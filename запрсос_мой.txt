ВЫБРАТЬ
	БазаДляНачислений.ФизЛицо,
	БазаДляНачислений.ФизЛицо.Наименование КАК ФИО,
	БазаДляНачислений.Месяц,
	БазаДляНачислений.Группа,
	СУММА(БазаДляНачислений.БазаДоходФСЗН_Прошл) КАК БазаДоходФСЗН_Прошл,
	СУММА(БазаДляНачислений.БазаДоходСтрах_Прошл) КАК БазаДоходСтрах_Прошл,
	СУММА(БазаДляНачислений.БазаДоходЕдиныйПлатеж_Прошл) КАК БазаДоходЕдиныйПлатеж_Прошл,
	СУММА(БазаДляНачислений.БазаДоходФСЗН) КАК БазаДоходФСЗН,
	СУММА(БазаДляНачислений.БазаДоходСтрах) КАК БазаДоходСтрах,
	СУММА(БазаДляНачислений.БазаДоходЕдиныйПлатеж) КАК БазаДоходЕдиныйПлатеж,
	0 КАК ПенсионныйФонд,
	0 КАК НачисленныйФСЗН,
	0 КАК НачисленныйСтрах,
	0 КАК НачисленныйЕдиныйПлатеж,
	1 КАК БазаНачислений
ИЗ
	(ВЫБРАТЬ
		Основная.ФизЛицо КАК ФизЛицо,
		Основная.Месяц КАК Месяц,
		ВЫБОР
			КОГДА НЕ Инвалид.Физлицо ЕСТЬ NULL
				ТОГДА Инвалид.Группа
			ИНАЧЕ 0
		КОНЕЦ КАК Группа,
		ВЫБОР
			КОГДА Основная.ДоходФСЗН = &парамПодлежитОбложению
					И Основная.Период <= &парамНачалоМесяцаПериодаРегистрации
					И Основная.Регистратор <> &Регистратор
				ТОГДА Основная.ОблагаемыйДоход
			ИНАЧЕ 0
		КОНЕЦ КАК БазаДоходФСЗН_Прошл,
		ВЫБОР
			КОГДА Основная.ДоходСтрах = &парамПодлежитОбложению
					И Основная.Период <= &парамНачалоМесяцаПериодаРегистрации
					И Основная.Регистратор <> &Регистратор
				ТОГДА Основная.ОблагаемыйДоход
			ИНАЧЕ 0
		КОНЕЦ КАК БазаДоходСтрах_Прошл,
		ВЫБОР
			КОГДА Основная.доходЕдиныйПлатеж = &парамПодлежитОбложению
					И Основная.Период <= &парамНачалоМесяцаПериодаРегистрации
					И Основная.Регистратор <> &Регистратор
				ТОГДА Основная.ОблагаемыйДоход
			ИНАЧЕ 0
		КОНЕЦ КАК БазаДоходЕдиныйПлатеж_Прошл,
		ВЫБОР
			КОГДА Основная.ДоходФСЗН = &парамПодлежитОбложению
				ТОГДА Основная.ОблагаемыйДоход
			ИНАЧЕ 0
		КОНЕЦ КАК БазаДоходФСЗН,
		ВЫБОР
			КОГДА Основная.ДоходСтрах = &парамПодлежитОбложению
				ТОГДА Основная.ОблагаемыйДоход
			ИНАЧЕ 0
		КОНЕЦ КАК БазаДоходСтрах,
		ВЫБОР
			КОГДА Основная.доходЕдиныйПлатеж = &парамПодлежитОбложению
				ТОГДА Основная.ОблагаемыйДоход
			ИНАЧЕ 0
		КОНЕЦ КАК БазаДоходЕдиныйПлатеж
	ИЗ
		(ВЫБРАТЬ
			ЕСННачисления.ФизЛицо КАК ФизЛицо,
			ЕСННачисления.Месяц КАК Месяц,
			ЕСННачисления.Период КАК Период,
			ЕСННачисления.Регистратор КАК Регистратор,
			ЕСННачисления.ДоходФСЗН КАК ДоходФСЗН,
			ЕСННачисления.ДоходСтрах КАК ДоходСтрах,
			ЕСННачисления.доходЕдиныйПлатеж КАК доходЕдиныйПлатеж,
			ЕСННачисления.ОблагаемыйДоход КАК ОблагаемыйДоход
		ИЗ
			(ВЫБРАТЬ
				ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
				НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
				НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) КАК Период,
				ЕСНСведенияОДоходах.Регистратор КАК Регистратор,
				ЕСНСведенияОДоходах.ДоходФСЗН КАК ДоходФСЗН,
				ЕСНСведенияОДоходах.ДоходСтрах КАК ДоходСтрах,
				ЕСНСведенияОДоходах.доходЕдиныйПлатеж КАК доходЕдиныйПлатеж,
				ВЫБОР
					КОГДА ЕСНСведенияОДоходах.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
							И ЕСНСведенияОДоходах.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
							И &парамПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
						ТОГДА ВЫРАЗИТЬ(ЕСНСведенияОДоходах.Результат / 10000 КАК ЧИСЛО(15, 2))
					ИНАЧЕ ЕСНСведенияОДоходах.Результат
				КОНЕЦ КАК ОблагаемыйДоход
			ИЗ
				РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
			ГДЕ
				ЕСНСведенияОДоходах.Период <= &парамКонецМесяцаПериодаРегистрации
				И ЕСНСведенияОДоходах.Организация = &Организация) КАК ЕСННачисления
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
					НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
					ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо
				ИЗ
					РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
				ГДЕ
					ЕСНСведенияОДоходах.Период = &парамПериодРегистрации
					И ЕСНСведенияОДоходах.Организация = &Организация) КАК Физлица
				ПО ЕСННачисления.ФизЛицо = Физлица.ФизЛицо
					И ЕСННачисления.Месяц = Физлица.Месяц) КАК Основная
			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				ВЫБОР
					КОГДА СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности = &парамГруппа1
							ИЛИ СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности = &парамГруппа2
						ТОГДА 1
					ИНАЧЕ 0
				КОНЕЦ КАК Группа,
				СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
				Периоды.Месяц КАК Месяц
			ИЗ
				(ВЫБРАТЬ
					СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
					МАКСИМУМ(СведенияОбИнвалидностиФизлиц.Период) КАК ПериодРегистра,
					НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ) КАК Месяц
				ИЗ
					(ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 1, 31, 23, 59, 59) КАК Период
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 2, 28, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 3, 31, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 4, 30, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 5, 31, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 6, 30, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 7, 31, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 8, 31, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 9, 30, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 10, 31, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 11, 30, 23, 59, 59)
					
					ОБЪЕДИНИТЬ ВСЕ
					
					ВЫБРАТЬ
						ДАТАВРЕМЯ(2025, 12, 31, 23, 59, 59)) КАК Периоды
						ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
						ПО Периоды.Период >= СведенияОбИнвалидностиФизлиц.Период
				
				СГРУППИРОВАТЬ ПО
					СведенияОбИнвалидностиФизлиц.Физлицо,
					НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ)) КАК Периоды
					ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
					ПО (СведенияОбИнвалидностиФизлиц.Период = Периоды.ПериодРегистра)
						И (ВЫБОР
							КОГДА СведенияОбИнвалидностиФизлиц.СрокДействияСправки = &ПустаяДата
								ТОГДА ИСТИНА
							ИНАЧЕ Периоды.ПериодРегистра < СведенияОбИнвалидностиФизлиц.СрокДействияСправки
						КОНЕЦ)
						И (СведенияОбИнвалидностиФизлиц.Физлицо = Периоды.Физлицо)
						И (СведенияОбИнвалидностиФизлиц.Инвалидность)) КАК Инвалид
			ПО (Инвалид.Физлицо = Основная.ФизЛицо)
				И Основная.Месяц = Инвалид.Месяц
	ГДЕ
		Инвалид.Физлицо = &Физлицо
		И Основная.ФизЛицо = &ФизЛицо) КАК БазаДляНачислений
ГДЕ
	БазаДляНачислений.ФизЛицо = &ФизЛицо

СГРУППИРОВАТЬ ПО
	БазаДляНачислений.ФизЛицо,
	БазаДляНачислений.Месяц,
	БазаДляНачислений.Группа,
	БазаДляНачислений.ФизЛицо.Наименование

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Отчисления.ФизЛицо,
	Отчисления.ФизЛицо.Наименование,
	Отчисления.Месяц,
	ВЫБОР
		КОГДА НЕ Инвалид.Физлицо ЕСТЬ NULL
			ТОГДА Инвалид.Группа
		ИНАЧЕ 0
	КОНЕЦ,
	0,
	0,
	0,
	0,
	0,
	0,
	СУММА(Отчисления.ПенсионныйФонд),
	СУММА(Отчисления.ФСЗН),
	СУММА(Отчисления.ОбязательноеСтрахование),
	СУММА(Отчисления.ЕдиныйПлатеж),
	0
ИЗ
	(ВЫБРАТЬ
		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		ВЫБОР
			КОГДА ЕСНИсчисленный.ПроцентФСЗН ЕСТЬ NULL
				ТОГДА 35
			ИНАЧЕ ЕСНИсчисленный.ПроцентФСЗН
		КОНЕЦ КАК ПроцентФСЗН,
		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
		ВЫБОР
			КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
					И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
					И &парамПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				ТОГДА ВЫРАЗИТЬ(ЕСНИсчисленный.ПенсионныйФонд / 10000 КАК ЧИСЛО(10, 2))
			ИНАЧЕ ЕСНИсчисленный.ПенсионныйФонд
		КОНЕЦ КАК ПенсионныйФонд,
		ВЫБОР
			КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
					И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
					И &парамПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				ТОГДА ВЫРАЗИТЬ(ЕСНИсчисленный.ФСЗН / 10000 КАК ЧИСЛО(10, 2))
			ИНАЧЕ ЕСНИсчисленный.ФСЗН
		КОНЕЦ КАК ФСЗН,
		ВЫБОР
			КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
					И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
					И &парамПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				ТОГДА ВЫРАЗИТЬ(ЕСНИсчисленный.ЕдиныйПлатеж / 10000 КАК ЧИСЛО(10, 2))
			ИНАЧЕ ЕСНИсчисленный.ЕдиныйПлатеж
		КОНЕЦ КАК ЕдиныйПлатеж,
		ВЫБОР
			КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
					И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
					И &парамПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				ТОГДА ВЫРАЗИТЬ(ЕСНИсчисленный.ОбязательноеСтрахование / 10000 КАК ЧИСЛО(10, 2))
			ИНАЧЕ ЕСНИсчисленный.ОбязательноеСтрахование
		КОНЕЦ КАК ОбязательноеСтрахование
	ИЗ
		РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
				НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
				ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо
			ИЗ
				РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
			ГДЕ
				ЕСНСведенияОДоходах.Период = &парамПериодРегистрации
				И ЕСНСведенияОДоходах.Организация = &Организация) КАК Физлица
			ПО ЕСНИсчисленный.ФизЛицо = Физлица.ФизЛицо
				И (НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = Физлица.Месяц)
	ГДЕ
		ЕСНИсчисленный.Организация = &Организация
		И ЕСНИсчисленный.Период <= &парамКонецМесяцаПериодаРегистрации) КАК Отчисления
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности = &парамГруппа1
						ИЛИ СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности = &парамГруппа2
					ТОГДА 1
				ИНАЧЕ 0
			КОНЕЦ КАК Группа,
			СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
			Периоды.Месяц КАК Месяц
		ИЗ
			(ВЫБРАТЬ
				СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
				МАКСИМУМ(СведенияОбИнвалидностиФизлиц.Период) КАК ПериодРегистра,
				НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ) КАК Месяц
			ИЗ
				(ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 1, 31, 23, 59, 59) КАК Период
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 2, 28, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 3, 31, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 4, 30, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 5, 31, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 6, 30, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 7, 31, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 8, 31, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 9, 30, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 10, 31, 23, 59, 59)
				
				ОБЪЕДИНИТЬ ВСЕ
				
				ВЫБРАТЬ
					ДАТАВРЕМЯ(2025, 11, 30, 23, 59, 59)) КАК Периоды
					ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
					ПО Периоды.Период >= СведенияОбИнвалидностиФизлиц.Период
			
			СГРУППИРОВАТЬ ПО
				СведенияОбИнвалидностиФизлиц.Физлицо,
				НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ)) КАК Периоды
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
				ПО (СведенияОбИнвалидностиФизлиц.Период = Периоды.ПериодРегистра)
					И (ВЫБОР
						КОГДА СведенияОбИнвалидностиФизлиц.СрокДействияСправки = &ПустаяДата
							ТОГДА ИСТИНА
						ИНАЧЕ Периоды.ПериодРегистра < СведенияОбИнвалидностиФизлиц.СрокДействияСправки
					КОНЕЦ)
					И (СведенияОбИнвалидностиФизлиц.Физлицо = Периоды.Физлицо)
					И (СведенияОбИнвалидностиФизлиц.Инвалидность)) КАК Инвалид
		ПО (Инвалид.Физлицо = Отчисления.ФизЛицо)
			И Отчисления.Месяц = Инвалид.Месяц
ГДЕ
	Отчисления.ФизЛицо = &ФизЛицо
	И Инвалид.Физлицо = &Физлицо

СГРУППИРОВАТЬ ПО
	Отчисления.ФизЛицо,
	Отчисления.Месяц,
	ВЫБОР
		КОГДА НЕ Инвалид.Физлицо ЕСТЬ NULL
			ТОГДА Инвалид.Группа
		ИНАЧЕ 0
	КОНЕЦ,
	Отчисления.ФизЛицо.Наименование