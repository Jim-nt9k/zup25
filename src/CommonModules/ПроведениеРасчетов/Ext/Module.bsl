
// Производит расчет записей набора записей регистра расчета
// параметры:
//  ИсходныеДанные - результат запроса к исходным данным
//  НаборЗаписейРегистра - набор записей
//  ЗаписиДоходыНДФЛ - набор записей регистра доходов НДФЛ
//  ГоловнаяОрганизация - ссылка на организацию
//  ОбособленноеПодразделение - ссылка на обособленное подразделение
//	ТабличнаяЧастьДокумента - табличная часть документа, заполняется по результатам расчета
//
// возвращаемое значение:
//	нет
//
Процедура РассчитатьЗаписиНабора(ИсходныеДанные,
	НаборЗаписейРегистра,
	НеобходимыеДанные,
	ЗаписиДоходыНДФЛ,
	ГоловнаяОрганизация,
	ОбособленноеПодразделение,
	ТабличнаяЧастьДокумента,
	ДанныеДляПрогнозаНДФЛ = Неопределено,
	СведенияОДоначислениях = Неопределено,
	КурсВалютыУпрУчета = Неопределено,
	ПовторныйРасчет = Ложь,
	МассивИндексыСтрокТабличнойЧасти = Неопределено,
	КомментироватьРасчет = Ложь, ФормаКомментариев = НеОпределено,НаборЗаписейРасчетСреднего = Неопределено,ТекЗначение = Неопределено) Экспорт 
	
	СтруктураПоиска = Новый Структура("НомерСтроки");
	ПустойКодДохода = Справочники.ДоходыНДФЛ.ПустаяСсылка();
	
	// признаки расчета набора записей определенного регистра
	ОсновныеНачисленияОрганизаций = Ложь;
	ДополнительныеНачисленияОрганизаций = Ложь;
	УправленческиеРасчеты = Ложь;
	УправленческиеНачисления = Ложь;
	РегламентированныеУдержания = Ложь;
	РегламентированныеНачисления = Ложь;
	Если ТипЗнч(НаборЗаписейРегистра) = Тип("РегистрРасчетаНаборЗаписей.ОсновныеНачисленияРаботниковОрганизаций") Тогда
		ОсновныеНачисленияОрганизаций = Истина;
		РегламентированныеНачисления = Истина;
	ИначеЕсли ТипЗнч(НаборЗаписейРегистра) = Тип("РегистрРасчетаНаборЗаписей.ДополнительныеНачисленияРаботниковОрганизаций") Тогда
		ДополнительныеНачисленияОрганизаций = Истина;
		РегламентированныеНачисления = Истина;
	ИначеЕсли ТипЗнч(НаборЗаписейРегистра) = Тип("РегистрРасчетаНаборЗаписей.УправленческиеНачисления") Тогда
		УправленческиеРасчеты = Истина;
		УправленческиеНачисления = Истина;
	ИначеЕсли ТипЗнч(НаборЗаписейРегистра) = Тип("РегистрРасчетаНаборЗаписей.УправленческиеУдержания") Тогда
		УправленческиеРасчеты = Истина;
	ИначеЕсли ТипЗнч(НаборЗаписейРегистра) = Тип("РегистрРасчетаНаборЗаписей.УдержанияРаботниковОрганизаций") Тогда
		РегламентированныеУдержания = Истина;
	КонецЕсли;
	
	// Соответствие для хранения графика с ошибками
	ГрафикиБезРабочегоВремени = Новый ТаблицаЗначений;
	ГрафикиБезРабочегоВремени.Колонки.Добавить("ГрафикРаботы");
	ГрафикиБезРабочегоВремени.Колонки.Добавить("ВидУчетаВремени");
	
	ВычетНДФЛКод405 = Справочники.ВычетыНДФЛ.Код405;
	ВычетНДФЛКод404 = Справочники.ВычетыНДФЛ.Код404;
	//	ВычетНДФЛКод403 = Справочники.ВычетыНДФЛ.Код403;
	
	//О.Т. 08.07.2015 № 481
	СторнируемыйДок = Ложь;
	Для Каждого СтрокаДвижений Из НаборЗаписейРегистра Цикл
		если СтрокаДвижений.Сторно Тогда 
			СторнируемыйДок = Истина;
			Прервать;
		КонецЕсли;
	КонецЦикла;
	//О.Т. 08.07.2015 № 481
	
	Для Каждого СтрокаДвижений Из НаборЗаписейРегистра Цикл
		#Если Клиент Тогда
			ОбработкаПрерыванияПользователя();
		#КонецЕсли
		
		//О.Т. 18.02.2015 № 334
		если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
			если  СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу Тогда 
				СтруктураПоиска = Новый Структура("ВидРасчета,ПериодДействияНачало");
				СтруктураПоиска.ВидРасчета = СтрокаДвижений.ВидРасчета;
				СтруктураПоиска.ПериодДействияНачало = СтрокаДвижений.ПериодДействияНачало;
			иначе
				СтруктураПоиска.НомерСтроки = СтрокаДвижений.НомерСтроки;
			КонецЕсли;
			
		иначе
			
			СтруктураПоиска.НомерСтроки = СтрокаДвижений.НомерСтроки;
		КонецЕсли;
		//О.Т. 18.02.2015 № 334
		
		//+ СВЭЙ КДЯ 24.01.20 СВФР-005407
		Если СтрокаДвижений.Регистратор.Метаданные().Реквизиты.Найти ( "Курс" ) <> Неопределено Тогда
			Курс = ?( СтрокаДвижений.Регистратор.Курс = 0, 1, СтрокаДвижений.Регистратор.Курс );
		Иначе	
			Курс = 1;
		КонецЕсли; 
		//- СВЭЙ КДЯ 24.01.20 СВФР-005407
		
		Если ИсходныеДанные.НайтиСледующий(СтруктураПоиска) Тогда
			СтрокаТабличнойЧасти = Неопределено;
			Если ТабличнаяЧастьДокумента <> Неопределено Тогда
				Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ПродажаТовараВКредит") Тогда //О.Т. Аверсон 11.04.2016
					СтрокаТабличнойЧасти = ТабличнаяЧастьДокумента;
				иначе
					
					Если МассивИндексыСтрокТабличнойЧасти = Неопределено Тогда
						//расчет всего документа
						//Аверсон 09.03.2022 КВВ СВФР-008806 (
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций")
							И ТипЗнч(СтрокаДвижений) = Тип("РегистрРасчетаЗапись.ДополнительныеНачисленияРаботниковОрганизаций") Тогда
							Попытка
								СтрокаТабличнойЧасти = ТабличнаяЧастьДокумента.Получить(НаборЗаписейРегистра.Индекс(СтрокаДвижений));
							Исключение
							КонецПопытки;
						Иначе
							//Аверсон 09.03.2022 КВВ СВФР-008806 )
							СтрокаТабличнойЧасти = ТабличнаяЧастьДокумента.Получить(НаборЗаписейРегистра.Индекс(СтрокаДвижений));
						КонецЕсли;
					Иначе
						//расчет по сотруднику
						СтрокаТабличнойЧасти = ТабличнаяЧастьДокумента.Получить(МассивИндексыСтрокТабличнойЧасти.Получить(НаборЗаписейРегистра.Индекс(СтрокаДвижений)));
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			//Если ТипЗнч(ИсходныеДанные.Регистратор) =  Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
			//	БазаЗамещение = НаборЗаписейРегистра[0].Результат;//Островская 16.03.2014 №
			//КонецЕсли;//Островская Татьяна 02.04.2014
			
			РезультатДляОграничения = 0;
			ДниДляОграничения = 0;
			Для каждого стрНаборЗаписей Из НаборЗаписейРегистра Цикл
				если НачалоМесяца(СтрокаДвижений.ПериодДействияНачало) = НачалоМесяца(стрНаборЗаписей.ПериодДействияНачало) и
					стрНаборЗаписей.НомерСтроки < СтрокаДвижений.НомерСтроки Тогда 
					РезультатДляОграничения = РезультатДляОграничения + стрНаборЗаписей.Результат;
				КонецЕсли;
			КонецЦикла;
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
				РезультатДляОграничения = 0;
				ДниДляОграничения = 0;
				Для каждого стрНаборЗаписей Из НаборЗаписейРегистра Цикл
					если НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало) = НачалоМесяца(стрНаборЗаписей.БазовыйПериодНачало) и
						стрНаборЗаписей.НомерСтроки < СтрокаДвижений.НомерСтроки Тогда 
						РезультатДляОграничения = РезультатДляОграничения + стрНаборЗаписей.Результат;
						ДниДляОграничения = ДниДляОграничения + стрНаборЗаписей.ОплаченоДнейЧасов;
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			
			
			
			РассчитатьЗаписьРегистраРасчета(СтрокаДвижений, ИсходныеДанные, УправленческиеРасчеты, РегламентированныеНачисления, РегламентированныеУдержания, ОсновныеНачисленияОрганизаций, ДополнительныеНачисленияОрганизаций, ДанныеДляПрогнозаНДФЛ, СведенияОДоначислениях, КурсВалютыУпрУчета, ПовторныйРасчет, КомментироватьРасчет, ФормаКомментариев, ГрафикиБезРабочегоВремени,РезультатДляОграничения,НаборЗаписейРасчетСреднего,СторнируемыйДок,ТекЗначение,ДниДляОграничения);//островская 16.03.2014 № , 481
			
			
			//Аверсон-софт, Островская Татьяна 16.03.2012   
			мОтработаноЧас = 0;
			мОтработаноЧасов = 0;
			Запрос = Новый Запрос;
			Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда //О.Т. Аверсон 13.12.2016 № 100
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
				|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней,
				|	РабочееВремяРаботниковОрганизаций.Регистратор
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&ВидИспользованияРабочегоВремени)
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
				|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
				|	И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И ВЫБОР
				|			КОГДА &ФлагПоТабелю
				|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
				|			ИНАЧЕ ИСТИНА
				|		КОНЕЦ
				|
				|СГРУППИРОВАТЬ ПО
				|	РабочееВремяРаботниковОрганизаций.Регистратор";
			иначе
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
				|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней,
				|	РабочееВремяРаботниковОрганизаций.Регистратор
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРабочегоВремени)
				|	И РабочееВремяРаботниковОрганизаций.Период >= &Период
				|	И РабочееВремяРаботниковОрганизаций.Период <= &Период2
				|	И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И ВЫБОР
				|			КОГДА &ФлагПоТабелю
				|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
				|			ИНАЧЕ ИСТИНА
				|		КОНЕЦ
				|
				|СГРУППИРОВАТЬ ПО
				|	РабочееВремяРаботниковОрганизаций.Регистратор";
			КонецЕсли;
			
			УчетнаяПолитикаЗапрос = Новый Запрос; //О.Т. 23.12.2014 № 
			УчетнаяПолитикаЗапрос.Текст = 
			"ВЫБРАТЬ
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
			|ИЗ
			|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
			|ГДЕ
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
			УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
			УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
			если УчетнаяПолитика.Количество()>0 Тогда 
				Запрос.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
			иначе
				Запрос.УстановитьПараметр("ФлагПоТабелю",Ложь);
			КонецЕсли;
			Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда //О.Т. Аверсон 13.12.2016 № 100
				если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
				иначе		
					Запрос.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
					Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
				КонецЕсли;
			иначе
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодРегистрации);
				Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
			КонецЕсли;
			Если СторнируемыйДок Тогда //О.Т. 08.07.2015 № 481
				если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
				КонецЕсли;
			КонецЕсли;
			
			Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул Тогда //О.Т. Аверсон 24.06.2016
				СписокКлассификатора = Новый СписокЗначений;
				СписокКлассификатора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Прогулы);
				если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
				иначе
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодРегистрации);
					Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
				КонецЕсли;
			иначе  				
				СписокКлассификатора = Новый СписокЗначений;
				СписокКлассификатора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
				СписокКлассификатора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускПоУходуЗаРебенком);
			КонецЕсли;
			Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", СписокКлассификатора);
			Выборка = Запрос.Выполнить().Выбрать();
			Пока Выборка.Следующий() цикл
				мОтработаноЧас = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Часов,0);
				мОтработаноЧасов = ?(ЗначениеЗаполнено(Выборка.Дней),Выборка.Дней,0);
			КонецЦикла;
			
			Если  ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДни ИЛИ 
				ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаШестидневка ИЛИ 
				ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДниБезУвольнения ИЛИ 
				ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаШестидневкаБезУвольнения ИЛИ 
				ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.УдержанияОрганизаций.УдержаниеЗаНеотработанныйОтпускКалендарныеДни ИЛИ 
				ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.УдержанияОрганизаций.УдержаниеЗаНеотработанныйОтпускШестидневка ИЛИ
				(ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") И 
				(ИсходныеДанные.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ИЛИ
				ИсходныеДанные.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке)) Тогда //О.Т. 02.09.2014 № 17565
				
			иначе
				Если ЗначениеЗаполнено(СтрокаДвижений.ДатаНачалаСобытия) Тогда 
					ТарСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ДатаНачалаСобытия, СтрокаДвижений.ГрафикРаботы, Ложь,?((СтрокаДвижений.Организация.ИНН = "100010315" ИЛИ СтрокаДвижений.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Организация.ИНН = "200400628" ИЛИ СтрокаДвижений.Организация.ИНН = "500036445" ИЛИ СтрокаДвижений.Организация.ИНН = "500826909"),Истина,Ложь),,,мОтработаноЧас,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,, Курс>   //Островская Татьяна 15.03.2013 № 16327 //Аверсон 07.10.2019 КВВ СВФР-004830 //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
				иначе
					ТарСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, НачалоМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.ГрафикРаботы, Ложь,,,,мОтработаноЧас,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,, Курс>  //Островская Татьяна 15.03.2013 № 16327
				КонецЕсли;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
			
			если (не ЗначениеЗаполнено(мОтработаноЧас) и не ЗначениеЗаполнено(мОтработаноЧасов)) и ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") тогда 
				Если ОсновныеНачисленияОрганизаций  И СтрокаДвижений.Авторасчет Тогда
					СтрокаДвижений.ОплаченоДней = 0;
				КонецЕсли;
			КонецЕсли;
			
			//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
			
			Если СтрокаТабличнойЧасти <> Неопределено Тогда
				Попытка
					СтрокаТабличнойЧасти.Показатель1 = СтрокаДвижений.Показатель1;
				Исключение
				КонецПопытки; 					
				
				//Аверсон 09.03.2022 КВВ СВФР-008806 (
				//Если ДополнительныеНачисленияОрганизаций И СтрокаДвижений.ВидРасчета.ЛьготаПоФСЗН500Код Тогда 
				////Не меняем результат
				//Иначе
				//Аверсон 09.03.2022 КВВ СВФР-008806 )
				СтрокаТабличнойЧасти.Результат = СтрокаДвижений.Результат;
				
				Если (ОсновныеНачисленияОрганизаций ИЛИ ДополнительныеНачисленияОрганизаций) И СтрокаДвижений.Авторасчет Тогда
					Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.МПНаОздоровление") Тогда 
						СтрокаТабличнойЧасти.ДнейКДоплате = СтрокаДвижений.ОплаченоДнейЧасов;
					иначе
						Если не ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЕдиновременныхПособийЗаСчетФСС") Тогда //О.Т. Аверсон 29.05.2018 № 2013
							СтрокаТабличнойЧасти.ОплаченоДнейЧасов = СтрокаДвижений.ОплаченоДнейЧасов;
						КонецЕсли;
						//толик
						Попытка
							//Аверсон-софт, Островская Татьяна 13.06.2012
							если ОсновныеНачисленияОрганизаций тогда
								//Аверсон-софт, Островская Татьяна 13.06.2012
								СтрокаТабличнойЧасти.ОплаченоДней = СтрокаДвижений.ОплаченоДней;
							КонецЕсли;
						Исключение
						КонецПопытки;
					КонецЕсли;
				КонецЕсли;
				
				// расчет вычетов для НДФЛ
				Если ДополнительныеНачисленияОрганизаций И НеобходимыеДанные.ВычетыКДоходамНДФЛ Тогда
					Если СтрокаТабличнойЧасти.КодВычета = ВычетНДФЛКод405 Тогда
						СтрокаТабличнойЧасти.СуммаВычета = СтрокаДвижений.Результат * ИсходныеДанные.НормативЗатрат / 100;
					ИначеЕсли СтрокаТабличнойЧасти.КодВычета = ВычетНДФЛКод404 Тогда  // фактические расходы, их изменять не следует
					Иначе
						БазовыеВеличины = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации), 
						Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.БазоваяВеличина));
						Если БазовыеВеличины <> Неопределено тогда
							//Аверсон-софт, Островская Татьяна 22.03.2012  №14668
							Если БазовыеВеличины.Размер <> 0 и ИсходныеДанные.Регистратор.ПериодРегистрации >= Дата("20120101000000") тогда
								ПараметрРасчета = ИсходныеДанные.ГодовойВычет;
							Иначе
								ПараметрРасчета = ИсходныеДанные.КратностьВычета*БазовыеВеличины.Размер;
							КонецЕсли;
							//Аверсон-софт, Островская Татьяна 22.03.2012 №14668
							
						Иначе
							ПараметрРасчета = ИсходныеДанные.ГодовойВычет;
						КонецЕсли;
						//О.Т. Аверсон 09.06.2016 № 1191
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и СтрокаДвижений.ПериодРегистрации <= Дата(2016,12,31) Тогда
							ПараметрРасчета = ОбщегоНазначения.ОкруглитьЗначение2016(ПараметрРасчета / 10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
						//О.Т. Аверсон 09.06.2016 № 1191
						
						СуммаПоИмущественным640 = 0;
						Если СтрокаТабличнойЧасти.КодВычета = Справочники.ВычетыНДФЛ.Код640страх Тогда 
							ЗапросИмущВычеты = Новый Запрос;
							ЗапросИмущВычеты.Текст = 
							"ВЫБРАТЬ
							|	СУММА(НДФЛИмущественныеВычетыФизлиц.Размер) КАК Размер
							|ИЗ
							|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц КАК НДФЛИмущественныеВычетыФизлиц
							|ГДЕ
							|	НДФЛИмущественныеВычетыФизлиц.Организация = &Организация
							|	И НДФЛИмущественныеВычетыФизлиц.ФизЛицо = &ФизЛицо
							|	И НДФЛИмущественныеВычетыФизлиц.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
							|	И НДФЛИмущественныеВычетыФизлиц.Период МЕЖДУ &Период И &Период1
							|	И НДФЛИмущественныеВычетыФизлиц.КодВычетаИмущественный = &КодВычетаИмущественный";
							
							ЗапросИмущВычеты.УстановитьПараметр("КодВычетаИмущественный", Справочники.ВычетыНДФЛ.Код640страх);
							ЗапросИмущВычеты.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
							ЗапросИмущВычеты.УстановитьПараметр("Период", НачалоГода(СтрокаДвижений.ПериодРегистрации));
							ЗапросИмущВычеты.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
							ЗапросИмущВычеты.УстановитьПараметр("ФизЛицо", СтрокаДвижений.ФизЛицо);
							
							РезультатИмущВычеты = ЗапросИмущВычеты.Выполнить().Выбрать();
							
							Пока РезультатИмущВычеты.Следующий() Цикл
								СуммаПоИмущественным640 = ?(РезультатИмущВычеты.Размер = Null, 0,РезультатИмущВычеты.Размер);
							КонецЦикла;
							//О.Т. Аверсон 15.05.2018 № 1952
							Если СтрокаТабличнойЧасти.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.Совместительство Тогда 
								Запрос500 = Новый Запрос;
								Запрос500.Текст = 
								"ВЫБРАТЬ
								|	Сумма(НДФЛСведенияОДоходах.СуммаВычета) как СуммаВычета500
								|ИЗ
								|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
								|ГДЕ
								|	НДФЛСведенияОДоходах.Организация = &Организация
								|	И НДФЛСведенияОДоходах.ФизЛицо = &ФизЛицо
								|	И НДФЛСведенияОДоходах.Период МЕЖДУ &Период И &Период1
								|	И НДФЛСведенияОДоходах.КодДохода = &КодДохода500";
								
								Запрос500.УстановитьПараметр("КодДохода500", Справочники.ДоходыНДФЛ.Код12117);
								Запрос500.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								Запрос500.УстановитьПараметр("Период", НачалоГода(СтрокаДвижений.ПериодРегистрации));
								Запрос500.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								Запрос500.УстановитьПараметр("ФизЛицо", СтрокаДвижений.ФизЛицо);
								
								Результат500 = Запрос500.Выполнить().Выбрать();
								
								Пока Результат500.Следующий() Цикл
									СуммаПо500 = ?(Результат500.СуммаВычета500 = Null, 0,Результат500.СуммаВычета500);
								КонецЦикла;
								СуммаПоИмущественным640 = СуммаПоИмущественным640 + СуммаПо500; 
								
								
							КонецЕсли;
							//О.Т. Аверсон 15.05.2018 № 1952
							
							
						КонецЕсли;
						
						
						Если СтрокаТабличнойЧасти.ВидРасчета.КодДоходаНДФЛ = Справочники.ДоходыНДФЛ.Код12117 Тогда //О.Т. Аверсон 21.05.2018 № 1952
							Если СтрокаТабличнойЧасти.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.Совместительство Тогда 
								Запрос640 = Новый Запрос;
								Запрос640.Текст = 
								"ВЫБРАТЬ
								|	Сумма(НДФЛСведенияОДоходах.СуммаВычета) как СуммаВычета640
								|ИЗ
								|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
								|ГДЕ
								|	НДФЛСведенияОДоходах.Организация = &Организация
								|	И НДФЛСведенияОДоходах.ФизЛицо = &ФизЛицо
								|	И НДФЛСведенияОДоходах.Период МЕЖДУ &Период И &Период1
								|	И НДФЛСведенияОДоходах.КодДохода = &КодДохода640";
								
								Запрос640.УстановитьПараметр("КодДохода640", Справочники.ДоходыНДФЛ.НайтиПоКоду("640"));
								Запрос640.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								Запрос640.УстановитьПараметр("Период", НачалоГода(СтрокаДвижений.ПериодРегистрации));
								Запрос640.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								Запрос640.УстановитьПараметр("ФизЛицо", СтрокаДвижений.ФизЛицо);
								
								Запрос640 = Запрос640.Выполнить().Выбрать();
								
								Пока Запрос640.Следующий() Цикл
									СуммаПоИмущественным640 = ?(Запрос640.СуммаВычета640 = Null, 0,Запрос640.СуммаВычета640);
								КонецЦикла;									
								
							КонецЕсли;
							//О.Т. Аверсон 15.05.2018 № 1952
							
							
						КонецЕсли;
						
						СтрокаТабличнойЧасти.СуммаВычета = Мин(ПараметрРасчета - ИсходныеДанные.СуммаВычетаОборот - СуммаПоИмущественным640, СтрокаДвижений.Результат); //О.Т. 04.01.2016 ( Макс(0, Мин(ПараметрРасчета - ИсходныеДанные.СуммаВычетаОборот, СтрокаДвижений.Результат)) )
						
						//Аверсон 16.07.2022 КВВ СВФР-009304 (
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") 
							И СтрокаТабличнойЧасти.ВидРасчета.ЛьготаПоФСЗН500Код 
							И СтрокаТабличнойЧасти.ВидРасчета.ОтдельныйУчетЛьготы 
							И ЗначениеЗаполнено(СтрокаТабличнойЧасти.ВидРасчета.ОблагаемыйВРЛьготаПоФСЗН500Код) Тогда
							
							//Аверсон 20.02.2023 КВВ СВФР-010268 (
							//ПределИзРегистра = ?(СтрокаТабличнойЧасти.Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.Постоянный,РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания)).ГодовойВычет,РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания)).ВычетНаСовместителя);
							//ПределИзРегистра = ?(СтрокаТабличнойЧасти.Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.Постоянный,РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания),Новый Структура("КодДохода",Справочники.ДоходыНДФЛ.Код12117)).ГодовойВычет,РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания),Новый Структура("КодДохода",Справочники.ДоходыНДФЛ.Код12117)).ВычетНаСовместителя);
							//Аверсон 20.02.2023 КВВ СВФР-010268 )
							//одинаковый принцип вид занятости и договор подряда
							Если СтрокаТабличнойЧасти.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.Совместительство или 
								СтрокаТабличнойЧасти.Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.ДоговорПодряда Тогда   
								ПределИзРегистра = РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания),Новый Структура("КодДохода",Справочники.ДоходыНДФЛ.Код12117)).ВычетНаСовместителя;
							Иначе 
								ПределИзРегистра = РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания),Новый Структура("КодДохода",Справочники.ДоходыНДФЛ.Код12117)).ГодовойВычет;
							КонецЕсли;
							ЗапросЛьготаФСЗН = Новый Запрос;
							ЗапросЛьготаФСЗН.Текст = "ВЫБРАТЬ
							|СУММА(ЛьготаФСЗН.Сумма) КАК Сумма
							|ИЗ РегистрСведений.ЛьготаФСЗН КАК ЛьготаФСЗН
							|ГДЕ ЛьготаФСЗН.Период МЕЖДУ &НачалоГода И &КонецГода
							|И ЛьготаФСЗН.Сотрудник = &Сотрудник
							|И ЛьготаФСЗН.Организация = &Организация";
							ЗапросЛьготаФСЗН.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
							ЗапросЛьготаФСЗН.УстановитьПараметр("Сотрудник",СтрокаТабличнойЧасти.Сотрудник);
							ЗапросЛьготаФСЗН.УстановитьПараметр("НачалоГода",НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания));
							ЗапросЛьготаФСЗН.УстановитьПараметр("КонецГода",КонецГода(СтрокаТабличнойЧасти.ДатаОкончания));
							РезЗапросЛьготаФСЗН = ЗапросЛьготаФСЗН.Выполнить().Выгрузить();
							СуммаПоРегистру = ?(ЗначениеЗаполнено(РезЗапросЛьготаФСЗН[0].Сумма),РезЗапросЛьготаФСЗН[0].Сумма,0);
							СтрокаТабличнойЧасти.ПределФСЗН = Мин(ПределИзРегистра - СуммаПоРегистру,СтрокаТабличнойЧасти.Результат);
						КонецЕсли;
						//Аверсон 16.07.2022 КВВ СВФР-009304 )
					КонецЕсли;
					
					//Аверсон 17.02.2023 КВВ СВФР-010268 (
				ИначеЕсли ДополнительныеНачисленияОрганизаций И НЕ НеобходимыеДанные.ВычетыКДоходамНДФЛ Тогда
					Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") 
						И СтрокаТабличнойЧасти.ВидРасчета.ЛьготаПоФСЗН500Код 
						И СтрокаТабличнойЧасти.ВидРасчета.ОтдельныйУчетЛьготы 
						И ЗначениеЗаполнено(СтрокаТабличнойЧасти.ВидРасчета.ОблагаемыйВРЛьготаПоФСЗН500Код) Тогда
						
						//ПределИзРегистра = ?(СтрокаТабличнойЧасти.Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.Постоянный,РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания)).ГодовойВычет,РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания)).ВычетНаСовместителя);
						ПределИзРегистра = ?(СтрокаТабличнойЧасти.Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.Постоянный,РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания),Новый Структура("КодДохода",Справочники.ДоходыНДФЛ.Код12117)).ГодовойВычет,РегистрыСведений.НДФЛВычетыПоДоходам.ПолучитьПоследнее(НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания),Новый Структура("КодДохода",Справочники.ДоходыНДФЛ.Код12117)).ВычетНаСовместителя);
						
						ЗапросЛьготаФСЗН = Новый Запрос;
						ЗапросЛьготаФСЗН.Текст = "ВЫБРАТЬ
						|СУММА(ЛьготаФСЗН.Сумма) КАК Сумма
						|ИЗ РегистрСведений.ЛьготаФСЗН КАК ЛьготаФСЗН
						|ГДЕ ЛьготаФСЗН.Период МЕЖДУ &НачалоГода И &КонецГода
						|И ЛьготаФСЗН.Сотрудник = &Сотрудник
						|И ЛьготаФСЗН.Организация = &Организация";
						ЗапросЛьготаФСЗН.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
						ЗапросЛьготаФСЗН.УстановитьПараметр("Сотрудник",СтрокаТабличнойЧасти.Сотрудник);
						ЗапросЛьготаФСЗН.УстановитьПараметр("НачалоГода",НачалоГода(СтрокаТабличнойЧасти.ДатаОкончания));
						ЗапросЛьготаФСЗН.УстановитьПараметр("КонецГода",КонецГода(СтрокаТабличнойЧасти.ДатаОкончания));
						РезЗапросЛьготаФСЗН = ЗапросЛьготаФСЗН.Выполнить().Выгрузить();
						СуммаПоРегистру = ?(ЗначениеЗаполнено(РезЗапросЛьготаФСЗН[0].Сумма),РезЗапросЛьготаФСЗН[0].Сумма,0);
						СтрокаТабличнойЧасти.ПределФСЗН = Мин(ПределИзРегистра - СуммаПоРегистру,СтрокаТабличнойЧасти.Результат);
					КонецЕсли;
					//Аверсон 17.02.2023 КВВ СВФР-010268 )
					
				КонецЕсли;
				//КонецЕсли; //Аверсон 09.03.2022 КВВ СВФР-008806
			КонецЕсли;
			
			// если передали таблицу (или набор записей) для заполнения движений о доходах НДФЛ
			// если код дохода указан
			// и если результат не нулевой
			// запишем движение в доходы НДФЛ
			Если ЗаписиДоходыНДФЛ <> Неопределено И 
				ИсходныеДанные.КодДоходаНДФЛ <> ПустойКодДохода И 
				СтрокаДвижений.Результат <> 0 Тогда
				// если определен код дохода с точки зрения НДФЛ - добавим строку в доходы НДФЛ
				Движение = ЗаписиДоходыНДФЛ.Добавить();
				// свойства 
				Движение.Регистратор				= СтрокаДвижений.Регистратор;
				Если ОсновныеНачисленияОрганизаций И ИсходныеДанные.КодДоходаНДФЛ = Справочники.ДоходыНДФЛ.КодДоходаПоУмолчанию Тогда
					Движение.Период					= СтрокаДвижений.ПериодДействия;
				Иначе
					Движение.Период					= СтрокаДвижений.ПериодРегистрации;
				КонецЕсли;
				
				// Измерения
				Движение.Организация				= ГоловнаяОрганизация;
				Движение.Физлицо					= СтрокаДвижений.Физлицо;
				Движение.КодДохода					= ИсходныеДанные.КодДоходаНДФЛ;
				Движение.ПериодРегистрации			= СтрокаДвижений.ПериодРегистрации;
				// Ресурсы
				Движение.СуммаДохода				= СтрокаДвижений.Результат;
				// реквизиты
				Движение.ОбособленноеПодразделение	= ОбособленноеПодразделение;
				
				// выполнен расчет вычетов для НДФЛ
				Если ДополнительныеНачисленияОрганизаций И НеобходимыеДанные.ВычетыКДоходамНДФЛ Тогда
					Движение.СуммаВычета			= СтрокаТабличнойЧасти.СуммаВычета;
					Движение.КодВычета				= СтрокаТабличнойЧасти.КодВычета;
				КонецЕсли;
			КонецЕсли;
			
			// если это данные по виду расчета, период действия которого является отработанным временем
			// или учитывается как норма времени, то для рассчитываемой записи сохраним данные о времени
			Если (ОсновныеНачисленияОрганизаций ИЛИ УправленческиеНачисления) И СтрокаДвижений.Авторасчет Тогда
				
				СпособРасчета = ИсходныеДанные.СпособРасчета;
				
				БылоСообщениеОРабочемВремени = (
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку или 
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС или 
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка или 
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням или 
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам или
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке или
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке или
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням или 
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам или
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке или
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке или
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы или
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы или
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф или //О.Т. Аверсон 02.04.2016 № 981
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр или //О.Т. Аверсон 02.04.2016 № 981
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой);//О.Т. 22.05.2015 №  
				
				БылоСообщениеОВидеВремени = Ложь;
				
				Если ИсходныеДанные.ЗачетОтработанногоВремени Тогда
					СтрокаДвижений.ОтработаноДней = 0;
					СтрокаДвижений.ОтработаноЧасов = 0;
					Если Не БылоСообщениеОРабочемВремени  Тогда
						СообщениеОбОшибке = Ложь;
						ОплачиваемоеВремя = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, , СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
						БылоСообщениеОРабочемВремени = СообщениеОбОшибке;
					КонецЕсли;
					ПлюсКомандДн = 0; ПлюсКомандЧас = 0; //Аверсон 15.08.2019 КВВ СВФР-004608
					Если ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням 
						Или СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
						//СтрокаДвижений.ОтработаноДней = ИсходныеДанные.ОтработаноДней * ?(СтрокаДвижений.Сторно,-1,1);
						//СтрокаДвижений.ОтработаноЧасов = ИсходныеДанные.ОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
						//толик
						//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
						если (не ЗначениеЗаполнено(мОтработаноЧас) или не ЗначениеЗаполнено(мОтработаноЧасов)) и ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") тогда
							СтрокаДвижений.ОтработаноДней = 0;
							СтрокаДвижений.ОтработаноЧасов = 0;
							//Если СтрокаДвижений.Организация.ИНН = "100071565" и ИсходныеДанные.ОтработаноЧасов > СтрокаДвижений.ОплаченоДнейЧасов и СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
							//	СтрокаДвижений.ОтработаноЧасов = СтрокаДвижений.ОплаченоДнейЧасов;
							//	СтрокаДвижений.ОтработаноДней =  ОКР(СтрокаДвижений.ОплаченоДнейЧасов/8);
							//КонецЕсли;
						иначе
							//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113	
							Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул Тогда //О.Т. Аверсон 24.06.2016
								СтрокаДвижений.ОтработаноДней = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДней, мОтработаноЧасов) * ?(СтрокаДвижений.Сторно,-1,1);
								СтрокаДвижений.ОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, мОтработаноЧас) * ?(СтрокаДвижений.Сторно,-1,1);
							иначе
								СтрокаДвижений.ОтработаноДней = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДней, ИсходныеДанные.ОтработаноДней) * ?(СтрокаДвижений.Сторно,-1,1);
								СтрокаДвижений.ОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов) * ?(СтрокаДвижений.Сторно,-1,1);
								//Если СтрокаДвижений.Организация.ИНН = "100071565" и ИсходныеДанные.ОтработаноЧасов > СтрокаДвижений.ОплаченоДнейЧасов и СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
								//	СтрокаДвижений.ОтработаноЧасов = СтрокаДвижений.ОплаченоДнейЧасов;
								//	СтрокаДвижений.ОтработаноДней =  ОКР(СтрокаДвижений.ОплаченоДнейЧасов/8);
								//КонецЕсли;
								//Аверсон 15.08.2019 КВВ СВФР-004608 (
								Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
									ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
									Если ТЗКолвоДнКом.Количество() > 0 Тогда
										Для Каждого Стр Из ТЗКолвоДнКом Цикл
											Если Стр.Дней > 0 Тогда
												СтрокаДвижений.ОтработаноДней = СтрокаДвижений.ОтработаноДней + Стр.Дней;
												СтрокаДвижений.ОтработаноЧасов = СтрокаДвижений.ОтработаноЧасов + Стр.Часов;
												ПлюсКомандДн = Стр.Дней; ПлюсКомандЧас = Стр.Часов;
												//СтрокаДвижений.НормаДней = СтрокаДвижений.НормаДней + Стр.Норма;
												Сообщить("В связи с командировкой сотрудника " + ПроцедурыУправленияПерсоналом.ФамилияИнициалыФизЛица(ИсходныеДанные.Сотрудник.ФизЛицо) + " было добавлено " + 
												
												//Аверсон ЕАЕ 03.02.2021 СВФР-007103
												//Строка(Стр.Дней)+"дн./" + Строка(Стр.Часов) + "час. в рабочее время и " +  //Строка(Стр.Норма)+"дн./" + Строка(Стр.НормаЧ) + "час."  //Аверсон 23.06.2020 КВВ СВФР-006176 (закомментировано)
												Строка(Стр.Дней)+"дн./" + Строка(Стр.Часов) + "час. в рабочее время и " + Строка(Стр.Норма)+"дн./" + Строка(Стр.НормаЧ) + "час."
												//Аверсон СВФР-007103
												
												"в норму (по строке """ + СокрЛП(СтрокаДвижений.ВидРасчета) + """).");
											КонецЕсли;
										КонецЦикла;
									КонецЕсли;
									
									//Аверсон ЕАЕ 18.01.2024 СВФР-012159
									//отнимем дни/часы оплаты по-среднему
									ТЗКолвоДнОплатаПоСреднему = ПроверитьОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
									Если ТЗКолвоДнОплатаПоСреднему.Количество() > 0 Тогда
										Для Каждого Стр Из ТЗКолвоДнОплатаПоСреднему Цикл
											Если Стр.Дней > 0 Тогда
												СтрокаДвижений.ОтработаноДней = СтрокаДвижений.ОтработаноДней - Стр.Дней;
											КонецЕсли;
											Если Стр.Часов > 0 Тогда
												СтрокаДвижений.ОтработаноЧасов = СтрокаДвижений.ОтработаноЧасов - Стр.Часов;
											КонецЕсли;
										КонецЦикла;
									КонецЕсли;
									//Аверсон СВФР-012159
									
									//Аверсон ЕАЕ 22.04.2024 СВФР-012909
									//Климовичи
									Если СтрокаДвижений.Организация.ИНН = "700103211" Тогда
										Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой 
											ИЛИ СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
											мСтрока = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(
											Новый Структура("Организация", СтрокаДвижений.Организация));
											Если мСтрока.НеРассчитыватьНачислениеЕслиПроведеноОплатаПоСреднему Тогда
												БылВременныйПеревод = ПроверитьВременныйПеревод(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
												Если БылВременныйПеревод Тогда
													БылаОплатаПоСреднемуПеревод = ПроверитьОплатуПоСреднемуВременныйПеревод(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
													Если БылаОплатаПоСреднемуПеревод Тогда
														СтрокаДвижений.ОтработаноДней = 0;
														СтрокаДвижений.ОтработаноЧасов = 0;
														СтрокаДвижений.ОплаченоДнейЧасов = 0;
														СтрокаДвижений.ОплаченоДней = 0;
														СтрокаДвижений.ОтработаноДнейПоПятидневке = 0;
														СтрокаДвижений.ОтработаноЧасовПоПятидневке = 0;
														Если СтрокаТабличнойЧасти <> Неопределено тогда
															СтрокаТабличнойЧасти.ОтработаноДней = 0;
															СтрокаТабличнойЧасти.ОтработаноЧасов = 0;
															СтрокаТабличнойЧасти.ОплаченоДнейЧасов = 0;
															СтрокаТабличнойЧасти.ОплаченоДней = 0;
															СтрокаТабличнойЧасти.ОтработаноДнейПоПятидневке = 0;
															СтрокаТабличнойЧасти.ОтработаноЧасовПоПятидневке = 0;
														КонецЕсли;
													КонецЕсли;
												КонецЕсли;
											КонецЕсли;
										КонецЕсли;
									КонецЕсли;
									//Аверсон СВФР-012909
									
								КонецЕсли;
								//Аверсон 15.08.2019 КВВ СВФР-004608 )
							КонецЕсли;
						КонецЕсли;
						//
					Иначе
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + СтрокаДвижений.ВидРасчета + ": Не задан вид учета времени");
						БылоСообщениеОВидеВремени = Истина;
					КонецЕсли;
					Если ОсновныеНачисленияОрганизаций Тогда
						СтрокаДвижений.ОтработаноДнейПоПятидневке = ИсходныеДанные.ОтработаноВремениПроизводственныйГрафик * ?(СтрокаДвижений.Сторно,-1,1) + ПлюсКомандДн;
						СтрокаДвижений.ОтработаноЧасовПоПятидневке = ИсходныеДанные.ОтработаноЧасовПроизводственныйГрафик * ?(СтрокаДвижений.Сторно,-1,1) + ПлюсКомандЧас;
					КонецЕсли;	
				КонецЕсли;
				
				Если ОсновныеНачисленияОрганизаций И ИсходныеДанные.ЗачетНормыВремени Тогда
					СтрокаДвижений.НормаЧасов = 0;
					СтрокаДвижений.НормаДней = 0;
					СтрокаДвижений.НормаДнейПоПятидневке = 0;
					СтрокаДвижений.НормаЧасовПоПятидневке = 0;
					Если ИсходныеДанные.НормаОплачиваемыхЧасов = NULL Тогда
						Если Не БылоСообщениеОРабочемВремени Тогда
							ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
						КонецЕсли;
					ИначеЕсли ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням 
						Или ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
						//Островская Татьяна 28.05.2013 № 15793
						Если ИсходныеДанные.ВидРасчетаЯвляетсяПочасовымОтклонением Тогда
							СтрокаДвижений.НормаЧасов = ?(ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку"),
							
							//Аверсон ЕАЕ 10.03.2021 СВФР-007091
							//?(СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам,СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам * ?(СтрокаДвижений.Сторно,-1,1),
							?(СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам,ИсходныеДанные.НормаОплачиваемыхЧасов * ?(СтрокаДвижений.Сторно,-1,1),
							//Аверсон СВФР-007091
							
							ИсходныеДанные.ОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1)), ИсходныеДанные.ОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1));
							
						Иначе 	
							СтрокаДвижений.НормаЧасов = ?(ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку"),
							
							//Аверсон ЕАЕ 10.03.2021 СВФР-007091
							//?(СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам,СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам * ?(СтрокаДвижений.Сторно,-1,1),
							?(СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам,ИсходныеДанные.НормаОплачиваемыхЧасов * ?(СтрокаДвижений.Сторно,-1,1),
							//Аверсон СВФР-007091
							
							ИсходныеДанные.НормаОплачиваемыхЧасов * ?(СтрокаДвижений.Сторно,-1,1)), ИсходныеДанные.НормаОплачиваемыхЧасов * ?(СтрокаДвижений.Сторно,-1,1));
							
							СтрокаДвижений.НормаДней = ИсходныеДанные.НормаОплачиваемыхДней * ?(СтрокаДвижений.Сторно,-1,1);
							
							//Аверсон 24.06.2020 КВВ СВФР-006185 (
							Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияПростоевРаботниковОрганизаций") И (СтрокаДвижений.НормаЧасов=0 И СтрокаДвижений.НормаДней = 0) И ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботыНорма) Тогда
								СтрокаДвижений.НормаЧасов = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(СтрокаДвижений.ГрафикРаботыНорма, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация);
								СтрокаДвижений.НормаДней = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(СтрокаДвижений.ГрафикРаботыНорма, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация);
							КонецЕсли;
							//Аверсон 24.06.2020 КВВ СВФР-006185 )
							
							СтрокаДвижений.НормаДнейПоПятидневке = ИсходныеДанные.ПроизводственныйКалендарьПятидневкаФактическийПериодДействия * ?(СтрокаДвижений.Сторно,-1,1);
							СтрокаДвижений.НормаЧасовПоПятидневке = ИсходныеДанные.ПроизводственныйКалендарьПятидневкаЧасыФактическийПериодДействия * ?(СтрокаДвижений.Сторно,-1,1);
							//Аверсон 15.08.2019 КВВ СВФР-004608 (
							Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
								ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
								Если ТЗКолвоДнКом.Количество() > 0 Тогда
									Для Каждого Стр Из ТЗКолвоДнКом Цикл
										Если Стр.Дней > 0 Тогда
											СтрокаДвижений.НормаДней = СтрокаДвижений.НормаДней + Стр.Норма;
											СтрокаДвижений.НормаЧасов = СтрокаДвижений.НормаЧасов + Стр.НормаЧ;
											СтрокаДвижений.НормаДнейПоПятидневке = СтрокаДвижений.НормаДнейПоПятидневке + Стр.Норма;
											СтрокаДвижений.НормаЧасовПоПятидневке = СтрокаДвижений.НормаЧасовПоПятидневке + Стр.НормаЧ;
										КонецЕсли;
									КонецЦикла;
								КонецЕсли;
							КонецЕсли;
							//Аверсон 15.08.2019 КВВ СВФР-004608 )
							
							//Аверсон ЕАЕ 03.02.2021 СВФР-007090
							Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
								ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
								Если ТЗКолвоДнКом.Количество() > 0 Тогда
									ДнейКомандировки = ТЗКолвоДнКом.Итог("Дней");
									ЧасовКомандировки = ТЗКолвоДнКом.Итог("Часов");
									Если ДнейКомандировки > СтрокаДвижений.ОплаченоДней ИЛИ ЧасовКомандировки > СтрокаДвижений.ОплаченоДнейЧасов Тогда
										РазницаДней = ДнейКомандировки - СтрокаДвижений.ОплаченоДней;
										РазницаЧасов = ЧасовКомандировки - СтрокаДвижений.ОплаченоДнейЧасов;
										
										СтрокаДвижений.ОплаченоДней = СтрокаДвижений.ОплаченоДней + РазницаДней;
										СтрокаДвижений.ОплаченоДнейЧасов = СтрокаДвижений.ОплаченоДнейЧасов + РазницаЧасов;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							//Аверсон СВФР-007090
							
							//Аверсон ЕАЕ 05.05.2025 СВФР-015387
							//Виток
							Если СтрокаДвижений.Организация.ИНН = "100194961" Тогда
								Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияПростоевРаботниковОрганизаций") Тогда
									ТЗКолвоДнПростои = ПроверитьПростои(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
									Если ТЗКолвоДнПростои.Количество() > 0 Тогда
										ДнейПростои = ТЗКолвоДнПростои.Итог("Дней");
										ЧасовПростои = ТЗКолвоДнПростои.Итог("Часов");
										СтрокаДвижений.НормаДней = ДнейПростои;
										СтрокаДвижений.НормаЧасов = ЧасовПростои;
										СтрокаДвижений.НормаДнейПоПятидневке = ДнейПростои;
										СтрокаДвижений.НормаЧасовПоПятидневке = ЧасовПростои;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							//Аверсон СВФР-015387
							
						КонецЕсли;
						//Островская Татьяна 28.05.2013 № 15793
					ИначеЕсли Не БылоСообщениеОВидеВремени Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не задан вид учета времени");
					КонецЕсли;
				КонецЕсли;
				Если ГоловнаяОрганизация.Инн = "100071565" и СтрокаДвижений.Результат=0 Тогда 
					Попытка 
						Если ИсходныеДанные.РазмерСдельногоЗаработка = 0 Тогда
							СтрокаДвижений.ОплаченоДней = 0;
							СтрокаДвижений.ОплаченоДнейЧасов = 0;
							СтрокаДвижений.ОтработаноДней = 0;
							СтрокаДвижений.ОтработаноЧасов = 0;
						КонецЕсли;
					Исключение;
					КонецПопытки;
				КонецЕсли;
				// Перепишем данные из регистра в табличную часть документа
				Если СтрокаТабличнойЧасти <> Неопределено тогда
					//Аверсон-софт, Островская Татьяна 13.06.2012 
					Если ИсходныеДанные.ЗачетОтработанногоВремени и не ДополнительныеНачисленияОрганизаций Тогда
						//Аверсон-софт, Островская Татьяна 13.06.2012 
						СтрокаТабличнойЧасти.ОтработаноДней = СтрокаДвижений.ОтработаноДней;
						//толик обновим оплату по дням ручного ввода
						Если ЗначениеЗаполнено(СтрокаДвижений.ОтработаноЧасов) Тогда
							СтрокаТабличнойЧасти.ОтработаноЧасов = СтрокаДвижений.ОтработаноЧасов;
						Иначе
							СтрокаДвижений.ОтработаноЧасов = СтрокаТабличнойЧасти.ОплаченоДнейЧасов;
							СтрокаТабличнойЧасти.ОтработаноЧасов = СтрокаТабличнойЧасти.ОплаченоДнейЧасов;
						КонецЕсли;
						//Аверсон-софт, Островская Татьяна 17.04.2013 №16410
						Попытка
							СтрокаТабличнойЧасти.ОплаченоДней = СтрокаДвижений.ОтработаноДней;
						Исключение
						КонецПопытки;
						//Аверсон-софт, Островская Татьяна 17.04.2013 №16410
						//
						Если ОсновныеНачисленияОрганизаций Тогда
							СтрокаТабличнойЧасти.ОтработаноДнейПоПятидневке = СтрокаДвижений.ОтработаноДнейПоПятидневке;
							СтрокаТабличнойЧасти.ОтработаноЧасовПоПятидневке = СтрокаДвижений.ОтработаноЧасовПоПятидневке;
						КонецЕсли;
					Иначе
						Если не ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЕдиновременныхПособийЗаСчетФСС") Тогда //О.Т. Аверсон 29.05.2018 № 2013 
							СтрокаТабличнойЧасти.ОтработаноДней = 0;
							СтрокаТабличнойЧасти.ОтработаноЧасов = 0;
							Если ОсновныеНачисленияОрганизаций Тогда
								СтрокаТабличнойЧасти.ОтработаноДнейПоПятидневке = 0;
								СтрокаТабличнойЧасти.ОтработаноЧасовПоПятидневке = 0;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					Если не ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЕдиновременныхПособийЗаСчетФСС") Тогда //О.Т. Аверсон 29.05.2018 № 2013
						Если ОсновныеНачисленияОрганизаций Тогда 
							Если ИсходныеДанные.ЗачетНормыВремени Тогда
								СтрокаТабличнойЧасти.НормаДней = СтрокаДвижений.НормаДней;
								СтрокаТабличнойЧасти.НормаЧасов = СтрокаДвижений.НормаЧасов;
								СтрокаТабличнойЧасти.НормаДнейПоПятидневке = СтрокаДвижений.НормаДнейПоПятидневке;
								СтрокаТабличнойЧасти.НормаЧасовПоПятидневке = СтрокаДвижений.НормаЧасовПоПятидневке;
							Иначе
								СтрокаТабличнойЧасти.НормаДней = 0;
								СтрокаТабличнойЧасти.НормаЧасов = 0;
								СтрокаТабличнойЧасти.НормаДнейПоПятидневке = 0;
								СтрокаТабличнойЧасти.НормаЧасовПоПятидневке = 0;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					//О.Т. 05.02.2015 № 330
					ЧасовПоСделке = 0;
					ДнейПоСделке = 0;
					СпособРасчета = СтрокаДвижений.ВидРасчета.СпособРасчета;
					если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке или
						СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке или
						СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням или
						СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам Тогда
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноЧасов) КАК ЧасовПоСделке,
						|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноДней) КАК ДнейПоСделке
						|ИЗ
						|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
						|ГДЕ
						|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ПовременнаяОплатаПриСделке
						//Аверсон 25.05.2020 КВВ СВФР-006030 (
						
						//Аверсон ЕАЕ 30.06.2025 СВФР-015776
						//Гроднооблгаз
						//|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
						//|И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(&ПериодРегистрации,ДЕНЬ)
						//|И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(&ПериодРегистрации1,ДЕНЬ)
						|И ВЫБОР
						|  КОГДА (ОсновныеНачисленияРаботниковОрганизаций.Организация.ИНН = ""500036445"" ИЛИ
						|  		ОсновныеНачисленияРаботниковОрганизаций.Организация.ИНН = ""500826909"") И
						|   	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке)
						|  ТОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
						|  ИНАЧЕ НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(&ПериодРегистрации,ДЕНЬ) И 
						|  	НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(&ПериодРегистрации1,ДЕНЬ)	
						|  КОНЕЦ
						//Аверсон СВФР-015776
						
						//Аверсон 25.05.2020 КВВ СВФР-006030 )
						|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация";
						Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
						//Аверсон 25.05.2020 КВВ СВФР-006030 (
						//Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
						//Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
						Запрос.УстановитьПараметр("ПериодРегистрации", СтрокаДвижений.ПериодДействияНачало);
						Запрос.УстановитьПараметр("ПериодРегистрации1", СтрокаДвижений.ПериодДействияКонец);
						//Аверсон 25.05.2020 КВВ СВФР-006030 )
						Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
						
						РезультатЗапроса = Запрос.Выполнить();
						
						ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
						
						Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
							ОтработаноДнейПоСделке = ?(ВыборкаДетальныеЗаписи.ДнейПоСделке = NULL,0,ВыборкаДетальныеЗаписи.ДнейПоСделке);
							ОтработаноЧасовПоСделке = ?(ВыборкаДетальныеЗаписи.ЧасовПоСделке = NULL,0,ВыборкаДетальныеЗаписи.ЧасовПоСделке);
						КонецЦикла;  
						СтрокаТабличнойЧасти.ОтработаноДней = СтрокаТабличнойЧасти.ОтработаноДней - ОтработаноДнейПоСделке;
						СтрокаТабличнойЧасти.ОтработаноЧасов = СтрокаТабличнойЧасти.ОтработаноЧасов - ОтработаноЧасовПоСделке;
						
						//Аверсон 13.12.2022 КВВ СВФР-010004 (
						СтрокаТабличнойЧасти.ОтработаноДней = ?(СтрокаТабличнойЧасти.ОтработаноДней<0,0,СтрокаТабличнойЧасти.ОтработаноДней);
						СтрокаТабличнойЧасти.ОтработаноЧасов = ?(СтрокаТабличнойЧасти.ОтработаноЧасов<0,0,СтрокаТабличнойЧасти.ОтработаноЧасов);
						//Аверсон 13.12.2022 КВВ СВФР-010004 )
						
						//Аверсон ЕАЕ 01.07.2025 СВФР-015776
						//Гроднооблгаз
						Если СтрокаДвижений.Организация.ИНН = "500036445" ИЛИ СтрокаДвижений.Организация.ИНН = "500826909" Тогда
							Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке Тогда
								СтрокаТабличнойЧасти.ОплаченоДней = СтрокаТабличнойЧасти.ОплаченоДней - ОтработаноДнейПоСделке;
								СтрокаТабличнойЧасти.ОплаченоДней = ?(СтрокаТабличнойЧасти.ОплаченоДней < 0,0,СтрокаТабличнойЧасти.ОплаченоДней);
							КонецЕсли;
						КонецЕсли;
						//Аверсон СВФР-015776
						
					КонецЕсли;
					
					//О.Т. 06.02.2015 № 330
					
				КонецЕсли;
			КонецЕсли;
		КонецЕсли; 	
		#Если Клиент Тогда
			ОбработкаПрерыванияПользователя();
		#КонецЕсли       
	КонецЦикла;
	
КонецПроцедуры // РассчитатьЗаписиНабора

//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
////+ СВЭЙ КДЯ 03.12.19 СВФР-005155
//Функция УточнитьВЦеломЗаПериод( Знач ВЦеломЗаПериод, СтрокаДвижений, Регистратор = Неопределено  )
//	Если НЕ ВЦеломЗаПериод Тогда
//		Возврат ВЦеломЗаПериод;	
//	КонецЕсли;
//	
//	МенеджерЗаписи = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.СоздатьМенеджерЗаписи();
//	МенеджерЗаписи.Организация = СтрокаДвижений.Организация;
//	МенеджерЗаписи.Прочитать();
//	ОтработанноеВремяТолькоПоТабелю	= Ложь;
//	Если МенеджерЗаписи.Выбран() Тогда
//		ОтработанноеВремяТолькоПоТабелю	= 
//			МенеджерЗаписи.ОтработанноеВремяТолькоПоТабелю;
//	КонецЕсли; 
//			
//	ЭтоРегистраторТабеля = Ложь;
//	Если ОтработанноеВремяТолькоПоТабелю Тогда
//		
//		//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
//		Если Регистратор = Неопределено Тогда
//			Регистратор	= СтрокаДвижений.Регистратор;
//		КонецЕсли;
//		//- СВЭЙ КДЯ 05.12.19 СВФР-005178
//		
//		ТипРегистраторыТабеля = Метаданные.РегистрыНакопления.РабочееВремяРаботниковОрганизаций.СтандартныеРеквизиты.Регистратор.Тип;
//		ЭтоРегистраторТабеля = ТипРегистраторыТабеля.СодержитТип( ТипЗнч( Регистратор ) );
//	
//	КонецЕсли; 
//	ВЦеломЗаПериод = НЕ ОтработанноеВремяТолькоПоТабелю ИЛИ ЭтоРегистраторТабеля;		
//	Возврат ВЦеломЗаПериод;	
//КонецФункции // УточнитьВЦеломЗаПериод
////- СВЭЙ КДЯ 03.12.19 СВФР-005155
//- СВЭЙ КДЯ 05.12.19 СВФР-005178

//+ СВЭЙ КДЯ 03.12.19 СВФР-005157
Процедура ОтобразитьОплачиваемоеВремяВДокументе( СтрокаДвижений, ИсходныеДанные )
	Если ОтображатьОплачиваемоеВремяВДокументе( СтрокаДвижений ) Тогда
		
		СтрокаДвижений.ОплаченоДней = ИсходныеДанные.ОтработаноДней;	
		СтрокаДвижений.ОплаченоДнейЧасов = ИсходныеДанные.ОтработаноЧасов;	
		
	КонецЕсли;
КонецПроцедуры

Функция ОтображатьОплачиваемоеВремяВДокументе( СтрокаДвижений )
	
	Если НЕ ТипЗнч( СтрокаДвижений.ВидРасчета ) = Тип( "ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций" ) 
		ИЛИ  НЕ ЗначениеЗаполнено( СтрокаДвижений.ВидРасчета ) Тогда
		Возврат Ложь;
	КонецЕсли; 
	
	Возврат СтрокаДвижений.ВидРасчета.ОтображатьОплачиваемоеВремяВДокументах;	
	
КонецФункции // ОтображатьОплачиваемоеВремяВДокументе()
//- СВЭЙ КДЯ 03.12.19 СВФР-005157

//+ СВЭЙ КДЯ 06.02.20 СВФР-005414
Функция ПолучитьПроцентПоШкалеСтажа( СтрокаДвижений, ПолныеГодыПоШкале = Неопределено, РассчитыватьПолныеГодыОтДатыПриема = Ложь) Экспорт //Аверсон ЕАЕ 16.05.2024 СВФР-012983
	
	Если НЕ ЗначениеЗаполнено( СтрокаДвижений.ВидРасчета ) 
		ИЛИ НЕ ЗначениеЗаполнено( СтрокаДвижений.ВидРасчета.КоэффициентСтажа ) Тогда
		
		Возврат 0;	
		
	КонецЕсли;
	
	//+ СВЭЙ КДЯ 27.02.20 СВФР-005548
	Если ПолныеГодыПоШкале = Неопределено Тогда
		ПолныеГодыПоШкале = ПолучитьПолныеГодыПоШкале( СтрокаДвижений );
		
		//Аверсон ЕАЕ 16.05.2024 СВФР-012983
		Если ПолныеГодыПоШкале = 0 И РассчитыватьПолныеГодыОтДатыПриема Тогда
			ПолныеГодыПоШкале = ПолучитьПолныеГодыОтДатыПриема(СтрокаДвижений);
		КонецЕсли;
		//Аверсон СВФР-012983
	КонецЕсли; 
	//- СВЭЙ КДЯ 27.02.20 СВФР-005548
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ШкалаКоэффициентовСтажа.Величина КАК ПроцентПоШкалеСтажа
	|ИЗ
	|	РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаКоэффициентовСтажа
	|ГДЕ
	|	ШкалаКоэффициентовСтажа.КоэффициентСтажа = &КоэффициентСтажа
	|	И ШкалаКоэффициентовСтажа.СтажС <= &Стаж
	//СВЭЙ 29.04.2020 ПНА СВФР-005891 (
	//|	И ШкалаКоэффициентовСтажа.СтажПо >= &Стаж";
	|	И ШкалаКоэффициентовСтажа.СтажПо > &Стаж"; 
	//СВЭЙ 29.04.2020 ПНА СВФР-005891 )
	
	Запрос.УстановитьПараметр("КоэффициентСтажа", СтрокаДвижений.ВидРасчета.КоэффициентСтажа);
	Запрос.УстановитьПараметр("Стаж", ПолныеГодыПоШкале);
	
	РезультатЗапроса = Запрос.Выполнить();
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	ПроцентПоШкалеСтажа = 0;
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ПроцентПоШкалеСтажа = ВыборкаДетальныеЗаписи.ПроцентПоШкалеСтажа;	
	КонецЦикла;
	Возврат ПроцентПоШкалеСтажа;
	
КонецФункции // ПолучитьПроцентПоШкалеСтажа()
//- СВЭЙ КДЯ 06.02.20 СВФР-005414

//+ СВЭЙ КДЯ 27.02.20 СВФР-005548
Функция ПолучитьПолныеГодыПоШкале( СтрокаДвижений ) Экспорт
	
	ПолныеГодыПоШкале = 0;
	ЗапросШкала = Новый Запрос;
	ЗапросШкала.Текст = 
	"ВЫБРАТЬ
	//Аверсон 24.01.2023 КВВ СВФР-010220 (
	////СВЭЙ 07.05.2020 ПНА СВФР-005891 (
	////|	РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней), &ДатаСравнения, ГОД) КАК СтажМесяцев
	//|	РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней), &ДатаСравнения, МЕСЯЦ) КАК СтажМесяцев
	////СВЭЙ 07.05.2020 ПНА СВФР-005891 )
	|	РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней), &ДатаСравнения, МЕСЯЦ) + ВЫБОР
	|		КОГДА МЕСЯЦ(&ДатаСравнения) = МЕСЯЦ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней))
	|			ТОГДА (ДЕНЬ(&ДатаСравнения) - ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней))) / 30
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СтажМесяцев
	//Аверсон 24.01.2023 КВВ СВФР-010220 )
	
	|ИЗ
	|	Справочник.ФизическиеЛица.Стажи КАК ФизическиеЛицаСтажи
	|ГДЕ
	|	ФизическиеЛицаСтажи.Ссылка = &ФизЛицо
	|	И ФизическиеЛицаСтажи.ВидСтажа = &ВидСтажа";
	ЗапросШкала.УстановитьПараметр( "ВидСтажа", СтрокаДвижений.ВидРасчета.ВидСтажа );
	ЗапросШкала.УстановитьПараметр( "ФизЛицо",  СтрокаДвижений.Сотрудник.ФизЛицо );
	Если Найти( ТипЗнч(СтрокаДвижений), " табличная часть строка" ) > 0 Тогда
		ДатаСравнения = СтрокаДвижений.ДатаНачала;
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005414
	ИначеЕсли Найти( ТипЗнч(СтрокаДвижений), "Выборка из результата запроса" ) > 0 Тогда
		ДатаСравнения = СтрокаДвижений.Период;
		//- СВЭЙ КДЯ 18.03.20 СВФР-005414
		
	//Аверсон ЕАЕ 16.05.2024 СВФР-012983
	ИначеЕсли Найти(ТипЗнч(СтрокаДвижений),"Структура") > 0 Тогда
		ДатаСравнения = СтрокаДвижений.ДатаСравнения;
	//Аверсон СВФР-012983
	Иначе	
		ДатаСравнения = СтрокаДвижений.ПериодРегистрации;
	КонецЕсли; 
	ЗапросШкала.УстановитьПараметр( "ДатаСравнения", ДатаСравнения );
	//СВЭЙ 07.05.2020 ПНА СВФР-005891 (	
	//ПолныеГодыПоШкале = ЗапросШкала.Выполнить().Выгрузить().Итог("СтажМесяцев");
	РезультатЗапроса = ЗапросШкала.Выполнить();
	Если Не РезультатЗапроса.Пустой() Тогда
		ПолныеГодыПоШкале = РезультатЗапроса.Выгрузить().Итог("СтажМесяцев");
		ПолныеГодыПоШкале = Цел(ПолныеГодыПоШкале/12);
	КонецЕсли;
	//СВЭЙ 07.05.2020 ПНА СВФР-005891 )	
	Возврат ПолныеГодыПоШкале;
	
КонецФункции // ПолучитьПолныеГоды()
//- СВЭЙ КДЯ 27.02.20 СВФР-005548

// Рассчитывает значение ресурса записи регистра расчета по ее реквизитам и дополнительным данным
//
// Параметры: 
//  СтрокаДвижений	- рассчитываемая запись регистра расчета
//  ИсходныеДанные	- выборка из результата запроса с исходными данными для расчета
//  УправленческиеРасчеты - булево, признак того, что это расчет управленческий
//  РегламентированныеНачисления - булево, признак того, что это регламентированное начисление
//  ОсновныеНачисленияОрганизаций - булево, признак того, что это именно основое регламентированное начисление
//  ДанныеДляПрогнозаНДФЛ - выборка из результата запроса с данными для прогнозирования НДФЛ
//  СведенияОДоначислениях - соответствие для хранения данных о доначислениях
//  КурсВалютыУпрУчета
//  ПовторныйРасчет - признак того, что выполняется повторный расчет (поддержка 
//              способа ДоначислениеПоУправленческомуУчету)
//
// Возвращаемое значение:
//  Нет.
//
Процедура РассчитатьЗаписьРегистраРасчета(СтрокаДвижений,
	ИсходныеДанные,
	УправленческиеРасчеты,
	РегламентированныеНачисления,
	РегламентированныеУдержания,
	ОсновныеНачисленияОрганизаций,
	ДополнительныеНачисленияОрганизаций,
	ДанныеДляПрогнозаНДФЛ,
	СведенияОДоначислениях,
	КурсВалютыУпрУчета,
	ПовторныйРасчет,
	КомментироватьРасчет, ФормаКомментариев, ГрафикиБезРабочегоВремени,РезультатДляОграничения = 0,НаборЗаписейРасчетСреднего = Неопределено,СторнируемыйДок = Ложь,ТекЗначение = Неопределено,ДниДляОграничения = 0)  //Островская 16.03.2014 № ,481
	
	ПорядокОкругленияПособия = Константы.ОкруглениеПособий.Получить();//Островская Татьяна 12.03.2013 № 16313
	
	ВидРасчета = СтрокаДвижений.ВидРасчета; 
	
	//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
	Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
		ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
		
		ТипРасчетаПоОкладу = СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу;
	иначе
		ТипРасчетаПоОкладу = Ложь;
	КонецЕсли;
	//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
	
	
	//+ СВЭЙ КДЯ 24.01.20 СВФР-005407
	Если СтрокаДвижений.Регистратор.Метаданные().Реквизиты.Найти ( "Курс" ) <> Неопределено Тогда
		Курс = ?( СтрокаДвижений.Регистратор.Курс = 0, 1, СтрокаДвижений.Регистратор.Курс );
	Иначе	
		Курс = 1;
	КонецЕсли; 
	//- СВЭЙ КДЯ 24.01.20 СВФР-005407
	
	//Наркевич 26.05.2014 №
	ТочностьСреднего = Константы.ТочностьСреднегоЗаработка.Получить();
	Если ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр0 Тогда 
		ЗначениеТочностьСреднего = 0;
	ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр1 Тогда 
		ЗначениеТочностьСреднего = 1;
	ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр2 Тогда 
		ЗначениеТочностьСреднего = 2;
	ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр3 Тогда 
		ЗначениеТочностьСреднего = 3;
	ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр4 Тогда 
		ЗначениеТочностьСреднего = 4;
	иначе
		ЗначениеТочностьСреднего = 0;
	КонецЕсли;
	//Наркевич 26.05.2014 №
	//Аверсон-софт, Островская Татьяна 19.03.2012
	Запрос1 = Новый Запрос;
	Запрос1.Текст =
	
	"ВЫБРАТЬ
	|	СтрокиДокумента.Ссылка,
	|	СтрокиДокумента.НомерСтроки,
	|	СтрокиДокумента.Сотрудник КАК Сотрудник,
	|	СтрокиДокумента.Физлицо,
	|	СтрокиДокумента.ВидРасчета,
	|	НАЧАЛОПЕРИОДА(СтрокиДокумента.ДатаНачала, МЕСЯЦ) КАК ПериодДействия
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиДокумента
	|ГДЕ
	|	СтрокиДокумента.ВидРасчета = &ВидРасчета
	|	И СтрокиДокумента.Ссылка = &ДокументСсылка
	|	И СтрокиДокумента.Сотрудник = &парамФизлицо
	|	И &ДатаНачала МЕЖДУ СтрокиДокумента.ДатаНачала И СтрокиДокумента.ДатаОкончания";
	Запрос1.УстановитьПараметр("ДокументСсылка", СтрокаДвижений.Регистратор);
	//Запрос.УстановитьПараметр("ГоловнаяОрганизация",СтрокаДвижений.Организация);
	если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда  
		Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.ПериодДействияНачало);
	иначе
		Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.БазовыйПериодНачало);
	КонецЕсли;	
	Запрос1.УстановитьПараметр("парамФизлицо", СтрокаДвижений.Сотрудник);
	Запрос1.УстановитьПараметр("ВидРасчета",  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
	Выборка = Запрос1.Выполнить().Выбрать();
	Пока Выборка.Следующий() цикл
		ВидРасчета1 = Выборка.ВидРасчета;
	КонецЦикла;
	Если СтрокаДвижений.Организация.ИНН = "500036445" Тогда
		Запрос1 = Новый Запрос;
		Запрос1.Текст =
		
		"ВЫБРАТЬ
		|	СтрокиДокумента.Ссылка,
		|	СтрокиДокумента.НомерСтроки,
		|	СтрокиДокумента.Сотрудник КАК Сотрудник,
		|	СтрокиДокумента.Физлицо,
		|	СтрокиДокумента.ВидРасчета,
		|	НАЧАЛОПЕРИОДА(СтрокиДокумента.ДатаНачала, МЕСЯЦ) КАК ПериодДействия
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиДокумента
		|ГДЕ
		|	(СтрокиДокумента.ВидРасчета = &ВидРасчета
		|	или СтрокиДокумента.ВидРасчета = &ВидРасчета1)
		|	И СтрокиДокумента.Ссылка = &ДокументСсылка
		|	И СтрокиДокумента.Сотрудник = &парамФизлицо
		|	И &ДатаНачала МЕЖДУ СтрокиДокумента.ДатаНачала И СтрокиДокумента.ДатаОкончания";
		Запрос1.УстановитьПараметр("ДокументСсылка", СтрокаДвижений.Регистратор);
		//Запрос.УстановитьПараметр("ГоловнаяОрганизация",СтрокаДвижений.Организация);
		если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда  
			Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.ПериодДействияНачало);
		иначе
			Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.БазовыйПериодНачало);
		КонецЕсли;	
		Запрос1.УстановитьПараметр("парамФизлицо", СтрокаДвижений.Сотрудник);
		Запрос1.УстановитьПараметр("ВидРасчета",  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
		Запрос1.УстановитьПараметр("ВидРасчета1",  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
		Выборка = Запрос1.Выполнить().Выбрать();
		Пока Выборка.Следующий() цикл
			ВидРасчета2 = Выборка.ВидРасчета;
		КонецЦикла;
	КонецЕсли;
	//Аверсон-софт, Островская Татьяна 19.03.2012
	
	СпособРасчета = ИсходныеДанные.СпособРасчета;         
	Результат = 0;
	
	РезультатПолучен = Истина;
	
	ПоказательРазмер = "Показатель1"; 
	Если СтрокаДвижений.Организация.ИНН = "100071565" Тогда
		Если ИсходныеДанные.ВидРасчета.Код = "00034" Тогда
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредность;
			ПоказательРазмер = "Показатель3";  
		КонецЕсли;
		Запрос1 = Новый Запрос;
		Запрос1.Текст =
		
		"ВЫБРАТЬ
		|	СтрокиДокумента.Ссылка,
		|	СтрокиДокумента.НомерСтроки,
		|	СтрокиДокумента.Сотрудник КАК Сотрудник,
		|	СтрокиДокумента.Физлицо,
		|	СтрокиДокумента.ВидРасчета,
		|	НАЧАЛОПЕРИОДА(СтрокиДокумента.ДатаНачала, МЕСЯЦ) КАК ПериодДействия
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиДокумента
		|ГДЕ
		|	СтрокиДокумента.ВидРасчета В (&ВидРасчета)
		|	И СтрокиДокумента.Ссылка = &ДокументСсылка
		|	И СтрокиДокумента.Сотрудник = &парамФизлицо
		|	И &ДатаНачала МЕЖДУ СтрокиДокумента.ДатаНачала И СтрокиДокумента.ДатаОкончания";
		Запрос1.УстановитьПараметр("ДокументСсылка", СтрокаДвижений.Регистратор);
		если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда  
			Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.ПериодДействияНачало);
		иначе
			Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.БазовыйПериодНачало);
		КонецЕсли;	
		Запрос1.УстановитьПараметр("парамФизлицо", СтрокаДвижений.Сотрудник);
		МассивВидыРасч = Новый СписокЗначений;
		МассивВидыРасч.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
		МассивВидыРасч.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
		Запрос1.УстановитьПараметр("ВидРасчета",  МассивВидыРасч);
		Выборка = Запрос1.Выполнить().Выбрать();
		Пока Выборка.Следующий() цикл
			ВидРасчета1 = Выборка.ВидРасчета;
		КонецЦикла;
	КонецЕсли;
	//Аверсон-софт, Островская Татьяна 16.03.2012 
	мОтработаноЧас = 0;
	мОтработаноЧасов = 0;
	ОтработаноДнейДляПитания = 0;
	
	Запрос = Новый Запрос;
	Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда //О.Т. Аверсон 13.12.2016 № 100
		Запрос.Текст =
		"ВЫБРАТЬ
		|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
		|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|ГДЕ
		|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
		|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени3)
		|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
		|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
		|	И ВЫБОР
		|			КОГДА &ФлагПоТабелю
		|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ";
	иначе
		Запрос.Текст =
		"ВЫБРАТЬ
		|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
		|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|ГДЕ
		|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
		|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени3)
		|	И РабочееВремяРаботниковОрганизаций.Период >= &Период
		|	И РабочееВремяРаботниковОрганизаций.Период <= &Период2
		|	И ВЫБОР
		|			КОГДА &ФлагПоТабелю
		|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ";
	КонецЕсли;
	
	УчетнаяПолитикаЗапрос = Новый Запрос; //О.Т. 23.12.2014 № 
	УчетнаяПолитикаЗапрос.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
	УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
	УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
	если УчетнаяПолитика.Количество()>0 Тогда 
		Запрос.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
	иначе
		Запрос.УстановитьПараметр("ФлагПоТабелю",Ложь);
	КонецЕсли;
	
	Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
	//Островская Татьяна 23.04.2014 № 17292
	ЗапросВид = Новый Запрос;
	Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда //О.Т. Аверсон 13.12.2016 № 100
		ЗапросВид.Текст = 
		"ВЫБРАТЬ
		|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|ГДЕ
		|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И РабочееВремяРаботниковОрганизаций.Организация = &Организация
		|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период1
		|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
		|
		|СГРУППИРОВАТЬ ПО
		|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод";
	иначе
		ЗапросВид.Текст = 
		"ВЫБРАТЬ
		//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
		//|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
		//- СВЭЙ КДЯ 05.12.19 СВФР-005178
		//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
		|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
		|   И ( НЕ ISNULL( Политика.ОтработанноеВремяТолькоПоТабелю, Ложь )
		|   	ИЛИ РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации )
		|   КАК ВЦеломЗаПериод
		//- СВЭЙ КДЯ 05.12.19 СВФР-005178
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
		|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК Политика
		|   	ПО Политика.Организация = РабочееВремяРаботниковОрганизаций.Организация
		//- СВЭЙ КДЯ 05.12.19 СВФР-005178
		|ГДЕ
		|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И РабочееВремяРаботниковОрганизаций.Организация = &Организация
		|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период1
		|
		|СГРУППИРОВАТЬ ПО
		//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
		//|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
		//- СВЭЙ КДЯ 05.12.19 СВФР-005178
		//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
		|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
		|   И ( НЕ ISNULL( Политика.ОтработанноеВремяТолькоПоТабелю, Ложь )
		|   	ИЛИ РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации )
		//- СВЭЙ КДЯ 05.12.19 СВФР-005178
		|";
	КонецЕсли;
	
	ЗапросВид.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
	//если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
	//	ЗапросВид.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
	//	ЗапросВид.УстановитьПараметр("Период1", СтрокаДвижений.ПериодДействияКонец);
	//	
	//ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
	//	ЗапросВид.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
	//	ЗапросВид.УстановитьПараметр("Период1", СтрокаДвижений.БазовыйПериодКонец);
	//ИначеЕсли СторнируемыйДок Тогда //О.Т. 08.07.2015 № 481
	//	если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
	//		ЗапросВид.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
	//		ЗапросВид.УстановитьПараметр("Период1", СтрокаДвижений.ПериодДействияКонец);       			
	//	ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
	//		ЗапросВид.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
	//		ЗапросВид.УстановитьПараметр("Период1", СтрокаДвижений.БазовыйПериодКонец);
	//	иначе
	//		ЗапросВид.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
	//		ЗапросВид.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));			
	//	КонецЕсли;
	//	//О.Т. 08.07.2015 № 481
	//иначе
	
	ЗапросВид.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
	ЗапросВид.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
	//КонецЕсли; //О.Т. Аверсон 09.11.2017 № 1216 Убрала, смотреть за весь месяц значение в целом за период
	
	ЗапросВид.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);	
	Результат1 = ЗапросВид.Выполнить();	
	ВыборкаДетальныеЗаписи = Результат1.Выбрать();
	ВЦеломЗаПериод = Истина;
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ВЦеломЗаПериод = ВыборкаДетальныеЗаписи.ВЦеломЗаПериод;
	КонецЦикла;
	
	//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
	////+ СВЭЙ КДЯ 03.12.19 СВФР-005155
	//ВЦеломЗаПериод = УточнитьВЦеломЗаПериод( ВЦеломЗаПериод, СтрокаДвижений );
	////- СВЭЙ КДЯ 03.12.19 СВФР-005155
	//- СВЭЙ КДЯ 05.12.19 СВФР-005178
	
	//Островская Татьяна 28.04.2014 № 17292
	Если СтрокаДвижений.Организация.ИНН = "100765738" и ВЦеломЗаПериод Тогда
		если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
			ПериодНачало = СтрокаДвижений.ПериодДействияНачало;
			ПериодКонец = СтрокаДвижений.ПериодДействияКонец;
			
		ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
			ПериодНачало = СтрокаДвижений.БазовыйПериодНачало;
			ПериодКонец = СтрокаДвижений.БазовыйПериодКонец;
		иначе
			ПериодНачало = НачалоМесяца(СтрокаДвижений.ПериодРегистрации);
			ПериодКонец = КонецМесяца(СтрокаДвижений.ПериодРегистрации);
		КонецЕсли;
	иначе
		
		если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") и не ВЦеломЗаПериод Тогда
			ПериодНачало = СтрокаДвижений.ПериодДействияНачало;
			ПериодКонец = СтрокаДвижений.ПериодДействияКонец;
			
		ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") и не ВЦеломЗаПериод Тогда
			ПериодНачало = СтрокаДвижений.БазовыйПериодНачало;
			ПериодКонец = СтрокаДвижений.БазовыйПериодКонец;
		ИначеЕсли СторнируемыйДок Тогда //О.Т. 08.07.2015 № 481
			если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				ПериодНачало = СтрокаДвижений.ПериодДействияНачало;
				ПериодКонец = СтрокаДвижений.ПериодДействияКонец;
				
			ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
				ПериодНачало = СтрокаДвижений.БазовыйПериодНачало;
				ПериодКонец = СтрокаДвижений.БазовыйПериодКонец;
			иначе
				ПериодНачало = НачалоМесяца(СтрокаДвижений.ПериодРегистрации);
				ПериодКонец = КонецМесяца(СтрокаДвижений.ПериодРегистрации);
			КонецЕсли;
			//О.Т. 08.07.2015 № 481
		иначе
			
			ПериодНачало = НачалоМесяца(СтрокаДвижений.ПериодРегистрации);
			ПериодКонец = КонецМесяца(СтрокаДвижений.ПериодРегистрации);
		КонецЕсли;
	КонецЕсли;
	//Островская Татьяна 23.04.2014 № 17292
	Запрос.УстановитьПараметр("Период", ПериодНачало);//Островская Татьяна 23.04.2014 № 17292
	Запрос.УстановитьПараметр("Период2", ПериодКонец);
	Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
	Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени3", Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускПоУходуЗаРебенком);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() цикл
		если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
			мОтработаноЧас = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Часов,0);
			мОтработаноЧасов = ?(ЗначениеЗаполнено(Выборка.Дней),Выборка.Дней,0);
			ОтработаноДнейДляПитания = ?(ЗначениеЗаполнено(Выборка.Дней),Выборка.Дней,0);
		иначе
			мОтработаноЧас = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Часов,0);
			мОтработаноЧасов = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Часов,0);
			ОтработаноДнейДляПитания = ?(ЗначениеЗаполнено(Выборка.Дней),Выборка.Дней,0); 
		КонецЕсли;
	КонецЦикла;
	
	Если  ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДни ИЛИ 
		ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаШестидневка ИЛИ 
		ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДниБезУвольнения ИЛИ 
		ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаШестидневкаБезУвольнения ИЛИ 
		ВидРасчета = ПланыВидовРасчета.УдержанияОрганизаций.УдержаниеЗаНеотработанныйОтпускКалендарныеДни ИЛИ 
		ВидРасчета = ПланыВидовРасчета.УдержанияОрганизаций.УдержаниеЗаНеотработанныйОтпускШестидневка ИЛИ
		(ТипЗнч(ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") И 
		(СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ИЛИ
		СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке)) Тогда //О.Т. 02.09.2014 № 17565
		
	иначе
		Если ЗначениеЗаполнено(СтрокаДвижений.ДатаНачалаСобытия) Тогда 
			ТарСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ДатаНачалаСобытия, СтрокаДвижений.ГрафикРаботы, Ложь,?((СтрокаДвижений.Организация.ИНН = "500227068" ИЛИ СтрокаДвижений.Организация.ИНН = "100010315" ИЛИ СтрокаДвижений.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Организация.ИНН = "200400628" ИЛИ СтрокаДвижений.Организация.ИНН = "500826909" ИЛИ СтрокаДвижений.Организация.ИНН = "500036445"),Истина,Ложь),,,мОтработаноЧас,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,, Курс> //Островская Татьяна 15.03.2013 № 16327 //Аверсон 07.10.2019 КВВ СВФР-004830 //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
		иначе
			ТарСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, НачалоМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.ГрафикРаботы, Ложь,,,,мОтработаноЧас,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,, Курс> //Островская Татьяна 15.03.2013 № 16327
		КонецЕсли;
		
	КонецЕсли;
	//Аверсон-софт, Островская Татьяна 16.03.2012
	
	
	// предварительные действия перед расчетом для поддержки 
	// способа расчета ДоначислениеПоУправленческомуУчету
	РасчетДоначисления = Ложь;
	Если РегламентированныеНачисления и СведенияОДоначислениях <> Неопределено Тогда
		Сведение = СведенияОДоначислениях.Получить(СтрокаДвижений.Сотрудник);
		Если Сведение = Неопределено Тогда
			Сведение = Новый Структура("КВыплатеПоУпрУчету,ЕстьДоначисление,ПрогнозНДФЛ,СуммарныйПроцент,УжеНачисленоДоДоначисления");
			Сведение.КВыплатеПоУпрУчету = 0;
			Сведение.СуммарныйПроцент = 0;
			Сведение.УжеНачисленоДоДоначисления = 0;
			Сведение.ЕстьДоначисление = Ложь;
			Сведение.ПрогнозНДФЛ = Новый Соответствие();
			СведенияОДоначислениях[СтрокаДвижений.Сотрудник] = Сведение;
		КонецЕсли;
		Если ОсновныеНачисленияОрганизаций 
			И ИсходныеДанные.КодДоходаНДФЛ = Справочники.ДоходыНДФЛ.КодДоходаПоУмолчанию Тогда
			ПериодДохода = НачалоМесяца(ИсходныеДанные.ПериодДействияНачало);
		Иначе
			// здесь предполагаем, что в наборе записей не может быть записей с разными периодами регистрации
			ПериодДохода = СтрокаДвижений.ПериодРегистрации;
		КонецЕсли;
		СтрокаПрогноза = Сведение.ПрогнозНДФЛ.Получить(ПериодДохода);
		Если СтрокаПрогноза = Неопределено Тогда
			СтрокаПрогноза = СоздатьСтрокуПрогнозаНДФЛ();
			Сведение.ПрогнозНДФЛ[ПериодДохода] = СтрокаПрогноза;
		КонецЕсли;
		Если ИсходныеДанные.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету Тогда
			РасчетДоначисления = Истина;
			Если не ПовторныйРасчет Тогда
				Сведение.ЕстьДоначисление = Истина;
				
				Сведение.КВыплатеПоУпрУчету = ?(ИсходныеДанные.КВыплатеПоУпрУчету = Null, 0, ИсходныеДанные.КВыплатеПоУпрУчету) * КурсВалютыУпрУчета;
				Сведение.СуммарныйПроцент = ?(ИсходныеДанные.СуммарныйПроцент = Null, 0, ИсходныеДанные.СуммарныйПроцент);
				Сведение.УжеНачисленоДоДоначисления = ?(ИсходныеДанные.УжеНачисленоДоДоначисления = Null, 0, ИсходныеДанные.УжеНачисленоДоДоначисления);
				Физлицо = ИсходныеДанные.Физлицо;
				// запомним поле "резидентство"
				Для Каждого СтрокаДляЗаполнения Из Сведение.ПрогнозНДФЛ Цикл
					СтрокаДляЗаполнения.Значение.Резидент = ИсходныеДанные.Резидент;
				КонецЦикла;
				Если ПозиционироватьДанныеПрогнозаНДФЛ(ДанныеДляПрогнозаНДФЛ, Физлицо) Тогда
					Пока Истина Цикл
						СтрокаДляЗаполнения = Сведение.ПрогнозНДФЛ.Получить(ДанныеДляПрогнозаНДФЛ.Период);
						Если СтрокаДляЗаполнения = Неопределено Тогда
							СтрокаДляЗаполнения = СоздатьСтрокуПрогнозаНДФЛ();
							Сведение.ПрогнозНДФЛ[ДанныеДляПрогнозаНДФЛ.Период] = СтрокаДляЗаполнения;
						КонецЕсли;
						// запоним остальные поля
						ЗаполнитьСтрокуПрогнозаНДФЛ(СтрокаДляЗаполнения, ДанныеДляПрогнозаНДФЛ);
						Если не ДанныеДляПрогнозаНДФЛ.Следующий() Тогда
							Прервать;
							
						КонецЕсли;
						Если ДанныеДляПрогнозаНДФЛ.Физлицо <> Физлицо Тогда
							Прервать;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
	// расчет будем проводить только для авторассчитываемой записи
	Если СтрокаДвижений.Авторасчет Тогда
		
		//ДатаЗакона255ФЗ = ПолучитьДатуВступленияВСилуИзмененийПоСоциальнымПособиям2006();
		
		// этот Если... нужно расширять при появлении новых способов расчета или видов расчета,
		// которые не укладываются в тот или иной способ
		
		Если КомментироватьРасчет Тогда
			КомментарийВидаРасчета = ОбщегоНазначения.КомментарийРасчета("Расчет ", , ИсходныеДанные.ВидРасчетаНаименование, СтрокаДвижений.ВидРасчета);
			ОбщегоНазначения.КомментарийРасчета("Способ расчета: " + ИсходныеДанные.СпособРасчета, КомментарийВидаРасчета);
			ОбщегоНазначения.КомментарийРасчета("Порядок расчета: " + ВизуализироватьФормулуРасчета(ИсходныеДанные.ВидРасчета), КомментарийВидаРасчета);
		КонецЕсли;
		СтраховыеАгенты = Ложь;
		Если СтрокаДвижений.Организация.ИНН = "100071565" Тогда
			ОтработаноЧасовПС = 0;
			ОтработаноЧасовПС17 = 0;
			//Аверсон ЕАЕ 06.03.2022 СВФР-008826
			//Получим периоды оплаты по среднему
			
			ВидыРасчета = Новый Массив;
			ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Оплата по среднему заработку за выполнение гособязанностей"));
			ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Оплата по среднему Обязательный медосмотр"));
			ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Доплата до среднего заработка")); 
			ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Оплата по среднему заработку не отработанное"));
			ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Оплата по среднему заработку участие в мероприятиях"));
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	ОплатаПоСреднемуЗаработку.ДатаНачала,
			|	ОплатаПоСреднемуЗаработку.ДатаОкончания
			|ИЗ
			|	Документ.ОплатаПоСреднемуЗаработку КАК ОплатаПоСреднемуЗаработку
			|ГДЕ
			|	ОплатаПоСреднемуЗаработку.Проведен
			|	И НЕ ОплатаПоСреднемуЗаработку.НесколькоДней
			|	И ОплатаПоСреднемуЗаработку.Сотрудник = &Сотрудник
			|   И НЕ ОплатаПоСреднемуЗаработку.ВидРасчета В (&ВидРасчета)
			|	И ОплатаПоСреднемуЗаработку.Организация = &Организация
			|	И ОплатаПоСреднемуЗаработку.ДатаНачала МЕЖДУ &ДатаНач И &ДатаКон
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ
			|	НАЧАЛОПЕРИОДА(ОплатаПоСреднемуЗаработкуДаты.Дата, ДЕНЬ),
			|	КОНЕЦПЕРИОДА(ОплатаПоСреднемуЗаработкуДаты.Дата, ДЕНЬ)
			|ИЗ
			|	Документ.ОплатаПоСреднемуЗаработку.Даты КАК ОплатаПоСреднемуЗаработкуДаты
			|ГДЕ
			|	ОплатаПоСреднемуЗаработкуДаты.Ссылка.Проведен
			|	И ОплатаПоСреднемуЗаработкуДаты.Ссылка.НесколькоДней
			|	И НЕ ОплатаПоСреднемуЗаработкуДаты.Ссылка.ВидРасчета В (&ВидРасчета)
			|	И ОплатаПоСреднемуЗаработкуДаты.Ссылка.Сотрудник = &Сотрудник
			|	И ОплатаПоСреднемуЗаработкуДаты.Ссылка.Организация = &Организация
			|	И ОплатаПоСреднемуЗаработкуДаты.Дата МЕЖДУ &ДатаНач И &ДатаКон";
			
			Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
			Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			Запрос.УстановитьПараметр("ВидРасчета", ВидыРасчета);
			Запрос.УстановитьПараметр("ДатаНач", СтрокаДвижений.ПериодДействияНачало);
			Запрос.УстановитьПараметр("ДатаКон", СтрокаДвижений.ПериодДействияКонец);
			
			
			ТЗПериодыОплатаПоСреднему = Запрос.Выполнить().Выгрузить();
			
			//Аверсон СВФР-008826
			Если СтрокаДвижений.ВидРасчета.Код <> "00034" Тогда //для вреддности ремонд не берем
				Запрос = Новый Запрос;
				Запрос.Текст =
				"ВЫБРАТЬ
				|	РабочееВремяРаботниковОрганизаций.Часов,
				
				//Аверсон ЕАЕ 06.03.2022 СВФР-008826
				|	РабочееВремяРаботниковОрганизаций.Период
				//Аверсон СВФР-008826
				
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				//|		ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени1)
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
				|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)";
				
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
				Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.НайтиПоНаименованию("Явка (ремонт)",Истина));
				//Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени1", Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
				Выборка = Запрос.Выполнить().Выбрать();
				Пока Выборка.Следующий() цикл
					
					Если НЕ ЕстьОплатаПоСреднему(Выборка.Период, ТЗПериодыОплатаПоСреднему) Тогда //Аверсон ЕАЕ 06.03.2022 СВФР-008826
						ОтработаноЧасовПС = ОтработаноЧасовПС+Выборка.Часов;
					КонецЕсли; 				
				КонецЦикла;
			КонецЕсли;
			
			//Аверсон ЕАЕ 12.03.2022 СВФР-008826
			//исключим часы если есть явка и оплата по среднему
			Если  СтрокаДвижений.ВидРасчета.Код = "00034" Тогда
				Запрос = Новый Запрос;
				Запрос.Текст =
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ
				|	ТЗ.ДатаНачала,
				|	ТЗ.ДатаОкончания
				|ПОМЕСТИТЬ ВТТЗ
				|ИЗ &ТЗ КАК ТЗ	
				|;
				|///////////////////////////////////////////////
				|ВЫБРАТЬ
				|	РабочееВремяРаботниковОрганизаций.Часов,
				|	РабочееВремяРаботниковОрганизаций.Период
				|ИЗ ВТТЗ
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ПО РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				| или РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени1
				| или РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени2)
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ ВТТЗ.ДатаНачала И ВТТЗ.ДатаОкончания
				|		ИЛИ ВТТЗ.ДатаНачала МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
				|";
				Запрос.УстановитьПараметр("ТЗ", ТЗПериодыОплатаПоСреднему);
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Командировка);
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени1", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени2", Справочники.КлассификаторИспользованияРабочегоВремени.КомандировкаВВыходной);
				
			Иначе
				
				Запрос = Новый Запрос;
				Запрос.Текст =
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ
				|	ТЗ.ДатаНачала,
				|	ТЗ.ДатаОкончания
				|ПОМЕСТИТЬ ВТТЗ
				|ИЗ &ТЗ КАК ТЗ	
				|;
				|///////////////////////////////////////////////
				|ВЫБРАТЬ
				|	РабочееВремяРаботниковОрганизаций.Часов,
				|	РабочееВремяРаботниковОрганизаций.Период
				|ИЗ ВТТЗ
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ПО РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ ВТТЗ.ДатаНачала И ВТТЗ.ДатаОкончания
				|		ИЛИ ВТТЗ.ДатаНачала МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
				|";
				Запрос.УстановитьПараметр("ТЗ", ТЗПериодыОплатаПоСреднему);
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
			КонецЕсли;
			Выборка = Запрос.Выполнить().Выбрать();
			Пока Выборка.Следующий() цикл
				Если Выборка.Часов <> null Тогда 
					ОтработаноЧасовПС = ОтработаноЧасовПС-Выборка.Часов; 
					Если  СтрокаДвижений.ВидРасчета.Код = "00017" Тогда
						ОтработаноЧасовПС17 = ОтработаноЧасовПС17-Выборка.Часов;
					КонецЕсли;
				КонецЕсли;  		
			КонецЦикла;
			//Аверсон СВФР-008826
			
		КонецЕсли;
		Если СтрокаДвижений.Организация.ИНН = "700067572" Тогда 
			Запрос1 = Новый Запрос;
			Запрос1.Текст =
			
			"ВЫБРАТЬ
			|	СтрокиДокумента.Ссылка,
			|	СтрокиДокумента.НомерСтроки,
			|	СтрокиДокумента.Сотрудник КАК Сотрудник,
			|	СтрокиДокумента.Физлицо,
			|	СтрокиДокумента.ВидРасчета,
			|	НАЧАЛОПЕРИОДА(СтрокиДокумента.ДатаНачала, МЕСЯЦ) КАК ПериодДействия
			|ИЗ
			|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиДокумента
			|ГДЕ
			|	СтрокиДокумента.ВидРасчета В (&ВидРасчета)
			|	И СтрокиДокумента.Ссылка = &ДокументСсылка
			|	И СтрокиДокумента.Сотрудник = &парамФизлицо
			|	И &ДатаНачала МЕЖДУ СтрокиДокумента.ДатаНачала И СтрокиДокумента.ДатаОкончания";
			Запрос1.УстановитьПараметр("ДокументСсылка", СтрокаДвижений.Регистратор);
			//Запрос.УстановитьПараметр("ГоловнаяОрганизация",СтрокаДвижений.Организация);
			если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда  
				Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.ПериодДействияНачало);
			иначе
				Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.БазовыйПериодНачало);
			КонецЕсли;	
			Запрос1.УстановитьПараметр("парамФизлицо", СтрокаДвижений.Сотрудник);
			МассивВидыРасч = Новый СписокЗначений;
			МассивВидыРасч.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
			МассивВидыРасч.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
			Запрос1.УстановитьПараметр("ВидРасчета",  МассивВидыРасч);
			Выборка = Запрос1.Выполнить().Выбрать();
			Пока Выборка.Следующий() цикл
				ВидРасчета1 = Выборка.ВидРасчета;
			КонецЦикла;
			Если СокрЛП(СтрокаДвижений.ПодразделениеОрганизации) = "Транспортный цех" 
				ИЛИ (ЗначениеЗаполнено(СтрокаДвижений.ПодразделениеОрганизации.Родитель) И СокрЛП(СтрокаДвижений.ПодразделениеОрганизации.Родитель) = "Транспортный цех") Тогда //Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 1)
				ОтработаноЧасовПС = 0;
				Запрос = Новый Запрос;
				Запрос.Текст =
				"ВЫБРАТЬ
				|	РабочееВремяРаботниковОрганизаций.Часов
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				//|		ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени1)
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
				|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)";
				
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
				Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные);
				//Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени1", Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
				Выборка = Запрос.Выполнить().Выбрать();
				Пока Выборка.Следующий() цикл
					ОтработаноЧасовПС = ОтработаноЧасовПС+Выборка.Часов;
				КонецЦикла;
				
			Иначе
				ОтработаноЧасовПС = 0;
				Запрос = Новый Запрос;
				Запрос.Текст =
				"ВЫБРАТЬ
				|	РабочееВремяРаботниковОрганизаций.Часов,
				//Аверсон ЕАЕ 11.06.2021 б/н
				|   РабочееВремяРаботниковОрганизаций.Период
				//Аверсон б/н
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				
				//Аверсон ЕАЕ 11.06.2021 б/н
				//|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизацийЯвка
				//|ПО РабочееВремяРаботниковОрганизаций.Сотрудник = РабочееВремяРаботниковОрганизацийЯвка.Сотрудник
				//|	И РабочееВремяРаботниковОрганизаций.Период = РабочееВремяРаботниковОрганизацийЯвка.Период
				//|	И РабочееВремяРаботниковОрганизацийЯвка.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремениЯвка
				//Аверсон б/н 
				
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|		ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени1)
				
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
				|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
				//Аверсон ЕАЕ 11.06.2021 б/н
				//|	И РабочееВремяРаботниковОрганизацийЯвка.Сотрудник ЕСТЬ NULL
				|";
				//Аверсон б/н
				
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
				Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные);
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени1", Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
				
				//Аверсон ЕАЕ 11.06.2021 б/н
				//Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремениЯвка", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
				//Аверсон б/н
				
				Выборка = Запрос.Выполнить().Выбрать();
				Пока Выборка.Следующий() цикл
					Если ЭтоРабочийСоСдельнойОплатой(СтрокаДвижений.Сотрудник, Выборка.Период) Тогда //Аверсон ЕАЕ 11.06.2021 б/н
						ОтработаноЧасовПС = ОтработаноЧасовПС+Выборка.Часов;
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;						
		КонецЕсли;
		
		// Процентом и от стажа процентом
		//	
		Если ПолучитьСписокНачисленийПроцентом().Найти(СпособРасчета) <> НеОпределено Тогда
			Если СтрокаДвижений.Организация.ИНН = "806000046" Тогда
				ЗапросКатегория = Новый Запрос;
				ЗапросКатегория.Текст = 
				"ВЫБРАТЬ
				|	РаботникиОрганизацийСрезПоследних.Категория,
				|	РаботникиОрганизацийСрезПоследних.Должность.Категория как КатегорияДолжность
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Дата, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних";
				
				ЗапросКатегория.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
				ЗапросКатегория.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				
				РезЗапросаКатегория = ЗапросКатегория.Выполнить().Выбрать();
				КатегорияРаботника = Справочники.КатегорииРаботников.ПустаяСсылка();
				Пока РезЗапросаКатегория.Следующий() Цикл
					КатегорияРаботника = РезЗапросаКатегория.Категория;
					Если не ЗначениеЗаполнено(КатегорияРаботника) Тогда 
						КатегорияРаботника = РезЗапросаКатегория.КатегорияДолжность;
					КонецЕсли;
				КонецЦикла;
				Если КатегорияРаботника.Наименование = "Страховые агенты" Тогда 
					СтраховыеАгенты = Истина;
					Запрос = Новый Запрос;
					Запрос.Текст =
					"ВЫБРАТЬ
					|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
					|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
					|ИЗ
					|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
					|ГДЕ
					|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
					|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
					|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период2
					|	И ВЫБОР
					|			КОГДА &ФлагПоТабелю
					|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
					|			ИНАЧЕ ИСТИНА
					|		КОНЕЦ";   
					Запрос.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации-1));
					Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации-1));
					Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
					УчетнаяПолитикаЗапрос = Новый Запрос;
					УчетнаяПолитикаЗапрос.Текст = 
					"ВЫБРАТЬ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
					|ИЗ
					|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
					|ГДЕ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
					УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
					УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
					если УчетнаяПолитика.Количество()>0 Тогда 
						Запрос.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
					иначе
						Запрос.УстановитьПараметр("ФлагПоТабелю",Ложь);
					КонецЕсли;
					
					Выборка = Запрос.Выполнить().Выбрать();
					
					Пока Выборка.Следующий() цикл 						
						Часы = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Дней,0);
						мЧасы = ?(ЗначениеЗаполнено(Выборка.Дней),Выборка.Дней,0);
					КонецЦикла;
					
					ТарСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, НачалоМесяца(СтрокаДвижений.ПериодРегистрации-1), СтрокаДвижений.ГрафикРаботы,Истина,,,,,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,, Курс>
				КонецЕсли;
			КонецЕсли;
			
			
			
			// Размер - процент доплаты
			Если ИсходныеДанные.РезультатБаза = NULL  Тогда  //Островская 16.03.2014 №
				если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы Тогда 
					
					//Аверсон 22.06.2020 КВВ СВФР-006176 (
					Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
						ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
						Если ТЗКолвоДнКом.Количество() > 0 Тогда
							Для Каждого Стр Из ТЗКолвоДнКом Цикл
								Если Стр.Дней > 0 Тогда
									мОтработаноЧасов = мОтработаноЧасов + Стр.Часов;
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
						Если СтрокаДвижений.Организация.СниматьОтработанныеЧасыВЗарплате Тогда
							ТЗКолвоДнОплатаПоСреднему = ПроверитьОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
							Если ТЗКолвоДнОплатаПоСреднему.Количество() > 0 Тогда
								Для Каждого Стр Из ТЗКолвоДнОплатаПоСреднему Цикл
									//Если Стр.Дней > 0 Тогда
									//	СтрокаДвижений.ОтработаноДней = СтрокаДвижений.ОтработаноДней - Стр.Дней;
									//КонецЕсли;
									Если Стр.Часов > 0 Тогда
										мОтработаноЧасов = мОтработаноЧасов - Стр.Часов;
									КонецЕсли;
								КонецЦикла;
							КонецЕсли;
						КонецЕсли; 
					КонецЕсли;
					//Аверсон 22.06.2020 КВВ СВФР-006176 )
					Если  СтрокаДвижений.Организация.ИНН = "700067572" Тогда
						мОтработаноЧасов = мОтработаноЧасов +  ОтработаноЧасовПС;
					КонецЕсли;
					Если  СтрокаДвижений.Организация.ИНН = "100071565" Тогда
						мОтработаноЧасов = мОтработаноЧасов +  ОтработаноЧасовПС;
					КонецЕсли;
					
					если ЗначениеЗаполнено(мОтработаноЧасов) Тогда //Аверсон 07.10.2019 КВВ СВФР-004830   (СтрокаДвижений.Организация.ИНН = "500052918" ИЛИ СтрокаДвижений.Организация.ИНН = "100010315") и для всех
						Если СтрокаДвижений.Организация.МПОтпуск Тогда
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте((Окр(ТарСтавка * СтрокаДвижений[ПоказательРазмер]/100,2))* мОтработаноЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
						Иначе
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ТарСтавка * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
						КонецЕсли;
					иначе
						Результат = 0;
					КонецЕсли;
				ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом Тогда 
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ТарСтавка * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());	
					
					//Аверсон ЕАЕ 12.02.2024 СВФР-012254
					//Климовичи (доплата за стаж)
					Если СтрокаДвижений.Организация.ИНН = "700103211" Тогда
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
							
							ОбнулятьРезультат = Ложь;
							
							мСтрока = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(
							Новый Структура("Организация", СтрокаДвижений.Организация));
							Если мСтрока.НеРассчитыватьНачислениеЕслиПроведеноОплатаПоСреднему Тогда
								БылВременныйПеревод = ПроверитьВременныйПеревод(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
								Если БылВременныйПеревод Тогда
									БылаОплатаПоСреднемуПеревод = ПроверитьОплатуПоСреднемуВременныйПеревод(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
									Если БылаОплатаПоСреднемуПеревод Тогда
										ОбнулятьРезультат = Истина;	
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							Если ОбнулятьРезультат Тогда
								Результат = 0;
							Иначе
								РемонтЧасов = РемонтЧасов(СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
								//Если БылРемонт(СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец, РемонтЧасов) Тогда
								ЧТС = ПолучитьЧТС(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало);
								//КонецЕсли;
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ЧТС * (мОтработаноЧасов + РемонтЧасов)) * СтрокаДвижений[ПоказательРазмер] / 100, Константы.ВалютаРегламентированногоУчета.Получить());
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					//Аверсон СВФР-012254
				иначе
					
					//Аверсон ЕАЕ 11.08.2025 СВФР-016381
					Если //ДополнительныеНачисленияОрганизаций = Истина И //Аверсон ЕАЕ 21.10.2025 СВФР-017026
						СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом И 
						СокрЛП(СтрокаДвижений.ВидРасчета.КатегорияНачисления) = "Зависимое третьего уровня" И СтрокаДвижений.ВидРасчета.ППСНаРуки = Истина Тогда
						
						//Рассчитать базу
						ТЗСводныйТабель = Новый ТаблицаЗначений;
						ТЗСводныйТабель.Колонки.Добавить("ФизЛицо");
						СписокСотрудников = Новый Массив;
						СписокСотрудников.Добавить(СтрокаДвижений.Сотрудник);
						СписокФизЛиц = Новый Массив;
						СписокФизЛиц.Добавить(СтрокаДвижений.ФизЛицо);
						
						//Аверсон ЕАЕ 21.10.2025 СВФР-017026
						Если ОсновныеНачисленияОрганизаций = Истина Тогда
							Нач = СтрокаДвижений.ПериодДействияНачало;
							Кон = СтрокаДвижений.ПериодДействияКонец; 
						Иначе 
							Нач = СтрокаДвижений.БазовыйПериодНачало;
							Кон = СтрокаДвижений.БазовыйПериодКонец;
						КонецЕсли;
						
						//ТЗОтработанноеВремя = ПолучитьОтработанноеВремяДляРасчетаППС(СтрокаДвижений.Организация,СтрокаДвижений.ПериодРегистрации,СписокСотрудников,ТЗСводныйТабель,Истина,
						//                                                             СтрокаДвижений.БазовыйПериодНачало, СтрокаДвижений.БазовыйПериодКонец); 
						//ТЗТаблицаЗаработка = СформироватьТаблицуЗаработка(СписокФизЛиц, Истина, СтрокаДвижений.Организация, НачалоМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.ПодразделениеОрганизации, 
						//					 							  ТЗОтработанноеВремя, СтрокаДвижений.Регистратор, СтрокаДвижений.БазовыйПериодНачало, СтрокаДвижений.БазовыйПериодКонец);
						ТЗОтработанноеВремя = ПолучитьОтработанноеВремяДляРасчетаППС(СтрокаДвижений.Организация,СтрокаДвижений.ПериодРегистрации,СписокСотрудников,ТЗСводныйТабель,Истина,
						                                                             Нач, Кон); 
						ТЗТаблицаЗаработка = СформироватьТаблицуЗаработка(СписокФизЛиц, Истина, СтрокаДвижений.Организация, НачалоМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.ПодразделениеОрганизации, 
											 							  ТЗОтработанноеВремя, СтрокаДвижений.Регистратор, Нач, Кон);
						//Аверсон СВФР-017026
						
						НужнаяСтр = ТЗТаблицаЗаработка.Найти(СтрокаДвижений.ФизЛицо, "ФизЛицо");
						Если НужнаяСтр = Неопределено Тогда
							БазаНачислено = 0;
						Иначе
							БазаНачислено = НужнаяСтр.Результат;
						КонецЕсли;
						
						//Сравнить ее с ограничением
						ВидНалогообложенияОрг = СтрокаДвижений.Организация.ОсновнаяСтавкаНалогообложения;
						ВидНалогообложенияСотр = СтрокаДвижений.Сотрудник.ВидНалогообложенияОсновной;
						Если ВидНалогообложенияСотр = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
							ВидНалогообложения = ВидНалогообложенияОрг;
						иначе
							ВидНалогообложения = ВидНалогообложенияСотр;
						КонецЕсли;
						
						РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации - 86400,
						Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
						СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
						СтрокаДвижений.Организация, Перечисления.ВидыОтчисленийСФОТиЗП.ППС, ВидНалогообложения));
						БазаОграничение = СтруктураПенс.ОграничениеПоДоходам * РазмерСреднейЗарплаты;
						
						БазаРезультат = Мин(БазаОграничение, БазаНачислено);
						
						//Рассчитать результат
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(БазаРезультат * СтрокаДвижений[ПоказательРазмер] / 100, Константы.ВалютаРегламентированногоУчета.Получить());
					Иначе
					//Аверсон СВФР-016381
						
						Если СтрокаДвижений.Организация.ИНН = "806000046" и КатегорияРаботника.Наименование = "Страховые агенты"  Тогда  						
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ТарСтавка * мЧасы)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
						ИначеЕсли ВидРасчета <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.РайонныйКоэффициент И СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка Тогда // оставляем поведение ред.2.1
							ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления ");
						КонецЕсли;
						
					КонецЕсли;
				КонецЕсли;
				ОтобразитьОплачиваемоеВремяВДокументе( СтрокаДвижений, ИсходныеДанные ); //+ СВЭЙ КДЯ 03.12.19 СВФР-005157
			ИначеЕсли СтрокаДвижений.Организация.ИНН = "700067572"  и ВидРасчета1 =  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам и СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы  Тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза )* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());   //+ ТарСтавка * мОтработаноЧасов
			ИначеЕсли СтрокаДвижений.Организация.ИНН = "100071565" и СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы  Тогда
				Если ВидРасчета1 =  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза )* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());   
				Иначе
					Если СтрокаДвижений.ВидРасчета.Код = "00017" Тогда
						ЗапросПлановые = Новый Запрос;
						ЗапросПлановые.Текст = 
						"ВЫБРАТЬ
						|	НачисленияРаботниковОрганизации.Показатель1
						|ИЗ
						|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
						|			&парамНачало,
						|			ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
						|				И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
						|ГДЕ
						|	ВЫБОР
						|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
						|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						|				ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
						|			ИНАЧЕ НачисленияРаботниковОрганизации.Действие
						|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
						|	И ВЫБОР
						|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
						|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						|				ТОГДА ВЫБОР
						|						КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
						|							ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
						|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
						|					КОНЕЦ
						|			ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
						|		КОНЕЦ В (&ВидыРасчетаПовышения)";
						ЗапросПлановые.УстановитьПараметр("парамНачало", ИсходныеДанные.ПериодДействияНачало);
						ЗапросПлановые.УстановитьПараметр("Сотрудник", ИсходныеДанные.Сотрудник);
						ВидыПовышений = Новый СписокЗначений;
						Для Каждого стр из Справочники.ГруппыРасчетов.ПовышениеДляНочных.Основные Цикл 
							ВидыПовышений.Добавить(стр.ВидРасчета);
						КонецЦикла;
						ЗапросПлановые.УстановитьПараметр("ВидыРасчетаПовышения", ВидыПовышений);
						РезультатЗапроса = ЗапросПлановые.Выполнить().Выбрать();
						ПроцентыПовышений = 0;
						пока РезультатЗапроса.Следующий() Цикл 
							ПроцентыПовышений = ПроцентыПовышений + РезультатЗапроса.Показатель1;
						КонецЦикла;  
						
						//СВЭЙ 22.02.2024 КВВ СВФР-012096 (
						Если Справочники.ГруппыРасчетов.ПовышениеДляНочных.РасчетПоСуммам Тогда
							Если ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботы) Тогда 
								ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
								Новый Структура("Организация,ВидПараметра,Категория,ГрафикРаботы", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка(),СтрокаДвижений.ГрафикРаботы));
								Если ЧасовВГоду.Размер = 0 Тогда 
									ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
									Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка()));
								КонецЕсли;
							Иначе                        		
								ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
								Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка()));
							КонецЕсли;
							Если ЧасовВГоду.Размер <> 0 Тогда
								Если СокрЛП(СтрокаДвижений.Категория) <> "Рабочие" Тогда
									ПроцентыПовышений = ПроцентыПовышений/ЧасовВГоду.Размер;
								КонецЕсли; 								
							КонецЕсли;
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте((((мОтработаноЧасов+ОтработаноЧасовПС17))*ПроцентыПовышений ),Константы.ВалютаРегламентированногоУчета.Получить());   
						Иначе
							//СВЭЙ 22.02.2024 КВВ СВФР-012096 )
							
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(((ТарСтавка *(мОтработаноЧасов+ОтработаноЧасовПС17))*(100+ПроцентыПовышений)/100 )* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());   
						КонецЕсли;
					Иначе
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(((ТарСтавка * (мОтработаноЧасов+ОтработаноЧасовПС))+ИсходныеДанные.РезультатБаза )* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());   
					КонецЕсли;
				КонецЕсли;
			Иначе   				
				Если КомментироватьРасчет Тогда
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					РасшифровкаБазы = ИсходныеДанные.Выбрать();
					Если Не РегламентированныеУдержания Тогда
						Пока РасшифровкаБазы.Следующий() Цикл
							Если РасшифровкаБазы.РезультатБаза <> 0 Тогда
								ОбщегоНазначения.КомментарийРасчета(РасшифровкаБазы.ВидРасчетаРазрезНаименование + ": " + РасшифровкаБазы.РезультатБаза, КомментарийБазы);
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
				КонецЕсли;
				
				Если РегламентированныеУдержания Тогда
					УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
					
					//Аверсон 08.06.2020 КВВ СВФР-006109 (
					Если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.УдержанияОрганизаций") И СтрокаДвижений.ВидРасчета.ЭтоПрофВзносы
						И УжеНачисленоВТекущемПериоде = 0 
						И НЕ(НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало) < НачалоМесяца(СтрокаДвижений.ПериодРегистрации)) Тогда //Аверсон 24.06.2020 КВВ СВФР-006192
						Запрос = Новый Запрос;
						Запрос.Текст = "ВЫБРАТЬ 
						|СУММА(УдержанияРаботниковОрганизаций.Результат) КАК ПрофСоюзРанееВТекПериоде
						|ИЗ РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизаций
						|ГДЕ УдержанияРаботниковОрганизаций.Регистратор <> &Регистратор
						|И УдержанияРаботниковОрганизаций.ВидРасчета = &ВидРасчета
						|И УдержанияРаботниковОрганизаций.ФизЛицо = &ФизЛицо
						|И НАЧАЛОПЕРИОДА(УдержанияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = &БазПериодНач";
						Запрос.УстановитьПараметр("Регистратор", СтрокаДвижений.Регистратор);
						Запрос.УстановитьПараметр("БазПериодНач", НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало));
						Запрос.УстановитьПараметр("ВидРасчета", СтрокаДвижений.ВидРасчета);
						Запрос.УстановитьПараметр("ФизЛицо", СтрокаДвижений.ФизЛицо);
						РезЗ = Запрос.Выполнить().Выбрать();
						Если РезЗ.Следующий() И РезЗ.ПрофСоюзРанееВТекПериоде <> Null И РезЗ.ПрофСоюзРанееВТекПериоде <> 0 Тогда
							УжеНачисленоВТекущемПериоде = РезЗ.ПрофСоюзРанееВТекПериоде;
						КонецЕсли;
					КонецЕсли;
					//Аверсон 08.06.2020 КВВ СВФР-006109 )
					
					//Аверсон-софт, Островская Татьяна 02.04.2012 № 15
					// если есть ночные в регистрации разовых начислений
					Запрос = Новый Запрос;
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления.Сотрудник,
					|	РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления.Результат,
					|	РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления.ВидРасчета,
					|	РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления.ДатаНачала
					|ИЗ
					|	Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций.ОсновныеНачисления КАК РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления
					|ГДЕ
					|	РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления.Сотрудник В(&Сотрудник)
					|	И РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления.ДатаНачала МЕЖДУ &ДатаНачала И &ДатаНачала2
					|	И (РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления.ВидРасчета = &ВидРасчета
					|	ИЛИ РегистрацияРазовыхНачисленийРаботниковОрганизацийОсновныеНачисления.ВидРасчета.СпособРасчета В (&СпособРасчета))";
					
					Запрос.УстановитьПараметр("ДатаНачала", СтрокаДвижений.ПериодРегистрации);
					Запрос.УстановитьПараметр("ДатаНачала2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					Запрос.УстановитьПараметр("ВидРасчета", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
					Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					//О.Т. Аверсон 03.04.2016 № 981
					СпособыРасчета = Новый СписокЗначений;
					СпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);
					СпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);
					Запрос.УстановитьПараметр("СпособРасчета", СпособыРасчета);
					//О.Т. Аверсон 03.04.2016 № 981
					Результат1 = Запрос.Выполнить().Выбрать();
					НочныеПоРегистрации = 0;						
					Пока Результат1.Следующий() Цикл
						НочныеПоРегистрации = Результат1.Результат;
						
					КонецЦикла;
					
					
					// для наряда
					Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда //О.Т. Аверсон 13.12.2016 № 100
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ ПЕРВЫЕ 1
						|	РабочееВремяРаботниковОрганизаций.Регистратор,
						|	РабочееВремяРаботниковОрганизаций.Сотрудник,
						|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени,
						|	РабочееВремяРаботниковОрганизаций.Период,
						|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
						|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)";  
						если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
							Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
							Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
						ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
							Запрос.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
							Запрос.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
						иначе		
							Запрос.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
							Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
						КонецЕсли;
					иначе
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ ПЕРВЫЕ 1
						|	РабочееВремяРаботниковОрганизаций.Регистратор,
						|	РабочееВремяРаботниковОрганизаций.Сотрудник,
						|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени,
						|	РабочееВремяРаботниковОрганизаций.Период,
						//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
						//|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
						//- СВЭЙ КДЯ 05.12.19 СВФР-005178
						//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
						|	РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
						|   И ( НЕ ISNULL( Политика.ОтработанноеВремяТолькоПоТабелю, Ложь )
						|   	ИЛИ РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации )
						|   КАК ВЦеломЗаПериод
						//- СВЭЙ КДЯ 05.12.19 СВФР-005178
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
						|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК Политика
						|   	ПО Политика.Организация = РабочееВремяРаботниковОрганизаций.Организация
						//- СВЭЙ КДЯ 05.12.19 СВФР-005178
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период2";  
						Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодРегистрации);
						Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					КонецЕсли;
					
					Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					//Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы);
					
					Результат1 = Запрос.Выполнить().Выбрать();
					ЗаПериод = ложь;
					пока Результат1.Следующий() цикл
						Регистратор = Результат1.Регистратор;
						ЗаПериод = Результат1.ВЦеломЗаПериод;
					КонецЦикла;
					
					//+ СВЭЙ КДЯ 05.12.19 СВФР-005178
					////+ СВЭЙ КДЯ 03.12.19 СВФР-005155   05.12.19 СВФР-005178
					//ЗаПериод = УточнитьВЦеломЗаПериод( ЗаПериод, СтрокаДвижений, Регистратор );
					////- СВЭЙ КДЯ 03.12.19 СВФР-005155   05.12.19 СВФР-005178
					//- СВЭЙ КДЯ 05.12.19 СВФР-005178
					
					//Островская Татьяна 26.03.2013 № 16355
					БазаОсновых = 0;
					//ПроверкаИндивидуального = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(СтрокаДвижений.БазовыйПериодНачало,СтрокаДвижений.Сотрудник);
					//если ПроверкаИндивидуального.КоличествоЧасов > 0  Тогда 
					//	Запрос = Новый Запрос;
					//	Запрос.Текст = 
					//	"ВЫБРАТЬ
					//	|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.Результат) КАК Результат,
					//	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник
					//	|ИЗ
					//	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
					//	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.БазовыеВидыРасчета КАК БазовыеВидыРасчета
					//	|		ПО ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = БазовыеВидыРасчета.Ссылка
					//	|ГДЕ
					//	|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор
					//	|	И ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = &ФизЛицо
					//	|
					//	|СГРУППИРОВАТЬ ПО
					//	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник";
					//	Запрос.УстановитьПараметр("ФизЛицо", СтрокаДвижений.Сотрудник.Физлицо);
					//	Запрос.УстановитьПараметр("Регистратор", СтрокаДвижений.Регистратор);
					//	
					//	БазаОсновых = Запрос.Выполнить().Выгрузить().Итог("Результат");
					//	
					//КонецЕсли; 
					//Островская Татьяна 26.03.2013 № 16355
					если ЗаПериод и не СтрокаДвижений.Организация.ИНН = "600124787" тогда //О.Т.
						
						
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
						|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
						|	ОсновныеНачисленияРаботниковОрганизаций.Результат,
						|	ОсновныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия
						|ИЗ
						|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
						|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ТабельУчетаРабочегоВремениОрганизации КАК ТабельУчетаРабочегоВремениОрганизации
						|		ПО ОсновныеНачисленияРаботниковОрганизаций.Регистратор = ТабельУчетаРабочегоВремениОрганизации.Ссылка
						|			И ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент = ТабельУчетаРабочегоВремениОрганизации.Ссылка
						|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд КАК СдельныйНаряд
						|		ПО ОсновныеНачисленияРаботниковОрганизаций.Регистратор = СдельныйНаряд.Ссылка
						|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций КАК РегистрацияРазовыхНачисленийРаботниковОрганизаций
						|		ПО ОсновныеНачисленияРаботниковОрганизаций.Регистратор = РегистрацияРазовыхНачисленийРаботниковОрганизаций.Ссылка
						|			И ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент = РегистрацияРазовыхНачисленийРаботниковОрганизаций.Ссылка
						|ГДЕ
						|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И ОсновныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия МЕЖДУ &ДатаНачалаСобытия И &ДатаНачалаСобытия2
						|	И (ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.СдельныйНаряд
						|			ИЛИ ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации";
						
						//СВЭЙ 01.02.2024 КВВ СВФР-012214 (
						Если СтрокаДвижений.Организация.ИНН <> "700103211" Тогда
							Запрос.Текст = Запрос.Текст + "
							|			ИЛИ ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций";
						КонецЕсли;
						Запрос.Текст = Запрос.Текст + "
						//СВЭЙ 01.02.2024 КВВ СВФР-012214 )
						
						|)						
						|	И ОсновныеНачисленияРаботниковОрганизаций.ГрафикРаботы = &ГрафикРаботы";
						
						Запрос.УстановитьПараметр("ДатаНачалаСобытия", СтрокаДвижений.ПериодРегистрации);
						Запрос.УстановитьПараметр("ДатаНачалаСобытия2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
						Запрос.УстановитьПараметр("Регистратор", СтрокаДвижений.Регистратор);
						Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
						Запрос.УстановитьПараметр("ГрафикРаботы", СтрокаДвижений.Сотрудник);
						
						Результат1 = Запрос.Выполнить();
						
						ВыборкаДетальныеЗаписи = Результат1.Выбрать();
						ИтогПоНачислениям = 0;
						Пока ВыборкаДетальныеЗаписи.Следующий() Цикл  
							ВидРасчетаНачисления = ВыборкаДетальныеЗаписи.ВидРасчета;
							НачислениеИзНаряда = ВыборкаДетальныеЗаписи.Результат;
							
							
							Запрос = Новый Запрос;
							Запрос.Текст = 
							"ВЫБРАТЬ
							|	УдержанияОрганизаций.Наименование,
							|	УдержанияОрганизацийБазовыеВидыРасчета.ВидРасчета
							|ИЗ
							|	ПланВидовРасчета.УдержанияОрганизаций.БазовыеВидыРасчета КАК УдержанияОрганизацийБазовыеВидыРасчета
							|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций КАК УдержанияОрганизаций
							|		ПО УдержанияОрганизацийБазовыеВидыРасчета.Ссылка = УдержанияОрганизаций.Ссылка
							|ГДЕ
							|	УдержанияОрганизаций.Наименование = &Наименование
							|	И УдержанияОрганизацийБазовыеВидыРасчета.ВидРасчета = &ВидРасчета";
							
							Запрос.УстановитьПараметр("Наименование", Строка(ВидРасчета));
							Запрос.УстановитьПараметр("ВидРасчета", ВидРасчетаНачисления);
							Результат1 = Запрос.Выполнить();
							
							
							если не Результат1.Пустой() и  ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") тогда
								
								ИтогПоНачислениям = ИтогПоНачислениям + НачислениеИзНаряда;
								
							иначе 
								ИтогПоНачислениям = ИтогПоНачислениям;
							КонецЕсли;
						КонецЦикла;
						если ТипЗнч(Регистратор)  = Тип("ДокументСсылка.СдельныйНаряд") и ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") тогда
							//Островская Татьяна 26.03.2013 № 16355
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Макс(((ИсходныеДанные.РезультатБаза+БазаОсновых) + ИтогПоНачислениям + НочныеПоРегистрации) * СтрокаДвижений[ПоказательРазмер]/100 - УжеНачисленоВТекущемПериоде,0),Константы.ВалютаРегламентированногоУчета.Получить());
							//Островская Татьяна 26.03.2013 № 16355
						ИначеЕсли  ТипЗнч(Регистратор)  = Тип("ДокументСсылка.ТабельУчетаРабочегоВремениОрганизации") и ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") тогда
							// для табеля
							СуммаНочныхТабель = 0; 
							//Запрос = Новый Запрос;
							//Запрос.Текст = 
							//"ВЫБРАТЬ
							//|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка,
							//|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник,
							//|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета,
							//|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Результат
							//|ИЗ
							//|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
							//|ГДЕ
							//|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка = &Ссылка
							//|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник = &Сотрудник
							//|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета = &ВидРасчета";
							//
							//Запрос.УстановитьПараметр("ВидРасчета", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
							//Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
							//Запрос.УстановитьПараметр("Ссылка", СтрокаДвижений.Регистратор);
							//
							//Результат1 = Запрос.Выполнить().Выбрать();
							//Пока Результат1.Следующий() цикл
							//	СуммаНочныхТабель =  Результат1.Результат;
							//КонецЦикла;
							//Островская Татьяна 26.03.2013 № 16355
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Макс(((ИсходныеДанные.РезультатБаза+БазаОсновых) + ИтогПоНачислениям + СуммаНочныхТабель + НочныеПоРегистрации) * СтрокаДвижений[ПоказательРазмер]/100 - УжеНачисленоВТекущемПериоде,0),Константы.ВалютаРегламентированногоУчета.Получить());
							//Островская Татьяна 26.03.2013 № 16355
						КонецЕсли;
					иначе 
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Макс((ИсходныеДанные.РезультатБаза+БазаОсновых)  * СтрокаДвижений[ПоказательРазмер]/100 - УжеНачисленоВТекущемПериоде,0),Константы.ВалютаРегламентированногоУчета.Получить());
						//Аверсон 14.08.2019 КВВ СВФР-004607 (
						Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
							//Аверсон 15.11.2019 КВВ СВФР-005009 (
							Если ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ПерерассчитываемыйДокумент) И РегламентированныеУдержания или СтрокаДвижений.ПериодРегистрации <> НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало) Тогда
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(((ИсходныеДанные.РезультатБаза+БазаОсновых)  * СтрокаДвижений[ПоказательРазмер]/100 - УжеНачисленоВТекущемПериоде),Константы.ВалютаРегламентированногоУчета.Получить());
							КонецЕсли;
							//Аверсон 15.11.2019 КВВ СВФР-005009 )
							Если ИсходныеДанные.Регистратор.ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод И ИсходныеДанные.РезультатБаза < 0 
								И УжеНачисленоВТекущемПериоде = 0 И БазаОсновых = 0 Тогда
								З_Нов = Новый Запрос;
								З_Нов.Текст = 
								"ВЫБРАТЬ
								|НачЗП.ФизЛицо,
								|НАЧЗП.ВидРасчета,
								|НачЗП.Результат,
								|НачЗП.Сторно КАК Сторно,
								|НачЗП.Авторасчет
								|ПОМЕСТИТЬ ВТ_Начисления			
								|ИЗ Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачЗП
								|ГДЕ Ссылка = &ТекДок И НЕ Сторно;
								|
								|ВЫБРАТЬ
								|УдержанияОрганизаций.Наименование,
								|УдержанияОрганизацийБазовыеВидыРасчета.ВидРасчета
								|ПОМЕСТИТЬ ВТ_База
								|ИЗ ПланВидовРасчета.УдержанияОрганизаций.БазовыеВидыРасчета КАК УдержанияОрганизацийБазовыеВидыРасчета
								|ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций КАК УдержанияОрганизаций
								|ПО УдержанияОрганизацийБазовыеВидыРасчета.Ссылка = УдержанияОрганизаций.Ссылка
								|ГДЕ УдержанияОрганизаций.Наименование = &НаименованиеВР;
								|							
								|ВЫБРАТЬ 
								|ВТ_Начисления.ВидРасчета,
								|ВТ_Начисления.Результат,
								|ВТ_База.ВидРасчета
								|ИЗ ВТ_Начисления КАК ВТ_Начисления
								|ЛЕВОЕ СОЕДИНЕНИЕ ВТ_База КАК ВТ_База
								|ПО ВТ_Начисления.ВидРасчета = ВТ_База.ВидРасчета";
								З_Нов.УстановитьПараметр("ТекДок", ИсходныеДанные.Регистратор);
								З_Нов.УстановитьПараметр("НаименованиеВР", ИсходныеДанные.ВидРасчетаНаименование);
								ТЗРез = З_Нов.Выполнить().Выгрузить();
								НоваяБаза = ТЗРез.Итог("Результат");
								Если НЕ (ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ПерерассчитываемыйДокумент) И РегламентированныеУдержания) Тогда  //Аверсон 15.11.2019 КВВ СВФР-005009
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(НоваяБаза * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Аверсон 14.08.2019 КВВ СВФР-004607 )
					КонецЕсли;
					
					
					
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Процент: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
					КонецЕсли;
				Иначе
					//О.Т. 30.07.2014 № 135
					если ИсходныеДанные.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы тогда
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
							ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
							Если ТЗКолвоДнКом.Количество() > 0 Тогда
								Для Каждого Стр Из ТЗКолвоДнКом Цикл
									Если Стр.Дней > 0 Тогда
										мОтработаноЧасов = мОтработаноЧасов + Стр.Часов;
									КонецЕсли;
								КонецЦикла;
							КонецЕсли;
							Если  СтрокаДвижений.Организация.ИНН = "700067572" Тогда
								мОтработаноЧасов = мОтработаноЧасов +  ОтработаноЧасовПС;
							КонецЕсли;
						КонецЕсли;
						
						если ЗначениеЗаполнено(мОтработаноЧасов) тогда
							Если  ЗначениеЗаполнено(ВидРасчета2) и ВидРасчета2  =  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РезультатБаза * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
							Иначе          
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза + ТарСтавка * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
							КонецЕсли;
							//СВФР-017390
							Если СтрокаДвижений.Организация.ИНН = "500036445" или СтрокаДвижений.Организация.ИНН = "500826909" Тогда 
								СведенияОСотруднике = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,Новый Структура("Сотрудник",ИсходныеДанные.Сотрудник));
								Если СведенияОСотруднике.Временно Тогда
									Если  ЗначениеЗаполнено(ВидРасчета2) и ВидРасчета2  =  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
										СведенияОСотрудникеЗП = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,Новый Структура("Сотрудник",ИсходныеДанные.Сотрудник));
										Результат = ОбщегоНазначения.ОкруглитьПоВалюте((СведенияОСотрудникеЗП.ТарифнаяСтавка/ИсходныеДанные.НормаВремениЗаМесяц* мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
									иначе
										Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ТарСтавка * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
									КонецЕсли; 	
								КонецЕсли; 							
							КонецЕсли;  
							//СВФР-017390
						иначе
							
							//Островская Татьяна 18.10.2013 № 16858
							если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РезультатБаза * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
							иначеЕсли ИсходныеДанные.РезультатБаза <> 0 Тогда
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
							Иначе
								Результат = 0;   								
							КонецЕсли;
							//Островская Татьяна 18.10.2013 № 16858
						КонецЕсли;
						ОтобразитьОплачиваемоеВремяВДокументе( СтрокаДвижений, ИсходныеДанные ); //+ СВЭЙ КДЯ 03.12.19 СВФР-005157
					ИначеЕсли ИсходныеДанные.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом тогда
						//Аверсон 22.06.2020 КВВ СВФР-006176 (
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
							ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
							Если ТЗКолвоДнКом.Количество() > 0 Тогда
								Для Каждого Стр Из ТЗКолвоДнКом Цикл
									Если Стр.Дней > 0 Тогда
										мОтработаноЧасов = мОтработаноЧасов + Стр.Часов;
									КонецЕсли;
								КонецЦикла;
							КонецЕсли;
						КонецЕсли;
						//Аверсон 22.06.2020 КВВ СВФР-006176 )
						
						//Островская Татьяна 15.03.2013 № 16327
						если ЗначениеЗаполнено(мОтработаноЧасов) или ИсходныеДанные.РезультатБаза<>0 тогда
							
							Если СтрокаДвижений.Организация.ИНН = "100074549" или СтрокаДвижений.Организация.ИНН = "100010315" ИЛИ СтрокаДвижений.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Организация.ИНН = "200400628"  //О.Т. Аверсон 29.11.2017  //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
								ИЛИ СтрокаДвижений.Организация.ИНН = "500227068" или СтрокаДвижений.Организация.ИНН = "100071565" Тогда //Аверсон 27.12.2021 КВВ СВФР-008546
								Запрос1 = Новый Запрос;
								Запрос1.Текст =
								
								"ВЫБРАТЬ
								|	СтрокиДокумента.Ссылка,
								|	СтрокиДокумента.НомерСтроки,
								|	СтрокиДокумента.Сотрудник КАК Сотрудник,
								|	СтрокиДокумента.Физлицо,
								|	СтрокиДокумента.ВидРасчета,
								|	НАЧАЛОПЕРИОДА(СтрокиДокумента.ДатаНачала, МЕСЯЦ) КАК ПериодДействия
								|ИЗ
								|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиДокумента
								|ГДЕ
								|	СтрокиДокумента.ВидРасчета В (&ВидРасчета)
								|	И СтрокиДокумента.Ссылка = &ДокументСсылка
								|	И СтрокиДокумента.Сотрудник = &парамФизлицо
								|	И &ДатаНачала МЕЖДУ СтрокиДокумента.ДатаНачала И СтрокиДокумента.ДатаОкончания";
								Запрос1.УстановитьПараметр("ДокументСсылка", СтрокаДвижений.Регистратор);
								//Запрос.УстановитьПараметр("ГоловнаяОрганизация",СтрокаДвижений.Организация);
								если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда  
									Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.ПериодДействияНачало);
								иначе
									Запрос1.УстановитьПараметр("ДатаНачала", СтрокаДвижений.БазовыйПериодНачало);
								КонецЕсли;	
								Запрос1.УстановитьПараметр("парамФизлицо", СтрокаДвижений.Сотрудник);
								МассивВидыРасч = Новый СписокЗначений;
								МассивВидыРасч.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
								МассивВидыРасч.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
								Запрос1.УстановитьПараметр("ВидРасчета",  МассивВидыРасч);
								Выборка = Запрос1.Выполнить().Выбрать();
								Пока Выборка.Следующий() цикл
									ВидРасчета1 = Выборка.ВидРасчета;
								КонецЦикла;
							КонецЕсли;
							
							если СтрокаДвижений.Организация.ИНН = "500052918" и ВидРасчета1 <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
								
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза + ТарСтавка * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
							ИначеЕсли СтрокаДвижений.Организация.ИНН = "700067572" тогда
								Если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
								Иначе 
									Если  СтрокаДвижений.Организация.ИНН = "700067572" Тогда
										мОтработаноЧасов = мОтработаноЧасов +  ОтработаноЧасовПС;
									КонецЕсли;
									Если СтрокаДвижений.Организация.ИНН = "100071565" и ВидРасчета1 <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
										Результат = ОбщегоНазначения.ОкруглитьПоВалюте((Окр(ТарСтавка *( мОтработаноЧасов+ОтработаноЧасовПС),2) +ИсходныеДанные.РезультатБаза) * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
									Иначе
										Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза + ТарСтавка * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
									КонецЕсли;
								КонецЕсли;
							ИначеЕсли (СтрокаДвижений.Организация.ИНН = "100074549" И НЕ ВидРасчета.РасчетВыслугиОтБазы) 
								или (СтрокаДвижений.Организация.ИНН = "100010315" ИЛИ СтрокаДвижений.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Организация.ИНН = "200400628" //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
								ИЛИ СтрокаДвижений.Организация.ИНН = "500227068") //Аверсон 27.12.2021 КВВ СВФР-008546
								и ВидРасчета1 <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням 
								и ВидРасчета1 <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам тогда
								//О.Т. Аверсон 05.04.2016 № 1027
								ПериодДляСтавки = СтрокаДвижений.ДатаНачалаСобытия; 							
								ЗапросТС = Новый Запрос;
								ЗапросТС.Текст = 
								"ВЫБРАТЬ
								|	РаботникиОрганизаций.Период
								|ИЗ
								|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
								|ГДЕ
								|	РаботникиОрганизаций.Сотрудник = &Сотрудник
								|	И РаботникиОрганизаций.Период <= &Период
								|	И РаботникиОрганизаций.Организация = &Организация
								|	И НЕ РаботникиОрганизаций.Временно";
								
								ЗапросТС.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								ЗапросТС.УстановитьПараметр("Период", СтрокаДвижений.ДатаНачалаСобытия);
								ЗапросТС.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
								
								РезультатЗапроса = ЗапросТС.Выполнить();
								ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									ПериодДляСтавки = ВыборкаДетальныеЗаписи.Период;
								КонецЦикла;
								ТарифныеСтавки1 = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ПериодДляСтавки,
								Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник));
								ЗанимаемаяСтавка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ДатаНачалаСобытия,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
								
								ЗапросТарСтПоИНН = Новый Запрос;
								ЗапросТарСтПоИНН.Текст = "ВЫБРАТЬ
								|	УчетнаяПолитикаПоПерсоналуОрганизаций.ЧасовойТарифЗаЦелуюСтавку
								|ИЗ
								|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
								|ГДЕ
								|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
								ЗапросТарСтПоИНН.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
								РезФлагТарСтавкаПоИНН = ЗапросТарСтПоИНН.Выполнить().Выбрать();
								если РезФлагТарСтавкаПоИНН.Следующий() Тогда 
									ФлЧасовойТарифЗаЦелуюСтавку = РезФлагТарСтавкаПоИНН.ЧасовойТарифЗаЦелуюСтавку; 
								иначе
									ФлЧасовойТарифЗаЦелуюСтавку = Ложь;
								КонецЕсли;
								
								ТарСтавка1 = Окр( 
								ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ДатаНачалаСобытия, СтрокаДвижений.ГрафикРаботы, Истина,,,,мОтработаноЧас,,,,,ТарифныеСтавки1,,Курс) //+ СВЭЙ КДЯ 24.01.20 СВФР-005407, добавлено: <,,Курс>
								, 5 ); //О.Т. Аверсон 05.04.2016 
								Если ФлЧасовойТарифЗаЦелуюСтавку Тогда
									ТарСтавка1 = ТарСтавка1 * ЗанимаемаяСтавка;
								КонецЕсли;
								
								//Если СтрокаДвижений.Организация.ИНН = "100765738" и ВЦеломЗаПериод Тогда //О.Т. Аверсон 13.12.2016 № 100
								//	ЗапросЧасы = Новый Запрос;
								//	ЗапросЧасы.Текст =
								//	"ВЫБРАТЬ
								//	|	ВложенныйЗапрос.Часов - ЕСТЬNULL(ВложенныйЗапросИскл.ЧасовИскл, 0) КАК Часов,
								//	|	ВложенныйЗапрос.Дней - ЕСТЬNULL(ВложенныйЗапросИскл.ДнейИскл, 0) КАК Дней
								//	|ИЗ
								//	|	(ВЫБРАТЬ
								//	|		СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
								//	|		СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
								//	|	ИЗ
								//	|		РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
								//	|	ГДЕ
								//	|		РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
								//	|		И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
								//	|				ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени3)
								//	|		И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
								//	|				ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
								//	|		И ВЫБОР
								//	|				КОГДА &ФлагПоТабелю
								//	|					ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
								//	|				ИНАЧЕ ИСТИНА
								//	|			КОНЕЦ) КАК ВложенныйЗапрос,
								//	|	(ВЫБРАТЬ
								//	|		СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК ЧасовИскл,
								//	|		СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК ДнейИскл
								//	|	ИЗ
								//	|		РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
								//	|	ГДЕ
								//	|		РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
								//	|		И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремениИскл
								//	|				ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени3Искл)
								//	|		И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
								//	|				ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
								//	|		И ВЫБОР
								//	|				КОГДА &ФлагПоТабелю
								//	|					ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
								//	|				ИНАЧЕ ИСТИНА
								//	|			КОНЕЦ) КАК ВложенныйЗапросИскл";
								//	если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
								//		ЗапросЧасы.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
								//		ЗапросЧасы.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
								//	ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
								//		ЗапросЧасы.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
								//		ЗапросЧасы.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
								//	иначе		
								//		Запрос.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
								//		Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации)); 										
								//	КонецЕсли;
								
								//иначе
								//	ЗапросЧасы = Новый Запрос;
								//	ЗапросЧасы.Текст =
								//	"ВЫБРАТЬ
								//	|	ВложенныйЗапрос.Часов - ЕСТЬNULL(ВложенныйЗапросИскл.ЧасовИскл, 0) КАК Часов,
								//	|	ВложенныйЗапрос.Дней - ЕСТЬNULL(ВложенныйЗапросИскл.ДнейИскл, 0) КАК Дней
								//	|ИЗ
								//	|	(ВЫБРАТЬ
								//	|		СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
								//	|		СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
								//	|	ИЗ            
								//	|		РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
								//	|	ГДЕ
								//	|		РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
								//	|		И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
								//	|				ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени3)
								//	|		И РабочееВремяРаботниковОрганизаций.Период >= &Период
								//	|		И РабочееВремяРаботниковОрганизаций.Период <= &Период2
								//	|		И ВЫБОР
								//	|				КОГДА &ФлагПоТабелю
								//	|					ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
								//	|				ИНАЧЕ ИСТИНА
								//	|			КОНЕЦ) КАК ВложенныйЗапрос,
								//	|	(ВЫБРАТЬ
								//	|		СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК ЧасовИскл,
								//	|		СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК ДнейИскл
								//	|	ИЗ
								//	|		РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
								//	|	ГДЕ
								//	|		РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
								//	|		И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремениИскл
								//	|				ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени3Искл)
								//	|		И РабочееВремяРаботниковОрганизаций.Период >= &Период
								//	|		И РабочееВремяРаботниковОрганизаций.Период <= &Период2
								//	|		И ВЫБОР
								//	|				КОГДА &ФлагПоТабелю
								//	|					ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
								//	|				ИНАЧЕ ИСТИНА
								//	|			КОНЕЦ) КАК ВложенныйЗапросИскл";  
								//	ЗапросЧасы.УстановитьПараметр("Период", ПериодНачало);//Островская Татьяна 23.04.2014 № 17292
								//	ЗапросЧасы.УстановитьПараметр("Период2", ПериодКонец);
								
								//КонецЕсли;
								//ЗапросЧасы.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);
								//ЗапросЧасы.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
								//ЗапросЧасы.УстановитьПараметр("ВидИспользованияРабочегоВремени3", Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускПоУходуЗаРебенком);
								//ЗапросЧасы.УстановитьПараметр("ВидИспользованияРабочегоВремениИскл", Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
								//ЗапросЧасы.УстановитьПараметр("ВидИспользованияРабочегоВремени3Искл", Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные);
								//УчетнаяПолитикаЗапрос = Новый Запрос; //О.Т. 23.12.2014 № 
								//УчетнаяПолитикаЗапрос.Текст = 
								//"ВЫБРАТЬ
								//|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
								//|ИЗ
								//|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
								//|ГДЕ
								//|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
								//УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
								//УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
								//если УчетнаяПолитика.Количество()>0 Тогда 
								//	ЗапросЧасы.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
								//иначе
								//	ЗапросЧасы.УстановитьПараметр("ФлагПоТабелю",Ложь);
								//КонецЕсли;
								
								//ВыборкаЧасы = ЗапросЧасы.Выполнить().Выбрать();
								//Пока ВыборкаЧасы.Следующий() Цикл
								//	если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
								//		мОтработаноЧасов = ?(ЗначениеЗаполнено(ВыборкаЧасы.Дней),ВыборкаЧасы.Дней,0);
								//	иначе
								//		мОтработаноЧасов = ?(ЗначениеЗаполнено(ВыборкаЧасы.Часов),ВыборкаЧасы.Часов,0);
								//	КонецЕсли;
								//КонецЦикла; // Убрала
								//О.Т. Аверсон 05.04.2016 № 1027
								Если (СтрокаДвижений.Организация.ИНН = "100010315" ИЛИ СтрокаДвижений.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Организация.ИНН = "200400628")   //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
									ИЛИ СтрокаДвижений.Организация.ИНН = "500227068" Тогда //Аверсон 27.12.2021 КВВ СВФР-008546
									//	Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза + ?(СтрокаДвижений.Организация.ИНН = "500227068",0,ТарСтавка1 * мОтработаноЧасов))* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить()); //Аверсон 24.03.2022 КВВ СВФР-008853 (УНП Радиотехники в формуле)
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза + ТарСтавка1 * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить()); //Аверсон 24.03.2022 КВВ СВФР-008853 (УНП Радиотехники в формуле)
									
								иначе
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ТарСтавка1 * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
								КонецЕсли;								
							иначе
								
								//Островская 16.03.2014 №
								//если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
								//	Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЗначениеЗаполнено(БазаЗамещение),БазаЗамещение,ИсходныеДанные.РезультатБаза) * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
								//иначе	
								//О.Т. 07.08.2014 № 160
								ЕстьИндивидуальныйГрафик = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Сотрудник);
								если ЕстьИндивидуальныйГрафик.КоличествоЧасов >0 и СтрокаДвижений.Организация.ИНН = "800009185" 
									и ВидРасчета1 <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда 
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарСтавка * мОтработаноЧасов * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
								иначе
									Если СтрокаДвижений.Организация.ИНН = "100071565" и ВидРасчета1 <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда										
										//Аверсон 16.07.2022 КВВ СВФР-009333 (
										//	Результат = ОбщегоНазначения.ОкруглитьПоВалюте((Окр(ТарСтавка *( мОтработаноЧасов+ОтработаноЧасовПС),2) +ИсходныеДанные.РезультатБаза) * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
										БратьБазуДляРасчета = ИсходныеДанные.РезультатБаза;
										УмножитьНаПроцент = 1;
										Если СтрокаДвижений[ПоказательРазмер] <> 0 И (СтрокаДвижений.ПериодДействияНачало <> НачалоМесяца(СтрокаДвижений.ПериодДействияНачало) ИЛИ СтрокаДвижений.ПериодДействияКонец <> КонецМесяца(СтрокаДвижений.ПериодДействияКонец)) Тогда //пересчитаем базу
											ТЗБазыВР = СтрокаДвижений.ВидРасчета.БазовыеВидыРасчета.Выгрузить();
											СписокБазыВР = Новый СписокЗначений;
											СписокБазыВР.ЗагрузитьЗначения(ТЗБазыВР.ВыгрузитьКолонку("ВидРасчета"));
											ЗапросБазыВР = Новый Запрос;
											ЗапросБазыВР.Текст = "ВЫБРАТЬ 
											|ТЧ.Показатель1 КАК Процент,
											|ТЧ.ДатаНачала,
											|ТЧ.ДатаОкончания,
											|ТЧ.ВидРасчета
											|ИЗ Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК ТЧ
											|ГДЕ ТЧ.Ссылка = &Док
											|И ТЧ.Сотрудник = &Сотрудник
											|И ТЧ.ВидРасчета В (&СписокВР)"; 
											ЗапросБазыВР.УстановитьПараметр("Док",СтрокаДвижений.Регистратор);
											ЗапросБазыВР.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);
											ЗапросБазыВР.УстановитьПараметр("СписокВР",СписокБазыВР);
											РезЗапросБазыВР = ЗапросБазыВР.Выполнить().Выгрузить();
											ЕстьПериодыКакУСтажа = Ложь; 
											СтрокиКУдалению = Новый Массив;     
											Для Каждого СтрРезЗапросБазыВР ИЗ РезЗапросБазыВР Цикл
												Если НачалоДня(СтрокаДвижений.ПериодДействияНачало) = НачалоДня(СтрРезЗапросБазыВР.ДатаНачала)
													И НачалоДня(СтрокаДвижений.ПериодДействияКонец) = НачалоДня(СтрРезЗапросБазыВР.ДатаОкончания) Тогда
													ЕстьПериодыКакУСтажа = Истина;
													Прервать;
												КонецЕсли;
												Если СтрРезЗапросБазыВР.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
													СтрокиКУдалению.Добавить( СтрРезЗапросБазыВР );														
												КонецЕсли;
											КонецЦикла;
											ОбщегоНазначения.УдалитьСтрокиИзТаблицы( РезЗапросБазыВР, СтрокиКУдалению );
											Если ЕстьПериодыКакУСтажа Тогда // ничего не меняем
											Иначе
												ВременнаяТЗ = РезЗапросБазыВР.Скопировать(,"ВидРасчета, Процент");
												ВременнаяТЗ.Свернуть("ВидРасчета,Процент");
												УмножитьНаПроцент = УмножитьНаПроцент + Окр(ВременнаяТЗ.Итог("Процент")/100,2);
												БратьБазуДляРасчета = 0;
												Сообщить("Проверить стаж "+ СокрЛП(СтрокаДвижений.Сотрудник)+" "+Формат(СтрокаДвижений.ПериодДействияНачало,"ДФ=dd.MM.yyyy")+"!!!" )
											КонецЕсли;
										КонецЕсли;
										Результат = ОбщегоНазначения.ОкруглитьПоВалюте((Окр(ТарСтавка *( мОтработаноЧасов+ОтработаноЧасовПС),2) + БратьБазуДляРасчета)* УмножитьНаПроцент * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
										//Аверсон 16.07.2022 КВВ СВФР-009333 )
									Иначе									
										Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РезультатБаза * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
										
										//Аверсон ЕАЕ 21.02.2024 СВФР-012254
										//Климовичи (Доплата за стаж)
										Если СтрокаДвижений.Организация.ИНН = "700103211" Тогда
											Если СтрокаДвижений.ВидРасчета.Наименование = "Доплата за стаж" Тогда
												Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
													
													ОбнулятьРезультат = Ложь;
													
													мСтрока = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(
													Новый Структура("Организация", СтрокаДвижений.Организация));
													Если мСтрока.НеРассчитыватьНачислениеЕслиПроведеноОплатаПоСреднему Тогда
														БылВременныйПеревод = ПроверитьВременныйПеревод(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
														Если БылВременныйПеревод Тогда
															БылаОплатаПоСреднемуПеревод = ПроверитьОплатуПоСреднемуВременныйПеревод(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
															Если БылаОплатаПоСреднемуПеревод Тогда
																ОбнулятьРезультат = Истина;	
															КонецЕсли;
														КонецЕсли;
													КонецЕсли;
													Если ОбнулятьРезультат Тогда
														Результат = 0;
													ИначеЕсли ИсходныеДанные.РезультатБаза = 0 Тогда
														Результат = 0;
													//иначе оставим расчет, как у всех
													//индивидуальный расчет останется только у тех сотрудников, у которых были часы ремонта
													ИначеЕсли БылиЧасыРемонта(СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодРегистрации) Тогда
														Если СотрудникРаботаетПоЧасовойТарифнойСтавке(СтрокаДвижений.Регистратор, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец) Тогда
															ЧТС = ПолучитьЧТС(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало);
															Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ЧТС * ИсходныеДанные.ОтработаноВремени * СтрокаДвижений[ПоказательРазмер] / 100, Константы.ВалютаРегламентированногоУчета.Получить());
														Иначе
															ТарифныеСтавки1 = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ПериодДляСтавки,
															Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник));
															МесячнаяТарифнаяСтавка = ТарифныеСтавки1.Ставка;
															//Результат = ОбщегоНазначения.ОкруглитьПоВалюте((МесячнаяТарифнаяСтавка / ИсходныеДанные.НормаВремениЗаМесяц) * ИсходныеДанные.ОтработаноВремени * СтрокаДвижений[ПоказательРазмер] / 100, Константы.ВалютаРегламентированногоУчета.Получить());
															ТЗКомандировки = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник,СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец);
															ОтработаноЧас = ИсходныеДанные.ОтработаноВремени;
															Если ТЗКомандировки.Количество() > 0 Тогда
																ОтработаноЧас = ОтработаноЧас + ТЗКомандировки.Итог("Часов");	
															КонецЕсли;
															Результат = ОбщегоНазначения.ОкруглитьПоВалюте((МесячнаяТарифнаяСтавка / ИсходныеДанные.НормаВремениЗаМесяц) * ОтработаноЧас * СтрокаДвижений[ПоказательРазмер] / 100, Константы.ВалютаРегламентированногоУчета.Получить());
														КонецЕсли;
													КонецЕсли;
												КонецЕсли;
											КонецЕсли;
										КонецЕсли;
										//Аверсон СВФР-012254
										
										//Аверсон ЕАЕ 23.05.2024 СВФР-012937
										//Бобруйсксельмаш
										Если СтрокаДвижений.Организация.ИНН = "790056159" Тогда
											Если СтрокаДвижений.ВидРасчета.Наименование = "Надбавка за выслугу лет" Тогда
												Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
													Если ИсходныеДанные.РезультатБаза = 0 Тогда //результат оплата по часовому тарифу пустой
														Если БылаПовременнаяОплата(СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодРегистрации) Тогда
															Если СотрудникРаботаетПоЧасовойТарифнойСтавке(СтрокаДвижений.Регистратор, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец) Тогда
																ЧТС = ПолучитьЧТС(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало);
																//Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ЧТС * ИсходныеДанные.ОтработаноВремени * СтрокаДвижений[ПоказательРазмер] / 100, Константы.ВалютаРегламентированногоУчета.Получить());
															Иначе
																ТарифныеСтавки1 = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ПериодДляСтавки,
																Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник));
																МесячнаяТарифнаяСтавка = ТарифныеСтавки1.Ставка;
																ЧТС = МесячнаяТарифнаяСтавка / ИсходныеДанные.НормаВремениЗаМесяц;
																//Результат = ОбщегоНазначения.ОкруглитьПоВалюте((МесячнаяТарифнаяСтавка / ИсходныеДанные.НормаВремениЗаМесяц) * ИсходныеДанные.ОтработаноВремени * СтрокаДвижений[ПоказательРазмер] / 100, Константы.ВалютаРегламентированногоУчета.Получить());
															КонецЕсли;
															Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ЧТС * мОтработаноЧасов * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
														КонецЕсли;
													КонецЕсли;
												КонецЕсли;
											КонецЕсли;
										КонецЕсли;
										//Аверсон СВФР-012937
										
									КонецЕсли;
									
								КонецЕсли;
								Если СтраховыеАгенты Тогда
									ТарСтавка1 = Окр(
									ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ДатаНачалаСобытия, СтрокаДвижений.ГрафикРаботы, Истина,,,,мОтработаноЧас,,,,,ТарифныеСтавки1,,Курс) //+ СВЭЙ КДЯ 24.01.20 СВФР-005407, добавлено: <,,Курс>
									, 5 );  
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ТарСтавка1 * мОтработаноЧасов)* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());	
								КонецЕсли;
							КонецЕсли;
						иначе
							//Островская Татьяна 18.10.2013 № 16858
							если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РезультатБаза * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
							иначе
								Результат = 0;
							КонецЕсли;
							//Островская Татьяна 18.10.2013 № 16858
							
						КонецЕсли; // ЗначениеЗаполнено(мОтработаноЧасов)
						ОтобразитьОплачиваемоеВремяВДокументе( СтрокаДвижений, ИсходныеДанные ); //+ СВЭЙ КДЯ 03.12.19 СВФР-005157
						
					ИначеЕсли ИсходныеДанные.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП тогда //О.Т. Аверсон 04.11.2016 № 1501
						РазмерБПМ = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПределПоСуммеИндексацииЗП)).Размер; 
						Если РазмерБПМ = 0 Тогда 
							Сообщить("Не заполнен предел по сумме индексации з/п!");
						КонецЕсли;
						
						//мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(ПериодНачало, ПериодКонец, СтрокаДвижений.Сотрудник);
						//если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
						//	НормаВремени = мНорма.НормаДней;
						//	ОтработаноВремени = ИсходныеДанные.ОтработаноДней;
						//иначе
						//	НормаВремени = мНорма.НормаЧасов;
						//	ОтработаноВремени = ИсходныеДанные.ОтработаноЧасов;
						//КонецЕсли;
						
						//Если ЗначениеЗаполнено(НормаВремени) Тогда
						//	Если ОтработаноВремени = НормаВремени Тогда 
						//		ПределОтОтработанного = РазмерБПМ; 
						//	иначе
						//		ПределОтОтработанного = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерБПМ * ОтработаноВремени / НормаВремени,СтрокаДвижений.ПериодРегистрации); 
						//	КонецЕсли;
						//иначе
						//	ПределОтОтработанного = 0;
						//	РезультатБазаОтОтработанного = 0;
						//КонецЕсли;
						РезультатБазаОтОтработанного = ИсходныеДанные.РезультатБаза;
						БазаДляРасчета = Мин(РазмерБПМ,РезультатБазаОтОтработанного);
						
						
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(БазаДляРасчета * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
					ИначеЕсли СтрокаДвижений.Организация.ИНН = "700067572" и (ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаКлассность или 
						СокрЛП(ИсходныеДанные.ВидРасчета)= "Ненорм.день доп") тогда 
						ЗапросПлановые = Новый Запрос;
						ЗапросПлановые.Текст = 
						"ВЫБРАТЬ
						|	НачисленияРаботниковОрганизации.Показатель1
						|ИЗ
						|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
						|			&парамНачало,
						|			ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
						|				И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
						|ГДЕ
						|	ВЫБОР
						|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
						|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						|				ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
						|			ИНАЧЕ НачисленияРаботниковОрганизации.Действие
						|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
						|	И ВЫБОР
						|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
						|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						|				ТОГДА ВЫБОР
						|						КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
						|							ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
						|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
						|					КОНЕЦ
						|			ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
						|		КОНЕЦ В (&ВидыРасчетаПовышения)";
						ЗапросПлановые.УстановитьПараметр("парамНачало", ИсходныеДанные.ПериодДействияНачало);
						ЗапросПлановые.УстановитьПараметр("Сотрудник", ИсходныеДанные.Сотрудник);
						ВидыПовышений = Новый СписокЗначений;
						Для Каждого стр из Справочники.ГруппыРасчетов.ПовышениеДляНочных.Основные Цикл 
							ВидыПовышений.Добавить(стр.ВидРасчета);
						КонецЦикла;
						ЗапросПлановые.УстановитьПараметр("ВидыРасчетаПовышения", ВидыПовышений);
						РезультатЗапроса = ЗапросПлановые.Выполнить().Выбрать();
						ПроцентыПовышений = 0;
						пока РезультатЗапроса.Следующий() Цикл 
							ПроцентыПовышений = ПроцентыПовышений + РезультатЗапроса.Показатель1;
						КонецЦикла;  //ТарСтавка
						//мОтработаноЧасов = 0;
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
							ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
							Если ТЗКолвоДнКом.Количество() > 0 Тогда
								Для Каждого Стр Из ТЗКолвоДнКом Цикл
									Если Стр.Дней > 0 Тогда
										мОтработаноЧасов = мОтработаноЧасов + Стр.Часов;
									КонецЕсли;
								КонецЦикла;
							КонецЕсли;
						КонецЕсли;
						ОтработаноЧасовВредность = 0;
						Запрос = Новый Запрос;
						Запрос.Текст =
						"ВЫБРАТЬ
						|	РабочееВремяРаботниковОрганизаций.Часов
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
						|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
						|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)";
						
						Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
						Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
						Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
						Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные);
						Выборка = Запрос.Выполнить().Выбрать();
						Пока Выборка.Следующий() цикл
							ОтработаноЧасовВредность = ОтработаноЧасовВредность+Выборка.Часов;
						КонецЦикла;
						мОтработаноЧасов = мОтработаноЧасов +  ОтработаноЧасовВредность;
						
						//СВЭЙ 22.02.2024 КВВ СВФР-012096 (
						Если Справочники.ГруппыРасчетов.ПовышениеДляНочных.РасчетПоСуммам Тогда
							Если ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботы) Тогда 
								ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
								Новый Структура("Организация,ВидПараметра,Категория,ГрафикРаботы", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка(),СтрокаДвижений.ГрафикРаботы));
								Если ЧасовВГоду.Размер = 0 Тогда 
									ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
									Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка()));
								КонецЕсли;
							Иначе                        		
								ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
								Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка()));
							КонецЕсли;
							Если ЧасовВГоду.Размер <> 0 Тогда
								Если СокрЛП(СтрокаДвижений.Категория) <> "Рабочие" Тогда
									ПроцентыПовышений = ПроцентыПовышений/ЧасовВГоду.Размер;
								КонецЕсли;
							КонецЕсли;
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(ИсходныеДанные.РезультатБаза*ПроцентыПовышений,2),Константы.ВалютаРегламентированногоУчета.Получить());	
						Иначе
							//СВЭЙ 22.02.2024 КВВ СВФР-012096 )
							
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(ИсходныеДанные.РезультатБаза*(100+ПроцентыПовышений)/100,2) * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());	
						КонецЕсли;
					ИначеЕсли СтрокаДвижений.Организация.ИНН = "100071565" и (ИсходныеДанные.ВидРасчета.Код = "00017") тогда 
						ЗапросПлановые = Новый Запрос;
						ЗапросПлановые.Текст = 
						"ВЫБРАТЬ
						|	НачисленияРаботниковОрганизации.Показатель1
						|ИЗ
						|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
						|			&парамНачало,
						|			ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
						|				И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
						|ГДЕ
						|	ВЫБОР
						|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
						|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						|				ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
						|			ИНАЧЕ НачисленияРаботниковОрганизации.Действие
						|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
						|	И ВЫБОР
						|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
						|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						|				ТОГДА ВЫБОР
						|						КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
						|							ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
						|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
						|					КОНЕЦ
						|			ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
						|		КОНЕЦ В (&ВидыРасчетаПовышения)";
						ЗапросПлановые.УстановитьПараметр("парамНачало", ИсходныеДанные.ПериодДействияНачало);
						ЗапросПлановые.УстановитьПараметр("Сотрудник", ИсходныеДанные.Сотрудник);
						ВидыПовышений = Новый СписокЗначений;
						Для Каждого стр из Справочники.ГруппыРасчетов.ПовышениеДляНочных.Основные Цикл 
							ВидыПовышений.Добавить(стр.ВидРасчета);
						КонецЦикла;
						ЗапросПлановые.УстановитьПараметр("ВидыРасчетаПовышения", ВидыПовышений);
						РезультатЗапроса = ЗапросПлановые.Выполнить().Выбрать();
						ПроцентыПовышений = 0;
						пока РезультатЗапроса.Следующий() Цикл 
							ПроцентыПовышений = ПроцентыПовышений + РезультатЗапроса.Показатель1;
						КонецЦикла; 	
						
						//СВЭЙ 22.02.2024 КВВ СВФР-012096 (
						Если Справочники.ГруппыРасчетов.ПовышениеДляНочных.РасчетПоСуммам Тогда
							Если ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботы) Тогда 
								ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
								Новый Структура("Организация,ВидПараметра,Категория,ГрафикРаботы", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка(),СтрокаДвижений.ГрафикРаботы));
								Если ЧасовВГоду.Размер = 0 Тогда 
									ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
									Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка()));
								КонецЕсли;
							Иначе                        		
								ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
								Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка()));
							КонецЕсли;
							Если ЧасовВГоду.Размер <> 0 Тогда
								Если СокрЛП(СтрокаДвижений.Категория) <> "Рабочие" Тогда
									ПроцентыПовышений = ПроцентыПовышений/ЧасовВГоду.Размер;
								КонецЕсли;
							КонецЕсли;
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(ТарСтавка * мОтработаноЧасов*ПроцентыПовышений,2) ,Константы.ВалютаРегламентированногоУчета.Получить());		
						Иначе
							//СВЭЙ 22.02.2024 КВВ СВФР-012096 )
							
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(ТарСтавка * мОтработаноЧасов*(100+ПроцентыПовышений)/100,2) * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());		
						КонецЕсли;
						
					//Аверсон ЕАЕ 27.08.2025 СВФР-016381
					ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом И 
						//ДополнительныеНачисленияОрганизаций = Истина И //Аверсон ЕАЕ 21.10.2025 СВФР-017026
						ИсходныеДанные.ВидРасчета.ППСНаРуки = Истина И 
						ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") И 
						СокрЛП(СтрокаДвижений.ВидРасчета.КатегорияНачисления) = "Зависимое третьего уровня" Тогда
						
						//Рассчитать базу
						ТЗСводныйТабель = Новый ТаблицаЗначений;
						ТЗСводныйТабель.Колонки.Добавить("ФизЛицо");
						СписокСотрудников = Новый Массив;
						СписокСотрудников.Добавить(СтрокаДвижений.Сотрудник);
						СписокФизЛиц = Новый Массив;
						СписокФизЛиц.Добавить(СтрокаДвижений.ФизЛицо);
						
						//Аверсон ЕАЕ 21.10.2025 СВФР-017026
						Если ОсновныеНачисленияОрганизаций = Истина Тогда
							Нач = СтрокаДвижений.ПериодДействияНачало;
							Кон = СтрокаДвижений.ПериодДействияКонец; 
						Иначе 
							Нач = СтрокаДвижений.БазовыйПериодНачало;
							Кон = СтрокаДвижений.БазовыйПериодКонец;
						КонецЕсли;
						
						//ТЗОтработанноеВремя = ПолучитьОтработанноеВремяДляРасчетаППС(СтрокаДвижений.Организация,СтрокаДвижений.ПериодРегистрации,СписокСотрудников,ТЗСводныйТабель,Истина,
						//																СтрокаДвижений.БазовыйПериодНачало, СтрокаДвижений.БазовыйПериодКонец); 
						//ТЗТаблицаЗаработка = СформироватьТаблицуЗаработка(СписокФизЛиц, Истина, СтрокаДвижений.Организация, НачалоМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.ПодразделениеОрганизации, 
						//													ТЗОтработанноеВремя, СтрокаДвижений.Регистратор, СтрокаДвижений.БазовыйПериодНачало, СтрокаДвижений.БазовыйПериодКонец);
						ТЗОтработанноеВремя = ПолучитьОтработанноеВремяДляРасчетаППС(СтрокаДвижений.Организация,СтрокаДвижений.ПериодРегистрации,СписокСотрудников,ТЗСводныйТабель,Истина,
																						Нач, Кон); 
						ТЗТаблицаЗаработка = СформироватьТаблицуЗаработка(СписокФизЛиц, Истина, СтрокаДвижений.Организация, НачалоМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.ПодразделениеОрганизации, 
																			ТЗОтработанноеВремя, СтрокаДвижений.Регистратор, Нач, Кон);
						//Аверсон СВФР-017026													
																			
						НужнаяСтр = ТЗТаблицаЗаработка.Найти(СтрокаДвижений.ФизЛицо, "ФизЛицо");
						Если НужнаяСтр = Неопределено Тогда
							БазаНачислено = 0;
						Иначе
							БазаНачислено = НужнаяСтр.Результат;
						КонецЕсли;
						
						//Сравнить ее с ограничением
						ВидНалогообложенияОрг = СтрокаДвижений.Организация.ОсновнаяСтавкаНалогообложения;
						ВидНалогообложенияСотр = СтрокаДвижений.Сотрудник.ВидНалогообложенияОсновной;
						Если ВидНалогообложенияСотр = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
							ВидНалогообложения = ВидНалогообложенияОрг;
						иначе
							ВидНалогообложения = ВидНалогообложенияСотр;
						КонецЕсли;
						
						РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации - 86400,
						Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
						СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
						СтрокаДвижений.Организация, Перечисления.ВидыОтчисленийСФОТиЗП.ППС, ВидНалогообложения));
						БазаОграничение = СтруктураПенс.ОграничениеПоДоходам * РазмерСреднейЗарплаты;
						
						БазаРезультат = Мин(БазаОграничение, БазаНачислено);
						
						//Рассчитать результат
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(БазаРезультат * СтрокаДвижений[ПоказательРазмер] / 100, Константы.ВалютаРегламентированногоУчета.Получить());
						
					//Аверсон СВФР-016381
						
					иначе
						////Островская 16.03.2014 №
						//если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
						//	Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЗначениеЗаполнено(БазаЗамещение),БазаЗамещение,ИсходныеДанные.РезультатБаза) * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
						//иначе
						Если ИсходныеДанные.ВидРасчета.ПериодДействияБазовый = ЛОжь и СтрокаДвижений.ПериодРегистрации = Дата(2016,07,01) и ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") тогда 
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РезультатБаза/10000 * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
						Иначе
							
							//Аверсон ЕАЕ 22.04.2022 СВФР-008969
							
							//Аверсон ЕАЕ 22.04.2022 СВФР-009077
							//вид расчета, который рассчитываем
							ТЗПериодыНачисления = ПолучитьПериодыНачисления(СтрокаДвижений.Сотрудник, ИсходныеДанные.ВидРасчета, НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации));
							ТЗПериодыНачисления.Свернуть("Сотрудник,ВидРасчета,Показатель1");
							
							//вид расчета Оклад
							ТЗПериодыНачисления1 = Новый ТаблицаЗначений;
							Если ЗначениеЗаполнено(ВидРасчета1) Тогда
								ТЗПериодыНачисления1 = ПолучитьПериодыНачисления(СтрокаДвижений.Сотрудник, ВидРасчета1, НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								ТЗПериодыНачисления1.Свернуть("Сотрудник,ВидРасчета,Показатель1");
							КонецЕсли;
							//Аверсон СВФР-009077
							
							Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") И
								ИсходныеДанные.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом И
								ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") И
								(ИсходныеДанные.ПериодДействияНачало <> НачалоМесяца(СтрокаДвижений.ПериодРегистрации) ИЛИ 
								ИсходныеДанные.ПериодДействияКонец <> КонецМесяца(СтрокаДвижений.ПериодРегистрации)) 
								И ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам 
								И ЗначениеЗаполнено(ВидРасчета1) 
								
								//Аверсон ЕАЕ 22.04.2022 СВФР-009077
								И ТЗПериодыНачисления.Количество() = 1
								И ТЗПериодыНачисления1.Количество() = 1
								//Аверсон СВФР-009077
								
								Тогда
								
								//Рассчитываем базу за месяц, т.к. в этой строке она рассчитана за период действия (меньше месяца)
								РезультатБазаЗаМесяц = 0;
								З = Новый Запрос;
								З.Текст = "ВЫБРАТЬ
								|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
								|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.Результат) КАК Результат
								|ИЗ
								|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
								|ГДЕ
								|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &НачДата И &КонДата
								|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
								|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
								|   И ОсновныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор
								|СГРУППИРОВАТЬ ПО
								|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета
								|
								|ОБЪЕДИНИТЬ ВСЕ
								|
								|ВЫБРАТЬ
								|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
								|	СУММА(ДополнительныеНачисленияРаботниковОрганизаций.Результат)
								|ИЗ
								|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
								|ГДЕ
								|	ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &НачДата И &КонДата
								|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
								|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
								|   И ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор
								|СГРУППИРОВАТЬ ПО
								|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета
								|";
								З.УстановитьПараметр("НачДата",НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
								З.УстановитьПараметр("КонДата",КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								З.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);
								З.УстановитьПараметр("ВидРасчета",ИсходныеДанные.ВидРасчета.БазовыеВидыРасчета.ВыгрузитьКолонку("ВидРасчета"));
								З.УстановитьПараметр("Регистратор", ИсходныеДанные.Регистратор);
								ТЗЗ = З.Выполнить().Выгрузить();
								Для Каждого СтрТЗЗ ИЗ ТЗЗ Цикл
									РезультатБазаЗаМесяц = РезультатБазаЗаМесяц + СтрТЗЗ.Результат;	
								КонецЦикла;
								
								//Количество отработанных дней за месяц берем из строки с первичным начислением
								ОтработанныхЧасовВМесяце = 0;
								Запрос = Новый Запрос;
								Запрос.Текст = 
								"ВЫБРАТЬ РАЗРЕШЕННЫЕ
								|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
								|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
								|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноЧасов) КАК ОтработаноЧасов
								|ИЗ
								|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
								|ГДЕ
								|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор = &Ссылка
								|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = &ВидРасчета1
								|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
								|
								|СГРУППИРОВАТЬ ПО
								|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
								|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета";
								
								Запрос.УстановитьПараметр("ВидРасчета1", ВидРасчета1);
								Запрос.УстановитьПараметр("Ссылка", ИсходныеДанные.Регистратор);
								Запрос.УстановитьПараметр("Сотрудник", ИсходныеДанные.Сотрудник);
								
								РезультатЗапроса = Запрос.Выполнить();
								
								ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
								
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									ОтработанныхЧасовВМесяце = ОтработанныхЧасовВМесяце + ВыборкаДетальныеЗаписи.ОтработаноЧасов;
								КонецЦикла;
								
								//Прибавляем к количеству отработанных часов количество часов командировок (за период в этой строке)
								ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
								Если ТЗКолвоДнКом.Количество() > 0 Тогда
									Для Каждого Стр Из ТЗКолвоДнКом Цикл
										Если Стр.Дней > 0 Тогда
											мОтработаноЧасов = мОтработаноЧасов + Стр.Часов;
										КонецЕсли;
									КонецЦикла;
								КонецЕсли;
								
								Если ОтработанныхЧасовВМесяце = 0 Тогда
									РезультатБазаЗаПериод = 0;
								Иначе
									РезультатБазаЗаПериод = РезультатБазаЗаМесяц / ОтработанныхЧасовВМесяце * мОтработаноЧасов;
								КонецЕсли;
								
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(РезультатБазаЗаПериод * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
							Иначе	
								//Аверсон СВФР-008969							
								//Аверсон 02.06.2021 КВВ СВФР-007641 (
								СнятьСумму = 0;
								//Аверсон ЕАЕ 02.09.2024 СВФР-013681 закомментировано
								//Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") И
								//	ИсходныеДанные.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом И
								//	ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") И
								//	ИсходныеДанные.ВидРасчета.ВидПремии = Перечисления.ВидыПремии.НеПремия Тогда
								//	З = Новый Запрос;
								//	З.Текст = "ВЫБРАТЬ
								//	|ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
								//	|ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
								//	|ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
								//	|ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,
								//	|СУММА(ОсновныеНачисленияРаботниковОрганизаций.Результат) КАК Результат
								//	|ИЗ
								//	|РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
								//	|ГДЕ
								//	|НЕ (ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &НачДата И &КонДата)
								//	|И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,МЕСЯЦ) =  &НачДата
								//	|И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
								//	|И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
								//	|СГРУППИРОВАТЬ ПО
								//	|ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
								//	|ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
								//	|ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
								//	|ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец
								//	|
								//	|ОБЪЕДИНИТЬ ВСЕ
								//	|
								//	|ВЫБРАТЬ
								//	|ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
								//	|ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
								//	|ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
								//	|ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
								//	|СУММА(ДополнительныеНачисленияРаботниковОрганизаций.Результат)
								//	|ИЗ
								//	|РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
								//	|ГДЕ
								//	|НЕ (ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &НачДата И &КонДата)
								//	|И НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,МЕСЯЦ) =  &НачДата
								//	|И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
								//	|И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник	
								//	|СГРУППИРОВАТЬ ПО
								//	|ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
								//	|ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
								//	|ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
								//	|ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец							
								//	|";
								//	З.УстановитьПараметр("НачДата",НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
								//	З.УстановитьПараметр("КонДата",КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								//	З.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);
								//	З.УстановитьПараметр("ВидРасчета",ИсходныеДанные.ВидРасчета.БазовыеВидыРасчета.ВыгрузитьКолонку("ВидРасчета"));
								//	ТЗЗ = З.Выполнить().Выгрузить();
								//	Для Каждого СтрТЗЗ ИЗ ТЗЗ Цикл
								//		СнятьСумму = СнятьСумму + СтрТЗЗ.Результат;	
								//	КонецЦикла;
								//КонецЕсли;
								//Аверсон СВФР-013681 закомментировано
								//Аверсон 02.06.2021 КВВ СВФР-007641 )
								
								
								//Аверсон ЕАЕ 08.02.2024 СВФР-012254 
								//Климовичи (премии)
								Если СтрокаДвижений.Организация.ИНН = "700103211" И ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") И
									ИсходныеДанные.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом И
									ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ПремииРаботниковОрганизаций") И
									(ИсходныеДанные.ВидРасчета.ВидПремии = Перечисления.ВидыПремии.ГодоваяПремия ИЛИ
									ИсходныеДанные.ВидРасчета.ВидПремии = Перечисления.ВидыПремии.ПолугодоваяПремия ИЛИ 
									ИсходныеДанные.ВидРасчета.ВидПремии = Перечисления.ВидыПремии.КвартальнаяПремия) Тогда
									Если СтрокаДвижений.ЧислоМесяцев = 0 Тогда
										Результат = 0;
									Иначе
										Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РезультатБаза / СтрокаДвижений.ЧислоМесяцев * СтрокаДвижений[ПоказательРазмер] / 100,Константы.ВалютаРегламентированногоУчета.Получить());
									КонецЕсли;	
								ИначеЕсли ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") и ИсходныеДанные.ВидРасчета.Годовая Тогда //СВФР-013637
									Коэф = 1;
									//Стажевый Коэффициент
									СтруктураРасчета = Новый Структура;
									СтруктураРасчета.Вставить("ВидРасчета", ИсходныеДанные.ВидРасчета);
									СтруктураРасчета.Вставить("Сотрудник", ИсходныеДанные.Сотрудник);
									СтруктураРасчета.Вставить("ДатаСравнения", КонецДня(ИсходныеДанные.Регистратор.ДатаОкончанияБП));
									Коэф = ПроведениеРасчетов.ПолучитьПроцентПоШкалеСтажа(СтруктураРасчета,,Истина);
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РезультатБаза  *Коэф* СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
								Иначе
								//Аверсон СВФР-012254 									
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РезультатБаза - СнятьСумму) * СтрокаДвижений[ПоказательРазмер]/100,Константы.ВалютаРегламентированногоУчета.Получить());
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Островская 16.03.2014 №
						ОтобразитьОплачиваемоеВремяВДокументе( СтрокаДвижений, ИсходныеДанные ); //+ СВЭЙ КДЯ 03.12.19 СВФР-005157
					КонецЕсли;
					//О.Т. 30.07.2014 № 135
					Если Не ИсходныеДанные.ВидРасчетаПериодДействияБазовый Тогда
						НормаВремени = ИсходныеДанные.НормаВремениЗаМесяц;
						СообщениеОбОшибке = Ложь;
						ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
						Если НЕ СообщениеОбОшибке И НормаВремени = 0 Тогда
							ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
						КонецЕсли;
						//Островская Татьяна 17.06.2013 № 16561
						если ВидРасчета.ПериодДействияБазовый Тогда 
							Если НормаВремени = 0 Тогда
								Результат = 0;
							Иначе
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Результат * ОтработаноВремениОсновное / НормаВремени,Константы.ВалютаРегламентированногоУчета.Получить());
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 17.06.2013 № 16561
						СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1);
					КонецЕсли;
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Процент оплаты: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
						Если Не ИсходныеДанные.ВидРасчетаПериодДействияБазовый Тогда
							ОбщегоНазначения.КомментарийРасчета("Отработанное время: " + ИсходныеДанные.ОтработаноВремени, КомментарийВидаРасчета);
							ОбщегоНазначения.КомментарийРасчета("Норма времени: " + ИсходныеДанные.НормаВремениЗаМесяц, КомментарийВидаРасчета);
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			// ИсполнительныйЛистПроцентом
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом Тогда
			
			// Размер - процент удержания
			//толик
			мБаза = ПрочиеПроцедуры.ПолучитьБазу(СтрокаДвижений.ФизЛицо, СтрокаДвижений.ПериодРегистрации, СтрокаДвижений.ВидРасчета);
			
			//			Если ИсходныеДанные.РезультатБаза = NULL Тогда
			Если мБаза = 0 Тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления");
				
			Иначе
				ИсчисленныйНалог 			= ?(ИсходныеДанные.ИсчисленныйНалог = Null, 0, ИсходныеДанные.ИсчисленныйНалог);
				УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
				
				//О.Т. Аверсон 27.06.2018 № 2094 				
				ДатаРождПроверка = НачалоМесяца(Дата(Год(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка)+18,Месяц(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка),День(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка)));
				
				Если ДатаРождПроверка = СтрокаДвижений.ПериодРегистрации Тогда
					Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((мБаза - ИсчисленныйНалог)/День(КонецМесяца(СтрокаДвижений.ПериодРегистрации))* (День(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка)-1) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());
				иначе
					//				Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((ИсходныеДанные.РезультатБаза - ИсчисленныйНалог) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());
					Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((мБаза - ИсчисленныйНалог) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());				
				КонецЕсли;
				//О.Т. Аверсон 27.06.2018 № 2094
				
				
				Если КомментироватьРасчет Тогда
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					ОбщегоНазначения.КомментарийРасчета("Подоходный налог за текущий период: " + ИсчисленныйНалог, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
				КонецЕсли;
				//О.Т. Аверсон 19.10.2016 № 1490
				Если ЗначениеЗаполнено(СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума) Тогда 
					РазмерБПМ = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер; 
					Если Результат < РазмерБПМ * СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума/100 - УжеНачисленоВТекущемПериоде Тогда //О.Т. Аверсон 18.05.2017 № 653 (- УжеНачисленоВТекущемПериоде)
						Сообщить("Расчетная величина по документу "+ Строка(СтрокаДвижений.ДокументОснование)+" меньше "+ Строка(СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума)+"%");
						Если РазмерБПМ * СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума/100 - УжеНачисленоВТекущемПериоде < 0 тогда //О.Т. Аверсон 18.05.2017 № 653
							Результат = 0; //О.Т. Аверсон 18.05.2017 № 653
						иначе
							Результат = РазмерБПМ * СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума/100 - УжеНачисленоВТекущемПериоде;
						КонецЕсли;
					КонецЕсли;
					
				КонецЕсли;
				//О.Т. Аверсон 19.10.2016 № 1490
				
			КонецЕсли;
			
			//О.Т. Аверсон 24.05.2017 № 665
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой Тогда
			
			// Размер - процент удержания
			//толик
			мБаза = ПрочиеПроцедуры.ПолучитьБазу(СтрокаДвижений.ФизЛицо, СтрокаДвижений.ПериодРегистрации, СтрокаДвижений.ВидРасчета);
			
			ЗапросПоАмортизации = Новый Запрос;
			ЗапросПоАмортизации.Текст = 
			"ВЫБРАТЬ
			|	ДанныеПоАмортизацииАвтомобилейСрезПоследних.СуммаВыплаты
			|ИЗ
			|	РегистрСведений.ДанныеПоАмортизацииАвтомобилей.СрезПоследних КАК ДанныеПоАмортизацииАвтомобилейСрезПоследних
			|ГДЕ
			|	ДанныеПоАмортизацииАвтомобилейСрезПоследних.Сотрудник = &Сотрудник
			|	И ДанныеПоАмортизацииАвтомобилейСрезПоследних.Организация = &Организация
			|	И ДанныеПоАмортизацииАвтомобилейСрезПоследних.Период МЕЖДУ &Период И &Период1";
			
			ЗапросПоАмортизации.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
			ЗапросПоАмортизации.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
			ЗапросПоАмортизации.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
			ЗапросПоАмортизации.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			
			РезультатПоАмортизации = ЗапросПоАмортизации.Выполнить().Выбрать();		
			СуммаВыплатыПоАмортизации = 0;
			Пока РезультатПоАмортизации.Следующий() Цикл
				СуммаВыплатыПоАмортизации = СуммаВыплатыПоАмортизации + РезультатПоАмортизации.СуммаВыплаты;
			КонецЦикла;
			мБаза = мБаза + СуммаВыплатыПоАмортизации;
			
			//			Если ИсходныеДанные.РезультатБаза = NULL Тогда
			Если мБаза = 0 Тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления");
				
			Иначе
				
				Запрос = Новый запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	Сумма(ЕСНИсчисленный.ПенсионныйФонд)
				|ИЗ
				|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
				|			Удержания.НомерСтроки КАК НомерСтроки,
				|			Удержания.ФизЛицо КАК Физлицо,
				|			НАЧАЛОПЕРИОДА(Удержания.БазовыйПериодНачало, МЕСЯЦ) КАК МесяцУдержания
				|		ИЗ
				|			РегистрРасчета.УдержанияРаботниковОрганизаций КАК Удержания
				|		ГДЕ
				|			Удержания.ВидРасчета = &ВидРасчета
				|			И Удержания.Регистратор = &парамРегистратор
				|			И Удержания.Сотрудник = &Сотрудник) КАК РаботникиОрганизации
				|		ПО ЕСНИсчисленный.ФизЛицо = РаботникиОрганизации.Физлицо
				|			И (НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ) = РаботникиОрганизации.МесяцУдержания)
				|ГДЕ
				|	ЕСНИсчисленный.Организация = &парамОрганизация
				|	И РаботникиОрганизации.НомерСтроки = &НомерСтроки
				|
				|СГРУППИРОВАТЬ ПО
				|	РаботникиОрганизации.НомерСтроки";
				//|	ЕСНИсчисленный.ПенсионныйФонд"; //О.Т. Аверсон 29.12.2017 № 1398 (не суммировались одинаковые суммы)
				Запрос.УстановитьПараметр("парамОрганизация",СтрокаДвижений.Организация);
				Запрос.УстановитьПараметр("парамРегистратор",СтрокаДвижений.Регистратор);
				Запрос.УстановитьПараметр("ВидРасчета", СтрокаДвижений.ВидРасчета);
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);//О.Т. Аверсон 04.09.2017 № 984 
				Запрос.УстановитьПараметр("НомерСтроки", СтрокаДвижений.НомерСтроки);//О.Т. Аверсон 18.04.2018 № 1850
				
				
				Результ = Запрос.Выполнить().Выбрать();
				ПенсионныйФонд = 0;
				Пока Результ.Следующий() Цикл 
					ПенсионныйФонд = ПенсионныйФонд + Результ.ПенсионныйФонд;
				КонецЦикла;                                                  				
				
				ИсчисленныйНалог 			= ?(ИсходныеДанные.ИсчисленныйНалог = Null, 0, ИсходныеДанные.ИсчисленныйНалог);
				УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
				///////////////////////////////////////////////////////////
				//Аверсон ЕАЕ 11.12.2025 СВФР-017402
				СуммаБЛ = 0;
				Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ Тогда
					ЗапросНеРазбиватьУдержанияПоПериодам = Новый Запрос;
					ЗапросНеРазбиватьУдержанияПоПериодам.Текст = "ВЫБРАТЬ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.НеРазбиватьУдержанияПоПериодам
					|ИЗ
					|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
					|ГДЕ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
					ЗапросНеРазбиватьУдержанияПоПериодам.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
					РезНеРазбиватьУдержанияПоПериодам = ЗапросНеРазбиватьУдержанияПоПериодам.Выполнить().Выбрать();
					если РезНеРазбиватьУдержанияПоПериодам.Следующий() Тогда 
						ФлНеРазбиватьУдержанияПоПериодам = РезНеРазбиватьУдержанияПоПериодам.НеРазбиватьУдержанияПоПериодам; 
					иначе
						ФлНеРазбиватьУдержанияПоПериодам = Ложь;
					КонецЕсли;
					Если ФлНеРазбиватьУдержанияПоПериодам = Истина Тогда
						Если ТипЗнч(СтрокаДвижений.ДокументОснование) = Тип("ДокументСсылка.ИсполнительныйЛист") Тогда
							ИспЛист = СтрокаДвижений.ДокументОснование;
							Если ИспЛист.УчитыватьБольничныеЛисты = Ложь Тогда
								БазовыеНачисления = ИсходныеДанные.ВидРасчета.БазовыеВидыРасчета.ВыгрузитьКолонку("ВидРасчета");
								
								Запрос = Новый Запрос;
								Запрос.Текст = 
								"ВЫБРАТЬ РАЗРЕШЕННЫЕ
								|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
								|   ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
								|	ОсновныеНачисленияРаботниковОрганизаций.Результат
								|ИЗ
								|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
								|ГДЕ
								|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
								|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &Нач И &Кон
								|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&БазовыеНачисления)
								|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &СпособРасчетаПоСреднемуЗаработкуФСЗН
								|
								|ОБЪЕДИНИТЬ ВСЕ
								|
								|ВЫБРАТЬ
								|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
								|   ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
								|	ДополнительныеНачисленияРаботниковОрганизаций.Результат
								|ИЗ
								|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
								|ГДЕ
								|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
								|	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &Нач И &Кон
								|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета В(&БазовыеНачисления)
								|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &СпособРасчетаПоСреднемуЗаработкуФСЗН
								|	";
								
								Запрос.УстановитьПараметр("БазовыеНачисления", БазовыеНачисления);
								Запрос.УстановитьПараметр("Нач", НачалоМесяца(СтрокаДвижений.ПериодРегистрации)); 
								Запрос.УстановитьПараметр("Кон", КонецМесяца(СтрокаДвижений.ПериодРегистрации)); 
								Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
								Запрос.УстановитьПараметр("СпособРасчетаПоСреднемуЗаработкуФСЗН", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
								
								РезультатЗапроса = Запрос.Выполнить();
								
								ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
								
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									СуммаБЛ = СуммаБЛ + ВыборкаДетальныеЗаписи.Результат; 
								КонецЦикла;
								НовыйПН = 0;
								Если ИсчисленныйНалог <> 0 и СуммаБЛ <> 0 Тогда  //рассчитаем удельный вес пн в сумме всего дохода без БЛ
									НовыйПН = ОбщегоНазначения.ОкруглитьПоВалюте((мБаза- СуммаБЛ)* ИсчисленныйНалог/мБаза,Константы.ВалютаРегламентированногоУчета.Получить());
									ИсчисленныйНалог = НовыйПН; 
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				//Аверсон СВФР-017402
				///////////////////////////////////////////////////////////
				//				Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((ИсходныеДанные.РезультатБаза - ИсчисленныйНалог) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());
				Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой Тогда
					Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(Мин((мБаза - ИсчисленныйНалог - ПенсионныйФонд),СтрокаДвижений[ПоказательРазмер]) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());
				иначе
					//О.Т. Аверсон 27.06.2018 № 2094 				
					ДатаРождПроверка = НачалоМесяца(Дата(Год(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка)+18,Месяц(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка),День(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка)));
					
					Если ДатаРождПроверка = СтрокаДвижений.ПериодРегистрации Тогда
						//Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((мБаза - ИсчисленныйНалог - ПенсионныйФонд)/День(КонецМесяца(СтрокаДвижений.ПериодРегистрации))* День(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());
						
						//Аверсон ЕАЕ 11.12.2025 СВФР-017402
						//Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((мБаза - ИсчисленныйНалог - ПенсионныйФонд)/День(КонецМесяца(СтрокаДвижений.ПериодРегистрации))* День(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка-1) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());    // не вкл совершеннолетие
						Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((мБаза - СуммаБЛ - ИсчисленныйНалог - ПенсионныйФонд) / День(КонецМесяца(СтрокаДвижений.ПериодРегистрации)) * День(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка-1) * СтрокаДвижений[ПоказательРазмер] / 100) - УжеНачисленоВТекущемПериоде, 0), Константы.ОкруглениеСуммДляПеречислений.Получить());    // не вкл совершеннолетие
						//Аверсон СВФР-017402
						
					иначе
						
						//Аверсон ЕАЕ 11.12.2025 СВФР-017402 
						//Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((мБаза - ИсчисленныйНалог - ПенсионныйФонд) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());			
						Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс(((мБаза - СуммаБЛ - ИсчисленныйНалог - ПенсионныйФонд) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0),Константы.ОкруглениеСуммДляПеречислений.Получить());			
						//Аверсон СВФР-017402
						
						Если СтрокаДвижений.БазовыйПериодНачало <> НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало) Тогда
							РазностьДни = (КонецМесяца(СтрокаДвижений.БазовыйПериодНачало)-СтрокаДвижений.БазовыйПериодНачало+1)/60/60/24;
							Результат = ОбщегоНазначения.ОкруглитьРезультат(Результат/Число(Лев(СтрокаДвижений.БазовыйПериодКонец,2))* РазностьДни,Константы.ОкруглениеСуммДляПеречислений.Получить());
						КонецЕсли;
					КонецЕсли;
					//О.Т. Аверсон 27.06.2018 № 2094
					
					
				КонецЕсли;
				
				Если КомментироватьРасчет Тогда
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					ОбщегоНазначения.КомментарийРасчета("Подоходный налог за текущий период: " + ИсчисленныйНалог, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Пенсионный фонд за текущий период: " + ПенсионныйФонд, КомментарийВидаРасчета); //О.Т. Аверсон 07.09.2017 № 1007
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
				КонецЕсли;
				//О.Т. Аверсон 19.10.2016 № 1490
				Если ЗначениеЗаполнено(СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума) Тогда 
					РазмерБПМ = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер; 
					Если Результат < РазмерБПМ * СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума/100 - УжеНачисленоВТекущемПериоде Тогда //О.Т. Аверсон 18.05.2017 № 653 (- УжеНачисленоВТекущемПериоде)
						Сообщить("Расчетная величина по документу "+ Строка(СтрокаДвижений.ДокументОснование)+" меньше "+ Строка(СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума)+"%");
						Если РазмерБПМ * СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума/100 - УжеНачисленоВТекущемПериоде < 0 тогда //О.Т. Аверсон 18.05.2017 № 653
							Результат = 0; //О.Т. Аверсон 18.05.2017 № 653
						иначе
							Результат = РазмерБПМ * СтрокаДвижений.ДокументОснование.ПроцентПрожиточногоМинимума/100 - УжеНачисленоВТекущемПериоде;
						КонецЕсли;
					КонецЕсли;
					
				КонецЕсли;
				//О.Т. Аверсон 19.10.2016 № 1490
				
			КонецЕсли;
			
			//ИсполнительныйЛистПроцентомСНДФЛ	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ Тогда
			
			// Размер - процент удержания
			//толик
			мБаза = ПрочиеПроцедуры.ПолучитьБазу(СтрокаДвижений.ФизЛицо, СтрокаДвижений.ПериодРегистрации, СтрокаДвижений.ВидРасчета);
			
			//			Если ИсходныеДанные.РезультатБаза = NULL Тогда
			Если мБаза = 0 Тогда
				Сообщить(""+СтрокаДвижений.Физлицо + "; " + ВидРасчета + ": Не определены базовые начисления ", СтатусСообщения.Важное);
			Иначе
				
				УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
				
				
				//О.Т. Аверсон 27.06.2018 № 2094 				
				ДатаРождПроверка = НачалоМесяца(Дата(Год(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка)+18,Месяц(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка),День(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка)));
				
				Если ДатаРождПроверка = СтрокаДвижений.ПериодРегистрации Тогда					
					Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс((мБаза/День(КонецМесяца(СтрокаДвижений.ПериодРегистрации))* День(СтрокаДвижений.ДокументОснование.ДатаРожденияРебенка) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0), Константы.ОкруглениеСуммДляПеречислений.Получить());
				иначе
					//				Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс((ИсходныеДанные.РезультатБаза * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0), Константы.ОкруглениеСуммДляПеречислений.Получить());
					Результат = ОбщегоНазначения.ОкруглитьРезультат(Макс((мБаза * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0), Константы.ОкруглениеСуммДляПеречислений.Получить());
				КонецЕсли;
				//О.Т. Аверсон 27.06.2018 № 2094
				
				Если КомментироватьРасчет Тогда
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
				КонецЕсли;
				
			КонецЕсли;
			
			// ИсполнительныйЛистПроцентомДоПредела
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела Тогда
			
			// Размер - процент удержания
			Если ИсходныеДанные.РезультатБаза = NULL Тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления ");
			Иначе
				
				ИсчисленныйНалог 			= ?(ИсходныеДанные.ИсчисленныйНалог = Null, 0, ИсходныеДанные.ИсчисленныйНалог);
				УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
				ПределПоДокументуОснованию  = ?(ИсходныеДанные.ПределПоДокументуОснованию = Null, 0 ,ИсходныеДанные.ПределПоДокументуОснованию);
				УжеНачисленоЗаВсюИсторию 	= ?(ИсходныеДанные.УжеНачисленоЗаВсюИсторию = Null, 0, ИсходныеДанные.УжеНачисленоЗаВсюИсторию);
				
				Результат = Макс(((ИсходныеДанные.РезультатБаза - ИсчисленныйНалог) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0);
				// Ограничим результат расчета в случае достижения предела удержания
				Результат = ОбщегоНазначения.ОкруглитьРезультат(Мин(Результат, ПределПоДокументуОснованию  - УжеНачисленоЗаВсюИсторию),Константы.ОкруглениеСуммДляПеречислений.Получить());
				
				Если КомментироватьРасчет Тогда
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					ОбщегоНазначения.КомментарийРасчета("Подоходный налог за текущий период: " + ИсчисленныйНалог, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Предел по документу основанию: " + ПределПоДокументуОснованию, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено за всю историю: " + УжеНачисленоЗаВсюИсторию, КомментарийВидаРасчета);
				КонецЕсли;
				
			КонецЕсли;
			
			
			//О.Т. Аверсон 24.05.2017 № 665
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой Тогда
			
			//О.Т. Аверсон 27.02.2018 № 1658
			ЗапросПоАмортизации = Новый Запрос;
			ЗапросПоАмортизации.Текст = 
			"ВЫБРАТЬ
			|	ДанныеПоАмортизацииАвтомобилейСрезПоследних.СуммаВыплаты
			|ИЗ
			|	РегистрСведений.ДанныеПоАмортизацииАвтомобилей.СрезПоследних КАК ДанныеПоАмортизацииАвтомобилейСрезПоследних
			|ГДЕ
			|	ДанныеПоАмортизацииАвтомобилейСрезПоследних.Сотрудник = &Сотрудник
			|	И ДанныеПоАмортизацииАвтомобилейСрезПоследних.Организация = &Организация
			|	И ДанныеПоАмортизацииАвтомобилейСрезПоследних.Период МЕЖДУ &Период И &Период1";
			
			ЗапросПоАмортизации.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
			ЗапросПоАмортизации.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
			ЗапросПоАмортизации.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
			ЗапросПоАмортизации.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			
			РезультатПоАмортизации = ЗапросПоАмортизации.Выполнить().Выбрать();		
			СуммаВыплатыПоАмортизации = 0;
			Пока РезультатПоАмортизации.Следующий() Цикл
				СуммаВыплатыПоАмортизации = СуммаВыплатыПоАмортизации + РезультатПоАмортизации.СуммаВыплаты;
			КонецЦикла;
			//О.Т. Аверсон 27.02.2018 № 1658
			
			// Размер - процент удержания
			Если ИсходныеДанные.РезультатБаза = NULL и СуммаВыплатыПоАмортизации = 0 Тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления ");
			Иначе
				
				Запрос = Новый запрос;
				Запрос.Текст = 
				
				//Аверсон 23.01.2023 КВВ СВФР-010198 (
				
				//"ВЫБРАТЬ
				//|	ЕСНИсчисленный.ПенсионныйФонд
				//|ИЗ
				//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
				//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
				//|			Удержания.НомерСтроки КАК НомерСтроки,
				//|			Удержания.ФизЛицо КАК Физлицо,
				//|			НАЧАЛОПЕРИОДА(Удержания.БазовыйПериодНачало, МЕСЯЦ) КАК МесяцУдержания
				//|		ИЗ
				//|			РегистрРасчета.УдержанияРаботниковОрганизаций КАК Удержания
				//|		ГДЕ
				//|			Удержания.ВидРасчета = &ВидРасчета
				//|			И Удержания.Регистратор = &парамРегистратор";
				//
				////Аверсон 20.01.2023 КВВ СВФР-010198 (
				//Если ЗначениеЗаполнено(СтрокаДвижений.ДокументОснование) Тогда
				//	Запрос.Текст = Запрос.Текст + "
				//	|		И Удержания.ДокументОснование = &ДокументОснование";
				//КонецЕсли;
				//Запрос.Текст = Запрос.Текст + "
				////Аверсон 20.01.2023 КВВ СВФР-010198 )
				//
				//|			И Удержания.Сотрудник = &Сотрудник) КАК РаботникиОрганизации
				//|		ПО ЕСНИсчисленный.ФизЛицо = РаботникиОрганизации.Физлицо
				//|			И (НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ) = РаботникиОрганизации.МесяцУдержания)
				//|ГДЕ
				//|	ЕСНИсчисленный.Организация = &парамОрганизация
				//|
				//|СГРУППИРОВАТЬ ПО
				//|	РаботникиОрганизации.НомерСтроки,
				//|	ЕСНИсчисленный.ПенсионныйФонд";
				//Запрос.УстановитьПараметр("парамОрганизация",СтрокаДвижений.Организация);
				//Запрос.УстановитьПараметр("парамРегистратор",СтрокаДвижений.Регистратор);
				//Запрос.УстановитьПараметр("ВидРасчета", СтрокаДвижений.ВидРасчета);
				//Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				//Запрос.УстановитьПараметр("ДокументОснование", СтрокаДвижений.ДокументОснование);  //Аверсон 20.01.2023 КВВ СВФР-010198 
				
				"ВЫБРАТЬ
				|ЕСНИсчисленный.ПенсионныйФонд  
				|ИЗ РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
				|ГДЕ
				|ЕСНИсчисленный.Организация = &парамОрганизация
				|И ЕСНИсчисленный.ФизЛицо = &ФизЛицо
				|И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ) = &НужныйМесяц
				|СГРУППИРОВАТЬ ПО
				|ЕСНИсчисленный.ПенсионныйФонд";
				Запрос.УстановитьПараметр("парамОрганизация",СтрокаДвижений.Организация);
				Запрос.УстановитьПараметр("ФизЛицо", СтрокаДвижений.Сотрудник.ФизЛицо);
				Запрос.УстановитьПараметр("НужныйМесяц", НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало));
				
				//Аверсон 23.01.2023 КВВ СВФР-010198 )
				
				Результ = Запрос.Выполнить().Выбрать();
				ПенсионныйФонд = 0;
				Пока Результ.Следующий() Цикл 
					ПенсионныйФонд = ПенсионныйФонд + Результ.ПенсионныйФонд;
				КонецЦикла;                                                    				
				
				
				ИсчисленныйНалог 			= ?(ИсходныеДанные.ИсчисленныйНалог = Null, 0, ИсходныеДанные.ИсчисленныйНалог);
				УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
				ПределПоДокументуОснованию  = ?(ИсходныеДанные.ПределПоДокументуОснованию = Null, 0 ,ИсходныеДанные.ПределПоДокументуОснованию);
				УжеНачисленоЗаВсюИсторию 	= ?(ИсходныеДанные.УжеНачисленоЗаВсюИсторию = Null, 0, ИсходныеДанные.УжеНачисленоЗаВсюИсторию);
				
				
				Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой Тогда
					Результат = Макс(Мин((ИсходныеДанные.РезультатБаза + СуммаВыплатыПоАмортизации - ИсчисленныйНалог - ПенсионныйФонд), СтрокаДвижений[ПоказательРазмер])- УжеНачисленоВТекущемПериоде, 0);
				иначе
					Результат = Макс(((ИсходныеДанные.РезультатБаза + СуммаВыплатыПоАмортизации - ИсчисленныйНалог - ПенсионныйФонд) * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0);
				КонецЕсли;
				// Ограничим результат расчета в случае достижения предела удержания
				Результат = ОбщегоНазначения.ОкруглитьРезультат(Мин(Результат, ПределПоДокументуОснованию  - УжеНачисленоЗаВсюИсторию),Константы.ОкруглениеСуммДляПеречислений.Получить());
				
				Если КомментироватьРасчет Тогда
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					ОбщегоНазначения.КомментарийРасчета("Подоходный налог за текущий период: " + ИсчисленныйНалог, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Пенсионный фонд за текущий период: " + ПенсионныйФонд, КомментарийВидаРасчета);//О.Т. Аверсон 07.09.2017 № 1007
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Предел по документу основанию: " + ПределПоДокументуОснованию, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено за всю историю: " + УжеНачисленоЗаВсюИсторию, КомментарийВидаРасчета);
				КонецЕсли;
				
			КонецЕсли;
			
			
			// ИсполнительныйЛистПроцентомДоПределаСНДФЛ
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПределаСНДФЛ Тогда
			
			// Размер - процент удержания
			Если ИсходныеДанные.РезультатБаза = NULL Тогда
				Сообщить(""+СтрокаДвижений.Физлицо + "; " + ВидРасчета + ": Не определены базовые начисления ", СтатусСообщения.Важное);
			Иначе
				
				УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
				ПределПоДокументуОснованию  = ?(ИсходныеДанные.ПределПоДокументуОснованию = Null, 0 ,ИсходныеДанные.ПределПоДокументуОснованию);
				УжеНачисленоЗаВсюИсторию 	= ?(ИсходныеДанные.УжеНачисленоЗаВсюИсторию = Null, 0, ИсходныеДанные.УжеНачисленоЗаВсюИсторию);
				
				Результат = Макс((ИсходныеДанные.РезультатБаза * СтрокаДвижений[ПоказательРазмер]/100) - УжеНачисленоВТекущемПериоде, 0);
				// Ограничим результат расчета в случае достижения предела удержания
				Результат = ОбщегоНазначения.ОкруглитьРезультат(Мин(Результат, ПределПоДокументуОснованию  - УжеНачисленоЗаВсюИсторию),Константы.ОкруглениеСуммДляПеречислений.Получить());
				
				Если КомментироватьРасчет Тогда
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					ОбщегоНазначения.КомментарийРасчета("Подоходный налог за текущий период: " + ИсчисленныйНалог, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Предел по документу основанию: " + ПределПоДокументуОснованию, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Ранее начислено за всю историю: " + УжеНачисленоЗаВсюИсторию, КомментарийВидаРасчета);
				КонецЕсли;
				
			КонецЕсли;
			//		
			// ИсполнительныйЛистФиксСуммойДоПредела
			//		
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела Тогда
			
			ПределПоДокументуОснованию  = ?(ИсходныеДанные.ПределПоДокументуОснованию = Null, 0 ,ИсходныеДанные.ПределПоДокументуОснованию);
			УжеНачисленоЗаВсюИсторию 	= ?(ИсходныеДанные.УжеНачисленоЗаВсюИсторию = Null, 0, ИсходныеДанные.УжеНачисленоЗаВсюИсторию);
			
			// Ограничим результат расчета в случае достижения предела удержания
			Результат = ОбщегоНазначения.ОкруглитьРезультат(Мин(СтрокаДвижений[ПоказательРазмер], ПределПоДокументуОснованию  - УжеНачисленоЗаВсюИсторию),Константы.ОкруглениеСуммДляПеречислений.Получить());
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Предел по документу основанию: " + ПределПоДокументуОснованию, КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Ранее начислено за всю историю: " + УжеНачисленоЗаВсюИсторию, КомментарийВидаРасчета);
			КонецЕсли;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПочтовыйСбор Тогда
			//Аверсон-софт, Островская Татьяна 31.08.2012 № 15766
			если ?(ЗначениеЗаполнено(ИсходныеДанные.ДокументОснованиеСсылка),ИсходныеДанные.ДокументОснованиеСсылка.ПроцентПочтовогоСбора > 0,Ложь) тогда
				ПроцентПочтовогоСбора = ИсходныеДанные.ДокументОснованиеСсылка.ПроцентПочтовогоСбора;
			иначе
				Сбор = 0;
				ЗапросШкала = новый Запрос;
				ЗапросШкала.Текст = 
				"ВЫБРАТЬ
				|	ШкалаПочтовогоСбораСрезПоследних.Период,
				|	ШкалаПочтовогоСбораСрезПоследних.НижнийПредел,
				|	ШкалаПочтовогоСбораСрезПоследних.ВерхнийПредел,
				|	ШкалаПочтовогоСбораСрезПоследних.Сбор
				|ИЗ
				|	РегистрСведений.ШкалаПочтовогоСбора.СрезПоследних КАК ШкалаПочтовогоСбораСрезПоследних
				|ГДЕ
				|	ШкалаПочтовогоСбораСрезПоследних.НижнийПредел <= &НижнийПредел
				|	И ШкалаПочтовогоСбораСрезПоследних.ВерхнийПредел >= &НижнийПредел";
				ЗапросШкала.УстановитьПараметр("НижнийПредел",ИсходныеДанные.РазмерПочтовогоПеревода );
				РезЗапрос = ЗапросШкала.Выполнить().Выгрузить();
				если РезЗапрос.Количество()>0 тогда
					Для й = РезЗапрос.Количество()по РезЗапрос.Количество() цикл
						НижнийПредел = РезЗапрос[й-1].НижнийПредел;
						ВерхнийПредел = РезЗапрос[й-1].ВерхнийПредел;
						Сбор = РезЗапрос[й-1].Сбор;
						й=й+1;
					КонецЦикла;
				КонецЕсли;
				ПроцентПочтовогоСбора = Сбор;
			КонецЕсли; 
			//Аверсон-софт, Островская Татьяна 31.08.2012 № 15766
			
			//Аверсон 07.07.2022 КВВ СВФР-008761 (
			УжеУдержаноПочтСбор = 0;
			ЗапросУжеУдержано = Новый Запрос;
			ЗапросУжеУдержано.Текст = "ВЫБРАТЬ 
			|СУММА(Уд.Результат) КАК Результат
			|ИЗ РегистрРасчета.УдержанияРаботниковОрганизаций КАК Уд
			|ГДЕ Уд.ФизЛицо = &ФизЛицо
			|И Уд.ВидРасчета = &ВидРасчета 
			|И Уд.ДокументОснование = &ДокументОснование
			|И НАЧАЛОПЕРИОДА(Уд.БазовыйПериодНачало,Месяц) = &ДатаНач";
			ЗапросУжеУдержано.УстановитьПараметр("ФизЛицо",ИсходныеДанные.Сотрудник);
			ЗапросУжеУдержано.УстановитьПараметр("ВидРасчета",ИсходныеДанные.ВидРасчета);
			ЗапросУжеУдержано.УстановитьПараметр("ДокументОснование",ИсходныеДанные.ДокументОснованиеСсылка);
			ЗапросУжеУдержано.УстановитьПараметр("ДатаНач",НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
			РезЗапросУжеУдержано = ЗапросУжеУдержано.Выполнить().Выгрузить();
			Если РезЗапросУжеУдержано.Количество() > 0 Тогда
				УжеУдержаноПочтСбор = РезЗапросУжеУдержано[0].Результат;
			КонецЕсли;
			УжеУдержаноПочтСбор = ?(НЕ ЗначениеЗаполнено(УжеУдержаноПочтСбор) И УжеУдержаноПочтСбор <>0,0,УжеУдержаноПочтСбор);
			//Аверсон 07.07.2022 КВВ СВФР-008761 )
			
			//Аверсон 13.07.2022 КВВ СВФР-008761 (
			Если УжеУдержаноПочтСбор <> 0 и ИсходныеДанные.ДокументОснованиеСсылка.ПроцентПочтовогоСбора=0 Тогда //пересчитаем заново процент с учетом обоих сумм алиментов
				Сбор = 0;
				ЗапросШкала = новый Запрос;
				ЗапросШкала.Текст = 
				"ВЫБРАТЬ
				|	ШкалаПочтовогоСбораСрезПоследних.Период,
				|	ШкалаПочтовогоСбораСрезПоследних.НижнийПредел,
				|	ШкалаПочтовогоСбораСрезПоследних.ВерхнийПредел,
				|	ШкалаПочтовогоСбораСрезПоследних.Сбор
				|ИЗ
				|	РегистрСведений.ШкалаПочтовогоСбора.СрезПоследних КАК ШкалаПочтовогоСбораСрезПоследних
				|ГДЕ
				|	ШкалаПочтовогоСбораСрезПоследних.НижнийПредел <= &НижнийПредел
				|	И ШкалаПочтовогоСбораСрезПоследних.ВерхнийПредел >= &НижнийПредел";
				ЗапросШкала.УстановитьПараметр("НижнийПредел",ИсходныеДанные.РазмерПочтовогоПеревода );
				РезЗапрос = ЗапросШкала.Выполнить().Выгрузить();
				если РезЗапрос.Количество()>0 тогда
					Для й = РезЗапрос.Количество()по РезЗапрос.Количество() цикл
						НижнийПредел = РезЗапрос[й-1].НижнийПредел;
						ВерхнийПредел = РезЗапрос[й-1].ВерхнийПредел;
						Сбор = РезЗапрос[й-1].Сбор;
						й=й+1;
					КонецЦикла;
				КонецЕсли;
				Если Сбор <> ПроцентПочтовогоСбора Тогда
					ПроцентПочтовогоСбора = Сбор; 
					СтрокаДвижений.Показатель1 = ПроцентПочтовогоСбора;
				КонецЕсли;
			КонецЕсли;
			//Аверсон 13.07.2022 КВВ СВФР-008761 )
			
			Результат = ОбщегоНазначения.ОкруглитьРезультат((ПроцентПочтовогоСбора / 100 * ИсходныеДанные.РазмерПочтовогоПеревода) - УжеУдержаноПочтСбор,Константы.ОкруглениеПочтовогоСбора.Получить()); //О.Т. Аверсон 25.11.2016 № 50  //Аверсон 07.07.2022 КВВ СВФР-008761 (УжеУдержаноПочтСбор)
			//Результат = Окр(Результат, -1,1);
			
			//О.Т. Аверсон 24.02.2017 № 339
			МинимальноеЗначениеПочтовогоСбора = Константы.МинимальноеЗначениеПочтовогоСбора.Получить();
			Если не (Результат = 0 и ИсходныеДанные.РазмерПочтовогоПеревода = 0) и ИсходныеДанные.ДокументОснованиеСсылка.ПроцентПочтовогоСбора=0 Тогда //О.Т. Аверсон 21.09.2017 № 1052 
				Если Результат < МинимальноеЗначениеПочтовогоСбора Тогда 
					Результат = МинимальноеЗначениеПочтовогоСбора;
				КонецЕсли;
			КонецЕсли;
			//О.Т. Аверсон 24.02.2017 № 339
			
			ОбщегоНазначения.ОкруглитьРезультат(1025422.145,Константы.ОкруглениеПочтовогоСбора.Получить());
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Размер почтового перевода: " + ИсходныеДанные.РазмерПочтовогоПеревода, КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Процент почтового сбора: " + ПроцентПочтовогоСбора, КомментарийВидаРасчета);
			КонецЕсли;
			
			// УдержаниеФиксированнойСуммой
			//		
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеФиксированнойСуммой Тогда
			
			УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
			// Размер - сумма удержания 
			// за месяц должно удержаться ровно столько, сколько указано в документе
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] - УжеНачисленоВТекущемПериоде,Константы.ВалютаРегламентированногоУчета.Получить());
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Размер удержания: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
			КонецЕсли;
			
			// ФиксированнойСуммой
			// ПоДоговоруФиксированнойСуммой
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой Тогда
			// Размер - сумма доплаты
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер],Константы.ВалютаРегламентированногоУчета.Получить());
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Размер начисления: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
			КонецЕсли;
			
			// НулеваяСумма
			//		
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.НулеваяСумма Тогда
			// Ничего не считаем 
			
			// ПоМесячнойТарифнойСтавкеПоДням
			// ПоМесячнойТарифнойСтавкеПоЧасам
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням или 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням или 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам Тогда   
			
			//Аверсон ЕАЕ 27.12.2020 СВФР-006994 (для Оклад по по ням и Оклад по часам)
			Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням ИЛИ 
				СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам Тогда
				
				Организация = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "ОсновнаяОрганизация");
				
				Отработано = 0;
				
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноЧасов) КАК ОтработаноЧасов,
				|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноДней) КАК ОтработаноДней
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ПовременнаяОплатаПриСделке
				|	И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(&ПериодРегистрации,ДЕНЬ)
				|	И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(&ПериодРегистрации1,ДЕНЬ)
				|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация";
				
				Запрос.УстановитьПараметр("Организация", Организация);
				Запрос.УстановитьПараметр("ПериодРегистрации", СтрокаДвижений.ПериодДействияНачало);
				Запрос.УстановитьПараметр("ПериодРегистрации1", СтрокаДвижений.ПериодДействияКонец);
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				
				РезультатЗапроса = Запрос.Выполнить();
				
				ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням Тогда
						Отработано = ?(ВыборкаДетальныеЗаписи.ОтработаноДней = NULL,0,ВыборкаДетальныеЗаписи.ОтработаноДней);
					Иначе
						Отработано = ?(ВыборкаДетальныеЗаписи.ОтработаноЧасов = NULL,0,ВыборкаДетальныеЗаписи.ОтработаноЧасов);
					КонецЕсли;
				КонецЦикла;
				
			Иначе
				//Аверсон СВФР-006994	
				
				Отработано = 0;
				//если СтрокаДвижений.Организация.ИНН = "600124787" Тогда  //О.Т. Аверсон 05.02.2016 № 858
				
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноДней) КАК Отработано
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ПовременнаяОплатаПриСделке
				|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
				|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация";
				
				Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
				Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
				Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				
				РезультатЗапроса = Запрос.Выполнить();
				
				ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					Отработано = ?(ВыборкаДетальныеЗаписи.Отработано = NULL,0,ВыборкаДетальныеЗаписи.Отработано);
				КонецЦикла;
				
			КонецЕсли;
			
			//Аверсон-софт, Островская Татьяна 28.03.2012 
			если (ЗначениеЗаполнено(мОтработаноЧас) или ЗначениеЗаполнено(мОтработаноЧасов) или 
				ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияПростоевРаботниковОрганизаций"))
				ИЛИ
				((НЕ ЗначениеЗаполнено(мОтработаноЧас) И НЕ ЗначениеЗаполнено(мОтработаноЧасов) И 
				ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций"))) // часов 0, целый месяц командировка без оплаты по среднему
				тогда
				//Аверсон-софт, Островская Татьяна 28.03.2012 № 15
				НормаВремени = ИсходныеДанные.НормаВремениЗаМесяц;
				СообщениеОбОшибке = Ложь;
				ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени)- Отработано;
				Если НЕ СообщениеОбОшибке И НормаВремени = 0 Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
				КонецЕсли;
				Если НормаВремени <> 0 Тогда
					//толик				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ОтработаноВремениОсновное / НормаВремени,Константы.ВалютаРегламентированногоУчета.Получить());
					//О.Т. Аверсон 27.10.2016 № 1499
					Запрос = Новый Запрос;
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.ВалютныеОклады
					|ИЗ
					|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
					|ГДЕ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
					
					Запрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация); 	
					РезультатЗапроса = Запрос.Выполнить();                	
					ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
					ВалютныеОклады = Ложь;
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						ВалютныеОклады = ВыборкаДетальныеЗаписи.ВалютныеОклады;        						
					КонецЦикла;
					ДляПечати = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ДляПечати;
					
					//О.Т. Аверсон 27.10.2016 № 1499
					ЗанимаемыхСтавок = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
					если не ЗанимаемыхСтавок > 0 Тогда 
						ЗанимаемыхСтавок = 1;			
					КонецЕсли;
					Если не СтрокаДвижений.Организация.ЗаполнениеТабелейСУчетомСтавки Тогда 
						ЗанимаемыхСтавок = 1;
					КонецЕсли;   					
					//О.Т. Аверсон 27.10.2016 № 1499
					Если ВалютныеОклады и ДляПечати и ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") и ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда 
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(СтрокаДвижений.Показатель3=0, СтрокаДвижений[ПоказательРазмер], СтрокаДвижений.Показатель3) * СтрокаДвижений.Регистратор.Курс * ОтработаноВремениОсновное / (НормаВремени*ЗанимаемыхСтавок),Константы.ВалютаРегламентированногоУчета.Получить());
					ИначеЕсли ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияПростоевРаботниковОрганизаций") Тогда 
						//Аверсон 23.03.2020 КВВ СВФР-005719 (
						Если СтрокаДвижений.Регистратор.РасчетОтЧасовогоТарифа ИЛИ СтрокаДвижений.Регистратор.РасчетОтЧасовогоТарифаСПовышениями Тогда 
							ЧТСтавка = ?(СтрокаДвижений.Показатель3=0, СтрокаДвижений[ПоказательРазмер], СтрокаДвижений.Показатель3); 
							
							//Аверсон 12.05.2023 КВВ СВФР-010820 (
							Если СтрокаДвижений.Регистратор.РасчетОтЧасовогоТарифа И СтрокаДвижений.Организация.ИНН = "100194961" Тогда 
								ДанныеНаДату = ?(ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаНачала),СтрокаДвижений.Регистратор.ДатаНачала,НачалоМесяца(СтрокаДвижений.ПериодРегистрации)); 
								ЧТСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.Регистратор.ДатаНачала, СтрокаДвижений.ГрафикРаботы, Ложь,Ложь,,,    ,Истина,,,,,, Курс ); 
							КонецЕсли;
							//Аверсон 12.05.2023 КВВ СВФР-010820 )
							
							//Аверсон 09.04.2020 КВВ СВФР-005844 (
							Если ЧТСтавка = 0 Тогда
								ДанныеНаДату = ?(ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаНачала),СтрокаДвижений.Регистратор.ДатаНачала,НачалоМесяца(СтрокаДвижений.ПериодРегистрации)); //Аверсон 09.04.2020 КВВ СВФР-005834 : убрано "-1" в НачалоМесяца(СтрокаДвижений.ПериодРегистрации)
								ЗанимаемыхСтавок = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ДанныеНаДату,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
								ЧТСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, ДанныеНаДату, СтрокаДвижений.ГрафикРаботы,Истина,,,,,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,, Курс> 
								Если СтрокаДвижений.Регистратор.РасчетОтЧасовогоТарифаСПовышениями Тогда
									ЧТСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, ДанныеНаДату, СтрокаДвижений.ГрафикРаботы,Ложь,Истина,,,,,,,Истина); 
								КонецЕсли;
								СтрокаДвижений[ПоказательРазмер] = Окр(ЧТСтавка*ЗанимаемыхСтавок,2);
							КонецЕсли;
							//Аверсон 09.04.2020 КВВ СВФР-005844 )
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ЧТСтавка * ОтработаноВремениОсновное * 2 / 3,Константы.ВалютаРегламентированногоУчета.Получить());
						Иначе //по старому
							//Аверсон 23.03.2020 КВВ СВФР-005719 )
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(СтрокаДвижений.Показатель3=0, СтрокаДвижений[ПоказательРазмер], СтрокаДвижений.Показатель3) * ОтработаноВремениОсновное / ?(СтрокаДвижений.Регистратор.СпособРегистрацииВремени = Перечисления.СпособыРегистрацииВремени.РегистрацияДляЧастиСмены,1,(НормаВремени*ЗанимаемыхСтавок)),Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т. Аверсон 07.02.2018 № 1549 для внутрисменного убрала / (норму *ставку) Не нужно было
						КонецЕсли;
					ИначеЕсли ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда //О.Т. Аверсон 20.08.2018 № 2270
						//Аверсон 15.08.2019 КВВ СВФР-004608 (
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
							ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
							Если ТЗКолвоДнКом.Количество() > 0 Тогда
								Для Каждого Стр Из ТЗКолвоДнКом Цикл
									Если Стр.Дней > 0 Тогда
										ОтработаноВремениОсновное = ОтработаноВремениОсновное + Стр.Дней;
									КонецЕсли;
								КонецЦикла;
							КонецЕсли;
						КонецЕсли;
						//Аверсон 15.08.2019 КВВ СВФР-004608 )
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(СтрокаДвижений.Показатель3=0, СтрокаДвижений[ПоказательРазмер], СтрокаДвижений.Показатель3) * ОтработаноВремениОсновное / НормаВремени,Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т. Аверсон 20.08.2018 № 2270
						
						//Аверсон ЕАЕ 09.02.2024 СВФР-012254
						//Климовичи (врем.перевод)
						Если Организация.ИНН = "700103211" Тогда
							Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
								мСтрока = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(
								Новый Структура("Организация", Организация));
								Если мСтрока.НеРассчитыватьНачислениеЕслиПроведеноОплатаПоСреднему Тогда
									БылВременныйПеревод = ПроверитьВременныйПеревод(Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
									Если БылВременныйПеревод Тогда
										БылаОплатаПоСреднемуПеревод = ПроверитьОплатуПоСреднемуВременныйПеревод(Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
										Если БылаОплатаПоСреднемуПеревод Тогда
											Результат = 0;	
										КонецЕсли;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Аверсон СВФР-012254
					иначе		
						//Аверсон 22.06.2020 КВВ СВФР-006176 (
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
							ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
							Если ТЗКолвоДнКом.Количество() > 0 Тогда
								Для Каждого Стр Из ТЗКолвоДнКом Цикл
									Если Стр.Дней > 0 Тогда
										ОтработаноВремениОсновное = ОтработаноВремениОсновное + Стр.Часов;
									КонецЕсли;
								КонецЦикла;
							КонецЕсли;
							Если Организация.СниматьОтработанныеЧасыВЗарплате Тогда
								ТЗКолвоДнОплатаПоСреднему = ПроверитьОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
								Если ТЗКолвоДнОплатаПоСреднему.Количество() > 0 Тогда
									Для Каждого Стр Из ТЗКолвоДнОплатаПоСреднему Цикл
										//Если Стр.Дней > 0 Тогда
										//	СтрокаДвижений.ОтработаноДней = СтрокаДвижений.ОтработаноДней - Стр.Дней;
										//КонецЕсли;
										Если Стр.Часов > 0 Тогда
											ОтработаноВремениОсновное = ОтработаноВремениОсновное - Стр.Часов;
										КонецЕсли;
									КонецЦикла;
								КонецЕсли;
							КонецЕсли; 
						КонецЕсли;
						Если Организация.Инн = "100071565" Тогда
							Если ОтработаночасовПС < 0 и ОтработаночасовПС <> null Тогда
								ОтработаноВремениОсновное = ОтработаноВремениОсновное + ОтработаночасовПС;
							КонецЕсли;
						КонецЕсли;
						//Аверсон 22.06.2020 КВВ СВФР-006176 )
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(СтрокаДвижений.Показатель3=0, СтрокаДвижений[ПоказательРазмер], СтрокаДвижений.Показатель3) * ОтработаноВремениОсновное / (НормаВремени*ЗанимаемыхСтавок),Константы.ВалютаРегламентированногоУчета.Получить());
						
						//Аверсон ЕАЕ 09.02.2024 СВФР-012254
						//Климовичи (врем.перевод)
						Если Организация.ИНН = "700103211" Тогда
							Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
								Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
									мСтрока = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(
											Новый Структура("Организация", Организация));

									Если мСтрока.НеРассчитыватьНачислениеЕслиПроведеноОплатаПоСреднему Тогда
										БылВременныйПеревод = ПроверитьВременныйПеревод(Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
										Если БылВременныйПеревод Тогда
											БылаОплатаПоСреднемуПеревод = ПроверитьОплатуПоСреднемуВременныйПеревод(Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
											Если БылаОплатаПоСреднемуПеревод Тогда
												Результат = 0;	
											КонецЕсли;
										КонецЕсли;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Аверсон СВФР-012254
					КонецЕсли;
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Должностной оклад/Тарифная ставка: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Норма времени: " + НормаВремени, КомментарийВидаРасчета);
					КонецЕсли;
				КонецЕсли;
				
				Если СтрокаДвижений.Организация.ИНН = "806000046" Тогда
					ЗапросКатегория = Новый Запрос;
					ЗапросКатегория.Текст = 
					"ВЫБРАТЬ
					|	РаботникиОрганизацийСрезПоследних.Категория,
					|	РаботникиОрганизацийСрезПоследних.Должность.Категория как КатегорияДолжность
					|ИЗ
					|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Дата, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних";
					
					ЗапросКатегория.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					ЗапросКатегория.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					
					РезЗапросаКатегория = ЗапросКатегория.Выполнить().Выбрать();
					КатегорияРаботника = Справочники.КатегорииРаботников.ПустаяСсылка();
					Пока РезЗапросаКатегория.Следующий() Цикл
						КатегорияРаботника = РезЗапросаКатегория.Категория;
						Если не ЗначениеЗаполнено(КатегорияРаботника) Тогда 
							КатегорияРаботника = РезЗапросаКатегория.КатегорияДолжность;
						КонецЕсли;
					КонецЦикла;
					
					Если КатегорияРаботника.Наименование = "Страховые агенты" Тогда 
						Результат = 0;
						Сообщить("Штатному агенту "+СтрокаДвижений.Сотрудник+ " оклад изменен.");
					КонецЕсли;
				КонецЕсли; 	
				
				СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1);
				//Аверсон-софт, Островская Татьяна 28.03.2012 
			иначе
				Результат = 0;
				СтрокаДвижений.ОплаченоДнейЧасов = 0;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 28.03.2012 
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксСуммойПропорционльноОтработанномуВремени или 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаЗаместительство или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.РазницаВОкладах  тогда  //Островская Татьяна 20.03.2013 № 16341
			
			//Аверсон 09.07.2020 КВВ СВФР-006236 (
			ЭтоОбучениеВСовмещении = Ложь;
			Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников") Тогда
				ЭтоОбучениеВСовмещении = ИсходныеДанные.Регистратор.Обучение;
			КонецЕсли;	
			Если ЭтоОбучениеВСовмещении Тогда
				мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодДействияНачало), КонецМесяца(СтрокаДвижений.ПериодДействияКонец), СтрокаДвижений.Сотрудник);
				НормаВремени = мНорма.НормаЧасов;
				
				Ученик = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
				З = Новый Запрос;
				З.Текст = "ВЫБРАТЬ 
				|ДокСовмещ.ЗамещаемыйСотрудник 
				|ИЗ Документ.ОплатаСовмещенияСотрудников.ОсновныеНачисления КАК ДокСовмещ
				|ГДЕ ДокСовмещ.Сотрудник = &Сотр
				|И ДокСовмещ.Ссылка = &ДокСсылка 
				|И ДокСовмещ.НомерСтроки = &НомерСтроки";
				З.УстановитьПараметр("Сотр",СтрокаДвижений.Сотрудник);
				З.УстановитьПараметр("ДокСсылка",СтрокаДвижений.Регистратор);
				З.УстановитьПараметр("НомерСтроки",СтрокаДвижений.НомерСтроки);
				РезЗ = З.Выполнить().Выбрать();
				Пока РезЗ.Следующий() Цикл
					Ученик = РезЗ.ЗамещаемыйСотрудник;
				КонецЦикла;
				
				//Аверсон ЕАЕ 18.12.2020
				//ФактВремени = 1000;
				//КолвоЦиклов = ?(ЗначениеЗаполнено(Ученик),2,1);
				//Для А = 1 По КолвоЦиклов Цикл
				//	З2 = Новый Запрос;
				//	З2.Текст = 
				//	"ВЫБРАТЬ 
				//	|СУММА(РабВремя.Часов) КАК Часов
				//	|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабВремя
				//	|ГДЕ РабВремя.Сотрудник = &Сотр
				//	|И РабВремя.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				//	|И ТИПЗНАЧЕНИЯ(РабВремя.Регистратор) = ТИП(Документ.ТабельУчетаРабочегоВремениОрганизации)
				//	|И РабВремя.Период МЕЖДУ &ДатаНач И &ДатаКон";
				//	З2.УстановитьПараметр("Сотр",?(А=1,СтрокаДвижений.Сотрудник,Ученик));
				//	З2.УстановитьПараметр("ДатаНач",СтрокаДвижений.ПериодДействияНачало);
				//	З2.УстановитьПараметр("ДатаКон",СтрокаДвижений.ПериодДействияКонец);
				//	З2.УстановитьПараметр("ВидИспользованияРабочегоВремени",Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
				//	
				//	РезЗ2 = З2.Выполнить().Выбрать();
				//	Пока РезЗ2.Следующий() Цикл
				//		ФактВремени = Мин(ФактВремени,РезЗ2.Часов); 
				//	КонецЦикла;
				//КонецЦикла;
				//ФактВремени = ?(ФактВремени=1000,0,ФактВремени);
				ФактВремени = 0;
				Если ЗначениеЗаполнено(Ученик) Тогда
					З2 = Новый Запрос;
					З2.Текст =
					"ВЫБРАТЬ РАЗРЕШЕННЫЕ
					|РабВремяУчителя.Период,
					|РабВремяУчителя.Часов
					|ПОМЕСТИТЬ ВТрабВремяУчителя
					|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабВремяУчителя
					|ГДЕ РабВремяУчителя.Сотрудник = &Учитель
					|	И РабВремяУчителя.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
					|	И ТИПЗНАЧЕНИЯ(РабВремяУчителя.Регистратор) = ТИП(Документ.ТабельУчетаРабочегоВремениОрганизации)
					|	И РабВремяУчителя.Период МЕЖДУ &ДатаНач И &ДатаКон
					|;
					|//////////////////////////////////////////////////
					|ВЫБРАТЬ РАЗРЕШЕННЫЕ
					|РабВремяУченика.Период,
					|РабВремяУченика.Часов
					|ПОМЕСТИТЬ ВТРабВремяУченика
					|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабВремяУченика
					|ГДЕ РабВремяУченика.Сотрудник = &Ученик
					|	И РабВремяУченика.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
					|	И ТИПЗНАЧЕНИЯ(РабВремяУченика.Регистратор) = ТИП(Документ.ТабельУчетаРабочегоВремениОрганизации)
					|	И РабВремяУченика.Период МЕЖДУ &ДатаНач И &ДатаКон
					|;
					|/////////////////////////////////////////////////
					|ВЫБРАТЬ РАЗРЕШЕННЫЕ
					|СУММА(ВЫБОР
					|		КОГДА ВТрабВремяУчителя.Часов < ВТРабВремяУченика.Часов
					|		ТОГДА ВТрабВремяУчителя.Часов
					|		ИНАЧЕ ВТРабВремяУченика.Часов
					|		КОНЕЦ) КАК Часов
					|ИЗ ВТрабВремяУчителя
					|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТРабВремяУченика
					|ПО ВТрабВремяУчителя.Период = ВТРабВремяУченика.Период
					|";
					
					З2.УстановитьПараметр("Учитель",СтрокаДвижений.Сотрудник);
					З2.УстановитьПараметр("Ученик",Ученик);
					З2.УстановитьПараметр("ДатаНач",СтрокаДвижений.ПериодДействияНачало);
					З2.УстановитьПараметр("ДатаКон",СтрокаДвижений.ПериодДействияКонец);
					З2.УстановитьПараметр("ВидИспользованияРабочегоВремени",Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
					
					РезЗ2 = З2.Выполнить().Выбрать();
					Пока РезЗ2.Следующий() Цикл
						ФактВремени = РезЗ2.Часов; 
					КонецЦикла;
				Иначе
					З2 = Новый Запрос;
					З2.Текст = 
					"ВЫБРАТЬ 
					|	СУММА(РабВремя.Часов) КАК Часов
					|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабВремя
					|ГДЕ РабВремя.Сотрудник = &Сотр
					|	И РабВремя.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
					|	И ТИПЗНАЧЕНИЯ(РабВремя.Регистратор) = ТИП(Документ.ТабельУчетаРабочегоВремениОрганизации)
					|	И РабВремя.Период МЕЖДУ &ДатаНач И &ДатаКон";
					З2.УстановитьПараметр("Сотр",СтрокаДвижений.Сотрудник);
					З2.УстановитьПараметр("ДатаНач",СтрокаДвижений.ПериодДействияНачало);
					З2.УстановитьПараметр("ДатаКон",СтрокаДвижений.ПериодДействияКонец);
					З2.УстановитьПараметр("ВидИспользованияРабочегоВремени",Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
					
					РезЗ2 = З2.Выполнить().Выбрать();
					Пока РезЗ2.Следующий() Цикл
						ФактВремени = РезЗ2.Часов; 
					КонецЦикла;
				КонецЕсли;
				//Аверсон
				
				СтрокаДвижений.ОплаченоДнейЧасов = ФактВремени;
				Если ИсходныеДанные.Регистратор.Обучение_Расчет = 0 Тогда
					СтрокаДвижений.Результат = Окр((СтрокаДвижений.Показатель1 * СтрокаДвижений.Показатель2) / НормаВремени * ФактВремени,2);
				Иначе
					СтрокаДвижений.Результат = Окр(((СтрокаДвижений.Показатель1 * СтрокаДвижений.Показатель2) / 100) / НормаВремени * ФактВремени,2);
				КонецЕсли;
				
			Иначе
				//Аверсон 09.07.2020 КВВ СВФР-006236 )
				//ПСА 29.03.2021 СВФР-007368 +++
				//мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.Сотрудник);
				мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодДействия), КонецМесяца(СтрокаДвижений.ПериодДействия), СтрокаДвижений.Сотрудник);
				//+++ПСА 29.03.2021 СВФР-007368
				если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда 
					НормаВремени = мНорма.НормаДней;
					ОтработаноВремениОсновное = ИсходныеДанные.ОтработаноДней;
				иначе
					НормаВремени = мНорма.НормаЧасов;
					ОтработаноВремениОсновное = ИсходныеДанные.ОтработаноЧасов;
					
					//Аверсон ЕАЕ 30.06.2025 СВФР-015776
					//Гроднооблгаз
					Если СтрокаДвижений.Организация.ИНН = "500036445" ИЛИ
						СтрокаДвижений.Организация.ИНН = "500826909" Тогда
						СписокПовышенийСуммой = ПолучитьСписокПовышенийСуммой();
						Если СписокПовышенийСуммой.Найти(СтрокаДвижений.ВидРасчета) <> Неопределено Тогда
							ОтработаноЧасовПоСделке = ПолучитьОтработаноЧасовПоСделке(СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник,СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец);
							
							ОтработаноВремениОсновное = ОтработаноВремениОсновное - ОтработаноЧасовПоСделке;
							
							ОтработаноВремениОсновное = ?(ОтработаноВремениОсновное < 0,0,ОтработаноВремениОсновное);
						КонецЕсли;
					КонецЕсли;
					//Аверсон СВФР-015776
					
				КонецЕсли;
				//Островская Татьяна 17.10.2013 № 16858
				если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
					если ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботыНорма) Тогда 
						ГрафикРаботы = СтрокаДвижений.ГрафикРаботыНорма;
					иначе
						ГрафикРаботы = СтрокаДвижений.ГрафикРаботы; 
					КонецЕсли;
					//Павличев СВФР-000859 07.08.2017
					Если ИсходныеДанные.Регистратор.ВидыРасчетаДляЗамещения = Перечисления.ВидыРасчетаДляЗамещения.СверхУстановленнойНормы Тогда
						СотрудникДляНормы = ИсходныеДанные.Регистратор.СотрудникЗамещаемый;
					Иначе
						СотрудникДляНормы = СтрокаДвижений.Сотрудник;
					КонецЕсли; 
					//Павличев СВФР-000859 07.08.2017
					мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодДействияНачало), КонецМесяца(СтрокаДвижений.ПериодДействияКонец), СотрудникДляНормы);
					если не ИсходныеДанные.Регистратор.РасчетВЧасах Тогда 
						НормаВремени = мНорма.НормаДней;
						ОтработаноВремениОсновное = ИсходныеДанные.ОтработаноДней;
					иначе
						НормаВремени = мНорма.НормаЧасов;
						ОтработаноВремениОсновное = ИсходныеДанные.ОтработаноЧасов;
					КонецЕсли;
					
					//Островская Татьяна 13.12.2013 № 16978
					если ИсходныеДанные.Регистратор.ВидыРасчетаДляЗамещения = Перечисления.ВидыРасчетаДляЗамещения.СверхУстановленнойНормы или 
						ИсходныеДанные.Регистратор.ВидыРасчетаДляЗамещения = Перечисления.ВидыРасчетаДляЗамещения.ДежурствоНаДому или 
						ИсходныеДанные.Регистратор.ВидыРасчетаДляЗамещения = Перечисления.ВидыРасчетаДляЗамещения.ЭкстренныйВызов Тогда  
						если ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка) Тогда 
							НормаВремениЗаИнтервал = ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка;
						иначе
							если ИсходныеДанные.Регистратор.РасчетВЧасах Тогда 
								НормаВремениЗаИнтервал = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация);
							иначе
								НормаВремениЗаИнтервал = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация);
							КонецЕсли;
						КонецЕсли;
					иначе
						если ИсходныеДанные.Регистратор.РасчетВЧасах Тогда 
							НормаВремениЗаИнтервал = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация);
						иначе
							НормаВремениЗаИнтервал = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация);
						КонецЕсли;
					КонецЕсли;
					//Островская Татьяна 13.12.2013 № 16978
				иначе
					НормаВремениЗаИнтервал = НормаВремени;
				КонецЕсли;
				//Островская Татьяна 17.10.2013 № 16858
				
				СообщениеОбОшибке = Ложь;
				
				//ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
				Если НЕ СообщениеОбОшибке И НормаВремени = 0 Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
				КонецЕсли;  
				//Островская Татьяна 17.10.2013 № 16858
				ПроцентОплаты = 1;
				Если НормаВремени <> 0 Тогда
					если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
						если не ИсходныеДанные.Регистратор.СчитатьПоДолжностнымОкладам Тогда 
							ПоказательРазмер = "Показатель2";
						КонецЕсли;
						//Островская Татьяна 24.12.2013 № 16993
						//если ИсходныеДанные.Регистратор.ВидыРасчетаДляЗамещения = Перечисления.ВидыРасчетаДляЗамещения.ЭкстренныйВызов Тогда 
						// ПроцентОплаты = 1;
						//ИначеЕсли  ИсходныеДанные.Регистратор.ВидыРасчетаДляЗамещения = Перечисления.ВидыРасчетаДляЗамещения.ДежурствоНаДому Тогда 
						//	ПроцентОплаты = 0.5; 
						//иначе	
						ПроцентОплаты = ИсходныеДанные.Регистратор.ПроцентОплаты/100;
						//КонецЕсли;
						//Островская Татьяна 24.12.2013 № 16993
						Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.РазницаВОкладах Тогда 
							ПоказательРазмер = "Показатель1";
							ПоказательРазмер2 = "Показатель2";
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте((СтрокаДвижений[ПоказательРазмер2]-СтрокаДвижений[ПоказательРазмер]) * ?(ОтработаноВремениОсновное>НормаВремени и СтрокаДвижений.Организация.Инн = "600124787",1,ОтработаноВремениОсновное / НормаВремени)*?(ЗначениеЗаполнено(ПроцентОплаты),ПроцентОплаты,1),Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т.
							НормаВремениЗаИнтервал = ОтработаноВремениОсновное;
						иначе
							Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаЗаместительство и ИсходныеДанные.Регистратор.РасчетОтОтработанногоВремени Тогда //О.Т. Аверсон 27.11.2017 № 1297
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ?(ОтработаноВремениОсновное>НормаВремени и СтрокаДвижений.Организация.Инн = "600124787",1,ОтработаноВремениОсновное / НормаВремени)*?(ЗначениеЗаполнено(ПроцентОплаты),ПроцентОплаты,1),Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т.
								НормаВремениЗаИнтервал = ОтработаноВремениОсновное;
							иначе
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ?(НормаВремениЗаИнтервал>НормаВремени и СтрокаДвижений.Организация.Инн = "600124787",1,НормаВремениЗаИнтервал / НормаВремени)*?(ЗначениеЗаполнено(ПроцентОплаты),ПроцентОплаты,1),Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т.
							КонецЕсли;
						КонецЕсли;
					иначеЕсли ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") и ВидРасчета2 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой Тогда
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ОтработаноВремениОсновное *?(ЗначениеЗаполнено(ПроцентОплаты),ПроцентОплаты,1),Константы.ВалютаРегламентированногоУчета.Получить());
						НормаВремениЗаИнтервал = ОтработаноВремениОсновное;    
					иначе
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ?(ОтработаноВремениОсновное>НормаВремени и СтрокаДвижений.Организация.Инн = "600124787",1,ОтработаноВремениОсновное / НормаВремени)*?(ЗначениеЗаполнено(ПроцентОплаты),ПроцентОплаты,1),Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т.
						НормаВремениЗаИнтервал = ОтработаноВремениОсновное;
					КонецЕсли;
					
					//Островская Татьяна 17.10.2013 № 16858
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Размер начисления: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Норма времени: " + НормаВремени, КомментарийВидаРасчета);
					КонецЕсли;
				КонецЕсли;
				СтрокаДвижений.ОплаченоДнейЧасов = НормаВремениЗаИнтервал * ?(СтрокаДвижений.Сторно,-1,1);//Островская Татьяна 17.10.2013 № 16858
				
				//Аверсон 20.03.2020 КВВ СВФР-005714 (
				Если (ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников")) И
					СтрокаДвижений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксСуммойПропорционльноОтработанномуВремени Тогда
					Если ИсходныеДанные.Регистратор.РасчетОтВведенныхЧасов Тогда
						СтрокаДвижений.ОплаченоДнейЧасов = ИсходныеДанные.Регистратор.ВведенныеЧасы;
						
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * (СтрокаДвижений.ОплаченоДнейЧасов / мНорма.НормаЧасов)*?(ЗначениеЗаполнено(ПроцентОплаты),ПроцентОплаты,1),Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
				КонецЕсли;
				//Аверсон 20.03.2020 КВВ СВФР-005714 )
				
				//Аверсон 06.11.2019 КВВ СВФР-005008 (	
				Если СтрокаДвижений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксСуммойПропорционльноОтработанномуВремени И ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
					ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
					Если ТЗКолвоДнКом.Количество() > 0 Тогда
						Для Каждого Стр Из ТЗКолвоДнКом Цикл
							Если Стр.Дней > 0 Тогда
								Если СтрокаДвижений.ВидУчетаВремени=Перечисления.ВидыУчетаВремени.ПоДням Тогда
									СтрокаДвижений.ОплаченоДнейЧасов = СтрокаДвижений.ОплаченоДнейЧасов + Стр.Дней;
									Результат = СтрокаДвижений.Показатель1/НормаВремени*СтрокаДвижений.ОплаченоДнейЧасов;
									Сообщить("В связи с командировкой сотрудника " + ПроцедурыУправленияПерсоналом.ФамилияИнициалыФизЛица(ИсходныеДанные.Сотрудник.ФизЛицо) + " было добавлено " + 
									Строка(Стр.Дней)+"дн. в рабочее время (по строке """ + СокрЛП(СтрокаДвижений.ВидРасчета) + """).");
								ИначеЕсли СтрокаДвижений.ВидУчетаВремени=Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
									СтрокаДвижений.ОплаченоДнейЧасов = СтрокаДвижений.ОплаченоДнейЧасов + Стр.Часов;
									Если ВидРасчета2 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой Тогда
										Результат = СтрокаДвижений.Показатель1*СтрокаДвижений.ОплаченоДнейЧасов;
									Иначе
										Результат = СтрокаДвижений.Показатель1/НормаВремени*СтрокаДвижений.ОплаченоДнейЧасов;
									КонецЕсли;
									Сообщить("В связи с командировкой сотрудника " + ПроцедурыУправленияПерсоналом.ФамилияИнициалыФизЛица(ИсходныеДанные.Сотрудник.ФизЛицо) + " было добавлено " + 
									Строка(Стр.Часов) + "час. в рабочее время (по строке """ + СокрЛП(СтрокаДвижений.ВидРасчета) + """).");
								КонецЕсли;
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
				КонецЕсли;
				//Аверсон 06.11.2019 КВВ СВФР-005008 )
			КонецЕсли;
			
			// ПоЧасовойТарифнойСтавке
			// ПоДневнойТарифнойСтавке
			//
			//Островская Татьяна 20.03.2013 № 16341
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоОкладу тогда
			НормаВремениЗаМесяц = ИсходныеДанные.НормаВремениЗаМесяц;
			//Аверсон 17.03.2020 КВВ СВФР-005648 (
			ЗамещающийСотр = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников") Тогда
				З = Новый Запрос;
				З.Текст =
				"ВЫБРАТЬ 
				|ДокСовмещ.Сотрудник 
				|ИЗ Документ.ОплатаСовмещенияСотрудников.ОсновныеНачисления КАК ДокСовмещ
				|ГДЕ ДокСовмещ.ЗамещаемыйСотрудник = &Сотр
				|И ДокСовмещ.Ссылка = &ДокСсылка 
				//	|И ДокСовмещ.ДатаНачала = &ДатаНач
				//|И ДокСовмещ.ДатаОкончания = &ДатаКон
				|И ДокСовмещ.НомерСтроки = &НомерСтроки";
				З.УстановитьПараметр("Сотр",СтрокаДвижений.Сотрудник);
				//З.УстановитьПараметр("ДатаНач",НачалоДня(СтрокаДвижений.ПериодДействияНачало));
				//З.УстановитьПараметр("ДатаКон",НачалоДня(СтрокаДвижений.ПериодДействияКонец));
				З.УстановитьПараметр("ДокСсылка",СтрокаДвижений.Регистратор);
				З.УстановитьПараметр("НомерСтроки",СтрокаДвижений.НомерСтроки);
				РезЗ = З.Выполнить().Выбрать();
				Пока РезЗ.Следующий() Цикл
					ЗамещающийСотр = РезЗ.Сотрудник;
				КонецЦикла;
				
				//Аверсон 03.04.2020 КВВ СВФР-005763 (
				Если СтрокаДвижений.Регистратор.НормаВремениМесБратьПоЗамещающему Тогда
					ЗпоГраф = Новый Запрос;	
					ЗпоГраф.Текст = 
					"ВЫБРАТЬ
					|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы КАК Сотрудник,
					|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы КАК ГрафикРаботы
					|	ПОМЕСТИТЬ ВТИндивГрафик
					|	ИЗ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
					|	ГДЕ ГрафикиРаботыПоВидамВремени.ГрафикРаботы = &Сотрудник
					|	И ГрафикиРаботыПоВидамВремени.Месяц = НАЧАЛОПЕРИОДА(&Дата,МЕСЯЦ)
					|	И ТИПЗНАЧЕНИЯ(ГрафикиРаботыПоВидамВремени.Документ) = ТИП(Документ.ВводИндивидуальныхГрафиковРаботыОрганизации) 
					|	СГРУППИРОВАТЬ ПО
					|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы;
					|	
					|ВЫБРАТЬ 
					|	РаботникиОрганизаций.Сотрудник,
					|	ВЫБОР КОГДА ВТИндивГрафик.ГрафикРаботы ЕСТЬ NULL 
					|	ТОГДА РаботникиОрганизаций.ГрафикРаботы 
					|	ИНАЧЕ ВТИндивГрафик.ГрафикРаботы КОНЕЦ КАК Результат
					|	ИЗ РегистрСведений.РаботникиОрганизаций.СрезПоследних(КОНЕЦПЕРИОДА(&Дата,МЕСЯЦ)) КАК РаботникиОрганизаций
					|	ЛЕВОЕ СОЕДИНЕНИЕ ВТИндивГрафик КАК ВТИндивГрафик
					|	ПО РаботникиОрганизаций.Сотрудник = ВТИндивГрафик.Сотрудник	
					|	ГДЕ РаботникиОрганизаций.Сотрудник = &Сотрудник";
					ЗпоГраф.УстановитьПараметр("Сотрудник",ЗамещающийСотр);
					ЗпоГраф.УстановитьПараметр("Дата",СтрокаДвижений.ПериодДействияКонец);
					РезЗпоГраф = ЗпоГраф.Выполнить().Выбрать();
					Пока РезЗпоГраф.Следующий() Цикл
						ГрафикРаботыЗамещающего = РезЗпоГраф.Результат;
					КонецЦикла;
					
					Если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда 
						НормаВремениЗаМесяц = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботыЗамещающего, Перечисления.ВидыУчетаВремени.ПоДням, НачалоМесяца(СтрокаДвижений.ПериодДействияНачало),КонецМесяца(СтрокаДвижений.ПериодДействияКонец),СтрокаДвижений.Организация); 
					Иначе
						НормаВремениЗаМесяц = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботыЗамещающего, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(СтрокаДвижений.ПериодДействияНачало),КонецМесяца(СтрокаДвижений.ПериодДействияКонец),СтрокаДвижений.Организация); 
					КонецЕсли;
				КонецЕсли;
				//Аверсон 03.04.2020 КВВ СВФР-005763 )
				
			КонецЕсли;
			//Аверсон 17.03.2020 КВВ СВФР-005648 )
			
			//О.Т. Аверсон 05.06.2018 № 2067
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	НачисленияРаботниковОрганизации.ВидРасчета
			|ИЗ
			|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
			|			&парамНачало,
			|			ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|				И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
			|ГДЕ
			|	ВЫБОР
			|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
			|			ИНАЧЕ НачисленияРаботниковОрганизации.Действие
			|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|	И ВЫБОР
			|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА ВЫБОР
			|						КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|							ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
			|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
			|					КОНЕЦ
			|			ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
			|		КОНЕЦ = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням)";
			
			Запрос.УстановитьПараметр("парамНачало", СтрокаДвижений.ПериодРегистрации);
			Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			
			РезультатЗапроса = Запрос.Выполнить();
			
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			ВидРасчета1 = Неопределено;
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				ВидРасчета1 = ВыборкаДетальныеЗаписи.ВидРасчета;
			КонецЦикла;
			//О.Т. Аверсон 05.06.2018 № 2067
			//О.Т. Аверсон 25.06.2018 № 2086
			если ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботыНорма) Тогда 
				ГрафикРаботы = СтрокаДвижений.ГрафикРаботыНорма;
			иначе
				ГрафикРаботы = СтрокаДвижений.ГрафикРаботы; 
			КонецЕсли;
			//О.Т. Аверсон 25.06.2018 № 2086
			
			//Аверсон 17.03.2020 КВВ СВФР-005648 (
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников") И СтрокаДвижений.Регистратор.ОплачиваемоеВремяПоТабелю Тогда
				//З = Новый Запрос;
				//З.Текст =
				//"ВЫБРАТЬ 
				//|ДокСовмещ.Сотрудник 
				//|ИЗ Документ.ОплатаСовмещенияСотрудников.ОсновныеНачисления КАК ДокСовмещ
				//|ГДЕ ДокСовмещ.ЗамещаемыйСотрудник = &Сотр
				//|И ДокСовмещ.Ссылка = &ДокСсылка 
				//|И ДокСовмещ.ДатаНачала = &ДатаНач
				//|И ДокСовмещ.ДатаОкончания = &ДатаКон";
				//З.УстановитьПараметр("Сотр",СтрокаДвижений.Сотрудник);
				//З.УстановитьПараметр("ДатаНач",НачалоДня(СтрокаДвижений.ПериодДействияНачало));
				//З.УстановитьПараметр("ДатаКон",НачалоДня(СтрокаДвижений.ПериодДействияКонец));
				//З.УстановитьПараметр("ДокСсылка",СтрокаДвижений.Регистратор);
				//РезЗ = З.Выполнить().Выбрать();
				//Пока РезЗ.Следующий() Цикл
				//	ЗамещающийСотр = РезЗ.Сотрудник;
				//КонецЦикла;
				
				З2 = Новый Запрос;
				З2.Текст = 
				"ВЫБРАТЬ 
				|СУММА(РабВремя.Дней) КАК Дней,
				|СУММА(РабВремя.Часов) КАК Часов //Аверсон 31.03.2020 КВВ СВФР-005737
				|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабВремя
				|ГДЕ РабВремя.Сотрудник = &Сотр
				|И РабВремя.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|И ТИПЗНАЧЕНИЯ(РабВремя.Регистратор) = ТИП(Документ.ТабельУчетаРабочегоВремениОрганизации)
				|И РабВремя.Период МЕЖДУ &ДатаНач И &ДатаКон";
				З2.УстановитьПараметр("Сотр",ЗамещающийСотр);
				З2.УстановитьПараметр("ДатаНач",СтрокаДвижений.ПериодДействияНачало);
				З2.УстановитьПараметр("ДатаКон",СтрокаДвижений.ПериодДействияКонец);
				З2.УстановитьПараметр("ВидИспользованияРабочегоВремени",ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени);
				НормаВремени2 = 0;
				РезЗ2 = З2.Выполнить().Выбрать();
				Пока РезЗ2.Следующий() Цикл
					НормаВремени2 = ?(СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням, РезЗ2.Дней, РезЗ2.Часов); //Аверсон 31.03.2020 КВВ СВФР-005737
				КонецЦикла;
				
				//Аверсон 11.04.2021 КВВ СВФР-007443 (
				З3 = Новый Запрос;
				З3.Текст = 
				"ВЫБРАТЬ 
				|СУММА(РабВремя.Дней) КАК Дней,
				|СУММА(РабВремя.Часов) КАК Часов
				|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабВремя
				|ГДЕ РабВремя.Сотрудник = &Сотр
				|И РабВремя.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|И ТИПЗНАЧЕНИЯ(РабВремя.Регистратор) = ТИП(Документ.ТабельУчетаРабочегоВремениОрганизации)
				|И РабВремя.Период МЕЖДУ &ДатаНач И &ДатаКон";
				З3.УстановитьПараметр("Сотр",СтрокаДвижений.Сотрудник);
				З3.УстановитьПараметр("ДатаНач",СтрокаДвижений.ПериодДействияНачало);
				З3.УстановитьПараметр("ДатаКон",СтрокаДвижений.ПериодДействияКонец);
				З3.УстановитьПараметр("ВидИспользованияРабочегоВремени",ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени);
				НормаВремени3 = 0;
				РезЗ3 = З3.Выполнить().Выбрать();
				Пока РезЗ3.Следующий() Цикл
					НормаВремени3 = ?(СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням, РезЗ3.Дней, РезЗ3.Часов); 
				КонецЦикла;
				Если СтрокаДвижений.Регистратор.Обучение Тогда
					НормаВремени = Мин(НормаВремени2,НормаВремени3);
				Иначе
					если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда //О.Т. Аверсон 06.06.2018 № 2067
						НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация,СтрокаДвижений.ГрафикРаботы, СтрокаДвижений.Регистратор); //О.Т. Аверсон 25.06.2018 № 2086 решили сделать как в заместительство. //НормаОплачиваемыхДней;  //Аверсон 23.06.2021 КВВ СВФР-007683 (добавлен 6 и 7 параметры)
					иначе
						НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация,СтрокаДвижений.ГрафикРаботы, СтрокаДвижений.Регистратор); //О.Т. Аверсон 25.06.2018 № 2086 решили сделать как в заместительство. //НормаОплачиваемыхЧасов;; //Аверсон 23.06.2021 КВВ СВФР-007683 (добавлен 6 и 7 параметры)
					КонецЕсли;
					//Аверсон 23.06.2021 КВВ СВФР-007683 (
					//НормаВремени = Мин(НормаВремени2,НормаВремени);  
					
					Если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда 
						НормаВремениЗаМесяц = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, НачалоМесяца(СтрокаДвижений.ПериодДействияНачало),КонецМесяца(СтрокаДвижений.ПериодДействияКонец),СтрокаДвижений.Организация,СтрокаДвижений.ГрафикРаботы, СтрокаДвижений.Регистратор); 
					Иначе
						НормаВремениЗаМесяц = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(СтрокаДвижений.ПериодДействияНачало),КонецМесяца(СтрокаДвижений.ПериодДействияКонец),СтрокаДвижений.Организация,СтрокаДвижений.ГрафикРаботы, СтрокаДвижений.Регистратор); 
					КонецЕсли;
					
					Если СтрокаДвижений.Регистратор.БратьЧасыИзТабеля Тогда 
						НормаВремени = НормаВремени2;
					ИНаче
						НормаВремени = НормаВремени;
					КонецЕсли;
					//Аверсон 23.06.2021 КВВ СВФР-007683 )
				КонецЕсли;
				
				//Аверсон 11.04.2021 КВВ СВФР-007443 )
				
			ИНАЧЕ
				//Аверсон 17.03.2020 КВВ СВФР-005648 )
				
				Если ?(ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников"),ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка),ложь) Тогда //О.Т. Аверсон 25.07.2018 № 2184
					НормаВремени = ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка;
				иначе
					
					если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда //О.Т. Аверсон 06.06.2018 № 2067
						НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация); //О.Т. Аверсон 25.06.2018 № 2086 решили сделать как в заместительство. //НормаОплачиваемыхДней;
					иначе
						НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация); //О.Т. Аверсон 25.06.2018 № 2086 решили сделать как в заместительство. //НормаОплачиваемыхЧасов;;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			СообщениеОбОшибке = Ложь;
			Если НЕ СообщениеОбОшибке И НормаВремени = 0 Тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
			КонецЕсли;
			Если НормаВремени <> 0 Тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений.Показатель2 / НормаВремениЗаМесяц * НормаВремени * СтрокаДвижений.Показатель1/100 ,Константы.ВалютаРегламентированногоУчета.Получить());
				Результат = ?(Результат < 0,0,Результат);
				Если КомментироватьРасчет Тогда
					ОбщегоНазначения.КомментарийРасчета("Размер начисления: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Норма времени за месяц: " + НормаВремениЗаМесяц, КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Норма времени: " + НормаВремени, КомментарийВидаРасчета);
				КонецЕсли;
			КонецЕсли;
			
			СтрокаДвижений.ОплаченоДнейЧасов = НормаВремени * ?(СтрокаДвижений.Сторно,-1,1);
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоТарифу тогда
			//О.Т. Аверсон 25.06.2018 № 2086
			если ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботыНорма) Тогда 
				ГрафикРаботы = СтрокаДвижений.ГрафикРаботыНорма;
			иначе
				ГрафикРаботы = СтрокаДвижений.ГрафикРаботы; 
			КонецЕсли;
			//О.Т. Аверсон 25.06.2018 № 2086
			
			//Аверсон 17.03.2020 КВВ СВФР-005648 (
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников") И СтрокаДвижений.Регистратор.ОплачиваемоеВремяПоТабелю Тогда
				З = Новый Запрос;
				З.Текст =
				"ВЫБРАТЬ 
				|ДокСовмещ.Сотрудник 
				|ИЗ Документ.ОплатаСовмещенияСотрудников.ОсновныеНачисления КАК ДокСовмещ
				|ГДЕ ДокСовмещ.ЗамещаемыйСотрудник = &Сотр
				|И ДокСовмещ.Ссылка = &ДокСсылка 
				|И ДокСовмещ.ДатаНачала = &ДатаНач
				|И ДокСовмещ.ДатаОкончания = &ДатаКон
				|И ДокСовмещ.НомерСтроки = &НомерСтроки";
				З.УстановитьПараметр("Сотр",СтрокаДвижений.Сотрудник);
				З.УстановитьПараметр("ДатаНач",НачалоДня(СтрокаДвижений.ПериодДействияНачало));
				З.УстановитьПараметр("ДатаКон",НачалоДня(СтрокаДвижений.ПериодДействияКонец));
				З.УстановитьПараметр("НомерСтроки",СтрокаДвижений.НомерСтроки);
				З.УстановитьПараметр("ДокСсылка",СтрокаДвижений.Регистратор);
				РезЗ = З.Выполнить().Выбрать();
				Пока РезЗ.Следующий() Цикл
					ЗамещающийСотр = РезЗ.Сотрудник;
				КонецЦикла;  			
				З2 = Новый Запрос;
				З2.Текст = 
				"ВЫБРАТЬ 
				|СУММА(РабВремя.Дней) КАК Дней, //Аверсон 31.03.2020 КВВ СВФР-005737
				|СУММА(РабВремя.Часов) КАК Часов
				|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабВремя
				|ГДЕ РабВремя.Сотрудник = &Сотр
				|И РабВремя.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|И РабВремя.Период МЕЖДУ &ДатаНач И &ДатаКон
				|И ВЫБОР
				|	КОГДА &ФлагПоТабелю
				|		ТОГДА РабВремя.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
				|	ИНАЧЕ ИСТИНА
				|КОНЕЦ";    
				З2.УстановитьПараметр("Сотр",ЗамещающийСотр);
				З2.УстановитьПараметр("ДатаНач",СтрокаДвижений.ПериодДействияНачало);
				З2.УстановитьПараметр("ДатаКон",СтрокаДвижений.ПериодДействияКонец);
				З2.УстановитьПараметр("ВидИспользованияРабочегоВремени",ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени);
				УчетнаяПолитикаЗапрос = Новый Запрос;
				УчетнаяПолитикаЗапрос.Текст = 
				"ВЫБРАТЬ
				|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
				|ИЗ
				|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
				|ГДЕ
				|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
				УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
				УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
				если УчетнаяПолитика.Количество()>0 Тогда 
					З2.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
				иначе
					З2.УстановитьПараметр("ФлагПоТабелю",Ложь);
				КонецЕсли;
				НормаВремени = 0;
				РезЗ2 = З2.Выполнить().Выбрать();
				Пока РезЗ2.Следующий() Цикл
					НормаВремени = ?(СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням, РезЗ2.Дней, РезЗ2.Часов); //Аверсон 31.03.2020 КВВ СВФР-005737
				КонецЦикла;
				НормаВремени = ?(НормаВремени = Null,0,НормаВремени); //Аверсон 16.06.2021 КВВ СВФР-007727
			ИНАЧЕ
				//Аверсон 17.03.2020 КВВ СВФР-005648 )
				Если ?(ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников"),ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка),ложь) Тогда //О.Т. Аверсон 25.07.2018 № 2184
					НормаВремени = ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка;
				иначе   				
					НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация); //О.Т. Аверсон 25.06.2018 № 2086 решили сделать как в заместительство. //НормаОплачиваемыхЧасов;
				КонецЕсли;
			КонецЕсли;
			
			СообщениеОбОшибке = Ложь;
			Если НЕ СообщениеОбОшибке И НормаВремени = 0 Тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
			КонецЕсли;
			Если НормаВремени <> 0 Тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений.Показатель2 * НормаВремени * СтрокаДвижений.Показатель1/100 ,Константы.ВалютаРегламентированногоУчета.Получить());
				Результат = ?(Результат < 0,0,Результат);
				Если КомментироватьРасчет Тогда
					ОбщегоНазначения.КомментарийРасчета("Размер начисления: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета("Норма времени: " + НормаВремени, КомментарийВидаРасчета);
				КонецЕсли;
			КонецЕсли;
			
			СтрокаДвижений.ОплаченоДнейЧасов = НормаВремени * ?(СтрокаДвижений.Сторно,-1,1);
			// ПоЧасовойТарифнойСтавке
			// ПоДневнойТарифнойСтавке
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПогрузочноРазгрузочныеРаботы тогда
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда 
				мОклад = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).ТарифнаяСтавка;
				
				СуммаПовышения = 0;
				ЗапросТариф = Новый Запрос;
				ЗапросТариф.Текст = 
				"ВЫБРАТЬ
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА НачисленияРаботниковОрганизации.Показатель1Завершения
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
				|	КОНЕЦ КАК Показатель1
				|ИЗ
				|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
				|			&парамНачало,
				|			ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|				И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
				|ГДЕ
				|	ВЫБОР
				|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
				|			ИНАЧЕ НачисленияРаботниковОрганизации.Действие
				|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|	И ВЫБОР
				|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА ВЫБОР
				|						КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|							ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
				|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
				|					КОНЕЦ
				|			ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
				|		КОНЕЦ В (&ВидРасчетаПовышения)";
				
				ВидыРасчетаПовышения = Новый СписокЗначений;
				ВидыРасчетаПовышения.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Контракт"));
				ВидыРасчетаПовышения.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("% повышения"));
				ВидыРасчетаПовышения.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("За веден.докум"));
				ЗапросТариф.УстановитьПараметр("ВидРасчетаПовышения", ВидыРасчетаПовышения);
				ЗапросТариф.УстановитьПараметр("парамНачало", СтрокаДвижений.ПериодРегистрации);
				ЗапросТариф.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				
				РезЗапросаТариф = ЗапросТариф.Выполнить().Выбрать();			
				Пока РезЗапросаТариф.Следующий() Цикл
					
					СуммаПовышения = СуммаПовышения + ОбщегоНазначения.ОкруглитьЗначение2016(мОклад * РезЗапросаТариф.Показатель1/100,СтрокаДвижений.ПериодРегистрации);
				КонецЦикла;
				
				Если ЗначениеЗаполнено(ИсходныеДанные.ОтработаноЧасов) Тогда 
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте((мОклад + СуммаПовышения) / ИсходныеДанные.ОтработаноЧасов * СтрокаДвижений.Показатель1 * СтрокаДвижений.Показатель2/100 ,Константы.ВалютаРегламентированногоУчета.Получить());
				иначе
					Результат = 0;
				КонецЕсли;
			КонецЕсли;
			//Островская Татьяна 20.03.2013 № 16341
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы  или 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф  или //О.Т. Аверсон 02.04.2016 № 981
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр  или //О.Т. Аверсон 02.04.2016 № 981
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой Тогда
			
			Организация = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "ОсновнаяОрганизация");
			
			мСтрока = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(
			Новый Структура("Организация", Организация));
			//О.Т. Аверсон 13.06.2016 № 1177
			ЗапросКатегория = Новый Запрос;
			ЗапросКатегория.Текст = 
			"ВЫБРАТЬ
			|	РаботникиОрганизацийСрезПоследних.Категория,
			|	РаботникиОрганизацийСрезПоследних.Должность.Категория как КатегорияДолжность
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Дата, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних";
			
			ЗапросКатегория.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
			ЗапросКатегория.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			
			РезЗапросаКатегория = ЗапросКатегория.Выполнить().Выбрать();
			КатегорияРаботника = Справочники.КатегорииРаботников.ПустаяСсылка();
			Пока РезЗапросаКатегория.Следующий() Цикл
				КатегорияРаботника = РезЗапросаКатегория.Категория;
				Если не ЗначениеЗаполнено(КатегорияРаботника) Тогда //О.Т. Аверсон 11.07.2016 К
					КатегорияРаботника = РезЗапросаКатегория.КатегорияДолжность;
				КонецЕсли;
			КонецЦикла;
			СтруктураПроцентНочных = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,
			Новый Структура("Организация,ВидПараметра,Категория",СтрокаДвижений.Организация,Перечисления.ВидыПараметровДляРасчетаЗарплаты.НочныеЧасыПоКатегориям,КатегорияРаботника)).Размер;
			//О.Т. Аверсон 13.06.2016 № 1177
			
			Отработано = 0;
			ЕстьДокСделка = Ложь;//О.Т. Аверсон 06.05.2016 № 1069
			если не (СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой) Тогда //О.Т. Аверсон 05.02.2016 № 858 (Организация.ИНН = "600124787" - убрать)
				
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноЧасов) КАК Отработано
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ПовременнаяОплатаПриСделке";
				//Аверсон 15.09.2020 ПСА СВФР-006552 (
				Если СтрокаДвижений.ПериодДействияНачало = НачалоМесяца(СтрокаДвижений.ПериодДействияНачало) и СтрокаДвижений.ПериодДействияКонец = КонецМесяца(СтрокаДвижений.ПериодДействияКонец) Тогда
					Запрос.Текст = Запрос.Текст + "
					|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1";
				Иначе
					Запрос.Текст = Запрос.Текст + "
					|И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(&ПериодРегистрации,ДЕНЬ)
					|И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(&ПериодРегистрации1,ДЕНЬ)";
					//Аверсон 15.09.2020 ПСА СВФР-006552 )
				КонецЕсли;
				Запрос.Текст = Запрос.Текст + "
				|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация";
				
				Запрос.УстановитьПараметр("Организация", Организация);
				//Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
				//Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
				Запрос.УстановитьПараметр("ПериодРегистрации", СтрокаДвижений.ПериодДействияНачало);
				Запрос.УстановитьПараметр("ПериодРегистрации1", СтрокаДвижений.ПериодДействияКонец);
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				
				РезультатЗапроса = Запрос.Выполнить();
				
				ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					Отработано = ?(ВыборкаДетальныеЗаписи.Отработано = NULL,0,ВыборкаДетальныеЗаписи.Отработано);
					ЕстьДокСделка = ?(ВыборкаДетальныеЗаписи.Отработано = NULL,Ложь,Истина); //О.Т. Аверсон 06.05.2016 № 1069
				КонецЦикла;
				
				
			КонецЕсли;
			
			
			//Островская Татьяна 06.05.2014 № 17331
			если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияПростоевРаботниковОрганизаций") Тогда   
				Если СтрокаДвижений.Регистратор.ВидПростоя = Перечисления.ВидыПростояРаботника.ОплатаПростояОтТарифнойСтавки и СтрокаДвижений.Регистратор.СпособРегистрацииВремени = Перечисления.СпособыРегистрацииВремени.РегистрацияДляЧастиСмены Тогда //О.Т. Аверсон 09.06.2017 № 706
					ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени)- Отработано; //О.Т. Аверсон 09.06.2017 № 706
				иначе
					если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням   тогда
						ОтработаноВремениОсновное = ИсходныеДанные.НормаОплачиваемыхДней;
					иначе
						ОтработаноВремениОсновное = ИсходныеДанные.НормаОплачиваемыхЧасов;
					КонецЕсли;
				КонецЕсли;
				//Островская Татьяна 12.05.2014 № 17359
			ИначеЕсли ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда
				ОтработаноВремениОсновное = СтрокаДвижений.ОплаченоДнейЧасов;
				//Островская Татьяна 12.05.2014 № 17359
			ИначеЕсли ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") или ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников") Тогда //О.Т. Аверсон 30.01.2017 № 237
				ОтработаноВремениОсновное = СтрокаДвижений.Показатель1;	
			иначе
				ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, , ГрафикиБезРабочегоВремени)- Отработано;	
				Если Организация.СниматьОтработанныеЧасыВЗарплате Тогда
					
					//Аверсон ЕАЕ 03.11.2025 СВФР-017037
					Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы Тогда
						ТЗКолвоДнОплатаПоСреднему = ПроверитьОплатуПоСреднемуНочные(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
					Иначе
					//Аверсон СВФР-017037
						
						ТЗКолвоДнОплатаПоСреднему = ПроверитьОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
					КонецЕсли;
					
					Если ТЗКолвоДнОплатаПоСреднему.Количество() > 0 Тогда
						Для Каждого Стр Из ТЗКолвоДнОплатаПоСреднему Цикл
							Если Стр.Часов > 0 Тогда
								ОтработаноВремениОсновное = ОтработаноВремениОсновное - Стр.Часов;
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
				КонецЕсли; 
			КонецЕсли;
			//Островская Татьяна 06.05.2014 № 17331
			
			//толик	Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ОтработаноВремениОсновное,Константы.ВалютаРегламентированногоУчета.Получить());
			Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф
				или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой Тогда
				//Островская Татьяна 10.12.2013 № 16968
				если ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботыНорма)Тогда 
					График = СтрокаДвижений.ГрафикРаботыНорма;
				иначе
					График = СтрокаДвижений.ГрафикРаботы;
				КонецЕсли;
				//О.Т. 25.05.2015 № 
				если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой Тогда
					
					СреднегодоваяНорма = 0;
					Запрос = Новый Запрос;
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	СУММА(ГрафикиРаботыПоВидамВремени.ОсновноеЗначение) КАК ОсновноеЗначение
					|ИЗ
					|	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
					|ГДЕ
					|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы = &ГрафикРаботы
					|	И ГрафикиРаботыПоВидамВремени.ВидВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
					|	И ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &Дата И &Дата1";
					
					Запрос.УстановитьПараметр("ГрафикРаботы", График);
					Запрос.УстановитьПараметр("Дата", НачалоГода(НачалоМесяца(СтрокаДвижений.ПериодРегистрации)));
					Запрос.УстановитьПараметр("Дата1", КонецГода(КонецМесяца(СтрокаДвижений.ПериодРегистрации)));
					
					РезультатЗапроса = Запрос.Выполнить();
					
					ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
					
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						СреднегодоваяНорма = СреднегодоваяНорма + ВыборкаДетальныеЗаписи.ОсновноеЗначение;
					КонецЦикла;
					
					
					
					СреднегодоваяНорма = СреднегодоваяНорма/12;
					
				иначе
					
					
					СреднегодоваяНорма = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(,Новый Структура("Организация,ВидПараметра,ГрафикРаботы",СтрокаДвижений.Организация,Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов,График)).Размер;
					
				КонецЕсли;
				//О.Т. 25.05.2015 №
				если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
					
					если СтрокаДвижений.Регистратор.СчитатьПоДолжностнымОкладам Тогда 
						мОклад = СтрокаДвижений.Регистратор.ОкладЗамещающего;
					иначе
						мОклад = СтрокаДвижений.Регистратор.ОкладЗамещаемого;
					КонецЕсли;
					
					мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.Регистратор.СотрудникЗамещающий);
					если не СтрокаДвижений.Регистратор.РасчетВЧасах Тогда 
						НормаВремени = мНорма.НормаДней;
					иначе
						НормаВремени = мНорма.НормаЧасов;
					КонецЕсли;
					Если (СтрокаДвижений.Регистратор.организация.ИНН= "100010315" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "200400628") //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
						И Справочники.ГруппыРасчетов.ПовышениеДляНочных.Основные.Количество()>0 Тогда
						СреднегодоваяНорма = "";
						ЗапросПлановые = Новый Запрос;
						ЗапросПлановые.Текст = 
						"ВЫБРАТЬ
						|	НачисленияРаботниковОрганизации.Показатель1
						|ИЗ
						|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
						|			&парамНачало,
						|			ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
						|				И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
						|ГДЕ
						|	ВЫБОР
						|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
						|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						|				ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
						|			ИНАЧЕ НачисленияРаботниковОрганизации.Действие
						|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
						|	И ВЫБОР
						|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
						|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						|				ТОГДА ВЫБОР
						|						КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
						|							ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
						|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
						|					КОНЕЦ
						|			ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
						|		КОНЕЦ В (&ВидыРасчетаПовышения)";
						ЗапросПлановые.УстановитьПараметр("парамНачало", ИсходныеДанные.ПериодДействияНачало);
						ЗапросПлановые.УстановитьПараметр("Сотрудник", ИсходныеДанные.Сотрудник);
						ВидыПовышений = Новый СписокЗначений;
						Для Каждого стр из Справочники.ГруппыРасчетов.ПовышениеДляНочных.Основные Цикл 
							ВидыПовышений.Добавить(стр.ВидРасчета);
						КонецЦикла;
						ЗапросПлановые.УстановитьПараметр("ВидыРасчетаПовышения", ВидыПовышений);
						РезультатЗапроса = ЗапросПлановые.Выполнить().Выбрать();
						ПроцентыПовышений = 0;
						пока РезультатЗапроса.Следующий() Цикл 
							ПроцентыПовышений = ПроцентыПовышений + РезультатЗапроса.Показатель1;
						КонецЦикла;
						мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), График);
						НормаВремени = мНорма.НормаЧасов;
						
					КонецЕсли;	
					
					//Аверсон ЕАЕ 09.11.2021 СВФР-008318
					Если ЭтоДолжностьСИндивидуальнымПроцентомНочных(СтрокаДвижений.Должность, СтрокаДвижений.Организация) Тогда
						мПроцентОплатыНочных = мСтрока.ПроцентОплатыВечерних;
					Иначе
						мПроцентОплатыНочных = мСтрока.ПроцентОплатыНочных;
					КонецЕсли;
					//Аверсон СВФР-008318
					
					если ЗначениеЗаполнено(СреднегодоваяНорма)Тогда 
						СрГодоваяНормаГрафика = СреднегодоваяНорма;
						//Островская Татьяна 24.12.2013 № 16993
						если СтрокаДвижений.Регистратор.ВидыРасчетаДляЗамещения = Перечисления.ВидыРасчетаДляЗамещения.ЭкстренныйВызов Тогда 
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2020,01,01) тогда
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/СрГодоваяНормаГрафика*СтрокаДвижений[ПоказательРазмер]* 60 / 100,Константы.ВалютаРегламентированногоУчета.Получить());
							Иначе
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/СрГодоваяНормаГрафика*СтрокаДвижений[ПоказательРазмер]* 70 / 100,Константы.ВалютаРегламентированногоУчета.Получить());
							КонецЕсли;	
						иначе
							
							//Аверсон ЕАЕ 09.11.2021 СВФР-008318
							//Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/СрГодоваяНормаГрафика*СтрокаДвижений[ПоказательРазмер]* ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мСтрока.ПроцентОплатыНочных <> 0, мСтрока.ПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/СрГодоваяНормаГрафика*СтрокаДвижений[ПоказательРазмер]* ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мПроцентОплатыНочных <> 0, мПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());
							//Аверсон СВФР-008318
							
						КонецЕсли;	
						//Островская Татьяна 24.12.2013 № 16993
					иначе
						СрГодоваяНормаГрафика = 0;
						Если (СтрокаДвижений.Регистратор.организация.ИНН= "100010315" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Регистратор.Организация.ИНН = "200400628") Тогда //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
							
							//Аверсон ЕАЕ 09.11.2021 СВФР-008318
							//Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/НормаВремени*(100+ПроцентыПовышений)/100*СтрокаДвижений[ПоказательРазмер]* ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мСтрока.ПроцентОплатыНочных <> 0, мСтрока.ПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/НормаВремени*(100+ПроцентыПовышений)/100*СтрокаДвижений[ПоказательРазмер]* ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мПроцентОплатыНочных <> 0, мПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());
							//Аверсон СВФР-008318
							
						Иначе
							
							//Аверсон ЕАЕ 09.11.2021 СВФР-008318
							//Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/НормаВремени*СтрокаДвижений[ПоказательРазмер]* ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мСтрока.ПроцентОплатыНочных <> 0, мСтрока.ПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/НормаВремени*СтрокаДвижений[ПоказательРазмер]* ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мПроцентОплатыНочных <> 0, мПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());
							//Аверсон СВФР-008318
							
						КонецЕсли;  
					КонецЕсли;
					//иначе
					//КонецЕсли;
					//Островская Татьяна 14.12.2013 № 16978
					//Островская Татьяна 10.12.2013 № 16968	
				иначе
					
					//Аверсон-софт, Островская Татьяна 26.03.2012 
					если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням   тогда
						если не ЗначениеЗаполнено(мОтработаноЧас) тогда
							мОтработаноЧас = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
						КонецЕсли;
						если не ЗначениеЗаполнено(мОтработаноЧасов) тогда
							мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
						КонецЕсли;
						
						//Аверсон ЕАЕ 09.11.2021 СВФР-008318
						Если ЭтоДолжностьСИндивидуальнымПроцентомНочных(СтрокаДвижений.Должность, СтрокаДвижений.Организация) Тогда
							мПроцентОплатыНочных = мСтрока.ПроцентОплатыВечерних;
						Иначе
							мПроцентОплатыНочных = мСтрока.ПроцентОплатыНочных;
						КонецЕсли;
						//Аверсон СВФР-008318
						
						//О.Т. Аверсон 30.03.2017 № 472
						Если Организация.ЗаполнениеТабелейСУчетомСтавки Тогда 
							Ставка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
							
							
							//Аверсон ЕАЕ 09.11.2021 СВФР-008318
							//Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер]* мОтработаноЧасов/мОтработаноЧас * ОтработаноВремениОсновное * ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мСтрока.ПроцентОплатыНочных <> 0, мСтрока.ПроцентОплатыНочных / 100, 1))/Ставка ,Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер]* мОтработаноЧасов/мОтработаноЧас * ОтработаноВремениОсновное * ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мПроцентОплатыНочных <> 0, мПроцентОплатыНочных / 100, 1))/Ставка ,Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
							//Аверсон СВФР-008318
							
						иначе
							
							//Аверсон ЕАЕ 09.11.2021 СВФР-008318
							//Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер]* мОтработаноЧасов/мОтработаноЧас * ОтработаноВремениОсновное * ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мСтрока.ПроцентОплатыНочных <> 0, мСтрока.ПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
							Если Организация.ИНН = "101132899" Тогда    //берем чтс окладника на часы, показать  уже чтс приводнить к тек месяцу не надо
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер]* ОтработаноВремениОсновное * ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мПроцентОплатыНочных <> 0, мПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
							Иначе
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер]* мОтработаноЧасов/мОтработаноЧас * ОтработаноВремениОсновное * ?(ЗначениеЗаполнено(СтруктураПроцентНочных),СтруктураПроцентНочных/100,?(мПроцентОплатыНочных <> 0, мПроцентОплатыНочных / 100, 1)),Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
							КонецЕсли;
							//Аверсон СВФР-008318
							
						КонецЕсли;
						//О.Т. Аверсон 30.03.2017 № 472
						
					иначе
						если ВидРасчета.Наименование = "Ночные по экстр. помощи" Тогда 
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2020,01,01) тогда
								ПроцентОплатыНочных = 60;
							Иначе
								ПроцентОплатыНочных = 70;
							КонецЕсли;
						иначе
							Если ЗначениеЗаполнено(СтруктураПроцентНочных) Тогда //О.Т. Аверсон 13.06.2016 № 1177
								ПроцентОплатыНочных = СтруктураПроцентНочных;
							иначе
								
								//Аверсон ЕАЕ 09.11.2021 СВФР-008318
								Если ЭтоДолжностьСИндивидуальнымПроцентомНочных(СтрокаДвижений.Должность, СтрокаДвижений.Организация) Тогда
									ПроцентОплатыНочных = мСтрока.ПроцентОплатыВечерних;
									//Аверсон СВФР-008318
									
								Иначе
									ПроцентОплатыНочных = мСтрока.ПроцентОплатыНочных;
								КонецЕсли;
								
							КонецЕсли;
						КонецЕсли;
						Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций")
							и не ЗначениеЗаполнено(СтрокаДвижений[ПоказательРазмер]) Тогда 
							если ЗначениеЗаполнено(СреднегодоваяНорма)Тогда 
								СрГодоваяНормаГрафика = СреднегодоваяНорма;
								Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф Тогда //О.Т. Аверсон 03.04.2016 № 981
									мОклад = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).ТарифнаяСтавка;
								ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр Тогда //О.Т. Аверсон 03.04.2016 № 981
									мОклад = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).ТарифнаяСПовышениемПоИнструкции;
								иначе
									мОклад = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Ставка;
								КонецЕсли;
								Если Организация.ЗаполнениеТабелейСУчетомСтавки Тогда
									Ставка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/СрГодоваяНормаГрафика * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1)/Ставка,Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
								иначе
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мОклад/СрГодоваяНормаГрафика * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1),Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
								КонецЕсли;
							иначе
								Если Организация.ЗаполнениеТабелейСУчетомСтавки Тогда
									Ставка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарСтавка * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1)/Ставка,Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
								иначе
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарСтавка * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1),Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
								КонецЕсли;
							КонецЕсли;	
						иначе
							
							//Аверсон 08.04.2022 КВВ СВФР-008930 (
							Если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций")
								И СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы Тогда
								ЧасовРемонта = 0;
								Попытка
									ЧасовРемонта = ИсходныеДанные.ЧасовРемонта;
								Исключение
								КонецПопытки;
								//Аверсон 11.05.2022 КВВ СВФР-009048 (
								//ОтработаноВремениОсновное = ОтработаноВремениОсновное - ЧасовРемонта;
								ОтработаноВремениОсновное = ?(ЗначениеЗаполнено(ЧасовРемонта),ОтработаноВремениОсновное - ЧасовРемонта,ОтработаноВремениОсновное);
								//Аверсон 11.05.2022 КВВ СВФР-009048 )
							КонецЕсли;
							//Аверсон 08.04.2022 КВВ СВФР-008930 )
							
							Если Организация.ЗаполнениеТабелейСУчетомСтавки Тогда  //О.Т. Аверсон 30.03.2017 № 472
								Ставка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
								
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1)/Ставка,Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
							иначе
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1),Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
								
								//Аверсон 18.09.2019 КВВ СВФР-004728 (
								Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") 
									И СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы Тогда
									Если СтрокаДвижений.Регистратор.РасчетНочныхСПовышениями И Справочники.ГруппыРасчетов.ПовышениеДляНочных.Основные.Количество()>0 Тогда
										ЗапросПлановые = Новый Запрос;
										ЗапросПлановые.Текст = 
										"ВЫБРАТЬ
										|	НачисленияРаботниковОрганизации.Показатель1
										|ИЗ
										|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
										|			&парамНачало,
										|			ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
										|				И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
										|ГДЕ
										|	ВЫБОР
										|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
										|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
										|				ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
										|			ИНАЧЕ НачисленияРаботниковОрганизации.Действие
										|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
										|	И ВЫБОР
										|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
										|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
										|				ТОГДА ВЫБОР
										|						КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
										|							ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
										|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
										|					КОНЕЦ
										|			ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
										|		КОНЕЦ В (&ВидыРасчетаПовышения)";
										ЗапросПлановые.УстановитьПараметр("парамНачало", ИсходныеДанные.ПериодДействияНачало);
										ЗапросПлановые.УстановитьПараметр("Сотрудник", ИсходныеДанные.Сотрудник);
										ВидыПовышений = Новый СписокЗначений;
										Для Каждого стр из Справочники.ГруппыРасчетов.ПовышениеДляНочных.Основные Цикл 
											ВидыПовышений.Добавить(стр.ВидРасчета);
										КонецЦикла;
										ЗапросПлановые.УстановитьПараметр("ВидыРасчетаПовышения", ВидыПовышений);
										РезультатЗапроса = ЗапросПлановые.Выполнить().Выбрать();
										ПроцентыПовышений = 0;
										ТСночные = 0;
										пока РезультатЗапроса.Следующий() Цикл 
											ПроцентыПовышений = ПроцентыПовышений + РезультатЗапроса.Показатель1;
											Если Справочники.ГруппыРасчетов.ПовышениеДляНочных.РасчетПоСуммам Тогда
												ТСночные = ТСночные + Окр(тарставка* РезультатЗапроса.Показатель1/100,2)
											КонецЕсли;
										КонецЦикла;
										
										//СВЭЙ 22.02.2024 КВВ СВФР-012096 (
										Если Справочники.ГруппыРасчетов.ПовышениеДляНочных.РасчетПоСуммам Тогда
											//Если ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботы) Тогда 
											//	ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
											//	Новый Структура("Организация,ВидПараметра,Категория,ГрафикРаботы", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка(),СтрокаДвижений.ГрафикРаботы));
											//	Если ЧасовВГоду.Размер = 0 Тогда 
											//		ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
											//		Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка()));
											//	КонецЕсли;
											//Иначе                        		
											//	ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияНачало,
											//	Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка()));
											//КонецЕсли;
											//Если ЧасовВГоду.Размер <> 0 Тогда
											//	Если ВидРасчета2 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам Тогда
											//		Норма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), График);
											//		ПроцентыПовышений = ПроцентыПовышений/ Норма.НормаЧасов; 
											//	ИначеЕсли СокрЛП(СтрокаДвижений.Категория) <> "Рабочие" Тогда
											//		ПроцентыПовышений = ПроцентыПовышений/ЧасовВГоду.Размер;
											//	КонецЕсли;
											//КонецЕсли;
											//Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ПроцентыПовышений * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1),Константы.ВалютаРегламентированногоУчета.Получить());
											Результат = ОбщегоНазначения.ОкруглитьПоВалюте((ТСночные+тарставка) * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1),Константы.ВалютаРегламентированногоУчета.Получить());
										Иначе         
											//СВЭЙ 22.02.2024 КВВ СВФР-012096 )
											
											Если СтрокаДвижений.Регистратор.организация.ИНН= "700067572" Тогда
												Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(СтрокаДвижений[ПоказательРазмер] * (100 + ПроцентыПовышений)/100,2) * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1),Константы.ВалютаРегламентированногоУчета.Получить());
											Иначе
												Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * (100 + ПроцентыПовышений)/100 * ОтработаноВремениОсновное * ?(ПроцентОплатыНочных <> 0, ПроцентОплатыНочных / 100, 1),Константы.ВалютаРегламентированногоУчета.Получить());
											КонецЕсли;
											Если СтрокаДвижений.Регистратор.организация.ИНН= "100071565" и отработаночасовПС <> 0 Тогда
												Результат = 0;
												ОтработаноВремениОсновное = 0;
											КонецЕсли;
										КонецЕсли;									
										
									КонецЕсли;
									
									//Аверсон ЕАЕ 23.04.2024 СВФР-012909
									//Климовичи (ночные)
									Если СтрокаДвижений.Организация.ИНН = "700103211" Тогда
										ОбнулятьРезультат = Ложь;
										
										Если мСтрока.НеРассчитыватьНачислениеЕслиПроведеноОплатаПоСреднему Тогда
											БылВременныйПеревод = ПроверитьВременныйПеревод(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
											Если БылВременныйПеревод Тогда
												БылаОплатаПоСреднемуПеревод = ПроверитьОплатуПоСреднемуВременныйПеревод(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
												Если БылаОплатаПоСреднемуПеревод Тогда
													ОбнулятьРезультат = Истина;	
												КонецЕсли;
											КонецЕсли;
										КонецЕсли;
										Если ОбнулятьРезультат Тогда
											Результат = 0;
										КонецЕсли;
									КонецЕсли;
									//Аверсон СВФР-012909
									
								КонецЕсли;
								//Аверсон 18.09.2019 КВВ СВФР-004728 )
							КонецЕсли;
							
							
						КонецЕсли;
					КонецЕсли;
					//Аверсон-софт, Островская Татьяна 26.03.2012 
				КонецЕсли;
				
			ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ОтработаноВремениОсновное * ?(мСтрока.ПроцентОплатыВечерних <> 0, мСтрока.ПроцентОплатыВечерних / 100, 1),Константы.ВалютаРегламентированногоУчета.Получить());//0.2;
			ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке Тогда
				Оклад = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(ИсходныеДанные.ПериодДействияКонец,Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Ставка;
				
				если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда
					Норма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Организация);
					Если Норма < ИсходныеДанные.ОтработаноДней   Тогда
						коэф = 1
					Иначе
						коэф = ИсходныеДанные.ОтработаноДней/Норма;
					КонецЕсли;
					если ИсходныеДанные.ОтработаноВремениПроизводственныйГрафик > 0 Тогда
						Результат = Оклад * коэф * СтрокаДвижений[ПоказательРазмер] /100;		
					иначе
						Результат = 0;
					КонецЕсли;
				Иначе
					Норма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Организация);
					Если ИсходныеДанные.ОтработаноВремени > Норма   Тогда
						коэф = 1
					Иначе
						коэф = ИсходныеДанные.ОтработаноВремени/Норма;
					КонецЕсли;
					если ИсходныеДанные.НормаВремениЗаМесяц > 0 Тогда 
						Результат = Оклад * коэф * СтрокаДвижений[ПоказательРазмер] /100;		
					иначе
						Результат = 0;
					КонецЕсли;
					
				КонецЕсли;
				
			ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке Тогда //О.Т. Аверсон 06.05.2016 № 1069
				Если ИсходныеДанные.РазмерСдельногоЗаработка = NULL или (Организация.ИНН = "600124787" или Организация.ПовременнаяОплатаПриСделке и ЕстьДокСделка) Тогда //Организация.ИНН = "600124787"
					//Аверсон 22.06.2020 КВВ СВФР-006176 (
					Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
						ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
						Если ТЗКолвоДнКом.Количество() > 0 Тогда
							Для Каждого Стр Из ТЗКолвоДнКом Цикл
								Если Стр.Дней > 0 Тогда
									ОтработаноВремениОсновное = ОтработаноВремениОсновное + Стр.Часов;
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
					КонецЕсли;
					Если Организация.ИНН = "100071565" Тогда
						Если ОтработаноЧасовПС < 0  Тогда
							ОтработаноВремениОсновное = ОтработаноВремениОсновное + ОтработаноЧасовПС;
						КонецЕсли;
					КонецЕсли;
					//Аверсон 22.06.2020 КВВ СВФР-006176 )
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(СтрокаДвижений.Показатель3=0, СтрокаДвижений[ПоказательРазмер], СтрокаДвижений.Показатель3) * ОтработаноВремениОсновное,Константы.ВалютаРегламентированногоУчета.Получить());
					Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") и Организация.ИНН = "100071565" Тогда
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(СтрокаДвижений.Показатель3=0, СтрокаДвижений[ПоказательРазмер], СтрокаДвижений.Показатель3) * ИсходныеДанные.ОтработаноВремени,Константы.ВалютаРегламентированногоУчета.Получить());	
					КонецЕсли;
					Если (Организация.ИНН = "700067572" или Организация.ИНН = "100071565") и ОтработаноВремениОсновное <>0 Тогда
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СУММА(ФактическаяВыработкаРаботниковОрганизаций.Выработка) КАК Выработка
						|ИЗ
						|	РегистрНакопления.ФактическаяВыработкаРаботниковОрганизаций КАК ФактическаяВыработкаРаботниковОрганизаций
						|ГДЕ
						|	ФактическаяВыработкаРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И ФактическаяВыработкаРаботниковОрганизаций.Организация = &Организация
						|	И ФактическаяВыработкаРаботниковОрганизаций.Период МЕЖДУ &Период И &Период1";
						
						Запрос.УстановитьПараметр("Организация", Организация);
						Запрос.УстановитьПараметр("Сотрудник", ИсходныеДанные.Сотрудник);
						Запрос.УстановитьПараметр("Период", ИсходныеДанные.ПериодДействияНачало);
						Запрос.УстановитьПараметр("Период1", КонецДня(ИсходныеДанные.ПериодДействияНачало));
						РезультатЗапроса = Запрос.Выполнить();
						
						ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
						
						Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
							Если ВыборкаДетальныеЗаписи.Выработка = 0 Тогда
								Результат = 0;								
							КонецЕсли;
							Если Организация.ИНН = "100071565" и ВыборкаДетальныеЗаписи.Выработка <> 0 и не ВыборкаДетальныеЗаписи.Выработка = null Тогда
								Результат = 0;								
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
				Иначе
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РазмерСдельногоЗаработка,Константы.ВалютаРегламентированногоУчета.Получить());
					Если Организация.ИНН = "100071565" и ИсходныеДанные.РазмерСдельногоЗаработка <> 0 Тогда
						Результат = 0;		
					КОнецЕсли;
				КонецЕсли;
				
				//Аверсон ЕАЕ 09.02.2024 СВФР-012254
				//Климовичи (врем.перевод)
				Если Организация.ИНН = "700103211" Тогда
					Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой Тогда
						Если мСтрока.НеРассчитыватьНачислениеЕслиПроведеноОплатаПоСреднему Тогда
							БылВременныйПеревод = ПроверитьВременныйПеревод(Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
							Если БылВременныйПеревод Тогда
								БылаОплатаПоСреднемуПеревод = ПроверитьОплатуПоСреднемуВременныйПеревод(Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец);
								Если БылаОплатаПоСреднемуПеревод Тогда
									Результат = 0;	
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				//Аверсон СВФР-012254
				
				//Аверсон ЕАЕ 30.06.2025 СВФР-015776
				//Гроднооблгаз
				//??? при каких тут еще условиях
				Если Организация.ИНН = "500036445" ИЛИ Организация.ИНН = "500826909" Тогда 
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений.Показатель1 * ОтработаноВремениОсновное,Константы.ВалютаРегламентированногоУчета.Получить());	
				КонецЕсли;
				//Аверсон СВФР-015776
				
			иначе
				
				//толик	Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * ОтработаноВремениОсновное,Константы.ВалютаРегламентированногоУчета.Получить());
				
				Если ИсходныеДанные.РазмерСдельногоЗаработка = NULL или Организация.ИНН = "600124787" или Организация.ПовременнаяОплатаПриСделке Тогда //Организация.ИНН = "600124787"
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(СтрокаДвижений.Показатель3=0, СтрокаДвижений[ПоказательРазмер], СтрокаДвижений.Показатель3) * ОтработаноВремениОсновное,Константы.ВалютаРегламентированногоУчета.Получить());
				Иначе
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РазмерСдельногоЗаработка,Константы.ВалютаРегламентированногоУчета.Получить());
					//Если ИсходныеДанные.ЗачетНормыВремени Или ИсходныеДанные.ЗачетОтработанногоВремени Тогда
					//	СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
					//КонецЕсли;
					//Если КомментироватьРасчет Тогда
					//	ОбщегоНазначения.КомментарийРасчета("Размер сдельного заработка: " + ИсходныеДанные.РазмерСдельногоЗаработка, КомментарийВидаРасчета);
					//КонецЕсли;
				КонецЕсли;
				
			КонецЕсли;
			
			СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1); //Аверсон 23.03.2020 КВВ СВФР-005719
			
			//О.Т. Аверсон 21.02.2019 № 3208
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияПростоевРаботниковОрганизаций") Тогда 
				//СВФР-016389 Если СтрокаДвижений.Регистратор.РасчетОтЧасовогоТарифа ИЛИ СтрокаДвижений.Регистратор.РасчетОтЧасовогоТарифаСПовышениями Тогда //Аверсон 23.03.2020 КВВ СВФР-005719 (+РасчетОтЧасовогоТарифаСПовышениями)
					Запрос = Новый Запрос;
					Запрос.Текст =
					"ВЫБРАТЬ
					|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
					|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
					|ИЗ
					|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
					|ГДЕ
					|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
					|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
					|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период2
					|	И ВЫБОР
					|			КОГДА &ФлагПоТабелю
					|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
					|			ИНАЧЕ ИСТИНА
					|		КОНЕЦ"; 
					
					//Аверсон ЕАЕ 05.08.2025 СВФР-016333
					//Виток
					Если Организация.ИНН = "100194961" Тогда
						Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало); 
						Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец); 
					Иначе
					//Аверсон СВФР-016333
					
						Запрос.УстановитьПараметр("Период", ?(ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаНачала),СтрокаДвижений.Регистратор.ДатаНачала,СтрокаДвижений.ПериодРегистрации)); //Аверсон 04.05.2020 КВВ СВФР-005941 (ДатаНачала)
						Запрос.УстановитьПараметр("Период2", ?(ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаОкончания),СтрокаДвижений.Регистратор.ДатаОкончания,СтрокаДвижений.ПериодРегистрации)); //Аверсон 04.05.2020 КВВ СВФР-005941 (ДатаОкончания)
					КонецЕсли;
					
					Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени",ИсходныеДанные.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени);
					УчетнаяПолитикаЗапрос = Новый Запрос;
					УчетнаяПолитикаЗапрос.Текст = 
					"ВЫБРАТЬ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
					|ИЗ
					|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
					|ГДЕ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
					УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
					УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
					если УчетнаяПолитика.Количество()>0 Тогда 
						Запрос.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
					иначе
						Запрос.УстановитьПараметр("ФлагПоТабелю",Ложь);
					КонецЕсли;
					
					Выборка = Запрос.Выполнить().Выбрать();
					Часы = 0;
					Пока Выборка.Следующий() Цикл 						
						Часы = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Часов,0); //Аверсон 29.04.2020 КВВ СВФР-005932
					КонецЦикла;
					ДанныеНаДату = ?(ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаНачала),СтрокаДвижений.Регистратор.ДатаНачала,НачалоМесяца(СтрокаДвижений.ПериодРегистрации)); //Аверсон 09.04.2020 КВВ СВФР-005834 : убрано "-1" в НачалоМесяца(СтрокаДвижений.ПериодРегистрации)
					ЧТСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, ДанныеНаДату, СтрокаДвижений.ГрафикРаботы,Истина,,,,,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,, Курс> 
					//Аверсон 23.03.2020 КВВ СВФР-005719 (
					Если СтрокаДвижений.Регистратор.РасчетОтЧасовогоТарифаСПовышениями Тогда
						ЧТСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, ДанныеНаДату, СтрокаДвижений.ГрафикРаботы,Ложь,Истина,,,,,,,Истина); 
					КонецЕсли;
					//Аверсон 23.03.2020 КВВ СВФР-005719 )
					
					//Аверсон 12.05.2023 КВВ СВФР-010820 (
					Если СтрокаДвижений.Регистратор.РасчетОтЧасовогоТарифа Тогда // СВФР-016389 И СтрокаДвижений.Организация.ИНН = "100194961" Тогда 
						ЧТСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, ДанныеНаДату, СтрокаДвижений.ГрафикРаботы, Ложь,Ложь,,,    ,,,,,,, Курс ); 
					КонецЕсли;
					//Аверсон 12.05.2023 КВВ СВФР-010820 )
					
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ЧТСтавка * Часы * 2 / 3,Константы.ВалютаРегламентированногоУчета.Получить());
					СтрокаДвижений.ОплаченоДнейЧасов = Часы * ?(СтрокаДвижений.Сторно,-1,1); //Аверсон 23.03.2020 КВВ СВФР-005719
				//СВФР-016389 КонецЕсли;
			КонецЕсли;
			//О.Т. Аверсон 21.02.2019 № 3208
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Должностной оклад/Тарифная ставка: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Отработанное время: " + ОтработаноВремениОсновное, КомментарийВидаРасчета);
			КонецЕсли;
			
			//СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1); //Аверсон 23.03.2020 КВВ СВФР-005719 (закомментировано, перенесено ДО простоев)
			
			
			///////////////
			//Толик
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки Тогда
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Должностной оклад/Тарифная ставка: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Отработанное время: " + ОтработаноВремениОсновное, КомментарийВидаРасчета);
			КонецЕсли;
			
			//если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
			//	мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы);
			//	мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
			//иначе
			//	мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы);
			//	мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
			//	
			//КонецЕсли;
			
			мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы,,,,,,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,,,,,,, Курс>
			мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноВремени); //О.Т. Аверсон 18.09.2017 № 1049 ОтработаноВремени
			
			
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТрарифнаяСтавка * мОтработаноЧасов * (СтрокаДвижений.Показатель1/100),Константы.ВалютаРегламентированногоУчета.Получить());
			//СтрокаДвижений.Показатель1 = мТрарифнаяСтавка;//Островская Татьяна 10.04.2013 №  16397
			СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезКонтракта или 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиПоИнструкции Тогда
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Должностной оклад/Тарифная ставка: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Отработанное время: " + ОтработаноВремениОсновное, КомментарийВидаРасчета);
			КонецЕсли;
			Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиПоИнструкции Тогда
				если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
					мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы, Ложь,,,,мОтработаноЧас,Ложь,,,Истина,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,, Курс> //Островская Татьяна 15.03.2013 № 16327
					мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
				иначе
					мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы,,,,,,Ложь,, ВидРасчета,Истина,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,, Курс>
					мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
					
				КонецЕсли;
			иначе
				если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
					мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы, Ложь,,,,мОтработаноЧас,Истина,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,, Курс>  //Островская Татьяна 15.03.2013 № 16327
					мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
				иначе
					мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы,,,,,,Истина,, ВидРасчета,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,, Курс>  //Аверсон 09.06.2020 КВВ СВФР-006118 (ЗАПЯТАЯ перед курсом)
					мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
					
				КонецЕсли;
			КонецЕсли;
			
			//Островская Татьяна 15.03.2013 № 16327
			ЕстьИндивидуальныйГрафик = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Сотрудник);
			ДанныеНормаЧасов = ПрочиеПроцедуры.ПолучитьРасчетнуюНормуЧасов(СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Сотрудник);
			если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням и ЕстьИндивидуальныйГрафик.КоличествоДней = 0 и
				не ДанныеНормаЧасов.НормаЧасовРасчетная = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Организация) Тогда 
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТрарифнаяСтавка * мОтработаноЧасов * (СтрокаДвижений.Показатель1/100),Константы.ВалютаРегламентированногоУчета.Получить());
			Иначе 
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТрарифнаяСтавка * мОтработаноЧасов * (СтрокаДвижений.Показатель1/100),Константы.ВалютаРегламентированногоУчета.Получить());
			КонецЕсли;
			//Островская Татьяна 15.03.2013 № 16327
			//СтрокаДвижений.Показатель1 = мТрарифнаяСтавка;//Островская Татьяна 10.04.2013 №  16397
			СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
			
			//Аверсон 05.12.2022 КВВ СВФР-009956 (
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезПовышенийИДоплат Тогда	
			//Аверсон 16.12.2022 КВВ СВФР-010038 (пункт 5) (
			//ДанныеНормаЧасов = ПрочиеПроцедуры.ПолучитьРасчетнуюНормуЧасов(СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Сотрудник);
			ДанныеНормаЧасов = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Организация);
			//Аверсон 16.12.2022 КВВ СВФР-010038 (пункт 5) )
			
			мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
			Результат = 0;
			Если ДанныеНормаЧасов <> 0 Тогда
				МТС = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецДня(СтрокаДвижений.ПериодДействияНачало),Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ТарифнаяСтавка;
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте((МТС)/ДанныеНормаЧасов * мОтработаноЧасов * (СтрокаДвижений.Показатель1/100),Константы.ВалютаРегламентированногоУчета.Получить());
				СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
			КонецЕсли;
			//Аверсон 05.12.2022 КВВ СВФР-009956 )
			
			//Аверсон 07.04.2023 КВВ СВФР-010563 (
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиДляВакантнойДолжности Тогда	
			ДанныеНормаЧасов = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Организация);
			мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
			Результат = 0;
			Если ДанныеНормаЧасов <> 0 Тогда
				З = Новый Запрос;
				З.Текст = "ВЫБРАТЬ
				|НачисленияРаботниковОрганизации.Регистратор,
				|НачисленияРаботниковОрганизации.Показатель1,
				|НачисленияРаботниковОрганизации.НомерСтроки						
				|ПОМЕСТИТЬ ВтПланНач						
				|ИЗ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(&парамНачало,
				|ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
				|ГДЕ
				|ВЫБОР
				|КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
				|ИНАЧЕ НачисленияРаботниковОрганизации.Действие
				|КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)				
				|И ВЫБОР
				|КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|ТОГДА ВЫБОР
				|КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|ТОГДА НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиДляВакантнойДолжности)
				|ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиДляВакантнойДолжности)
				|КОНЕЦ
				|ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиДляВакантнойДолжности)
				|КОНЕЦ 
				|;
				|ВЫБРАТЬ 
				|ОснНач.ПодразделениеПоСовмещению,
				|ОснНач.ДолжностьПоСовмещению,
				|ОснНач.РазрядЕТСПоСовмещению
				|ПОМЕСТИТЬ ВтПодрДолж
				|ИЗ Документ.ВводСведенийОПлановыхНачисленияхРаботниковОрганизаций.ОсновныеНачисления КАК ОснНач
				|ЛЕВОЕ СОЕДИНЕНИЕ ВтПланНач
				|ПО ОснНач.Ссылка = ВтПланНач.Регистратор
				|И ОснНач.НомерСтроки = ВтПланНач.НомерСтроки
				|ГДЕ ОснНач.Ссылка = ВтПланНач.Регистратор
				|И ОснНач.ВидРасчета = &ВР
				|;
				|ВЫБРАТЬ 
				|ВтПодрДолж.ПодразделениеПоСовмещению,
				|ВтПодрДолж.ДолжностьПоСовмещению,
				|ВтПодрДолж.РазрядЕТСПоСовмещению,
				|МАКСИМУМ(ПланШР.Период)
				|ПОМЕСТИТЬ ВтПланШР
				|ИЗ РегистрСведений.ПлановоеШтатноеРасписаниеОрганизаций.СрезПоследних(&парамНачало) КАК ПланШР
				|ЛЕВОЕ СОЕДИНЕНИЕ ВтПодрДолж
				|ПО ПланШР.ПодразделениеОрганизации = ВтПодрДолж.ПодразделениеПоСовмещению
				|И ПланШР.Должность = ВтПодрДолж.ДолжностьПоСовмещению
				|И ПланШР.РазрядЕТС = ВтПодрДолж.РазрядЕТСПоСовмещению
				|ГДЕ ПланШР.ПодразделениеОрганизации = ВтПодрДолж.ПодразделениеПоСовмещению
				|И ПланШР.Должность = ВтПодрДолж.ДолжностьПоСовмещению
				|И ПланШР.РазрядЕТС = ВтПодрДолж.РазрядЕТСПоСовмещению
				|СГРУППИРОВАТЬ ПО
				|ВтПодрДолж.ПодразделениеПоСовмещению,
				|ВтПодрДолж.ДолжностьПоСовмещению,
				|ВтПодрДолж.РазрядЕТСПоСовмещению				
				|;
				|ВЫБРАТЬ 
				|ВтПланШР.ПодразделениеПоСовмещению,
				|ВтПланШР.ДолжностьПоСовмещению,
				|ВтПланШР.РазрядЕТСПоСовмещению,
				|ПланШР.Период,
				|ПланШР.ТарифнаяСтавка,
				
				//Аверсон ЕАЕ 20.09.2024 СВФР-013339
				|ПланШР.РазмерСтавки1Разряда,
				|ПланШР.КоэффициентЕТС
				//Аверсон СВФР-013339
				
				|ИЗ РегистрСведений.ПлановоеШтатноеРасписаниеОрганизаций КАК ПланШР
				|ЛЕВОЕ СОЕДИНЕНИЕ ВтПланШР
				|ПО ПланШР.ПодразделениеОрганизации = ВтПланШР.ПодразделениеПоСовмещению
				|И ПланШР.Должность = ВтПланШР.ДолжностьПоСовмещению
				|И ПланШР.РазрядЕТС = ВтПланШР.РазрядЕТСПоСовмещению
				|ГДЕ ПланШР.ПодразделениеОрганизации = ВтПланШР.ПодразделениеПоСовмещению
				|И ПланШР.Должность = ВтПланШР.ДолжностьПоСовмещению
				|И ПланШР.РазрядЕТС = ВтПланШР.РазрядЕТСПоСовмещению
				|И ПланШР.Период = ВтПланШР.Период";
				З.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);				
				З.УстановитьПараметр("парамНачало",СтрокаДвижений.ДатаНачалаСобытия);
				З.УстановитьПараметр("ВР",СтрокаДвижений.ВидРасчета);
				
				РезЗ = З.Выполнить().Выгрузить();
				МТС = 0;
				
				//Аверсон ЕАЕ 20.09.2024 СВФР-013339
				РазмерСтавки1Разряда = 0;
				КоэффициентЕТС       = 0;
				//Аверсон СВФР-013339
				
				Если РезЗ.Количество() > 0 Тогда
					МТС = РезЗ[0].ТарифнаяСтавка;
					
					//Аверсон ЕАЕ 20.09.2024 СВФР-013339
					РазмерСтавки1Разряда = РезЗ[0].РазмерСтавки1Разряда;
					КоэффициентЕТС       = РезЗ[0].КоэффициентЕТС;
					//Аверсон СВФР-013339
					
				КонецЕсли;
				
				//МТС = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецДня(СтрокаДвижений.ПериодДействияНачало),Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ТарифнаяСтавка;
				
				//Аверсон ЕАЕ 18.09.2024 СВФР-013560
				//Результат = ОбщегоНазначения.ОкруглитьПоВалюте((МТС)/ДанныеНормаЧасов * мОтработаноЧасов * (СтрокаДвижений.Показатель1/100),Константы.ВалютаРегламентированногоУчета.Получить());
				//Результат = ОбщегоНазначения.ОкруглитьПоВалюте((МТС)/ДанныеНормаЧасов * мОтработаноЧасов * СтрокаДвижений.Показатель2 * (СтрокаДвижений.Показатель1/100),Константы.ВалютаРегламентированногоУчета.Получить());
				
				Если ДанныеНормаЧасов = 0 Тогда
					Результат = 0;
				Иначе
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте((РазмерСтавки1Разряда * КоэффициентЕТС * СтрокаДвижений.Показатель2) / ДанныеНормаЧасов * мОтработаноЧасов * (СтрокаДвижений.Показатель1 / 100),Константы.ВалютаРегламентированногоУчета.Получить());
				КонецЕсли;	
				
				//Аверсон СВФР-013560
				
				СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
			КонецЕсли;
			//Аверсон 07.04.2023 КВВ СВФР-010563 )
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС Тогда
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Должностной оклад/Тарифная ставка: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Отработанное время: " + ОтработаноВремениОсновное, КомментарийВидаРасчета);
			КонецЕсли;
			если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы, Ложь,,,,мОтработаноЧас,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,, Курс> //Островская Татьяна 15.03.2013 № 16327
				мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
			иначе
				мТрарифнаяСтавка = ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ГрафикРаботы,,,,,,,,,,,, Курс ); //+ СВЭЙ КДЯ 24.01.20 СВФР-005407  - добавлено: <,,,,,,,,,,,, Курс>
				мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
			КонецЕсли;
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТрарифнаяСтавка * ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, мОтработаноЧасов) * (СтрокаДвижений[ПоказательРазмер]/100),Константы.ВалютаРегламентированногоУчета.Получить());
			
			СтрокаДвижений.ОплаченоДнейЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, мОтработаноЧасов) * ?(СтрокаДвижений.Сторно,-1,1);
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Питание Тогда
			//Островская Татьяна 26.11.2012 № ??
			если ЗначениеЗаполнено(ОтработаноДнейДляПитания) тогда
				Показатель1 = ОтработаноДнейДляПитания;
			иначе
				
				Попытка
					Показатель1 = ИсходныеДанные.НормаВремениЗаМесяц;
				Исключение
					ЗапросНормаВремени = Новый Запрос;
					ЗапросНормаВремени.Текст = 
					"ВЫБРАТЬ
					|	СУММА(ГрафикиРаботыПоВидамВремени.ОсновноеЗначение) КАК ОсновноеЗначение,
					|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ДополнительноеЗначение,
					|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы,
					|	ГрафикиРаботыПоВидамВремени.ВидУчетаВремени
					|ИЗ
					|	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
					|			РаботникиОрганизацийСрезПоследних.ГрафикРаботы КАК ГрафикРаботы
					|		ИЗ
					|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Месяц1, ) КАК РаботникиОрганизацийСрезПоследних
					|		ГДЕ
					|			РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник) КАК ВложенныйЗапрос
					|		ПО ГрафикиРаботыПоВидамВремени.ГрафикРаботы = ВложенныйЗапрос.ГрафикРаботы
					|ГДЕ
					|	ГрафикиРаботыПоВидамВремени.Месяц МЕЖДУ &Месяц И &Месяц1
					|	И ГрафикиРаботыПоВидамВремени.ВидВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
					|
					|СГРУППИРОВАТЬ ПО
					|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы,
					|	ГрафикиРаботыПоВидамВремени.ВидУчетаВремени";
					ЗапросНормаВремени.УстановитьПараметр("Месяц",НачалоМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации));
					ЗапросНормаВремени.УстановитьПараметр("Месяц1",КонецМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации));
					ЗапросНормаВремени.УстановитьПараметр("Сотрудник",ИсходныеДанные.Сотрудник);
					РезНормаВремени = ЗапросНормаВремени.Выполнить().Выбрать();
					Пока РезНормаВремени.Следующий() Цикл 
						Показатель1 = РезНормаВремени.ОсновноеЗначение;
					КонецЦикла;
					
				КонецПопытки;
				
			КонецЕсли;
			//Островская Татьяна 26.11.2012 № ??
			
			мСтоимостьТалона = 	РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация,ВидПараметра,Категория",СтрокаДвижений.Организация,Перечисления.ВидыПараметровДляРасчетаЗарплаты.СтоимостьТалонаНаПитание, Справочники.КатегорииРаботников.ПустаяСсылка())).Размер;
			//Островская Татьяна 26.11.2012 № ??
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мСтоимостьТалона * Показатель1,Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
			СтрокаДвижений.ОплаченоДнейЧасов = Показатель1;
			СтрокаДвижений.Показатель1 = Показатель1;
			//Островская Татьяна 26.11.2012 № ??
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Разъездные Тогда
			//Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер] * СтрокаДвижений.Показатель2,Константы.ВалютаРегламентированногоУчета.Получить());//0.4;
			//СтрокаДвижений.ОплаченоДней = СтрокаДвижений[ПоказательРазмер];
			
			//Аверсон 15.10.2019 КВВ СВФР-004858 (
			ОтработаноДнейРазъездных = 0;
			Запрос = Новый Запрос;
			Запрос.Текст =
			"ВЫБРАТЬ
			|РабочееВремяРаботниковОрганизаций.Дней
			|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
			|ГДЕ РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
			|И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
			|И РабочееВремяРаботниковОрганизаций.Период >= &Период
			|И РабочееВремяРаботниковОрганизаций.Период <= &Период2";
			Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			Запрос.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
			Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));    					
			Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени);
			Выборка = Запрос.Выполнить().Выбрать();
			Пока Выборка.Следующий() цикл
				ОтработаноДнейРазъездных = ОтработаноДнейРазъездных+Выборка.Дней;
			КонецЦикла;
			
			СуммаРазъездных = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(СтрокаДвижений.БазовыйПериодНачало, 
			Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.Разъездные)).Размер;
			
			Результат = Окр(ОтработаноДнейРазъездных * СуммаРазъездных,2);
			СтрокаДвижений.ОплаченоДней = ОтработаноДнейРазъездных;
			СтрокаДвижений.Показатель1 = ОтработаноДнейРазъездных;
			//Аверсон 15.10.2019 КВВ СВФР-004858 )
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредность Тогда
			//мТС1Разряда = 	РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			//	Новый Структура("Организация,ВидПараметра,Категория",СтрокаДвижений.Организация,Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ, Справочники.КатегорииРаботников.ПустаяСсылка())).Размер;
			//Островская Татьяна 13.02.2013 № 15797
			ОтработаноЧасовВредность = Неопределено;
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
				ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
				Если ТЗКолвоДнКом.Количество() > 0 Тогда
					Для Каждого Стр Из ТЗКолвоДнКом Цикл
						Если Стр.Дней > 0 Тогда
							мОтработаноЧас = мОтработаноЧасов + Стр.Часов;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
			
			Если  СтрокаДвижений.Организация.ИНН = "700067572" Тогда			
				мОтработаноЧас = мОтработаноЧас +  ОтработаноЧасовПС;
			КонецЕсли;
			
			Запрос = Новый Запрос;
			Если СтрокаДвижений.Организация.ИНН = "100765738" и ВЦеломЗаПериод Тогда //О.Т. Аверсон 13.12.2016 № 100
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СУММА(РабочееВремяРаботниковОрганизаций.ЧасовВредность) КАК ЧасовВредность
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
				|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)";
			иначе
				
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СУММА(РабочееВремяРаботниковОрганизаций.ЧасовВредность) КАК ЧасовВредность
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|	И РабочееВремяРаботниковОрганизаций.Период >= &Период
				|	И РабочееВремяРаботниковОрганизаций.Период <= &Период2";
			КонецЕсли;
			
			Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			//Островская Татьяна 28.04.2014 № 17292
			Если СтрокаДвижений.Организация.ИНН = "100765738" и ВЦеломЗаПериод Тогда  //О.Т. Аверсон 13.12.2016 № 100
				если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
				иначе		
					Запрос.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
					Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));    					
				КонецЕсли;
			иначе
				//Аверсон 19.06.2022 КВВ СВФР-009216 (
				Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") 
					И ИсходныеДанные.Регистратор.ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);
				Иначе
					//Аверсон 19.06.2022 КВВ СВФР-009216 )
					Запрос.УстановитьПараметр("Период", ?(ВЦеломЗаПериод,НачалоМесяца(СтрокаДвижений.ПериодРегистрации),СтрокаДвижений.ПериодДействияНачало));
					Запрос.УстановитьПараметр("Период2", ?(ВЦеломЗаПериод,КонецМесяца(СтрокаДвижений.ПериодРегистрации),СтрокаДвижений.ПериодДействияКонец));
				КонецЕсли;
			КонецЕсли;
			//Островская Татьяна 28.04.2014 № 17292
			Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Вредность);
			Выборка = Запрос.Выполнить().Выбрать();
			Пока Выборка.Следующий() цикл
				ОтработаноЧасовВредность = Выборка.ЧасовВредность;
			КонецЦикла;
			//Островская Татьяна 13.02.2013 № 15797
			// Отсровская заявка № 15085
			
			ВидСтавки =  СтрокаДвижений.ВидРасчета.ТарифнаяСтавка1Разряда; // О.Т. 20.11.2014 289
			если не ЗначениеЗаполнено(ВидСтавки) Тогда 
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|			&Период,
				|			Сотрудник = &Сотрудник
				|				И Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
				
				Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);//О.Т. Аверсон 07.06.2016 № 2016
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				
				РезультатЗапроса = Запрос.Выполнить();
				
				ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					ВидСтавки = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
				КонецЦикла;
				
			КонецЕсли;
			
			
			
			Запрос = Новый Запрос;
			Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
			Запрос.УстановитьПараметр("Период", СтрокаДвижений.ДатаНачалаСобытия);
			Запрос.УстановитьПараметр("ТарифнаяСтавка", ВидСтавки);
			Запрос.Текст =
			"ВЫБРАТЬ
			|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер
			|ИЗ
			|	РегистрСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.СрезПоследних(
			|			&Период,
			|			Организация = &Организация
			|				И ТарифнаяСтавка = &ТарифнаяСтавка) КАК ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних";
			
			Ставка = Запрос.Выполнить().Выбрать();
			Если Ставка.Следующий() тогда
				ТС1Разряда =  Ставка.Размер;
			КонецЕсли;
			если  ЗначениеЗаполнено(ВидСтавки) тогда
				мТС1Разряда = ТС1Разряда;
			иначе
				
				мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
				Новый Структура("Организация,ТарифнаяСтавка",СтрокаДвижений.Организация,Справочники.ТарифныеСтавкиПервогоРазряда.Основная)).Размер;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 20.03.2012 заявка № 15085
			
			
			если не ЗначениеЗаполнено(мОтработаноЧас) тогда
				//мОтработаноЧас = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
				//Аверсон-софт, Островская Татьяна 26.03.2012 
				//мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
				//Аверсон-софт, Островская Татьяна 26.03.2012 
				мОтработаноЧас = 0;
				мОтработаноЧасов = 0;
			КонецЕсли;   
			//Островская Татьяна 13.12.2013 № 16978
			если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
				мОтработаноЧас = ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка;
			КонецЕсли; 	
			Если  СтрокаДвижений.Организация.ИНН = "100071565" и ОтработаноЧасовВредность <> Null Тогда			
				ОтработаноЧасовВредность = ОтработаноЧасовВредность +  ОтработаноЧасовПС;
			КонецЕсли;
			//Островская Татьяна 13.12.2013 № 16978
			//Островская Татьяна 13.02.2013 № 15797
			если ОтработаноЧасовВредность <> Неопределено и ОтработаноЧасовВредность <> Null Тогда 
				Если СтрокаДвижений.ПериодРегистрации < Дата(2016,07,1) Тогда //О.Т. Аверсон 15.03.2016 № 949
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100),2) * ОтработаноЧасовВредность,Константы.ВалютаРегламентированногоУчета.Получить());
				иначе
					Если СтрокаДвижений.Организация.ИНН = "100074549" или СтрокаДвижений.Организация.ИНН = "100071565" Тогда //О.Т. Аверсон 25.09.2017 № 1065
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100),2) * ОтработаноЧасовВредность,Константы.ВалютаРегламентированногоУчета.Получить());
					иначе 						
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100) * ОтработаноЧасовВредность,Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
				КонецЕсли;
				СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноЧасовВредность * ?(СтрокаДвижений.Сторно,-1,1);//Островская Татьяна 25.04.2014(исправлено-всегда часы брать)
			Иначе
				Если СтрокаДвижений.ПериодРегистрации < Дата(2016,07,1) Тогда //О.Т. Аверсон 15.03.2016 № 949
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100),2) * мОтработаноЧас,Константы.ВалютаРегламентированногоУчета.Получить());
				иначе
					Если СтрокаДвижений.Организация.ИНН = "100074549" или СтрокаДвижений.Организация.ИНН = "100071565" Тогда //О.Т. Аверсон 25.09.2017 № 1065
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100),2) * мОтработаноЧас,Константы.ВалютаРегламентированногоУчета.Получить());
					иначеЕсли СтрокаДвижений.Организация.ИНН = "700067572" Тогда //О.Т. Аверсон 25.09.2017 № 1065
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100),3) * мОтработаноЧас,Константы.ВалютаРегламентированногоУчета.Получить());
					Иначе
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100) * мОтработаноЧас,Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
				КонецЕсли;
				СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧас * ?(СтрокаДвижений.Сторно,-1,1);//Островская Татьяна 25.04.2014(исправлено-всегда часы брать)
			КонецЕсли;
			//Островская Татьяна 13.02.2013 № 15797
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредностьОтОтработанногоВремени Тогда //О.Т. Аверсон 02.04.2016 № 972
			//мТС1Разряда = 	РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			//	Новый Структура("Организация,ВидПараметра,Категория",СтрокаДвижений.Организация,Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ, Справочники.КатегорииРаботников.ПустаяСсылка())).Размер;
			//Островская Татьяна 13.02.2013 № 15797
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
				ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
				Если ТЗКолвоДнКом.Количество() > 0 Тогда
					Для Каждого Стр Из ТЗКолвоДнКом Цикл
						Если Стр.Дней > 0 Тогда
							мОтработаноЧас = мОтработаноЧас + Стр.Часов;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
			
			ОтработаноЧасовВредность = Неопределено;
			Запрос = Новый Запрос;
			Если СтрокаДвижений.Организация.ИНН = "100765738" и ВЦеломЗаПериод Тогда //О.Т. Аверсон 13.12.2016 № 100
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СУММА(РабочееВремяРаботниковОрганизаций.ЧасовВредность) КАК ЧасовВредность
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
				|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)";
			иначе
				Запрос.Текст =
				"ВЫБРАТЬ
				|	РабочееВремяРаботниковОрганизаций.ЧасовВредность
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|	И РабочееВремяРаботниковОрганизаций.Период >= &Период
				|	И РабочееВремяРаботниковОрганизаций.Период <= &Период2";
			КонецЕсли;
			Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
			//Островская Татьяна 28.04.2014 № 17292
			Если СтрокаДвижений.Организация.ИНН = "100765738" и ВЦеломЗаПериод Тогда  //О.Т. Аверсон 13.12.2016 № 100
				если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
					Запрос.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
					Запрос.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
				иначе		
					Запрос.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
					Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));					
				КонецЕсли;
			иначе
				Запрос.УстановитьПараметр("Период", ?(ВЦеломЗаПериод,НачалоМесяца(СтрокаДвижений.ПериодРегистрации),СтрокаДвижений.ПериодДействияНачало));
				Запрос.УстановитьПараметр("Период2", ?(ВЦеломЗаПериод,КонецМесяца(СтрокаДвижений.ПериодРегистрации),СтрокаДвижений.ПериодДействияКонец));
			КонецЕсли;
			//Островская Татьяна 28.04.2014 № 17292
			Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Вредность);
			Выборка = Запрос.Выполнить().Выбрать();
			Пока Выборка.Следующий() цикл
				ОтработаноЧасовВредность = Выборка.ЧасовВредность;
			КонецЦикла;
			//Островская Татьяна 13.02.2013 № 15797
			// Отсровская заявка № 15085
			
			ВидСтавки =  СтрокаДвижений.ВидРасчета.ТарифнаяСтавка1Разряда; // О.Т. 20.11.2014 289
			если не ЗначениеЗаполнено(ВидСтавки) Тогда 
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|			&Период,
				|			Сотрудник = &Сотрудник
				|				И Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
				
				Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодРегистрации);
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				
				РезультатЗапроса = Запрос.Выполнить();
				
				ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					ВидСтавки = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
				КонецЦикла;
				
			КонецЕсли;
			
			
			
			Запрос = Новый Запрос;
			Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
			Запрос.УстановитьПараметр("Период", СтрокаДвижений.ДатаНачалаСобытия);
			Запрос.УстановитьПараметр("ТарифнаяСтавка", ВидСтавки);
			Запрос.Текст =
			"ВЫБРАТЬ
			|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер
			|ИЗ
			|	РегистрСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.СрезПоследних(
			|			&Период,
			|			Организация = &Организация
			|				И ТарифнаяСтавка = &ТарифнаяСтавка) КАК ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних";
			
			Ставка = Запрос.Выполнить().Выбрать();
			Если Ставка.Следующий() тогда
				ТС1Разряда =  Ставка.Размер;
			КонецЕсли;
			если  ЗначениеЗаполнено(ВидСтавки) тогда
				мТС1Разряда = ТС1Разряда;
			иначе
				
				мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
				Новый Структура("Организация,ТарифнаяСтавка",СтрокаДвижений.Организация,Справочники.ТарифныеСтавкиПервогоРазряда.Основная)).Размер;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 20.03.2012 заявка № 15085
			
			
			если не ЗначениеЗаполнено(мОтработаноЧас) тогда
				//мОтработаноЧас = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
				//Аверсон-софт, Островская Татьяна 26.03.2012 
				//мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
				//Аверсон-софт, Островская Татьяна 26.03.2012 
				мОтработаноЧас = 0;
				мОтработаноЧасов = 0;
			КонецЕсли;   
			//Островская Татьяна 13.12.2013 № 16978
			если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
				мОтработаноЧас = ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка;
			КонецЕсли; 		
			//Островская Татьяна 13.12.2013 № 16978
			//Островская Татьяна 13.02.2013 № 15797
			мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.Сотрудник);
			если ОтработаноЧасовВредность <> Неопределено и ОтработаноЧасовВредность <> Null Тогда 
				Если СтрокаДвижений.ПериодРегистрации < Дата(2016,07,1) Тогда //О.Т. Аверсон 15.03.2016 № 949  Убрала показ/100
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]),2) * ОтработаноЧасовВредность/мНорма.НормаЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
				иначе
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]) * ОтработаноЧасовВредность/мНорма.НормаЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
				КонецЕсли;
				СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноЧасовВредность * ?(СтрокаДвижений.Сторно,-1,1);//Островская Татьяна 25.04.2014(исправлено-всегда часы брать)
			иначе
				Если СтрокаДвижений.ПериодРегистрации < Дата(2016,07,1) Тогда //О.Т. Аверсон 15.03.2016 № 949
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]),2) * мОтработаноЧас/мНорма.НормаЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
				иначе
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]) * мОтработаноЧас/мНорма.НормаЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
				КонецЕсли;
				СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧас * ?(СтрокаДвижений.Сторно,-1,1);//Островская Татьяна 25.04.2014(исправлено-всегда часы брать)
			КонецЕсли;
			Если (СтрокаДвижений.Организация.ИНН = "100010315" ИЛИ СтрокаДвижений.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Организация.ИНН = "200400628") Тогда //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
				Результат = Результат/100;
			КонецЕсли;
			//Островская Татьяна 13.02.2013 № 15797
			
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаИзБюджета Тогда
			
			мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.Сотрудник);
			РаботникДолжность = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).Должность; 
			РегистрДоплата = РегистрыСведений.ДоплатаИзБюджета.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("СтрокаЕТС",РаботникДолжность.СтрокаЕТС));
			если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(РегистрДоплата.Сумма * мОтработаноЧасов / мНорма.НормаДней,Константы.ВалютаРегламентированногоУчета.Получить());
			иначе
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(РегистрДоплата.Сумма * мОтработаноЧасов / мНорма.НормаЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
			КонецЕсли;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаБригаду Тогда
			мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация, Сотрудник", СтрокаДвижений.Организация, ИсходныеДанные.Сотрудник));
			
			мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация, ТарифнаяСтавка",СтрокаДвижений.Организация, мСтрока.Категория.ТарифнаяСтавкаПервогоРазряда)).Размер;
			Если ЗначениеЗаполнено(мСтрока.ГрафикРаботы) Тогда //О.Т. Аверсон 05.02.2018 № 1547
				ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
				Новый Структура("Организация,ВидПараметра,Категория,ГрафикРаботы", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка(),мСтрока.ГрафикРаботы)).Размер;
				Если ЧасовВГоду = 0 Тогда 
					ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
					Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка())).Размер;
				КонецЕсли; 				
			иначе
				ЧасовВГоду = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
				Новый Структура("Организация,ВидПараметра,Категория", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов, Справочники.КатегорииРаботников.ПустаяСсылка())).Размер;
			КонецЕсли;
			
			если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
			иначе	
				мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
			КонецЕсли;
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС1Разряда / ЧасовВГоду * мОтработаноЧасов * (СтрокаДвижений[ПоказательРазмер]/100),Константы.ВалютаРегламентированногоУчета.Получить());
			СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
			
		//Аверсон ЕАЕ 23.05.2024 СВФР-012937
		//Бобруйсксельмаш (доплата за бригадирство)
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаБригадирство Тогда
			мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация, ТарифнаяСтавка",СтрокаДвижений.Организация, СтрокаДвижений.ВидРасчета.ТарифнаяСтавка1Разряда)).Размер;
			СреднемесячноеКоличествоЧасов = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация,ВидПараметра", СтрокаДвижений.Организация, Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов)).Размер;
			
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте((мТС1Разряда * СтрокаДвижений[ПоказательРазмер] / 100 / СреднемесячноеКоличествоЧасов) * мОтработаноЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
		//Аверсон СВФР-012937
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДетскийДень Тогда
			мДетскийДень = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация,ВидПараметра,Категория",СтрокаДвижений.Организация,Перечисления.ВидыПараметровДляРасчетаЗарплаты.ДетскийДень, Справочники.КатегорииРаботников.ПустаяСсылка())).Размер;
			
			если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
			иначе	
				мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
			КонецЕсли;
			
			
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мДетскийДень * мОтработаноЧасов, Константы.ВалютаРегламентированногоУчета.Получить());
			СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке4Разряда Тогда
			мТС4Разряда = 	РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация,ВидПараметра,Категория",СтрокаДвижений.Организация,Перечисления.ВидыПараметровДляРасчетаЗарплаты.ЧасоваяСтавка4разрядаОрганизации, Справочники.КатегорииРаботников.ПустаяСсылка())).Размер;
			если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноДней);
			иначе	
				мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
			КонецЕсли;
			
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС4Разряда * мОтработаноЧасов, Константы.ВалютаРегламентированногоУчета.Получить());
			СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПрямойСдельныйЗаработок Тогда
			
			мОтработаноЧасов = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДнейЧасов, ИсходныеДанные.ОтработаноЧасов);
			мОтработаноДней = ?(СтрокаДвижений.ЧасыИзДокумента, СтрокаДвижений.ОплаченоДней, ИсходныеДанные.ОтработаноДней);
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаДвижений[ПоказательРазмер],Константы.ВалютаРегламентированногоУчета.Получить());
			СтрокаДвижений.ОплаченоДнейЧасов = мОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
			СтрокаДвижений.ОплаченоДней = мОтработаноДней * ?(СтрокаДвижений.Сторно,-1,1);
			////КонецТолик
			///////////////////////
			// ВыходноеПособие	и  СохраняемыйЗаработокНаВремяТрудоустройства
		ИначеЕсли ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ВыходноеПособие ИЛИ 
			ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.СохраняемыйЗаработокНаВремяТрудоустройства Тогда
			
			Если НЕ СтрокаДвижений.Сторно Тогда 
				Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				Иначе
					Если ИсходныеДанные.СреднийЗаработок = NULL 
						ИЛИ (СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам и ИсходныеДанные.ОтработаноЧасовПоСреднему = 0)
						ИЛИ (СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и ИсходныеДанные.ОтработаноДнейПоСреднему = 0) Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных для расчета среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			ПроцентОплаты = 100;
			ОплачиваемоеВремя = СтрокаДвижений[ПоказательРазмер];
			
			Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
				ЗаработокЗаЕдиницуВремени = ИсходныеДанные.РазмерСреднегоЗаработка;
			Иначе
				Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
					ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноЧасовПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
				Иначе
					ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
				КонецЕсли;
			КонецЕсли;
			
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты/100,Константы.ВалютаРегламентированногоУчета.Получить());
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Оплачиваемые дни: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета(?(СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам,"Среднечасовой заработок: ","Среднедневной заработок: ") + ЗаработокЗаЕдиницуВремени, КомментарийВидаРасчета);
			КонецЕсли;
			
			СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя * ?(СтрокаДвижений.Сторно,-1,1);
			
		ИначеЕсли ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ВыходноеПособиеПоСокр или ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияВзаменПредупреждения Тогда //О.Т. Аверсон 20.10.2017 № 1108 новый воторой вид расчета добавлен
			//О.Т. 12.09.2014 № 17568
			Если НЕ СтрокаДвижений.Сторно Тогда 
				Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;  					
				КонецЕсли;
			КонецЕсли;
			ИтоговаяСумма = 0;
			если НаборЗаписейРасчетСреднего = Неопределено Тогда 
				
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
				|	СтрокаРасчетСреднего.ВидРасчета.Наименование КАК НаименованиеВидаРасчета,
				//- СВЭЙ КДЯ 26.02.20 СВФР-005574
				|	СтрокаРасчетСреднего.МесяцВыборки КАК МесяцВыборки,
				|	СтрокаРасчетСреднего.ОтработаноДней,
				|	СтрокаРасчетСреднего.ОтработаноЧасов,
				|	СтрокаРасчетСреднего.Результат,
				|	СтрокаРасчетСреднего.КоэффициентИндексации
				|ИЗ
				|	Документ.РасчетПриУвольненииРаботникаОрганизаций.РасчетСреднего КАК СтрокаРасчетСреднего
				|ГДЕ
				|	СтрокаРасчетСреднего.Ссылка = &ДокументСсылка";
				
				Запрос.УстановитьПараметр("ДокументСсылка", ИсходныеДанные.Регистратор);
				РезультатСредний = Запрос.Выполнить().Выгрузить();	
			иначе
				ТЗНаборЗаписей = Новый ТаблицаЗначений;
				//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
				ТЗНаборЗаписей.Колонки.Добавить("НаименованиеВидаРасчета");
				//- СВЭЙ КДЯ 26.02.20 СВФР-005574
				ТЗНаборЗаписей.Колонки.Добавить("МесяцВыборки");
				ТЗНаборЗаписей.Колонки.Добавить("ОтработаноДней");
				ТЗНаборЗаписей.Колонки.Добавить("ОтработаноЧасов");
				ТЗНаборЗаписей.Колонки.Добавить("Результат");
				ТЗНаборЗаписей.Колонки.Добавить("КоэффициентИндексации");
				
				Для Каждого стрЗначение из НаборЗаписейРасчетСреднего Цикл 
					если стрЗначение.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку Тогда 
						СтрокаНаборЗаписей = ТЗНаборЗаписей.Добавить();
						ЗаполнитьЗначенияСвойств(СтрокаНаборЗаписей,стрЗначение);
						//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
						СтрокаНаборЗаписей.НаименованиеВидаРасчета = стрЗначение.ВидРасчета.Наименование;
						//- СВЭЙ КДЯ 26.02.20 СВФР-005574
					КонецЕсли;
				КонецЦикла;
				РезультатСредний = ТЗНаборЗаписей;
				
			КонецЕсли;
			
			//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
			СуммаМесяца = Новый Соответствие;
			ВремяМесяца = Новый Соответствие;
			НормаМесяца = Новый Соответствие;
			//- СВЭЙ КДЯ 26.02.20 СВФР-005574
			
			для Каждого СтрРезультатСредний из  РезультатСредний Цикл
				Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
					ВремяМесяцаДнейЧасов = СтрРезультатСредний.ОтработаноЧасов; //+ СВЭЙ КДЯ 26.02.20 СВФР-005574
					
					НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрРезультатСредний.МесяцВыборки),КонецМесяца(СтрРезультатСредний.МесяцВыборки),ИсходныеДанные.Сотрудник).НормаЧасов;
					//+ СВЭЙ КДЯ 27.09.19 СВФР-004834
					Если СтрРезультатСредний.ОтработаноЧасов = 0 
						ИЛИ Найти( НРег( СтрРезультатСредний.НаименованиеВидаРасчета ), "годовой" ) = 0 //+ СВЭЙ КДЯ 26.02.20 СВФР-005574
						Тогда
						Результат = СтрРезультатСредний.Результат * СтрРезультатСредний.КоэффициентИндексации;
					Иначе
						//- СВЭЙ КДЯ 27.09.19 СВФР-004834
						//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
						//Результат = СтрРезультатСредний.Результат * СтрРезультатСредний.КоэффициентИндексации * НормаВремени / СтрРезультатСредний.ОтработаноЧасов;
						//- СВЭЙ КДЯ 26.02.20 СВФР-005574
						//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
						Результат = СтрРезультатСредний.Результат 
						* СтрРезультатСредний.КоэффициентИндексации 
						* СтрРезультатСредний.ОтработаноЧасов / НормаВремени;
						//- СВЭЙ КДЯ 26.02.20 СВФР-005574
						
						//+ СВЭЙ КДЯ 27.09.19 СВФР-004834
					КонецЕсли; 
					//- СВЭЙ КДЯ 27.09.19 СВФР-004834
				иначе
					ВремяМесяцаДнейЧасов = СтрРезультатСредний.ОтработаноДней; //+ СВЭЙ КДЯ 26.02.20 СВФР-005574
					
					НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрРезультатСредний.МесяцВыборки),КонецМесяца(СтрРезультатСредний.МесяцВыборки),ИсходныеДанные.Сотрудник).НормаДней;
					//+ СВЭЙ КДЯ 27.09.19 СВФР-004834
					Если СтрРезультатСредний.ОтработаноДней = 0 
						ИЛИ Найти( НРег( СтрРезультатСредний.НаименованиеВидаРасчета ), "годовой" ) = 0 //+ СВЭЙ КДЯ 26.02.20 СВФР-005574
						Тогда
						Результат = СтрРезультатСредний.Результат * СтрРезультатСредний.КоэффициентИндексации;
					Иначе
						//- СВЭЙ КДЯ 27.09.19 СВФР-004834
						//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
						//Результат = СтрРезультатСредний.Результат * СтрРезультатСредний.КоэффициентИндексации * НормаВремени / СтрРезультатСредний.ОтработаноДней;
						//- СВЭЙ КДЯ 26.02.20 СВФР-005574
						//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
						Результат = СтрРезультатСредний.Результат 
						* СтрРезультатСредний.КоэффициентИндексации 
						* СтрРезультатСредний.ОтработаноДней / НормаВремени;
						//- СВЭЙ КДЯ 26.02.20 СВФР-005574
						
						//+ СВЭЙ КДЯ 27.09.19 СВФР-004834
					КонецЕсли; 
					//- СВЭЙ КДЯ 27.09.19 СВФР-004834
				КонецЕсли;
				//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
				//ИтоговаяСумма = ИтоговаяСумма + Результат;
				//- СВЭЙ КДЯ 26.02.20 СВФР-005574
				//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
				Если ВремяМесяца[ СтрРезультатСредний.МесяцВыборки ] = Неопределено И ВремяМесяцаДнейЧасов <> 0 Тогда
					ВремяМесяца[ СтрРезультатСредний.МесяцВыборки ] = ВремяМесяцаДнейЧасов;	
				КонецЕсли; 
				Если НормаМесяца[ СтрРезультатСредний.МесяцВыборки ] = Неопределено И НормаВремени <> 0 Тогда
					НормаМесяца[ СтрРезультатСредний.МесяцВыборки ] = НормаВремени;	
				КонецЕсли; 
				Если СуммаМесяца[ СтрРезультатСредний.МесяцВыборки ] = Неопределено Тогда
					СуммаМесяца[ СтрРезультатСредний.МесяцВыборки ] = 0;	
				КонецЕсли; 
				СуммаМесяца[ СтрРезультатСредний.МесяцВыборки ] = 
				СуммаМесяца[ СтрРезультатСредний.МесяцВыборки ] + Результат;
				//- СВЭЙ КДЯ 26.02.20 СВФР-005574
			КонецЦикла;
			//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
			Для каждого КлючЗначение Из СуммаМесяца Цикл
				ИтоговаяСумма = ИтоговаяСумма + КлючЗначение.Значение 
				* НормаМесяца[ КлючЗначение.Ключ ]/ ВремяМесяца[ КлючЗначение.Ключ ];
			КонецЦикла; 
			//- СВЭЙ КДЯ 26.02.20 СВФР-005574
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИтоговаяСумма/ИсходныеДанные.ВидРасчета.ЧислоМесяцев * СтрокаДвижений.Показатель1,Константы.ВалютаРегламентированногоУчета.Получить());
			СтрокаДвижений.ОплаченоДнейЧасов = СтрокаДвижений.Показатель1* ?(СтрокаДвижений.Сторно,-1,1);
			//О.Т. 12.09.2014 № 17568
			
			// ОплатаПоСреднему
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку Тогда
			
			Если НЕ СтрокаДвижений.Сторно Тогда 
				Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				Иначе
					Если ИсходныеДанные.СреднийЗаработок = NULL 
						ИЛИ СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам и ИсходныеДанные.ОтработаноЧасовПоСреднему = 0
						ИЛИ СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и ИсходныеДанные.ОтработаноЧасовПоСреднему = 0 Тогда
						//толик расчет по среднему из документа начисление ЗП						
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных для расчета среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			ПроцентОплаты = ?(СтрокаДвижений[ПоказательРазмер] = 0, 100, СтрокаДвижений[ПоказательРазмер]);
			если СтрокаДвижений.Организация.КодАктивацииТранспорта <> "" и ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку")
				и ЗначениеЗаполнено(ИсходныеДанные.ОтработаноДней) Тогда //Островская Татьяна 04.12.2013 № 16средний для ремондиса
				ОплачВремяЧасы = ИсходныеДанные.ОтработаноДней; //Островская Татьяна 04.12.2013 № 16 средний для ремондиса 17723
				Время = ПрочиеПроцедуры.ОтработанноеВремяПоСводнымГраффикам(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, ИсходныеДанные.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени, Ложь, Ложь,СтрокаДвижений.Организация); //О.Т. 23.12.2014 № 
				ОплачиваемоеВремяВЧасах = Время.Часов;
				// ПСА 04-12-2020 СВФР-006906+++
				ОплачиваемоеВремяЧасы = Время.Часов;
				
				Если НЕ СтрокаДвижений.Сторно Тогда
					
					Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
						ЗаработокЗаЕдиницуВремени = ИсходныеДанные.РазмерСреднегоЗаработка;
						//Островская Татьяна 28.05.2013 № 15793
						если СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам Тогда
							ОплачВремяЧасы = СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
						КонецЕсли;
						//Островская Татьяна 28.05.2013 № 15793
						
					Иначе
						если СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам Тогда 
							ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноЧасовПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
							ОплачВремяЧасы =  СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
						иначе
							ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
							ОплачВремяЧасы = ИсходныеДанные.ОтработаноДней; //Островская Татьяна 04.12.2013 Средний для ремондиса 17723 
							
						КонецЕсли;
					КонецЕсли;	
					
					// сохраним заработок за единицу времени для возможных расчетов сторно записей в будущем 
					СтрокаДвижений.ДополнительныеДанные = ЗаработокЗаЕдиницуВремени;
					
				Иначе
					ЗаработокЗаЕдиницуВремени = СтрокаДвижений.ДополнительныеДанные;
				КонецЕсли;
				
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачВремяЧасы * ЗаработокЗаЕдиницуВремени * ПроцентОплаты/100, Константы.ВалютаРегламентированногоУчета.Получить());
				
				Время = ПрочиеПроцедуры.ОтработанноеВремяПоСводнымГраффикам(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, ИсходныеДанные.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени, Ложь, Ложь,СтрокаДвижений.Организация);//О.Т. 23.12.2014 № 
				ОплачиваемоеВремя = Время.Часов;
				Если Время.Дней = 0 Тогда
					ОплачиваемоеВремяДни = Время.Часов / 8;
				Иначе
					ОплачиваемоеВремяДни = Время.Дней;
				КонецЕсли;
				//по графику
				Если ОплачиваемоеВремя = 0 Тогда
					ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Истина);
					ОплачиваемоеВремяДни = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Истина);
				КонецЕсли;
				Если ОплачиваемоеВремя = Null Тогда
					ОплачиваемоеВремя = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, , ГрафикиБезРабочегоВремени);
					ОплачиваемоеВремяДни = 0;
				КонецЕсли;
				//ОплачиваемоеВремя = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, , ГрафикиБезРабочегоВремени);
				//енд
				ВремяОплачиваемое = ОплачиваемоеВремяДни;//Островская Татьяна 30.04.2013 № 15793
				// Рассчитаем заработок за день (или за час для суммированного учета времени)
				// для строк сторно заработок возьмем из реквизита "ДополнительныеДанные" записи начислений
				Если НЕ СтрокаДвижений.Сторно Тогда
					
					Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
						//Островская Татьяна 28.05.2013 № 15793 
						если СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам Тогда
							ОплачиваемоеВремя = СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
							ВремяОплачиваемое =  СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
						КонецЕсли;
						//Островская Татьяна 28.05.2013 № 15793
					Иначе
						//Островская Татьяна 30.04.2013 № 15793
						Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
							если СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам Тогда 
								ВремяОплачиваемое =  СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
								ОплачиваемоеВремя = СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
							иначе
								ВремяОплачиваемое = ОплачиваемоеВремяДни;
							КонецЕсли;
							
						КонецЕсли;
						//Островская Татьяна 30.04.2013 № 15793
					КонецЕсли;	
					
				КонецЕсли;
				
			иначе
				
				//толик комм
				//по табелю
				Время = ПрочиеПроцедуры.ОтработанноеВремяПоСводнымГраффикам(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, ИсходныеДанные.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени, Ложь, Ложь,СтрокаДвижений.Организация); //О.Т. 23.12.2014 № 
				ОплачиваемоеВремя = Время.Часов;
				Если Время.Дней = 0 Тогда
					ОплачиваемоеВремяДни = Время.Часов / 8;
				Иначе
					ОплачиваемоеВремяДни = Время.Дней;
				КонецЕсли;
				ОплачиваемоеВремяЧасы = 0;  //Аверсон 07.07.2020 КВВ СВФР-006222
				//по графику
				Если ОплачиваемоеВремя = 0 Тогда
					ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Истина);
					ОплачиваемоеВремяДни = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Истина);
					ОплачиваемоеВремяЧасы = ОплачиваемоеВремя;  //Аверсон 07.07.2020 КВВ СВФР-006222
				КонецЕсли;
				Если ОплачиваемоеВремя = Null Тогда
					ОплачиваемоеВремя = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, , ГрафикиБезРабочегоВремени);
					ОплачиваемоеВремяДни = 0;
				КонецЕсли;
				//ОплачиваемоеВремя = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, , ГрафикиБезРабочегоВремени);
				//енд
				ВремяОплачиваемое = ОплачиваемоеВремяДни;//Островская Татьяна 30.04.2013 № 15793
				// Рассчитаем заработок за день (или за час для суммированного учета времени)
				// для строк сторно заработок возьмем из реквизита "ДополнительныеДанные" записи начислений
				Если НЕ СтрокаДвижений.Сторно Тогда
					
					Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
						ЗаработокЗаЕдиницуВремени = ИсходныеДанные.РазмерСреднегоЗаработка;
						//Островская Татьяна 28.05.2013 № 15793
						если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
							если СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам Тогда
								//Аверсон ЕАЕ 28.03.2021 СВФР-007091 (СВФР-007389)
								Если ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам) Тогда
									ОплачиваемоеВремя = СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
									ВремяОплачиваемое =  СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
								иначе
									//Аверсон СВФР-007091 (СВФР-007389)
									НормаВремениПоГрафику = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальномуЗаИнтервал(ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец,СтрокаДвижений.Сотрудник).КоличествоЧасов;
									Если не ЗначениеЗаполнено(НормаВремениПоГрафику)  Тогда
										мСтрокаГрафик = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ИсходныеДанные.ПериодДействияНачало),
										Новый Структура("Организация, Сотрудник", СтрокаДвижений.Сотрудник.Организация, СтрокаДвижений.Сотрудник));
										НормаВремениПоГрафику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(мСтрокаГрафик.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец,СтрокаДвижений.Организация);//О.Т. 03.06.2015 № 448
									КонецЕсли;
									//О.Т. 03.06.2015 № 448
									
									//СВЭЙ 04.07.2024 КВВ СВФР-013163 (
									Если НормаВремениПоГрафику = 0 Тогда 
										НормаВремениПоГрафику = ПроверкаПриказаНаРаботуВПраздникиИПереносДней(СтрокаДвижений.Сотрудник.Организация,СтрокаДвижений.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
									КонецЕсли;
									//СВЭЙ 04.07.2024 КВВ СВФР-013163 )
									
									ВремяОплачиваемое = НормаВремениПоГрафику;
									ОплачиваемоеВремя = НормаВремениПоГрафику;
									
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 28.05.2013 № 15793
					Иначе
						//Островская Татьяна 30.04.2013 № 15793
						Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
							если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
								если СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам Тогда
									ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноЧасовПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
									
									//Аверсон ЕАЕ 10.03.2021 СВФР-007091
									Если ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам) Тогда 
										ОплачиваемоеВремя = СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
										ВремяОплачиваемое =  СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам;
									иначе
										//Аверсон СВФР-007091
										
										//О.Т. 03.06.2015 № 448
										//Аверсон 28.05.2022 КВВ СВФР-009131 (
										//НормаВремениПоГрафику = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальномуЗаИнтервал(ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец,СтрокаДвижений.Сотрудник).КоличествоЧасов;
										ДанныеПоИндивидуальномуЗаИнтервал = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальномуЗаИнтервал(ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец,СтрокаДвижений.Сотрудник);
										НормаВремениПоГрафику = ДанныеПоИндивидуальномуЗаИнтервал.КоличествоЧасов;
										ДанныеПоИндивидуальномуЗаИнтервал_ЕстьГрафик = ДанныеПоИндивидуальномуЗаИнтервал.ЕстьГрафик;
										//Аверсон 28.05.2022 КВВ СВФР-009131 )
										
										Если не ЗначениеЗаполнено(НормаВремениПоГрафику) 
											И НЕ ДанныеПоИндивидуальномуЗаИнтервал_ЕстьГрафик Тогда //Аверсон 28.05.2022 КВВ СВФР-009131
											мСтрокаГрафик = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ИсходныеДанные.ПериодДействияНачало),
											Новый Структура("Организация, Сотрудник", СтрокаДвижений.Сотрудник.Организация, СтрокаДвижений.Сотрудник));
											НормаВремениПоГрафику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(мСтрокаГрафик.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец,СтрокаДвижений.Организация,,ИсходныеДанные.Регистратор);//О.Т. 03.06.2015 № 448  //СВЭЙ 16.02.2024 КВВ СВФР-012360 (Регистратор)
										КонецЕсли;
										
										//Аверсон ЕАЕ 10.03.2021 СВФР-007091
										ТЗКолвоДнКом = ПроведениеРасчетов.ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Сотрудник.Организация, СтрокаДвижений.Сотрудник, ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
										Если ТЗКолвоДнКом.Количество() > 0 Тогда
											ЧасовКомандировки = ТЗКолвоДнКом.Итог("Часов");
											Если ЧасовКомандировки > НормаВремениПоГрафику Тогда
												РазницаЧасов = ЧасовКомандировки - НормаВремениПоГрафику;
												НормаВремениПоГрафику = НормаВремениПоГрафику + РазницаЧасов;
											КонецЕсли;
										КонецЕсли;
										//Аверсон СВФР-007091
										
										//СВЭЙ 25.12.2023 КВВ СВФР-012032 (
										Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") 
											И (СтрокаДвижений.Организация.ИНН = "700067572") 
											И ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ПерерассчитываемыйДокумент) Тогда
											ЗПраздники = Новый Запрос;
											ЗПраздники.Текст = "ВЫБРАТЬ
											|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней,
											|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов
											|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
											|ГДЕ
											|	РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &парамНачало И &парамКонец
											|	И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
											|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени";
											ЗПраздники.УстановитьПараметр("парамНачало",ИсходныеДанные.ПериодДействияНачало);
											ЗПраздники.УстановитьПараметр("парамКонец",ИсходныеДанные.ПериодДействияКонец);
											ЗПраздники.УстановитьПараметр("Сотрудник",ИсходныеДанные.Сотрудник);
											ЗПраздники.УстановитьПараметр("ВидИспользованияРабочегоВремени",Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
											РезЗПраздники = ЗПраздники.Выполнить().Выгрузить();
											Для Каждого СЗПраздники ИЗ РезЗПраздники Цикл
												НормаВремениПоГрафику = НормаВремениПоГрафику + ?(СЗПраздники.Часов = Null, 0,СЗПраздники.Часов);
												ОплачиваемоеВремяДни = ОплачиваемоеВремяДни + ?(СЗПраздники.Дней = Null, 0,СЗПраздники.Дней);
											КонецЦикла;
										КонецЕсли;
										//СВЭЙ 25.12.2023 КВВ СВФР-012032 )
										
										
										//О.Т. 03.06.2015 № 448
										ВремяОплачиваемое = НормаВремениПоГрафику;
										ОплачиваемоеВремя = НормаВремениПоГрафику;
									КонецЕсли;
									
								иначе
									ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
									ВремяОплачиваемое = ОплачиваемоеВремяДни;
								КонецЕсли;
							иначе
								ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
								ВремяОплачиваемое = ОплачиваемоеВремяДни;
							КонецЕсли;
							
						Иначе
							ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
						КонецЕсли;
						//Островская Татьяна 30.04.2013 № 15793
					КонецЕсли;	
					
					// сохраним заработок за единицу времени для возможных расчетов сторно записей в будущем 
					СтрокаДвижений.ДополнительныеДанные = ЗаработокЗаЕдиницуВремени;
					
				Иначе
					ЗаработокЗаЕдиницуВремени = СтрокаДвижений.ДополнительныеДанные;
				КонецЕсли;
				
				//Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
				//	Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты/100, Константы.ВалютаРегламентированногоУчета.Получить());
				//Иначе
				
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ВремяОплачиваемое * ЗаработокЗаЕдиницуВремени * ПроцентОплаты/100, Константы.ВалютаРегламентированногоУчета.Получить()); //Островская Татьяна 30.04.2013 № 15793
				
			КонецЕсли;
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Процент оплаты: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета(?(СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам,"Среднечасовой заработок: ","Среднедневной заработок: ") + ЗаработокЗаЕдиницуВремени, КомментарийВидаРасчета);
			КонецЕсли;
			
			СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя * ?(СтрокаДвижений.Сторно,-1,1);
			//толик
			//Аверсон 07.07.2020 КВВ СВФР-006222 (
			Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") И ОплачиваемоеВремяЧасы > 0 И 
				ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам) И ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ЗначениеОплатаПоЧасам) 
				И ОплачиваемоеВремя <> ОплачиваемоеВремяЧасы Тогда //Аверсон 21.09.2020 КВВ СВФР-006588
				СтрокаДвижений.ОплаченоДней = Окр(ОплачиваемоеВремя/ОплачиваемоеВремяЧасы,2) * ?(СтрокаДвижений.Сторно,-1,1);
			Иначе
				//Аверсон 07.07.2020 КВВ СВФР-006222 )
				СтрокаДвижений.ОплаченоДней = ОплачиваемоеВремяДни * ?(СтрокаДвижений.Сторно,-1,1);
			КонецЕсли;
			//если учитывать отработанное время запишем данные
			Если СтрокаДвижений.ВидРасчета.ВидВремени = Перечисления.ВидыВремени.ОтработанноеВПределахНормы Тогда
				СтрокаДвижений.ОтработаноЧасов = ОплачиваемоеВремя * ?(СтрокаДвижений.Сторно,-1,1);
				СтрокаДвижений.ОтработаноДней = ОплачиваемоеВремяДни * ?(СтрокаДвижений.Сторно,-1,1);
			КонецЕсли;
			
			// ДоплатаДоСреднегоЗаработка
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка Тогда
			
			Если НЕ СтрокаДвижений.Сторно Тогда 
				Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				Иначе
					Если (ИсходныеДанные.СреднийЗаработок = NULL 
						ИЛИ СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам и ИсходныеДанные.ОтработаноЧасовПоСреднему = 0
						ИЛИ СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и ИсходныеДанные.ОтработаноДнейПоСреднему = 0)
						И ИсходныеДанные.Регистратор.Метаданные().Имя <> "НачислениеЗарплатыРаботникамОрганизаций" Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных для расчета среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			//толик доплата до среднего из докумета начисление ЗП
			Если ИсходныеДанные.Регистратор.Метаданные().Имя = "НачислениеЗарплатыРаботникамОрганизаций" Тогда
				мЗапрос = Новый Запрос;
				мЗапрос.Текст = 
				"ВЫБРАТЬ
				|	ОплатаПоСреднемуЗаработку.Ссылка КАК Документ
				|ИЗ
				|	Документ.ОплатаПоСреднемуЗаработку КАК ОплатаПоСреднемуЗаработку
				|ГДЕ
				|	ОплатаПоСреднемуЗаработку.Комментарий ПОДОБНО &Комментарий
				|	И ОплатаПоСреднемуЗаработку.ПериодРегистрации >= &ПериодРегистрации";
				мЗапрос.УстановитьПараметр("ПериодРегистрации", ИсходныеДанные.Регистратор.ПериодРегистрации);
				мЗапрос.УстановитьПараметр("Комментарий", "ВременныйДокумент");
				мСписокДок = мЗапрос.Выполнить().Выбрать();
				Если мСписокДок.Следующий() Тогда
					мВременныйДокумент = мСписокДок.Документ.ПолучитьОбъект();
					мВременныйДокумент.ПометкаУдаления = Ложь;
				Иначе
					мВременныйДокумент = Документы.ОплатаПоСреднемуЗаработку.СоздатьДокумент();
					мВременныйДокумент.Комментарий = "ВременныйДокумент";
					мВременныйДокумент.Дата = ТекущаяДата();
					мВременныйДокумент.Записать();
				КонецЕсли;
				мВременныйДокумент.ПериодРегистрации = ИсходныеДанные.Регистратор.ПериодРегистрации;
				мВременныйДокумент.ВидРасчета = СтрокаДвижений.ВидРасчета;
				мВременныйДокумент.Организация = СтрокаДвижений.Организация;
				мВременныйДокумент.СпособРегистрацииВремени = Перечисления.СпособыРегистрацииВремени.РегистрацияДляЦелойСмены;
				мВременныйДокумент.ПроцентОплаты = ?(СтрокаДвижений[ПоказательРазмер] = 0, 100, СтрокаДвижений[ПоказательРазмер]);
				мВременныйДокумент.Комментарий = "ВременныйДокумент";
				мВременныйДокумент.ДатаНачала = ИсходныеДанные.ПериодДействияНачало;
				мВременныйДокумент.ДатаОкончания = ИсходныеДанные.ПериодДействияКонец;
				мВременныйДокумент.Сотрудник = СтрокаДвижений.Сотрудник;
				мВременныйДокумент.Физлицо = СтрокаДвижений.Сотрудник.ФизЛицо;
				
				мРассчитываемыеТаблицы = Новый Структура("Начисления,РасчетСреднего");
				
				мВременныйДокумент.Записать(РежимЗаписиДокумента.ОтменаПроведения);
				
				мРассчитываемыеТаблицы.Начисления		= Истина;
				мРассчитываемыеТаблицы.РасчетСреднего	= Истина;
				мВременныйДокумент.Рассчитать(мРассчитываемыеТаблицы);
				мВременныйДокумент.ПометкаУдаления = Истина;
				мВременныйДокумент.Записать();
				Результат = мВременныйДокумент.Начисления.Итог("Результат");
				СтрокаДвижений.ОплаченоДнейЧасов = мВременныйДокумент.Начисления.Итог("ОплаченоДнейЧасов") * ?(СтрокаДвижений.Сторно,-1,1);
				СтрокаДвижений.ОплаченоДней = мВременныйДокумент.Начисления.Итог("ОплаченоДней") * ?(СтрокаДвижений.Сторно,-1,1);
			Иначе
				ПроцентОплаты = ?(СтрокаДвижений[ПоказательРазмер] = 0, 100, СтрокаДвижений[ПоказательРазмер]);
				//толик комм
				//по табелю
				Время = ПрочиеПроцедуры.ОтработанноеВремяПоСводнымГраффикам(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, ИсходныеДанные.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени, Ложь, Ложь,СтрокаДвижений.Организация);
				ОплачиваемоеВремя = Время.Часов;
				ОплачиваемоеВремяДни = Время.Дней;
				//по графику
				Если ОплачиваемоеВремя = 0 Тогда
					ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Истина);
					ОплачиваемоеВремяДни = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Истина);
				КонецЕсли;
				Если ОплачиваемоеВремя = Null Тогда
					ОплачиваемоеВремя = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, , ГрафикиБезРабочегоВремени);
					ОплачиваемоеВремяДни = 0;
				КонецЕсли;
				//ОплачиваемоеВремя = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, , ГрафикиБезРабочегоВремени);
				//енд
				
				// Рассчитаем заработок за день (или за час для суммированного учета времени)
				// для строк сторно заработок возьмем из реквизита "ДополнительныеДанные" записи начислений
				Если НЕ СтрокаДвижений.Сторно Тогда
					
					Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
						ЗаработокЗаЕдиницуВремени = ИсходныеДанные.РазмерСреднегоЗаработка;
					Иначе
						Если СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам Тогда
							ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноЧасовПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
						Иначе
							ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);//Наркевич 26.05.2014 №
						КонецЕсли;
					КонецЕсли;
					
					// сохраним заработок за единицу времени для возможных расчетов сторно записей в будущем 
					СтрокаДвижений.ДополнительныеДанные = ЗаработокЗаЕдиницуВремени;
					
				Иначе
					ЗаработокЗаЕдиницуВремени = СтрокаДвижений.ДополнительныеДанные;
				КонецЕсли;
				
				// Вычтем из среднего заработка начисленные суммы
				//толик
				мНачисленоЗаПериод = ПрочиеПроцедуры.ПолучитьБазуПоПериодуДействия(СтрокаДвижений.Сотрудник, ИсходныеДанные.ПериодДействияНачало, ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку, ИсходныеДанные.ПериодДействияКонец,СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам);
				Если СтрокаДвижений.Регистратор.ФлагОплатаПоЧасам тогда 
					мНачисленоЗаПериод = мНачисленоЗаПериод*ОплачиваемоеВремя;
					СреднийЗаработок = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты/100;
				Иначе
					мНачисленоЗаПериод = мНачисленоЗаПериод*ОплачиваемоеВремяДни;
					СреднийЗаработок = ОплачиваемоеВремяДни * ЗаработокЗаЕдиницуВремени * ПроцентОплаты/100;
				КонецЕсли;
				
				Если Не ЗначениеЗаполнено(мНачисленоЗаПериод) Тогда
					ОбщегоНазначения.СообщитьОбОшибке("По сотруднику: "+Строка(СтрокаДвижений.Сотрудник)+" нет кадрового перемещения или данных по начислениям за указанный период!");
					Результат = 0;
				Иначе
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Макс(СреднийЗаработок - мНачисленоЗаПериод, 0),Константы.ВалютаРегламентированногоУчета.Получить());
				КонецЕсли;
				
				Если КомментироватьРасчет Тогда
					ОбщегоНазначения.КомментарийРасчета("Процент оплаты: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
					ОбщегоНазначения.КомментарийРасчета(?(СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам,"Среднечасовой заработок: ","Среднедневной заработок: ") + ЗаработокЗаЕдиницуВремени, КомментарийВидаРасчета);
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					РасшифровкаБазы = ИсходныеДанные.Выбрать();
					Пока РасшифровкаБазы.Следующий() Цикл
						Если РасшифровкаБазы.РезультатБаза <> 0 Тогда
							ОбщегоНазначения.КомментарийРасчета(РасшифровкаБазы.ВидРасчетаРазрезНаименование + ": " + РасшифровкаБазы.РезультатБаза, КомментарийБазы);
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
				
				СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя * ?(СтрокаДвижений.Сторно,-1,1);
				СтрокаДвижений.ОплаченоДней = ОплачиваемоеВремяДни * ?(СтрокаДвижений.Сторно,-1,1);
			КонецЕсли;
			
			// ПоСреднемуЗаработкуФСС
			// больничные
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС Тогда
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
				Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				Иначе
					Если ИсходныеДанные.СреднийЗаработок = NULL Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных для расчета среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;	
				КонецЕсли;
				
				
				
				ОплачиваемоеВремяДни = ((СтрокаДвижений.БазовыйПериодКонец-СтрокаДвижений.БазовыйПериодНачало+1)/86400);
				ОплачиваемоеВремя = ((СтрокаДвижений.БазовыйПериодКонец-СтрокаДвижений.БазовыйПериодНачало+1)/86400);
				
				
				ТипРасчетаПоОкладу = СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу;
				НеРасчитыватьПропорционально = Ложь;
				
				Если СтрокаДвижений.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
					ВидНалогообложения = СтрокаДвижений.Организация.ОсновнаяСтавкаНалогообложения;
				иначе
					ВидНалогообложения = СтрокаДвижений.Сотрудник.ВидНалогообложенияОсновной;
				КонецЕсли;
				
				если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПоБеременностиИРодам Тогда 
					РазмерОграничения = РегистрыСведений.РазмерОграниченияПособияПоНетрудоспособности.ПолучитьПоследнее(КонецМесяца(ДобавитьМесяц(СтрокаДвижений.ПериодРегистрации, -1)),Новый Структура("Организация,ВидНалогоОбложения", СтрокаДвижений.Организация,ВидНалогообложения)).РазмерПоБеременности; //О.Т. Аверсон 28.04.2016 № 7777 НачалоМесяца(Выборка.ДатаНачала)
				иначе
					РазмерОграничения = РегистрыСведений.РазмерОграниченияПособияПоНетрудоспособности.ПолучитьПоследнее(КонецМесяца(ДобавитьМесяц(СтрокаДвижений.ПериодРегистрации, -1)),Новый Структура("Организация,ВидНалогоОбложения", СтрокаДвижений.Организация,ВидНалогообложения)).Размер; //О.Т. Аверсон 28.04.2016 № 7777 НачалоМесяца(Выборка.ДатаНачала)
				КонецЕсли;
				СредняяПоРБ = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(ДобавитьМесяц(СтрокаДвижений.Регистратор.ДатаНачала, -1)), //ИсходныеДанные.ПериодДействияНачало
				Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер; //Островская Татьяна 16.07.2013 № 16623
				РазмерОграничения =  РазмерОграничения * Макс(СредняяПоРБ, 1);
				
				
				//если Месяц(СтрокаДвижений.БазовыйПериодНачало) >= 2 и Месяц(СтрокаДвижений.БазовыйПериодНачало) <= 04 Тогда 
				//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.БазовыйПериодНачало)," ","")+"0201000000");
				//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.БазовыйПериодНачало)-1," ","")+"1101000000");
				//ИначеЕсли Месяц(СтрокаДвижений.БазовыйПериодНачало) >= 5 и Месяц(СтрокаДвижений.БазовыйПериодНачало) <= 7 Тогда 
				//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.БазовыйПериодНачало)," ","")+"0501000000");
				//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.БазовыйПериодНачало)," ","")+"0201000000");
				//ИначеЕсли Месяц(СтрокаДвижений.БазовыйПериодНачало) >= 8 и Месяц(СтрокаДвижений.БазовыйПериодНачало) <= 10 Тогда 
				//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.БазовыйПериодНачало)," ","")+"0801000000");
				//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.БазовыйПериодНачало)," ","")+"0501000000");
				//ИначеЕсли Месяц(СтрокаДвижений.БазовыйПериодНачало) >= 11 и Месяц(СтрокаДвижений.БазовыйПериодНачало) <= 1 Тогда 
				//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.БазовыйПериодНачало)," ","")+"1101000000");
				//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.БазовыйПериодНачало)," ","")+"0801000000");
				//КонецЕсли;
				//БюджетПрожиточногоМинимума1 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним1, 
				//Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
				//БюджетПрожиточногоМинимума2 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним2, 
				//Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
				//БюджетПрожиточногоМинимума = Макс(БюджетПрожиточногоМинимума1,БюджетПрожиточногоМинимума2);//О.Т. 17.02.2015 Убрать поиск максимального и искать просто по периоду действия 
				
				БюджетПрожиточногоМинимума = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(СтрокаДвижений.БазовыйПериодНачало, 
				Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;

				ФлагБПМ = ?(СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП,Истина,ложь);
				ПроцентОплаты = СтрокаДвижений[ПоказательРазмер];
				
				Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					ЗаработокЗаЕдиницуВремени = ИсходныеДанные.РазмерСреднегоЗаработка;
				Иначе
					ЗаработокЗаЕдиницуВремени = Окр(?(ИсходныеДанные.ОтработаноДнейПоСреднему = 0,0,ИсходныеДанные.СреднийЗаработок/ИсходныеДанные.ОтработаноДнейПоСреднему),ЗначениеТочностьСреднего);
				КонецЕсли;
				СтрокаДвижений.РазмерСреднегоЗаработка = ЗаработокЗаЕдиницуВремени;
				
				мДатаИзмененияЗП = ПрочиеПроцедуры.ОпределитьДатуИзмененияЗП(СтрокаДвижений.Организация);
				мКоэффициент = 1;
				Если СтрокаДвижений.ПериодРасчетаСреднегоЗаработкаНачало < мДатаИзмененияЗП И СтрокаДвижений.БазовыйПериодНачало >= мДатаИзмененияЗП Тогда
					мКоэффициент = ПрочиеПроцедуры.ПолучитьКоэффициентПриИзмененииЗП(мДатаИзмененияЗП, СтрокаДвижений.Организация, ИсходныеДанные.Сотрудник);
					СтрокаДвижений.Показатель6 = мКоэффициент;
				КонецЕсли;
				
				
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100, Константы.ВалютаРегламентированногоУчета.Получить());
				НеПроверятьНаБПМ = Ложь;
				Если РазмерОграничения = 0 Тогда
					Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
						Результат = ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент;
					иначе     						
						Результат = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент; //Островская Татьяна 22.07.2013 № 16645
					КонецЕсли;
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Пособие начисляется без ограничений", КомментарийВидаРасчета);
					КонецЕсли;
				Иначе
					Если ОплачиваемоеВремя = 0 Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет оплачиваемых дней в заданном периоде");
					Иначе
						
						Если ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда
							если  СтрокаДвижений.Регистратор.КалендарныеДни Тогда 
								ВлючатьИсключения = Ложь;//НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало)< СтрокаДвижений.Регистратор.ПериодРегистрации; //О.Т. 07.08.2014 № 164
								НормаВремени = ПрочиеПроцедуры.ПолучитьДниПоКалендарю(НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало),КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),ИсходныеДанные.Сотрудник,СтрокаДвижений.Регистратор,ВлючатьИсключения);
							иначе	
								НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало),КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),ИсходныеДанные.Сотрудник).НормаДней;
							КонецЕсли;
						Иначе
							если  СтрокаДвижений.Регистратор.КалендарныеДни Тогда 
								ВлючатьИсключения = Ложь;//НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало)< СтрокаДвижений.Регистратор.ПериодРегистрации; //О.Т. 07.08.2014 № 164
								НормаВремени = ПрочиеПроцедуры.ПолучитьДниПоКалендарю(НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало),КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),ИсходныеДанные.Сотрудник,СтрокаДвижений.Регистратор,ВлючатьИсключения);
							иначе
								НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало),КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),ИсходныеДанные.Сотрудник).НормаЧасов;
							КонецЕсли;
						КонецЕсли;
						Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
							ВлючатьИсключения = Ложь;//НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало)< СтрокаДвижений.Регистратор.ПериодРегистрации; //О.Т. 07.08.2014 № 164
							НормаВремени = ПрочиеПроцедуры.ПолучитьДниПоКалендарю(НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало),КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),ИсходныеДанные.Сотрудник,СтрокаДвижений.Регистратор,ВлючатьИсключения);
						КонецЕсли;
						
						//О.Т. 11.08.2014 № 164
						ОбщееОплачиваемоеВремя = ОплачиваемоеВремя;
						//если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
						//	ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.09.2014 № 17616 
						Если ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаНачала) И ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаОкончания) Тогда
							мДатаНачалаСобытияРег = СтрокаДвижений.ДатаНачалаСобытия;
							//		если НачалоМесяца(СтрокаДвижений.Регистратор.ДатаНачала) <> НачалоМесяца(СтрокаДвижений.Регистратор.ДатаОкончания) Тогда 
							//			Если НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало) = НачалоМесяца(СтрокаДвижений.Регистратор.ДатаНачала) Тогда 
							//				мДатаНачалаСобытия = СтрокаДвижений.Регистратор.ДатаНачала;
							//			иначе
							мДатаНачалаСобытия = СтрокаДвижений.БазовыйПериодНачало;
							//	КонецЕсли;
							//	Если НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало) <> НачалоМесяца(СтрокаДвижений.Регистратор.ДатаНачала) Тогда 
							//		мДатаКонецСобытия = СтрокаДвижений.Регистратор.ДатаОкончания;
							//	иначе
							//		мДатаКонецСобытия = НачалоДня(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало));
							//	КонецЕсли;
							//иначе
							//	мДатаНачалаСобытия = СтрокаДвижений.Регистратор.ДатаНачала;
							//	мДатаКонецСобытия = СтрокаДвижений.Регистратор.ДатаОкончания;
							//	
							//КонецЕсли;
							//если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
							//КонецЕсли;
							мДатаКонецСобытия = НачалоДня(СтрокаДвижений.БазовыйПериодКонец);
							
							
							Если мДатаНачалаСобытияРег <> мДатаНачалаСобытия Тогда
								ДнейКОплате = (мДатаКонецСобытия - мДатаНачалаСобытияРег) / 86400 + 1;
								ОплаченоРанее = (мДатаНачалаСобытия - мДатаНачалаСобытияРег) / 86400;
							Иначе
								ДнейКОплате = (мДатаКонецСобытия - мДатаНачалаСобытия) / 86400 + 1;
								ОплаченоРанее = 0;
							КонецЕсли;
							
							//Островская Татьяна 10.06.2014 № 17421
							//если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
							//	График = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(мДатаКонецСобытия,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ГрафикРаботы;
							//	ДнейКОплате = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(График, Перечисления.ВидыУчетаВремени.ПоДням, мДатаНачалаСобытия,мДатаКонецСобытия,СтрокаДвижений.Организация);
							//КонецЕсли;
							//Островская Татьяна 10.06.2014 № 17421
							
							// учтем ограничение периода оплаты по одному страховому случаю
							Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПособиеПриДолечивании Тогда
								ОбщееОплачиваемоеВремя = Макс(Мин(ДнейКОплате, 24) - ОплаченоРанее,0) // п.2 ст.6 Федерального закона от 29 декабря 2006 г. № 255-ФЗ
							ИначеЕсли СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПоУходуЗаВзрослым Тогда
								ОбщееОплачиваемоеВремя = Макс(Мин(ДнейКОплате, 7) - ОплаченоРанее,0) // пп. 6 п.5 ст.6 Федерального закона от 29 декабря 2006 г. № 255-ФЗ
							ИначеЕсли СтрокаДвижений.Регистратор.СлучайУходаЗаБольнымРебенком = Перечисления.СлучаиУходаЗаБольнымиДетьми.ПоУходуДо15тиЛетАмбулаторно
								Или СтрокаДвижений.Регистратор.СлучайУходаЗаБольнымРебенком = Перечисления.СлучаиУходаЗаБольнымиДетьми.ПоУходуДо15тиЛетВСтационаре Тогда
								ОбщееОплачиваемоеВремя = Макс(Мин(ДнейКОплате, 15) - ОплаченоРанее,0) // пп. 2 п.5 ст.6 Федерального закона от 29 декабря 2006 г. № 255-ФЗ
							Иначе
								ОбщееОплачиваемоеВремя = Макс(ДнейКОплате - ОплаченоРанее,0)
							КонецЕсли;
						КонецЕсли;
						
						//КонецЕсли;
						//О.Т. 11.08.2014 № 164
						НеПроверятьНаБПМ = Ложь;
						Если ОплачиваемоеВремя < НормаВремени Тогда
							если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
								Если СтрокаДвижений.Регистратор.ОграничениеПособия = Перечисления.ВидыОграниченияПособия.ОграничениеРазмераПособияПоСуммеБЛ Тогда 
									Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
										Результат = ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент;
									иначе     						
										Результат = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент;
									КонецЕсли;
								иначе
									если ОплаченоРанее<> 0 и РезультатДляОграничения <> 0 Тогда
										ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерОграничения / НормаВремени * (ОбщееОплачиваемоеВремя+ДниДляОграничения) * ПроцентОплаты/100, СтрокаДвижений.ПериодРегистрации);//О.Т. Аверсон 13.07.2016 Округление другое
										ОграничениеПособия = ОграничениеПособия - РезультатДляОграничения;
									иначе               										
										ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерОграничения / НормаВремени * ОбщееОплачиваемоеВремя * ПроцентОплаты/100, СтрокаДвижений.ПериодРегистрации);//О.Т. Аверсон 13.07.2016 Округление другое
									КонецЕсли;
									Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
										Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
											Результат = ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент;
										иначе
											Результат = Мин(ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия); //Островская Татьяна 22.07.2013 № 16645
										КонецЕсли;
										
										Если ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент > ОграничениеПособия Тогда 
											НеПроверятьНаБПМ = Истина;
										КонецЕсли;
									иначе 
										Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
											Результат = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент;
										иначе
											Результат = Мин(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия); //Островская Татьяна 22.07.2013 № 16645
										КонецЕсли;
										Если ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент > ОграничениеПособия Тогда 
											НеПроверятьНаБПМ = Истина;
										КонецЕсли;
									КонецЕсли;
								КонецЕсли;								
							иначе 
								если ОплаченоРанее<> 0 и РезультатДляОграничения <> 0 Тогда
									ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерОграничения / НормаВремени * (ОбщееОплачиваемоеВремя+ДниДляОграничения), СтрокаДвижений.ПериодРегистрации);//О.Т. Аверсон 13.07.2016 Округление другое
									ОграничениеПособия = ОграничениеПособия - РезультатДляОграничения;
								иначе               										
									ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерОграничения / НормаВремени * ОбщееОплачиваемоеВремя, СтрокаДвижений.ПериодРегистрации);//О.Т. Аверсон 13.07.2016 Округление другое
								КонецЕсли;
								Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
									Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
										Результат = ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент;
									иначе   											
										Результат = Мин(ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия); //Островская Татьяна 22.07.2013 № 16645
									КонецЕсли;
								иначе
									Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
										Результат = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент;
									иначе              											
										Результат = Мин(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия); //Островская Татьяна 22.07.2013 № 16645
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
						Иначе
							
							ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерОграничения , СтрокаДвижений.ПериодРегистрации); //О.Т. Аверсон 13.07.2016 округление другое
							Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
								Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
									Результат = ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент;
								иначе   											
									Результат = Мин(ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия);//Островская Татьяна 22.07.2013 № 16645
								КонецЕсли;
							иначе     						
								Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
									Результат = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент;
								иначе   											
									Результат = Мин(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия);//Островская Татьяна 22.07.2013 № 16645
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						Если КомментироватьРасчет Тогда
							ОбщегоНазначения.КомментарийРасчета("Ограничение пособия: " + ОграничениеПособия, КомментарийВидаРасчета);
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				
				если ФлагБПМ Тогда 
					Результат = БюджетПрожиточногоМинимума/2/((КонецМесяца(СтрокаДвижений.БазовыйПериодНачало)-НачалоМесяца(СтрокаДвижений.БазовыйПериодНачало)+1)/86400)*((СтрокаДвижений.БазовыйПериодКонец-СтрокаДвижений.БазовыйПериодНачало+1)/86400);
				КонецЕсли;
				
				
				
				
				
				
				
				
				
				
				СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя * ?(СтрокаДвижений.Сторно,-1,1);
				
				Попытка
					СтрокаДвижений.ОплаченоДней = ОплачиваемоеВремяДни * ?(СтрокаДвижений.Сторно,-1,1);
				Исключение
				КонецПопытки;
				
				//СтрокаДвижений.Результат = ИсходныеДанные.СреднийЗаработок*ИсходныеДанные.ОтработаноДнейПоСреднему/СтрокаДвижений.Показатель1/100;
			иначе
				если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
					Если СтрокаДвижений.ПериодДействияНачало >= Дата('20240701') Тогда    
						БюджетПрожиточногоМинимума = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(СтрокаДвижений.БазовыйПериодНачало, 
						Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер; 
					КонецЕсли;
					если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда  //О.Т. Аверсон 04.04.2018 № 1808
						График = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ГрафикРаботы; 
						//О.Т. Аверсон 25.06.2018 № 2057
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СУММА(ВЫБОР
						|			КОГДА ГрафикиРаботыПоВидамВремени.ОсновноеЗначение <= 0
						|				ТОГДА ГрафикиРаботыПоВидамВремени.ОсновноеЗначениеПолное
						|			ИНАЧЕ ГрафикиРаботыПоВидамВремени.ОсновноеЗначение
						|		КОНЕЦ) КАК Значение
						|ИЗ
						|	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
						|ГДЕ
						|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы = &Сотрудник
						|	И ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = &ВидУчетаВремени
						|	И ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &парамНачало И &парамКонец
						|	И ГрафикиРаботыПоВидамВремени.План = &ТипГрафика";
						
						Запрос.УстановитьПараметр("парамНачало", СтрокаДвижений.ПериодДействияНачало);
						Запрос.УстановитьПараметр("парамКонец", СтрокаДвижений.ПериодДействияКонец);
						Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
						Запрос.УстановитьПараметр("ВидУчетаВремени", Перечисления.ВидыУчетаВремени.ПоДням);
						Запрос.УстановитьПараметр("ТипГрафика", Истина);
						мРезультат = Запрос.Выполнить().Выгрузить();
						Если мРезультат.Количество()=0 или ?(мРезультат.Количество()<>0,?(мРезультат[0].Значение = Null,Истина,Ложь),Ложь) Тогда 
							//О.Т. Аверсон 25.06.2018 № 2057 							
							ОплачиваемоеВремяДни = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(График,Перечисления.ВидыУчетаВремени.ПоДням,СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация); 
						иначе
							ОплачиваемоеВремяДни = ?(ЗначениеЗаполнено(мРезультат[0].Значение),мРезультат[0].Значение,0)
						КонецЕсли;
					иначе 
						ОплачиваемоеВремяДни = ((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400);//Островская Татьяна 03.10.2013 № 16778
					КонецЕсли;
				иначе
					ОплачиваемоеВремяДни = ((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400);//Островская Татьяна 03.10.2013 № 16778
				КонецЕсли;
				//ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням,,СтрокаДвижений.Регистратор); //Островская Татьяна 15.07.2013 № 16623
				Если ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда
					если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
						если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда  //О.Т. Аверсон 04.04.2018 № 1808
							График = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ГрафикРаботы; 
							ОплачиваемоеВремя = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(График,Перечисления.ВидыУчетаВремени.ПоДням,СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.ПериодДействияКонец,СтрокаДвижений.Организация); 
						иначе 
							ОплачиваемоеВремя = ((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400);//Островская Татьяна 03.10.2013 № 16778
						КонецЕсли;
					иначе
						ОплачиваемоеВремя = ((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400);//Островская Татьяна 03.10.2013 № 16778
					КонецЕсли;
					
					//ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням,,СтрокаДвижений.Регистратор);//Островская Татьяна 15.07.2013 № 16623
				Иначе
					//О.Т. Аверсон 25.06.2018 № 2057
					Запрос = Новый Запрос;
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	СУММА(ВЫБОР
					|			КОГДА ГрафикиРаботыПоВидамВремени.ОсновноеЗначение <= 0
					|				ТОГДА ГрафикиРаботыПоВидамВремени.ОсновноеЗначениеПолное
					|			ИНАЧЕ ГрафикиРаботыПоВидамВремени.ОсновноеЗначение
					|		КОНЕЦ) КАК Значение
					|ИЗ
					|	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
					|ГДЕ
					|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы = &Сотрудник
					|	И ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = &ВидУчетаВремени
					|	И ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &парамНачало И &парамКонец
					|	И ГрафикиРаботыПоВидамВремени.План = &ТипГрафика";
					
					Запрос.УстановитьПараметр("парамНачало", СтрокаДвижений.ПериодДействияНачало);
					Запрос.УстановитьПараметр("парамКонец", СтрокаДвижений.ПериодДействияКонец);
					Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					Запрос.УстановитьПараметр("ВидУчетаВремени", Перечисления.ВидыУчетаВремени.ПоЧасам);
					Запрос.УстановитьПараметр("ТипГрафика", Истина);
					мРезультат = Запрос.Выполнить().Выгрузить();
					//О.Т. Аверсон 25.06.2018 № 2057
					//Островская Татьяна 03.10.2013 № 16778
					Если мРезультат.Количество()=0 или ?(мРезультат.Количество()<>0,?(мРезультат[0].Значение = Null,Истина,Ложь),Ложь) Тогда 
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СУММА(ВЫБОР
						|			КОГДА ГрафикиРаботыПоВидамВремени.ОсновноеЗначение <= 0
						|				ТОГДА ГрафикиРаботыПоВидамВремени.ОсновноеЗначениеПолное
						|			ИНАЧЕ ГрафикиРаботыПоВидамВремени.ОсновноеЗначение
						|		КОНЕЦ) КАК Значение
						|ИЗ
						|	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
						|ГДЕ
						|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы = &Сотрудник
						|	И ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = &ВидУчетаВремени
						|	И ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &парамНачало И &парамКонец
						|	И ГрафикиРаботыПоВидамВремени.План = &ТипГрафика";
						
						Запрос.УстановитьПараметр("парамНачало", СтрокаДвижений.ПериодДействияНачало);
						Запрос.УстановитьПараметр("парамКонец", СтрокаДвижений.ПериодДействияКонец);
						Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.ГрафикРаботы);
						Запрос.УстановитьПараметр("ВидУчетаВремени", Перечисления.ВидыУчетаВремени.ПоЧасам);
						Запрос.УстановитьПараметр("ТипГрафика", Истина);
						мРезультат = Запрос.Выполнить().Выгрузить();
					КонецЕсли;
					
					
					ОплачиваемоеВремя = ?(ЗначениеЗаполнено(мРезультат[0].Значение),мРезультат[0].Значение,0)//Островская Татьяна 03.10.2013 № 167778
					//ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, ИсходныеДанные.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам,,СтрокаДвижений.Регистратор);//Островская Татьяна 15.07.2013 № 16623				
				КонецЕсли;
				
				//О.Т. Аверсон 05.02.2016 № 853
				//Островская Татьяна 11.09.2013 № 16778
				если Месяц(СтрокаДвижений.ПериодДействия) >= 2 и Месяц(СтрокаДвижений.ПериодДействия) <= 04 Тогда 
					ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)," ","")+"0201000000");
					ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)-1," ","")+"1101000000");
				ИначеЕсли Месяц(СтрокаДвижений.ПериодДействия) >= 5 и Месяц(СтрокаДвижений.ПериодДействия) <= 7 Тогда 
					ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)," ","")+"0501000000");
					ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)," ","")+"0201000000");
				ИначеЕсли Месяц(СтрокаДвижений.ПериодДействия) >= 8 и Месяц(СтрокаДвижений.ПериодДействия) <= 10 Тогда 
					ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)," ","")+"0801000000");
					ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)," ","")+"0501000000");
				ИначеЕсли Месяц(СтрокаДвижений.ПериодДействия) >= 11 или Месяц(СтрокаДвижений.ПериодДействия) = 1 Тогда
					
					если Месяц(СтрокаДвижений.ПериодДействия) = 1 Тогда
						ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)-1," ","")+"1101000000");
						ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)-1," ","")+"0801000000");
					иначе
						ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)," ","")+"1101000000"); 
						ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(СтрокаДвижений.ПериодДействия)," ","")+"0801000000");
					КонецЕсли;
					
				КонецЕсли;
				
				БюджетПрожиточногоМинимума1 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним1, 
				Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
				БюджетПрожиточногоМинимума2 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним2, 
				Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
				БюджетПрожиточногоМинимума = Макс(БюджетПрожиточногоМинимума1,БюджетПрожиточногоМинимума2); //О.Т. 17.02.2015 Убрать поиск максимального и искать просто по периоду действия 
				
				//Островская Татьяна 11.09.2013 № 16778
				Если СтрокаДвижений.ПериодДействияНачало >= Дата('20240701') и не СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда
					БюджетПрожиточногоМинимума = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДобавитьМесяц(СтрокаДвижений.Регистратор.ДатаНачала,-1), 
					Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
					Если ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист) Тогда     
						БюджетПрожиточногоМинимума = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДобавитьМесяц(СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.ДатаНачала,-1), 
						Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
					КонецЕсли;
				КонецЕсли;//мзп на дату начала болезни а не каждый месяц
			//О.Т. Аверсон 05.02.2016 № 853 Убрала коментарий на поиск максимума. Теперь нужно искать по 2-м кварталам
				
				
				Если НЕ СтрокаДвижений.Сторно Тогда
					Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам и Не ЗначениеЗаполнено(ОплачиваемоеВремя)
						ИЛИ СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и Не ЗначениеЗаполнено(ОплачиваемоеВремя) Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет оплачиваемых дней в заданном периоде");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;	
					//Островская Татьяна 26.05.2014 № 17
					если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
						ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.09.2014 № 17616 
						если не ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист) Тогда 
							Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда    
								//Аверсон ПСА 07.08.2024 СВФР-013512 +++  
								Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту")
									и СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП
									и СтрокаДвижений.Регистратор.Дата >= Дата(2024,07,01) Тогда
								Иначе
								//+++Аверсон ПСА 07.08.2024 СВФР-013512 	
									Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
										ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
										СтрокаДвижений.Результат = 0;
										Возврат;
									КонецЕсли;
								КонецЕсли;
							Иначе
								если не ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
									Если Не ЗначениеЗаполнено(ИсходныеДанные.СреднийЗаработокПособий) Тогда
										ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных для расчета среднего заработка");
										СтрокаДвижений.Результат = 0;
										Возврат;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							
						КонецЕсли;
					иначе
						Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
							Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
								ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
								СтрокаДвижений.Результат = 0;
								Возврат;
							КонецЕсли;
						Иначе
							Если Не ЗначениеЗаполнено(ИсходныеДанные.СреднийЗаработокПособий) Тогда
								ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных для расчета среднего заработка");
								СтрокаДвижений.Результат = 0;
								Возврат;
							КонецЕсли;	
						КонецЕсли;
						
					КонецЕсли;
					//Островская Татьяна 26.05.2014 № 17
					
				КонецЕсли;	
				ФлагБПМ = Ложь;
				если строка(ТипЗнч(СтрокаДвижений.Регистратор)) = "Начисление по больничному листу" или 
					строка(ТипЗнч(СтрокаДвижений.Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
					ФлагБПМ = ?(СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП,Истина,ложь);
				КонецЕсли;
				ПроцентОплаты = СтрокаДвижений[ПоказательРазмер];
				//О.Т. Аверсон 03.10.2016 № 1473
				Если не ФлагБПМ Тогда 
					
					//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
					//БюджетПрожиточногоМинимума1Проверка = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-1), 
					//Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;  
					//Если СтрокаДвижений.Регистратор.ПериодРегистрации > Дата(2016,07,1) и ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-1) < Дата(2016,07,1) Тогда //О.Т. Аверсон 18.10.2016 № 1489
					//	БюджетПрожиточногоМинимума1Проверка = ОбщегоНазначения.ОкруглитьЗначение2016(БюджетПрожиточногоМинимума1Проверка/10000,СтрокаДвижений.Регистратор.ПериодРегистрации);
					//КонецЕсли;
					//
					//БюджетПрожиточногоМинимума2Проверка = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-2), 
					//Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
					//Если СтрокаДвижений.Регистратор.ПериодРегистрации > Дата(2016,07,1) и ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-2) < Дата(2016,07,1) Тогда //О.Т. Аверсон 18.10.2016 № 1489
					//	БюджетПрожиточногоМинимума2Проверка = ОбщегоНазначения.ОкруглитьЗначение2016(БюджетПрожиточногоМинимума2Проверка/10000,СтрокаДвижений.Регистратор.ПериодРегистрации);
					//КонецЕсли;
					//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
					
					//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
					Если ТипРасчетаПоОкладу Тогда
						СтруктураДатБПМ = ПолучитьСтруктуруДатБюджетаПрожиточногоМинимума( СтрокаДвижений.ПериодДействия );
						ДатаБюджетаПрожМиним1 = СтруктураДатБПМ.ДатаБюджетаПрожМинимТекущегоПериода;
						ДатаБюджетаПрожМиним2 = СтруктураДатБПМ.ДатаБюджетаПрожМинимПредыдущегоПериода;
					Иначе
						
						//СВЭЙ 19.02.2024 КВВ СВФР-012465 (
						//ДатаБюджетаПрожМиним1 = ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-1);
						//ДатаБюджетаПрожМиним2 = ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-2);
						
						Если ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист) Тогда
							ДатаБюджетаПрожМиним1 = НачалоМесяца(СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.ДатаНачала);   
						Иначе
							ДатаБюджетаПрожМиним1 = СтрокаДвижений.ПериодДействия;
						КонецЕсли;
						ДатаБюджетаПрожМиним2 = ДобавитьМесяц(ДатаБюджетаПрожМиним1,-1);
						//СВЭЙ 19.02.2024 КВВ СВФР-012465 )
					КонецЕсли;
					
					БюджетПрожиточногоМинимума1Проверка = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее( ДатаБюджетаПрожМиним1, 
					Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;  
					Если СтрокаДвижений.Регистратор.ПериодРегистрации > Дата(2016,07,1) и ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-1) < Дата(2016,07,1) Тогда //О.Т. Аверсон 18.10.2016 № 1489
						БюджетПрожиточногоМинимума1Проверка = ОбщегоНазначения.ОкруглитьЗначение2016(БюджетПрожиточногоМинимума1Проверка/10000,СтрокаДвижений.Регистратор.ПериодРегистрации);
					КонецЕсли;
					
					БюджетПрожиточногоМинимума2Проверка = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее( ДатаБюджетаПрожМиним2, 
					Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
					Если СтрокаДвижений.Регистратор.ПериодРегистрации > Дата(2016,07,1) и ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-2) < Дата(2016,07,1) Тогда //О.Т. Аверсон 18.10.2016 № 1489
						БюджетПрожиточногоМинимума2Проверка = ОбщегоНазначения.ОкруглитьЗначение2016(БюджетПрожиточногоМинимума2Проверка/10000,СтрокаДвижений.Регистратор.ПериодРегистрации);
					КонецЕсли;
					//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт 
					БюджетПрожиточногоМинимумаПроверка = Макс(БюджетПрожиточногоМинимума1Проверка,БюджетПрожиточногоМинимума2Проверка);
					
					СреднийПроверка = Окр(БюджетПрожиточногоМинимумаПроверка/2/День(КонецМесяца(СтрокаДвижений.ПериодДействия)),ЗначениеТочностьСреднего);
					НачислениеПроверка = СреднийПроверка*ОплачиваемоеВремя; 
					// МЗП минимум 
					Если СтрокаДвижений.ПериодДействияНачало >= Дата('20240701') Тогда 
						БюджетПрожиточногоМинимума = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее( ДатаБюджетаПрожМиним2, 
						Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
						Если СтрокаДвижений.Регистратор.ПериодРегистрации > Дата(2016,07,1) и ДобавитьМесяц(СтрокаДвижений.ПериодДействия,-2) < Дата(2016,07,1) Тогда //О.Т. Аверсон 18.10.2016 № 1489
							БюджетПрожиточногоМинимума2Проверка = ОбщегоНазначения.ОкруглитьЗначение2016(БюджетПрожиточногоМинимума2Проверка/10000,СтрокаДвижений.Регистратор.ПериодРегистрации);
						КонецЕсли;  
						БюджетПрожиточногоМинимумаПроверка = БюджетПрожиточногоМинимума;
						СреднийПроверка = Окр(БюджетПрожиточногоМинимума/День(КонецМесяца(СтрокаДвижений.ПериодДействия)),ЗначениеТочностьСреднего);
						НачислениеПроверка = СреднийПроверка*ОплачиваемоеВремя; 
					КонецЕсли;
					//МЗП минимум

				КонецЕсли;
				//О.Т. Аверсон 03.10.2016 № 1473
				
				
				//Островская Татьяна 11.09.2013 № 16778
				если ФлагБПМ Тогда 
					ДниИсключение = 0;
					ДеньПриема = 0;
					Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда //О.Т. Аверсон 13.12.2016 № 100
						ЗапросИсклДни = Новый Запрос;
						ЗапросИсклДни.Текст = 
						"ВЫБРАТЬ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник,
						|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК ДнейЯвки,
						|	ВложенныйЗапрос.Дней,
						|	РаботникиОрганизацийСрезПоследних.Период КАК ДатаПриема
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
						|			РабочееВремяРаботниковОрганизаций.Сотрудник КАК Сотрудник,
						|			СУММА(ВЫБОР
						|					КОГДА РабочееВремяРаботниковОрганизаций.Дней = 0
						|							ИЛИ РабочееВремяРаботниковОрганизаций.Дней = NULL
						|						ТОГДА 1
						|					ИНАЧЕ РабочееВремяРаботниковОрганизаций.Дней
						|				КОНЕЦ) КАК Дней
						|		ИЗ
						|			РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|		ГДЕ
						|			РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&ВидИспользованияРВ)
						|			И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|			И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период1
						|					ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
						|		
						|		СГРУППИРОВАТЬ ПО
						|			РабочееВремяРаботниковОрганизаций.Сотрудник) КАК ВложенныйЗапрос
						|		ПО РабочееВремяРаботниковОрганизаций.Сотрудник = ВложенныйЗапрос.Сотрудник
						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период1, ) КАК РаботникиОрганизацийСрезПоследних
						|		ПО РабочееВремяРаботниковОрганизаций.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
						|ГДЕ
						|	НЕ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРВ)
						|	И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период1
						|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
						|
						|СГРУППИРОВАТЬ ПО
						|	РабочееВремяРаботниковОрганизаций.Сотрудник,
						|	ВложенныйЗапрос.Дней,
						|	РаботникиОрганизацийСрезПоследних.Период";
						
					иначе
						ЗапросИсклДни = Новый Запрос;
						ЗапросИсклДни.Текст = 
						"ВЫБРАТЬ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник,
						|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК ДнейЯвки,
						|	ВложенныйЗапрос.Дней,
						|	РаботникиОрганизацийСрезПоследних.Период КАК ДатаПриема
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
						|			РабочееВремяРаботниковОрганизаций.Сотрудник КАК Сотрудник,
						|			СУММА(ВЫБОР
						|					КОГДА РабочееВремяРаботниковОрганизаций.Дней = 0
						|							ИЛИ РабочееВремяРаботниковОрганизаций.Дней = NULL
						|						ТОГДА 1
						|					ИНАЧЕ РабочееВремяРаботниковОрганизаций.Дней
						|				КОНЕЦ) КАК Дней
						|		ИЗ
						|			РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|		ГДЕ
						|			РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&ВидИспользованияРВ)
						|			И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|			И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период1
						|		
						|		СГРУППИРОВАТЬ ПО
						|			РабочееВремяРаботниковОрганизаций.Сотрудник) КАК ВложенныйЗапрос
						|		ПО РабочееВремяРаботниковОрганизаций.Сотрудник = ВложенныйЗапрос.Сотрудник
						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период1, ) КАК РаботникиОрганизацийСрезПоследних
						|		ПО РабочееВремяРаботниковОрганизаций.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
						|ГДЕ
						|	НЕ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРВ)
						|	И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период1
						|
						|СГРУППИРОВАТЬ ПО
						|	РабочееВремяРаботниковОрганизаций.Сотрудник,
						|	ВложенныйЗапрос.Дней,
						|	РаботникиОрганизацийСрезПоследних.Период";
					КонецЕсли;
					ЗапросИсклДни.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					ПараметрыОтбора = Новый СписокЗначений;
					//Островская Татьяна 10.09.2013 № 16623
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.НеоплачиваемыйОтпускПоРазрешениюРаботодателя);
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОсновнойОтпуск);
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускПоБеременностиИРодам);
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускНаОбучение);
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускНаОбучениеНеоплачиваемый);
					
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.НеявкиПоНевыясненнымПричинам);
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускПоУходуЗаРебенком);
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ДополнительныйОтпуск);
					ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Болезнь);
					//Островская Татьяна 10.09.2013 № 16623
					ЗапросИсклДни.УстановитьПараметр("ВидИспользованияРВ", ПараметрыОтбора);
					Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда //О.Т. Аверсон 13.12.2016 № 100
						если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
							ЗапросИсклДни.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
							ЗапросИсклДни.УстановитьПараметр("Период1", СтрокаДвижений.ПериодДействияКонец);					
						ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
							ЗапросИсклДни.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
							ЗапросИсклДни.УстановитьПараметр("Период1", СтрокаДвижений.БазовыйПериодКонец);
						иначе		
							ЗапросИсклДни.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
							ЗапросИсклДни.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
						КонецЕсли;
					иначе  						
						ЗапросИсклДни.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодДействия));
						ЗапросИсклДни.УстановитьПараметр("Период1", КонецМесяца(СтрокаДвижений.ПериодДействия));
					КонецЕсли;
					РезИсклДни = ЗапросИсклДни.Выполнить().Выбрать();
					если РезИсклДни.Следующий() Тогда 
						ДниИсключение = ?(ЗначениеЗаполнено(РезИсклДни.Дней),РезИсклДни.Дней,0); 
						если  Месяц(РезИсклДни.ДатаПриема) = Месяц(СтрокаДвижений.ПериодДействия) Тогда 
							ДеньПриема = День(РезИсклДни.ДатаПриема)-1;
						КонецЕсли;
						
					КонецЕсли; 
					КалендарныеДни = День(КонецМесяца(СтрокаДвижений.ПериодДействия)) - ДеньПриема - ДниИсключение;
				КонецЕсли;
				//Островская Татьяна 11.09.2013 № 16778
				
				
				
				// Рассчитаем заработок за день (или за час для суммированного учета времени)
				// для строк сторно заработок возьмем из реквизита "ДополнительныеДанные" записи начислений
				//Островская Татьяна 17.04.2014 № 17287
				ЗаработокЗаЕдиницуВремени = 0;
				//О.Т. Аверсон 27.09.2016
				НеРасчитыватьПропорционально = Ложь;
				
				//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
				//перенесено в начало процедуры
				//Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
				//	ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
				//	
				//	ТипРасчетаПоОкладу = СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу;
				//иначе
				//	ТипРасчетаПоОкладу = Ложь;
				//КонецЕсли;
				//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
				
				//О.Т. Аверсон 27.09.2016
				
				Если НЕ СтрокаДвижений.Сторно Тогда
					
					Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
						ЗаработокЗаЕдиницуВремени = ИсходныеДанные.РазмерСреднегоЗаработка;
					Иначе
						//Островская Татьяна 26.05.2014 № 17
						если (ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
							ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")) и //О.Т. 23.09.2014 № 17616 
							ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист) и 
							СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.РучнойРасчетСреднегоЗаработка Тогда
							
							ЗаработокЗаЕдиницуВремени = СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.РазмерСреднегоЗаработка;
						иначе
							
							НормаВремени = ИсходныеДанные.НормаВремениЗаМесяц;
							//О.Т. 15.07.2014 № 118
							если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
								ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.09.2014 № 17616 
								если СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу и СтрокаДвижений.Регистратор.КалендарныеДни Тогда 
									
									ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок/ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);
									Если ОплачиваемоеВремя = ИсходныеДанные.ОтработаноДнейПоСреднему Тогда //О.Т. Аверсон 27.09.2016 
										НеРасчитыватьПропорционально = Истина;
									КонецЕсли;
									
								иначе
									Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
										Если ИсходныеДанные.ОтработаноЧасовПоСреднему <> 0 Тогда
											ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноЧасовПоСреднему,ЗначениеТочностьСреднего);
											Если ОплачиваемоеВремя = ИсходныеДанные.ОтработаноЧасовПоСреднему Тогда //О.Т. Аверсон 27.09.2016
												НеРасчитыватьПропорционально = Истина;
											КонецЕсли;   
										КонецЕсли;
									Иначе
										Если ИсходныеДанные.ОтработаноДнейПоСреднему <> 0 Тогда
											ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);
											Если ОплачиваемоеВремя = ИсходныеДанные.ОтработаноДнейПоСреднему Тогда //О.Т. Аверсон 27.09.2016
												НеРасчитыватьПропорционально = Истина;
											КонецЕсли;
										КонецЕсли;
									КонецЕсли;
								КонецЕсли;
								//О.Т. 15.07.2014 № 118	
							иначе
								
								Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
									Если ИсходныеДанные.ОтработаноЧасовПоСреднему <> 0 Тогда
										ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноЧасовПоСреднему,ЗначениеТочностьСреднего);
										Если ОплачиваемоеВремя = ИсходныеДанные.ОтработаноЧасовПоСреднему Тогда //О.Т. Аверсон 27.09.2016
											НеРасчитыватьПропорционально = Истина;
										КонецЕсли;
									КонецЕсли;
								Иначе
									Если ИсходныеДанные.ОтработаноДнейПоСреднему <> 0 Тогда
										ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноДнейПоСреднему,ЗначениеТочностьСреднего);
										Если ОплачиваемоеВремя = ИсходныеДанные.ОтработаноДнейПоСреднему Тогда //О.Т. Аверсон 27.09.2016
											НеРасчитыватьПропорционально = Истина;
										КонецЕсли;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 26.05.2014 № 17
					КонецЕсли;	
					
					СтрокаДвижений.РазмерСреднегоЗаработка = ЗаработокЗаЕдиницуВремени;
				Иначе
					ЗаработокЗаЕдиницуВремени = СтрокаДвижений.РазмерСреднегоЗаработка;
				КонецЕсли;
				
				Если КомментироватьРасчет Тогда
					ОбщегоНазначения.КомментарийРасчета("Процент оплаты: " + ПроцентОплаты, КомментарийВидаРасчета);
				КонецЕсли;
				
				мДатаИзмененияЗП = ПрочиеПроцедуры.ОпределитьДатуИзмененияЗП(СтрокаДвижений.Организация);
				мКоэффициент = 1;
				Если СтрокаДвижений.ПериодРасчетаСреднегоЗаработкаНачало < мДатаИзмененияЗП И СтрокаДвижений.ПериодДействияНачало >= мДатаИзмененияЗП Тогда
					мКоэффициент = ПрочиеПроцедуры.ПолучитьКоэффициентПриИзмененииЗП(мДатаИзмененияЗП, СтрокаДвижений.Организация, ИсходныеДанные.Сотрудник);
					СтрокаДвижений.Показатель6 = мКоэффициент;
				КонецЕсли;
				НеПроверятьНаБПМ = Ложь;
				Если ИсходныеДанные.РазмерОграничения = 0 Тогда
					Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
						Результат = ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент;
					иначе     						
						Результат = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент; //Островская Татьяна 22.07.2013 № 16645
					КонецЕсли;
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Пособие начисляется без ограничений", КомментарийВидаРасчета);
					КонецЕсли;
				Иначе
					
					//Аверсон 10.07.2020 КВВ СВФР-006218 (
					Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") 
						И (СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПоБеременностиИРодам
						ИЛИ СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПоУходу
						ИЛИ СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ОбщееЗаболевание
						ИЛИ СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаВБыту) //ПСА 17-12-2020 СВФР-006942
						И НормаВремени = 0 И ОплачиваемоеВремя <> 0 Тогда
						НормаВремени = ОплачиваемоеВремя; //Норма ниже пересчитается по графикам
					КонецЕсли;
					//Аверсон 10.07.2020 КВВ СВФР-006218 )
					
					Если НормаВремени = 0 Или ОплачиваемоеВремя = 0 Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет оплачиваемых дней в заданном периоде");
					Иначе
						
						//(начало) закомментировано Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
						//СредняяПоРБ = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(ДобавитьМесяц(СтрокаДвижений.Регистратор.ДатаНачала, -1)), //ИсходныеДанные.ПериодДействияНачало
						//Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер; //Островская Татьяна 16.07.2013 № 16623
						//(конец) закомментировано Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
						//(начало) добавлено Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
						//+ СВЭЙ КДЯ 25.09.19 СВФР-004822 - вернул обратно ( по среднему пока расчет не будет работать )
						ДобавитьДниПервичногоБольничного = 0;
						//- СВЭЙ КДЯ 25.09.19 СВФР-004822
						Если ТипЗнч( СтрокаДвижений.Регистратор ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛисту" ) Тогда
							Если ЗначениеЗаполнено( СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист )   Тогда
								ПериодСредняяЗПРаботников = НачалоМесяца( СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.ДатаНачала ) - 1;
								//+ СВЭЙ КДЯ 25.09.19 СВФР-004822 - вернул обратно ( по среднему пока расчет не будет работать )
								Если НачалоМесяца( СтрокаДвижений.ПериодДействия ) < СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.ДатаОкончания Тогда
									ДобавитьДниПервичногоБольничного =
									Макс(
									( СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.ДатаОкончания 
									- Макс( СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.ДатаНачала, 
									НачалоМесяца( СтрокаДвижений.Регистратор.ПервичныйБольничныйЛист.ДатаОкончания )
									) 
									) / 86400
									+ 1, 0 );
								КонецЕсли; 
								//- СВЭЙ КДЯ 25.09.19 СВФР-004822
							Иначе	
								ПериодСредняяЗПРаботников = НачалоМесяца( СтрокаДвижений.Регистратор.ДатаНачала ) - 1;
							КонецЕсли; 
						Иначе	
							ПериодСредняяЗПРаботников = КонецМесяца( ДобавитьМесяц( СтрокаДвижений.Регистратор.ДатаНачала, -1) );
						КонецЕсли;
						СредняяПоРБ = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее( ПериодСредняяЗПРаботников, 
						Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников) ).Размер;
						//(конец) добавлено Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
						
						Если ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда
							если  СтрокаДвижений.Регистратор.КалендарныеДни Тогда 
								ВлючатьИсключения = Ложь;//НачалоМесяца(СтрокаДвижений.ПериодДействия)< СтрокаДвижений.Регистратор.ПериодРегистрации; //О.Т. 07.08.2014 № 164
								
								//(начало) закомментировано Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
								//НормаВремени = ПрочиеПроцедуры.ПолучитьДниПоКалендарю(НачалоМесяца(СтрокаДвижений.ПериодДействия),КонецМесяца(СтрокаДвижений.ПериодДействия),ИсходныеДанные.Сотрудник,СтрокаДвижений.Регистратор,ВлючатьИсключения);
								//(конец) закомментировано Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
								//(начало) добавлено Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
								НормаВремени = ПрочиеПроцедуры.ПолучитьДниПоКалендарю( НачалоМесяца( СтрокаДвижений.ПериодДействия ), КонецМесяца( СтрокаДвижений.ПериодДействия ),
								ИсходныеДанные.Сотрудник, СтрокаДвижений.Регистратор, ВлючатьИсключения )
								//+ СВЭЙ КДЯ 25.09.19 СВФР-004822 - вернул обратно ( по среднему пока расчет не будет работать )
								+ ДобавитьДниПервичногоБольничного
								//- СВЭЙ КДЯ 25.09.19 СВФР-004822
								;
								//(конец) добавлено Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
							иначе	
								НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодДействия),КонецМесяца(СтрокаДвижений.ПериодДействия),ИсходныеДанные.Сотрудник).НормаДней;
							КонецЕсли;
						Иначе
							НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодДействия),КонецМесяца(СтрокаДвижений.ПериодДействия),ИсходныеДанные.Сотрудник).НормаЧасов;
						КонецЕсли;
						//О.Т. 11.08.2014 № 164
						ОбщееОплачиваемоеВремя = ОплачиваемоеВремя;
						если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
							ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.09.2014 № 17616 
							Если ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаНачала) И ЗначениеЗаполнено(СтрокаДвижений.Регистратор.ДатаОкончания) Тогда
								мДатаНачалаСобытияРег = СтрокаДвижений.ДатаНачалаСобытия;
								если НачалоМесяца(СтрокаДвижений.Регистратор.ДатаНачала) <> НачалоМесяца(СтрокаДвижений.Регистратор.ДатаОкончания) Тогда 
									Если НачалоМесяца(СтрокаДвижений.ПериодДействияНачало) = НачалоМесяца(СтрокаДвижений.Регистратор.ДатаНачала) Тогда 
										мДатаНачалаСобытия = СтрокаДвижений.Регистратор.ДатаНачала;
									иначе
										мДатаНачалаСобытия = НачалоМесяца(СтрокаДвижений.ПериодДействияНачало);
									КонецЕсли;
									Если НачалоМесяца(СтрокаДвижений.ПериодДействияНачало) <> НачалоМесяца(СтрокаДвижений.Регистратор.ДатаНачала) Тогда 
										мДатаКонецСобытия = СтрокаДвижений.Регистратор.ДатаОкончания;
									иначе
										мДатаКонецСобытия = НачалоДня(КонецМесяца(СтрокаДвижений.ПериодДействияНачало));
									КонецЕсли;
								иначе
									мДатаНачалаСобытия = СтрокаДвижений.Регистратор.ДатаНачала;
									мДатаКонецСобытия = СтрокаДвижений.Регистратор.ДатаОкончания;
									
								КонецЕсли;
								
								Если мДатаНачалаСобытияРег <> мДатаНачалаСобытия Тогда
									ДнейКОплате = (мДатаКонецСобытия - мДатаНачалаСобытияРег) / 86400 + 1;
									ОплаченоРанее = (мДатаНачалаСобытия - мДатаНачалаСобытияРег) / 86400;
								Иначе
									ДнейКОплате = (мДатаКонецСобытия - мДатаНачалаСобытия) / 86400 + 1;
									ОплаченоРанее = 0;
								КонецЕсли;
								//Островская Татьяна 10.06.2014 № 17421
								если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда
									График = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(мДатаКонецСобытия,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ГрафикРаботы;
									ДнейКОплате = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(График, Перечисления.ВидыУчетаВремени.ПоДням, мДатаНачалаСобытия,мДатаКонецСобытия,СтрокаДвижений.Организация);
									ОплаченоРанее = 0; //ПСА 26.07.2021 СВФР-007856 +++
								КонецЕсли;
								//Островская Татьяна 10.06.2014 № 17421
								
								// учтем ограничение периода оплаты по одному страховому случаю
								Если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПособиеПриДолечивании Тогда
									ОбщееОплачиваемоеВремя = Макс(Мин(ДнейКОплате, 24) - ОплаченоРанее,0) // п.2 ст.6 Федерального закона от 29 декабря 2006 г. № 255-ФЗ
								ИначеЕсли СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПоУходуЗаВзрослым Тогда
									ОбщееОплачиваемоеВремя = Макс(Мин(ДнейКОплате, 7) - ОплаченоРанее,0) // пп. 6 п.5 ст.6 Федерального закона от 29 декабря 2006 г. № 255-ФЗ
								ИначеЕсли СтрокаДвижений.Регистратор.СлучайУходаЗаБольнымРебенком = Перечисления.СлучаиУходаЗаБольнымиДетьми.ПоУходуДо15тиЛетАмбулаторно
									Или СтрокаДвижений.Регистратор.СлучайУходаЗаБольнымРебенком = Перечисления.СлучаиУходаЗаБольнымиДетьми.ПоУходуДо15тиЛетВСтационаре Тогда
									ОбщееОплачиваемоеВремя = Макс(Мин(ДнейКОплате, 15) - ОплаченоРанее,0) // пп. 2 п.5 ст.6 Федерального закона от 29 декабря 2006 г. № 255-ФЗ
								Иначе
									ОбщееОплачиваемоеВремя = Макс(ДнейКОплате - ОплаченоРанее,0)
								КонецЕсли;
							КонецЕсли;
							
						КонецЕсли;
						//О.Т. 11.08.2014 № 164
						НеПроверятьНаБПМ = Ложь;
						Если ОплачиваемоеВремя < НормаВремени Тогда
							если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
								Если СтрокаДвижений.Регистратор.ОграничениеПособия = Перечисления.ВидыОграниченияПособия.ОграничениеРазмераПособияПоСуммеБЛ Тогда 
									Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
										Результат = ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент;
									иначе     						
										Результат = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент;
									КонецЕсли;
								иначе
									ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(ИсходныеДанные.РазмерОграничения * Макс(СредняяПоРБ, 1) / НормаВремени * ОбщееОплачиваемоеВремя, СтрокаДвижений.ПериодРегистрации);//О.Т. Аверсон 13.07.2016 Округление другое
									ОграничениеПособия = ОграничениеПособия - РезультатДляОграничения;
									Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
										Результат = Мин(ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия); //Островская Татьяна 22.07.2013 № 16645
										Если ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент > ОграничениеПособия Тогда 
											НеПроверятьНаБПМ = Истина;
										КонецЕсли;
									иначе     						
										Результат = Мин(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия); //Островская Татьяна 22.07.2013 № 16645
										Если ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент > ОграничениеПособия Тогда 
											НеПроверятьНаБПМ = Истина;
										КонецЕсли;
									КонецЕсли;
								КонецЕсли;								
							иначе 								
								ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(ИсходныеДанные.РазмерОграничения * Макс(СредняяПоРБ, 1) / НормаВремени * ОбщееОплачиваемоеВремя, СтрокаДвижений.ПериодРегистрации);//О.Т. Аверсон 13.07.2016 Округление другое
								ОграничениеПособия = ОграничениеПособия - РезультатДляОграничения;
								Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
									Результат = Мин(ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия); //Островская Татьяна 22.07.2013 № 16645
								иначе     						
									Результат = Мин(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия); //Островская Татьяна 22.07.2013 № 16645
								КонецЕсли;
							КонецЕсли;
						Иначе
							если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
								Если СтрокаДвижений.Регистратор.ОграничениеПособия = Перечисления.ВидыОграниченияПособия.ОграничениеРазмераПособияПоСуммеБЛ Тогда 
									Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
										Результат = ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент;
									иначе     						
										Результат = ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент;
									КонецЕсли;
								иначе
									
									//(начало) закомментировано Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
									//ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(ИсходныеДанные.РазмерОграничения * Макс(СредняяПоРБ, 1), СтрокаДвижений.ПериодРегистрации); //О.Т. Аверсон 13.07.2016 округление другое
									//(конец) закомментировано Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
									//+ СВЭЙ 20.03.19  КДЯ СВФР-004092	
									Если СтрокаДвижений.Регистратор.ОграничениеПособия = Перечисления.ВидыОграниченияПособия.ОбщееОграничение 
										И СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПоБеременностиИРодам Тогда	
										ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(ИсходныеДанные.РазмерОграничения * Макс(СредняяПоРБ, 1), СтрокаДвижений.ПериодРегистрации);
									Иначе
										//- СВЭЙ 20.03.19  КДЯ СВФР-004092	
										//(начало) добавлено Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
										ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(ИсходныеДанные.РазмерОграничения * Макс(СредняяПоРБ, 1) / НормаВремени * ОбщееОплачиваемоеВремя, СтрокаДвижений.ПериодРегистрации);//О.Т. Аверсон 13.07.2016 Округление другое
										//(конец) добавлено Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
										//+ СВЭЙ 20.03.19  КДЯ СВФР-004092	
									КонецЕсли; // СтрокаДвижений.Регистратор.ОграничениеПособия = Перечисления.ВидыОграниченияПособия.ОбщееОграничение ...
									//- СВЭЙ 20.03.19  КДЯ СВФР-004092	
									
									Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
										Результат = Мин(ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия);//Островская Татьяна 22.07.2013 № 16645
										
										Если ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент > ОграничениеПособия Тогда 
											НеПроверятьНаБПМ = Истина;
										КонецЕсли;
									иначе     						
										Результат = Мин(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия);//Островская Татьяна 22.07.2013 № 16645
										Если ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент > ОграничениеПособия Тогда 
											НеПроверятьНаБПМ = Истина;
										КонецЕсли;
									КонецЕсли;     									
								КонецЕсли;                                                                                                                                                              								
							иначе
								ОграничениеПособия = ОбщегоНазначения.ОкруглитьЗначение2016(ИсходныеДанные.РазмерОграничения * Макс(СредняяПоРБ, 1), СтрокаДвижений.ПериодРегистрации); //О.Т. Аверсон 13.07.2016 округление другое
								Если НеРасчитыватьПропорционально и ТипРасчетаПоОкладу Тогда //О.Т. Аверсон 27.09.2016
									Результат = Мин(ИсходныеДанные.СреднийЗаработок * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия);//Островская Татьяна 22.07.2013 № 16645
								иначе     						
									Результат = Мин(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * мКоэффициент, ОграничениеПособия);//Островская Татьяна 22.07.2013 № 16645
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						Если КомментироватьРасчет Тогда
							ОбщегоНазначения.КомментарийРасчета("Ограничение пособия: " + ОграничениеПособия, КомментарийВидаРасчета);
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				//Островская Татьяна 11.09.2013 № 16778
				если ФлагБПМ Тогда
					ЗанимаемаяСтавка = 1;
					ЗанимаемаяСтавка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
					//Аверсон ЕАЕ 07.10.2017
					Если СтрокаДвижений.ПериодДействияНачало = НачалоМесяца(СтрокаДвижений.ПериодДействияНачало)
						И СтрокаДвижений.ПериодДействияКонец = КонецМесяца(СтрокаДвижений.ПериодДействияНачало) Тогда //т.е. если это целый месяц 
						Если  СтрокаДвижений.ПериодДействияНачало >= Дата('20240701')  и не СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда
							Результат = БюджетПрожиточногоМинимума * ЗанимаемаяСтавка;
						Иначе
							Результат = БюджетПрожиточногоМинимума / 2;  
						КОнецЕсли;
					Иначе
						//Аверсон 
						Если   СтрокаДвижений.ПериодДействияНачало >= Дата('20240701')  и не СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда    
							//ЗанимаемаяСтавка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
							//Результат = ОбщегоНазначения.ОкруглитьЗначение2016(БюджетПрожиточногоМинимума/((КонецМесяца(СтрокаДвижений.ПериодДействияНачало)-НачалоМесяца(СтрокаДвижений.ПериодДействияНачало)+1)/86400)*((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400),СтрокаДвижений.ПериодРегистрации)*ЗанимаемаяСтавка;
							Результат = БюджетПрожиточногоМинимума/((КонецМесяца(СтрокаДвижений.ПериодДействияНачало)-НачалоМесяца(СтрокаДвижений.ПериодДействияНачало)+1)/86400)*ЗанимаемаяСтавка*((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400);
							//мзп без округления для всех
						Иначе
							Результат = ОбщегоНазначения.ОкруглитьЗначение2016(БюджетПрожиточногоМинимума/2/((КонецМесяца(СтрокаДвижений.ПериодДействияНачало)-НачалоМесяца(СтрокаДвижений.ПериодДействияНачало)+1)/86400),СтрокаДвижений.ПериодРегистрации)*((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400);
						КонецЕсли;
					КонецЕсли;
					Если СтрокаДвижений.Показатель1 =0 и СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ПоУходу Тогда
						Результат = 0;
					КонецЕсли;
					//Аверсон ЕАЕ 05.09.2024 СВФР-013586
					Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") И ЗначениеЗаполнено(СтрокаДвижений.Регистратор.РазмерСреднегоЗаработка) Тогда 
						РезультатРучной = СтрокаДвижений.Регистратор.РазмерСреднегоЗаработка * ОплачиваемоеВремя* ПроцентОплаты / 100 ;   // проверяем с учетом процента оплаты
						Если РезультатРучной > Результат Тогда
							Результат = РезультатРучной;
						КонецЕсли;
					КонецЕсли;
					//Аверсон СВФР-013586
					
				КонецЕсли;
				//Островская Татьяна 11.09.2013 № 16778
				
				//Островская Татьяна 15.07.2013 № 16623
				если СтрокаДвижений.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.БольничныйЛистАлкоголь
					и СтрокаДвижений.Регистратор.КалендарныеДни Тогда 
					если ПроцентОплаты = 0 Тогда 
						Результат = 0;
					Иначе
						//если СтрокаДвижений.ПериодДействияНачало < СтрокаДвижений.Регистратор.ДатаНачала+1036800 Тогда 
						//	Результат = ЗаработокЗаЕдиницуВремени * ((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400)*0.8* СтрокаДвижений.Регистратор.ПроцентУдержания/100;
						//Иначе
						//всегда платим из МЗП 170425
						//Результат = ЗаработокЗаЕдиницуВремени*  ((СтрокаДвижений.ПериодДействияКонец-СтрокаДвижений.ПериодДействияНачало+1)/86400)*СтрокаДвижений.Показатель1/100;
						//КонецЕсли;	
					КонецЕсли;
				КонецЕсли;
				//Островская Татьяна 15.07.2013 № 16623
				//О.Т. Аверсон 03.10.2016 № 1473
				
				//О.Т. Аверсон 05.12.2016 № 68
				БольничныйАлкоголь = Ложь;
				ДниАлкоголя6 = Ложь;
				Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
					Если ИсходныеДанные.Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.БольничныйЛистАлкоголь Тогда 
						БольничныйАлкоголь = Истина;
						
						//Аверсон ЕАЕ 07.06.2022 СВФР-009156
						//Если СтрокаДвижений.ПериодДействияНачало >= ИсходныеДанные.Регистратор.ДатаНачала и СтрокаДвижений.ПериодДействияНачало+(6*86400)-1 <= КонецДня(ИсходныеДанные.Регистратор.ДатаОкончания) Тогда
						Если СтрокаДвижений.ПериодДействияНачало >= ИсходныеДанные.Регистратор.ДатаНачала и СтрокаДвижений.ПериодДействияНачало+(6*86400)-1 >= КонецДня(ИсходныеДанные.Регистратор.ДатаОкончания) Тогда
							//Аверсон СВФР-009156
							
							ДниАлкоголя6 = Истина;
						КонецЕсли;
						
						//Аверсон 05.05.2023 КВВ СВФР-010802 (
						//Если ИсходныеДанные.Регистратор.ДатаНачала +(6*86400)-1=СтрокаДвижений.ПериодДействияКонец Тогда
						Если НЕ ДниАлкоголя6 И (ИсходныеДанные.Регистратор.ДатаНачала +(6*86400)-1 >= СтрокаДвижений.ПериодДействияКонец) Тогда
							//Аверсон 05.05.2023 КВВ СВФР-010802 )
							
							ДниАлкоголя6 = Истина;
							Если Значениезаполнено(ИсходныеДанные.Регистратор.ПервичныйБольничныйЛист.датаначала) Тогда
								Если не ИсходныеДанные.Регистратор.ПервичныйБольничныйЛист.датаначала +(6*86400)-1 >= ИсходныеДанные.Регистратор.ДатаНачала Тогда
									ДниАлкоголя6 = Ложь;
								КонецЕсли;
							КонецЕсли;	
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				//О.Т. Аверсон 05.12.2016 № 68
				
				Если не ФлагБПМ Тогда 
					если не(БольничныйАлкоголь и ДниАлкоголя6) Тогда //БольничныйЛистАлкоголь
						если НачислениеПроверка > Результат и не НеПроверятьНаБПМ Тогда 
							Если не СтрокаДвижений.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство Тогда 
								Если не СтрокаДвижений.Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПустаяСсылка() и СтрокаДвижений.ПериодДействияНачало >= Дата('20240701') Тогда
									Результат = НачислениеПроверка;
								КонецЕсли;
								Если СтрокаДвижений.ПериодДействияНачало >= Дата('20240701') Тогда   
									Сообщить("Минимальная зарплата равна "+ Строка(БюджетПрожиточногоМинимумаПроверка));//с 01.07.2024 МЗП минимум
								Иначе 								
									Сообщить("Бюджет прожиточного минимума равен "+ Строка(БюджетПрожиточногоМинимумаПроверка));//О.Т. Аверсон 23.11.2016 № 47
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;   	
					КонецЕсли;
				КонецЕсли;
				//О.Т. Аверсон 03.10.2016 № 1473
				
				Результат = ОбщегоНазначения.ОкруглитьЗначение2016(Результат, СтрокаДвижений.ПериодРегистрации); //О.Т. Аверсон 13.07.2016 другое округление
				СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя * ?(СтрокаДвижений.Сторно,-1,1);
				
				//СВЭЙ 13.02.2024 КВВ СВФР-012233 (
				Если ДниАлкоголя6 И (СтрокаДвижений.ПериодДействияКонец <= ИсходныеДанные.Регистратор.ДатаНачала+(6*86400)-1) Тогда
					СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛ0;
				КонецЕсли;
				//СВЭЙ 13.02.2024 КВВ СВФР-012233 )
				
				Попытка
					СтрокаДвижений.ОплаченоДней = ОплачиваемоеВремяДни * ?(СтрокаДвижений.Сторно,-1,1);
				Исключение
				КонецПопытки;
				//енд
			КонецЕсли;
			
			// Компенсация отпуска и Удержание за неотработанный отпуск					
		ИначеЕсли
			ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДни ИЛИ 
			ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаШестидневка ИЛИ 
			ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДниБезУвольнения ИЛИ 
			ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаШестидневкаБезУвольнения ИЛИ 
			ВидРасчета = ПланыВидовРасчета.УдержанияОрганизаций.УдержаниеЗаНеотработанныйОтпускКалендарныеДни ИЛИ 
			ВидРасчета = ПланыВидовРасчета.УдержанияОрганизаций.УдержаниеЗаНеотработанныйОтпускШестидневка ИЛИ
			(ТипЗнч(ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") И 
			(СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ИЛИ
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке)) Тогда //О.Т. 02.09.2014 № 17565
			
			Если НЕ СтрокаДвижений.Сторно Тогда
				Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				Иначе
					//Островская Татьяна 13.06.2013 № 16558
					Если ИсходныеДанные.СреднийЗаработок = NULL  Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных для расчета среднего заработка ");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
					//Островская Татьяна 17.06.2013 № 16558
				КонецЕсли;
			КонецЕсли;
			
			ПроцентОплаты = 100;
			ОплачиваемоеВремя = СтрокаДвижений[ПоказательРазмер];
			//Островская Татьяна 24.03.2014
			//Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
			//	// переводим дни в часы: количество недель отпуска * длительность рабочей недели
			//	ОплачиваемоеВремя = ОплачиваемоеВремя / ИсходныеДанные.ЧислоДнейВНеделе * ИсходныеДанные.ДлительностьРабочейНедели;
			//КонецЕсли;
			//Островская Татьяна 24.03.2014
			// Рассчитаем заработок за день (или за час для суммированного учета времени)
			Если ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
				ЗаработокЗаЕдиницуВремени =  ИсходныеДанные.РазмерСреднегоЗаработка;
			Иначе
				Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда
					
					//+ СВЭЙ КДЯ 10.01.20 СВФР-005268	
					//Если ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДни 
					//		И ИсходныеДанные.Регистратор.СреднийЧасовойЗаработокДляКомпОтпуска Тогда
					
					//СреднемесНормаРабЧасов = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(НачалоМесяца(СтрокаДвижений.ПериодРегистрации),Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов)).Размер;
					
					//ЗаработокЗаЕдиницуВремени = 
					//	Окр( 
					//		ИсходныеДанные.СреднийЗаработок / ИсходныеДанные.ОтработаноЧасовПоСреднему 
					//		* СреднемесНормаРабЧасов 
					//		/ РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее( 
					//			НачалоМесяца( ИсходныеДанные.Регистратор.ПериодРегистрации ),
					//			Новый Структура( "ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней ) ).Размер,
					//		ЗначениеТочностьСреднего ); //Наркевич 26.05.2014 №
					//- СВЭЙ КДЯ 10.01.20 СВФР-005268
					
					//+ СВЭЙ КДЯ 10.01.20 СВФР-005268
					ДатаСобытия = СтрокаДвижений.Регистратор.ДатаУвольнения;	
					
					Если ( ИсходныеДанные.Регистратор.СреднийЧасовойЗаработокДляКомпОтпуска 
						ИЛИ ИсходныеДанные.Регистратор.ИспользоватьСреднеЧасовойЗаработок )
						И  
						( ТипЗнч( ВидРасчета ) = Тип( "ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций" )  
						И ( СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням 
						ИЛИ
						СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке 
						)
						)
						И НЕ ИсходныеДанные.ОтработаноЧасовПоСреднему = 0 //+ СВЭЙ КДЯ 17.02.20 СВФР-005492 
						Тогда 
						
						СреднеМесячноеКолвоКалендДней = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(
						НачалоМесяца( ДатаСобытия ), 
						Новый Структура( "ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней ) ).Размер;
						
						НормаЧасовПоГрафикуСотрудникаЗаГод = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(
						СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, 
						НачалоГода( ДатаСобытия ), 
						КонецГода( ДатаСобытия ), 
						СтрокаДвижений.Регистратор.Организация 
						);
						
						СреднеЧасовойЗаработок = Окр( ИсходныеДанные.СреднийЗаработок  
						/ ИсходныеДанные.ОтработаноЧасовПоСреднему, ЗначениеТочностьСреднего );	
						
						
						ЗаработокЗаЕдиницуВремени = 
						Окр( СреднеЧасовойЗаработок * НормаЧасовПоГрафикуСотрудникаЗаГод
						/ 12 / СреднеМесячноеКолвоКалендДней,
						ЗначениеТочностьСреднего );
						//- СВЭЙ КДЯ 10.01.20 СВФР-005268
						
					иначе
						ЗаработокЗаЕдиницуВремени = 
						Окр( ИсходныеДанные.СреднийЗаработок / ( ИсходныеДанные.ЧислоМесяцев  
						* РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее( 
						//+ СВЭЙ КДЯ 10.01.20 СВФР-005268
						//НачалоМесяца( ИсходныеДанные.Регистратор.ПериодРегистрации ),
						//- СВЭЙ КДЯ 10.01.20 СВФР-005268
						//+ СВЭЙ КДЯ 10.01.20 СВФР-005268
						НачалоМесяца( ДатаСобытия ),
						//- СВЭЙ КДЯ 10.01.20 СВФР-005268
						Новый Структура( "ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней ) ).Размер ), 
						ЗначениеТочностьСреднего ); //Наркевич 26.05.2014 №
					КонецЕсли;
					
					
				иначе 					
					Если ИсходныеДанные.Регистратор.РасчетПриНеполныхМесяцах Тогда   //неверный расчет если пересчет по часа
						ДнейСр = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца( ИсходныеДанные.Регистратор.Дата ),
						Новый Структура( "ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней ) ).Размер; 
						СрНормаЧасов = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ИсходныеДанные.Регистратор.Дата),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов)).Размер;
						ЗаработокЗаЕдиницуВремени =	Окр(ИсходныеДанные.СреднийЗаработок /ИсходныеДанные.ОтработаноЧасовПоСреднему*СрНормаЧасов/ДнейСр,ЗначениеТочностьСреднего);
					Иначе
						ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ((ИсходныеДанные.ЧислоМесяцев) * РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней)).Размер),ЗначениеТочностьСреднего);// 26.05.2014 №
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			Если Не ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ПерерассчитываемыйДокумент) Тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100, Константы.ВалютаРегламентированногоУчета.Получить());
			Иначе
				Если Не ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ПерерассчитываемыйДокумент) Тогда
					Если НачалоМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации) = НачалоМесяца(ИсходныеДанные.периодДействияНачало) Тогда
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * ?(ИсходныеДанные.Регистратор.КоэффициентОтпуска = 0, 1, ИсходныеДанные.Регистратор.КоэффициентОтпуска), Константы.ВалютаРегламентированногоУчета.Получить());
					Иначе
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100,Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
				Иначе
					//заявка №1921 (база заявок Кристалла) Дмитрук О.Г.
					//О.Т. 10.10.2014 № 242
					если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
						Если (ИсходныеДанные.Регистратор.КоэффициентОтпуска = 1 или ИсходныеДанные.Регистратор.КоэффициентОтпуска = 0)
							ИЛИ (ИсходныеДанные.Регистратор.ДнейЧасовКомпенсацииОтпуска <> 0) Тогда  //Аверсон 04.05.2021 КВВ СВФР-007553
							Если ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДниБезУвольнения Тогда
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * ?(ИсходныеДанные.Регистратор.КоэффициентОтпуска = 0, 1, ИсходныеДанные.Регистратор.КоэффициентОтпуска), Константы.ВалютаРегламентированногоУчета.Получить());
							Иначе
								//Островская Татьяна 15.11.2012 № 16002
								Если НачалоМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации) = НачалоМесяца(ИсходныеДанные.БазовыйПериодНачало) Тогда
									//Островская Татьяна 15.11.2012 № 16002
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * ?(ИсходныеДанные.Регистратор.КоэффициентОтпуска = 0, 1, ИсходныеДанные.Регистратор.КоэффициентОтпуска), Константы.ВалютаРегламентированногоУчета.Получить());
								Иначе
									Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100,Константы.ВалютаРегламентированногоУчета.Получить());
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
					иначе
						Если ИсходныеДанные.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДниБезУвольнения Тогда
							Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * ?(ИсходныеДанные.Регистратор.КоэффициентОтпуска = 0, 1, ИсходныеДанные.Регистратор.КоэффициентОтпуска), Константы.ВалютаРегламентированногоУчета.Получить());
						Иначе
							//Островская Татьяна 15.11.2012 № 16002
							Если НачалоМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации) = НачалоМесяца(ИсходныеДанные.БазовыйПериодНачало) Тогда
								//Островская Татьяна 15.11.2012 № 16002
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * ?(ИсходныеДанные.Регистратор.КоэффициентОтпуска = 0, 1, ИсходныеДанные.Регистратор.КоэффициентОтпуска), Константы.ВалютаРегламентированногоУчета.Получить());
							Иначе
								Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100,Константы.ВалютаРегламентированногоУчета.Получить());
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					//О.Т. 10.10.2014 № 242
					//заявка №1921
				КонецЕсли;
			КонецЕсли;
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Размер начисления: " + Результат, КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Дни отпуска: " + СтрокаДвижений[ПоказательРазмер], КомментарийВидаРасчета);
				Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
					ОбщегоНазначения.КомментарийРасчета("Часы отпуска: " + ОплачиваемоеВремя, КомментарийВидаРасчета);
				КонецЕсли;
				ОбщегоНазначения.КомментарийРасчета(?(СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам,"Среднечасовой заработок: ","Среднедневной заработок: ") + ЗаработокЗаЕдиницуВремени, КомментарийВидаРасчета);
			КонецЕсли;
			
			Если ТипЗнч(ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
				СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя * ?(СтрокаДвижений.Сторно,-1,1);
			КонецЕсли;
			
			// ОплатаПоСреднемуОтпКалендарныеДни 
			// ОплатаПоСреднемуОтпШестидневка 
		ИначеЕсли
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ИЛИ
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке Тогда
			
			Если НЕ СтрокаДвижений.Сторно Тогда
				
				//Аверсон ЕАЕ 31.01.2022 СВФР-008641
				Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И ИсходныеДанные.Регистратор.РасчетОтОклада Тогда
					//Аверсон СВФР-008641
					
				ИначеЕсли ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					Если Не ЗначениеЗаполнено(ИсходныеДанные.РазмерСреднегоЗаработка) тогда 
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет введен размер среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				Иначе
					Если ИсходныеДанные.СреднийЗаработок = NULL 
						ИЛИ СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам и ИсходныеДанные.ОтработаноЧасов = 0 Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных для расчета среднего заработка");
						СтрокаДвижений.Результат = 0;
						Возврат;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			ПроцентОплаты = ?(СтрокаДвижений[ПоказательРазмер] = 0, 100, СтрокаДвижений[ПоказательРазмер]);
			//толик изменил оплачивать по календаою
			//			ОплачиваемоеВремя = ?(ИсходныеДанные.ОплачиваемыеДниОтпуска = NULL, 0, ИсходныеДанные.ОплачиваемыеДниОтпуска);
			
			//Аверсон ЕАЕ 29.06.2021 СВФР-007787
			//ОплачиваемоеВремя = ПрочиеПроцедуры.РассчитатьКоличествоДнейОтпуска(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец);
			Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И ИсходныеДанные.Регистратор.РасчетОтОклада
				И ИсходныеДанные.Регистратор.ВидДней = 1 Тогда //по рабочим дням
				ОплачиваемоеВремя = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ИсходныеДанные.Сотрудник, ИсходныеДанные.ВидУчетаВремени, 
				ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, СтрокаДвижений.Организация);  		
			Иначе
				ОплачиваемоеВремя = ПрочиеПроцедуры.РассчитатьКоличествоДнейОтпуска(ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец);
			КонецЕсли;
			//Аверсон СВФР-007787
			
			//енд
			
			//Аверсон 26.02.2020 КВВ СВФР-005564 (
			Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда
				Если ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускНаОбучение Тогда
					З = Новый Запрос;
					З.Текст = 
					"ВЫБРАТЬ 
					|	СУММА (ВЫБОР 
					|	КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(перечисление.ВидыДнейПроизводственногоКалендаря.Праздник) ТОГДА 1 
					|	ИНАЧЕ 0 КОНЕЦ)  КАК КолвоПраздников
					|ИЗ  РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
					|ГДЕ РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &ДатаНачалаОтпуска И &ДатаОкончанияОтпуска";
					З.УстановитьПараметр("ДатаНачалаОтпуска",		ИсходныеДанные.ПериодДействияНачало);
					З.УстановитьПараметр("ДатаОкончанияОтпуска",	ИсходныеДанные.ПериодДействияКонец);
					Выборка = З.Выполнить().Выбрать();
					мКоличествоДнейПраздника = 0;
					Пока Выборка.Следующий() Цикл
						мКоличествоДнейПраздника = Выборка.КолвоПраздников;
					КонецЦикла;
					ОплачиваемоеВремя = ОплачиваемоеВремя + мКоличествоДнейПраздника;
				КонецЕсли;
			КонецЕсли;
			//Аверсон 26.02.2020 КВВ СВФР-005564 )
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Процент оплаты: " + ПроцентОплаты, КомментарийВидаРасчета);
				ОбщегоНазначения.КомментарийРасчета("Дни отпуска: " + ОплачиваемоеВремя, КомментарийВидаРасчета);
			КонецЕсли;
			Если СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам Тогда
				// переводим дни в часы: количество недель отпуска * длительность рабочей недели
				//ОплачиваемоеВремя = ОплачиваемоеВремя / ИсходныеДанные.ЧислоДнейВНеделе * ИсходныеДанные.ДлительностьРабочейНедели;
				//Если КомментироватьРасчет Тогда
				//	ОбщегоНазначения.КомментарийРасчета("Часы отпуска: " + ОплачиваемоеВремя, КомментарийВидаРасчета);
				//КонецЕсли;
			КонецЕсли;
			
			// Рассчитаем заработок за день (или за час для суммированного учета времени)
			// для строк сторно заработок возьмем из реквизита "ДополнительныеДанные" записи начислений
			Если НЕ СтрокаДвижений.Сторно Тогда
				
				//Аверсон ЕАЕ 31.01.2022 СВФР-008641
				Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И ИсходныеДанные.Регистратор.РасчетОтОклада Тогда
					ЗаработокЗаЕдиницуВремени = ИсходныеДанные.Регистратор.РасчетСреднегоПоОкладу.Итог("РазмерСреднегоЗаработка");
					//Аверсон СВФР-008641
					
				ИначеЕсли ИсходныеДанные.РучнойРасчетСреднегоЗаработка тогда
					ЗаработокЗаЕдиницуВремени =  ИсходныеДанные.РазмерСреднегоЗаработка;
				Иначе
					//Аверсон ЕАЕ 14.10.2022 СВФР-009668
					Если ИсходныеДанные.ЧислоМесяцев = 0 Тогда 
						//ЗаработокЗаЕдиницуВремени = 0;
						Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И ИсходныеДанные.Регистратор.РасчетПриНеполныхМесяцах Тогда
							СреднемесячнаяНормаРабочихЧасов = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ИсходныеДанные.ПериодДействияНачало),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов)).Размер;
							СреднемесячноеКоличествоДней = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ИсходныеДанные.ПериодДействияНачало),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней)).Размер;
							//ТЧ = ИсходныеДанные.Регистратор.РасчетСреднегоПоКалендарным;
							//Заработок = РассчитатьЗаработок(ТЧ);
							//ОтработаноЧасов = РассчитатьОтработаноЧасов(ТЧ);
							Заработок = ИсходныеДанные.СреднийЗаработок;
							ОтработаноЧасов = ИсходныеДанные.ОтработаноЧасовПоСреднему;
							ЗаработокЗаЕдиницуВремени = Окр(Заработок / ОтработаноЧасов * СреднемесячнаяНормаРабочихЧасов / СреднемесячноеКоличествоДней, ЗначениеТочностьСреднего);
						Иначе
							ЗаработокЗаЕдиницуВремени = 0;
							Сообщить("Отработан неполный месяц. Установите флаг Расчет при неполных месяцах и пересчитайте документ.");
						КонецЕсли;
					Иначе
						//ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ((ИсходныеДанные.ЧислоМесяцев) * РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ИсходныеДанные.ПериодДействияНачало),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней)).Размер),ЗначениеТочностьСреднего);//Наркевич 26.05.2014 № //ИсходныеДанные.ОтработаноДней;
						Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И ИсходныеДанные.Регистратор.РасчетПриНеполныхМесяцах Тогда
							СреднемесячнаяНормаРабочихЧасов = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ИсходныеДанные.ПериодДействияНачало),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов)).Размер;
							СреднемесячноеКоличествоДней = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ИсходныеДанные.ПериодДействияНачало),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней)).Размер;
							//ТЧ = ИсходныеДанные.Регистратор.РасчетСреднегоПоКалендарным;
							//Заработок = РассчитатьЗаработок(ТЧ);
							//ОтработаноЧасов = РассчитатьОтработаноЧасов(ТЧ);
							Заработок = ИсходныеДанные.СреднийЗаработок;
							ОтработаноЧасов = ИсходныеДанные.ОтработаноЧасовПоСреднему;
							ЗаработокЗаЕдиницуВремени = Окр(Заработок / ОтработаноЧасов * СреднемесячнаяНормаРабочихЧасов / СреднемесячноеКоличествоДней, ЗначениеТочностьСреднего);
						Иначе
							ЗаработокЗаЕдиницуВремени = Окр(ИсходныеДанные.СреднийЗаработок / ((ИсходныеДанные.ЧислоМесяцев) * РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ИсходныеДанные.ПериодДействияНачало),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней)).Размер),ЗначениеТочностьСреднего);//Наркевич 26.05.2014 № //ИсходныеДанные.ОтработаноДней;
						КонецЕсли;
						//Аверсон СВФР-009668
					КонецЕсли;
				КонецЕсли;
				
				// сохраним заработок за единицу времени для возможных расчетов сторно записей в будущем 
				СтрокаДвижений.ДополнительныеДанные = ЗаработокЗаЕдиницуВремени;
				
			Иначе
				ЗаработокЗаЕдиницуВремени = СтрокаДвижений.ДополнительныеДанные;
			КонецЕсли;
			
			Если Не ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ПерерассчитываемыйДокумент) Тогда
				//Аверсон ЕАЕ 26.03.2021 СВФР-007329
				Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") 
					И ЗначениеЗаполнено(ИсходныеДанные.Регистратор) И ИсходныеДанные.Регистратор.РасчетОтОклада Тогда
					
					//Аверсон ЕАЕ 07.02.2022 СВФР-008641
					ОтработаноДнейЧасов = Неопределено;
					//Аверсон СВФР-008641
					
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(РассчитатьРезультатОтОкладаОтпуск(ИсходныеДанные.Регистратор, ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, Ложь, ОтработаноДнейЧасов),Константы.ВалютаРегламентированногоУчета.Получить()); //Аверсон ЕАЕ 07.02.2022 СВФР-008641 параметр ОтработаноДнейЧасов
					//Аверсон СВФР-007329
				Иначе
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100,Константы.ВалютаРегламентированногоУчета.Получить());
				КонецЕсли;
				
			Иначе
				Если НачалоМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации) = НачалоМесяца(ИсходныеДанные.периодДействияНачало) Тогда
					//Аверсон ЕАЕ 26.03.2021 СВФР-007329
					Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") 
						И ЗначениеЗаполнено(ИсходныеДанные.Регистратор) И ИсходныеДанные.Регистратор.РасчетОтОклада Тогда
						
						//Аверсон ЕАЕ 07.02.2022 СВФР-008641
						ОтработаноДнейЧасов = Неопределено;
						//Аверсон СВФР-008641
						
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(РассчитатьРезультатОтОкладаОтпуск(ИсходныеДанные.Регистратор, ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, Истина, ОтработаноДнейЧасов),Константы.ВалютаРегламентированногоУчета.Получить()); //Аверсон ЕАЕ 07.02.2022 СВФР-008641 параметр ОтработаноДнейЧасов
					Иначе
						//Аверсон СВФР-007329	
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100 * ?(ИсходныеДанные.Регистратор.КоэффициентОтпуска = 0, 1, ИсходныеДанные.Регистратор.КоэффициентОтпуска),Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
				Иначе
					//Аверсон ЕАЕ 26.03.2021 СВФР-007329
					Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") 
						И ЗначениеЗаполнено(ИсходныеДанные.Регистратор) И ИсходныеДанные.Регистратор.РасчетОтОклада Тогда
						
						//Аверсон ЕАЕ 07.02.2022 СВФР-008641
						ОтработаноДнейЧасов = Неопределено;
						//Аверсон СВФР-008641
						
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(РассчитатьРезультатОтОкладаОтпуск(ИсходныеДанные.Регистратор, ИсходныеДанные.ПериодДействияНачало, ИсходныеДанные.ПериодДействияКонец, Ложь, ОтработаноДнейЧасов),Константы.ВалютаРегламентированногоУчета.Получить()); //Аверсон ЕАЕ 07.02.2022 СВФР-008641 параметр ОтработаноДнейЧасов
					Иначе
						//Аверсон СВФР-007329	
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ОплачиваемоеВремя * ЗаработокЗаЕдиницуВремени * ПроцентОплаты / 100,Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета(?(СтрокаДвижений.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам,"Среднечасовой заработок: ","Среднедневной заработок: ") + ЗаработокЗаЕдиницуВремени, КомментарийВидаРасчета);
			КонецЕсли;
			
			//толик оплачено дней и часов
			//Аверсон ЕАЕ 07.02.2022 СВФР-008641
			Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций")
				И ЗначениеЗаполнено(ИсходныеДанные.Регистратор) И ИсходныеДанные.Регистратор.РасчетОтОклада И ЗначениеЗаполнено(ОтработаноДнейЧасов) Тогда
				СтрокаДвижений.ОплаченоДней = ОтработаноДнейЧасов.ОтработаноДней * ?(СтрокаДвижений.Сторно,-1,1);
				СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноДнейЧасов.ОтработаноЧасов * ?(СтрокаДвижений.Сторно,-1,1);
			Иначе
				//Аверсон СВФР-008641
				СтрокаДвижений.ОплаченоДней = ОплачиваемоеВремя * ?(СтрокаДвижений.Сторно,-1,1);
				СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя * 8 * ?(СтрокаДвижений.Сторно,-1,1);
			КонецЕсли;
			
			// ПособиеНаРебенкаДо3Лет
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет Тогда
			Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				Если ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на ребенка до 3-х лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
					ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
					Если КалендарныхДнейВМесяце = ОплачиваемыеДни Тогда //О.Т. Аверсон 19.10.2016 № 1491
						КалендарныхДнейВМесяце = 1;
						ОплачиваемыеДни = 1;
					КонецЕсли;
					
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313	
				КонецЕсли;
			Иначе
				//заявка №1604 (база заявок Кристалла) Дмитрук О.Г.
				мСтрока = РегистрыСведений.ГосударственныеПособия.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),
				Новый Структура("ВидПособия", Перечисления.ВидыГосударственныхПособий.ПособиеНаРебенкаДо3Лет));
				
				Если мСтрока.Размер = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на ребенка до 3-х лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало));
					ОплачиваемыеДни = День(СтрокаДвижений.БазовыйПериодКонец) - День(СтрокаДвижений.БазовыйПериодНачало) + 1;
					Если КалендарныхДнейВМесяце = ОплачиваемыеДни Тогда //О.Т. Аверсон 19.10.2016 № 1491
						КалендарныхДнейВМесяце = 1;
						ОплачиваемыеДни = 1;
					КонецЕсли;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
				КонецЕсли;
				//заявка №1604
				
			КонецЕсли;
			
			//О.Т. Аверсон 21.07.2017 № 851
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей Тогда
			Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				Если ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия старше 3-х лет из отдельных категорий семей");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
					ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
					Если КалендарныхДнейВМесяце = ОплачиваемыеДни Тогда //О.Т. Аверсон 19.10.2016 № 1491
						КалендарныхДнейВМесяце = 1;
						ОплачиваемыеДни = 1;
					КонецЕсли;
					
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313	
				КонецЕсли;
			Иначе
				//заявка №1604 (база заявок Кристалла) Дмитрук О.Г.
				мСтрока = РегистрыСведений.ГосударственныеПособия.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),
				Новый Структура("ВидПособия", Перечисления.ВидыГосударственныхПособий.ПособиеНаРебенкаДо3Лет));
				
				Если мСтрока.Размер = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия старше 3-х лет из отдельных категорий семей");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало));
					ОплачиваемыеДни = День(СтрокаДвижений.БазовыйПериодКонец) - День(СтрокаДвижений.БазовыйПериодНачало) + 1;
					Если КалендарныхДнейВМесяце = ОплачиваемыеДни Тогда //О.Т. Аверсон 19.10.2016 № 1491
						КалендарныхДнейВМесяце = 1;
						ОплачиваемыеДни = 1;
					КонецЕсли;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
				КонецЕсли;
				//заявка №1604
				
			КонецЕсли;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид Тогда
			Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				Если ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия старше 3-х лет из отдельных категорий семей (инвалид)");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
					ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
					Если КалендарныхДнейВМесяце = ОплачиваемыеДни Тогда //О.Т. Аверсон 19.10.2016 № 1491
						КалендарныхДнейВМесяце = 1;
						ОплачиваемыеДни = 1;
					КонецЕсли;
					
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313	
				КонецЕсли;
			Иначе
				//заявка №1604 (база заявок Кристалла) Дмитрук О.Г.
				мСтрока = РегистрыСведений.ГосударственныеПособия.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),
				Новый Структура("ВидПособия", Перечисления.ВидыГосударственныхПособий.ПособиеНаРебенкаДо3Лет));
				
				Если мСтрока.Размер = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия старше 3-х лет из отдельных категорий семей (инвалид)");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало));
					ОплачиваемыеДни = День(СтрокаДвижений.БазовыйПериодКонец) - День(СтрокаДвижений.БазовыйПериодНачало) + 1;
					Если КалендарныхДнейВМесяце = ОплачиваемыеДни Тогда //О.Т. Аверсон 19.10.2016 № 1491
						КалендарныхДнейВМесяце = 1;
						ОплачиваемыеДни = 1;
					КонецЕсли;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
				КонецЕсли;
				//заявка №1604
				
			КонецЕсли;         
			//О.Т. Аверсон 21.07.2017 № 851
			
			
			// ПособиематериОдиночкеДо1_5Лет
			//
			//О.Т. 27.01.2015 № 17821
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаДетейВВозрастеОт3До18 Тогда
			Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				Если ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на детей в возрасте от 3-х до 18 лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
					ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313	
				КонецЕсли;
			Иначе
				//заявка №1604 (база заявок Кристалла) Дмитрук О.Г.
				мСтрока = РегистрыСведений.ГосударственныеПособия.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),
				Новый Структура("ВидПособия", Перечисления.ВидыГосударственныхПособий.ПособиеНаДетейВВозрастеОт3До18));
				
				Если мСтрока.Размер = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на детей в возрасте от 3-х до 18 лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало));
					ОплачиваемыеДни = День(СтрокаДвижений.БазовыйПериодКонец) - День(СтрокаДвижений.БазовыйПериодНачало) + 1;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
				КонецЕсли;
				//заявка №1604
				
			КонецЕсли;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаВторогоИПоследующихДо3Лет Тогда
			Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				Если ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на на второго и последующих детей до 3-х лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
					ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313	
				КонецЕсли;
			Иначе
				//заявка №1604 (база заявок Кристалла) Дмитрук О.Г.
				мСтрока = РегистрыСведений.ГосударственныеПособия.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),
				Новый Структура("ВидПособия", Перечисления.ВидыГосударственныхПособий.ПособиеНаВторогоИПоследующихДо3Лет));
				
				Если мСтрока.Размер = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на на второго и последующих детей до 3-х лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало));
					ОплачиваемыеДни = День(СтрокаДвижений.БазовыйПериодКонец) - День(СтрокаДвижений.БазовыйПериодНачало) + 1;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
				КонецЕсли;
				//заявка №1604
				
			КонецЕсли;	
			
			
			//О.Т. 27.01.2015 № 17821
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиематериОдиночкеДо1_5Лет Тогда
			Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				Если ИсходныеДанные.РазмерПособияМатериОдиночкеДо1_5Лет = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия матери-одиночке на ребенка до 1.5 лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
					ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияматериОдиночкеДо1_5Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияматериОдиночкеДо1_5Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
				КонецЕсли;
			Иначе
				//заявка №1633 (база заявок Кристалла) Дмитрук О.Г.
				мСтрока = РегистрыСведений.ГосударственныеПособия.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),
				Новый Структура("ВидПособия", Перечисления.ВидыГосударственныхПособий.ПособиеМатериОдиночкеДо1_5Лет));
				
				Если мСтрока.Размер = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия матери-одиночке на ребенка до 1.5 лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало));
					ОплачиваемыеДни = День(СтрокаДвижений.БазовыйПериодКонец) - День(СтрокаДвижений.БазовыйПериодНачало) + 1;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
				КонецЕсли;
				//заявка №1633
			Конецесли;
			// ПособиеМатериОдиночкеДо3Лет
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо3Лет Тогда
			Если ТипЗнч(ИсходныеДанные.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				
				Если ИсходныеДанные.РазмерПособияМатериОдиночкеДо3Лет = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия матери-одиночке на ребенка до 3-х лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
					ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияМатериОдиночкеДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияМатериОдиночкеДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
					
				КонецЕсли;
			Иначе
				//заявка №1633 (база заявок Кристалла) Дмитрук О.Г.
				мСтрока = РегистрыСведений.ГосударственныеПособия.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало),
				Новый Структура("ВидПособия", Перечисления.ВидыГосударственныхПособий.ПособиеМатериОдиночкеДо3Лет));
				
				Если мСтрока.Размер = Null тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия матери-одиночке на ребенка до 3-х лет");
				Иначе
					КалендарныхДнейВМесяце = День(КонецМесяца(СтрокаДвижений.БазовыйПериодНачало));
					ОплачиваемыеДни = День(СтрокаДвижений.БазовыйПериодКонец) - День(СтрокаДвижений.БазовыйПериодНачало) + 1;
					//Островская Татьяна 12.03.2013 № 16313
					Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
					ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((мСтрока.Размер * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
					//Островская Татьяна 12.03.2013 № 16313
				КонецЕсли;
				//заявка №1633
			Конецесли;
			
			// ПособиеНаРебенкаСНадбавкой40До3Лет
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСНадбавкой40До3Лет Тогда
			Если ИсходныеДанные.РазмерПособияНаРебенкаСНадбавкой40До3Лет = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия по уходу за ребенком-инвалидом в возрасте до 18 лет (120%БПМ)");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаСНадбавкой40До3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаСНадбавкой40До3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;
			
			// ПособиеНеРаботающейМатериДо3Лет
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРаботающейМатериДо3Лет Тогда
			Если ИсходныеДанные.РазмерПособияНеРаботающейМатериДо3Лет = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия не работающей матери на ребенка до 3-х лет");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНеРаботающейМатериДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНеРаботающейМатериДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;	
			
			// ПособиеНеРабМатериНадб40До3Лет
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериНадб40До3Лет Тогда
			Если ИсходныеДанные.РазмерПособияНеРабМатериНадб40До3Лет = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия не работающей матери с надбавкой 40% на ребенка до 3-х лет");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНеРабМатериНадб40До3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНеРабМатериНадб40До3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;
			
			// ПособиеНеРабМатериОдиночкеДо1_5Лет
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо1_5Лет Тогда
			Если ИсходныеДанные.РазмерПособияНеРабМатериОдиночкеДо1_5Лет = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия не работающей матери-одиночке на ребенка до 1.5 лет");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНеРабМатериОдиночкеДо1_5Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНеРабМатериОдиночкеДо1_5Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;
			
			// ПособиеНаРебенкаСтарше3Лет
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСтарше3Лет Тогда
			Если ИсходныеДанные.РазмерПособиянаРебенкаСтарше3Лет = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на ребенка старше 3-х лет");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаСтарше3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособиянаРебенкаСтарше3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;
			
			// ПособиеНеРабМатериОдиночкеДо3Лет
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо3Лет Тогда
			Если ИсходныеДанные.РазмерПособияНеРабМатериОдиночкеДо3Лет = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия не работающей метери-одиночке на ребенка до 3-х лет");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНеРабМатериОдиночкеДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНеРабМатериОдиночкеДо3Лет * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;
			
			// ПособиеНаРебенкаДо18ЛетНадб40
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо18ЛетНадб40 Тогда
			Если ИсходныеДанные.РазмерПособияНаРебенкаДо18ЛетНадб40 = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на ребенка до 18 лет с надбавкой 40%");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНаРебенкаДо18ЛетНадб40 * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНаРебенкаДо18ЛетНадб40 * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;
			
			// ПособиеНаРебенкаИнвалида
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида Тогда
			Если ИсходныеДанные.РазмерПособияНаРебенкаИнвалида = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на ребенка инвалида");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНаРебенкаИнвалида * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНаРебенкаИнвалида * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;
			// ПособиеНаРебенкаВИЧ
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаВИЧ Тогда
			Если ИсходныеДанные.РазмерПособияНаРебенкаВИЧ = Null тогда
				ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование+". Не задан размер пособия на ребенка ВИЧ");
			Иначе
				КалендарныхДнейВМесяце = День(КонецМесяца(ИсходныеДанные.ПериодДействияНачало));
				ОплачиваемыеДни = День(ИсходныеДанные.ПериодДействияКонец) - День(ИсходныеДанные.ПериодДействияНачало) + 1;
				//Островская Татьяна 12.03.2013 № 16313
				Результат = ?(не ЗначениеЗаполнено(ПорядокОкругленияПособия)или ПорядокОкругленияПособия = Неопределено,ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНаРебенкаВИЧ * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),
				ОбщегоНазначения.ОкруглитьРезультат(ОбщегоНазначения.ОкруглитьПоВалюте((ИсходныеДанные.РазмерПособияНаРебенкаВИЧ * СтрокаДвижений[ПоказательРазмер] / 100) / КалендарныхДнейВМесяце  * ОплачиваемыеДни, Константы.ВалютаРегламентированногоУчета.Получить()),ПорядокОкругленияПособия));
				//Островская Татьяна 12.03.2013 № 16313
			КонецЕсли;
			// СдельныйЗаработок
			//
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок Тогда
			
			Если ИсходныеДанные.РазмерСдельногоЗаработка = NULL Тогда
				Если ИсходныеДанные.ОшибкаВводаФактическойВыработки Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Данные об фактической выработке введены сводно. Расчет суммы по данному виду расчета невозможен");
				Иначе
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет данных о фактической выработке ");
				КонецЕсли;
			Иначе
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ИсходныеДанные.РазмерСдельногоЗаработка,Константы.ВалютаРегламентированногоУчета.Получить());
				Если ИсходныеДанные.ЗачетНормыВремени Или ИсходныеДанные.ЗачетОтработанногоВремени Тогда
					СтрокаДвижений.ОплаченоДнейЧасов = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
				КонецЕсли;
				Если КомментироватьРасчет Тогда
					ОбщегоНазначения.КомментарийРасчета("Размер сдельного заработка: " + ИсходныеДанные.РазмерСдельногоЗаработка, КомментарийВидаРасчета);
				КонецЕсли;
			КонецЕсли;
			
			// доначсиление до размеров управленческих начислений
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету Тогда
			// здесь предполагаем, что в наборе записей не может быть записей с разными периодами регистрации
			ПериодДохода = СтрокаДвижений.ПериодРегистрации;
			Результат = ПодобратьДоначисление(СведенияОДоначислениях, ИсходныеДанные.Сотрудник, СтрокаДвижений.ПериодРегистрации);
			
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Размер начисления: " + Результат, КомментарийВидаРасчета);
			КонецЕсли;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроизвольнаяФормула Тогда
			
			// проверем все ли показатели получены			
			Если ИсходныеДанные.КоличествоПоказателей <> Null Тогда
				Для НомерСтроки = 1 По ИсходныеДанные.КоличествоПоказателей Цикл
					Если ИсходныеДанные["Показатель"+НомерСтроки] = Null Тогда
						ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": не получен Показатель """ + ИсходныеДанные["Показатель"+НомерСтроки+"Наименование"] + """");
						РезультатПолучен = Ложь;
					ИначеЕсли КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета(ИсходныеДанные["Показатель"+НомерСтроки+"Наименование"]+ ": " + Строка(ИсходныеДанные["Показатель"+НомерСтроки]), КомментарийВидаРасчета);
					КонецЕсли;
					
				КонецЦикла;
			КонецЕсли;
			
			Если РезультатПолучен Тогда
				Попытка
					Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Вычислить(ИсходныеДанные.ФормулаРасчета),Константы.ВалютаРегламентированногоУчета.Получить());
				Исключение					
					ОбщегоНазначения.КомментарийРасчета(ИсходныеДанные.СотрудникНаименование + "; " +ИсходныеДанные.ВидРасчетаНаименование +" Ошибка в формуле расчета!", КомментарийВидаРасчета, ,,Перечисления.ВидыСообщений.Ошибка);
				КонецПопытки;
			КонецЕсли;	
			//О.Т. Аверсон 28.03.2018 № 1759
			Попытка
				Если ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников") Тогда 
					Если не( ИсходныеДанные.Регистратор.ЗаполнениеПоГруппеРасчетов и ТекЗначение <> Неопределено) Тогда 
						ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
						СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1); 
					КонецЕсли;
				иначе
					ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
					СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1);  		
				КонецЕсли;
			Исключение	
			КонецПопытки;
			//О.Т. Аверсон 28.03.2018 № 1759
			
			// заявка №1602 (база заявок Кристалла) Дмитрук О.Г.
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1Разряда Тогда
			мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация,ТарифнаяСтавка",СтрокаДвижений.Организация,СтрокаДвижений.ВидРасчета.ТарифнаяСтавка1Разряда)).Размер;//О.Т. Аверсон 24.01.2017 № 179
			если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100)*СтрокаДвижений.Регистратор.ПроцентОплаты/100,Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т. Аверсон 15.03.2016 № 949
			Иначе
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100),Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т. Аверсон 15.03.2016 № 949
			КонецЕсли;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1РазрядаОтрВр Тогда
			
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда
				ТЗКолвоДнКом = ПроверитьКомандировкиИОплатуПоСреднему(СтрокаДвижений.Организация,ИсходныеДанные.Сотрудник,ИсходныеДанные.ПериодДействияНачало,ИсходныеДанные.ПериодДействияКонец);
				Если ТЗКолвоДнКом.Количество() > 0 Тогда
					Для Каждого Стр Из ТЗКолвоДнКом Цикл
						Если Стр.Дней > 0 Тогда
							мОтработаноЧасов = мОтработаноЧасов + Стр.НормаЧ;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
			Если СтрокаДвижений.организация.инн = "700067572" Тогда   				
				Запрос = Новый Запрос;
				Запрос.Текст =
				"ВЫБРАТЬ
				|	РабочееВремяРаботниковОрганизаций.Часов,
				|   РабочееВремяРаботниковОрганизаций.Период,
				
				//Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 2) (
				|   ВЫБОР КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Праздник) ТОГДА
				|   ИСТИНА 
				|	ИНАЧЕ ЛОЖЬ 
				|	КОНЕЦ КАК ЭтоГосПраздник
				//Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 2) )
				
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций	
				
				//Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 2) (
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
				|		ПО РабочееВремяРаботниковОрганизаций.Период = РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
				//Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 2) )
				
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|		ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени1)
				
				|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
				|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
				|";
				
				Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
				Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные);
				Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени1", Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
				
				СнятьГосПраздники = 0; //Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 2)	
				Выборка = Запрос.Выполнить().Выбрать();
				Пока Выборка.Следующий() цикл
					Если не ЭтоРабочийСоСдельнойОплатой(СтрокаДвижений.Сотрудник, Выборка.Период) Тогда //Аверсон ЕАЕ 11.06.2021 б/н
						мОтработаноЧасов = мОтработаноЧасов-Выборка.Часов;
						
						//Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 2) (
						Если СокрЛП(СтрокаДвижений.ПодразделениеОрганизации) = "Транспортный цех" ИЛИ (ЗначениеЗаполнено(СтрокаДвижений.ПодразделениеОрганизации.Родитель) И СокрЛП(СтрокаДвижений.ПодразделениеОрганизации.Родитель) = "Транспортный цех") Тогда
							СнятьГосПраздники = СнятьГосПраздники + ?(Выборка.ЭтоГосПраздник,Выборка.Часов,0);
						Иначе
							Если Выборка.ЭтоГосПраздник Тогда
								мОтработаноЧасов = мОтработаноЧасов+Выборка.Часов;
							КонецЕсли;
						КонецЕсли;
						//Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 2) )
						
					КонецЕсли;
				КонецЦикла;   
				
				//Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 1) (
				Если (СокрЛП(СтрокаДвижений.ПодразделениеОрганизации) = "Транспортный цех" ИЛИ (ЗначениеЗаполнено(СтрокаДвижений.ПодразделениеОрганизации.Родитель) И СокрЛП(СтрокаДвижений.ПодразделениеОрганизации.Родитель) = "Транспортный цех")) И ЗначениеЗаполнено(ОтработаноЧасовПС) Тогда
					мОтработаноЧасов = мОтработаноЧасов + ОтработаноЧасовПС - СнятьГосПраздники; 					
				КонецЕсли;
				//Аверсон 10.06.2022 КВВ СВФР-009189 (пункт 1) )
				
			Конецесли;
			мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,
			Новый Структура("Организация,ТарифнаяСтавка",СтрокаДвижений.Организация,Справочники.ТарифныеСтавкиПервогоРазряда.Основная)).Размер;
			//Островская Татьяна 10.04.2014
			если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
				ПроцентОплатыДок = СтрокаДвижений.Регистратор.ПроцентОплаты;
			Иначе
				ПроцентОплатыДок = 100;
			КонецЕсли;
			//Островская Татьяна 10.04.2014
			если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				Н1 = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодРегистрации,СтрокаДвижений.Организация);
				Отр = мОтработаноЧасов;	
			Иначе
				Н1 = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(СтрокаДвижений.ПериодРегистрации),СтрокаДвижений.Организация);
				если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
					Отр = СтрокаДвижений.Регистратор.ОплаченоДнейЧасовШапка; 
				Иначе
					Отр = мОтработаноЧасов;
				КонецЕсли;
			КонецЕсли;
			ТекущаяТарифнаяСтавка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия, 
			Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
			
			Отбор = Новый Структура;
			Отбор.Вставить("Организация", СтрокаДвижений.Организация);
			Отбор.Вставить("ТарифнаяСтавка",  ТекущаяТарифнаяСтавка);
			
			РазмерТС =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,Отбор).Размер;
			Если не ЗначениеЗаполнено(СтрокаДвижений.ВидРасчета.ТарифнаяСтавка1Разряда) тогда
				мТС1Разряда	=РазмерТС;
			КонецЕсли;
			
			//О.Т. 22.05.2015 № 
			ЗанимаемыхСтавок = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
			если не ЗанимаемыхСтавок > 0 Тогда 
				ЗанимаемыхСтавок = 1;			
			КонецЕсли; 
			//О.Т. 22.05.2015 № 
			Если СтрокаДвижений.ПериодРегистрации < Дата(2016,07,1) Тогда  //О.Т. Аверсон 15.03.2016 № 949
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Окр(Окр(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100)/Н1*Отр*ПроцентОплатыДок/100)),Константы.ВалютаРегламентированногоУчета.Получить());
			иначе
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мТС1Разряда * (СтрокаДвижений[ПоказательРазмер]/100)/Н1*Отр*ПроцентОплатыДок/100,Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т. Аверсон 20.01.2017 № 195 убрала округления
			КонецЕсли;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеФиксированнойСуммойОтБазы Тогда
			Если ИсходныеДанные.РезультатБаза = NULL Тогда
				Результат = 0;
			Иначе
				Если КомментироватьРасчет Тогда
					КомментарийБазы = ОбщегоНазначения.КомментарийРасчета("Базовые начисления составили всего: " + ИсходныеДанные.РезультатБаза, КомментарийВидаРасчета,,,, Ложь);
					РасшифровкаБазы = ИсходныеДанные.Выбрать();
					Если Не РегламентированныеУдержания Тогда
						Пока РасшифровкаБазы.Следующий() Цикл
							Если РасшифровкаБазы.РезультатБаза <> 0 Тогда
								ОбщегоНазначения.КомментарийРасчета(РасшифровкаБазы.ВидРасчетаРазрезНаименование + ": " + РасшифровкаБазы.РезультатБаза, КомментарийБазы);
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
				КонецЕсли;
				
				мСуммаУдержания = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.ПериодРегистрации),
				Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СуммаУдержанияНатурПродукта)).Размер;
				
				мПределУдержания = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.ПериодРегистрации),
				Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПределУдержанияНатурПродукта)).Размер;
				
				Если РегламентированныеУдержания Тогда
					УжеНачисленоВТекущемПериоде = ?(ИсходныеДанные.УжеНачисленоВТекущемПериоде = Null, 0, ИсходныеДанные.УжеНачисленоВТекущемПериоде);
					Если ИсходныеДанные.РезультатБаза < мПределУдержания Тогда 
						Результат = 0;
					Иначе
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мСуммаУдержания, Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
					
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Сумма: " + мСуммаУдержания, КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Ранее начислено в текущем периоде: " + УжеНачисленоВТекущемПериоде, КомментарийВидаРасчета);
					КонецЕсли;
				Иначе
					Если ИсходныеДанные.РезультатБаза < мПределУдержания Тогда 
						Результат = 0;
					Иначе
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте(мСуммаУдержания, Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Сумма: " + мСуммаУдержания, КомментарийВидаРасчета);
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			// заявка №1676	
			//Островская Татьяна 25.03.2013 № 16351	
			
			//Аверсон 10.02.2023 КВВ СВФР-010320 (
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплатыИнвалидам1и2гр тогда
			ВидРасчетаПрисутствует = ПоискВидаРасчетаПоГруппеРасчета(СтрокаДвижений);
			Если ВидРасчетаПрисутствует Тогда 
				Результат = 0;
				Сообщить("Вид расчета или вид времени у сотрудника "+СтрокаДвижений.Сотрудник.Наименование+", исключен из доплаты");
			иначе
				СообщениеОбОшибке = Ложь;
				ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
				//Если ИсходныеДанные.РазмерЧасоваяМинимальнаяЗарплата = 0 Тогда
				
				РазмерЧасоваяМинимальнаяЗарплатаИнв = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.ПериодДействияНачало), 
				Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ЧасоваяМинимальнаяЗарплатаИнвалиды)).Размер;
				
				Если РазмерЧасоваяМинимальнаяЗарплатаИнв = 0 Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не задан размер часовой минимальной зарплаты для инвалидов I и II гр.");
				ИначеЕсли  ИсходныеДанные.РезультатБаза = NULL Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления ");
				ИначеЕсли СообщениеОбОшибке Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
				Иначе
					
					ЗапросВВр = Новый Запрос;
					ЗапросВВр.Текст =
					"ВЫБРАТЬ
					|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
					|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
					|ИЗ
					|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
					|ГДЕ
					|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
					|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРабочегоВремени)
					|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период2
					|	И ВЫБОР
					|			КОГДА &ФлагПоТабелю
					|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
					|			ИНАЧЕ ИСТИНА
					|		КОНЕЦ";
					ВидыВремени = Новый СписокЗначений;
					Для Каждого стрВидыВр из Справочники.ГруппыРасчетов.ДополнительноеВремяПриДоплатеДоМинимальнойЗП.КлассификаторИспользованияРВ Цикл 
						ВидыВремени.Добавить(стрВидыВр.ВидКлассификатора);
					КонецЦикла;
					ЗапросВВр.УстановитьПараметр("ВидИспользованияРабочегоВремени", ВидыВремени);
					ЗапросВВр.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
						ЗапросВВр.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
						ЗапросВВр.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
					ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
						ЗапросВВр.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
						ЗапросВВр.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
					иначе		
						ЗапросВВр.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
						ЗапросВВр.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					КонецЕсли;  
					УчетнаяПолитикаЗапрос = Новый Запрос;  
					УчетнаяПолитикаЗапрос.Текст = 
					"ВЫБРАТЬ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
					|ИЗ
					|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
					|ГДЕ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
					УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
					УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
					если УчетнаяПолитика.Количество()>0 Тогда 
						ЗапросВВр.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
					иначе
						ЗапросВВр.УстановитьПараметр("ФлагПоТабелю",Ложь);
					КонецЕсли;
					
					РезультатВВр = ЗапросВВр.Выполнить().Выбрать();
					ДопВремя = 0;
					Пока РезультатВВр.Следующий() Цикл
						ДопВремя = ?(РезультатВВр.Часов=Null,0,РезультатВВр.Часов);
					КонецЦикла;   
					
					//ЧасоваяМинимальнаяЗарплата = ИсходныеДанные.РазмерЧасоваяМинимальнаяЗарплата;
					ЧасоваяМинимальнаяЗарплата = РазмерЧасоваяМинимальнаяЗарплатаИнв;
					СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1);
					База =  ИсходныеДанные.РезультатБаза;
					Результат = ЧасоваяМинимальнаяЗарплата * (ОтработаноВремениОсновное+ДопВремя) -  База; 
					Результат = ?(Результат > 0 ,Результат,0);
					
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Часовая минимальная зарплата для инвалидов I и II гр.: " + сокрлп(РазмерЧасоваяМинимальнаяЗарплатаИнв), КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Начисленно в месяце: " + База, КомментарийВидаРасчета);
					КонецЕсли;					
				КонецЕсли;
			КонецЕсли;
			
			//Аверсон 10.02.2023 КВВ СВФР-010320 )
			
			//О.Т. Аверсон 15.10.2015 № 637	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты тогда
			ВидРасчетаПрисутствует = ПоискВидаРасчетаПоГруппеРасчета(СтрокаДвижений);
			Если ВидРасчетаПрисутствует Тогда 
				Результат = 0;
				Сообщить("Вид расчета или вид времени у сотрудника "+СтрокаДвижений.Сотрудник.Наименование+", исключен из доплаты");
			иначе
				СообщениеОбОшибке = Ложь;
				ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
				Если ИсходныеДанные.РазмерЧасоваяМинимальнаяЗарплата = 0 Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не задан размер часовой минимальной зарплаты");
				ИначеЕсли  ИсходныеДанные.РезультатБаза = NULL Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления ");
				ИначеЕсли СообщениеОбОшибке Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
				Иначе
					//О.Т. Аверсон 11.05.2018 № 1948 убираем заявку 1594
					//О.Т. Аверсон 15.02.2018 № 1594
					//ЗанимаемыхСтавок = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
					//если не ЗанимаемыхСтавок > 0 Тогда 
					//	ЗанимаемыхСтавок = 1;			
					//КонецЕсли;
					//О.Т. Аверсон 15.02.2018 № 1594 
					//О.Т. Аверсон 11.05.2018 № 1948
					
					//О.Т. Аверсон 02.05.2019 № 4298
					ЗапросВВр = Новый Запрос;
					Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда
						ЗапросВВр.Текст =
						"ВЫБРАТЬ
						|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
						|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРабочегоВремени)
						|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
						|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
						|	И ВЫБОР
						|			КОГДА &ФлагПоТабелю
						|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
						|			ИНАЧЕ ИСТИНА
						|		КОНЕЦ";
					иначе
						ЗапросВВр.Текст =
						"ВЫБРАТЬ
						|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
						|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРабочегоВремени)
						|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период2
						|			
						|	И ВЫБОР
						|			КОГДА &ФлагПоТабелю
						|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
						|			ИНАЧЕ ИСТИНА
						|		КОНЕЦ";
					КонецЕсли;
					ВидыВремени = Новый СписокЗначений;
					Для Каждого стрВидыВр из Справочники.ГруппыРасчетов.ДополнительноеВремяПриДоплатеДоМинимальнойЗП.КлассификаторИспользованияРВ Цикл 
						ВидыВремени.Добавить(стрВидыВр.ВидКлассификатора);
					КонецЦикла;
					ЗапросВВр.УстановитьПараметр("ВидИспользованияРабочегоВремени", ВидыВремени);
					ЗапросВВр.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
						ЗапросВВр.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
						ЗапросВВр.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
					ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
						ЗапросВВр.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
						ЗапросВВр.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
					иначе		
						ЗапросВВр.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
						ЗапросВВр.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					КонецЕсли;  
					УчетнаяПолитикаЗапрос = Новый Запрос; //О.Т. 23.12.2014 № 
					УчетнаяПолитикаЗапрос.Текст = 
					"ВЫБРАТЬ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
					|ИЗ
					|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
					|ГДЕ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
					УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
					УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
					если УчетнаяПолитика.Количество()>0 Тогда 
						ЗапросВВр.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
					иначе
						ЗапросВВр.УстановитьПараметр("ФлагПоТабелю",Ложь);
					КонецЕсли;
					
					РезультатВВр = ЗапросВВр.Выполнить().Выбрать();
					ДопВремя = 0;
					Пока РезультатВВр.Следующий() Цикл
						ДопВремя = ?(РезультатВВр.Часов=Null,0,РезультатВВр.Часов);
					КонецЦикла;   
					//О.Т. Аверсон 02.05.2019 № 4298
					
					
					ЧасоваяМинимальнаяЗарплата = ИсходныеДанные.РазмерЧасоваяМинимальнаяЗарплата;
					СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1);
					База =  ИсходныеДанные.РезультатБаза;
					Результат = ЧасоваяМинимальнаяЗарплата * (ОтработаноВремениОсновное+ДопВремя) -  База; //* ЗанимаемыхСтавок
					Результат = ?(Результат > 0 ,Результат,0);
					
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Часовая минимальная зарплата: " + ИсходныеДанные.РазмерЧасоваяМинимальнаяЗарплата, КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Начисленно в месяце: " + База, КомментарийВидаРасчета);
					КонецЕсли;
					
				КонецЕсли;
			КонецЕсли;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМЗПотМесячнойМЗП тогда
			
			ВидРасчетаПрисутствует = ПоискВидаРасчетаПоГруппеРасчета(СтрокаДвижений);
			Если ВидРасчетаПрисутствует Тогда 
				Результат = 0;
				Сообщить("Вид расчета или вид времени у сотрудника "+СтрокаДвижений.Сотрудник.Наименование+", исключен из доплаты");
			иначе
				
				ЗапросВидРасчета = Новый Запрос;
				ЗапросВидРасчета.Текст = 
				"ВЫБРАТЬ ПЕРВЫЕ 1
				|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
				|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)";
				ВидРасчетаСписок = Новый СписокЗначений;
				ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
				ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
				ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
				ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
				ЗапросВидРасчета.УстановитьПараметр("ВидРасчета",ВидРасчетаСписок);	
				ЗапросВидРасчета.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);
				ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокаДвижений.ПериодРегистрации);
				РезультатВидРасчета = ЗапросВидРасчета.Выполнить().Выгрузить();
				ВидРасчетаМесяца = Неопределено;
				если РезультатВидРасчета.Количество()>0 Тогда 
					ВидРасчетаМесяца = РезультатВидРасчета[0].ВидРасчета;
				КонецЕсли;	
				
				
				
				СообщениеОбОшибке = Ложь;
				Если ВидРасчетаМесяца = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда 
					Норма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодДействияНачало,СтрокаДвижений.Организация);
					НормаВремени = Норма;
					ОтработаноВремениОсновное = ИсходныеДанные.ОтработаноДней;
				иначе
					НормаВремени = ИсходныеДанные.НормаВремениЗаМесяц;
					ОтработаноВремениОсновное = ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВидаРасчета, СообщениеОбОшибке, ГрафикиБезРабочегоВремени);
				КонецЕсли;
				
				Если ИсходныеДанные.РазмерМесячнаяМинимальнаяЗарплата = 0 Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не задан размер часовой минимальной зарплаты");
				ИначеЕсли  ИсходныеДанные.РезультатБаза = NULL Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления ");
				ИначеЕсли СообщениеОбОшибке Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
				ИначеЕсли НормаВремени = 0 Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
				Иначе
					//О.Т. Аверсон 15.02.2018 № 1594
					ЗанимаемыхСтавок = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
					если не ЗанимаемыхСтавок > 0 или  (СтрокаДвижений.Организация.ИНН = "100010315" ИЛИ СтрокаДвижений.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Организация.ИНН = "200400628") Тогда  //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
						ЗанимаемыхСтавок = 1;			
					КонецЕсли;
					//О.Т. Аверсон 15.02.2018 № 1594
					
					
					//О.Т. Аверсон 02.05.2019 № 4298
					ЗапросВВр = Новый Запрос;
					Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда
						ЗапросВВр.Текст =
						"ВЫБРАТЬ
						|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
						|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРабочегоВремени)
						|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
						|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
						|	И ВЫБОР
						|			КОГДА &ФлагПоТабелю
						|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
						|			ИНАЧЕ ИСТИНА
						|		КОНЕЦ";
					иначе
						ЗапросВВр.Текст =
						"ВЫБРАТЬ
						|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
						|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРабочегоВремени)
						|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период2
						|			
						|	И ВЫБОР
						|			КОГДА &ФлагПоТабелю
						|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
						|			ИНАЧЕ ИСТИНА
						|		КОНЕЦ";
					КонецЕсли;
					ВидыВремени = Новый СписокЗначений;
					Для Каждого стрВидыВр из Справочники.ГруппыРасчетов.ДополнительноеВремяПриДоплатеДоМинимальнойЗП.КлассификаторИспользованияРВ Цикл 
						ВидыВремени.Добавить(стрВидыВр.ВидКлассификатора);
					КонецЦикла;
					ЗапросВВр.УстановитьПараметр("ВидИспользованияРабочегоВремени", ВидыВремени);
					ЗапросВВр.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
						ЗапросВВр.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
						ЗапросВВр.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
					ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
						ЗапросВВр.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
						ЗапросВВр.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
					иначе		
						ЗапросВВр.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
						ЗапросВВр.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					КонецЕсли;  
					УчетнаяПолитикаЗапрос = Новый Запрос; //О.Т. 23.12.2014 № 
					УчетнаяПолитикаЗапрос.Текст = 
					"ВЫБРАТЬ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
					|ИЗ
					|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
					|ГДЕ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
					УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
					УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
					если УчетнаяПолитика.Количество()>0 Тогда 
						ЗапросВВр.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
					иначе
						ЗапросВВр.УстановитьПараметр("ФлагПоТабелю",Ложь);
					КонецЕсли;
					
					РезультатВВр = ЗапросВВр.Выполнить().Выбрать();
					ДопВремя = 0;
					Пока РезультатВВр.Следующий() Цикл
						если ВидРасчетаМесяца = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
							ДопВремя = ?(РезультатВВр.Дней=Null,0,РезультатВВр.Дней);
						иначе
							ДопВремя = ?(РезультатВВр.Часов=Null,0,РезультатВВр.Часов);
						КонецЕсли;
					КонецЦикла;   
					//О.Т. Аверсон 02.05.2019 № 4298
					
					
					МесячнаяМинимальнаяЗарплата = ИсходныеДанные.РазмерМесячнаяМинимальнаяЗарплата;
					СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1);
					База =  ИсходныеДанные.РезультатБаза;
					Результат = ЗанимаемыхСтавок*МесячнаяМинимальнаяЗарплата/НормаВремени * (ОтработаноВремениОсновное + ДопВремя) -  База;
					Результат = ?(Результат > 0 ,Результат,0);
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Минимальная зарплата: " + ИсходныеДанные.РазмерМесячнаяМинимальнаяЗарплата, КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Начисленно в месяце: " + База, КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Норма времени за месяц: " + НормаВремени, КомментарийВидаРасчета);
						
					КонецЕсли;
					
				КонецЕсли;
			КонецЕсли;
			
			//+ СВЭЙ КДЯ 09.10.19 СВФР-004842
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоМЗПотСреднегодовойГрафика тогда
			
			ВидРасчетаПрисутствует = ПоискВидаРасчетаПоГруппеРасчета(СтрокаДвижений);
			Если ВидРасчетаПрисутствует Тогда 
				Результат = 0;
				Сообщить("Вид расчета или вид времени у сотрудника "+СтрокаДвижений.Сотрудник.Наименование+", исключен из доплаты");
			иначе
				
				ЗапросВидРасчета = Новый Запрос;
				ЗапросВидРасчета.Текст = 
				"ВЫБРАТЬ ПЕРВЫЕ 1
				|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
				|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)";
				ВидРасчетаСписок = Новый СписокЗначений;
				ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
				ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
				ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
				ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
				ЗапросВидРасчета.УстановитьПараметр("ВидРасчета",ВидРасчетаСписок);	
				ЗапросВидРасчета.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);
				ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокаДвижений.ПериодРегистрации);
				РезультатВидРасчета = ЗапросВидРасчета.Выполнить().Выгрузить();
				ВидРасчетаМесяца = Неопределено;
				если РезультатВидРасчета.Количество()>0 Тогда 
					ВидРасчетаМесяца = РезультатВидРасчета[0].ВидРасчета;
				иначе
					Возврат;
				КонецЕсли;	
				
				
				СреднеГодоваяНормаВремениГрафикаСотрудника = 
				ПрочиеПроцедуры.ПолучитьСреднеГодовуюНормуВремениПоГрафику( СтрокаДвижений.ГрафикРаботы, 
				Перечисления.ВидыУчетаВремени.ПоЧасам, СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.Организация );
				
				СообщениеОбОшибке = Ложь;
				ОтработаноВремениОсновное = ИсходныеДанные.ОтработаноЧасов;
				
				Если ИсходныеДанные.РазмерМесячнаяМинимальнаяЗарплата = 0 Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не задан размер часовой минимальной зарплаты");
				ИначеЕсли  ИсходныеДанные.РезультатБаза = NULL Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не определены базовые начисления ");
				ИначеЕсли СообщениеОбОшибке Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в заданном периоде");
				ИначеЕсли СреднеГодоваяНормаВремениГрафикаСотрудника = 0 Тогда
					ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Нет рабочих дней в графике сотрудника в текущем году");
				Иначе
					//О.Т. Аверсон 15.02.2018 № 1594
					ЗанимаемыхСтавок = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействияНачало,Новый Структура("Сотрудник",СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
					если не ЗанимаемыхСтавок > 0 или  (СтрокаДвижений.Организация.ИНН = "100010315" ИЛИ СтрокаДвижений.Организация.ИНН = "700176068" ИЛИ СтрокаДвижений.Организация.ИНН = "400230097" ИЛИ СтрокаДвижений.Организация.ИНН = "300000265" ИЛИ СтрокаДвижений.Организация.ИНН = "500158130" ИЛИ СтрокаДвижений.Организация.ИНН = "200400628") Тогда //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
						ЗанимаемыхСтавок = 1;			
					КонецЕсли;
					//О.Т. Аверсон 15.02.2018 № 1594
					
					
					//О.Т. Аверсон 02.05.2019 № 4298
					ЗапросВВр = Новый Запрос;
					Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда
						ЗапросВВр.Текст =
						"ВЫБРАТЬ
						|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
						|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРабочегоВремени)
						|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
						|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
						|	И ВЫБОР
						|			КОГДА &ФлагПоТабелю
						|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
						|			ИНАЧЕ ИСТИНА
						|		КОНЕЦ";
					иначе
						ЗапросВВр.Текст =
						"ВЫБРАТЬ
						|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
						|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРабочегоВремени)
						|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период2
						|			
						|	И ВЫБОР
						|			КОГДА &ФлагПоТабелю
						|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
						|			ИНАЧЕ ИСТИНА
						|		КОНЕЦ";
					КонецЕсли;
					ВидыВремени = Новый СписокЗначений;
					Для Каждого стрВидыВр из Справочники.ГруппыРасчетов.ДополнительноеВремяПриДоплатеДоМинимальнойЗП.КлассификаторИспользованияРВ Цикл 
						ВидыВремени.Добавить(стрВидыВр.ВидКлассификатора);
					КонецЦикла;
					ЗапросВВр.УстановитьПараметр("ВидИспользованияРабочегоВремени", ВидыВремени);
					ЗапросВВр.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
						ЗапросВВр.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
						ЗапросВВр.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
					ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
						ЗапросВВр.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
						ЗапросВВр.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
					иначе		
						ЗапросВВр.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
						ЗапросВВр.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					КонецЕсли;  
					УчетнаяПолитикаЗапрос = Новый Запрос; //О.Т. 23.12.2014 № 
					УчетнаяПолитикаЗапрос.Текст = 
					"ВЫБРАТЬ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
					|ИЗ
					|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
					|ГДЕ
					|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
					УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
					УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
					если УчетнаяПолитика.Количество()>0 Тогда 
						ЗапросВВр.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
					иначе
						ЗапросВВр.УстановитьПараметр("ФлагПоТабелю",Ложь);
					КонецЕсли;
					
					РезультатВВр = ЗапросВВр.Выполнить().Выбрать();
					ДопВремя = 0;
					Пока РезультатВВр.Следующий() Цикл
						если ВидРасчетаМесяца = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
							ДопВремя = ?(РезультатВВр.Дней=Null,0,РезультатВВр.Дней);
						иначе
							ДопВремя = ?(РезультатВВр.Часов=Null,0,РезультатВВр.Часов);
						КонецЕсли;
					КонецЦикла;   
					//О.Т. Аверсон 02.05.2019 № 4298
					
					
					МесячнаяМинимальнаяЗарплата = ИсходныеДанные.РазмерМесячнаяМинимальнаяЗарплата;
					СтрокаДвижений.ОплаченоДнейЧасов = ОтработаноВремениОсновное * ?(СтрокаДвижений.Сторно,-1,1);
					База =  ИсходныеДанные.РезультатБаза;
					Результат = ЗанимаемыхСтавок*МесячнаяМинимальнаяЗарплата/СреднеГодоваяНормаВремениГрафикаСотрудника * (ОтработаноВремениОсновное + ДопВремя) -  База;
					Результат = ?(Результат > 0 ,Результат,0);
					Если КомментироватьРасчет Тогда
						ОбщегоНазначения.КомментарийРасчета("Минимальная зарплата: " + ИсходныеДанные.РазмерМесячнаяМинимальнаяЗарплата, КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Начисленно в месяце: " + База, КомментарийВидаРасчета);
						ОбщегоНазначения.КомментарийРасчета("Среднегодовая норма времени по графику сотрудника: " + СреднеГодоваяНормаВремениГрафикаСотрудника, КомментарийВидаРасчета);
						
					КонецЕсли;
					
				КонецЕсли;
			КонецЕсли;
			
			//- СВЭЙ КДЯ 09.10.19 СВФР-004842
			
			
			//О.Т. Аверсон 15.10.2015 № 637	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме Тогда
			СуммаЗаГодСтажа = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.ПериодДействия), 
			Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СуммаЗаГодСтажа)).Размер;
			НормаПоИндивидуальному = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(СтрокаДвижений.ПериодРегистрации,СтрокаДвижений.Сотрудник);
			Если не ЗначениеЗаполнено(НормаПоИндивидуальному.КоличествоЧасов)  Тогда
				
				если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
					НормаВремениПографику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодРегистрации,СтрокаДвижений.Организация);
				Иначе
					НормаВремениПографику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(СтрокаДвижений.ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(СтрокаДвижений.ПериодРегистрации),СтрокаДвижений.Организация);
				КонецЕсли; 
			Иначе
				если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
					НормаВремениПографику = НормаПоИндивидуальному.КоличествоДней;
				Иначе
					НормаВремениПографику = НормаПоИндивидуальному.КоличествоЧасов;
				КонецЕсли;
			КонецЕсли;
			ПолныеГодыПоШкале = 0;
			ЗапросШкала = Новый Запрос;
			ЗапросШкала.Текст = 
			"ВЫБРАТЬ
			
			//Аверсон 05.06.2023 КВВ СВФР-010898 (
			////СВЭЙ 17.07.2020 ПНА СВФР-006251 (
			////|	РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней), &ДатаСравнения, ГОД) КАК СтажМесяцев
			//|	РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней), &ДатаСравнения, МЕСЯЦ) КАК СтажМесяцев
			////СВЭЙ 17.07.2020 ПНА СВФР-006251 )
			
			|РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней), &ДатаСравнения2, МЕСЯЦ) + ВЫБОР
			|КОГДА МЕСЯЦ(&ДатаСравнения2) = МЕСЯЦ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней))
			|ТОГДА (ДЕНЬ(&ДатаСравнения2) - ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней))) / 30
			|ИНАЧЕ 0
			|КОНЕЦ КАК СтажМесяцев
			//Аверсон 05.06.2023 КВВ СВФР-010898 )
			
			|ИЗ
			|	Справочник.ФизическиеЛица.Стажи КАК ФизическиеЛицаСтажи
			|ГДЕ
			|	ФизическиеЛицаСтажи.Ссылка = &ФизЛицо
			|	И ФизическиеЛицаСтажи.ВидСтажа = &ВидСтажа";
			ЗапросШкала.УстановитьПараметр("ВидСтажа",ВидРасчета.ВидСтажа);
			ЗапросШкала.УстановитьПараметр("ФизЛицо",СтрокаДвижений.Сотрудник.ФизЛицо);
			ЗапросШкала.УстановитьПараметр("ДатаСравнения",СтрокаДвижений.ПериодРегистрации);
			
			//Аверсон 06.06.2023 КВВ СВФР-010898 (
			ЗапросШкала.УстановитьПараметр("ДатаСравнения2",СтрокаДвижений.ПериодДействияКонец);
			Если СтрокаДвижений.Организация.ИНН = "100765738"
				И СтрокаДвижений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме 
				И (НачалоМесяца(СтрокаДвижений.ПериодДействияНачало) <> НачалоДня(СтрокаДвижений.ПериодДействияНачало) 
				ИЛИ КонецМесяца(СтрокаДвижений.ПериодДействияКонец) <> КонецДня(СтрокаДвижений.ПериодДействияКонец)) Тогда
				Сообщить("Проверьте расчет стажа: строка № " + СокрЛП(СтрокаДвижений.НомерСтроки));
			КонецЕсли;
			//Аверсон 06.06.2023 КВВ СВФР-010898 )
			
			//СВЭЙ 17.07.2020 ПНА СВФР-006251 (	
			//ПолныеГодыПоШкале = ЗапросШкала.Выполнить().Выгрузить().Итог("СтажМесяцев");
			РезультатЗапроса = ЗапросШкала.Выполнить();
			Если Не РезультатЗапроса.Пустой() Тогда
				ПолныеГодыПоШкале = РезультатЗапроса.Выгрузить().Итог("СтажМесяцев");
				ПолныеГодыПоШкале = Цел(ПолныеГодыПоШкале/12);
			КонецЕсли;
			//СВЭЙ 17.07.2020 ПНА СВФР-006251 )	
			//+ СВЭЙ КДЯ 16.03.20 СВФР-005548 2 часть
			Если ТипЗнч( ИсходныеДанные.Регистратор ) = Тип( "ДокументСсылка.ОплатаЗамещенияСотрудников" ) Тогда
				мОтработаноЧасов = ИсходныеДанные.Регистратор.ОплаченоДнейЧасовШапка;
				
				//Аверсон ЕАЕ 21.10.2025 СВФР-017027
				//Посчитаем норму замещаемого
				Если НЕ ИсходныеДанные.Регистратор.СчитатьПоДолжностнымОкладам Тогда
					ЗамещаемыйСотрудник = ИсходныеДанные.Регистратор.СотрудникЗамещаемый;
					НормаПоИндивидуальному = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(СтрокаДвижений.ПериодРегистрации,ЗамещаемыйСотрудник);
					Если не ЗначениеЗаполнено(НормаПоИндивидуальному.КоличествоЧасов)  Тогда
						//ГрафикЗамещаемогоСотрудника = ПрочиеПроцедуры.ПолучитьГрафикСотрудникаНаДату(ИсходныеДанные.Регистратор.СотрудникЗамещаемый, СтрокаДвижений.ПериодДействияКонец);
						если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
							//НормаВремениПографику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(ГрафикЗамещаемогоСотрудника, Перечисления.ВидыУчетаВремени.ПоДням, СтрокаДвижений.ПериодРегистрации,СтрокаДвижений.Организация);
							НормаВремениЗамещаемого = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуСУчетомИзмененияГрафика(СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец, 
							ЗамещаемыйСотрудник,Ложь,Истина, Ложь, Перечисления.ВидыУчетаВремени.ПоДням);
							НормаВремениПографику = НормаВремениЗамещаемого.НормаЧасов;																							
						Иначе
							//НормаВремениПографику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(ГрафикЗамещаемогоСотрудника, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(СтрокаДвижений.ПериодРегистрации),СтрокаДвижений.Организация);
							НормаВремениЗамещаемого = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуСУчетомИзмененияГрафика(СтрокаДвижений.ПериодДействияНачало, СтрокаДвижений.ПериодДействияКонец, 
							ЗамещаемыйСотрудник,Ложь,Истина, Ложь, Перечисления.ВидыУчетаВремени.ПоЧасам);
							НормаВремениПографику = НормаВремениЗамещаемого.НормаЧасов;																							 
						КонецЕсли; 
					Иначе
						если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
							НормаВремениПографику = НормаПоИндивидуальному.КоличествоДней;
						Иначе
							НормаВремениПографику = НормаПоИндивидуальному.КоличествоЧасов;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				//Аверсон СВФР-017027
				
			КонецЕсли; 
			//- СВЭЙ КДЯ 16.03.20 СВФР-005548 2 часть
			//мОтработаноЧасов
			если не ЗначениеЗаполнено(мОтработаноЧасов) тогда
				мОтработаноЧасов = 0;
			КонецЕсли;
			Попытка 
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(((ПолныеГодыПоШкале-1) * СуммаЗаГодСтажа/НормаВремениПографику*мОтработаноЧасов),Константы.ВалютаРегламентированногоУчета.Получить());//О.Т. Аверсон 14.03.2016 № 949
			Исключение
				Результат = 0;
			КонецПопытки;
			
			//Островская Татьяна 25.03.2013 № 16351	
			Если  СтрокаДвижений.Организация.ИНН = "100765738" Тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте((СтрокаДвижений.Показатель1/100* СуммаЗаГодСтажа/НормаВремениПографику*мОтработаноЧасов),Константы.ВалютаРегламентированногоУчета.Получить());
			КонецЕсли;
			//+ СВЭЙ КДЯ 06.02.20 СВФР-005414
			СтрокаДвижений.Показатель1 = ПолучитьПроцентПоШкалеСтажа( СтрокаДвижений, ПолныеГодыПоШкале );
			//- СВЭЙ КДЯ 06.02.20 СВФР-005414
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1РазрядаПоРаботнику Тогда  //О.Т. Аверсон 07.09.2016 № 1436
			
			ТекущаяТарифнаяСтавка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия, 
			Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
			
			Отбор = Новый Структура;
			Отбор.Вставить("Организация", СтрокаДвижений.Организация);
			Отбор.Вставить("ТарифнаяСтавка",  ТекущаяТарифнаяСтавка);
			
			РазмерТС =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодДействия,Отбор).Размер;
			
			если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(РазмерТС * (СтрокаДвижений[ПоказательРазмер]/100)*СтрокаДвижений.Регистратор.ПроцентОплаты/100,Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т. Аверсон 15.03.2016 № 949
			Иначе
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(РазмерТС * (СтрокаДвижений[ПоказательРазмер]/100),Константы.ВалютаРегламентированногоУчета.Получить()); //О.Т. Аверсон 15.03.2016 № 949
			КонецЕсли;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ВоинскоеЗвание Тогда  //О.Т. Аверсон 18.05.2017 № 592
			
			ТарифнаяСтавка1РазрядаПоУмолчанию = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации, 
			Новый Структура("ТарифнаяСтавка,Организация", Справочники.ТарифныеСтавкиПервогоРазряда.Основная,СтрокаДвижений.Организация)).Размер;
			
			мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.Сотрудник);			
			если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * СтрокаДвижений[ПоказательРазмер]*ИсходныеДанные.ОтработаноДней/мНорма.НормаДней,Константы.ВалютаРегламентированногоУчета.Получить());
			иначе    				
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * СтрокаДвижений[ПоказательРазмер]*ИсходныеДанные.ОтработаноЧасов/мНорма.НормаЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
			КонецЕсли;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.КоэффициентОтБазовогоОкладаОтОтрабВр Тогда  //О.Т. Аверсон 18.05.2017 № 592
			
			ТарифнаяСтавка1РазрядаПоУмолчанию = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации, 
			Новый Структура("ТарифнаяСтавка,Организация", Справочники.ТарифныеСтавкиПервогоРазряда.Основная,СтрокаДвижений.Организация)).Размер;
			
			мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.Сотрудник);			
			если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * СтрокаДвижений[ПоказательРазмер]*ИсходныеДанные.ОтработаноДней/мНорма.НормаДней,Константы.ВалютаРегламентированногоУчета.Получить());
			иначе    				
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * СтрокаДвижений[ПоказательРазмер]*ИсходныеДанные.ОтработаноЧасов/мНорма.НормаЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
			КонецЕсли;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.КоэффициентОтТарифнойСтавки1РазрядаОтОтрабВр Тогда  //О.Т. Аверсон 18.05.2017 № 592
			
			ТарифнаяСтавка1РазрядаПоУмолчанию = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации, 
			Новый Структура("ТарифнаяСтавка,Организация", СтрокаДвижений.ВидРасчета.ТарифнаяСтавка1Разряда,СтрокаДвижений.Организация)).Размер;
			
			
			мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаДвижений.ПериодРегистрации), КонецМесяца(СтрокаДвижений.ПериодРегистрации), СтрокаДвижений.Сотрудник);			
			если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * СтрокаДвижений[ПоказательРазмер]*ИсходныеДанные.ОтработаноДней/мНорма.НормаДней,Константы.ВалютаРегламентированногоУчета.Получить());
			иначе    				
				Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * СтрокаДвижений[ПоказательРазмер]*ИсходныеДанные.ОтработаноЧасов/мНорма.НормаЧасов,Константы.ВалютаРегламентированногоУчета.Получить());
			КонецЕсли;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СуточныйНаряд Тогда  //О.Т. Аверсон 06.06.2017 № 594
			
			ТарифнаяСтавка1РазрядаПоУмолчанию = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации, 
			Новый Структура("ТарифнаяСтавка,Организация", Справочники.ТарифныеСтавкиПервогоРазряда.Основная,СтрокаДвижений.Организация)).Размер;
			
			КоэффСуточныйНаряд = РегистрыСведений.СуточныйНаряд.ПолучитьПоследнее(СтрокаДвижений.ПериодРегистрации,Новый Структура("КоличествоНарядов",СтрокаДвижений[ПоказательРазмер])).Коэффициент; 
			
			Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * КоэффСуточныйНаряд, Константы.ВалютаРегламентированногоУчета.Получить());
			
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МПЕПО Тогда //О.Т. Аверсон 06.06.2017 № 594
			
			//________ способ расчета ВоискоеЗвание___________  
			Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда 
				Если СтрокаДвижений.Организация.ДенежноеДовольствие Тогда //Аверсон 21.04.2022 КВВ СВФР-008937
					ВоинскоеЗвание = РегистрыСведений.ВоинскийУчет.ПолучитьПоследнее(СтрокаДвижений.Регистратор.ДатаПриказа,Новый Структура("ФизЛицо",СтрокаДвижений.ФизЛицо)).Звание; 
					РегистрКоэф = РегистрыСведений.ВоинскиеЗвания.ПолучитьПоследнее(СтрокаДвижений.Регистратор.ДатаПриказа, Новый Структура("ВоинскоеЗвание",ВоинскоеЗвание)).Коэффициент; 
					
					ТарифнаяСтавка1РазрядаПоУмолчанию = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.Регистратор.ДатаПриказа, 
					Новый Структура("ТарифнаяСтавка,Организация", Справочники.ТарифныеСтавкиПервогоРазряда.Основная,СтрокаДвижений.Организация)).Размер;
					
					
					РезультатВоинскоеЗв = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * РегистрКоэф,Константы.ВалютаРегламентированногоУчета.Получить());
					
					
					
					//________ вид расчета Оклад___________
					
					Тариф = 0;
					ЗапросТариф = Новый Запрос;
					ЗапросТариф.Текст = 
					"ВЫБРАТЬ
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|				И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|			ТОГДА НачисленияРаботниковОрганизации.Показатель1Завершения
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
					|	КОНЕЦ КАК Показатель1
					|ИЗ
					|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
					|			&парамНачало,
					|			ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
					|				И Сотрудник = &Сотрудник) КАК НачисленияРаботниковОрганизации
					|ГДЕ
					|	ВЫБОР
					|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|				ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
					|			ИНАЧЕ НачисленияРаботниковОрганизации.Действие
					|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|	И ВЫБОР
					|			КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|					И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|				ТОГДА ВЫБОР
					|						КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|							ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
					|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
					|					КОНЕЦ
					|			ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
					|		КОНЕЦ = &ВидРасчетаОклад";
					
					ЗапросТариф.УстановитьПараметр("ВидРасчетаОклад", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
					ЗапросТариф.УстановитьПараметр("парамНачало", СтрокаДвижений.Регистратор.ДатаПриказа);
					ЗапросТариф.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					
					РезЗапросаТариф = ЗапросТариф.Выполнить().Выбрать();			
					Пока РезЗапросаТариф.Следующий() Цикл
						Тариф = РезЗапросаТариф.Показатель1;
					КонецЦикла;
					
					
					РезультатОклад = ОбщегоНазначения.ОкруглитьПоВалюте(Тариф,Константы.ВалютаРегламентированногоУчета.Получить());
					
					//_________ способ расчета КоэффициентОтБазовогоОкладаОтОтрабВр___________
					
					ТарифнаяСтавка1РазрядаПоУмолчанию = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(СтрокаДвижений.Регистратор.ДатаПриказа, 
					Новый Структура("ТарифнаяСтавка,Организация", Справочники.ТарифныеСтавкиПервогоРазряда.Основная,СтрокаДвижений.Организация)).Размер;
					
					ЗапросТариф.УстановитьПараметр("ВидРасчетаОклад", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Повышение долж;окл;"));
					
					РезЗапросаКоэфТ = ЗапросТариф.Выполнить().Выбрать();
					КоэффициентОтБаз = 0;
					Пока РезЗапросаКоэфТ.Следующий() Цикл 
						КоэффициентОтБаз = РезЗапросаКоэфТ.Показатель1;
					КонецЦикла;
					
					
					РезультатОтБазового = ОбщегоНазначения.ОкруглитьПоВалюте(ТарифнаяСтавка1РазрядаПоУмолчанию * КоэффициентОтБаз,Константы.ВалютаРегламентированногоУчета.Получить());
					
					Если ЗначениеЗаполнено(СтрокаДвижений.Показатель2) Тогда
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте( (РезультатВоинскоеЗв + РезультатОклад + РезультатОтБазового)* СтрокаДвижений[ПоказательРазмер]/ 12 * СтрокаДвижений.Показатель2 ,Константы.ВалютаРегламентированногоУчета.Получить());
					иначе					
						Результат = ОбщегоНазначения.ОкруглитьПоВалюте((РезультатВоинскоеЗв + РезультатОклад + РезультатОтБазового)* СтрокаДвижений[ПоказательРазмер], Константы.ВалютаРегламентированногоУчета.Получить());
					КонецЕсли;
					
					//Аверсон 21.04.2022 КВВ СВФР-008937 (
				Иначе // НЕ Денежное довольствие
					Если Найти(Нрег(СтрокаДвижений.ВидРасчета.Наименование),"оздоровление") > 0 
						ИЛИ Найти(Нрег(СтрокаДвижений.ВидРасчета.Наименование),"помощь") > 0 Тогда
						Результат = СтрокаДВижений.Результат;
					Иначе
						Результат = 0;
					КонецЕсли;
				КонецЕсли;
				//Аверсон 21.04.2022 КВВ СВФР-008937 )
				
			иначе
				Результат = 0;
			КонецЕсли;
			
		//Аверсон ЕАЕ 02.02.2024 СВФР-012141
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтОтработанныхЧасов 
			ИЛИ СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтОтработанныхЧасовЧасоваяТарифнаяСтавка //Аверсон ЕАЕ 07.02.2024 СВФР-012254 Климовичи
			ИЛИ СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтОтработанныхЧасовСтавкаПервогоРазряда Тогда
			Результат = Окр(СтрокаДвижений.Показатель1 * СтрокаДвижений.Показатель2 * СтрокаДвижений.Показатель3 / 100,2);
			СтрокаДвижений.ОплаченоДнейЧасов = СтрокаДвижений.Показатель2;
		//Аверсон СВФР-012141
		
		//Аверсон ЕАЕ 15.05.2024 СВФР-012983
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтФОТРаспределениемСуммы Тогда
		    Регистратор = СтрокаДвижений.Регистратор;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ПремииРаботниковОрганизаций") Тогда
				ОбщийФОТ = ПолучитьОбщийФОТ(Регистратор);
				Если ОбщийФОТ = 0 Тогда
					Результат = 0;
				Иначе
					Если Регистратор.Начисления.Количество() = 1 Тогда
						Результат = Регистратор.СуммаКРаспределению;
					Иначе
						Результат = Окр(СтрокаДвижений.Показатель1 * СтрокаДвижений.Показатель2 / ОбщийФОТ * Регистратор.СуммаКРаспределению,2); 
					КонецЕсли;
				КонецЕсли;	
			Иначе
				Результат = 0;
			КонецЕсли;
		//Аверсон СВФР-012983
		
		Иначе // Не найден способ расчета
			ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": вид расчета не предусмотрен");
		КонецЕсли;
		//О.Т. 30.07.2014 № 135
		Если СтрокаДвижений.Организация.ИНН = "100765738" Тогда //О.Т. Аверсон 13.12.2016 № 100
			Запрос = Новый Запрос;
			Запрос.Текст =
			"ВЫБРАТЬ
			|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
			|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
			|ИЗ
			|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
			|ГДЕ
			|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
			|	И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
			|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени2
			|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени3)
			|	И (РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период И &Период2
			|			ИЛИ &Период МЕЖДУ РабочееВремяРаботниковОрганизаций.ДатаНачала И РабочееВремяРаботниковОрганизаций.ДатаОкончания)
			|	И ВЫБОР
			|			КОГДА &ФлагПоТабелю
			|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
			|			ИНАЧЕ ИСТИНА
			|		КОНЕЦ";
			если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.ПериодДействияНачало);
				Запрос.УстановитьПараметр("Период2", СтрокаДвижений.ПериодДействияКонец);					
			ИначеЕсли ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
				Запрос.УстановитьПараметр("Период", СтрокаДвижений.БазовыйПериодНачало);
				Запрос.УстановитьПараметр("Период2", СтрокаДвижений.БазовыйПериодКонец);
			иначе		
				Запрос.УстановитьПараметр("Период", НачалоМесяца(СтрокаДвижений.ПериодРегистрации));
				Запрос.УстановитьПараметр("Период2", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
			КонецЕсли;
			
		иначе
			Запрос = Новый Запрос;
			Запрос.Текст =
			"ВЫБРАТЬ
			|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
			|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
			|ИЗ
			|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
			|ГДЕ
			|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
			|	И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
			|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени2
			|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени4
			|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени3)
			|	И РабочееВремяРаботниковОрганизаций.Период >= &Период
			|	И РабочееВремяРаботниковОрганизаций.Период <= &Период2
			|	И ВЫБОР
			|			КОГДА &ФлагПоТабелю
			|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
			|			ИНАЧЕ ИСТИНА
			|		КОНЕЦ";   
			Запрос.УстановитьПараметр("Период", ПериодНачало);
			Запрос.УстановитьПараметр("Период2", ПериодКонец);
			
		КонецЕсли;
		Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
		Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
		Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени2", Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
		Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени4", Справочники.КлассификаторИспользованияРабочегоВремени.Командировка);
		Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени3", Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускПоУходуЗаРебенком);
		УчетнаяПолитикаЗапрос = Новый Запрос; //О.Т. 23.12.2014 № 
		УчетнаяПолитикаЗапрос.Текст = 
		"ВЫБРАТЬ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
		|ИЗ
		|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
		|ГДЕ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
		УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",СтрокаДвижений.Организация);
		УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
		если УчетнаяПолитика.Количество()>0 Тогда 
			Запрос.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
		иначе
			Запрос.УстановитьПараметр("ФлагПоТабелю",Ложь);
		КонецЕсли;
		
		Выборка = Запрос.Выполнить().Выбрать();
		
		Пока Выборка.Следующий() цикл
			если  ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням тогда
				мОтработаноЧас = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Часов,0);
				мОтработаноЧасов = ?(ЗначениеЗаполнено(Выборка.Дней),Выборка.Дней,0);
			иначе
				мОтработаноЧас = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Часов,0);
				мОтработаноЧасов = ?(ЗначениеЗаполнено(Выборка.Часов),Выборка.Часов,0); 
			КонецЕсли;
		КонецЦикла;
		//О.Т. 30.07.2014 № 135
		//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
		ЭтоПособие = СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаДетейОт3До18 или  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаВторогоИПоследующихДо3Лет или  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаДо18ЛетНадб40
		или  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаДо3Лет или  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаСтарше3Лет
		или  СтрокаДвижений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей или  СтрокаДвижений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид
		или  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаИнвалида//О.Т. Аверсон 21.07.2017 № 851
		//ПСА 24.02.2021 СВФР-007189+++
		или  СтрокаДвижений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаДетейВВозрастеОт3До18
		или  СтрокаДвижений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет
		или  СтрокаДвижений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида;
		//+++ПСА 24.02.2021 СВФР-007189
		
		//Аверсон ЕАЕ 26.11.2025 СВФР-017026
		ЭтоППСНаРуки = Ложь;
		Если ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") ИЛИ
			ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") Тогда
			ЭтоППСНаРуки = СтрокаДвижений.ВидРасчета.ППСНаРуки;
		КонецЕсли;
		//Аверсон СВФР-017026
		
		если (не ЗначениеЗаполнено(мОтработаноЧас) или не ЗначениеЗаполнено(мОтработаноЧасов)) и ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") 
			//(начало) добавлено Кухарчуком Д.Я. 22.12.18, Задача СВФР-002938, Аверсон-Софт
			и не СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой
			и не СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы
			и не СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом
			//(конец) добавлено Кухарчуком Д.Я. 22.12.18, Задача СВФР-002938, Аверсон-Софт
			
			//Аверсон ЕАЕ 02.09.2024 СВФР-013681
			И НЕ ТипЗнч(СтрокаДвижений.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций")
			//Аверсон СВФР-013681
			
			//Аверсон ЕАЕ 03.11.2025 СВФР-017026
			
			//Аверсон ЕАЕ 26.11.2025 СВФР-017026
			//И НЕ СтрокаДвижений.ВидРасчета.ППСНаРуки
			И НЕ ЭтоППСНаРуки
			//Аверсон СВФР-017026
			
			//Аверсон СВФР-017026
			
			и не СтрокаДвижений.Сотрудник.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда и не ЭтоПособие и не РегламентированныеУдержания тогда // О.Т. 20.11.2014 288
			Результат = 0;
		КонецЕсли;
		//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
		
		Если СтрокаДвижений.Сторно Тогда
			СтрокаДвижений.Результат = Результат * -1;
			Если КомментироватьРасчет Тогда
				ОбщегоНазначения.КомментарийРасчета("Расчет сторно", КомментарийВидаРасчета, , , Перечисления.ВидыСообщений.ВажнаяИнформация);
			КонецЕсли;
		Иначе
			Если не (ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") и СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные) //О.Т. Аверсон 01.02.2017 № 235
				И НЕ (ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.ОплатаСовмещенияСотрудников") И СтрокаДвижений.Регистратор.Обучение) Тогда  //Аверсон 09.07.2020 КВВ СВФР-006236
				//Аверсон ПСА 07.08.2024 СВФР-013512 +++	
				Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту")
					и СтрокаДвижений.Регистратор.ТипРасчета = перечисления.ТипРасчетаБЛ.МЗП Тогда
					КоэффициентГрафикаРаботы = 1;
					Если ТИпЗНЧ(СтрокаДвижений.ГрафикРаботы) = Тип("СправочникСсылка.ГрафикиРаботы")
						и ЗначениеЗаполнено(СтрокаДвижений.ГрафикРаботы)
						и значениеЗаполнено(СтрокаДвижений.ГрафикРаботы.ГрафикПолногоРабочегоВремени) 
						И СтрокаДвижений.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели <> 0 
						и ЗанимаемаяСтавка = 1 Тогда // применяем только если ставка не 1
						КоэффициентГрафикаРаботы = СтрокаДвижений.ГрафикРаботы.ДлительностьРабочейНедели /СтрокаДвижений.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели;
					КонецЕсли;	
					СтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Результат*КоэффициентГрафикаРаботы,Константы.ВалютаРегламентированногоУчета.Получить());	
				Иначе
				//+++ Аверсон ПСА 07.08.2024 СВФР-013512					
					СтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(Результат,Константы.ВалютаРегламентированногоУчета.Получить());   
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		Если КомментироватьРасчет Тогда
			ОбщегоНазначения.КомментарийРасчета("Результат расчета: " + СтрокаДвижений.Результат, КомментарийВидаРасчета);
		КонецЕсли;
		//Аверсон 15.11.2019 КВВ СВФР-005009 (
	Иначе
		Если ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") И СтрокаДвижений.Сторно И ЗначениеЗаполнено(ИсходныеДанные.Регистратор.ПерерассчитываемыйДокумент) И РегламентированныеУдержания Тогда
			СтрокаДвижений.Результат = 0;
		КонецЕсли;
		//Аверсон 15.11.2019 КВВ СВФР-005009 )
	КонецЕсли;
	
	// финальные действия для поддержки 
	// способа расчета ДоначислениеПоУправленческомуУчету
	Если РегламентированныеНачисления и СведенияОДоначислениях <> Неопределено Тогда
		Если РасчетДоначисления Тогда
			СтрокаПрогноза.НачисленоПриДоначислении = СтрокаДвижений.Результат;
			//СтрокаПрогноза.НачисленоДоДоначисления = СтрокаПрогноза.НачисленоДоДоначисления + СтрокаДвижений.Результат;
			СтрокаПрогноза.НачисленоПослеДоначисления = 0;
		ИначеЕсли Сведение.ЕстьДоначисление Тогда
			СтрокаПрогноза.НачисленоПослеДоначисления = СтрокаПрогноза.НачисленоПослеДоначисления + СтрокаДвижений.Результат;
		ИначеЕсли не ПовторныйРасчет Тогда
			СтрокаПрогноза.НачисленоДоДоначисления = СтрокаПрогноза.НачисленоДоДоначисления + СтрокаДвижений.Результат;
		КонецЕсли;
	КонецЕсли;
	//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
	
	если ( не ЗначениеЗаполнено(мОтработаноЧас) или не ЗначениеЗаполнено(мОтработаноЧасов) ) 
		//(начало) добавлено Кухарчуком Д.Я. 22.12.18, Задача СВФР-002938, Аверсон-Софт
		и не СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой  
		//(конец) добавлено Кухарчуком Д.Я. 22.12.18, Задача СВФР-002938, Аверсон-Софт
		и ТипЗнч(СтрокаДвижений.Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") тогда 
		
		Результат = 0;
		Если (ОсновныеНачисленияОрганизаций ИЛИ ДополнительныеНачисленияОрганизаций) И СтрокаДвижений.Авторасчет Тогда
			СтрокаДвижений.ОплаченоДнейЧасов = 0;
			если не ДополнительныеНачисленияОрганизаций тогда
				СтрокаДвижений.ОплаченоДней = 0;
				
				СтрокаДвижений.ОтработаноДней = 0;
				
				СтрокаДвижений.ОтработаноЧасов = 0; 
			КонецЕсли;
		КонецЕсли;			
		
	КонецЕсли;
	
	//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
	
	
КонецПроцедуры  // РассчитатьЗаписьРегистраРасчета

//Аверсон ЕАЕ 11.11.2024 СВФР-014078
Функция БылиЧасыРемонта(Сотр, ПериодРегистрации)
	Были = Ложь;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник,
		|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ЧасовОборот) КАК Часов
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций.Обороты(
		|			&Нач,
		|			&Кон,
		|			Авто,
		|			Сотрудник = &Сотр
		|				И ВидИспользованияРабочегоВремени = &ВидВрРемонт) КАК РабочееВремяРаботниковОрганизацийОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник";
	
	Запрос.УстановитьПараметр("ВидВрРемонт", Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт);
	Запрос.УстановитьПараметр("Кон", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("Нач", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("Сотр", Сотр);
	
	РезультатЗапроса = Запрос.Выполнить();
	Если Не РезультатЗапроса.Пустой() Тогда
		Выборка = РезультатЗапроса.Выбрать();
		Если Выборка.Следующий() Тогда
			Если Выборка.Часов > 0 Тогда
				Были = Истина;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;

	Возврат Были;
КонецФункции
//Аверсон СВФР-014078

//Аверсон ЕАЕ 06.03.2022 СВФР-008826
Функция ЕстьОплатаПоСреднему(Дат, ТЗПериодыОплатаПоСреднему)
	Есть = Ложь;
	Для Каждого Стр Из ТЗПериодыОплатаПоСреднему Цикл
		Если Дат >= Стр.ДатаНачала И Дат <= Стр.ДатаОкончания Тогда
			Есть = Истина;
			Прервать;
		КонецЕсли;
	КонецЦикла;
	Возврат Есть;
КонецФункции
//Аверсон СВФР-008826

//Аверсон ЕАЕ 11.06.2021 СВФР-007703
Функция ЭтоРабочийСоСдельнойОплатой(Сотр, НаДату) Экспорт
	РабочийСоСдельнойОтплатой = Ложь;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	РаботникиОрганизацийСрезПоследних.Должность,
	|	РаботникиОрганизацийСрезПоследних.Должность.Категория КАК Категория
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НаДату, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних
	|ГДЕ
	|	РаботникиОрганизацийСрезПоследних.Должность.Категория В(&СписокКатегорий)
	|	И РаботникиОрганизацийСрезПоследних.Должность.СдельнаяОплата = ИСТИНА";
	
	Запрос.УстановитьПараметр("НаДату", НаДату);
	Запрос.УстановитьПараметр("Сотрудник", Сотр);
	СписокКатегорий = Новый Массив;
	СписокКатегорий.Добавить(Справочники.КатегорииРаботников.РабочиеВспомогательные);
	СписокКатегорий.Добавить(Справочники.КатегорииРаботников.РабочиеОсновные);
	Запрос.УстановитьПараметр("СписокКатегорий", СписокКатегорий);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если Не РезультатЗапроса.Пустой() Тогда
		РабочийСоСдельнойОтплатой = Истина;
	КонецЕсли;
	
	Возврат РабочийСоСдельнойОтплатой;
КонецФункции
//Аверсон СВФР-007703

//Аверсон ЕАЕ 26.03.2021 СВФР-007329
Функция РассчитатьРезультатОтОкладаОтпуск(Док, ДатаНач, ДатаКон, ЭтоПерерасчет, ОтработаноДнейЧасов) //Аверсон ЕАЕ 07.02.2022 СВФР-008641 параметр ОтработаноДнейЧасов
	Рез = 0;
	ИтогоСум = 0;
	
	//Аверсон ЕАЕ 07.02.2022 СВФР-008641
	ОтработаноДнейЧасов = Новый Структура;
	ОтработаноДнейЧасов.Вставить("ОтработаноДней");
	ОтработаноДнейЧасов.Вставить("ОтработаноЧасов");
	//Аверсон СВФР-008641
	
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.ДатаНачала,
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.ДатаОкончания,
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.РазмерСреднегоЗаработка,
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.Ссылка.ПроцентОплаты КАК ПроцентОплаты,
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.Ссылка.КоэффициентОтпуска КАК КоэффициентОтпуска,
	
	//Аверсон ЕАЕ 29.06.2021 СВФР-007787
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.Ссылка.ВидДней КАК ВидДней,
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.Ссылка.Сотрудник КАК Сотрудник,
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.Ссылка.Организация КАК Организация,
	//Аверсон СВФР-007787
	|	
	//Аверсон ЕАЕ 25.01.2022 СВФР-008641
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.Ссылка.Организация.ИНН КАК ИННОрганизации
	//Аверсон СВФР-008641
	
	|ИЗ
	|	Документ.НачислениеОтпускаРаботникамОрганизаций.РасчетСреднегоПоОкладу КАК НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу
	|ГДЕ
	|	НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.Ссылка = &Ссылка
	|	И НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.ДатаНачала >= &ДатаНачалаОтп
	|	И НачислениеОтпускаРаботникамОрганизацийРасчетСреднегоПоОкладу.ДатаОкончания <= &ДатаОкончанияОтп";
	
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("Ссылка", Док);
	Запрос.УстановитьПараметр("ДатаНачалаОтп", ДатаНач);
	Запрос.УстановитьПараметр("ДатаОкончанияОтп", ДатаКон);
	
	Результат = Запрос.Выполнить();
	Если Не Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Пока Выборка.Следующий() Цикл
			РазмерСреднего = Выборка.РазмерСреднегоЗаработка;
			ПроцентОплаты = Выборка.ПроцентОплаты;
			Нач = Выборка.ДатаНачала;
			Кон = Выборка.ДатаОкончания;
			КоэффициентОтпуска = Выборка.КоэффициентОтпуска;
			
			//Аверсон ЕАЕ 29.06.2021 СВФР-007787
			//ОтрДней = ПрочиеПроцедуры.РассчитатьКоличествоДнейОтпуска(Нач, Кон);
			Если Выборка.ВидДней = 0 Тогда //Календарные
				ОтрДней = ПрочиеПроцедуры.РассчитатьКоличествоДнейОтпуска(Нач, Кон);
				
				//Аверсон ЕАЕ 07.02.2022 СВФР-008641
				ОтрДнейФакт = ОтрДней;
				ОтрЧасовФакт = ОтрДней * 8;
				//ОтрДнейНорма = ОтрДней;
				//ОтрЧасовНорма = ОтрДней * 8;
				ОтрВремя = ОтрДнейФакт
				//Аверсон СВФР-008641
				
			Иначе //Рабочие
				//Аверсон ЕАЕ 25.01.2022 СВФР-008641
				Если Выборка.ИННОрганизации = "100010315" ИЛИ Выборка.ИННОрганизации = "700176068" ИЛИ Выборка.ИННОрганизации = "400230097" ИЛИ Выборка.ИННОрганизации = "300000265"  ИЛИ Выборка.ИННОрганизации = "500158130" ИЛИ Выборка.ИННОрганизации = "200400628" Тогда
					Если ПрочиеПроцедуры.СотрудникРаботаетПоЧасовомуТарифу(Выборка.Сотрудник, Выборка.Организация, ДатаНач, 0) Тогда
						ДанныеИндГрафика = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальномуЗаИнтервал(Нач,Кон,Выборка.Сотрудник);
						
						//Аверсон ЕАЕ 07.02.2022 СВФР-008641
						//ОтрДней = ДанныеИндГрафика.КоличествоЧасов; //это часы
						ОтрДнейФакт = ДанныеИндГрафика.КоличествоДней; 
						ОтрЧасовФакт = ДанныеИндГрафика.КоличествоЧасов; //это часы
						//ОтрДнейНорма = ДанныеИндГрафика.КоличествоДней; 
						//ОтрЧасовНорма = ДанныеИндГрафика.КоличествоЧасов; //это часы
						//Аверсон СВФР-008641
						
						ЕстьГрафик = ДанныеИндГрафика.ЕстьГрафик;
						Если Не ЕстьГрафик Тогда
							ГрафикРаботы = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Макс((Док.ДатаНачалаОсновногоОтпуска),Док.ПериодРегистрации),Новый Структура("Сотрудник", Выборка.Сотрудник)).ГрафикРаботы;
							//Если ГрафикРаботы.СокращенноеРабочееВремя Тогда
							//	ГрафикРаботы = ГрафикРаботы.ГрафикПолногоРабочегоВремени;
							//КонецЕсли;
							
							//Аверсон ЕАЕ 07.02.2022 СВФР-008641
							//ОтрДней = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, Нач, Кон, Выборка.Организация); //это часы
							//ОтрДнейФакт = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, Нач, Кон, Выборка.Организация);
							//ОтрЧасовФакт = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, Нач, Кон, Выборка.Организация); //это часы
							ОтрДнейФакт = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(Нач, Кон, ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, Истина);
							ОтрЧасовФакт = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(Нач, Кон, ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, Истина);; //это часы
							//ОтрДнейНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, Нач, Кон, Выборка.Организация);
							//ОтрЧасовНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, Нач, Кон, Выборка.Организация); //это часы
							//Аверсон СВФР-008641
							
						КонецЕсли;
						
						//Аверсон ЕАЕ 07.02.2022 СВФР-008641
						ОтрВремя = ОтрЧасовФакт;
						//Аверсон СВФР-008641
					Иначе
						ДанныеИндГрафика = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальномуЗаИнтервал(Нач,Кон,Выборка.Сотрудник);
						//ОтрДней = ДанныеИндГрафика.КоличествоДней;
						
						//Аверсон ЕАЕ 07.02.2022 СВФР-008641
						ОтрДнейФакт = ДанныеИндГрафика.КоличествоДней;
						ОтрЧасовФакт = ДанныеИндГрафика.КоличествоЧасов;
						//ОтрДнейНорма = ДанныеИндГрафика.КоличествоДней;
						//ОтрЧасовНорма = ДанныеИндГрафика.КоличествоЧасов;
						//Аверсон СВФР-008641
						
						ЕстьГрафик = ДанныеИндГрафика.ЕстьГрафик;
						Если Не ЕстьГрафик Тогда
							ГрафикРаботы = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Макс((Док.ДатаНачалаОсновногоОтпуска),Док.ПериодРегистрации),Новый Структура("Сотрудник", Выборка.Сотрудник)).ГрафикРаботы;
							//Если ГрафикРаботы.СокращенноеРабочееВремя Тогда
							//	ГрафикРаботы = ГрафикРаботы.ГрафикПолногоРабочегоВремени;
							//КонецЕсли;
							//ОтрДней = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, Нач, Кон, Выборка.Организация);
							
							//Аверсон ЕАЕ 07.02.2022
							//ОтрДнейФакт = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, Нач, Кон, Выборка.Организация);
							//ОтрЧасовФакт = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, Нач, Кон, Выборка.Организация);
							ОтрДнейФакт = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(Нач, Кон, ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, Истина);
							ОтрЧасовФакт = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(Нач, Кон, ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, Истина);; //это часы
							//ОтрДнейНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоДням, Нач, Кон, Выборка.Организация);
							//ОтрЧасовНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, Нач, Кон, Выборка.Организация);
							//Аверсон 
							
						КонецЕсли;
						
						//Аверсон ЕАЕ 07.02.2022 СВФР-008641
						ОтрВремя = ОтрДнейФакт;
						//Аверсон СВФР-008641
						
					КонецЕсли;
				Иначе
					//Аверсон СВФР-008641
					//ОтрДней = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(Выборка.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Нач, Кон, Выборка.Организация);
					
					//Аверсон ЕАЕ 07.02.2022 СВФР-008641
					//ОтрДнейФакт = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(Выборка.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Нач, Кон, Выборка.Организация);
					//ОтрЧасовФакт = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(Выборка.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Нач, Кон, Выборка.Организация);
					ОтрДнейФакт = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(Нач, Кон, Выборка.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням);
					ОтрЧасовФакт = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(Нач, Кон, Выборка.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам);
					//ОтрДнейНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(Выборка.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Нач, Кон, Выборка.Организация);
					//ОтрЧасовНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(Выборка.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Нач, Кон, Выборка.Организация);
					
					ОтрВремя = ОтрДнейФакт;
					//Аверсон СВФР-008641
				КонецЕсли;
			КонецЕсли;
			//Аверсон СВФР-007787
			
			Если ЭтоПерерасчет Тогда
				//Аверсон ЕАЕ 07.02.2022 СВФР-008641
				//Сум = РазмерСреднего * ОтрДней * ПроцентОплаты / 100 * ?(КоэффициентОтпуска = 0, 1, КоэффициентОтпуска);
				Сум = РазмерСреднего * ОтрВремя * ПроцентОплаты / 100 * ?(КоэффициентОтпуска = 0, 1, КоэффициентОтпуска);
				//Аверсон СВФР-008641
			Иначе
				//Аверсон ЕАЕ 07.02.2022 СВФР-008641
				//Сум = РазмерСреднего * ОтрДней * ПроцентОплаты / 100;
				Сум = РазмерСреднего * ОтрВремя * ПроцентОплаты / 100;
				//Аверсон СВФР-008641
			КонецЕсли;
			
			ИтогоСум = ИтогоСум + Сум;
		КонецЦикла;
	КонецЕсли;
	Рез = ИтогоСум;
	
	//Аверсон ЕАЕ 07.02.2022 СВФР-008641
	ОтработаноДнейЧасов.ОтработаноДней = ОтрДнейФакт;
	ОтработаноДнейЧасов.ОтработаноЧасов = ОтрЧасовФакт;
	//Аверсон СВФР-008641
	
	Возврат Рез;
КонецФункции
//Аверсон СВФР-007329

// Функция предназначена для получения структуры НеобходимыеДанные с элементами:
//			База
//			НормаВремени
//			ОтработаноВремени
// каждый из которых - булево и означает необходимость получения соотвю исходных данных для 
// расчета записей регистра расчета
// Параметр:
//	МассивСпособовРасчета - массив элементов типа СпособРасчетаСсылка или ПланВидовРасчетаСсылка
Функция ПолучитьСтруктуруНеобходимыхДанных(МассивСпособовРасчета, МассивПоказателей) Экспорт
	
	НеобходимыеДанные = Новый Структура;
	НеобходимыеДанные.Вставить("База", Ложь);
	НеобходимыеДанные.Вставить("НормаВремени", Ложь);
	НеобходимыеДанные.Вставить("НормаВремениЗаМесяц", Ложь);
	
	//+ СВЭЙ КДЯ 09.10.19 СВФР-004842
	НеобходимыеДанные.Вставить( "СреднеГодоваяНормаВремениГрафикаСотрудника", Ложь );
	//- СВЭЙ КДЯ 09.10.19 СВФР-004842
	
	НеобходимыеДанные.Вставить("ОтработаноВремени", Ложь);
	НеобходимыеДанные.Вставить("СдельныйЗаработок", Ложь);
	
	НеобходимыеДанные.Вставить("СреднийЗаработок", Ложь);
	НеобходимыеДанные.Вставить("СреднийЗаработокОтпуска", Ложь);
	НеобходимыеДанные.Вставить("СреднийЗаработокПособий", Ложь);
	НеобходимыеДанные.Вставить("КалендарныеДниПособия", Ложь);
	НеобходимыеДанные.Вставить("ИсчисленныйНДФЛ", Ложь);
	НеобходимыеДанные.Вставить("ВычетыКДоходамНДФЛ", Ложь);
	НеобходимыеДанные.Вставить("ПределПоДокументуОснованию", Ложь);
	НеобходимыеДанные.Вставить("НакопленныеДанныеПоДокументуОснованию", Ложь);
	
	
	НеобходимыеДанные.Вставить("РайонныйКоэффициентРФОрганизации", Ложь);
	НеобходимыеДанные.Вставить("ПочтовыеПереводы", Ложь);
	НеобходимыеДанные.Вставить("РазмерОграниченияПособия", Ложь);
	НеобходимыеДанные.Вставить("ДанныеДляПрогнозаНДФЛ", Ложь);
	НеобходимыеДанные.Вставить("ПоказателиСхемМотивации", Ложь);
	НеобходимыеДанные.Вставить("Стаж", Ложь);
	НеобходимыеДанные.Вставить("ВремяВКалендарныхДнях", Ложь);
	НеобходимыеДанные.Вставить("КалендарныхДнейВмесяце", Ложь);
	НеобходимыеДанные.Вставить("ВсегоОтработаноВремени", Ложь);
	
	//РБ
	НеобходимыеДанные.Вставить("МесячнаяТарифнаяСтавка", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНаРебенкаДо3Лет", Ложь);
	//О.Т. Аверсон 21.07.2017 № 851
	НеобходимыеДанные.Вставить("РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемей", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид", Ложь);
	//О.Т. Аверсон 21.07.2017 № 851
	
	//О.Т. 27.01.2015 № 17821
	НеобходимыеДанные.Вставить("РазмерПособияНаДетейОт3До18Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНа2ИПоследующихДетейДо3Лет", Ложь);
	//О.Т. 27.01.2015 № 17821
	НеобходимыеДанные.Вставить("РазмерПособияМатериОдиночкеДо1_5Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияМатериОдиночкеДо3Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНаРебенкаСНадбавкой40До3Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНеРаботающейМатериДо3Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНеРабМатериОдиночкеДо1_5Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНеРабМатериОдиночкеДо3Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособиянеРабМатериНадб40До3Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНаРебенкаСтарше3Лет", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНаРебенкаДо18ЛетНадб40", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНаРебенкаИнвалида", Ложь);
	НеобходимыеДанные.Вставить("РазмерПособияНаРебенкаВИЧ", Ложь);
	НеобходимыеДанные.Вставить("ТарифнаяСтавка1Разряда", Ложь);//Островская Татьяна 18.02.2014 № 17126
	НеобходимыеДанные.Вставить("РазмерЧасоваяМинимальнаяЗарплата", Ложь); //О.Т. Аверсон 15.10.2015 № 637
	НеобходимыеДанные.Вставить("РазмерМесячнаяМинимальнаяЗарплата", Ложь);//О.Т. Аверсон 15.10.2015 № 637
	
	// данный Если... необходимо пополнять при появлении новых способ расчета или
	// видов расчета, которые не укладываются ни в один из способов
	Для Каждого СпособРасчета Из МассивСпособовРасчета Цикл
		Если 	
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам ИЛИ 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням ИЛИ
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксСуммойПропорционльноОтработанномуВремени ИЛИ
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам ИЛИ 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням ИЛИ
			//Островская Татьяна 20.03.2013 № 16341
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаЗаместительство ИЛИ
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоОкладу ИЛИ
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоТарифу ИЛИ
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.РазницаВОкладах ИЛИ //О.Т. Аверсон 26.10.2017 № 1158
			
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаИзБюджета //О.Т. Аверсон 04.11.2016 № 1501
			//Островская Татьяна 20.03.2013 № 16341
			или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ВоинскоеЗвание //О.Т. Аверсон 19.05.2017 № 952
			или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.КоэффициентОтБазовогоОкладаОтОтрабВр //О.Т. Аверсон 19.05.2017 № 952
			или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.КоэффициентОтТарифнойСтавки1РазрядаОтОтрабВр //О.Т. Аверсон 19.05.2017 № 952
			Тогда
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.НормаВремениЗаМесяц = Истина;
		ИначеЕсли 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке или
			//Толик
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезКонтракта или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиПоИнструкции или //О.Т. Аверсон 04.04.2016 № 981
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Питание или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Разъездные или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаБригаду или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредность или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредностьОтОтработанногоВремени или //О.Т. Аверсон 02.04.2016 № 972
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке4Разряда или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПрямойСдельныйЗаработок или
			//КонецТолик
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф или //О.Т. Аверсон 03.04.2016 № 981
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр или //О.Т. Аверсон 03.04.2016 № 981
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой //О.Т. 22.05.2015 №  
			Тогда
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.МесячнаяТарифнаяСтавка = Истина;
			Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке Тогда
				НеобходимыеДанные.СдельныйЗаработок = Истина;
			КонецЕсли;
			//Островская Татьяна 20.03.2013 № 16341
		ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоОкладу тогда
			НеобходимыеДанные.НормаВремениЗаМесяц = Истина;
			НеобходимыеДанные.НормаВремени = Истина;
		ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоТарифу тогда
			НеобходимыеДанные.НормаВремени = Истина;
			//Островская Татьяна 20.03.2013 № 16341
			//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом
			или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы 
			//заявка №1676 (база заявок Кристалла) Дмитрук О.Г.
			Или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеФиксированнойСуммойОтБазы
			или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП Тогда //О.Т. Аверсон 04.11.2016 № 1501
			//заявка №1676
			
			НеобходимыеДанные.База = Истина;
			Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП 
				//+ СВЭЙ КДЯ 03.12.19 СВФР-005157 
				ИЛИ СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом
				ИЛИ СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы 
				//- СВЭЙ КДЯ 03.12.19 СВФР-005157
				Тогда  
				НеобходимыеДанные.ОтработаноВремени = Истина;
				НеобходимыеДанные.НормаВремениЗаМесяц = Истина;
			КонецЕсли;                                                                      
			
		ИначеЕсли 	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ
			или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой Тогда //О.Т. Аверсон 24.05.2017 № 665
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.ИсчисленныйНДФЛ = Истина;
			НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию = Истина;
		ИначеЕсли 	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ Тогда
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию = Истина;
		ИначеЕсли 	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела
			или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой Тогда //О.Т. Аверсон 24.05.2017 № 665
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.ИсчисленныйНДФЛ = Истина;
			НеобходимыеДанные.ПределПоДокументуОснованию = Истина;
			НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию = Истина;
		ИначеЕсли 	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПределаСНДФЛ Тогда
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.ПределПоДокументуОснованию = Истина;
			НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию = Истина;
		ИначеЕсли 	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела Тогда
			НеобходимыеДанные.ПределПоДокументуОснованию = Истина;
			НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию = Истина;
		ИначеЕсли 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку  Тогда
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.СреднийЗаработок = Истина;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС  Тогда
			
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.РазмерОграниченияПособия = Истина;
			НеобходимыеДанные.НормаВремениЗаМесяц = Истина;
			НеобходимыеДанные.СреднийЗаработок = Истина;
			НеобходимыеДанные.СреднийЗаработокПособий = Истина;
			НеобходимыеДанные.КалендарныеДниПособия = Истина;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка Тогда
			
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.СреднийЗаработок = Истина;
			
		ИначеЕсли
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ИЛИ 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке Тогда
			
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.СреднийЗаработокОтпуска = Истина;
			НеобходимыеДанные.СреднийЗаработок = Истина; 
		ИначеЕсли 	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МПЕПО Тогда //О.Т. Аверсон 06.06.2017 № 594
			//НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.НормаВремениЗаМесяц = Истина;
			НеобходимыеДанные.НормаВремени = Истина;
			
		ИначеЕсли
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой 
			Тогда
			// ничего...
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеФиксированнойСуммой Тогда
			НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию = Истина;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет Тогда
			НеобходимыеДанные.РазмерПособияНаРебенкаДо3Лет = Истина;
			//О.Т. 27.01.2015 № 17821
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаДетейВВозрастеОт3До18 Тогда
			НеобходимыеДанные.РазмерПособияНаДетейОт3До18Лет = Истина;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаВторогоИПоследующихДо3Лет Тогда
			НеобходимыеДанные.РазмерПособияНа2ИПоследующихДетейДо3Лет = Истина;
			//О.Т. 27.01.2015 № 17821
			//О.Т. Аверсон 21.07.2017 № 851
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей Тогда
			НеобходимыеДанные.РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемей = Истина;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид Тогда
			НеобходимыеДанные.РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид = Истина;
			
			//О.Т. Аверсон 21.07.2017 № 851
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо1_5Лет Тогда
			НеобходимыеДанные.РазмерПособияМатериОдиночкеДо1_5Лет = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо3Лет Тогда
			НеобходимыеДанные.РазмерПособияМатериОдиночкеДо3Лет = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСНадбавкой40До3Лет Тогда
			НеобходимыеДанные.РазмерПособияНаРебенкаСНадбавкой40До3Лет = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРаботающейМатериДо3Лет Тогда
			НеобходимыеДанные.РазмерПособияНеРаботающейМатериДо3Лет = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо1_5Лет Тогда
			НеобходимыеДанные.РазмерПособияНеРабМатериОдиночкеДо1_5Лет = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо3Лет Тогда
			НеобходимыеДанные.РазмерПособияНеРабМатериОдиночкеДо3Лет = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериНадб40До3Лет Тогда
			НеобходимыеДанные.РазмерПособияНеРабМатериНадб40До3Лет = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСтарше3Лет Тогда
			НеобходимыеДанные.РазмерПособияНаРебенкаСтарше3Лет = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо18ЛетНадб40 Тогда
			НеобходимыеДанные.РазмерПособияНаРебенкаДо18ЛетНадб40 = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида Тогда
			НеобходимыеДанные.РазмерПособияНаРебенкаИнвалида = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаВИЧ Тогда
			НеобходимыеДанные.РазмерПособияНаРебенкаВИЧ = Истина;	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок Тогда
			НеобходимыеДанные.СдельныйЗаработок = Истина;
			
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СдельныйПриработок или
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СделкаПоЧасовойТарифнойСтавке Тогда
			НеобходимыеДанные.СдельныйЗаработок = Истина;
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.МесячнаяТарифнаяСтавка = Истина;
			//О.Т. Аверсон 02.11.2017 № 1183
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПогрузочноРазгрузочныеРаботы Тогда
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.МесячнаяТарифнаяСтавка = Истина;
			//О.Т. Аверсон 02.11.2017 № 1183		
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроизвольнаяФормула Тогда
			НеобходимыеДанные.ПоказателиСхемМотивации = Истина;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПочтовыйСбор Тогда
			НеобходимыеДанные.ПочтовыеПереводы = Истина
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету Тогда
			НеобходимыеДанные.ДанныеДляПрогнозаНДФЛ = Истина;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом или 
			СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме  Тогда //Островская Татьяна 25.03.2013 № 16351
			НеобходимыеДанные.База = Истина;
			//+ СВЭЙ КДЯ 03.12.19 СВФР-005157 
			Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом Тогда  
				НеобходимыеДанные.ОтработаноВремени = Истина;
				НеобходимыеДанные.НормаВремениЗаМесяц = Истина;
			КонецЕсли;                                                                      
			//- СВЭЙ КДЯ 03.12.19 СВФР-005157
			
			//Аверсон 10.02.2023 КВВ СВФР-010320 (	
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплатыИнвалидам1и2гр Тогда
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.РазмерЧасоваяМинимальнаяЗарплата = Истина;
			//Аверсон 10.02.2023 КВВ СВФР-010320 )
			
			//О.Т. Аверсон 15.10.2015 № 637
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты Тогда
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.РазмерЧасоваяМинимальнаяЗарплата = Истина;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМЗПотМесячнойМЗП Тогда
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.РазмерМесячнаяМинимальнаяЗарплата = Истина;
			НеобходимыеДанные.НормаВремениЗаМесяц = Истина;
			
			//+ СВЭЙ КДЯ 09.10.19 СВФР-004842
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоМЗПотСреднегодовойГрафика Тогда
			НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.ОтработаноВремени = Истина;
			НеобходимыеДанные.РазмерМесячнаяМинимальнаяЗарплата = Истина;
			НеобходимыеДанные.СреднеГодоваяНормаВремениГрафикаСотрудника = Истина;
			//- СВЭЙ КДЯ 09.10.19 СВФР-004842
			
		//Аверсон ЕАЕ 15.05.2024 СВФР-012983
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтФОТРаспределениемСуммы Тогда
		    НеобходимыеДанные.База = Истина;
			НеобходимыеДанные.Стаж = Истина;
		//Аверсон СВФР-012983
		
		КонецЕсли;
		//О.Т. Аверсон 15.10.2015 № 637
		
		//Островская Татьяна 16.04.2013 № 16341
		Если  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоОкладу 
			или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоТарифу тогда
			НеобходимыеДанные.НормаВремениЗаМесяц = Истина;
			НеобходимыеДанные.НормаВремени = Истина;
		КонецЕсли;	
		//Островская Татьяна 16.04.2013 № 16341
	КонецЦикла;
	
	Для Каждого Показатель Из МассивПоказателей Цикл
		
		НеобходимыеДанные.СдельныйЗаработок = НеобходимыеДанные.СдельныйЗаработок Или Показатель = Справочники.ПоказателиСхемМотивации.СдельнаяВыработка;
		НеобходимыеДанные.ОтработаноВремени = НеобходимыеДанные.ОтработаноВремени Или Показатель = Справочники.ПоказателиСхемМотивации.ВремяВДнях Или Показатель = Справочники.ПоказателиСхемМотивации.ВремяВЧасах
		Или Показатель = Справочники.ПоказателиСхемМотивации.ОтработаноВремениВДнях Или Показатель = Справочники.ПоказателиСхемМотивации.ОтработаноВремениВЧасах Или Показатель = Справочники.ПоказателиСхемМотивации.ОтработаноВремени;
		НеобходимыеДанные.НормаВремениЗаМесяц = НеобходимыеДанные.НормаВремениЗаМесяц Или Показатель = Справочники.ПоказателиСхемМотивации.НормаВремениВДнях Или Показатель = Справочники.ПоказателиСхемМотивации.НормаВремениВЧасах;
		НеобходимыеДанные.База = НеобходимыеДанные.База Или Показатель = Справочники.ПоказателиСхемМотивации.РасчетнаяБаза;
		НеобходимыеДанные.Стаж = НеобходимыеДанные.Стаж Или Показатель = Справочники.ПоказателиСхемМотивации.Стаж;
		НеобходимыеДанные.ВремяВКалендарныхДнях = НеобходимыеДанные.ВремяВКалендарныхДнях Или Показатель = Справочники.ПоказателиСхемМотивации.ВремяВКалендарныхДнях;
		НеобходимыеДанные.КалендарныхДнейВмесяце = НеобходимыеДанные.КалендарныхДнейВмесяце Или Показатель = Справочники.ПоказателиСхемМотивации.КалендарныхДнейВмесяце;
		НеобходимыеДанные.ВсегоОтработаноВремени = НеобходимыеДанные.ВсегоОтработаноВремени Или Показатель = Справочники.ПоказателиСхемМотивации.ОтработаноВремениВДнях Или Показатель = Справочники.ПоказателиСхемМотивации.ОтработаноВремениВЧасах Или Показатель = Справочники.ПоказателиСхемМотивации.ОтработаноВремени;
		НеобходимыеДанные.ТарифнаяСтавка1Разряда = НеобходимыеДанные.ТарифнаяСтавка1Разряда Или Показатель = Справочники.ПоказателиСхемМотивации.ТарифнаяСтавка1Разряда; //Островская Татьяна 18.02.2014 № 17126
	КонецЦикла;
	
	Возврат НеобходимыеДанные;
КонецФункции

// Функция предназначена для получения оплачиваемого времени по результату запроса при расчете:
//
// Параметры:
//	ИсходныеДанные - строка выборки из результат запроса, по которой вернуть время
//
// Возвращаемое значение:
//	Число - размер оплачиваемого времени в днях/часах
//
Функция ОплачиваемоеВремя(ИсходныеДанные, СтрокаДвижений, КомментироватьРасчет, КомментарийВладелец, СообщениеОбОшибке = Ложь, ГрафикиБезРабочегоВремени)
	
	ОплачиваемоеВремя = 0;
	РасшифровкаКомментария = НеОпределено;
	ВажностьКомментария = НеОпределено;
	//заявка №1979 (база заявок Кристалла)
	Если НачалоМесяца(ИсходныеДанные.Регистратор.ПериодРегистрации) >= Дата('20110601') Тогда 
		Если ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и
			не ТипЗнч(ИсходныеДанные.Регистратор) = Тип("ДокументСсылка.РегистрацияПростоевРаботниковОрганизаций")Тогда //О.Т. 02.09.2014
			
			ОплачиваемоеВремя = ИсходныеДанные.ОтработаноДней;
			
		Иначе
			ОплачиваемоеВремя = ИсходныеДанные.ОтработаноВремени;
		КонецЕсли;
		//заявка №1979
		
	Иначе
		ОплачиваемоеВремя = ИсходныеДанные.ОтработаноВремени;
	КонецЕсли;
	
	//толик	
	Если СтрокаДвижений.ЧасыИзДокумента Тогда
		Возврат СтрокаДвижений.ОплаченоДнейЧасов;
	КонецЕсли;
	//	
	
	Если ИсходныеДанные.ОтработаноВремени = Null Тогда
		Если ИсходныеДанные.ОшибкаВводаОтработанногоВремени Тогда
			ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Данные об отработанном времени введены сводно. Расчет времени по данному виду расчета невозможен");
		ИначеЕсли ИсходныеДанные.ОшибкаВводаИндивидуальногоГрафикаРаботы Тогда
			ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Индивидуальный график работы введен сводно. Расчет времени по данному виду расчета невозможен");
		Иначе
			ОбщегоНазначения.ОшибкаРасчета(ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Не найдены данные об отработанном времени");
		КонецЕсли;
		СообщениеОбОшибке = Истина;
		Возврат 0;
	ИначеЕсли ИсходныеДанные.ПредупреждениеНесоответствияТабеляИНачисления Тогда
		//толик		ОбщегоНазначения.ОшибкаРасчета("Предупреждение: " + ИсходныеДанные.СотрудникНаименование + "; " + ИсходныеДанные.ВидРасчетаНаименование + ": Данные об отработанном времени введенные табелем,  не соответствуют введенным начислениям");
	КонецЕсли;
	
	Если КомментироватьРасчет и ТипЗнч(ИсходныеДанные.ВидРасчета) <> Тип("ПланВидовРасчетаСсылка.УправленческиеНачисления")и ТипЗнч(ИсходныеДанные.ВидРасчета) <> Тип("ПланВидовРасчетаСсылка.УправленческиеУдержания") Тогда
		Если ИсходныеДанные.СпособВводаВремени = 1 
			или ИсходныеДанные.СпособВводаВремени = 2 Тогда // введено сводно табелем или индивид. графиком
			РасшифровкаКомментария = Новый Массив;
			РасшифровкаКомментария.Добавить("РаботаСДиалогами.ОткрытьГрафик");
			РасшифровкаКомментария.Добавить(СтрокаДвижений.Сотрудник);
			РасшифровкаКомментария.Добавить(СтрокаДвижений.ПериодДействия);
			ТекстКомментария = "Оплачиваемое время введено сводно за весь период работы ";
			Если ИсходныеДанные.СпособВводаВремени = 1 Тогда
				ПредставлениеРасшифровки = "табелем учета рабочего времени или сдельным нарядом";
			Иначе
				ПредставлениеРасшифровки = "индивидуальным графиком работы";
			КонецЕсли;
			ВажностьКомментария = Перечисления.ВидыСообщений.ВажнаяИнформация;
		Иначе
			РасшифровкаКомментария = Новый Массив;
			РасшифровкаКомментария.Добавить("РаботаСДиалогами.ОткрытьГрафик");
			РасшифровкаКомментария.Добавить(СтрокаДвижений.ГрафикРаботы);
			РасшифровкаКомментария.Добавить(СтрокаДвижений.ПериодДействия);
			Если ИсходныеДанные.СпособВводаВремени = 3 Тогда
				ТекстКомментария = "Оплачиваемое время рассчитано по графику работы: ";
				ПредставлениеРасшифровки = ИсходныеДанные.ГрафикРаботыНаименование;
			Иначе
				ТекстКомментария = "Оплачиваемое время рассчитано по индивидуальному графику работы или по табелю учета рабочего времени. ";
				ПредставлениеРасшифровки = "Подробнее...";
				ВажностьКомментария = Перечисления.ВидыСообщений.ВажнаяИнформация;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	Если ИсходныеДанные.ВидУчетаВремени <> Перечисления.ВидыУчетаВремени.ПоДням Тогда
		Если ИсходныеДанные.ВидРасчета.ВидВремени = Перечисления.ВидыВремени.ЧасовоеНеотработанное
			ИЛИ ИсходныеДанные.ВидРасчета.ВидВремени = Перечисления.ВидыВремени.ЧасовоеОтработанноеВПределахНормы Тогда
			ОплачиваемоеВремя = ИсходныеДанные.ОтработаноЧасов;
		Иначе
			ОплачиваемоеВремя = ИсходныеДанные.ОтработаноВремени;// - ИсходныеДанные.ОтработаноЧасовПоТабелюОтклонение;//О.Т. 18.03.2015 № 388
		КонецЕсли;
	КонецЕсли;
	
	Если КомментироватьРасчет Тогда
		ОбщегоНазначения.КомментарийРасчета("Оплачиваемое время " + ?(ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням, "(в днях) ", "(в часах) ") + ОплачиваемоеВремя, КомментарийВладелец);
		ОбщегоНазначения.КомментарийРасчета("Вид учета времени: " + ИсходныеДанные.ВидУчетаВремени, КомментарийВладелец);
		ОбщегоНазначения.КомментарийРасчета(ТекстКомментария, КомментарийВладелец, ПредставлениеРасшифровки, РасшифровкаКомментария, ВажностьКомментария);
	КонецЕсли;
	
	Если ОплачиваемоеВремя = 0 И Не ЗначениеЗаполнено(ИсходныеДанные.НормаВремениЗаМесяц) Тогда
		КлючПоиска = Новый Структура("ГрафикРаботы,ВидУчетаВремени");
		КлючПоиска.ВидУчетаВремени = ИсходныеДанные.ВидУчетаВремени;
		Если ИсходныеДанные.СпособВводаВремени = 1 Или ИсходныеДанные.СпособВводаВремени = 2 Тогда
			КлючПоиска.ГрафикРаботы = СтрокаДвижений.Сотрудник;
		Иначе
			КлючПоиска.ГрафикРаботы = СтрокаДвижений.ГрафикРаботы;
		КонецЕсли;
		
		КоличествоСтрокГрафика = ГрафикиБезРабочегоВремени.НайтиСтроки(КлючПоиска).Количество();
		Если КомментироватьРасчет Или КоличествоСтрокГрафика = 0 Тогда
			РасшифровкаКомментария = Новый Массив;
			РасшифровкаКомментария.Добавить("РаботаСДиалогами.ОткрытьГрафик");
			
			Если ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоВечернимЧасам Тогда
				ТекстВидаВремени = "вечерних часов";
			ИначеЕсли ИсходныеДанные.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоНочнымЧасам Тогда
				ТекстВидаВремени = "ночных часов";
			Иначе
				ТекстВидаВремени = "рабочих дней";
			КонецЕсли;
			
			Если ИсходныеДанные.СпособВводаВремени = 1 Тогда
				РасшифровкаКомментария.Добавить(СтрокаДвижений.Сотрудник);
				РасшифровкаКомментария.Добавить(СтрокаДвижений.ПериодДействия);
				Если КомментироватьРасчет Тогда
					ТекстКомментария = "В сдельном наряде или табеле учета рабочего времени за " + Формат(СтрокаДвижений.ПериодДействия, "ДФ='MMММ yyyy ""г.""'") + " нет " + ТекстВидаВремени + "! Необходимо заполнить ";
				Иначе
					ФИО = ИсходныеДанные.СотрудникНаименование;
					ФИО = СтрЗаменить(ФИО,"Ё","Е");//О.Т. Аверсон 23.06.2016
					ПроцедурыУправленияПерсоналом.Просклонять(глЗначениеПеременной("глКомпонентаСклоненияФИО"), ФИО, 2, ФИО);
					
					ТекстКомментария = "У " + ФИО + " в сдельном наряде или табеле учета рабочего времени за " + Формат(СтрокаДвижений.ПериодДействия, "ДФ='MMММ yyyy ""г.""'") + " нет " + ТекстВидаВремени + "! Необходимо заполнить ";
				КонецЕсли;
				
				ОбщегоНазначения.КомментарийРасчета(ТекстКомментария, КомментарийВладелец, "документ", РасшифровкаКомментария, Перечисления.ВидыСообщений.Ошибка);
				Если КоличествоСтрокГрафика = 0 Тогда
					НоваяСтрока = ГрафикиБезРабочегоВремени.Добавить();
					НоваяСтрока.ВидУчетаВремени = ИсходныеДанные.ВидУчетаВремени;
					НоваяСтрока.ГрафикРаботы = СтрокаДвижений.Сотрудник;
				КонецЕсли;
				
			ИначеЕсли ИсходныеДанные.СпособВводаВремени = 2 Тогда
				РасшифровкаКомментария.Добавить(СтрокаДвижений.Сотрудник);
				РасшифровкаКомментария.Добавить(СтрокаДвижений.ПериодДействия);
				
				Если КомментироватьРасчет Тогда
					ТекстКомментария = "В индивидуальном графике за " + Формат(СтрокаДвижений.ПериодДействия, "ДФ='MMММ yyyy ""г.""'") + " нет " + ТекстВидаВремени + "! Необходимо заполнить ";
				Иначе
					ФИО = ИсходныеДанные.СотрудникНаименование;
					ФИО = СтрЗаменить(ФИО,"Ё","Е");//О.Т. Аверсон 23.06.2016
					ПроцедурыУправленияПерсоналом.Просклонять(глЗначениеПеременной("глКомпонентаСклоненияФИО"), ФИО, 2, ФИО);
					
					ТекстКомментария = "У " + ФИО + " в индивидуальном графике за " + Формат(СтрокаДвижений.ПериодДействия, "ДФ='MMММ yyyy ""г.""'") + " нет " + ТекстВидаВремени + "! Необходимо заполнить ";
				КонецЕсли;
				
				ОбщегоНазначения.КомментарийРасчета(ТекстКомментария, КомментарийВладелец, "документ", РасшифровкаКомментария, Перечисления.ВидыСообщений.Ошибка);
				Если КоличествоСтрокГрафика = 0 Тогда
					НоваяСтрока = ГрафикиБезРабочегоВремени.Добавить();
					НоваяСтрока.ВидУчетаВремени = ИсходныеДанные.ВидУчетаВремени;
					НоваяСтрока.ГрафикРаботы = СтрокаДвижений.Сотрудник;
				КонецЕсли;
				
			Иначе
				РасшифровкаКомментария.Добавить(СтрокаДвижений.ГрафикРаботы);
				РасшифровкаКомментария.Добавить(СтрокаДвижений.ПериодДействия);
				Если ИсходныеДанные.СпособВводаВремени = 3 Тогда
					ОбщегоНазначения.КомментарийРасчета("В графике нет " + ТекстВидаВремени + " за " + Формат(СтрокаДвижений.ПериодДействия, "ДФ='MMММ yyyy ""г.""'") + " Необходимо заполнить график: ", КомментарийВладелец, ИсходныеДанные.ГрафикРаботыНаименование, РасшифровкаКомментария, Перечисления.ВидыСообщений.Ошибка);
				Иначе
					Если КомментироватьРасчет Тогда
						ТекстКомментария = "В индивидуальном графике или табеле учета рабочего времени за " + Формат(СтрокаДвижений.ПериодДействия, "ДФ='MMММ yyyy ""г.""'") + " нет " + ТекстВидаВремени + ". Необходимо заполнить ";
					Иначе
						ФИО = ИсходныеДанные.СотрудникНаименование;
						ФИО = СтрЗаменить(ФИО,"Ё","Е");//О.Т. Аверсон 23.06.2016
						ПроцедурыУправленияПерсоналом.Просклонять(глЗначениеПеременной("глКомпонентаСклоненияФИО"), ФИО, 2, ФИО);
						
						ТекстКомментария = "У " + ФИО + " в индивидуальном графике или табеле учета рабочего времени за " + Формат(СтрокаДвижений.ПериодДействия, "ДФ='MMММ yyyy ""г.""'") + " нет " + ТекстВидаВремени + ". Необходимо заполнить ";
					КонецЕсли;
					
					ОбщегоНазначения.КомментарийРасчета(ТекстКомментария, КомментарийВладелец, "документ", РасшифровкаКомментария, Перечисления.ВидыСообщений.Ошибка);
				КонецЕсли;
				Если КоличествоСтрокГрафика = 0 Тогда
					НоваяСтрока = ГрафикиБезРабочегоВремени.Добавить();
					НоваяСтрока.ВидУчетаВремени = ИсходныеДанные.ВидУчетаВремени;
					НоваяСтрока.ГрафикРаботы = СтрокаДвижений.ГрафикРаботы;
				КонецЕсли;
				
			КонецЕсли;
		КонецЕсли;
		СообщениеОбОшибке = Истина;
	КонецЕсли;
	
	Возврат ОплачиваемоеВремя;
	
КонецФункции // ОплачиваемоеВремя()

// Создает строку в движениях  РасчетСреднегоЗаработка, заполняет по данным выборки 
// из запроса и возвращает ее
// Используется в СформироватьИЗаписатьДанныеРасчетаСреднего
// Параметры:
// 	Выборка - спозиционированная выборка результата запроса
//  НаборЗаписей - набор записей РасчетСреднегоЗаработка
//  Регистратор - документ
//  ВидРасчета - вид расчета среднего заработка
//
// Возвращаемое значение:
// Запись регистра расчета РасчетСреднегоЗаработка
//
Функция СоздатьСтрокуРасчетаСреднего(Выборка, НаборЗаписей, Регистратор, ВидРасчета)
	
	Строка = НаборЗаписей.Добавить();
	
	// предопределенные поля
	Строка.ПериодРегистрации				= Выборка.ПериодРегистрации;
	Строка.ВидРасчета						= ВидРасчета;
	
	// измерения
	Строка.Сотрудник						= Выборка.Сотрудник;
	Строка.Физлицо							= Выборка.Физлицо;
	Строка.Организация						= Выборка.Организация;
	
	// реквизиты
	Строка.СпособРасчета					= Выборка.СпособРасчета;
	Строка.ВидУчетаВремени					= Выборка.ВидУчетаВремени;
	Строка.ДатаНачалаСобытия				= Выборка.ДатаНачалаСобытия;
	Строка.ДатаНачалаРасчетногоПериода		= Выборка.НачалоБП;
	Строка.ДатаОкончанияРасчетногоПериода	= Выборка.КонецБП;
	
	
	Строка.ПериодРасчетаСреднегоЗаработка	= Выборка.ПериодРасчетаСреднегоЗаработка;
	Строка.КоэффициентИндексации			= 1;
	
	Возврат Строка;
	
КонецФункции // СоздатьСтрокуРасчетаСреднего()

//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
//Получает структуру дат динамики бюджета прожиточного минимума (для получения текущего и предыдущего значений бюджета прожиточного минимума)
Функция ПолучитьСтруктуруДатБюджетаПрожиточногоМинимума( ДатаВыборки )
	
	Если Месяц(ДатаВыборки) >= 2 и Месяц(ДатаВыборки) <= 04 Тогда 
		ДатаБюджетаПрожМинимТекущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)," ","")+"0201000000");
		ДатаБюджетаПрожМинимПредыдущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)-1," ","")+"1101000000");
	ИначеЕсли Месяц(ДатаВыборки) >= 5 и Месяц(ДатаВыборки) <= 7 Тогда 
		ДатаБюджетаПрожМинимТекущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)," ","")+"0501000000");
		ДатаБюджетаПрожМинимПредыдущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)," ","")+"0201000000");
	ИначеЕсли Месяц(ДатаВыборки) >= 8 и Месяц(ДатаВыборки) <= 10 Тогда 
		ДатаБюджетаПрожМинимТекущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)," ","")+"0801000000");
		ДатаБюджетаПрожМинимПредыдущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)," ","")+"0501000000");
	ИначеЕсли Месяц(ДатаВыборки) >= 11 или Месяц(ДатаВыборки) = 1 Тогда 
		Если Месяц(ДатаВыборки) = 1 Тогда
			ДатаБюджетаПрожМинимТекущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)-1," ","")+"1101000000");
			ДатаБюджетаПрожМинимПредыдущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)-1," ","")+"0801000000");
		Иначе
			ДатаБюджетаПрожМинимТекущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)," ","")+"1101000000"); 
			ДатаБюджетаПрожМинимПредыдущегоПериода = Дата(""+СтрЗаменить(Год(ДатаВыборки)," ","")+"0801000000");
		КонецЕсли;
	КонецЕсли;
	
	СтруктураДатБюджетаПрожиточногоМинимума = Новый Структура( 
	"ДатаБюджетаПрожМинимТекущегоПериода, ДатаБюджетаПрожМинимПредыдущегоПериода", 
	ДатаБюджетаПрожМинимТекущегоПериода, ДатаБюджетаПрожМинимПредыдущегоПериода );
	
	Возврат СтруктураДатБюджетаПрожиточногоМинимума;
	
КонецФункции // ПолучитьСтруктуруДатБПМ
//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт

//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
Функция ПолучитьМассивГодовыхПремий()
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ДополнительныеНачисленияОрганизаций.Ссылка КАК ГодоваяПремия
	|ИЗ
	|	ПланВидовРасчета.ДополнительныеНачисленияОрганизаций КАК ДополнительныеНачисленияОрганизаций
	|ГДЕ
	|	ДополнительныеНачисленияОрганизаций.ВидПремии = ЗНАЧЕНИЕ(Перечисление.ВидыПремии.ГодоваяПремия)
	|	И ДополнительныеНачисленияОрганизаций.ЧислоМесяцев = 12
	|	И НЕ ДополнительныеНачисленияОрганизаций.ПометкаУдаления";
	
	МассивГодовыхПремий = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку( "ГодоваяПремия" );
	
	Возврат МассивГодовыхПремий;
	
КонецФункции // ПолучитьМассивГодовыхПремий()
//- СВЭЙ КДЯ 12.12.19 СВФР-004448

//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
//получает эталонную тарифную ставку теущего периода, применяемую для индексации среднего 
Функция ПолучитьЭталоннуюТС( МесяцВыборки, ПериодРегистрации, ОтборСтавки, Знач РазмерТСТекущегоПериода, РазмерТСНаДату )
	Дата_С = КонецГода( МесяцВыборки );
	Дата_ПО = КонецГода( ДобавитьМесяц( ПериодРегистрации, -12 ) );
	Пока РазмерТСТекущегоПериода / РазмерТСНаДату > 2 И Дата_С <= Дата_ПО Цикл
		РазмерТСТекущегоПериода = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее( 
		Дата_ПО, ОтборСтавки ).Размер;
		Дата_ПО = КонецГода( ДобавитьМесяц( Дата_ПО, -12 ) );
	КонецЦикла;
	Возврат РазмерТСТекущегоПериода;
КонецФункции // ПолучитьТС()
//- СВЭЙ КДЯ 03.01.20 СВФР-005167

//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
Функция ПолучитьДанныеПоследнегоОклада(	ДатаСред, СтрокаДвижений )
	
	ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее( 
	КонецМесяца( ДатаСред ),
	Новый Структура( "Организация, Сотрудник", СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник ) 
	).Должность;							
	ЗапросОкладПосл = Новый Запрос;
	ЗапросОкладПосл.Текст = "
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ТарифныеСтавкиРаботниковОрганизации.ДляПечати
	|			ТОГДА ТарифныеСтавкиРаботниковОрганизации.МесячнаяТарифнаяСтавкаВВалюте
	|		ИНАЧЕ ТарифныеСтавкиРаботниковОрганизации.ТарифнаяСтавка
	|	КОНЕЦ КАК ТарифнаяСтавка,//О.Т. Аверсон 06.12.2016 № 74
	|	ТарифныеСтавкиРаботниковОрганизации.Период
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
	|			&ДатаНачалаРасчетногоПериода,
	|			Сотрудник = &Сотрудник
	|				И Организация = &Организация
	|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизаций
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
	|		ПО РаботникиОрганизаций.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
	|			И РаботникиОрганизаций.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
	|			И РаботникиОрганизаций.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
	|	 
	|ОБЪЕДИНИТЬ ВСЕ
	|	 
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ТарифныеСтавкиРаботниковОрганизации.ДляПечати
	|			ТОГДА ТарифныеСтавкиРаботниковОрганизации.МесячнаяТарифнаяСтавкаВВалюте
	|		ИНАЧЕ ТарифныеСтавкиРаботниковОрганизации.ТарифнаяСтавка
	|	КОНЕЦ КАК ТарифнаяСтавка,//О.Т. Аверсон 06.12.2016 № 74
	|	ТарифныеСтавкиРаботниковОрганизации.Период
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
	|		ПО РаботникиОрганизаций.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
	|			И РаботникиОрганизаций.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
	|			И РаботникиОрганизаций.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
	|ГДЕ
	|	РаботникиОрганизаций.Сотрудник = &Сотрудник
	|	И РаботникиОрганизаций.Организация = &Организация
	|	И РаботникиОрганизаций.Период МЕЖДУ &ДатаНачалаРасчетногоПериода И &ДатаОкончанияРасчетногоПериода
	|	И РаботникиОрганизаций.Должность = &Должность 
	|	И НЕ РаботникиОрганизаций.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций 
	|";
	
	ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
	ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
	ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
	ЗапросОкладПосл.УстановитьПараметр("ДатаНачалаРасчетногоПериода", НачалоДня(СтрокаДвижений.ДатаНачалаРасчетногоПериода));
	
	//Аверсон 22.04.2022 КВВ СВФР-008984 (
	//ЗапросОкладПосл.УстановитьПараметр("ДатаОкончанияРасчетногоПериода", КонецДня(СтрокаДвижений.ДатаОкончанияРасчетногоПериода));
	ЗапросОкладПосл.УстановитьПараметр("ДатаОкончанияРасчетногоПериода", КонецДня(СтрокаДвижений.ПериодРегистрации));
	//Аверсон 22.04.2022 КВВ СВФР-008984 )
	
	ТЗ_СтавкиДоПонижения = Новый ТаблицаЗначений;
	ТЗ_СтавкиДоПонижения.Колонки.Добавить( "Период" );
	ТЗ_СтавкиДоПонижения.Колонки.Добавить( "Ставка" );
	
	РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();
	
	ПериодОкл = Дата( 1, 1, 1 );
	РазмерОкл = 0;
	
	ПредыдущийРазмерОкл = 0;
	Пока РезультатОкладПосл.Следующий() Цикл
		ПериодОкл = РезультатОкладПосл.Период;
		РазмерОкл = РезультатОкладПосл.ТарифнаяСтавка;
		Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и РезультатОкладПосл.Период < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
			РазмерОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерОкл / 10000,СтрокаДвижений.ПериодРегистрации);
		КонецЕсли; 								
		Если РазмерОкл > 0 И ПредыдущийРазмерОкл > РазмерОкл Тогда
			ДобавляемыйПериод = НачалоМесяца( ДобавитьМесяц( РезультатОкладПосл.Период, -1 ) );
			Стр = ТЗ_СтавкиДоПонижения.Найти( ДобавляемыйПериод, "Период" );
			Если Стр = Неопределено Тогда
				Стр =  ТЗ_СтавкиДоПонижения.Добавить();
				Стр.Период = ДобавляемыйПериод;
			КонецЕсли;
			Стр.Ставка = ПредыдущийРазмерОкл;
		КонецЕсли; 
		ПредыдущийРазмерОкл = РазмерОкл;
	КонецЦикла;
	
	Если РазмерОкл > 0 Тогда
		ДобавляемыйПериод = НачалоМесяца( СтрокаДвижений.ДатаОкончанияРасчетногоПериода );
		Стр = ТЗ_СтавкиДоПонижения.Найти( ДобавляемыйПериод, "Период" );
		Если Стр = Неопределено Тогда
			Стр =  ТЗ_СтавкиДоПонижения.Добавить();
			Стр.Период = ДобавляемыйПериод;
		КонецЕсли;
		Стр.Ставка = РазмерОкл; 
	КонецЕсли;
	ТЗ_СтавкиДоПонижения.Сортировать( "Период" );
	МесяцВыборки = НачалоМесяца( ДатаСред );
	
	
	ПериодПоследнегоОкл = ТекущаяДата();
	РазмерПоследнегоОкл = 0;
	Для каждого Стр Из ТЗ_СтавкиДоПонижения Цикл
		Если Стр.Период >= МесяцВыборки Тогда
			ПериодПоследнегоОкл = Стр.Период;
			РазмерПоследнегоОкл = Стр.Ставка;
			Прервать;
		КонецЕсли; 
	КонецЦикла; 
	
	
	ДанныеПоследнегоОклада = Новый Структура( 
	"ПериодПоследнегоОкл, РазмерПоследнегоОкл, ТЗ_СтавкиДоПонижения",	
	ПериодПоследнегоОкл, РазмерПоследнегоОкл, ТЗ_СтавкиДоПонижения );	
	Возврат ДанныеПоследнегоОклада;
	
КонецФункции // ПолучитьДанныеПоследнегоОклада 
//- СВЭЙ КДЯ 27.01.20 СВФР-005409

Функция ЧасовПоГруппеРасчетовУвеличениеНормыГрафикаВОплатеПоСреднему(Сотрудник,ДатаЗапроса, ВР = Неопределено) 
	//Аверсон 13.06.2022 КВВ СВФР-009195 (
	Часов = 0;
	ЧасовНВ = 0;
	СписокВР = Новый СписокЗначений;
	
	ГруппаРасчетов = Справочники.ГруппыРасчетов.УвеличениеНормыГрафикаВОплатеПоСреднему;
	Для Каждого Стр из ГруппаРасчетов.Основные Цикл 
		Если ВР = Неопределено 
			ИЛИ (ВР <> Неопределено И ВР = Стр.ВидРасчета) Тогда
			СписокВР.Добавить(Стр.ВидРасчета);
		КонецЕсли;
	КонецЦикла;
	
	//Аверсон 12.07.2022 КВВ СВФР-009332 (
	СписокВВ = Новый СписокЗначений;
	Для Каждого Стр из ГруппаРасчетов.КлассификаторИспользованияРВ Цикл 
		Если ВР = Неопределено Тогда
			СписокВВ.Добавить(Стр.ВидКлассификатора);
		КонецЕсли;
	КонецЦикла;
	//Аверсон 12.07.2022 КВВ СВФР-009332 )
	
	Если СписокВР.Количество() > 0 ИЛИ СписокВВ.Количество() > 0 Тогда	//Аверсон 12.07.2022 КВВ СВФР-009332	
		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ
		|СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОплаченоДнейЧасов) КАК Часов
		|ПОМЕСТИТЬ ВтЧасов //Аверсон 12.07.2022 КВВ СВФР-009332
		|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		|ГДЕ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В (&СписокВР)
		|И НАЧАЛОПЕРИОДА(&ДатаЗапроса,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия,МЕСЯЦ) 
		|И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|
		//Аверсон 12.07.2022 КВВ СВФР-009332 (
		|ОБЪЕДИНИТЬ
		|ВЫБРАТЬ
		|СУММА(РабочееВремяРаботниковОрганизаций.Часов) 
		|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|ГДЕ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&СписокВВ)
		|И НАЧАЛОПЕРИОДА(&ДатаЗапроса,МЕСЯЦ) = НАЧАЛОПЕРИОДА(РабочееВремяРаботниковОрганизаций.Период,МЕСЯЦ) 
		|И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
		|;
		|ВЫБРАТЬ 
		|СУММА(ВтЧасов.Часов) КАК Часов
		|ИЗ ВтЧасов КАК ВтЧасов";
		//Аверсон 12.07.2022 КВВ СВФР-009332 )
		
		Запрос.УстановитьПараметр("Сотрудник",Сотрудник);
		Запрос.УстановитьПараметр("ДатаЗапроса",ДатаЗапроса);
		Запрос.УстановитьПараметр("СписокВР",СписокВР);
		Запрос.УстановитьПараметр("СписокВВ",СписокВВ); //Аверсон 12.07.2022 КВВ СВФР-009332
		
		РезЗапрос = Запрос.Выполнить().Выгрузить();
		Если РезЗапрос.Количество() > 0 Тогда
			//Часов = РезЗапрос[0].Часов;
			Часов = РезЗапрос.Итог("Часов"); //Аверсон 12.07.2022 КВВ СВФР-009332
		КонецЕсли;	
		ЗапросНВ = Новый Запрос;
		ЗапросНВ.Текст =
		"ВЫБРАТЬ
		|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|ГДЕ
		|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
		|	И РабочееВремяРаботниковОрганизаций.Период >= &Период
		|	И РабочееВремяРаботниковОрганизаций.Период <= &Период2";   
		ЗапросНВ.УстановитьПараметр("Сотрудник",Сотрудник);
		ЗапросНВ.УстановитьПараметр("Период", НачалоМесяца(ДатаЗапроса));
		ЗапросНВ.УстановитьПараметр("Период2", КонецМесяца(ДатаЗапроса));
		ЗапросНВ.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.НайтиПоНаименованию("Дополнительные выходные дни (без сохранения зарабо",истина));
		РезультатНВ = ЗапросНВ.Выполнить().Выбрать();
		ДопВремя = 0; 
		Пока РезультатНВ.Следующий() Цикл
			ЧасовНВ =?(РезультатНВ.Часов=null,0,РезультатНВ.Часов);
		КонецЦикла;
		
	КонецЕсли;
	Возврат ?(ЗначениеЗаполнено(Часов),Часов-ЧасовНВ,0-ЧасовНВ);
	//Аверсон 13.06.2022 КВВ СВФР-009195 )
КонецФункции

Функция СформироватьДанныеПоГрРасчетов(БазовыйПериодНачало, БазовыйПериодКонец, Организация, Сотрудник)
	//Аверсон 28.04.2023 КВВ СВФР-010738 (
	ВозвратЗначения = Ложь;
	Если Организация.НормаВОтпускахПоГрРасчетов = Истина
		И ЗначениеЗаполнено(Организация.ГруппаРасчета) Тогда
		
		СпЗнВидыВремени = Новый СписокЗначений;
		Для Каждого Стр из Организация.ГруппаРасчета.КлассификаторИспользованияРВ Цикл 
			СпЗнВидыВремени.Добавить(Стр.ВидКлассификатора);
		КонецЦикла;
		
		Если СпЗнВидыВремени.Количество() > 0 Тогда				
			Запрос = Новый Запрос;
			
			Запрос.Текст = "ВЫБРАТЬ
			|СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
			|СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
			|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
			|ГДЕ
			|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&СпЗнВидыВремени) 
			|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &НачПериод И &КонПериод
			|	И РабочееВремяРаботниковОрганизаций.Организация = &Организация
			|	И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник";
			
			Запрос.УстановитьПараметр("НачПериод", БазовыйПериодНачало);
			Запрос.УстановитьПараметр("КонПериод", БазовыйПериодКонец);
			Запрос.УстановитьПараметр("Организация", Организация);
			Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
			Запрос.УстановитьПараметр("СпЗнВидыВремени",СпЗнВидыВремени);
			Рез = Запрос.Выполнить().Выгрузить();
			Если Рез.Количество() > 0 Тогда
				Если (ЗначениеЗаполнено(Рез[0].Часов) И Рез[0].Часов > 0) ИЛИ (ЗначениеЗаполнено(Рез[0].Дней) И Рез[0].Дней > 0) Тогда
					ВозвратЗначения = Истина;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;	
	Возврат ВозвратЗначения;	
	//Аверсон 28.04.2023 КВВ СВФР-010738 )
КонецФункции


// выполняет формирование и запись набора записей регистра РасчетСреднегоЗаработка
// на основании данных набора записей регистра ОсновныеНачисленияРаботниковОрганизации
// Параметры:
//  ИмяРегистра - имя регистра расчетов 
//  Регистратор - регистратор набора записей регистра ОсновныеНачисленияРаботниковОрганизации
//  НаборЗаписей
// 
// Возвращаемое значение:
//  нет
//
Процедура СформироватьИЗаписатьДанныеРасчетаСреднего(ИмяРегистра, Регистратор, НаборЗаписей, КомментироватьРасчет = Ложь,ТЗНаборРасчетаНачисления = Неопределено,ПрошлыйТек = Ложь,Пересчет = Ложь,ТЧРегистратор = Неопределено) Экспорт //Островская Татьяна 30.05.2014 № 17397
	//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
	Перем ПервСтр, ДатаНачалаВыборки, ДатаНачалаСобытия, МаксимальныйОбъемВыборки, ДатаПриема;
	//- СВЭЙ КДЯ 05.09.19 СВФР-004448
	Перем ТЗ_СтавкиДоПонижения; //+ СВЭЙ КДЯ 27.01.20 СВФР-005409
	
	СообщениеОПересечении = ""; //Аверсон 27.12.2021 КВВ СВФР-008547
	
	//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
	ТипРегистратора = ТипЗнч( Регистратор );
	ОкруглитьКоэффициентИндексации = ( ТипРегистратора = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" )
	ИЛИ ТипРегистратора = Тип( "ДокументСсылка.ОплатаПоСреднемуЗаработку" ) 
	ИЛИ ТипРегистратора = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" ) 
	ИЛИ ТипРегистратора = Тип( "ДокументСсылка.РасчетСреднегоПоСотрудникам" ) 
	);
	//- СВЭЙ 15.03.19 КДЯ СВФР-004088
	
	// Вычислим наименьшую и наибольшую дату расчета среднего
	ДатаНачалаРасчетаСреднего		= '00010101';
	ДатаОкончанияРасчетаСреднего	= '00010101';
	НГраница = НаборЗаписей.Количество();
	
	//толик определим дату изменения зп	
	мДатаИзмененияЗП = ПрочиеПроцедуры.ОпределитьДатуИзмененияЗП(Регистратор.Организация);
	
	// Выберем данные о коэффициентах индексации за расчетные периоды (в общем случае может быть несколько 
	// различных расчетных периодов, так как записей начислений в документе оплаты может быть несколько и мы позволяем 
	// пользователю редактировать расчетный период)
	
	// Реализация Федеральных законов:
	//	от 22.12.2005 г. № 180-ФЗ и от 29 декабря 2006 г. № 255-ФЗ - по больничным листам
	//	от 5 декабря 2006 г. № 207-ФЗ - по отпуску по уходу за детьми
	// - поле "Сотрудник" с 1 января 2006 года для больничных листов и с 1 января 2007 года для отпуска по уходу за детьми
	// может идентифицировать несколько мест работы, включая работу по внутреннему совместительству
	// - выборка РаботникиОрганизацийСрезПоследних содержит все действующие на конец расчетного периода
	// рабочие места
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ЕСТЬNULL(РаботникиОрганизацийСрезПоследних.Сотрудник, Основной.Сотрудник) КАК Сотрудник,
	|	Основной.ФизЛицо КАК Физлицо,
	|	Основной.Организация КАК Организация,
	|	Основной.ВидУчетаВремени КАК ВидУчетаВремени,
	|	Основной.ВидРасчета.СпособРасчета КАК СпособРасчета,";
	
	//Аверсон 21.06.2023 КВВ СВФР-010940 (
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") И ЗначениеЗаполнено(Регистратор.ДатаВыборки) Тогда
		Запрос.Текст = Запрос.Текст + "
		|РАЗНОСТЬДАТ(Основной.Регистратор.ДатаВыборки, НАЧАЛОПЕРИОДА(
		|ВЫБОР КОГДА 
		|КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(Основной.Регистратор.ДатаВыборки,МЕСЯЦ,11),МЕСЯЦ) < КОНЕЦПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, ДЕНЬ)
		|ТОГДА
		|КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(Основной.Регистратор.ДатаВыборки,МЕСЯЦ,11),МЕСЯЦ)
		|ИНАЧЕ
		|КОНЕЦПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, ДЕНЬ) 
		|КОНЕЦ
		|, МЕСЯЦ), МЕСЯЦ) + 1 КАК ПериодРасчетаСреднегоЗаработка,
		|Основной.Регистратор.ДатаВыборки КАК НачалоБП,
		|ВЫБОР КОГДА 
		|КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(Основной.Регистратор.ДатаВыборки,МЕСЯЦ,11),МЕСЯЦ) < КОНЕЦПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, ДЕНЬ)
		|ТОГДА
		|КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(Основной.Регистратор.ДатаВыборки,МЕСЯЦ,11),МЕСЯЦ)
		|ИНАЧЕ
		|КОНЕЦПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, ДЕНЬ) 
		|КОНЕЦ КАК КонецБП,";
	Иначе
		Запрос.Текст = Запрос.Текст + "		
		|РАЗНОСТЬДАТ(Основной.ПериодРасчетаСреднегоЗаработкаНачало, НАЧАЛОПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, МЕСЯЦ), МЕСЯЦ) + 1 КАК ПериодРасчетаСреднегоЗаработка,
		|Основной.ПериодРасчетаСреднегоЗаработкаНачало КАК НачалоБП,
		|КОНЕЦПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, ДЕНЬ) КАК КонецБП,";
	КонецЕсли;
	//Аверсон 21.06.2023 КВВ СВФР-010940 )
	
	Запрос.Текст = Запрос.Текст + "
	|	Основной.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|	1 КАК КоэффициентИндексации,
	|	0 КАК ТекущаяТарифнаяСтавка,
	|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Период КАК Период,
	//Если ИмяРегистра = "ОсновныеНачисленияРаботниковОрганизаций" Тогда
	//	Запрос.Текст = Запрос.Текст + "
	//|	ВЫБОР
	//|		КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПособиеПоУходуЗаРебенкомДо1_5Лет)
	//|			ТОГДА ""ЗаСчетФССПо255ФЗ""
	//|		КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС)
	//|			ТОГДА ВЫБОР
	//|					КОГДА Основной.ДатаНачалаСобытия >= &парамДатаЗакона255ФЗ
	//|						ТОГДА ""ЗаСчетФССПо255ФЗ""
	//|					КОГДА Основной.ВариантАлгоритмаРасчета В (&БольничныеПереходногоПериода)
	//|						ТОГДА ""ПереходныйПериодПо255ФЗ""
	//|					ИНАЧЕ ""ЗаСчетФССПо180ФЗ""
	//|				КОНЕЦ
	//|		КОГДА Основной.ДатаНачалаСобытия >= &парамДатаПостановления922
	//|			ТОГДА ""Средний2008""
	//|		ИНАЧЕ ""Средний""
	//|	КОНЕЦ КАК ВариантЗаполненияСреднего,";
	//Иначе
	//	Запрос.Текст = Запрос.Текст + "
	|	""Средний"" КАК ВариантЗаполненияСреднего,
	//КонецЕсли;
	//Запрос.Текст = Запрос.Текст + "
	|	//Основной.Регистратор.ПериодРегистрации КАК ПериодРегистрации, Основной.ПериодДействияНачало, Основной.ПериодДействияКонец
	|ИЗ
	|	РегистрРасчета." + ИмяРегистра + " КАК Основной
	//	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации.СрезПоследних КАК ТарифныеСтавкиРаботниковОрганизацииСрезПоследних
	|		ПО Основной.сотрудник = ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник
	|			И Основной.Организация = ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Организация
	|			И Основной.ПериодРегистрации = ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Период
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
	|			ДатыРегистра.Сотрудник КАК Сотрудник,
	|			ДатыРегистра.Регистратор КАК Регистратор,
	|			ДатыРегистра.НомерСтроки КАК НомерСтроки
	|		ИЗ
	|			(ВЫБРАТЬ
	|				ОсновныеНачисленияРаботниковОрганизаций.Регистратор КАК Регистратор,
	|				ОсновныеНачисленияРаботниковОрганизаций.НомерСтроки КАК НомерСтроки,
	|				ОсновныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|				РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	|				МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период
	|			ИЗ
	|				РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|					ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|					ПО 
	|						ОсновныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия >= РаботникиОрганизаций.Период
	|						И ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
	|						И ОсновныеНачисленияРаботниковОрганизаций.Организация = РаботникиОрганизаций.Сотрудник.Организация
	|			ГДЕ
	|				ОсновныеНачисленияРаботниковОрганизаций.Регистратор = &парамРегистратор
	|				И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС))
	//|				И ОсновныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия >= &парамДатаЗакона180ФЗ
	|				И (НЕ ОсновныеНачисленияРаботниковОрганизаций.Сторно)
	|			
	|			СГРУППИРОВАТЬ ПО
	|				ОсновныеНачисленияРаботниковОрганизаций.Регистратор,
	|				ОсновныеНачисленияРаботниковОрганизаций.НомерСтроки,
	|				ОсновныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
	|				РаботникиОрганизаций.Сотрудник) КАК ДатыРегистра
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|				ПО ДатыРегистра.Период = РаботникиОрганизаций.Период
	|					И ДатыРегистра.Сотрудник = РаботникиОрганизаций.Сотрудник";
	//О.Т. Аверсон 21.10.2015 № 657
	Если не ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
		Запрос.Текст = Запрос.Текст + "
		|		ГДЕ
		|			ВЫБОР
		|					КОГДА ДатыРегистра.ДатаНачалаСобытия >= РаботникиОрганизаций.ПериодЗавершения
		|							И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|						ТОГДА РаботникиОрганизаций.ПричинаИзмененияСостоянияЗавершения
		|					ИНАЧЕ РаботникиОрганизаций.ПричинаИзмененияСостояния
		|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) КАК РаботникиОрганизацийСрезПоследних";
	иначе
		Запрос.Текст = Запрос.Текст + " ) КАК РаботникиОрганизацийСрезПоследних";
	КонецЕсли;
	Запрос.Текст = Запрос.Текст + "
	//О.Т. Аверсон 21.10.2015 № 657
	|		ПО Основной.Регистратор = РаботникиОрганизацийСрезПоследних.Регистратор
	|			И Основной.НомерСтроки = РаботникиОрганизацийСрезПоследних.НомерСтроки
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.ВидРасчета.СпособРасчета В(&парамСпособыРасчета)
	|	И (НЕ Основной.Сторно)
	//толик по сотруднику
	|	И ВЫБОР
	|		КОГДА &ЭтоБольничный
	|			ТОГДА Основной.Сотрудник = &Сотрудник
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ
	|	И ВЫБОР
	|		КОГДА &ЭтоБольничный
	|			ТОГДА РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ
	//
	|
	|УПОРЯДОЧИТЬ ПО
	|	Физлицо,
	|	Сотрудник,
	|	СпособРасчета,
	|	НачалоБП,
	|	КонецБП,
	|	Период УБЫВ";
	
	//Запрос.УстановитьПараметр("парамДатаЗакона180ФЗ",		'20060101');
	//Запрос.УстановитьПараметр("парамДатаЗакона255ФЗ",		ПолучитьДатуВступленияВСилуИзмененийПоСоциальнымПособиям2006());
	//ДатаПостановления922	= ПолучитьДатуВступленияВСилуИзмененийПоОтпускам2008();
	//Запрос.УстановитьПараметр("парамДатаПостановления922",	ДатаПостановления922);
	Запрос.УстановитьПараметр("парамРегистратор",			Регистратор);
	//толик
	Запрос.УстановитьПараметр("Сотрудник", ?(ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам"),ТЧРегистратор.Сотрудник,Регистратор.Сотрудник));
	Если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" или 
		Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛистуПоДоговорамПодряда" Тогда //О.Т. 23.09.2014 № 17616
		Запрос.УстановитьПараметр("ЭтоБольничный", Истина);
	Иначе
		Запрос.УстановитьПараметр("ЭтоБольничный", Ложь);
	КонецЕсли;
	//
	
	СпособыРасчетаПоСреднему = Новый Массив(6);
	СпособыРасчетаПоСреднему[0] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку;
	СпособыРасчетаПоСреднему[1] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС;
	СпособыРасчетаПоСреднему[2] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням;
	СпособыРасчетаПоСреднему[3] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке;
	СпособыРасчетаПоСреднему[4] = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка;
	//СпособыРасчетаПоСреднему[5] = Перечисления.СпособыРасчетаОплатыТруда.ПособиеПоУходуЗаРебенкомДо1_5Лет;
	
	Запрос.УстановитьПараметр("парамСпособыРасчета", СпособыРасчетаПоСреднему);
	
	ПоСреднемуЗаработкуФСС = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС;
	ПоСреднемуЗаработкуОтпуск = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням;
	//БольничныеПереходногоПериода = Новый Массив(7);
	//БольничныеПереходногоПериода[0] = Перечисления.ВариантыАлгоритмовРасчета.БольничныйПереходногоПериодаБезОграничений;
	//БольничныеПереходногоПериода[1] = Перечисления.ВариантыАлгоритмовРасчета.БольничныйПереходногоПериодаСОбщимОграничением;
	//БольничныеПереходногоПериода[2] = Перечисления.ВариантыАлгоритмовРасчета.БольничныйПереходногоПериодаСОбщимОграничениемИБезОграничений;
	//БольничныеПереходногоПериода[3] = Перечисления.ВариантыАлгоритмовРасчета.БольничныйПереходногоПериодаСОбщимОграничениемИВРазмереММОТ;
	//БольничныеПереходногоПериода[4] = Перечисления.ВариантыАлгоритмовРасчета.БольничныйПереходногоПериодаСОграничениемВРазмереММОТ;
	//БольничныеПереходногоПериода[5] = Перечисления.ВариантыАлгоритмовРасчета.БольничныйПереходногоПериодаСОграничениемВРазмереММОТиБезОграничений;
	//БольничныеПереходногоПериода[6] = Перечисления.ВариантыАлгоритмовРасчета.БольничныйПереходногоПериодаСОграничениямиВРазмереММОТиОбщим;
	//
	//Запрос.УстановитьПараметр("БольничныеПереходногоПериода", БольничныеПереходногоПериода);
	если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу"  Тогда //О.Т. 23.09.2014 № 17616
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"//Основной.Регистратор.ПериодРегистрации КАК ПериодРегистрации, Основной.ПериодДействияНачало, Основной.ПериодДействияКонец","Основной.Регистратор.ПериодРегистрации КАК ПериодРегистрации, Основной.ПериодДействияНачало, Основной.ПериодДействияКонец");
	ИначеЕсли строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"//Основной.Регистратор.ПериодРегистрации КАК ПериодРегистрации, Основной.ПериодДействияНачало, Основной.ПериодДействияКонец","Основной.Регистратор.ПериодРегистрации КАК ПериодРегистрации, Основной.БазовыйПериодНачало, Основной.БазовыйПериодКонец");
	иначе
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"//Основной.Регистратор.ПериодРегистрации КАК ПериодРегистрации, Основной.ПериодДействияНачало, Основной.ПериодДействияКонец","Основной.Регистратор.ПериодРегистрации КАК ПериодРегистрации");
	КонецЕсли;
	если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда
		запрос.Текст = "ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Основной.Сотрудник КАК Сотрудник,
		|	Основной.ФизЛицо КАК Физлицо,
		|	Основной.Организация КАК Организация,
		|	Основной.ВидУчетаВремени КАК ВидУчетаВремени,
		|	Основной.ВидРасчета.СпособРасчета КАК СпособРасчета,
		|	РАЗНОСТЬДАТ(Основной.ПериодРасчетаСреднегоЗаработкаНачало, НАЧАЛОПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, МЕСЯЦ), МЕСЯЦ) + 1 КАК ПериодРасчетаСреднегоЗаработка,
		|	Основной.ПериодРасчетаСреднегоЗаработкаНачало КАК НачалоБП,
		|	КОНЕЦПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, ДЕНЬ) КАК КонецБП,
		|	Основной.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
		|	1 КАК КоэффициентИндексации,
		|	0 КАК ТекущаяТарифнаяСтавка,
		|	""Средний"" КАК ВариантЗаполненияСреднего,
		|	Основной.Регистратор.ПериодРегистрации КАК ПериодРегистрации,
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		//|	Основной.БазовыйПериодНачало КАК ПериодДействияНачало,
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		|	НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ ) КАК ПериодДействияНачало,
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		|	Основной.БазовыйПериодКонец КАК ПериодДействияКонец,
		|	NULL КАК Период
		|ИЗ
		|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Основной
		|ГДЕ
		|	Основной.Регистратор = &парамРегистратор
		|	И Основной.ВидРасчета.СпособРасчета В(&парамСпособыРасчета)
		|	И НЕ Основной.Сторно
		|	И ВЫБОР
		|			КОГДА &ЭтоБольничный
		|				ТОГДА Основной.Сотрудник = &Сотрудник
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|
		|УПОРЯДОЧИТЬ ПО
		|	Физлицо,
		|	Сотрудник,
		|	СпособРасчета,
		|	НачалоБП,
		|	КонецБП" ;
	КонецЕсли;
	
	
	Выборка = Запрос.Выполнить().Выгрузить(); //Островская Татьяна 11.09.2013 № 16778
	
	//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
	Если Выборка.Количество() > 0 Тогда
		ПервСтр = Выборка[0];
		ДатаНачалаВыборки = ПервСтр.НачалоБП;
		ДатаОкончанияВыборки = ПервСтр.КонецБП;
		ДатаНачалаСобытия = ПервСтр.ДатаНачалаСобытия;
		МаксимальныйОбъемВыборки = ПервСтр.ПериодРасчетаСреднегоЗаработка;
	КонецЕсли;
	//- СВЭЙ КДЯ 05.09.19 СВФР-004448
	
	ПредыдущаяСтрокаЗаработок	= Неопределено;
	ПредыдущаяСтрокаНеИндексировать	= Неопределено;
	ПредыдущаяСтрокаНеИндексироватьСред	= Неопределено;//О.Т. Аверсон 06.07.2016 № 855
	ПредыдущаяСтрокаПремии		= Неопределено;
	ПредыдущаяСтрокаПремииПоСреднему = Неопределено;//О.Т. Аверсон 06.05.2016 № 1141
	ПредыдущаяСтрокаФиксПремии	= Неопределено;
	
	ТекущийСотрудник			= Неопределено;
	ТекущийСпособ				= Неопределено;
	ТекущийНачалоБП				= Неопределено;
	ТекущийКонецБП				= Неопределено;
	ТекущаяДатаНачалаСобытия	= Неопределено;
	ТекущийКоэффициент			= 1;
	ТекущийВариантЗаполненияСреднего = "";
	
	// предопределенные виды расчета среднего заработка
	//ПоЗаработку		= Неопределено;
	//ПоПремиям		= Неопределено;
	//ПоФиксПремиям	= Неопределено;
	//ПоГодовойПремии	= Неопределено;
	//ПоФиксГодовойПремии	= Неопределено;
	//
	//ПоЗаработкуБЛ			= ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
	//ПоЗаработкуБЛиПособий	= ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуПособий;
	//ПоПремиямБЛ				= ПланыВидовРасчета.СреднийЗаработок.ПоПремиямБЛ;
	//ПоФиксПремиямБЛ			= ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямБЛ;
	//ПоПремиямБЛиПособий		= ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПособий;
	//ПоГодовойПремииБЛ		= ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииБЛ;
	//ПоФиксГодовойПремииБЛ	= ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииБЛ;
	//
	//ПоЗаработкуДо			= ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку;
	//ПоЗаработкуПосле		= ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуИндексируемые;
	//ПоЗаработкуНеИндексируемый = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые;
	//ПоПремиямДо				= ПланыВидовРасчета.СреднийЗаработок.ПоПремиям;
	//ПоПремиямПосле			= ПланыВидовРасчета.СреднийЗаработок.ПоПремиямИндексируемые;
	//ПоПремиямНеИндексируемый = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямНеИндексируемые;
	//ПоФиксПремиямДо			= ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
	//ПоФиксПремиямПосле		= ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямНеИндексируемые;
	//ПоГодовойПремииДо		= ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
	//ПоГодовойПремииПосле	= ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииНеИндексируемые;
	//ПоГодовойПремииИндексируемый = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииИндексируемые;
	//ПоФиксГодовойПремииДо	= ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремии;
	//ПоФиксГодовойПремииПосле = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииНеИндексируемые;
	
	ПоЗаработку = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку;
	ПоЗаработкуБЛ = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
	ПоЗаработкуОтпуск = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
	
	//Аверсон ЕАЕ 14.10.2022 СВФР-009668
	ПоЗаработкуОтпускПриНеполныхМесяцах = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах;
	//Аверсон СВФР-009668
	
	ПоЗаработкуОтпускАгент = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент;//О.Т. Аверсон 16.04.2019 № 4189
	ПоПремиям = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям;
	ПоПремиямПоСреднему = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему;//О.Т. Аверсон 06.05.2016 № 1141
	ПоФиксПремиям = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
	ПоГодовойПремии = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
	//О.Т. Аверсон 12.04.2019 № 4189
	ЭтоАгент = Ложь;
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
		ЭтоАгент = Регистратор.Агент;
	КонецЕсли;
	
	ПоЗаработкуНеИндексируемый = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые;
	ПоЗаработкуНеИндексируемыйАгент = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент;
	ПоЗаработкуНеИндексируемыйСред = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеСред; //О.Т. Аверсон 06.07.2016 № 855
	
	//О.Т. Аверсон 12.04.2019 № 4189
	
	
	//О.Т. Аверсон 29.06.2018 № 2119
	ДатаНачДоговора = Дата(1,1,1);
	ДатаКонецДоговора = Дата(1,1,1);
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда 
		//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
		// Данный фрагмент построен конструктором.
		// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
		
		ЗапросДоговор = Новый Запрос;
		ЗапросДоговор.Текст = 
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		//"ВЫБРАТЬ
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
		|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
		|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания
		|ИЗ
		|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
		|		ПО ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка
		|			И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета
		|			И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
		|			И ДополнительныеНачисленияРаботниковОрганизаций.НомерСтроки = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
		|ГДЕ
		|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
		|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
		|	И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
		|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
		
		//Аверсон ЕАЕ 09.01.2023 СВФР-010128
		|   И ВЫБОР
		|     КОГДА &ДоговорПодряда = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
		|     ТОГДА ИСТИНА
		|     ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = &ДоговорПодряда
		|     КОНЕЦ
		//Аверсон СВФР-010128
		
		|";
		//|И ВЫБОР
		//|	КОГДА &Причина = ЗНАЧЕНИЕ(Перечисление.ПричиныНетрудоспособности.ТравмаНаПроизводстве)
		//|		ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ ДополнительныеНачисленияРаботниковОрганизаций.ПериодРасчетаСреднегоЗаработкаНачало И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРасчетаСреднегоЗаработкаОкончание
		//|	ИНАЧЕ ИСТИНА
		//|КОНЕЦ";
		
		ЗапросДоговор.УстановитьПараметр("Сотрудник", Регистратор.Сотрудник);
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		//ЗапросДоговор.УстановитьПараметр( "ДатаНачала", Регистратор.ДатаНачала );
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		ЗапросДоговор.УстановитьПараметр( "ДатаНачала", ПолучитьРеквизитПервичного( Регистратор, "ДатаНачала" ) );
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		
		//Аверсон ЕАЕ 09.01.2023 СВФР-010128
		ЗапросДоговор.УстановитьПараметр("ДоговорПодряда", Регистратор.ДоговорПодряда);
		//Аверсон СВФР-010128
		
		РезультатЗапросаДоговор = ЗапросДоговор.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапросаДоговор.Выбрать();
		
		
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			ДатаТравмыНаПроизв = ДобавитьМесяц(НачалоМесяца(Регистратор.ДатаНачала),-2);
			
			ДатаНачДоговора = ?( Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,
			Макс( ВыборкаДетальныеЗаписи.ДатаНачала, ДатаТравмыНаПроизв ), 
			ВыборкаДетальныеЗаписи.ДатаНачала );
			ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
			Пока ЗначениеЗаполнено( ПервичныйДог ) Цикл  
				ДатаНачДоговора = ?( Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве, 
				Макс( ПервичныйДог.ДатаНачала, ДатаТравмыНаПроизв ), 
				ПервичныйДог.ДатаНачала );
				
				//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
				//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
				//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				
				//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
				Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
					//защита от зацикливания
					ПервичныйДог = Неопределено;
				Иначе	
					ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
				КонецЕсли; 					   
				//- СВЭЙ КДЯ 02.12.19 СВФР-005149
			КонецЦикла;
			
		КонецЦикла;	
		
		Если ВыборкаДетальныеЗаписи.Количество() = 0 Тогда 
			
			ЗапросДоговор.Текст = 
			"ВЫБРАТЬ
			|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ИЗ
			|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|		ПО ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование
			|ГДЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
			|	И &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
			|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
			
			//Аверсон ЕАЕ 09.01.2023 СВФР-010128
			|   И ВЫБОР
			|     КОГДА &ДоговорПодряда = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|     ТОГДА ИСТИНА
			|     ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = &ДоговорПодряда
			|     КОНЕЦ
			//Аверсон СВФР-010128
			
			|";
			
			//Аверсон ЕАЕ 09.01.2023 СВФР-010128
			ЗапросДоговор.УстановитьПараметр("ДоговорПодряда", Регистратор.ДоговорПодряда);
			//Аверсон СВФР-010128
			
			РезультатЗапроса = ЗапросДоговор.Выполнить();
			
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			СписокДокументов = Новый СписокЗначений;
			
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				ДатаТравмыНаПроизв = ДобавитьМесяц(НачалоМесяца(Регистратор.ДатаНачала),-2);
				
				ДатаНачДоговора = ?(Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаТравмыНаПроизв),ВыборкаДетальныеЗаписи.ДатаНачала);
				СписокДокументов.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
				ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
				Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
					Если ПервичныйДог.Проведен Тогда 
						СписокДокументов.Добавить(ПервичныйДог);
					КонецЕсли;
					
					ДатаНачДоговора = ?(Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ПервичныйДог.ДатаНачала,ДатаТравмыНаПроизв),ПервичныйДог.ДатаНачала);
					
					ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
				КонецЦикла;
				
			КонецЦикла;
			
			ЗапросДоговор.Текст = 
			"ВЫБРАТЬ
			|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ИЗ
			|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
			|		ПО ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка
			|			И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета
			|			И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
			|			И ДополнительныеНачисленияРаботниковОрганизаций.НомерСтроки = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.НомерСтроки
			|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ГДЕ
			|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
			|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
			|	И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
			|	И ДоговорНаВыполнениеРаботСФизЛицом.Ссылка В(&Ссылка)
			|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
			
			//Аверсон ЕАЕ 09.01.2023 СВФР-010128
			|   И ВЫБОР
			|     КОГДА &ДоговорПодряда = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|     ТОГДА ИСТИНА
			|     ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = &ДоговорПодряда
			|     КОНЕЦ
			//Аверсон СВФР-010128
			
			|";
			
			ЗапросДоговор.УстановитьПараметр("Сотрудник", Регистратор.Сотрудник);
			ЗапросДоговор.УстановитьПараметр("ДатаНачала", Регистратор.ДатаНачала);
			ЗапросДоговор.УстановитьПараметр("Ссылка", СписокДокументов);
			
			//Аверсон ЕАЕ 09.01.2023 СВФР-010128
			ЗапросДоговор.УстановитьПараметр("ДоговорПодряда", Регистратор.ДоговорПодряда);
			//Аверсон СВФР-010128
			
			РезультатЗапросаДоговор = ЗапросДоговор.Выполнить();
			
			ВыборкаДетальныеЗаписи = РезультатЗапросаДоговор.Выбрать();
			
			//СписокДокументов = Новый СписокЗначений;
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				ДатаТравмыНаПроизв = ДобавитьМесяц(НачалоМесяца(Регистратор.ДатаНачала),-2);
				
				ДатаНачДоговора = ?(Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаТравмыНаПроизв),ВыборкаДетальныеЗаписи.ДатаНачала);
				Если СписокДокументов.НайтиПоЗначению(ВыборкаДетальныеЗаписи.Ссылка) = Неопределено Тогда
					СписокДокументов.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
				КонецЕсли;
				ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
				Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
					Если ПервичныйДог.Проведен Тогда 
						Если СписокДокументов.НайтиПоЗначению(ВыборкаДетальныеЗаписи.Ссылка) = Неопределено Тогда
							СписокДокументов.Добавить(ПервичныйДог);
						КонецЕсли;
					КонецЕсли;
					ДатаНачДоговора = ?(Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ПервичныйДог.ДатаНачала,ДатаТравмыНаПроизв),ПервичныйДог.ДатаНачала);
					
					ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
				КонецЦикла;
				
			КонецЦикла;
			
			
			//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
			
		КонецЕсли;
		
		
	КонецЕсли;	
	
	//О.Т. Аверсон 29.06.2018 № 2119
	
	// Скопируем структуру набора записей
	ТаблицаЗаписей = НаборЗаписей.Выгрузить();
	
	//Таблица значений для простоев по вине нанимателя
	таблицаПростоев = Новый ТаблицаЗначений;
	ТаблицаПростоев.Колонки.Добавить("МесяцВыборки");
	ТаблицаПростоев.Колонки.Добавить("ВидРасчета");//О.Т. Аверсон 19.01.2016 для нового среднего заработка индексивор
	таблицаПростоев.Колонки.Добавить("НаличиеПростоев");
	//Островская Татьяна 11.09.2013 № 16778
	//Островская Татьяна 11.09.2013 № 16778
	УсловиеДляБПМ = Ложь;
	если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
		строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
		если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда
			УсловиеДляБПМ = Истина;
		иначе
			УсловиеДляБПМ = ложь;
		КонецЕсли;
	КонецЕсли;
	//Островская Татьяна 11.09.2013 № 16778
	
	//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
	если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
		УсловиеПоОкладу = ( Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и ТЗНаборРасчетаНачисления <> Неопределено );
		ЭтоТипРасчетаПоОкладу = ( Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу );
	иначе
		ЭтоТипРасчетаПоОкладу = Ложь;
		УсловиеПоОкладу = Ложь;
	КонецЕсли;
	//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
	
	если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
		строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
		
		если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
			Колич = Выборка.Количество();
			если Колич > 0 Тогда 
				НачалоБПМ = НачалоМесяца(Выборка[0].ПериодДействияНачало);
				КонецБПМ = КонецМесяца(Выборка[Колич-1].ПериодДействияКонец);
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	Выборка = Запрос.Выполнить().Выбрать();
	//Островская Татьяна 11.09.2013 № 16778
	
	// Выборку обходим в порядке убывания дат случаев индексации
	Пока Выборка.Следующий() Цикл
		НачалоБППерем = Выборка.НачалоБП;
		КонецБППерем = Выборка.КонецБП;
		
		// Проверим, не сменился ли работник
		Если ТекущийСотрудник <> Выборка.Сотрудник
			ИЛИ ТекущийСпособ <> Выборка.СпособРасчета
			ИЛИ ТекущийНачалоБП <> НачалоБППерем
			ИЛИ ТекущийКонецБП <> КонецБППерем
			ИЛИ ТекущаяДатаНачалаСобытия <> Выборка.ДатаНачалаСобытия Тогда
			
			
			// Закроем строки по предыдущему работнику
			Если ПредыдущаяСтрокаЗаработок <> Неопределено Тогда
				// закроем последнюю строку по предыдущему работнику
				ПредыдущаяСтрокаЗаработок.БазовыйПериодНачало = ТекущийНачалоБП;
				ПредыдущаяСтрокаНеИндексировать.БазовыйПериодНачало = ТекущийНачалоБП;
				ПредыдущаяСтрокаНеИндексироватьСред.БазовыйПериодНачало = ТекущийНачалоБП;//О.Т. Аверсон 06.07.2016 № 855
				ПредыдущаяСтрокаПремии.БазовыйПериодНачало = ТекущийНачалоБП;
				ПредыдущаяСтрокаПремииПоСреднему.БазовыйПериодНачало = ТекущийНачалоБП;//О.Т. Аверсон 06.05.2016 № 1141
				ПредыдущаяСтрокаФиксПремии.БазовыйПериодНачало = ТекущийНачалоБП;
				ПредыдущаяСтрокаЗаработок = Неопределено;
				ПредыдущаяСтрокаНеИндексировать = Неопределено;
				ПредыдущаяСтрокаНеИндексироватьСред = Неопределено;//О.Т. Аверсон 06.07.2016 № 855
				ПредыдущаяСтрокаПремии = Неопределено;
				ПредыдущаяСтрокаПремииПоСреднему = Неопределено;//О.Т. Аверсон 06.05.2016 № 1141
				ПредыдущаяСтрокаФиксПремии = Неопределено;
			КонецЕсли;
			
			// Запомним новый набор идентификаторов начисления
			ТекущийСотрудник			= Выборка.Сотрудник;
			ТекущийСпособ				= Выборка.СпособРасчета;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
				ТекущийНачалоБП				= ДатаНачДоговора;
				ТекущийКонецБП				= Выборка.ДатаНачалаСобытия;
			иначе
				ТекущийНачалоБП				= ?(УсловиеДляБПМ,НачалоБПМ,НачалоБППерем);
				ТекущийКонецБП				= ?(УсловиеДляБПМ,КонецБПМ,КонецБППерем);
			КонецЕсли;
			ТекущаяДатаНачалаСобытия	= Выборка.ДатаНачалаСобытия;
			ТекущийВариантЗаполненияСреднего = Выборка.ВариантЗаполненияСреднего;
			
			// Инициализируем данные для нового работника
			ТекущийКоэффициент = 1;
			
			// введем вид расчета по годовой премии
			Строка = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоГодовойПремии);
			// при расчете годовой премии в базовый период пишем год, за который начислялась годовая премия 
			Строка.БазовыйПериодНачало 	= НачалоГода(НачалоГода(Выборка.ДатаНачалаСобытия) - 1);
			//Островская Татьяна 21.01.2013 № 16068
			если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
				строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616 
				если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда 
					Строка.БазовыйПериодКонец 	= КонецМесяца(НачалоМесяца(Выборка.ДатаНачалаСобытия));
				Иначе 
					Строка.БазовыйПериодКонец 	= КонецМесяца(НачалоМесяца(Выборка.ДатаНачалаСобытия) - 1);
				КонецЕсли;
			Иначе 
				Строка.БазовыйПериодКонец 	= КонецМесяца(НачалоМесяца(Выборка.ДатаНачалаСобытия) - 1);
			КонецЕсли;
			//Островская Татьяна 21.01.2013 № 16068
			//ТекущаяТарифнаяСтавка = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия, 
			//						Новый Структура("Сотрудник,Организация", Выборка.Сотрудник,Выборка.Организация)).Ставка;
			
			
			ТекущаяТарифнаяСтавка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия, 
			Новый Структура("Сотрудник,Организация", Выборка.Сотрудник,Выборка.Организация)).ТарифнаяСтавкаПервогоРазряда;
			
			Отбор = Новый Структура;
			Отбор.Вставить("Организация", Выборка.Организация);
			Отбор.Вставить("ТарифнаяСтавка",  ТекущаяТарифнаяСтавка);
			
			РазмерТС =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия,Отбор).Размер;
			
			Строка.ТекущаяТарифнаяСтавка = РазмерТС;
			//Строка.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
			//О.Т. Аверсон 16.04.2019 № 4189
			ЭтоАгент = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				ЭтоАгент = Регистратор.Агент;
			КонецЕсли;
			//О.Т. Аверсон 16.04.2019 № 4189
			
			// Создадим по первой строке по работнику для заработка и премии
			
			//Аверсон ЕАЕ 14.10.2022 СВФР-009668
			НеполныйМесяц = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда
				НеполныйМесяц = Регистратор.РасчетПриНеполныхМесяцах;
			КонецЕсли;
			
			//СтрокаЗаработок  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ?(Выборка.СпособРасчета = ПоСреднемуЗаработкуФСС, ПоЗаработкуБЛ, ?(Выборка.СпособРасчета = ПоСреднемуЗаработкуОтпуск, ?(ЭтоАгент,ПоЗаработкуОтпускАгент,ПоЗаработкуОтпуск), ПоЗаработку)));
			СтрокаЗаработок  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ?(Выборка.СпособРасчета = ПоСреднемуЗаработкуФСС, ПоЗаработкуБЛ, ?(Выборка.СпособРасчета = ПоСреднемуЗаработкуОтпуск, ?(ЭтоАгент,ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПоЗаработкуОтпускПриНеполныхМесяцах,ПоЗаработкуОтпуск)), ПоЗаработку)));
			//Аверсон СВФР-009668
			
			СтрокаНеИндексируемый  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ?(ЭтоАгент,ПоЗаработкуНеИндексируемыйАгент,ПоЗаработкуНеИндексируемый));
			СтрокаНеИндексируемыйСред  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоЗаработкуНеИндексируемыйСред);//О.Т. Аверсон 06.07.2016 № 855
			СтрокаПремии  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоПремиям);
			СтрокаПремииПоСреднему  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоПремиямПоСреднему); //О.Т. Аверсон 06.05.2016 № 1141
			СтрокаФиксПремии  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоФиксПремиям);
			
			//О.Т. 09.10.2014 № 17616
			если УсловиеДляБПМ Тогда 
				если не ЗначениеЗаполнено(КонецБПМ) или КонецБПМ = Дата(1,1,31,23,59,59) Тогда
					КонецБПМ = КонецБППерем;
				КонецЕсли;
			КонецЕсли;
			//О.Т. 09.10.2014 № 17616
			СтрокаЗаработок.БазовыйПериодКонец = ?(УсловиеДляБПМ,конецБПМ,КонецБППерем);
			СтрокаНеИндексируемый.БазовыйПериодКонец = ?(УсловиеДляБПМ,конецБПМ,КонецБППерем);
			СтрокаНеИндексируемыйСред.БазовыйПериодКонец = ?(УсловиеДляБПМ,конецБПМ,КонецБППерем); //О.Т. Аверсон 06.07.2016 № 855
			СтрокаПремии.БазовыйПериодКонец = ?(УсловиеДляБПМ,конецБПМ,КонецБППерем);
			СтрокаПремииПоСреднему.БазовыйПериодКонец = ?(УсловиеДляБПМ,конецБПМ,КонецБППерем);//О.Т. Аверсон 06.05.2016 № 1141
			СтрокаФиксПремии.БазовыйПериодКонец = ?(УсловиеДляБПМ,конецБПМ,КонецБППерем);
			
			//СтрокаЗаработок.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
			//СтрокаПремии.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
			//СтрокаФиксПремии.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
			
			СтрокаЗаработок.ТекущаяТарифнаяСтавка = РазмерТС;
			СтрокаНеИндексируемый.ТекущаяТарифнаяСтавка = РазмерТС;
			СтрокаНеИндексируемыйСред.ТекущаяТарифнаяСтавка = РазмерТС; //О.Т. Аверсон 06.07.2016 № 855
			СтрокаПремии.ТекущаяТарифнаяСтавка = РазмерТС;
			СтрокаПремииПоСреднему.ТекущаяТарифнаяСтавка = РазмерТС;//О.Т. Аверсон 06.05.2016 № 1141
			СтрокаФиксПремии.ТекущаяТарифнаяСтавка = РазмерТС;
			
			//толик	ненужны дубдирования		Если Выборка.Период <> NULL и Выборка.Период <= Выборка.КонецБП Тогда
			Если Ложь Тогда
				
				// дозаполним первые строки по работнику
				СтрокаЗаработок.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,НачалоБППерем);
				СтрокаНеИндексируемый.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,НачалоБППерем);
				СтрокаНеИндексируемыйСред.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,НачалоБППерем);//О.Т. Аверсон 06.07.2016 № 855
				СтрокаПремии.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,НачалоБППерем);
				СтрокаПремииПоСреднему.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,НачалоБППерем);//О.Т. Аверсон 06.05.2016 № 1141
				СтрокаФиксПремии.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,НачалоБППерем);
				
				// и создадим еще по одной строке
				СтрокаЗаработок = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ?(Выборка.СпособРасчета = ПоСреднемуЗаработкуФСС, ПоЗаработкуБЛ,?(Выборка.СпособРасчета = ПоСреднемуЗаработкуОтпуск, ?(ЭтоАгент,ПоЗаработкуОтпускАгент,ПоЗаработкуОтпуск), ПоЗаработку)));
				СтрокаНеИндексируемый  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ?(ЭтоАгент,ПоЗаработкуНеИндексируемыйАгент,ПоЗаработкуНеИндексируемый));
				СтрокаНеИндексируемыйСред  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоЗаработкуНеИндексируемыйСред); //О.Т. Аверсон 06.07.2016 № 855
				СтрокаПремии = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоПремиям);
				СтрокаПремииПоСреднему = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоПремиямПоСреднему);//О.Т. Аверсон 06.05.2016 № 1141
				СтрокаФиксПремии = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоФиксПремиям);
				
				
				// дозаполним - знаем все кроме БазовыйПериодНачало
				//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
				//ТекущийКоэффициент = Выборка.КоэффициентИндексации * ТекущийКоэффициент;
				//- СВЭЙ 15.03.19 КДЯ СВФР-004088
				//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
				ТекущийКоэффициент = РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( 
				Выборка.КоэффициентИндексации * ТекущийКоэффициент, ОкруглитьКоэффициентИндексации );
				//- СВЭЙ 15.03.19 КДЯ СВФР-004088
				
				СтрокаЗаработок.БазовыйПериодКонец = КонецБППерем;
				СтрокаНеИндексируемый.БазовыйПериодКонец = КонецБППерем;
				СтрокаНеИндексируемыйСред.БазовыйПериодКонец = КонецБППерем;//О.Т. Аверсон 06.07.2016 № 855
				СтрокаПремии.БазовыйПериодКонец = КонецБППерем;
				СтрокаПремииПоСреднему.БазовыйПериодКонец = КонецБППерем; //О.Т. Аверсон 06.05.2016 № 1141
				СтрокаФиксПремии.БазовыйПериодКонец = КонецБППерем;
				
				//ТекущаяТарифнаяСтавка = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия, 
				//					Новый Структура("Сотрудник,Организация", Выборка.Сотрудник,Выборка.Организация)).Ставка;
				
				ТекущаяТарифнаяСтавка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия, 
				Новый Структура("Сотрудник,Организация", Выборка.Сотрудник,Выборка.Организация)).ТарифнаяСтавкаПервогоРазряда;
				
				РазмерТС =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия, 
				Новый Структура("Организация,ТарифнаяСтавка", Выборка.Организация, ТекущаяТарифнаяСтавка)).Размер;
				
				СтрокаЗаработок.ТекущаяТарифнаяСтавка = РазмерТС;
				СтрокаНеИндексируемый.ТекущаяТарифнаяСтавка = РазмерТС;
				СтрокаНеИндексируемыйСред.ТекущаяТарифнаяСтавка = РазмерТС; //О.Т. Аверсон 06.07.2016 № 855
				СтрокаПремии.ТекущаяТарифнаяСтавка = РазмерТС;
				СтрокаПремииПоСреднему.ТекущаяТарифнаяСтавка = РазмерТС;//О.Т. Аверсон 06.05.2016 № 1141
				СтрокаФиксПремии.ТекущаяТарифнаяСтавка = РазмерТС;
				
				//СтрокаЗаработок.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
				//СтрокаПремии.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
				//СтрокаФиксПремии.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
				
			ИначеЕсли Выборка.Период <> NULL Тогда
				// здесь запомним только Коэффициент ии
				//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
				//ТекущийКоэффициент = Выборка.КоэффициентИндексации * ТекущийКоэффициент;
				//- СВЭЙ 15.03.19 КДЯ СВФР-004088
				//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
				ТекущийКоэффициент = РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( 
				Выборка.КоэффициентИндексации * ТекущийКоэффициент, ОкруглитьКоэффициентИндексации );
				//- СВЭЙ 15.03.19 КДЯ СВФР-004088
			КонецЕсли;
			
			СтрокаЗаработок.КоэффициентИндексации = ТекущийКоэффициент;
			СтрокаНеИндексируемый.КоэффициентИндексации = ТекущийКоэффициент;
			СтрокаНеИндексируемыйСред.КоэффициентИндексации = ТекущийКоэффициент;//О.Т. Аверсон 06.07.2016 № 855
			СтрокаПремии.КоэффициентИндексации = ТекущийКоэффициент;
			СтрокаПремииПоСреднему.КоэффициентИндексации = ТекущийКоэффициент;//О.Т. Аверсон 06.05.2016 № 1141
			СтрокаФиксПремии.КоэффициентИндексации = ТекущийКоэффициент;
			
		Иначе
			//толик	ненужны дубдирования		Если Выборка.Период = NULL или Выборка.Период <= Выборка.КонецБП Тогда	
			Если Ложь Тогда	
				
				// закроем предыдущую строку
				ПредыдущаяСтрокаЗаработок.БазовыйПериодНачало = НачалоБППерем;
				ПредыдущаяСтрокаНеИндексировать.БазовыйПериодНачало = НачалоБППерем;
				ПредыдущаяСтрокаНеИндексироватьСред.БазовыйПериодНачало = НачалоБППерем;//О.Т. Аверсон 06.07.2016 № 855
				ПредыдущаяСтрокаПремии.БазовыйПериодНачало = НачалоБППерем;
				ПредыдущаяСтрокаПремииПоСреднему.БазовыйПериодНачало = НачалоБППерем; //О.Т. Аверсон 06.05.2016 № 1141
				ПредыдущаяСтрокаФиксПремии.БазовыйПериодНачало = НачалоБППерем;
				
				//О.Т. Аверсон 16.04.2019 № 4189
				ЭтоАгент = Ложь;
				Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
					ЭтоАгент = Регистратор.Агент;
				КонецЕсли;
				//О.Т. Аверсон 16.04.2019 № 4189
				// Создадим очередные строки
				СтрокаЗаработок  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ?(Выборка.СпособРасчета = ПоСреднемуЗаработкуФСС, ПоЗаработкуБЛ, ?(Выборка.СпособРасчета = ПоСреднемуЗаработкуОтпуск, ?(ЭтоАгент,ПоЗаработкуОтпускАгент,ПоЗаработкуОтпуск), ПоЗаработку)));
				СтрокаНеИндексируемый  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ?(ЭтоАгент,ПоЗаработкуНеИндексируемыйАгент,ПоЗаработкуНеИндексируемый));
				СтрокаНеИндексируемыйСред  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоЗаработкуНеИндексируемыйСред);//О.Т. Аверсон 06.07.2016 № 855
				СтрокаПремии  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоПремиям);
				СтрокаПремииПоСреднему = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоПремиямПоСреднему);//О.Т. Аверсон 06.05.2016 № 1141
				СтрокаФиксПремии  = СоздатьСтрокуРасчетаСреднего(Выборка, ТаблицаЗаписей, Регистратор, ПоФиксПремиям);
				
				// дозаполним - знаем все кроме БазовыйПериодНачало
				ТекущийКоэффициент = 1;
				
				//ТекущаяТарифнаяСтавка = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия, 
				//					Новый Структура("Сотрудник,Организация", Выборка.Сотрудник,Выборка.Организация)).Ставка;
				//					
				ТекущаяТарифнаяСтавка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия, 
				Новый Структура("Сотрудник,Организация", Выборка.Сотрудник,Выборка.Организация)).ТарифнаяСтавкаПервогоРазряда;
				
				РазмерТС =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия, 
				Новый Структура("Организация,ТарифнаяСтавка", Выборка.Организация, ТекущаяТарифнаяСтавка)).Размер;
				
				СтрокаЗаработок.ТекущаяТарифнаяСтавка = РазмерТС;
				СтрокаНеИндексируемый.ТекущаяТарифнаяСтавка = РазмерТС;
				СтрокаНеИндексируемыйСред.ТекущаяТарифнаяСтавка = РазмерТС;//О.Т. Аверсон 06.07.2016 № 855
				СтрокаПремии.ТекущаяТарифнаяСтавка = РазмерТС;
				СтрокаПремииПоСреднему.ТекущаяТарифнаяСтавка = РазмерТС;//О.Т. Аверсон 06.05.2016 № 1141
				СтрокаФиксПремии.ТекущаяТарифнаяСтавка = РазмерТС;
				
				//СтрокаЗаработок.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
				//СтрокаПремии.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
				//СтрокаФиксПремии.ТекущаяТарифнаяСтавка = ТекущаяТарифнаяСтавка;
				//
				СтрокаЗаработок.БазовыйПериодКонец = КонецБППерем;
				СтрокаНеИндексируемый.БазовыйПериодКонец = КонецБППерем;
				СтрокаНеИндексируемыйСред.БазовыйПериодКонец = КонецБППерем;//О.Т. Аверсон 06.07.2016 № 855
				СтрокаПремии.БазовыйПериодКонец = КонецБППерем;
				СтрокаПремииПоСреднему.БазовыйПериодКонец = КонецБППерем;//О.Т. Аверсон 06.05.2016 № 1141
				СтрокаФиксПремии.БазовыйПериодКонец = КонецБППерем;
				
				СтрокаЗаработок.КоэффициентИндексации = ТекущийКоэффициент;
				СтрокаНеИндексируемый.КоэффициентИндексации = ТекущийКоэффициент;
				СтрокаНеИндексируемыйСред.КоэффициентИндексации = ТекущийКоэффициент;//О.Т. Аверсон 06.07.2016 № 855
				СтрокаПремии.КоэффициентИндексации = ТекущийКоэффициент;
				СтрокаПремииПоСреднему.КоэффициентИндексации = ТекущийКоэффициент;//О.Т. Аверсон 06.05.2016 № 1141
				СтрокаФиксПремии.КоэффициентИндексации = ТекущийКоэффициент;
				
			Иначе
				// здесь запомним только КоэффициентИндексации
				ТекущийКоэффициент = ТекущийКоэффициент;
			КонецЕсли;
		КонецЕсли;
		
		// Сохраним для следующей итерации
		ПредыдущаяСтрокаЗаработок = СтрокаЗаработок;
		ПредыдущаяСтрокаНеИндексировать = СтрокаНеИндексируемый;
		ПредыдущаяСтрокаНеИндексироватьСред = СтрокаНеИндексируемыйСред;//О.Т. Аверсон 06.07.2016 № 855
		ПредыдущаяСтрокаПремии = СтрокаПремии;
		ПредыдущаяСтрокаПремииПоСреднему = СтрокаПремииПоСреднему;//О.Т. Аверсон 06.05.2016 № 1141
		ПредыдущаяСтрокаФиксПремии = СтрокаФиксПремии;
		
		
		// Расчет минимальной и максимальной из дат начала и окончания расчетных периодов 
		//(эти данные нужны для процедуры ПолучитьДанныеДляРасчета
		Если ДатаНачалаРасчетаСреднего = Дата('00010101') Тогда
			ДатаНачалаРасчетаСреднего = НачалоБППерем;
		Иначе
			ДатаНачалаРасчетаСреднего = Мин(ДатаНачалаРасчетаСреднего, НачалоБППерем);
		КонецЕсли;
		Если ДатаОкончанияРасчетаСреднего = Дата('00010101') Тогда
			ДатаОкончанияРасчетаСреднего = КонецБППерем;
		Иначе
			ДатаОкончанияРасчетаСреднего = Макс(ДатаОкончанияРасчетаСреднего, КонецБППерем);
		КонецЕсли;
		//Островская Татьяна 11.09.2013 № 16778
		если не ЗначениеЗаполнено(НачалоБПМ) Тогда
			НачалоБПМ = ДатаНачалаРасчетаСреднего;
		КонецЕсли;
		если не ЗначениеЗаполнено(КонецБПМ) или КонецБПМ = Дата(1,1,31,23,59,59) Тогда
			КонецБПМ = ДатаОкончанияРасчетаСреднего;
		КонецЕсли;
		если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
			строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
			если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
				ДатаНачалаРасчетаСреднего = НачалоБПМ;
				ДатаОкончанияРасчетаСреднего = КонецБПМ;
			КонецЕсли;
		КонецЕсли;
		//Островская Татьяна 11.09.2013 № 16778
		
	КонецЦикла; // Выборка.Следующий()
	
	// Закроем строки по последнему работнику
	Если ПредыдущаяСтрокаЗаработок <> Неопределено Тогда
		// закроем последнюю строку по предыдущему работнику
		ПредыдущаяСтрокаЗаработок.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,ТекущийНачалоБП);
		ПредыдущаяСтрокаНеИндексировать.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,ТекущийНачалоБП);
		ПредыдущаяСтрокаНеИндексироватьСред.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,ТекущийНачалоБП);//О.Т. Аверсон 06.07.2016 № 855
		ПредыдущаяСтрокаПремии.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,ТекущийНачалоБП);
		ПредыдущаяСтрокаПремииПоСреднему.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,ТекущийНачалоБП); //О.Т. Аверсон 06.05.2016 № 1141
		ПредыдущаяСтрокаФиксПремии.БазовыйПериодНачало = ?(УсловиеДляБПМ,НачалоБПМ,ТекущийНачалоБП);
	КонецЕсли;
	
	// Загрузим полученные периоды в набор записей
	ТаблицаЗаписей.Сортировать("Сотрудник, СпособРасчета, ДатаНачалаРасчетногоПериода, ДатаОкончанияРасчетногоПериода, БазовыйПериодНачало, ТекущаяТарифнаяСтавка");
	// Загрузим полученные периоды в набор записей
	НаборЗаписей.Загрузить(ТаблицаЗаписей);
	
	// Зафиксируем нарезанные записи
	НаборЗаписей.Записать();
	
	////////////////////////////////////////////////////////////////////////////////
	// базовые данные для расчета ресурсов
	
	//толик добавил детализацию по виду расчета убрал комментировать запрос
	//	Если КомментироватьРасчет Тогда
	
	
	
	ЗапросРазрезы = Новый Запрос;
	//Островская Татьяна 15.04.2014 № 17275
	//Островская Татьяна 15.04.2014 № 17275
	ЗапросРазрезы.Текст =
	"ВЫБРАТЬ
	|	ЕСТЬNULL(СУММА(База.РезультатБаза), 0) КАК Результат,";
	
	//Аверсон 21.06.2022 КВВ СВФР-009217 (
	Если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" Тогда
		ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
		|	НАЧАЛОПЕРИОДА(База.ПериодРегистрации, МЕСЯЦ) КАК МесяцВыборки,";
	Иначе
		ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
		|	НАЧАЛОПЕРИОДА(База.ПериодРегистрацииРазрез, МЕСЯЦ) КАК МесяцВыборки,";
	КонецЕсли;
	ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
	//Аверсон 21.06.2022 КВВ СВФР-009217 )
	
	|	База.ВидРасчетаРазрез КАК ВидРасчета,
	|	ЕСТЬNULL(СУММА(База.ОтработаноДнейБаза), 0) КАК ОтработаноДней,
	|	ЕСТЬNULL(СУММА(База.ОтработаноЧасовБаза), 0) КАК ОтработаноЧасов,";
	
	//Аверсон 21.06.2022 КВВ СВФР-009217 (
	Если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" Тогда
		ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
		|	НАЧАЛОПЕРИОДА(База.ПериодРегистрацииРазрез, МЕСЯЦ) КАК ПериодРегистрации,";
	Иначе
		ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
		|	База.ПериодРегистрации,";
	КонецЕсли;
	ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
	//Аверсон 21.06.2022 КВВ СВФР-009217 )
	
	|	&парамРегистратор КАК Документ,
	|	База.Тип,
	|	ЕСТЬNULL(СУММА(База.РезультатБаза), 0) КАК НачисленнаяЗП
	|ИЗ
	|	(ВЫБРАТЬ
	|		БазаОсновныеНачисления.РезультатБаза КАК РезультатБаза,
	|		БазаОсновныеНачисления.ПериодДействияРазрез КАК ПериодРегистрацииРазрез,
	|		БазаОсновныеНачисления.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
	|		БазаОсновныеНачисления.ОтработаноДнейБаза КАК ОтработаноДнейБаза,
	|		БазаОсновныеНачисления.ОтработаноЧасовБаза КАК ОтработаноЧасовБаза,
	|		БазаОсновныеНачисления.ПериодРегистрацииРазрез КАК ПериодРегистрации,
	|		0 КАК Тип
	|	ИЗ
	|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
	|				&парамИзмерения,
	|				&парамИзмерения,
	|				&парамРазрезы,
	|				Регистратор = &парамРегистратор
	|					И ВидРасчета В (&парамЗаработок)) КАК БазаОсновныеНачисления
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		БазаДополнительныеНачисления.РезультатБаза,
	|		БазаДополнительныеНачисления.ПериодРегистрацииРазрез,
	|		БазаДополнительныеНачисления.ВидРасчетаРазрез,
	|		NULL,
	|		NULL,
	|		БазаДополнительныеНачисления.ПериодРегистрацииРазрез,
	|		0
	|	ИЗ
	|		РегистрРасчета.РасчетСреднегоЗаработка.БазаДополнительныеНачисленияРаботниковОрганизаций(
	|				&парамИзмерения,
	|				&парамИзмерения,
	|				&парамРазрезыДоп,
	|				Регистратор = &парамРегистратор
	|					И ВидРасчета В (&парамЗаработок)) КАК БазаДополнительныеНачисления";
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
		
		//Аверсон ЕАЕ 11.01.2023 СВФР-010128
		ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
		|ГДЕ ВЫБОР
		|    КОГДА &ДоговорПодряда = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
		|    ТОГДА ИСТИНА
		|    ИНАЧЕ БазаДополнительныеНачисления.ДокументОснованиеРазрез = &ДоговорПодряда
		|    КОНЕЦ
		|";
		ЗапросРазрезы.УстановитьПараметр("ДоговорПодряда", Регистратор.ДоговорПодряда);
		//Аверсон СВФР-010128
		
		ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
		|	СГРУППИРОВАТЬ ПО
		|	БазаДополнительныеНачисления.ВидРасчетаРазрез,
		|	БазаДополнительныеНачисления.РезультатБаза,
		|	БазаДополнительныеНачисления.ПериодРегистрацииРазрез,
		|	БазаДополнительныеНачисления.ПериодРегистрацииРазрез ";
		
	КонецЕсли;
	
	ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "	
	
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Дополнительные.Результат,
	|		Дополнительные.ПериодРегистрации,
	|		Дополнительные.ВидРасчета,
	|		NULL,
	|		NULL,
	|		Дополнительные.БазовыйПериодНачало,
	|		1
	|	ИЗ
	|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
	|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
	|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций)
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Дополнительные
	|			ПО (Дополнительные.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
	|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец) //О.Т. Аверсон 29.11.2016 № 53(поменяла период рег на базовый)
	|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
	|				И (Дополнительные.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
	|	ГДЕ
	|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
	|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоПремии)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Основные.Результат,
	|		Основные.ПериодРегистрации,
	|		Основные.ВидРасчета,
	|		NULL,
	|		NULL,
	|		Основные.ПериодДействияНачало,
	|		1
	|	ИЗ
	|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
	|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
	|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основные
	|			ПО (Основные.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
	|				И (НАЧАЛОПЕРИОДА(Основные.ПериодРегистрации, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
	|				И (НАЧАЛОПЕРИОДА(Основные.ПериодРегистрации, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
	|				И (Основные.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
	|	ГДЕ
	|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
	|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоПремии)) КАК База
	|
	|СГРУППИРОВАТЬ ПО
	|	База.ВидРасчетаРазрез,";
	
	//Аверсон 21.06.2022 КВВ СВФР-009217 (
	Если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" Тогда
		ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
		//|	База.ПериодРегистрации,
		|	НАЧАЛОПЕРИОДА(База.ПериодРегистрации, МЕСЯЦ),";
	Иначе
		ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
		|	База.ПериодРегистрации,";
	КонецЕсли;
	ЗапросРазрезы.Текст = ЗапросРазрезы.Текст + "
	//Аверсон 21.06.2022 КВВ СВФР-009217 )
	
	|	База.Тип,
	|	НАЧАЛОПЕРИОДА(База.ПериодРегистрацииРазрез, МЕСЯЦ)"; //О.Т. Аверсон 16.10.2015 № 630 (убрано внутр соед) //Островская Татьяна 06.06.2014 № 17416
	//Островская Татьяна 15.04.2014 № 17275 (Добавление в Базу Основные начисления)
	РазрезыРасшифрока = Новый Массив(3);
	РазрезыРасшифрока[0] = "ПериодДействия";
	РазрезыРасшифрока[1] = "ВидРасчета";
	РазрезыРасшифрока[2] = "ПериодРегистрации";
	
	//Аверсон ЕАЕ 11.01.2023 СВФР-010128
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
		РазмерМассива = 4;
	Иначе
		РазмерМассива = 3;
	КонецЕсли;
	//РазрезыРасшифрокаДоп = Новый Массив(3);
	РазрезыРасшифрокаДоп = Новый Массив(РазмерМассива);
	//Аверсон СВФР-010128
	
	РазрезыРасшифрокаДоп[0] = "ПериодРегистрации";
	РазрезыРасшифрокаДоп[1] = "ЧислоМесяцев";
	РазрезыРасшифрокаДоп[2] = "ВидРасчета";
	
	если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
		
		//Аверсон ЕАЕ 11.01.2023 СВФР-010128
		РазрезыРасшифрокаДоп[3] = "ДокументОснование";
		//Аверсон СВФР-010128
		
		
		Запрос.УстановитьПараметр("Сотрудник", Регистратор.Сотрудник);
		Запрос.УстановитьПараметр("ДатаНачала", ТекущийНачалоБП);
		Запрос.УстановитьПараметр("ДатаОкончания", ТекущийКонецБП);
		Запрос.УстановитьПараметр("ДатаНачалаБЛ", Регистратор.ДатаНачала);
		Запрос.УстановитьПараметр("ДатаОкончания1", НачалоМесяца(ТекущийКонецБП)-1);
		ПоПремии = Новый Массив;
		ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
		ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему);//О.Т. Аверсон 06.05.2016 № 1141
		ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
		
		Запрос.УстановитьПараметр("парамПоПремии",	ПоПремии);
		//О.Т. 04.09.2014 № 17567
		СписокИзГруппыРасчетов = Новый СписокЗначений;
		если Регистратор.Организация.НормаВОтпускахПоГрРасчетов и (ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам")
			или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда
			Для каждого стрВидРасчета Из Регистратор.Организация.ГруппаРасчета.Основные Цикл
				СписокИзГруппыРасчетов.Добавить(стрВидРасчета.ВидРасчета);	
			КонецЦикла; 
		КонецЕсли;
		Запрос.УстановитьПараметр("СписокИзГруппыРасчетов",СписокИзГруппыРасчетов);
		//О.Т. 04.09.2014 № 17567
		
		Заработок = Новый Массив;
		Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
		Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
		Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск);
		Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент);//О.Т. Аверсон 16.04.2019 № 4189
		Запрос.УстановитьПараметр("парамЗаработок",Заработок);
		
		//Аверсон ЕАЕ 09.01.2023 СВФР-010128
		Запрос.УстановитьПараметр("ДоговорПодряда", Регистратор.ДоговорПодряда);
		//Аверсон СВФР-010128
		
		Запрос.Текст = "
		//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		//оптимизация запроса 3
		|	ВЫБРАТЬ
		|		РасчетСреднегоЗаработка.НомерСтроки,
		|		РасчетСреднегоЗаработка.Регистратор,
		|		РасчетСреднегоЗаработка.ПериодРегистрации,
		|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
		|		РасчетСреднегоЗаработка.Сотрудник,
		|		РасчетСреднегоЗаработка.ВидРасчета,
		|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
		|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
		|		РасчетСреднегоЗаработка.ВидУчетаВремени
		|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработка
		|	ИЗ
		|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
		|	ГДЕ
		|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
		|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамЗаработок)
		|;
		//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		//толик изменил месяц выборки
		|ВЫБРАТЬ
		|	СУММА(ЕСТЬNULL(База.РезультатБаза, 0)) КАК РезультатБаза,
		|	База.ЧислоМесяцев,
		|	База.ПериодРасчетаСреднегоЗаработка,
		|	База.ПериодРегистрацииРазрез КАК МесяцВыборки,
		|	База.НомерСтроки КАК НомерСтроки,
		|	База.ВидУчетаВремени,
		|	СУММА(База.ВключенВГруппуРасчетов) КАК ВключенВГруппуРасчетов,
		|	База.ДатаДоговора,
		|	База.НомерДоговора,
		|	База.ДатаНачалаДоговора,
		|	База.ДатаОкончанияДоговора,
		|	База.ДатаНачалаОснДог,
		|	База.ДатаОкончанияОснДог,
		|	База.Ссылка
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВложенныйЗапрос.Результат КАК РезультатБаза,
		|		ВЫБОР
		|			КОГДА ВложенныйЗапрос.ЧислоМесяцев = 0
		|				ТОГДА 1
		|			ИНАЧЕ ВложенныйЗапрос.ЧислоМесяцев
		|		КОНЕЦ КАК ЧислоМесяцев,
		|		0 КАК ПериодРасчетаСреднегоЗаработка,
		|		НАЧАЛОПЕРИОДА(ВложенныйЗапрос.ПериодРегистрации, МЕСЯЦ) КАК ПериодРегистрацииРазрез,
		|		ВложенныйЗапрос.НомерСтроки КАК НомерСтроки,
		|		ВложенныйЗапрос.ВидУчетаВремени КАК ВидУчетаВремени,
		|		СУММА(ВЫБОР
		|				КОГДА ВложенныйЗапрос.ВидРасчета В (&СписокИзГруппыРасчетов)
		|					ТОГДА 1
		|				ИНАЧЕ 0
		|			КОНЕЦ) КАК ВключенВГруппуРасчетов,
		|		ВложенныйЗапрос.Сотрудник КАК Сотрудник,
		|		ДоговорНаВыполнениеРаботСФизЛицом.Дата КАК ДатаДоговора,
		|		ДоговорНаВыполнениеРаботСФизЛицом.Номер КАК НомерДоговора,
		|		ВложенныйЗапрос.БазовыйПериодНачало КАК ДатаНачалаДоговора,
		|		ВложенныйЗапрос.БазовыйПериодКонец КАК ДатаОкончанияДоговора,
		|		ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачалаОснДог,
		|		ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончанияОснДог,
		|		ДоговорНаВыполнениеРаботСФизЛицом.Ссылка КАК Ссылка
		|	ИЗ
		|		(ВЫБРАТЬ
		|			ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации КАК ПериодРегистрации,
		|			ДополнительныеНачисленияРаботниковОрганизаций.Регистратор КАК Регистратор,
		|			РасчетСреднегоЗаработка.НомерСтроки КАК НомерСтроки,
		|			ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
		|			ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
		|			ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
		|			ДополнительныеНачисленияРаботниковОрганизаций.Организация КАК Организация,
		|			ДополнительныеНачисленияРаботниковОрганизаций.Результат КАК Результат,
		|			ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|			ДополнительныеНачисленияРаботниковОрганизаций.ЧислоМесяцев КАК ЧислоМесяцев,
		|			ДополнительныеНачисленияРаботниковОрганизаций.ВидУчетаВремени КАК ВидУчетаВремени,
		|			ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало КАК БазовыйПериодНачало,
		|			ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец КАК БазовыйПериодКонец,
		|			ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование КАК ДокументОснование
		|		ИЗ
		//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		//оптимизация запроса 3
		//|			РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
		//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		//оптимизация запроса 3
		|			ВтРасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
		//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		|				ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
		|				ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
		|					И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций)
		|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|				ПО РасчетСреднегоЗаработка.Сотрудник = ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
		|					И (НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) <= ВЫБОР
		|							КОГДА &ДатаОкончания > РасчетСреднегоЗаработка.БазовыйПериодКонец
		|								ТОГДА КОНЕЦПЕРИОДА(&ДатаОкончания, МЕСЯЦ)
		|							ИНАЧЕ РасчетСреднегоЗаработка.БазовыйПериодКонец
		|						КОНЕЦ)
		//	|					И (НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
		|					И (ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
		|					И (ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
		|		ГДЕ
		//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		//оптимизация запроса 3
		//|			РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
		//|			И РасчетСреднегоЗаработка.ВидРасчета В(&парамЗаработок) И 
		//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		|			ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0) КАК ВложенныйЗапрос
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
		|			ПО ВложенныйЗапрос.Регистратор = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка
		|				И ВложенныйЗапрос.ВидРасчета = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета
		|				И ВложенныйЗапрос.Сотрудник = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
		|				И ВложенныйЗапрос.НомерСтроки = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.НомерСтроки
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		|			ПО ВложенныйЗапрос.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
		|	ГДЕ
		|		ВложенныйЗапрос.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
		|		И ВложенныйЗапрос.Сотрудник = &Сотрудник
		|		И &ДатаОкончания МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
		|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
		
		//Аверсон ЕАЕ 09.01.2023 СВФР-010128
		|   И ВЫБОР
		|     КОГДА &ДоговорПодряда = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
		|     ТОГДА ИСТИНА
		|     ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = &ДоговорПодряда
		|     КОНЕЦ
		//Аверсон СВФР-010128
		
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДоговорНаВыполнениеРаботСФизЛицом.Дата,
		|		ДоговорНаВыполнениеРаботСФизЛицом.Номер,
		|		ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,
		|		ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания,
		|		ДоговорНаВыполнениеРаботСФизЛицом.Ссылка,
		|		ВложенныйЗапрос.Результат,
		|		ВЫБОР
		|			КОГДА ВложенныйЗапрос.ЧислоМесяцев = 0
		|				ТОГДА 1
		|			ИНАЧЕ ВложенныйЗапрос.ЧислоМесяцев
		|		КОНЕЦ,
		|		НАЧАЛОПЕРИОДА(ВложенныйЗапрос.ПериодРегистрации, МЕСЯЦ),
		|		ВложенныйЗапрос.НомерСтроки,
		|		ВложенныйЗапрос.ВидУчетаВремени,
		|		ВложенныйЗапрос.Сотрудник,
		|		ВложенныйЗапрос.БазовыйПериодНачало,
		|		ВложенныйЗапрос.БазовыйПериодКонец) КАК База
		|
		|СГРУППИРОВАТЬ ПО
		|	База.ПериодРегистрацииРазрез,
		|	База.ПериодРасчетаСреднегоЗаработка,
		|	База.НомерСтроки,
		|	База.ВидУчетаВремени,
		|	База.ЧислоМесяцев,
		|	База.ДатаДоговора,
		|	База.НомерДоговора,
		|	База.ДатаНачалаДоговора,
		|	База.ДатаОкончанияДоговора,
		|	База.ДатаНачалаОснДог,
		|	База.ДатаОкончанияОснДог,
		|	База.Ссылка
		|
		|УПОРЯДОЧИТЬ ПО
		|	НомерСтроки
		//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		//оптимизация запроса 3
		|;
		|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработка
		//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		|";
		ВыборкаБазы = Запрос.Выполнить().Выгрузить();
		СписокДокументов = Новый СписокЗначений;
		Для Каждого стр из ВыборкаБазы Цикл
			ПервичныйДог = стр.Ссылка.ПервичныйДоговор;
			СписокДокументов.Добавить( стр.Ссылка );
			Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
				Если ПервичныйДог.Проведен Тогда 
					СписокДокументов.Добавить(ПервичныйДог);
				КонецЕсли;
				
				
				//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
				//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
				//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				
				//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
				Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
					//защита от зацикливания
					ПервичныйДог = Неопределено;
				Иначе	
					ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
				КонецЕсли; 					   
				//- СВЭЙ КДЯ 02.12.19 СВФР-005149
			КонецЦикла;
		КонецЦикла;
		
		
		Если ВыборкаБазы.Количество() = 0 Тогда 
			ЗапросДоговор = Новый Запрос;
			ЗапросДоговор.Текст = 
			"ВЫБРАТЬ
			|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ИЗ
			|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|		ПО ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование
			|ГДЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
			|	И &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
			|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен";
			
			ЗапросДоговор.УстановитьПараметр("ДатаНачала", ТекущийКонецБП);
			ЗапросДоговор.УстановитьПараметр("Сотрудник", Регистратор.Сотрудник);
			
			РезультатЗапроса = ЗапросДоговор.Выполнить();
			
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			СписокДокументов = Новый СписокЗначений;
			
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				ДатаТравмыНаПроизв = ДобавитьМесяц(НачалоМесяца(Регистратор.ДатаНачала),-2);
				
				ДатаНачДоговора = ?(Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаТравмыНаПроизв),ВыборкаДетальныеЗаписи.ДатаНачала);
				СписокДокументов.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
				ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
				Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
					Если ПервичныйДог.Проведен Тогда 
						СписокДокументов.Добавить(ПервичныйДог);
					КонецЕсли;
					
					ДатаНачДоговора = ?(Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ПервичныйДог.ДатаНачала,ДатаТравмыНаПроизв),ПервичныйДог.ДатаНачала);
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
						//защита от зацикливания
						ПервичныйДог = Неопределено;
					Иначе	
						ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					КонецЕсли; 					   
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				КонецЦикла;
				
			КонецЦикла;
			Если Регистратор.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве Тогда 
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"И &ДатаОкончания МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания","И ДоговорНаВыполнениеРаботСФизЛицом.Ссылка В(&Ссылка) и НАЧАЛОПЕРИОДА(ВложенныйЗапрос.ПериодРегистрации, МЕСЯЦ) между &ДНТравма и &ДКТравма");
			иначе
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"И &ДатаОкончания МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания","И ДоговорНаВыполнениеРаботСФизЛицом.Ссылка В(&Ссылка)");
			КонецЕсли;  
			Запрос.УстановитьПараметр("Ссылка", СписокДокументов);
			ДатаТравмыНаПроизв = ДобавитьМесяц(НачалоМесяца(Регистратор.ДатаНачала),-2);
			Запрос.УстановитьПараметр("ДНТравма", ДатаТравмыНаПроизв);
			Запрос.УстановитьПараметр("ДКТравма", НачалоМесяца(ТекущийКонецБП)-1);
			
			
			ВыборкаБазы = Запрос.Выполнить().Выгрузить();
			//СписокДокументов = Новый СписокЗначений;
			Для Каждого стр из ВыборкаБазы Цикл
				ПервичныйДог = стр.Ссылка.ПервичныйДоговор;
				Если СписокДокументов.НайтиПоЗначению(ВыборкаДетальныеЗаписи.Ссылка) = Неопределено Тогда 
					СписокДокументов.Добавить(стр.Ссылка);
				КонецЕсли;
				
				Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
					Если ПервичныйДог.Проведен Тогда 
						Если СписокДокументов.НайтиПоЗначению(ВыборкаДетальныеЗаписи.Ссылка) = Неопределено Тогда
							СписокДокументов.Добавить(ПервичныйДог);
						КонецЕсли;
					КонецЕсли;
					
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
						//защита от зацикливания
						ПервичныйДог = Неопределено;
					Иначе	
						ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					КонецЕсли; 					   
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				КонецЦикла;
			КонецЦикла;
			
			
			
		КонецЕсли;
		
		
		
		
		
		
		
		БЛПоДоговорамТекМес = Ложь;
		Если ВыборкаБазы.Количество() = 0 Тогда 
			Запрос.УстановитьПараметр("ДатаОкончания", КонецМесяца(ТекущийКонецБП));
			Запрос.УстановитьПараметр("ДатаОкончания1", КонецМесяца(ТекущийКонецБП));
			
			ВыборкаБазы = Запрос.Выполнить().Выгрузить();
			Для Каждого стр из ВыборкаБазы Цикл
				ПервичныйДог = стр.Ссылка.ПервичныйДоговор;
				СписокДокументов.Добавить(стр.Ссылка);
				Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
					Если ПервичныйДог.Проведен Тогда 
						СписокДокументов.Добавить(ПервичныйДог);
					КонецЕсли;
					
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
						//защита от зацикливания
						ПервичныйДог = Неопределено;
					Иначе	
						ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					КонецЕсли; 					   
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				КонецЦикла;
			КонецЦикла;
			
			
			БЛПоДоговорамТекМес = Истина;
		КонецЕсли;
		
		
		
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"И &ДатаОкончания МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания","И ДоговорНаВыполнениеРаботСФизЛицом.Ссылка В(&Ссылка) И ВложенныйЗапрос.ПериодРегистрации <= &ДатаОкончания1");
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"//УсловиеТравма","И ВЫБОР КОГДА &Причина = ЗНАЧЕНИЕ(Перечисление.ПричиныНетрудоспособности.ТравмаНаПроизводстве) ТОГДА ВложенныйЗапрос.ПериодРегистрации МЕЖДУ &ДатаНачала И &ДатаОкончания ИНАЧЕ ИСТИНА КОНЕЦ");
		Запрос.УстановитьПараметр("Ссылка",СписокДокументов);
		Запрос.УстановитьПараметр("Причина", Регистратор.ПричинаНетрудоспособности);
		
		ВыборкаБазы = Запрос.Выполнить().Выгрузить();
		
		
		БЛПоДоговорамТекМес = Ложь;
		Если ВыборкаБазы.Количество() = 0 Тогда 
			Запрос.УстановитьПараметр("ДатаОкончания", КонецМесяца(ТекущийКонецБП));
			Запрос.УстановитьПараметр("ДатаОкончания1", КонецМесяца(ТекущийКонецБП));
			
			ВыборкаБазы = Запрос.Выполнить().Выгрузить();
			Для Каждого стр из ВыборкаБазы Цикл
				ПервичныйДог = стр.Ссылка.ПервичныйДоговор;
				СписокДокументов.Добавить(стр.Ссылка);
				Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
					Если ПервичныйДог.Проведен Тогда 
						СписокДокументов.Добавить(ПервичныйДог);
					КонецЕсли;
					
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
						//защита от зацикливания
						ПервичныйДог = Неопределено;
					Иначе	
						ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					КонецЕсли; 					   
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				КонецЦикла;
			КонецЦикла;
			
			
			БЛПоДоговорамТекМес = Истина;
		КонецЕсли;
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончанияОснДог,","ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончанияОснДог");
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"ДоговорНаВыполнениеРаботСФизЛицом.Ссылка КАК Ссылка","");
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"База.ДатаОкончанияОснДог,","База.ДатаОкончанияОснДог");
		Запрос.Текст = СтрЗаменить(Запрос.Текст,"База.Ссылка","");
		
		
		
		
	иначе
		
		//	Иначе
		//Островская Татьяна 19.09.2013 № 16727
		Если Регистратор.Организация.ДеноминацияКаждогоНачисления или ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
			Запрос.Текст = "
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса  :   Исходное время выполнения = 122.229285 сек;   Оптимизированное время выполнения  = 1.7889 сек   
			|	ВЫБРАТЬ
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.Регистратор,
			|		РасчетСреднегоЗаработка.ПериодРегистрации,
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		РасчетСреднегоЗаработка.Сотрудник,
			|		РасчетСреднегоЗаработка.ВидРасчета,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени
			|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработка
			|	ИЗ
			|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|	ГДЕ
			|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			|;
			|	ВЫБРАТЬ
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.Сотрудник,
			|		РасчетСреднегоЗаработка.ВидРасчета,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени
			|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработкаЗаработок
			|	ИЗ
			|		ВтРасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|	ГДЕ
			|		РасчетСреднегоЗаработка.ВидРасчета В(&парамЗаработок)
			|	ИНДЕКСИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.Сотрудник, 	
			|		РасчетСреднегоЗаработка.ВидРасчета 	
			|;
			|	ВЫБРАТЬ
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.Сотрудник,
			|		РасчетСреднегоЗаработка.ВидРасчета,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени
			|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработкаПремия
			|	ИЗ
			|		ВтРасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|	ГДЕ
			|		РасчетСреднегоЗаработка.ВидРасчета В(&парамПоПремии)
			|	ИНДЕКСИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.Сотрудник, 	
			|		РасчетСреднегоЗаработка.ВидРасчета 	
			|;
			|	ВЫБРАТЬ
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.Регистратор,
			|		РасчетСреднегоЗаработка.ПериодРегистрации,
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		РасчетСреднегоЗаработка.Сотрудник,
			|		РасчетСреднегоЗаработка.ВидРасчета,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени
			|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработкаГодоваяПремия
			|	ИЗ
			|		ВтРасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|	ГДЕ
			|		РасчетСреднегоЗаработка.ВидРасчета В(&парамПоГодовойПремии)
			|	ИНДЕКСИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.Сотрудник, 	
			|		РасчетСреднегоЗаработка.ВидРасчета 	
			|;
			|	ВЫБРАТЬ
			|		БазаОсновныеНачисления.ПериодРегистрацииРазрез,
			|		БазаОсновныеНачисления.ПериодДействияРазрез,
			|		БазаОсновныеНачисления.РезультатБаза,
			|		БазаОсновныеНачисления.НомерСтроки,
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		БазаОсновныеНачисления.ВидРасчета,
			|		БазаОсновныеНачисления.ВидРасчетаРазрез
			|	ПОМЕСТИТЬ ВтБазаОсновныеНачисления
			|	ИЗ
			|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
			|				&парамИзмерения,
			|				&парамИзмерения,
			|				&парамРазрезы,
			|				Регистратор = &парамРегистратор
			|					) КАК БазаОсновныеНачисления
			|;
			|	ВЫБРАТЬ
			|		БазаДополнительныеНачисления.ПериодРегистрацииРазрез,
			|		БазаДополнительныеНачисления.БазовыйПериодНачало,
			|		БазаДополнительныеНачисления.РезультатБаза,
			|		БазаДополнительныеНачисления.НомерСтроки,
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		БазаДополнительныеНачисления.ВидРасчета,
			|		БазаДополнительныеНачисления.ВидРасчетаРазрез
			|	ПОМЕСТИТЬ ВтБазаДополнительныеНачисления
			|	ИЗ
			|		РегистрРасчета.РасчетСреднегоЗаработка.БазаДополнительныеНачисленияРаботниковОрганизаций(
			|				&парамИзмерения,
			|				&парамИзмерения,
			|				&парамРазрезыДоп,
			|				Регистратор = &парамРегистратор
			|					) КАК БазаДополнительныеНачисления
			|;
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//толик изменил месяц выборки
			|ВЫБРАТЬ
			|	СУММА(ЕСТЬNULL(База.РезультатБаза, 0)) КАК РезультатБаза,
			|	База.ЧислоМесяцев,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|	База.ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|	База.ПериодРасчетаСреднегоЗаработка,
			|	База.ПериодРегистрацииРазрез КАК МесяцВыборки,
			|	База.НомерСтроки КАК НомерСтроки,
			|	База.Начало,
			|	База.Конец,
			|	База.БПНачало,
			|	База.БПКонец,
			|	База.ВидУчетаВремени,
			|	СУММА(База.ВключенВГруппуРасчетов) КАК ВключенВГруппуРасчетов
			|ИЗ
			|	(ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ПериодРегистрацииРазрез < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(БазаОсновныеНачисления.РезультатБаза / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА БазаОсновныеНачисления.ПериодРегистрацииРазрез >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА БазаОсновныеНачисления.РезультатБаза * 10000
			|				ИНАЧЕ БазаОсновныеНачисления.РезультатБаза
			|			КОНЕЦ) КАК РезультатБаза,
			|		1 КАК ЧислоМесяцев,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0 КАК ПериодРасчетаСреднегоЗаработка,
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ) КАК ПериодРегистрацииРазрез,
			|		БазаОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|		NULL КАК Начало,
			|		NULL КАК Конец,
			|		NULL КАК БПНачало,
			|		NULL КАК БПКонец,
			|		БазаОсновныеНачисления.ВидУчетаВремени КАК ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ) КАК ВключенВГруппуРасчетов
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезы,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработок)) КАК БазаОсновныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтБазаОсновныеНачисления КАК БазаОсновныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработок)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		БазаОсновныеНачисления.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(Дополнительные.Результат / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА Дополнительные.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА Дополнительные.Результат * 10000
			|				ИНАЧЕ Дополнительные.Результат
			|			КОНЕЦ),
			|		ВЫБОР
			|			КОГДА Дополнительные.ЧислоМесяцев = 0
			|				ТОГДА 1
			|			ИНАЧЕ Дополнительные.ЧислоМесяцев
			|		КОНЕЦ,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		ВЫБОР
			|			КОГДА Дополнительные.Организация.ПремияВОтпускахПоМесяцуНачисления
			|					И Дополнительные.ВидРасчета.ВидПремии = ЗНАЧЕНИЕ(Перечисление.ВидыПремии.Премия)
			|				ТОГДА НАЧАЛОПЕРИОДА(Дополнительные.ПериодРегистрации, МЕСЯЦ)
			|			ИНАЧЕ НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ)
			|		КОНЕЦ,
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтРасчетСреднегоЗаработкаЗаработок КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций)
			|			ПОЛНОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Дополнительные
			|			ПО (Дополнительные.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (Дополнительные.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамЗаработок)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		ВЫБОР
			|			КОГДА Дополнительные.ЧислоМесяцев = 0
			|				ТОГДА 1
			|			ИНАЧЕ Дополнительные.ЧислоМесяцев
			|		КОНЕЦ,
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		ВЫБОР
			|			КОГДА Дополнительные.Организация.ПремияВОтпускахПоМесяцуНачисления
			|					И Дополнительные.ВидРасчета.ВидПремии = ЗНАЧЕНИЕ(Перечисление.ВидыПремии.Премия)
			|				ТОГДА НАЧАЛОПЕРИОДА(Дополнительные.ПериодРегистрации, МЕСЯЦ)
			|			ИНАЧЕ НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ)
			|		КОНЕЦ
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(Дополнительные.Результат / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА Дополнительные.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА Дополнительные.Результат * 10000
			|				ИНАЧЕ Дополнительные.Результат
			|			КОНЕЦ),
			|		ВЫБОР
			|			КОГДА Дополнительные.ЧислоМесяцев = 0
			|				ТОГДА 1
			|			ИНАЧЕ Дополнительные.ЧислоМесяцев
			|		КОНЕЦ,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			//+ СВЭЙ КДЯ 08.01.20 СВФР-005268
			//|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			//|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			//- СВЭЙ КДЯ 08.01.20 СВФР-005268
			//+ СВЭЙ КДЯ 08.01.20 СВФР-005268
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			//- СВЭЙ КДЯ 08.01.20 СВФР-005268
			|		ЕСТЬNULL(Дополнительные.БазовыйПериодНачало, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		ЕСТЬNULL(Дополнительные.БазовыйПериодКонец, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтРасчетСреднегоЗаработкаПремия КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций)
			|			ПОЛНОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Дополнительные
			|			ПО (Дополнительные.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (Дополнительные.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоПремии)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		ЕСТЬNULL(Дополнительные.БазовыйПериодНачало, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		ЕСТЬNULL(Дополнительные.БазовыйПериодКонец, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		ВЫБОР
			|			КОГДА Дополнительные.ЧислоМесяцев = 0
			|				ТОГДА 1
			|			ИНАЧЕ Дополнительные.ЧислоМесяцев
			|		КОНЕЦ,
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(Дополнительные.Результат / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА Дополнительные.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА Дополнительные.Результат * 10000
			|				ИНАЧЕ Дополнительные.Результат
			|			КОНЕЦ),
			|		Дополнительные.ЧислоМесяцев,
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
			////+ СВЭЙ КДЯ 04.09.19 СВФР-004448
			//|		СреднийЗаработокБазовыеВидыРасчета.ВидРасчета = ЗНАЧЕНИЕ( ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Годовая ) КАК ЭтоГодоваяПремия, 
			////- СВЭЙ КДЯ 04.09.19 СВФР-004448
			//- СВЭЙ КДЯ 12.12.19 СВФР-004448
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
			|		СреднийЗаработокБазовыеВидыРасчета.ВидРасчета В ( &МассивГодовыхПремий ) КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 12.12.19 СВФР-004448
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		НАЧАЛОПЕРИОДА(Дополнительные.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		NULL,
			|		NULL,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтРасчетСреднегоЗаработкаГодоваяПремия КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Дополнительные
			|			ПО (Дополнительные.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.ПериодРегистрации, МЕСЯЦ) <= РасчетСреднегоЗаработка.ПериодРегистрации)
			|				И (Дополнительные.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			|				И (Дополнительные.БазовыйПериодНачало >= Выбор когда РасчетСреднегоЗаработка.Регистратор ссылка Документ.ОплатаПоСреднемуЗаработку тогда
			|						ДОБАВИТЬКДАТЕ(РасчетСреднегоЗаработка.БазовыйПериодНачало, МЕСЯЦ, -1) иначе РасчетСреднегоЗаработка.БазовыйПериодНачало конец)
			|				И (Дополнительные.БазовыйПериодНачало <= РасчетСреднегоЗаработка.БазовыйПериодКонец)  //О.Т. Аверсон 19.01.2018 № 1457
			|				И (Дополнительные.БазовыйПериодКонец > Выбор когда РасчетСреднегоЗаработка.Регистратор ссылка Документ.ОплатаПоСреднемуЗаработку тогда 
			|						ДОБАВИТЬКДАТЕ(РасчетСреднегоЗаработка.БазовыйПериодНачало, МЕСЯЦ, -1) иначе РасчетСреднегоЗаработка.БазовыйПериодНачало конец) //О.Т. Аверсон 19.01.2018 № 1457
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоГодовойПремии)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(Дополнительные.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		Дополнительные.ЧислоМесяцев,
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
			////+ СВЭЙ КДЯ 04.09.19 СВФР-004448
			//|		СреднийЗаработокБазовыеВидыРасчета.ВидРасчета = ЗНАЧЕНИЕ( ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Годовая ), 
			////- СВЭЙ КДЯ 04.09.19 СВФР-004448
			//- СВЭЙ КДЯ 12.12.19 СВФР-004448
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
			|		СреднийЗаработокБазовыеВидыРасчета.ВидРасчета В ( &МассивГодовыхПремий ), 
			//- СВЭЙ КДЯ 12.12.19 СВФР-004448
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		РасчетСреднегоЗаработка.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА ОсновныеНачисления.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(ОсновныеНачисления.Результат / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА ОсновныеНачисления.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ОсновныеНачисления.Результат * 10000
			|				ИНАЧЕ ОсновныеНачисления.Результат
			|			КОНЕЦ),
			|		12,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		NULL,
			|		NULL,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА ОсновныеНачисления.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтРасчетСреднегоЗаработкаГодоваяПремия КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|			ПО (ОсновныеНачисления.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (ОсновныеНачисления.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			|				И (ОсновныеНачисления.ПериодРегистрации <= РасчетСреднегоЗаработка.ПериодРегистрации)
			|				И (ВЫБОР
			|					КОГДА ОсновныеНачисления.ВидРасчета.ПериодДействияБазовый
			|						ТОГДА ОсновныеНачисления.ПериодДействияНачало
			|					ИНАЧЕ ОсновныеНачисления.БазовыйПериодНачало
			|				КОНЕЦ >= Выбор когда РасчетСреднегоЗаработка.Регистратор ссылка Документ.ОплатаПоСреднемуЗаработку тогда
			|						ДОБАВИТЬКДАТЕ(РасчетСреднегоЗаработка.БазовыйПериодНачало, МЕСЯЦ, -1) иначе РасчетСреднегоЗаработка.БазовыйПериодНачало конец) //О.Т. Аверсон 19.01.2018 № 1457
			|				И (ВЫБОР
			|					КОГДА ОсновныеНачисления.ВидРасчета.ПериодДействияБазовый
			|						ТОГДА ОсновныеНачисления.ПериодДействияНачало
			|					ИНАЧЕ ОсновныеНачисления.БазовыйПериодНачало
			|				КОНЕЦ <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			|				И (ВЫБОР
			|					КОГДА ОсновныеНачисления.ВидРасчета.ПериодДействияБазовый
			|						ТОГДА ОсновныеНачисления.ПериодДействияКонец
			|					ИНАЧЕ ОсновныеНачисления.БазовыйПериодКонец
			|				КОНЕЦ > Выбор когда РасчетСреднегоЗаработка.Регистратор ссылка Документ.ОплатаПоСреднемуЗаработку тогда
			|						ДОБАВИТЬКДАТЕ(РасчетСреднегоЗаработка.БазовыйПериодНачало, МЕСЯЦ, -1) иначе РасчетСреднегоЗаработка.БазовыйПериодНачало конец) //О.Т. Аверсон 19.01.2018 № 1457
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоГодовойПремии)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		РасчетСреднегоЗаработка.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(ОсновныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ОсновныеНачисленияРаботниковОрганизаций.Результат * 10000
			|				ИНАЧЕ ОсновныеНачисленияРаботниковОрганизаций.Результат
			|			КОНЕЦ),
			|		NULL,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			//+ СВЭЙ КДЯ 08.01.20 СВФР-005268
			//|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			//|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			//- СВЭЙ КДЯ 08.01.20 СВФР-005268
			//+ СВЭЙ КДЯ 08.01.20 СВФР-005268
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			//- СВЭЙ КДЯ 08.01.20 СВФР-005268
			|		ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтРасчетСреднегоЗаработкаПремия КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			|			ПО (ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			|				И (НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
			|				И (ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоПремии)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		РасчетСреднегоЗаработка.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ПериодРегистрацииРазрез < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(БазаОсновныеНачисления.РезультатБаза / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА БазаОсновныеНачисления.ПериодРегистрацииРазрез >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА БазаОсновныеНачисления.РезультатБаза * 10000
			|				ИНАЧЕ БазаОсновныеНачисления.РезультатБаза
			|			КОНЕЦ),
			|		0,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезы,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработокНеИндексировать)) КАК БазаОсновныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтБазаОсновныеНачисления КАК БазаОсновныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработокНеИндексировать)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		БазаОсновныеНачисления.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА БазаДополнительныеНачисления.ПериодРегистрацииРазрез < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(БазаДополнительныеНачисления.РезультатБаза / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА БазаДополнительныеНачисления.ПериодРегистрацииРазрез >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА БазаДополнительныеНачисления.РезультатБаза * 10000
			|				ИНАЧЕ БазаДополнительныеНачисления.РезультатБаза
			|			КОНЕЦ),
			|		0,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.ПериодРегистрацииРазрез, МЕСЯЦ),
			|		БазаДополнительныеНачисления.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаДополнительныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаДополнительныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезыДоп,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработокНеИндексировать)) КАК БазаДополнительныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтБазаДополнительныеНачисления КАК БазаДополнительныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработокНеИндексировать)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.ПериодРегистрацииРазрез, МЕСЯЦ),
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		БазаДополнительныеНачисления.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ПериодРегистрацииРазрез < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(БазаОсновныеНачисления.РезультатБаза / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА БазаОсновныеНачисления.ПериодРегистрацииРазрез >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА БазаОсновныеНачисления.РезультатБаза * 10000
			|				ИНАЧЕ БазаОсновныеНачисления.РезультатБаза
			|			КОНЕЦ),
			|		0,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезы,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработокНеИндексироватьСред)) КАК БазаОсновныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтБазаОсновныеНачисления КАК БазаОсновныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработокНеИндексироватьСред)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		БазаОсновныеНачисления.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ВЫБОР
			|				КОГДА БазаДополнительныеНачисления.ПериодРегистрацииРазрез < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА ВЫРАЗИТЬ(БазаДополнительныеНачисления.РезультатБаза / 10000 КАК ЧИСЛО(15, 2))
			|				КОГДА БазаДополнительныеНачисления.ПериодРегистрацииРазрез >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|						И НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ) < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|					ТОГДА БазаДополнительныеНачисления.РезультатБаза * 10000
			|				ИНАЧЕ БазаДополнительныеНачисления.РезультатБаза
			|			КОНЕЦ),
			|		0,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.ПериодРегистрацииРазрез, МЕСЯЦ),
			|		БазаДополнительныеНачисления.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаДополнительныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаДополнительныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезыДоп,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработокНеИндексироватьСред)) КАК БазаДополнительныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|		ВтБазаДополнительныеНачисления КАК БазаДополнительныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработокНеИндексироватьСред)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.ПериодРегистрацииРазрез, МЕСЯЦ),
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		БазаДополнительныеНачисления.НомерСтроки) КАК База
			|
			|СГРУППИРОВАТЬ ПО
			|	База.ПериодРегистрацииРазрез,
			|	База.ПериодРасчетаСреднегоЗаработка,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|	База.ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|	База.НомерСтроки,
			|	База.Начало,
			|	База.Конец,
			|	База.БПНачало,
			|	База.БПКонец,
			|	База.ВидУчетаВремени,
			|	База.ЧислоМесяцев
			|
			|УПОРЯДОЧИТЬ ПО
			|	НомерСтроки
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса
			|;
			|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработка;
			|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработкаЗаработок;
			|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработкаПремия;
			|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработкаГодоваяПремия;
			|УНИЧТОЖИТЬ	ВтБазаОсновныеНачисления;
			|УНИЧТОЖИТЬ	ВтБазаДополнительныеНачисления;
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|";
			
		иначе
			
			Запрос.Текст = "
			//толик изменил месяц выборки
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2  :   Исходное время выполнения = 120.43 сек;   Оптимизированное время выполнения  = 2.664287 сек
			|	ВЫБРАТЬ
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.Регистратор,
			|		РасчетСреднегоЗаработка.ПериодРегистрации,
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		РасчетСреднегоЗаработка.Сотрудник,
			|		РасчетСреднегоЗаработка.ВидРасчета,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени
			|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработка
			|	ИЗ
			|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|	ГДЕ
			|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			|;
			|	ВЫБРАТЬ
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.Сотрудник,
			|		РасчетСреднегоЗаработка.ВидРасчета,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени
			|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработкаЗаработок
			|	ИЗ
			|		ВтРасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|	ГДЕ
			|		РасчетСреднегоЗаработка.ВидРасчета В(&парамЗаработок)
			|	ИНДЕКСИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.Сотрудник, 	
			|		РасчетСреднегоЗаработка.ВидРасчета 	
			|;
			|	ВЫБРАТЬ
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.Сотрудник,
			|		РасчетСреднегоЗаработка.ВидРасчета,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени
			|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработкаПремия
			|	ИЗ
			|		ВтРасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|	ГДЕ
			|		РасчетСреднегоЗаработка.ВидРасчета В(&парамПоПремии)
			|	ИНДЕКСИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.Сотрудник, 	
			|		РасчетСреднегоЗаработка.ВидРасчета 	
			|;
			|	ВЫБРАТЬ
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.Регистратор,
			|		РасчетСреднегоЗаработка.ПериодРегистрации,
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		РасчетСреднегоЗаработка.Сотрудник,
			|		РасчетСреднегоЗаработка.ВидРасчета,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени
			|	ПОМЕСТИТЬ ВтРасчетСреднегоЗаработкаГодоваяПремия
			|	ИЗ
			|		ВтРасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|	ГДЕ
			|		РасчетСреднегоЗаработка.ВидРасчета В(&парамПоГодовойПремии)
			|	ИНДЕКСИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.Сотрудник, 	
			|		РасчетСреднегоЗаработка.ВидРасчета 	
			|;
			|	ВЫБРАТЬ
			|		БазаОсновныеНачисления.ПериодРегистрацииРазрез,
			|		БазаОсновныеНачисления.ПериодДействияРазрез,
			|		БазаОсновныеНачисления.РезультатБаза,
			|		БазаОсновныеНачисления.НомерСтроки,
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		БазаОсновныеНачисления.ВидРасчета,
			|		БазаОсновныеНачисления.ВидРасчетаРазрез
			|	ПОМЕСТИТЬ ВтБазаОсновныеНачисления
			|	ИЗ
			|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
			|				&парамИзмерения,
			|				&парамИзмерения,
			|				&парамРазрезы,
			|				Регистратор = &парамРегистратор
			|					) КАК БазаОсновныеНачисления
			|;
			|	ВЫБРАТЬ
			|		БазаДополнительныеНачисления.ПериодРегистрацииРазрез,
			|		БазаДополнительныеНачисления.БазовыйПериодНачало,
			|		БазаДополнительныеНачисления.РезультатБаза,
			|		БазаДополнительныеНачисления.НомерСтроки,
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		БазаДополнительныеНачисления.ВидРасчета,
			|		БазаДополнительныеНачисления.ВидРасчетаРазрез
			|	ПОМЕСТИТЬ ВтБазаДополнительныеНачисления
			|	ИЗ
			|		РегистрРасчета.РасчетСреднегоЗаработка.БазаДополнительныеНачисленияРаботниковОрганизаций(
			|				&парамИзмерения,
			|				&парамИзмерения,
			|				&парамРазрезыДоп,
			|				Регистратор = &парамРегистратор
			|					) КАК БазаДополнительныеНачисления
			|;
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|ВЫБРАТЬ
			|	СУММА(ЕСТЬNULL(База.РезультатБаза, 0)) КАК РезультатБаза,
			|	База.ЧислоМесяцев,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|	База.ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|	База.ПериодРасчетаСреднегоЗаработка,
			|	База.ПериодРегистрацииРазрез КАК МесяцВыборки,
			|	База.НомерСтроки КАК НомерСтроки,
			|	База.Начало,
			|	База.Конец,";
			
			//Аверсон 23.06.2022 КВВ СВФР-009217 (
			//|	База.БПНачало,
			//|	База.БПКонец,
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
				Запрос.Текст = Запрос.Текст + "
				|	НАЧАЛОПЕРИОДА(База.БПНачало,МЕСЯЦ) КАК БПНачало,  
				|	КОНЕЦПЕРИОДА(База.БПКонец,МЕСЯЦ) КАК БПКонец,";     
			Иначе
				Запрос.Текст = Запрос.Текст + "
				|	База.БПНачало,  
				|	База.БПКонец,";     
			КонецЕсли;
			Запрос.Текст = Запрос.Текст + "
			//Аверсон 23.06.2022 КВВ СВФР-009217 )
			
			|	База.ВидУчетаВремени,
			|	СУММА(База.ВключенВГруппуРасчетов) КАК ВключенВГруппуРасчетов
			|ИЗ
			|	(ВЫБРАТЬ
			|		СУММА(БазаОсновныеНачисления.РезультатБаза) КАК РезультатБаза,
			|		1 КАК ЧислоМесяцев,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0 КАК ПериодРасчетаСреднегоЗаработка,
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ) КАК ПериодРегистрацииРазрез,
			|		БазаОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|		NULL КАК Начало,
			|		NULL КАК Конец,
			|		NULL КАК БПНачало,
			|		NULL КАК БПКонец,
			|		БазаОсновныеНачисления.ВидУчетаВремени КАК ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ) КАК ВключенВГруппуРасчетов
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезы,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработок)) КАК БазаОсновныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтБазаОсновныеНачисления КАК БазаОсновныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработок)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		БазаОсновныеНачисления.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(Дополнительные.Результат),
			|		ВЫБОР
			|			КОГДА Дополнительные.ЧислоМесяцев = 0
			|				ТОГДА 1
			|			ИНАЧЕ Дополнительные.ЧислоМесяцев
			|		КОНЕЦ,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтРасчетСреднегоЗаработкаЗаработок КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций)
			|			ПОЛНОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Дополнительные
			|			ПО (Дополнительные.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (Дополнительные.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамЗаработок)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		ВЫБОР
			|			КОГДА Дополнительные.ЧислоМесяцев = 0
			|				ТОГДА 1
			|			ИНАЧЕ Дополнительные.ЧислоМесяцев
			|		КОНЕЦ,
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(Дополнительные.Результат),
			|		ВЫБОР
			|			КОГДА Дополнительные.ЧислоМесяцев = 0
			|				ТОГДА 1
			|			ИНАЧЕ Дополнительные.ЧислоМесяцев
			|		КОНЕЦ,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			//+ СВЭЙ КДЯ 08.01.20 СВФР-005268
			//|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			//|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			//- СВЭЙ КДЯ 08.01.20 СВФР-005268
			//+ СВЭЙ КДЯ 08.01.20 СВФР-005268
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			//- СВЭЙ КДЯ 08.01.20 СВФР-005268
			|		ЕСТЬNULL(Дополнительные.БазовыйПериодНачало, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		ЕСТЬNULL(Дополнительные.БазовыйПериодКонец, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтРасчетСреднегоЗаработкаПремия КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций)
			|			ПОЛНОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Дополнительные
			|			ПО (Дополнительные.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (Дополнительные.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоПремии)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		ЕСТЬNULL(Дополнительные.БазовыйПериодНачало, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		ЕСТЬNULL(Дополнительные.БазовыйПериодКонец, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		ВЫБОР
			|			КОГДА Дополнительные.ЧислоМесяцев = 0
			|				ТОГДА 1
			|			ИНАЧЕ Дополнительные.ЧислоМесяцев
			|		КОНЕЦ,
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		НАЧАЛОПЕРИОДА(Дополнительные.БазовыйПериодНачало, МЕСЯЦ)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(Дополнительные.Результат),
			|		Дополнительные.ЧислоМесяцев,
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
			////+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			//|		СреднийЗаработокБазовыеВидыРасчета.ВидРасчета = ЗНАЧЕНИЕ( ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Годовая ) КАК ЭтоГодоваяПремия, 
			////- СВЭЙ КДЯ 08.10.19 СВФР-004899
			//- СВЭЙ КДЯ 12.12.19 СВФР-004448
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
			|		СреднийЗаработокБазовыеВидыРасчета.ВидРасчета В ( &МассивГодовыхПремий ) КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 12.12.19 СВФР-004448
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка КАК ПериодРасчетаСреднегоЗаработка,
			|		НАЧАЛОПЕРИОДА(Дополнительные.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		NULL,
			|		NULL,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА Дополнительные.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтРасчетСреднегоЗаработкаГодоваяПремия КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Дополнительные
			|			ПО (Дополнительные.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (НАЧАЛОПЕРИОДА(Дополнительные.ПериодРегистрации, МЕСЯЦ) <= РасчетСреднегоЗаработка.ПериодРегистрации)
			|				И (Дополнительные.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			|				И (Дополнительные.БазовыйПериодНачало >= Выбор когда РасчетСреднегоЗаработка.Регистратор ссылка Документ.ОплатаПоСреднемуЗаработку тогда //О.Т. Аверсон 19.01.2018 № 1457
			|						ДОБАВИТЬКДАТЕ(РасчетСреднегоЗаработка.БазовыйПериодНачало, МЕСЯЦ, -1) иначе РасчетСреднегоЗаработка.БазовыйПериодНачало конец)
			|				И (Дополнительные.БазовыйПериодНачало <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			|				И (Дополнительные.БазовыйПериодКонец > Выбор когда РасчетСреднегоЗаработка.Регистратор ссылка Документ.ОплатаПоСреднемуЗаработку тогда //О.Т. Аверсон 19.01.2018 № 1457
			|						ДОБАВИТЬКДАТЕ(РасчетСреднегоЗаработка.БазовыйПериодНачало, МЕСЯЦ, -1) иначе РасчетСреднегоЗаработка.БазовыйПериодНачало конец)
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоГодовойПремии)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(Дополнительные.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		Дополнительные.ЧислоМесяцев,
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
			////+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			//|		СреднийЗаработокБазовыеВидыРасчета.ВидРасчета = ЗНАЧЕНИЕ( ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Годовая ), 
			////- СВЭЙ КДЯ 08.10.19 СВФР-004899
			//- СВЭЙ КДЯ 12.12.19 СВФР-004448
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
			|		СреднийЗаработокБазовыеВидыРасчета.ВидРасчета В ( &МассивГодовыхПремий ), 
			//- СВЭЙ КДЯ 12.12.19 СВФР-004448
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		РасчетСреднегоЗаработка.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ОсновныеНачисления.Результат),
			|		12,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		NULL,
			|		NULL,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА ОсновныеНачисления.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтРасчетСреднегоЗаработкаГодоваяПремия КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|			ПО (ОсновныеНачисления.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (ОсновныеНачисления.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			|				И (ОсновныеНачисления.ПериодРегистрации <= РасчетСреднегоЗаработка.ПериодРегистрации)
			|				И (ВЫБОР
			|					КОГДА ОсновныеНачисления.ВидРасчета.ПериодДействияБазовый
			|						ТОГДА ОсновныеНачисления.ПериодДействияНачало
			|					ИНАЧЕ ОсновныеНачисления.БазовыйПериодНачало
			|				КОНЕЦ >= Выбор когда РасчетСреднегоЗаработка.Регистратор ссылка Документ.ОплатаПоСреднемуЗаработку тогда
			|						ДОБАВИТЬКДАТЕ(РасчетСреднегоЗаработка.БазовыйПериодНачало, МЕСЯЦ, -1) иначе РасчетСреднегоЗаработка.БазовыйПериодНачало конец) //О.Т. Аверсон 19.01.2018 № 1457
			|				И (ВЫБОР
			|					КОГДА ОсновныеНачисления.ВидРасчета.ПериодДействияБазовый
			|						ТОГДА ОсновныеНачисления.ПериодДействияНачало
			|					ИНАЧЕ ОсновныеНачисления.БазовыйПериодНачало
			|				КОНЕЦ <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			|				И (ВЫБОР
			|					КОГДА ОсновныеНачисления.ВидРасчета.ПериодДействияБазовый
			|						ТОГДА ОсновныеНачисления.ПериодДействияКонец
			|					ИНАЧЕ ОсновныеНачисления.БазовыйПериодКонец
			|				КОНЕЦ > Выбор когда РасчетСреднегоЗаработка.Регистратор ссылка Документ.ОплатаПоСреднемуЗаработку тогда
			|						ДОБАВИТЬКДАТЕ(РасчетСреднегоЗаработка.БазовыйПериодНачало, МЕСЯЦ, -1) иначе РасчетСреднегоЗаработка.БазовыйПериодНачало конец) //О.Т. Аверсон 19.01.2018 № 1457
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоГодовойПремии)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка,
			|		РасчетСреднегоЗаработка.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(ОсновныеНачисленияРаботниковОрганизаций.Результат),
			|		NULL,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.НомерСтроки,
			//+ СВЭЙ КДЯ 08.01.20 СВФР-005268
			//|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			//|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			//- СВЭЙ КДЯ 08.01.20 СВФР-005268
			//+ СВЭЙ КДЯ 08.01.20 СВФР-005268
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			//- СВЭЙ КДЯ 08.01.20 СВФР-005268
			|		ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтРасчетСреднегоЗаработкаПремия КАК РасчетСреднегоЗаработка
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
			|			ПО РасчетСреднегоЗаработка.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.Ссылка
			|				И (СреднийЗаработокБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			|			ПО (ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета)
			|				И (НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			|				И (НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)
			// ПСА 18.03.2021 СВФР-007350 +++
			|				И (НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, МЕСЯЦ) <= РасчетСреднегоЗаработка.БазовыйПериодКонец)
			|				И (НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) >= РасчетСреднегоЗаработка.БазовыйПериодНачало)			
			// +++ ПСА 18.03.2021 СВФР-007350
			|				И (ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = РасчетСреднегоЗаработка.Сотрудник)
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|	ГДЕ
			//|		РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
			//|		И РасчетСреднегоЗаработка.ВидРасчета В(&парамПоПремии)
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
			|		РасчетСреднегоЗаработка.БазовыйПериодКонец,
			|		РасчетСреднегоЗаработка.БазовыйПериодНачало,
			|		ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец, ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)),
			|		РасчетСреднегоЗаработка.ВидУчетаВремени,
			|		РасчетСреднегоЗаработка.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(БазаОсновныеНачисления.РезультатБаза),
			|		0,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезы,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработокНеИндексировать)) КАК БазаОсновныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтБазаОсновныеНачисления КАК БазаОсновныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработокНеИндексировать)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		БазаОсновныеНачисления.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(БазаДополнительныеНачисления.РезультатБаза),
			|		0,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.ПериодРегистрацииРазрез, МЕСЯЦ),
			|		БазаДополнительныеНачисления.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаДополнительныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаДополнительныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезыДоп,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработокНеИндексировать)) КАК БазаДополнительныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтБазаДополнительныеНачисления КАК БазаДополнительныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработокНеИндексировать)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.ПериодРегистрацииРазрез, МЕСЯЦ),
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		БазаДополнительныеНачисления.НомерСтроки
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(БазаОсновныеНачисления.РезультатБаза),
			|		0,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаОсновныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаОсновныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезы,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработокНеИндексироватьСред)) КАК БазаОсновныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтБазаОсновныеНачисления КАК БазаОсновныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработокНеИндексироватьСред)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаОсновныеНачисления.ПериодДействияРазрез, МЕСЯЦ),
			|		БазаОсновныеНачисления.ВидУчетаВремени,
			|		БазаОсновныеНачисления.НомерСтроки
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		СУММА(БазаДополнительныеНачисления.РезультатБаза),
			|		0,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		Ложь КАК ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|		0,
			|		НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.ПериодРегистрацииРазрез, МЕСЯЦ),
			|		БазаДополнительныеНачисления.НомерСтроки,
			|		NULL,
			|		NULL,
			|		NULL,
			|		NULL,
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		СУММА(ВЫБОР
			|				КОГДА БазаДополнительныеНачисления.ВидРасчетаРазрез В (&СписокИзГруппыРасчетов)
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ)
			|	ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			//|		РегистрРасчета.РасчетСреднегоЗаработка.БазаДополнительныеНачисленияРаботниковОрганизаций(
			//|				&парамИзмерения,
			//|				&парамИзмерения,
			//|				&парамРазрезыДоп,
			//|				Регистратор = &парамРегистратор
			//|					И ВидРасчета В (&парамЗаработокНеИндексироватьСред)) КАК БазаДополнительныеНачисления
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|		ВтБазаДополнительныеНачисления КАК БазаДополнительныеНачисления
			|	ГДЕ	
			|		ВидРасчета В (&парамЗаработокНеИндексироватьСред)
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(БазаДополнительныеНачисления.ПериодРегистрацииРазрез, МЕСЯЦ),
			|		БазаДополнительныеНачисления.ВидУчетаВремени,
			|		БазаДополнительныеНачисления.НомерСтроки ) КАК База
			|
			|СГРУППИРОВАТЬ ПО
			|	База.ПериодРегистрацииРазрез,
			|	База.ПериодРасчетаСреднегоЗаработка,
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
			|	База.ЭтоГодоваяПремия, 
			//- СВЭЙ КДЯ 08.10.19 СВФР-004899
			|	База.НомерСтроки,
			|	База.Начало,
			|	База.Конец,";
			
			//Аверсон 23.06.2022 КВВ СВФР-009217 (
			//|	База.БПНачало,
			//|	База.БПКонец,
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
				Запрос.Текст = Запрос.Текст + "
				|	НАЧАЛОПЕРИОДА(База.БПНачало,МЕСЯЦ),
				|	КОНЕЦПЕРИОДА(База.БПКонец,МЕСЯЦ),";
			Иначе
				Запрос.Текст = Запрос.Текст + "
				|	База.БПНачало,
				|	База.БПКонец,";
			КонецЕсли;
			
			Запрос.Текст = Запрос.Текст + "
			//Аверсон 23.06.2022 КВВ СВФР-009217 )
			
			|	База.ВидУчетаВремени,
			|	База.ЧислоМесяцев
			|
			|УПОРЯДОЧИТЬ ПО
			|	НомерСтроки
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			//оптимизация запроса 2
			|;
			|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработка;
			|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработкаЗаработок;
			|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработкаПремия;
			|УНИЧТОЖИТЬ	ВтРасчетСреднегоЗаработкаГодоваяПремия;
			|УНИЧТОЖИТЬ	ВтБазаОсновныеНачисления;
			|УНИЧТОЖИТЬ	ВтБазаДополнительныеНачисления;
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			|";
		КонецЕсли;
	КонецЕсли;
	//Островская Татьяна 19.09.2013 № 16727
	Разрезы = Новый Массив(3);
	//		Разрезы[0] = "ПериодРегистрации";
	Разрезы[0] = "ПериодДействия";
	Разрезы[1] = "ВидРасчета";//О.Т. 04.09.2014 № 17567
	Разрезы[2] = "ПериодРегистрации";//О.Т. Аверсон 09.08.2016 № 1371
	РазрезыДоп = Новый Массив(3);
	РазрезыДоп[0] = "ПериодРегистрации";
	РазрезыДоп[1] = "ЧислоМесяцев";
	РазрезыДоп[2] = "ВидРасчета"; //О.Т. 04.09.2014 № 17567
	//	КонецЕсли;
	
	Измерения = Новый Массив(1);
	Измерения[0] = "Сотрудник";
	Запрос.УстановитьПараметр("парамИзмерения",		Измерения);
	Запрос.УстановитьПараметр("парамРазрезы",		Разрезы);
	Запрос.УстановитьПараметр("парамРазрезыДоп",	РазрезыДоп);
	
	ПоГодовойПремии = Новый Массив;
	ПоГодовойПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии);
	
	ПоПремии = Новый Массив;
	ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
	ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему);//О.Т. Аверсон 06.05.2016 № 1141
	ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
	
	Заработок = Новый Массив;
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
	
	//Аверсон ЕАЕ 14.10.2022 СВФР-009668
	//Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск);
	Если НеполныйМесяц Тогда
		Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах);
	Иначе
		Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск);
	КонецЕсли;
	//Аверсон СВФР-009668
	
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент);//О.Т. Аверсон 16.04.2019 № 4189
	
	если ЭтоАгент Тогда //О.Т. Аверсон 12.04.2019 № 4189
		ЗаработокНеИндексировать = Новый Массив;
		ЗаработокНеИндексировать.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент);
	иначе
		ЗаработокНеИндексировать = Новый Массив;
		ЗаработокНеИндексировать.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые);
	КонецЕсли;
	ЗаработокНеИндексироватьСред = Новый Массив;
	ЗаработокНеИндексироватьСред.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеСред); //О.Т. Аверсон 06.07.2016 № 855
	
	
	
	//Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
	//Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
	//
	Запрос.УстановитьПараметр("парамПоГодовойПремии",	ПоГодовойПремии);
	Запрос.УстановитьПараметр("парамЗаработок",	Заработок);
	Запрос.УстановитьПараметр("парамЗаработокНеИндексировать",	ЗаработокНеИндексировать);
	Запрос.УстановитьПараметр("парамЗаработокНеИндексироватьСред",	ЗаработокНеИндексироватьСред);//О.Т. Аверсон 06.07.2016 № 855
	Запрос.УстановитьПараметр("парамПоПремии",	ПоПремии);
	//О.Т. 04.09.2014 № 17567
	СписокИзГруппыРасчетов = Новый СписокЗначений;
	если Регистратор.Организация.НормаВОтпускахПоГрРасчетов и (ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или
		ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда
		Для каждого стрВидРасчета Из Регистратор.Организация.ГруппаРасчета.Основные Цикл
			СписокИзГруппыРасчетов.Добавить(стрВидРасчета.ВидРасчета);	
		КонецЦикла; 
	КонецЕсли;
	Запрос.УстановитьПараметр("СписокИзГруппыРасчетов",СписокИзГруппыРасчетов);
	//О.Т. 04.09.2014 № 17567
	
	//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
	МассивГодовыхПремий = ПолучитьМассивГодовыхПремий();
	Запрос.УстановитьПараметр( "МассивГодовыхПремий", МассивГодовыхПремий );
	//- СВЭЙ КДЯ 12.12.19 СВФР-004448
	
	ВыборкаБазы = Запрос.Выполнить().Выбрать();                                                            
	
	
	ЗаписиДанныхДляСреднего =
	"ВЫБРАТЬ
	|	ЗаписиРасчетаСреднего.НомерСтроки КАК НомерСтроки,
	|	ЗаписиРасчетаСреднего.БазовыйПериодНачало КАК БазовыйПериодНачало,
	|	ЗаписиРасчетаСреднего.БазовыйПериодКонец КАК БазовыйПериодКонец,
	|	ЗаписиРасчетаСреднего.Сотрудник КАК Сотрудник,
	|	ЗаписиРасчетаСреднего.Организация КАК Организация,
	//|	ЗаписиРасчетаСреднего.Приказ КАК Приказ,
	|	ЗаписиРасчетаСреднего.ДатаНачалаРасчетногоПериода КАК ДатаНачалаРасчетногоПериода,
	|	ЗаписиРасчетаСреднего.ДатаОкончанияРасчетногоПериода КАК ДатаОкончанияРасчетногоПериода,
	|	ЗаписиРасчетаСреднего.ВидРасчета КАК ВидРасчета,
	|	ЗаписиРасчетаСреднего.СпособРасчета КАК СпособРасчета,
	|	ЗаписиРасчетаСреднего.МесяцВыборки
	|ИЗ
	|	РегистрРасчета.РасчетСреднегоЗаработка КАК ЗаписиРасчетаСреднего
	|ГДЕ
	|	ЗаписиРасчетаСреднего.Регистратор = &парамРегистратор
	|	И ЗаписиРасчетаСреднего.ВидРасчета В(&Заработок)";
	
	запросДоп = Новый запрос;
	ЗапросДоп.Текст = ЗаписиДанныхДляСреднего;
	Заработок = Новый Массив();
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск);
	
	//Аверсон ЕАЕ 14.10.2022 СВФР-009668
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах);
	//Аверсон СВФР-009668
	
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент); //О.Т. Аверсон 16.04.2019 № 4189
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
	ЗапросДоп.УстановитьПараметр("Заработок", Заработок);
	ЗапросДоп.УстановитьПараметр("парамРегистратор", Регистратор);
	
	// НормаПоШестидневке
	// Данные о норме дней по шестидневке
	// Поля:
	//		МесяцПериода,
	// 		ДнейПоШестидневке - суммируем
	//
	// Описание:
	//      выбираем из производсвенного календаря с сумированием ресурса Шестидневка
	//      условие - с начала периода расчета среднего заработка по конец периода
	//      группируем по номеру месяца
	//
	НормаПоШестидневкеТекст = 
	"ВЫБРАТЬ
	|	НАЧАЛОПЕРИОДА(ПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК МесяцПериода,
	|	СУММА(ПроизводственныйКалендарь.Шестидневка) КАК ДнейПоШестидневке
	|ИЗ
	|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК ПроизводственныйКалендарь
	|ГДЕ
	|	ПроизводственныйКалендарь.ДатаКалендаря >= &парамДатаС
	|	И ПроизводственныйКалендарь.ДатаКалендаря <= &парамДатаПо
	|
	|СГРУППИРОВАТЬ ПО
	|	НАЧАЛОПЕРИОДА(ПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ)";
	
	ЗапросДоп.Текст = ЗаписиДанныхДляСреднего;
	////////////////////////////////////////////////////////////////////////////////
	// данные о продолжительности расчетного периода (ОтработаноДней и ОтработаноЧасов), а также
	// об отработанном времени и норме времени за расчетный период  -
	// 	нужны для включения премий, начисленных в фиксированных суммах, пропорционально отработанному времени)
	
	// к каждой записи из данных для расчета среднего выбираем записи основного регистра по правилу:
	// - если это запись по премиям в фикс. суммах - все записи основного регистра, попадающие в расчетный период
	// - если это запись по заработку и начинает расчетный период - записи основного регистра за все "затронутые" месяцы расчетного периода
	// - если же это одна из последующих записей по заработку - записи основного регистра за "затронутые" месяцы расчетного периода, кроме первого
	// для записей расчета среднего по премиям в фикс. суммах собираем отработанное время и норму по пятидневке за весь расчетный период
	// для записей по заработку собираем продолжительность её части расчетного периода
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ОтработанноеВремя.НомерСтроки КАК НомерСтроки,
	|	ОтработанноеВремя.МесяцВыборки КАК МесяцВыборки,
	|	ОтработанноеВремя.ОтработаноДнейПоПятидневке КАК ОтработаноДнейПоПятидневке,
	|	ОтработанноеВремя.НормаДней КАК НормаДней,
	|	ОтработанноеВремя.НормаЧасов КАК НормаЧасов,
	|	ОтработанноеВремя.НормаДнейПоПятидневке КАК НормаДнейПоПятидневке,
	|	ОтработанноеВремя.ОтработаноДней - ЕстьNull(ИсключенияКалДней.Дней,0) КАК ОтработаноДней,
	|	ОтработанноеВремя.НаличиеПростоев КАК наличиеПростоев,
	|	ОтработанноеВремя.ОтработаноЧасов - ЕстьNull(ИсключенияКалДней.Часов,0) КАК ОтработаноЧасов
	|ИЗ
	|	(ВЫБРАТЬ
	|		ЗаписиРасчетаСреднего.НомерСтроки КАК НомерСтроки,
	|		ОтработанноеВремя.ПериодДействия КАК Месяцвыборки,
	|		СУММА(ОтработанноеВремя.НормаДней) КАК НормаДней,
	|		СУММА(ОтработанноеВремя.НормаЧасов) КАК НормаЧасов,
	|		СУММА(ОтработанноеВремя.ОтработаноДнейПоПятидневке) КАК ОтработаноДнейПоПятидневке,";
	//О.Т. Аверсон 06.09.2017 № 1001
	если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
		Запрос.Текст = Запрос.Текст + " 
		|		СУММА(ВЫБОР когда не ОтработанноеВремя.ВидРасчета.СпособРасчета в (&ИсключОтпускДляСреднего) и ОтработанноеВремя.ВидРасчета <> &ОтпускЗаСвойСчет ИЛИ ЕСТЬNULL(ИндивидуальныйГрафик.Сотрудник, 0) = 0 тогда ОтработанноеВремя.НормаДнейПоПятидневке иначе 0 конец) КАК НормаДнейПоПятидневке,";
	иначе
		Запрос.Текст = Запрос.Текст + " 
		|		СУММА(ОтработанноеВремя.НормаДнейПоПятидневке) КАК НормаДнейПоПятидневке,";
	КонецЕсли;
	Запрос.Текст = Запрос.Текст + " 
	//О.Т. Аверсон 06.09.2017 № 1001
	|		СУММА(ВЫБОР
	|			КОГДА ЗаписиРасчетаСреднего.СпособРасчета В (&парамНеОтпуск)
	//|				ТОГДА СУММА(ВЫБОР
	//|							КОГДА ОтработанноеВремя.ВидРасчета В (&Прогулы)
	//|								ТОГДА ОтработанноеВремя.НормаДней
	//|							ИНАЧЕ ОтработанноеВремя.ОтработаноДней
	//|						КОНЕЦ)
	|				ТОГДА ОтработанноеВремя.ОтработаноДней
	|			ИНАЧЕ ВЫБОР
	|					КОГДА ВЫБОР
	|								КОГДА ОтработанноеВремя.ВидРасчета В (&Прогулы)
	|									ТОГДА ОтработанноеВремя.НормаДнейПоПятидневке
	|								ИНАЧЕ ОтработанноеВремя.ОтработаноДнейПоПятидневке
	|							КОНЕЦ < ОтработанноеВремя.НормаДнейПоПятидневке
	|						ТОГДА ВЫБОР
	|								КОГДА ЗаписиРасчетаСреднего.СпособРасчета = &парамПоШестидневке
	|									ТОГДА ОтработанноеВремя.ОтработаноДнейПоПятидневке * 1.2
	|								КОГДА ОтработанноеВремя.ВидРасчета = &ПарамОтпуск
	|									ТОГДА ОтработанноеВремя.НормаДней
	
	|								ИНАЧЕ ОтработанноеВремя.ОтработаноДней  //СУММА(ОтработанноеВремя.ОтработаноДнейПоПятидневке) * 1.4
	|							КОНЕЦ
	|					КОГДА ОтработанноеВремя.ВидРасчета = &ПарамОтпуск
	|							ТОГДА ОтработанноеВремя.НормаДней
	|					ИНАЧЕ ВЫБОР
	|							КОГДА ЗаписиРасчетаСреднего.СпособРасчета = &парамПоШестидневке
	|								ТОГДА НормаПоШестидневке.ДнейПоШестидневке
	|							ИНАЧЕ ОтработанноеВремя.НормаДней //29.7
	|						КОНЕЦ
	|				КОНЕЦ
	|		КОНЕЦ) КАК ОтработаноДней, //Островская Татьяна 27.05.2014 № 17387
	|		СУММА(ВЫБОР
	|				КОГДА ОтработанноеВремя.ВидРасчета В (&Простои)
	|					ТОГДА 1 //ОтработанноеВремя.ОтработаноЧасов
	|				ИНАЧЕ 0
	|			КОНЕЦ) КАК НаличиеПростоев,
	|		СУММА(ВЫБОР
	
	//Аверсон ЕАЕ 31.10.2022 СВФР-009732
	|           КОГДА &РасчетПриНеполныхМесяцах И ЗаписиРасчетаСреднего.ВидРасчета = &ПоЗаработкуДляРасчетаОтпускаПриНеполныхМесяцах
	|           ТОГДА ВЫБОР
	|                 КОГДА ОтработанноеВремя.ВидРасчета В (&СписокВидовРасчетаПриНеполныхМесяцах)
	|                 ТОГДА ОтработанноеВремя.ОтработаноЧасов
	|                 ИНАЧЕ 0
	|                 КОНЕЦ
	//Аверсон СВФР-009732
	
	//+ СВЭЙ КДЯ 10.01.20 СВФР-005268
	|			КОГДА &ЭтоСреднийЧасовойЗаработокДляКомпОтпуска 
	|				ТОГДА ОтработанноеВремя.ОтработаноЧасов
	//- СВЭЙ КДЯ 10.01.20 СВФР-005268
	|			КОГДА ЗаписиРасчетаСреднего.СпособРасчета В (&парамНеОтпуск)
	|				ТОГДА ВЫБОР КОГДА ОтработанноеВремя.ВидРасчета В (&ДетскийДень) ТОГДА 0 ИНАЧЕ ОтработанноеВремя.ОтработаноЧасов КОНЕЦ //толик
	|			ИНАЧЕ ВЫБОР
	|				КОГДА ОтработанноеВремя.ВидРасчета В (&Прогулы)
	|					ТОГДА ОтработанноеВремя.НормаЧасов
	|				КОГДА ОтработанноеВремя.ВидРасчета = &ПарамОтпуск
	|					ТОГДА ОтработанноеВремя.НормаЧасов
	|				ИНАЧЕ ОтработанноеВремя.ОтработаноЧасов
	|			КОНЕЦ 
	|		КОНЕЦ) КАК ОтработаноЧасов //Островская Татьяна 27.05.2014 № 17387
	|	ИЗ
	|		(" + ЗаписиДанныхДляСреднего + ") КАК ЗаписиРасчетаСреднего
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОтработанноеВремя
	|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка КАК Ссылка,
	|			ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Сотрудник КАК Сотрудник,
	|			ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка.ПериодРегистрации КАК ПериодРегистрации
	|		ИЗ
	|			Документ.ВводИндивидуальныхГрафиковРаботыОрганизации.ГрафикРаботы КАК ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы
	|		ГДЕ ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка.Проведен //О.Т. Аверсон 28.11.2018 № 2829
	
	|		
	|		СГРУППИРОВАТЬ ПО
	|			ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка,
	|			ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Сотрудник,
	|			ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка.ПериодРегистрации) КАК ИндивидуальныйГрафик
	|		ПО ОтработанноеВремя.ПериодДействия = ИндивидуальныйГрафик.ПериодРегистрации
	|			И ОтработанноеВремя.Сотрудник = ИндивидуальныйГрафик.Сотрудник
	
	|			ПО ЗаписиРасчетаСреднего.Сотрудник = ОтработанноеВремя.Сотрудник
	|				И ЗаписиРасчетаСреднего.Организация = ОтработанноеВремя.Организация
	|				И ЗаписиРасчетаСреднего.ДатаНачалаРасчетногоПериода <= ОтработанноеВремя.ПериодДействияКонец
	|				И ЗаписиРасчетаСреднего.ДатаОкончанияРасчетногоПериода >= ОтработанноеВремя.ПериодДействияНачало
	|				И ((ЗаписиРасчетаСреднего.ДатаНачалаРасчетногоПериода = ЗаписиРасчетаСреднего.БазовыйПериодНачало
	|							И НАЧАЛОПЕРИОДА(ЗаписиРасчетаСреднего.БазовыйПериодНачало, МЕСЯЦ) <= ОтработанноеВремя.ПериодДействия
	|						ИЛИ ЗаписиРасчетаСреднего.ДатаНачалаРасчетногоПериода < ЗаписиРасчетаСреднего.БазовыйПериодНачало
	|							И ЗаписиРасчетаСреднего.БазовыйПериодНачало <= ОтработанноеВремя.ПериодДействия)
	|						И НАЧАЛОПЕРИОДА(ЗаписиРасчетаСреднего.БазовыйПериодКонец, МЕСЯЦ) >= ОтработанноеВремя.ПериодДействия
	|					ИЛИ ЗаписиРасчетаСреднего.ВидРасчета = &ФиксПремии)
	|			ЛЕВОЕ СОЕДИНЕНИЕ (" + НормаПоШестидневкеТекст + ") КАК НормаПоШестидневке
	|			ПО НормаПоШестидневке.МесяцПериода = ОтработанноеВремя.ПериодДействия";
	//О.Т. 31.07.2014 № 134
	если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") и Регистратор.Организация.ИНН = "100765738" и 
		?(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту"),Регистратор.ПричинаНетрудоспособности <> Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве, истина) Тогда //О.Т. Аверсон 22.05.2018 № 1991 2п последнее условие доб  
		Запрос.Текст = Запрос.Текст + " 
		|   ГДЕ
		|   ОтработанноеВремя.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(Справочник.Классификаториспользованиярабочеговремени.работа)";	
	КонецЕсли;
	Запрос.Текст = Запрос.Текст + "
	//О.Т. 31.07.2014 № 134
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ЗаписиРасчетаСреднего.СпособРасчета,
	|		ЗаписиРасчетаСреднего.НомерСтроки,
	|		ЗаписиРасчетаСреднего.МесяцВыборки,
	|		ОтработанноеВремя.ПериодДействия) КАК ОтработанноеВремя
	//|		ОтработанноеВремя.ПериодДействия,
	//|		ОтработанноеВремя.НормаДнейПоПятидневке,
	//|		НормаПоШестидневке.ДнейПоШестидневке) КАК ОтработанноеВремя
	|
	//|СГРУППИРОВАТЬ ПО
	//|	ОтработанноеВремя.НомерСтроки,
	//|	ОтработанноеВремя.МесяцВыборки
	//|
	//О.Т. Аверсон 09.01.2018 № 1416
	|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|		СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней,
	|		СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
	|		НАЧАЛОПЕРИОДА(РабочееВремяРаботниковОрганизаций.Период, МЕСЯЦ) КАК Период,
	|		РабочееВремяРаботниковОрганизаций.Сотрудник КАК Сотрудник
	|	ИЗ
	|		РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
	|	ГДЕ
	|		РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
	|		И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&СписокКлассификаторовИскл)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		НАЧАЛОПЕРИОДА(РабочееВремяРаботниковОрганизаций.Период, МЕСЯЦ),
	|		РабочееВремяРаботниковОрганизаций.Сотрудник) КАК ИсключенияКалДней
	|	ПО ОтработанноеВремя.Месяцвыборки = ИсключенияКалДней.Период
	//О.Т. Аверсон 09.01.2018 № 1416
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	// в запросе по отработанному времени отдельно обрабатываются прогулы - выберем их список и передадим его как параметр
	ЗапросПВР = Новый Запрос(
	"ВЫБРАТЬ
	|	ОсновныеНачисленияОрганизаций.Ссылка
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияОрганизаций.ЗачетНормыВремени
	|	И ОсновныеНачисленияОрганизаций.ОбозначениеВТабелеУчетаРабочегоВремени = &Прогул");
	ЗапросПВР.УстановитьПараметр("Прогул", Справочники.КлассификаторИспользованияРабочегоВремени.Прогулы);
	Запрос.УстановитьПараметр("Прогулы", ЗапросПВР.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка"));
	
	ЗапросПР = Новый Запрос(
	"ВЫБРАТЬ
	|	ОсновныеНачисленияОрганизаций.Ссылка
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияОрганизаций.ЗачетНормыВремени
	|	И ОсновныеНачисленияОрганизаций.ОбозначениеВТабелеУчетаРабочегоВремени В (&Простои)");
	СписокПростоев = Новый Массив();
	//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
	//	если Регистратор.Дата < Дата(2014,07,25) Тогда
	//		СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Болезнь);
	//	КонецЕсли;
	//	
	//иначе
	СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Болезнь);
	//КонецЕсли;
	
	СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.БолезньБезОплаты);
	СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ВынужденныйПрогул);
	СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускНаОбучениеНеоплачиваемый);
	СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Простой);
	СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ПростойПоВинеРаботодателя);
	ЗапросПР.УстановитьПараметр("Простои", СписокПростоев);
	//толик
	СписокДД = Новый Массив();
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
		СписокДД.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("031"));
	КонецЕсли;
	Запрос.УстановитьПараметр("ДетскийДень", СписокДД);
	//
	Запрос.УстановитьПараметр("Простои", ЗапросПР.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка"));
	
	
	Заработок = Новый Массив();
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск);
	
	//Аверсон ЕАЕ 14.10.2022 СВФР-009668
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах);
	//Аверсон СВФР-009668
	
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент);//О.Т. Аверсон 16.04.2019 № 4189
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
	//Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
	//Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
	Запрос.УстановитьПараметр("Заработок", Заработок);
	Запрос.УстановитьПараметр("ФиксПремии", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
	Запрос.УстановитьПараметр("парамДатаС", НачалоМесяца(ДатаНачалаРасчетаСреднего));
	Запрос.УстановитьПараметр("парамДатаПо", КонецМесяца(ДатаОкончанияРасчетаСреднего));
	СписокСпособов = Новый Массив();
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	//Аверсон 07.09.2021 КВВ СВФР-008036 (
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
		СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка);
	КонецЕсли;
	//Аверсон 07.09.2021 КВВ СВФР-008036 )
	Запрос.УстановитьПараметр("парамНеОтпуск", СписокСпособов);
	Запрос.УстановитьПараметр("парамОтпуск", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпКалендарныеДни); //Островская Татьяна 27.05.2014 № 17387
	Запрос.УстановитьПараметр("парамПоШестидневке", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке);
	
	//О.Т. Аверсон 06.09.2017 № 1001
	
	СпособИсклОтпуска = Новый Массив();
	СпособИсклОтпуска.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
	
	Запрос.УстановитьПараметр("ИсключОтпускДляСреднего",СпособИсклОтпуска); 
	Запрос.УстановитьПараметр("ОтпускЗаСвойСчет",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет); 
	//О.Т. Аверсон 06.09.2017 № 1001
	
	//О.Т. Аверсон 09.01.2018 № 1416
	ИслючениеДнейБЛ = Новый Массив; 
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
		Для Каждого стр из Справочники.ГруппыРасчетов.КаленДниБезОтпИБЛ.КлассификаторИспользованияРВ Цикл 
			ИслючениеДнейБЛ.Добавить(стр.ВидКлассификатора); 
		КонецЦикла;
	КонецЕсли;
	Запрос.УстановитьПараметр("СписокКлассификаторовИскл",ИслючениеДнейБЛ);
	//О.Т. Аверсон 09.01.2018 № 1416
	
	//+ СВЭЙ КДЯ 10.01.20 СВФР-005268
	ЭтоСреднийЧасовойЗаработокДляКомпОтпуска = 
	ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" )
	И ( Регистратор.ИспользоватьСреднеЧасовойЗаработок
	ИЛИ Регистратор.СреднийЧасовойЗаработокДляКомпОтпуска
	);
	Запрос.УстановитьПараметр( "ЭтоСреднийЧасовойЗаработокДляКомпОтпуска" , ЭтоСреднийЧасовойЗаработокДляКомпОтпуска );
	//- СВЭЙ КДЯ 10.01.20 СВФР-005268
	
	//Аверсон ЕАЕ 31.10.2022 СВФР-009732
	Запрос.УстановитьПараметр("СписокВидовРасчетаПриНеполныхМесяцах", ПолучитьСписокВидовРасчетаПриНеполныхМесяцах());
	Запрос.УстановитьПараметр("РасчетПриНеполныхМесяцах", ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И Регистратор.РасчетПриНеполныхМесяцах);
	Запрос.УстановитьПараметр("ПоЗаработкуДляРасчетаОтпускаПриНеполныхМесяцах", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах);
	//Аверсон СВФР-009732
	
	ВыборкаОтработанноеВремя = Запрос.Выполнить().Выгрузить();
	
	// заполним результаты в наборе записей	
	ТаблицаЗаписей = НаборЗаписей.Выгрузить();
	ТаблицаЗаписей.Колонки.Добавить("БПНачало");
	ТаблицаЗаписей.Колонки.Добавить("БПКонец");
	//	ТаблицаЗаписей.Колонки.Добавить("РезультатДляПремии"); //Островская Татьяна 13.06.2014 Пересчет   //Аверсон 22.09.2020 КВВ СВФР-006593 (закомментировано)
	ПрошлыйБюджетПрожиточногоМинимума = 0;//Островская Татьяна 11.09.2013 № 16778
	СтруктураПоиска = Новый Структура("НомерСтроки");
	СтруктураПоискаДоп = Новый Структура("МесяцВыборки");
	ВГраница = НаборЗаписей.Количество() - 1;
	ПредыдущийКоэффициентИндексации = 1;
	ТекущийКоэффициентИндексации = 1;
	//НачалоБПМ = Дата("00010101000000"); //Островская Татьяна 11.12.2013
	//КонецБПМ = КонецМесяца(Дата("00010201000000")); //Островская Татьяна 11.12.2013
	//Островская Татьяна 23.10.2013 № 16864
	Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетСреднегоПоСотрудникам" Тогда
		ТЧРасчетСреднего = "РасчетСреднегоПоКалендарным";
	ИначеЕсли Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда 
		ТЧРасчетСреднего = "РасчетСреднегоДляОтпуска";
	КонецЕсли;
	//Островская Татьяна 23.10.2013 № 16864
	//Островская Татьяна 28.12.2012 № 16068
	если не ТЗНаборРасчетаНачисления = Неопределено Тогда
		ЕстьТекМесяц = Истина;
		если ВГраница <> -1 Тогда 
			ВГраница = 1;
		КонецЕсли;
	иначе
		ЕстьТекМесяц = Ложь;
	КонецЕсли;
	//Островская Татьяна 28.12.2012 № 16068
	//Островская Татьяна 02.08.2013 № 16623
	если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
		ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")или //Островская Татьяна 18.04.2014 № 17293
		ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда //О.Т. 27.06.2014 № 85
		НеИндексировать = Регистратор.НеИндексировать;
		//Островская Татьяна 12.02.2014 № 17107
	ИначеЕсли  ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.01.2015 № 17616
		НеИндексировать = Истина;
	ИначеЕсли  ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
		НеИндексировать = Регистратор.НеРасчитыватьКоэфИндексации;
		//Островская Татьяна 12.02.2014 № 17107	
	иначе 		
		НеИндексировать = Ложь;
	КонецЕсли;
	//Островская Татьяна 02.08.2013 № 16623
	ПремияПропорц = Ложь;
	
	СписокСообщений = Новый СписокЗначений;//О.Т. 26.09.2014 № 17568
	
	//+ СВЭЙ КДЯ 04.09.19 СВФР-004448
	СоотвСуммыВыборкиККорректировке = Новый Соответствие; // МесяцВыборки --> Сумма подлежащая пересчету по формуле: 
	// Скоректированная Сумма ::=  СуммаВыборкиККорректировке * кол-во строк ТЧ "РасчетСреднегоПоКалендарным" ( с флагом "Включать" = истина ) / кол-во строк ТЧ "РасчетСреднегоПоКалендарным"
	//- СВЭЙ КДЯ 04.09.19 СВФР-004448
	
	//Аверсон ЕАЕ 26.07.2022 СВФР-009371
	ТЗКорректировка = Новый ТаблицаЗначений;
	ТЗКорректировка.Колонки.Добавить("МесяцВыборки");
	ТЗКорректировка.Колонки.Добавить("СпособРасчета");
	ТЗКорректировка.Колонки.Добавить("Сумма");
	//Аверсон СВФР-009371
	
	Для Индекс = 0 По ВГраница Цикл  // окончание цикла -  в строке 12551
		
		//+ СВЭЙ КДЯ 17.02.20 СВФР-005492
		ПремияПропорц = Ложь;
		//- СВЭЙ КДЯ 17.02.20 СВФР-005492
		
		если НаборЗаписей.Количество()>0 Тогда 
			
			СтрокаДвижений = НаборЗаписей[Индекс];
			ЧислоИндекс = НаборЗаписей.Количество() - 1;
			для индексы=1 по ЧислоИндекс Цикл 
				если ТаблицаЗаписей[индексы].МесяцВыборки = Дата("00010101000000") Тогда 
					ИндексСлед = индексы;
					Прервать;
				КонецЕсли;
				
			КонецЦикла;
		КонецЕсли;
		ПредыдущийКоэффициентИндексации = 1;
		ТекущийКоэффициетИндексации = 1;
		
		СтруктураПоиска.НомерСтроки = СтрокаДвижений.НомерСтроки;
		//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		////О.Т. 18.02.2015 № 334
		//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
		//	УсловиеПоОкладу = Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и ТЗНаборРасчетаНачисления <> Неопределено;
		//иначе
		//	УсловиеПоОкладу = Ложь;
		//КонецЕсли;
		////О.Т. 18.02.2015 № 334
		//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
		
		если не УсловиеПоОкладу Тогда //О.Т. 18.02.2015 № 334
			ПерваяЗапись = Истина;
			Пока ВыборкаБазы.НайтиСледующий(СтруктураПоиска) Цикл
				//Островская Татьяна 19.09.2013 № 16727
				
				
				//Островская Татьяна 19.09.2013 № 16727
				Если ((ВыборкаБазы.РезультатБаза <> 0) И (ВыборкаБазы.РезультатБаза <> Null)) 
					или ((СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ) и (ВыборкаБазы.МесяцВыборки <> Null)) тогда
					
					//+ СВЭЙ КДЯ 04.09.19 СВФР-004448
					Если 
						СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии
						//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
						//И ВыборкаБазы.ЧислоМесяцев = 0
						//- СВЭЙ КДЯ 08.10.19 СВФР-004899
						//+ СВЭЙ КДЯ 08.10.19 СВФР-004899
						И ВыборкаБазы.ЭтоГодоваяПремия
						//- СВЭЙ КДЯ 08.10.19 СВФР-004899
						Тогда
						
						
						СоотвСуммыВыборкиККорректировке[ ВыборкаБазы.МесяцВыборки ] = 
						?( СоотвСуммыВыборкиККорректировке[ ВыборкаБазы.МесяцВыборки ] = Неопределено, 0,
						СоотвСуммыВыборкиККорректировке[ ВыборкаБазы.МесяцВыборки ] )
						+  ВыборкаБазы.РезультатБаза; 
						
						//Аверсон ЕАЕ 26.07.2022 СВФР-009371
						//Будем собирать сумму корректировки годовой премии в разрезе способов расчета,
						//чтобы она не задвоилась в случае, если несколько записей в РР ДополнительныеНачисленияРаботниковОрганизаций
						НоваяСтрокаКорректировка = ТЗКорректировка.Добавить();
						НоваяСтрокаКорректировка.МесяцВыборки = ВыборкаБазы.МесяцВыборки;
						НоваяСтрокаКорректировка.СпособРасчета = СтрокаДвижений.СпособРасчета;
						НоваяСтрокаКорректировка.Сумма = ВыборкаБазы.РезультатБаза;
						//Аверсон СВФР-009371
						
					КонецЕсли; // СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии
					//- СВЭЙ КДЯ 04.09.19 СВФР-004448
					
					Если ?(ЭтоАгент,СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент,СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые) Тогда //О.Т. Аверсон 12.04.2019 № 4189
						Если не ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций")
							// + СВЭЙ КДЯ СВФР-004602 08.08.19
							и не ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" )
							// - СВЭЙ КДЯ СВФР-004602 08.08.19
							Тогда
							Продолжить;
						КонецЕсли;
						
						НеИндексировать = Истина;
					ИначеЕсли СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеСред Тогда //О.Т. Аверсон 06.07.2016 № 855
						Если не ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
							Продолжить;
						КонецЕсли;
						
						НеИндексировать = Истина;
					иначе
						//Островская Татьяна 02.08.2013 № 16623
						если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
							ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")или //Островская Татьяна 18.04.2014 № 17293
							ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда //О.Т. 27.06.2014 № 85
							НеИндексировать = Регистратор.НеИндексировать;
							//Островская Татьяна 12.02.2014 № 17107
						ИначеЕсли  ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.01.2015 № 17616
							НеИндексировать = Истина;
						ИначеЕсли  ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
							НеИндексировать = Регистратор.НеРасчитыватьКоэфИндексации;
							//Островская Татьяна 12.02.2014 № 17107	
						иначе 		
							НеИндексировать = Ложь;
						КонецЕсли;
						//Островская Татьяна 02.08.2013 № 16623
					КонецЕсли;
					
					//Островская Татьяна 12.07.2013 № 16623   
					если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") 
						или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам")  
						или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда //Островская Татьяна 25.02.2014 № 17146
						если  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям 
							или СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям 
							или СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему 
							//+ СВЭЙ КДЯ 17.02.20 СВФР-005492
							И НЕ ( ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" ) 
							И Регистратор.ВклПремииПропорциональноОтрабВр ) 
							//- СВЭЙ КДЯ 17.02.20 СВФР-005492
							Тогда 
							Продолжить;
						КонецЕсли;
						
					ИначеЕсли ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
						если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии или 
							СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда //О.Т. Аверсон 03.06.2016 № 1230
							Продолжить;
						КонецЕсли;	
						//О.Т. 28.04.2015 № 417	
					ИначеЕсли ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
						если Регистратор.ВклПремииПропорциональноОтрабВр Тогда 
							Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям или
								СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям Тогда //О.Т. Аверсон 16.05.2016 № 1071
								Продолжить;
							КонецЕсли;
							
						иначе
							если  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям или
								СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему или //О.Т. Аверсон 06.05.2016 № 1141
								СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям Тогда 
								Продолжить;
							КонецЕсли;
						КонецЕсли;
						//О.Т. 28.04.2015 № 417	
						
					КонецЕсли;
					// О.Т. 20.11.2014 292
					СуммаБольничный = 0;
					если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") или 
						ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций")  или
						ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или 
						ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда  //О.Т. 20.01.2015 № 17795
						
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СреднийЗаработокБазовыеВидыРасчета.Ссылка
						|ИЗ
						|	ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
						|ГДЕ
						|	(СреднийЗаработокБазовыеВидыРасчета.ВидРасчета.СпособРасчета = &СпособРасчета
						|	или СреднийЗаработокБазовыеВидыРасчета.ВидРасчета = &ВидРасчета)
						|	И СреднийЗаработокБазовыеВидыРасчета.Ссылка = &Ссылка";
						
						Запрос.УстановитьПараметр("Ссылка", СтрокаДвижений.ВидРасчета);
						Запрос.УстановитьПараметр("ВидРасчета",  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоИнициативеНанимателя);//03.02.2022
						Запрос.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС); //О.Т. 20.01.2015 № 17795
						РезВидРасчетаБольничный = Запрос.Выполнить().Выгрузить();
						если РезВидРасчетаБольничный.Количество()>0 Тогда 
							
							Запрос = Новый Запрос;
							Запрос.Текст = 
							"ВЫБРАТЬ
							|	ВЫБОР
							|		КОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
							//|				И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
							|			ТОГДА ВЫРАЗИТЬ(ОсновныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
							|		ИНАЧЕ ОсновныеНачисленияРаботниковОрганизаций.Результат
							|	КОНЕЦ КАК Результат
							|ИЗ
							|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
							|ГДЕ
							|	(ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &СпособРасчета
							|	или ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = &ВидРасчета)
							|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
							|	И ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация
							|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &ПериодДействияНачало И &ПериодДействияНачало1
							|	И ОсновныеНачисленияРаботниковОрганизаций.Регистратор <> &Регистратор";
							
							Запрос.УстановитьПараметр("СпособРасчета",  Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);//О.Т. 20.01.2015 № 17795
							Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
							Запрос.УстановитьПараметр("ВидРасчета", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоИнициативеНанимателя);//03.02.2022
							Запрос.УстановитьПараметр("ПериодДействияНачало", НачалоМесяца(ВыборкаБазы.МесяцВыборки));
							Запрос.УстановитьПараметр("ПериодДействияНачало1", КонецМесяца(ВыборкаБазы.МесяцВыборки));
							Запрос.УстановитьПараметр("Регистратор", СтрокаДвижений.Регистратор);
							Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
							
							РезультатБольничный = Запрос.Выполнить().Выбрать();
							
							Пока РезультатБольничный.Следующий() Цикл
								СуммаБольничный = СуммаБольничный + РезультатБольничный.Результат;
							КонецЦикла;
							//О.Т. Аверсон 15.04.2019 № 4229
							Если СуммаБольничный > 0 Тогда 
								Сообщить("В месяце "+Формат(НачалоМесяца(ВыборкаБазы.МесяцВыборки),"ДЛФ=Д")+" отминусована сумма "+Строка(СуммаБольничный));
							КонецЕсли;
							//О.Т. Аверсон 15.04.2019 № 4229
							
							//Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и НачалоМесяца(ВыборкаБазы.МесяцВыборки) < Дата(2016,07,01) тогда //О.Т. Аверсон 08.08.2016 
							//	СуммаБольничный = ОбщегоНазначения.ОкруглитьПоВалюте(ОбщегоНазначения.ОкруглитьЗначение2016(СуммаБольничный/10000, СтрокаДвижений.ПериодРегистрации),Константы.ВалютаРегламентированногоУчета.Получить());
							//КонецЕсли;
							
						КонецЕсли;
					КонецЕсли;
					// О.Т. 20.11.2014 292
					
					//Островская Татьяна 06.12.2013 № 16623
					если ( СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям 
						или СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему )
						Тогда //О.Т. Аверсон 06.05.2016 № 1141
						ПремияПропорц = Истина;
					КонецЕсли;
					
					//О.Т. 16.07.2014 № 118
					ПоОкладуКаленд = Ложь;
					Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
						ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда //О.Т. 23.09.2014 № 17616
						Если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и Регистратор.КалендарныеДни Тогда
							ПоОкладуКаленд = Истина;
						КонецЕсли;
					КонецЕсли;
					//О.Т. 16.07.2014 № 118
					если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
						КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ВыборкаБазы.МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,ВыборкаБазы.ДатаНачалаДоговора,ВыборкаБазы.ДатаОкончанияДоговора,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
					иначе
						
						КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ВыборкаБазы.МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
					КонецЕсли;
					
					//О.Т. 29.04.2015 № 417
					ЗапросВидРасчета = Новый Запрос;
					ЗапросВидРасчета.Текст = 
					"ВЫБРАТЬ ПЕРВЫЕ 1
					|	ОсновныеНачисленияРаботниковОрганизаций.ВидУчетаВремени
					|ИЗ
					|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
					|ГДЕ
					|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
					|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
					|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)";
					ВидРасчетаСписок = Новый СписокЗначений;
					ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
					ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
					ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
					ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
					ЗапросВидРасчета.УстановитьПараметр("ВидРасчета",ВидРасчетаСписок);	
					ЗапросВидРасчета.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);
					ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",ВыборкаБазы.МесяцВыборки);
					РезультатВидРасчета = ЗапросВидРасчета.Выполнить().Выгрузить();
					ВидРасчетаМесяца = Неопределено;
					если РезультатВидРасчета.Количество()>0 Тогда 
						ВидРасчетаМесяца = РезультатВидРасчета[0].ВидУчетаВремени;
					КонецЕсли;			
					//О.Т. 29.04.2015 № 417
					
					////Аверсон 28.04.2023 КВВ СВФР-010738 (
					//Если НЕ Пересчет И Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" Тогда
					//	ПроверкаНаВРВГруппеРасчетов = СформироватьДанныеПоГрРасчетов(НачалоМесяца(ВыборкаБазы.МесяцВыборки), КонецМесяца(ВыборкаБазы.МесяцВыборки),СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник);
					//	Если ПроверкаНаВРВГруппеРасчетов Тогда
					//		ТаблицаЗаписей[Индекс].Включать = Ложь;
					//		Сообщить("Месяц выборки " + Формат(ВыборкаБазы.МесяцВыборки, "ДЛФ=D") + " исключается из расчета среднего заработка, т.к. есть виды времени, включенные в группу расчетов """ + СокрЛП(СтрокаДвижений.Организация.ГруппаРасчета) + """");
					//		Продолжить;
					//	КонецЕсли;
					//КонецЕсли;
					////Аверсон 28.04.2023 КВВ СВФР-010738 )
					
					Если НЕ ПерваяЗапись Тогда
						если УсловиеДляБПМ Тогда 
							если не  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ Тогда 
								Продолжить;
							КонецЕсли;
							
						КонецЕсли;
						
						//(начало) закомментировано Кухарчуком Д.Я., 18.12.18, Задача СВФР-002946, Аверсон-Софт
						//вынесено в отдельную процедуру ПолучитьСтруктуруДатБюджетаПрожиточногоМинимума (см. ниже)
						////Островская Татьяна 11.09.2013 № 16778
						//если Месяц(ВыборкаБазы.МесяцВыборки) >= 2 и Месяц(ВыборкаБазы.МесяцВыборки) <= 04 Тогда 
						//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0201000000");
						//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)-1," ","")+"1101000000");
						//ИначеЕсли Месяц(ВыборкаБазы.МесяцВыборки) >= 5 и Месяц(ВыборкаБазы.МесяцВыборки) <= 7 Тогда 
						//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0501000000");
						//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0201000000");
						//ИначеЕсли Месяц(ВыборкаБазы.МесяцВыборки) >= 8 и Месяц(ВыборкаБазы.МесяцВыборки) <= 10 Тогда 
						//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0801000000");
						//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0501000000");
						//ИначеЕсли Месяц(ВыборкаБазы.МесяцВыборки) >= 11 или Месяц(ВыборкаБазы.МесяцВыборки) = 1 Тогда 
						//	если Месяц(ВыборкаБазы.МесяцВыборки) = 1 Тогда
						//		ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)-1," ","")+"1101000000");
						//		ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)-1," ","")+"0801000000");
						//	иначе
						//		ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"1101000000"); 
						//		ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0801000000");
						//	КонецЕсли;
						//КонецЕсли;
						//(конец) закомментировано Кухарчуком Д.Я., 18.12.18, Задача СВФР-002946, Аверсон-Софт
						//(начало) добавлено Кухарчуком Д.Я., 18.12.18, Задача СВФР-002946, Аверсон-Софт
						СтруктураДатБПМ = ПолучитьСтруктуруДатБюджетаПрожиточногоМинимума( ВыборкаБазы.МесяцВыборки );
						ДатаБюджетаПрожМиним1 = СтруктураДатБПМ.ДатаБюджетаПрожМинимТекущегоПериода;
						ДатаБюджетаПрожМиним2 = СтруктураДатБПМ.ДатаБюджетаПрожМинимПредыдущегоПериода;
						//(конец) добавлено Кухарчуком Д.Я., 18.12.18, Задача СВФР-002946, Аверсон-Софт
						
						
						БюджетПрожиточногоМинимума1 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним1, 
						Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
						БюджетПрожиточногоМинимума2 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним2, 
						Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
						БюджетПрожиточногоМинимума = Макс(БюджетПрожиточногоМинимума1,БюджетПрожиточногоМинимума2);
						//Островская Татьяна 11.09.2013 № 16778
						если УсловиеДляБПМ Тогда 
							если ПрошлыйБюджетПрожиточногоМинимума = БюджетПрожиточногоМинимума Тогда 
								Продолжить;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 11.09.2013 № 16778 
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							ОтборРег = Новый Структура;
							ОтборРег.Вставить("МесяцВыборки",ВыборкаБазы.МесяцВыборки);
							ОтборРег.Вставить("ВидРасчета",СтрокаДвижений.ВидРасчета);
							ЗначениеПоРег = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
						КонецЕсли;                                                                 
						//Островская Татьяна 12.06.2014 Пересчет
						// вводим новые строки набора записей
						ДопСтрокаДвижений = ТаблицаЗаписей.Добавить();
						Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
							ДопСтрокаДвижений.ДатаДоговора = ВыборкаБазы.ДатаДоговора;
							ДопСтрокаДвижений.НомерДоговора = ВыборкаБазы.НомерДоговора;
						КонецЕсли;
						
						ДопСтрокаДвижений.ПериодРегистрации = Регистратор.ПериодРегистрации;
						ДопСтрокаДвижений.ВидРасчета 		= СтрокаДвижений.ВидРасчета;
						
						ДопСтрокаДвижений.Регистратор 		= Регистратор;
						ДопСтрокаДвижений.НомерСтроки		= СтрокаДвижений.НомерСтроки;
						
						// измерения
						ДопСтрокаДвижений.Сотрудник 	= СтрокаДвижений.Сотрудник;
						ДопСтрокаДвижений.ФизЛицо 	= СтрокаДвижений.ФизЛицо;
						ДопСтрокаДвижений.Организация	= СтрокаДвижений.Организация;
						//ДопСтрокаДвижений.Приказ 		= СтрокаДвижений.Приказ;
						
						// свойства
						//ДопСтрокаДвижений.ВидРасчета 		 			 = СтрокаДвижений.ВидРасчета;
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ДопСтрокаДвижений.БазовыйПериодНачало = ЗначениеПоРег[0].БазовыйПериодНачало;
							иначе
								ДопСтрокаДвижений.БазовыйПериодНачало = СтрокаДвижений.БазовыйПериодНачало;
							КонецЕсли;
						иначе
							ДопСтрокаДвижений.БазовыйПериодНачало 		= СтрокаДвижений.БазовыйПериодНачало;
						КонецЕсли;
						// О.Т. 03.11.2014 17616
						Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
							ДопСтрокаДвижений.БазовыйПериодНачало 		= ВыборкаБазы.ДатаНачалаОснДог;
							//  ДопСтрокаДвижений.БазовыйПериодНачало 		= ВыборкаБазы.ДатаНачалаДоговора;
						КонецЕсли;
						// О.Т. 03.11.2014 17616
						//Островская Татьяна 12.06.2014 Пересчет
						если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
							строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
							если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда 
								ДопСтрокаДвижений.БазовыйПериодКонец = ДобавитьМесяц(СтрокаДвижений.БазовыйПериодКонец,1);
							иначе
								ДопСтрокаДвижений.БазовыйПериодКонец = СтрокаДвижений.БазовыйПериодКонец;
							КонецЕсли;
							//Островская Татьяна 12.06.2014 Пересчет
						иначеЕсли (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ДопСтрокаДвижений.БазовыйПериодКонец = ЗначениеПоРег[0].БазовыйПериодКонец;
							иначе
								ДопСтрокаДвижений.БазовыйПериодКонец = СтрокаДвижений.БазовыйПериодКонец;
							КонецЕсли;
							//Островская Татьяна 12.06.2014 Пересчет	
						Иначе 
							ДопСтрокаДвижений.БазовыйПериодКонец = СтрокаДвижений.БазовыйПериодКонец;
						КонецЕсли;
						// О.Т. 03.11.2014 17616
						Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
							ДопСтрокаДвижений.БазовыйПериодКонец 		= Мин(?(БЛПоДоговорамТекМес,КонецМесяца(Регистратор.ДатаНачала),ДатаОкончанияРасчетаСреднего),ВыборкаБазы.ДатаОкончанияОснДог);
							
							//ДопСтрокаДвижений.БазовыйПериодКонец 		= ВыборкаБазы.ДатаОкончанияДоговора;
						КонецЕсли;
						// О.Т. 03.11.2014 17616
						// реквизиты
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
								//ДопСтрокаДвижений.КоэффициентИндексации = ЗначениеПоРег[0].КоэффициентИндексации;
								//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
								ДопСтрокаДвижений.КоэффициентИндексации = РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( 
								ЗначениеПоРег[0].КоэффициентИндексации, ОкруглитьКоэффициентИндексации );
								//- СВЭЙ 15.03.19 КДЯ СВФР-004088
							иначе
								ДопСтрокаДвижений.КоэффициентИндексации 		 = ?( НеИндексировать, 1, СтрокаДвижений.КоэффициентИндексации ); //Островская Татьяна 02.08.2013 № 16623
							КонецЕсли;
							//ПСА 20.10.2021 СВФЗ-008285 +++	
						ИначеЕсли Регистратор.Метаданные().Имя = "ОплатаПоСреднемуЗаработку" и ТекущийКоэффициентИндексации <> 1
							и ДопСтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии Тогда
							ДопСтрокаДвижений.КоэффициентИндексации  = ТекущийКоэффициентИндексации;
							//+++ПСА 20.10.2021 СВФЗ-008285		
						иначе
							ДопСтрокаДвижений.КоэффициентИндексации 		 = ?( НеИндексировать, 1, СтрокаДвижений.КоэффициентИндексации ); //Островская Татьяна 02.08.2013 № 16623
						КонецЕсли;
						
						//Островская Татьяна 12.06.2014 Пересчет
						ДопСтрокаДвижений.ДатаНачалаРасчетногоПериода 	 = СтрокаДвижений.ДатаНачалаРасчетногоПериода;
						ДопСтрокаДвижений.ДатаОкончанияРасчетногоПериода = СтрокаДвижений.ДатаОкончанияРасчетногоПериода;
						
						ДопСтрокаДвижений.СпособРасчета 				 = СтрокаДвижений.СпособРасчета;
						ДопСтрокаДвижений.ПериодРасчетаСреднегоЗаработка = СтрокаДвижений.ПериодРасчетаСреднегоЗаработка;
						ДопСтрокаДвижений.ДатаНачалаСобытия              = СтрокаДвижений.ДатаНачалаСобытия;
						
						Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям ИЛИ  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям 
							ИЛИ  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда //О.Т. Аверсон 06.05.2016 № 1141
							ДопСтрокаДвижений.БПНачало = ВыборкаБазы.БПНачало;
							ДопСтрокаДвижений.БПКонец  = ВыборкаБазы.БПКонец;
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ДопСтрокаДвижений.ТекущаяТарифнаяСтавка = ЗначениеПоРег[0].ТекущаяТарифнаяСтавка;
							иначе
								ДопСтрокаДвижений.ТекущаяТарифнаяСтавка 		 = СтрокаДвижений.ТекущаяТарифнаяСтавка;
							КонецЕсли;
						иначе
							ДопСтрокаДвижений.ТекущаяТарифнаяСтавка 		 = СтрокаДвижений.ТекущаяТарифнаяСтавка;
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						
						//ТарифнаяСтавкаПериода = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
						//					Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).Ставка;
						
						ТарифнаяСтавкаПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
						Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
						
						РазмерТСПериода =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
						Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация, ТарифнаяСтавкаПериода)).Размер;
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
							РазмерТСПериода = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСПериода / 10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
						
						
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ДопСтрокаДвижений.ТарифнаяСтавкаПериода = ЗначениеПоРег[0].ТарифнаяСтавкаПериода;
							иначе
								ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = РазмерТСПериода;
							КонецЕсли;
						иначе
							ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = РазмерТСПериода;
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						
						//толик коэффициент индексации с 01.01.2009
						//	                ТекущийКоэффициентИндексации = ?(ТекущаяТарифнаяСтавка =0 , 1, ?(СтрокаДвижений.ТекущаяТарифнаяСтавка < ТарифнаяСтавкаПериода, МАКС(ПредыдущийКоэффициентИндексации,1), СтрокаДвижений.ТекущаяТарифнаяСтавка / ТарифнаяСтавкаПериода));
						//ТекущийКоэффициентИндексации = ?(ТекущаяТарифнаяСтавка =0 ИЛИ ВыборкаБазы.Месяцвыборки >= мДатаИзмененияЗП, 1, ?(СтрокаДвижений.ТекущаяТарифнаяСтавка < ТарифнаяСтавкаПериода, МАКС(ПредыдущийКоэффициентИндексации,1), СтрокаДвижений.ТекущаяТарифнаяСтавка / ТарифнаяСтавкаПериода));
						
						//О.Т. Аверсон 06.11.2015 № 679
						БезЕТСПоСотруднику = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки),Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).БезЕТС;
						//О.Т. Аверсон 06.11.2015 № 679
						
						//Островская Татьяна 25.03.2013 № 16352
						если Строка(ТипЗнч(Регистратор)) = Метаданные.Документы.НачислениеОтпускаРаботникамОрганизаций.Синоним или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Строка(ТипЗнч(Регистратор)) = Метаданные.Документы.РасчетПриУвольненииРаботникаОрганизаций.Синоним  Тогда //О.Т. Аверсон 09.02.2018 № 1566 + средний
							УсловиеФлагОрганизация = СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС; //О.Т. 18.07.2014 (убран ЕТКС)
						Иначе
							УсловиеФлагОрганизация = не БезЕТСПоСотруднику;
						КонецЕсли;
						//Островская Татьяна 25.03.2013 № 16352
						если не УсловиеФлагОрганизация тогда
							//Аверсон-софт, Островская Татьяна 12.06.2012 № 15410
							если СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС Тогда 
								Запрос = Новый Запрос;
								Запрос.Текст = 
								"ВЫБРАТЬ
								|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда КАК ТарифнаяСтавкаПервогоРазряда
								|ИЗ
								|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
								|			&Период,
								|			Сотрудник = &Сотрудник
								|				И организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
								
								Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								Запрос.УстановитьПараметр("Период", Регистратор.ПериодРегистрации);
								Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);		
								Результат = Запрос.Выполнить();	
								ВыборкаДетальныеЗаписи = Результат.Выбрать();
								ТарифнаяСтавка1Р = "";
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									ТарифнаяСтавка1Р = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
								КонецЦикла;
								Запрос.УстановитьПараметр("Период", ВыборкаБазы.Месяцвыборки);
								Результат = Запрос.Выполнить();	
								ВыборкаДетальныеЗаписи = Результат.Выбрать();
								ТарифнаяСтавка1РНаДату = "";
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									ТарифнаяСтавка1РНаДату = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
								КонецЦикла;
								
								если ЗначениеЗаполнено(ТарифнаяСтавка1Р) и ЗначениеЗаполнено(ТарифнаяСтавка1РНаДату) Тогда
									РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
									Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1Р)).Размер;
									РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
									Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1РНаДату)).Размер;
									
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
										ОтборСтавки = Новый Структура( "Организация, ТарифнаяСтавка", СтрокаДвижений.Организация, ТарифнаяСтавка1РНаДату );
										РазмерТекущегоТСПериода = 
										ПолучитьЭталоннуюТС( ВыборкаБазы.МесяцВыборки, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
									КонецЕсли; 
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									
								Иначе
									РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
									Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
									РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
									Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
									
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
										ОтборСтавки = Новый Структура( "Организация", СтрокаДвижений.Организация );
										РазмерТекущегоТСПериода = 
										ПолучитьЭталоннуюТС( ВыборкаБазы.МесяцВыборки, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
									КонецЕсли; 
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
								КонецЕсли;
								если РазмерТекущегоТСПериода <> 0 и РазмерТСНаДату <> 0 Тогда 
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									//ТекущийКоэффициентИндексации = ?(НеИндексировать,1,Окр(РазмерТекущегоТСПериода / РазмерТСНаДату, 4));
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, 
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( РазмерТекущегоТСПериода / РазмерТСНаДату, ОкруглитьКоэффициентИндексации ) );
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								иначе
									ТекущийКоэффициентИндексации = 1;
								КонецЕсли;
							иначе
								//О.Т. 23.02.2015 № 331    
								если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда  //О.Т. Аверсон 09.02.2018 № 1566 + средний
									//О.Т. Аверсон 06.12.2016 № 74
									РегистрТарифныеСтавки = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.ПериодРегистрации), Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник));
									Если РегистрТарифныеСтавки.ДляПечати Тогда 
										РазмерПоследнегоОкл =  РегистрТарифныеСтавки.МесячнаяТарифнаяСтавкаВВалюте;
									иначе
										РазмерПоследнегоОкл =  РегистрТарифныеСтавки.ТарифнаяСтавка;
									КонецЕсли;
									//О.Т. Аверсон 06.12.2016 № 74
									
									//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
								иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
									
									ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ВыборкаБазы.МесяцВыборки, СтрокаДвижений );
									ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
									РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
									ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
									//- СВЭЙ КДЯ 27.01.20 СВФР-005409
									
								иначе
									
									ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
									ЗапросОкладПосл = Новый Запрос;
									ЗапросОкладПосл.Текст = 
									"ВЫБРАТЬ
									|	ВЫБОР
									|		КОГДА ТарифныеСтавкиРаботниковОрганизации.ДляПечати
									|			ТОГДА ТарифныеСтавкиРаботниковОрганизации.МесячнаяТарифнаяСтавкаВВалюте
									|		ИНАЧЕ ТарифныеСтавкиРаботниковОрганизации.ТарифнаяСтавка
									|	КОНЕЦ КАК ТарифнаяСтавка, //О.Т. Аверсон 06.12.2016 № 74
									|	ТарифныеСтавкиРаботниковОрганизации.Период
									|ИЗ
									|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
									|			&Дата,
									|			Организация = &Организация
									|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
									|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
									|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
									|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
									|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
									|ГДЕ
									|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
									
									ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
									ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
									ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
									ЗапросОкладПосл.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
									
									РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
									РазмерПоследнегоОкл = 0;
									Пока РезультатОкладПосл.Следующий() Цикл
										РазмерПоследнегоОкл = РезультатОкладПосл.ТарифнаяСтавка;
										Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и РезультатОкладПосл.Период < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
											РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
										КонецЕсли;
									КонецЦикла;
								КонецЕсли;
								//О.Т. 23.02.2015 № 331
								
								//О.Т. Аверсон 06.12.2016 № 74
								РегистрТарифныеСтавки = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки), Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник));
								Если РегистрТарифныеСтавки.ДляПечати Тогда 
									Оклад =РегистрТарифныеСтавки.МесячнаяТарифнаяСтавкаВВалюте;
								иначе								
									Оклад =РегистрТарифныеСтавки.ТарифнаяСтавка; 
								КонецЕсли;
								//О.Т. Аверсон 06.12.2016 № 74
								Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
									Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
								КонецЕсли;
								
								//Островская Татьяна 10.07.2013 № 16615
								если не Оклад = 0 Тогда
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									//ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, ?( РазмерПоследнегоОкл = 0 , 1, 
									//		?( РазмерПоследнегоОкл < Оклад, МАКС( ПредыдущийКоэффициентИндексации, 1 ), Окр( РазмерПоследнегоОкл / Оклад, 10 ) ) ) ); //Островская Татьяна 02.08.2013 № 16623								
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, 
									?( РазмерПоследнегоОкл = 0 , 1, 
									?( РазмерПоследнегоОкл < Оклад, 
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									//МАКС( ПредыдущийКоэффициентИндексации, 1 ),
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( МАКС( ПредыдущийКоэффициентИндексации, 1 ), ОкруглитьКоэффициентИндексации ),
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( РазмерПоследнегоОкл / Оклад, ОкруглитьКоэффициентИндексации ) ) ) );								
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								иначе
									ТекущийКоэффициентИндексации = 1;
									ОбщегоНазначения.СообщитьОбОшибке("Оклад на "+ ВыборкаБазы.МесяцВыборки + " равен 0");
								КонецЕсли;
							КонецЕсли;
							//Островская Татьяна 10.07.2013 № 16615
						иначе
							//Аверсон-софт, Островская Татьяна 12.06.2012 № 15410	
							//ТекущийКоэффициентИндексации = ?(СтрокаДвижений.ТекущаяТарифнаяСтавка =0 , 1, ?(СтрокаДвижений.ТекущаяТарифнаяСтавка < РазмерТСПериода, МАКС(ПредыдущийКоэффициентИндексации,1), СтрокаДвижений.ТекущаяТарифнаяСтавка / РазмерТСПериода));
							//заявка №1650 (база заявок Кристалла) Дмитрук О.Г.
							//Островская Татьяна 17.06.2013 № 16558
							
							//О.Т. 23.02.2015 № 331
							если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда  //О.Т. Аверсон 09.02.2018 № 1566 + средний
								ПериодПоследнегоОкл = ТекущаяДата();							
								
								//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
							иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
								
								ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ВыборкаБазы.МесяцВыборки, СтрокаДвижений );
								ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
								РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
								ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
								//- СВЭЙ КДЯ 27.01.20 СВФР-005409
								
							иначе
								
								ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
								ЗапросОкладПосл = Новый Запрос;
								ЗапросОкладПосл.Текст = 
								"ВЫБРАТЬ
								|	ТарифныеСтавкиРаботниковОрганизации.Период
								|ИЗ
								|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
								|			&Дата,
								|			Организация = &Организация
								|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
								|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
								|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
								|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
								|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
								|ГДЕ
								|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
								
								ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
								ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
								ЗапросОкладПосл.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								
								РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
								ПериодПоследнегоОкл = ТекущаяДата();
								Пока РезультатОкладПосл.Следующий() Цикл
									ПериодПоследнегоОкл = РезультатОкладПосл.Период;
								КонецЦикла;
							КонецЕсли;
							//О.Т. 23.02.2015 № 331
							
							ТарифнаяСтавкаПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
							Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
							ТарифнаяСтавкаПериода1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
							Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
							
							РазмерПоследнегоОкл =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
							Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода)).Размер;
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ПериодПоследнегоОкл < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
								РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
							КонецЕсли;
							Оклад = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки), 
							Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода1)).Размер;
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ПериодПоследнегоОкл < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
								РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
							КонецЕсли; 
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
								Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
							КонецЕсли;
							//Островская Татьяна 17.06.2013 № 16558
							если СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС Тогда 
								Запрос = Новый Запрос;
								Запрос.Текст = 
								"ВЫБРАТЬ
								|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда КАК ТарифнаяСтавкаПервогоРазряда
								|ИЗ
								|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
								|			&Период,
								|			Сотрудник = &Сотрудник
								|				И организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
								
								Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								Запрос.УстановитьПараметр("Период", ПериодПоследнегоОкл);
								Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);		
								Результат = Запрос.Выполнить();	
								ВыборкаДетальныеЗаписи = Результат.Выбрать();
								ТарифнаяСтавка1Р = "";
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									ТарифнаяСтавка1Р = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
								КонецЦикла;
								Запрос.УстановитьПараметр("Период", КонецМесяца(ВыборкаБазы.Месяцвыборки));
								Результат = Запрос.Выполнить();	
								ВыборкаДетальныеЗаписи = Результат.Выбрать();
								ТарифнаяСтавка1РНаДату = "";
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									ТарифнаяСтавка1РНаДату = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
								КонецЦикла;
								
								если ЗначениеЗаполнено(ТарифнаяСтавка1Р) и ЗначениеЗаполнено(ТарифнаяСтавка1РНаДату) Тогда
									РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
									Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1Р)).Размер;
									
									//СВЭЙ 16.09.2023 КВВ СВФР-011447 (пункт 2) (
									Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" 
										И ЗначениеЗаполнено(Регистратор.ПерерассчитываемыйДокумент) Тогда
										РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПерерассчитываемыйДокумент.ПериодРегистрации, 
										Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1Р)).Размер;
									КонецЕсли;
									//СВЭЙ 16.09.2023 КВВ СВФР-011447 (пункт 2) )
									
									РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
									Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1РНаДату)).Размер;
									Если Регистратор.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
										РазмерТСНаДату = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСНаДату / 10000,Регистратор.ПериодРегистрации);
									КонецЕсли;
									
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
										ОтборСтавки = Новый Структура( "Организация, ТарифнаяСтавка", СтрокаДвижений.Организация, ТарифнаяСтавка1РНаДату );
										РазмерТекущегоТСПериода = 
										ПолучитьЭталоннуюТС( ВыборкаБазы.МесяцВыборки, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
									КонецЕсли; 
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									
								Иначе
									РазмерТекущегоТСПериода = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
									Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
									РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
									Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
									Если Регистратор.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
										РазмерТСНаДату = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСНаДату / 10000,Регистратор.ПериодРегистрации);
									КонецЕсли;
									
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
										ОтборСтавки = Новый Структура( "Организация", СтрокаДвижений.Организация );
										РазмерТекущегоТСПериода = 
										ПолучитьЭталоннуюТС( ВыборкаБазы.МесяцВыборки, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
									КонецЕсли; 
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									
								КонецЕсли;
								
								Попытка
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									//ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, Окр( РазмерТекущегоТСПериода / РазмерТСНаДату, 4 ) ); //Островская Татьяна 17.06.2013 № 16558, 16623
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, 
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( РазмерТекущегоТСПериода / РазмерТСНаДату, ОкруглитьКоэффициентИндексации ) );								
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								Исключение
									ТекущийКоэффициентИндексации = 0;
								КонецПопытки;
								
							иначе 
								Если РазмерТСПериода <> 0 Тогда
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									//ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, ?( СтрокаДвижений.ТекущаяТарифнаяСтавка = 0 , 1, 
									//		?( СтрокаДвижений.ТекущаяТарифнаяСтавка < РазмерТСПериода, МАКС( ПредыдущийКоэффициентИндексации, 1 ), 
									//			Окр( СтрокаДвижений.ТекущаяТарифнаяСтавка / РазмерТСПериода, 4 ) ) ) ); //Островская Татьяна 17.06.2013 № 16558 ,16623								
									////заявка №1650
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, ?( СтрокаДвижений.ТекущаяТарифнаяСтавка = 0 , 1, 
									?( СтрокаДвижений.ТекущаяТарифнаяСтавка < РазмерТСПериода, 
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									//МАКС( ПредыдущийКоэффициентИндексации, 1 ),
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( МАКС( ПредыдущийКоэффициентИндексации, 1 ), ОкруглитьКоэффициентИндексации ),
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( СтрокаДвижений.ТекущаяТарифнаяСтавка / РазмерТСПериода, ОкруглитьКоэффициентИндексации ) ) ) );
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								Иначе 
									ТекущийКоэффициентИндексации = 1;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//О.Т. 09.10.2014 № 17616
						если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
							ТекущийКоэффициентИндексации = 1;
						КонецЕсли;
						//О.Т. 09.10.2014 № 17616
						//Аверсон-софт, Островская Татьяна 27.06.2012 № 15549
						//Если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" Тогда
						//	ТекущийКоэффициентИндексации = 1;
						//КонецЕсли;
						
						ПерваяЗапись = Ложь;
						
						//О.Т. Аверсон 15.04.2019 № 4229
						ЗначениеЕсть = Ложь;
						ЗапросПровБазы = Новый Запрос;
						если ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛисту" ) Тогда
							
							Если ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии 
								или ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям 
								или ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему 
								или ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям Тогда 
								
								ЗапросПровБазы.Текст = 
								"ВЫБРАТЬ
								|	ВложенныйЗапрос.Сотрудник,
								|	СУММА(ВложенныйЗапрос.Результат) КАК Результат
								|ИЗ
								|	(ВЫБРАТЬ
								|		ЕСНОсновныеНачисления.Сотрудник КАК Сотрудник,
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859
								//|		СУММА(ВЫБОР
								//|				КОГДА ЕСНОсновныеНачисления.ДоходФСЗН = &ДоходФСЗН
								//|					ТОГДА ЕСНОсновныеНачисления.Результат
								//|				ИНАЧЕ 0
								//|			КОНЕЦ) КАК Результат
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859
								|		СУММА( ЕСНОсновныеНачисления.Результат ) КАК Результат
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								|	ИЗ
								|		РегистрРасчета.ЕСНОсновныеНачисления КАК ЕСНОсновныеНачисления
								|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
								|			ПО ЕСНОсновныеНачисления.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета
								|	ГДЕ
								|		ЕСНОсновныеНачисления.ПериодДействияНачало МЕЖДУ &Период1 И &Период2
								|		И ЕСНОсновныеНачисления.Сотрудник = &Сотрудник
								|		И ЕСНОсновныеНачисления.Организация = &Организация
								|		И СреднийЗаработокБазовыеВидыРасчета.Ссылка = &ВидРасчетаСредний
								|	
								|	СГРУППИРОВАТЬ ПО
								|		ЕСНОсновныеНачисления.Сотрудник
								|	
								|	ОБЪЕДИНИТЬ ВСЕ
								|	
								|	ВЫБРАТЬ
								|		ЕСНДополнительныеНачисления.Сотрудник,
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859
								//|		СУММА(ВЫБОР
								//|				КОГДА ЕСНДополнительныеНачисления.ДоходФСЗН = &ДоходФСЗН
								//|					ТОГДА ЕСНДополнительныеНачисления.Результат
								//|				ИНАЧЕ 0
								//|			КОНЕЦ)
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859
								|		СУММА( ЕСНДополнительныеНачисления.Результат )
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								|	ИЗ
								|		РегистрРасчета.ЕСНДополнительныеНачисления КАК ЕСНДополнительныеНачисления
								|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
								|			ПО ЕСНДополнительныеНачисления.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета
								|	ГДЕ
								|		ЕСНДополнительныеНачисления.БазовыйПериодНачало МЕЖДУ &Период1 И &Период2
								|		И ЕСНДополнительныеНачисления.Сотрудник = &Сотрудник
								|		И ЕСНДополнительныеНачисления.Организация = &Организация
								|		И СреднийЗаработокБазовыеВидыРасчета.Ссылка = &ВидРасчетаСредний
								|	
								|	СГРУППИРОВАТЬ ПО
								|		ЕСНДополнительныеНачисления.Сотрудник) КАК ВложенныйЗапрос
								|
								|СГРУППИРОВАТЬ ПО
								|	ВложенныйЗапрос.Сотрудник";
								
								
							иначе
								
								ЗапросПровБазы.Текст = 
								"ВЫБРАТЬ
								|	ВложенныйЗапрос.Сотрудник,
								|	СУММА(ВложенныйЗапрос.Результат) КАК Результат
								|ИЗ
								|	(ВЫБРАТЬ
								|		ЕСНОсновныеНачисления.Сотрудник КАК Сотрудник,
								|		СУММА(ЕСНОсновныеНачисления.Результат) КАК Результат
								|	ИЗ
								|		РегистрРасчета.ЕСНОсновныеНачисления КАК ЕСНОсновныеНачисления
								|	ГДЕ
								|		ЕСНОсновныеНачисления.ПериодДействияНачало МЕЖДУ &Период1 И &Период2
								|		И ЕСНОсновныеНачисления.Сотрудник = &Сотрудник
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859 ( нужно учитывать весь доход )
								//|		И ЕСНОсновныеНачисления.ДоходФСЗН = &ДоходФСЗН
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								|		И ЕСНОсновныеНачисления.Организация = &Организация";
								
								//Аверсон 07.08.2021 КВВ СВФР-007953 (
								Если ТаблицаЗаписей[Индекс].ВидРасчета=ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ Тогда
									ЗапросПровБазы.Текст = ЗапросПровБазы.Текст + "
									|		И ЕСНОсновныеНачисления.КодДоходаЕСН В (&КодыДоходовЕСНФОТ)";
								КонецЕсли;
								//Аверсон 07.08.2021 КВВ СВФР-007953 )
								
								ЗапросПровБазы.Текст = ЗапросПровБазы.Текст + "
								|	
								|	СГРУППИРОВАТЬ ПО
								|		ЕСНОсновныеНачисления.Сотрудник
								|	
								|	ОБЪЕДИНИТЬ ВСЕ
								|	
								|	ВЫБРАТЬ
								|		ЕСНДополнительныеНачисления.Сотрудник,
								|		СУММА(ЕСНДополнительныеНачисления.Результат)
								|	ИЗ
								|		РегистрРасчета.ЕСНДополнительныеНачисления КАК ЕСНДополнительныеНачисления
								|	ГДЕ
								|		ЕСНДополнительныеНачисления.БазовыйПериодНачало МЕЖДУ &Период1 И &Период2
								|		И ЕСНДополнительныеНачисления.Сотрудник = &Сотрудник
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859 ( нужно учитывать весь доход )
								//|		И ЕСНДополнительныеНачисления.ДоходФСЗН = &ДоходФСЗН
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								|		И ЕСНДополнительныеНачисления.Организация = &Организация";
								
								//Аверсон 07.08.2021 КВВ СВФР-007953 (
								Если ТаблицаЗаписей[Индекс].ВидРасчета=ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ Тогда
									ЗапросПровБазы.Текст = ЗапросПровБазы.Текст + "
									|		И ЕСНДополнительныеНачисления.КодДоходаЕСН В (&КодыДоходовЕСНФОТ)";
								КонецЕсли;
								//Аверсон 07.08.2021 КВВ СВФР-007953 )
								
								ЗапросПровБазы.Текст = ЗапросПровБазы.Текст + "
								|	
								|	СГРУППИРОВАТЬ ПО
								|		ЕСНДополнительныеНачисления.Сотрудник) КАК ВложенныйЗапрос
								|
								|СГРУППИРОВАТЬ ПО
								|	ВложенныйЗапрос.Сотрудник";
								
							КонецЕсли;   
							
							ЗапросПровБазы.УстановитьПараметр("ДоходФСЗН", Перечисления.ДоходыФСС_НС.Облагается);
							ЗапросПровБазы.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
							ЗапросПровБазы.УстановитьПараметр("Период1", НачалоМесяца(ВыборкаБазы.МесяцВыборки));
							ЗапросПровБазы.УстановитьПараметр("Период2", КонецМесяца(ВыборкаБазы.МесяцВыборки));
							ЗапросПровБазы.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
							ЗапросПровБазы.УстановитьПараметр("ВидРасчетаСредний", ТаблицаЗаписей[Индекс].ВидРасчета);
							
							//Аверсон 07.08.2021 КВВ СВФР-007953 (
							Если ТаблицаЗаписей[Индекс].ВидРасчета=ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ Тогда
								СписокКодыДоходовЕСНФОТ = Новый СписокЗначений;
								СписокКодыДоходовЕСНФОТ.Добавить(Справочники.ДоходыЕСН.ОблагаетсяФСЗН);
								СписокКодыДоходовЕСНФОТ.Добавить(Справочники.ДоходыЕСН.ОблагаетсяФСЗНиЕП);
								СписокКодыДоходовЕСНФОТ.Добавить(Справочники.ДоходыЕСН.ОблагаетсяФСЗНиСТРАХ);
								СписокКодыДоходовЕСНФОТ.Добавить(Справочники.ДоходыЕСН.ОблагаетсяПолностью);
								
								ЗапросПровБазы.УстановитьПараметр("КодыДоходовЕСНФОТ", СписокКодыДоходовЕСНФОТ);
							КонецЕсли;
							//Аверсон 07.08.2021 КВВ СВФР-007953 )	
							
							РезПровБазы = ЗапросПровБазы.Выполнить();       					
							ВыборкаДетальныеЗаписи = РезПровБазы.Выбрать(); 
							БазаПоФОТ = 0;
							Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
								БазаПоФОТ = ВыборкаДетальныеЗаписи.Результат;
								ЗначениеЕсть = Истина;
							КонецЦикла;
						КонецЕсли;
						//О.Т. Аверсон 15.04.2019 № 4229 
						
						//Островская Татьяна 12.06.2014 Пересчет
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда 
							РезультатБаза	     = ОбщегоНазначения.ОкруглитьПоВалюте(ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаБазы.РезультатБаза/10000, СтрокаДвижений.ПериодРегистрации),Константы.ВалютаРегламентированногоУчета.Получить());;					
						Иначе
							РезультатБаза = ВыборкаБазы.РезультатБаза; 
						КонецЕсли;
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ДопСтрокаДвижений.Результат = ЗначениеПоРег[0].Результат;
								ДопСтрокаДвижений.РезультатДляПремии = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза);
							иначе
								ДопСтрокаДвижений.Результат 		 = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза);//Островская Татьяна 28.12.2012 № 16068
								ДопСтрокаДвижений.РезультатДляПремии = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза);
							КонецЕсли;
						иначе
							ДопСтрокаДвижений.Результат 		 = ?(ЗначениеЕсть и БазаПоФОТ <?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ВыборкаБазы.РезультатБаза),БазаПоФОТ,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ВыборкаБазы.РезультатБаза));//Островская Татьяна 28.12.2012 № 16068
							ДопСтрокаДвижений.РезультатДляПремии = ?(ЗначениеЕсть и БазаПоФОТ <?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ВыборкаБазы.РезультатБаза),БазаПоФОТ,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ВыборкаБазы.РезультатБаза));
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						
						//Островская Татьяна 11.09.2013 № 16778
						если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
							строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
							если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
								ДопСтрокаДвижений.Результат = БюджетПрожиточногоМинимума;
								ДопСтрокаДвижений.РезультатДляПремии = БюджетПрожиточногоМинимума;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 11.09.2013 № 16778
						ДопСтрокаДвижений.ЧислоМесяцев 		 = ВыборкаБазы.ЧислоМесяцев;//Островская Татьяна 28.12.2012 № 16068
						ДопСтрокаДвижений.ПериодРасчетаСреднегоЗаработка= ВыборкаБазы.ПериодРасчетаСреднегоЗаработка;
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ДопСтрокаДвижений.МесяцВыборки = ЗначениеПоРег[0].МесяцВыборки;
							иначе
								ДопСтрокаДвижений.МесяцВыборки 		 = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,НачалоМесяца(ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
							КонецЕсли;
						иначе
							ДопСтрокаДвижений.МесяцВыборки 		 = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,НачалоМесяца(ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15410
						БезЕТСПоСотруднику = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки),Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).БезЕТС;//О.Т. Аверсон 06.11.2015 № 679
						если БезЕТСПоСотруднику или (не БезЕТСПоСотруднику и СтрокаДвижений.Организация.НеУчитыватьЕТКС) тогда //О.Т. Аверсон 05.02.2016 № 853
							//Островская Татьяна 12.06.2014 Пересчет
							Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
								если ЗначениеПоРег.Количество()> 0 Тогда 
									ДопСтрокаДвижений.ТекущаяТарифнаяСтавка = ЗначениеПоРег[0].ТекущаяТарифнаяСтавка;
									ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = ЗначениеПоРег[0].ТарифнаяСтавкаПериода;;
								иначе
									ДопСтрокаДвижений.ТекущаяТарифнаяСтавка 		 = РазмерПоследнегоОкл;
									ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = Оклад;
								КонецЕсли;
							иначе
								ДопСтрокаДвижений.ТекущаяТарифнаяСтавка 		 = РазмерПоследнегоОкл;
								ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = Оклад;
							КонецЕсли;
							//Островская Татьяна 12.06.2014 Пересчет
						иначе
							Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
								если ЗначениеПоРег.Количество()> 0 Тогда 
									ДопСтрокаДвижений.ТекущаяТарифнаяСтавка = ЗначениеПоРег[0].ТекущаяТарифнаяСтавка;
									ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = ЗначениеПоРег[0].ТарифнаяСтавкаПериода;;
								иначе
									ДопСтрокаДвижений.ТекущаяТарифнаяСтавка 		 = РазмерПоследнегоОкл;
									ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = РазмерТСПериода;
								КонецЕсли;
							иначе
								ДопСтрокаДвижений.ТекущаяТарифнаяСтавка 		 = РазмерПоследнегоОкл;
								ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = РазмерТСПериода;
							КонецЕсли;
						КонецЕсли;
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15410
						//СтруктураПоискаДоп.НомерСтроки = СтруктураПоиска.НомерСтроки;
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								СтруктураПоискаДоп.МесяцВыборки = ЗначениеПоРег[0].МесяцВыборки;
							иначе
								СтруктураПоискаДоп.МесяцВыборки 		 = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,НачалоМесяца(ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
							КонецЕсли;
						иначе
							СтруктураПоискаДоп.МесяцВыборки 		 = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,НачалоМесяца(ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						
						СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(СтруктураПоискаДоп);
						
						Если СтрокиВремени.Количество() > 0 Тогда 
							Если СтрокиВремени.Количество() > 1 Тогда 
								Для каждого строканеноль из СтрокиВремени цикл
									Если СтрокаНеНоль.НормаДнейПоПятидневке > 0 тогда
										ВыбраннаяСтрока = СтрокаНеНоль;
										Прервать;
									иначе
										ВыбраннаяСтрока = СтрокиВремени[0];
									КонецЕсли;
								КонецЦикла;
							Иначе
								ВыбраннаяСтрока = СтрокиВремени[0];
							КонецЕсли;
							
							//Заполним простои
							Если ВыбраннаяСтрока.НаличиеПростоев <> 0 тогда
								СтрокаПростоев = ТаблицаПростоев.Добавить();
								СтрокаПростоев.ВидРасчета = ДопСтрокаДвижений.ВидРасчета;
								//Островская Татьяна 12.06.2014 Пересчет
								Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
									если ЗначениеПоРег.Количество()> 0 Тогда 
										СтрокаПростоев.МесяцВыборки = ЗначениеПоРег[0].МесяцВыборки;
									иначе
										СтрокаПростоев.МесяцВыборки 		 = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,НачалоМесяца(ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
									КонецЕсли;
								иначе
									СтрокаПростоев.МесяцВыборки 		 = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,НачалоМесяца(ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
								КонецЕсли;
								//Островская Татьяна 12.06.2014 Пересчет
								
								СтрокаПростоев.НаличиеПростоев = ВыбраннаяСтрока.НаличиеПростоев;
								Сообщить("Возможно за " + Формат(НачалоМесяца(ВыборкаБазы.МесяцВыборки),"ДЛФ=Д") + " у сотрудника были простои.");
								//Островская Татьяна 30.05.2014 № 17397
								Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") Тогда
									если Пересчет  Тогда 
										ОтборРег = Новый Структура;
										ОтборРег.Вставить("МесяцВыборки",ДопСтрокаДвижений.МесяцВыборки);
										ОтборРег.Вставить("ВидРасчета",ДопСтрокаДвижений.ВидРасчета);
										Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
										если Включать.Количество()> 0 Тогда 
											ДопСтрокаДвижений.Включать = Включать[0].Включать;
										иначе
											ДопСтрокаДвижений.Включать = Ложь;
										КонецЕсли;
									иначе
										ДопСтрокаДвижений.Включать = Ложь;
									КонецЕсли;
								КонецЕсли;
								//Островская Татьяна 30.05.2014 № 17397
							КонецЕсли;
							//О.Т. 09.10.2014 № 17616
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
								КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ДопСтрокаДвижений.МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,ВыборкаБазы.ДатаНачалаДоговора,ВыборкаБазы.ДатаОкончанияДоговора,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
							иначе
								
								КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ДопСтрокаДвижений.МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
							КонецЕсли;
							//О.Т. 09.10.2014 № 17616
							
							//Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям Тогда
							// для "премий фиксированной суммой" надо учитывать отработанное время
							//Островская Татьяна 12.06.2014 Пересчет
							Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
								если ЗначениеПоРег.Количество()> 0 Тогда 
									ДопСтрокаДвижений.ОтработаноПоПятидневке = ЗначениеПоРег[0].ОтработаноПоПятидневке;
									ДопСтрокаДвижений.НормаПоПятидневке 		 = ЗначениеПоРег[0].НормаПоПятидневке;
								иначе
									ДопСтрокаДвижений.ОтработаноПоПятидневке 		 = ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДнейПоПятидневке,ВыбраннаяСтрока.ОтработаноДнейПоПятидневке));//Островская Татьяна 28.12.2012 № 16068
									ДопСтрокаДвижений.НормаПоПятидневке 		 = ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаДнейПоПятидневке,ВыбраннаяСтрока.НормаДнейПоПятидневке)); //Островская Татьяна 28.12.2012 № 16068
								КонецЕсли;
							иначе
								ДопСтрокаДвижений.ОтработаноПоПятидневке 		 = ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДнейПоПятидневке,ВыбраннаяСтрока.ОтработаноДнейПоПятидневке));//Островская Татьяна 28.12.2012 № 16068
								ДопСтрокаДвижений.НормаПоПятидневке 		 = ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаДнейПоПятидневке,ВыбраннаяСтрока.НормаДнейПоПятидневке)); //Островская Татьяна 28.12.2012 № 16068
							КонецЕсли;
							//Островская Татьяна 12.06.2014 Пересчет
							
							//Иначе
							//толик изменение ТС
							Попытка
								//О.Т. 28.04.2015 № 417
								если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") 
									//+ СВЭЙ КДЯ 17.02.20 СВФР-005492
									ИЛИ ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" )
									И Регистратор.ВклПремииПропорциональноОтрабВр
									//- СВЭЙ КДЯ 17.02.20 СВФР-005492
									Тогда 
									если Регистратор.ВклПремииПропорциональноОтрабВр и СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда //О.Т. Аверсон 06.05.2016 № 1141
										ФлагВключатьРасчетПропорционально = Ложь;
									иначе
										ФлагВключатьРасчетПропорционально = Истина;
									КонецЕсли;
								иначе
									ФлагВключатьРасчетПропорционально = Истина; 
								КонецЕсли;
								//О.Т. 28.04.2015 № 417
								Если ВыбраннаяСтрока.МесяцВыборки = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) и ФлагВключатьРасчетПропорционально Тогда
									//О.Т. 29.04.2015 № 417
									если ВидРасчетаМесяца = Перечисления.ВидыУчетаВремени.ПоДням Тогда
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
										ВыбСтрокаОтработаноВремени = ВыбраннаяСтрока.ОтработаноДней;
									иначе
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Ложь);
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
										ВыбСтрокаОтработаноВремени = ВыбраннаяСтрока.ОтработаноЧасов;
									КонецЕсли;
									//О.Т. 29.04.2015 № 417
									
									//Островская Татьяна 12.06.2014 Пересчет
									Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда 
										РезультатБаза	     = ОбщегоНазначения.ОкруглитьПоВалюте(ОбщегоНазначения.ОкруглитьЗначение2016((ДопСтрокаДвижений.Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя)/10000, СтрокаДвижений.ПериодРегистрации),Константы.ВалютаРегламентированногоУчета.Получить());;					
									Иначе
										РезультатБаза = ДопСтрокаДвижений.Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя; 
									КонецЕсли;
									Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
										если ЗначениеПоРег.Количество()> 0 Тогда 
											ДопСтрокаДвижений.Результат = ЗначениеПоРег[0].Результат;
											ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
											ДопСтрокаДвижений.ОтработаноЧасов = ЗначениеПоРег[0].ОтработаноЧасов;
											ДопСтрокаДвижений.ОтработаноДней = ЗначениеПоРег[0].ОтработаноДней;
										иначе
											ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());//Островская Татьяна 28.12.2012 № 16068
											ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
											ДопСтрокаДвижений.ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ОплачиваемоеВремя));//Островская Татьяна 28.12.2012 № 16068
											ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
											ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
											ДопСтрокаДвижений.ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ОплачиваемоеВремя));//Островская Татьяна 28.12.2012 № 16068
										КонецЕсли;
									иначе
										ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());//Островская Татьяна 28.12.2012 № 16068
										ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
										//Островская Татьяна 11.09.2013 № 16778
										если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
											строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
											если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
												ДопСтрокаДвижений.Результат = БюджетПрожиточногоМинимума;
												ДопСтрокаДвижений.РезультатДляПремии = БюджетПрожиточногоМинимума;
												//О.Т. 15.07.2014 № 118	
											ИначеЕсли Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и Регистратор.КалендарныеДни Тогда
												ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат), Константы.ВалютаРегламентированногоУчета.Получить());
												ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат), Константы.ВалютаРегламентированногоУчета.Получить());
											КонецЕсли;
											//О.Т. 15.07.2014 № 118
										КонецЕсли;
										//Островская Татьяна 11.09.2013 № 16778
										
										ДопСтрокаДвижений.ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ОплачиваемоеВремя));//Островская Татьяна 28.12.2012 № 16068
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
										ДопСтрокаДвижений.ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ОплачиваемоеВремя));//Островская Татьяна 28.12.2012 № 16068
									КонецЕсли;
									//Островская Татьяна 12.06.2014 Пересчет
									
								Иначе
									//Островская Татьяна 12.06.2014 Пересчет
									Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
										если ЗначениеПоРег.Количество()> 0 Тогда 
											ДопСтрокаДвижений.ОтработаноДней = ЗначениеПоРег[0].ОтработаноДней;
											ДопСтрокаДвижений.ОтработаноЧасов 		 = ЗначениеПоРег[0].ОтработаноЧасов;
										иначе
											ДопСтрокаДвижений.ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ВыбраннаяСтрока.ОтработаноДней));//Островская Татьяна 28.12.2012 № 16068
											ДопСтрокаДвижений.ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ВыбраннаяСтрока.ОтработаноЧасов)); //Островская Татьяна 28.12.2012 № 16068
										КонецЕсли;
									иначе
										ДопСтрокаДвижений.ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ВыбраннаяСтрока.ОтработаноДней));//Островская Татьяна 28.12.2012 № 16068
										ДопСтрокаДвижений.ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ВыбраннаяСтрока.ОтработаноЧасов)); //Островская Татьяна 28.12.2012 № 16068
										//Аверсон 07.08.2019 КВВ СВФР-004596 (
										Если ПремияПропорц И Регистратор.Метаданные().Имя = "ОплатаПоСреднемуЗаработку" Тогда
											Если (ЕстьТекМесяц И ТЗНаборРасчетаНачисления.ОтработаноДней=0 И ТЗНаборРасчетаНачисления.ОтработаноЧасов) ИЛИ 
												(НЕ ЕстьТекМесяц И ВыбраннаяСтрока.ОтработаноДней=0 И ВыбраннаяСтрока.ОтработаноЧасов = 0) Тогда  
												ДопСтрокаДвижений.Результат = 0;
											КонецЕсли;
										КонецЕсли;
										//Аверсон 07.08.2019 КВВ СВФР-004596 )
									КонецЕсли;
									//Островская Татьяна 12.06.2014 Пересчет
									
								КонецЕсли;
							Исключение
								//Островская Татьяна 12.06.2014 Пересчет
								Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
									если ЗначениеПоРег.Количество()> 0 Тогда 
										ДопСтрокаДвижений.ОтработаноДней = ЗначениеПоРег[0].ОтработаноДней;
										ДопСтрокаДвижений.ОтработаноЧасов = ЗначениеПоРег[0].ОтработаноЧасов;
									иначе
										ДопСтрокаДвижений.ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ВыбраннаяСтрока.ОтработаноДней));//Островская Татьяна 28.12.2012 № 16068
										ДопСтрокаДвижений.ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ВыбраннаяСтрока.ОтработаноЧасов));//Островская Татьяна 28.12.2012 № 16068
									КонецЕсли;
								иначе
									ДопСтрокаДвижений.ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ВыбраннаяСтрока.ОтработаноДней));//Островская Татьяна 28.12.2012 № 16068
									ДопСтрокаДвижений.ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ВыбраннаяСтрока.ОтработаноЧасов));//Островская Татьяна 28.12.2012 № 16068
								КонецЕсли;
								//Островская Татьяна 12.06.2014 Пересчет
								
							КонецПопытки;
							//ДопСтрокаДвижений.ОтработаноДней 					= ВыбраннаяСтрока.ОтработаноДней;
							//ДопСтрокаДвижений.ОтработаноЧасов 					= ВыбраннаяСтрока.ОтработаноЧасов;
							//КонецЕсли;
							//СтрокаДвижений = ДопСтрокаДвижений;
							
							//+ СВЭЙ КДЯ 09.01.20 СВФР-005273
							УчитыватьСтавку = ( ТипЗнч(  СтрокаДвижений.Регистратор ) 
							= Тип( "ДокументСсылка.НачислениеПоБольничномуЛисту" ) 
							И СтрокаДвижений.Регистратор.УчитыватьСтавку );
							//- СВЭЙ КДЯ 09.01.20 СВФР-005273
							
							//Аверсон ЕАЕ 10.02.2021 СВФР-007115
							НормаИзГрафика = (ТипЗнч(СтрокаДвижений.Регистратор) 
							= Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") 
							И СтрокаДвижений.Регистратор.НормаИзГрафика);
							//Аверсон
							
							мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику( 
							НачалоМесяца( ВыборкаБазы.МесяцВыборки ),
							КонецМесяца( ВыборкаБазы.МесяцВыборки ), 
							СтрокаДвижений.Сотрудник
							//+ СВЭЙ КДЯ 09.01.20 СВФР-005273
							, УчитыватьСтавку 
							//- СВЭЙ КДЯ 09.01.20 СВФР-005273
							
							//Аверсон ЕАЕ 10.02.2021 СВФР-007115
							,,
							НормаИзГрафика
							//Аверсон
							);
							ДопСтрокаДвижений.НормаДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаДней,мНорма.НормаДней));//Островская Татьяна 28.12.2012 № 16068
							ДопСтрокаДвижений.НормаЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаЧасов,мНорма.НормаЧасов));//Островская Татьяна 28.12.2012 № 16068
							//ДопСтрокаДвижений.НормаДней 					= ВыбраннаяСтрока.НормаДней;
							//ДопСтрокаДвижений.НормаЧасов 					= ВыбраннаяСтрока.НормаЧасов;
							ПредыдущийКоэффициентИндексации = ТекущийКоэффициентИндексации;
							//толик если премия то нужно сразу разделить результат пропорционально
							//Островская Татьяна 12.07.2013 № 16623
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
								ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда //О.Т. 23.09.2014 № 17616 
								если (Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПустаяСсылка() или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу) и Регистратор.КалендарныеДни Тогда //О.Т. 16.07.2014 № 118
									ДопСтрокаДвижений.ОтработаноДней = ?(ПремияПропорц,0,КалендарныеДни);
								КонецЕсли;
							КонецЕсли;
							//Островская Татьяна 12.07.2013 № 16623
							//Аверсон-софт, Островская Татьяна 27.06.2012 № 15549
							//Островская Татьяна 23.10.2013 № 16864
							//Островская Татьяна 12.06.2014 Пересчет
							Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
								если ЗначениеПоРег.Количество()> 0 Тогда 
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									//ДопСтрокаДвижений.КоэффициентИндексации = ЗначениеПоРег[0].КоэффициентИндексации;
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									ДопСтрокаДвижений.КоэффициентИндексации  = РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( ЗначениеПоРег[0].КоэффициентИндексации, ОкруглитьКоэффициентИндексации );
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								иначе
									ДопСтрокаДвижений.КоэффициентИндексации = ТекущийКоэффициентИндексации;
								КонецЕсли;
							иначе
								ДопСтрокаДвижений.КоэффициентИндексации = ТекущийКоэффициентИндексации;
							КонецЕсли;
							//Островская Татьяна 12.06.2014 Пересчет 
							если Пересчет и (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") Тогда 
								ОтборРег = Новый Структура;
								ОтборРег.Вставить("МесяцВыборки",ДопСтрокаДвижений.МесяцВыборки);
								ОтборРег.Вставить("ВидРасчета",ДопСтрокаДвижений.ВидРасчета);
								Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
								если Включать.Количество()> 0 Тогда 
									ДопСтрокаДвижений.Включать = Включать[0].Включать;
								иначе
									ДопСтрокаДвижений.Включать = Истина;
								КонецЕсли;
							иначе
								ДопСтрокаДвижений.Включать = Истина;
							КонецЕсли;
							
							//Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
							//	ОтборРег = Новый Структура;
							//	ОтборРег.Вставить("МесяцВыборки",ДопСтрокаДвижений.МесяцВыборки);
							//	Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
							//	если Включать.Количество()> 0 Тогда 
							//		ДопСтрокаДвижений.Включать = Включать[0].Включать;
							//	иначе
							//		ДопСтрокаДвижений.Включать = Истина;
							//	КонецЕсли;
							//КонецЕсли;
							//Островская Татьяна 23.10.2013 № 16864
						Иначе
							Если Не ДопСтрокаДвижений.БПНачало = Неопределено Тогда 
								//О.Т. 28.04.2015 № 417
								если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
									если Регистратор.ВклПремииПропорциональноОтрабВр и СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда 
										ФлагВключатьРасчетПропорционально = Ложь;
									иначе
										ФлагВключатьРасчетПропорционально = Истина;
									КонецЕсли;
								иначе
									ФлагВключатьРасчетПропорционально = Истина; 
								КонецЕсли;
								//О.Т. 28.04.2015 № 417
								Если НачалоМесяца(ДопСтрокаДвижений.БПНачало) = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) и ФлагВключатьРасчетПропорционально Тогда
									//О.Т. 29.04.2015 № 417
									если ВидРасчетаМесяца = Перечисления.ВидыУчетаВремени.ПоДням Тогда
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
										НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ДопСтрокаДвижений.БПНачало), КонецМесяца(ДопСтрокаДвижений.БПНачало), СтрокаДвижений.Сотрудник).НормаДней;
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
									иначе
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Ложь);
										НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ДопСтрокаДвижений.БПНачало), КонецМесяца(ДопСтрокаДвижений.БПНачало), СтрокаДвижений.Сотрудник).НормаЧасов;
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
									КонецЕсли;
									//О.Т. 29.04.2015 № 417
									
									//Островская Татьяна 12.06.2014 Пересчет
									Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда 
										РезультатБаза	     = ОбщегоНазначения.ОкруглитьПоВалюте(ОбщегоНазначения.ОкруглитьЗначение2016((ДопСтрокаДвижений.Результат/НормаВремени*ОплачиваемоеВремя)/10000, СтрокаДвижений.ПериодРегистрации),Константы.ВалютаРегламентированногоУчета.Получить());;					
									Иначе
										РезультатБаза = ДопСтрокаДвижений.Результат/НормаВремени*ОплачиваемоеВремя; 
									КонецЕсли;
									Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
										если ЗначениеПоРег.Количество()> 0 Тогда 
											ДопСтрокаДвижений.Результат = ЗначениеПоРег[0].Результат;
											ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
										иначе
											Если ЗначениеЗаполнено(НормаВремени) Тогда
												ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());//Островская Татьяна 28.12.2012 № 16068
												ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
											КонецЕсли;
										КонецЕсли;
									иначе
										//О.Т. 15.07.2014 № 118
										Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
											ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда //О.Т. 23.09.2014 № 17616
											если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу Тогда 
												ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат), Константы.ВалютаРегламентированногоУчета.Получить());
												ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат), Константы.ВалютаРегламентированногоУчета.Получить());
											иначе
												ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
												ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
											КонецЕсли;
										иначе
											//О.Т. 15.07.2014 № 118
											Если ЗначениеЗаполнено(НормаВремени) Тогда
												ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());//Островская Татьяна 28.12.2012 № 16068
												ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ДопСтрокаДвижений.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
											КонецЕсли;
										КонецЕсли;
									КонецЕсли;
									//Островская Татьяна 12.06.2014 Пересчет 
									
									//Островская Татьяна 11.09.2013 № 16778
									если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
										строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
										если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
											ДопСтрокаДвижений.Результат = БюджетПрожиточногоМинимума;
											ДопСтрокаДвижений.РезультатДляПремии = БюджетПрожиточногоМинимума;
										КонецЕсли;
									КонецЕсли;
									//Островская Татьяна 11.09.2013 № 16778
								КонецЕсли
								//енд					
							КонецЕсли;
							//Островская Татьяна 12.07.2013 № 16623
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
								ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.09.2014 № 17616 
								если (Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПустаяСсылка() или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.БПМ или
									Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу) и Регистратор.КалендарныеДни Тогда //О.Т. 16.07.2014 № 118
									ДопСтрокаДвижений.ОтработаноДней = ?(ПремияПропорц,0,КалендарныеДни);
								КонецЕсли;
							КонецЕсли;
							//Островская Татьяна 12.07.2013 № 16623
							
						КонецЕсли;
						
						//Островская Татьяна 03.12.2013 № 16960
						//Островская Татьяна 30.05.2014 № 17397
						если Пересчет и (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") Тогда 
							ОтборРег = Новый Структура;
							ОтборРег.Вставить("МесяцВыборки",ДопСтрокаДвижений.МесяцВыборки);
							ОтборРег.Вставить("ВидРасчета",ДопСтрокаДвижений.ВидРасчета);
							Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
							если Включать.Количество()> 0 Тогда 
								ДопСтрокаДвижений.Включать = Включать[0].Включать;
							иначе
								Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
									если ДопСтрокаДвижений.ОтработаноЧасов < ДопСтрокаДвижений.НормаЧасов Тогда 
										ДопСтрокаДвижений.Включать = Ложь;
										СписокСообщений.Добавить(ДопСтрокаДвижений.МесяцВыборки);//О.Т. 26.09.2014 № 17568
									КонецЕсли;
								КонецЕсли; 
							КонецЕсли;
						иначе
							
							Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
								если ДопСтрокаДвижений.ОтработаноЧасов < ДопСтрокаДвижений.НормаЧасов Тогда 
									ДопСтрокаДвижений.Включать = Ложь;
									СписокСообщений.Добавить(ДопСтрокаДвижений.МесяцВыборки);//О.Т. 26.09.2014 № 17568
								КонецЕсли;
							КонецЕсли;    
						КонецЕсли;
						//Островская Татьяна 03.12.2013 № 16960, 17397
						
						// удалила, т.к. в конце расчитывается результат для премии!!!
						//Если не УсловиеДляБПМ тогда
						//	если ПремияПропорц Тогда 
						//		если ВыборкаБазы.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда 
						//			если мНорма.НормаДней/ВыбраннаяСтрока.ОтработаноДней <1 Тогда 
						//				ДопСтрокаДвижений.Результат = ДопСтрокаДвижений.Результат /1;
						//			иначе
						//				ДопСтрокаДвижений.Результат = ДопСтрокаДвижений.Результат /мНорма.НормаДней*ВыбраннаяСтрока.ОтработаноДней;
						//			КонецЕсли;
						//			
						//		иначе
						//			если мНорма.НормаЧасов/ВыбраннаяСтрока.ОтработаноЧасов <1 Тогда 
						//				ДопСтрокаДвижений.Результат = ДопСтрокаДвижений.Результат /1;
						//			иначе
						//				ДопСтрокаДвижений.Результат = ДопСтрокаДвижений.Результат /мНорма.НормаЧасов*ВыбраннаяСтрока.ОтработаноЧасов;
						//			КонецЕсли;
						//		КонецЕсли; 
						//		ПремияПропорц = Ложь;
						//	КонецЕсли;
						//КонецЕсли;
						
						//О.Т. 04.09.2014 № 17567
						Если ВыборкаБазы.ВключенВГруппуРасчетов > 0 и не Пересчет Тогда 						
							ДопСтрокаДвижений.Включать = Ложь;
							Сообщить("Месяц выборки "+Формат(ВыборкаБазы.МесяцВыборки,"ДФ=""дд.ММ.гггг""")+" исключается из расчета среднего заработка, т.к. у работника в этом месяце есть вид расчета, который включен в группу расчетов.");//О.Т. Аверсон 08.12.2016 № 74
						ИначеЕсли ВыборкаБазы.ВключенВГруппуРасчетов = 0 и не Пересчет и Регистратор.Организация.НормаВОтпускахПоГрРасчетов и (ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или
							ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда
							
							ДопСтрокаДвижений.Включать = Истина;
							//Аверсон 28.04.2023 КВВ СВФР-010738 (
							Если НЕ Пересчет И Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" Тогда
								ПроверкаНаВРВГруппеРасчетов = СформироватьДанныеПоГрРасчетов(НачалоМесяца(ВыборкаБазы.МесяцВыборки), КонецМесяца(ВыборкаБазы.МесяцВыборки),СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник);
								Если ПроверкаНаВРВГруппеРасчетов Тогда
									ДопСтрокаДвижений.Включать = Ложь;
									Сообщить("Месяц выборки " + Формат(ВыборкаБазы.МесяцВыборки, "ДЛФ=D") + " исключается из расчета среднего заработка, т.к. есть виды времени, включенные в группу расчетов """ + СокрЛП(СтрокаДвижений.Организация.ГруппаРасчета) + """");
									//	Продолжить;
								КонецЕсли;
							КонецЕсли;
							//Аверсон 28.04.2023 КВВ СВФР-010738 )
						КонецЕсли; 
						//О.Т. 04.09.2014 № 17567
						если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда 
							ДопСтрокаДвижений.Включать = Истина;
						КонецЕсли;
						если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") и ДопСтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку Тогда //О.Т. Аверсон 10.02.2016 Для выходного пособия
							ДопСтрокаДвижений.Включать = Истина;			
						КонецЕсли;
						
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) и не Пересчет Тогда 
							ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьЗначение2016(ДопСтрокаДвижений.Результат/10000,СтрокаДвижений.ПериодРегистрации);//Островская Татьяна 08.10.2013;
							ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьЗначение2016(ДопСтрокаДвижений.РезультатДляПремии/10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
						
						если не Пересчет Тогда 
							ДопСтрокаДвижений.Результат = ДопСтрокаДвижений.Результат - СуммаБольничный;
						КонецЕсли;
						ДопСтрокаДвижений.РезультатДляПремии = ДопСтрокаДвижений.РезультатДляПремии - СуммаБольничный;
						
						ДопСтрокаДвижений.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ДопСтрокаДвижений.Результат, Константы.ВалютаРегламентированногоУчета.Получить());//Островская Татьяна 08.10.2013;
						ДопСтрокаДвижений.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(ДопСтрокаДвижений.РезультатДляПремии, Константы.ВалютаРегламентированногоУчета.Получить());
						
					Иначе
						
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда 
							ОтборРег = Новый Структура;
							ОтборРег.Вставить("МесяцВыборки",ВыборкаБазы.МесяцВыборки);
							ОтборРег.Вставить("ВидРасчета",СтрокаДвижений.ВидРасчета);
							ЗначениеПоРег = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						
						ПерваяЗапись = Ложь;   
						если УсловиеДляБПМ Тогда 
							если не  СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ Тогда 
								Продолжить;
							КонецЕсли;
							
						КонецЕсли;
						
						//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
						//вынесено в отдельную процедуру ПолучитьСтруктуруДатБюджетаПрожиточногоМинимума (см. ниже)
						////Островская Татьяна 11.09.2013 № 16778
						//Если Месяц(ВыборкаБазы.МесяцВыборки) >= 2 и Месяц(ВыборкаБазы.МесяцВыборки) <= 04 Тогда 
						//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0201000000");
						//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)-1," ","")+"1101000000");
						//ИначеЕсли Месяц(ВыборкаБазы.МесяцВыборки) >= 5 и Месяц(ВыборкаБазы.МесяцВыборки) <= 7 Тогда 
						//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0501000000");
						//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0201000000");
						//ИначеЕсли Месяц(ВыборкаБазы.МесяцВыборки) >= 8 и Месяц(ВыборкаБазы.МесяцВыборки) <= 10 Тогда 
						//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0801000000");
						//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0501000000");
						//ИначеЕсли Месяц(ВыборкаБазы.МесяцВыборки) >= 11 или Месяц(ВыборкаБазы.МесяцВыборки) = 1 Тогда 
						//	если Месяц(ВыборкаБазы.МесяцВыборки) = 1 Тогда
						//		ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)-1," ","")+"1101000000");
						//		ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)-1," ","")+"0801000000");
						//	иначе
						//		ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"1101000000"); 
						//		ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ВыборкаБазы.МесяцВыборки)," ","")+"0801000000");
						//	КонецЕсли;
						//	
						//КонецЕсли;
						//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
						
						//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
						СтруктураДатБПМ = ПолучитьСтруктуруДатБюджетаПрожиточногоМинимума( 
						?( ЭтоТипРасчетаПоОкладу, НачалоМесяца( СтрокаДвижений.ДатаНачалаСобытия ), ВыборкаБазы.МесяцВыборки )  
						);
						ДатаБюджетаПрожМиним1 = СтруктураДатБПМ.ДатаБюджетаПрожМинимТекущегоПериода;
						ДатаБюджетаПрожМиним2 = СтруктураДатБПМ.ДатаБюджетаПрожМинимПредыдущегоПериода;
						//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
						
						БюджетПрожиточногоМинимума1 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним1, 
						Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
						БюджетПрожиточногоМинимума2 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним2, 
						Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
						БюджетПрожиточногоМинимума = Макс(БюджетПрожиточногоМинимума1,БюджетПрожиточногоМинимума2);
						если УсловиеДляБПМ Тогда 
							если ПрошлыйБюджетПрожиточногоМинимума = БюджетПрожиточногоМинимума Тогда 
								Продолжить;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 11.09.2013 № 16778
						БезЕТСПоСотруднику = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки),Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).БезЕТС;//О.Т. Аверсон 06.11.2015 № 679
						//Островская Татьяна 25.03.2013 № 16352
						если Строка(ТипЗнч(Регистратор)) = Метаданные.Документы.НачислениеОтпускаРаботникамОрганизаций.Синоним или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Строка(ТипЗнч(Регистратор)) = Метаданные.Документы.РасчетПриУвольненииРаботникаОрганизаций.Синоним Тогда //О.Т. Аверсон 09.02.2018 № 1566 + средний
							УсловиеФлагОрганизация = СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС;//О.Т. 18.07.2014 (убран ЕТКС)
						Иначе
							УсловиеФлагОрганизация = не БезЕТСПоСотруднику;
						КонецЕсли;
						//Островская Татьяна 25.03.2013 № 16352
						
						//Аверсон-софт, Островская Татьяна 12.06.2012 № 15410
						если не УсловиеФлагОрганизация тогда
							//Аверсон-софт, Островская Татьяна 12.06.2012 № 15410     т
							//О.Т. 23.02.2015 № 331
							если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда //О.Т. Аверсон 09.02.2018 № 1566 + средний
								//О.Т. Аверсон 06.12.2016 № 74
								РегистрТарифныеСтавки = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.ПериодРегистрации), Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник));
								Если РегистрТарифныеСтавки.ДляПечати Тогда 
									РазмерПоследнегоОкл =  РегистрТарифныеСтавки.МесячнаяТарифнаяСтавкаВВалюте;
								иначе
									РазмерПоследнегоОкл =  РегистрТарифныеСтавки.ТарифнаяСтавка;
								КонецЕсли;
								//О.Т. Аверсон 06.12.2016 № 74
								
								//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
							иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
								
								ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ВыборкаБазы.МесяцВыборки, СтрокаДвижений );
								ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
								РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
								ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
								//- СВЭЙ КДЯ 27.01.20 СВФР-005409
								
							иначе	
								ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
								ЗапросОкладПосл = Новый Запрос;
								ЗапросОкладПосл.Текст = 
								"ВЫБРАТЬ
								|	ВЫБОР
								|		КОГДА ТарифныеСтавкиРаботниковОрганизации.ДляПечати
								|			ТОГДА ТарифныеСтавкиРаботниковОрганизации.МесячнаяТарифнаяСтавкаВВалюте
								|		ИНАЧЕ ТарифныеСтавкиРаботниковОрганизации.ТарифнаяСтавка
								|	КОНЕЦ КАК ТарифнаяСтавка,//О.Т. Аверсон 06.12.2016 № 74
								|	ТарифныеСтавкиРаботниковОрганизации.Период
								|ИЗ
								|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
								|			&Дата,
								|			Организация = &Организация
								|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
								|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
								|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
								|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
								|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
								|ГДЕ
								|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
								
								ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
								ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
								ЗапросОкладПосл.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								
								РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
								РазмерПоследнегоОкл = 0;
								Пока РезультатОкладПосл.Следующий() Цикл
									РазмерПоследнегоОкл = РезультатОкладПосл.ТарифнаяСтавка;
									Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и РезультатОкладПосл.Период < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
										РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
									КонецЕсли; 								
								КонецЦикла;
								
							КонецЕсли;
							//О.Т. 23.02.2015 № 331
							
							//О.Т. Аверсон 06.12.2016 № 74
							РегистрТарифныеСтавки = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки), Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник));
							Если РегистрТарифныеСтавки.ДляПечати Тогда 
								Оклад =  РегистрТарифныеСтавки.МесячнаяТарифнаяСтавкаВВалюте;
							иначе
								Оклад =  РегистрТарифныеСтавки.ТарифнаяСтавка;
								////Аверсон 05.05.2022 КВВ СВФР-009018 (
								//ЗСт = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки),Новый Структура("Организация, Сотрудник", СтрокаДвижений.Организация, СтрокаДвижений.Сотрудник)).ЗанимаемыхСтавок;
								//Если ЗСт > 0 И ЗСт < 1 Тогда
								//	Оклад = Окр(Оклад/ЗСт,2);
								//КонецЕсли;
								////Аверсон 05.05.2022 КВВ СВФР-009018 )
								
							КонецЕсли;
							//О.Т. Аверсон 06.12.2016 № 74
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
								Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
							КонецЕсли;
							//Островская Татьяна 10.07.2013 № 16615
							если не Оклад = 0 Тогда 
								//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
								//ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, ?( РазмерПоследнегоОкл = 0 , 1, ?( РазмерПоследнегоОкл < Оклад, МАКС( ПредыдущийКоэффициентИндексации, 1 ), Окр( РазмерПоследнегоОкл /Оклад, 10 ) ) ) ); //Островская Татьяна 02.08.2013 № 16623							
								//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
								ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, ?( РазмерПоследнегоОкл = 0 , 1, 
								?( РазмерПоследнегоОкл < Оклад, 
								//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
								//МАКС( ПредыдущийКоэффициентИндексации, 1 ),
								//- СВЭЙ КДЯ 03.01.20 СВФР-005167
								//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
								РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( МАКС( ПредыдущийКоэффициентИндексации, 1 ), ОкруглитьКоэффициентИндексации ),
								//- СВЭЙ КДЯ 03.01.20 СВФР-005167
								РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( РазмерПоследнегоОкл / Оклад, ОкруглитьКоэффициентИндексации ) ) ) );							
								//- СВЭЙ 15.03.19 КДЯ СВФР-004088
							иначе
								ТекущийКоэффициентИндексации = 1;
								ОбщегоНазначения.СообщитьОбОшибке("Оклад на "+ ВыборкаБазы.МесяцВыборки + " равен 0");
							КонецЕсли;
							//Островская Татьяна 10.07.2013 № 16615
						иначе
							//О.Т. 23.02.2015 № 331
							если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда  //О.Т. Аверсон 09.02.2018 № 1566 + средний
								ПериодПоследнегоОкл = ТекущаяДата();
								
								//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
							иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
								
								ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ВыборкаБазы.МесяцВыборки, СтрокаДвижений );
								ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
								РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
								ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
								//- СВЭЙ КДЯ 27.01.20 СВФР-005409
								
							иначе
								
								ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
								ЗапросОкладПосл = Новый Запрос;
								ЗапросОкладПосл.Текст = 
								"ВЫБРАТЬ
								|	ТарифныеСтавкиРаботниковОрганизации.Период
								|ИЗ
								|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
								|			&Дата,
								|			Организация = &Организация
								|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
								|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
								|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
								|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
								|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
								|ГДЕ
								|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
								
								ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
								ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
								ЗапросОкладПосл.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								
								РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
								ПериодПоследнегоОкл = ТекущаяДата();
								Пока РезультатОкладПосл.Следующий() Цикл
									ПериодПоследнегоОкл = РезультатОкладПосл.Период;
								КонецЦикла;      
							КонецЕсли;
							//О.Т. 23.02.2015 № 331
							
							//Островская Татьяна 17.06.2013 № 16558
							ТарифнаяСтавкаПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
							Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
							ТарифнаяСтавкаПериода1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
							Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
							
							РазмерПоследнегоОкл =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
							Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода)).Размер;
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ПериодПоследнегоОкл < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
								РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
							КонецЕсли;
							Оклад = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки), 
							Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода)).Размер;
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
								Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
							КонецЕсли;
							//Островская Татьяна 17.06.2013 № 16558
						КонецЕсли;
						//Аверсон-софт, Островская Татьяна 12.06.2012 № 15410
						
						//Островская Татьяна 28.12.2012 № 16068
						если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
							строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
							если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда 
								ТаблицаЗаписей[Индекс].БазовыйПериодКонец 					= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].БазовыйПериодКонец,ДобавитьМесяц(ТаблицаЗаписей[Индекс].БазовыйПериодКонец,1));
								ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец 					= ?(ЕстьТекМесяц,ДобавитьМесяц(ТаблицаЗаписей[Индекс].БазовыйПериодКонец,1),ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец);
								
							КонецЕсли;
						иначе
							//Островская Татьяна 12.06.2014 Пересчет
							Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
								если ЗначениеПоРег.Количество()> 0 Тогда 
									ТаблицаЗаписей[Индекс].БазовыйПериодКонец 					= ЗначениеПоРег[0].БазовыйПериодКонец;
									
								иначе
									ТаблицаЗаписей[Индекс].БазовыйПериодКонец 					= ДобавитьМесяц(ТаблицаЗаписей[Индекс].БазовыйПериодКонец,1);
									ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец 				= ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец;
								КонецЕсли;
							ИначеЕсли Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
								если ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку Тогда 
									ТаблицаЗаписей[Индекс].БазовыйПериодКонец 					= ТаблицаЗаписей[Индекс].БазовыйПериодКонец; 
								иначе
									ТаблицаЗаписей[Индекс].БазовыйПериодКонец 					= ДобавитьМесяц(ТаблицаЗаписей[Индекс].БазовыйПериодКонец,1);
									ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец 				= ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец;
								КонецЕсли;	
							иначе
								ТаблицаЗаписей[Индекс].БазовыйПериодКонец 					= ДобавитьМесяц(ТаблицаЗаписей[Индекс].БазовыйПериодКонец,1);
								ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец 				= ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец;
							КонецЕсли;
							//Островская Татьяна 12.06.2014 Пересчет
							
						КонецЕсли;
						//Островская Татьяна 28.12.2012 № 16068
						// О.Т. 03.11.2014 17616
						если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда
							
							ТаблицаЗаписей[Индекс].БазовыйПериодКонец 					= Мин(?(БЛПоДоговорамТекМес,КонецМесяца(Регистратор.ДатаНачала),ДатаОкончанияРасчетаСреднего),ВыборкаБазы.ДатаОкончанияОснДог);
							ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец 				= Мин(?(БЛПоДоговорамТекМес,КонецМесяца(Регистратор.ДатаНачала),ДатаОкончанияРасчетаСреднего),ВыборкаБазы.ДатаОкончанияОснДог);
							ТаблицаЗаписей[Индекс].БазовыйПериодНачало 					= ВыборкаБазы.ДатаНачалаОснДог;
							ТаблицаЗаписей[ИндексСлед].БазовыйПериодНачало 				= ВыборкаБазы.ДатаНачалаОснДог;
							
							
							//ТаблицаЗаписей[Индекс].БазовыйПериодКонец 					= ВыборкаБазы.ДатаОкончанияДоговора;
							//ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец 				= ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец;
							//ТаблицаЗаписей[Индекс].БазовыйПериодНачало 					= ВыборкаБазы.ДатаНачалаДоговора;
							//ТаблицаЗаписей[ИндексСлед].БазовыйПериодНачало 				= ТаблицаЗаписей[ИндексСлед].БазовыйПериодНачало;
						КонецЕсли;
						// О.Т. 03.11.2014 17616
						
						Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
							ТаблицаЗаписей[Индекс].ДатаДоговора = ВыборкаБазы.ДатаДоговора;
							ТаблицаЗаписей[Индекс].НомерДоговора = ВыборкаБазы.НомерДоговора;
						КонецЕсли;
						
						
						//О.Т. Аверсон 15.04.2019 № 4229
						ЗапросПровБазы = Новый Запрос;    
						ЗначениеЕсть = Ложь;
						если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту")Тогда
							Если ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии или ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям или
								ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему или ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям Тогда 
								
								ЗапросПровБазы.Текст = 
								"ВЫБРАТЬ
								|	ВложенныйЗапрос.Сотрудник,
								|	СУММА(ВложенныйЗапрос.Результат) КАК Результат
								|ИЗ
								|	(ВЫБРАТЬ
								|		ЕСНОсновныеНачисления.Сотрудник КАК Сотрудник,
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859 17.03.20 СВФР-005656 16
								//|		СУММА(ВЫБОР
								//|				КОГДА ЕСНОсновныеНачисления.ДоходФСЗН = &ДоходФСЗН
								//|					ТОГДА ЕСНОсновныеНачисления.Результат
								//|				ИНАЧЕ 0
								//|			КОНЕЦ) КАК Результат
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859 
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859 17.03.20 СВФР-005656 16
								|		СУММА( ЕСНОсновныеНачисления.Результат ) КАК Результат
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								|	ИЗ
								|		РегистрРасчета.ЕСНОсновныеНачисления КАК ЕСНОсновныеНачисления
								|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
								|			ПО ЕСНОсновныеНачисления.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета
								|	ГДЕ
								|		ЕСНОсновныеНачисления.ПериодДействияНачало МЕЖДУ &Период1 И &Период2
								|		И ЕСНОсновныеНачисления.Сотрудник = &Сотрудник
								|		И ЕСНОсновныеНачисления.Организация = &Организация
								|		И СреднийЗаработокБазовыеВидыРасчета.Ссылка = &ВидРасчетаСредний
								|	
								|	СГРУППИРОВАТЬ ПО
								|		ЕСНОсновныеНачисления.Сотрудник
								|	
								|	ОБЪЕДИНИТЬ ВСЕ
								|	
								|	ВЫБРАТЬ
								|		ЕСНДополнительныеНачисления.Сотрудник,
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859 17.03.20 СВФР-005656 16
								//|		СУММА(ВЫБОР
								//|				КОГДА ЕСНДополнительныеНачисления.ДоходФСЗН = &ДоходФСЗН
								//|					ТОГДА ЕСНДополнительныеНачисления.Результат
								//|				ИНАЧЕ 0
								//|			КОНЕЦ)
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859 17.03.20 СВФР-005656 16
								|		СУММА( ЕСНДополнительныеНачисления.Результат )
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								|	ИЗ
								|		РегистрРасчета.ЕСНДополнительныеНачисления КАК ЕСНДополнительныеНачисления
								|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
								|			ПО ЕСНДополнительныеНачисления.ВидРасчета = СреднийЗаработокБазовыеВидыРасчета.ВидРасчета
								|	ГДЕ
								|		ЕСНДополнительныеНачисления.БазовыйПериодНачало МЕЖДУ &Период1 И &Период2
								|		И ЕСНДополнительныеНачисления.Сотрудник = &Сотрудник
								|		И ЕСНДополнительныеНачисления.Организация = &Организация
								|		И СреднийЗаработокБазовыеВидыРасчета.Ссылка = &ВидРасчетаСредний
								|	
								|	СГРУППИРОВАТЬ ПО
								|		ЕСНДополнительныеНачисления.Сотрудник) КАК ВложенныйЗапрос
								|
								|СГРУППИРОВАТЬ ПО
								|	ВложенныйЗапрос.Сотрудник";
								
							иначе
								
								ЗапросПровБазы.Текст = 
								"ВЫБРАТЬ
								|	ВложенныйЗапрос.Сотрудник,
								|	СУММА(ВложенныйЗапрос.Результат) КАК Результат
								|ИЗ
								|	(ВЫБРАТЬ
								|		ЕСНОсновныеНачисления.Сотрудник КАК Сотрудник,
								|		СУММА(ЕСНОсновныеНачисления.Результат) КАК Результат
								|	ИЗ
								|		РегистрРасчета.ЕСНОсновныеНачисления КАК ЕСНОсновныеНачисления
								|	ГДЕ
								|		ЕСНОсновныеНачисления.ПериодДействияНачало МЕЖДУ &Период1 И &Период2
								|		И ЕСНОсновныеНачисления.Сотрудник = &Сотрудник
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859 ( нужно учитывать весь доход ) 17.03.20 СВФР-005656 16
								//|		И ЕСНОсновныеНачисления.ДоходФСЗН = &ДоходФСЗН
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								|		И ЕСНОсновныеНачисления.Организация = &Организация
								|	
								|	СГРУППИРОВАТЬ ПО
								|		ЕСНОсновныеНачисления.Сотрудник
								|	
								|	ОБЪЕДИНИТЬ ВСЕ
								|	
								|	ВЫБРАТЬ
								|		ЕСНДополнительныеНачисления.Сотрудник,
								|		СУММА(ЕСНДополнительныеНачисления.Результат)
								|	ИЗ
								|		РегистрРасчета.ЕСНДополнительныеНачисления КАК ЕСНДополнительныеНачисления
								|	ГДЕ
								|		ЕСНДополнительныеНачисления.БазовыйПериодНачало МЕЖДУ &Период1 И &Период2
								|		И ЕСНДополнительныеНачисления.Сотрудник = &Сотрудник
								//+ СВЭЙ КДЯ 16.10.19 СВФР-004859 ( нужно учитывать весь доход ) 17.03.20 СВФР-005656 16
								//|		И ЕСНДополнительныеНачисления.ДоходФСЗН = &ДоходФСЗН
								//- СВЭЙ КДЯ 16.10.19 СВФР-004859
								|		И ЕСНДополнительныеНачисления.Организация = &Организация
								|	
								|	СГРУППИРОВАТЬ ПО
								|		ЕСНДополнительныеНачисления.Сотрудник) КАК ВложенныйЗапрос
								|
								|СГРУППИРОВАТЬ ПО
								|	ВложенныйЗапрос.Сотрудник";
								
								
							КонецЕсли;   
							ЗапросПровБазы.УстановитьПараметр("ДоходФСЗН", Перечисления.ДоходыФСС_НС.Облагается);
							ЗапросПровБазы.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
							ЗапросПровБазы.УстановитьПараметр("Период1", НачалоМесяца(ВыборкаБазы.МесяцВыборки));
							ЗапросПровБазы.УстановитьПараметр("Период2", КонецМесяца(ВыборкаБазы.МесяцВыборки));
							ЗапросПровБазы.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
							ЗапросПровБазы.УстановитьПараметр("ВидРасчетаСредний", ТаблицаЗаписей[Индекс].ВидРасчета);
							
							РезПровБазы = ЗапросПровБазы.Выполнить();       					
							ВыборкаДетальныеЗаписи = РезПровБазы.Выбрать(); 
							БазаПоФОТ = 0; 						
							Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
								БазаПоФОТ = ВыборкаДетальныеЗаписи.Результат;
								ЗначениеЕсть = Истина;
							КонецЦикла;
						КонецЕсли;
						//О.Т. Аверсон 15.04.2019 № 4229
						
						//Островская Татьяна 12.06.2014 Пересчет
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда 
							РезультатБаза	     = ОбщегоНазначения.ОкруглитьПоВалюте(ОбщегоНазначения.ОкруглитьЗначение2016((ВыборкаБазы.РезультатБаза)/10000, СтрокаДвижений.ПериодРегистрации),Константы.ВалютаРегламентированногоУчета.Получить());;					
						Иначе
							РезультатБаза = ВыборкаБазы.РезультатБаза; 
						КонецЕсли;					
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ТаблицаЗаписей[Индекс].Результат = ЗначениеПоРег[0].Результат;
								ТаблицаЗаписей[Индекс].РезультатДляПремии = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза);
							иначе
								ТаблицаЗаписей[Индекс].Результат = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза);//Островская Татьяна 28.12.2012 № 16068
								ТаблицаЗаписей[Индекс].РезультатДляПремии = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза);
							КонецЕсли;
						иначе
							ТаблицаЗаписей[Индекс].Результат = ?(ЗначениеЕсть и БазаПоФОТ<?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ВыборкаБазы.РезультатБаза),БазаПоФОТ,?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ВыборкаБазы.РезультатБаза));//Островская Татьяна 28.12.2012 № 16068
							ТаблицаЗаписей[Индекс].Результат = ?(ЗначениеЕсть и БазаПоФОТ<?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ТаблицаЗаписей[Индекс].Результат),БазаПоФОТ,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ТаблицаЗаписей[Индекс].Результат));//О.Т. 16.07.2014 № 118
							ТаблицаЗаписей[Индекс].РезультатДляПремии = ?(ЗначениеЕсть и БазаПоФОТ<?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ВыборкаБазы.РезультатБаза),БазаПоФОТ,?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ВыборкаБазы.РезультатБаза));
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						
						//Островская Татьяна 11.09.2013 № 16778
						если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
							строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
							если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
								ТаблицаЗаписей[Индекс].Результат = БюджетПрожиточногоМинимума;	
								ТаблицаЗаписей[Индекс].РезультатДляПремии = БюджетПрожиточногоМинимума;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 11.09.2013 № 16778
						
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ТаблицаЗаписей[Индекс].МесяцВыборки 					= ЗначениеПоРег[0].МесяцВыборки;
							иначе
								ТаблицаЗаписей[Индекс].МесяцВыборки 					= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].МесяцВыборки,НачалоМесяца(ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
							КонецЕсли;
						иначе
							ТаблицаЗаписей[Индекс].МесяцВыборки 					= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].МесяцВыборки,НачалоМесяца(ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						ТаблицаЗаписей[Индекс].ЧислоМесяцев 					= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ЧислоМесяцев,ВыборкаБазы.ЧислоМесяцев);
						ТаблицаЗаписей[Индекс].ПериодРасчетаСреднегоЗаработка 	= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ПериодРасчетаСреднегоЗаработка,ВыборкаБазы.ПериодРасчетаСреднегоЗаработка);
						
						//ТаблицаЗаписей[ИндексСлед].Результат 						= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ТаблицаЗаписей[ИндексСлед].Результат);//Островская Татьяна 28.12.2012 № 16068
						//Островская Татьяна 11.09.2013 № 16778
						//если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" Тогда
						//	если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда 
						//		 ТаблицаЗаписей[ИндексСлед].Результат = БюджетПрожиточногоМинимума;							
						//	КонецЕсли;
						//КонецЕсли;
						//Островская Татьяна 11.09.2013 № 16778
						ТаблицаЗаписей[ИндексСлед].ЧислоМесяцев 					= ВыборкаБазы.ЧислоМесяцев;
						ТаблицаЗаписей[ИндексСлед].ПериодРасчетаСреднегоЗаработка 	= ВыборкаБазы.ПериодРасчетаСреднегоЗаработка;
						ТаблицаЗаписей[ИндексСлед].МесяцВыборки 					= НачалоМесяца(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,ТаблицаЗаписей[ИндексСлед].МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
						БезЕТСПоСотруднику = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки),Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).БезЕТС;//О.Т. Аверсон 06.11.2015 № 679
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15410
						
						//если БезЕТСПоСотруднику или (не БезЕТСПоСотруднику и СтрокаДвижений.Организация.НеУчитыватьЕТКС) тогда //О.Т. Аверсон 05.02.2016 № 853
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка = ЗначениеПоРег[0].ТекущаяТарифнаяСтавка;
							иначе
								ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка			 = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка,РазмерПоследнегоОкл);
							КонецЕсли;
						иначе
							ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка			 = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка,РазмерПоследнегоОкл);
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						
						ТаблицаЗаписей[ИндексСлед].ТекущаяТарифнаяСтавка			 = ?(ЕстьТекМесяц,РазмерПоследнегоОкл,ТаблицаЗаписей[ИндексСлед].ТекущаяТарифнаяСтавка);
						//иначе
						//	//Островская Татьяна 12.06.2014 Пересчет
						//	Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
						//		если ЗначениеПоРег.Количество()> 0 Тогда 
						//			ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка = ЗначениеПоРег[0].ТекущаяТарифнаяСтавка;
						//		иначе
						//			ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка			 = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка,СтрокаДвижений.ТекущаяТарифнаяСтавка);
						//		КонецЕсли;
						//	иначе
						//		ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка			 = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка,СтрокаДвижений.ТекущаяТарифнаяСтавка);
						//	КонецЕсли;
						//	//Островская Татьяна 12.06.2014 Пересчет
						//	ТаблицаЗаписей[ИндексСлед].ТекущаяТарифнаяСтавка			 =  ?(ЕстьТекМесяц,СтрокаДвижений.ТекущаяТарифнаяСтавка,ТаблицаЗаписей[Индекс].ТекущаяТарифнаяСтавка);
						//КонецЕсли;
						
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15410
						//ТарифнаяСтавкаПериода = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
						//					Новый Структура("Сотрудник,Организация",ТаблицаЗаписей[Индекс].Сотрудник,ТаблицаЗаписей[Индекс].Организация)).Ставка;
						
						ТарифнаяСтавкаПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
						Новый Структура("Сотрудник,Организация", ТаблицаЗаписей[Индекс].Сотрудник,ТаблицаЗаписей[Индекс].Организация)).ТарифнаяСтавкаПервогоРазряда;    //Островская Татьяна 28.12.2012 № 16068
						ТарифнаяСтавкаПериода1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,ВыборкаБазы.Месяцвыборки)), 
						Новый Структура("Сотрудник,Организация", ТаблицаЗаписей[ИндексСлед].Сотрудник,ТаблицаЗаписей[ИндексСлед].Организация)).ТарифнаяСтавкаПервогоРазряда;
						
						//Аверсон 08.02.2023 КВВ СВФР-010260 (
						Если Оклад = 0 И Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" Тогда
							Оклад = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки), 
							Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода)).Размер;
						КонецЕсли;
						//Аверсон 08.02.2023 КВВ СВФР-010260 )
						
						РазмерТСПериода =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
						Новый Структура("Организация,ТарифнаяСтавка", ТаблицаЗаписей[Индекс].Организация, ТарифнаяСтавкаПериода)).Размер;//Островская Татьяна 28.12.2012 № 16068
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
							РазмерТСПериода = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСПериода / 10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
						
						РазмерТСПериода1 =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,КонецМесяца(ВыборкаБазы.Месяцвыборки)), 
						Новый Структура("Организация,ТарифнаяСтавка", ТаблицаЗаписей[ИндексСлед].Организация, ТарифнаяСтавкаПериода)).Размер;//Островская Татьяна 28.12.2012 № 16068
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,ВыборкаБазы.Месяцвыборки) < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
							РазмерТСПериода1 = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСПериода1 / 10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
						
						БезЕТСПоСотруднику = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки),Новый Структура("Сотрудник,Организация", ТаблицаЗаписей[Индекс].Сотрудник,ТаблицаЗаписей[Индекс].Организация)).БезЕТС;//О.Т. Аверсон 06.11.2015 № 679
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15410
						если БезЕТСПоСотруднику или (не БезЕТСПоСотруднику и СтрокаДвижений.Организация.НеУчитыватьЕТКС) тогда //О.Т. Аверсон 05.02.2016 № 853
							//Островская Татьяна 12.06.2014 Пересчет
							Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
								если ЗначениеПоРег.Количество()> 0 Тогда 
									ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода = ЗначениеПоРег[0].ТарифнаяСтавкаПериода;
								иначе
									ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода			 = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода,Оклад);
								КонецЕсли;
							иначе
								ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода			 = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода,Оклад);
							КонецЕсли;
							//Островская Татьяна 12.06.2014 Пересчет
							ТаблицаЗаписей[ИндексСлед].ТарифнаяСтавкаПериода			 = ?(ЕстьТекМесяц,Оклад,ТаблицаЗаписей[ИндексСлед].ТарифнаяСтавкаПериода);
						иначе
							//Островская Татьяна 12.06.2014 Пересчет
							Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
								если ЗначениеПоРег.Количество()> 0 Тогда 
									ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода = ЗначениеПоРег[0].ТарифнаяСтавкаПериода;
								иначе
									ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода			 = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода,РазмерТСПериода);
								КонецЕсли;
							иначе
								ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода			 = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ТарифнаяСтавкаПериода,РазмерТСПериода);
							КонецЕсли;
							//Островская Татьяна 12.06.2014 Пересчет
							ТаблицаЗаписей[ИндексСлед].ТарифнаяСтавкаПериода			 = ?(ЕстьТекМесяц,РазмерТСПериода,ТаблицаЗаписей[ИндексСлед].ТарифнаяСтавкаПериода);
						КонецЕсли;
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15410
						//толик коэффициент индексации с 01.01.2009
						если УсловиеФлагОрганизация тогда
							//О.Т. 23.02.2015 № 331
							если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда  //О.Т. Аверсон 09.02.2018 № 1566 + средний
								ПериодПоследнегоОкл =  ТекущаяДата();
								
								//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
							иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
								
								ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ВыборкаБазы.МесяцВыборки, СтрокаДвижений );
								ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
								РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
								ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
								//- СВЭЙ КДЯ 27.01.20 СВФР-005409
								
							иначе
								
								ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
								ЗапросОкладПосл = Новый Запрос;
								ЗапросОкладПосл.Текст = 
								"ВЫБРАТЬ
								|	ТарифныеСтавкиРаботниковОрганизации.Период
								|ИЗ
								|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
								|			&Дата,
								|			Организация = &Организация
								|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
								|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
								|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
								|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
								|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
								|ГДЕ
								|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
								
								ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
								ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
								ЗапросОкладПосл.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
								
								РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
								ПериодПоследнегоОкл = ТекущаяДата();
								Пока РезультатОкладПосл.Следующий() Цикл
									ПериодПоследнегоОкл = РезультатОкладПосл.Период;
								КонецЦикла;
							КонецЕсли;
							//О.Т. 23.02.2015 № 331
							
							//заявка №1650 (база заявок Кристалла) Дмитрук О.Г.
							//Островская Татьяна 17.06.2013 № 16558
							ТарифнаяСтавкаПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
							Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
							ТарифнаяСтавкаПериода1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
							Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
							
							РазмерПоследнегоОкл =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
							Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода)).Размер;
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ПериодПоследнегоОкл < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
								РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
							КонецЕсли;
							
							Оклад = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.МесяцВыборки), 
							Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода1)).Размер;
							Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
								Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
							КонецЕсли;
							//Островская Татьяна 17.06.2013 № 16558
							если СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС Тогда 
								
								Запрос = Новый Запрос;
								Запрос.Текст = 
								"ВЫБРАТЬ
								|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда КАК ТарифнаяСтавкаПервогоРазряда
								|ИЗ
								|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
								|			&Период,
								|			Сотрудник = &Сотрудник
								|				И организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
								
								Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
								Запрос.УстановитьПараметр("Период", ПериодПоследнегоОкл);
								Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);		
								Результат = Запрос.Выполнить();	
								ВыборкаДетальныеЗаписи = Результат.Выбрать();
								ТарифнаяСтавка1Р = "";
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									ТарифнаяСтавка1Р = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
								КонецЦикла;
								Запрос.УстановитьПараметр("Период", КонецМесяца(ВыборкаБазы.Месяцвыборки));
								Результат = Запрос.Выполнить();	
								ВыборкаДетальныеЗаписи = Результат.Выбрать();
								ТарифнаяСтавка1РНаДату = "";
								Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
									ТарифнаяСтавка1РНаДату = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
								КонецЦикла;
								
								если ЗначениеЗаполнено(ТарифнаяСтавка1Р) и ЗначениеЗаполнено(ТарифнаяСтавка1РНаДату) Тогда
									РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
									Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1Р)).Размер;
									
									//СВЭЙ 16.09.2023 КВВ СВФР-011447 (пункт 2) (
									Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" 
										И ЗначениеЗаполнено(Регистратор.ПерерассчитываемыйДокумент) Тогда
										РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПерерассчитываемыйДокумент.ПериодРегистрации, 
										Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1Р)).Размер;
									КонецЕсли;
									//СВЭЙ 16.09.2023 КВВ СВФР-011447 (пункт 2) )
									
									РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
									Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1РНаДату)).Размер;
									Если Регистратор.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
										РазмерТСНаДату = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСНаДату / 10000,СтрокаДвижений.ПериодРегистрации);
									КонецЕсли;
									
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
										ОтборСтавки = Новый Структура( "Организация, ТарифнаяСтавка", СтрокаДвижений.Организация, ТарифнаяСтавка1РНаДату );
										РазмерТекущегоТСПериода = 
										ПолучитьЭталоннуюТС( ВыборкаБазы.МесяцВыборки, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
									КонецЕсли; 
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
								Иначе
									РазмерТекущегоТСПериода = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
									Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
									РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ВыборкаБазы.Месяцвыборки), 
									Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
									Если Регистратор.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
										РазмерТСНаДату = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСНаДату / 10000,СтрокаДвижений.ПериодРегистрации);
									КонецЕсли;
									
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
										ОтборСтавки = Новый Структура( "Организация", СтрокаДвижений.Организация );
										РазмерТекущегоТСПериода = 
										ПолучитьЭталоннуюТС( ВыборкаБазы.МесяцВыборки, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
									КонецЕсли; 
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									
								КонецЕсли;
								
								Попытка
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									//ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, Окр( РазмерТекущегоТСПериода / РазмерТСНаДату, 4 ) ); //Островская Татьяна 17.06.2013 № 16558
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, 
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( РазмерТекущегоТСПериода / РазмерТСНаДату, ОкруглитьКоэффициентИндексации ) );
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								Исключение
									ТекущийКоэффициентИндексации = 0;
								КонецПопытки;
								
							иначе 
								Если РазмерТСПериода <> 0 Тогда
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									//ТекущийКоэффициентИндексации = ?( НеИндексировать, 1, ?( СтрокаДвижений.ТекущаяТарифнаяСтавка = 0, 1, ?( СтрокаДвижений.ТекущаяТарифнаяСтавка < РазмерТСПериода, МАКС( ПредыдущийКоэффициентИндексации, 1 ), Окр( СтрокаДвижений.ТекущаяТарифнаяСтавка / РазмерТСПериода, 4 ) ) ) ); //Островская Татьяна 17.06.2013 № 16558								
									////заявка №1650
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
									//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
									ТекущийКоэффициентИндексации = 
									?( НеИндексировать, 1, 
									?( СтрокаДвижений.ТекущаяТарифнаяСтавка = 0, 1, 
									?( СтрокаДвижений.ТекущаяТарифнаяСтавка < РазмерТСПериода,
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									//МАКС( ПредыдущийКоэффициентИндексации, 1 ),
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( МАКС( ПредыдущийКоэффициентИндексации, 1 ), ОкруглитьКоэффициентИндексации ),
									//- СВЭЙ КДЯ 03.01.20 СВФР-005167
									РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( СтрокаДвижений.ТекущаяТарифнаяСтавка / РазмерТСПериода, ОкруглитьКоэффициентИндексации ) 
									) ) );								
									//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								Иначе 
									ТекущийКоэффициентИндексации = 1;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Аверсон-софт, Островская Татьяна 27.06.2012 № 15549
						
						
						//Островская Татьяна 23.10.2013 № 16864 ,17397
						если Пересчет и (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") Тогда 
							ОтборРег = Новый Структура;
							ОтборРег.Вставить("МесяцВыборки",ТаблицаЗаписей[Индекс].МесяцВыборки);
							ОтборРег.Вставить("ВидРасчета",ТаблицаЗаписей[Индекс].ВидРасчета);
							Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
							если Включать.Количество()> 0 Тогда 
								ТаблицаЗаписей[Индекс].Включать = Включать[0].Включать;
							иначе
								Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
									ОтборРег = Новый Структура;
									ОтборРег.Вставить("МесяцВыборки",ТаблицаЗаписей[Индекс].МесяцВыборки);
									ОтборРег.Вставить("ВидРасчета",ТаблицаЗаписей[Индекс].ВидРасчета);
									Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
									если Включать.Количество()> 0 Тогда 
										ТаблицаЗаписей[Индекс].Включать = Включать[0].Включать;
										ТаблицаЗаписей[ИндексСлед].Включать = ?(ЕстьТекМесяц,Включать[0].Включать,ТаблицаЗаписей[ИндексСлед].Включать);
									Иначе 
										ТаблицаЗаписей[Индекс].Включать = Истина;
										ТаблицаЗаписей[ИндексСлед].Включать = ?(ЕстьТекМесяц,Истина,ТаблицаЗаписей[ИндексСлед].Включать);
									КонецЕсли;						
								КонецЕсли;	 
							КонецЕсли;
						иначе
							Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
								ОтборРег = Новый Структура;
								ОтборРег.Вставить("МесяцВыборки",ТаблицаЗаписей[Индекс].МесяцВыборки);
								ОтборРег.Вставить("ВидРасчета",ТаблицаЗаписей[Индекс].ВидРасчета);
								Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
								если Включать.Количество()> 0 и Пересчет Тогда 
									ТаблицаЗаписей[Индекс].Включать = Включать[0].Включать;
									ТаблицаЗаписей[ИндексСлед].Включать = ?(ЕстьТекМесяц,Включать[0].Включать,ТаблицаЗаписей[ИндексСлед].Включать);
								Иначе 
									ТаблицаЗаписей[Индекс].Включать = Истина;
									ТаблицаЗаписей[ИндексСлед].Включать = ?(ЕстьТекМесяц,Истина,ТаблицаЗаписей[ИндексСлед].Включать);
								КонецЕсли;						
							КонецЕсли;	
						КонецЕсли;
						//Островская Татьяна 23.10.2013 № 16864 ,17397
						//		
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
								//ТаблицаЗаписей[Индекс].КоэффициентИндексации = ЗначениеПоРег[0].КоэффициентИндексации;
								//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								//+ СВЭЙ 15.03.19 КДЯ СВФР-004088
								ТаблицаЗаписей[ Индекс ].КоэффициентИндексации = РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации( ЗначениеПоРег[0].КоэффициентИндексации, ОкруглитьКоэффициентИндексации );
								//- СВЭЙ 15.03.19 КДЯ СВФР-004088
								СтруктураПоискаДоп.МесяцВыборки = ЗначениеПоРег[0].МесяцВыборки;
							иначе
								ТаблицаЗаписей[Индекс].КоэффициентИндексации			 = ТекущийКоэффициентИндексации;
								СтруктураПоискаДоп.МесяцВыборки = НачалоМесяца(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
							КонецЕсли;
						иначе
							ТаблицаЗаписей[Индекс].КоэффициентИндексации			 = ТекущийКоэффициентИндексации;
							СтруктураПоискаДоп.МесяцВыборки = НачалоМесяца(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						ТаблицаЗаписей[ИндексСлед].КоэффициентИндексации = ?(НеИндексировать,1,?(ЕстьТекМесяц,ТекущийКоэффициентИндексации,ТаблицаЗаписей[ИндексСлед].КоэффициентИндексации));
						Если ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям ИЛИ  ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям
							ИЛИ  ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда //О.Т. Аверсон 06.05.2016 № 1141
							ТаблицаЗаписей[Индекс].БПНачало = ВыборкаБазы.БПНачало;
							ТаблицаЗаписей[Индекс].БПКонец  = ВыборкаБазы.БПКонец;
						КонецЕсли;
						Если ТаблицаЗаписей[ИндексСлед].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям ИЛИ  ТаблицаЗаписей[ИндексСлед].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям
							ИЛИ  ТаблицаЗаписей[ИндексСлед].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда //О.Т. Аверсон 06.05.2016 № 1141
							ТаблицаЗаписей[ИндексСлед].БПНачало = ?(ЕстьТекМесяц,ВыборкаБазы.БПНачало,ТаблицаЗаписей[ИндексСлед].БПНачало);
							ТаблицаЗаписей[ИндексСлед].БПКонец  = ?(ЕстьТекМесяц,ВыборкаБазы.БПКонец,ТаблицаЗаписей[ИндексСлед].БПНачало);
						КонецЕсли;
						//СтруктураПоискаДоп.НомерСтроки = СтруктураПоиска.НомерСтроки; //Островская Татьяна 08.10.2013
						//Островская Татьяна 28.12.2012 № 16068
						если ЕстьТекМесяц Тогда 
							//ТаблицаЗаписей[Индекс].ОтработаноДней 					= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ОтработаноДней,ТЗНаборРасчетаНачисления.ОтработаноДней);
							//ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ОтработаноЧасов,ТЗНаборРасчетаНачисления.ОтработаноЧасов);
							//мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки), КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки), СтрокаДвижений.Сотрудник);
							//ТаблицаЗаписей[Индекс].НормаДней 					= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].НормаДней,ТЗНаборРасчетаНачисления.НормаДней);
							//ТаблицаЗаписей[Индекс].НормаЧасов 					= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].НормаЧасов,ТЗНаборРасчетаНачисления.НормаЧасов);
							//ТаблицаЗаписей[Индекс].БазовыйПериодНачало = ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].БазовыйПериодНачало,ТЗНаборРасчетаНачисления.БазовыйПериодНачало);
							//ТаблицаЗаписей[Индекс].БазовыйПериодКонец =  ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].БазовыйПериодКонец,ТЗНаборРасчетаНачисления.БазовыйПериодКонец);
							//
							если не ПремияПропорц Тогда 
								ТаблицаЗаписей[ИндексСлед].ОтработаноДней 					= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ТаблицаЗаписей[ИндексСлед].ОтработаноДней);
								ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов 					= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов);
								ТаблицаЗаписей[ИндексСлед].НормаДней 					= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаДней,ТаблицаЗаписей[ИндексСлед].НормаДней);
								ТаблицаЗаписей[ИндексСлед].НормаЧасов 					= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаЧасов,ТаблицаЗаписей[ИндексСлед].НормаЧасов);
							КонецЕсли;
							ТаблицаЗаписей[ИндексСлед].БазовыйПериодНачало = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.БазовыйПериодНачало,ТаблицаЗаписей[ИндексСлед].БазовыйПериодНачало);
							ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец =  ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.БазовыйПериодКонец,ТаблицаЗаписей[ИндексСлед].БазовыйПериодКонец);
							
							ПредыдущийКоэффициентИндексации = ТекущийКоэффициентИндексации;
						КонецЕсли;
						
						СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(СтруктураПоискаДоп);	
						Если СтрокиВремени.Количество() > 0 Тогда 
							Если СтрокиВремени.Количество() > 1 Тогда 
								Для каждого строканеноль из СтрокиВремени цикл
									Если СтрокаНеНоль.НормаДнейПоПятидневке > 0 тогда
										ВыбраннаяСтрока = СтрокаНеНоль;
										Прервать;
									иначе
										ВыбраннаяСтрока = СтрокиВремени[0];
									КонецЕсли;
								КонецЦикла;
							Иначе
								ВыбраннаяСтрока = СтрокиВремени[0];
							КонецЕсли;
							
							//Заполним простои
							Если ВыбраннаяСтрока.НаличиеПростоев <> 0 тогда
								СтрокаПростоев = ТаблицаПростоев.Добавить();
								СтрокаПростоев.ВидРасчета = ТаблицаЗаписей[Индекс].ВидРасчета;
								СтрокаПростоев.НаличиеПростоев = ВыбраннаяСтрока.НаличиеПростоев;
								Сообщить("Возможно за " + Формат(НачалоМесяца(ВыборкаБазы.МесяцВыборки),"ДЛФ=Д") + " у сотрудника были простои.");
								//Островская Татьяна 30.05.2014 № 17397
								если Пересчет и (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") Тогда 
									ОтборРег = Новый Структура;
									ОтборРег.Вставить("МесяцВыборки",ТаблицаЗаписей[Индекс].МесяцВыборки);
									ОтборРег.Вставить("ВидРасчета",ТаблицаЗаписей[Индекс].ВидРасчета);
									Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
									если Включать.Количество()> 0 Тогда 
										ТаблицаЗаписей[Индекс].Включать = Включать[0].Включать;
										СтрокаПростоев.МесяцВыборки = Включать[0].МесяцВыборки;
									иначе
										Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
											ТаблицаЗаписей[Индекс].Включать = Ложь;
											ТаблицаЗаписей[ИндексСлед].Включать = Ложь;
											
										КонецЕсли;
										СтрокаПростоев.МесяцВыборки = НачалоМесяца(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
									КонецЕсли;
								иначе
									СтрокаПростоев.МесяцВыборки = НачалоМесяца(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,ВыборкаБазы.МесяцВыборки));//Островская Татьяна 28.12.2012 № 16068
									Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
										ТаблицаЗаписей[Индекс].Включать = Ложь;
										ТаблицаЗаписей[ИндексСлед].Включать = Ложь;
										
									КонецЕсли;
								КонецЕсли;
								//Островская Татьяна 30.05.2014 № 17397
							КонецЕсли;
							//О.Т. 09.10.2014 № 17616
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
								КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ТаблицаЗаписей[Индекс].МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,ВыборкаБазы.ДатаНачалаДоговора,ВыборкаБазы.ДатаОкончанияДоговора,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
							иначе
								
								КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ТаблицаЗаписей[Индекс].МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
							КонецЕсли;
							//О.Т. 09.10.2014 № 17616
							//Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям Тогда
							// для "премий фиксированной суммой" надо учитывать отработанное время
							если не ПремияПропорц Тогда 
								//Островская Татьяна 12.06.2014 Пересчет
								Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
									если ЗначениеПоРег.Количество()> 0 Тогда 
										ТаблицаЗаписей[Индекс].ОтработаноПоПятидневке 			= ЗначениеПоРег[0].ОтработаноПоПятидневке;
										ТаблицаЗаписей[Индекс].НормаПоПятидневке 				= ЗначениеПоРег[0].НормаПоПятидневке;
									иначе
										ТаблицаЗаписей[Индекс].ОтработаноПоПятидневке 			= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ОтработаноПоПятидневке,ВыбраннаяСтрока.ОтработаноДнейПоПятидневке);//Островская Татьяна 28.12.2012 № 16068
										ТаблицаЗаписей[Индекс].НормаПоПятидневке 				= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].НормаПоПятидневке,ВыбраннаяСтрока.НормаДнейПоПятидневке);//Островская Татьяна 28.12.2012 № 16068
									КонецЕсли;
								иначе
									ТаблицаЗаписей[Индекс].ОтработаноПоПятидневке 			= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ОтработаноПоПятидневке,ВыбраннаяСтрока.ОтработаноДнейПоПятидневке);//Островская Татьяна 28.12.2012 № 16068
									ТаблицаЗаписей[Индекс].НормаПоПятидневке 				= ?(ПрошлыйТек,ТаблицаЗаписей[Индекс].НормаПоПятидневке,ВыбраннаяСтрока.НормаДнейПоПятидневке);//Островская Татьяна 28.12.2012 № 16068
								КонецЕсли;
								//Островская Татьяна 12.06.2014 Пересчет
								ТаблицаЗаписей[ИндексСлед].ОтработаноПоПятидневке 			= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДнейПоПятидневке,ТаблицаЗаписей[ИндексСлед].ОтработаноПоПятидневке);//Островская Татьяна 28.12.2012 № 16068
								ТаблицаЗаписей[ИндексСлед].НормаПоПятидневке 				= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаДнейПоПятидневке,ТаблицаЗаписей[ИндексСлед].НормаПоПятидневке);//Островская Татьяна 28.12.2012 № 16068
							КонецЕсли;
							//толик при увеличения ТС
							Попытка
								//О.Т. 28.04.2015 № 417
								если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") 
									//+ СВЭЙ КДЯ 17.02.20 СВФР-005492
									ИЛИ ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.ОплатаПоСреднемуЗаработку" )
									И Регистратор.ВклПремииПропорциональноОтрабВр
									//- СВЭЙ КДЯ 17.02.20 СВФР-005492
									Тогда 
									если Регистратор.ВклПремииПропорциональноОтрабВр и СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда 
										ФлагВключатьРасчетПропорционально = Ложь;
										ТаблицаЗаписей[Индекс].Включать = Истина;
									иначе
										ФлагВключатьРасчетПропорционально = Истина;
										ТаблицаЗаписей[Индекс].Включать = Истина;
									КонецЕсли;
								иначе
									ФлагВключатьРасчетПропорционально = Истина; 
								КонецЕсли;
								//О.Т. 28.04.2015 № 417
								Если ВыбраннаяСтрока.МесяцВыборки = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) и ФлагВключатьРасчетПропорционально Тогда //Островская Татьяна 28.12.2012 № 16068
									//О.Т. 29.04.2015 № 417
									если ВидРасчетаМесяца = Перечисления.ВидыУчетаВремени.ПоДням Тогда
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
										ВыбСтрокаОтработаноВремени = ВыбраннаяСтрока.ОтработаноДней;
									иначе
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Ложь);
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
										ВыбСтрокаОтработаноВремени = ВыбраннаяСтрока.ОтработаноЧасов;
									КонецЕсли;
									//О.Т. 29.04.2015 № 417
									
									//Островская Татьяна 12.06.2014 Пересчет
									Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда 
										РезультатБаза	     = ОбщегоНазначения.ОкруглитьПоВалюте(ОбщегоНазначения.ОкруглитьЗначение2016((ТаблицаЗаписей[Индекс].Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя)/10000, СтрокаДвижений.ПериодРегистрации),Константы.ВалютаРегламентированногоУчета.Получить());;					
									Иначе
										РезультатБаза = ТаблицаЗаписей[Индекс].Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя; 
									КонецЕсли;
									Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
										если ЗначениеПоРег.Количество()> 0 Тогда 
											ТаблицаЗаписей[Индекс].Результат 			= ЗначениеПоРег[0].Результат;
											ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
											ТаблицаЗаписей[Индекс].ОтработаноЧасов 		= ЗначениеПоРег[0].ОтработаноЧасов;
											ТаблицаЗаписей[Индекс].ОтработаноДней 		= ЗначениеПоРег[0].ОтработаноДней;//Островская Татьяна 28.12.2012 № 16068
											
										иначе
											ТаблицаЗаписей[Индекс].Результат 			= ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить()); //Островская Татьяна 28.12.2012 № 16068
											ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
											ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ОтработаноЧасов,ОплачиваемоеВремя));
											ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
											ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
											ТаблицаЗаписей[Индекс].ОтработаноДней 					= ?(ПремияПропорц,0,ОплачиваемоеВремя);//Островская Татьяна 28.12.2012 № 16068
										КонецЕсли;
									иначе
										//О.Т. 15.07.2014 № 118
										Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
											ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда //О.Т. 23.09.2014 № 17616
											
											если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и Регистратор.КалендарныеДни Тогда
												ТаблицаЗаписей[Индекс].Результат 			= ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат), Константы.ВалютаРегламентированногоУчета.Получить());
											иначе
												ТаблицаЗаписей[Индекс].Результат 			= ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить()); //Островская Татьяна 28.12.2012 № 16068
											КонецЕсли;
										иначе
											//О.Т. 15.07.2014 № 118	
											ТаблицаЗаписей[Индекс].Результат 			= ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить()); //Островская Татьяна 28.12.2012 № 16068
										КонецЕсли; 
										ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат/ВыбСтрокаОтработаноВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
										ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ПрошлыйТек,ТаблицаЗаписей[Индекс].ОтработаноЧасов,ОплачиваемоеВремя));
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
										ТаблицаЗаписей[Индекс].ОтработаноДней 					= ?(ПремияПропорц,0,ОплачиваемоеВремя);//Островская Татьяна 28.12.2012 № 16068
									КонецЕсли;
									//Островская Татьяна 12.06.2014 Пересчет
									
									//Островская Татьяна 11.09.2013 № 16778
									если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
										строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
										если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
											ТаблицаЗаписей[Индекс].Результат = БюджетПрожиточногоМинимума;	
											ТаблицаЗаписей[Индекс].РезультатДляПремии = БюджетПрожиточногоМинимума;									
										КонецЕсли;
									КонецЕсли;
									//Островская Татьяна 11.09.2013 № 16778
								Иначе
									//Островская Татьяна 12.06.2014 Пересчет
									Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
										если ЗначениеПоРег.Количество()> 0 Тогда 
											ТаблицаЗаписей[Индекс].ОтработаноДней 					= ЗначениеПоРег[0].ОтработаноДней;
											ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ЗначениеПоРег[0].ОтработаноЧасов; 										
										иначе
											ТаблицаЗаписей[Индекс].ОтработаноДней 					= ?(ПремияПропорц,0,ВыбраннаяСтрока.ОтработаноДней); //Островская Татьяна 28.12.2012 № 16068
											ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ?(ПремияПропорц,0,ВыбраннаяСтрока.ОтработаноЧасов);//Островская Татьяна 28.12.2012 № 16068
										КонецЕсли;
									иначе
										ТаблицаЗаписей[Индекс].ОтработаноДней 					= ?(ПремияПропорц,0,ВыбраннаяСтрока.ОтработаноДней); //Островская Татьяна 28.12.2012 № 16068
										ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ?(ПремияПропорц,0,ВыбраннаяСтрока.ОтработаноЧасов);//Островская Татьяна 28.12.2012 № 16068
									КонецЕсли;
									//Островская Татьяна 12.06.2014 Пересчет
									
								КонецЕсли;
							Исключение
								//Островская Татьяна 12.06.2014 Пересчет
								Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
									если ЗначениеПоРег.Количество()> 0 Тогда 
										ТаблицаЗаписей[Индекс].ОтработаноДней 					= ЗначениеПоРег[0].ОтработаноДней;
										ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ЗначениеПоРег[0].ОтработаноЧасов;										
									иначе
										ТаблицаЗаписей[Индекс].ОтработаноДней 					= ?(ПремияПропорц,0,ВыбраннаяСтрока.ОтработаноДней);//Островская Татьяна 28.12.2012 № 16068
										ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ?(ПремияПропорц,0,ВыбраннаяСтрока.ОтработаноЧасов);//Островская Татьяна 28.12.2012 № 16068
									КонецЕсли;
								иначе
									ТаблицаЗаписей[Индекс].ОтработаноДней 					= ?(ПремияПропорц,0,ВыбраннаяСтрока.ОтработаноДней);//Островская Татьяна 28.12.2012 № 16068
									ТаблицаЗаписей[Индекс].ОтработаноЧасов 					= ?(ПремияПропорц,0,ВыбраннаяСтрока.ОтработаноЧасов);//Островская Татьяна 28.12.2012 № 16068
								КонецЕсли;
								//Островская Татьяна 12.06.2014 Пересчет
							КонецПопытки;
							
							Попытка
								Если ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.МесяцВыборки,ВыбраннаяСтрока.МесяцВыборки) = НачалоМесяца(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ДатаНачалаСобытия,СтрокаДвижений.ДатаНачалаСобытия)) Тогда //Островская Татьяна 28.12.2012 № 16068
									//ТаблицаЗаписей[ИндексСлед].Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,ТаблицаЗаписей[ИндексСлед].Результат), Константы.ВалютаРегламентированногоУчета.Получить()); //Островская Татьяна 28.12.2012 № 16068
									////Островская Татьяна 11.09.2013 № 16778
									//если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" Тогда
									//	если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда 
									//		ТаблицаЗаписей[ИндексСлед].Результат = БюджетПрожиточногоМинимума;							
									//	КонецЕсли;
									//КонецЕсли;
									//Островская Татьяна 11.09.2013 № 16778
									ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов 					= ?(ПремияПропорц,0,ОплачиваемоеВремя);
									ТаблицаЗаписей[ИндексСлед].ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ТаблицаЗаписей[ИндексСлед].ОтработаноДней));//Островская Татьяна 28.12.2012 № 16068
								Иначе
									ТаблицаЗаписей[ИндексСлед].ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ТаблицаЗаписей[ИндексСлед].ОтработаноДней)); //Островская Татьяна 28.12.2012 № 16068
									ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов));//Островская Татьяна 28.12.2012 № 16068
								КонецЕсли;
							Исключение
								ТаблицаЗаписей[ИндексСлед].ОтработаноДней 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноДней,ТаблицаЗаписей[ИндексСлед].ОтработаноДней));//Островская Татьяна 28.12.2012 № 16068
								ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов 					= ?(ПремияПропорц,0,?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.ОтработаноЧасов,ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов));//Островская Татьяна 28.12.2012 № 16068
							КонецПопытки;
							
							//Островская Татьяна 12.07.2013 № 16623
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
								ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.09.2014 № 17616 
								если (Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПустаяСсылка() или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.БПМ или 
									Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу) и Регистратор.КалендарныеДни Тогда //О.Т. 16.07.2014 № 118
									ТаблицаЗаписей[Индекс].ОтработаноДней = ?(ПремияПропорц,0,КалендарныеДни);
								КонецЕсли;
							КонецЕсли;
							//Островская Татьяна 12.07.2013 № 16623
							
							
							//КонецЕсли;
							//+ СВЭЙ КДЯ 09.01.20 СВФР-005273
							УчитыватьСтавку = ( ТипЗнч(  СтрокаДвижений.Регистратор ) 
							= Тип( "ДокументСсылка.НачислениеПоБольничномуЛисту" ) 
							И СтрокаДвижений.Регистратор.УчитыватьСтавку );
							//- СВЭЙ КДЯ 09.01.20 СВФР-005273
							
							//Аверсон ЕАЕ 10.02.2021 СВФР-007115
							НормаИзГрафика = (ТипЗнч(СтрокаДвижений.Регистратор) 
							= Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") 
							И СтрокаДвижений.Регистратор.НормаИзГрафика);
							//Аверсон
							
							мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику( 
							НачалоМесяца( ВыборкаБазы.МесяцВыборки ),
							КонецМесяца( ВыборкаБазы.МесяцВыборки ), 
							СтрокаДвижений.Сотрудник
							//+ СВЭЙ КДЯ 09.01.20 СВФР-005273
							, УчитыватьСтавку 
							//- СВЭЙ КДЯ 09.01.20 СВФР-005273
							
							//Аверсон ЕАЕ 10.02.2021 СВФР-007115
							,,
							НормаИзГрафика
							//Аверсон
							);
							если не ПремияПропорц Тогда 
								ТаблицаЗаписей[Индекс].НормаДней 					= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаДней,мНорма.НормаДней);//Островская Татьяна 28.12.2012 № 16068
								ТаблицаЗаписей[Индекс].НормаЧасов 					= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаЧасов,мНорма.НормаЧасов);//Островская Татьяна 28.12.2012 № 16068
								
								ТаблицаЗаписей[ИндексСлед].НормаДней 					= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаДней,ТаблицаЗаписей[ИндексСлед].НормаДней);//Островская Татьяна 28.12.2012 № 16068
								ТаблицаЗаписей[ИндексСлед].НормаЧасов 					= ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.НормаЧасов,ТаблицаЗаписей[ИндексСлед].НормаЧасов);//Островская Татьяна 28.12.2012 № 16068
							КонецЕсли;
							//ТаблицаЗаписей[Индекс].НормаДней 					= ВыбраннаяСтрока.НормаДней;
							//ТаблицаЗаписей[Индекс].НормаЧасов 					= ВыбраннаяСтрока.НормаЧасов;
							//СтрокаДвижений = ДопСтрокаДвижений;
							//енд толик
							
							ПредыдущийКоэффициентИндексации = ТекущийКоэффициентИндексации;
						Иначе
							//О.Т. 09.10.2014 № 17616
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
								КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ТаблицаЗаписей[Индекс].МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,ВыборкаБазы.ДатаНачалаДоговора,ВыборкаБазы.ДатаОкончанияДоговора,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
							иначе
								
								КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ТаблицаЗаписей[Индекс].МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
							КонецЕсли;
							//О.Т. 09.10.2014 № 17616
							//толик если премия то нужно сразу разделить результат пропорционально
							Если НЕ ТаблицаЗаписей[Индекс].БПНачало = Неопределено Тогда
								//О.Т. 28.04.2015 № 417
								если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
									если Регистратор.ВклПремииПропорциональноОтрабВр и СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда 
										ФлагВключатьРасчетПропорционально = Ложь;
									иначе
										ФлагВключатьРасчетПропорционально = Истина;
									КонецЕсли;
								иначе
									ФлагВключатьРасчетПропорционально = Истина; 
								КонецЕсли;
								//О.Т. 28.04.2015 № 417
								Если НачалоМесяца(ТаблицаЗаписей[Индекс].БПНачало) = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) и ФлагВключатьРасчетПропорционально Тогда
									//О.Т. 29.04.2015 № 417
									если ВидРасчетаМесяца = Перечисления.ВидыУчетаВремени.ПоДням Тогда
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
										НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ТаблицаЗаписей[Индекс].БПНачало), КонецМесяца(ТаблицаЗаписей[Индекс].БПНачало), СтрокаДвижений.Сотрудник).НормаДней;
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
									иначе
										ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Ложь);
										НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ТаблицаЗаписей[Индекс].БПНачало), КонецМесяца(ТаблицаЗаписей[Индекс].БПНачало), СтрокаДвижений.Сотрудник).НормаЧасов;
										ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
									КонецЕсли;
									//О.Т. 29.04.2015 № 417
									
									//Островская Татьяна 12.06.2014 Пересчет
									Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
										Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) Тогда 
											РезультатБаза	     = ОбщегоНазначения.ОкруглитьПоВалюте(ОбщегоНазначения.ОкруглитьЗначение2016((ТаблицаЗаписей[Индекс].Результат/НормаВремени*ОплачиваемоеВремя)/10000, СтрокаДвижений.ПериодРегистрации),Константы.ВалютаРегламентированногоУчета.Получить());;					
										Иначе
											РезультатБаза = ТаблицаЗаписей[Индекс].Результат/НормаВремени*ОплачиваемоеВремя; 
										КонецЕсли;
										
										если ЗначениеПоРег.Количество()> 0 Тогда 	
											ТаблицаЗаписей[Индекс].Результат = ЗначениеПоРег[0].Результат;
											ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
										иначе
											Если ЗначениеЗаполнено(НормаВремени) Тогда
												ТаблицаЗаписей[Индекс].Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
												ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,РезультатБаза), Константы.ВалютаРегламентированногоУчета.Получить());
											КонецЕсли;
										КонецЕсли;
									иначе
										//О.Т. 15.07.2014 № 118
										если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
											ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.09.2014 № 17616
											если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и КалендарныеДни Тогда 
												ТаблицаЗаписей[Индекс].Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат), Константы.ВалютаРегламентированногоУчета.Получить())
											иначе
												ТаблицаЗаписей[Индекс].Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
												ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
											КонецЕсли;
										иначе 
											//О.Т. 15.07.2014 № 118	
											Если ЗначениеЗаполнено(НормаВремени) Тогда
												ТаблицаЗаписей[Индекс].Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
												ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ПрошлыйТек,ТаблицаЗаписей[Индекс].Результат,ТаблицаЗаписей[Индекс].Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
											КонецЕсли;
										КонецЕсли;
									КонецЕсли;
									//Островская Татьяна 12.06.2014 Пересчет
									
									//Островская Татьяна 11.09.2013 № 16778
									если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
										строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
										если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
											ТаблицаЗаписей[Индекс].Результат = БюджетПрожиточногоМинимума;	
											ТаблицаЗаписей[Индекс].РезультатДляПремии = БюджетПрожиточногоМинимума;
										КонецЕсли;
									КонецЕсли;
									//Островская Татьяна 11.09.2013 № 16778
								КонецЕсли;
								//енд					
							КонецЕсли;
							
							Если НЕ ТаблицаЗаписей[ИндексСлед].БПНачало = Неопределено Тогда
								Если НачалоМесяца(ТаблицаЗаписей[ИндексСлед].БПНачало) = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) Тогда
									//Если ЗначениеЗаполнено(НормаВремени) Тогда
									//	ТаблицаЗаписей[ИндексСлед].Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТаблицаЗаписей[ИндексСлед].Результат/НормаВремени*ОплачиваемоеВремя, Константы.ВалютаРегламентированногоУчета.Получить());
									//КонецЕсли;
									//Островская Татьяна 11.09.2013 № 16778
									если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" Тогда
										//если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда 
										//	ТаблицаЗаписей[ИндексСлед].Результат = БюджетПрожиточногоМинимума;							
										//КонецЕсли;
									КонецЕсли;
									//Островская Татьяна 11.09.2013 № 16778
								КонецЕсли;
								//енд					
							КонецЕсли;
							//Островская Татьяна 12.07.2013 № 16623
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") или
								ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда //О.Т. 23.09.2014 № 17616 
								если (Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПустаяСсылка() или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.БПМ или 
									Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу) и Регистратор.КалендарныеДни Тогда //О.Т. 16.07.2014 № 118
									ТаблицаЗаписей[Индекс].ОтработаноДней = ?(ПремияПропорц,0,КалендарныеДни);
								КонецЕсли;
							КонецЕсли;
							//Островская Татьяна 12.07.2013 № 16623
							
						КонецЕсли;
						//Островская Татьяна 03.12.2013 № 16960 ,17397
						если Пересчет и (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") Тогда 
							ОтборРег = Новый Структура;
							ОтборРег.Вставить("МесяцВыборки",ТаблицаЗаписей[Индекс].МесяцВыборки);
							ОтборРег.Вставить("ВидРасчета",ТаблицаЗаписей[Индекс].ВидРасчета);
							Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
							если Включать.Количество()> 0 Тогда 
								ТаблицаЗаписей[Индекс].Включать = Включать[0].Включать;
							иначе
								Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
									
									если ТаблицаЗаписей[Индекс].ОтработаноЧасов < ТаблицаЗаписей[Индекс].НормаЧасов Тогда 
										ТаблицаЗаписей[Индекс].Включать = Ложь;
										СписокСообщений.Добавить(ТаблицаЗаписей[Индекс].МесяцВыборки);//О.Т. 26.09.2014 № 17568
									КонецЕсли;
									если ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов < ТаблицаЗаписей[ИндексСлед].НормаЧасов Тогда 
										ТаблицаЗаписей[ИндексСлед].Включать = Ложь;
										СписокСообщений.Добавить(ТаблицаЗаписей[ИндексСлед].МесяцВыборки);//О.Т. 26.09.2014 № 17568
									КонецЕсли;
								КонецЕсли;
								
							КонецЕсли;
						иначе
							
							Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
								
								если ТаблицаЗаписей[Индекс].ОтработаноЧасов < ТаблицаЗаписей[Индекс].НормаЧасов Тогда 
									ТаблицаЗаписей[Индекс].Включать = Ложь;
									СписокСообщений.Добавить(ТаблицаЗаписей[Индекс].МесяцВыборки);//О.Т. 26.09.2014 № 17568
								КонецЕсли;
								если ТаблицаЗаписей[ИндексСлед].ОтработаноЧасов < ТаблицаЗаписей[ИндексСлед].НормаЧасов Тогда 
									ТаблицаЗаписей[ИндексСлед].Включать = Ложь;
									СписокСообщений.Добавить(ТаблицаЗаписей[ИндексСлед].МесяцВыборки);//О.Т. 26.09.2014 № 17568
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						
						//О.Т. 04.09.2014 № 17567
						Если ВыборкаБазы.ВключенВГруппуРасчетов > 0 и не Пересчет Тогда 						
							ТаблицаЗаписей[Индекс].Включать = Ложь;
							Сообщить("Месяц выборки "+Формат(ВыборкаБазы.МесяцВыборки,"ДФ=""дд.ММ.гггг""")+" исключается из расчета среднего заработка, т.к. у работника в этом месяце есть вид расчета, который включен в группу расчетов.");//О.Т. Аверсон 08.12.2016 № 74
						ИначеЕсли ВыборкаБазы.ВключенВГруппуРасчетов = 0 и не Пересчет и Регистратор.Организация.НормаВОтпускахПоГрРасчетов и (ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций")
							или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или
							ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда
							
							ТаблицаЗаписей[Индекс].Включать = Истина;
						КонецЕсли; 
						//О.Т. 04.09.2014 № 17567
						
						//Островская Татьяна 03.12.2013 № 16960 ,17397
						
						// удалила, т.к. в конце расчитывается результат для премии!!!
						//Если не УсловиеДляБПМ тогда
						//	если ПремияПропорц Тогда 
						//		мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ВыборкаБазы.МесяцВыборки), КонецМесяца(ВыборкаБазы.МесяцВыборки), СтрокаДвижений.Сотрудник);
						//		Отбор = Новый Структура;
						//		Отбор.Вставить("МесяцВыборки",ВыборкаБазы.МесяцВыборки);
						//		СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(Отбор);
						//		если СтрокиВремени.Количество()>0 Тогда 
						//			СтрокиВремениПремия = СтрокиВремени[0];
						//		КонецЕсли;
						//		
						//		если ВыборкаБазы.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда 
						//			если мНорма.НормаДней/СтрокиВремениПремия.ОтработаноДней <1 Тогда 
						//				ТаблицаЗаписей[Индекс].Результат = ТаблицаЗаписей[Индекс].Результат /1;
						//			иначе
						//				ТаблицаЗаписей[Индекс].Результат = ТаблицаЗаписей[Индекс].Результат /мНорма.НормаДней*СтрокиВремениПремия.ОтработаноДней;
						//			КонецЕсли;
						//			
						//		иначе
						//			если мНорма.НормаЧасов/СтрокиВремениПремия.ОтработаноЧасов <1 Тогда 
						//				ТаблицаЗаписей[Индекс].Результат = ТаблицаЗаписей[Индекс].Результат /1;
						//			иначе
						//				ТаблицаЗаписей[Индекс].Результат = ТаблицаЗаписей[Индекс].Результат /мНорма.НормаЧасов*СтрокиВремениПремия.ОтработаноЧасов;
						//			КонецЕсли;	
						//		КонецЕсли;
						//		ПремияПропорц = Ложь;
						//	КонецЕсли;
						//КонецЕсли;
						если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда 
							ТаблицаЗаписей[Индекс].Включать = Истина;
						КонецЕсли;
						если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") и ТаблицаЗаписей[Индекс].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку Тогда //О.Т. Аверсон 10.02.2016 Для выходного пособия
							ТаблицаЗаписей[Индекс].Включать = Истина;			
						КонецЕсли;
						
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ВыборкаБазы.МесяцВыборки < Дата(2016,07,01) и не Пересчет Тогда
							ТаблицаЗаписей[Индекс].Результат = ОбщегоНазначения.ОкруглитьЗначение2016(ТаблицаЗаписей[Индекс].Результат/10000,СтрокаДвижений.ПериодРегистрации); //Островская Татьяна 08.10.2013
							ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьЗначение2016(ТаблицаЗаписей[Индекс].РезультатДляПремии/10000,СтрокаДвижений.ПериодРегистрации); //Островская Татьяна 08.10.2013
						КонецЕсли;
						
						если не Пересчет Тогда
							ТаблицаЗаписей[Индекс].Результат = ТаблицаЗаписей[Индекс].Результат - СуммаБольничный;
						КонецЕсли;
						ТаблицаЗаписей[Индекс].РезультатДляПремии = ТаблицаЗаписей[Индекс].РезультатДляПремии - СуммаБольничный;
						
						ТаблицаЗаписей[Индекс].Результат = ОбщегоНазначения.ОкруглитьПоВалюте(ТаблицаЗаписей[Индекс].Результат, Константы.ВалютаРегламентированногоУчета.Получить()); //Островская Татьяна 08.10.2013
						ТаблицаЗаписей[Индекс].РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(ТаблицаЗаписей[Индекс].РезультатДляПремии, Константы.ВалютаРегламентированногоУчета.Получить()); //Островская Татьяна 08.10.2013
						
					КонецЕсли;
					
					ПрошлыйБюджетПрожиточногоМинимума = БюджетПрожиточногоМинимума; //Островская Татьяна 11.09.2013 № 16778
					//Островская Татьяна 28.12.2012 № 16068
					если ЕстьТекМесяц Тогда 
						Прервать;
					КонецЕсли;
					//Островская Татьяна 28.12.2012 № 16068
				КонецЕсли;
				
			КонецЦикла;// ВыборкаБазы.НайтиСледующий(СтруктураПоиска)
		КонецЕсли; // не УсловиеПоОкладу  - начало в строке 10048
		
	КонецЦикла; // Индекс = 0 По ВГраница - начало в строке 10021
	//КонецЕсли;
	
	//Аверсон ЕАЕ 01.10.2024 СВФР-013764 
	//Корректировка текущей ТС и коэффициентов индексации
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") и не (Регистратор.Организация.НеУчитыватьЕТКС или БезЕТСПоСотруднику) Тогда
		Для Каждого Стр Из ТаблицаЗаписей Цикл
			//СВФР-015885 300525
			Если Стр.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые Тогда
				продолжить;
			КонецЕсли;       
			//СВФР-015885 300525
			МесВыб = Стр.МесяцВыборки;
			ТекДат = Стр.ДатаНачалаСобытия;
			Сотр   = Стр.Сотрудник;
			Орг    = Стр.Организация;
			//Тарифная ставка периода
			СтПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(МесВыб), 
			Новый Структура("Сотрудник,Организация", Сотр, Орг)).ТарифнаяСтавкаПервогоРазряда;
			
			//Размер текущий     на текущий период регистрации 16.11.2024
			ТекСтавка = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(Стр.ПериодРегистрации), 
			Новый Структура("Организация,ТарифнаяСтавка", Орг, СтПериода)).Размер;
			
			Стр.ТекущаяТарифнаяСтавка = ТекСтавка;
			Если Стр.КоэффициентИндексации = 0 Тогда
				Если Стр.ТарифнаяСтавкаПериода = 0 Тогда
					Стр.КоэффициентИндексации = 0;
				Иначе
					Стр.КоэффициентИндексации = РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации(Стр.ТекущаяТарифнаяСтавка / Стр.ТарифнаяСтавкаПериода, ОкруглитьКоэффициентИндексации);
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	//Аверсон СВФР-013764
	
	//Аверсон ЕАЕ 26.07.2022 СВФР-009371
	ТЗКорректировка.Свернуть("МесяцВыборки, СпособРасчета", "Сумма");
	//Аверсон СВФР-009371
	
	// О.Т. 24.10.2014 Если расчет приходится на дату приема сотрудника  
	если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
		если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и Регистратор.КалендарныеДни и ТЗНаборРасчетаНачисления <> Неопределено Тогда
			ПроверкаЗаписей = ТаблицаЗаписей.ВыгрузитьКолонку("Результат");
			ПроверкаРезультат = 0;
			для Каждого стрПроверка из ПроверкаЗаписей Цикл 
				ПроверкаРезультат = ПроверкаРезультат + стрПроверка;
			КонецЦикла; 
			//О.Т. 18.02.2015 № 334
			если ТаблицаЗаписей[1].Результат = 0 Тогда 
				СтрокаТаблицаЗаписей = ТаблицаЗаписей[1];
			иначе
				СтрокаТаблицаЗаписей = ТаблицаЗаписей.Добавить();
				СтрокаТаблицаЗаписей.ВидРасчета = НаборЗаписей[1].ВидРасчета;
				ЗаполнитьЗначенияСвойств(СтрокаТаблицаЗаписей,НаборЗаписей[1]);
				
			КонецЕсли;
			//О.Т. 18.02.2015 № 334
			СтрокаТаблицаЗаписей.Результат = ?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,СтрокаТаблицаЗаписей.Результат);
			ТарифнаяСтавкаПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки), 
			Новый Структура("Сотрудник,Организация", СтрокаТаблицаЗаписей.Сотрудник,СтрокаТаблицаЗаписей.Организация)).ТарифнаяСтавкаПервогоРазряда;    //Островская Татьяна 28.12.2012 № 16068
			
			РазмерТСПериода =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки), 
			Новый Структура("Организация,ТарифнаяСтавка", СтрокаТаблицаЗаписей.Организация, ТарифнаяСтавкаПериода)).Размер;//Островская Татьяна 28.12.2012 № 16068
			
			БезЕТСПоСотруднику = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки),
			Новый Структура("Сотрудник,Организация", СтрокаТаблицаЗаписей.Сотрудник,СтрокаТаблицаЗаписей.Организация)).БезЕТС;//О.Т. Аверсон 06.11.2015 № 679
			
			если Строка(ТипЗнч(Регистратор)) = Метаданные.Документы.НачислениеОтпускаРаботникамОрганизаций.Синоним или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Строка(ТипЗнч(Регистратор)) = Метаданные.Документы.РасчетПриУвольненииРаботникаОрганизаций.Синоним Тогда //О.Т. Аверсон 09.02.2018 № 1566 + средний
				УсловиеФлагОрганизация = СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС;//О.Т. 18.07.2014 (убран ЕТКС)
			Иначе
				УсловиеФлагОрганизация = не БезЕТСПоСотруднику;
			КонецЕсли;
			
			если не УсловиеФлагОрганизация тогда
				//Аверсон-софт, Островская Татьяна 12.06.2012 № 15410
				если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда  //О.Т. Аверсон 09.02.2018 № 1566 + средний
					//О.Т. Аверсон 06.12.2016 № 74
					РегистрТарифныеСтавки = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(СтрокаДвижений.ПериодРегистрации), Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник));
					Если РегистрТарифныеСтавки.ДляПечати Тогда 
						РазмерПоследнегоОкл =  РегистрТарифныеСтавки.МесячнаяТарифнаяСтавкаВВалюте;
					иначе
						РазмерПоследнегоОкл =  РегистрТарифныеСтавки.ТарифнаяСтавка;
					КонецЕсли;
					//О.Т. Аверсон 06.12.2016 № 74
					
					//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
				иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
					
					ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ТЗНаборРасчетаНачисления.МесяцВыборки, СтрокаДвижений );
					ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
					РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
					ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
					//- СВЭЙ КДЯ 27.01.20 СВФР-005409
					
				иначе
					
					ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
					ЗапросОкладПосл = Новый Запрос;
					ЗапросОкладПосл.Текст = 
					"ВЫБРАТЬ
					|	ВЫБОР
					|		КОГДА ТарифныеСтавкиРаботниковОрганизации.ДляПечати
					|			ТОГДА ТарифныеСтавкиРаботниковОрганизации.МесячнаяТарифнаяСтавкаВВалюте
					|		ИНАЧЕ ТарифныеСтавкиРаботниковОрганизации.ТарифнаяСтавка
					|	КОНЕЦ КАК ТарифнаяСтавка, //О.Т. Аверсон 07.12.2016 № 74
					|	ТарифныеСтавкиРаботниковОрганизации.Период
					|ИЗ
					|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
					|			&Дата,
					|			Организация = &Организация
					|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
					|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
					|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
					|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
					|ГДЕ
					|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
					
					ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
					ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
					ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					ЗапросОкладПосл.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					
					РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
					РазмерПоследнегоОкл = 0;
					Пока РезультатОкладПосл.Следующий() Цикл
						РазмерПоследнегоОкл = РезультатОкладПосл.ТарифнаяСтавка;
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и РезультатОкладПосл.Период < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
							РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
				
				//О.Т. Аверсон 06.12.2016 № 74
				РегистрТарифныеСтавки = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки), Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник));
				Если РегистрТарифныеСтавки.ДляПечати Тогда 
					Оклад =  РегистрТарифныеСтавки.МесячнаяТарифнаяСтавкаВВалюте;
				иначе
					Оклад =  РегистрТарифныеСтавки.ТарифнаяСтавка;
				КонецЕсли;
				//О.Т. Аверсон 06.12.2016 № 74
				Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ТЗНаборРасчетаНачисления.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
					Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
				КонецЕсли;
				
			иначе
				//О.Т. 23.02.2015 № 331
				если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда //О.Т. Аверсон 09.02.2018 № 1566 + средний
					ПериодПоследнегоОкл =  ТекущаяДата();
					
					//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
				иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
					
					ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ТЗНаборРасчетаНачисления.МесяцВыборки, СтрокаДвижений );
					ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
					РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
					ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
					//- СВЭЙ КДЯ 27.01.20 СВФР-005409
					
				иначе
					ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
					ЗапросОкладПосл = Новый Запрос;
					ЗапросОкладПосл.Текст = 
					"ВЫБРАТЬ
					|	ТарифныеСтавкиРаботниковОрганизации.Период
					|ИЗ
					|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
					|			&Дата,
					|			Организация = &Организация
					|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
					|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
					|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
					|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
					|ГДЕ
					|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
					
					ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
					ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
					ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
					ЗапросОкладПосл.УстановитьПараметр("Дата", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
					
					РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
					ПериодПоследнегоОкл = ТекущаяДата();
					Пока РезультатОкладПосл.Следующий() Цикл
						ПериодПоследнегоОкл = РезультатОкладПосл.Период;
					КонецЦикла;
				КонецЕсли;
				//О.Т. 23.02.2015 № 331
				
				//Островская Татьяна 17.06.2013 № 16558
				ТарифнаяСтавкаПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
				Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
				ТарифнаяСтавкаПериода1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки), 
				Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
				
				РазмерПоследнегоОкл =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
				Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода)).Размер;
				Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ПериодПоследнегоОкл < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
					РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
				КонецЕсли;
				Оклад = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки), 
				Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавкаПериода1)).Размер;
				Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ТЗНаборРасчетаНачисления.МесяцВыборки < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
					Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
				КонецЕсли;
				//Островская Татьяна 17.06.2013 № 16558
			КонецЕсли;
			БезЕТСПоСотруднику = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки),
			Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).БезЕТС;//О.Т. Аверсон 06.11.2015 № 679
			
			если БезЕТСПоСотруднику или (не БезЕТСПоСотруднику и СтрокаДвижений.Организация.НеУчитыватьЕТКС) тогда //О.Т. Аверсон 05.02.2016 № 853
				СтрокаТаблицаЗаписей.ТарифнаяСтавкаПериода			 = ?(ПрошлыйТек,СтрокаТаблицаЗаписей.ТарифнаяСтавкаПериода,Оклад);
				СтрокаТаблицаЗаписей.ТекущаяТарифнаяСтавка			 = ?(ПрошлыйТек,СтрокаТаблицаЗаписей.ТекущаяТарифнаяСтавка,РазмерПоследнегоОкл);
			иначе
				СтрокаТаблицаЗаписей.ТарифнаяСтавкаПериода			 = ?(ПрошлыйТек,СтрокаТаблицаЗаписей.ТарифнаяСтавкаПериода,РазмерТСПериода);
				СтрокаТаблицаЗаписей.ТекущаяТарифнаяСтавка			 = ?(ПрошлыйТек,СтрокаТаблицаЗаписей.ТекущаяТарифнаяСтавка,СтрокаДвижений.ТекущаяТарифнаяСтавка);
			КонецЕсли;
			
			КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ТЗНаборРасчетаНачисления.МесяцВыборки, Истина,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
			СтрокаТаблицаЗаписей.ОтработаноДней = ?(ПремияПропорц,0,КалендарныеДни);
			СтрокаТаблицаЗаписей.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаТаблицаЗаписей.Результат, Константы.ВалютаРегламентированногоУчета.Получить()); 
			СтрокаТаблицаЗаписей.МесяцВыборки = ТЗНаборРасчетаНачисления.МесяцВыборки;
			СтрокаТаблицаЗаписей.ЧислоМесяцев = 1;
			
			
		КонецЕсли;
	КонецЕсли;
	
	// О.Т. 24.10.2014 Если расчет приходится на дату приема сотрудника
	
	//Островская Татьяна 11.09.2013 № 16778
	Даты = Новый СписокЗначений;
	если ЗначениеЗаполнено(НачалоБПМ) Тогда 
		Даты.Добавить(НачалоБПМ);
		КонецБПМ = ?(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда"),КонецМесяца(КонецБПМ),КонецБПМ); //Аверсон 03.09.2021 КВВ СВФР-008077
		если КонецМесяца(НачалоБПМ) <> КонецБПМ Тогда 
			если КонецМесяца(ДобавитьМесяц(НачалоБПМ,1)) = КонецБПМ Тогда 
				Даты.Добавить(НачалоМесяца(КонецБПМ));
			иначе
				счДата = 1;
				пока КонецМесяца(ДобавитьМесяц(НачалоБПМ,счДата)) <> КонецБПМ Цикл  
					Даты.Добавить(ДобавитьМесяц(НачалоБПМ,счДата));
					счДата = счДата+1;
				КонецЦикла;
				Даты.Добавить(ДобавитьМесяц(НачалоБПМ,счДата));
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	ПрошлыйБюджетПрожиточногоМинимума = 0;
	если УсловиеДляБПМ Тогда
		//СчНомерСтроки = 1;
		//Для Каждого СтрокаЗаписи из ТаблицаЗаписей Цикл 
		//	СтрокаЗаписи.НомерСтроки = СчНомерСтроки;
		//	СчНомерСтроки = СчНомерСтроки + 1;
		//КонецЦикла;
		
		для Каждого ДатаБПМ из Даты Цикл 
			ДатаБПМ = ДатаБПМ.Значение;
			
			//(начало) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			////вынесено в отдельную процедуру ПолучитьСтруктуруДатБюджетаПрожиточногоМинимума (см.ниже)
			//если Месяц(ДатаБПМ) >= 2 и Месяц(ДатаБПМ) <= 04 Тогда 
			//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ДатаБПМ)," ","")+"0201000000");
			//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ДатаБПМ)-1," ","")+"1101000000");
			//ИначеЕсли Месяц(ДатаБПМ) >= 5 и Месяц(ДатаБПМ) <= 7 Тогда 
			//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ДатаБПМ)," ","")+"0501000000");
			//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ДатаБПМ)," ","")+"0201000000");
			//ИначеЕсли Месяц(ДатаБПМ) >= 8 и Месяц(ДатаБПМ) <= 10 Тогда 
			//	ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ДатаБПМ)," ","")+"0801000000");
			//	ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ДатаБПМ)," ","")+"0501000000");
			//ИначеЕсли Месяц(ДатаБПМ) >= 11 или Месяц(ДатаБПМ) = 1 Тогда 
			//	если Месяц(ДатаБПМ) = 1 Тогда
			//		ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ДатаБПМ)-1," ","")+"1101000000");
			//		ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ДатаБПМ)-1," ","")+"0801000000");
			//	иначе
			//		ДатаБюджетаПрожМиним1 = Дата(""+СтрЗаменить(Год(ДатаБПМ)," ","")+"1101000000"); 
			//		ДатаБюджетаПрожМиним2 = Дата(""+СтрЗаменить(Год(ДатаБПМ)," ","")+"0801000000");
			//	КонецЕсли;
			//	
			//КонецЕсли;
			//(конец) закомментировано Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			
			//(начало) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			СтруктураДатБПМ = ПолучитьСтруктуруДатБюджетаПрожиточногоМинимума( ДатаБПМ );
			ДатаБюджетаПрожМиним1 = СтруктураДатБПМ.ДатаБюджетаПрожМинимТекущегоПериода;
			ДатаБюджетаПрожМиним2 = СтруктураДатБПМ.ДатаБюджетаПрожМинимПредыдущегоПериода;
			//(конец) добавлено Кухарчуком Д.Я. 18.12.18, Задача СВФР-002946, Аверсон-Софт
			
			БюджетПрожиточногоМинимума1 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним1, 
			Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
			БюджетПрожиточногоМинимума2 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаБюджетаПрожМиним2, 
			Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер;
			БюджетПрожиточногоМинимума = Макс(БюджетПрожиточногоМинимума1,БюджетПрожиточногоМинимума2);
			
			Отбор = Новый Структура();
			Отбор.Вставить("МесяцВыборки",ДатаБПМ);
			Отбор.Вставить("ВидРасчета",ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
			РезультатТаблица = ТаблицаЗаписей.НайтиСтроки(Отбор);
			если РезультатТаблица.Количество() = 0 Тогда 
				Отбор = Новый Структура();
				Отбор.Вставить("МесяцВыборки",Дата("00010101000000"));
				Отбор.Вставить("ВидРасчета",ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
				РезультатТаблица = ТаблицаЗаписей.НайтиСтроки(Отбор);
				если РезультатТаблица.Количество()>0 Тогда
					Для Каждого СтрТаблЗаписей из ТаблицаЗаписей Цикл 
						если СтрТаблЗаписей.НомерСтроки = РезультатТаблица[0].НомерСтроки Тогда 
							СтрокаТаблицаЗаписей = СтрТаблЗаписей;
						КонецЕсли;
					КонецЦикла;
					если СтрокаТаблицаЗаписей = Неопределено Тогда 
						СтрокаТаблицаЗаписей = ТаблицаЗаписей[0];
					КонецЕсли;
					
					
					// переправить везде стокуДвижений на нужные!!!
					//О.Т. 09.10.2014 № 17616
					если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
						КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаТаблицаЗаписей.Сотрудник,ДатаБПМ, УсловиеДляБПМ,ВыборкаБазы.ДатаНачалаДоговора,ВыборкаБазы.ДатаОкончанияДоговора,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
					иначе
						
						КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаТаблицаЗаписей.Сотрудник,ДатаБПМ, УсловиеДляБПМ,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
					КонецЕсли;
					//О.Т. 09.10.2014 № 17616
					
					//Островская Татьяна 11.09.2013 № 16778
					если УсловиеДляБПМ Тогда 
						если ПрошлыйБюджетПрожиточногоМинимума = БюджетПрожиточногоМинимума Тогда 
							Продолжить;
						КонецЕсли;
					КонецЕсли;
					//Островская Татьяна 11.09.2013 № 16778
					
					СтрокаТаблицаЗаписей.ПериодРегистрации = Регистратор.ПериодРегистрации;
					
					СтрокаТаблицаЗаписей.Регистратор 		= Регистратор;
					//Островская Татьяна 12.06.2014 Пересчет
					Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
						если ЗначениеПоРег.Количество()> 0 Тогда 
							СтрокаТаблицаЗаписей.БазовыйПериодНачало 		 	 = ЗначениеПоРег[0].БазовыйПериодНачало;
							СтрокаТаблицаЗаписей.БазовыйПериодКонец = ЗначениеПоРег[0].БазовыйПериодКонец;
							СтрокаТаблицаЗаписей.Результат = ЗначениеПоРег[0].Результат;
							СтрокаТаблицаЗаписей.РезультатДляПремии = БюджетПрожиточногоМинимума;
							СтрокаТаблицаЗаписей.ЧислоМесяцев 					= ЗначениеПоРег[0].ЧислоМесяцев;
							СтрокаТаблицаЗаписей.МесяцВыборки 					= ЗначениеПоРег[0].МесяцВыборки;								
						иначе
							СтрокаТаблицаЗаписей.БазовыйПериодНачало 		 	 = ДатаБПМ;
							СтрокаТаблицаЗаписей.БазовыйПериодКонец = КонецМесяца(ДатаБПМ);
							СтрокаТаблицаЗаписей.Результат = БюджетПрожиточногоМинимума;
							СтрокаТаблицаЗаписей.РезультатДляПремии = БюджетПрожиточногоМинимума;
							СтрокаТаблицаЗаписей.ЧислоМесяцев 					= 1;
							СтрокаТаблицаЗаписей.МесяцВыборки 					= ДатаБПМ;
							
						КонецЕсли;
					иначе
						СтрокаТаблицаЗаписей.БазовыйПериодНачало 		 	 = ДатаБПМ;
						СтрокаТаблицаЗаписей.БазовыйПериодКонец = КонецМесяца(ДатаБПМ);
						СтрокаТаблицаЗаписей.Результат = БюджетПрожиточногоМинимума;	
						СтрокаТаблицаЗаписей.РезультатДляПремии = БюджетПрожиточногоМинимума;
						СтрокаТаблицаЗаписей.ЧислоМесяцев 					= 1;
						СтрокаТаблицаЗаписей.МесяцВыборки 					= ДатаБПМ;
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						Если ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда" ) Тогда  //+ СВЭЙ КДЯ 26.11.19 СВФР-005120
							
							Если НЕ ЗначениеЗаполнено( СтрокаТаблицаЗаписей.НомерДоговора ) Тогда
								СтрокаТаблицаЗаписей.НомерДоговора = ВыборкаБазы.НомерДоговора;
								СтрокаТаблицаЗаписей.БазовыйПериодНачало 		 	 = ВыборкаБазы.ДатаНачалаОснДог;
								СтрокаТаблицаЗаписей.БазовыйПериодКонец = ВыборкаБазы.ДатаОкончанияОснДог;
							КонецЕсли; 
							Если НЕ ЗначениеЗаполнено( СтрокаТаблицаЗаписей.ДатаДоговора ) Тогда
								СтрокаТаблицаЗаписей.ДатаДоговора = ВыборкаБазы.ДатаДоговора;	
							КонецЕсли; 
							
						КонецЕсли; // ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда" ) //+ СВЭЙ КДЯ 26.11.19 СВФР-005120
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						
					КонецЕсли;
					//Островская Татьяна 12.06.2014 Пересчет
					
					СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(СтруктураПоискаДоп);
					
					Если СтрокиВремени.Количество() > 0 Тогда 
						Если СтрокиВремени.Количество() > 1 Тогда 
							Для каждого строканеноль из СтрокиВремени цикл
								Если СтрокаНеНоль.НормаДнейПоПятидневке > 0 тогда
									ВыбраннаяСтрока = СтрокаНеНоль;
									Прервать;
								иначе
									ВыбраннаяСтрока = СтрокиВремени[0];
								КонецЕсли;
							КонецЦикла;
						Иначе
							ВыбраннаяСтрока = СтрокиВремени[0];
						КонецЕсли;
						
						//Заполним простои
						Если ВыбраннаяСтрока.НаличиеПростоев <> 0 тогда
							СтрокаПростоев = ТаблицаПростоев.Добавить();
							СтрокаПростоев.ВидРасчета = СтрокаТаблицаЗаписей.ВидРасчета;
							СтрокаПростоев.МесяцВыборки = ДатаБПМ;
							СтрокаПростоев.НаличиеПростоев = ВыбраннаяСтрока.НаличиеПростоев;
							Сообщить("Возможно за " + Формат(НачалоМесяца(ДатаБПМ),"ДЛФ=Д") + " у сотрудника были простои.");
						КонецЕсли;
						//Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям Тогда
						// для "премий фиксированной суммой" надо учитывать отработанное время
						//Островская Татьяна 12.06.2014 Пересчет
						Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
							если ЗначениеПоРег.Количество()> 0 Тогда 
								СтрокаТаблицаЗаписей.ОтработаноПоПятидневке 			= ЗначениеПоРег[0].ОтработаноДнейПоПятидневке;
								СтрокаТаблицаЗаписей.НормаПоПятидневке 				= ЗначениеПоРег[0].НормаДнейПоПятидневке; //Островская Татьяна 28.12.2012 № 16068				
								СтрокаТаблицаЗаписей.ОтработаноЧасов 					= ЗначениеПоРег[0].ОтработаноЧасов; //Островская Татьяна 28.12.2012 № 16068								
							иначе
								СтрокаТаблицаЗаписей.ОтработаноПоПятидневке 			= ВыбраннаяСтрока.ОтработаноДнейПоПятидневке;
								СтрокаТаблицаЗаписей.НормаПоПятидневке 				= ВыбраннаяСтрока.НормаДнейПоПятидневке; //Островская Татьяна 28.12.2012 № 16068
								СтрокаТаблицаЗаписей.ОтработаноЧасов 					= ВыбраннаяСтрока.ОтработаноЧасов; //Островская Татьяна 28.12.2012 № 16068
							КонецЕсли;
						иначе
							СтрокаТаблицаЗаписей.ОтработаноПоПятидневке 			= ВыбраннаяСтрока.ОтработаноДнейПоПятидневке;
							СтрокаТаблицаЗаписей.НормаПоПятидневке 				= ВыбраннаяСтрока.НормаДнейПоПятидневке; //Островская Татьяна 28.12.2012 № 16068
							СтрокаТаблицаЗаписей.ОтработаноЧасов 					= ВыбраннаяСтрока.ОтработаноЧасов; //Островская Татьяна 28.12.2012 № 16068
						КонецЕсли;
						//Островская Татьяна 12.06.2014 Пересчет
						мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ДатаБПМ), КонецМесяца(ДатаБПМ), СтрокаТаблицаЗаписей.Сотрудник);
						СтрокаТаблицаЗаписей.НормаДней 					= мНорма.НормаДней;//Островская Татьяна 28.12.2012 № 16068
						СтрокаТаблицаЗаписей.НормаЧасов 					= мНорма.НормаЧасов;//Островская Татьяна 28.12.2012 № 16068
						если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
							строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
							если (Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПустаяСсылка() или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.БПМ или
								Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП) и Регистратор.КалендарныеДни Тогда 
								СтрокаТаблицаЗаписей.ОтработаноДней = КалендарныеДни;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 12.07.2013 № 16623
					Иначе
						Если Не СтрокаТаблицаЗаписей.БПНачало = Неопределено Тогда 
							//О.Т. 28.04.2015 № 417
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
								если Регистратор.ВклПремииПропорциональноОтрабВр и СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда 
									ФлагВключатьРасчетПропорционально = Ложь;
								иначе
									ФлагВключатьРасчетПропорционально = Истина;
								КонецЕсли;
							иначе
								ФлагВключатьРасчетПропорционально = Истина; 
							КонецЕсли;
							//О.Т. 29.04.2015 № 417
							ЗапросВидРасчета = Новый Запрос;
							ЗапросВидРасчета.Текст = 
							"ВЫБРАТЬ ПЕРВЫЕ 1
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидУчетаВремени
							|ИЗ
							|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
							|ГДЕ
							|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
							|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
							|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)";
							ВидРасчетаСписок = Новый СписокЗначений;
							ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
							ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
							ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
							ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
							ЗапросВидРасчета.УстановитьПараметр("ВидРасчета",ВидРасчетаСписок);	
							ЗапросВидРасчета.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);
							ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокаТаблицаЗаписей.МесяцВыборки);
							РезультатВидРасчета = ЗапросВидРасчета.Выполнить().Выгрузить();
							ВидРасчетаМесяца = Неопределено;
							если РезультатВидРасчета.Количество()>0 Тогда 
								ВидРасчетаМесяца = РезультатВидРасчета[0].ВидУчетаВремени;
							КонецЕсли;			
							//О.Т. 29.04.2015 № 417
							
							//О.Т. 28.04.2015 № 417
							Если НачалоМесяца(СтрокаТаблицаЗаписей.БПНачало) = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) и ФлагВключатьРасчетПропорционально Тогда
								//О.Т. 29.04.2015 № 417
								если ВидРасчетаМесяца = Перечисления.ВидыУчетаВремени.ПоДням Тогда
									ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоДням, Ложь);
									НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаТаблицаЗаписей.БПНачало), КонецМесяца(СтрокаТаблицаЗаписей.БПНачало), СтрокаДвижений.Сотрудник).НормаДней;
									ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
								иначе
									ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия), СтрокаДвижений.ДатаНачалаСобытия-86400, СтрокаДвижений.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Ложь);
									НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаТаблицаЗаписей.БПНачало), КонецМесяца(СтрокаТаблицаЗаписей.БПНачало), СтрокаДвижений.Сотрудник).НормаЧасов;
									ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
								КонецЕсли;
								//О.Т. 29.04.2015 № 417
								
								//Островская Татьяна 12.06.2014 Пересчет
								Если (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") и Пересчет Тогда
									если ЗначениеПоРег.Количество()> 0 Тогда 
										СтрокаТаблицаЗаписей.Результат 			= ЗначениеПоРег[0].Результат;
										СтрокаТаблицаЗаписей.РезультатДляПремии = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,СтрокаТаблицаЗаписей.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
									иначе
										Если ЗначениеЗаполнено(НормаВремени) Тогда
											СтрокаТаблицаЗаписей.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,СтрокаТаблицаЗаписей.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());//Островская Татьяна 28.12.2012 № 16068
											СтрокаТаблицаЗаписей.РезультатДляПремии =ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,СтрокаТаблицаЗаписей.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
										КонецЕсли;
									КонецЕсли;
								иначе
									Если ЗначениеЗаполнено(НормаВремени) Тогда
										СтрокаТаблицаЗаписей.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,СтрокаТаблицаЗаписей.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());//Островская Татьяна 28.12.2012 № 16068
										СтрокаТаблицаЗаписей.РезультатДляПремии =ОбщегоНазначения.ОкруглитьПоВалюте(?(ЕстьТекМесяц,ТЗНаборРасчетаНачисления.Результат,СтрокаТаблицаЗаписей.Результат/НормаВремени*ОплачиваемоеВремя), Константы.ВалютаРегламентированногоУчета.Получить());
									КонецЕсли;
								КонецЕсли;
								//Островская Татьяна 12.06.2014 Пересчет
								
								//Островская Татьяна 11.09.2013 № 16778
								если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
									строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
									если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
										СтрокаТаблицаЗаписей.Результат = БюджетПрожиточногоМинимума;	
										СтрокаТаблицаЗаписей.РезультатДляПремии = БюджетПрожиточногоМинимума;
									КонецЕсли;
								КонецЕсли;
								//Островская Татьяна 11.09.2013 № 16778
								
							КонецЕсли
							//енд					
						КонецЕсли;
					КонецЕсли;
					если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
						строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
						если (Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПустаяСсылка() или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.БПМ
							или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП) и Регистратор.КалендарныеДни Тогда 
							СтрокаТаблицаЗаписей.ОтработаноДней = КалендарныеДни;
						КонецЕсли;
					КонецЕсли;
					
				иначе
					Отбор = Новый Структура();
					Отбор.Вставить("МесяцВыборки",ДатаБПМ);
					Отбор.Вставить("ВидРасчета",ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
					РезультатТаблица = ТаблицаЗаписей.НайтиСтроки(Отбор);
					если РезультатТаблица = 0 Тогда 
						НомерСтрокиПрошл = ТаблицаЗаписей.Количество();
						НомерСтроки = ТаблицаЗаписей.Количество()+1;
						//О.Т. 09.10.2014 № 17616
						если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")Тогда
							КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(ТаблицаЗаписей[НомерСтрокиПрошл-1].Сотрудник,ДатаБПМ, УсловиеДляБПМ,ВыборкаБазы.ДатаНачалаДоговора,ВыборкаБазы.ДатаОкончанияДоговора,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
						иначе
							
							КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(ТаблицаЗаписей[НомерСтрокиПрошл-1].Сотрудник,ДатаБПМ, УсловиеДляБПМ,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
						КонецЕсли;
						//О.Т. 09.10.2014 № 17616
						
						//Островская Татьяна 11.09.2013 № 16778
						если УсловиеДляБПМ Тогда 
							если ПрошлыйБюджетПрожиточногоМинимума = БюджетПрожиточногоМинимума Тогда 
								Продолжить;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 11.09.2013 № 16778
						// вводим новые строки набора записей
						ДопСтрокаДвижений = ТаблицаЗаписей.Добавить();
						
						ДопСтрокаДвижений.ПериодРегистрации = Регистратор.ПериодРегистрации;
						ДопСтрокаДвижений.ВидРасчета 		= ТаблицаЗаписей[НомерСтрокиПрошл-1].ВидРасчета;
						ДопСтрокаДвижений.Регистратор 		= Регистратор;
						ДопСтрокаДвижений.НомерСтроки		= НомерСтроки;
						
						// измерения
						ДопСтрокаДвижений.Сотрудник 	= ТаблицаЗаписей[НомерСтрокиПрошл-1].Сотрудник;
						ДопСтрокаДвижений.ФизЛицо 	= ТаблицаЗаписей[НомерСтрокиПрошл-1].ФизЛицо;
						ДопСтрокаДвижений.Организация	= ТаблицаЗаписей[НомерСтрокиПрошл-1].Организация;
						ДопСтрокаДвижений.Приказ 		= ТаблицаЗаписей[НомерСтрокиПрошл-1].Приказ;
						
						// свойства
						//ДопСтрокаДвижений.ВидРасчета 		 			 = СтрокаДвижений.ВидРасчета;
						ДопСтрокаДвижений.БазовыйПериодНачало 		 	 = ДатаБПМ;
						ДопСтрокаДвижений.БазовыйПериодКонец = КонецМесяца(ДатаБПМ);
						// реквизиты
						ДопСтрокаДвижений.КоэффициентИндексации 		 = ТаблицаЗаписей[НомерСтрокиПрошл-1].КоэффициентИндексации; //Островская Татьяна 02.08.2013 № 16623
						ДопСтрокаДвижений.ДатаНачалаРасчетногоПериода 	 = ТаблицаЗаписей[НомерСтрокиПрошл-1].ДатаНачалаРасчетногоПериода;
						ДопСтрокаДвижений.ДатаОкончанияРасчетногоПериода = ТаблицаЗаписей[НомерСтрокиПрошл-1].ДатаОкончанияРасчетногоПериода;
						
						ДопСтрокаДвижений.СпособРасчета 				 = ТаблицаЗаписей[НомерСтрокиПрошл-1].СпособРасчета;
						ДопСтрокаДвижений.ПериодРасчетаСреднегоЗаработка = ТаблицаЗаписей[НомерСтрокиПрошл-1].ПериодРасчетаСреднегоЗаработка;
						ДопСтрокаДвижений.ДатаНачалаСобытия              = ТаблицаЗаписей[НомерСтрокиПрошл-1].ДатаНачалаСобытия;
						
						ДопСтрокаДвижений.Результат = БюджетПрожиточногоМинимума;
						ДопСтрокаДвижений.РезультатДляПремии = БюджетПрожиточногоМинимума;
						//Островская Татьяна 11.09.2013 № 16778
						ДопСтрокаДвижений.ЧислоМесяцев 					= 1;
						ДопСтрокаДвижений.МесяцВыборки 					= ДатаБПМ;
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15410
						СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(СтруктураПоискаДоп);
						
						Если СтрокиВремени.Количество() > 0 Тогда 
							Если СтрокиВремени.Количество() > 1 Тогда 
								Для каждого строканеноль из СтрокиВремени цикл
									Если СтрокаНеНоль.НормаДнейПоПятидневке > 0 тогда
										ВыбраннаяСтрока = СтрокаНеНоль;
										Прервать;
									иначе
										ВыбраннаяСтрока = СтрокиВремени[0];
									КонецЕсли;
								КонецЦикла;
							Иначе
								ВыбраннаяСтрока = СтрокиВремени[0];
							КонецЕсли;
							
							//Заполним простои
							Если ВыбраннаяСтрока.НаличиеПростоев <> 0 тогда
								СтрокаПростоев = ТаблицаПростоев.Добавить();
								СтрокаПростоев.ВидРасчета = ДопСтрокаДвижений.ВидРасчета;
								СтрокаПростоев.МесяцВыборки = ДатаБПМ;
								СтрокаПростоев.НаличиеПростоев = ВыбраннаяСтрока.НаличиеПростоев;
								Сообщить("Возможно за " + Формат(НачалоМесяца(ДатаБПМ),"ДЛФ=Д") + " у сотрудника были простои.");
								Если Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций" Тогда
									//Островская Татьяна 30.05.2014 № 17397
									если Пересчет и (Регистратор.Метаданные().Имя = "НачислениеОтпускаРаботникамОрганизаций" или Регистратор.Метаданные().Имя = "РасчетПриУвольненииРаботникаОрганизаций") Тогда 
										ОтборРег = Новый Структура;
										ОтборРег.Вставить("МесяцВыборки",ДопСтрокаДвижений.МесяцВыборки);
										ОтборРег.Вставить("ВидРасчета",ДопСтрокаДвижений.ВидРасчета);
										Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
										если Включать.Количество()> 0 Тогда 
											ДопСтрокаДвижений.Включать = Включать[0].Включать;
										иначе
											ДопСтрокаДвижений.Включать = Ложь;											
										КонецЕсли;
									иначе
										
										ДопСтрокаДвижений.Включать = Ложь;
									КонецЕсли;
									//Островская Татьяна 30.05.2014 № 17397
								КонецЕсли;
							КонецЕсли;
							//Если СтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям Тогда
							// для "премий фиксированной суммой" надо учитывать отработанное время
							ДопСтрокаДвижений.ОтработаноПоПятидневке 			= ВыбраннаяСтрока.ОтработаноДнейПоПятидневке;
							ДопСтрокаДвижений.НормаПоПятидневке 				= ВыбраннаяСтрока.НормаДнейПоПятидневке; //Островская Татьяна 28.12.2012 № 16068
							ДопСтрокаДвижений.ОтработаноЧасов 					= ВыбраннаяСтрока.ОтработаноЧасов; //Островская Татьяна 28.12.2012 № 16068
							мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ДатаБПМ), КонецМесяца(ДатаБПМ), ТаблицаЗаписей[НомерСтрокиПрошл-1].Сотрудник);
							ДопСтрокаДвижений.НормаДней 					= мНорма.НормаДней;//Островская Татьяна 28.12.2012 № 16068
							ДопСтрокаДвижений.НормаЧасов 					= мНорма.НормаЧасов;//Островская Татьяна 28.12.2012 № 16068
							если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
								строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
								если (Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПустаяСсылка() или Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.БПМ или 
									Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП) и Регистратор.КалендарныеДни Тогда 
									ДопСтрокаДвижений.ОтработаноДней = КалендарныеДни;
								КонецЕсли;
							КонецЕсли;
							//Островская Татьяна 12.07.2013 № 16623
						Иначе
							Если Не ДопСтрокаДвижений.БПНачало = Неопределено Тогда 
								Если НачалоМесяца(ДопСтрокаДвижений.БПНачало) = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) Тогда
									ОплачиваемоеВремя = ПрочиеПроцедуры.ОтработанноеВремяПоПлановымГраффикамПлан(НачалоМесяца(ТаблицаЗаписей[НомерСтрокиПрошл-1].ДатаНачалаСобытия), ТаблицаЗаписей[НомерСтрокиПрошл-1].ДатаНачалаСобытия-86400, ТаблицаЗаписей[НомерСтрокиПрошл-1].Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, Ложь);
									НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ДатаБПМ), КонецМесяца(ДатаБПМ), ТаблицаЗаписей[НомерСтрокиПрошл-1].Сотрудник).НормаЧасов;
									ОплачиваемоеВремя = ?(ОплачиваемоеВремя=Null, 0, ОплачиваемоеВремя);
									если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
										строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
										если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
											ДопСтрокаДвижений.Результат = БюджетПрожиточногоМинимума;
											ДопСтрокаДвижений.РезультатДляПремии = БюджетПрожиточногоМинимума;
										КонецЕсли;
									КонецЕсли;
									//Островская Татьяна 11.09.2013 № 16778
									
								КонецЕсли
								//енд					
							КонецЕсли;
						КонецЕсли;
						
						
						
					КонецЕсли;
					
					
				КонецЕсли; 
			КонецЕсли;
			ПрошлыйБюджетПрожиточногоМинимума = БюджетПрожиточногоМинимума;
			
		КонецЦикла; // ДатаБПМ из Даты
		
		
	КонецЕсли;
	
	//Островская Татьяна 11.09.2013 № 16778
	ЗапросВидРасчета = Новый Запрос;
	ЗапросВидРасчета.Текст = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидУчетаВремени
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
	|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
	|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)";
	ВидРасчетаСписок = Новый СписокЗначений;
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
	ЗапросВидРасчета.УстановитьПараметр("ВидРасчета",ВидРасчетаСписок);	
	//толик данные для разрезов	
	Измерения = Новый Массив(1);
	Измерения[0] = "Сотрудник";
	
	ЗапросРазрезы.УстановитьПараметр("парамИзмерения",		Измерения);
	ЗапросРазрезы.УстановитьПараметр("парамРазрезы",		РазрезыРасшифрока);
	ЗапросРазрезы.УстановитьПараметр("парамРазрезыДоп",		РазрезыРасшифрокаДоп);
	ЗапросРазрезы.УстановитьПараметр("парамРегистратор",	Регистратор);
	
	ПоГодовойПремии = Новый Массив;
	ПоГодовойПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии);
	
	ПоПремии = Новый Массив;
	//О.Т. Аверсон 06.01.2017 № 133
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") 
		//+ СВЭЙ КДЯ 17.02.20 СВФР-005492
		ИЛИ ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" ) 
		И Регистратор.ВклПремииПропорциональноОтрабВр
		//- СВЭЙ КДЯ 17.02.20 СВФР-005492
		Тогда 
		ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему);//О.Т. Аверсон 06.05.2016 № 1141
	иначе
		ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
	КонецЕсли;
	//О.Т. Аверсон 06.01.2017 № 133
	ПоПремии.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
	
	Заработок = Новый Массив;
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск);
	
	//Аверсон ЕАЕ 17.10.2022 СВФР-009668
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах);
	//Аверсон СВФР-009668
	
	Заработок.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент);//О.Т. Аверсон 16.04.2019 № 4189
	
	ЗапросРазрезы.УстановитьПараметр("парамПоГодовойПремии",	ПоГодовойПремии);
	ЗапросРазрезы.УстановитьПараметр("парамЗаработок",	Заработок);
	ЗапросРазрезы.УстановитьПараметр("парамПоПремии",	ПоПремии);
	
	//Аверсон 27.01.2022 КВВ СВФР-008638 (
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
		ВыборкаБазыРазрезов = ЗапросРазрезы.Выполнить().Выгрузить();
		СтрокиКУдалению = ВыборкаБазыРазрезов.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			ВыборкаБазыРазрезов.Удалить(ПустаяСтрока);
		КонецЦикла;
		РасшифровкаРасчетаСреднего = РегистрыСведений.РасшифровкаРасчетаСреднего.СоздатьНаборЗаписей();
		РасшифровкаРасчетаСреднего.Отбор.Документ.Установить(Регистратор.Ссылка);
		РасшифровкаРасчетаСреднего.Очистить();
		РасшифровкаРасчетаСреднего.Загрузить(ВыборкаБазыРазрезов);
		РасшифровкаРасчетаСреднего.Записать(Истина);
	КонецЕсли;
	//Аверсон 27.01.2022 КВВ СВФР-008638 )
	
	если не УсловиеДляБПМ Тогда
		Если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" или
			Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛистуПоДоговорамПодряда" Тогда //О.Т. 23.09.2014 № 17616
			если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" и ТЗНаборРасчетаНачисления <> Неопределено Тогда 
				если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и КонецМесяца(ТЗНаборРасчетаНачисления.МесяцВыборки)= КонецМесяца(Регистратор.ДатаОкончания) Тогда //О.Т. 18.02.2015 № 334
					ВыборкаБазыРазрезов = ЗапросРазрезы.Выполнить().Выгрузить();
					тзОтработано = ТаблицаЗаписей.Скопировать(,"МесяцВыборки, НормаЧасов,НормаДней, ОтработаноЧасов, ОтработаноПоПятидневке");
					тзОтработано.Свернуть("МесяцВыборки", "НормаЧасов,НормаДней, ОтработаноЧасов, ОтработаноПоПятидневке");
					Для Каждого СтрокаОтработано Из тзОтработано Цикл
						если ЗначениеЗаполнено(СтрокаОтработано.МесяцВыборки) Тогда 
							мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокаОтработано.МесяцВыборки), КонецМесяца(СтрокаОтработано.МесяцВыборки), СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация.ЗаполнениеТабелейСУчетомСтавки);
							Отбор = Новый Структура;
							Отбор.Вставить("МесяцВыборки",СтрокаОтработано.МесяцВыборки);
							СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(Отбор);
							//Островская Татьяна 11.12.2013 № 16971
							ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокаОтработано.МесяцВыборки);
							ЗапросВидРасчета.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);//Островская Татьяна 11.12.2013 № 16971
							ВидУчетаВремени = Неопределено;
							РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
							если РезультВидУчета.Количество() > 0 Тогда 
								ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
							КонецЕсли;
							//Островская Татьяна 11.12.2013 № 16971
							если СтрокиВремени.Количество()>0 Тогда 
								СтрокиВремени = СтрокиВремени[0];
								ОтрабПоГрДн = СтрокиВремени.ОтработаноДней;
								Если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и не Регистратор.СпособРасчетаВЧасах Тогда 
									ОтрабПоГр = СтрокиВремени.ОтработаноДней;
								Иначе 
									ОтрабПоГр = СтрокиВремени.ОтработаноЧасов;
								КонецЕсли;
								если Регистратор.СпособРасчетаВДнях и не Регистратор.СпособРасчетаВЧасах Тогда 
									ОтрабПоГр = СтрокиВремени.ОтработаноДней;
								КонецЕсли;
							иначе
								СтрокиВремени = СтрокаОтработано;
								ОтрабПоГрДн = СтрокиВремени.ОтработаноПоПятидневке;
								Если ЗначениеЗаполнено(СтрокиВремени.ОтработаноПоПятидневке) Тогда 
									ОтрабПоГр = СтрокиВремени.ОтработаноПоПятидневке;
								Иначе 
									ОтрабПоГр = СтрокиВремени.ОтработаноЧасов;
								КонецЕсли;
								если Регистратор.СпособРасчетаВДнях и не Регистратор.СпособРасчетаВЧасах Тогда 
									ОтрабПоГр = СтрокиВремени.ОтработаноПоПятидневке;
								КонецЕсли;
							КонецЕсли;  
							
							
							Если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и не Регистратор.СпособРасчетаВЧасах Тогда 
								НормаПоГр= мНорма.НормаДней;
							Иначе 
								НормаПоГр= мНорма.НормаЧасов;
							КонецЕсли;
							если Регистратор.СпособРасчетаВДнях и не Регистратор.СпособРасчетаВЧасах Тогда 
								НормаПоГр = мНорма.НормаДней;
							КонецЕсли;
						КонецЕсли;
						
						Если НачалоМесяца(СтрокаОтработано.МесяцВыборки) = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) Тогда
							
							
							//если месяц расчета равен месяцу начисления пересчитываем часы в расшифровке
							
							МассивЗП = ВыборкаБазыРазрезов.НайтиСтроки(Новый Структура("МесяцВыборки, Тип", СтрокаОтработано.МесяцВыборки, 0));
							мСуммаЧасов = 0;
							Для Каждого СтрокаЗП Из МассивЗП Цикл
								мСуммаЧасов = мСуммаЧасов + СтрокаЗП.ОтработаноЧасов;
							КонецЦикла;
							мЗаполненныеЧасы = Ложь;
							Для Каждого СтрокаЗП Из МассивЗП Цикл
								СтрокаЗП.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(мСуммаЧасов = 0, 0, СтрокаЗП.Результат/мСуммаЧасов*ОтрабПоГр), Константы.ВалютаРегламентированногоУчета.Получить());
								Если (Не мЗаполненныеЧасы) И (ЗначениеЗаполнено(СтрокаЗП.ОтработаноЧасов)) Тогда
									СтрокаЗП.ОтработаноЧасов = ОтрабПоГр;
									СтрокаЗП.ОтработаноДней = ОтрабПоГрДн;
									мЗаполненныеЧасы = Истина;
								Иначе
									СтрокаЗП.ОтработаноЧасов = 0;
									СтрокаЗП.ОтработаноДней = 0;
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
						//ТаблицаБПМ = ТаблицаЗаписей;
						//ТаблицаБПМ.Свернуть("МесяцВыборки,ВидРассчета,Результат");
						//МассивБПМ = ТаблицаБПМ.НайтиСтроки(Новый Структура("МесяцВыборки", СтрокаОтработано.МесяцВыборки));
						
						МассивПремий = ВыборкаБазыРазрезов.НайтиСтроки(Новый Структура("МесяцВыборки, Тип", СтрокаОтработано.МесяцВыборки, 1));
						Для Каждого СтрокаПремии1 Из МассивПремий Цикл
							//О.Т. 15.07.2014 № 118
							если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и Регистратор.КалендарныеДни Тогда 
								СтрокаПремии1.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии1.Результат / КалендарныеДни, Константы.ВалютаРегламентированногоУчета.Получить()); 
							иначе
								//О.Т. 15.07.2014 № 118
								Если НормаПоГр = 0 Тогда 
									СтрокаПремии1.Результат = 0;
								Иначе
									СтрокаПремии1.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии1.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр, Константы.ВалютаРегламентированногоУчета.Получить());
								КонецЕсли;
							КонецЕсли;
						КонецЦикла;
						
					КонецЦикла;
					СтрокиКУдалению = ВыборкаБазыРазрезов.НайтиСтроки(Новый Структура("Результат", 0));
					Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
						ВыборкаБазыРазрезов.Удалить(ПустаяСтрока);
					КонецЦикла;
					РасшифровкаРасчетаСреднего = РегистрыСведений.РасшифровкаРасчетаСреднего.СоздатьНаборЗаписей();
					РасшифровкаРасчетаСреднего.Отбор.Документ.Установить(Регистратор.Ссылка);
					РасшифровкаРасчетаСреднего.Очистить();//Островская Татьяна 29.11.2013
					РасшифровкаРасчетаСреднего.Загрузить(ВыборкаБазыРазрезов);
					РасшифровкаРасчетаСреднего.Записать(Истина);
				КонецЕсли;
			иначе
				ВыборкаБазыРазрезов = ЗапросРазрезы.Выполнить().Выгрузить();
				тзОтработано = ТаблицаЗаписей.Скопировать(,"МесяцВыборки, НормаЧасов,НормаДней, ОтработаноЧасов, ОтработаноПоПятидневке");
				тзОтработано.Свернуть("МесяцВыборки", "НормаЧасов,НормаДней, ОтработаноЧасов, ОтработаноПоПятидневке");
				
				ЭтоБольничныйПоДогПодряда = Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛистуПоДоговорамПодряда";//О.Т. Аверсон 05.12.2017
				
				Для Каждого СтрокаОтработано Из тзОтработано Цикл
					если ЗначениеЗаполнено( СтрокаОтработано.МесяцВыборки ) Тогда
						
						//+ СВЭЙ КДЯ 09.01.20 СВФР-005273
						УчитыватьСтавку = ( ТипЗнч(  СтрокаДвижений.Регистратор ) 
						= Тип( "ДокументСсылка.НачислениеПоБольничномуЛисту" ) 
						И СтрокаДвижений.Регистратор.УчитыватьСтавку );
						//- СВЭЙ КДЯ 09.01.20 СВФР-005273
						
						//Аверсон ЕАЕ 10.02.2021 СВФР-007115
						НормаИзГрафика = (ТипЗнч(СтрокаДвижений.Регистратор) 
						= Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") 
						И СтрокаДвижений.Регистратор.НормаИзГрафика);
						//Аверсон
						
						мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(
						НачалоМесяца( СтрокаОтработано.МесяцВыборки ), 
						КонецМесяца( СтрокаОтработано.МесяцВыборки ), 
						СтрокаДвижений.Сотрудник,
						СтрокаДвижений.Организация.ЗаполнениеТабелейСУчетомСтавки 
						//+ СВЭЙ КДЯ 09.01.20 СВФР-005273
						ИЛИ УчитыватьСтавку 
						//- СВЭЙ КДЯ 09.01.20 СВФР-005273
						
						//Аверсон ЕАЕ 10.02.2021 СВФР-007115
						,,
						НормаИзГрафика
						//Аверсон
						);
						
						Отбор = Новый Структура;
						Отбор.Вставить("МесяцВыборки",СтрокаОтработано.МесяцВыборки);
						СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(Отбор);
						//Островская Татьяна 11.12.2013 № 16971
						ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокаОтработано.МесяцВыборки);
						ЗапросВидРасчета.УстановитьПараметр("Сотрудник",СтрокаДвижений.Сотрудник);//Островская Татьяна 11.12.2013 № 16971
						ВидУчетаВремени = Неопределено;
						РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
						если РезультВидУчета.Количество() > 0 Тогда 
							ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
						КонецЕсли;
						//Островская Татьяна 11.12.2013 № 16971
						
						
						//О.Т. Аверсон 06.12.2017 № 1330
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОплаченоДней) КАК ОплаченоДней,
						|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОплаченоДнейЧасов) КАК ОплаченоДнейЧасов
						|ИЗ
						|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
						|ГДЕ
						|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &ПериодВыборки И &ПериодВыборки1
						|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)";
						
						СписокВидРасчета = Новый СписокЗначений;
						ГруппаРасчетовБЛПремия = Справочники.ГруппыРасчетов.ВключениеРабочегоВремениДляБЛДляРасчетаПремии;    
						для Каждого СтрДляПремии из ГруппаРасчетовБЛПремия.Основные Цикл 
							СписокВидРасчета.Добавить(СтрДляПремии.ВидРасчета);
						КонецЦикла;
						
						Запрос.УстановитьПараметр("ВидРасчета", СписокВидРасчета);
						Запрос.УстановитьПараметр("ПериодВыборки", НачалоМесяца(СтрокаОтработано.МесяцВыборки));
						Запрос.УстановитьПараметр("ПериодВыборки1", КонецМесяца(СтрокаОтработано.МесяцВыборки));
						Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
						
						РезДляПремии = Запрос.Выполнить().Выбрать();
						ДопДни = 0;
						ДопЧасы = 0;
						Пока РезДляПремии.Следующий() Цикл
							ДопДни = ДопДни + ?(РезДляПремии.ОплаченоДней = Null,0,РезДляПремии.ОплаченоДней);
							ДопЧасы = ДопЧасы + ?(РезДляПремии.ОплаченоДнейЧасов = Null,0,РезДляПремии.ОплаченоДнейЧасов);
						КонецЦикла;
						
						
						
						если СтрокиВремени.Количество()>0 Тогда 
							СтрокиВремени = СтрокиВремени[0];
							ОтрабПоГрДн = СтрокиВремени.ОтработаноДней;
							Если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и не ?(ЭтоБольничныйПоДогПодряда,ложь,Регистратор.СпособРасчетаВЧасах) Тогда 
								ОтрабПоГр = СтрокиВремени.ОтработаноДней + ДопДни;
							Иначе 
								ОтрабПоГр = СтрокиВремени.ОтработаноЧасов + ДопЧасы;
							КонецЕсли;
							если Регистратор.СпособРасчетаВДнях и не ?(ЭтоБольничныйПоДогПодряда,ложь,Регистратор.СпособРасчетаВЧасах) Тогда 
								ОтрабПоГр = СтрокиВремени.ОтработаноДней + ДопДни;
							КонецЕсли;
						иначе
							СтрокиВремени = СтрокаОтработано;
							ОтрабПоГрДн = СтрокиВремени.ОтработаноПоПятидневке;
							Если ЗначениеЗаполнено(СтрокиВремени.ОтработаноПоПятидневке) Тогда 
								ОтрабПоГр = СтрокиВремени.ОтработаноПоПятидневке + ДопДни;
							Иначе 
								ОтрабПоГр = СтрокиВремени.ОтработаноЧасов + ДопЧасы;
							КонецЕсли;
							если Регистратор.СпособРасчетаВДнях и не ?(ЭтоБольничныйПоДогПодряда,ложь,Регистратор.СпособРасчетаВЧасах) Тогда 
								ОтрабПоГр = СтрокиВремени.ОтработаноПоПятидневке + ДопДни;
							КонецЕсли;
						КонецЕсли;  
						
						
						Если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и не ?(ЭтоБольничныйПоДогПодряда,ложь,Регистратор.СпособРасчетаВЧасах) Тогда 
							НормаПоГр= мНорма.НормаДней;
						Иначе 
							НормаПоГр= мНорма.НормаЧасов;
						КонецЕсли;
						если Регистратор.СпособРасчетаВДнях и не ?(ЭтоБольничныйПоДогПодряда,ложь,Регистратор.СпособРасчетаВЧасах) Тогда 
							НормаПоГр = мНорма.НормаДней;
						КонецЕсли;
						Если Не ЗначениеЗаполнено(НормаПоГр) Тогда// //СМА СВФР-007810
							НормаПоГр = 0; 
						КонецЕсли;
					КонецЕсли;
					
					
					
					
					Если НачалоМесяца(СтрокаОтработано.МесяцВыборки) = НачалоМесяца(СтрокаДвижений.ДатаНачалаСобытия) Тогда
						
						
						//если месяц расчета равен месяцу начисления пересчитываем часы в расшифровке
						
						МассивЗП = ВыборкаБазыРазрезов.НайтиСтроки(Новый Структура("МесяцВыборки, Тип", СтрокаОтработано.МесяцВыборки, 0));
						мСуммаЧасов = 0;
						Для Каждого СтрокаЗП Из МассивЗП Цикл
							мСуммаЧасов = мСуммаЧасов + СтрокаЗП.ОтработаноЧасов;
						КонецЦикла;
						мЗаполненныеЧасы = Ложь;
						Для Каждого СтрокаЗП Из МассивЗП Цикл
							СтрокаЗП.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(?(мСуммаЧасов = 0, 0, СтрокаЗП.Результат/мСуммаЧасов*ОтрабПоГр), Константы.ВалютаРегламентированногоУчета.Получить());
							Если (Не мЗаполненныеЧасы) И (ЗначениеЗаполнено(СтрокаЗП.ОтработаноЧасов)) Тогда
								СтрокаЗП.ОтработаноЧасов = ОтрабПоГр;
								СтрокаЗП.ОтработаноДней = ОтрабПоГрДн;
								мЗаполненныеЧасы = Истина;
							Иначе
								СтрокаЗП.ОтработаноЧасов = 0;
								СтрокаЗП.ОтработаноДней = 0;
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
					//ТаблицаБПМ = ТаблицаЗаписей;
					//ТаблицаБПМ.Свернуть("МесяцВыборки,ВидРассчета,Результат");
					//МассивБПМ = ТаблицаБПМ.НайтиСтроки(Новый Структура("МесяцВыборки", СтрокаОтработано.МесяцВыборки));
					
					МассивПремий = ВыборкаБазыРазрезов.НайтиСтроки(Новый Структура("МесяцВыборки, Тип", СтрокаОтработано.МесяцВыборки, 1));
					Для Каждого СтрокаПремии1 Из МассивПремий Цикл
						//О.Т. 15.07.2014 № 118
						если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и Регистратор.КалендарныеДни Тогда 
							СтрокаПремии1.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии1.Результат / КалендарныеДни, Константы.ВалютаРегламентированногоУчета.Получить()); 
						иначе
							//О.Т. 15.07.2014 № 118
							Если НормаПоГр = 0 Тогда  
								СтрокаПремии1.Результат = 0;
							Иначе
								СтрокаПремии1.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии1.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр, Константы.ВалютаРегламентированногоУчета.Получить());
							КонецЕсли;
						КонецЕсли;
					КонецЦикла;
					
				КонецЦикла;
				СтрокиКУдалению = ВыборкаБазыРазрезов.НайтиСтроки(Новый Структура("Результат", 0));
				Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
					ВыборкаБазыРазрезов.Удалить(ПустаяСтрока);
				КонецЦикла;
				РасшифровкаРасчетаСреднего = РегистрыСведений.РасшифровкаРасчетаСреднего.СоздатьНаборЗаписей();
				РасшифровкаРасчетаСреднего.Отбор.Документ.Установить(Регистратор.Ссылка);
				РасшифровкаРасчетаСреднего.Очистить();//Островская Татьяна 29.11.2013
				РасшифровкаРасчетаСреднего.Загрузить(ВыборкаБазыРазрезов);
				РасшифровкаРасчетаСреднего.Записать(Истина);
				
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;	
	//толик енд	
	
	//О.Т. Аверсон 16.04.2019 № 4189
	ЭтоАгент = Ложь;
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
		ЭтоАгент = Регистратор.Агент;
	КонецЕсли;
	//О.Т. Аверсон 16.04.2019 № 4189
	//Запишем результат
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") тогда
		СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			ТаблицаЗаписей.Удалить(ПустаяСтрока);
		КонецЦикла;
		
		СтруктураПоиска = Новый Структура("МесяцВыборки");
		//Проанализировать простои
		
		//Аверсон ЕАЕ 17.10.2022 СВФР-009668
		НеполныйМесяц = Ложь;
		Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда
			НеполныйМесяц = Регистратор.РасчетПриНеполныхМесяцах;
		КонецЕсли;
		//СтрокиЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
		СтрокиЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск))));
		//Аверсон СВФР-009668
		
		Если СтрокиЗаработка.Количество() <> 0 тогда
			ПервыйМесяцВыборки = Месяц(СтрокиЗаработка[0].МесяцВыборки);
			ПервыйГодВыборки   = Год(СтрокиЗаработка[0].МесяцВыборки);
			
			ПоРаботнику = РегистрыСведений.РаботникиОрганизаций.СрезПервых(,Новый Структура("Сотрудник,Организация",СтрокиЗаработка[0].Сотрудник,СтрокиЗаработка[0].Организация)); 
			
			//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
			//Запрос = Новый Запрос;
			//Запрос.Текст = "ВЫБРАТЬ
			//|	ПриемНаРаботуВОрганизациюРаботникиОрганизации.ДатаПриема КАК ДатаПриема
			//|ИЗ
			//|	Документ.ПриемНаРаботуВОрганизацию.РаботникиОрганизации КАК ПриемНаРаботуВОрганизациюРаботникиОрганизации
			//|ГДЕ
			//|	ПриемНаРаботуВОрганизациюРаботникиОрганизации.Сотрудник = &ФизЛицо
			//|
			//|УПОРЯДОЧИТЬ ПО
			//|	ДатаПриема УБЫВ";
			//
			//Запрос.УстановитьПараметр("ФизЛицо", СтрокиЗаработка[0].Сотрудник);
			//
			//Результат = Запрос.Выполнить();
			//Выборка = Результат.Выбрать();
			//
			////+ СВЭЙ КДЯ 04.09.19 СВФР-004448
			//ДатаПриемаРаботника = Дата( 1, 1, 1 );
			//Сотрудник = СтрокиЗаработка[0].Сотрудник;
			////- СВЭЙ КДЯ 04.09.19 СВФР-004448
			//Если Выборка.Следующий() тогда
			//	ДатаПриемаРаботника = Выборка.ДатаПриема;
			//КонецЕсли;
			//- СВЭЙ КДЯ 05.09.19 СВФР-004448
			
			//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
			Сотрудник = СтрокиЗаработка[0].Сотрудник;
			ДатаПриемаРаботника = УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Сотрудник );
			//- СВЭЙ КДЯ 05.09.19 СВФР-004448
			
			//+ СВЭЙ КДЯ 04.09.19 СВФР-004448
			Если ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) 
				И ЗначениеЗаполнено( ДатаПриемаРаботника ) И ЗначениеЗаполнено( Регистратор.ДатаНачалаОсновногоОтпуска ) Тогда
				
				ОтработаноМеньше12Месяцев = 
				НачалоМесяца( Регистратор.ДатаНачалаОсновногоОтпуска ) <= НачалоМесяца( ДобавитьМесяц( ДатаПриемаРаботника, 12 ) );	
				Если ОтработаноМеньше12Месяцев Тогда
					
					СообщениеУвед = Нстр( "ru = '%Сотрудник принят%Окончание на работу %ДатаПриема, %Местоимение отработано менее 12 месяцев !'" );
					СообщениеУвед = СтрЗаменить( СообщениеУвед, "%Сотрудник", Сотрудник );
					СообщениеУвед = СтрЗаменить( СообщениеУвед, "%ДатаПриема", Формат( ДатаПриемаРаботника, "ДФ=""дд.ММ.гггг""" ) );
					Пол = Сотрудник.ФизЛицо.Пол;
					ЭтоЖенщина = ЗначениеЗаполнено( Пол ) И Пол = Перечисления.ПолФизическихЛиц.Женский;
					СтрОкончание = ?( ЭтоЖенщина, "а", "" );
					СообщениеУвед = СтрЗаменить( СообщениеУвед, "%Окончание", СтрОкончание );
					СтрМестоимение = ?( ЭтоЖенщина, "ею", "им" );
					СообщениеУвед = СтрЗаменить( СообщениеУвед, "%Местоимение", СтрМестоимение );
					Сообщить( СообщениеУвед, СтатусСообщения.Информация ); 
					
				КонецЕсли; 
				
			КонецЕсли;
			//- СВЭЙ КДЯ 04.09.19 СВФР-004448
			
			МесяцПриема = Месяц(ДатаПриемаРаботника);
			ГодПриема   = Год(ДатаПриемаРаботника);
			
			Если ПервыйГодВыборки = ГодПриема И ПервыйМесяцВыборки = МесяцПриема И День(ДатаПриемаРаботника)>0 тогда
				ПроверкаНаВРВГруппеРасчетов = СформироватьДанныеПоГрРасчетов(НачалоМесяца(ДатаПриемаРаботника), КонецМесяца(ДатаПриемаРаботника),Регистратор.Организация,Сотрудник);
				Если  Регистратор.Организация.НормаВОтпускахПоГрРасчетов Тогда //если первый месяц и нет в исключении, считаем полным
					Если ПроверкаНаВРВГруппеРасчетов Тогда	
						НоваяСтрока = ТаблицаПростоев.Добавить();
						НоваяСтрока.ВидРасчета = СтрокиЗаработка[0].ВидРасчета;
						НоваяСтрока.МесяцВыборки = СтрокиЗаработка[0].МесяцВыборки;
						НоваяСтрока.НаличиеПростоев = 1; 
					КонецЕсли;
				ИначеЕсли  СтрокиЗаработка[0].ОтработаноПоПятидневке < СтрокиЗаработка[0].НормаПоПятидневке   тогда
					НоваяСтрока = ТаблицаПростоев.Добавить();
					НоваяСтрока.ВидРасчета = СтрокиЗаработка[0].ВидРасчета;
					НоваяСтрока.МесяцВыборки = СтрокиЗаработка[0].МесяцВыборки;
					НоваяСтрока.НаличиеПростоев = 1;
				КонецЕсли;
			КонецЕсли;
			// уберем простои по классификатору
			Если не Пересчет Тогда
				ЗапросПР = Новый Запрос(
				"ВЫБРАТЬ
				|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
				|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
				|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени В(&Простои)
				|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &Период И &Период2");
				
				СписокПростоев = Новый Массив();
				СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Простой);
				СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ПростойПоВинеРаботодателя);
				СписокПростоев.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.НайтиПоНаименованию("Простой целосменный"));
				
				ЗапросПР.УстановитьПараметр("Простои", СписокПростоев);
				ЗапросПР.УстановитьПараметр("Сотрудник", СтрокиЗаработка[0].сотрудник);
				ЗапросПР.УстановитьПараметр("Период", НачалоМесяца(СтрокиЗаработка[0].ДатаНачалаРасчетногоПериода));
				ЗапросПР.УстановитьПараметр("Период2", КонецМесяца(СтрокиЗаработка[0].ДатаОкончанияРасчетногоПериода));	
				результат = ЗапросПР.Выполнить();
				
				если не результат.пустой() тогда
					выборка = результат.выбрать();
					пока выборка.следующий() цикл
						НоваяСтрока = ТаблицаПростоев.Добавить();
						НоваяСтрока.ВидРасчета = выборка.ВидРасчета;
						НоваяСтрока.МесяцВыборки = НачалоМесяца(выборка.ПериодДействияНачало);
						НоваяСтрока.НаличиеПростоев = 1;
					КонецЦикла;
				КонецЕсли;
				//простои конец
			КонецЕсли;
			Если таблицаПростоев.Количество() = СтрокиЗаработка.Количество() тогда
				//Нет ни одного полного месяца
				//Оставляем выборку для перерасчета до полных месяцев
			Иначе
				//Есть полностью отработанные месяцы
				//Удаляем из выборки неполные месяцы
				
				Для каждого СтрокаТаблицы из ТаблицаПростоев цикл
					СтруктураПоиска.МесяцВыборки = СтрокаТаблицы.МесяцВыборки;
					СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(СтруктураПоиска);
					Для каждого ПустаяСтрока из СтрокиКУдалению цикл
						
						Сообщить("Начисление отпуска №"+ Регистратор.Номер+ " "+ СокрЛП(ПустаяСтрока.ФизЛицо.Наименование));
						Сообщить("Месяц выборки "+ ПустаяСтрока.МесяцВыборки+" содержит простои или больничные листы. Проверьте правильность включения в расчет среднего");
						//ТаблицаЗаписей.Удалить(ПустаяСтрока);
						//Островская Татьяна 30.05.2014 № 17397
						если Пересчет Тогда 
							ОтборРег = Новый Структура;
							ОтборРег.Вставить("МесяцВыборки",СтрокаТаблицы.МесяцВыборки);
							ОтборРег.Вставить("ВидРасчета",СтрокаТаблицы.ВидРасчета);
							Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
							если Включать.Количество()> 0 Тогда 
								ПустаяСтрока.Включать = Включать[0].Включать;
							иначе
								ПустаяСтрока.Включать = Ложь;											
							КонецЕсли;
						иначе
							
							ПустаяСтрока.Включать = Ложь;
						КонецЕсли;
						//Островская Татьяна 30.05.2014 № 17397
					КонецЦикла;
				КонецЦикла;
				
			КонецЕсли;
			
			//Остальные месяцы считаются поностью отработанными
			Для каждого СтрокаТаблицы из ТаблицаЗаписей цикл
				//Островская Татьяна 27.05.2013 № 16494
				если Строкатаблицы.ОтработаноПоПятидневке < СтрокаТаблицы.НормаПоПятидневке Тогда 
					Строкатаблицы.ОтработаноПоПятидневке = СтрокаТаблицы.НормаПоПятидневке;
				КонецЕсли;
				//Островская Татьяна 27.05.2013 № 16494				
			КонецЦикла;
		КонецЕсли;
		//_________________________________________________________________________________________________________________________		
		// Расчет годовой премии для включения в выборку для среднего по отпуску в соответствии с п.18 глава 2 Инструкции о порядке
		// исчисления среднего заработка, сохраняемого в случаях, предусмотренных законодательством
		//_________________________________________________________________________________________________________________________		
		
		//Аверсон ЕАЕ 17.10.2022 СВФР-009668
		НеполныйМесяц = Ложь;
		
		Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И Регистратор.РасчетПриНеполныхМесяцах Тогда
			Для Каждого Стр Из ТаблицаЗаписей Цикл
				Стр.Включать = Истина;
			КонецЦикла;
		КонецЕсли;
		//Аверсон СВФР-009668
		
		СтрокиГодовойПремии = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии));
		Если СтрокиГодовойПремии.Количество()<> 0 тогда
			//Островская Татьяна 29.11.2013 № 16788
			если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") Тогда 
				ТаблицаКолСтрок = Новый ТаблицаЗначений;
				ТаблицаКолСтрок.Колонки.Добавить("ВидРасчета");
				ТаблицаКолСтрок.Колонки.Добавить("МесяцВыборки");
				ТаблицаКолСтрок.Колонки.Добавить("Включать");
				для Каждого СтрТЗ из ТаблицаЗаписей Цикл 
					СтрокаТаблицаКолСтрок = ТаблицаКолСтрок.Добавить();
					СтрокаТаблицаКолСтрок.ВидРасчета = СтрТЗ.ВидРасчета;
					СтрокаТаблицаКолСтрок.МесяцВыборки = СтрТЗ.МесяцВыборки;
					СтрокаТаблицаКолСтрок.Включать = СтрТЗ.Включать;
				КонецЦикла;
				
				ТаблицаКолСтрок.Свернуть("ВидРасчета,МесяцВыборки,Включать");
				
				//Аверсон ЕАЕ 17.10.2022 СВФР-009668
				//НеполныйМесяц = Ложь;
				Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда
					НеполныйМесяц = Регистратор.РасчетПриНеполныхМесяцах;	
				КонецЕсли;
				//СтрокиОсновногоЗаработка = ТаблицаКолСтрок.НайтиСтроки(Новый Структура("ВидРасчета,Включать", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск),Истина));
				СтрокиОсновногоЗаработка = ТаблицаКолСтрок.НайтиСтроки(Новый Структура("ВидРасчета,Включать", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)),Истина));
				//Аверсон СВФР-009668
				
			иначе
				СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			КонецЕсли;
			//Островская Татьяна 29.11.2013 № 16788
			
			Если СтрокиОсновногоЗаработка.Количество()<>0 тогда
				Для каждого СтрокаПремии из СтрокиГодовойПремии цикл
					Если СтрокаПремии.ЧислоМесяцев = СтрокаПремии.ПериодРасчетаСреднегоЗаработка тогда
						
						//Аверсон ЕАЕ 17.10.2022 СВФР-009668
						//СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
						СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)), СтрокаПремии.МесяцВыборки));
						//Аверсон СВФР-009668
						
						Если СтрокиЗаработка.Количество()<>0 тогда
							Если СтрокиосновногоЗаработка.Количество() <> СтрокаПремии.ЧислоМесяцев тогда
								//толик							СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии.Результат/СтрокаПремии.ЧислоМесяцев*СтрокиОсновногоЗаработка.Количество(),Константы.ВалютаРегламентированногоУчета.Получить());
								//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
								// корректировка осуществляется в другой части кода  стр. 15501 :   ОбъемВыборки > 0
								//СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии.РезультатДляПремии/?(СтрокаПремии.ЧислоМесяцев=0,1,СтрокаПремии.ЧислоМесяцев)*СтрокиОсновногоЗаработка.Количество(),Константы.ВалютаРегламентированногоУчета.Получить());
								//- СВЭЙ КДЯ 12.12.19 СВФР-004448
								//+ СВЭЙ КДЯ 12.12.19 СВФР-004448 +
								// корректировка осуществляется в другой части кода  стр. 15501 :   ОбъемВыборки > 0
								СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
								//- СВЭЙ КДЯ 12.12.19 СВФР-004448
								СтрокаПремии.Результат = 0;
								СтрокаПремии.РезультатДляПремии = 0;
								СтрокаПремии.ЧислоМесяцев = 1;
								//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
								//СтрокаПремии.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии.РезультатДляПремии/?(СтрокаПремии.ЧислоМесяцев=0,1,СтрокаПремии.ЧислоМесяцев)*СтрокиОсновногоЗаработка.Количество(),Константы.ВалютаРегламентированногоУчета.Получить());
								//- СВЭЙ КДЯ 12.12.19 СВФР-004448
							Иначе
								//толик							СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + СтрокаПремии.Результат;
								СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
								СтрокаПремии.Результат = 0;
								СтрокаПремии.РезультатДляПремии = 0;
								СтрокаПремии.ЧислоМесяцев = 1;
							КонецЕсли;
						Иначе
							СтрокаПремии.Результат = 0;
							СтрокаПремии.РезультатДляПремии = 0;
						Конецесли;
					Иначе
						
						//Аверсон ЕАЕ 17.10.2022 СВФР-009668
						//СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
						СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)), СтрокаПремии.МесяцВыборки));
						//Аверсон СВФР-009668
						
						Если СтрокиЗаработка.Количество()<>0 тогда
							СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
							//толик						СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + СтрокаПремии.Результат;
							
							//Аверсон ЕАЕ 10.01.2024 СВФР-012131
							//Чтобы сохранилась квартальная премия
							СтрокиЗаработка[0].РезультатДляПремии = СтрокиЗаработка[0].Результат;
							//Аверсон СВФР-012131
							
							СтрокаПремии.Результат = 0;
							СтрокаПремии.РезультатДляПремии = 0;
							СтрокаПремии.ЧислоМесяцев = 1;
						Иначе
							//нет заработка, бл целый  месяц есть квартальная месяц исчезнуть не должен
							Если СтрокаПремии.ДатаНачалаРасчетногоПериода <= СтрокаПремии.МесяцВыборки Тогда
								СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии), СтрокаПремии.МесяцВыборки));
								Если СтрокиЗаработка.Количество()<>0 тогда
									СтрокиЗаработка[0].Результат = СтрокаПремии.Результат;
									СтрокиЗаработка[0].ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
									СтрокиЗаработка[0].ЧислоМесяцев = 1;
								КонецЕсли;
							Иначе  
								СтрокаПремии.Результат = 0;
								СтрокаПремии.РезультатДляПремии = 0;
							КонецЕсли;
						Конецесли;
					Конецесли;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
		СтрокиГодовойПремии = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям));
		Если СтрокиГодовойПремии.Количество()<> 0 тогда
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			//СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск))));
			//Аверсон СВФР-009668
			
			Если СтрокиОсновногоЗаработка.Количество()<>0 тогда
				Для каждого СтрокаПремии из СтрокиГодовойПремии цикл
					
					//Аверсон ЕАЕ 17.10.2022 СВФР-009668
					//СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
					СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)), СтрокаПремии.МесяцВыборки));
					//Аверсон СВФР-009668
					
					Если СтрокиЗаработка.Количество()<>0 тогда
						//толик							СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + СтрокаПремии.Результат;
						СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
						СтрокаПремии.Результат = 0;
						СтрокаПремии.РезультатДляПремии = 0;
						СтрокаПремии.ЧислоМесяцев = 1;
					Иначе
						СтрокаПремии.Результат = 0;
						СтрокаПремии.РезультатДляПремии = 0;
					Конецесли;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
		СтрокиГодовойПремии = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям));
		Если СтрокиГодовойПремии.Количество()<> 0 тогда
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			//СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск))));
			//Аверсон СВФР-009668
			
			Если СтрокиОсновногоЗаработка.Количество()<>0 тогда
				Для каждого СтрокаПремии из СтрокиГодовойПремии цикл
					
					//Аверсон ЕАЕ 17.10.2022 СВФР-009668
					//СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
					СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)), СтрокаПремии.МесяцВыборки));
					//Аверсон СВФР-009668
					
					Если СтрокиЗаработка.Количество()<>0 тогда
						//толик							СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + СтрокаПремии.Результат;
						СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
						СтрокаПремии.Результат = 0;
						СтрокаПремии.РезультатДляПремии = 0;
						СтрокаПремии.ЧислоМесяцев = 1;
					Иначе
						СтрокаПремии.Результат = 0;
						СтрокаПремии.РезультатДляПремии = 0;
					Конецесли;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
		СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			ТаблицаЗаписей.Удалить(ПустаяСтрока);
		КонецЦикла;
		
	ИначеЕсли ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") тогда
		Если Регистратор.СпособРасчетаВЧасах Тогда
			ЧасыДок = 1;
		Иначе 
			ЧасыДок = 0;
		КонецЕсли;
		
		ЗапросВидРасчета.УстановитьПараметр("Сотрудник",Регистратор.Сотрудник);//Островская Татьяна 11.12.2013 № 16971
		СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			Если  ПустаяСтрока.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ Тогда
				Если ПустаяСтрока.ОтработаноДней = 0 Тогда
					ТаблицаЗаписей.Удалить(ПустаяСтрока);
				КонецЕсли;	
			Иначе	
				ТаблицаЗаписей.Удалить(ПустаяСтрока);
			КонецЕсли; 
		КонецЦикла;
		
		//_________________________________________________________________________________________________________________________		
		// Расчет годовой премии для включения в выборку для среднего по отпуску в соответствии с п.32 Положения о порядке
		// обеспечения пособиями по временной нетрудоспособности и по беременности и родам
		//_________________________________________________________________________________________________________________________		
		//Проверить премии   
		если не УсловиеДляБПМ Тогда
			СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии));
			Если СтрокиГодовой.Количество()<>0 тогда
				Для каждого СтрокиПр из СтрокиГодовой цикл
					//СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ, СтрокиПр.МесяцВыборки));
					мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокиПр.МесяцВыборки), КонецМесяца(СтрокиПр.МесяцВыборки), СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация.ЗаполнениеТабелейСУчетомСтавки);//О.Т. 01.06.2015 № 
					Отбор = Новый Структура;
					Отбор.Вставить("МесяцВыборки",СтрокиПр.МесяцВыборки);
					СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(Отбор);
					//Островская Татьяна 11.12.2013 № 16971
					ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокиПр.МесяцВыборки);
					ВидУчетаВремени = Неопределено;
					РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
					если РезультВидУчета.Количество() > 0 Тогда 
						ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
					КонецЕсли;
					//Островская Татьяна 11.12.2013 № 16971
					Если СтрокиВремени.Количество()>0 тогда
						СтрокиВремени = СтрокиВремени[0];					
						//толик часы					НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
						//					ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
						//Островская Татьяна 09.12.2013
						если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и ЧасыДок=0 Тогда 
							НормаПоГр = мНорма.НормаДней;
							ОтрабПоГр = СтрокиВремени.ОтработаноДней;
							
						иначе
							
							НормаПоГр = мНорма.НормаЧасов;
							ОтрабПоГр = СтрокиВремени.ОтработаноЧасов;
						КонецЕсли;
						//Островская Татьяна 09.12.2013
						//О.Т. Аверсон 04.01.2016 № 815
						Если Регистратор.СпособРасчетаВДнях и не Регистратор.СпособРасчетаВЧасах Тогда 
							НормаПоГр = мНорма.НормаДней;
							ОтрабПоГр = СтрокиВремени.ОтработаноДней;
						КонецЕсли;
						//О.Т. Аверсон 04.01.2016 № 815
						
						//толик
						//добавил ограничение согласно разъяснению п.28 
						//					СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ОтрабПоГр/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						СтрокиПр.ЧислоМесяцев = 1;
					Иначе
						СтрокиПр.Результат = 0;
					КонецЕсли;
				Конеццикла;
			КонецЕсли;
			
			СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям));
			Если СтрокиГодовой.Количество()<>0 тогда
				Для каждого СтрокиПр из СтрокиГодовой цикл
					//СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ, СтрокиПр.МесяцВыборки));
					
					//+ СВЭЙ КДЯ 09.01.20 СВФР-005273
					УчитыватьСтавку = ( ТипЗнч(  СтрокаДвижений.Регистратор ) 
					= Тип( "ДокументСсылка.НачислениеПоБольничномуЛисту" ) 
					И СтрокаДвижений.Регистратор.УчитыватьСтавку );
					//- СВЭЙ КДЯ 09.01.20 СВФР-005273
					
					//Аверсон ЕАЕ 10.02.2021 СВФР-007115
					НормаИзГрафика = (ТипЗнч(СтрокаДвижений.Регистратор) 
					= Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") 
					И СтрокаДвижений.Регистратор.НормаИзГрафика);
					//Аверсон
					
					мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(
					НачалоМесяца( СтрокиПр.МесяцВыборки ), 
					КонецМесяца( СтрокиПр.МесяцВыборки ), 
					СтрокаДвижений.Сотрудник,
					СтрокаДвижений.Организация.ЗаполнениеТабелейСУчетомСтавки
					//+ СВЭЙ КДЯ 09.01.20 СВФР-005273
					ИЛИ УчитыватьСтавку 
					//- СВЭЙ КДЯ 09.01.20 СВФР-005273
					
					//Аверсон ЕАЕ 10.02.2021 СВФР-007115
					,,
					НормаИзГрафика
					//Аверсон
					); //О.Т. 01.06.2015 №
					
					Отбор = Новый Структура;
					Отбор.Вставить("МесяцВыборки",СтрокиПр.МесяцВыборки);
					СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(Отбор);
					//Островская Татьяна 11.12.2013 № 16971
					ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокиПр.МесяцВыборки);
					ВидУчетаВремени = Неопределено;
					РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
					если РезультВидУчета.Количество() > 0 Тогда 
						ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
					КонецЕсли;
					//Островская Татьяна 11.12.2013 № 16971
					Если СтрокиВремени.Количество()>0 тогда
						СтрокиВремени = СтрокиВремени[0];
						//Если СтрокиПр.БПНачало < СтрокиПр.МесяцВыборки И СтрокиПр.БПКонец < СтрокиПр.МесяцВыборки тогда //Островская Татьяна 09.12.2013(не проходило условие, не просчитывало результат пропорционально)
						//толик часы						НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
						//						ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
						//Островская Татьяна 09.12.2013
						если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и ЧасыДок = 0 Тогда 
							НормаПоГр = мНорма.НормаДней;
							ОтрабПоГр = СтрокиВремени.ОтработаноДней;
							
						иначе
							
							НормаПоГр = мНорма.НормаЧасов;
							ОтрабПоГр = СтрокиВремени.ОтработаноЧасов;
						КонецЕсли;
						//Островская Татьяна 09.12.2013
						//О.Т. Аверсон 04.01.2016 № 815
						Если Регистратор.СпособРасчетаВДнях и не Регистратор.СпособРасчетаВЧасах Тогда 
							НормаПоГр = мНорма.НормаДней;
							ОтрабПоГр = СтрокиВремени.ОтработаноДней;
						КонецЕсли;
						//О.Т. Аверсон 04.01.2016 № 815
						
						//О.Т. Аверсон 06.12.2017 № 1330
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОплаченоДней) КАК ОплаченоДней,
						|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОплаченоДнейЧасов) КАК ОплаченоДнейЧасов
						|ИЗ
						|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
						|ГДЕ
						|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &ПериодВыборки И &ПериодВыборки1
						|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)";
						
						СписокВидРасчета = Новый СписокЗначений;
						ГруппаРасчетовБЛПремия = Справочники.ГруппыРасчетов.ВключениеРабочегоВремениДляБЛДляРасчетаПремии;    
						для Каждого СтрДляПремии из ГруппаРасчетовБЛПремия.Основные Цикл 
							СписокВидРасчета.Добавить(СтрДляПремии.ВидРасчета);
						КонецЦикла;
						
						Запрос.УстановитьПараметр("ВидРасчета", СписокВидРасчета);
						Запрос.УстановитьПараметр("ПериодВыборки", НачалоМесяца(СтрокиПр.МесяцВыборки));
						Запрос.УстановитьПараметр("ПериодВыборки1", КонецМесяца(СтрокиПр.МесяцВыборки));
						Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
						
						РезДляПремии = Запрос.Выполнить().Выбрать();
						ДопДни = 0;
						ДопЧасы = 0;
						Пока РезДляПремии.Следующий() Цикл
							ДопДни = ДопДни + ?(РезДляПремии.ОплаченоДней = Null,0,РезДляПремии.ОплаченоДней);
							ДопЧасы = ДопЧасы + ?(РезДляПремии.ОплаченоДнейЧасов = Null,0,РезДляПремии.ОплаченоДнейЧасов);
						КонецЦикла;
						
						если (ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням и ЧасыДок = 0) или
							Регистратор.СпособРасчетаВДнях и не Регистратор.СпособРасчетаВЧасах Тогда 
							
							ОтрабПоГр = ОтрабПоГр + ДопДни;
							
						иначе
							ОтрабПоГр = ОтрабПоГр + ДопЧасы;
						КонецЕсли;
						//О.Т. Аверсон 06.12.2017 № 1330
						Если Не ЗначениеЗаполнено(НормаПоГр) ТОгда //СМА СВФР-007810
							НормаПоГр = 0;
							СтрокиПр.Результат  = 0;
						Иначе
							//						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ОтрабПоГр/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
							СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						КонецЕсли;
						СтрокиПр.ЧислоМесяцев = 1;
						//Иначе
						//	СтрокиПр.ЧислоМесяцев = 1;
						//КонецЕсли;
					Иначе
						//толик -- нет заработка нет премии
						СтрокиПр.Результат = 0;
					КонецЕсли;
				Конеццикла;
			КонецЕсли;
			
			СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям));
			Если СтрокиГодовой.Количество()<>0 тогда
				Для каждого СтрокиПр из СтрокиГодовой цикл
					//СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ, СтрокиПр.МесяцВыборки));
					мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(СтрокиПр.МесяцВыборки), КонецМесяца(СтрокиПр.МесяцВыборки), СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация.ЗаполнениеТабелейСУчетомСтавки);//О.Т. 01.06.2015 № 
					Отбор = Новый Структура;
					Отбор.Вставить("МесяцВыборки",СтрокиПр.МесяцВыборки);
					СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(Отбор);
					//Островская Татьяна 11.12.2013 № 16971
					ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокиПр.МесяцВыборки);
					ВидУчетаВремени = Неопределено;
					РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
					если РезультВидУчета.Количество() > 0 Тогда 
						ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
					КонецЕсли;
					//Островская Татьяна 11.12.2013 № 16971
					Если СтрокиВремени.Количество()>0 тогда
						СтрокиВремени = СтрокиВремени[0];
						
						//Если СтрокиПр.БПНачало < СтрокиПр.МесяцВыборки и СтрокиПр.БПКонец< СтрокиПр.МесяцВыборки тогда //Островская Татьяна 09.12.2013(не проходило условие, не просчитывало результат пропорционально)
						//толик часы						НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
						//						ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
						//Островская Татьяна 09.12.2013
						если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням  и ЧасыДок=0 Тогда 
							НормаПоГр = мНорма.НормаДней;
							ОтрабПоГр = СтрокиВремени.ОтработаноДней;
							
						иначе
							
							НормаПоГр = мНорма.НормаЧасов;
							ОтрабПоГр = СтрокиВремени.ОтработаноЧасов;
						КонецЕсли;
						//Островская Татьяна 09.12.2013
						//О.Т. Аверсон 04.01.2016 № 815
						Если Регистратор.СпособРасчетаВДнях и не Регистратор.СпособРасчетаВЧасах Тогда 
							НормаПоГр = мНорма.НормаДней;
							ОтрабПоГр = СтрокиВремени.ОтработаноДней;
						КонецЕсли;
						//О.Т. Аверсон 04.01.2016 № 815
						
						//толик						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ОтрабПоГр/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						СтрокиПр.ЧислоМесяцев = 1;
						//Иначе
						//	СтрокиПр.ЧислоМесяцев = 1;
						//КонецЕсли;
					Иначе
						//толик -- нет заработка нет премии
						СтрокиПр.Результат = 0;
					КонецЕсли;
				Конеццикла;
			КонецЕсли;
		КонецЕсли;
		ТаблицаЗаписей.Сортировать("МесяцВыборки");//мое
		СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			
			Если  Не ПустаяСтрока.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ Тогда
				ТаблицаЗаписей.Удалить(ПустаяСтрока);
			КонецЕсли; 
			
		КонецЦикла;
		
		
		ДатаНачалаСобытия = ?(НЕ ЗначениеЗаполнено(Регистратор.ПервичныйБольничныйЛист), Регистратор.ДатаНачала, Регистратор.ПервичныйБольничныйлист.ДатаНачала);
		ПервыйМесяцДляРасчетаСреднего = НачалоМесяца(ДобавитьМесяц(ДатаНачалаСобытия, -1));
		ВторойМесяцДляРасчетаСреднего = НачалоМесяца(ДобавитьМесяц(ПервыйМесяцДляРасчетаСреднего, -1));
		ТретийМесяцДляРасчетаСреднего = НачалоМесяца(ДобавитьМесяц(ВторойМесяцДляРасчетаСреднего, -1));
		ЧетвертыйМесяцДляРасчетаСреднего = НачалоМесяца(ДобавитьМесяц(ТретийМесяцДляРасчетаСреднего, -1));
		
		СтрокиПервогоМесяца = ТаблицаЗаписей.НайтиСтроки(Новый Структура("МесяцВыборки", ПервыйМесяцДляРасчетаСреднего));
		СтрокиВторогоМесяца = ТаблицаЗаписей.НайтиСтроки(Новый Структура("МесяцВыборки", ВторойМесяцДляРасчетаСреднего));
		Если СтрокиПервогоМесяца.Количество() <> 0 ИЛИ СтрокиВторогоМесяца.Количество() <> 0 тогда
			//Есть заработок в первые два месяца предшествующие началу болезни
			РасчетВозможен = Истина;
			Для каждого СтрокаВыборки из СтрокиПервогоМесяца цикл
				Если СтрокаВыборки.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ тогда
					//толик убрал					РасчетВозможен = СтрокаВыборки.КоэффициентИндексации = 1 и (СтрокаВыборки.ОтработаноДней <> 0 или СтрокаВыборки.ОтработаноЧасов <> 0);
				КонецЕсли;
			Конеццикла;
			
			ВторойВходит = Истина;
			Если РасчетВозможен тогда
				Для каждого СтрокаВыборки из СтрокиВторогоМесяца цикл
					Если СтрокаВыборки.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ тогда
						//толик	убрал					ВторойВходит = СтрокаВыборки.КоэффициентИндексации = 1 и (СтрокаВыборки.ОтработаноДней <> 0 или СтрокаВыборки.ОтработаноЧасов <> 0);
						//						ВторойВходит = (СтрокаВыборки.ОтработаноДней <> 0 или СтрокаВыборки.ОтработаноЧасов <> 0);
					КонецЕсли;
				Конеццикла;
			КонецЕсли;
			
			Если расчетВозможен и ВторойВходит тогда
			ИначеЕсли РасчетВозможен и Не второйВходит тогда
				Сообщить("Для расчета возможно выбрать только один месяц");
				Для Каждого ПустаяСтрока из СтрокиВторогоМесяца Цикл
					ТаблицаЗаписей.Удалить(ПустаяСтрока);
				КонецЦикла;
			Иначе
				Сообщить("Для расчета возможно учесть только премии двух месяцев предшествующих больничному");
				Сообщить("Расчет по тарифной ставке первого месяца больничного");
				
				Запрос = Новый Запрос;
				Запрос.Текст = "ВЫБРАТЬ
				|	СУММА(РегламентированныйПроизводственныйКалендарь.Пятидневка) КАК НормаДней
				|ИЗ
				|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
				|ГДЕ
				|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря <= КОНЕЦПЕРИОДА(&ДатаНачалаСобытия, МЕСЯЦ)
				|			И РегламентированныйПроизводственныйКалендарь.ДатаКалендаря >= НАЧАЛОПЕРИОДА(&ДатаНачалаСобытия, МЕСЯЦ)";
				
				Запрос.УстановитьПараметр("ДатаНачалаСобытия", ДатаНачалаСобытия);
				
				Результат = Запрос.Выполнить();
				Выборка = Результат.Выбрать();
				Выборка.Следующий();
				
				СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ));
				Если СтрокиОсновногоЗаработка.Количество() > 0 тогда
					СтрокаТекущая = СтрокиОсновногоЗаработка[0];
					СтрокаТекущая.Результат = СтрокаТекущая.ТекущаяТарифнаяСтавка;
					Строкатекущая.ТарифнаяСтавкаПериода = СтрокаТекущая.ТекущаяТарифнаяСтавка;
					СтрокаТекущая.ОтработаноПоПятидневке = Выборка.НормаДней;
					СтрокаТекущая.ОтработаноДней = Выборка.НормаДней;
					СтрокаТекущая.ОтработаноЧасов = Выборка.НормаДней * 8;
					СтрокаТекущая.НормаПоПятидневке = Выборка.НормаДней;
					СтрокаТекущая.МесяцВыборки = Началомесяца(ДатаНачалаСобытия);
					СтрокаТекущая.КоэффициентИндексации = 1;
				КонецЕсли;
				Для тт =1 по СтрокиОсновногоЗаработка.Количество() - 1 Цикл
					ТаблицаЗаписей.Удалить(СтрокиОсновногоЗаработка[тт]);
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
	ИначеЕсли ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")
		//+ СВЭЙ КДЯ 17.02.20 СВФР-005492
		И НЕ Регистратор.ВклПремииПропорциональноОтрабВр
		//- СВЭЙ КДЯ 17.02.20 СВФР-005492
		тогда
		ЗапросВидРасчета.УстановитьПараметр("Сотрудник",Регистратор.Сотрудник);
		СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			ТаблицаЗаписей.Удалить(ПустаяСтрока);
		КонецЦикла;
		
		СтруктураПоиска = Новый Структура("МесяцВыборки");
		//Проанализировать простои
		СтрокиЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
		
		Если СтрокиЗаработка.Количество() <> 0 тогда
			ПервыйМесяцВыборки = Месяц(СтрокиЗаработка[0].МесяцВыборки);
			ПервыйГодВыборки   = Год(СтрокиЗаработка[0].МесяцВыборки);
			
			ПоРаботнику = РегистрыСведений.РаботникиОрганизаций.СрезПервых(,Новый Структура("Сотрудник,Организация",СтрокиЗаработка[0].Сотрудник,СтрокиЗаработка[0].Организация)); 
			
			//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
			//Запрос = Новый Запрос;
			//Запрос.Текст = "ВЫБРАТЬ
			//|	ПриемНаРаботуВОрганизациюРаботникиОрганизации.ДатаПриема КАК ДатаПриема
			//|ИЗ
			//|	Документ.ПриемНаРаботуВОрганизацию.РаботникиОрганизации КАК ПриемНаРаботуВОрганизациюРаботникиОрганизации
			//|ГДЕ
			//|	ПриемНаРаботуВОрганизациюРаботникиОрганизации.Сотрудник = &ФизЛицо
			//|
			//|УПОРЯДОЧИТЬ ПО
			//|	ДатаПриема УБЫВ";
			//
			//Запрос.УстановитьПараметр("ФизЛицо", СтрокиЗаработка[0].Сотрудник);
			//
			//Результат = Запрос.Выполнить();
			//Выборка = Результат.Выбрать();
			//
			//Если Выборка.Следующий() тогда
			//	ДатаПриемаРаботника = Выборка.ДатаПриема;
			//КонецЕсли;
			//- СВЭЙ КДЯ 05.09.19 СВФР-004448
			
			//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
			Сотрудник = СтрокиЗаработка[0].Сотрудник;
			ДатаПриемаРаботника = УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Сотрудник );
			//- СВЭЙ КДЯ 05.09.19 СВФР-004448
			
			
			МесяцПриема = Месяц(ДатаПриемаРаботника);
			ГодПриема   = Год(ДатаПриемаРаботника);
			
			Если ПервыйГодВыборки = ГодПриема И ПервыйМесяцВыборки = МесяцПриема И День(ДатаПриемаРаботника)>0 тогда
				Если  СтрокиЗаработка[0].ОтработаноПоПятидневке < СтрокиЗаработка[0].НормаПоПятидневке тогда
					НоваяСтрока = ТаблицаПростоев.Добавить();
					НоваяСтрока.ВидРасчета = СтрокиЗаработка[0].ВидРасчета;
					НоваяСтрока.МесяцВыборки = СтрокиЗаработка[0].МесяцВыборки;
					НоваяСтрока.НаличиеПростоев = 1;
				КонецЕсли;
			КонецЕсли;
			
			Если таблицаПростоев.Количество() = СтрокиЗаработка.Количество() тогда
				//Нет ни одного полного месяца
				//Оставляем выборку для перерасчета до полных месяцев
			Иначе
				//Есть полностью отработанные месяцы
				//Удаляем из выборки неполные месяцы
				
				Для каждого СтрокаТаблицы из ТаблицаПростоев цикл
					СтруктураПоиска.МесяцВыборки = СтрокаТаблицы.МесяцВыборки;
					СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(СтруктураПоиска);
					Для каждого ПустаяСтрока из СтрокиКУдалению цикл
						//						ТаблицаЗаписей.Удалить(ПустаяСтрока);
						Сообщить("Начисление отпуска №"+ Регистратор.Номер+ " "+ СокрЛП(ПустаяСтрока.ФизЛицо.Наименование));
						Сообщить("Месяц выборки "+ ПустаяСтрока.МесяцВыборки+" содержит простои или больничные листы. Проверьте правильность включения в расчет среднего");
						
						если Пересчет Тогда 
							ОтборРег = Новый Структура;
							ОтборРег.Вставить("МесяцВыборки",СтрокаТаблицы.МесяцВыборки);
							ОтборРег.Вставить("ВидРасчета",СтрокаТаблицы.ВидРасчета);
							Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
							если Включать.Количество()> 0 Тогда 
								ПустаяСтрока.Включать = Включать[0].Включать;
							иначе
								ПустаяСтрока.Включать = Ложь;											
							КонецЕсли;
						иначе
							
							ПустаяСтрока.Включать = Ложь;
						КонецЕсли;
					КонецЦикла;
				КонецЦикла;
				
			КонецЕсли;
			
			//Остальные месяцы считаются поностью отработанными
			Для каждого СтрокаТаблицы из ТаблицаЗаписей цикл
				//Островская Татьяна 27.05.2013 № 16494
				если Строкатаблицы.ОтработаноПоПятидневке < СтрокаТаблицы.НормаПоПятидневке Тогда 
					Строкатаблицы.ОтработаноПоПятидневке = СтрокаТаблицы.НормаПоПятидневке;
				КонецЕсли;
				//Островская Татьяна 27.05.2013 № 16494
			КонецЦикла;
		КонецЕсли;
		//_________________________________________________________________________________________________________________________		
		// Расчет годовой премии для включения в выборку для среднего по отпуску в соответствии с п.18 глава 2 Инструкции о порядке
		// исчисления среднего заработка, сохраняемого в случаях, предусмотренных законодательством
		//_________________________________________________________________________________________________________________________		
		
		СтрокиГодовойПремии = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,СпособРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии, Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням));
		Если СтрокиГодовойПремии.Количество()<> 0 тогда
			//Островская Татьяна 09.12.2013
			ТаблицаКолСтрок = Новый ТаблицаЗначений;
			ТаблицаКолСтрок.Колонки.Добавить("ВидРасчета");
			ТаблицаКолСтрок.Колонки.Добавить("МесяцВыборки");
			ТаблицаКолСтрок.Колонки.Добавить("Включать");
			для Каждого СтрТЗ из ТаблицаЗаписей Цикл 
				СтрокаТаблицаКолСтрок = ТаблицаКолСтрок.Добавить();
				СтрокаТаблицаКолСтрок.ВидРасчета = СтрТЗ.ВидРасчета;
				СтрокаТаблицаКолСтрок.МесяцВыборки = СтрТЗ.МесяцВыборки;
				СтрокаТаблицаКолСтрок.Включать = СтрТЗ.Включать;
			КонецЦикла;
			//Островская Татьяна 09.12.2013
			ТаблицаКолСтрок.Свернуть("ВидРасчета,МесяцВыборки,Включать");
			СтрокиОсновногоЗаработка = ТаблицаКолСтрок.НайтиСтроки(Новый Структура("ВидРасчета,Включать", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск),Истина));
			
			//СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск));
			Если СтрокиОсновногоЗаработка.Количество()<>0 тогда
				Для каждого СтрокаПремии из СтрокиГодовойПремии цикл
					Если СтрокаПремии.ЧислоМесяцев = СтрокаПремии.ПериодРасчетаСреднегоЗаработка тогда
						СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки",?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент, ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
						Если СтрокиЗаработка.Количество()<>0 тогда
							Если СтрокиосновногоЗаработка.Количество() <> СтрокаПремии.ЧислоМесяцев тогда
								//толик								СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии.Результат/СтрокаПремии.ЧислоМесяцев*СтрокиОсновногоЗаработка.Количество(),Константы.ВалютаРегламентированногоУчета.Получить());
								//+ СВЭЙ КДЯ 12.12.19 СВФР-004448
								// корректировка осуществляется в другой части кода  стр. 15501 :   ОбъемВыборки > 0
								//СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].Результат + ОбщегоНазначения.ОкруглитьПоВалюте(СтрокаПремии.Результат/?(СтрокаПремии.ЧислоМесяцев=0,1,СтрокаПремии.ЧислоМесяцев)*СтрокиОсновногоЗаработка.Количество(),Константы.ВалютаРегламентированногоУчета.Получить());
								//- СВЭЙ КДЯ 12.12.19 СВФР-004448
								//+ СВЭЙ КДЯ 12.12.19 СВФР-004448 +
								// корректировка осуществляется в другой части кода  стр. 15501 :   ОбъемВыборки > 0
								
								//Аверсон ЕАЕ 23.11.2021 СВФР-008387
								//СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].Результат + СтрокаПремии.Результат;
								СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
								СтрокаПремии.РезультатДляПремии = 0;
								//Аверсон СВФР-008387
								
								//- СВЭЙ КДЯ 12.12.19 СВФР-004448
								СтрокаПремии.Результат = 0;
								СтрокаПремии.ЧислоМесяцев = 1;
							Иначе
								//толик								СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + СтрокаПремии.Результат;
								
								//Аверсон ЕАЕ 23.11.2021 СВФР-008387
								//СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].Результат + СтрокаПремии.Результат;
								СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
								СтрокаПремии.РезультатДляПремии = 0;
								//Аверсон СВФР-008387
								
								СтрокаПремии.Результат = 0;
								СтрокаПремии.ЧислоМесяцев = 1;
							КонецЕсли;
						Иначе
							СтрокаПремии.Результат = 0;
						Конецесли;
					Иначе
						СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
						Если СтрокиЗаработка.Количество()<>0 тогда
							//толик							СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + СтрокаПремии.Результат;
							
							//Аверсон ЕАЕ 23.11.2021 СВФР-008387
							//СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].Результат + СтрокаПремии.Результат;
							СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
							СтрокаПремии.РезультатДляПремии = 0;
							//Аверсон СВФР-008387
							
							СтрокаПремии.Результат = 0;
							СтрокаПремии.ЧислоМесяцев = 1;
						Иначе
							//Аверсон ЕАЕ 23.11.2021 СВФР-008387
							СтрокаПремии.РезультатДляПремии = 0;
							//Аверсон СВФР-008387
							
							СтрокаПремии.Результат = 0;
						Конецесли;
					Конецесли;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
		СтрокиГодовойПремии = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,СпособРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям,Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням));
		Если СтрокиГодовойПремии.Количество()<> 0 тогда
			СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			Если СтрокиОсновногоЗаработка.Количество()<>0 тогда
				Для каждого СтрокаПремии из СтрокиГодовойПремии цикл
					СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
					Если СтрокиЗаработка.Количество()<>0 тогда
						//толик							СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + СтрокаПремии.Результат;
						
						//Аверсон ЕАЕ 23.11.2021 СВФР-008387
						//СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].Результат + СтрокаПремии.Результат;
						СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
						СтрокаПремии.РезультатДляПремии = 0;
						//Аверсон СВФР-008387
						
						СтрокаПремии.Результат = 0;
						СтрокаПремии.ЧислоМесяцев = 1;
					Иначе
						//Аверсон ЕАЕ 23.11.2021 СВФР-008387
						СтрокаПремии.РезультатДляПремии = 0;
						//Аверсон СВФР-008387
						
						СтрокаПремии.Результат = 0;
					Конецесли;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
		СтрокиГодовойПремии = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,СпособРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям,Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням));
		Если СтрокиГодовойПремии.Количество()<> 0 тогда
			СтрокиОсновногоЗаработка = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			Если СтрокиОсновногоЗаработка.Количество()<>0 тогда
				Для каждого СтрокаПремии из СтрокиГодовойПремии цикл
					СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
					Если СтрокиЗаработка.Количество()<>0 тогда
						//толик							СтрокиЗаработка[0].Результат = СтрокиОсновногоЗаработка[0].Результат + СтрокаПремии.Результат;
						
						//Аверсон ЕАЕ 23.11.2021 СВФР-008387
						//СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].Результат + СтрокаПремии.Результат;
						СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
						СтрокаПремии.РезультатДляПремии = 0;
						//Аверсон СВФР-008387
						
						СтрокаПремии.Результат = 0;
						СтрокаПремии.ЧислоМесяцев = 1;
					Иначе
						//Аверсон ЕАЕ 23.11.2021 СВФР-008387
						СтрокаПремии.РезультатДляПремии = 0;
						//Аверсон СВФР-008387
						
						СтрокаПремии.Результат = 0;
					Конецесли;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
		//_________________________________________________________________________________________________________________________		
		// Расчет годовой премии для включения в выборку для среднего по отпуску в соответствии с п.28 глава 3 Инструкции о порядке
		// исчисления среднего заработка, сохраняемого в случаях, предусмотренных законодательством
		//_________________________________________________________________________________________________________________________		
		
		СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,СпособРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям,Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку));
		Если СтрокиГодовой.Количество()<>0 тогда
			Для каждого СтрокиПр из СтрокиГодовой цикл
				СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку, СтрокиПр.МесяцВыборки));
				//Островская Татьяна 11.12.2013 № 16971
				ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокиПр.МесяцВыборки);
				ВидУчетаВремени = Неопределено;
				РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
				если РезультВидУчета.Количество() > 0 Тогда 
					ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
				КонецЕсли;
				//Островская Татьяна 11.12.2013 № 16971
				Если СтрокиЗаработка.Количество()<>0 тогда
					//Если СтрокиПр.БПНачало < СтрокиПр.МесяцВыборки и СтрокиПр.БПКонец< СтрокиПр.МесяцВыборки тогда //Островская Татьяна 09.12.2013(не проходило условие, не просчитывало результат пропорционально)
					//толик часы						НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
					//						ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
					//Островская Татьяна 09.12.2013
					если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда 
						НормаПоГр = СтрокиЗаработка[0].НормаДней;
						ОтрабПоГр = СтрокиЗаработка[0].ОтработаноДней;
						
					иначе
						
						НормаПоГр = ?(СтрокиЗаработка[0].НормаЧасов=0, ?(СтрокиЗаработка[0].НормаДней = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаДней),СтрокиЗаработка[0].НормаЧасов);
						ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноЧасов=0, ?(СтрокиЗаработка[0].ОтработаноДней=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноДней),СтрокиЗаработка[0].ОтработаноЧасов);
					КонецЕсли;
					//Островская Татьяна 09.12.2013
					СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
					СтрокиПр.ЧислоМесяцев = 1;
					//Иначе
					//	СтрокиПр.ЧислоМесяцев = 1;
					//КонецЕсли;
				Иначе
					//толик
					СтрокаПремии.Результат = 0;
				КонецЕсли;
			Конеццикла;
		КонецЕсли;
		
		СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,СпособРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям,Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку));
		Если СтрокиГодовой.Количество()<>0 тогда
			Для каждого СтрокиПр из СтрокиГодовой цикл
				СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку, СтрокиПр.МесяцВыборки));
				//Островская Татьяна 11.12.2013 № 16971
				ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокиПр.МесяцВыборки);
				ВидУчетаВремени = Неопределено;
				РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
				если РезультВидУчета.Количество() > 0 Тогда 
					ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
				КонецЕсли;
				//Островская Татьяна 11.12.2013 № 16971
				Если СтрокиЗаработка.Количество()<>0 тогда
					//Если СтрокиПр.БПНачало < СтрокиПр.МесяцВыборки и СтрокиПр.БПКонец< СтрокиПр.МесяцВыборки тогда //Островская Татьяна 09.12.2013(не проходило условие, не просчитывало результат пропорционально)
					//толик часы						НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
					//						ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
					//Островская Татьяна 09.12.2013
					если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда 
						НормаПоГр = СтрокиЗаработка[0].НормаДней;
						ОтрабПоГр = СтрокиЗаработка[0].ОтработаноДней;
						
					иначе
						
						НормаПоГр = ?(СтрокиЗаработка[0].НормаЧасов=0, ?(СтрокиЗаработка[0].НормаДней = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаДней),СтрокиЗаработка[0].НормаЧасов);
						ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноЧасов=0, ?(СтрокиЗаработка[0].ОтработаноДней=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноДней),СтрокиЗаработка[0].ОтработаноЧасов);
					КонецЕсли;
					//Островская Татьяна 09.12.2013
					СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
					//						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ОтрабПоГр/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
					СтрокиПр.ЧислоМесяцев = 1;
					//Иначе
					//	СтрокиПр.ЧислоМесяцев = 1;
					//КонецЕсли;
				Иначе
					//толик
					СтрокаПремии.Результат = 0;
				КонецЕсли;
			Конеццикла;
		КонецЕсли;
		
		СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,СпособРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии,Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку));
		Если СтрокиГодовой.Количество()<>0 тогда
			Для каждого СтрокиПр из СтрокиГодовой цикл
				Если СтрокиПр.ЧислоМесяцев=1 тогда
					Сообщить("В премии, выплачиваемые за период включен вид расчета за 1 месяц. Исправьте базовые виды расчетов дл ярасчета среднего");
				Иначе
					
					//Определим период в который включается премия
					Если СтрокиПр.ЧислоМесяцев = 12 тогда
						//О.Т. Аверсон 02.03.2016 № 932
						
						//Д1 = НачалоГода(СтрокиПр.МесяцВыборки);
						//Д2 = КонецГода(СтрокиПр.МесяцВыборки);
						Д1 = НачалоМесяца(СтрокиПр.МесяцВыборки);
						Д2 = ДобавитьМесяц(НачалоМесяца(СтрокиПр.МесяцВыборки),12)-1;
						//О.Т. Аверсон 02.03.2016 № 932
					ИначеЕсли СтрокиПр.ЧислоМесяцев = 6 тогда
						//О.Т. Аверсон 02.03.2016 № 932
						//Если Месяц(СтрокиПр.МесяцВыборки)<=6 тогда
						//	Д1 = НачалоГода(СтрокиПр.Месяцвыборки);
						//	д2 = Дата(Год(СтрокиПр.МесяцВыборки),6,30);
						//Иначе
						//	Д1 = Дата(Год(СтрокиПр.МесяцВыборки),7,1);
						//	д2 = Конецгода(СтрокиПр.МесяцВыборки);
						//КонецЕсли;
						Д1 = НачалоМесяца(СтрокиПр.МесяцВыборки);
						Д2 = ДобавитьМесяц(НачалоМесяца(СтрокиПр.МесяцВыборки),6)-1;
						//О.Т. Аверсон 02.03.2016 № 932
					ИначеЕсли СтрокиПр.ЧислоМесяцев = 3 тогда
						//О.Т. Аверсон 02.03.2016 № 932
						//Д1 = НачалоКвартала(СтрокиПр.Месяцвыборки);
						//Д2 = КонецКвартала(СтрокиПр.МесяцВыборки);
						Д1 = НачалоМесяца(СтрокиПр.МесяцВыборки);
						Д2 = ДобавитьМесяц(НачалоМесяца(СтрокиПр.МесяцВыборки),3)-1;
						//О.Т. Аверсон 02.03.2016 № 932
					Иначе
						Д1 = СтрокиПр.МесяцВыборки;
						Д2 = СтрокиПр.МесяцВыборки;
					Конецесли;
					
					СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку));
					
					Если СтрокиЗаработка.Количество()<>0 тогда
						
						Для каждого СтрокаЗп из СтрокиЗаработка цикл
							//Островская Татьяна 11.12.2013 № 16971
							ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокаЗп.МесяцВыборки);
							ВидУчетаВремени = Неопределено;
							РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
							если РезультВидУчета.Количество() > 0 Тогда 
								ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
							КонецЕсли;
							//Островская Татьяна 11.12.2013 № 16971
							Если СтрокаЗп.МесяцВыборки>= Д1 и СтрокаЗп.МесяцВыборки<=КонецМесяца(д2) тогда
								ДопСтрокаДвижений = ТаблицаЗаписей.Добавить();
								
								ДопСтрокаДвижений.ПериодРегистрации = СтрокаЗп.ПериодРегистрации;
								ДопСтрокаДвижений.ВидРасчета 		= СтрокиПр.ВидРасчета;
								ДопСтрокаДвижений.Регистратор 		= Регистратор;
								ДопСтрокаДвижений.НомерСтроки		= СтрокиПр.НомерСтроки;
								
								// измерения
								ДопСтрокаДвижений.Сотрудник 		= СтрокаЗп.Сотрудник;
								ДопСтрокаДвижений.ФизЛицо 		= СтрокаЗп.ФизЛицо;
								ДопСтрокаДвижений.Организация	= СтрокаЗп.Организация;
								//ДопСтрокаДвижений.Приказ 		= СтрокаЗп.Приказ;
								
								// свойства
								ДопСтрокаДвижений.БазовыйПериодНачало 		 	 = СтрокиПр.БазовыйПериодНачало;
								//Островская Татьяна 29.12.2012 № 16068
								если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
									строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
									если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда 
										ДопСтрокаДвижений.БазовыйПериодКонец = ДобавитьМесяц(СтрокаЗп.БазовыйПериодКонец,1);
									иначе
										ДопСтрокаДвижений.БазовыйПериодКонец = СтрокаЗп.БазовыйПериодКонец;
									КонецЕсли;
								иначе
									ДопСтрокаДвижений.БазовыйПериодКонец = СтрокаЗп.БазовыйПериодКонец;
								КонецЕсли;
								//Островская Татьяна 29.12.2012 № 16068
								// реквизиты
								ДопСтрокаДвижений.КоэффициентИндексации 		 = СтрокаЗп.КоэффициентИндексации;
								ДопСтрокаДвижений.ДатаНачалаРасчетногоПериода 	 = СтрокаЗп.ДатаНачалаРасчетногоПериода;
								ДопСтрокаДвижений.ДатаОкончанияРасчетногоПериода = СтрокаЗп.ДатаОкончанияРасчетногоПериода;
								
								ДопСтрокаДвижений.СпособРасчета 				 = СтрокиПр.СпособРасчета;
								ДопСтрокаДвижений.ПериодРасчетаСреднегоЗаработка = СтрокиПр.ПериодРасчетаСреднегоЗаработка;
								
								ДопСтрокаДвижений.ТекущаяТарифнаяСтавка			 = СтрокаЗп.ТекущаяТарифнаяСтавка;
								ДопСтрокаДвижений.ТарифнаяСтавкаПериода			 = СтрокаЗп.ТарифнаяСтавкаПериода; 
								//ДопСтрокаДвижений.КоэффициентИндексации = СтрокаЗп.КоэффициентИндексации;
								
								//толик часы								НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
								//								ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
								//Островская Татьяна 09.12.2013
								СтрокиЗаработкаВремя = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку,СтрокаЗп.МесяцВыборки));
								если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда 
									НормаПоГр = СтрокиЗаработкаВремя[0].НормаДней;
									ОтрабПоГр = СтрокиЗаработкаВремя[0].ОтработаноДней;
									
								иначе
									
									НормаПоГр = ?(СтрокиЗаработкаВремя[0].НормаЧасов=0, ?(СтрокиЗаработкаВремя[0].НормаДней = 0, СтрокиЗаработкаВремя[0].НормаПоПятидневке,СтрокиЗаработкаВремя[0].НормаДней),СтрокиЗаработкаВремя[0].НормаЧасов);
									ОтрабПоГр = ?(СтрокиЗаработкаВремя[0].ОтработаноЧасов=0, ?(СтрокиЗаработкаВремя[0].ОтработаноДней=0,СтрокиЗаработкаВремя[0].ОтработаноПоПятидневке,СтрокиЗаработкаВремя[0].ОтработаноДней),СтрокиЗаработкаВремя[0].ОтработаноЧасов);
								КонецЕсли;
								//Островская Татьяна 09.12.2013
								ДопСтрокаДвижений.Результат 					= ОбщегоНазначения.ОкруглитьПоВалюте((СтрокиПр.Результат/?(СтрокиПр.ЧислоМесяцев=0,1,СтрокиПр.ЧислоМесяцев)) * ОтрабПоГр/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
								ДопСтрокаДвижений.ЧислоМесяцев 					= 1;
								ДопСтрокаДвижений.ПериодРасчетаСреднегоЗаработка= СтрокиПр.ПериодРасчетаСреднегоЗаработка;
								ДопСтрокаДвижений.МесяцВыборки 					= СтрокаЗп.МесяцВыборки;
								
								//+ СВЭЙ КДЯ 28.09.19 СВФР-004834
								//ДопСтрокаДвижений.ОтработаноПоПятидневке 			= СтрокиПр.ОтработаноПоПятидневке;
								//ДопСтрокаДвижений.НормаПоПятидневке 				= СтрокиПр.НормаПоПятидневке;
								//ДопСтрокаДвижений.ОтработаноДней 					= СтрокиПр.ОтработаноДней;
								//ДопСтрокаДвижений.ОтработаноЧасов 					= СтрокиПр.ОтработаноЧасов;
								//ДопСтрокаДвижений.НормаДней 					= СтрокиПр.НормаДней;
								//ДопСтрокаДвижений.НормаЧасов 					= СтрокиПр.НормаЧасов;
								//- СВЭЙ КДЯ 28.09.19 СВФР-004834
								
								//+ СВЭЙ КДЯ 28.09.19 СВФР-004834
								ДопСтрокаДвижений.ОтработаноПоПятидневке 			= СтрокаЗп.ОтработаноПоПятидневке;
								ДопСтрокаДвижений.НормаПоПятидневке 				= СтрокаЗп.НормаПоПятидневке;
								ДопСтрокаДвижений.ОтработаноДней 					= СтрокаЗп.ОтработаноДней;
								ДопСтрокаДвижений.ОтработаноЧасов 					= СтрокаЗп.ОтработаноЧасов;
								ДопСтрокаДвижений.НормаДней 					= СтрокаЗп.НормаДней;
								ДопСтрокаДвижений.НормаЧасов 					= СтрокаЗп.НормаЧасов;
								//- СВЭЙ КДЯ 28.09.19 СВФР-004834
							КонецЕсли;		
						Конеццикла;
					КонецЕсли;
					СтрокиПр.Результат = 0;
				КонецЕсли;
			Конеццикла;
		КонецЕсли;
		
		СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			ТаблицаЗаписей.Удалить(ПустаяСтрока);
		КонецЦикла;
		
	Иначе
		//Все остальные случаи предусмотренные законодательством
		ЗапросВидРасчета.УстановитьПараметр("Сотрудник",Регистратор.Сотрудник);
		СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			ТаблицаЗаписей.Удалить(ПустаяСтрока);
		КонецЦикла;
		
		//Аверсон ЕАЕ 01.08.2022 СВФР-009371
		Если ТипРегистратора = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") И Регистратор.ВклПремииПропорциональноОтрабВр Тогда
			//Исключим месяцы, в которых были простои
			Для каждого СтрокаТаблицы из ТаблицаПростоев цикл
				СтруктураПоиска = Новый Структура;
				СтруктураПоиска.Вставить("МесяцВыборки", СтрокаТаблицы.МесяцВыборки);
				СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(СтруктураПоиска);
				Для каждого ПустаяСтрока из СтрокиКУдалению цикл
					//Сообщить("Начисление отпуска №"+ Регистратор.Номер+ " "+ СокрЛП(ПустаяСтрока.ФизЛицо.Наименование));
					//Сообщить("Месяц выборки "+ ПустаяСтрока.МесяцВыборки+" содержит простои или больничные листы. Проверьте правильность включения в расчет среднего");
					
					если Пересчет Тогда 
						ОтборРег = Новый Структура;
						ОтборРег.Вставить("МесяцВыборки",СтрокаТаблицы.МесяцВыборки);
						ОтборРег.Вставить("ВидРасчета",СтрокаТаблицы.ВидРасчета);
						Включать = Регистратор[ТЧРасчетСреднего].НайтиСтроки(ОтборРег);
						если Включать.Количество()> 0 Тогда 
							ПустаяСтрока.Включать = Включать[0].Включать;
						иначе
							ПустаяСтрока.Включать = Ложь;											
						КонецЕсли;
					иначе
						
						ПустаяСтрока.Включать = Ложь;
					КонецЕсли;
				КонецЦикла;
			КонецЦикла;
			
			//В нужную строку добавим годовую премию
			СтрокиГП = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,СпособРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии, Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням));
			Если СтрокиГП.Количество()<> 0 тогда
				ТаблицаКолСтрок = Новый ТаблицаЗначений;
				ТаблицаКолСтрок.Колонки.Добавить("ВидРасчета");
				ТаблицаКолСтрок.Колонки.Добавить("МесяцВыборки");
				ТаблицаКолСтрок.Колонки.Добавить("Включать");
				для Каждого СтрТЗ из ТаблицаЗаписей Цикл 
					СтрокаТаблицаКолСтрок = ТаблицаКолСтрок.Добавить();
					СтрокаТаблицаКолСтрок.ВидРасчета = СтрТЗ.ВидРасчета;
					СтрокаТаблицаКолСтрок.МесяцВыборки = СтрТЗ.МесяцВыборки;
					СтрокаТаблицаКолСтрок.Включать = СтрТЗ.Включать;
				КонецЦикла;
				ТаблицаКолСтрок.Свернуть("ВидРасчета,МесяцВыборки,Включать");
				СтрокиОсновногоЗаработка = ТаблицаКолСтрок.НайтиСтроки(Новый Структура("ВидРасчета,Включать", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск),Истина));
				
				Если СтрокиОсновногоЗаработка.Количество()<>0 тогда
					Для каждого СтрокаПремии из СтрокиГП цикл
						Если СтрокаПремии.ЧислоМесяцев = СтрокаПремии.ПериодРасчетаСреднегоЗаработка тогда
							СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки",?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент, ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
							Если СтрокиЗаработка.Количество()<>0 тогда
								Если СтрокиосновногоЗаработка.Количество() <> СтрокаПремии.ЧислоМесяцев тогда
									СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
									
									СтрокаПремии.РезультатДляПремии = 0;
									СтрокаПремии.Результат = 0;
									СтрокаПремии.ЧислоМесяцев = 1;
								Иначе
									СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
									СтрокаПремии.РезультатДляПремии = 0;
									СтрокаПремии.Результат = 0;
									СтрокаПремии.ЧислоМесяцев = 1;
								КонецЕсли;
							Иначе
								СтрокаПремии.Результат = 0;
							Конецесли;
						Иначе
							СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск), СтрокаПремии.МесяцВыборки));
							Если СтрокиЗаработка.Количество()<>0 тогда
								СтрокиЗаработка[0].Результат = СтрокиЗаработка[0].РезультатДляПремии + СтрокаПремии.РезультатДляПремии;
								СтрокаПремии.РезультатДляПремии = 0;
								СтрокаПремии.Результат = 0;
								СтрокаПремии.ЧислоМесяцев = 1;
							Иначе
								СтрокаПремии.РезультатДляПремии = 0;
								СтрокаПремии.Результат = 0;
							Конецесли;
						Конецесли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		//Аверсон СВФР-009371
		
		//_________________________________________________________________________________________________________________________		
		// Расчет годовой премии для включения в выборку для среднего по отпуску в соответствии с п.28 глава 3 Инструкции о порядке
		// исчисления среднего заработка, сохраняемого в случаях, предусмотренных законодательством
		//_________________________________________________________________________________________________________________________		
		если не УсловиеДляБПМ Тогда
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") 
				//+ СВЭЙ КДЯ 17.02.20 СВФР-005492
				ИЛИ ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" ) 
				И Регистратор.ВклПремииПропорциональноОтрабВр
				//- СВЭЙ КДЯ 17.02.20 СВФР-005492
				тогда
				СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему));//О.Т. Аверсон 06.05.2016 № 1141
			иначе
				СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям));
			КонецЕсли;
			Если СтрокиГодовой.Количество()<>0 тогда
				Для каждого СтрокиПр из СтрокиГодовой цикл
					СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку, СтрокиПр.МесяцВыборки));
					//Островская Татьяна 11.12.2013 № 16971
					ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокиПр.МесяцВыборки);
					
					ВидУчетаВремени = Неопределено;
					РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
					Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") тогда
						если Регистратор.ПремияПоЧасам Тогда
							ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;
						иначе
							ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
						КонецЕсли;
					иначе
						если РезультВидУчета.Количество() > 0 Тогда 
							ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
						КонецЕсли;
					КонецЕсли;
					//Островская Татьяна 11.12.2013 № 16971
					Если СтрокиЗаработка.Количество()<>0 тогда
						//Если СтрокиПр.БПНачало < СтрокиПр.МесяцВыборки и СтрокиПр.БПКонец< СтрокиПр.МесяцВыборки тогда //Островская Татьяна 09.12.2013(не проходило условие, не просчитывало результат пропорционально)
						//толик часы
						//						НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
						//						ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
						//Островская Татьяна 09.12.2013
						если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда 
							НормаПоГр = СтрокиЗаработка[0].НормаДней;
							//О.Т. 28.04.2015 № 417
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") тогда
								Отбор = Новый Структура;
								Отбор.Вставить("МесяцВыборки",СтрокиПр.МесяцВыборки);
								СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(Отбор);
								если Регистратор.ПремияПоЧасам Тогда
									ОтрабПоГр = СтрокиВремени[0].ОтработаноЧасов;
								иначе
									ОтрабПоГр = СтрокиВремени[0].ОтработаноДней;
								КонецЕсли;
							иначе
								//О.Т. 28.04.2015 № 417
								ОтрабПоГр = СтрокиЗаработка[0].ОтработаноДней;
							КонецЕсли;
							
						иначе
							
							НормаПоГр = СтрокиЗаработка[0].НормаЧасов;
							//О.Т. 28.04.2015 № 417
							если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") тогда
								
								//Аверсон 13.06.2022 КВВ СВФР-009195 (
								ДопЧасов = ЧасовПоГруппеРасчетовУвеличениеНормыГрафикаВОплатеПоСреднему(Регистратор.Сотрудник,СтрокиЗаработка[0].МесяцВыборки);
								НормаПоГр_ = НормаПоГр + ДопЧасов;
								
								Если СтрокиЗаработка[0].НормаЧасов <> НормаПоГр_ Тогда
									ДобавитьКНорме = Ложь;
									Если ТаблицаЗаписей.Колонки.Найти("Учтено")=Неопределено Тогда
										ТаблицаЗаписей.Колонки.Добавить("Учтено"); 
										СтрокиЗаработка[0].Учтено = Истина;
										ДобавитьКНорме = Истина;
									Иначе
										Если СтрокиЗаработка[0].Учтено <> Истина Тогда
											СтрокиЗаработка[0].Учтено = Истина;
											ДобавитьКНорме = Истина;
										КонецЕсли;
									КонецЕсли;
									Если ДобавитьКНорме Тогда
										СтрокиЗаработка[0].НормаЧасов = НормаПоГр_;
										НормаПоГр = НормаПоГр_;
									КонецЕсли;
								КонецЕсли;
								//Аверсон 13.06.2022 КВВ СВФР-009195 )
								
								Отбор = Новый Структура;
								Отбор.Вставить("МесяцВыборки",СтрокиПр.МесяцВыборки);
								СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(Отбор);
								если Регистратор.ПремияПоЧасам Тогда
									ОтрабПоГр = СтрокиВремени[0].ОтработаноЧасов;
								иначе
									ОтрабПоГр = СтрокиВремени[0].ОтработаноДней;
								КонецЕсли;
							иначе
								//О.Т. 28.04.2015 № 417	
								ОтрабПоГр = СтрокиЗаработка[0].ОтработаноЧасов;
							КонецЕсли;
						КонецЕсли;
						//Островская Татьяна 09.12.2013
						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						//						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ОтрабПоГр/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						СтрокиПр.ЧислоМесяцев = 1;
						//Иначе
						//	СтрокиПр.ЧислоМесяцев = 1;
						//КонецЕсли;
					Иначе
						//толик
						СтрокаПремии.Результат = 0;
						СтрокиПр.Результат = 0; //Аверсон 21.09.2020 КВВ СВФР-006591
					КонецЕсли;
				Конеццикла;
			КонецЕсли;
			
			СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям));
			Если СтрокиГодовой.Количество()<>0 тогда
				Для каждого СтрокиПр из СтрокиГодовой цикл
					СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку, СтрокиПр.МесяцВыборки));
					//Островская Татьяна 11.12.2013 № 16971
					ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокиПр.МесяцВыборки);
					ВидУчетаВремени = Неопределено;
					РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
					если РезультВидУчета.Количество() > 0 Тогда 
						ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
					КонецЕсли;
					//Островская Татьяна 11.12.2013 № 16971
					Если СтрокиЗаработка.Количество()<>0 тогда
						//Если СтрокиПр.БПНачало < СтрокиПр.МесяцВыборки и СтрокиПр.БПКонец< СтрокиПр.МесяцВыборки тогда //Островская Татьяна 09.12.2013(не проходило условие, не просчитывало результат пропорционально)
						//толик						НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
						//часы						ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
						//Островская Татьяна 09.12.2013
						если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда 
							НормаПоГр = СтрокиЗаработка[0].НормаДней;
							ОтрабПоГр = СтрокиЗаработка[0].ОтработаноДней;
							
						иначе
							
							НормаПоГр = СтрокиЗаработка[0].НормаЧасов;
							ОтрабПоГр = СтрокиЗаработка[0].ОтработаноЧасов;
						КонецЕсли;
						//Островская Татьяна 09.12.2013
						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ?(ОтрабПоГр>НормаПоГр, НормаПоГр, ОтрабПоГр)/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						//						СтрокиПр.Результат = ОбщегоНазначения.ОкруглитьПоВалюте(СтрокиПр.Результат * ОтрабПоГр/НормаПоГр,Константы.ВалютаРегламентированногоУчета.Получить());
						СтрокиПр.ЧислоМесяцев = 1;
						//Иначе
						//	СтрокиПр.ЧислоМесяцев = 1;
						//КонецЕсли;
					Иначе
						//толик
						СтрокаПремии.Результат = 0;
					КонецЕсли;
				Конеццикла;
			КонецЕсли;
			
			СтрокиГодовой = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии));
			Если СтрокиГодовой.Количество()<>0 тогда
				Если Регистратор.Организация.Инн = "100071565" Тогда // когда премии начисляются кусками
					ТОтбор = Новый Структура();
					ТОтбор.Вставить("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии);
					ТОтбор.Вставить("ЧислоМесяцев", 12);
					
					НужныеСтроки = ТаблицаЗаписей.НайтиСтроки(ТОтбор);
					Если НужныеСтроки.Количество() > 0 Тогда
						
						Запрос = Новый Запрос;
						Запрос.Текст = "ВЫБРАТЬ
						|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
						|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
						|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
						|	ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации КАК ПериодРегистрации,
						|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
						|	ДополнительныеНачисленияРаботниковОрганизаций.Результат
						|ИЗ
						|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
						|ГДЕ
						|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
						|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < &ПериодРегистрации
						|
						|УПОРЯДОЧИТЬ ПО
						|	ПериодРегистрации";
						
						Запрос.УстановитьПараметр("Сотрудник", Регистратор.Сотрудник);
						Запрос.УстановитьПараметр("ВидРасчета", МассивГодовыхПремий);
						Запрос.УстановитьПараметр("ПериодРегистрации", Регистратор.ПериодРегистрации);
						ЗапросРез = Запрос.Выполнить().Выгрузить();
						
						ТаблицаКолСтрок = Новый ТаблицаЗначений;
						ТаблицаКолСтрок.Колонки.Добавить("ВидРасчета");
						ТаблицаКолСтрок.Колонки.Добавить("Период");
						ВидРасчетПР = "";
						для Каждого СтрТЗ из ЗапросРез Цикл 
							СтрокаТаблицаКолСтрок = ТаблицаКолСтрок.Добавить();
							СтрокаТаблицаКолСтрок.ВидРасчета = СтрТЗ.ВидРасчета;
							Если ВидРасчетПР <> СтрТЗ.ВидРасчета или ВидРасчетПР = "" Тогда  									
								СтрокаТаблицаКолСтрок.Период = СтрТЗ.ПериодРегистрации;
								Период =СтрТЗ.ПериодРегистрации;
								ВидРасчетПР =СтрТЗ.ВидРасчета;
							Иначе
								СтрокаТаблицаКолСтрок.Период = Период;	
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;					
				КонецЕсли;
				
				//Аверсон ЕАЕ 01.06.2022 СВФР-009118
				//Если строка(ТипЗнч(Регистратор)) = "Оплата по среднему заработку"  И СтрокиПр.ЧислоМесяцев = 3 Тогда
				Если строка(ТипЗнч(Регистратор)) = "Оплата по среднему заработку" Тогда
					ТаблицаЗаписей.Колонки.Добавить("Новая"); //В новых строках будем заполнять 1, чтобы отличить добавленные строки от существовавщих ранее
				КонецЕсли;
				//Аверсон СВФР-009118
				
				Для каждого СтрокиПр из СтрокиГодовой цикл
					Если СтрокиПр.ЧислоМесяцев=1 тогда
						Сообщить("В премии, выплачиваемые за период включен вид расчета за 1 месяц. Исправьте базовые виды расчетов для расчета среднего");
					Иначе
						
						//Определим период в который включается премия
						Если СтрокиПр.ЧислоМесяцев = 12 тогда
							//О.Т. Аверсон 02.03.2016 № 932
							//Д1 = НачалоГода(СтрокиПр.МесяцВыборки);
							//Д2 = КонецГода(СтрокиПр.МесяцВыборки);
							Д1 = НачалоМесяца(СтрокиПр.МесяцВыборки);
							Д2 = ДобавитьМесяц(НачалоМесяца(СтрокиПр.МесяцВыборки),12)-1;
							Если Регистратор.Организация.Инн = "100071565" Тогда // когда премии начисляются кусками
								Если ТаблицаКолСтрок.Количество()>1 тогда
									//Для каждого СтрокиСмены из СтрокаТаблицаКолСтрок цикл //  ТаблицаКолСтрок
									ДатаСменаПремии = ДобавитьМесяц(НачалоМесяца(Период),12)-1;
									//	Прервать;
									//КонецЦикла; 
									Если Д2 < ДатаСменаПремии или Д2 > ДатаСменаПремии Тогда
										Если Д2 > ДатаСменаПремии Тогда
											РазностьДни = (Д2-ДатаСменаПремии)/60/60/24 ;
											Если  РазностьДни > 364 Тогда
											Иначе
												Д2 = ДатаСменаПремии ;
											КонецЕсли;
										Иначе
											Д2 = ДатаСменаПремии ;
										КонецЕсли;
									КонецЕсли;  							
								КонецЕсли;
							КонецЕсли;
							//О.Т. Аверсон 02.03.2016 № 932
						ИначеЕсли СтрокиПр.ЧислоМесяцев = 6 тогда
							//О.Т. Аверсон 02.03.2016 № 932
							//Если Месяц(СтрокиПр.МесяцВыборки)<=6 тогда
							//	Д1 = НачалоГода(СтрокиПр.Месяцвыборки);
							//	д2 = Дата(Год(СтрокиПр.МесяцВыборки),6,30);
							//Иначе
							//	Д1 = Дата(Год(СтрокиПр.МесяцВыборки),7,1);
							//	д2 = Конецгода(СтрокиПр.МесяцВыборки);
							//КонецЕсли;
							Д1 = НачалоМесяца(СтрокиПр.МесяцВыборки);
							Д2 = ДобавитьМесяц(НачалоМесяца(СтрокиПр.МесяцВыборки),6)-1;
							//О.Т. Аверсон 02.03.2016 № 932
						ИначеЕсли СтрокиПр.ЧислоМесяцев = 3 тогда
							//О.Т. Аверсон 02.03.2016 № 932
							//Д1 = НачалоКвартала(СтрокиПр.Месяцвыборки);
							//Д2 = КонецКвартала(СтрокиПр.МесяцВыборки);
							Д1 = НачалоМесяца(СтрокиПр.МесяцВыборки);
							Д2 = ДобавитьМесяц(НачалоМесяца(СтрокиПр.МесяцВыборки),3)-1;
							//О.Т. Аверсон 02.03.2016 № 932
						ИначеЕсли СтрокиПр.ЧислоМесяцев = 9 тогда   //добавили 9мес
							Д1 = НачалоМесяца(СтрокиПр.МесяцВыборки);
							Д2 = ДобавитьМесяц(НачалоМесяца(СтрокиПр.МесяцВыборки),9)-1;
						Иначе
							Д1 = СтрокиПр.МесяцВыборки;
							Д2 = СтрокиПр.МесяцВыборки;
						Конецесли;
						
						СтрокиЗаработка = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку));
						
						Если СтрокиЗаработка.Количество()<>0 тогда
							
							Для каждого СтрокаЗп из СтрокиЗаработка цикл
								//Островская Татьяна 11.12.2013 № 16971
								ЗапросВидРасчета.УстановитьПараметр("ПериодРегистрации",СтрокаЗп.МесяцВыборки);
								ВидУчетаВремени = Неопределено;
								РезультВидУчета = ЗапросВидРасчета.Выполнить().Выгрузить();
								если РезультВидУчета.Количество() > 0 Тогда 
									ВидУчетаВремени = РезультВидУчета[0].ВидУчетаВремени;
								КонецЕсли;
								//Островская Татьяна 11.12.2013 № 16971
								Если СтрокаЗп.МесяцВыборки>= Д1 и СтрокаЗп.МесяцВыборки<=КонецМесяца(д2) тогда
									
									//Аверсон ЕАЕ 01.06.2022 СВФР-009118
									//Найдем строки с такой же премией за этот же месяц выборки
									//Отбираем строки только из добавленных, существовавшие ранее не берем
									Если строка(ТипЗнч(Регистратор)) = "Оплата по среднему заработку" И СтрокиПр.ЧислоМесяцев = 3 Тогда
										СтруктураОтбора = Новый Структура;
										СтруктураОтбора.Вставить("Сотрудник", СтрокаЗп.Сотрудник);
										СтруктураОтбора.Вставить("ФизЛицо", СтрокаЗп.ФизЛицо);
										СтруктураОтбора.Вставить("Организация", СтрокаЗп.Организация);
										СтруктураОтбора.Вставить("МесяцВыборки", СтрокаЗп.МесяцВыборки);
										СтруктураОтбора.Вставить("ВидРасчета", СтрокиПр.ВидРасчета);
										СтруктураОтбора.Вставить("Новая", 1);
										Если Регистратор.КвПремияВсеВыплаты Тогда  
											СтруктураОтбора.Вставить("ЧислоМесяцев", 3);
										Иначе
											СтруктураОтбора.Вставить("ЧислоМесяцев", 1);
										КонецЕсли;										
										МассивСуществующихПремий = ТаблицаЗаписей.НайтиСтроки(СтруктураОтбора);
									КонецЕсли;
									//Аверсон СВФР-009118
									
									ДопСтрокаДвижений = ТаблицаЗаписей.Добавить();
									
									ДопСтрокаДвижений.ПериодРегистрации = СтрокаЗп.ПериодРегистрации;
									ДопСтрокаДвижений.ВидРасчета 		= СтрокиПр.ВидРасчета;
									ДопСтрокаДвижений.Регистратор 		= Регистратор;
									ДопСтрокаДвижений.НомерСтроки		= СтрокиПр.НомерСтроки;
									
									// измерения
									ДопСтрокаДвижений.Сотрудник 		= СтрокаЗп.Сотрудник;
									ДопСтрокаДвижений.ФизЛицо 		= СтрокаЗп.ФизЛицо;
									ДопСтрокаДвижений.Организация	= СтрокаЗп.Организация;
									//ДопСтрокаДвижений.Приказ 		= СтрокаЗп.Приказ;
									
									// свойства
									ДопСтрокаДвижений.БазовыйПериодНачало 		 	 = СтрокиПр.БазовыйПериодНачало;
									//Островская Татьяна 29.12.2012 № 16068
									если строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу" или
										строка(ТипЗнч(Регистратор)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
										если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда 
											ДопСтрокаДвижений.БазовыйПериодКонец = ДобавитьМесяц(СтрокаЗп.БазовыйПериодКонец,1);
										иначе
											ДопСтрокаДвижений.БазовыйПериодКонец = СтрокаЗп.БазовыйПериодКонец;
										КонецЕсли;
									иначе
										ДопСтрокаДвижений.БазовыйПериодКонец = СтрокаЗп.БазовыйПериодКонец;
									КонецЕсли;
									//Островская Татьяна 29.12.2012 № 16068
									// реквизиты
									ДопСтрокаДвижений.КоэффициентИндексации 		 = СтрокаЗп.КоэффициентИндексации;
									ДопСтрокаДвижений.ДатаНачалаРасчетногоПериода 	 = СтрокаЗп.ДатаНачалаРасчетногоПериода;
									ДопСтрокаДвижений.ДатаОкончанияРасчетногоПериода = СтрокаЗп.ДатаОкончанияРасчетногоПериода;
									ДопСтрокаДвижений.ДатаНачалаСобытия = 			СтрокаЗп.ДатаНачалаСобытия;
									
									
									
									ДопСтрокаДвижений.СпособРасчета 				 = СтрокиПр.СпособРасчета;
									ДопСтрокаДвижений.ПериодРасчетаСреднегоЗаработка = СтрокиПр.ПериодРасчетаСреднегоЗаработка;
									
									ДопСтрокаДвижений.ТекущаяТарифнаяСтавка			 = СтрокаЗп.ТекущаяТарифнаяСтавка;
									ДопСтрокаДвижений.ТарифнаяСтавкаПериода			 = СтрокаЗп.ТарифнаяСтавкаПериода; 
									//ДопСтрокаДвижений.КоэффициентИндексации = СтрокаЗп.КоэффициентИндексации;
									
									//толик								НормаПоГр = ?(СтрокиЗаработка[0].НормаДней=0, ?(СтрокиЗаработка[0].НормаЧасов = 0, СтрокиЗаработка[0].НормаПоПятидневке,СтрокиЗаработка[0].НормаЧасов),СтрокиЗаработка[0].НормаДней);
									//часы								ОтрабПоГр = ?(СтрокиЗаработка[0].ОтработаноДней=0, ?(СтрокиЗаработка[0].ОтработаноЧасов=0,СтрокиЗаработка[0].ОтработаноПоПятидневке,СтрокиЗаработка[0].ОтработаноЧасов),СтрокиЗаработка[0].ОтработаноДней);
									//Островская Татьяна 09.12.2013
									СтрокиЗаработкаВремя = таблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку,СтрокаЗп.МесяцВыборки));
									если ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням Тогда 
										НормаПоГр = СтрокиЗаработкаВремя[0].НормаДней;
										ОтрабПоГр = СтрокиЗаработкаВремя[0].ОтработаноДней;
										
									иначе
										
										НормаПоГр = СтрокиЗаработкаВремя[0].НормаЧасов;
										ОтрабПоГр = СтрокиЗаработкаВремя[0].ОтработаноЧасов;
									КонецЕсли;
									//Островская Татьяна 09.12.2013 
									ДопСтрокаДвижений.Результат 					= ОбщегоНазначения.ОкруглитьПоВалюте((СтрокиПр.Результат/?(СтрокиПр.ЧислоМесяцев=0,1,СтрокиПр.ЧислоМесяцев)),Константы.ВалютаРегламентированногоУчета.Получить());
									ДопСтрокаДвижений.ЧислоМесяцев 					= 1;
									ДопСтрокаДвижений.ПериодРасчетаСреднегоЗаработка= СтрокиПр.ПериодРасчетаСреднегоЗаработка;
									ДопСтрокаДвижений.МесяцВыборки 					= СтрокаЗп.МесяцВыборки;
									//14088 выплаты по видам нач и периду
									Если строка(ТипЗнч(Регистратор)) = "Оплата по среднему заработку" и Регистратор.Организация.ФлОплПоСрПериодКв тогда 										
										Запрос = Новый Запрос;
										Запрос.Текст = "ВЫБРАТЬ
										|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
										|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
										|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
										|	ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации КАК ПериодРегистрации,
										|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
										|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
										|	ДополнительныеНачисленияРаботниковОрганизаций.ЧислоМесяцев
										|ИЗ
										|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
										|ГДЕ
										|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
										|	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < &ПериодРегистрации
										|	И ДополнительныеНачисленияРаботниковОрганизаций.ЧислоМесяцев <> 1
										|	И ДополнительныеНачисленияРаботниковОрганизаций.Организация = &Организация
										|
										|УПОРЯДОЧИТЬ ПО
										|	ПериодРегистрации";
										
										Запрос.УстановитьПараметр("Сотрудник", Регистратор.Сотрудник);
										Запрос.УстановитьПараметр("Организация", Регистратор.Организация);
										Запрос.УстановитьПараметр("ПериодРегистрации", Регистратор.ПериодРегистрации);
										ЗапросРез = Запрос.Выполнить().Выгрузить();
										
										ВидРасчетПР = "";
										для Каждого СтрТЗ из ЗапросРез Цикл 											
											Если СтрокиПр.МесяцВыборки = НачалоМесяца(СтрТЗ.ПериодРегистрации) и  
												СтрокиПр.Результат = СтрТЗ.Результат Тогда
											ДопСтрокаДвижений.ВРРегистрации = Формат(СтрокиПр.МесяцВыборки,"ДФ=dd.MM.yyyy");
											ДопСтрокаДвижений.ВРТекст = СтрТЗ.ВидРасчета;
											КонецЕсли;
										КонецЦикла;   										
									КонецЕсли;
									// 14088
									//Аверсон ЕАЕ 12.02.2021 СВФР-007151
									ПремияПоЧасам = (строка(ТипЗнч(Регистратор)) = "Оплата по среднему заработку" 
									И ДопСтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии 
									И Регистратор.ПремияПоЧасам);
									
									//ДопСтрокаДвижений.ОтработаноПоПятидневке 			= СтрокиЗаработкаВремя[0].ОтработаноПоПятидневке;
									//ДопСтрокаДвижений.НормаПоПятидневке 				= СтрокиЗаработкаВремя[0].НормаПоПятидневке;
									ДопСтрокаДвижений.ОтработаноПоПятидневке 			= ?(ПремияПоЧасам, СтрокиЗаработкаВремя[0].ОтработаноЧасов, СтрокиЗаработкаВремя[0].ОтработаноПоПятидневке);
									ДопСтрокаДвижений.НормаПоПятидневке 				= ?(ПремияПоЧасам, СтрокиЗаработкаВремя[0].НормаЧасов, СтрокиЗаработкаВремя[0].НормаПоПятидневке);
									//Аверсон СВФР-007151
									
									ДопСтрокаДвижений.ОтработаноДней 					= СтрокиЗаработкаВремя[0].ОтработаноДней;
									ДопСтрокаДвижений.ОтработаноЧасов 					= СтрокиЗаработкаВремя[0].ОтработаноЧасов;
									ДопСтрокаДвижений.НормаДней 					= СтрокиЗаработкаВремя[0].НормаДней;
									ДопСтрокаДвижений.НормаЧасов 					= СтрокиЗаработкаВремя[0].НормаЧасов;
									ДопСтрокаДвижений.Включать 						= Истина;
									//ПСА 20.10.2021 СвФР-008285+++
									Если строка(ТипЗнч(Регистратор)) = "Оплата по среднему заработку" 
										И ДопСтрокаДвижений.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии 
										И РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация", Регистратор.Организация)).ИндексацияГодовойПремииВОплатеПоСреднему Тогда //Аверсон 04.01.2022 КВВ СВФР-008570
										ДопСтрокаДвижений.КоэффициентИндексации 		 = СтрокиПр.КоэффициентИндексации;
										ДопСтрокаДвижений.ТарифнаяСтавкаПериода			 = СтрокиПр.ТарифнаяСтавкаПериода;
										//индексируем только старые суммы по годовым премиям. а не песле повышения ТС
										Если ДопСтрокаДвижений.ТарифнаяСтавкаПериода =  ДопСтрокаДвижений.ТекущаяТарифнаяСтавка Тогда  
											ДопСтрокаДвижений.КоэффициентИндексации 	= 1;
										Иначе//если за период расчета несколько раз поднималась ТС 
											К =  РаботаСДиалогамиСвэй.ОкруглитьКоэффициентИндексации(ДопСтрокаДвижений.ТекущаяТарифнаяСтавка/ ДопСтрокаДвижений.ТарифнаяСтавкаПериода, ОкруглитьКоэффициентИндексации);
											Если ДопСтрокаДвижений.КоэффициентИндексации <> К Тогда
												ДопСтрокаДвижений.КоэффициентИндексации = К ;
											КонецЕсли;
										КонецЕсли;
									КонецЕсли;	
									//+++ПСА 20.10.2021 СвФР-008285	
									
									//Аверсон ЕАЕ 01.06.2022 СВФР-009118
									//В строках с такой же премией, таким же месяцем выборки обнулим результат
									//чтобы потом их удалить
									
									//Аверсон ЕАЕ 22.07.2022 СВФР-009371
									//ДопСтрокаДвижений.Новая = 1;
									//Аверсон СВФР-009371
									
									Если строка(ТипЗнч(Регистратор)) = "Оплата по среднему заработку" И СтрокиПр.ЧислоМесяцев = 3 Тогда
										//Аверсон ЕАЕ 22.07.2022 СВФР-009371
										ДопСтрокаДвижений.Новая = 1;
										//Аверсон СВФР-009371
										Для Каждого Пр Из МассивСуществующихПремий Цикл
											Пр.Результат = 0;
										КонецЦикла;
									КонецЕсли;
									//Аверсон СВФР-009118
									
								КонецЕсли;		
							Конеццикла;
						КонецЕсли;
						СтрокиПр.Результат = 0;
					КонецЕсли;
				Конеццикла;
			КонецЕсли;
		КонецЕсли;
		СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(Новый Структура("Результат", 0));
		Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
			ТаблицаЗаписей.Удалить(ПустаяСтрока);
		КонецЦикла;
	КонецЕсли;
	
	//толик	
	Если таблицаЗаписей.Количество() = 0 И Регистратор.Метаданные().Имя <> "НачислениеЗарплатыРаботникамОрганизаций" 
		
		//Аверсон ЕАЕ 01.02.2022 СВФР-008641
		И Не (ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И Регистратор.РасчетОтОклада) Тогда
		//Аверсон СВФР-008641
		
		Сообщить("Невозможно выбрать данные для расчета среднего. Введите данные вручную");
	КонецЕсли;
	если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛисту" или 
		Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛистуПоДоговорамПодряда" Тогда //О.Т. 23.09.2014 № 17616
		для Каждого стр из ТаблицаЗаписей Цикл
			ПараметрыОтбора = Новый Структура;
			ПараметрыОтбора.Вставить("МесяцВыборки",стр.МесяцВыборки);
			ПараметрыОтбора.Вставить("ВидРасчета",стр.ВидРасчета);
			если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛистуПоДоговорамПодряда" Тогда
				ПараметрыОтбора.Вставить("БазовыйПериодНачало",стр.БазовыйПериодНачало);
			КонецЕсли;
			
			СтрокиКУдалению = ТаблицаЗаписей.НайтиСтроки(ПараметрыОтбора);
			КоличествоСтр1 = СтрокиКУдалению.Количество();
			пока КоличествоСтр1 <> 0 Цикл  
				//Для КоличествоСтр1 = КоличествоСтр1 По 1 Цикл
				ПустаяСтрока = СтрокиКУдалению[КоличествоСтр1-1];
				//Для Каждого ПустаяСтрока из СтрокиКУдалению Цикл
				//если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛистуПоДоговорамПодряда" Тогда 
				//	КоличествоСтр = ТаблицаЗаписей.НайтиСтроки(Новый Структура("МесяцВыборки",стр.МесяцВыборки)).Количество();
				//иначе
				КоличествоСтр = ТаблицаЗаписей.НайтиСтроки(Новый Структура("МесяцВыборки,БазовыйПериодНачало,БазовыйПериодКонец",стр.МесяцВыборки,стр.БазовыйПериодНачало,стр.БазовыйПериодКонец)).Количество();
				//		КонецЕсли;
				
				если  ТаблицаЗаписей.НайтиСтроки(ПараметрыОтбора).Количество()> 1 Тогда
					//Островская Татьяна 06.12.2013 дополнительная премия удалялась
					СуммированныйРезультат = ПустаяСтрока.Результат;
					ТаблицаЗаписей.Удалить(ПустаяСтрока);
					если не Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛистуПоДоговорамПодряда" Тогда
						ТаблицаЗаписей.НайтиСтроки(ПараметрыОтбора)[0].Результат = ТаблицаЗаписей.НайтиСтроки(ПараметрыОтбора)[0].Результат + СуммированныйРезультат;
					КонецЕсли;
					//Островская Татьяна 06.12.2013 дополнительная премия удалялась
					//КоличествоСтр1 = КоличествоСтр1-1;
					если КоличествоСтр = 2 Тогда 
						Прервать;
					КонецЕсли;
					
				КонецЕсли;
				КоличествоСтр1 = КоличествоСтр1-1;
			КонецЦикла;
		КонецЦикла;
		
		если Регистратор.Метаданные().Имя = "НачислениеПоБольничномуЛистуПоДоговорамПодряда" Тогда
			
			//+ СВЭЙ КДЯ 11.10.19 СВФР-004756
			МассивСтрокКУдалению = Новый Массив;
			//- СВЭЙ КДЯ 11.10.19 СВФР-004756
			
			Для Каждого стр из ТаблицаЗаписей Цикл 
				
				Если НЕ УсловиеДляБПМ Тогда //Аверсон 03.06.2020 КВВ СВФР-006059  
					//+ СВЭЙ КДЯ 11.10.19 СВФР-004756
					Если стр.МесяцВыборки < НачалоМесяца( стр.БазовыйПериодНачало ) ИЛИ стр.МесяцВыборки > стр.ДатаОкончанияРасчетногоПериода Тогда
						МассивСтрокКУдалению.Добавить( стр );
						Продолжить;
					КонецЕсли;  
					//- СВЭЙ КДЯ 11.10.19 СВФР-004756
					//Аверсон 03.06.2020 КВВ СВФР-006059 (
				Иначе
					Если стр.МесяцВыборки < НачалоМесяца( стр.БазовыйПериодНачало ) Тогда
						МассивСтрокКУдалению.Добавить( стр );
						Продолжить;
					КонецЕсли;
				КонецЕсли; 
				//Аверсон 03.06.2020 КВВ СВФР-006059 )
				
				
				ТЗДаты = Новый ТаблицаЗначений;
				ТЗДаты.Колонки.Добавить( "Дата" );
				//+ СВЭЙ КДЯ 11.10.19 СВФР-004756
				//ДатаНачала = НачалоМесяца(стр.БазовыйПериодНачало);
				//Пока ДатаНачала<=стр.БазовыйПериодКонец Цикл 
				//	стрТЗДаты = ТЗДаты.Добавить();
				//	стрТЗДаты.Дата = ДатаНачала;
				//	ДатаНачала = ДобавитьМесяц(ДатаНачала,1);
				//КонецЦикла;
				//- СВЭЙ КДЯ 11.10.19 СВФР-004756
				//+ СВЭЙ КДЯ 11.10.19 СВФР-004756
				
				//Аверсон 30.10.2020 КВВ СВФР-006762 (  
				//ДатаНачала = НачалоМесяца( стр.БазовыйПериодНачало );
				ДатаНачала = НачалоМесяца(?(ЗначениеЗаполнено(стр.БазовыйПериодНачало),стр.БазовыйПериодНачало,стр.ДатаНачалаРасчетногоПериода));
				//Аверсон 30.10.2020 КВВ СВФР-006762 )
				
				//Аверсон 15.02.2022 КВВ СВФР-008743 (
				МинДатаПо = Мин(НачалоДня(НачалоМесяца(стр.ДатаНачалаСобытия)-1),стр.ДатаОкончанияРасчетногоПериода);
				//Пока ДатаНачала <= стр.ДатаОкончанияРасчетногоПериода Цикл 
				Пока ДатаНачала <= МинДатаПо Цикл
					//Аверсон 15.02.2022 КВВ СВФР-008743 )
					стрТЗДаты = ТЗДаты.Добавить();
					стрТЗДаты.Дата = ДатаНачала;
					ДатаНачала = ДобавитьМесяц( ДатаНачала, 1 );
				КонецЦикла;
				//- СВЭЙ КДЯ 11.10.19 СВФР-004756
				
				
				Для каждого стрДаты Из ТЗДаты Цикл
					
					МассивТаблицаЗаписей =  ТаблицаЗаписей.НайтиСтроки( Новый Структура( "МесяцВыборки", НачалоМесяца( стрДаты.Дата ) ) );
					Если МассивТаблицаЗаписей.Количество() = 0 Тогда 
						стрТабЗначение = ТаблицаЗаписей.Добавить();
						ЗаполнитьЗначенияСвойств(стрТабЗначение,стр);
						стрТабЗначение.МесяцВыборки = стрДаты.Дата;
						ДН = ?(НачалоМесяца(стр.БазовыйПериодНачало) = стрТабЗначение.МесяцВыборки,стр.БазовыйПериодНачало,стрТабЗначение.МесяцВыборки);
						ДК = ?(НачалоМесяца(стр.БазовыйПериодКонец) = стрТабЗначение.МесяцВыборки,стр.БазовыйПериодКонец,КонецМесяца(стрТабЗначение.МесяцВыборки));
						
						КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,стрТабЗначение.МесяцВыборки, УсловиеДляБПМ или ПоОкладуКаленд,ДН,ДК,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
						
						стрТабЗначение.ОтработаноДней = КалендарныеДни;
						стрТабЗначение.Результат = 0;
					КонецЕсли;
					
				КонецЦикла; // стрДаты Из ТЗДаты
				
			КонецЦикла; // стр из ТаблицаЗаписей
			
			//+ СВЭЙ КДЯ 11.10.19 СВФР-004756
			Для каждого СтрУдал Из МассивСтрокКУдалению Цикл
				ТаблицаЗаписей.Удалить( СтрУдал );	
			КонецЦикла;
			//- СВЭЙ КДЯ 11.10.19 СВФР-004756
			
			ТаблицаЗаписей.Сортировать("МесяцВыборки");
			
		КонецЕсли;
		
	КонецЕсли;
	//О.Т. 26.09.2014 № 17568
	СписокСообщений.СортироватьПоЗначению(НаправлениеСортировки.Возр);
	ДатаПрошл = "";
	для Каждого СтрСписок из СписокСообщений Цикл 
		если СтрСписок.Значение <> ДатаПрошл и не Регистратор.Организация.НормаВОтпускахПоГрРасчетов Тогда 
			Сообщить("Месяц выборки "+Формат(СтрСписок.Значение,"ДФ=""дд.ММ.гггг""")+" исключается из расчета среднего заработка, т.к. у работника не отработано время по норме."); //О.Т. 26.09.2014 № 17568
		КонецЕсли;
		ДатаПрошл = СтрСписок.Значение;
	КонецЦикла;
	//О.Т. 26.09.2014 № 17568
	
	//О.Т. 05.10.2014 № 
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
		если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПустаяСсылка() Тогда
			
			
			//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
			//ЗапросПрием = Новый запрос;
			//ЗапросПрием.Текст =
			//"ВЫБРАТЬ
			//|	МАКСИМУМ(РаботникиОрганизаций.Период) КАК ДатаПриема
			//|ИЗ
			//|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			//|ГДЕ
			//|	РаботникиОрганизаций.Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию
			//|	И РаботникиОрганизаций.Сотрудник = &Сотрудник";
			//ЗапросПрием.УстановитьПараметр("Сотрудник",Регистратор.Сотрудник);
			//РезультПрием = ЗапросПрием.Выполнить().Выбрать();
			//если РезультПрием.Следующий() Тогда 
			//	ДатаПриема = РезультПрием.ДатаПриема;
			//КонецЕсли;
			//- СВЭЙ КДЯ 05.09.19 СВФР-004448
			
			//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
			ДатаПриема = УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Регистратор.Сотрудник );
			//- СВЭЙ КДЯ 05.09.19 СВФР-004448
			
			МесяцСред = Макс(Месяц(ДатаНачалаРасчетаСреднего),Месяц(ДатаПриема));
			
			ДатаСред = Макс(ДатаНачалаРасчетаСреднего,НачалоМесяца(ДатаПриема));
			СтрокаДвижений = НаборЗаписей[1];
			ДатаСредКонец = Месяц(ДобавитьМесяц(ДатаОкончанияРасчетаСреднего,1));
			//О.Т. Аверсон 05.01.2016 № Не нужно //О.Т. Аверсон 24.03.2016 № 993 (вернула, только с условием того, что добавлятся строки будут, если есть в этом месяце календарные дни)
			Пока МесяцСред <> ДатаСредКонец Цикл 
				ЗаполнениеМесяца = ТаблицаЗаписей.НайтиСтроки(Новый Структура("ВидРасчета,МесяцВыборки",ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ,ДатаСред));
				если ЗаполнениеМесяца.Количество() = 0 Тогда 
					//Запрос = Новый Запрос;
					//Запрос.Текст = 
					//"ВЫБРАТЬ
					//|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник
					//|ИЗ
					//|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
					//|ГДЕ
					//|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
					//|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации";
					//ВидРасчетаНевыходы = Новый СписокЗначений;
					//ВидРасчетаНевыходы.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпКалендарныеДни);
					//ВидРасчетаНевыходы.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуБЛ);
					//Запрос.УстановитьПараметр("ВидРасчета", ВидРасчетаНевыходы);
					//Запрос.УстановитьПараметр("ПериодРегистрации", ДатаСред);
					//
					//РезультатНевыходы = Запрос.Выполнить().Выгрузить();
					//
					//если РезультатНевыходы.Количество()>0 Тогда 
					//О.Т. Аверсон 24.03.2016 № 993
					ПоОкладуКаленд = Ложь;
					Если Регистратор.ТипРасчета =  Перечисления.ТипРасчетаБЛ.ПоОкладу и Регистратор.КалендарныеДни Тогда
						ПоОкладуКаленд = Истина;
					КонецЕсли;
					//О.Т. 16.07.2014 № 118
					КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ДатаСред, УсловиеДляБПМ или ПоОкладуКаленд,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
					Если КалендарныеДни = 0 Тогда
						ДатаСред = ДобавитьМесяц(ДатаСред,1);
						МесяцСред = Месяц(ДатаСред);
						Продолжить;
					КонецЕсли;
					//О.Т. Аверсон 24.03.2016 № 993
					
					ДопСтрокаДвижений = ТаблицаЗаписей.Добавить();
					
					ДопСтрокаДвижений.ПериодРегистрации = Регистратор.ПериодРегистрации;
					ДопСтрокаДвижений.ВидРасчета 		= СтрокаДвижений.ВидРасчета;
					ДопСтрокаДвижений.СпособРасчета     = СтрокаДвижений.СпособРасчета;
					ДопСтрокаДвижений.Регистратор 		= Регистратор;
					ДопСтрокаДвижений.НомерСтроки		= СтрокаДвижений.НомерСтроки;
					
					// измерения
					ДопСтрокаДвижений.Сотрудник 	= СтрокаДвижений.Сотрудник;
					ДопСтрокаДвижений.ФизЛицо 	= СтрокаДвижений.ФизЛицо;
					ДопСтрокаДвижений.Организация	= СтрокаДвижений.Организация;
					ДопСтрокаДвижений.БазовыйПериодНачало 		= СтрокаДвижений.БазовыйПериодНачало;
					ДопСтрокаДвижений.БазовыйПериодКонец = СтрокаДвижений.БазовыйПериодКонец;
					ДопСтрокаДвижений.КоэффициентИндексации 		 = ?(НеИндексировать,1,СтрокаДвижений.КоэффициентИндексации);
					
					БезЕТСПоСотруднику = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред),
					Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).БезЕТС;//О.Т. Аверсон 06.11.2015 № 679
					
					если Строка(ТипЗнч(Регистратор)) = Метаданные.Документы.НачислениеОтпускаРаботникамОрганизаций.Синоним или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или Строка(ТипЗнч(Регистратор)) = Метаданные.Документы.РасчетПриУвольненииРаботникаОрганизаций.Синоним  Тогда //О.Т. Аверсон 09.02.2018 № 1566 + средний
						УсловиеФлагОрганизация = СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС; //О.Т. 18.07.2014 (убран ЕТКС)
					Иначе
						УсловиеФлагОрганизация = не БезЕТСПоСотруднику;
					КонецЕсли;
					
					
					ДопСтрокаДвижений.ТекущаяТарифнаяСтавка 		 = СтрокаДвижений.ТекущаяТарифнаяСтавка;
					ТарифнаяСтавкаПериода = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред), 
					Новый Структура("Сотрудник,Организация", СтрокаДвижений.Сотрудник,СтрокаДвижений.Организация)).ТарифнаяСтавкаПервогоРазряда;
					
					
					РазмерТСПериода =   РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред), 
					Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация, ТарифнаяСтавкаПериода)).Размер;
					если не УсловиеФлагОрганизация тогда
						//О.Т. 23.02.2015 № 331
						если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда //О.Т. Аверсон 09.02.2018 № 1566 + средний
							//О.Т. Аверсон 06.12.2016 № 74
							РегистрТарифныеСтавки = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(, Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник));
							Если РегистрТарифныеСтавки.ДляПечати Тогда 
								РазмерПоследнегоОкл =  РегистрТарифныеСтавки.МесячнаяТарифнаяСтавкаВВалюте;
							иначе
								РазмерПоследнегоОкл =  РегистрТарифныеСтавки.ТарифнаяСтавка;
							КонецЕсли;
							//О.Т. Аверсон 06.12.2016 № 74
							
							//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
						иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
							
							ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ДатаСред, СтрокаДвижений );
							ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
							РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
							ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
							//- СВЭЙ КДЯ 27.01.20 СВФР-005409
							
						иначе
							ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
							ЗапросОкладПосл = Новый Запрос;
							ЗапросОкладПосл.Текст = 
							"ВЫБРАТЬ
							|	ВЫБОР
							|		КОГДА ТарифныеСтавкиРаботниковОрганизации.ДляПечати
							|			ТОГДА ТарифныеСтавкиРаботниковОрганизации.МесячнаяТарифнаяСтавкаВВалюте
							|		ИНАЧЕ ТарифныеСтавкиРаботниковОрганизации.ТарифнаяСтавка
							|	КОНЕЦ КАК ТарифнаяСтавка,
							|	ТарифныеСтавкиРаботниковОрганизации.Период
							|ИЗ
							|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
							|			,
							|			Организация = &Организация
							|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
							|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
							|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
							|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
							|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
							|ГДЕ
							|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
							
							ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
							ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
							ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
							
							РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
							РазмерПоследнегоОкл = 0;
							Пока РезультатОкладПосл.Следующий() Цикл
								РазмерПоследнегоОкл = РезультатОкладПосл.ТарифнаяСтавка;
								Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и РезультатОкладПосл.Период < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
									РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
						//О.Т. 23.02.2015 № 331
						
						//О.Т. Аверсон 06.12.2016 № 74
						РегистрТарифныеСтавки = РегистрыСведений.ТарифныеСтавкиРаботниковОрганизации.ПолучитьПоследнее(КонецМесяца(ДатаСред), Новый Структура("Организация,Сотрудник", СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник));
						Если РегистрТарифныеСтавки.ДляПечати Тогда 
							Оклад =  РегистрТарифныеСтавки.МесячнаяТарифнаяСтавкаВВалюте;
						иначе
							Оклад =  РегистрТарифныеСтавки.ТарифнаяСтавка;
						КонецЕсли;
						//О.Т. Аверсон 06.12.2016 № 74
						
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ДатаСред < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
							Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
						
						//Аверсон-софт, Островская Татьяна 12.06.2012 № 15410
						если СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС Тогда
							Запрос = Новый Запрос;
							Запрос.Текст = 
							"ВЫБРАТЬ
							|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда КАК ТарифнаяСтавкаПервогоРазряда
							|ИЗ
							|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
							|			&Период,
							|			Сотрудник = &Сотрудник
							|				И организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
							
							Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
							Запрос.УстановитьПараметр("Период", Регистратор.ПериодРегистрации);
							Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);		
							Результат = Запрос.Выполнить();	
							ВыборкаДетальныеЗаписи = Результат.Выбрать();
							ТарифнаяСтавка1Р = "";
							Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
								ТарифнаяСтавка1Р = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
							КонецЦикла;
							Запрос.УстановитьПараметр("Период", ДатаСред);
							Результат = Запрос.Выполнить();	
							ВыборкаДетальныеЗаписи = Результат.Выбрать();
							ТарифнаяСтавка1РНаДату = "";
							Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
								ТарифнаяСтавка1РНаДату = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
							КонецЦикла;
							
							если ЗначениеЗаполнено(ТарифнаяСтавка1Р) и ЗначениеЗаполнено(ТарифнаяСтавка1РНаДату) Тогда
								РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
								Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1Р)).Размер;
								РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред), 
								Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1РНаДату)).Размер;
								Если Регистратор.ПериодРегистрации >= Дата(2016,07,01) и ДатаСред < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
									РазмерТСНаДату = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСНаДату / 10000,СтрокаДвижений.ПериодРегистрации);
								КонецЕсли;
								
								//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
								Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
									ОтборСтавки = Новый Структура( "Организация, ТарифнаяСтавка", СтрокаДвижений.Организация, ТарифнаяСтавка1РНаДату );
									РазмерТекущегоТСПериода = 
									ПолучитьЭталоннуюТС( ДатаСред, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
								КонецЕсли; 
								//- СВЭЙ КДЯ 03.01.20 СВФР-005167
								
							Иначе
								РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
								Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
								РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред), 
								Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
								Если Регистратор.ПериодРегистрации >= Дата(2016,07,01) и ДатаСред < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
									РазмерТСНаДату = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСНаДату / 10000,Регистратор.ПериодРегистрации);
								КонецЕсли;
								
								//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
								Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
									ОтборСтавки = Новый Структура( "Организация", СтрокаДвижений.Организация );
									РазмерТекущегоТСПериода = 
									ПолучитьЭталоннуюТС( ДатаСред, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
								КонецЕсли; 
								//- СВЭЙ КДЯ 03.01.20 СВФР-005167
								
							КонецЕсли;
							
							
							
						КонецЕсли;
					иначе
						//О.Т. 23.02.2015 № 331
						если не(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетСреднегоПоСотрудникам") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")) Тогда //О.Т. Аверсон 09.02.2018 № 1566 + средний
							ПериодПоследнегоОкл =  ТекущаяДата();
							
							//+ СВЭЙ КДЯ 27.01.20 СВФР-005409
						иначеесли ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
							
							ДанныеПоследнегоОклада = ПолучитьДанныеПоследнегоОклада( ДатаСред, СтрокаДвижений );
							ПериодПоследнегоОкл = ДанныеПоследнегоОклада.ПериодПоследнегоОкл;
							РазмерПоследнегоОкл = ДанныеПоследнегоОклада.РазмерПоследнегоОкл;
							ТЗ_СтавкиДоПонижения = ДанныеПоследнегоОклада.ТЗ_СтавкиДоПонижения;
							//- СВЭЙ КДЯ 27.01.20 СВФР-005409
							
						иначе
							ДолжностьРаботника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред),Новый Структура("Организация,Сотрудник",СтрокаДвижений.Организация,СтрокаДвижений.Сотрудник)).Должность;							
							ЗапросОкладПосл = Новый Запрос;
							ЗапросОкладПосл.Текст = 
							"ВЫБРАТЬ
							|	ТарифныеСтавкиРаботниковОрганизации.Период
							|ИЗ
							|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
							|			,
							|			Организация = &Организация
							|				И Должность = &Должность И НЕ Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследних
							|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиРаботниковОрганизации КАК ТарифныеСтавкиРаботниковОрганизации
							|		ПО РаботникиОрганизацийСрезПоследних.Регистратор = ТарифныеСтавкиРаботниковОрганизации.Регистратор
							|			И РаботникиОрганизацийСрезПоследних.Сотрудник = ТарифныеСтавкиРаботниковОрганизации.Сотрудник
							|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиРаботниковОрганизации.Организация
							|ГДЕ
							|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
							
							ЗапросОкладПосл.УстановитьПараметр("Должность", ДолжностьРаботника);
							ЗапросОкладПосл.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
							ЗапросОкладПосл.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
							
							РезультатОкладПосл = ЗапросОкладПосл.Выполнить().Выбрать();	
							ПериодПоследнегоОкл = ТекущаяДата();
							Пока РезультатОкладПосл.Следующий() Цикл
								ПериодПоследнегоОкл = РезультатОкладПосл.Период;
							КонецЦикла;
						КонецЕсли;
						//О.Т. 23.02.2015 № 331
						
						
						РазмерПоследнегоОкл =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(ПериодПоследнегоОкл, 
						Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ПериодПоследнегоОкл < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
							РазмерПоследнегоОкл = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерПоследнегоОкл / 10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
						Оклад = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред), 
						Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
						Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,01) и ДатаСред < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
							Оклад = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад / 10000,СтрокаДвижений.ПериодРегистрации);
						КонецЕсли;
						
						//Островская Татьяна 17.06.2013 № 16558
						если СтрокаДвижений.Организация.РасчетКоэффициентовВОтпускахПоТС Тогда 
							Запрос = Новый Запрос;
							Запрос.Текст = 
							"ВЫБРАТЬ
							|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда КАК ТарифнаяСтавкаПервогоРазряда
							|ИЗ
							|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
							|			&Период,
							|			Сотрудник = &Сотрудник
							|				И организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
							
							Запрос.УстановитьПараметр("Организация", СтрокаДвижений.Организация);
							Запрос.УстановитьПараметр("Период", Регистратор.ПериодРегистрации);
							Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);		
							Результат = Запрос.Выполнить();	
							ВыборкаДетальныеЗаписи = Результат.Выбрать();
							ТарифнаяСтавка1Р = "";
							Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
								ТарифнаяСтавка1Р = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
							КонецЦикла;
							Запрос.УстановитьПараметр("Период", КонецМесяца(ДатаСред));
							Результат = Запрос.Выполнить();	
							ВыборкаДетальныеЗаписи = Результат.Выбрать();
							ТарифнаяСтавка1РНаДату = "";
							Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
								ТарифнаяСтавка1РНаДату = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
							КонецЦикла;
							
							если ЗначениеЗаполнено(ТарифнаяСтавка1Р) и ЗначениеЗаполнено(ТарифнаяСтавка1РНаДату) Тогда
								РазмерТекущегоТСПериода =  РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
								Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1Р)).Размер;
								РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред), 
								Новый Структура("Организация,ТарифнаяСтавка", СтрокаДвижений.Организация,ТарифнаяСтавка1РНаДату)).Размер;
								Если Регистратор.ПериодРегистрации >= Дата(2016,07,01) и ДатаСред < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
									РазмерТСНаДату = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСНаДату / 10000,Регистратор.ПериодРегистрации);
								КонецЕсли;
								
								//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
								Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
									ОтборСтавки = Новый Структура( "Организация, ТарифнаяСтавка", СтрокаДвижений.Организация, ТарифнаяСтавка1РНаДату );
									РазмерТекущегоТСПериода = 
									ПолучитьЭталоннуюТС( ДатаСред, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
								КонецЕсли; 
								//- СВЭЙ КДЯ 03.01.20 СВФР-005167
								
							Иначе
								РазмерТекущегоТСПериода = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(Регистратор.ПериодРегистрации, 
								Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
								РазмерТСНаДату = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(КонецМесяца(ДатаСред), 
								Новый Структура("Организация", СтрокаДвижений.Организация)).Размер;
								Если Регистратор.ПериодРегистрации >= Дата(2016,07,01) и ДатаСред < Дата(2016,07,01) Тогда //О.Т. Аверсон 18.07.2016
									РазмерТСНаДату = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерТСНаДату / 10000,Регистратор.ПериодРегистрации);
								КонецЕсли;
								
								//+ СВЭЙ КДЯ 03.01.20 СВФР-005167
								Если РазмерТСНаДату > 0 И РазмерТекущегоТСПериода / РазмерТСНаДату > 2 Тогда
									ОтборСтавки = Новый Структура( "Организация", СтрокаДвижений.Организация );
									РазмерТекущегоТСПериода = 
									ПолучитьЭталоннуюТС( ДатаСред, Регистратор.ПериодРегистрации, ОтборСтавки, РазмерТекущегоТСПериода, РазмерТСНаДату );
								КонецЕсли; 
								//- СВЭЙ КДЯ 03.01.20 СВФР-005167
								
							КонецЕсли;							
							
						КонецЕсли;
						
					КонецЕсли;
					
					
					ДопСтрокаДвижений.ТекущаяТарифнаяСтавка =  РазмерПоследнегоОкл;
					ДопСтрокаДвижений.ТарифнаяСтавкаПериода 		 = Оклад;	
					ДопСтрокаДвижений.ЧислоМесяцев 		 = 1;
					ДопСтрокаДвижений.МесяцВыборки 		 = ДатаСред;		
					СтрокиВремени = ВыборкаОтработанноеВремя.НайтиСтроки(СтруктураПоискаДоп);
					если СтрокиВремени.Количество()>0 Тогда 
						ДопСтрокаДвижений.ОтработаноПоПятидневке 		 = СтрокиВремени[0].ОтработаноДнейПоПятидневке;//Островская Татьяна 28.12.2012 № 16068
						ДопСтрокаДвижений.НормаПоПятидневке 		 = СтрокиВремени[0].НормаДнейПоПятидневке; //Островская Татьяна 28.12.2012 № 16068
					КонецЕсли;
					мНорма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(ДатаСред), КонецМесяца(ДатаСред), СтрокаДвижений.Сотрудник);
					ДопСтрокаДвижений.НормаДней 					= мНорма.НормаДней;//Островская Татьяна 28.12.2012 № 16068
					ДопСтрокаДвижений.НормаЧасов 					= мНорма.НормаЧасов;//Островская Татьяна 28.12.2012 № 16068
					КалендарныеДни = ПолучитьКалендарныеДниБезОтпускаБольничного(СтрокаДвижений.Сотрудник,ДатаСред, ложь,,,СообщениеОПересечении); //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
					ДопСтрокаДвижений.ОтработаноДней = КалендарныеДни;
					ДопСтрокаДвижений.ОтработаноПоПятидневке = КалендарныеДни;
					ДопСтрокаДвижений.Включать = Истина;
					ДопСтрокаДвижений.ДатаНачалаСобытия = ДатаНачалаСобытия;
					ДопСтрокаДвижений.ДатаНачалаРасчетногоПериода = ДатаНачалаРасчетаСреднего;
					ДопСтрокаДвижений.ДатаОкончанияРасчетногоПериода = ДатаОкончанияРасчетаСреднего;
					//КонецЕсли;
				КонецЕсли;
				
				
				
				
				ДатаСред = ДобавитьМесяц(ДатаСред,1);
				МесяцСред = Месяц(ДатаСред);
			КонецЦикла;
		КонецЕсли;
	КонецЕсли;
	//О.Т. 05.10.2014 № 
	
	//О.Т. 18.03.2015 № 382
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") 
		ИЛИ ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда  //Аверсон 21.04.2022 КВВ СВФР-008956
		ОсталосьОграничить = 0;
		МесяцПрошл = "";
		МесяцПрошлДляСообщения = "";
		Для Каждого стрРасчетСреднего из ТаблицаЗаписей	Цикл 
			//О.Т. Аверсон 25.03.2016 № 950
			Если СтрокаДвижений.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
				ВидНалогообложения = СтрокаДвижений.Организация.ОсновнаяСтавкаНалогообложения;
			иначе
				ВидНалогообложения = СтрокаДвижений.Сотрудник.ВидНалогообложенияОсновной;
			КонецЕсли;
			//О.Т. Аверсон 25.03.2016 № 950
			СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(НачалоМесяца(стрРасчетСреднего.МесяцВыборки)-1,Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",СтрокаДвижений.Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 25.03.2016 № 950
			РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(стрРасчетСреднего.МесяцВыборки)-1,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;//О.Т. Аверсон 25.03.2016 № 950
			Если СтрокаДвижений.ПериодРегистрации >= Дата(2016,07,1) и стрРасчетСреднего.МесяцВыборки < Дата(2016,07,1) Тогда //О.Т. Аверсон 01.11.2016 № 1498
				РазмерСреднейЗарплаты = ОбщегоНазначения.ОкруглитьЗначение2016(РазмерСреднейЗарплаты/10000,СтрокаДвижений.ПериодРегистрации);
			КонецЕсли;
			БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
			если МесяцПрошл <> стрРасчетСреднего.МесяцВыборки Тогда 
				ОсталосьОграничить = БазаОграниченияФСЗН;
			КонецЕсли;
			
			если стрРасчетСреднего.Результат > ОсталосьОграничить Тогда 
				стрРасчетСреднего.Результат = ОсталосьОграничить;
				ОсталосьОграничить = 0;
			иначе
				ОсталосьОграничить = ОсталосьОграничить-стрРасчетСреднего.Результат;
			КонецЕсли;
			если БазаОграниченияФСЗН = 0 и МесяцПрошлДляСообщения <> НачалоМесяца(стрРасчетСреднего.МесяцВыборки)-1 Тогда 
				Сообщить("В месяце "+Формат(НачалоМесяца(стрРасчетСреднего.МесяцВыборки)-1,"ДЛФ=Д")+" не заполнен размер средней зарплаты!");
			КонецЕсли;		
			МесяцПрошл = стрРасчетСреднего.МесяцВыборки;
			МесяцПрошлДляСообщения = НачалоМесяца(стрРасчетСреднего.МесяцВыборки)-1;
		КонецЦикла;
	КонецЕсли;
	//О.Т. 18.03.2015 № 382
	
	//+ СВЭЙ КДЯ 04.09.19 СВФР-004448
	ОбъемВыборки = 0;
	Если ТаблицаЗаписей.Количество() = 0 Тогда
		//объем выборки = 0
	ИначеЕсли ТипРегистратора = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) Тогда
		
		//+ СВЭЙ КДЯ 26.09.19 СВФР-004448
		Если НЕ ЗначениеЗаполнено( ДатаПриемаРаботника ) Тогда
			ДатаПриемаРаботника	= УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Регистратор.Сотрудник );
		КонецЕсли; 
		//- СВЭЙ КДЯ 26.09.19 СВФР-004448
		
		ОбъемВыборки = УчетВремениСвэй.ПолучитьОбъемВыборкиВМесяцах( ДатаПриемаРаботника, 
		Регистратор.ДатаНачалаВыборки, Регистратор.ДатаНачалаОсновногоОтпуска, 12 );
		
		//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
		
		//Аверсон ЕАЕ 17.10.2022 СВФР-009668
		//ВидРасчетаВыборки = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
		Если Регистратор.РасчетПриНеполныхМесяцах Тогда
			ВидРасчетаВыборки = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах;
		Иначе
			ВидРасчетаВыборки = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
		КонецЕсли;
		//Аверсон СВФР-009668
		
		//- СВЭЙ КДЯ 05.09.19 СВФР-004448
		
	ИначеЕсли ТипРегистратора = Тип( "ДокументСсылка.ОплатаПоСреднемуЗаработку" ) Тогда
		
		//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
		
		МаксимальныйОбъемВыборки = ?( ЗначениеЗаполнено( МаксимальныйОбъемВыборки ), МаксимальныйОбъемВыборки, 12 );
		ДатаНачалаСобытия = ?( ЗначениеЗаполнено( ДатаНачалаСобытия ), ДатаНачалаСобытия, Дата( 1, 1, 1 ) ); //чтобы тип был гарантированно Дата
		ДатаНачалаВыборки = ?( ЗначениеЗаполнено( ДатаНачалаВыборки ), ДатаНачалаВыборки, Дата( 1, 1, 1 ) ); //чтобы тип был гарантированно Дата
		
		//+ СВЭЙ КДЯ 26.09.19 СВФР-004448
		Если НЕ ЗначениеЗаполнено( ДатаПриемаРаботника ) Тогда
			Если ТаблицаЗаписей.Количество() > 0 Тогда
				Сотрудник = ТаблицаЗаписей[0].Сотрудник;
			Иначе	
				Сотрудник = Регистратор.Сотрудник;
			КонецЕсли; 
			ДатаПриемаРаботника = УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Сотрудник );
		КонецЕсли; 
		//- СВЭЙ КДЯ 26.09.19 СВФР-004448
		
		ОбъемВыборки = УчетВремениСвэй.ПолучитьОбъемВыборкиВМесяцах( ДатаПриемаРаботника, 
		ДатаНачалаВыборки, ДатаНачалаСобытия, МаксимальныйОбъемВыборки );
		
		ВидРасчетаВыборки = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
		//- СВЭЙ КДЯ 05.09.19 СВФР-004448
		
	ИначеЕсли ТипРегистратора = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" ) Тогда
		
		//+ СВЭЙ КДЯ 26.09.19 СВФР-004448
		Если НЕ ЗначениеЗаполнено( ДатаПриемаРаботника ) Тогда
			ДатаПриемаРаботника	= УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Регистратор.Сотрудник );
		КонецЕсли; 
		//- СВЭЙ КДЯ 26.09.19 СВФР-004448
		
		//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
		МаксимальныйОбъемВыборки = ?( ЗначениеЗаполнено( МаксимальныйОбъемВыборки ), МаксимальныйОбъемВыборки, 12 );
		
		//ДатаНачалаСобытия = ?( ЗначениеЗаполнено( ДатаНачалаСобытия ), ДатаНачалаСобытия, Регистратор.ДатаУвольнения );
		ДатаНачалаСобытия = ?(ЗначениеЗаполнено(Регистратор.ДатаВыборки),Регистратор.ДатаВыборки,?( ЗначениеЗаполнено( ДатаНачалаСобытия ), ДатаНачалаСобытия, Регистратор.ДатаУвольнения )); //Аверсон 19.06.2023 КВВ СВФР-010940
		
		
		ОбъемВыборки = УчетВремениСвэй.ПолучитьОбъемВыборкиВМесяцах( ДатаПриемаРаботника, 
		ДатаНачалаВыборки, ДатаНачалаСобытия, МаксимальныйОбъемВыборки );
		
		//Аверсон ЕАЕ 05.08.2022 СВФР-009371
		ОбъемВыборкиДляОтпуска = УчетВремениСвэй.ПолучитьОбъемВыборкиВМесяцах(ДатаПриемаРаботника, 
		, ДатаНачалаСобытия, 12);
		//Аверсон СВФР-009371
		
		ВидРасчетаВыборки = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
		//- СВЭЙ КДЯ 05.09.19 СВФР-004448
		
	ИначеЕсли ТипРегистратора = Тип( "ДокументСсылка.РасчетСреднегоПоСотрудникам" ) Тогда
		
		//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
		МаксимальныйОбъемВыборки = ?( ЗначениеЗаполнено( МаксимальныйОбъемВыборки ), МаксимальныйОбъемВыборки, 12 );
		
		ДатаНачалаСобытия = ?( ЗначениеЗаполнено( ДатаНачалаСобытия ), ДатаНачалаСобытия, Дата( 1, 1, 1 ) ); //чтобы тип был гарантированно Дата
		ДатаНачалаВыборки = ?( ЗначениеЗаполнено( ДатаНачалаВыборки ), ДатаНачалаВыборки, Дата( 1, 1, 1 ) ); //чтобы тип был гарантированно Дата
		
		ОбъемВыборки = УчетВремениСвэй.ПолучитьОбъемВыборкиВМесяцах( ДатаПриемаРаботника, 
		ДатаНачалаВыборки, ДатаНачалаСобытия, МаксимальныйОбъемВыборки );
		
		ВидРасчетаВыборки = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
		//- СВЭЙ КДЯ 05.09.19 СВФР-004448
		
	ИначеЕсли ТипРегистратора = Тип( "ДокументСсылка.НачислениеПоБольничномуЛисту" ) Тогда	
		
		//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
		МаксимальныйОбъемВыборки = ?( ЗначениеЗаполнено( МаксимальныйОбъемВыборки ), МаксимальныйОбъемВыборки, 6 );
		ДатаНачалаСобытия = ?( ЗначениеЗаполнено( ДатаНачалаСобытия ), ДатаНачалаСобытия, Регистратор.ДатаНачала );
		ДатаНачалаВыборки = ?( ЗначениеЗаполнено( ДатаНачалаВыборки ), ДатаНачалаВыборки, Дата( 1, 1, 1 ) ); //чтобы тип был гарантированно Дата
		
		//+ СВЭЙ КДЯ 26.09.19 СВФР-004448
		Если НЕ ЗначениеЗаполнено( ДатаПриема ) Тогда
			ДатаПриема = УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Регистратор.Сотрудник );
		КонецЕсли; 
		//- СВЭЙ КДЯ 26.09.19 СВФР-004448
		
		ОбъемВыборки = УчетВремениСвэй.ПолучитьОбъемВыборкиВМесяцах( ДатаПриема, 
		ДатаНачалаВыборки, ДатаНачалаСобытия, МаксимальныйОбъемВыборки );
		
		ВидРасчетаВыборки = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
		//- СВЭЙ КДЯ 05.09.19 СВФР-004448
		
	ИначеЕсли ТипРегистратора = Тип( "ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда" ) Тогда	
		
		//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
		//+ СВЭЙ КДЯ 26.09.19 СВФР-004448
		//Сотрудник = ТаблицаЗаписей[0].Сотрудник;
		//ДатаПриемаРаботника = УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Сотрудник );
		//- СВЭЙ КДЯ 26.09.19 СВФР-004448
		
		//+ СВЭЙ КДЯ 26.09.19 СВФР-004448
		Если НЕ ЗначениеЗаполнено( ДатаПриемаРаботника ) Тогда
			Если ТаблицаЗаписей.Количество() > 0 Тогда
				Сотрудник = ТаблицаЗаписей[0].Сотрудник;
			Иначе	
				Сотрудник = Регистратор.Сотрудник;
			КонецЕсли; 
			ДатаПриемаРаботника = УчетВремениСвэй.ПолучитьДатуПриемаСотрудника( Сотрудник );
		КонецЕсли; 
		//- СВЭЙ КДЯ 26.09.19 СВФР-004448
		
		МаксимальныйОбъемВыборки = ?( ЗначениеЗаполнено( МаксимальныйОбъемВыборки ), МаксимальныйОбъемВыборки, 1 );
		ДатаНачалаСобытия = Макс( ДатаНачалаСобытия, ДобавитьМесяц( НачалоМесяца( ДатаОкончанияВыборки ), 1 ) );
		ДатаНачалаВыборки = ?( ЗначениеЗаполнено( ДатаНачалаВыборки ), ДатаНачалаВыборки, Дата( 1, 1, 1 ) ); //чтобы тип был гарантированно Дата
		
		ОбъемВыборки = УчетВремениСвэй.ПолучитьОбъемВыборкиВМесяцах( ДатаПриемаРаботника, 
		ДатаНачалаВыборки, ДатаНачалаСобытия, МаксимальныйОбъемВыборки );
		
		ВидРасчетаВыборки = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
		//- СВЭЙ КДЯ 05.09.19 СВФР-004448
		
	КонецЕсли; 	
	
	Если ТипРегистратора <> Тип( "ДокументСсылка.ОплатаПоСреднемуЗаработку" ) Тогда //Аверсон ЕАЕ 23.03.2022 СВФР-008854
		Если ОбъемВыборки > 0 Тогда
			
			//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
			//ВключенныхМесяцев = ТаблицаЗаписей.НайтиСтроки( Новый Структура( "Включать", Истина ) ).Количество();
			//- СВЭЙ КДЯ 05.09.19 СВФР-004448
			
			//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
			ТаблицаЗаписейКопия = ТаблицаЗаписей.Скопировать( Новый Структура( "Включать", Истина ), "МесяцВыборки" );
			ТаблицаЗаписейКопия.Свернуть( "МесяцВыборки" );
			ВключенныхМесяцев = ТаблицаЗаписейКопия.Количество();
			ОтборКорректируемыхСтрокВыборки = Новый Структура( "ВидРасчета, МесяцВыборки", 
			ВидРасчетаВыборки, Неопределено );
			//- СВЭЙ КДЯ 05.09.19 СВФР-004448
			
			Для каждого КлючЗначение Из СоотвСуммыВыборкиККорректировке Цикл
				
				//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
				//КорректируемаяСтрока = ТаблицаЗаписей.Найти( КлючЗначение.Ключ, "МесяцВыборки" );
				//- СВЭЙ КДЯ 05.09.19 СВФР-004448
				
				//+ СВЭЙ КДЯ 05.09.19 СВФР-004448
				ОтборКорректируемыхСтрокВыборки.МесяцВыборки = КлючЗначение.Ключ;						
				КорректируемыеСтроки = ТаблицаЗаписей.НайтиСтроки( ОтборКорректируемыхСтрокВыборки );
				Если КорректируемыеСтроки.Количество() > 0 Тогда
					КорректируемаяСтрока = КорректируемыеСтроки[ 0 ];
				Иначе	
					КорректируемаяСтрока = Неопределено;
				КонецЕсли; 
				//- СВЭЙ КДЯ 05.09.19 СВФР-004448
				
				
				Если КорректируемаяСтрока <> Неопределено Тогда
					
					//Аверсон ЕАЕ 26.07.2022 СВФР-009371
					СтруктураОтбора = Новый Структура;
					СтруктураОтбора.Вставить("МесяцВыборки", КлючЗначение.Ключ);
					СтруктураОтбора.Вставить("СпособРасчета", КорректируемаяСтрока.СпособРасчета);
					СтрокиКорректировка = ТЗКорректировка.НайтиСтроки(СтруктураОтбора);
					Если СтрокиКорректировка.Количество() > 0 Тогда
						СтрКорректировка = СтрокиКорректировка[0];
						
						//КорректируемаяСтрока.Результат = 
						//КорректируемаяСтрока.Результат 
						//+ СтрКорректировка.Сумма * ВключенныхМесяцев / ОбъемВыборки
						//- СтрКорректировка.Сумма; 
						Если ТипРегистратора = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций")
							И КорректируемаяСтрока.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням Тогда
							ОВ = ОбъемВыборкиДляОтпуска;
						Иначе
							ОВ = ОбъемВыборки;
						КонецЕсли;
						КорректируемаяСтрока.Результат = 
						КорректируемаяСтрока.Результат 
						+ СтрКорректировка.Сумма * ВключенныхМесяцев / ОВ
						- СтрКорректировка.Сумма; 
						
					КонецЕсли;
					
					//КорректируемаяСтрока.Результат = 
					//КорректируемаяСтрока.Результат 
					//+ КлючЗначение.Значение * ВключенныхМесяцев / ОбъемВыборки
					//- КлючЗначение.Значение; 
					//Аверсон СВФР-009371
					
				КонецЕсли; 
				
			КонецЦикла; // КлючЗначение Из СоотвСуммыВыборкиККорректировке
		КонецЕсли; // ОбъемВыборки > 0
		//- СВЭЙ КДЯ 04.09.19 СВФР-004448
	КонецЕсли;
	
	//Аверсон 22.09.2020 КВВ СВФР-006593 (
	Для Каждого СтрТаблицаЗаписей ИЗ ТаблицаЗаписей Цикл
		Если  СтрТаблицаЗаписей.ВидРасчета <> ПланыВидовРасчета.СреднийЗаработок.ПоПремиям
			И СтрТаблицаЗаписей.ВидРасчета <> ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям
			И СтрТаблицаЗаписей.ВидРасчета <> ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии
			И СтрТаблицаЗаписей.ВидРасчета <> ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему Тогда
			СтрТаблицаЗаписей.РезультатДляПремии = 0;
		КонецЕсли;
	КонецЦикла;
	//Аверсон 22.09.2020 КВВ СВФР-006593 )
	Если Регистратор.Организация.ИНН = "700067572" тогда
		
		//ПСА 17.08.2021 СВФР-007864+++
		ТаблицаЗаписей.Сортировать("МесяцВыборки Убыв");     
		БылоСовершенствование= ложь;
		МесяцСоверш = "";
		Для Каждого СтрТаблицаЗаписей ИЗ ТаблицаЗаписей Цикл
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда,
			|	РаботникиОрганизацийСрезПоследних.Организация
			|ПОМЕСТИТЬ ВтТарифныеСтавки
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
			|			&ДатаСреза,
			|			Организация = &Организация
			|				И Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Совершенствование
			|ИЗ
			|	РегистрСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.СрезПоследних(
			|			&ДатаСреза,
			|			(Организация, ТарифнаяСтавка) В
			|				(ВЫБРАТЬ
			|					ВтТарифныеСтавки.Организация,
			|					ВтТарифныеСтавки.ТарифнаяСтавкаПервогоРазряда
			|				ИЗ
			|					ВтТарифныеСтавки КАК ВтТарифныеСтавки)) КАК ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних";
			
			Запрос.УстановитьПараметр("ДатаСреза", СтрТаблицаЗаписей.МесяцВыборки);
			Запрос.УстановитьПараметр("Организация", СтрТаблицаЗаписей.Организация);
			Запрос.УстановитьПараметр("Сотрудник", СтрТаблицаЗаписей.Сотрудник);
			
			РезультатЗапроса = Запрос.Выполнить();
			
			Выборка = РезультатЗапроса.Выбрать();
			
			Если Выборка.Следующий() Тогда
				Если БылоСовершенствование Тогда
					ЗапросВ = Новый Запрос;
					ЗапросВ.Текст = 
					"ВЫБРАТЬ
					|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда
					|ИЗ
					|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
					|			&Период,
					|			Сотрудник = &Сотрудник
					|				И Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
					
					ЗапросВ.УстановитьПараметр("Организация", СтрТаблицаЗаписей.Организация);
					ЗапросВ.УстановитьПараметр("Период", МесяцСоверш);
					ЗапросВ.УстановитьПараметр("Сотрудник", СтрТаблицаЗаписей.Сотрудник);
					
					РезультатЗапроса = ЗапросВ.Выполнить();
					
					ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
					
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						ВидСтавки = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
					КонецЦикла;      		
					
					
					ЗапросР = Новый Запрос;
					ЗапросР.УстановитьПараметр("Организация", СтрТаблицаЗаписей.Организация);
					ЗапросР.УстановитьПараметр("Период", МесяцСоверш);
					ЗапросР.УстановитьПараметр("ТарифнаяСтавка", ВидСтавки);
					ЗапросР.Текст =
					"ВЫБРАТЬ
					|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер
					|ИЗ
					|	РегистрСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.СрезПоследних(
					|			&Период,
					|			Организация = &Организация
					|				И ТарифнаяСтавка = &ТарифнаяСтавка) КАК ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних";
					
					Ставка = ЗапросР.Выполнить().Выбрать();
					Если Ставка.Следующий() тогда
						ТС1Разряда =  Ставка.Размер;
					КонецЕсли;  
					ПорядокОкругления = Константы.АВ_ПорядокОкругленияКоэффициентаИндексации.Получить();
					СтрТаблицаЗаписей.ТекущаяТарифнаяСтавка = ТС1Разряда;
					СтрТаблицаЗаписей.КоэффициентИндексации = Окр(СтрТаблицаЗаписей.ТекущаяТарифнаяСтавка/СтрТаблицаЗаписей.ТарифнаяСтавкаПериода,ПорядокОкругления);
				КонецЕсли;
				Если Выборка.Совершенствование Тогда
					СтрТаблицаЗаписей.КоэффициентИндексации = 1;
					БылоСовершенствование = Истина;
					МесяцСоверш = СтрТаблицаЗаписей.МесяцВыборки -1;
				ИначеЕсли СтрТаблицаЗаписей.КоэффициентИндексации > 1 и не БылоСовершенствование  Тогда
					ЗапросВ = Новый Запрос;
					ЗапросВ.Текст = 
					"ВЫБРАТЬ
					|	РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда
					|ИЗ
					|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
					|			&Период,
					|			Сотрудник = &Сотрудник
					|				И Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних";
					
					ЗапросВ.УстановитьПараметр("Организация", СтрТаблицаЗаписей.Организация);
					ЗапросВ.УстановитьПараметр("Период", Регистратор.Дата);
					ЗапросВ.УстановитьПараметр("Сотрудник", СтрТаблицаЗаписей.Сотрудник);
					
					РезультатЗапроса = ЗапросВ.Выполнить();
					
					ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
					
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						ВидСтавки = ВыборкаДетальныеЗаписи.ТарифнаяСтавкаПервогоРазряда;
					КонецЦикла;      		
					ЗапросР = Новый Запрос;
					ЗапросР.УстановитьПараметр("Организация", СтрТаблицаЗаписей.Организация);
					ЗапросР.УстановитьПараметр("Период", Регистратор.Дата);
					ЗапросР.УстановитьПараметр("ТарифнаяСтавка", ВидСтавки);
					ЗапросР.Текст =
					"ВЫБРАТЬ
					|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер,
					|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Совершенствование
					|ИЗ
					|	РегистрСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.СрезПоследних(
					|			&Период,
					|			Организация = &Организация
					|				И ТарифнаяСтавка = &ТарифнаяСтавка) КАК ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних";
					
					Ставка = ЗапросР.Выполнить().Выбрать();
					Если Ставка.Следующий() тогда
						ТС1Разряда =  Ставка.Размер;
						БылоСовершенствование = Ставка.Совершенствование;
					КонецЕсли;  
					Если БылоСовершенствование Тогда
						СтрТаблицаЗаписей.КоэффициентИндексации = 1;
						МесяцСоверш = СтрТаблицаЗаписей.МесяцВыборки;
					кОнецЕсли;
				КонецЕсли	
			КонецЕсли;
		КонецЦикла;	
	КонецЕсли;
	//+++ПСА 17.08.2021 СВФР-007864
	
	//Аверсон ЕАЕ 18.10.2022 СВФР-009668
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") И Регистратор.РасчетПриНеполныхМесяцах Тогда
		Для Каждого Стр Из ТаблицаЗаписей Цикл
			Стр.Включать = Истина;
		КонецЦикла;
	КонецЕсли;
	//Аверсон СВФР-009668
	
	НаборЗаписей.Загрузить(ТаблицаЗаписей);
	
	НаборЗаписей.Записать(Истина,);
	
	//Аверсон 27.12.2021 КВВ СВФР-008547 (
	Если ЗначениеЗаполнено(СообщениеОПересечении)
		И ТипЗнч(Регистратор) <> Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") 
		И ТипЗнч(Регистратор) <> Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций")  Тогда //Аверсон 11.07.2022 КВВ СВФР-009306
		Сообщить("На " + СообщениеОПересечении + " введены пересекающиеся данные!"); 
	КонецЕсли;
	//Аверсон 27.12.2021 КВВ СВФР-008547 )
	
КонецПроцедуры

// Получает данные для расчета ресурсов записей регистра расчета
//
//	ИмяРегистра - строка, имя регистра расчета
//	КатегорияРасчета - ссылка на значение перечисленич КатегорииРасчетов
//	НеобходимыеДанные - Структура с элементами 
//			База,
//			НормаВремени,
//			ОтработаноВремени,
//			...
//	Регистратор - ссылка на документ
//	Организация - ссылка на организацию по которой проводится Регистратор
//	ПериодРегистрации
//	Перерасчет - булево - признак того, что получаем данные для случая перерасчета
//	Физлица - массив ссылок на физлиц - выбранные для перерасчета физлица, или массив содержащий ссылку
//			  на физлицо по которому производится расчет (расчет по одному работнику из документа)	
//
// Возвращает выборку результата запроса
Функция ПолучитьДанныеДляРасчета(ИмяРегистра,
	КатегорияНачисления,
	НеобходимыеДанные,
	Регистратор,
	Организация,
	ПериодРегистрации,
	Перерасчет = Ложь,
	Физлица = Неопределено,
	КомментироватьРасчет = Ложь, ФормаКомментариев = НеОпределено,ПериодСреднегоПоОкладу = Неопределено,ТекЗначение=Неопределено,РеальныйРегистратор = Неопределено) Экспорт //О.Т. 18.02.2015 № 334(ПериодСреднегоПоОкладу) //Аверсон 13.01.2022 КВВ СВФР-008577 (РеальныйРегистратор)
	
	Если ПериодСреднегоПоОкладу = Неопределено Тогда
		ПериодСреднегоПоОкладу = Дата(1,1,1);
	КонецЕсли;
	
	
	/////////////////////////////////////////////////////////////////////
	// Вложенные запросы
	// для получения данных расчета
	// Реализованы как временные таблицы
	
	// таблица СотрудникиДляПерерасчетаТекст
	// Список сотрудников по которым необходимо выполнить перерасчет
	// Поля:
	//		Сотрудник
	// Описание:
	// Получает список неповторяющихся сотрудников по которым есть записи
	// перерасчета в одной из таблиц перерасчета - по основным или дополнительным начислениям
	//
	ФизлицаДляПерерасчетаТекст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Перерасчет.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ ВТФизлицаДляПерерасчета
	|ИЗ
	|	(ВЫБРАТЬ
	|		Перерасчет.Физлицо КАК Физлицо
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ПерерасчетОсновныхНачислений КАК Перерасчет
	|	ГДЕ
	|		Перерасчет.ОбъектПерерасчета = &парамРегистратор
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Перерасчет.Физлицо
	|	ИЗ
	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.ПерерасчетДополнительныхНачислений КАК Перерасчет
	|	ГДЕ
	|		Перерасчет.ОбъектПерерасчета = &парамРегистратор) КАК Перерасчет
	|ИНДЕКСИРОВАТЬ ПО 
	|	Физлицо";
	
	// ДанныеОСреднемЗаработке
	//		Таблица данных о среднем заработке
	// 
	//	Поля:
	//		СреднийЗаработок - суммируем
	//		ОтработаноДней - для расчета среднего
	//		ОтработаноЧасов - для расчета среднего
	//		Сотрудник,
	//		СпособРасчета,                 - это для идентификации записи в основном регистре расчета
	//		ДатаНачалаРасчетногоПериода,   - это для идентификации записи в основном регистре расчета
	//		ДатаОкончанияРасчетногоПериода - это для идентификации записи в основном регистре расчета
	// 
	// Описание:
	//
	//	выбираем из РегистрРасчета.РасчетСреднегоЗаработка
	//	по регистратору
	//Островская Татьяна 28.04.2014 № 17316
	
	//О.Т. Аверсон 28.02.2017 № 215
	ДанныеОСреднемЗаработкеДляОкладаТекст =
	"ВЫБРАТЬ
	|	СУММА(ВЫБОР
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|				ТОГДА РасчетСреднегоЗаработка.Результат * РасчетСреднегоЗаработка.КоэффициентИндексации
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоФиксПремиям
	|				ТОГДА ВЫБОР
	|						КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0
	|							ТОГДА 0
	|						ИНАЧЕ РасчетСреднегоЗаработка.Результат * РасчетСреднегоЗаработка.КоэффициентИндексации
	|					КОНЕЦ
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоПремиям
	|				ТОГДА ВЫБОР
	|						КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0
	|							ТОГДА 0
	|						ИНАЧЕ РасчетСреднегоЗаработка.Результат * РасчетСреднегоЗаработка.КоэффициентИндексации
	|					КОНЕЦ
	|           КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоГодовымПремиям
	|	            ТОГДА РасчетСреднегоЗаработка.Результат * 
	//|	        ВЫБОР
	//|			КОГДА РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку
	//|				И &парамПериодРегистрации >= ДАТАВРЕМЯ(2017, 10, 1)
	//|			ТОГДА 1
	//|				ИНАЧЕ 
	|	        ВЫБОР
	|			КОГДА ЕСТЬNULL(РасчетСреднегоЗаработка.НормаПоПятидневке, 0) = 0
	|				ТОГДА 1
	|			ИНАЧЕ РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
	|		КОНЕЦ  * Выбор когда РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку тогда ВЫБОР //конец
	|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
	|								ТОГДА 1
	|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
	|						КОНЕЦ иначе 1 конец * ВЫБОР
	|			КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
	|				ТОГДА РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / РасчетСреднегоЗаработка.ЧислоМесяцев
	|			ИНАЧЕ 1
	|		КОНЕЦ
	
	|			КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетСреднегоЗаработка.Результат * ВЫБОР
	|					КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
	|						ТОГДА РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / РасчетСреднегоЗаработка.ЧислоМесяцев
	|					ИНАЧЕ 1
	|				КОНЕЦ
	|		КОНЕЦ) КАК СреднийЗаработокДляОклада,
	|	СУММА(ВЫБОР
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|				ТОГДА РасчетСреднегоЗаработка.ОтработаноДней
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОтработаноДней,
	|	СУММА(ВЫБОР
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|				ТОГДА РасчетСреднегоЗаработка.ОтработаноЧасов
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОтработаноЧасов,
	|	РасчетСреднегоЗаработка.Сотрудник КАК Сотрудник,
	|	РасчетСреднегоЗаработка.ФизЛицо КАК ФизЛицо,
	|	РасчетСреднегоЗаработка.Организация КАК Организация,
	|	РасчетСреднегоЗаработка.СпособРасчета КАК СпособРасчета,
	|	РасчетСреднегоЗаработка.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|	РасчетСреднегоЗаработка.ДатаНачалаРасчетногоПериода КАК ДатаНачалаРасчетногоПериода,
	|	РасчетСреднегоЗаработка.ДатаОкончанияРасчетногоПериода КАК ДатаОкончанияРасчетногоПериода,
	|	ВложенныйЗапрос.ЧислоМесяцев
	//|	РасчетСреднегоЗаработка.НомерДоговора,
	//|	РасчетСреднегоЗаработка.ДатаДоговора  //О.Т. 13.10.2014 № 17616
	|ПОМЕСТИТЬ ВТДанныеОСреднемЗаработкеДляОклада
	|ИЗ
	|	РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка,
	|	(ВЫБРАТЬ
	|		СУММА(ВложенныйЗапрос.ЧислоМесяцев) КАК ЧислоМесяцев
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ВЫБОР
	|				КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|						ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|						ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|					ТОГДА ВЫБОР
	|							КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > 1
	|								ТОГДА 1
	|							ИНАЧЕ РасчетСреднегоЗаработка.ЧислоМесяцев
	|						КОНЕЦ
	|				ИНАЧЕ 0
	|			КОНЕЦ КАК ЧислоМесяцев,
	|			РасчетСреднегоЗаработка.МесяцВыборки КАК МесяцВыборки
	|		ИЗ
	|			РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
	|		ГДЕ
	|			РасчетСреднегоЗаработка.Регистратор = &парамРегистратор" + ?(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту"),"ОснПервич","") + " //СВЭЙ 02.02.2024 КВВ СВФР-012133
	|			И РасчетСреднегоЗаработка.ВидРасчета <> 0
	|           //И РасчетСреднегоЗаработка.Включать
	|		
	|		СГРУППИРОВАТЬ ПО
	|			РасчетСреднегоЗаработка.МесяцВыборки,
	|			ВЫБОР
	|				КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|						ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|						ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|					ТОГДА ВЫБОР
	|							КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > 1
	|								ТОГДА 1
	|							ИНАЧЕ РасчетСреднегоЗаработка.ЧислоМесяцев
	|						КОНЕЦ
	|				ИНАЧЕ 0
	|			КОНЕЦ) КАК ВложенныйЗапрос) КАК ВложенныйЗапрос
	|ГДЕ
	
	//СВЭЙ 02.02.2024 КВВ СВФР-012133 (
	//|	РасчетСреднегоЗаработка.Регистратор = &парамРегистратор"
	//|	И РасчетСреднегоЗаработка.ВидРасчета <> 0
	//|	И РасчетСреднегоЗаработка.МесяцВыборки МЕЖДУ &ПериодСреднегоПоОкладу1 И КОНЕЦПЕРИОДА(&ПериодСреднегоПоОкладу1, МЕСЯЦ) //О.Т. 17.02.2015 № 334
	|	РасчетСреднегоЗаработка.Регистратор = &парамРегистратор" + ?(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту"),"ОснПервич","") + "
	|	И РасчетСреднегоЗаработка.ВидРасчета <> 0
	|	И РасчетСреднегоЗаработка.МесяцВыборки МЕЖДУ &ПериодСреднегоПоОкладу"+ ?(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту"),"ОснПервич","") + "1 И КОНЕЦПЕРИОДА(&ПериодСреднегоПоОкладу" + ?(ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту"),"ОснПервич","") + "1, МЕСЯЦ) //О.Т. 17.02.2015 № 334
	
	//СВЭЙ 02.02.2024 КВВ СВФР-012133 )
	
	|	//И РасчетСреднегоЗаработка.Включать
	|
	|СГРУППИРОВАТЬ ПО
	|	РасчетСреднегоЗаработка.Сотрудник,
	|	РасчетСреднегоЗаработка.ФизЛицо,
	|	РасчетСреднегоЗаработка.Организация,
	|	РасчетСреднегоЗаработка.СпособРасчета,
	|	РасчетСреднегоЗаработка.ДатаНачалаСобытия,
	|	РасчетСреднегоЗаработка.ДатаНачалаРасчетногоПериода,
	|	РасчетСреднегоЗаработка.ДатаОкончанияРасчетногоПериода,
	|	ВложенныйЗапрос.ЧислоМесяцев
	//|	РасчетСреднегоЗаработка.НомерДоговора,
	//|	РасчетСреднегоЗаработка.ДатаДоговора
	| 
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	СпособРасчета,
	|	ДатаНачалаСобытия,
	|	ДатаНачалаРасчетногоПериода,
	|	ДатаОкончанияРасчетногоПериода";
	//Островская Татьяна 28.04.2014 № 17316
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда
		ДанныеОСреднемЗаработкеДляОкладаТекст = СтрЗаменить(ДанныеОСреднемЗаработкеДляОкладаТекст,"//И РасчетСреднегоЗаработка.Включать","И РасчетСреднегоЗаработка.Включать");
	иначе
		ДанныеОСреднемЗаработкеДляОкладаТекст = СтрЗаменить(ДанныеОСреднемЗаработкеДляОкладаТекст,"//И РасчетСреднегоЗаработка.Включать","");
	КонецЕсли;
	//О.Т. Аверсон 28.02.2017 № 215
	
	
	ДанныеОСреднемЗаработкеТекст =
	"ВЫБРАТЬ
	|	СУММА(ВЫБОР
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|				ТОГДА РасчетСреднегоЗаработка.Результат * РасчетСреднегоЗаработка.КоэффициентИндексации
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоФиксПремиям
	|				ТОГДА ВЫБОР
	|						КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0
	|							ТОГДА 0
	|						ИНАЧЕ РасчетСреднегоЗаработка.Результат * РасчетСреднегоЗаработка.КоэффициентИндексации
	|					КОНЕЦ
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоПремиям
	|				ТОГДА ВЫБОР
	|						КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0
	|							ТОГДА 0
	|						ИНАЧЕ РасчетСреднегоЗаработка.Результат * РасчетСреднегоЗаработка.КоэффициентИндексации
	|					КОНЕЦ
	|           КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоГодовымПремиям
	|	            ТОГДА РасчетСреднегоЗаработка.Результат * 
	//|	        ВЫБОР
	//|			КОГДА РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку
	//|					И &парамПериодРегистрации >= ДАТАВРЕМЯ(2017, 10, 1)
	//|				ТОГДА 1
	//|			ИНАЧЕ 
	|	        ВЫБОР
	|			КОГДА ЕСТЬNULL(РасчетСреднегоЗаработка.НормаПоПятидневке, 0) = 0
	|				ТОГДА 1
	|			ИНАЧЕ 
	
	//Аверсон 09.08.2021 КВВ СВФР-007817 (
	//РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
	|ВЫБОР КОГДА 
	|(РасчетСреднегоЗаработка.ОтработаноПоПятидневке < РасчетСреднегоЗаработка.НормаПоПятидневке)
	//ПСА 08.10.2021 СВФР-8202--- |И (РасчетСреднегоЗаработка.КоэффициентИндексации = 1)
	|ТОГДА
	|РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
	|ИНАЧЕ 1
	|КОНЕЦ
	//Аверсон 09.08.2021 КВВ СВФР-007817 )
	
	|		КОНЕЦ  * Выбор когда РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку тогда ВЫБОР //О.Т. Аверсон 22.03.2018 № 1755  //конец
	|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
	|								ТОГДА 1
	|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
	|						КОНЕЦ  иначе 1 конец * ВЫБОР
	|			КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
	|				ТОГДА РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / РасчетСреднегоЗаработка.ЧислоМесяцев
	|			ИНАЧЕ 1
	|		КОНЕЦ
	
	|			КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетСреднегоЗаработка.Результат * ВЫБОР
	|					КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
	|						ТОГДА РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / РасчетСреднегоЗаработка.ЧислоМесяцев
	|					ИНАЧЕ 1
	|				КОНЕЦ
	|		КОНЕЦ) КАК СреднийЗаработок,
	|	СУММА(ВЫБОР
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|				ТОГДА РасчетСреднегоЗаработка.ОтработаноДней
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОтработаноДней,
	|	СУММА(ВЫБОР
	|			КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|				ТОГДА РасчетСреднегоЗаработка.ОтработаноЧасов
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОтработаноЧасов,
	|	РасчетСреднегоЗаработка.Сотрудник КАК Сотрудник,
	|	РасчетСреднегоЗаработка.ФизЛицо КАК ФизЛицо,
	|	РасчетСреднегоЗаработка.Организация КАК Организация,
	|	РасчетСреднегоЗаработка.СпособРасчета КАК СпособРасчета,
	|	РасчетСреднегоЗаработка.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|	РасчетСреднегоЗаработка.ДатаНачалаРасчетногоПериода КАК ДатаНачалаРасчетногоПериода,
	|	РасчетСреднегоЗаработка.ДатаОкончанияРасчетногоПериода КАК ДатаОкончанияРасчетногоПериода,
	|	ВложенныйЗапрос.ЧислоМесяцев
	//|	РасчетСреднегоЗаработка.НомерДоговора,
	//|	РасчетСреднегоЗаработка.ДатаДоговора  //О.Т. 13.10.2014 № 17616
	|ПОМЕСТИТЬ ВТДанныеОСреднемЗаработке
	|ИЗ
	|	РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка,
	|	(ВЫБРАТЬ
	|		СУММА(ВложенныйЗапрос.ЧислоМесяцев) КАК ЧислоМесяцев
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ВЫБОР
	|				КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|						ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|						ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|					ТОГДА ВЫБОР
	|							КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > 1
	|								ТОГДА 1
	|							ИНАЧЕ РасчетСреднегоЗаработка.ЧислоМесяцев
	|						КОНЕЦ
	|				ИНАЧЕ 0
	|			КОНЕЦ КАК ЧислоМесяцев,
	|			РасчетСреднегоЗаработка.МесяцВыборки КАК МесяцВыборки
	|		ИЗ
	|			РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
	|		ГДЕ
	|			РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
	|			И РасчетСреднегоЗаработка.ВидРасчета <> 0
	|           //И РасчетСреднегоЗаработка.Включать
	|		
	|		СГРУППИРОВАТЬ ПО
	|			РасчетСреднегоЗаработка.МесяцВыборки,
	|			ВЫБОР
	|				КОГДА РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработку
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИнд
	|					ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуИндСред
	|						ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
	|						ИЛИ РасчетСреднегоЗаработка.ВидРасчета = &ПоЗаработкуОтпуск
	|					ТОГДА ВЫБОР
	|							КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > 1
	|								ТОГДА 1
	|							ИНАЧЕ РасчетСреднегоЗаработка.ЧислоМесяцев
	|						КОНЕЦ
	|				ИНАЧЕ 0
	|			КОНЕЦ) КАК ВложенныйЗапрос) КАК ВложенныйЗапрос
	|ГДЕ
	|	РасчетСреднегоЗаработка.Регистратор = &парамРегистратор
	|	И РасчетСреднегоЗаработка.ВидРасчета <> 0
	|	//И РасчетСреднегоЗаработка.МесяцВыборки МЕЖДУ &ПериодСреднегоПоОкладу И КОНЕЦПЕРИОДА(&ПериодСреднегоПоОкладу, МЕСЯЦ) //О.Т. 17.02.2015 № 334
	|	//И РасчетСреднегоЗаработка.Включать
	|
	|СГРУППИРОВАТЬ ПО
	|	РасчетСреднегоЗаработка.Сотрудник,
	|	РасчетСреднегоЗаработка.ФизЛицо,
	|	РасчетСреднегоЗаработка.Организация,
	|	РасчетСреднегоЗаработка.СпособРасчета,
	|	РасчетСреднегоЗаработка.ДатаНачалаСобытия,
	|	РасчетСреднегоЗаработка.ДатаНачалаРасчетногоПериода,
	|	РасчетСреднегоЗаработка.ДатаОкончанияРасчетногоПериода,
	|	ВложенныйЗапрос.ЧислоМесяцев
	//|	РасчетСреднегоЗаработка.НомерДоговора,
	//|	РасчетСреднегоЗаработка.ДатаДоговора
	| 
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	СпособРасчета,
	|	ДатаНачалаСобытия,
	|	ДатаНачалаРасчетногоПериода,
	|	ДатаОкончанияРасчетногоПериода";
	//Островская Татьяна 28.04.2014 № 17316
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") или ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда
		ДанныеОСреднемЗаработкеТекст = СтрЗаменить(ДанныеОСреднемЗаработкеТекст,"//И РасчетСреднегоЗаработка.Включать","И РасчетСреднегоЗаработка.Включать");
	иначе
		ДанныеОСреднемЗаработкеТекст = СтрЗаменить(ДанныеОСреднемЗаработкеТекст,"//И РасчетСреднегоЗаработка.Включать","");
	КонецЕсли;
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
		Если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу и ПериодСреднегоПоОкладу <> Неопределено Тогда
			ДанныеОСреднемЗаработкеТекст = СтрЗаменить(ДанныеОСреднемЗаработкеТекст,"//И РасчетСреднегоЗаработка.МесяцВыборки МЕЖДУ &ПериодСреднегоПоОкладу И КОНЕЦПЕРИОДА(&ПериодСреднегоПоОкладу, МЕСЯЦ)",
			"И РасчетСреднегоЗаработка.МесяцВыборки МЕЖДУ &ПериодСреднегоПоОкладу И КОНЕЦПЕРИОДА(&ПериодСреднегоПоОкладу, МЕСЯЦ)");
		КонецЕсли;
	КонецЕсли;
	
	// КалендарныеДниПособия
	// 		
	// 
	//	Поля:
	// 
	// Описание:
	//
	
	ДанныеОДоговоре = 
	"ВЫБРАТЬ
	|	База.Сотрудник,
	|	База.ДатаДоговора,
	|	База.НомерДоговора
	|ПОМЕСТИТЬ ВТДанныеОДоговоре
	|ИЗ
	|	(ВЫБРАТЬ
	|		ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
	|		ДоговорНаВыполнениеРаботСФизЛицом.Дата КАК ДатаДоговора,
	|		ДоговорНаВыполнениеРаботСФизЛицом.Номер КАК НомерДоговора
	|	ИЗ
	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
	|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
	|			ПО ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка
	|				И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета
	|				И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
	|				И ДополнительныеНачисленияРаботниковОрганизаций.НомерСтроки = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.НомерСтроки
	|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
	|			ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
	|	ГДЕ
	|		ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
	|		И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
	|		И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало МЕЖДУ &ДатаНачала И &ДатаОкончания
	|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
	|		ДоговорНаВыполнениеРаботСФизЛицом.Дата,
	|		ДоговорНаВыполнениеРаботСФизЛицом.Номер) КАК База";
	
	
	
	КалендарныеДниПособияТекст =
	"ВЫБРАТЬ
	|	ФактическийПериодДействия.НомерСтроки КАК НомерСтроки,
	|	СУММА(РАЗНОСТЬДАТ(ФактическийПериодДействия.ПериодДействияНачало, ДОБАВИТЬКДАТЕ(ФактическийПериодДействия.ПериодДействияКонец, СЕКУНДА, 1), ДЕНЬ)) КАК ОплачиватьДнейПособия
	|ПОМЕСТИТЬ ВТКалендарныеДниПособия
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
	|		ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления
	|			И ВидРасчета.СпособРасчета В (&ПоСреднемуЗаработкуФСС)
	|			И Регистратор = &парамРегистратор
	|			И Авторасчет) КАК ФактическийПериодДействия
	|
	|СГРУППИРОВАТЬ ПО
	|	ФактическийПериодДействия.НомерСтроки
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НомерСтроки";
	
	// ИсчисленныйНДФЛ
	//	данные по исчисленному НДФЛ в текущем периоде регистрации
	//	Поля 
	//		Физлицо
	//		ИсчисленныйНалог
	//
	//	Описание
	//	Суммируем исчисленный НДФЛ по заданной организации в заданном периоде регистрации
	//	в разрезе физлиц
	
	ИсчисленныйНДФЛТекст = 
	"ВЫБРАТЬ
	|	РаботникиОрганизации.НомерСтроки,
	|	СУММА(НДФЛРасчетыСБюджетом.Налог) КАК ИсчисленныйНалог
	|ПОМЕСТИТЬ ВТИсчисленныйНДФЛ
	|ИЗ
	|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
	|			Удержания.НомерСтроки КАК НомерСтроки,
	|			Удержания.ФизЛицо КАК Физлицо,
	|			НАЧАЛОПЕРИОДА(Удержания.БазовыйПериодНачало, МЕСЯЦ) КАК МесяцУдержания
	|		ИЗ
	|			РегистрРасчета.УдержанияРаботниковОрганизаций КАК Удержания
	|		ГДЕ
	|			(Удержания.ВидРасчета В(&парамМассивУдержанийИЛ) или Удержания.ВидРасчета.СпособРасчета = &CпособРасчетаИсполнительный 
	|		или Удержания.ВидРасчета.СпособРасчета = &CпособРасчетаИсполнительныйДоПредела или Удержания.ВидРасчета.СпособРасчета = &CпособРасчетаИсполнительныйФиксСуммой
	|		или Удержания.ВидРасчета.СпособРасчета = &CпособРасчетаИсполнительныйБезПНИПФ или Удержания.ВидРасчета.СпособРасчета = &CпособРасчетаИсполнительныйБезПНИПФДоПредела
	|		или Удержания.ВидРасчета.СпособРасчета = &CпособРасчетаИсполнительныйБезПНИПФФикс или Удержания.ВидРасчета.СпособРасчета = &CпособРасчетаИсполнительныйБезПНИПФДоПределаФикс)
	|			И Удержания.Регистратор = &парамРегистратор) КАК РаботникиОрганизации
	|		ПО НДФЛРасчетыСБюджетом.ФизЛицо = РаботникиОрганизации.Физлицо
	|			И (НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ) = РаботникиОрганизации.МесяцУдержания)
	|ГДЕ
	|	НДФЛРасчетыСБюджетом.Организация = &парамОрганизация
	|	И НДФЛРасчетыСБюджетом.ВидДвижения = &парамПриход
	|	И НДФЛРасчетыСБюджетом.ВидСтроки = &парамВидСтроки
	|
	|СГРУППИРОВАТЬ ПО
	|	РаботникиОрганизации.НомерСтроки";
	
	// НакопленныеДанные
	// уже начислено по другим регистраторам в данном расчетном периоде и за всю историю
	// применяется для расчета удержаний "нарастающим итогом за месяц"
	//	Поля:
	//		Сотрудник
	//		ДокументОснование
	//		ВидРасчета
	//		УжеНачисленоВТекущемПериоде
	//		УжеНачисленоЗаВсюИсторию
	//	Описание:
	//		суммирует результаты по видам расчета и документам-основаниям
	//
	НакопленныеДанныеТекст = 
	"ВЫБРАТЬ
	//|	СУММА(ВЫБОР
	//|	КОГДА Основной.ПериодРегистрации = НакопленныеДанные.ПериодРегистрации
	//|			И ВЫБОР
	//|				КОГДА Основной.ВидРасчета.СпособРасчета В (&СпособРасчетаИЛ)
	//|					ТОГДА НАЧАЛОПЕРИОДА(Основной.БазовыйПериодНачало, МЕСЯЦ) <= НакопленныеДанные.БазовыйПериодНачало
	//|				ИНАЧЕ Основной.БазовыйПериодНачало <= НакопленныеДанные.БазовыйПериодНачало
	//|			КОНЕЦ
	//|			И КОНЕЦПЕРИОДА(Основной.БазовыйПериодКонец,месяц) >= НакопленныеДанные.БазовыйПериодКонец
	//|		ТОГДА НакопленныеДанные.Результат
	//|	ИНАЧЕ 0
	//|   КОНЕЦ) КАК УжеНачисленоВТекущемПериоде,
	//О.Т. Аверсон 21.06.2017 № 754
	|	СУММА(ВЫБОР
	|	КОГДА 
	|			ВЫБОР
	|				КОГДА Основной.ВидРасчета.СпособРасчета В (&СпособРасчетаИЛ) или Основной.ВидРасчета В (&ВидРасчетаПрофВзнос) //О.Т. Аверсон 21.07.2017 № 852
	|					ТОГДА НАЧАЛОПЕРИОДА(Основной.БазовыйПериодНачало, МЕСЯЦ) <= НакопленныеДанные.БазовыйПериодНачало и Основной.ПериодРегистрации = НакопленныеДанные.ПериодРегистрации
	|				ИНАЧЕ Основной.БазовыйПериодНачало <= НакопленныеДанные.БазовыйПериодНачало и НАЧАЛОПЕРИОДА(НакопленныеДанные.БазовыйПериодНачало, МЕСЯЦ) = Основной.ПериодРегистрации
	|			КОНЕЦ
	|			И КОНЕЦПЕРИОДА(Основной.БазовыйПериодКонец, МЕСЯЦ) >= НакопленныеДанные.БазовыйПериодКонец
	|		ТОГДА НакопленныеДанные.Результат
	|	ИНАЧЕ 0
	|КОНЕЦ) КАК УжеНачисленоВТекущемПериоде,
	//О.Т. Аверсон 21.06.2017 № 754
	|	СУММА(ВЫБОР
	|			КОГДА НакопленныеДанные.ПериодРегистрации <= Основной.ПериодРегистрации
	|					И Основной.БазовыйПериодНачало >= НакопленныеДанные.БазовыйПериодНачало
	|				ТОГДА НакопленныеДанные.Результат
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК УжеНачисленоЗаВсюИсторию,
	|	НакопленныеДанные.ФизЛицо КАК ФизЛицо,
	|	НакопленныеДанные.ВидРасчета КАК ВидРасчета,
	// ПСА 20-01-2021 СВФР-007089 +++
	|	Основной.БазовыйПериодНачало КАК БазовыйПериодНачало,
	|	НакопленныеДанные.ДокументОснование КАК ДокументОснование
	|ПОМЕСТИТЬ ВТНакопленныеДанные
	|ИЗ
	|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК Основной
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.УдержанияРаботниковОрганизаций КАК НакопленныеДанные
	|		ПО Основной.ФизЛицо = НакопленныеДанные.ФизЛицо
	//(начало) добавлено Кухарчуком Д.Я. 25.06.19, Задача СВФР-004463, Аверсон-Софт
	|			И ( НЕ Основной.ВидРасчета В (&ВидРасчетаПрофВзнос) ИЛИ Основной.Сотрудник = НакопленныеДанные.Сотрудник )
	//(конец) добавлено Кухарчуком Д.Я. 25.06.19, Задача СВФР-004463, Аверсон-Софт
	|			И Основной.ВидРасчета = НакопленныеДанные.ВидРасчета
	|			И Основной.ПериодРегистрации >= НакопленныеДанные.ПериодРегистрации
	|			И Основной.Организация = НакопленныеДанные.Организация
	|			И Основной.ДокументОснование = НакопленныеДанные.ДокументОснование
	|			И Основной.Регистратор <> НакопленныеДанные.Регистратор
	|			И Основной.Сторно = НакопленныеДанные.Сторно
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.Авторасчет
	|
	|СГРУППИРОВАТЬ ПО
	|	НакопленныеДанные.ФизЛицо,
	|	НакопленныеДанные.ВидРасчета,
	// ПСА 20-01-2021 СВФР-007089 +++
	|	Основной.БазовыйПериодНачало,	
	|	НакопленныеДанные.ДокументОснование
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	ВидРасчета,
	|	ДокументОснование";
	
	
	//Выбираем пособия на детей
	
	// РазмерПособияНаРебенкаДо3хЛет
	//	Поля:
	//		НомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка до 3 лет для каждой строки начислений
	//
	РазмерПособияНаРебенкаДо3ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНаРебенкаДо3Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия В (&ВидПособияНаРебенкаДо3Лет)) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета В (&СпособРасчетаПособияНаРебенкаДо3Лет)//О.Т. 29.01.2015 № 17821
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности
	|			И ДатыАктуальностиРазмераПособия.ВидПособия = ГосударственныеПособия.ВидПособия
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновнойНомерСтроки,
	|	ВидПособия";
	
	
	// РазмерПособияМатериОдиночкеДо1_5Лет
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия матери-одиночке на ребенка до 1.5 лет для каждой строки начислений
	//
	РазмерПособияМатериОдиночкеДо1_5ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияМатериОдиночкеДо1_5Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияМатериОдиночкеДо1_5Лет) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияМатериОдиночкеДо1_5Лет
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияМатериОдиночкеДо1_5Лет) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияМатериОдиночкеДо3Лет
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия матери-одиночке на ребенка до 3 лет для каждой строки начислений
	//
	РазмерПособияМатериОдиночкеДо3ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияМатериОдиночкеДо3Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияМатериОдиночкеДо3Лет) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияМатериОдиночкеДо3Лет
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияМатериОдиночкеДо3Лет) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНаРебенкаСНадбавкой40До3хЛет
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка до 3 лет с надбавкой 40% для каждой строки начислений
	//
	РазмерПособияНаРебенкаСНадбавкой40До3ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНаРебенкаСНадбавкой40До3Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаСНадбавкой40До3Лет) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНаРебенкаСНадбавкой40До3Лет
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаСНадбавкой40До3Лет) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНеРаботающейМатериДо3хЛет
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка не работающей до 3 лет для каждой строки начислений
	//
	РазмерПособияНеРаботающейМатериДо3ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНеРаботающейМатериДо3Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНеРаботающейМатериДо3Лет) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНеРаботающейМатериДо3Лет
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНеРаботающейМатериДо3Лет) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНеРабМатериОдиночкеДо3Лет
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка не работающей матери-одиночке до 3 лет для каждой строки начислений
	//
	РазмерПособияНеРабМатериОдиночкеДо3ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНеРабМатериОдиночкеДо3Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНеРабМатериОдиночкеДо3Лет) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНеРабМатериОдиночкеДо3Лет
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНеРабМатериОдиночкеДо3Лет) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНеРабМатериОдиночкеДо1_5Лет
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка не работающей матери-одиночке до 1.5 лет для каждой строки начислений
	//
	РазмерПособияНеРабМатериОдиночкеДо1_5ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНеРабМатериОдиночкеДо1_5Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНеРабМатериОдиночкеДо1_5Лет) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНеРабМатериОдиночкеДо1_5Лет
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНеРабМатериОдиночкеДо1_5Лет) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНеРабМатериНадб40До3хЛет
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка не работающей матери до 3 лет с надбавкой 40% 
	//		для каждой строки начислений
	//
	РазмерПособияНеРабМатериНадб40До3ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНеРабМатериНадб40До3Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНеРабМатериНадб40До3Лет) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНеРабМатериНадб40До3Лет
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНеРабМатериНадб40До3Лет) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНаРебенкаСтарше3хЛет
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка старше 3 лет 
	//		для каждой строки начислений
	//
	РазмерПособияНаРебенкаСтарше3ЛетТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНаРебенкаСтарше3Лет
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаСтарше3Лет) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНаРебенкаСтарше3Лет
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаСтарше3Лет) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНаРебенкаДо18ЛетНадб40
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка до 18 лет с надбавкой 40% 
	//		для каждой строки начислений
	//
	РазмерПособияНаРебенкаДо18ЛетНадб40Текст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНаРебенкаДо18ЛетНадб40
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаДо18ЛетНадб40) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНаРебенкаДо18ЛетНадб40
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаДо18ЛетНадб40) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНаРебенкаИнвалида
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка-инвалида до 18 лет 
	//		для каждой строки начислений
	//
	РазмерПособияНаРебенкаИнвалидаТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНаРебенкаИнвалида
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаИнвалида) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНаРебенкаИнвалида
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаИнвалида) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	// РазмерПособияНаРебенкаВИЧ
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки расчитываемых движений
	//		РазмерПособия - размер пособия
	//	Описание:
	//		получает размер пособия на ребенка инфицированного ВИЧ до 18 лет 
	//		для каждой строки начислений
	//
	РазмерПособияНаРебенкаВИЧТекст = "ВЫБРАТЬ
	|	ДатыАктуальностиРазмераПособия.НомерСтроки КАК ОсновнойНомерСтроки,
	|	ГосударственныеПособия.Размер КАК РазмерПособия,
	|	ДатыАктуальностиРазмераПособия.ВидПособия КАК ВидПособия
	|ПОМЕСТИТЬ ВТРазмерПособияНаРебенкаВИЧ
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК ДатаАктуальности,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособия
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаВИЧ) И ГосударственныеПособия.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПособияНаРебенкаВИЧ
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыАктуальностиРазмераПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО (ГосударственныеПособия.ВидПособия = &ВидПособияНаРебенкаВИЧ) И ГосударственныеПособия.Период = ДатыАктуальностиРазмераПособия.ДатаАктуальности";
	
	
	//О.Т. Аверсон 15.10.2015 № 637
	РазмерЧасоваяМинимальнаяЗарплатаТекст = 
	"ВЫБРАТЬ
	|	ДатыАктуальности.НомерСтроки КАК ОсновнойНомерСтроки,
	|	РазмерыПараметровДляРасчетаРБ.Размер КАК Размер,
	|	ДатыАктуальности.ВидПараметра
	|ПОМЕСТИТЬ ВТРазмерЧасоваяМинимальнаяЗарплата
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(РазмерыПараметровДляРасчетаРБ.Период) КАК ДатаАктуальности,
	|		РазмерыПараметровДляРасчетаРБ.ВидПараметра 
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ КАК РазмерыПараметровДляРасчетаРБ
	|			ПО (РазмерыПараметровДляРасчетаРБ.Период <= Основной.ПериодДействияНачало)
	|				И (РазмерыПараметровДляРасчетаРБ.ВидПараметра = ЗНАЧЕНИЕ(Перечисление.ВидыПараметровДляРасчетаЗарплаты.ЧасоваяМинимальнаяЗарплата))
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор
	|		И Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		РазмерыПараметровДляРасчетаРБ.ВидПараметра) КАК ДатыАктуальности
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ КАК РазмерыПараметровДляРасчетаРБ
	|		ПО (РазмерыПараметровДляРасчетаРБ.Период = ДатыАктуальности.ДатаАктуальности)
	|		И РазмерыПараметровДляРасчетаРБ.ВидПараметра =  ДатыАктуальности.ВидПараметра";
	
	РазмерМесячнаяМинимальнаяЗарплатаТекст = 
	"ВЫБРАТЬ
	|	ДатыАктуальности.НомерСтроки КАК ОсновнойНомерСтроки,
	|	РазмерыПараметровДляРасчетаРБ.Размер КАК Размер,
	|	ДатыАктуальности.ВидПараметра
	|ПОМЕСТИТЬ ВТРазмерМесячнаяМинимальнаяЗарплата
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(РазмерыПараметровДляРасчетаРБ.Период) КАК ДатаАктуальности,
	|		РазмерыПараметровДляРасчетаРБ.ВидПараметра 
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ КАК РазмерыПараметровДляРасчетаРБ
	|			ПО (РазмерыПараметровДляРасчетаРБ.Период <= Основной.ПериодДействияНачало)
	|				И (РазмерыПараметровДляРасчетаРБ.ВидПараметра = ЗНАЧЕНИЕ(Перечисление.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ))
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор
	|		И ( Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМЗПотМесячнойМЗП)
	//+ СВЭЙ КДЯ 09.10.19 СВФР-004842
	|			ИЛИ Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоМЗПотСреднегодовойГрафика ) )
	//- СВЭЙ КДЯ 09.10.19 СВФР-004842
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки,
	|		РазмерыПараметровДляРасчетаРБ.ВидПараметра) КАК ДатыАктуальности
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ КАК РазмерыПараметровДляРасчетаРБ
	|		ПО (РазмерыПараметровДляРасчетаРБ.Период = ДатыАктуальности.ДатаАктуальности)
	|		И РазмерыПараметровДляРасчетаРБ.ВидПараметра =  ДатыАктуальности.ВидПараметра";
	//О.Т. Аверсон 15.10.2015 № 637
	
	// РазмерММОТ
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки рассчитываемых движений
	//		Размер - размер ММОТ
	//	Описание:
	//		получает размер ММОТ для каждой строки начислений
	//
	РазмерММОТТекст = 
	"ВЫБРАТЬ
	|	ДатыАктуальностиММОТ.НомерСтроки КАК ОсновнойНомерСтроки,
	|	МинимальнаяОплатаТрудаРФ.Размер КАК Размер
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(МинимальнаяОплатаТрудаРФ.Период) КАК ДатаАктуальности
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МинимальнаяОплатаТрудаРФ КАК МинимальнаяОплатаТрудаРФ
	|			ПО МинимальнаяОплатаТрудаРФ.Период <= Основной.ПериодДействияНачало
	|	
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор И
	|		Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПоСреднемуЗаработкуФСС
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки) КАК ДатыАктуальностиММОТ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МинимальнаяОплатаТрудаРФ КАК МинимальнаяОплатаТрудаРФ
	|		ПО МинимальнаяОплатаТрудаРФ.Период = ДатыАктуальностиММОТ.ДатаАктуальности";
	
	// РазмерОграниченияПособия
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки рассчитываемых движений
	//		Размер - размер ограничения
	//	Описание:
	//		получает размер ограничения пособия для каждой строки начислений
	//
	РазмерОграниченияПособияТекст = 
	"ВЫБРАТЬ
	|	ДатыАктуальности.НомерСтроки КАК ОсновнойНомерСтроки,
	|	РазмерОграниченияПособияПоНетрудоспособности.Размер КАК Размер,
	|	РазмерОграниченияПособияПоНетрудоспособности.РазмерПоБеременности
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		МАКСИМУМ(РазмерОграниченияПособияПоНетрудоспособности.Период) КАК ДатаАктуальности
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерОграниченияПособияПоНетрудоспособности КАК РазмерОграниченияПособияПоНетрудоспособности
	|			ПО (РазмерОграниченияПособияПоНетрудоспособности.Период <= Основной.ПериодРегистрации)
	|				И Основной.Организация = РазмерОграниченияПособияПоНетрудоспособности.Организация
	|				И (ВЫБОР
	|					КОГДА Основной.Сотрудник.ВидНалогообложенияОсновной = &ПустойВидНалогообложения
	|						ТОГДА Основной.Организация.ОсновнаяСтавкаНалогообложения
	|					ИНАЧЕ Основной.Сотрудник.ВидНалогообложенияОсновной
	|				КОНЕЦ = РазмерОграниченияПособияПоНетрудоспособности.ВидНалогообложения)
	|	ГДЕ
	|		Основной.Регистратор = &парамРегистратор
	|		И Основной.ВидРасчета.СпособРасчета = &СпособРасчетаПоСреднемуЗаработкуФСС
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Основной.НомерСтроки) КАК ДатыАктуальности
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерОграниченияПособияПоНетрудоспособности КАК РазмерОграниченияПособияПоНетрудоспособности
	|		ПО (РазмерОграниченияПособияПоНетрудоспособности.Период = ДатыАктуальности.ДатаАктуальности)"; //О.Т. Аверсон 13.07.2016 № 1308
	
	// СдельныйЗаработокОрганизацииТекст
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки рассчитываемых движений
	//		РазмерЗаработка - размер сдельного заработка
	//	Описание:
	//		получает размер сдельного заработка для начислений со способом расчета "Сдельный заработок"
	//
	СдельныйЗаработокОрганизацииТекст =
	"ВЫБРАТЬ
	|	НесгруппированныеДанные.ОсновнойНомерСтроки КАК ОсновнойНомерСтроки,
	|	СУММА(НесгруппированныеДанные.СуммаЗаработка) КАК СуммаЗаработка,
	|	МАКСИМУМ(НесгруппированныеДанные.ОшибкаВводаФактическойВыработки) КАК ОшибкаВводаФактическойВыработки
	|ПОМЕСТИТЬ ВТСдельныйЗаработокОрганизации
	|ИЗ
	|	(ВЫБРАТЬ
	|		Начисления.НомерСтроки КАК ОсновнойНомерСтроки,
	|		ФактическаяВыработка.Выработка КАК СуммаЗаработка,
	|		ЛОЖЬ КАК ОшибкаВводаФактическойВыработки
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
	|				Регистратор = &парамРегистратор
	|					И Авторасчет
	|					И (ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок) или ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке))) КАК Начисления
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ФактическаяВыработкаРаботниковОрганизаций КАК ФактическаяВыработка
	|			ПО Начисления.Сотрудник = ФактическаяВыработка.Сотрудник
	|				И (ФактическаяВыработка.Период МЕЖДУ Начисления.ПериодДействияНачало И Начисления.ПериодДействияКонец)
	|				И (ФактическаяВыработка.СпособВводаДанных В (ЗНАЧЕНИЕ(Перечисление.СпособыВводаДанныхОВремени.ПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыВводаДанныхОВремени.ЗаДень)))
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Начисления.НомерСтроки,
	|		ФактическаяВыработка.Выработка,
	|		ВЫБОР
	|			КОГДА ПроверкаКоличестваЗаписей.Сотрудник ЕСТЬ НЕ NULL 
	|					И ФактическаяВыработка.Выработка ЕСТЬ НЕ NULL 
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Начисления
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ФактическаяВыработкаРаботниковОрганизаций КАК ФактическаяВыработка
	|			ПО Начисления.Сотрудник = ФактическаяВыработка.Сотрудник
	|				И ФактическаяВыработка.Период = Начисления.ПериодДействия
	|				И (ФактическаяВыработка.СпособВводаДанных В (ЗНАЧЕНИЕ(Перечисление.СпособыВводаДанныхОВремени.ВЦеломЗаПериод)))
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ПроверкаКоличестваЗаписей
	|			ПО Начисления.Сотрудник = ПроверкаКоличестваЗаписей.Сотрудник
	|				И Начисления.ПериодДействия = ПроверкаКоличестваЗаписей.ПериодДействия
	|				И Начисления.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ПроверкаКоличестваЗаписей.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени
	|				И Начисления.Организация = ПроверкаКоличестваЗаписей.Организация
	|				И (Начисления.ВидРасчета.ВидВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))
	|				И (ПроверкаКоличестваЗаписей.ВидРасчета.ВидВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))
	|				И ((НЕ(Начисления.Регистратор = ПроверкаКоличестваЗаписей.Регистратор
	|						И Начисления.НомерСтроки = ПроверкаКоличестваЗаписей.НомерСтроки)))
	|	ГДЕ
	|		Начисления.Регистратор = &парамРегистратор
	|		И Начисления.Авторасчет) КАК НесгруппированныеДанные
	|
	|СГРУППИРОВАТЬ ПО
	|	НесгруппированныеДанные.ОсновнойНомерСтроки
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновнойНомерСтроки";
	
	// СдельныйЗаработокКомпанииТекст
	//	Поля:
	//		ОсновнойНомерСтроки - номер строки рассчитываемых движений
	//		РазмерЗаработка - размер сдельного заработка
	//	Описание:
	//		получает размер сдельного заработка для начислений со способом расчета "Сдельный заработок"
	//
	СдельныйЗаработокКомпанииТекст =
	"ВЫБРАТЬ
	|	НесгруппированныеДанные.ОсновнойНомерСтроки КАК ОсновнойНомерСтроки,
	|	СУММА(НесгруппированныеДанные.СуммаЗаработка) КАК СуммаЗаработка,
	|	МАКСИМУМ(НесгруппированныеДанные.ОшибкаВводаФактическойВыработки) КАК ОшибкаВводаФактическойВыработки
	|ПОМЕСТИТЬ ВТСдельныйЗаработокКомпании
	|ИЗ
	|	(ВЫБРАТЬ
	|		Начисления.НомерСтроки КАК ОсновнойНомерСтроки,
	|		ФактическаяВыработка.Выработка КАК СуммаЗаработка,
	|		ЛОЖЬ КАК ОшибкаВводаФактическойВыработки
	|	ИЗ
	|		РегистрРасчета.УправленческиеНачисления.ФактическийПериодДействия(
	|				Регистратор = &парамРегистратор
	|					И Авторасчет) КАК Начисления
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ФактическаяВыработкаРаботников КАК ФактическаяВыработка
	|			ПО Начисления.ФизЛицо = ФактическаяВыработка.Физлицо
	|				И (ФактическаяВыработка.Период МЕЖДУ Начисления.ПериодДействияНачало И Начисления.ПериодДействияКонец)
	|				И (ФактическаяВыработка.СпособВводаДанных В (ЗНАЧЕНИЕ(Перечисление.СпособыВводаДанныхОВремени.ПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыВводаДанныхОВремени.ЗаДень)))
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Начисления.НомерСтроки,
	|		ФактическаяВыработка.Выработка,
	|		ВЫБОР
	|			КОГДА ПроверкаКоличестваЗаписей.ФизЛицо ЕСТЬ НЕ NULL 
	|					И ФактическаяВыработка.Выработка ЕСТЬ НЕ NULL 
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ
	|	ИЗ
	|		РегистрРасчета.УправленческиеНачисления КАК Начисления
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ФактическаяВыработкаРаботников КАК ФактическаяВыработка
	|			ПО Начисления.ФизЛицо = ФактическаяВыработка.Физлицо
	|				И (ФактическаяВыработка.Период = Начисления.ПериодДействия)
	|				И (ФактическаяВыработка.СпособВводаДанных = ЗНАЧЕНИЕ(Перечисление.СпособыВводаДанныхОВремени.ВЦеломЗаПериод))
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.УправленческиеНачисления КАК ПроверкаКоличестваЗаписей
	|			ПО Начисления.ФизЛицо = ПроверкаКоличестваЗаписей.ФизЛицо
	|				И Начисления.ПериодДействия = ПроверкаКоличестваЗаписей.ПериодДействия
	|				И Начисления.ВидРасчета.ВидУчетаРабочегоВремени = ПроверкаКоличестваЗаписей.ВидРасчета.ВидУчетаРабочегоВремени
	|				И (Начисления.ВидРасчета.ЗачетОтработанногоВремени)
	|				И (ПроверкаКоличестваЗаписей.ВидРасчета.ЗачетОтработанногоВремени)
	|				И ((НЕ(Начисления.Регистратор = ПроверкаКоличестваЗаписей.Регистратор
	|						И Начисления.НомерСтроки = ПроверкаКоличестваЗаписей.НомерСтроки)))
	|	ГДЕ
	|		Начисления.Регистратор = &парамРегистратор
	|		И Начисления.Авторасчет) КАК НесгруппированныеДанные
	|		) КАК НесгруппированныеДанные
	|
	|СГРУППИРОВАТЬ ПО
	|	НесгруппированныеДанные.ОсновнойНомерСтроки
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновнойНомерСтроки";
	
	
	// ВремяПоТабелю
	//	данные по отработанному времени и норме времени по методу "сплошной регистрации" в текущем периоде регистрации
	//	Поля 
	//		НомерСтроки
	//		ОтработаноДнейПоТабелю
	//		ОтработаноЧасовПоТабелю
	//		ОтработаноЧасовПоТабелюОтклонение
	//
	//	Описание                       
	//	Суммируем отработанное время и норму времени в заданном периоде действия для каждой строки начисления
	//	из регистра РабочееВремяРаботниковОрганизаций 
	
	ВремяПоТабелюТекст = 
	"ВЫБРАТЬ
	|	Основной.НомерСтроки КАК НомерСтроки,
	|	СУММА(ВЫБОР
	|			КОГДА Основной.ВидРасчета.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеВПределахНормы), ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))
	|				ТОГДА ОтработанноеВремя.Часов
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОтработаноЧасовПоТабелюОтклонение,
	|	СУММА(ВЫБОР
	|			КОГДА ОтработанноеВремя.Регистратор = &парамРегистратор
	|					И Основной.ВидРасчета.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеНеотработанное), ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеОтработанноеВПределахНормы))
	|				ТОГДА ОтработанноеВремя.Часов
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ВнутрисменныеЧасыОтклонение
	|ПОМЕСТИТЬ ВТВремяПоТабелю
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(Регистратор = &парамРегистратор) КАК Основной
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ВнутрисменноеВремяРаботниковОрганизаций КАК ОтработанноеВремя
	|		ПО Основной.Сотрудник = ОтработанноеВремя.Сотрудник
	|			И (ОтработанноеВремя.Период МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец)
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.Авторасчет
	|
	|СГРУППИРОВАТЬ ПО
	|	Основной.НомерСтроки
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НомерСтроки";
	
	// ОтработаноПоВидуВремениДляПоказателейТекст
	//	Данные по отработанному времени введенное табелем по указанному в начислении виду учета времени
	ОтработанноеВремяПоТабелю = ПрочиеПроцедуры.НеобходимоУчитыватьОтработанноеВремяТолькоПоТабелю(Организация);
	//О.Т. Аверсон 13.12.2016 № 100
	Если Организация.ИНН = "100765738" Тогда 
		ОтработаноПоВидуВремениДляПоказателейТекст = 
		"ВЫБРАТЬ
		|	Основной.НомерСтроки КАК НомерСтроки,
		|	СУММА(РабочееВремяРаботников.Дней) КАК Дней_Сумма,
		|	СУММА(РабочееВремяРаботников.Часов) КАК Часов,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ РабочееВремяРаботников.Период) КАК Дней,
		|	МАКСИМУМ(РабочееВремяРаботников.ВЦеломЗаПериод) КАК Сводно
		|ПОМЕСТИТЬ ВТОтработаноПоВидуВремениДляПоказателей
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
		|			Регистратор = &парамРегистратор
		|				И Авторасчет
		|				И ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)) КАК Основной
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботников
		|		ПО Основной.Сотрудник = РабочееВремяРаботников.Сотрудник
		|			И (РабочееВремяРаботников.ДатаНачала МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец или
		|			Основной.ПериодДействияНачало МЕЖДУ РабочееВремяРаботников.ДатаНачала И РабочееВремяРаботников.ДатаОкончания)//Островская Татьяна 17.04.2014 № 17283
		//|			И (РабочееВремяРаботников.ВидИспользованияРабочегоВремени = Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени)
		//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
		|			И ((РабочееВремяРаботников.ВидИспользованияРабочегоВремени = Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени) ИЛИ (РабочееВремяРаботников.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Ремонт)))
		//заявка №1664
		|			И (РабочееВремяРаботников.Регистратор <> &парамРегистратор)";
		если ОтработанноеВремяПоТабелю Тогда 
			ОтработаноПоВидуВремениДляПоказателейТекст = ОтработаноПоВидуВремениДляПоказателейТекст + "
			|			ГДЕ
			|			РабочееВремяРаботников.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации";
		КонецЕсли;
		ОтработаноПоВидуВремениДляПоказателейТекст = ОтработаноПоВидуВремениДляПоказателейТекст + "
		|СГРУППИРОВАТЬ ПО
		|	Основной.НомерСтроки
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НомерСтроки";
		//О.Т. Аверсон 13.12.2016 № 100
	иначе
		ОтработаноПоВидуВремениДляПоказателейТекст = 
		"ВЫБРАТЬ
		|	Основной.НомерСтроки КАК НомерСтроки,
		|	СУММА(РабочееВремяРаботников.Дней) КАК Дней_Сумма,
		|	СУММА(РабочееВремяРаботников.Часов) КАК Часов,
		
		//Аверсон 08.04.2022 КВВ СВФР-008930 (
		|СУММА(
		|ВЫБОР КОГДА
		|РабочееВремяРаботников.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Ремонт)
		|ТОГДА РабочееВремяРаботников.Часов
		|ИНАЧЕ 0 КОНЕЦ) КАК ЧасовРемонта,  
		//Аверсон 08.04.2022 КВВ СВФР-008930 )
		
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ РабочееВремяРаботников.Период) КАК Дней,
		|	МАКСИМУМ(РабочееВремяРаботников.ВЦеломЗаПериод) КАК Сводно
		|ПОМЕСТИТЬ ВТОтработаноПоВидуВремениДляПоказателей
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
		|			Регистратор = &парамРегистратор
		|				И Авторасчет
		|				И ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)) КАК Основной
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботников
		|		ПО Основной.Сотрудник = РабочееВремяРаботников.Сотрудник
		|			И (РабочееВремяРаботников.Период МЕЖДУ ВЫБОР
		|				КОГДА РабочееВремяРаботников.ВЦеломЗаПериод
		|					ТОГДА НАЧАЛОПЕРИОДА(Основной.ПериодДействияНачало, МЕСЯЦ)
		|				ИНАЧЕ Основной.ПериодДействияНачало
		|			КОНЕЦ И Основной.ПериодДействияКонец)//Островская Татьяна 17.04.2014 № 17283
		//|			И (РабочееВремяРаботников.ВидИспользованияРабочегоВремени = Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени)
		//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
		|			И ((РабочееВремяРаботников.ВидИспользованияРабочегоВремени = Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени) ИЛИ (РабочееВремяРаботников.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Ремонт)))
		//заявка №1664
		|			И (РабочееВремяРаботников.Регистратор <> &парамРегистратор)";
		если ОтработанноеВремяПоТабелю Тогда 
			ОтработаноПоВидуВремениДляПоказателейТекст = ОтработаноПоВидуВремениДляПоказателейТекст + "
			|			ГДЕ
			|			РабочееВремяРаботников.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации";
		КонецЕсли;
		ОтработаноПоВидуВремениДляПоказателейТекст = ОтработаноПоВидуВремениДляПоказателейТекст + "
		|СГРУППИРОВАТЬ ПО
		|	Основной.НомерСтроки
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НомерСтроки";
	КонецЕсли;
	
	//заявка №1979 (база заявок Кристалла) Дмитрук О.Г.
	Если НачалоМесяца(ПериодРегистрации) >= Дата('20110601') Тогда
		ОтработаноПоВидуВремениДляПоказателейТекст = СтрЗаменить(ОтработаноПоВидуВремениДляПоказателейТекст,"КОЛИЧЕСТВО(РАЗЛИЧНЫЕ РабочееВремяРаботников.Период) КАК Дней,","СУММА(РабочееВремяРаботников.Дней) КАК Дней,");
	КонецЕсли;
	//заявка №1979 (база заявок Кристалла) Дмитрук О.Г.
	
	
	// ^ толик убрал табель т.к. время беретси и со сделки
	// |			И (РабочееВремяРаботников.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации)
	//О.Т. Аверсон 13.12.2016 № 100
	Если Организация.ИНН = "100765738" Тогда 
		ВремяВведенноеВЦеломЗаПериодТекст = 
		"ВЫБРАТЬ
		|	Основной.НомерСтроки КАК НомерСтроки,
		|	СУММА(ВЫБОР
		|			КОГДА Основной.ВидУчетаВремени = &ПоДням
		|				ТОГДА ОтработанноеВремя.Дней
		|			ИНАЧЕ ОтработанноеВремя.Часов
		|		КОНЕЦ) КАК ОсновноеЗначениеПоТабелю,
		|	СУММА(ОтработанноеВремя.Дней) КАК ДнейПоТабелю,
		|	СУММА(ОтработанноеВремя.Часов) КАК ЧасовПоТабелю,
		|	МАКСИМУМ(ВЫБОР
		|			КОГДА ПроверкаКоличестваЗаписей.Сотрудник ЕСТЬ НЕ NULL 
		|					И ОтработанноеВремя.Дней ЕСТЬ НЕ NULL 
		|				ТОГДА ИСТИНА
		|			ИНАЧЕ ЛОЖЬ
		|		КОНЕЦ) КАК ОшибкаВводаОтработанногоВремени
		|ПОМЕСТИТЬ ВТВремяВведенноеВЦеломЗаПериод
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК ОтработанноеВремя
		|		ПО Основной.Сотрудник = ОтработанноеВремя.Сотрудник
		|			И Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ОтработанноеВремя.ВидИспользованияРабочегоВремени
		|			И (ОтработанноеВремя.ВЦеломЗаПериод)
		|			И (ОтработанноеВремя.ДатаНачала МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец
		|				ИЛИ Основной.ПериодДействияНачало МЕЖДУ ОтработанноеВремя.ДатаНачала И ОтработанноеВремя.ДатаОкончания)
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ПроверкаКоличестваЗаписей
		|		ПО Основной.Сотрудник = ПроверкаКоличестваЗаписей.Сотрудник
		|			И Основной.ПериодДействияНачало = ПроверкаКоличестваЗаписей.ПериодДействияНачало
		|			И Основной.ПериодРегистрации >= ПроверкаКоличестваЗаписей.ПериодРегистрации
		|			И Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ПроверкаКоличестваЗаписей.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени
		|			И Основной.Организация = ПроверкаКоличестваЗаписей.Организация
		|			И (Основной.ВидРасчета.ВидВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))
		|			И (ПроверкаКоличестваЗаписей.ВидРасчета.ВидВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))
		|			И (НЕ(Основной.Регистратор = ПроверкаКоличестваЗаписей.Регистратор
		|					И Основной.НомерСтроки = ПроверкаКоличестваЗаписей.НомерСтроки))
		|			И (НЕ(Основной.ВидРасчета = ПроверкаКоличестваЗаписей.ВидРасчета
		|					И Основной.ПериодДействияНачало = ПроверкаКоличестваЗаписей.ПериодДействияНачало
		|					И Основной.ПериодДействияКонец = ПроверкаКоличестваЗаписей.ПериодДействияКонец
		|					И (Основной.ПериодРегистрации <> ПроверкаКоличестваЗаписей.ПериодРегистрации
		|						ИЛИ Основной.Сторно <> ПроверкаКоличестваЗаписей.Сторно)))
		|ГДЕ
		|	Основной.Регистратор = &парамРегистратор
		|	И Основной.Авторасчет
		|
		|СГРУППИРОВАТЬ ПО
		|	Основной.НомерСтроки
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НомерСтроки";
		//О.Т. Аверсон 13.12.2016 № 100
	иначе
		
		ВремяВведенноеВЦеломЗаПериодТекст = 
		"ВЫБРАТЬ
		|	Основной.НомерСтроки КАК НомерСтроки,
		|	СУММА(ВЫБОР
		|			КОГДА Основной.ВидУчетаВремени = &ПоДням
		|				ТОГДА ОтработанноеВремя.Дней
		|			ИНАЧЕ ОтработанноеВремя.Часов
		|		КОНЕЦ) КАК ОсновноеЗначениеПоТабелю,
		|	СУММА(ОтработанноеВремя.Дней) КАК ДнейПоТабелю,
		|	СУММА(ОтработанноеВремя.Часов) КАК ЧасовПоТабелю,
		|	МАКСИМУМ(ВЫБОР
		|			КОГДА ПроверкаКоличестваЗаписей.Сотрудник ЕСТЬ НЕ NULL 
		|					И ОтработанноеВремя.Дней ЕСТЬ НЕ NULL 
		|				ТОГДА ИСТИНА
		|			ИНАЧЕ ЛОЖЬ
		|		КОНЕЦ) КАК ОшибкаВводаОтработанногоВремени
		|ПОМЕСТИТЬ ВТВремяВведенноеВЦеломЗаПериод
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК ОтработанноеВремя
		|		ПО Основной.Сотрудник = ОтработанноеВремя.Сотрудник
		|			И Основной.ПериодДействия = ОтработанноеВремя.Период
		|			И Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ОтработанноеВремя.ВидИспользованияРабочегоВремени
		|			И (ОтработанноеВремя.ВЦеломЗаПериод)
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ПроверкаКоличестваЗаписей
		|		ПО Основной.Сотрудник = ПроверкаКоличестваЗаписей.Сотрудник
		|			И Основной.ПериодДействияНачало = ПроверкаКоличестваЗаписей.ПериодДействияНачало
		|			И Основной.ПериодРегистрации >= ПроверкаКоличестваЗаписей.ПериодРегистрации
		|			И Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ПроверкаКоличестваЗаписей.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени
		|			И Основной.Организация = ПроверкаКоличестваЗаписей.Организация
		|			И (Основной.ВидРасчета.ВидВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))
		|			И (ПроверкаКоличестваЗаписей.ВидРасчета.ВидВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))
		|			И ((НЕ(Основной.Регистратор = ПроверкаКоличестваЗаписей.Регистратор
		|					И Основной.НомерСтроки = ПроверкаКоличестваЗаписей.НомерСтроки)))
		|			И ((НЕ(Основной.ВидРасчета = ПроверкаКоличестваЗаписей.ВидРасчета
		|					И Основной.ПериодДействияНачало = ПроверкаКоличестваЗаписей.ПериодДействияНачало
		|					И Основной.ПериодДействияКонец = ПроверкаКоличестваЗаписей.ПериодДействияКонец
		|					И (Основной.ПериодРегистрации <> ПроверкаКоличестваЗаписей.ПериодРегистрации
		|						ИЛИ Основной.Сторно <> ПроверкаКоличестваЗаписей.Сторно))))
		|ГДЕ
		|	Основной.Регистратор = &парамРегистратор
		|	И Основной.Авторасчет
		|
		|СГРУППИРОВАТЬ ПО
		|	Основной.НомерСтроки
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НомерСтроки";
	КонецЕсли;
	
	СводныеИндивидуальныеГрафикиТекст = 
	"ВЫБРАТЬ
	|	Основной.НомерСтроки КАК НомерСтроки,
	|	ВЫБОР
	|		КОГДА Основной.ВидУчетаВремени = &ПоДням
	|			ТОГДА СводныеИндивидуальныеГрафики.Дней
	|		КОГДА Основной.ВидУчетаВремени = &ПоЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.Часов
	|		КОГДА Основной.ВидУчетаВремени = &ПоВечернимЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.ЧасовВечерних
	|		КОГДА Основной.ВидУчетаВремени = &ПоНочнымЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.ЧасовНочных
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НормаВремени,
	|	ВЫБОР
	|		КОГДА Основной.ВидУчетаВремени = &ПоДням
	|			ТОГДА СводныеИндивидуальныеГрафики.Дней
	|		КОГДА Основной.ВидУчетаВремени = &ПоВечернимЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.ЧасовВечерних
	|		КОГДА Основной.ВидУчетаВремени = &ПоНочнымЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.ЧасовНочных
	|		ИНАЧЕ СводныеИндивидуальныеГрафики.Часов
	|	КОНЕЦ КАК ОсновноеЗначение,
	|	СводныеИндивидуальныеГрафики.Дней КАК ДнейПоГрафику,
	|	СводныеИндивидуальныеГрафики.Часов КАК ЧасовПоГрафику,
	|	СводныеИндивидуальныеГрафики.Дней КАК НормаДнейПоГрафику,
	|	СводныеИндивидуальныеГрафики.Часов КАК НормаЧасовПоГрафику,
	|	ВЫБОР
	|		КОГДА (НАЧАЛОПЕРИОДА(Основной.ПериодДействияНачало, ДЕНЬ) > Основной.ПериодДействия
	|				ИЛИ КОНЕЦПЕРИОДА(Основной.ПериодДействияКонец, ДЕНЬ) < КОНЕЦПЕРИОДА(Основной.ПериодДействия, МЕСЯЦ))
	|				И СводныеИндивидуальныеГрафики.Дней ЕСТЬ НЕ NULL 
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ОшибкаВводаИндивидуальногоГрафикаРаботы
	|ПОМЕСТИТЬ ВТСводныеИндивидуальныеГрафики
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
	|		ПО Основной.Сотрудник = СводныеИндивидуальныеГрафики.Сотрудник
	|			И Основной.ПериодДействия = СводныеИндивидуальныеГрафики.Месяц
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.Авторасчет
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НомерСтроки";
	
	НормаВремениПоОбщемуГрафикуТекст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СУММА(ГрафикиРаботыПоВидамВремени.ОсновноеЗначениеНорма) КАК НормаДней,
	|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначениеНорма) КАК НормаЧасов,
	|	Основной.ГрафикРаботыНорма КАК ГрафикРаботы,
	|	Основной.ПериодДействия
	|ПОМЕСТИТЬ ВТНормаВремениПоОбщемуГрафику
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Основной
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|		ПО Основной.ГрафикРаботыНорма = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
	|			И Основной.ПериодДействия = ГрафикиРаботыПоВидамВремени.Месяц
	|			И (ГрафикиРаботыПоВидамВремени.План)
	|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.Авторасчет
	|	И Основной.ГрафикРаботыНорма <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка) 
	|
	|СГРУППИРОВАТЬ ПО
	|	Основной.ГрафикРаботыНорма,
	|	Основной.НомерСтроки,
	|	Основной.ПериодДействия
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ГрафикРаботы";
	
	// Сумма отработанного времени по видам времени: 
	//	ОтработанноеВПределахНормы,
	//	ЧасовоеОтработанноеВПределахНормы,
	//	ОтработанноеСверхНормы, необходим для расчета показателей ОтработаноВремениВДнях, ОтработаноВремениВЧасах
	
	СотрудникиПериодыДействия =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|	ОсновныеНачисления.ПериодДействия КАК ПериодДействия
	|ПОМЕСТИТЬ ВТ_СотрудникиПериодыДействия
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|ГДЕ
	|	ОсновныеНачисления.Регистратор = &парамРегистратор
	|	И ОсновныеНачисления.Авторасчет
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	ПериодДействия";
	
	СписокВРПоДням =
	"ВЫБРАТЬ
	|	ОсновныеНачисленияОрганизаций.Ссылка КАК ВидРасчета
	|ПОМЕСТИТЬ ВТ_СписокВРПоДням
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияОрганизаций.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеВПределахНормы), ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеСверхНормы))
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидРасчета";
	
	СписокВРПоЧасам =
	"ВЫБРАТЬ
	|	ОсновныеНачисленияОрганизаций.Ссылка КАК ВидРасчета
	|ПОМЕСТИТЬ ВТ_СписокВРПоЧасам
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияОрганизаций.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеСверхНормы), ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеОтработанноеВПределахНормы))
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидРасчета";
	
	ОсновныеФПД = 
	"ВЫБРАТЬ
	|	ФактическийПериодДействия.НомерСтроки,
	|	ФактическийПериодДействия.Сотрудник КАК Сотрудник,
	|	ФактическийПериодДействия.Организация КАК Организация,
	|	ФактическийПериодДействия.ПериодДействия КАК ПериодДействия,
	|	ФактическийПериодДействия.ПериодДействияНачало,
	|	ФактическийПериодДействия.ПериодДействияКонец
	|ПОМЕСТИТЬ ВТ_ОсновныеФПД
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
	|			Регистратор = &парамРегистратор
	|				И Авторасчет) КАК ФактическийПериодДействия
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	Организация,
	|	ПериодДействия";
	
	
	ВсегоОтработаноВремени = 
	"ВЫБРАТЬ
	|	НесгруппированныеДанные.НомерСтроки КАК НомерСтроки,
	|	СУММА(НесгруппированныеДанные.ОтработаноДней) КАК ВсегоОтработаноДней,
	|	СУММА(НесгруппированныеДанные.ОтработаноЧасов) КАК ВсегоОтработаноЧасов
	|ПОМЕСТИТЬ ВТВсегоОтработаноВремени
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основной.НомерСтроки КАК НомерСтроки,
	|		ГрафикиРаботы.ОсновноеЗначение + ВЫБОР
	|			КОГДА Вспомогательный.ВидРасчета.ВидВремени = ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеСверхНормы)
	|				ТОГДА Вспомогательный.ОтработаноДней
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ОтработаноДней,
	|		ГрафикиРаботы.ДополнительноеЗначение КАК ОтработаноЧасов,
	|		Вспомогательный.ВидРасчета КАК ВидРасчета,
	|		Вспомогательный.Результат КАК Результат
	|	ИЗ
	|		ВТ_ОсновныеФПД КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
	|					ВидРасчета В
	|							(ВЫБРАТЬ
	|								СписокВР.ВидРасчета
	|							ИЗ
	|								ВТ_СписокВРПоДням КАК СписокВР)
	|						И (Сотрудник, ПериодДействия) В
	|							(ВЫБРАТЬ
	|								ОсновныеНачисления.Сотрудник,
	|								ОсновныеНачисления.ПериодДействия
	|							ИЗ
	|								ВТ_СотрудникиПериодыДействия КАК ОсновныеНачисления)) КАК Вспомогательный
	|			ПО Основной.Сотрудник = Вспомогательный.Сотрудник
	|				И Основной.Организация = Вспомогательный.Организация
	|				И Основной.ПериодДействия = Вспомогательный.ПериодДействия
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботы
	|			ПО (Вспомогательный.ГрафикРаботы = ГрафикиРаботы.ГрафикРаботы)
	|				И (ГрафикиРаботы.Месяц = Вспомогательный.ПериодДействия)
	|				И (ГрафикиРаботы.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
	|				И (ГрафикиРаботы.Дата МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец)
	|				И (ГрафикиРаботы.Дата МЕЖДУ Вспомогательный.ПериодДействияНачало И Вспомогательный.ПериодДействияКонец)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Основной.НомерСтроки,
	|		0,
	|		Вспомогательный.ОтработаноЧасов,
	|		NULL,
	|		NULL
	|	ИЗ
	|		ВТ_ОсновныеФПД КАК Основной
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
	|					ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоЧасам)
	|						И ВидРасчета В
	|							(ВЫБРАТЬ
	|								СписокВР.ВидРасчета
	|							ИЗ
	|								ВТ_СписокВРПоЧасам КАК СписокВР)
	|						И (Сотрудник, ПериодДействия) В
	|							(ВЫБРАТЬ
	|								ОсновныеНачисления.Сотрудник,
	|								ОсновныеНачисления.ПериодДействия
	|							ИЗ
	|								ВТ_СотрудникиПериодыДействия КАК ОсновныеНачисления)) КАК Вспомогательный
	|			ПО Основной.Сотрудник = Вспомогательный.Сотрудник
	|				И Основной.Организация = Вспомогательный.Организация
	|				И Основной.ПериодДействия = Вспомогательный.ПериодДействия
	|				И (Вспомогательный.ПериодДействияНачало МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец)
	|				И (Вспомогательный.ПериодДействияКонец МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец)) КАК НесгруппированныеДанные
	|
	|СГРУППИРОВАТЬ ПО
	|	НесгруппированныеДанные.НомерСтроки
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НомерСтроки";
	
	ФизлицаПериодыДействия =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	УправленческиеНачисления.ФизЛицо КАК ФизЛицо,
	|	УправленческиеНачисления.ПериодДействия КАК ПериодДействия
	|ПОМЕСТИТЬ ВТ_ФизлицаПериодыДействия
	|ИЗ
	|	РегистрРасчета.УправленческиеНачисления КАК УправленческиеНачисления
	|ГДЕ
	|	УправленческиеНачисления.Регистратор = &парамРегистратор
	|	И УправленческиеНачисления.Авторасчет
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	ПериодДействия";
	// Сумма отработанного времени по видам времени: 
	//	ОтработанноеВПределахНормы,
	//	ЧасовоеОтработанноеВПределахНормы,
	//	ОтработанноеСверхНормы, необходим для расчета показателей ОтработаноВремениВДнях, ОтработаноВремениВЧасах
	
	УпрВсегоОтработаноВремени = 
	"ВЫБРАТЬ
	|	Основной.НомерСтроки КАК НомерСтроки,
	|	СУММА(ГрафикиРаботы.ОсновноеЗначение) КАК ВсегоОтработаноДней,
	|	СУММА(ГрафикиРаботы.ДополнительноеЗначение) КАК ВсегоОтработаноЧасов
	|ПОМЕСТИТЬ ВТУпрВсегоОтработаноВремени
	|ИЗ
	|	РегистрРасчета.УправленческиеНачисления.ФактическийПериодДействия(
	|			Регистратор = &парамРегистратор
	|				И Авторасчет) КАК Основной
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.УправленческиеНачисления.ФактическийПериодДействия(
	|				ВидРасчета.ЗачетОтработанногоВремени
	|					И (ФизЛицо, ПериодДействия) В
	|						(ВЫБРАТЬ
	|							УправленческиеНачисления.ФизЛицо,
	|							УправленческиеНачисления.ПериодДействия
	|						ИЗ
	|							ВТ_ФизлицаПериодыДействия КАК УправленческиеНачисления)) КАК Вспомогательный
	|		ПО Основной.ФизЛицо = Вспомогательный.ФизЛицо
	|			И Основной.ПериодДействия = Вспомогательный.ПериодДействия
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботы
	|		ПО (Вспомогательный.ГрафикРаботы = ГрафикиРаботы.ГрафикРаботы)
	|			И (ГрафикиРаботы.Месяц = Вспомогательный.ПериодДействия)
	|			И (ГрафикиРаботы.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
	|			И (ГрафикиРаботы.Дата МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец)
	|			И (ГрафикиРаботы.Дата МЕЖДУ Вспомогательный.ПериодДействияНачало И Вспомогательный.ПериодДействияКонец)
	|
	|СГРУППИРОВАТЬ ПО
	|	Основной.НомерСтроки
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НомерСтроки";
	
	
	// СоответствиеТабеляИНачислений
	// Данное по ошибке, возникающей в случае ввода табеля с отклонениями, на которые не введены документы
	//	Поля 
	//		НомерСтроки
	//		ПредупреждениеОНесоответствииТабеляИНачисления
	//
	//	Описание                       
	//	Суммируем отработанное время в заданном периоде действия для каждой строки начисления
	//	из регистра РабочееВремяРаботниковОрганизаций 
	
	СоответствиеТабеляИНачислений = 
	"ВЫБРАТЬ
	|	Основной.НомерСтроки КАК НомерСтроки,
	|	ВЫБОР
	|		КОГДА Основной.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
	|					И Основной.ОсновноеЗначениеФактическийПериодДействия = СУММА(РабочееВремяРаботниковОрганизаций.Дней)
	|				ИЛИ Основной.ВидУчетаВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоЧасам), ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоВечернимЧасам), ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоНочнымЧасам))
	|					И Основной.ОсновноеЗначениеФактическийПериодДействия = СУММА(РабочееВремяРаботниковОрганизаций.Часов)
	|				ИЛИ СУММА(РабочееВремяРаботниковОрганизаций.Часов) ЕСТЬ NULL 
	|			ТОГДА ЛОЖЬ
	|		КОГДА (НЕ Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени В 
	|			(ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка), 
	|			ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Сверхурочные), 
	|			ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы), 
	|			ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы), 
	|			ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)))
	|				И (НЕ СУММА(РабочееВремяРаботниковОрганизаций.Дней) ЕСТЬ NULL )
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ПредупреждениеОНесоответствииТабеляИНачисления
	|ПОМЕСТИТЬ ВТСоответствиеТабеляИНачислений
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ДанныеГрафика(Регистратор = &парамРегистратор) КАК Основной
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
	|		ПО (РабочееВремяРаботниковОрганизаций.Период МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец)
	|			И Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени
	|			И Основной.Сотрудник = РабочееВремяРаботниковОрганизаций.Сотрудник
	|			И (НАЧАЛОПЕРИОДА(РабочееВремяРаботниковОрганизаций.Период, МЕСЯЦ) = &парамПериодРегистрации)
	|			И ((НЕ РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод))
	|ГДЕ
	|	Основной.Авторасчет
	|	И Основной.Регистратор = &ПарамРегистратор
	|
	|СГРУППИРОВАТЬ ПО
	|	Основной.НомерСтроки,
	|	Основной.ВидУчетаВремени,
	|	Основной.ОсновноеЗначениеФактическийПериодДействия,
	|	Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени";	
	
	
	
	// ВремяПоТабелю
	//	данные по отработанному времени и норме времени по методу "сплошной регистрации" в текущем периоде регистрации
	//	Поля 
	//		НомерСтроки
	//		ОтработаноДнейПоТабелю
	//		ОтработаноЧасовПоТабелю
	//		ОтработаноЧасовПоТабелюОтклонение
	//
	//	Описание                       
	//	Суммируем отработанное время и норму времени в заданном периоде действия для каждой строки начисления
	//	из регистра РабочееВремяРаботниковОрганизаций 
	
	УпрВремяПоТабелюТекст = 
	"ВЫБРАТЬ
	|	Основной.НомерСтроки КАК НомерСтроки,
	|	СУММА(ВЫБОР
	|			КОГДА Основной.ВидРасчета.ВидУчетаРабочегоВремени = ОтработанноеВремя.ВидИспользованияРабочегоВремени
	|				ТОГДА ВЫБОР
	|						КОГДА Основной.ВидУчетаВремени = &ПоДням
	|							ТОГДА ОтработанноеВремя.Дней
	|						ИНАЧЕ ОтработанноеВремя.Часов
	|					КОНЕЦ
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОсновноеЗначениеПоТабелю,
	|	СУММА(ВЫБОР
	|			КОГДА Основной.ВидРасчета.ВидУчетаРабочегоВремени = ОтработанноеВремя.ВидИспользованияРабочегоВремени
	|				ТОГДА ОтработанноеВремя.Дней
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОтработаноДнейПоТабелю,
	|	СУММА(0) КАК ВнутрисменныеЧасыОтклонение,
	|	СУММА(ВЫБОР
	|			КОГДА Основной.ВидРасчета.ВидУчетаРабочегоВремени = ОтработанноеВремя.ВидИспользованияРабочегоВремени
	|				ТОГДА ОтработанноеВремя.Часов
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОтработаноЧасовПоТабелю,
	|	 0 КАК ОтработаноЧасовПоТабелюОтклонение
	|ПОМЕСТИТЬ ВТУпрВремяПоТабелю
	|ИЗ
	|	РегистрРасчета.УправленческиеНачисления КАК Основной
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК ОтработанноеВремя
	|		ПО Основной.Физлицо = ОтработанноеВремя.Сотрудник.Физлицо
	|			И (ОтработанноеВремя.Период МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец)
	|			И ((НЕ ОтработанноеВремя.ВЦеломЗаПериод))
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.Авторасчет
	|
	|СГРУППИРОВАТЬ ПО
	|	Основной.НомерСтроки
	|ИНДЕКСИРОВАТЬ ПО 
	|	НомерСтроки";
	
	
	// ОтработаноПоВидуВремениДляПоказателейТекст
	//	Данные по отработанному времени введенное табелем по указанному в начислении виду учета времени
	УпрОтработаноПоВидуВремениДляПоказателейТекст = 
	"ВЫБРАТЬ
	|	Основной.НомерСтроки КАК НомерСтроки,
	|	СУММА(РабочееВремяРаботников.Дней) КАК Дней,
	|	СУММА(РабочееВремяРаботников.Часов) КАК Часов
	|ПОМЕСТИТЬ ВТУпрОтработаноПоВидуВремениДляПоказателей
	|ИЗ
	|	РегистрРасчета.УправленческиеНачисления КАК Основной
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботников
	|		ПО Основной.Физлицо = РабочееВремяРаботников.Сотрудник.Физлицо
	|			И (РабочееВремяРаботников.Период МЕЖДУ Основной.ПериодДействияНачало И Основной.ПериодДействияКонец)
	|			И (РабочееВремяРаботников.ВидИспользованияРабочегоВремени = Основной.ВидРасчета.ВидУчетаРабочегоВремени)
	|			И (Основной.ВидРасчета.ВидУчетаРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка))
	|			И (РабочееВремяРаботников.Регистратор <> &парамРегистратор)
	|			И (РабочееВремяРаботников.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации)
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.Авторасчет
	|
	|СГРУППИРОВАТЬ ПО
	|	Основной.НомерСтроки
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НомерСтроки";
	
	УпрВремяВведенноеВЦеломЗаПериодТекст = 
	"ВЫБРАТЬ
	|	Основной.НомерСтроки КАК НомерСтроки,
	|	СУММА(ВЫБОР
	|			КОГДА Основной.ВидУчетаВремени = &ПоДням
	|				ТОГДА ОтработанноеВремя.Дней
	|			ИНАЧЕ ОтработанноеВремя.Часов
	|		КОНЕЦ) КАК ОсновноеЗначениеПоТабелю,
	|	СУММА(ОтработанноеВремя.Дней) КАК ДнейПоТабелю,
	|	СУММА(ОтработанноеВремя.Часов) КАК ЧасовПоТабелю,
	|	МАКСИМУМ(ВЫБОР
	|			КОГДА (НАЧАЛОПЕРИОДА(Основной.ПериодДействияНачало, ДЕНЬ) > ПроверкаКоличестваЗаписей.ПериодДействияНачало
	|					ИЛИ КОНЕЦПЕРИОДА(Основной.ПериодДействияКонец, ДЕНЬ) < ПроверкаКоличестваЗаписей.ПериодДействияКонец)
	|					И ОтработанноеВремя.Дней ЕСТЬ НЕ NULL 
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ОшибкаВводаОтработанногоВремени
	|ПОМЕСТИТЬ ВТУпрВремяВведенноеВЦеломЗаПериод
	|ИЗ
	|	РегистрРасчета.УправленческиеНачисления КАК Основной
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			НАЧАЛОПЕРИОДА(МИНИМУМ(НачисленияРаботников.ПериодДействияНачало), ДЕНЬ) КАК ПериодДействияНачало,
	|			КОНЕЦПЕРИОДА(МАКСИМУМ(НачисленияРаботников.ПериодДействияКонец), ДЕНЬ) КАК ПериодДействияКонец,
	|			НачисленияРаботников.ПериодДействия КАК ПериодДействия,
	|			НачисленияРаботников.ВидРасчета КАК ВидРасчета,
	|			НачисленияРаботников.ФизЛицо КАК ФизЛицо
	|		ИЗ
	|			РегистрРасчета.УправленческиеНачисления КАК НачисленияРаботников
	|		ГДЕ
	|			НачисленияРаботников.Регистратор = &парамРегистратор
	|			И НачисленияРаботников.Авторасчет
	|		
	|		СГРУППИРОВАТЬ ПО
	|			НачисленияРаботников.ПериодДействия,
	|			НачисленияРаботников.ВидРасчета,
	|			НачисленияРаботников.ФизЛицо) КАК ПроверкаКоличестваЗаписей
	|		ПО Основной.ФизЛицо = ПроверкаКоличестваЗаписей.ФизЛицо
	|			И Основной.ВидРасчета = ПроверкаКоличестваЗаписей.ВидРасчета
	|			И Основной.ПериодДействия = ПроверкаКоличестваЗаписей.ПериодДействия
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК ОтработанноеВремя
	|		ПО Основной.Физлицо = ОтработанноеВремя.Сотрудник.Физлицо
	|			И ОтработанноеВремя.Период = Основной.ПериодДействия
	|			И Основной.ВидРасчета.ВидУчетаРабочегоВремени = ОтработанноеВремя.ВидИспользованияРабочегоВремени
	|			И (ОтработанноеВремя.ВЦеломЗаПериод)
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.Авторасчет
	|
	|СГРУППИРОВАТЬ ПО
	|	Основной.НомерСтроки
	|ИНДЕКСИРОВАТЬ ПО 
	|	НомерСтроки";
	
	УпрСводныеИндивидуальныеГрафикиТекст = 
	"ВЫБРАТЬ
	|	Основной.НомерСтроки КАК НомерСтроки,
	|	ВЫБОР
	|		КОГДА Основной.ВидУчетаВремени = &ПоДням
	|			ТОГДА СводныеИндивидуальныеГрафики.Дней
	|		КОГДА Основной.ВидУчетаВремени = &ПоЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.Часов
	|		КОГДА Основной.ВидУчетаВремени = &ПоВечернимЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.ЧасовВечерних
	|		КОГДА Основной.ВидУчетаВремени = &ПоНочнымЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.ЧасовНочных
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НормаВремени,
	|	ВЫБОР
	|		КОГДА Основной.ВидУчетаВремени = &ПоДням
	|			ТОГДА СводныеИндивидуальныеГрафики.Дней
	|		КОГДА Основной.ВидУчетаВремени = &ПоВечернимЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.ЧасовВечерних
	|		КОГДА Основной.ВидУчетаВремени = &ПоНочнымЧасам
	|			ТОГДА СводныеИндивидуальныеГрафики.ЧасовНочных
	|		ИНАЧЕ СводныеИндивидуальныеГрафики.Часов
	|	КОНЕЦ КАК ОсновноеЗначение,
	|	СводныеИндивидуальныеГрафики.Дней КАК ДнейПоГрафику,
	|	СводныеИндивидуальныеГрафики.Часов КАК ЧасовПоГрафику,
	|	СводныеИндивидуальныеГрафики.Дней КАК НормаДнейПоГрафику,
	|	СводныеИндивидуальныеГрафики.Часов КАК НормаЧасовПоГрафику,
	|	ВЫБОР
	|		КОГДА (НАЧАЛОПЕРИОДА(Основной.ПериодДействияНачало, ДЕНЬ) > Основной.ПериодДействия
	|				ИЛИ КОНЕЦПЕРИОДА(Основной.ПериодДействияКонец, ДЕНЬ) < КОНЕЦПЕРИОДА(Основной.ПериодДействия, МЕСЯЦ))
	|				И СводныеИндивидуальныеГрафики.Дней ЕСТЬ НЕ NULL 
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ОшибкаВводаИндивидуальногоГрафикаРаботы
	|ПОМЕСТИТЬ ВТУпрСводныеИндивидуальныеГрафики
	|ИЗ
	|	РегистрРасчета.УправленческиеНачисления КАК Основной
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
	|		ПО Основной.ФизЛицо = СводныеИндивидуальныеГрафики.Сотрудник
	|			И (СводныеИндивидуальныеГрафики.Месяц = Основной.ПериодДействия)
	|ГДЕ
	|	Основной.Регистратор = &парамРегистратор
	|	И Основной.Авторасчет
	|ИНДЕКСИРОВАТЬ ПО 
	|	НомерСтроки";
	
	// Конец определения текстов вложенных запросов
	/////////////////////////////////////////////////////////////////////
	
	Запрос = Новый Запрос();
	НеобходимаБаза = НеобходимыеДанные.База;
	НеобходимГрафик = НеобходимыеДанные.НормаВремени ИЛИ НеобходимыеДанные.ОтработаноВремени ИЛИ НеобходимыеДанные.НормаВремениЗаМесяц;
	
	МенеджерВТ = Новый МенеджерВременныхТаблиц;
	Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
	
	// параметры запросов
	//О.Т. Аверсон 18.05.2017 № 653
	МассивИЛСпособыРасчета = Новый СписокЗначений;
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом);
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела);
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПределаСНДФЛ);
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ);
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела);
	//О.Т. Аверсон 24.05.2017 № 665
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ);
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПочтовыйСбор); //Аверсон 07.07.2022 КВВ СВФР-008761 может надо еще условие на : НеобходимыеДанные.ПочтовыеПереводы=Истина
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела);
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой);
	МассивИЛСпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой);
	
	//О.Т. Аверсон 24.05.2017 № 665
	Если ТекЗначение<> Неопределено Тогда 
		Запрос.УстановитьПараметр("ТекЗначение",Истина);
		
	иначе
		Запрос.УстановитьПараметр("ТекЗначение",Ложь);
		
	КонецЕсли;
	Запрос.УстановитьПараметр("СпособРасчетаИЛ",МассивИЛСпособыРасчета);
	//О.Т. Аверсон 18.05.2017 № 653
	
	Запрос.УстановитьПараметр("ВидРасчетаПрофВзнос",ОбщегоНазначения.ПолучитьПрофВзносыВУдержаниях());//О.Т. Аверсон 21.07.2017 № 852
	
	//+ СВЭЙ КДЯ 03.10.19 СВФР-004756
	//Запрос.УстановитьПараметр("парамРегистратор", Регистратор);
	//Запрос.УстановитьПараметр("парамПериодРегистрации", ПериодРегистрации);
	//- СВЭЙ КДЯ 03.10.19 СВФР-004756
	//+ СВЭЙ КДЯ 03.10.19 СВФР-004756
	Запрос.УстановитьПараметр( "парамРегистратор", ПолучитьРеквизитПервичного( Регистратор, "Ссылка" ) );
	Запрос.УстановитьПараметр( "парамПериодРегистрации", ПолучитьРеквизитПервичного( Регистратор, "ПериодРегистрации" ) );
	//- СВЭЙ КДЯ 03.10.19 СВФР-004756
	
	Запрос.УстановитьПараметр("парамОрганизация", Организация);
	Запрос.УстановитьПараметр("парамПриход", ВидДвиженияНакопления.Приход);
	// категория начисления (удержания)
	Запрос.УстановитьПараметр("парамКатегорияНачисления", КатегорияНачисления);
	Запрос.УстановитьПараметр("ПустойВидНалогообложения", Справочники.ВидыНалогообложения.ПустаяСсылка());//О.Т. Аверсон 13.07.2016 № 1308
	
	Если ИмяРегистра = "ДополнительныеНачисленияРаботниковОрганизаций" ИЛИ 
		ИмяРегистра = "ОсновныеНачисленияРаботниковОрганизаций" или 
		ИмяРегистра = "УправленческиеНачисления" или 
		ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда
		Условие = "ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления И Регистратор = &парамРегистратор И Авторасчет";
		//О.Т. 13.10.2014 № 17616
		//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
		//	ВнешнееУсловие = "ВложенныйЗапрос.ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления И ВложенныйЗапрос.Регистратор = &парамРегистратор";
		//иначе
		
		ВнешнееУсловие = "Основной.ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления И Основной.Регистратор = &парамРегистратор";
		//О.Т. 17.02.2015 № 334
		Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
			Если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу и ПериодСреднегоПоОкладу <> Неопределено Тогда
				ВнешнееУсловие = ВнешнееУсловие + " И Основной.ПериодДействия МЕЖДУ &ПериодДействияПоОкладу И КОНЕЦПЕРИОДА(&ПериодДействияПоОкладу, МЕСЯЦ)";
				Запрос.УстановитьПараметр("ПериодДействияПоОкладу",ПериодСреднегоПоОкладу);
			КонецЕсли;
		КонецЕсли;
		//О.Т. 17.02.2015 № 334
		//КонецЕсли;
		//О.Т. 13.10.2014 № 17616
	Иначе
		Условие = "Регистратор = &парамРегистратор И Авторасчет";
		//О.Т. 13.10.2014 № 17616
		//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
		//	ВнешнееУсловие = "ВложенныйЗапрос.Регистратор = &парамРегистратор";
		//иначе	
		ВнешнееУсловие = "Основной.Регистратор = &парамРегистратор";
		//КонецЕсли;
		//О.Т. 13.10.2014 № 17616
	КонецЕсли;
	
	Если Перерасчет тогда
		Если Физлица = Неопределено Тогда
			Запрос.Текст = ФизлицаДляПерерасчетаТекст;
			Запрос.Выполнить();
			ФизлицаДляПерерасчетаТекст = "ВТФизлицаДляПерерасчета";
			
			УсловиеНаФизлицоТекст = "Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТФизлицаДляПерерасчета)";
			Условие = Условие + " И " + УсловиеНаФизлицоТекст + " И Авторасчет";
			// в данном случае внешнее условие не дополняется - выполняется внутреннее 
			// соединение с таблицей СотрудникиДляПерерасчета
		Иначе
			УсловиеНаФизлицоТекст = "Физлицо В (&ФизлицаПерерасчета)";
			Условие = Условие + " И " + УсловиеНаФизлицоТекст + " И Авторасчет";
			//О.Т. 13.10.2014 № 17616
			//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
			//	ВнешнееУсловие = ВнешнееУсловие + " И ВложенныйЗапрос.Физлицо В (&ФизлицаПерерасчета)";
			//иначе
			ВнешнееУсловие = ВнешнееУсловие + " И Основной.Физлицо В (&ФизлицаПерерасчета)";
			//КонецЕсли;
			Запрос.УстановитьПараметр("ФизлицаПерерасчета", Физлица);
		КонецЕсли;
	Иначе
		Если Физлица = Неопределено Тогда //О.Т. 11.09.2014 № 17594
			если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда 
				УсловиеНаФизлицоТекст = 
				"Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТФизлицаДляПроверки)";
				// поместим в запрос временную таблицу для проверки условия на физлиц
				//Островская Татьяна 17.01.2013 № 16154
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
				|	СотрудникиОрганизаций.Физлицо
				|ПОМЕСТИТЬ ВТФизлицаДляПроверки
				|ИЗ
				|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
				|ГДЕ
				|	СотрудникиОрганизаций.Организация = &парамОрганизация";
				Запрос.Выполнить();
			иначе
				
				УсловиеНаФизлицоТекст = 
				"Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТФизлицаДляПроверки)";
				// поместим в запрос временную таблицу для проверки условия на физлиц
				//Островская Татьяна 17.01.2013 № 16154
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
				|	РаботникиОрганизаций.Сотрудник.Физлицо КАК Физлицо,
				|	РаботникиОрганизаций.Регистратор
				|ПОМЕСТИТЬ ВТФизлицаДляПроверки
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
				|ГДЕ
				|	РаботникиОрганизаций.Организация = &парамОрганизация
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Физлицо";
				Запрос.Выполнить();
			КонецЕсли;
		иначе
			если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда 
				УсловиеНаФизлицоТекст = 
				"Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТФизлицаДляПроверки)";
				// поместим в запрос временную таблицу для проверки условия на физлиц
				//Островская Татьяна 17.01.2013 № 16154
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
				|	СотрудникиОрганизаций.Физлицо
				|ПОМЕСТИТЬ ВТФизлицаДляПроверки
				|ИЗ
				|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
				|ГДЕ
				|	СотрудникиОрганизаций.Организация = &парамОрганизация
				|	И СотрудникиОрганизаций.Физлицо в (&Физлица)";
				Запрос.УстановитьПараметр("Физлица", Физлица);
				Запрос.Выполнить();
				
			иначе
				УсловиеНаФизлицоТекст = 
				"Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТФизлицаДляПроверки)";
				// поместим в запрос временную таблицу для проверки условия на физлиц
				//Островская Татьяна 17.01.2013 № 16154
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
				|	РаботникиОрганизаций.Сотрудник.Физлицо КАК Физлицо,
				|	РаботникиОрганизаций.Регистратор
				|ПОМЕСТИТЬ ВТФизлицаДляПроверки
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
				|ГДЕ
				|	РаботникиОрганизаций.Организация = &парамОрганизация
				|   И РаботникиОрганизаций.Сотрудник.ФизЛицо в (&ФизЛица)
				|ИНДЕКСИРОВАТЬ ПО
				|	Физлицо";
				Запрос.УстановитьПараметр("Физлица", Физлица);
				Запрос.Выполнить();
			КонецЕсли;
		КонецЕсли; //О.Т. 11.09.2014 № 17594
		//Островская Татьяна 17.01.2013 № 16154
	КонецЕсли;
	
	// для формирования ИТОГИ при комментировании расчета
	ПоляЗапроса = Новый Массив;
	
	ПроцентныеПоказатели = Новый Массив;
	ПроцентныеПоказатели.Добавить(Перечисления.ТипыПоказателейСхемМотивации.ОценочнаяШкалаПроцентная);
	ПроцентныеПоказатели.Добавить(Перечисления.ТипыПоказателейСхемМотивации.Процентный);
	Запрос.УстановитьПараметр("ПроцентныеПоказатели", ПроцентныеПоказатели);
	
	ШкальныеПоказатели = Новый Массив;
	ШкальныеПоказатели.Добавить(Перечисления.ТипыПоказателейСхемМотивации.ОценочнаяШкалаПроцентная);
	ШкальныеПоказатели.Добавить(Перечисления.ТипыПоказателейСхемМотивации.ОценочнаяШкалаЧисловая);
	Запрос.УстановитьПараметр("ШкальныеПоказатели", ШкальныеПоказатели);				
	
	Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
		
		Если ИмяРегистра = "ОсновныеНачисленияРаботниковОрганизаций" Тогда
			ИмяПВР = "ОсновныеНачисленияОрганизаций";
		ИначеЕсли ИмяРегистра = "ДополнительныеНачисленияРаботниковОрганизаций" Тогда
			ИмяПВР = "ДополнительныеНачисленияОрганизаций";						
		ИначеЕсли ИмяРегистра = "УправленческиеНачисления" Или ИмяРегистра = "УправленческиеУдержания" Тогда 			
			ИмяПВР = ИмяРегистра;			
		ИначеЕсли ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда
			ИмяПВР = "УдержанияОрганизаций";
		КонецЕсли;
		
		// Получим максимальное число показателей			
		Запрос.Текст =
		"ВЫБРАТЬ
		|	МАКСИМУМ(ВложенныйЗапрос.НомерСтроки) КАК КолВоПоказателей
		|ИЗ
		|	РегистрРасчета."+ИмяРегистра +" КАК Основной
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|	(ВЫБРАТЬ
		|		Показатели.Ссылка,
		|		Показатели.НомерСтроки КАК НомерСтроки
		|	ИЗ
		|		ПланВидовРасчета." + ИмяПВР +".Показатели КАК Показатели) КАК ВложенныйЗапрос
		|	ПО ВложенныйЗапрос.Ссылка = Основной.ВидРасчета
		|ГДЕ " + ВнешнееУсловие;
		
		ВыборкаКоличестваПоказателей = Запрос.Выполнить().Выбрать();
		ВыборкаКоличестваПоказателей.Следующий();
		КоличествоПоказателей = ВыборкаКоличестваПоказателей.КолВоПоказателей;
		Если КоличествоПоказателей = Null Тогда
			КоличествоПоказателей = 0;
		КонецЕсли;
		
		Показатель1Текст = ПолучитьТекстПоказателя(НеобходимыеДанные,ИмяРегистра,,КомментироватьРасчет);
		Если КоличествоПоказателей > 6 Тогда
			// получим текст запроса для предопределенных показателей
			Показатель1ТекстПредопределенный = ПолучитьТекстПоказателя(НеобходимыеДанные,ИмяРегистра, Истина,КомментироватьРасчет);
		КонецЕсли;
		
		// получим временную таблицу с расчетом показателей
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Основной.ВидРасчета,
		|	МАКСИМУМ(ВСЕПоказатели.НомерСтроки) КАК КоличествоПоказателей";
		Для СчПоказателей = 1 По КоличествоПоказателей Цикл
			Запрос.Текст = Запрос.Текст + ",
			|	Показатели"+ СчПоказателей + ".Показатель КАК Показатель" + СчПоказателей;
		КонецЦикла;
		Запрос.Текст = Запрос.Текст + "
		|ПОМЕСТИТЬ ВТПоказатели
		|ИЗ
		|	РегистрРасчета."+ИмяРегистра +" КАК Основной
		|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета."+ИмяПВР+".Показатели КАК ВСЕПоказатели
		|	ПО Основной.ВидРасчета = ВСЕПоказатели.Ссылка";
		Для СчПоказателей = 1 По КоличествоПоказателей Цикл
			Запрос.Текст = Запрос.Текст + "
			|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета."+ИмяПВР+".Показатели КАК Показатели"+ СчПоказателей + "
			|	ПО Основной.ВидРасчета = Показатели"+ СчПоказателей + ".Ссылка 
			|	И  Показатели"+ СчПоказателей + ".НомерСтроки = "+ СчПоказателей;
		КонецЦикла;
		Запрос.Текст = Запрос.Текст + "
		|ГДЕ " + ВнешнееУсловие + "
		|СГРУППИРОВАТЬ ПО
		|	Основной.ВидРасчета";
		Для СчПоказателей = 1 По КоличествоПоказателей Цикл
			Запрос.Текст = Запрос.Текст + ",
			|	Показатели"+ СчПоказателей + ".Показатель";
		КонецЦикла;
		Запрос.Текст = Запрос.Текст + "
		|ИНДЕКСИРОВАТЬ ПО Основной.ВидРасчета";
		
		Запрос.Выполнить();
		
	КонецЕсли;
	
	// установка параметров связанных с виртуальными таблицами регистов расчета
	Если ИмяРегистра = "ДополнительныеНачисленияРаботниковОрганизаций" или
		ИмяРегистра = "ОсновныеНачисленияРаботниковОрганизаций" Тогда
		// измерения сопоставления
		Измерения = Новый Массив(1);
		Измерения[0] = "Сотрудник";
		// для начислений сопоставляемые измерения основного и базового регистов совпадают
		Запрос.УстановитьПараметр("парамИзмеренияОсновного", Измерения);
		Запрос.УстановитьПараметр("парамИзмеренияБазового", Измерения);
		// список способов расчета, являющихся почасовыми отклонениями
		Запрос.УстановитьПараметр("парамСписокПочасовыхОтклонений", ПолучитьСписокНачисленийПочасовыхОтклонений());
		
	ИначеЕсли	ИмяРегистра = "УправленческиеНачисления" ИЛИ
		ИмяРегистра = "УправленческиеУдержания"
		Тогда
		// измерения сопоставления для управленческих регистров
		Измерения = Новый Массив(1);
		Измерения[0] = "Физлицо";
		// для начислений сопоставляемые измерения основного и базового регистов совпадают
		Запрос.УстановитьПараметр("парамИзмеренияОсновного", Измерения);
		Запрос.УстановитьПараметр("парамИзмеренияБазового", Измерения);
		
	Иначе
		// измерения сопоставления для удержаний
		Измерения = Новый Массив(2);
		Измерения[0] = "ФизЛицо";
		Измерения[1] = "Организация";
		// для удержаний сопоставляемые измерения основного и базового регистов разные
		Запрос.УстановитьПараметр("парамИзмеренияОсновного", Измерения);
		Запрос.УстановитьПараметр("парамИзмеренияБазового", Измерения);
		
	КонецЕсли;
	
	Если ИмяРегистра = "ОсновныеНачисленияРаботниковОрганизаций" Тогда
		
		ТекстЗапроса = 
		"ВЫБРАТЬ 
		|Основной.Регистратор Как Регистратор,
		|Основной.НомерСтроки Как НомерСтроки,
		|Основной.ВидРасчета Как ВидРасчета,
		|Основной.ВидРасчета.Наименование Как ВидРасчетаНаименование,
		|Основной.ВидРасчета.ПериодДействияБазовый Как ВидРасчетаПериодДействияБазовый,
		|Основной.Сотрудник Как Сотрудник,
		|Основной.Сотрудник.Наименование Как СотрудникНаименование,
		|Основной.Сотрудник.Физлицо Как Физлицо,
		|Основной.ПериодДействияНачало Как ПериодДействияНачало,
		|Основной.ПериодДействияКонец Как ПериодДействияКонец,
		|Основной.ВидРасчета.ЗачетОтработанногоВремени Как ЗачетОтработанногоВремени,
		|Основной.ВидРасчета.ЗачетНормыВремени Как ЗачетНормыВремени,
		|Основной.ВидУчетаВремени Как ВидУчетаВремени,
		|Основной.ВидРасчета.СпособРасчета Как СпособРасчета, 
		|Основной.ВариантАлгоритмаРасчета Как ВариантАлгоритмаРасчета, 
		|ВЫБОР КОГДА Основной.ВидРасчета.ВидВремени В(&парамСписокПочасовыхОтклонений) ТОГДА ИСТИНА ИНАЧЕ ЛОЖЬ КОНЕЦ КАК ВидРасчетаЯвляетсяПочасовымОтклонением,
		|Основной.ВидРасчета.КодДоходаНДФЛ Как КодДоходаНДФЛ";
		
		Если КомментироватьРасчет Тогда
			ПоляЗапроса.Добавить("Сотрудник");
			ПоляЗапроса.Добавить("СотрудникНаименование");
			ПоляЗапроса.Добавить("Регистратор");//О.Т. Аверсон 18.04.2017 № 531
			ПоляЗапроса.Добавить("ФизЛицо"); //О.Т. Аверсон 18.04.2017 № 531
			ПоляЗапроса.Добавить("ПериодДействияНачало");
			ПоляЗапроса.Добавить("ПериодДействияКонец");
			ПоляЗапроса.Добавить("ЗачетОтработанногоВремени");
			ПоляЗапроса.Добавить("ЗачетНормыВремени");
			ПоляЗапроса.Добавить("ВидУчетаВремени");
			ПоляЗапроса.Добавить("СпособРасчета");
			ПоляЗапроса.Добавить("ВариантАлгоритмаРасчета");
			ПоляЗапроса.Добавить("ВидРасчетаЯвляетсяПочасовымОтклонением");
			ПоляЗапроса.Добавить("КодДоходаНДФЛ");
			ПоляЗапроса.Добавить("ВидРасчета");
			ПоляЗапроса.Добавить("ВидРасчетаНаименование");
			ПоляЗапроса.Добавить("ВидРасчетаПериодДействияБазовый");
		КонецЕсли;
		
		Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
			
			Если КоличествоПоказателей = 0 Тогда
				ТекстЗапроса = ТекстЗапроса + ",
				| 0 КАК КоличествоПоказателей,";
			Иначе
				ТекстЗапроса = ТекстЗапроса + ",
				| Показатели.КоличествоПоказателей КАК КоличествоПоказателей,";
			КонецЕсли;
			
			ТекстЗапроса = ТекстЗапроса + "
			| Основной.ВидРасчета.ФормулаРасчета КАК ФормулаРасчета";
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("КоличествоПоказателей");
				ПоляЗапроса.Добавить("ФормулаРасчета");
			КонецЕсли;
			
			Для СчПоказателей = 1 По КоличествоПоказателей Цикл
				Если СчПоказателей > 6 Тогда					
					ПоказательТекст = СтрЗаменить(Показатель1ТекстПредопределенный, "Показатель1", "Показатель"+СчПоказателей);
				ИначеЕсли СчПоказателей > 1 Тогда
					ПоказательТекст = СтрЗаменить(Показатель1Текст, "Показатель1", "Показатель"+СчПоказателей);
				Иначе
					ПоказательТекст = Показатель1Текст;
				КонецЕсли;					
				
				ТекстЗапроса = ТекстЗапроса + ", 
				|Показатели.Показатель" + СчПоказателей+".Наименование Как Показатель" + СчПоказателей + "Наименование,
				|" + ПоказательТекст + " Как Показатель"+СчПоказателей;
				
				Если КомментироватьРасчет Тогда
					ПоляЗапроса.Добавить("Показатель" + СчПоказателей + "Наименование");
					ПоляЗапроса.Добавить("Показатель" + СчПоказателей);
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
		Если НеобходимаБаза Тогда
			Если КомментироватьРасчет Тогда
				ТекстЗапроса = ТекстЗапроса + ",
				|База.РезультатБаза Как РезультатБаза,
				|База.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
				|База.ВидРасчетаРазрез.Наименование КАК ВидРасчетаРазрезНаименование";
				ПоляЗапроса.Добавить("РезультатБаза");
				ПоляЗапроса.Добавить("ВидРасчетаРазрез");
				ПоляЗапроса.Добавить("ВидРасчетаРазрезНаименование");
			Иначе 
				ТекстЗапроса = ТекстЗапроса + ",
				|База.РезультатБаза КАК РезультатБаза";
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимГрафик Тогда
			ТекстЗапроса = ТекстЗапроса + ",
			|	ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ) КАК ОшибкаВводаИндивидуальногоГрафикаРаботы,
			|	ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ) КАК ОшибкаВводаОтработанногоВремени,
			|	ЕСТЬNULL(СоответствиеТабеляИНачислений.ПредупреждениеОНесоответствииТабеляИНачисления, ЛОЖЬ) КАК ПредупреждениеНесоответствияТабеляИНачисления,
			|	Основной.ГрафикРаботы.Наименование КАК ГрафикРаботыНаименование";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ГрафикРаботыНаименование");
				ПоляЗапроса.Добавить("ОшибкаВводаИндивидуальногоГрафикаРаботы");
				ПоляЗапроса.Добавить("ОшибкаВводаОтработанногоВремени");
				ПоляЗапроса.Добавить("ПредупреждениеНесоответствияТабеляИНачисления");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.НормаВремениЗаМесяц Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ЕСТЬNULL(
			|		ВЫБОР  
			|			КОГДА НормаВремениПоОбщемуГрафику.ГрафикРаботы ЕСТЬ NULL	
			|				ТОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.НормаВремени,ДанныеГрафика.ОсновноеЗначениеНормаПериодДействия) 
			|			КОГДА Основной.ВидУчетаВремени = &ПоДням
			|				ТОГДА НормаВремениПоОбщемуГрафику.НормаДней
			|	    	ИНАЧЕ НормаВремениПоОбщемуГрафику.НормаЧасов
			|		КОНЕЦ, 0) КАК НормаВремениЗаМесяц";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("НормаВремениЗаМесяц");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.НормаВремени Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ВЫБОР
			|		КОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ)
			|			ТОГДА NULL
			|		ИНАЧЕ ЕСТЬNULL(СводныеИндивидуальныеГрафики.НормаЧасовПоГрафику, ЕСТЬNULL(ВЫБОР
			|						КОГДА Основной.ВидУчетаВремени = &ПоДням
			|							ТОГДА ДанныеГрафика.ДополнительноеЗначениеНормаФактическийПериодДействия
			|						ИНАЧЕ ДанныеГрафика.ОсновноеЗначениеНормаФактическийПериодДействия
			|					КОНЕЦ, 0))
			|	КОНЕЦ КАК НормаОплачиваемыхЧасов,
			|	ВЫБОР
			|		КОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ)
			|			ТОГДА NULL
			|		ИНАЧЕ ЕСТЬNULL(СводныеИндивидуальныеГрафики.НормаДнейПоГрафику, ЕСТЬNULL(ВЫБОР
			|						КОГДА Основной.ВидУчетаВремени = &ПоДням
			|							ТОГДА ДанныеГрафика.ОсновноеЗначениеНормаФактическийПериодДействия
			|						ИНАЧЕ ДанныеГрафика.ДополнительноеЗначениеНормаФактическийПериодДействия
			|					КОНЕЦ, 0))
			|	КОНЕЦ КАК НормаОплачиваемыхДней,
			|	ЕСТЬNULL(ДанныеГрафика.ПроизводственныйКалендарьПятидневкаЧасыФактическийПериодДействия,0) КАК ПроизводственныйКалендарьПятидневкаЧасыФактическийПериодДействия,
			|	ЕСТЬNULL(ДанныеГрафика.ПроизводственныйКалендарьПятидневкаФактическийПериодДействия,0) КАК ПроизводственныйКалендарьПятидневкаФактическийПериодДействия";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("НормаОплачиваемыхЧасов");
				ПоляЗапроса.Добавить("НормаОплачиваемыхДней");
				ПоляЗапроса.Добавить("ПроизводственныйКалендарьПятидневкаЧасыФактическийПериодДействия");
				ПоляЗапроса.Добавить("ПроизводственныйКалендарьПятидневкаФактическийПериодДействия");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.ОтработаноВремени Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ВЫБОР
			|		КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
			|			ТОГДА NULL
			|		КОГДА ВремяВведенноеВЦеломЗаПериод.ОсновноеЗначениеПоТабелю ЕСТЬ НЕ NULL 
			|			ТОГДА 1 
			|		КОГДА НЕ (Основной.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботы)
			|			ТОГДА 4 
			|		КОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ)
			|			ТОГДА NULL
			|		КОГДА СводныеИндивидуальныеГрафики.ОсновноеЗначение ЕСТЬ НЕ NULL 
			|			ТОГДА 2 
			|		ИНАЧЕ 3 
			|	КОНЕЦ КАК СпособВводаВремени,
			|	ВЫБОР
			|		КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
			|			ТОГДА NULL
			//толик учитывается флахок в настройках учетной политики ОтработанноеВремяТолькоПоТабелю
			|		КОГДА  ВЫБОР КОГДА &ОтработанноеВремяТолькоПоТабелю ТОГДА Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени.РабочееВремя
			|			ИНАЧЕ Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени НЕ В
			|			(ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка),
			|			 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Сверхурочные),
			|			 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы),
			|			 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы),
			|			 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)) КОНЕЦ
			//			|			 И НЕ ОтработаноПоВидуВремениНачисления.Дней ЕСТЬ NULL КОНЕЦ
			|			 И ВЫБОР КОГДА &ОтработанноеВремяТолькоПоТабелю ТОГДА ИСТИНА ИНАЧЕ ОтработаноПоВидуВремениНачисления.Дней ЕСТЬ НЕ NULL КОНЕЦ
			//енд			
			|			ТОГДА
			|				ВЫБОР 
			|					КОГДА Основной.ВидУчетаВремени = &ПоДням
			|						ТОГДА ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Дней, 0)
			|					ИНАЧЕ ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Часов, 0)
			|			    КОНЕЦ
			|			ИНАЧЕ
			//Аверсон-софт, Островская Татьяна 07.05.2012 № 15320
			|				ВЫБОР 
			|					КОГДА Основной.ВидУчетаВремени = &ПоДням
			|						ТОГДА ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Дней, 0)
			|					ИНАЧЕ ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Часов, 0)
			|			    КОНЕЦ
			//Аверсон-софт, Островская Татьяна 07.05.2012 № 15320
			|	КОНЕЦ КАК ОтработаноВремени,
			|	ВЫБОР
			|		КОГДА Основной.ВидРасчета.ВидВремени В (Значение(Перечисление.ВидыВремени.ЧасовоеНеотработанное), Значение(Перечисление.ВидыВремени.ЧасовоеОтработанноеВПределахНормы))
			|			ТОГДА 0
			|		КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
			|			ТОГДА 0
			|		КОГДА Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени.РабочееВремя
			//толик			|			 И НЕ ОтработаноПоВидуВремениНачисления.Дней ЕСТЬ NULL
			// из графиков дни
			|			 И ВЫБОР КОГДА &ОтработанноеВремяТолькоПоТабелю ТОГДА ИСТИНА ИНАЧЕ ОтработаноПоВидуВремениНачисления.Часов ЕСТЬ НЕ NULL КОНЕЦ
			|			ТОГДА ЕСТЬNULL(ВЫБОР КОГДА ОтработаноПоВидуВремениНачисления.Сводно ТОГДА ОтработаноПоВидуВремениНачисления.Дней_Сумма ИНАЧЕ ОтработаноПоВидуВремениНачисления.Дней КОНЕЦ, 0)
			
			|		ИНАЧЕ ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ДнейПоТабелю, ВЫБОР
			|								КОГДА НЕ (Основной.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботы)
			|									ТОГДА ЕСТЬNULL(ВЫБОР
			|												КОГДА Основной.ВидУчетаВремени = &ПоДням
			|													ТОГДА ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
			|												ИНАЧЕ ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
			|											КОНЕЦ, 0)
			|								КОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ)
			|									ТОГДА 0
			|								ИНАЧЕ ЕСТЬNULL(СводныеИндивидуальныеГрафики.ДнейПоГрафику, ЕСТЬNULL(ВЫБОР
			|												КОГДА Основной.ВидУчетаВремени = &ПоДням
			|													ТОГДА ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
			|												ИНАЧЕ ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
			|											КОНЕЦ, 0))
			|							КОНЕЦ)
			|	КОНЕЦ КАК ОтработаноДней,
			|	ВЫБОР
			|		КОГДА Основной.ВидРасчета.ВидВремени В (Значение(Перечисление.ВидыВремени.ЧасовоеНеотработанное), Значение(Перечисление.ВидыВремени.ЧасовоеОтработанноеВПределахНормы))
			|			ТОГДА ЕСТЬNULL(ВремяПоТабелю.ВнутрисменныеЧасыОтклонение, 0)
			|		КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
			|			ТОГДА 0
			|		КОГДА Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени.РабочееВремя
			//толик			|			 И ОтработаноПоВидуВремениНачисления.Часов ЕСТЬ НЕ NULL
			|			 И ВЫБОР КОГДА &ОтработанноеВремяТолькоПоТабелю ТОГДА ИСТИНА ИНАЧЕ ОтработаноПоВидуВремениНачисления.Часов ЕСТЬ НЕ NULL КОНЕЦ
			|			ТОГДА ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Часов, 0)
			|		ИНАЧЕ ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ЧасовПоТабелю, ВЫБОР
			|								КОГДА НЕ (Основной.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботы)
			|									ТОГДА ЕСТЬNULL(ВЫБОР
			|												КОГДА Основной.ВидУчетаВремени = &ПоДням
			|													ТОГДА ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
			|												ИНАЧЕ ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
			|											КОНЕЦ, 0) - ЕСТЬNULL(ВремяПоТабелю.ОтработаноЧасовПоТабелюОтклонение, 0)
			|								КОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ)
			|									ТОГДА 0
			|								ИНАЧЕ ЕСТЬNULL(СводныеИндивидуальныеГрафики.ЧасовПоГрафику, ЕСТЬNULL(ВЫБОР
			|												КОГДА Основной.ВидУчетаВремени = &ПоДням
			|													ТОГДА ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
			|												ИНАЧЕ ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
			|											КОНЕЦ, 0)) - ЕСТЬNULL(ВремяПоТабелю.ОтработаноЧасовПоТабелюОтклонение, 0)
			|							КОНЕЦ)
			|	КОНЕЦ КАК ОтработаноЧасов,";
			
			//Аверсон 25.04.2022 КВВ СВФР-008930 (
			Если НЕ Организация.ИНН = "100765738" Тогда
				ТекстЗапроса = ТекстЗапроса + "
				|	ОтработаноПоВидуВремениНачисления.ЧасовРемонта КАК ЧасовРемонта,";  //Аверсон 08.04.2022 КВВ СВФР-008930
			КонецЕсли;
			ТекстЗапроса = ТекстЗапроса + "
			//Аверсон 25.04.2022 КВВ СВФР-008930 )
			
			|	ЕСТЬNULL(ДанныеГрафика.ПроизводственныйКалендарьПятидневкаЧасыФактическийПериодДействия,0) КАК ОтработаноЧасовПроизводственныйГрафик,
			|	ЕСТЬNULL(ДанныеГрафика.ПроизводственныйКалендарьПятидневкаФактическийПериодДействия, 0) КАК ОтработаноВремениПроизводственныйГрафик,
			|	ЕСТЬNULL(ВремяПоТабелю.ОтработаноЧасовПоТабелюОтклонение,0) КАК ОтработаноЧасовПоТабелюОтклонение";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОтработаноВремени");
				ПоляЗапроса.Добавить("ОтработаноДней");
				ПоляЗапроса.Добавить("ОтработаноЧасов");
				ПоляЗапроса.Добавить("ОтработаноВремениПроизводственныйГрафик");
				ПоляЗапроса.Добавить("ОтработаноЧасовПроизводственныйГрафик");
				ПоляЗапроса.Добавить("ОтработаноЧасовПоТабелюОтклонение");
			КонецЕсли;
			//толик			
			Запрос.УстановитьПараметр("ОтработанноеВремяТолькоПоТабелю", ПрочиеПроцедуры.НеобходимоУчитыватьОтработанноеВремяТолькоПоТабелю(Организация));
			//			
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработок Тогда
			
			ТекстЗапроса = ТекстЗапроса + ",
			|Основной.РучнойРасчетСреднегоЗаработка Как РучнойРасчетСреднегоЗаработка, 
			|Основной.РазмерСреднегоЗаработка Как РазмерСреднегоЗаработка, 
			|ДанныеДляРасчетаСреднего.ОтработаноДней Как ОтработаноДнейСтар, 
			|ДанныеДляРасчетаСреднего.ОтработаноЧасов Как ОтработаноЧасовСтар, 
			|ДанныеДляРасчетаСреднего.ЧислоМесяцев Как ЧислоМесяцев, 
			|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноДней,0) Как ОтработаноДнейПоСреднему, 
			|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноЧасов,0) Как ОтработаноЧасовПоСреднему,";
			
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
				Если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу и ПериодСреднегоПоОкладу <> Неопределено Тогда
					ТекстЗапроса = ТекстЗапроса+ " 
					|ДанныеДляРасчетаСреднегоДляОклада.СреднийЗаработокДляОклада Как СреднийЗаработок";
				иначе
					ТекстЗапроса = ТекстЗапроса+ " 
					|ДанныеДляРасчетаСреднего.СреднийЗаработок Как СреднийЗаработок";
					
				КонецЕсли;
			иначе
				ТекстЗапроса = ТекстЗапроса+ " 
				|ДанныеДляРасчетаСреднего.СреднийЗаработок Как СреднийЗаработок";
			КонецЕсли;
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОтработаноДнейПоСреднему");
				ПоляЗапроса.Добавить("ОтработаноЧасовПоСреднему");
				ПоляЗапроса.Добавить("СреднийЗаработок");
				ПоляЗапроса.Добавить("РазмерСреднегоЗаработка");
			КонецЕсли;
			
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработокПособий Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			//|ДанныеДляРасчетаСреднего.ОтработаноДней Как ОтработаноДнейСтар, 
			//|ДанныеДляРасчетаСреднего.ОтработаноЧасов Как ОтработаноЧасовСтар, 
			//|ДанныеДляРасчетаСреднего.ЧислоМесяцев Как ЧислоМесяцев, 
			|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноДней,0) Как ОтработаноДнейПособий, 
			|ДанныеДляРасчетаСреднего.СреднийЗаработок Как СреднийЗаработокПособий";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОтработаноДнейПособий");
				ПоляЗапроса.Добавить("СреднийЗаработокПособий");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработокОтпуска Тогда
			// выбираем число дней по шестидневке или календарных рабочих дней 
			// из производственного календаря и ЧислоДнейВНеделе
			ТекстЗапроса = ТекстЗапроса + ", 
			//|ДанныеДляРасчетаСреднего.ОтработаноДней Как ОтработаноДней, 
			//|ДанныеДляРасчетаСреднего.ОтработаноЧасов Как ОтработаноЧасов, 
			//|ДанныеДляРасчетаСреднего.СреднийЗаработок Как СреднийЗаработок,
			//|ДанныеДляРасчетаСреднего.ЧислоМесяцев Как ЧислоМесяцев, 
			|ВЫБОР КОГДА Основной.ВариантАлгоритмаРасчета = ЗНАЧЕНИЕ(Перечисление.ВариантыАлгоритмовРасчета.ОтпускСОплатойПраздничныхДней) ТОГДА РАЗНОСТЬДАТ(Основной.ПериодДействияНачало, ДОБАВИТЬКДАТЕ(Основной.ПериодДействияКонец, СЕКУНДА, 1), ДЕНЬ) КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке) ТОГДА ДанныеГрафика.ПроизводственныйКалендарьШестидневкаФактическийПериодДействия ИНАЧЕ ДанныеГрафика.ПроизводственныйКалендарьКалендарныеДниФактическийПериодДействия КОНЕЦ КАК ОплачиваемыеДниОтпуска,
			|ВЫБОР КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке) ТОГДА 6 ИНАЧЕ 7 КОНЕЦ КАК ЧислоДнейВНеделе,
			|Основной.ГрафикРаботы.ДлительностьРабочейНедели КАК ДлительностьРабочейНедели";
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОплачиваемыеДниОтпуска");
				ПоляЗапроса.Добавить("ЧислоДнейВНеделе");
				ПоляЗапроса.Добавить("ДлительностьРабочейНедели");
			КонецЕсли;
			
		КонецЕсли;
		
		Если НеобходимыеДанные.КалендарныеДниПособия Тогда
			ТекстЗапроса = ТекстЗапроса + ",
			|КалендарныеДниПособия.ОплачиватьДнейПособия КАК ОплачиватьДнейПособия";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОплачиватьДнейПособия");
			КонецЕсли;
		КонецЕсли;
		//О.Т. Аверсон 15.10.2015 № 637
		Если НеобходимыеДанные.РазмерЧасоваяМинимальнаяЗарплата Тогда 
			ТекстЗапроса = ТекстЗапроса + ", 
			|ЕСТЬNULL(ДанныеОРазмереЧасоваяМинимальнаяЗарплата.Размер,0) КАК РазмерЧасоваяМинимальнаяЗарплата";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерЧасоваяМинимальнаяЗарплата");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерМесячнаяМинимальнаяЗарплата Тогда 
			ТекстЗапроса = ТекстЗапроса + ", 
			|ЕСТЬNULL(ДанныеОРазмереМесячнаяМинимальнаяЗарплата.Размер,0) КАК РазмерМесячнаяМинимальнаяЗарплата";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерМесячнаяМинимальнаяЗарплата");
			КонецЕсли;
		КонецЕсли;
		//О.Т. Аверсон 15.10.2015 № 637
		
		//О.Т. 29.01.2015 № 17821
		Если НеобходимыеДанные.РазмерПособияНаРебенкаДо3Лет или НеобходимыеДанные.РазмерПособияНаДетейОт3До18Лет или НеобходимыеДанные.РазмерПособияНа2ИПоследующихДетейДо3Лет или
			НеобходимыеДанные.РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемей или НеобходимыеДанные.РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид Тогда //О.Т. Аверсон 21.07.2017 № 851
			// выбираем размер пособия на ребенка до 3 лет
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНаРебенкаДо3Лет.РазмерПособия КАК РазмерПособияНаРебенкаДо3Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНаРебенкаДо3Лет");
			КонецЕсли;
		КонецЕсли;
		//О.Т. 29.01.2015 № 17821
		
		Если НеобходимыеДанные.РазмерПособияМатериОдиночкеДо1_5Лет Тогда
			// выбираем размер пособия на ребенка до 1.5 лет матери-одиночке
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияМатериОдиночкеДо1_5Лет.РазмерПособия КАК РазмерПособияМатериОдиночкеДо1_5Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияМатериОдиночкеДо1_5Лет");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияМатериОдиночкеДо3Лет Тогда
			// выбираем размер пособия на ребенка до 3 лет матери-одиночке
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияМатериОдиночкеДо3Лет.РазмерПособия КАК РазмерПособияМатериОдиночкеДо3Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияМатериОдиночкеДо3Лет");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНаРебенкаСНадбавкой40До3Лет Тогда
			// выбираем размер пособия на ребенка до 3 лет с надбавкой 40%
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНаРебенкаСНадбавкой40До3Лет.РазмерПособия КАК РазмерПособияНаРебенкаСНадбавкой40До3Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНаРебенкаСНадбавкой40До3Лет");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНеРаботающейМатериДо3Лет Тогда
			// выбираем размер пособия на ребенка до 3 лет не работающей матери
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНеРаботающейМатериДо3Лет.РазмерПособия КАК РазмерПособияНеРаботающейМатериДо3Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНеРаботающейМатериДо3Лет");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНеРабМатериОдиночкеДо3Лет Тогда
			// выбираем размер пособия на ребенка до 3 лет не работающей матери-одиночке
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНеРабМатериОдиночкеДо3Лет.РазмерПособия КАК РазмерПособияНеРабМатериОдиночкеДо3Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНеРабМатериОдиночкеДо3Лет");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНеРабМатериОдиночкеДо1_5Лет Тогда
			// выбираем размер пособия на ребенка до 1_5 лет не работающей матери-одиночке
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНеРабМатериОдиночкеДо1_5Лет.РазмерПособия КАК РазмерПособияНеРабМатериОдиночкеДо1_5Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНеРабМатериОдиночкеДо1_5Лет");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНеРабМатериНадб40До3Лет Тогда
			// выбираем размер пособия на ребенка до 3 лет не работающей матери с надьавкой 40%
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНеРабМатериНадб40До3Лет.РазмерПособия КАК РазмерПособияНеРабМатериНадб40До3Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНеРабМатериНадб40До3Лет");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНаРебенкаСтарше3Лет Тогда
			// выбираем размер пособия на ребенка старше 3 лет
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНаРебенкаСтарше3Лет.РазмерПособия КАК РазмерПособияНаРебенкаСтарше3Лет";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНаРебенкаСтарше3Лет");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНаРебенкаДо18ЛетНадб40 Тогда
			// выбираем размер пособия на ребенка старше 3 лет с надбавкой 40%
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНаРебенкаДо18ЛетНадб40.РазмерПособия КАК РазмерПособияНаРебенкаДо18ЛетНадб40";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНаРебенкаДо18ЛетНадб40");
			КонецЕсли;			
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНаРебенкаИнвалида Тогда
			// выбираем размер пособия по уходу за ребенком-инвалидом до 18 лет
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНаРебенкаИнвалида.РазмерПособия КАК РазмерПособияНаРебенкаИнвалида";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНаРебенкаИнвалида");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНаРебенкаВИЧ Тогда
			// выбираем размер пособия по уходу за ребенком инфицированного ВИЧ до 18 лет
			ТекстЗапроса = ТекстЗапроса + ", 
			|ДанныеОРазмереПособияНаРебенкаВИЧ.РазмерПособия КАК РазмерПособияНаРебенкаВИЧ";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПособияНаРебенкаВИЧ");
			КонецЕсли;
		КонецЕсли;
		
		//Если НеобходимыеДанные.РайонныйКоэффициентРФОрганизации Тогда
		//	// размер районного коэфиициента, установленного для организации
		//	ТекстЗапроса = ТекстЗапроса + ", 
		//	|ВЫБОР
		//	|		КОГДА Основной.ПодразделениеОрганизации.КодПоОКАТО <> """"""""
		//	|				И Основной.ПодразделениеОрганизации.РайонныйКоэффициентРФ > 1
		//	|			ТОГДА Основной.ПодразделениеОрганизации.РайонныйКоэффициентРФ
		//	|		КОГДА Основной.ОбособленноеПодразделение.РайонныйКоэффициентРФ > 1
		//	|			ТОГДА Основной.ОбособленноеПодразделение.РайонныйКоэффициентРФ
		//	|		ИНАЧЕ 1
		//	|	КОНЕЦ КАК РайонныйКоэффициентРФОрганизации";
		//	Если КомментироватьРасчет Тогда
		//		ПоляЗапроса.Добавить("РайонныйКоэффициентРФОрганизации");
		//	КонецЕсли;
		//КонецЕсли;
		
		Если НеобходимыеДанные.РазмерОграниченияПособия Тогда
			// размер ограничения пособия по нетрудоспособности
			ТекстЗапроса = ТекстЗапроса + ", 
			//|	ЕСТЬNULL(РазмерММОТ.Размер, 0) КАК РазмерММОТ,
			//|	ЕСТЬNULL(РазмерОграниченияПособия.Размер, 0) КАК РазмерОбщегоОграничения,
			|ВЫБОР КОГДА ВЫРАЗИТЬ(Основной.Регистратор КАК Документ.НачислениеПоБольничномуЛисту).ОграничениеПособия = &БезОграничения ТОГДА 0 КОГДА ВЫРАЗИТЬ(Основной.Регистратор КАК Документ.НачислениеПоБольничномуЛисту).ОграничениеПособия = &ОграничениеММОТ ТОГДА ЕСТЬNULL(РазмерММОТ.Размер, 0) ИНАЧЕ ЕСТЬNULL(РазмерОграниченияПособия.Размер, 0) КОНЕЦ КАК РазмерОграничения";
			//|	ЕСТЬNULL(РазмерОграниченияПособия.РазмерПоБеременности, 0) КАК РазмерПоБеременности";
			
			Запрос.УстановитьПараметр("БезОграничения", Перечисления.ВидыОграниченияПособия.БезОграничений);
			Запрос.УстановитьПараметр("ОграничениеММОТ", Перечисления.ВидыОграниченияПособия.ОграничениеВРазмереММОТ);
			//(начало) закомментировано Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
			//Запрос.УстановитьПараметр("СредняяПоРБ", РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(периодРегистрации, Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер);//Островская Татьяна 16.07.2013 № 16623
			//(конец) закомментировано Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
			//(начало) добавлено Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
			Если ТипЗнч( Регистратор ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛисту" ) Тогда
				Если ЗначениеЗаполнено( Регистратор.ПервичныйБольничныйЛист )   Тогда
					ПериодСредняяЗПРаботников = НачалоМесяца( Регистратор.ПервичныйБольничныйЛист.ДатаНачала ) - 1;
				Иначе	
					ПериодСредняяЗПРаботников = НачалоМесяца( Регистратор.ДатаНачала ) - 1;
				КонецЕсли; 
			Иначе	
				ПериодСредняяЗПРаботников = периодРегистрации;
			КонецЕсли;
			СредняяПоРБ = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее( ПериодСредняяЗПРаботников, 
			Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников) ).Размер;
			Запрос.УстановитьПараметр( "СредняяПоРБ", СредняяПоРБ ); //Островская Татьяна 16.07.2013 № 16623
			//(конец) добавлено Кухарчуком Д.Я. 13.08.18, Задача СВФР-002295
			
			Если КомментироватьРасчет Тогда
				//ПоляЗапроса.Добавить("РазмерММОТ");
				//ПоляЗапроса.Добавить("РазмерОбщегоОграничения");
				ПоляЗапроса.Добавить("РазмерОграничения");
				//ПоляЗапроса.Добавить("РазмерПоБеременности");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.СдельныйЗаработок Тогда
			// размер сдельного заработка
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ВЫБОР
			|		КОГДА ЕСТЬNULL(ДанныеОСдельномЗаработке.ОшибкаВводаФактическойВыработки, ЛОЖЬ)
			|			ТОГДА NULL
			|		ИНАЧЕ ДанныеОСдельномЗаработке.СуммаЗаработка 
			|	КОНЕЦ КАК РазмерСдельногоЗаработка,
			|ЕСТЬNULL(ДанныеОСдельномЗаработке.ОшибкаВводаФактическойВыработки, ЛОЖЬ) КАК ОшибкаВводаФактическойВыработки";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерСдельногоЗаработка");
				ПоляЗапроса.Добавить("ОшибкаВводаФактическойВыработки");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.ДанныеДляПрогнозаНДФЛ Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|ВзаиморасчетыСРаботниками.СуммаУпрОстаток Как КВыплатеПоУпрУчету,
			|ВзаиморасчетыСРаботникамиОрганизаций.УжеНачисленоДоДоначисления Как УжеНачисленоДоДоначисления,
			|ЕСТЬNULL(СуммарныйПроцент.Процент, 0) Как СуммарныйПроцент,
			|ВЫБОР КОГДА НеРезиденты.ФизЛицо ЕСТЬ NULL ТОГДА Истина ИНАЧЕ Ложь КОНЕЦ Как Резидент";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("КВыплатеПоУпрУчету");
				ПоляЗапроса.Добавить("УжеНачисленоДоДоначисления");
				ПоляЗапроса.Добавить("СуммарныйПроцент");
				ПоляЗапроса.Добавить("Резидент");
			КонецЕсли;
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса + "
		|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций Как Основной";
		
		Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказатели КАК Показатели
			|ПО Показатели.ВидРасчета = Основной.ВидРасчета";
			
			Если НеобходимыеДанные.ВремяВКалендарныхДнях Тогда
				ТекстЗапроса = ТекстЗапроса + "
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(Регистратор = &парамРегистратор) КАК ФактическийПериодДействия
				|ПО ФактическийПериодДействия.НомерСтроки = Основной.НомерСтроки";
			КонецЕсли;
			
		КонецЕсли;
		
		Если НеобходимыеДанные.ВсегоОтработаноВремени Тогда
			
			Запрос.Текст = СотрудникиПериодыДействия; 
			Запрос.Выполнить(); 
			
			Запрос.Текст = СписокВРПоДням;
			Запрос.Выполнить();
			
			Запрос.Текст = СписокВРПоЧасам;
			Запрос.Выполнить();
			
			Запрос.Текст = ОсновныеФПД;
			Запрос.Выполнить();
			
			Запрос.Текст = ВсегоОтработаноВремени;
			Запрос.Выполнить();
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТВсегоОтработаноВремени КАК ВсегоОтработаноВремени
			|ПО Основной.НомерСтроки = ВсегоОтработаноВремени.НомерСтроки
			|";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.Стаж Тогда
			// присоединение к данным о стаже
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ДанныеОСтаже			
			|ПО ДанныеОСтаже.Сотрудник = Основной.Сотрудник
			|И	ДанныеОСтаже.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)";
			
			Запрос.УстановитьПараметр("ПериодРегистрации",	ПериодРегистрации);
		КонецЕсли;
		
		// если перерасчет - нужно сузить выборку 
		Если Перерасчет И Физлица = Неопределено Тогда
			// перерасчет по всем физлицам перерасчета
			ТекстЗапроса = ТекстЗапроса + "
			|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТФизлицаДляПерерасчета КАК ФизлицаДляПерерасчета
			|ПО ФизлицаДляПерерасчета.Физлицо = Основной.Физлицо";
			
		КонецЕсли;
		
		Если НеобходимаБаза Тогда
			Разрезы = Новый Массив;
			Разрезы.Добавить("ПериодРегистрации");
			Разрезы.Добавить("Регистратор");
			Если КомментироватьРасчет Тогда
				если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	СУММА(База.РезультатБаза) КАК РезультатБаза,
					|	База.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
					|	База.Регистратор КАК Регистратор,
					|	База.НомерСтроки КАК НомерСтроки
					|ПОМЕСТИТЬ ВТБаза
					|ИЗ
					|	(ВЫБРАТЬ
					|		База1.РезультатБаза КАК РезультатБаза,
					|		База1.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
					|		База1.Регистратор КАК Регистратор,
					|		База1.НомерСтроки КАК НомерСтроки
					|	ИЗ
					|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаОсновныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База1
					|	ГДЕ
					|		((НЕ База1.Сторно)
					|				ИЛИ База1.ПериодРегистрацииРазрез < База1.ПериодРегистрации)
					|		И База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников
					|		//И РегистраторРазрез1
					|		И База1.РегистраторРазрез.ВидыРасчетаДляЗамещения = База1.Регистратор.ВидыРасчетаДляЗамещения
					|	
					|	ОБЪЕДИНИТЬ ВСЕ
					|	
					|	ВЫБРАТЬ
					|		База2.РезультатБаза,
					|		База2.ВидРасчетаРазрез,
					|		База2.Регистратор,
					|		База2.НомерСтроки
					|	ИЗ
					|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаДополнительныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База2
					|	ГДЕ
					|		((НЕ База2.Сторно)
					|				ИЛИ База2.ПериодРегистрацииРазрез < База2.ПериодРегистрации)
					|		И База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников
					|		//И РегистраторРазрез2
					|		И База2.РегистраторРазрез.ВидыРасчетаДляЗамещения = База2.Регистратор.ВидыРасчетаДляЗамещения) КАК База
					|СГРУППИРОВАТЬ ПО
					|	База.ВидРасчетаРазрез,
					|	База.Регистратор,
					|	База.НомерСтроки";
				иначе
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	СУММА(База.РезультатБаза) КАК РезультатБаза,
					|	База.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
					|	База.Регистратор КАК Регистратор,
					|	База.НомерСтроки КАК НомерСтроки
					|ПОМЕСТИТЬ ВТБаза
					|ИЗ
					|	(ВЫБРАТЬ
					|		База1.РезультатБаза КАК РезультатБаза,
					|		База1.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
					|		База1.Регистратор КАК Регистратор,
					|		База1.НомерСтроки КАК НомерСтроки
					|	ИЗ
					|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаОсновныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База1
					|	ГДЕ
					|		((НЕ База1.Сторно)
					|				ИЛИ База1.ПериодРегистрацииРазрез < База1.ПериодРегистрации)
					|		//И РегистраторРазрез1
					|	
					|	ОБЪЕДИНИТЬ ВСЕ
					|	
					|	ВЫБРАТЬ
					|		База2.РезультатБаза,
					|		База2.ВидРасчетаРазрез,
					|		База2.Регистратор,
					|		База2.НомерСтроки
					|	ИЗ
					|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаДополнительныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База2
					|	ГДЕ
					|		((НЕ База2.Сторно)
					|				ИЛИ База2.ПериодРегистрацииРазрез < База2.ПериодРегистрации)
					|		//И РегистраторРазрез2) КАК База
					|СГРУППИРОВАТЬ ПО
					|	База.ВидРасчетаРазрез,
					|	База.Регистратор,
					|	База.НомерСтроки";
				КонецЕсли;
				
				Разрезы.Добавить("ВидРасчета");
				
			Иначе
				если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	СУММА(База.РезультатБаза) КАК РезультатБаза,
					|	База.Регистратор КАК Регистратор,
					|	База.НомерСтроки КАК НомерСтроки
					|ПОМЕСТИТЬ ВТБаза
					|ИЗ
					|	(ВЫБРАТЬ
					|		База1.РезультатБаза КАК РезультатБаза,
					|		База1.Регистратор КАК Регистратор,
					|		База1.НомерСтроки КАК НомерСтроки,
					|		База1.Регистратор.ВидыРасчетаДляЗамещения КАК РегистраторВидыРасчетаДляЗамещения,
					|		NULL КАК РегистраторРазрезВидыРасчетаДляЗамещения
					|	ИЗ
					|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаОсновныеНачисленияРаботниковОрганизаций(
					|				&парамИзмеренияОсновного,
					|				&парамИзмеренияБазового,
					|				&парамРазрезы,
					|				ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления
					|					И Регистратор = &парамРегистратор
					|					И Авторасчет) КАК База1
					|	ГДЕ
					|		(НЕ База1.Сторно
					|				ИЛИ База1.ПериодРегистрацииРазрез < База1.ПериодРегистрации)
					|		И База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников
					|		И База1.РегистраторРазрез.ВидыРасчетаДляЗамещения = База1.Регистратор.ВидыРасчетаДляЗамещения
					|		//И РегистраторРазрез1
					|	
					|	ОБЪЕДИНИТЬ ВСЕ
					|	
					|	ВЫБРАТЬ
					|		База2.РезультатБаза,
					|		База2.Регистратор,
					|		База2.НомерСтроки,
					|		NULL,
					|		База2.РегистраторРазрез.ВидыРасчетаДляЗамещения
					|	ИЗ
					|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаДополнительныеНачисленияРаботниковОрганизаций(
					|				&парамИзмеренияОсновного,
					|				&парамИзмеренияБазового,
					|				&парамРазрезы,
					|				ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления
					|					И Регистратор = &парамРегистратор
					|					И Авторасчет) КАК База2
					|	ГДЕ
					|		(НЕ База2.Сторно
					|				ИЛИ База2.ПериодРегистрацииРазрез < База2.ПериодРегистрации)
					|		И База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников
					|		И База2.РегистраторРазрез.ВидыРасчетаДляЗамещения = База2.Регистратор.ВидыРасчетаДляЗамещения
					|		//И РегистраторРазрез2) КАК База
					|
					|СГРУППИРОВАТЬ ПО
					|	База.Регистратор,
					|	База.НомерСтроки";
				иначе
					Запрос.Текст =
					"ВЫБРАТЬ
					|	СУММА(База.РезультатБаза) КАК РезультатБаза,
					|	База.Регистратор КАК Регистратор,
					|	База.НомерСтроки КАК НомерСтроки
					|ПОМЕСТИТЬ ВТБаза
					|ИЗ
					|	(ВЫБРАТЬ
					|		База1.РезультатБаза КАК РезультатБаза,
					|		База1.Регистратор КАК Регистратор,
					|		База1.НомерСтроки КАК НомерСтроки
					|	ИЗ
					|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаОсновныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База1
					|	ГДЕ
					|		((НЕ База1.Сторно)
					|				ИЛИ База1.ПериодРегистрацииРазрез < База1.ПериодРегистрации)
					|		//И РегистраторРазрез1 //Островская Татьяна 12.05.2014 № 17307       
					|	
					|	ОБЪЕДИНИТЬ ВСЕ
					|	
					|	ВЫБРАТЬ
					|		База2.РезультатБаза,
					|		База2.Регистратор,
					|		База2.НомерСтроки
					|	ИЗ
					|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаДополнительныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База2
					|	ГДЕ
					|		((НЕ База2.Сторно)
					|				ИЛИ База2.ПериодРегистрацииРазрез < База2.ПериодРегистрации)
					|		//И РегистраторРазрез2) КАК База //Островская Татьяна 12.05.2014 № 17307
					|СГРУППИРОВАТЬ ПО
					|	База.Регистратор,
					|	База.НомерСтроки";
				КонецЕсли;
			КонецЕсли;
			//Островская Татьяна 12.05.2014 № 17307
			если Организация.ИНН = "100765738" Тогда 
				если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","И База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников И База1.РегистраторРазрез = &парамРегистратор");//О.Т. 01.08.2014 № 133
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","И База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников И База2.РегистраторРазрез = &парамРегистратор");//О.Т. 01.08.2014 № 133
				иначе
					если ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда
						Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
						Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
					иначе
						////Аверсон 30.06.2022 КВВ СВФР-009157 (   (для Госпиталя пока не делать)
						//Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций")
						//	И ЗначениеЗаполнено(Регистратор.ПерерассчитываемыйДокумент) Тогда
						//	Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","И База1.РегистраторРазрез = &парамРегистратор И База1.АвторасчетРазрез = ИСТИНА"+?(КатегорияНачисления = Справочники.КатегорииРасчетов.НайтиПоНаименованию("Зависимое третьего уровня"),""," И не База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников"));
						//	Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","И База2.РегистраторРазрез = &парамРегистратор И База2.АвторасчетРазрез = ИСТИНА"+?(КатегорияНачисления = Справочники.КатегорииРасчетов.НайтиПоНаименованию("Зависимое третьего уровня"),""," И не База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников"));
						//	Разрезы.Добавить("Авторасчет"); 
						//Иначе
						//	//Аверсон 30.06.2022 КВВ СВФР-009157 )
						
						Если КатегорияНачисления = Справочники.КатегорииРасчетов.НайтиПоНаименованию("Зависимое третьего уровня") Тогда 
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
						иначе
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","И не База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","И не База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
						КонецЕсли;
						//КонецЕсли;
					КонецЕсли;
				КонецЕсли;
			иначе
				//Аверсон 30.06.2022 КВВ СВФР-009157 (
				Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций")
					И ЗначениеЗаполнено(Регистратор.ПерерассчитываемыйДокумент) Тогда
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","И База1.РегистраторРазрез = &парамРегистратор И База1.АвторасчетРазрез = ИСТИНА");
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","И База2.РегистраторРазрез = &парамРегистратор И База2.АвторасчетРазрез = ИСТИНА");
					Разрезы.Добавить("Авторасчет");
				Иначе
					//Аверсон 30.06.2022 КВВ СВФР-009157 )
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
				КонецЕсли;
			КонецЕсли;			
			
			//Островская Татьяна 12.05.2014 № 17307
			Запрос.УстановитьПараметр("парамРазрезы", Разрезы);
			Запрос.Выполнить();
			
			//**************************************************
			//НЕ УБИРАТЬ !!! закомментирован пример выгрузки в ТЗ по Разрезам (для тестирования) (16.07.2022 КВВ) (
			//ЗЗ = Новый Запрос;
			//ЗЗ.Текст = "
			//|ВЫБРАТЬ
			//|База1.РезультатБаза КАК РезультатБаза,
			//|База1.Регистратор КАК Регистратор,
			//|База1.РегистраторРазрез КАК РегистраторР,
			//|База1.ВидРасчетаРазрез КАК ВРР,
			//|База1.ВидРасчета КАК ВР,
			//|База1.ПериодРегистрации КАК ПерР,
			//|База1.ПериодРегистрацииРазрез КАК ПерРР,
			//|База1.НомерСтрокиРазрез КАК НомерСтрокиР,
			//|База1.НомерСтроки КАК НомерСтроки
			//|ИЗ
			//|РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаОсновныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления И Регистратор = &парамРегистратор И Авторасчет) КАК База1
			//|ГДЕ
			//|((НЕ База1.Сторно)
			//|ИЛИ База1.ПериодРегистрацииРазрез < База1.ПериодРегистрации)
			//|ОБЪЕДИНИТЬ ВСЕ
			//|ВЫБРАТЬ
			//|База2.РезультатБаза,
			//|База2.Регистратор,
			//|База2.РегистраторРазрез,
			//|База2.ВидРасчетаРазрез,
			//|База2.ВидРасчета,
			//|База2.ПериодРегистрации,
			//|База2.ПериодРегистрацииРазрез,
			//|База2.НомерСтрокиРазрез,
			//|База2.НомерСтроки
			//|ИЗ
			//|РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаДополнительныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления И Регистратор = &парамРегистратор И Авторасчет) КАК База2
			//|ГДЕ
			//|((НЕ База2.Сторно)
			//|		ИЛИ База2.ПериодРегистрацииРазрез < База2.ПериодРегистрации)
			//|";
			//ЗЗ.УстановитьПараметр( "парамРегистратор", ПолучитьРеквизитПервичного( Регистратор, "Ссылка" ) );
			//ЗЗ.УстановитьПараметр("парамКатегорияНачисления", КатегорияНачисления);
			//ИзмеренияЗЗ = Новый Массив(1);
			//ИзмеренияЗЗ[0] = "Сотрудник";
			//ЗЗ.УстановитьПараметр("парамИзмеренияОсновного", ИзмеренияЗЗ);
			//ЗЗ.УстановитьПараметр("парамИзмеренияБазового", ИзмеренияЗЗ);			
			//РазрезыЗЗ = Новый Массив;
			//РазрезыЗЗ.Добавить("ПериодРегистрации");
			//РазрезыЗЗ.Добавить("Регистратор");
			//РазрезыЗЗ.Добавить("ВидРасчета");
			//РазрезыЗЗ.Добавить("Авторасчет");
			//РазрезыЗЗ.Добавить("НомерСтроки");			
			//ЗЗ.УстановитьПараметр("парамРазрезы", РазрезыЗЗ);						
			//РЕзЗЗ = ЗЗ.Выполнить().Выгрузить();			
			//НЕ УБИРАТЬ !!! закомментирован пример выгрузки в ТЗ по Разрезам (для тестирования) (16.07.2022 КВВ) )
			//**************************************************
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТБаза КАК База
			|ПО Основной.Регистратор = База.Регистратор И Основной.НомерСтроки = База.НомерСтроки";
			
		КонецЕсли;
		
		Если НеобходимГрафик Тогда
			
			Запрос.УстановитьПараметр("ПоДням", Перечисления.ВидыУчетаВремени.ПоДням);
			Запрос.УстановитьПараметр("ПоЧасам", Перечисления.ВидыУчетаВремени.ПоЧасам);
			Запрос.УстановитьПараметр("ПоВечернимЧасам", Перечисления.ВидыУчетаВремени.ПоВечернимЧасам);
			Запрос.УстановитьПараметр("ПоНочнымЧасам", Перечисления.ВидыУчетаВремени.ПоНочнымЧасам);
			Запрос.УстановитьПараметр("ПустойВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка());
			Запрос.УстановитьПараметр("КлассификаторЯ", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
			Запрос.УстановитьПараметр("КлассификаторВЧ", Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы);
			Запрос.УстановитьПараметр("КлассификаторНЧ", Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы);
			Запрос.УстановитьПараметр("ОтработанноеВПределахНормы", Перечисления.ВидыВремени.ОтработанноеВПределахНормы);
			Запрос.УстановитьПараметр("ЦелодневноеНеотработанное", Перечисления.ВидыВремени.ЦелодневноеНеотработанное);
			Запрос.УстановитьПараметр("ЧасовоеНеотработанное", Перечисления.ВидыВремени.ЧасовоеНеотработанное);
			Запрос.УстановитьПараметр("ЧасовоеОтработанноеВПределахНормы", Перечисления.ВидыВремени.ЧасовоеОтработанноеВПределахНормы);
			
			
			Запрос.Текст = ВремяПоТабелюТекст;
			Запрос.Выполнить();
			
			Запрос.Текст = ОтработаноПоВидуВремениДляПоказателейТекст;
			Запрос.Выполнить();
			
			Запрос.Текст = СводныеИндивидуальныеГрафикиТекст;
			Запрос.Выполнить();
			
			Запрос.Текст = НормаВремениПоОбщемуГрафикуТекст;
			Запрос.Выполнить();
			
			Запрос.Текст = ВремяВведенноеВЦеломЗаПериодТекст;
			Запрос.Выполнить();
			
			Запрос.Текст = СоответствиеТабеляИНачислений;
			Запрос.Выполнить();
			
			// присоединяем к данным графика
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ДанныеГрафика(" + Условие +  ") Как ДанныеГрафика
			|ПО Основной.Регистратор = ДанныеГрафика.Регистратор И Основной.НомерСтроки = ДанныеГрафика.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТВремяПоТабелю КАК ВремяПоТабелю
			|ПО Основной.НомерСтроки = ВремяПоТабелю.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТСводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
			|ПО Основной.НомерСтроки = СводныеИндивидуальныеГрафики.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТОтработаноПоВидуВремениДляПоказателей КАК ОтработаноПоВидуВремениНачисления
			|ПО Основной.НомерСтроки = ОтработаноПоВидуВремениНачисления.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоОбщемуГрафику КАК НормаВремениПоОбщемуГрафику
			|ПО Основной.ГрафикРаботыНорма = НормаВремениПоОбщемуГрафику.ГрафикРаботы
			|	И Основной.ПериодДействия = НормаВремениПоОбщемуГрафику.ПериодДействия
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТВремяВведенноеВЦеломЗаПериод КАК ВремяВведенноеВЦеломЗаПериод
			|ПО Основной.НомерСтроки = ВремяВведенноеВЦеломЗаПериод.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТСоответствиеТабеляИНачислений КАК СоответствиеТабеляИНачислений
			|ПО Основной.НомерСтроки = СоответствиеТабеляИНачислений.НомерСтроки
			//Островская Татьяна 18.02.2014 № 17126
			|	ЛЕВОЕ СОЕДИНЕНИЕ ставки КАК ставки
			|ПО Основной.Сотрудник = ставки.Сотрудник
			|	И (ставки.Период В
			|		(ВЫБРАТЬ
			|			МАКСИМУМ(т.Период)
			|		ИЗ
			|			ставки КАК т
			|		ГДЕ
			|			т.Сотрудник = Основной.Сотрудник
			|			И т.Период <= Основной.ПериодРегистрации))
			
			//Островская Татьяна 18.02.2014 № 17126
			|";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработок Тогда
			
			Запрос.УстановитьПараметр("ПоЗаработку", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
			//О.Т. Аверсон 12.04.2019 № 4189
			ЭтоАгент = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				ЭтоАгент = Регистратор.Агент;
			КонецЕсли;
			//О.Т. Аверсон 12.04.2019 № 4189
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			НеполныйМесяц = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				НеполныйМесяц = Регистратор.РасчетПриНеполныхМесяцах;
			КонецЕсли;
			//Аверсон СВФР-009668
			
			Запрос.УстановитьПараметр("ПоЗаработкуИнд", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые));
			Запрос.УстановитьПараметр("ПоЗаработкуИндСред", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеСред); //О.Т. Аверсон 06.07.2016 № 855
			Запрос.УстановитьПараметр("ПоЗаработкуБЛ", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			//Запрос.УстановитьПараметр("ПоЗаработкуОтпуск", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск));//О.Т. Аверсон 16.04.2019 № 4189
			Запрос.УстановитьПараметр("ПоЗаработкуОтпуск", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			//Аверсон СВФР-009668
			
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда //О.Т. Аверсон 23.06.2016 № 1267
				Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему);
			иначе
				Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
			КонецЕсли;
			Запрос.УстановитьПараметр("ПоФиксПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
			Запрос.УстановитьПараметр("ПоГодовымПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии);
			
			ПоСреднемуЗаработкуФСС = Новый Массив(2);
			ПоСреднемуЗаработкуФСС[0] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС;
			//ПоСреднемуЗаработкуФСС[1] = Перечисления.СпособыРасчетаОплатыТруда.ПособиеПоУходуЗаРебенкомДо1_5Лет;
			Запрос.УстановитьПараметр("ПоСреднемуЗаработкуФСС", ПоСреднемуЗаработкуФСС);
			
			Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу",ПериодСреднегоПоОкладу); //О.Т. 17.02.2015 № 334
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
				Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу1",НачалоМесяца(Регистратор.ДатаНачала)); //О.Т. 17.02.2015 № 334
			иначе
				Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу1",ПериодСреднегоПоОкладу);
			КонецЕсли;
			
			//СВЭЙ 02.02.2024 КВВ СВФР-012133 (
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
				Если ЗначениеЗаполнено(Регистратор.ПервичныйБольничныйЛист) Тогда
					Запрос.УстановитьПараметр("ПериодСреднегоПоОкладуОснПервич1",НачалоМесяца(Регистратор.ПервичныйБольничныйЛист.ДатаНачала));
					Запрос.УстановитьПараметр("парамРегистраторОснПервич",Регистратор.ПервичныйБольничныйЛист);
				Иначе
					Запрос.УстановитьПараметр("ПериодСреднегоПоОкладуОснПервич1",НачалоМесяца(Регистратор.ДатаНачала));
					Запрос.УстановитьПараметр("парамРегистраторОснПервич",Регистратор);
				КонецЕсли;				
			КонецЕсли;
			//СВЭЙ 02.02.2024 КВВ СВФР-012133 )
			
			Запрос.Текст = ДанныеОСреднемЗаработкеТекст;
			Запрос.Выполнить();
			ДанныеОСреднемЗаработкеТекст = "ВТДанныеОСреднемЗаработке";
			
			//О.Т. Аверсон 28.02.2017 № 215
			Запрос.Текст = ДанныеОСреднемЗаработкеДляОкладаТекст;
			Запрос.Выполнить();
			ДанныеОСреднемЗаработкеДляОкладаТекст = "ВТДанныеОСреднемЗаработкеДляОклада";
			//О.Т. Аверсон 28.02.2017 № 215
			
			
			// присоединяем данные для расчета среднего заработка
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ "+ДанныеОСреднемЗаработкеТекст+" КАК ДанныеДляРасчетаСреднего
			|ПО Основной.Сотрудник = ДанныеДляРасчетаСреднего.Сотрудник И 
			|Основной.ВидРасчета.СпособРасчета = ДанныеДляРасчетаСреднего.СпособРасчета И 
			|Основной.ДатаНачалаСобытия = ДанныеДляРасчетаСреднего.ДатаНачалаСобытия И 
			|Основной.ПериодРасчетаСреднегоЗаработкаНачало = ДанныеДляРасчетаСреднего.ДатаНачалаРасчетногоПериода И 
			|Основной.ПериодРасчетаСреднегоЗаработкаОкончание = ДанныеДляРасчетаСреднего.ДатаОкончанияРасчетногоПериода";
			//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
			//	ТекстЗапроса = ТекстЗапроса + "
			//	|Основной.ДатаДоговора = ДанныеДляРасчетаСреднего.ДатаДоговора и 
			//	|Основной.НомерДоговора = ДанныеДляРасчетаСреднего.НомерДоговора";
			//КонецЕсли;
			//О.Т. Аверсон 28.02.2017 № 215
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ "+ДанныеОСреднемЗаработкеДляОкладаТекст+" КАК ДанныеДляРасчетаСреднегоДляОклада
			|ПО Основной.Сотрудник = ДанныеДляРасчетаСреднегоДляОклада.Сотрудник И 
			|Основной.ВидРасчета.СпособРасчета = ДанныеДляРасчетаСреднегоДляОклада.СпособРасчета И 
			|Основной.ДатаНачалаСобытия = ДанныеДляРасчетаСреднегоДляОклада.ДатаНачалаСобытия И 
			|Основной.ПериодРасчетаСреднегоЗаработкаНачало = ДанныеДляРасчетаСреднегоДляОклада.ДатаНачалаРасчетногоПериода И 
			|Основной.ПериодРасчетаСреднегоЗаработкаОкончание = ДанныеДляРасчетаСреднегоДляОклада.ДатаОкончанияРасчетногоПериода";
			//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
			//	ТекстЗапроса = ТекстЗапроса + "
			//	|Основной.ДатаДоговора = ДанныеДляРасчетаСреднегоДляОклада.ДатаДоговора и 
			//	|Основной.НомерДоговора = ДанныеДляРасчетаСреднегоДляОклада.НомерДоговора";
			//КонецЕсли;
			//О.Т. Аверсон 28.02.2017 № 215
			
			
			
		КонецЕсли;
		
		Если НеобходимыеДанные.КалендарныеДниПособия Тогда
			
			ПоСреднемуЗаработкуФСС = Новый Массив(2);
			ПоСреднемуЗаработкуФСС[0] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС;
			//ПоСреднемуЗаработкуФСС[1] = Перечисления.СпособыРасчетаОплатыТруда.ПособиеПоУходуЗаРебенкомДо1_5Лет;
			Запрос.УстановитьПараметр("ПоСреднемуЗаработкуФСС", ПоСреднемуЗаработкуФСС);
			
			Запрос.Текст = КалендарныеДниПособияТекст;
			Запрос.Выполнить();
			КалендарныеДниПособияТекст = "ВТКалендарныеДниПособия";
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ " + КалендарныеДниПособияТекст + " Как КалендарныеДниПособия
			|ПО Основной.НомерСтроки = КалендарныеДниПособия.НомерСтроки
			|";
		КонецЕсли;
		
		Если НеобходимыеДанные.ИсчисленныйНДФЛ Тогда
			Запрос.Текст = ИсчисленныйНДФЛТекст;
			Запрос.Выполнить();
			ИсчисленныйНДФЛТекст = "ВТИсчисленныйНДФЛ";
			
			// присоединяем данные по исчисленному НДФЛ
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ "+ИсчисленныйНДФЛТекст+" КАК ИсчисленныйНДФЛ
			|ПО Основной.ФизЛицо = ИсчисленныйНДФЛ.ФизЛицо";
			
		КонецЕсли;
		
		//О.Т. Аверсон 15.10.2015 № 637
		Если НеобходимыеДанные.РазмерЧасоваяМинимальнаяЗарплата тогда
			Запрос.Текст = РазмерЧасоваяМинимальнаяЗарплатаТекст;
			Запрос.Выполнить();
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерЧасоваяМинимальнаяЗарплата КАК ДанныеОРазмереЧасоваяМинимальнаяЗарплата
			|ПО Основной.НомерСтроки = ДанныеОРазмереЧасоваяМинимальнаяЗарплата.ОсновнойНомерСтроки";
			
			
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерМесячнаяМинимальнаяЗарплата тогда
			Запрос.Текст = РазмерМесячнаяМинимальнаяЗарплатаТекст;
			Запрос.Выполнить();
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерМесячнаяМинимальнаяЗарплата КАК ДанныеОРазмереМесячнаяМинимальнаяЗарплата
			|ПО Основной.НомерСтроки = ДанныеОРазмереМесячнаяМинимальнаяЗарплата.ОсновнойНомерСтроки";
		КонецЕсли;
		
		//О.Т. Аверсон 15.10.2015 № 637
		
		
		//О.Т. 29.01.2015 № 17821
		Если НеобходимыеДанные.РазмерПособияНаРебенкаДо3Лет или НеобходимыеДанные.РазмерПособияНаДетейОт3До18Лет или НеобходимыеДанные.РазмерПособияНа2ИПоследующихДетейДо3Лет
			или НеобходимыеДанные.РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемей или НеобходимыеДанные.РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид Тогда  
			ВидПособия = Новый СписокЗначений;
			СпособРасчетаПособия = Новый СписокЗначений;
			Если НеобходимыеДанные.РазмерПособияНаРебенкаДо3Лет Тогда
				ВидПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет);
				СпособРасчетаПособия.Добавить(Перечисления.ВидыГосударственныхПособий.ПособиеНаРебенкаДо3Лет);
			КонецЕсли;
			
			Если НеобходимыеДанные.РазмерПособияНаДетейОт3До18Лет Тогда
				ВидПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаДетейВВозрастеОт3До18);
				СпособРасчетаПособия.Добавить(Перечисления.ВидыГосударственныхПособий.ПособиеНаДетейВВозрастеОт3До18);
			КонецЕсли;
			
			Если НеобходимыеДанные.РазмерПособияНа2ИПоследующихДетейДо3Лет Тогда
				ВидПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаВторогоИПоследующихДо3Лет);
				СпособРасчетаПособия.Добавить(Перечисления.ВидыГосударственныхПособий.ПособиеНаВторогоИПоследующихДо3Лет);
			КонецЕсли;
			//О.Т. Аверсон 21.07.2017 № 851			
			Если НеобходимыеДанные.РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемей Тогда
				ВидПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей);
				СпособРасчетаПособия.Добавить(Перечисления.ВидыГосударственныхПособий.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей);
			КонецЕсли;
			
			Если НеобходимыеДанные.РазмерПособияСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид Тогда
				ВидПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид);
				СпособРасчетаПособия.Добавить(Перечисления.ВидыГосударственныхПособий.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид);
			КонецЕсли;
			//О.Т. Аверсон 21.07.2017 № 851
			
			Запрос.УстановитьПараметр("СпособРасчетаПособияНаРебенкаДо3Лет", ВидПособия);
			Запрос.УстановитьПараметр("ВидПособияНаРебенкаДо3Лет", СпособРасчетаПособия);
			
			Запрос.Текст = РазмерПособияНаРебенкаДо3ЛетТекст;
			Запрос.Выполнить();
			РазмерПособияНаРебенкаДо3ЛетТекст = "ВТРазмерПособияНаРебенкаДо3Лет";
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНаРебенкаДо3Лет КАК ДанныеОРазмереПособияНаРебенкаДо3Лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНаРебенкаДо3Лет.ОсновнойНомерСтроки
			|И (ВЫБОР
			|	КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПособиеНаДетейВВозрастеОт3До18)
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыГосударственныхПособий.ПособиеНаДетейВВозрастеОт3До18)
			|	КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПособиеНаВторогоИПоследующихДо3Лет)
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыГосударственныхПособий.ПособиеНаВторогоИПоследующихДо3Лет)
			|	КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей)
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыГосударственныхПособий.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей)//О.Т. Аверсон 21.07.2017 № 851
			|	КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид)
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыГосударственныхПособий.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид)//О.Т. Аверсон 21.07.2017 № 851
			
			|	КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет)
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыГосударственныхПособий.ПособиеНаРебенкаДо3Лет)
			|КОНЕЦ = ДанныеОРазмереПособияНаРебенкаДо3Лет.ВидПособия)";
			
			
		КонецЕсли;
		//О.Т. 27.01.2015 № 17821
		
		Если НеобходимыеДанные.РазмерПособияМатериОдиночкеДо3Лет Тогда
			
			Запрос.УстановитьПараметр("СпособРасчетаПособияМатериОдиночкеДо3Лет", Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо3Лет);
			Запрос.УстановитьПараметр("ВидПособияМатериОдиночкеДо3Лет", Перечисления.ВидыГосударственныхПособий.ПособиеМатериОдиночкеДо3Лет);
			
			Запрос.Текст = РазмерПособияМатериОдиночкеДо3ЛетТекст;
			Запрос.Выполнить();
			РазмерПособияМатериОдиночкеДо3ЛетТекст = "ВТРазмерПособияМатериОдиночкеДо3Лет";
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияМатериОдиночкеДо3Лет КАК ДанныеОРазмереПособияМатериОдиночкеДо3Лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияМатериОдиночкеДо3Лет.ОсновнойНомерСтроки";
			
		КонецЕсли;
		Если НеобходимыеДанные.РазмерПособияМатериОдиночкеДо1_5Лет Тогда
			
			Запрос.УстановитьПараметр("СпособРасчетаПособияМатериОдиночкеДо1_5Лет", Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо1_5Лет);
			Запрос.УстановитьПараметр("ВидПособияМатериОдиночкеДо1_5Лет", Перечисления.ВидыГосударственныхПособий.ПособиеМатериОдиночкеДо1_5Лет         );
			
			Запрос.Текст = РазмерПособияМатериОдиночкеДо1_5ЛетТекст;
			Запрос.Выполнить();
			РазмерПособияМатериОдиночкеДо1_5ЛетТекст = "ВТРазмерПособияМатериОдиночкеДо1_5Лет";
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияМатериОдиночкеДо1_5Лет КАК ДанныеОРазмереПособияМатериОдиночкеДо1_5Лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияМатериОдиночкеДо1_5Лет.ОсновнойНомерСтроки";
			
		КонецЕсли;
		Если НеобходимыеДанные.РазмерПособияНаРебенкаСНадбавкой40До3лет Тогда
			
			Запрос.УстановитьПараметр("СпособРасчетаПособияНаРебенкаСНадбавкой40До3лет", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСНадбавкой40До3лет);
			Запрос.УстановитьПараметр("ВидПособияНаРебенкаСНадбавкой40До3лет", Перечисления.ВидыГосударственныхПособий.ПособиеНаРебенкаСНадбавкой40До3лет    );
			
			Запрос.Текст = РазмерПособияНаРебенкаСНадбавкой40До3летТекст;
			Запрос.Выполнить();
			РазмерПособияНаРебенкаСНадбавкой40До3летТекст = "ВТРазмерПособияНаРебенкаСНадбавкой40До3лет";
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНаРебенкаСНадбавкой40До3лет КАК ДанныеОРазмереПособияНаРебенкаСНадбавкой40До3лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНаРебенкаСНадбавкой40До3лет.ОсновнойНомерСтроки";
			
		КонецЕсли;
		Если НеобходимыеДанные.РазмерПособияНеРаботающейМатериДо3лет Тогда
			Запрос.УстановитьПараметр("СпособРасчетаПособияНеРаботающейМатериДо3лет", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРаботающейМатериДо3лет);
			Запрос.УстановитьПараметр("ВидПособияНеРаботающейМатериДо3лет", Перечисления.ВидыГосударственныхПособий.ПособиеНеРаботающейМатериДо3лет    );
			
			Запрос.Текст = РазмерПособияНеРаботающейМатериДо3летТекст;
			Запрос.Выполнить();
			РазмерПособияНеРаботающейМатериДо3летТекст = "ВТРазмерПособияНеРаботающейМатериДо3лет";
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНеРаботающейМатериДо3лет КАК ДанныеОРазмереПособияНеРаботающейМатериДо3лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНеРаботающейМатериДо3лет.ОсновнойНомерСтроки";
			
		КонецЕсли;
		Если НеобходимыеДанные.РазмерПособияНеРабМатериОдиночкеДо3лет Тогда
			Запрос.УстановитьПараметр("СпособРасчетаПособияНеРабМатериОдиночкеДо3лет", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо3лет);
			Запрос.УстановитьПараметр("ВидПособияНеРабМатериОдиночкеДо3лет", Перечисления.ВидыГосударственныхПособий.ПособиеНеРабМатериОдиночкеДо3лет    );
			
			Запрос.Текст = РазмерПособияНеРабМатериОдиночкеДо3летТекст;
			Запрос.Выполнить();
			РазмерПособияНеРабМатериОдиночкеДо3летТекст = "ВТРазмерПособияНеРабМатериОдиночкеДо3лет";
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНеРабМатериОдиночкеДо3лет КАК ДанныеОРазмереПособияНеРабМатериОдиночкеДо3лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНеРабМатериОдиночкеДо3лет.ОсновнойНомерСтроки";
			
		КонецЕсли;
		Если НеобходимыеДанные.РазмерПособияНеРабМатериОдиночкеДо1_5лет Тогда
			Запрос.УстановитьПараметр("СпособРасчетаПособияНеРабМатериОдиночкеДо1_5лет", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо1_5лет);
			Запрос.УстановитьПараметр("ВидПособияНеРабМатериОдиночкеДо1_5лет", Перечисления.ВидыГосударственныхПособий.ПособиеНеРабМатериОдиночкеДо1_5лет    );
			
			Запрос.Текст = РазмерПособияНеРабМатериОдиночкеДо1_5летТекст;
			Запрос.Выполнить();
			РазмерПособияНеРабМатериОдиночкеДо1_5летТекст = "ВТРазмерПособияНеРабМатериОдиночкеДо1_5лет";
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНеРабМатериОдиночкеДо1_5лет КАК ДанныеОРазмереПособияНеРабМатериОдиночкеДо1_5лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНеРабМатериОдиночкеДо1_5лет.ОсновнойНомерСтроки";
			
		КонецЕсли;
		Если НеобходимыеДанные.РазмерПособияНеРабМатериНадб40До3Лет Тогда
			Запрос.УстановитьПараметр("СпособРасчетаПособияНеРабМатериНадб40До3Лет", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериНадб40До3Лет);
			Запрос.УстановитьПараметр("ВидПособияНеРабМатериНадб40До3Лет", Перечисления.ВидыГосударственныхПособий.ПособиеНеРабМатериНадб40До3Лет);
			
			Запрос.Текст = РазмерПособияНеРабМатериНадб40До3ЛетТекст;
			Запрос.Выполнить();
			РазмерПособияНеРабМатериНадб40До3ЛетТекст = "ВТРазмерПособияНеРабМатериНадб40До3Лет";
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНеРабМатериНадб40До3Лет КАК ДанныеОРазмереПособияНеРабМатериНадб40До3Лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНеРабМатериНадб40До3Лет.ОсновнойНомерСтроки";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНаРебенкаСтарше3Лет Тогда
			Запрос.УстановитьПараметр("СпособРасчетаПособияНаРебенкаСтарше3Лет", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСтарше3Лет);
			Запрос.УстановитьПараметр("ВидПособияНаРебенкаСтарше3Лет", Перечисления.ВидыГосударственныхПособий.ПособиеНаРебенкаСтарше3Лет    );
			
			Запрос.Текст = РазмерПособияНаРебенкаСтарше3ЛетТекст;
			Запрос.Выполнить();
			РазмерПособияНаРебенкаСтарше3ЛетТекст = "ВТРазмерПособияНаРебенкаСтарше3Лет";
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНаРебенкаСтарше3Лет КАК ДанныеОРазмереПособияНаРебенкаСтарше3Лет
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНаРебенкаСтарше3Лет.ОсновнойНомерСтроки";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.РазмерПособияНаРебенкаДо18ЛетНадб40 Тогда
			Запрос.УстановитьПараметр("СпособРасчетаПособияНаРебенкаДо18ЛетНадб40", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо18ЛетНадб40);
			Запрос.УстановитьПараметр("ВидПособияНаРебенкаДо18ЛетНадб40", Перечисления.ВидыГосударственныхПособий.ПособиеНаРебенкаДо18ЛетНадб40    );
			
			Запрос.Текст = РазмерПособияНаРебенкаДо18ЛетНадб40Текст;
			Запрос.Выполнить();
			РазмерПособияНаРебенкаДо18ЛетНадб40Текст = "ВТРазмерПособияНаРебенкаДо18ЛетНадб40";
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНаРебенкаДо18ЛетНадб40 КАК ДанныеОРазмереПособияНаРебенкаДо18ЛетНадб40
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНаРебенкаДо18ЛетНадб40.ОсновнойНомерСтроки";
			
			
		КонецЕсли;
		Если НеобходимыеДанные.РазмерПособияНаРебенкаИнвалида Тогда
			Запрос.УстановитьПараметр("СпособРасчетаПособияНаРебенкаИнвалида", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида);
			Запрос.УстановитьПараметр("ВидПособияНаРебенкаИнвалида", Перечисления.ВидыГосударственныхПособий.ПособиеНаРебенкаИнвалида    );
			
			Запрос.Текст = РазмерПособияНаРебенкаИнвалидаТекст;
			Запрос.Выполнить();
			РазмерПособияНаРебенкаИнвалидаТекст = "ВТРазмерПособияНаРебенкаИнвалида";
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНаРебенкаИнвалида КАК ДанныеОРазмереПособияНаРебенкаИнвалида
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНаРебенкаИнвалида.ОсновнойНомерСтроки";
			
		КонецЕсли;
		Если НеобходимыеДанные.РазмерПособияНаРебенкаВич Тогда
			Запрос.УстановитьПараметр("СпособРасчетаПособияНаРебенкаВич", Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаВич);
			Запрос.УстановитьПараметр("ВидПособияНаРебенкаВич", Перечисления.ВидыГосударственныхПособий.ПособиеНаВИЧИнфицРебенка    );
			
			Запрос.Текст = РазмерПособияНаРебенкаВичТекст;
			Запрос.Выполнить();
			РазмерПособияНаРебенкаВичТекст = "ВТРазмерПособияНаРебенкаВич";
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерПособияНаРебенкаВич КАК ДанныеОРазмереПособияНаРебенкаВич
			|ПО Основной.НомерСтроки = ДанныеОРазмереПособияНаРебенкаВич.ОсновнойНомерСтроки";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.СдельныйЗаработок Тогда
			
			Запрос.Текст = СдельныйЗаработокОрганизацииТекст;
			Запрос.Выполнить();
			СдельныйЗаработокОрганизацииТекст = "ВТСдельныйЗаработокОрганизации";
			
			// присоединяем данные о сдельном заработке
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТСдельныйЗаработокОрганизации КАК ДанныеОСдельномЗаработке
			|ПО Основной.НомерСтроки = ДанныеОСдельномЗаработке.ОсновнойНомерСтроки";
			
		КонецЕсли;
		
		
		Если НеобходимыеДанные.РазмерОграниченияПособия Тогда
			
			Запрос.УстановитьПараметр("СпособРасчетаПоСреднемуЗаработкуФСС", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
			
			// присоединяем данные о размере пособия
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ (" + РазмерММОТТекст + ") КАК РазмерММОТ
			|ПО Основной.НомерСтроки = РазмерММОТ.ОсновнойНомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ (" + РазмерОграниченияПособияТекст + ") КАК РазмерОграниченияПособия
			|ПО Основной.НомерСтроки = РазмерОграниченияПособия.ОсновнойНомерСтроки";
		КонецЕсли;
		
		Если НеобходимыеДанные.ДанныеДляПрогнозаНДФЛ Тогда
			
			СуммарныйПроцентТекст = 
			"ВЫБРАТЬ
			|	Размеры.Сотрудник,
			|	СУММА(Размеры.Размер) КАК Процент
			|ИЗ
			|	(ВЫБРАТЬ
			|		Начисления.Сотрудник КАК Сотрудник,
			|		Начисления.Показатель1 КАК Размер
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
			|	ГДЕ
			|		Начисления.Ссылка = &парамРегистратор
			|		И Начисления.ВидРасчета.СпособРасчета В (&Процентом)
			|		И Начисления.ВидРасчета В
			|				(ВЫБРАТЬ
			|					Базовые.Ссылка
			|				ИЗ
			|					ПланВидовРасчета.ОсновныеНачисленияОрганизаций.БазовыеВидыРасчета КАК Базовые
			|				ГДЕ
			|					Базовые.ВидРасчета.СпособРасчета = &Доначисление)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		Начисления.Сотрудник,
			|		Начисления.Показатель1
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
			|	ГДЕ
			|		Начисления.Ссылка = &парамРегистратор
			|		И Начисления.ВидРасчета.СпособРасчета В (&Процентом)
			|		И Начисления.ВидРасчета В
			|				(ВЫБРАТЬ
			|					Базовые.Ссылка
			|				ИЗ
			|					ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.БазовыеВидыРасчета КАК Базовые
			|				ГДЕ
			|					Базовые.ВидРасчета.СпособРасчета = &Доначисление)) КАК Размеры
			|
			|СГРУППИРОВАТЬ ПО
			|	Размеры.Сотрудник";
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ВзаиморасчетыСРаботниками.Остатки(&КонецПериодаРегистрации, " + УсловиеНаФизлицоТекст + ") КАК ВзаиморасчетыСРаботниками
			|ПО Основной.Физлицо = ВзаиморасчетыСРаботниками.Физлицо
			|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	ВзаиморасчетыСРаботникамиОрганизаций.Физлицо,
			|	СУММА(ВзаиморасчетыСРаботникамиОрганизаций.СуммаВзаиморасчетов) КАК УжеНачисленоДоДоначисления
			|ИЗ
			|	РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК ВзаиморасчетыСРаботникамиОрганизаций
			|ГДЕ
			|	ВзаиморасчетыСРаботникамиОрганизаций.Организация = &парамОрганизация
			|	И ВзаиморасчетыСРаботникамиОрганизаций.Регистратор <> &парамРегистратор
			|	И НАЧАЛОПЕРИОДА(ВзаиморасчетыСРаботникамиОрганизаций.Период, МЕСЯЦ) = НАЧАЛОПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
			|	И ВзаиморасчетыСРаботникамиОрганизаций.ВидДвижения = &парамПриход
			|
			|СГРУППИРОВАТЬ ПО
			|	ВзаиморасчетыСРаботникамиОрганизаций.Физлицо) КАК ВзаиморасчетыСРаботникамиОрганизаций
			|ПО Основной.Физлицо = ВзаиморасчетыСРаботникамиОрганизаций.Физлицо
			|ЛЕВОЕ СОЕДИНЕНИЕ (" + СуммарныйПроцентТекст + ") КАК СуммарныйПроцент
			|ПО Основной.Сотрудник = СуммарныйПроцент.Сотрудник
			|ЛЕВОЕ СОЕДИНЕНИЕ 
			|(ВЫБРАТЬ
			|	ГражданствоФизЛицСрезПоследних.ФизЛицо КАК ФизЛицо
			|	ИЗ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&парамКонецГода, " + УсловиеНаФизлицоТекст + ") КАК ГражданствоФизЛицСрезПоследних
			|	ГДЕ (ГражданствоФизЛицСрезПоследних.НеЯвляетсяНалоговымРезидентомРФ)) КАК НеРезиденты
			|ПО Основной.Физлицо = НеРезиденты.ФизЛицо";
			
			Запрос.УстановитьПараметр("парамКонецГода", КонецГода(ПериодРегистрации));
			Запрос.УстановитьПараметр("КонецПериодаРегистрации", ДобавитьМесяц(ПериодРегистрации, 1));
			Запрос.УстановитьПараметр("Доначисление", Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету);
			Запрос.УстановитьПараметр("Процентом", ПолучитьСписокНачисленийПроцентом());
			
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса + "
		|ГДЕ " + ВнешнееУсловие;
		
	ИначеЕсли ИмяРегистра = "ДополнительныеНачисленияРаботниковОрганизаций" Тогда
		//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда 
		//	ТекстЗапроса =
		//	"ВЫБРАТЬ
		//	|ДанныеДляРасчетаСреднего.ЧислоМесяцев КАК ЧислоМесяцев,
		//	|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноДней, 0) КАК ОтработаноДнейПоСреднему,
		//	|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноЧасов, 0) КАК ОтработаноЧасовПоСреднему,
		//	|ДанныеДляРасчетаСреднего.СреднийЗаработок КАК СреднийЗаработок,
		//	|ВложенныйЗапрос.Регистратор,
		//	|ВложенныйЗапрос.НомерСтроки,
		//	|ВложенныйЗапрос.СотрудникНаименование,
		//	|ВложенныйЗапрос.Сотрудник,
		//	|ВложенныйЗапрос.Физлицо,
		//	|ВложенныйЗапрос.ВидРасчета,
		//	|ВложенныйЗапрос.ВидРасчетаПериодДействияБазовый,
		//	|ВложенныйЗапрос.ВидРасчетаНаименование,
		//	|ВложенныйЗапрос.СпособРасчета,
		//	|ВложенныйЗапрос.ВидУчетаВремени,
		//	|ВложенныйЗапрос.КодДоходаНДФЛ,
		//	|ВложенныйЗапрос.РучнойРасчетСреднегоЗаработка,
		//	|ВложенныйЗапрос.РазмерСреднегоЗаработка,
		//	|ВложенныйЗапрос.Номер,
		//	|ВложенныйЗапрос.Дата,
		//	|ВложенныйЗапрос.ПериодРасчетаСреднегоЗаработкаНачало,
		//	|ВложенныйЗапрос.ПериодРасчетаСреднегоЗаработкаОкончание,
		//	|ВложенныйЗапрос.ДатаНачалаСобытия
		//	|ИЗ
		//	|(ВЫБРАТЬ
		//	|Основной.Регистратор КАК Регистратор,
		//	|Основной.НомерСтроки КАК НомерСтроки,
		//	|Основной.Сотрудник.Наименование КАК СотрудникНаименование,
		//	|Основной.Сотрудник КАК Сотрудник,
		//	|Основной.Сотрудник.Физлицо КАК Физлицо,
		//	|Основной.ВидРасчета КАК ВидРасчета,
		//	|ИСТИНА КАК ВидРасчетаПериодДействияБазовый,
		//	|Основной.ВидРасчета.Наименование КАК ВидРасчетаНаименование,
		//	|Основной.ВидРасчета.СпособРасчета КАК СпособРасчета,
		//	|Основной.ВидУчетаВремени КАК ВидУчетаВремени,
		//	|Основной.ВидРасчета.КодДоходаНДФЛ КАК КодДоходаНДФЛ";
		//	
		//иначе
		//	
		//Островская Татьяна 17.01.2013 № 16154
		ТекстЗапроса = 
		"ВЫБРАТЬ 
		|Основной.Регистратор Как Регистратор,
		|МАКСИМУМ(Основной.НомерСтроки) Как НомерСтроки,
		|Основной.Сотрудник.Наименование Как СотрудникНаименование,
		|Основной.Сотрудник Как Сотрудник,
		|Основной.Сотрудник.Физлицо Как Физлицо,
		|Основной.ВидРасчета Как ВидРасчета,
		|Истина Как ВидРасчетаПериодДействияБазовый,
		|Основной.ВидРасчета.Наименование Как ВидРасчетаНаименование,
		|Основной.ВидРасчета.СпособРасчета Как СпособРасчета,
		|Основной.ВидУчетаВремени как ВидУчетаВремени,
		|Основной.ВидРасчета.КодДоходаНДФЛ Как КодДоходаНДФЛ";
		Если не НеобходимыеДанные.ВычетыКДоходамНДФЛ Тогда
			ТекстЗапроса = СтрЗаменить(ТекстЗапроса,"МАКСИМУМ(Основной.НомерСтроки) Как НомерСтроки,","Основной.НомерСтроки Как НомерСтроки,");
		КонецЕсли;
		//КонецЕсли;
		
		Запрос.УстановитьПараметр("ПустойКодВычета", Справочники.ВычетыНДФЛ.ПустаяСсылка());
		
		Если КомментироватьРасчет Тогда
			ПоляЗапроса.Добавить("Сотрудник");
			ПоляЗапроса.Добавить("СотрудникНаименование");
			ПоляЗапроса.Добавить("Регистратор");//О.Т. Аверсон 18.04.2017 № 531
			ПоляЗапроса.Добавить("ФизЛицо"); //О.Т. Аверсон 18.04.2017 № 531
			ПоляЗапроса.Добавить("ВидРасчета");
			ПоляЗапроса.Добавить("ВидРасчетаНаименование");
			ПоляЗапроса.Добавить("СпособРасчета");
			ПоляЗапроса.Добавить("КодДоходаНДФЛ");
			ПоляЗапроса.Добавить("ВидРасчетаПериодДействияБазовый");
		КонецЕсли;
		
		Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
			
			Если КоличествоПоказателей = 0 Тогда
				ТекстЗапроса = ТекстЗапроса + ",
				| 0 КАК КоличествоПоказателей,";
			Иначе
				ТекстЗапроса = ТекстЗапроса + ",
				| Показатели.КоличествоПоказателей КАК КоличествоПоказателей,";
			КонецЕсли;
			
			ТекстЗапроса = ТекстЗапроса + "
			| Основной.ВидРасчета.ФормулаРасчета КАК ФормулаРасчета";
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("КоличествоПоказателей");
				ПоляЗапроса.Добавить("ФормулаРасчета");
			КонецЕсли;
			
			Для СчПоказателей = 1 По КоличествоПоказателей Цикл
				Если СчПоказателей > 6 Тогда					
					ПоказательТекст = СтрЗаменить(Показатель1ТекстПредопределенный, "Показатель1", "Показатель"+СчПоказателей);
				ИначеЕсли СчПоказателей > 1 Тогда
					ПоказательТекст = СтрЗаменить(Показатель1Текст, "Показатель1", "Показатель"+СчПоказателей);
				Иначе
					ПоказательТекст = Показатель1Текст;
				КонецЕсли;					
				
				ТекстЗапроса = ТекстЗапроса + ", 
				|Показатели.Показатель" + СчПоказателей+".Наименование Как Показатель" + СчПоказателей + "Наименование,
				|" + ПоказательТекст + " Как Показатель"+СчПоказателей;
				
				Если КомментироватьРасчет Тогда
					ПоляЗапроса.Добавить("Показатель" + СчПоказателей + "Наименование");
					ПоляЗапроса.Добавить("Показатель" + СчПоказателей);
				КонецЕсли;
			КонецЦикла;			
			
		КонецЕсли;
		
		Если НеобходимаБаза Тогда
			// если присоединяем к базе
			Если КомментироватьРасчет Тогда
				ТекстЗапроса = ТекстЗапроса + ",
				|База.РезультатБаза Как РезультатБаза,
				|База.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
				|База.ВидРасчетаРазрез.Наименование КАК ВидРасчетаРазрезНаименование";
				ПоляЗапроса.Добавить("РезультатБаза");
				ПоляЗапроса.Добавить("ВидРасчетаРазрез");
				ПоляЗапроса.Добавить("ВидРасчетаРазрезНаименование");
			Иначе 
				ТекстЗапроса = ТекстЗапроса + ",
				|База.РезультатБаза КАК РезультатБаза";
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработок Тогда
			//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
			//	ТекстЗапроса = ТекстЗапроса + ",
			//	|Основной.РучнойРасчетСреднегоЗаработка КАК РучнойРасчетСреднегоЗаработка,
			//	|Основной.РазмерСреднегоЗаработка КАК РазмерСреднегоЗаработка,
			//	|ДоговорНаВыполнениеРаботСФизЛицом.Номер КАК Номер,
			//	|ДоговорНаВыполнениеРаботСФизЛицом.Дата КАК Дата,
			//	|Основной.ПериодРасчетаСреднегоЗаработкаНачало КАК ПериодРасчетаСреднегоЗаработкаНачало,
			//	|Основной.ПериодРасчетаСреднегоЗаработкаОкончание КАК ПериодРасчетаСреднегоЗаработкаОкончание,
			//	|Основной.ДатаНачалаСобытия КАК ДатаНачалаСобытия";
			//иначе
			
			ТекстЗапроса = ТекстЗапроса + ",
			|Основной.РучнойРасчетСреднегоЗаработка Как РучнойРасчетСреднегоЗаработка, 
			|Основной.РазмерСреднегоЗаработка Как РазмерСреднегоЗаработка, 
			|ДанныеДляРасчетаСреднего.ЧислоМесяцев Как ЧислоМесяцев, 
			|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноДней,0) Как ОтработаноДнейПоСреднему, 
			|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноЧасов,0) Как ОтработаноЧасовПоСреднему,"; 
			//|ДанныеДляРасчетаСреднего.ДатаДоговора Как ДатаДоговора,
			//|ДанныеДляРасчетаСреднего.НомерДоговора Как НомерДоговора,";
			
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
				Если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу и ПериодСреднегоПоОкладу <> Неопределено Тогда
					ТекстЗапроса = ТекстЗапроса+ " 
					|ДанныеДляРасчетаСреднегоДляОклада.СреднийЗаработокДляОклада Как СреднийЗаработок";
				иначе
					ТекстЗапроса = ТекстЗапроса+ " 
					|ДанныеДляРасчетаСреднего.СреднийЗаработок Как СреднийЗаработок";
					
				КонецЕсли;
			иначе
				ТекстЗапроса = ТекстЗапроса+ " 
				|ДанныеДляРасчетаСреднего.СреднийЗаработок Как СреднийЗаработок";
			КонецЕсли;
			//КонецЕсли; Поставить условие на документ на номер и дату
			
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОтработаноДнейПоСреднему");
				ПоляЗапроса.Добавить("ОтработаноЧасовПоСреднему");
				ПоляЗапроса.Добавить("СреднийЗаработок");
			КонецЕсли;
			
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработокОтпуска Тогда
			//Островская Татьяна 15.11.2012 № 15
			// выбираем ЧислоДнейВНеделе
			ТекстЗапроса = ТекстЗапроса + ", 
			|ВЫБОР КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке) ТОГДА 6 ИНАЧЕ 7 КОНЕЦ КАК ЧислоДнейВНеделе,
			|Основной.ГрафикРаботы.ДлительностьРабочейНедели КАК ДлительностьРабочейНедели,
			|Основной.БазовыйПериодНачало";
			//Островская Татьяна 15.11.2012 № 15
			//О.Т. Аверсон 12.04.2019 № 4189
			ЭтоАгент = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				ЭтоАгент = Регистратор.Агент;
			КонецЕсли;
			//О.Т. Аверсон 12.04.2019 № 4189
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			НеполныйМесяц = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				НеполныйМесяц = Регистратор.РасчетПриНеполныхМесяцах;
			КонецЕсли;
			//Аверсон СВФР-009668
			
			Запрос.УстановитьПараметр("ПоЗаработку", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
			Запрос.УстановитьПараметр("ПоЗаработкуИнд", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые));
			Запрос.УстановитьПараметр("ПоЗаработкуИндСред", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеСред);//О.Т. Аверсон 06.07.2016 № 855
			Запрос.УстановитьПараметр("ПоЗаработкуБЛ", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			//Запрос.УстановитьПараметр("ПоЗаработкуОтпуск", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск));//О.Т. Аверсон 16.04.2019 № 4189
			Запрос.УстановитьПараметр("ПоЗаработкуОтпуск", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			//Аверсон СВФР-009668
			
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда //О.Т. Аверсон 23.06.2016 № 1267
				Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему);
			иначе    
				Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
			КонецЕсли;
			Запрос.УстановитьПараметр("ПоФиксПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ЧислоДнейВНеделе");
				ПоляЗапроса.Добавить("ДлительностьРабочейНедели");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.ДанныеДляПрогнозаНДФЛ Тогда
			ТекстЗапроса = ТекстЗапроса + ",
			|ВзаиморасчетыСРаботниками.СуммаУпрОстаток Как КВыплатеПоУпрУчету,
			|ВзаиморасчетыСРаботникамиОрганизаций.УжеНачисленоДоДоначисления Как УжеНачисленоДоДоначисления,
			|ЕСТЬNULL(СуммарныйПроцент.Процент, 0) Как СуммарныйПроцент, 
			|ВЫБОР КОГДА НеРезиденты.ФизЛицо ЕСТЬ NULL ТОГДА Истина ИНАЧЕ Ложь КОНЕЦ Как Резидент";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("КВыплатеПоУпрУчету");
				ПоляЗапроса.Добавить("УжеНачисленоДоДоначисления");
				ПоляЗапроса.Добавить("СуммарныйПроцент");
				ПоляЗапроса.Добавить("Резидент");
			КонецЕсли;
		КонецЕсли;
		
		//Аверсон-софт, Островская Татьяна 22.03.2012 №14668
		Если НеобходимыеДанные.ВычетыКДоходамНДФЛ Тогда
			//Островская Татьяна 17.01.2013 № 16154
			ТекстЗапроса = ТекстЗапроса + ", 
			|ВЫБОР
			|	КОГДА (Основной.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(перечисление.ВидыЗанятостиВОрганизации.Совместительство))";
			
			//Аверсон 06.04.2022 КВВ СВФР-008874 (
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда
				ТекстЗапроса = ТекстЗапроса + "
				|ИЛИ
				|(Основной.Сотрудник.ТипРаботника = ЗНАЧЕНИЕ(Перечисление.ТипыРаботников.ДоговорПодряда))";
			КонецЕсли;
			ТекстЗапроса = ТекстЗапроса + "
			//Аверсон 06.04.2022 КВВ СВФР-008874 )
			
			|		ТОГДА ЕСТЬNULL(СведенияОСкидках.ВычетНаСовместителя, 0)
			|	ИНАЧЕ ЕСТЬNULL(СведенияОСкидках.ГодовойВычет, 0)
			|КОНЕЦ Как ГодовойВычет, //О.Т. Аверсон 08.12.2016 № 77
			|ЕСТЬNULL(СведенияОСкидках.НормативЗатрат, 0) Как НормативЗатрат,
			|ЕСТЬNULL(СведенияОСкидках.КратностьВычета, 0) Как КратностьВычета,
			|ЕСТЬNULL(НДФЛСведенияОДоходахОбороты.СуммаВычетаОборот, 0) Как СуммаВычетаОборот1,";
			Если ПериодРегистрации >= Дата(2016,07,01) и ПериодРегистрации <= Дата(2016,12,31) Тогда //О.Т. Аверсон 09.06.2016 № 1191
				ТекстЗапроса = ТекстЗапроса + " 	
				|ЕСТЬNULL(НДФЛОбороты.СуммаВычетаОборот, 0) / 10000 + ЕСТЬNULL(НДФЛСведенияОДоходахОбороты.СуммаВычетаОборот, 0) Как СуммаВычетаОборот,";
			иначе  				
				ТекстЗапроса = ТекстЗапроса + " 	
				|ЕСТЬNULL(НДФЛОбороты.СуммаВычетаОборот, 0) Как СуммаВычетаОборот,";
			КонецЕсли;
			
			если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда
				ТекстЗапроса = СтрЗаменить(ТекстЗапроса,"Как СуммаВычетаОборот,","Как СуммаВычетаОборот");
			иначе
				ТекстЗапроса = ТекстЗапроса + " ФизЛица.Регистратор КАК РегистраторРаботники";
			КонецЕсли;
			//Островская Татьяна 17.01.2013 № 16154
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ГодовойВычет");
				ПоляЗапроса.Добавить("НормативЗатрат");
				ПоляЗапроса.Добавить("КратностьВычета");
				ПоляЗапроса.Добавить("СуммаВычетаОборот");
				ПоляЗапроса.Добавить("Период");
				
			КонецЕсли;
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса + "
		|ИЗ РегистрРасчета."+ИмяРегистра+" Как Основной";
		
		//О.Т. 13.10.2014 № 17616
		//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда 
		//	ТекстЗапроса = ТекстЗапроса + " 
		//	|ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		//	|ПО Основной.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
		//	|ГДЕ
		//	|Основной.ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления
		//	|И Основной.Регистратор = &парамРегистратор) КАК ВложенныйЗапрос";
		//КонецЕсли;
		//О.Т. 13.10.2014 № 17616
		
		Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
			
			ТекстЗапроса = ТекстЗапроса + "			
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказатели КАК Показатели
			|ПО Показатели.ВидРасчета = Основной.ВидРасчета";
			
		КонецЕсли;	
		
		Если НеобходимыеДанные.Стаж Тогда
			// присоединение к данным о стаже
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ДанныеОСтаже			
			|ПО ДанныеОСтаже.Сотрудник = Основной.Сотрудник
			|И	ДанныеОСтаже.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)";
			
			Запрос.УстановитьПараметр("ПериодРегистрации",	ПериодРегистрации);
		КонецЕсли;
		
		// если перерасчет - нужно сузить выборку 
		Если Перерасчет И Физлица = Неопределено Тогда
			// перерасчет по всем физлицам перерасчета
			ТекстЗапроса = ТекстЗапроса + "
			|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТФизлицаДляПерерасчета КАК ФизлицаДляПерерасчета
			|ПО ФизлицаДляПерерасчета.Физлицо = Основной.Физлицо";
			
		КонецЕсли;
		
		Если НеобходимаБаза Тогда
			
			Разрезы = Новый Массив;
			Разрезы.Добавить("ПериодРегистрации");
			Разрезы.Добавить("Регистратор"); //Островская Татьяна 19.05.2014 № 17307
			
			Если КомментироватьРасчет Тогда
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	СУММА(База.РезультатБаза) КАК РезультатБаза,
				|	База.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
				|	База.Регистратор КАК Регистратор,
				|	База.НомерСтроки КАК НомерСтроки
				|ПОМЕСТИТЬ ВТБаза
				|ИЗ
				|	(ВЫБРАТЬ
				|		База1.РезультатБаза КАК РезультатБаза,
				|		База1.ВидРасчетаРазрез КАК ВидРасчетаРазрез,
				|		База1.Регистратор КАК Регистратор,
				|		База1.НомерСтроки КАК НомерСтроки
				|	ИЗ
				|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.БазаОсновныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База1
				|	ГДЕ
				|		((НЕ База1.Сторно)
				|				ИЛИ База1.ПериодРегистрацииРазрез < База1.ПериодРегистрации)
				|		//И РегистраторРазрез1 //Островская Татьяна 12.05.2014 № 17307
				|	
				|	ОБЪЕДИНИТЬ ВСЕ
				|	
				|	ВЫБРАТЬ
				|		База2.РезультатБаза,
				|		База2.ВидРасчетаРазрез,
				|		База2.Регистратор,
				|		База2.НомерСтроки
				|	ИЗ
				|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.БазаДополнительныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База2
				|	ГДЕ
				|		((НЕ База2.Сторно)
				|				ИЛИ База2.ПериодРегистрацииРазрез < База2.ПериодРегистрации)
				|		//И РегистраторРазрез2) КАК База  //Островская Татьяна 12.05.2014 № 17307
				|СГРУППИРОВАТЬ ПО
				|	База.ВидРасчетаРазрез,
				|	База.Регистратор,
				|	База.НомерСтроки";
				
				Разрезы.Добавить("ВидРасчета");
				
			Иначе
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	СУММА(База.РезультатБаза) КАК РезультатБаза,
				|	База.Регистратор КАК Регистратор,
				|	База.НомерСтроки КАК НомерСтроки
				|ПОМЕСТИТЬ ВТБаза
				|ИЗ
				|	(ВЫБРАТЬ
				|		База1.РезультатБаза КАК РезультатБаза,
				|		База1.Регистратор КАК Регистратор,
				|		База1.НомерСтроки КАК НомерСтроки
				|	ИЗ
				|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.БазаОсновныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База1
				|	ГДЕ
				|		((НЕ База1.Сторно)
				|				ИЛИ База1.ПериодРегистрацииРазрез < База1.ПериодРегистрации)
				|		//И РегистраторРазрез1 //Островская Татьяна 12.05.2014 № 17307
				|	
				|	ОБЪЕДИНИТЬ ВСЕ
				|	
				|	ВЫБРАТЬ
				|		База2.РезультатБаза,
				|		База2.Регистратор,
				|		База2.НомерСтроки
				|	ИЗ
				|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.БазаДополнительныеНачисленияРаботниковОрганизаций(&парамИзмеренияОсновного, &парамИзмеренияБазового, &парамРазрезы, " + Условие + ") КАК База2
				|	ГДЕ
				|		((НЕ База2.Сторно)
				|				ИЛИ База2.ПериодРегистрацииРазрез < База2.ПериодРегистрации)
				|		//И РегистраторРазрез2) КАК База //Островская Татьяна 12.05.2014 № 17307
				|СГРУППИРОВАТЬ ПО
				|	База.Регистратор,
				|	База.НомерСтроки";
				
			КонецЕсли;
			//Островская Татьяна 12.05.2014 № 17307
			если Организация.ИНН = "100765738" Тогда 
				если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","И База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","И База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
				иначе
					если ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда
						Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
						Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
					иначе
						Если КатегорияНачисления = Справочники.КатегорииРасчетов.НайтиПоНаименованию("Зависимое третьего уровня") Тогда 
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
						иначе
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","И не База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","И не База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
			иначе
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
			КонецЕсли;
			//Островская Татьяна 12.05.2014 № 17307
			Запрос.УстановитьПараметр("парамРазрезы", Разрезы);
			Запрос.Выполнить();
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТБаза КАК База
			|ПО Основной.Регистратор = База.Регистратор И Основной.НомерСтроки = База.НомерСтроки";
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработок Тогда
			//О.Т. Аверсон 12.04.2019 № 4189
			ЭтоАгент = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				ЭтоАгент = Регистратор.Агент;
			КонецЕсли;
			//О.Т. Аверсон 12.04.2019 № 4189
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			НеполныйМесяц = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				НеполныйМесяц = Регистратор.РасчетПриНеполныхМесяцах;
			КонецЕсли;
			//Аверсон СВФР-009668
			
			Запрос.УстановитьПараметр("ПоЗаработку", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
			Запрос.УстановитьПараметр("ПоЗаработкуИнд", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые));
			Запрос.УстановитьПараметр("ПоЗаработкуИндСред", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеСред);//О.Т. Аверсон 06.07.2016 № 855
			Запрос.УстановитьПараметр("ПоЗаработкуБЛ", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			//Запрос.УстановитьПараметр("ПоЗаработкуОтпуск", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск));//О.Т. Аверсон 16.04.2019 № 4189
			Запрос.УстановитьПараметр("ПоЗаработкуОтпуск", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			//Аверсон СВФР-009668
			
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда //О.Т. Аверсон 23.06.2016 № 1267
				Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему);
			иначе    
				Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
			КонецЕсли;
			Запрос.УстановитьПараметр("ПоФиксПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
			
			ПоСреднемуЗаработкуФСС = Новый Массив(2);
			ПоСреднемуЗаработкуФСС[0] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС;
			//ПоСреднемуЗаработкуФСС[1] = Перечисления.СпособыРасчетаОплатыТруда.ПособиеПоУходуЗаРебенкомДо1_5Лет;
			Запрос.УстановитьПараметр("ПоСреднемуЗаработкуФСС", ПоСреднемуЗаработкуФСС);
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
				ЗапросДаты = Новый Запрос;
				ЗапросДаты.Текст = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	Основной.Сотрудник КАК Сотрудник,
				|	РАЗНОСТЬДАТ(Основной.ПериодРасчетаСреднегоЗаработкаНачало, НАЧАЛОПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, МЕСЯЦ), МЕСЯЦ) + 1 КАК ПериодРасчетаСреднегоЗаработка,
				|	Основной.ПериодРасчетаСреднегоЗаработкаНачало КАК НачалоБП,
				|	КОНЕЦПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, ДЕНЬ) КАК КонецБП,
				|	Основной.БазовыйПериодНачало КАК ПериодДействияНачало,
				|	Основной.БазовыйПериодКонец КАК ПериодДействияКонец
				|ИЗ
				|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Основной
				|ГДЕ
				|	Основной.Регистратор = &парамРегистратор
				|	И Основной.ВидРасчета.СпособРасчета В(&парамСпособыРасчета)
				|	И НЕ Основной.Сторно
				|	И ВЫБОР
				|			КОГДА &ЭтоБольничный
				|				ТОГДА Основной.Сотрудник = &Сотрудник
				|			ИНАЧЕ ИСТИНА
				|		КОНЕЦ
				|
				|УПОРЯДОЧИТЬ ПО
				|	Сотрудник,
				|	НачалоБП,
				|	КонецБП";
				СпособыРасчетаПоСреднему = Новый Массив(1);
				СпособыРасчетаПоСреднему[0] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС;
				
				//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
				ЗапросДаты.УстановитьПараметр("парамРегистратор", Регистратор);
				//- СВЭЙ КДЯ 01.10.19 СВФР-004756
				
				//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
				//ЗапросДаты.УстановитьПараметр( "парамРегистратор", ПолучитьРеквизитПервичного( Регистратор, "Ссылка" ) );
				//- СВЭЙ КДЯ 01.10.19 СВФР-004756
				
				ЗапросДаты.УстановитьПараметр("парамСпособыРасчета", СпособыРасчетаПоСреднему);
				ЗапросДаты.УстановитьПараметр("Сотрудник", Регистратор.Сотрудник);
				ЗапросДаты.УстановитьПараметр("ЭтоБольничный", Истина);
				
				РезультатДаты = ЗапросДаты.Выполнить().Выгрузить();
				если РезультатДаты.Количество()> 0 Тогда 
					ДатаНачалаРасчетаСреднего = РезультатДаты[0].НачалоБП;
					ДатаОкончанияРасчетаСреднего = РезультатДаты[0].КонецБП;
				КонецЕсли;
				если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП  Тогда 
					Колич = РезультатДаты.Количество();
					если Колич > 0 Тогда 
						НачалоБПМ = НачалоМесяца(РезультатДаты[0].ПериодДействияНачало);
						КонецБПМ = КонецМесяца(РезультатДаты[Колич-1].ПериодДействияКонец);
					КонецЕсли;
				КонецЕсли;
				если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ или Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.МЗП Тогда 
					ДатаНачалаРасчетаСреднего = НачалоБПМ;
					ДатаОкончанияРасчетаСреднего = КонецБПМ;
				КонецЕсли;
				Запрос.УстановитьПараметр("ДатаНачала", ДатаНачалаРасчетаСреднего);
				Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончанияРасчетаСреднего);
				
				Запрос.УстановитьПараметр("Сотрудник", Регистратор.Сотрудник);
				Запрос.Текст = ДанныеОДоговоре;
				Запрос.Выполнить(); 
			КонецЕсли;
			Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу",ПериодСреднегоПоОкладу); //О.Т. 17.02.2015 № 334
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
				Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу1",НачалоМесяца(Регистратор.ДатаНачала)); //О.Т. 17.02.2015 № 334
			иначе
				Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу1",ПериодСреднегоПоОкладу);
			КонецЕсли;
			
			Запрос.УстановитьПараметр("ПоГодовымПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии);
			Запрос.Текст = ДанныеОСреднемЗаработкеТекст;
			Запрос.Выполнить();
			ДанныеОСреднемЗаработкеТекст = "ВТДанныеОСреднемЗаработке";
			//О.Т. Аверсон 28.02.2017 № 215
			Запрос.Текст = ДанныеОСреднемЗаработкеДляОкладаТекст;
			Запрос.Выполнить();
			ДанныеОСреднемЗаработкеДляОкладаТекст = "ВТДанныеОСреднемЗаработкеДляОклада";
			//О.Т. Аверсон 28.02.2017 № 215
			
			
			// присоединяем данные для расчета среднего заработка     
			//Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
			//	ТекстЗапроса = ТекстЗапроса + "
			//	|ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОСреднемЗаработке КАК ДанныеДляРасчетаСреднего
			//	|ПО ВложенныйЗапрос.Сотрудник = ДанныеДляРасчетаСреднего.Сотрудник
			//	|И ВложенныйЗапрос.ВидРасчета.СпособРасчета = ДанныеДляРасчетаСреднего.СпособРасчета
			//	|И ВложенныйЗапрос.ДатаНачалаСобытия = ДанныеДляРасчетаСреднего.ДатаНачалаСобытия
			//	|И ВложенныйЗапрос.ПериодРасчетаСреднегоЗаработкаНачало = ДанныеДляРасчетаСреднего.ДатаНачалаРасчетногоПериода
			//	|И ВложенныйЗапрос.ПериодРасчетаСреднегоЗаработкаОкончание = ДанныеДляРасчетаСреднего.ДатаОкончанияРасчетногоПериода";
			//	//|И ВложенныйЗапрос.Дата = ДанныеДляРасчетаСреднего.ДатаДоговора
			//	//|И ВложенныйЗапрос.Номер = ДанныеДляРасчетаСреднего.НомерДоговора";
			//иначе
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ "+ДанныеОСреднемЗаработкеТекст+" КАК ДанныеДляРасчетаСреднего
			|ПО Основной.Сотрудник = ДанныеДляРасчетаСреднего.Сотрудник И 
			|Основной.ВидРасчета.СпособРасчета = ДанныеДляРасчетаСреднего.СпособРасчета И 
			|Основной.ДатаНачалаСобытия = ДанныеДляРасчетаСреднего.ДатаНачалаСобытия"; 
			//	|Основной.ПериодРасчетаСреднегоЗаработкаНачало = ДанныеДляРасчетаСреднего.ДатаНачалаРасчетногоПериода И  //Аверсон 13.01.2022 КВВ СВФР-008577 (закомментировано) 
			
			//Аверсон 21.06.2023 КВВ СВФР-010940 (
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") И ЗначениеЗаполнено(Регистратор.ДатаВыборки) Тогда
				//не сравниваем
			Иначе   
				//Аверсон 21.06.2023 КВВ СВФР-010940 )
				
				//Аверсон 22.08.2023 КВВ СВФР-011258 (пункт 1) (
				Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")
					И РеальныйРегистратор <> Неопределено 
					И ЗначениеЗаполнено(РеальныйРегистратор.ПервичныйБольничныйЛист) Тогда 
				Иначе
					//Аверсон 22.08.2023 КВВ СВФР-011258 (пункт 1) )
					ТекстЗапроса = ТекстЗапроса + "
					|И Основной.ПериодРасчетаСреднегоЗаработкаОкончание = ДанныеДляРасчетаСреднего.ДатаОкончанияРасчетногоПериода 
					|";
				КонецЕсли;
			КонецЕсли;
			
			//Аверсон 13.01.2022 КВВ СВФР-008577 (
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")
				И РеальныйРегистратор <> Неопределено 
				И ЗначениеЗаполнено(РеальныйРегистратор.ПервичныйБольничныйЛист) Тогда 
			Иначе
				//Аверсон 21.06.2023 КВВ СВФР-010940 (
				Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") И ЗначениеЗаполнено(Регистратор.ДатаВыборки) Тогда
					//не сравниваем
				Иначе   
					//Аверсон 21.06.2023 КВВ СВФР-010940 )
					
					ТекстЗапроса = ТекстЗапроса + "
					|И Основной.ПериодРасчетаСреднегоЗаработкаНачало = ДанныеДляРасчетаСреднего.ДатаНачалаРасчетногоПериода";
				КонецЕсли;
			КонецЕсли;
			//Аверсон 13.01.2022 КВВ СВФР-008577 )
			
			//КонецЕсли;
			//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
			//	ТекстЗапроса = ТекстЗапроса + " и 
			//	|Основной.ДатаДоговора = ДанныеДляРасчетаСреднего.ДатаДоговора и 
			//	|Основной.НомерДоговора = ДанныеДляРасчетаСреднего.НомерДоговора";
			//КонецЕсли;
			//О.Т. Аверсон 28.02.2017 № 215
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ "+ДанныеОСреднемЗаработкеДляОкладаТекст+" КАК ДанныеДляРасчетаСреднегоДляОклада
			|ПО Основной.Сотрудник = ДанныеДляРасчетаСреднегоДляОклада.Сотрудник И 
			|Основной.ВидРасчета.СпособРасчета = ДанныеДляРасчетаСреднегоДляОклада.СпособРасчета И 
			|Основной.ДатаНачалаСобытия = ДанныеДляРасчетаСреднегоДляОклада.ДатаНачалаСобытия И 
			|Основной.ПериодРасчетаСреднегоЗаработкаНачало = ДанныеДляРасчетаСреднегоДляОклада.ДатаНачалаРасчетногоПериода И 
			|Основной.ПериодРасчетаСреднегоЗаработкаОкончание = ДанныеДляРасчетаСреднегоДляОклада.ДатаОкончанияРасчетногоПериода";
			//КонецЕсли;
			//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда
			//	ТекстЗапроса = ТекстЗапроса + " и 
			//	|Основной.ДатаДоговора = ДанныеДляРасчетаСреднегоДляОклада.ДатаДоговора и 
			//	|Основной.НомерДоговора = ДанныеДляРасчетаСреднегоДляОклада.НомерДоговора";
			//КонецЕсли;
			//О.Т. Аверсон 28.02.2017 № 215
			
			
		КонецЕсли;
		
		Если НеобходимыеДанные.ДанныеДляПрогнозаНДФЛ Тогда
			// суммарный процент всех процентных начислений, в базу которых включены виды расчета 
			// со способом расчета ДоначислениеПоУправленческомуУчету
			СуммарныйПроцентТекст = 
			"ВЫБРАТЬ
			|	Размеры.Сотрудник,
			|	СУММА(Размеры.Размер) КАК Процент
			|ИЗ
			|	(ВЫБРАТЬ
			|		Начисления.Сотрудник КАК Сотрудник,
			|		Начисления.Показатель1 КАК Размер
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
			|	ГДЕ
			|		Начисления.Ссылка = &парамРегистратор
			|		И Начисления.ВидРасчета.СпособРасчета В (&Процентом)
			|		И Начисления.ВидРасчета В
			|				(ВЫБРАТЬ
			|					Базовые.Ссылка
			|				ИЗ
			|					ПланВидовРасчета.ОсновныеНачисленияОрганизаций.БазовыеВидыРасчета КАК Базовые
			|				ГДЕ
			|					Базовые.ВидРасчета.СпособРасчета = &Доначисление)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		Начисления.Сотрудник,
			|		Начисления.Начисления.Показатель1
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
			|	ГДЕ
			|		Начисления.Ссылка = &парамРегистратор
			|		И Начисления.ВидРасчета.СпособРасчета В (&Процентом)
			|		И Начисления.ВидРасчета В
			|				(ВЫБРАТЬ
			|					Базовые.Ссылка
			|				ИЗ
			|					ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.БазовыеВидыРасчета КАК Базовые
			|				ГДЕ
			|					Базовые.ВидРасчета.СпособРасчета = &Доначисление)) КАК Размеры
			|
			|СГРУППИРОВАТЬ ПО
			|	Размеры.Сотрудник";
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ВзаиморасчетыСРаботниками.Остатки(&КонецПериодаРегистрации, " + УсловиеНаФизлицоТекст + ") КАК ВзаиморасчетыСРаботниками
			|ПО Основной.Физлицо = ВзаиморасчетыСРаботниками.Физлицо
			|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	ВзаиморасчетыСРаботникамиОрганизаций.Физлицо,
			|	СУММА(ВзаиморасчетыСРаботникамиОрганизаций.СуммаВзаиморасчетов) КАК УжеНачисленоДоДоначисления
			|ИЗ
			|	РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК ВзаиморасчетыСРаботникамиОрганизаций
			|ГДЕ
			|	ВзаиморасчетыСРаботникамиОрганизаций.Организация = &парамОрганизация
			|	И ВзаиморасчетыСРаботникамиОрганизаций.Регистратор <> &парамРегистратор
			|	И ВзаиморасчетыСРаботникамиОрганизаций.ПериодВзаиморасчетов = &парамПериодРегистрации
			|	И ВзаиморасчетыСРаботникамиОрганизаций.ВидДвижения = &парамПриход
			|
			|СГРУППИРОВАТЬ ПО
			|	ВзаиморасчетыСРаботникамиОрганизаций.Физлицо) КАК ВзаиморасчетыСРаботникамиОрганизаций
			|ПО Основной.Физлицо = ВзаиморасчетыСРаботникамиОрганизаций.Физлицо
			|ЛЕВОЕ СОЕДИНЕНИЕ (" + СуммарныйПроцентТекст + ") КАК СуммарныйПроцент
			|ПО Основной.Сотрудник = СуммарныйПроцент.Сотрудник
			|ЛЕВОЕ СОЕДИНЕНИЕ 
			|(ВЫБРАТЬ
			|	ГражданствоФизЛицСрезПоследних.ФизЛицо КАК ФизЛицо
			|	ИЗ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&парамКонецГода, " + УсловиеНаФизлицоТекст + ") КАК ГражданствоФизЛицСрезПоследних
			|	ГДЕ (ГражданствоФизЛицСрезПоследних.НеЯвляетсяНалоговымРезидентомРФ)) КАК НеРезиденты
			|ПО Основной.Физлицо = НеРезиденты.ФизЛицо";
			
			Запрос.УстановитьПараметр("парамКонецГода", КонецГода(ПериодРегистрации));
			Запрос.УстановитьПараметр("КонецПериодаРегистрации", ДобавитьМесяц(ПериодРегистрации, 1));
			Запрос.УстановитьПараметр("Доначисление", Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету);
			Запрос.УстановитьПараметр("Процентом", ПолучитьСписокНачисленийПроцентом());
			
		КонецЕсли;
		//Островская Татьяна 17.01.2013 № 16154
		Если НеобходимыеДанные.ВычетыКДоходамНДФЛ Тогда 
			Если ПериодРегистрации >= Дата(2016,07,01) и ПериодРегистрации <= Дата(2016,12,31) Тогда //О.Т. Аверсон 09.06.2016 № 1191
				
				ТекстЗапроса = ТекстЗапроса + "
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах.Обороты(&парамНачалоГода, &парамПерваяПоловинаГода, , ПериодРегистрации <= &парамПериодРегистрации И Организация = &парамОрганизация И " + УсловиеНаФизлицоТекст +") КАК НДФЛОбороты  
				|ПО Основной.Физлицо = НДФЛОбороты.ФизЛицо И Основной.Организация = НДФЛОбороты.Организация И Основной.ВидРасчета.КодДоходаНДФЛ = НДФЛОбороты.КодДохода
				
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах.Обороты(&парамВтораяПоловинаГода, &парамКонецМесяцаНалоговогоПериода, , ПериодРегистрации <= &парамПериодРегистрации И Организация = &парамОрганизация И " + УсловиеНаФизлицоТекст +") КАК НДФЛСведенияОДоходахОбороты  
				|ПО Основной.Физлицо = НДФЛСведенияОДоходахОбороты.ФизЛицо И Основной.Организация = НДФЛСведенияОДоходахОбороты.Организация И Основной.ВидРасчета.КодДоходаНДФЛ = НДФЛСведенияОДоходахОбороты.КодДохода";
			иначе
				ТекстЗапроса = ТекстЗапроса + "
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах.Обороты(&парамНачалоГода, &парамКонецМесяцаНалоговогоПериода, , ПериодРегистрации <= &парамПериодРегистрации И Организация = &парамОрганизация И " + УсловиеНаФизлицоТекст +") КАК НДФЛОбороты  
				|ПО Основной.Физлицо = НДФЛОбороты.ФизЛицо И Основной.Организация = НДФЛОбороты.Организация И Основной.ВидРасчета.КодДоходаНДФЛ = НДФЛОбороты.КодДохода
				
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах.Обороты(&парамВтораяПоловинаГода, &парамКонецМесяцаНалоговогоПериода, , ПериодРегистрации <= &парамПериодРегистрации И Организация = &парамОрганизация И " + УсловиеНаФизлицоТекст +") КАК НДФЛСведенияОДоходахОбороты  
				|ПО Основной.Физлицо = НДФЛСведенияОДоходахОбороты.ФизЛицо И Основной.Организация = НДФЛСведенияОДоходахОбороты.Организация И Основной.ВидРасчета.КодДоходаНДФЛ = НДФЛСведенияОДоходахОбороты.КодДохода";
				
			КонецЕсли;
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛВычетыПоДоходам.СрезПоследних(&парамНачалоГода) КАК СведенияОСкидках
			|ПО СведенияОСкидках.КодДохода = Основной.ВидРасчета.КодДоходаНДФЛ,
			|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТФизлицаДляПроверки КАК ФизЛица  //О.Т. 11.09.2014 № 17594
			|ПО Основной.ФизЛицо = ФизЛица.ФизЛицо"; //И КодДохода В (&ДоходыП28Ст217)(Был убран(док. регистрация раз.нач))
			//Островская Татьяна 17.01.2013 № 16154
			ДоходыП28Ст217 = Новый Массив;
			//ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код2761);
			//ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код2720);
			//ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код2730);
			//ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код2740);
			//ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код2760);
			//ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код2770);
			//ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код2790);
			
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1216);       //подарки
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код3114юр);      //подарки (не используется)
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12122а);        //выигрыши призы
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1218);        //мат пом со смертью
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12117);        //мат пом
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12124);        //мат пом подарки профсоюзы
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12119);        //благотворит пом
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код3147);        //подарки до 18 лет (не используется)
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код3131);        //мат пом подарки надбавки пенсионерам (не испоьзуется)
			
			//Аверсон-софт, Островская Татьяна 23.03.2012
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1213); 
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код0911);
			
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код0912);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код0913);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код0914);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код0911);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1011прогр);                                
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1211);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код0911);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12110);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1212);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12122);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12125);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12126);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12127);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12128);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12130);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12139);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1213вых);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1214);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1215);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1217);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код12181);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1219);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код174);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1802ставка15);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1841);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1842);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код301);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код302);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код303);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код304);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код305);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код306);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код307);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код308);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код309);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код310);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код311);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код312);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код313);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код3138);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код314);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код315);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код4000);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код4600);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код4800);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код1842);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код591);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код592);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код593);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код594);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код595);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код596);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код597);
			ДоходыП28Ст217.Добавить(Справочники.ДоходыНДФЛ.Код598);
			//Аверсон-софт, Островская Татьяна 23.03.2012 		
			
			
			Запрос.УстановитьПараметр("ДоходыП28Ст217", ДоходыП28Ст217);
			Запрос.УстановитьПараметр("парамНачалоГода",НачалоГода(ПериодРегистрации));
			Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ПериодРегистрации));
			//О.Т. Аверсон 09.06.2016 № 1191
			Запрос.УстановитьПараметр("парамПерваяПоловинаГода", КонецМесяца(Дата(2016,06,01)));
			Запрос.УстановитьПараметр("парамВтораяПоловинаГода", Дата(2016,07,01));
			//О.Т. Аверсон 09.06.2016 № 1191
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса + "
		|ГДЕ " + ВнешнееУсловие;
		Если НеобходимыеДанные.ВычетыКДоходамНДФЛ Тогда
			Если НеобходимыеДанные.СреднийЗаработок Тогда //О.Т. Аверсон 16.11.2015
				ТекстЗапроса = ТекстЗапроса + "
				|СГРУППИРОВАТЬ ПО ";
				//|ДанныеДляРасчетаСреднего.ДатаДоговора,
				//|ДанныеДляРасчетаСреднего.НомерДоговора,";
				
				Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
					Если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу и ПериодСреднегоПоОкладу <> Неопределено Тогда
						ТекстЗапроса = ТекстЗапроса+ " 
						|ДанныеДляРасчетаСреднегоДляОклада.СреднийЗаработокДляОклада,";
					иначе
						ТекстЗапроса = ТекстЗапроса+ " 
						|ДанныеДляРасчетаСреднего.СреднийЗаработок,";
						
					КонецЕсли;
				иначе
					ТекстЗапроса = ТекстЗапроса+ " 
					|ДанныеДляРасчетаСреднего.СреднийЗаработок,";
				КонецЕсли;
				
				если не ТипЗнч(Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда
					ТекстЗапроса = ТекстЗапроса + " ФизЛица.Регистратор,";
				КонецЕсли;
				ТекстЗапроса = ТекстЗапроса + "
				|Основной.Сотрудник,
				|Основной.Регистратор,
				|Основной.ВидРасчета,
				|Основной.ВидУчетаВремени,
				|Основной.РучнойРасчетСреднегоЗаработка,
				|ДанныеДляРасчетаСреднего.ЧислоМесяцев,
				|Основной.Сотрудник.Наименование,
				|Основной.Сотрудник.Физлицо,
				|Основной.ВидРасчета.Наименование,
				|Основной.ВидРасчета.СпособРасчета,
				|Основной.ВидРасчета.КодДоходаНДФЛ,
				|Основной.РазмерСреднегоЗаработка,
				|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноДней, 0),
				|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноЧасов, 0),
				|ВЫБОР
				|	КОГДА (Основной.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(перечисление.ВидыЗанятостиВОрганизации.Совместительство))";
				
				//Аверсон 06.04.2022 КВВ СВФР-008874 (
				Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда
					ТекстЗапроса = ТекстЗапроса + "
					|ИЛИ
					|(Основной.Сотрудник.ТипРаботника = ЗНАЧЕНИЕ(Перечисление.ТипыРаботников.ДоговорПодряда))";
				КонецЕсли;
				ТекстЗапроса = ТекстЗапроса + "
				//Аверсон 06.04.2022 КВВ СВФР-008874 )
				
				|		ТОГДА ЕСТЬNULL(СведенияОСкидках.ВычетНаСовместителя, 0)
				|	ИНАЧЕ ЕСТЬNULL(СведенияОСкидках.ГодовойВычет, 0)
				|КОНЕЦ, //О.Т. Аверсон 08.12.2016 № 77
				|ЕСТЬNULL(СведенияОСкидках.НормативЗатрат, 0),
				|ЕСТЬNULL(СведенияОСкидках.КратностьВычета, 0),";
				Если ПериодРегистрации >= Дата(2016,07,01) и ПериодРегистрации <= Дата(2016,12,31) Тогда //О.Т. Аверсон 09.06.2016 № 1191
					ТекстЗапроса = ТекстЗапроса + "	
					|ЕСТЬNULL(НДФЛОбороты.СуммаВычетаОборот, 0) / 10000 + ЕСТЬNULL(НДФЛСведенияОДоходахОбороты.СуммаВычетаОборот, 0),";
				иначе  				
					ТекстЗапроса = ТекстЗапроса + "	
					|ЕСТЬNULL(НДФЛОбороты.СуммаВычетаОборот, 0),";
				КонецЕсли;
				ТекстЗапроса = ТекстЗапроса + " 
				|ЕСТЬNULL(НДФЛСведенияОДоходахОбороты.СуммаВычетаОборот, 0)";
				//О.Т. Аверсон 04.02.2016 № 853
				Если НеобходимыеДанные.СреднийЗаработокОтпуска Тогда
					//Островская Татьяна 15.11.2012 № 15
					// выбираем ЧислоДнейВНеделе
					ТекстЗапроса = ТекстЗапроса + ", 
					|ВЫБОР КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке) ТОГДА 6 ИНАЧЕ 7 КОНЕЦ,
					|Основной.ГрафикРаботы.ДлительностьРабочейНедели,
					|Основной.БазовыйПериодНачало";
				КонецЕсли;
				//О.Т. Аверсон 04.02.2016 № 853
			иначе
				
				//Островская Татьяна 17.01.2013 № 16154
				ТекстЗапроса = ТекстЗапроса + "
				|СГРУППИРОВАТЬ ПО
				|Основной.Регистратор,
				|Основной.Сотрудник,
				|Основной.ВидРасчета,";
				если не ТипЗнч(Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда
					ТекстЗапроса = ТекстЗапроса + " ФизЛица.Регистратор,";
				КонецЕсли;
				//|Основной.НомерСтроки,
				ТекстЗапроса = ТекстЗапроса + " Основной.Сотрудник.Наименование,
				|Основной.Сотрудник.Физлицо,
				|Основной.ВидРасчета.Наименование,
				|Основной.ВидРасчета.СпособРасчета,
				|Основной.ВидРасчета.КодДоходаНДФЛ,
				|Основной.ВидУчетаВремени,
				|ЕСТЬNULL(СведенияОСкидках.КратностьВычета, 0),
				|ЕСТЬNULL(НДФЛСведенияОДоходахОбороты.СуммаВычетаОборот, 0),";
				Если ПериодРегистрации >= Дата(2016,07,01) и ПериодРегистрации <= Дата(2016,12,31) Тогда //О.Т. Аверсон 09.06.2016 № 1191
					ТекстЗапроса = ТекстЗапроса + "	
					|ЕСТЬNULL(НДФЛОбороты.СуммаВычетаОборот, 0) / 10000 + ЕСТЬNULL(НДФЛСведенияОДоходахОбороты.СуммаВычетаОборот, 0),";
				иначе  				
					ТекстЗапроса = ТекстЗапроса + "	
					|ЕСТЬNULL(НДФЛОбороты.СуммаВычетаОборот, 0),";
				КонецЕсли;
				ТекстЗапроса = ТекстЗапроса + " 
				|ЕСТЬNULL(СведенияОСкидках.Период, 0),
				|ЕСТЬNULL(СведенияОСкидках.НормативЗатрат, 0),
				|ВЫБОР
				|	КОГДА (Основной.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(перечисление.ВидыЗанятостиВОрганизации.Совместительство))";
				
				//Аверсон 06.04.2022 КВВ СВФР-008874 (
				Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.РегистрацияРазовыхНачисленийРаботниковОрганизаций") Тогда
					ТекстЗапроса = ТекстЗапроса + "
					|ИЛИ
					|(Основной.Сотрудник.ТипРаботника = ЗНАЧЕНИЕ(Перечисление.ТипыРаботников.ДоговорПодряда))";
				КонецЕсли;
				ТекстЗапроса = ТекстЗапроса + "
				//Аверсон 06.04.2022 КВВ СВФР-008874 )
				
				|		ТОГДА ЕСТЬNULL(СведенияОСкидках.ВычетНаСовместителя, 0)
				|	ИНАЧЕ ЕСТЬNULL(СведенияОСкидках.ГодовойВычет, 0)
				|КОНЕЦ //О.Т. Аверсон 08.12.2016 № 77";
				//Островская Татьяна 17.01.2013 № 16154
				//О.Т. Аверсон 04.02.2016 № 853
				Если НеобходимыеДанные.СреднийЗаработокОтпуска Тогда
					//Островская Татьяна 15.11.2012 № 15
					// выбираем ЧислоДнейВНеделе
					ТекстЗапроса = ТекстЗапроса + ", 
					|ВЫБОР КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке) ТОГДА 6 ИНАЧЕ 7 КОНЕЦ,
					|Основной.ГрафикРаботы.ДлительностьРабочейНедели,
					|Основной.БазовыйПериодНачало";
				КонецЕсли;
				//О.Т. Аверсон 04.02.2016 № 853
			КонецЕсли;
			
		КонецЕсли;
	ИначеЕсли 	ИмяРегистра = "УправленческиеНачисления" или 
		ИмяРегистра = "УправленческиеУдержания" Тогда 
		
		ТекстЗапроса = 
		"ВЫБРАТЬ 
		|Основной.Регистратор Как Регистратор,
		|Основной.НомерСтроки Как НомерСтроки,
		|Основной.Физлицо Как Сотрудник,
		|Основной.Физлицо.Наименование Как СотрудникНаименование, 
		|Основной.ВидРасчета Как ВидРасчета,
		|Основной.ВидРасчета.Наименование Как ВидРасчетаНаименование,
		|Основной.ВидРасчета.СпособРасчета Как СпособРасчета";
		
		Если КомментироватьРасчет Тогда
			ПоляЗапроса.Добавить("Сотрудник");
			ПоляЗапроса.Добавить("СотрудникНаименование");
			ПоляЗапроса.Добавить("Регистратор");//О.Т. Аверсон 18.04.2017 № 531
			ПоляЗапроса.Добавить("СпособРасчета");
			ПоляЗапроса.Добавить("ВидРасчета");
			ПоляЗапроса.Добавить("ВидРасчетаНаименование");
		КонецЕсли;
		
		Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
			
			Если КоличествоПоказателей = 0 Тогда
				ТекстЗапроса = ТекстЗапроса + ",
				| 0 КАК КоличествоПоказателей,";
			Иначе
				ТекстЗапроса = ТекстЗапроса + ",
				| Показатели.КоличествоПоказателей КАК КоличествоПоказателей,";
			КонецЕсли;
			
			ТекстЗапроса = ТекстЗапроса + "
			| Основной.ВидРасчета.ФормулаРасчета КАК ФормулаРасчета";
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("КоличествоПоказателей");
				ПоляЗапроса.Добавить("ФормулаРасчета");
			КонецЕсли;
			
			Для СчПоказателей = 1 По КоличествоПоказателей Цикл
				Если СчПоказателей > 6 Тогда					
					ПоказательТекст = СтрЗаменить(Показатель1ТекстПредопределенный, "Показатель1", "Показатель"+СчПоказателей);
				ИначеЕсли СчПоказателей > 1 Тогда
					ПоказательТекст = СтрЗаменить(Показатель1Текст, "Показатель1", "Показатель"+СчПоказателей);
				Иначе
					ПоказательТекст = Показатель1Текст;
				КонецЕсли;					
				
				ТекстЗапроса = ТекстЗапроса + ", 
				|Показатели.Показатель" + СчПоказателей+".Наименование Как Показатель" + СчПоказателей + "Наименование,
				|" + ПоказательТекст + " Как Показатель"+СчПоказателей;
				
				Если КомментироватьРасчет Тогда
					ПоляЗапроса.Добавить("Показатель" + СчПоказателей + "Наименование");
					ПоляЗапроса.Добавить("Показатель" + СчПоказателей);
				КонецЕсли;
			КонецЦикла;			
			
		КонецЕсли;
		
		Если ИмяРегистра = "УправленческиеНачисления" Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|Основной.ВидРасчета.ЗачетОтработанногоВремени Как ЗачетОтработанногоВремени,
			|Основной.ВидУчетаВремени Как ВидУчетаВремени";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ЗачетОтработанногоВремени");
				ПоляЗапроса.Добавить("ВидУчетаВремени");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.ОтработаноВремени Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ЕСТЬNULL(ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия, 0) КАК ОтработаноВремени,
			|	ЕСТЬNULL(ВЫБОР
			|			КОГДА Основной.ВидУчетаВремени = &ПоДням
			|				ТОГДА ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
			|			ИНАЧЕ ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
			|			КОНЕЦ, 0) КАК ОтработаноДней,
			|	ЕСТЬNULL(ВЫБОР	КОГДА Основной.ВидУчетаВремени = &ПоДням
			|		ТОГДА ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
			|		ИНАЧЕ ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
			|		КОНЕЦ, 0) КАК ОтработаноЧасов,
			|	ЕСТЬNULL(ДанныеГрафика.ПроизводственныйКалендарьПятидневкаЧасыФактическийПериодДействия,0) КАК ОтработаноЧасовПроизводственныйГрафик,
			|	ЕСТЬNULL(ДанныеГрафика.ПроизводственныйКалендарьПятидневкаФактическийПериодДействия, 0) КАК ОтработаноВремениПроизводственныйГрафик,
			|	ЕСТЬNULL(ВремяПоТабелю.ОтработаноЧасовПоТабелюОтклонение,0) КАК ОтработаноЧасовПоТабелюОтклонение";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОтработаноВремени");
				ПоляЗапроса.Добавить("ОтработаноДней");
				ПоляЗапроса.Добавить("ОтработаноЧасов");
				ПоляЗапроса.Добавить("ОтработаноВремениПроизводственныйГрафик");
				ПоляЗапроса.Добавить("ОтработаноЧасовПроизводственныйГрафик");
				//ПоляЗапроса.Добавить("ОтработаноЧасовПоТабелю");
				ПоляЗапроса.Добавить("ОтработаноЧасовПоТабелюОтклонение");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимаБаза Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|База.РезультатБаза";
		КонецЕсли;
		
		Если НеобходимГрафик Тогда
			ТекстЗапроса = ТекстЗапроса + ",
			|	ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ) КАК ОшибкаВводаИндивидуальногоГрафикаРаботы,
			|	ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ) КАК ОшибкаВводаОтработанногоВремени,
			|	ЛОЖЬ КАК ПредупреждениеНесоответствияТабеляИНачисления,
			|	Основной.ГрафикРаботы.Наименование КАК ГрафикРаботыНаименование";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ГрафикРаботыНаименование");
				ПоляЗапроса.Добавить("ОшибкаВводаИндивидуальногоГрафикаРаботы");
				ПоляЗапроса.Добавить("ОшибкаВводаОтработанногоВремени");
				ПоляЗапроса.Добавить("ПредупреждениеНесоответствияТабеляИНачисления");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.Стаж Тогда
			// стаж работы на предприятии
			ТекстЗапроса = ТекстЗапроса + ", 
			|РАЗНОСТЬДАТ(ДанныеОСтаже.Период, &ПериодРегистрации, МЕСЯЦ) КАК Стаж";			
			
		КонецЕсли;
		
		Если НеобходимыеДанные.СдельныйЗаработок Тогда
			// размер сдельного заработка
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ВЫБОР
			|		КОГДА ЕСТЬNULL(ДанныеОСдельномЗаработке.ОшибкаВводаФактическойВыработки, ЛОЖЬ)
			|			ТОГДА NULL
			|		ИНАЧЕ ДанныеОСдельномЗаработке.СуммаЗаработка 
			|	КОНЕЦ КАК РазмерСдельногоЗаработка,
			|ЕСТЬNULL(ДанныеОСдельномЗаработке.ОшибкаВводаФактическойВыработки, ЛОЖЬ) КАК ОшибкаВводаФактическойВыработки";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОшибкаВводаФактическойВыработки");
			КонецЕсли;
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса + "		
		|ИЗ РегистрРасчета." + ИмяРегистра + " Как Основной";
		
		Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
			Если КоличествоПоказателей > 0 Тогда
				ТекстЗапроса = ТекстЗапроса + "			
				|ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказатели КАК Показатели
				|ПО Показатели.ВидРасчета = Основной.ВидРасчета";
			КонецЕсли;
			Если ИмяРегистра = "УправленческиеНачисления" И НеобходимыеДанные.ВремяВКалендарныхДнях Тогда
				ТекстЗапроса = ТекстЗапроса + "
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.УправленческиеНачисления.ФактическийПериодДействия(Регистратор = &парамРегистратор) КАК ФактическийПериодДействия
				|ПО ФактическийПериодДействия.НомерСтроки = Основной.НомерСтроки";
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимаБаза Тогда
			// присоединяем к базе
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета." + ИмяРегистра + ".БазаУправленческиеНачисления(&парамИзмеренияОсновного, &парамИзмеренияБазового, , " + Условие + ") Как База
			|ПО База.Регистратор = Основной.Регистратор И База.НомерСтроки = Основной.НомерСтроки";
		КонецЕсли;
		
		Если НеобходимыеДанные.ВсегоОтработаноВремени Тогда
			
			Запрос.Текст = ФизлицаПериодыДействия;
			Запрос.Выполнить();
			
			Запрос.Текст = УпрВсегоОтработаноВремени;
			Запрос.Выполнить();
			
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТУпрВсегоОтработаноВремени КАК ВсегоОтработаноВремени
			|ПО Основной.НомерСтроки = ВсегоОтработаноВремени.НомерСтроки
			|";
			
		КонецЕсли;
		
		Если НеобходимГрафик Тогда
			Запрос.УстановитьПараметр("ПоДням", Перечисления.ВидыУчетаВремени.ПоДням);
			Запрос.УстановитьПараметр("ПоЧасам", Перечисления.ВидыУчетаВремени.ПоЧасам);
			Запрос.УстановитьПараметр("ПоВечернимЧасам", Перечисления.ВидыУчетаВремени.ПоВечернимЧасам);
			Запрос.УстановитьПараметр("ПоНочнымЧасам", Перечисления.ВидыУчетаВремени.ПоНочнымЧасам);
			Запрос.УстановитьПараметр("ПустойВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка());
			Запрос.УстановитьПараметр("ОтработанноеВПределахНормы", Перечисления.ВидыВремени.ОтработанноеВПределахНормы);
			Запрос.УстановитьПараметр("ЦелодневноеНеотработанное", Перечисления.ВидыВремени.ЦелодневноеНеотработанное);
			Запрос.УстановитьПараметр("ЧасовоеНеотработанное", Перечисления.ВидыВремени.ЧасовоеНеотработанное);
			Запрос.УстановитьПараметр("ЧасовоеОтработанноеВПределахНормы", Перечисления.ВидыВремени.ЧасовоеОтработанноеВПределахНормы);
			
			Запрос.Текст = УпрВремяПоТабелюТекст;
			Запрос.Выполнить();
			
			Запрос.Текст = УпрОтработаноПоВидуВремениДляПоказателейТекст;
			Запрос.Выполнить();
			
			Запрос.Текст = УпрСводныеИндивидуальныеГрафикиТекст;
			Запрос.Выполнить();
			
			Запрос.Текст = УпрВремяВведенноеВЦеломЗаПериодТекст;
			Запрос.Выполнить();
			
			// присоединяем к данным графика
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета." + ИмяРегистра + ".ДанныеГрафика(" + Условие +  ") Как ДанныеГрафика
			|ПО Основной.Регистратор = ДанныеГрафика.Регистратор И Основной.НомерСтроки = ДанныеГрафика.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТУпрВремяПоТабелю КАК ВремяПоТабелю
			|ПО Основной.НомерСтроки = ВремяПоТабелю.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТУпрСводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
			|ПО Основной.НомерСтроки = СводныеИндивидуальныеГрафики.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТУпрОтработаноПоВидуВремениДляПоказателей КАК ОтработаноПоВидуВремениНачисления
			|ПО Основной.НомерСтроки = ОтработаноПоВидуВремениНачисления.НомерСтроки
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТУпрВремяВведенноеВЦеломЗаПериод КАК ВремяВведенноеВЦеломЗаПериод
			|ПО Основной.НомерСтроки = ВремяВведенноеВЦеломЗаПериод.НомерСтроки
			|";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.Стаж Тогда
			// присоединение к данным о стаже
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Работники КАК ДанныеОСтаже
			|ПО ДанныеОСтаже.Физлицо = Основной.Физлицо
			|И	ДанныеОСтаже.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)";
			
			Запрос.УстановитьПараметр("ПериодРегистрации",	ПериодРегистрации);
		КонецЕсли;
		
		Если НеобходимыеДанные.СдельныйЗаработок Тогда
			
			Запрос.Текст = СдельныйЗаработокКомпанииТекст;
			Запрос.Выполнить();
			СдельныйЗаработокКомпанииТекст = "ВТСдельныйЗаработокКомпании";
			
			// присоединяем данные о сдельном заработке
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ "+СдельныйЗаработокКомпанииТекст+" КАК ДанныеОСдельномЗаработке
			|ПО Основной.НомерСтроки = ДанныеОСдельномЗаработке.ОсновнойНомерСтроки";
			
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса + "
		|ГДЕ " + ВнешнееУсловие;
		
		
	ИначеЕсли ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда
		
		ТекстЗапроса = 
		"ВЫБРАТЬ 
		|	Основной.Регистратор Как Регистратор, 
		|	Основной.НомерСтроки Как НомерСтроки, 
		|	Основной.Физлицо Как Сотрудник, 
		|	Основной.Физлицо.Наименование Как СотрудникНаименование, 
		|	Основной.ВидРасчета Как ВидРасчета,
		|	Истина Как ВидРасчетаПериодДействияБазовый,
		|	Основной.ВидРасчета.Наименование Как ВидРасчетаНаименование,
		|	Основной.ВидРасчета.СпособРасчета Как СпособРасчета";
		
		Если КомментироватьРасчет Тогда
			ПоляЗапроса.Добавить("Сотрудник");
			ПоляЗапроса.Добавить("СотрудникНаименование");
			ПоляЗапроса.Добавить("Регистратор");//О.Т. Аверсон 18.04.2017 № 531
			
			ПоляЗапроса.Добавить("ВидРасчета");
			ПоляЗапроса.Добавить("ВидРасчетаНаименование");
			ПоляЗапроса.Добавить("СпособРасчета");
			ПоляЗапроса.Добавить("ВидРасчетаПериодДействияБазовый");
		КонецЕсли;
		
		Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
			
			Если КоличествоПоказателей = 0 Тогда
				ТекстЗапроса = ТекстЗапроса + ",
				| 0 КАК КоличествоПоказателей,";
			Иначе
				ТекстЗапроса = ТекстЗапроса + ",
				| Показатели.КоличествоПоказателей КАК КоличествоПоказателей,";
			КонецЕсли;
			
			ТекстЗапроса = ТекстЗапроса + "
			| Основной.ВидРасчета.ФормулаРасчета КАК ФормулаРасчета";
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("КоличествоПоказателей");
				ПоляЗапроса.Добавить("ФормулаРасчета");
			КонецЕсли;
			
			Для СчПоказателей = 1 По КоличествоПоказателей Цикл
				Если СчПоказателей > 6 Тогда					
					ПоказательТекст = СтрЗаменить(Показатель1ТекстПредопределенный, "Показатель1", "Показатель"+СчПоказателей);
				ИначеЕсли СчПоказателей > 1 Тогда
					ПоказательТекст = СтрЗаменить(Показатель1Текст, "Показатель1", "Показатель"+СчПоказателей);
				Иначе
					ПоказательТекст = Показатель1Текст;
				КонецЕсли;					
				
				ТекстЗапроса = ТекстЗапроса + ", 
				|Показатели.Показатель" + СчПоказателей+".Наименование Как Показатель" + СчПоказателей + "Наименование,
				|" + ПоказательТекст + " Как Показатель"+СчПоказателей;
				
				Если КомментироватьРасчет Тогда
					ПоляЗапроса.Добавить("Показатель" + СчПоказателей + "Наименование");
					ПоляЗапроса.Добавить("Показатель" + СчПоказателей);
				КонецЕсли;
			КонецЦикла;			
			
		КонецЕсли;
		
		Если НеобходимыеДанные.ПределПоДокументуОснованию Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|	Основной.ДокументОснование.Предел Как ПределПоДокументуОснованию";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ПределПоДокументуОснованию");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимаБаза Тогда
			// если присоединяем к базе
			ТекстЗапроса = ТекстЗапроса + ",
			|	База.РезультатБаза КАК РезультатБаза";
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РезультатБаза");
			КонецЕсли;
			
		КонецЕсли;
		
		Если НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию Тогда
			// если присоединяем к базе
			ТекстЗапроса = ТекстЗапроса + ",
			|	НакопленныеДанные.УжеНачисленоВТекущемПериоде,
			|	НакопленныеДанные.УжеНачисленоЗаВсюИсторию";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("УжеНачисленоВТекущемПериоде");
				ПоляЗапроса.Добавить("УжеНачисленоЗаВсюИсторию");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.ИсчисленныйНДФЛ Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ИсчисленныйНДФЛ.ИсчисленныйНалог Как ИсчисленныйНалог";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ИсчисленныйНалог");
			КонецЕсли;
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработок Тогда
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ЕСТЬNULL(ДанныеДляРасчетаСреднего.ЧислоМесяцев,0) Как ЧислоМесяцев, 
			|	ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноДней,0) Как ОтработаноДнейПоСреднему, 
			|	ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноЧасов,0) Как ОтработаноЧасовПоСреднему,";
			
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда
				Если Регистратор.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу и ПериодСреднегоПоОкладу <> Неопределено Тогда
					ТекстЗапроса = ТекстЗапроса+ " 
					|ДанныеДляРасчетаСреднегоДляОклада.СреднийЗаработокДляОклада Как СреднийЗаработок,";
				иначе
					ТекстЗапроса = ТекстЗапроса+ " 
					|ДанныеДляРасчетаСреднего.СреднийЗаработок Как СреднийЗаработок,";
					
				КонецЕсли;
			иначе
				ТекстЗапроса = ТекстЗапроса+ " 
				|ДанныеДляРасчетаСреднего.СреднийЗаработок Как СреднийЗаработок,";
			КонецЕсли;
			ТекстЗапроса = ТекстЗапроса+ " 
			|	Основной.РучнойРасчетСреднегоЗаработка Как РучнойРасчетСреднегоЗаработка, 
			|	Основной.РазмерСреднегоЗаработка Как РазмерСреднегоЗаработка";
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ОтработаноДнейПоСреднему");
				ПоляЗапроса.Добавить("ОтработаноЧасовПоСреднему");
				ПоляЗапроса.Добавить("СреднийЗаработок");
			КонецЕсли;
			
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработокОтпуска Тогда
			// выбираем число дней по шестидневке или календарных рабочих дней 
			// из производственного календаря
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ВЫБОР КОГДА Основной.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке) ТОГДА 6 ИНАЧЕ 7 КОНЕЦ КАК ЧислоДнейВНеделе,
			|	Основной.ГрафикРаботы.ДлительностьРабочейНедели КАК ДлительностьРабочейНедели";
			
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("ЧислоДнейВНеделе");
				ПоляЗапроса.Добавить("ДлительностьРабочейНедели");
			КонецЕсли;
			
		КонецЕсли;
		
		Если НеобходимыеДанные.ПочтовыеПереводы Тогда
			//Аверсон-софт, Островская Татьяна 31.08.2012 № 15766
			ТекстЗапроса = ТекстЗапроса + ", 
			|	ПочтовыеПереводы.ДокументОснованиеСсылка Как ДокументОснованиеСсылка,
			|	ЕСТЬNULL(ПочтовыеПереводы.РазмерПочтовогоПеревода,0) Как РазмерПочтовогоПеревода";
			//Аверсон-софт, Островская Татьяна 31.08.2012 № 15766
			Если КомментироватьРасчет Тогда
				ПоляЗапроса.Добавить("РазмерПочтовогоПеревода");
			КонецЕсли;
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса + "
		|	ИЗ РегистрРасчета."+ИмяРегистра+" Как Основной";
		
		Если НеобходимыеДанные.ПоказателиСхемМотивации Тогда
			
			ТекстЗапроса = ТекстЗапроса + "			
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказатели КАК Показатели
			|ПО Показатели.ВидРасчета = Основной.ВидРасчета";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.Стаж Тогда
			// присоединение к данным о стаже
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ДанныеОСтаже			
			|ПО ДанныеОСтаже.Сотрудник.ФизЛицо = Основной.Физлицо
			|И	ДанныеОСтаже.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)";
			
			Запрос.УстановитьПараметр("ПериодРегистрации",	ПериодРегистрации);
		КонецЕсли;
		
		// если перерасчет - нужно сузить выборку 
		Если Перерасчет И Физлица = Неопределено Тогда
			// перерасчет по всем физлицам перерасчета
			ТекстЗапроса = ТекстЗапроса + "
			|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТФизлицаДляПерерасчета КАК ФизлицаДляПерерасчета
			|	ПО ФизлицаДляПерерасчета.Физлицо = Основной.Физлицо";
			
		КонецЕсли;
		
		Если НеобходимаБаза Тогда
			
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	Удержания.Регистратор КАК Регистратор,
			|	Удержания.НомерСтроки КАК НомерСтроки,
			|	Удержания.ФизЛицо,
			|	Удержания.ПериодРегистрации,
			|	Удержания.Организация,
			|	Удержания.БазовыйПериодНачало,
			|	БазовыеВидыРасчета.ВидРасчета,
			//+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			|	Удержания.ВидРасчета.УдержанияПоПериодамДействия 
			//+ СВЭЙ КДЯ 26.03.20 СВФР-005738
			//|   И НЕ ISNULL( УчетнаяПолитика.НеРазбиватьУдержанияПоПериодам, Ложь )
			//- СВЭЙ КДЯ 26.03.20 СВФР-005738
			|		КАК УдержанияПоПериодамДействия, 
			//- СВЭЙ КДЯ 22.11.19 СВФР-005096
			|	Удержания.ПорядокРасчетаБазы,
			|	Удержания.БазовыйПериодКонец,
			|	Удержания.Сотрудник //О.Т. Аверсон 06.03.2018 № 1693
			|ПОМЕСТИТЬ ВТ_ЗаписиУдержаний
			|ИЗ
			|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК Удержания
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.БазовыеВидыРасчета КАК БазовыеВидыРасчета
			|		ПО Удержания.ВидРасчета = БазовыеВидыРасчета.Ссылка
			//+ СВЭЙ КДЯ 26.03.20 СВФР-005738
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитика
			|		ПО УчетнаяПолитика.Организация = &парамОрганизация
			//- СВЭЙ КДЯ 26.03.20 СВФР-005738
			|ГДЕ
			|	Удержания.ВидРасчета.КатегорияНачисления = &парамКатегорияНачисления
			|	И Удержания.Регистратор = &парамРегистратор
			|	И Удержания.Авторасчет
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Регистратор,
			|	НомерСтроки";
			Запрос.Выполнить();
			
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	Удержания.Регистратор КАК Регистратор,
			|	Удержания.НомерСтроки КАК НомерСтроки,
			|	Удержания.ФизЛицо,
			|	Удержания.ПериодРегистрации КАК ПериодРегистрации,
			|	Удержания.Организация,
			|	Удержания.БазовыйПериодНачало,
			|	Удержания.ВидРасчета,
			//+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			|	Удержания.УдержанияПоПериодамДействия, 
			//- СВЭЙ КДЯ 22.11.19 СВФР-005096
			|	Удержания.ПорядокРасчетаБазы,
			|	Удержания.БазовыйПериодКонец,
			|	Удержания.Сотрудник КАК Сотрудник //О.Т. Аверсон 06.03.2018 № 1693
			|ПОМЕСТИТЬ ВТ_Удержания
			|ИЗ
			|	ВТ_ЗаписиУдержаний КАК Удержания
			//О.Т. Аверсон 06.03.2018 № 1693 убрано
			//|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
			//|		ПО Удержания.ФизЛицо = СотрудникиОрганизаций.Физлицо
			//|			И Удержания.Организация = СотрудникиОрганизаций.Организация
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	ПериодРегистрации,
			//+ СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть: упрощение и оптимизация запросов
			//|	Сотрудник
			//- СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть
			//+ СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть: упрощение и оптимизация запросов
			|	ФизЛицо
			//- СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть
			|";
			Запрос.Выполнить();
			
			//+ СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть: упрощение и оптимизация запросов
			//Запрос.Текст = "  //1 - Прием. Осн.
			//|ВЫБРАТЬ   
			//|	СУММА(База.РезультатБаза) КАК РезультатБаза,
			//|	База.Регистратор КАК Регистратор,
			//|	База.НомерСтроки КАК НомерСтроки
			//|ПОМЕСТИТЬ ВТБаза
			//|ИЗ
			//|	(
			//|	ВЫБРАТЬ
			//|		База.Результат КАК РезультатБаза,
			//|		Основной.Регистратор КАК Регистратор,
			//|		Основной.НомерСтроки КАК НомерСтроки
			//|	ИЗ
			//|		ВТ_Удержания КАК Основной
			//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК База
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			////|			ПО Основной.Сотрудник = База.Сотрудник
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//|			ПО Основной.ФизЛицо = База.ФизЛицо
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//|				И Основной.Организация = База.Организация
			////+ СВЭЙ КДЯ 22.11.19 СВФР-005096  1
			////|				И Основной.ПериодРегистрации = База.ПериодРегистрации
			////|				И Основной.БазовыйПериодНачало <= База.ПериодДействияНачало
			////- СВЭЙ КДЯ 22.11.19 СВФР-005096
			////+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			//|				И 
			//|				( НЕ Основной.УдержанияПоПериодамДействия
			//|					И Основной.ПериодРегистрации = База.ПериодРегистрации
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть: когда удержания не по периодам действия, смотрим только период регистрации
			////|					И Основной.БазовыйПериодНачало <= База.ПериодДействияНачало
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть
			//|					ИЛИ
			//|				  Основной.УдержанияПоПериодамДействия
			//|					И Основной.БазовыйПериодНачало <= База.ПериодДействияНачало
			//|					И Основной.БазовыйПериодКонец >= База.ПериодДействияКонец
			//|               )
			////- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//|				И (Основной.ВидРасчета = База.ВидРасчета)
			//|	ГДЕ
			//|		Основной.ПорядокРасчетаБазы = &парамПриПриемеНаРаботу
			//|		И База.ВидРасчета ЕСТЬ НЕ NULL 
			//|	
			//|	ОБЪЕДИНИТЬ ВСЕ   //2 - Прием. Доп.
			//|	
			//|	ВЫБРАТЬ       
			//|		База.Результат,
			//|		Основной.Регистратор,
			//|		Основной.НомерСтроки
			//|	ИЗ
			//|		ВТ_Удержания КАК Основной
			//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК База
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			////|			ПО Основной.Сотрудник = База.Сотрудник
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//|			ПО Основной.ФизЛицо = База.ФизЛицо
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//|				И Основной.Организация = База.Организация
			//|				И Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( База.ПериодРегистрации, МЕСЯЦ )
			//|				И Основной.БазовыйПериодНачало <= База.ПериодРегистрации
			//|				И (Основной.ВидРасчета = База.ВидРасчета)
			//|	ГДЕ
			//|		Основной.ПорядокРасчетаБазы = &парамПриПриемеНаРаботу
			//|		И База.ВидРасчета ЕСТЬ НЕ NULL 
			//|	
			//|	ОБЪЕДИНИТЬ ВСЕ   //3 - Увольн. Осн.
			//|	
			//|	ВЫБРАТЬ
			//|		База.Результат,
			//|		Основной.Регистратор,
			//|		Основной.НомерСтроки
			//|	ИЗ
			//|		ВТ_Удержания КАК Основной
			//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК База
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			////|			ПО Основной.Сотрудник = База.Сотрудник
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//|			ПО Основной.ФизЛицо = База.ФизЛицо
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//|				И Основной.Организация = База.Организация
			////+ СВЭЙ КДЯ 22.11.19 СВФР-005096  2
			////|				И Основной.ПериодРегистрации = База.ПериодРегистрации
			////|				И Основной.БазовыйПериодКонец >= База.ПериодДействияНачало
			////- СВЭЙ КДЯ 22.11.19 СВФР-005096
			////+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			//|				И 
			//|				( НЕ Основной.УдержанияПоПериодамДействия
			//|					И Основной.ПериодРегистрации = База.ПериодРегистрации
			//|					И Основной.БазовыйПериодКонец >= База.ПериодДействияНачало
			//|					ИЛИ
			//|				  Основной.УдержанияПоПериодамДействия
			//|					И Основной.БазовыйПериодНачало <= База.ПериодДействияНачало
			//|					И Основной.БазовыйПериодКонец >= База.ПериодДействияКонец
			//|               )
			////- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//|				И (Основной.ВидРасчета = База.ВидРасчета)
			//|	ГДЕ
			//|		Основной.ПорядокРасчетаБазы = &парамПриУвольнении
			//|		И База.ВидРасчета ЕСТЬ НЕ NULL 
			//|	
			//|	ОБЪЕДИНИТЬ ВСЕ   //4 - Увольн. Доп.
			//|	
			//|	ВЫБРАТЬ
			//|		База.Результат,
			//|		Основной.Регистратор,
			//|		Основной.НомерСтроки
			//|	ИЗ
			//|		ВТ_Удержания КАК Основной
			//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК База
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			////|			ПО Основной.Сотрудник = База.Сотрудник
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//|			ПО Основной.ФизЛицо = База.ФизЛицо
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//|				И Основной.Организация = База.Организация
			////+ СВЭЙ КДЯ 22.11.19 СВФР-005096  2
			////|				И Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( База.ПериодРегистрации, МЕСЯЦ )  // т.к. у дополнительных начислений период регистрации - это не всегда начало месяца
			////|				И Основной.БазовыйПериодКонец >= База.ПериодРегистрации
			////- СВЭЙ КДЯ 22.11.19 СВФР-005096
			////+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			//|				И 
			//|				( НЕ Основной.УдержанияПоПериодамДействия
			//|					И Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( База.ПериодРегистрации, МЕСЯЦ )  // т.к. у дополнительных начислений период регистрации - это не всегда начало месяца
			//|					И Основной.БазовыйПериодКонец >= База.БазовыйПериодНачало
			//|					ИЛИ
			//|				  Основной.УдержанияПоПериодамДействия
			//|					И Основной.БазовыйПериодНачало <= База.БазовыйПериодКонец
			//|					И Основной.БазовыйПериодКонец >= База.БазовыйПериодКонец
			//|               )
			////- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//|				И (Основной.ВидРасчета = База.ВидРасчета)
			//|	ГДЕ
			//|		Основной.ПорядокРасчетаБазы = &парамПриУвольнении
			//|		И База.ВидРасчета ЕСТЬ НЕ NULL 
			//|	
			//|	ОБЪЕДИНИТЬ ВСЕ ";
			//
			////О.Т. Аверсон 21.01.2017 Закоментировала доп выборку. профвзносы неправильно читались. суммма большая была 
			//
			////Если ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда //О.Т. Аверсон 03.01.2017 № 119
			////	Запрос.Текст = Запрос.Текст + " ВЫБРАТЬ
			////	|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.Результат) КАК Результат,
			////	|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор КАК Регистратор,
			////	|	УдержанияРаботниковОрганизаций.НомерСтроки КАК НомерСтроки
			////	|ИЗ
			////	|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизаций
			////	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.БазовыеВидыРасчета КАК УдержанияОрганизацийБазовыеВидыРасчета
			////	|		ПО (УдержанияОрганизацийБазовыеВидыРасчета.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
			////	|			И УдержанияРаботниковОрганизаций.ВидРасчета = УдержанияОрганизацийБазовыеВидыРасчета.Ссылка
			////	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			////	|		ПО (ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = УдержанияРаботниковОрганизаций.ФизЛицо)
			////	|			И (ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало = УдержанияРаботниковОрганизаций.БазовыйПериодНачало)
			////	|			И (ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец = УдержанияРаботниковОрганизаций.БазовыйПериодКонец)
			////	|			И (ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = УдержанияОрганизацийБазовыеВидыРасчета.ВидРасчета)
			////	|ГДЕ
			////	|	НЕ ОсновныеНачисленияРаботниковОрганизаций.Сторно
			////	|	И УдержанияРаботниковОрганизаций.Регистратор = &Регистратор
			////	|
			////	|СГРУППИРОВАТЬ ПО
			////	|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор,
			////	|	УдержанияРаботниковОрганизаций.НомерСтроки";	
			////иначе	
			//	
			//	//О.Т. Аверсон 10.04.2018 № 1408 вместо УНП
			//    ЗапросУП = Новый Запрос;
			//	ЗапросУП.Текст = 
			//		"ВЫБРАТЬ
			//		|	УчетнаяПолитикаПоПерсоналуОрганизаций.НеРазбиватьУдержанияПоПериодам
			//		|ИЗ
			//		|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
			//		|ГДЕ
			//		|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
			//	
			//	ЗапросУП.УстановитьПараметр("Организация", Организация);
			//	
			//	РезультатЗапросаУП = ЗапросУП.Выполнить().Выбрать();
			//	НеРазбиватьУдержанияПоПериодам = Ложь;
			//	Пока РезультатЗапросаУП.Следующий() Цикл
			//		НеРазбиватьУдержанияПоПериодам = РезультатЗапросаУП.НеРазбиватьУдержанияПоПериодам;
			//	КонецЦикла;  //О.Т. Аверсон 10.04.2018 № 1408
			
			//	//О.Т. Аверсон 09.03.2017 № 385 2 часть профвзносы. Когда у сотрудника есть кадровое. Базу не разбивает, а бралась за весь месяц на каждую строку
			//	Запрос.Текст = Запрос.Текст + 
			//	 "ВЫБРАТЬ    //5 - Перемещ. Осн. без будущего отпуска
			//	 |	База.Результат,
			//	 |	Основной.Регистратор,
			//	 |	Основной.НомерСтроки
			//	 |ИЗ
			//	 |	ВТ_Удержания КАК Основной
			//	 |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК База
			//	 //+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//	 //|	ПО Основной.Сотрудник = База.Сотрудник
			//	 //- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//	 //+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//	 |		ПО Основной.ФизЛицо = База.ФизЛицо
			//	 //- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//	 |			И Основной.Организация = База.Организация
			//	 //+ СВЭЙ КДЯ 22.11.19 СВФР-005096  3
			//	 //|		И Основной.ПериодРегистрации = База.ПериодРегистрации
			//	 //- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//	 //+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			//	 |			И 
			//	 |			( НЕ Основной.УдержанияПоПериодамДействия
			//	 |				И Основной.ПериодРегистрации = База.ПериодРегистрации
			//	 |				ИЛИ
			//	 |			  Основной.УдержанияПоПериодамДействия
			//	 |			    И Основной.БазовыйПериодНачало <= База.ПериодДействияНачало
			//	 |				И Основной.БазовыйПериодКонец >= База.ПериодДействияКонец
			//	 |           )
			//	 //- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//	 |			И Основной.ВидРасчета = База.ВидРасчета
			//	 |			И ВЫБОР КОГДА База.ВидРасчета.СпособРасчета = &СпособРасчетаОтпуска ТОГДА НЕ Основной.БазовыйПериодКонец < База.ПериодДействияНачало ИНАЧЕ ИСТИНА КОНЕЦ"; //О.Т. Аверсон 06.02.2018 № 1532 следующий кусок кода отвечается за буд отпуск
			//	 
			//	 Если не НеРазбиватьУдержанияПоПериодам Тогда //О.Т. Аверсон 10.04.2018 № 1408
			//		 Запрос.Текст = Запрос.Текст + "  					 
			//		 //+ СВЭЙ КДЯ 29.11.19 СВФР-004909
			//		 //|	И База.ПериодДействияНачало между Основной.БазовыйПериодНачало И Основной.БазовыйПериодКонец";
			//		 //- СВЭЙ КДЯ 29.11.19 СВФР-004909
			//		 //+ СВЭЙ КДЯ 29.11.19 СВФР-004909
			//		 |	И ( База.БазовыйПериодНачало МЕЖДУ НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ ) И Основной.БазовыйПериодКонец
			//		 |		ИЛИ База.ПериодДействияНачало МЕЖДУ НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ ) И Основной.БазовыйПериодКонец )";
			//		 //- СВЭЙ КДЯ 29.11.19 СВФР-004909
			//	 иначе
			//		 Запрос.Текст = Запрос.Текст + "
			//		 //+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			//		 //|	И База.ПериодРегистрации между НачалоПериода(Основной.БазовыйПериодНачало, месяц) И Основной.БазовыйПериодКонец
			//		 //- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//		 //+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			//		 |	И ( Основной.УдержанияПоПериодамДействия
			//		 |		ИЛИ База.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ ) И Основной.БазовыйПериодКонец )
			//		 //- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//		 |"; //О.Т. Аверсон 05.01.2018 № 1408 Изменено на период регистрации. В базу не попадал прошлый месяц в тек месяце ☻
			//	 КонецЕсли;
			//	 Запрос.Текст = Запрос.Текст + "
			
			//	 |ГДЕ
			//	 |	База.ВидРасчета ЕСТЬ НЕ NULL 
			//	 |И НЕ Основной.ПорядокРасчетаБазы = &парамПриПриемеНаРаботу
			//	 |И НЕ Основной.ПорядокРасчетаБазы = &парамПриУвольнении " ;
			
			//	 
			//	//Павличев СВФР-000859 07.08.2017
			//	Запрос.Текст = Запрос.Текст + "
			//	 |	ОБЪЕДИНИТЬ ВСЕ  //6 - Перемещ. Осн. Будущий Отпуск.
			//	 |
			//	 |ВЫБРАТЬ
			//	 |	База.Результат,
			//	 |	Основной.Регистратор,
			//	 |	Основной.НомерСтроки
			//	 |ИЗ
			//	 |	ВТ_Удержания КАК Основной
			//	 |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК База
			//	 //+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//	 //|	ПО Основной.Сотрудник = База.Сотрудник
			//	 //- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//	 //+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//	 |		ПО Основной.ФизЛицо = База.ФизЛицо
			//	 //- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//	 |			И Основной.Организация = База.Организация
			//	 //+ СВЭЙ КДЯ 22.11.19 СВФР-005096  4
			//	 //|		И Основной.ПериодРегистрации = База.ПериодРегистрации
			//	 //- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//	 //+ СВЭЙ КДЯ 22.11.19 СВФР-005096
			//	 |			И 
			//	 |			( НЕ Основной.УдержанияПоПериодамДействия
			//	 |				И Основной.ПериодРегистрации = База.ПериодРегистрации
			//	 |				ИЛИ
			//	 |			  Основной.УдержанияПоПериодамДействия
			//	 |			    И Основной.БазовыйПериодНачало <= База.ПериодДействияНачало
			//	 |				И Основной.БазовыйПериодКонец >= База.ПериодДействияКонец
			//	 |           )
			//	 //- СВЭЙ КДЯ 22.11.19 СВФР-005096
			//	 |			И Основной.ВидРасчета = База.ВидРасчета
			//	 |			И Основной.БазовыйПериодКонец < База.ПериодДействияНачало
			//	 |ГДЕ
			//	 |	База.ВидРасчета ЕСТЬ НЕ NULL 
			//	 |И НЕ Основной.ПорядокРасчетаБазы = &парамПриПриемеНаРаботу
			//	 |И НЕ Основной.ПорядокРасчетаБазы = &парамПриУвольнении 
			//	 |И База.ВидРасчета.СпособРасчета = &СпособРасчетаОтпуска" ;
			//	 
			//	// |	
			//	//|	ВЫБРАТЬ
			//	//|		База1.РезультатБаза,
			//	//|		База1.Регистратор,
			//	//|		База1.НомерСтроки
			//	//|	ИЗ
			//	//|		РегистрРасчета.УдержанияРаботниковОрганизаций.БазаОсновныеНачисленияРаботниковОрганизаций(
			//	//|				&парамИзмеренияОсновного,
			//	//|				&парамИзмеренияБазового,
			//	//|				&парамРазрезы,
			//	//|				 " + Условие + "
			//	//|					И ПорядокРасчетаБазы = &парамЗаВесьПериод) КАК База1
			//	//|	ГДЕ
			//	//|		((НЕ База1.Сторно)
			//	//|				ИЛИ База1.ПериодРегистрацииРазрез < База1.ПериодРегистрации)
			//	//|		И База1.ДатаНачалаСобытияРазрез между База1.БазовыйПериодНачало И База1.БазовыйПериодКонец
			//	//|		//И РегистраторРазрез1 //Островская Татьяна 12.05.2014 № 17307
			//	//|";
			////КонецЕсли;
			//
			////О.Т. Аверсон 26.06.2018 № 1992
			//Запрос.Текст = Запрос.Текст + 
			//"
			//|	ОБЪЕДИНИТЬ ВСЕ  //7 - Перемещ. Доп. без будущего отпуска
			//|
			//|  			
			//|ВЫБРАТЬ
			//|	База.Результат,
			//|	Основной.Регистратор,
			//|	Основной.НомерСтроки
			//|ИЗ
			//|	ВТ_Удержания КАК Основной
			//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК База
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			////|		ПО Основной.Сотрудник = База.Сотрудник
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//|		ПО Основной.ФизЛицо = База.ФизЛицо
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//|			И Основной.Организация = База.Организация
			////(начало) закомментировано Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
			////|			И Основной.ПериодРегистрации = База.ПериодРегистрации
			////(конец) закомментировано Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
			////(начало) добавлено Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
			//|			И Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( База.ПериодРегистрации, МЕСЯЦ )
			////(конец) добавлено Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
			//|			И Основной.ВидРасчета = База.ВидРасчета
			//|			И Выбор когда База.ВидРасчета.СпособРасчета = &СпособРасчетаОтпуска тогда  не Основной.БазовыйПериодКонец < База.БазовыйПериодНачало иначе истина конец"; //О.Т. Аверсон 06.02.2018 № 1532 следующий кусок кода отвечается за буд отпуск
			//
			//
			////не учтен флаг "УдержанияПоПериодамДействия"
			//Если не НеРазбиватьУдержанияПоПериодам Тогда //О.Т. Аверсон 10.04.2018 № 1408
			//	Запрос.Текст = Запрос.Текст + "  					 
			//	//+ СВЭЙ КДЯ 29.11.19 СВФР-004909
			//	//|	И База.БазовыйПериодНачало между Основной.БазовыйПериодНачало И Основной.БазовыйПериодКонец";
			//	//- СВЭЙ КДЯ 29.11.19 СВФР-004909
			//	//+ СВЭЙ КДЯ 29.11.19 СВФР-004909
			//	|	И База.БазовыйПериодНачало МЕЖДУ НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ ) И Основной.БазовыйПериодКонец";
			//	//- СВЭЙ КДЯ 29.11.19 СВФР-004909
			//иначе
			//	Запрос.Текст = Запрос.Текст + "					 
			//	|	И База.ПериодРегистрации между НачалоПериода(Основной.БазовыйПериодНачало, месяц) И Основной.БазовыйПериодКонец"; //О.Т. Аверсон 05.01.2018 № 1408 Изменено на период регистрации. В базу не попадал прошлый месяц в тек месяце ☻
			//КонецЕсли;
			//Запрос.Текст = Запрос.Текст + "
			//
			//|ГДЕ
			//|	База.ВидРасчета ЕСТЬ НЕ NULL 
			//|И НЕ Основной.ПорядокРасчетаБазы = &парамПриПриемеНаРаботу
			//|И НЕ Основной.ПорядокРасчетаБазы = &парамПриУвольнении " ;
			//
			//
			//Запрос.Текст = Запрос.Текст + "
			//|	ОБЪЕДИНИТЬ ВСЕ    //8 - Перемещ. Доп. Будущий отпуск.
			//|
			//|ВЫБРАТЬ
			//|	База.Результат,
			//|	Основной.Регистратор,
			//|	Основной.НомерСтроки
			//|ИЗ
			//|	ВТ_Удержания КАК Основной
			//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК База
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			////|		ПО Основной.Сотрудник = База.Сотрудник
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			////+ СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть: соединяемся по физ.лицу, чтобы учесть вн. совместителей
			//|		ПО Основной.ФизЛицо = База.ФизЛицо
			////- СВЭЙ КДЯ 26.03.20 СВФР-005738 2 часть
			//|			И Основной.Организация = База.Организация
			////(начало) закомментировано Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
			////|			И Основной.ПериодРегистрации = База.ПериодРегистрации
			////(конец) закомментировано Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
			////(начало) добавлено Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
			//|			И Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( База.ПериодРегистрации, МЕСЯЦ )
			////(конец) добавлено Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
			//|			И Основной.ВидРасчета = База.ВидРасчета
			//|			И Основной.БазовыйПериодКонец < База.БазовыйПериодНачало
			//|ГДЕ
			//|	База.ВидРасчета ЕСТЬ НЕ NULL 
			//|И НЕ Основной.ПорядокРасчетаБазы = &парамПриПриемеНаРаботу
			//|И НЕ Основной.ПорядокРасчетаБазы = &парамПриУвольнении 
			//|И База.ВидРасчета.СпособРасчета = &СпособРасчетаОтпуска" ;
			////О.Т. Аверсон 26.06.2018 № 1992 Убран запрос ниже и добавлен новый, чтоб по доп начислениям делался профвзнос по внутренним и основным
			////     |
			////     |
			////     V
			//Запрос.Текст = Запрос.Текст + "
			////|	ОБЪЕДИНИТЬ ВСЕ
			////|	
			////|	ВЫБРАТЬ
			////|		База2.РезультатБаза,
			////|		База2.Регистратор,
			////|		База2.НомерСтроки
			////|	ИЗ
			////|		РегистрРасчета.УдержанияРаботниковОрганизаций.БазаДополнительныеНачисленияРаботниковОрганизаций(
			////|				&парамИзмеренияОсновного,
			////|				&парамИзмеренияБазового,
			////|				&парамРазрезы,
			////|				 " + Условие + "
			////|					И ПорядокРасчетаБазы = &парамЗаВесьПериод) КАК База2
			////|	ГДЕ
			////|		((НЕ База2.Сторно)
			////|				ИЛИ База2.ПериодРегистрацииРазрез < База2.ПериодРегистрации)
			////|		//И РегистраторРазрез2
			//|	) КАК База //Островская Татьяна 12.05.2014 № 17307
			//|СГРУППИРОВАТЬ ПО
			//|	База.Регистратор,
			//|	База.НомерСтроки";
			//- СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть
			
			
			//+ СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть: оптимизация запросов
			Запрос.Текст = "
			|ВЫБРАТЬ   
			|	СУММА( База.РезультатБаза ) КАК РезультатБаза,
			|	База.Регистратор КАК Регистратор,
			|	База.НомерСтроки КАК НомерСтроки
			|ПОМЕСТИТЬ ВТБаза
			|ИЗ
			|	(
			|	ВЫБРАТЬ
			|		База.Результат КАК РезультатБаза,
			|		Основной.Регистратор КАК Регистратор,
			|		Основной.НомерСтроки КАК НомерСтроки
			|	ИЗ
			|		ВТ_Удержания КАК Основной
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК База
			|			ПО Основной.ФизЛицо = База.ФизЛицо
			|				И Основной.Организация = База.Организация
			|				И 
			|				( НЕ Основной.УдержанияПоПериодамДействия
			|					И Основной.ПериодРегистрации = База.ПериодРегистрации
			|					ИЛИ
			|				  Основной.УдержанияПоПериодамДействия
			|					И ( Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ )
			|						И Основной.БазовыйПериодНачало <= База.ПериодДействияКонец
			|						И База.ПериодДействияНачало <= Основной.БазовыйПериодКонец 
			| 						И База.ПериодРегистрации <= Основной.ПериодРегистрации   //Аверсон 03.08.2020 КВВ СВФР-006354
			|						ИЛИ 
			|						Основной.ПериодРегистрации > НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ ) // если это прошедший период действия
			|						И Основной.ПериодРегистрации = База.ПериодРегистрации                             // то учитываем базу, зарегистрированную только в текущем периоде 
			|						И Основной.БазовыйПериодНачало <= База.ПериодДействияКонец
			|						И База.ПериодДействияНачало <= Основной.БазовыйПериодКонец
			|                     )
			|               )
			|				И Основной.ВидРасчета = База.ВидРасчета
			|	
			|	ОБЪЕДИНИТЬ ВСЕ			
			|	
			|	ВЫБРАТЬ       
			|		База.Результат,
			|		Основной.Регистратор,
			|		Основной.НомерСтроки
			|	ИЗ
			|		ВТ_Удержания КАК Основной
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК База
			|			ПО Основной.ФизЛицо = База.ФизЛицо
			|				И Основной.Организация = База.Организация
			|				И 
			|				( НЕ Основной.УдержанияПоПериодамДействия
			|					И Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( База.ПериодРегистрации, МЕСЯЦ )  // т.к. у дополнительных начислений период регистрации - это не всегда начало месяца
			|					ИЛИ
			|				  Основной.УдержанияПоПериодамДействия
			|					И ( Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ )
			|						И Основной.БазовыйПериодНачало <= База.БазовыйПериодКонец
			|						И База.БазовыйПериодНачало <= Основной.БазовыйПериодКонец 
			|						ИЛИ 
			|						Основной.ПериодРегистрации > НАЧАЛОПЕРИОДА( Основной.БазовыйПериодНачало, МЕСЯЦ ) // если это прошедший период действия
			|						И Основной.ПериодРегистрации = НАЧАЛОПЕРИОДА( База.ПериодРегистрации, МЕСЯЦ )     // то учитываем базу, зарегистрированную только в текущем периоде 
			|						И Основной.БазовыйПериодНачало <= База.БазовыйПериодКонец
			|						И База.БазовыйПериодНачало <= Основной.БазовыйПериодКонец
			|                     )
			|               )
			|				И Основной.ВидРасчета = База.ВидРасчета
			|
			|	) КАК База
			|
			|СГРУППИРОВАТЬ ПО
			|	База.Регистратор,
			|	База.НомерСтроки
			|";
			//- СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть
			
			
			
			
			
			//Островская Татьяна 12.05.2014 № 17307
			если Организация.ИНН = "100765738" Тогда 
				если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаЗамещенияСотрудников") Тогда 
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","И База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","И База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
				иначе
					если ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда
						Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
						Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
					иначе
						Если КатегорияНачисления = Справочники.КатегорииРасчетов.НайтиПоНаименованию("Зависимое третьего уровня") Тогда 
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
						иначе
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","И не База1.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
							Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","И не База2.РегистраторРазрез ССЫЛКА Документ.ОплатаЗамещенияСотрудников");
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
			иначе
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез1","");
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РегистраторРазрез2","");
			КонецЕсли;
			//Островская Татьяна 12.05.2014 № 17307
			Разрезы = Новый Массив;
			Разрезы.Добавить("ПериодРегистрации");
			если Организация.ИНН = "100765738" Тогда
				Разрезы.Добавить("Регистратор");
			КонецЕсли;
			Запрос.УстановитьПараметр("Регистратор", Регистратор);//О.Т. Аверсон 03.01.2017 № 119
			Запрос.УстановитьПараметр("парамРазрезы", Разрезы);
			Запрос.УстановитьПараметр("парамПриПриемеНаРаботу", Перечисления.ПорядокРасчетаБазы.ПриПриемеНаРаботу);
			Запрос.УстановитьПараметр("парамПриУвольнении", Перечисления.ПорядокРасчетаБазы.ПриУвольнении);
			Запрос.УстановитьПараметр("парамЗаВесьПериод", Перечисления.ПорядокРасчетаБазы.ЗаВесьПериод);
			Запрос.УстановитьПараметр("СпособРасчетаОтпуска", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
			
			Запрос.Выполнить();
			
			ТекстЗапроса = ТекстЗапроса + "
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТБаза Как База
			|		ПО База.Регистратор = Основной.Регистратор И База.НомерСтроки = Основной.НомерСтроки
			|";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию Тогда
			Запрос.Текст = НакопленныеДанныеТекст;
			Запрос.Выполнить();
			
			// присоединяем сводные данные по документу основанию
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТНакопленныеДанные КАК НакопленныеДанные
			|ПО 
			|	НакопленныеДанные.Физлицо = Основной.Физлицо
			|	И НакопленныеДанные.ВидРасчета = Основной.ВидРасчета
			|	И НакопленныеДанные.ДокументОснование = Основной.ДокументОснование";
			//ПСА 20-01-2021 СВФР-007089+++
			Если ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда
				ТекстЗапроса = ТекстЗапроса + "
				|	И НакопленныеДанные.БазовыйПериодНачало = Основной.БазовыйПериодНачало";
			КонецЕсли;	
			//+++ПСА 20-01-2021 СВФР-007089
		КонецЕсли;
		
		
		Если НеобходимыеДанные.ИсчисленныйНДФЛ Тогда
			МассивУдержанийИЛ = Новый Массив;
			МассивУдержанийИЛ.Добавить(ПланыВидовРасчета.УдержанияОрганизаций.ИЛПроцентом);
			МассивУдержанийИЛ.Добавить(ПланыВидовРасчета.УдержанияОрганизаций.ИЛПроцентомБезБЛ);
			МассивУдержанийИЛ.Добавить(ПланыВидовРасчета.УдержанияОрганизаций.ИЛПроцентомДоПредела);
			МассивУдержанийИЛ.Добавить(ПланыВидовРасчета.УдержанияОрганизаций.ИЛПроцентомДоПределаБезБЛ);
			МассивУдержанийИЛ.Добавить(ПланыВидовРасчета.УдержанияОрганизаций.ИЛФиксированнойСуммой);
			МассивУдержанийИЛ.Добавить(ПланыВидовРасчета.УдержанияОрганизаций.ИЛФиксированнойСуммойДоПредела);
			
			
			Запрос.УстановитьПараметр("парамМассивУдержанийИЛ", МассивУдержанийИЛ);
			Запрос.УстановитьПараметр("CпособРасчетаИсполнительный",Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом);
			Запрос.УстановитьПараметр("CпособРасчетаИсполнительныйДоПредела",Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела);
			Запрос.УстановитьПараметр("CпособРасчетаИсполнительныйФиксСуммой",Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела);
			//О.Т. Аверсон 24.05.2017 № 665
			Запрос.УстановитьПараметр("CпособРасчетаИсполнительныйБезПНИПФДоПредела",Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела);
			Запрос.УстановитьПараметр("CпособРасчетаИсполнительныйБезПНИПФ",Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ);
			Запрос.УстановитьПараметр("CпособРасчетаИсполнительныйБезПНИПФДоПределаФикс",Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой);
			Запрос.УстановитьПараметр("CпособРасчетаИсполнительныйБезПНИПФФикс",Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой);
			//О.Т. Аверсон 24.05.2017 № 665
			
			Запрос.УстановитьПараметр("парамВидСтроки", Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
			Запрос.УстановитьПараметр("парамСтавка35", Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка35);
			
			Запрос.Текст = ИсчисленныйНДФЛТекст;
			Запрос.Выполнить();
			
			// присоединяем данные по исчисленному НДФЛ
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТИсчисленныйНДФЛ КАК ИсчисленныйНДФЛ
			|ПО Основной.НомерСтроки = ИсчисленныйНДФЛ.НомерСтроки";
			
		КонецЕсли;
		
		Если НеобходимыеДанные.СреднийЗаработок Тогда
			
			//ОсновнойЗаработок = Новый Массив(3);
			//ОсновнойЗаработок[0] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку;
			//ОсновнойЗаработок[1] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
			//ОсновнойЗаработок[2] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуИндексируемые;
			//ПоФиксПремиям = Новый Массив(2);
			//ПоФиксПремиям[0] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
			//ПоФиксПремиям[1] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямБЛ;
			//ПоПремиям = Новый Массив(4);
			//ПоПремиям[0] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям;
			//ПоПремиям[1] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямБЛ;
			//ПоПремиям[2] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямИндексируемые;
			//ПоПремиям[3] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииИндексируемые;
			//ПоФиксПремиямНеИндексируемые = Новый Массив(4);
			//ПоФиксПремиямНеИндексируемые[0] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремии;
			//ПоФиксПремиямНеИндексируемые[1] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииБЛ;
			//ПоФиксПремиямНеИндексируемые[2] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииНеИндексируемые;
			//ПоФиксПремиямНеИндексируемые[3] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямНеИндексируемые;
			//
			//Запрос.УстановитьПараметр("ОсновнойЗаработок", ОсновнойЗаработок); // Основной заработок индексируемый
			//Запрос.УстановитьПараметр("ОсновнойЗаработокНеиндексируемый", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые);
			//Запрос.УстановитьПараметр("ПоПремиям", ПоПремиям);  // Премии полностью учитываемые, индексируемые
			//Запрос.УстановитьПараметр("ПоФиксПремиям", ПоФиксПремиям); // Премии учитываемые частично, индексируемые
			//Запрос.УстановитьПараметр("ПоФиксПремиямНеИндексируемые", ПоФиксПремиямНеИндексируемые); // Премии учитываемые частично, не индексируемые
			//
			//// для реализации Федеральных законов:
			////	от 22.12.2005 г. № 180-ФЗ и от 29 декабря 2006 г. № 255-ФЗ - по больничным листам
			////	от 5 декабря 2006 г. № 207-ФЗ - по отпуску по уходу за детьми
			//// при расчете пособий заработок учитывается по всем местам работы
			//
			//Запрос.УстановитьПараметр("ОсновнойЗаработокПособий", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуПособий);
			//
			//СоставляющиеСреднегоЗаработкаПособий = Новый Массив(5);
			//СоставляющиеСреднегоЗаработкаПособий.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуПособий);
			//СоставляющиеСреднегоЗаработкаПособий.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПособий);
			//СоставляющиеСреднегоЗаработкаПособий.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямПособий);
			//СоставляющиеСреднегоЗаработкаПособий.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииПособий);
			//СоставляющиеСреднегоЗаработкаПособий.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииПособий);
			
			//СоставляющиеПрочихСреднихЗаработков = Новый Массив(18);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуИндексируемые);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиямИндексируемые);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиямНеИндексируемые);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииИндексируемые);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииНеИндексируемые);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямНеИндексируемые);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииНеИндексируемые);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремии);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиямБЛ);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямБЛ);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииБЛ);
			//СоставляющиеПрочихСреднихЗаработков.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииБЛ);
			
			//Запрос.УстановитьПараметр("СоставляющиеСреднегоЗаработкаПособий", СоставляющиеСреднегоЗаработкаПособий);
			//Запрос.УстановитьПараметр("СоставляющиеПрочихСреднихЗаработков", СоставляющиеПрочихСреднихЗаработков);
			//О.Т. Аверсон 12.04.2019 № 4189
			ЭтоАгент = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				ЭтоАгент = Регистратор.Агент;
			КонецЕсли;
			//О.Т. Аверсон 12.04.2019 № 4189
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			НеполныйМесяц = Ложь;
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
				НеполныйМесяц = Регистратор.РасчетПриНеполныхМесяцах;
			КонецЕсли;
			//Аверсон СВФР-009668
			
			Запрос.УстановитьПараметр("ПоЗаработку", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
			Запрос.УстановитьПараметр("ПоЗаработкуИнд", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые));
			Запрос.УстановитьПараметр("ПоЗаработкуИндСред", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеСред); //О.Т. Аверсон 06.07.2016 № 855
			Запрос.УстановитьПараметр("ПоЗаработкуБЛ", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
			
			//Аверсон ЕАЕ 17.10.2022 СВФР-009668
			//Запрос.УстановитьПараметр("ПоЗаработкуОтпуск", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск));//О.Т. Аверсон 16.04.2019 № 4189
			Запрос.УстановитьПараметр("ПоЗаработкуОтпуск", ?(ЭтоАгент,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент,?(НеполныйМесяц,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах,ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск)));
			//Аверсон СВФР-009668
			
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда  //О.Т. Аверсон 23.06.2016 № 1267
				Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему);
			иначе     				
				Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
			КонецЕсли;
			Запрос.УстановитьПараметр("ПоФиксПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
			
			ПоСреднемуЗаработкуФСС = Новый Массив(2);
			ПоСреднемуЗаработкуФСС[0] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС;
			//ПоСреднемуЗаработкуФСС[1] = Перечисления.СпособыРасчетаОплатыТруда.ПособиеПоУходуЗаРебенкомДо1_5Лет;
			Запрос.УстановитьПараметр("ПоСреднемуЗаработкуФСС", ПоСреднемуЗаработкуФСС);
			
			Запрос.Текст = ДанныеОСреднемЗаработкеТекст;
			Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу",ПериодСреднегоПоОкладу); //О.Т. 17.02.2015 № 334
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
				Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу1",НачалоМесяца(Регистратор.ДатаНачала)); //О.Т. 17.02.2015 № 334
			иначе
				Запрос.УстановитьПараметр("ПериодСреднегоПоОкладу1",ПериодСреднегоПоОкладу);
			КонецЕсли;
			
			Запрос.Выполнить();
			ДанныеОСреднемЗаработкеТекст = "ВТДанныеОСреднемЗаработке";
			
			Запрос.Текст = ДанныеОСреднемЗаработкеДляОкладаТекст;
			Запрос.Выполнить();
			ДанныеОСреднемЗаработкеДляОкладаТекст = "ВТДанныеОСреднемЗаработкеДляОклада";
			
			
			// присоединяем данные для расчета среднего заработка
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ "+ДанныеОСреднемЗаработкеТекст+" КАК ДанныеДляРасчетаСреднего
			|ПО Основной.Сотрудник = ДанныеДляРасчетаСреднего.Сотрудник И 
			|Основной.ВидРасчета.СпособРасчета = ДанныеДляРасчетаСреднего.СпособРасчета И 
			|Основной.ДатаНачалаСобытия = ДанныеДляРасчетаСреднего.ДатаНачалаСобытия И 
			|Основной.ПериодРасчетаСреднегоЗаработкаНачало = ДанныеДляРасчетаСреднего.ДатаНачалаРасчетногоПериода И 
			|Основной.ПериодРасчетаСреднегоЗаработкаОкончание = ДанныеДляРасчетаСреднего.ДатаОкончанияРасчетногоПериода";
			//О.Т. Аверсон 28.02.2017 № 215
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ "+ДанныеОСреднемЗаработкеДляОкладаТекст+" КАК ДанныеДляРасчетаСреднегоДляОклада
			|ПО Основной.Сотрудник = ДанныеДляРасчетаСреднегоДляОклада.Сотрудник И 
			|Основной.ВидРасчета.СпособРасчета = ДанныеДляРасчетаСреднегоДляОклада.СпособРасчета И 
			|Основной.ДатаНачалаСобытия = ДанныеДляРасчетаСреднегоДляОклада.ДатаНачалаСобытия И 
			|Основной.ПериодРасчетаСреднегоЗаработкаНачало = ДанныеДляРасчетаСреднегоДляОклада.ДатаНачалаРасчетногоПериода И 
			|Основной.ПериодРасчетаСреднегоЗаработкаОкончание = ДанныеДляРасчетаСреднегоДляОклада.ДатаОкончанияРасчетногоПериода";
			//О.Т. Аверсон 28.02.2017 № 215
			
			
		КонецЕсли;
		
		Если НеобходимыеДанные.ПочтовыеПереводы Тогда
			//Аверсон-софт, Островская Татьяна 31.08.2012 № 15766
			ПочтовыеПереводыТекст = 
			"ВЫБРАТЬ
			|	Основная.ФизЛицо,
			|	Основная.Организация,
			|	Основная.ДокументОснование,
			|	СУММА(Дополнительная.Результат) КАК РазмерПочтовогоПеревода,
			|	Основная.ДокументОснование.Ссылка
			|ИЗ
			|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК Основная
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.УдержанияРаботниковОрганизаций КАК Дополнительная
			|		ПО Основная.ПериодРегистрации = Дополнительная.ПериодРегистрации
			|			И Основная.ФизЛицо = Дополнительная.ФизЛицо
			|			И Основная.Организация = Дополнительная.Организация
			|			И Основная.ДокументОснование = Дополнительная.ДокументОснование
			|			И Основная.ВидРасчета <> Дополнительная.ВидРасчета
			|ГДЕ
			|	Основная.Регистратор = &парамРегистратор
			|	И Основная.ВидРасчета.СпособРасчета = &СпособРасчетаПочтовыйСбор
			|
			|СГРУППИРОВАТЬ ПО
			|	Основная.ФизЛицо,
			|	Основная.Организация,
			|	Основная.ДокументОснование,
			|	Дополнительная.ДокументОснование.Ссылка";
			//Аверсон-софт, Островская Татьяна 31.08.2012 № 15766
			// присоединяем данные для расчета почтового перевода
			ТекстЗапроса = ТекстЗапроса + "
			|ЛЕВОЕ СОЕДИНЕНИЕ ("+ПочтовыеПереводыТекст+") КАК ПочтовыеПереводы
			|ПО Основной.Физлицо = ПочтовыеПереводы.Физлицо И
			|Основной.Организация = ПочтовыеПереводы.Организация И
			|Основной.ДокументОснование = ПочтовыеПереводы.ДокументОснование";
			
			Запрос.УстановитьПараметр("СпособРасчетаПочтовыйСбор", Перечисления.СпособыРасчетаОплатыТруда.ПочтовыйСбор);
			
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса + "
		|ГДЕ " + ВнешнееУсловие;
		
	КонецЕсли;
	//Островская Татьяна 17.01.2013 № 16154
	//Если не НеобходимыеДанные.ВычетыКДоходамНДФЛ Тогда
	//О.Т. 13.10.2014 № 17616
	//Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда 
	//	ТекстЗапроса = ТекстЗапроса + "
	//	|СГРУППИРОВАТЬ ПО
	//	|ДанныеДляРасчетаСреднего.НомерДоговора,
	//	|ДанныеДляРасчетаСреднего.ДатаДоговора,
	//	|Основной.Регистратор,
	//	|Основной.Сотрудник,
	//	|Основной.ВидРасчета,
	//	|Основной.ВидУчетаВремени,
	//	|Основной.РучнойРасчетСреднегоЗаработка,
	//	|ДанныеДляРасчетаСреднего.ЧислоМесяцев,
	//	|ДанныеДляРасчетаСреднего.СреднийЗаработок,
	//	|Основной.НомерСтроки,
	//	|Основной.Сотрудник.Наименование,
	//	|Основной.Сотрудник.Физлицо,
	//	|Основной.ВидРасчета.Наименование,
	//	|Основной.ВидРасчета.СпособРасчета,
	//	|Основной.ВидРасчета.КодДоходаНДФЛ,
	//	|Основной.РазмерСреднегоЗаработка,
	//	|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноДней, 0),
	//	|ЕСТЬNULL(ДанныеДляРасчетаСреднего.ОтработаноЧасов, 0)";
	//	
	//	//	|УПОРЯДОЧИТЬ ПО ВложенныйЗапрос.НомерСтроки";
	//КонецЕсли;
	
	
	
	ТекстЗапроса = ТекстЗапроса + "
	|УПОРЯДОЧИТЬ ПО НомерСтроки";
	//О.Т. 13.10.2014 № 17616
	//КонецЕсли;
	//Островская Татьяна 17.01.2013 № 16154
	Если НеобходимаБаза И КомментироватьРасчет Тогда
		ТекстЗапроса = ТекстЗапроса + "
		|ИТОГИ";
		Для Каждого Поле Из ПоляЗапроса Цикл
			ТекстЗапроса = ТекстЗапроса + "
			|	МАКСИМУМ(" + Поле + "),"
		КонецЦикла;
		ТекстЗапроса = ТекстЗапроса + "
		|	СУММА(РезультатБаза)
		|ПО
		|	НомерСтроки";
	КонецЕсли;
	//Островская Татьяна 18.02.2014 № 17126
	ЗапросСтавка1Разряда = 
	"ВЫБРАТЬ
	|	ТарифныеСтавкиПервогоРазрядаОрганизаций.Период,
	|	ТарифныеСтавкиПервогоРазрядаОрганизаций.ТарифнаяСтавка,
	|	ТарифныеСтавкиПервогоРазрядаОрганизаций.Размер,
	|	РаботникиОрганизацийСрезПоследних.Сотрудник
	|ПОМЕСТИТЬ ставки
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийСрезПоследних
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций КАК ТарифныеСтавкиПервогоРазрядаОрганизаций
	|		ПО РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда = ТарифныеСтавкиПервогоРазрядаОрганизаций.ТарифнаяСтавка
	|ГДЕ
	|	ЕСТЬNULL(ТарифныеСтавкиПервогоРазрядаОрганизаций.Период, 0) <> 0
	|
	|СГРУППИРОВАТЬ ПО
	|	ТарифныеСтавкиПервогоРазрядаОрганизаций.ТарифнаяСтавка,
	|	РаботникиОрганизацийСрезПоследних.Сотрудник,
	|	ТарифныеСтавкиПервогоРазрядаОрганизаций.Период,
	|	ТарифныеСтавкиПервогоРазрядаОрганизаций.Размер";
	Запрос.Текст = ЗапросСтавка1Разряда;
	Запрос.Выполнить();
	//Островская Татьяна 18.02.2014 № 17126
	
	
	Запрос.Текст = ТекстЗапроса;
	
	//Островская Татьяна 13.03.2014 № 17148
	если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда 
		если Регистратор.Организация.ИНН = "100765738" Тогда 
			сч = 1;
			ТЗИсходныеДанные = Новый ТаблицаЗначений;
			ТЗИсходныеДанные = Запрос.Выполнить().Выгрузить();
			если ТЗИсходныеДанные.Количество()>0 Тогда 
				для Каждого стрОтпуск из Регистратор.Отпуска Цикл 
					если стрОтпуск.ФлагИстина Тогда
						если сч = 1 Тогда 
							СтрокаЗаполнения = ТЗИсходныеДанные[0];
							
						КонецЕсли;
						сч = сч+1;
						МассивСтрок = ТЗИсходныеДанные.НайтиСтроки(Новый Структура("ВидРасчета", стрОтпуск.ВидОтпуска.ВидРасчета));
						если МассивСтрок.Количество()=0 Тогда 
							если стрОтпуск.ВидОтпуска.ВидРасчета.КатегорияНачисления = КатегорияНачисления Тогда 
								СтрокаТЗ = ТЗИсходныеДанные.Добавить();
								ЗаполнитьЗначенияСвойств(СтрокаТЗ,СтрокаЗаполнения);
								СтрокаТЗ.ВидРасчета = стрОтпуск.ВидОтпуска.ВидРасчета;
								СтрокаТЗ.ВидРасчетаНаименование = стрОтпуск.ВидОтпуска.ВидРасчета.Наименование;
								СтрокаТЗ.НомерСтроки = стрОтпуск.НомерСтроки;
								Дней = 0;
								ОбщегоНазначения.РазобратьРазностьДат(стрОтпуск.ДатаОкончания, стрОтпуск.ДатаНачала,,, Дней);
								СтрокаТЗ.ОплачиваемыеДниОтпуска = Дней+1;
								СтрокаТЗ.ОтработаноВремениПроизводственныйГрафик = Дней+1;		
								СтрокаТЗ.ОтработаноДней = Дней+1;
								СтрокаТЗ.ПериодДействияНачало = стрОтпуск.ДатаНачала;
								СтрокаТЗ.ПериодДействияКонец = стрОтпуск.ДатаОкончания;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			
			Запрос = Новый Запрос;
			Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
			Запрос.Текст =  
			"Выбрать
			|*
			|ПОМЕСТИТЬ ВТСтрокиЗапроса 
			|из &Таблица как Табл";
			Запрос.УстановитьПараметр("Таблица",ТЗИсходныеДанные);
			Запрос.Выполнить();	 
			
			запрос.Текст = 
			"выбрать
			|*
			|из ВТСтрокиЗапроса как ТЗ";
			Запрос.Выполнить();
			
			
		КонецЕсли;
		
	КонецЕсли;
	#Если Клиент Тогда
		ОбработкаПрерыванияПользователя();
	#КонецЕсли
	//Островская Татьяна 13.03.2014 № 17148
	
	//Аверсон ЕАЕ 28.02.2022 СВФР-008796
	Если ТипЗнч(РеальныйРегистратор) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") 
		И ЗначениеЗаполнено(РеальныйРегистратор) И ЗначениеЗаполнено(Регистратор)
		И РеальныйРегистратор <> Регистратор Тогда
		Запрос.УстановитьПараметр("парамРегистратор", РеальныйРегистратор);
	КонецЕсли;
	//Аверсон СВФР-008796
	
	РезультатЗапроса = Запрос.Выполнить();
	Возврат РезультатЗапроса.Выбрать( ОбходРезультатаЗапроса.ПоГруппировкам );
	
КонецФункции //ПолучитьДанныеДляРасчета()

//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
Функция ПолучитьРеквизитПервичного( Документ, ИмяРеквизита ) Экспорт
	Перем ПервичныйДокумент, РеквизитПервичного;
	
	ПервичныйДокумент = Документ;
	Если ТипЗнч( Документ.Ссылка ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда" ) Тогда //Аверсон 22.08.2023 КВВ СВФР-011258 (пункт 1) (.Ссылка)
		Пока ЗначениеЗаполнено( ПервичныйДокумент.ПервичныйБольничныйЛист ) Цикл
			ПервичныйДокумент = ПервичныйДокумент.ПервичныйБольничныйЛист;	
		КонецЦикла; 
	КонецЕсли;
	РеквизитПервичного = ПервичныйДокумент[ ИмяРеквизита ];
	
	Возврат РеквизитПервичного;
КонецФункции // ПолучитьРеквизитПервичного()

//- СВЭЙ КДЯ 01.10.19 СВФР-004756


// Рассчитывает записи из переданного набора записей
//
// Параметры:
//	ИмяРегистра				- имя регистра, чьи записи будут рассчитаны
//	НаборЗаписейРегистра	- набор записей, которые надо рассчитать
//	ЗаписиДоходыНДФЛ		- набор записей регистра накопления с доходами НДФЛ
//							  Передается только для случаев расчета набора записей - начислений
//	НаборЗаписейРасчетСреднего
//	ГоловнаяОрганизация
//	ОбособленноеПодразделение
//	ТабличнаяЧастьДокумента
//	ОднократныйРасчетСреднего	- будево. Если Истина, то при расчете выполняется 
//								  однократный расчет среднего в не зависимости от количесвта различных 
//								  категорий видов расчета в наборе записей
//  ПовторныйРасчет
//  КатегорияДоначисления
//  СведенияОДоначислениях
//  КурсВалютыУпрУчета
//  МассивИндексыСтрокТабличнойЧасти	- массив с индексами строк табличного поля, для реализации
//										  расчета по одному сотруднику	
//	Физлицо								- ссылка Справочники.ФизическиеЛица, для реализации
//										  расчета по одному сотруднику	
//
// Возвращаемое значение:
//	Нет.
//
Процедура РассчитатьЗаписиРегистраРасчета(ИмяРегистра, 
	НаборЗаписейРегистра, 
	ЗаписиДоходыНДФЛ = Неопределено,
	НаборЗаписейРасчетСреднего = Неопределено,
	ГоловнаяОрганизация = Неопределено,
	ОбособленноеПодразделение = Неопределено,
	ТабличнаяЧастьДокумента = Неопределено,
	ОднократныйРасчетСреднего = Ложь,
	ПовторныйРасчет = Ложь,
	КатегорияДоначисления = Неопределено,
	СведенияОДоначислениях = Неопределено,
	КурсВалютыУпрУчета = Неопределено,
	МассивИндексыСтрокТабличнойЧасти = Неопределено,
	Физлицо = Неопределено,
	КомментироватьРасчет = Ложь, ФормаКомментариев = НеОпределено,Пересчет = Ложь,ПервыйПоОкладу = Ложь,ПериодСреднегоПоОкладу = Неопределено,ТекЗначение = Неопределено) Экспорт //Островская Татьяна 30.05.2014 № 17397,334
	
	Если НаборЗаписейРегистра.Количество() = 0 Тогда
		Возврат;
	КонецЕсли;
	// здесь предполагаем, что в наборе записей не может быть записей с разными периодами регистрации
	ПериодРегистрации = НаборЗаписейРегистра[0].ПериодРегистрации;
	
	Регистратор = НаборЗаписейРегистра.Отбор.Регистратор.Значение;
	
	//Регистратор = НаборЗаписейРегистра.Отбор.Регистратор.Значение;
	ИмяПВР = Метаданные.РегистрыРасчета[ИмяРегистра].ПланВидовРасчета.Имя;
	
	СчитатьСреднийЗаработок = Истина;
	
	Если	ИмяРегистра = "ОсновныеНачисленияРаботниковОрганизаций" или
		ИмяРегистра = "ДополнительныеНачисленияРаботниковОрганизаций" или
		ИмяРегистра = "УдержанияРаботниковОрганизаций" или
		ИмяРегистра = "УправленческиеНачисления" или
		ИмяРегистра = "УправленческиеУдержания" Тогда
		
		// получим массив видов расчета из набора записей
		//Островская Татьяна 27.12.2012 № 15
		
		ТаблицаВидовРасчета = НаборЗаписейРегистра.Выгрузить();
		ТаблицаВидовРасчета.Свернуть("ВидРасчета");
		ВидыРасчетов = ТаблицаВидовРасчета.ВыгрузитьКолонку("ВидРасчета");
		
		// Получим максимальное число показателей			
		ЗапросНаКоличествоПоказателей = Новый Запрос(
		"ВЫБРАТЬ
		|	ЕСТЬNULL(МАКСИМУМ(НачисленияПоказатели.НомерСтроки),0) КАК КолВоПоказателей
		|ИЗ");
		Если ИмяРегистра = "ОсновныеНачисленияРаботниковОрганизаций" Тогда
			ЗапросНаКоличествоПоказателей.Текст = ЗапросНаКоличествоПоказателей.Текст + "
			|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК НачисленияПоказатели";
		ИначеЕсли ИмяРегистра = "ДополнительныеНачисленияРаботниковОрганизаций" Тогда 
			ЗапросНаКоличествоПоказателей.Текст = ЗапросНаКоличествоПоказателей.Текст + "
			|	ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК НачисленияПоказатели";
		ИначеЕсли ИмяРегистра = "УдержанияРаботниковОрганизаций" Тогда 		
			ЗапросНаКоличествоПоказателей.Текст = ЗапросНаКоличествоПоказателей.Текст + "
			|	ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК НачисленияПоказатели";
		ИначеЕсли ИмяРегистра = "УправленческиеНачисления" Тогда 		
			ЗапросНаКоличествоПоказателей.Текст = ЗапросНаКоличествоПоказателей.Текст + "
			|	ПланВидовРасчета.УправленческиеНачисления.Показатели КАК НачисленияПоказатели";
		ИначеЕсли ИмяРегистра = "УправленческиеУдержания" Тогда 		
			ЗапросНаКоличествоПоказателей.Текст = ЗапросНаКоличествоПоказателей.Текст + "
			|	ПланВидовРасчета.УправленческиеУдержания.Показатели КАК НачисленияПоказатели";
		КонецЕсли;
		ВыборкаКоличестваПоказателей = ЗапросНаКоличествоПоказателей.Выполнить().Выбрать();
		ВыборкаКоличестваПоказателей.Следующий();
		КоличествоПоказателей = ВыборкаКоличестваПоказателей.КолВоПоказателей;
		
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	КатегорияНачисления,"
		+ ?(ИмяПВР = "ОсновныеНачисленияОрганизаций",
		"
		|	ЗачетНормыВремени,
		|	ПериодДействияБазовый,","")
		+ ?(ИмяПВР = "ДополнительныеНачисленияОрганизаций",
		"
		|	ВЫБОР КОГДА КодыДоходаСВычетами.КодДохода ЕСТЬ NULL ТОГДА Ложь ИНАЧЕ Истина КОНЕЦ Как РасчетВычетов,","") + "
		|	ПВР.Ссылка КАК Ссылка1");		
		Для СчПоказателей = 1 По КоличествоПоказателей Цикл
			Если СчПоказателей = 1 Тогда
				Запрос.Текст = Запрос.Текст + ",";
			КонецЕсли;
			Запрос.Текст = Запрос.Текст + "
			|	ВЫБОР
			|		КОГДА ТЧПоказатели.НомерСтроки = "+ СчПоказателей+"
			|			ТОГДА 
			|				ВЫБОР
			|					КОГДА ТЧПоказатели.Показатель.Предопределенный
			|						ТОГДА ТЧПоказатели.Показатель
			|					ИНАЧЕ NULL
			|				КОНЕЦ				
			|		ИНАЧЕ NULL
			|	КОНЕЦ КАК Показатель" + СчПоказателей;
			Если СчПоказателей<КоличествоПоказателей Тогда
				Запрос.Текст = Запрос.Текст + ","
			КонецЕсли;
		КонецЦикла;
		Если ИмяПВР = "ОсновныеНачисленияОрганизаций" Или ИмяПВР = "УправленческиеНачисления" Тогда
			Запрос.Текст = Запрос.Текст + ",
			|	ЗачетОтработанногоВремени";
		КонецЕсли;
		Запрос.Текст = Запрос.Текст + ",
		|	ПВР.СпособРасчета Как СпособРасчета
		|ИЗ	
		|	ПланВидовРасчета."+ИмяПВР + " КАК ПВР";
		Если КоличествоПоказателей > 0 Тогда
			Запрос.Текст = Запрос.Текст + "
			|	ЛЕВОЕ СОЕДИНЕНИЕ  ПланВидовРасчета."+ИмяПВР+".Показатели КАК ТЧПоказатели
			|	ПО ПВР.Ссылка = ТЧПоказатели.Ссылка";
		КонецЕсли;
		Запрос.Текст = Запрос.Текст 
		+ ?(ИмяПВР = "ДополнительныеНачисленияОрганизаций",
		"
		|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ КодДохода Из РегистрСведений.НДФЛВычетыПоДоходам) Как КодыДоходаСВычетами
		|ПО КодДоходаНДФЛ = КодыДоходаСВычетами.КодДохода
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		|	И КодДоходаНДФЛ <> ЗНАЧЕНИЕ( Справочник.ДоходыНДФЛ.ПустаяСсылка )
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		|","")
		+ "
		|ГДЕ ПВР.Ссылка В(&парамВидыРасчетов)
		|УПОРЯДОЧИТЬ ПО
		|	КатегорияНачисления.Код
		|
		|ИТОГИ ПО КатегорияНачисления";
		
		Запрос.УстановитьПараметр("парамВидыРасчетов", ВидыРасчетов);
		
		
		// получаем список категороий и способов расчета
		ВыборкаКатегорий = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		БудетДоначислениеПоУпрУчету = Ложь;
		Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|   1 КАК Поле1
		|ИЗ
		|   ПланВидовРасчета." + ИмяПВР + " КАК ПВР
		|ГДЕ
		|   ПВР.Ссылка В(&парамВидыРасчетов)
		|   И ПВР.СпособРасчета = &Доначисление";
		
		Запрос.УстановитьПараметр("Доначисление", Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету);
		
		Если Не Запрос.Выполнить().Пустой() Тогда
			
			БудетДоначислениеПоУпрУчету = Истина;
		КонецЕсли;
		
		// первая запись набора делается с пересчетом Фактического периода действия
		ТолькоЗапись = Ложь;
		
		Если ИмяРегистра = "ДополнительныеНачисленияРаботниковОрганизаций" Тогда
			ЗапросПоВычетам = Новый Запрос
		КонецЕсли;
		
		Если Не(Физлицо = Неопределено) Тогда
			Физлица = Новый Массив();
			Физлица.Добавить(Физлицо);
		Иначе
			Физлица = Неопределено;
		КонецЕсли;
		
		
		Пока ВыборкаКатегорий.Следующий() Цикл
			
			// Поддержка способа расчета ДоначислениеПоУправленческомуУчету
			// пропустим категории "младше" категории в которой выполняется доначисление
			Если ПовторныйРасчет и КатегорияДоначисления <> Неопределено и ОбщегоНазначения.СравнениеПеречислений(ВыборкаКатегорий.КатегорияНачисления, КатегорияДоначисления) < 0 Тогда
				Продолжить;
			КонецЕсли;
			
			// Получим структуру необходимых данных для расчетов текущей категории
			МассивСпособовРасчета	= Новый Массив;	// Массив способов расчета текущий категории
			МассивПоказателей		= Новый Массив;	// Массив видов показателей схем мотивации
			НормаВремени			= Ложь;			// Признак необходимости получения нормы времени для видов расчета
			ОтработаноВремени		= Ложь;			// Признак необходимости получения отработанного времени для видов расчета
			РасчетВычетов			= Ложь;			// Признак необходимости расчета вычетов к доходам
			НеобходимБазовыйПериод	= Ложь;			// Признак необходимости базового периода
			
			ВложеннаяВыборка = ВыборкаКатегорий.Выбрать();
			Пока ВложеннаяВыборка.Следующий() Цикл
				МассивСпособовРасчета.Добавить(ВложеннаяВыборка.СпособРасчета);
				
				Для Сч = 1 По КоличествоПоказателей Цикл
					Если ВложеннаяВыборка["Показатель"+Сч] <> Null Тогда
						МассивПоказателей.Добавить(ВложеннаяВыборка["Показатель"+Сч]);
					КонецЕсли;
				КонецЦикла;
				
				Если ИмяПВР = "ОсновныеНачисленияОрганизаций" Тогда
					
					НормаВремени			= НормаВремени ИЛИ ВложеннаяВыборка.ЗачетНормыВремени;
					ОтработаноВремени		= ОтработаноВремени ИЛИ ВложеннаяВыборка.ЗачетОтработанногоВремени ИЛИ ВложеннаяВыборка.ЗачетНормыВремени;
					НеобходимБазовыйПериод	= НеобходимБазовыйПериод ИЛИ (НЕ ВложеннаяВыборка.ПериодДействияБазовый);
				КонецЕсли;
				
				Если ИмяПВР = "ДополнительныеНачисленияОрганизаций" Тогда
					РасчетВычетов = РасчетВычетов ИЛИ ВложеннаяВыборка.РасчетВычетов;
				КонецЕсли;
				
				Если ИмяПВР = "УправленческиеНачисления" Тогда					
					ОтработаноВремени = ОтработаноВремени ИЛИ ВложеннаяВыборка.ЗачетОтработанногоВремени;
				КонецЕсли;
				
			КонецЦикла;
			
			НеобходимыеДанные = ПолучитьСтруктуруНеобходимыхДанных(МассивСпособовРасчета, МассивПоказателей);
			НеобходимыеДанные.НормаВремени			= НеобходимыеДанные.НормаВремени ИЛИ НормаВремени;
			НеобходимыеДанные.ОтработаноВремени		= НеобходимыеДанные.ОтработаноВремени ИЛИ ОтработаноВремени;
			НеобходимыеДанные.ВычетыКДоходамНДФЛ	= РасчетВычетов;
			
			Если Не НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию Тогда
				НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию = ИмяРегистра = "УдержанияРаботниковОрганизаций" И НеобходимыеДанные.База
			КонецЕсли;
			
			Если НеобходимыеДанные.База Тогда
				НеобходимыеДанные.НормаВремениЗаМесяц	= НеобходимыеДанные.НормаВремениЗаМесяц ИЛИ НеобходимБазовыйПериод;
				НеобходимыеДанные.ОтработаноВремени		= НеобходимыеДанные.ОтработаноВремени ИЛИ НеобходимБазовыйПериод;
			КонецЕсли;
			
			Если ИмяПВР = "ОсновныеНачисленияОрганизаций" Или ИмяПВР = "УправленческиеНачисления" Тогда
				НеобходимыеДанные.НормаВремениЗаМесяц = Истина; // для предотвращения ложных сообщений об отсутствии графика
			КонецЕсли;
			
			// записываем набор перед расчетом каждой категории начислений
			НаборЗаписейРегистра.Записать(Истина, ТолькоЗапись);
			
			//О.Т. Аверсон 01.02.2017 № 235
			Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") и ТабличнаяЧастьДокумента <> Неопределено и ТолькоЗапись = Ложь Тогда 
				Если ИмяРегистра = "ОсновныеНачисленияРаботниковОрганизаций" Тогда 
					ПараметрыОтбора = Новый Структура;
					ПараметрыОтбора.Вставить("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные); 
					
					МассивРаботавшихВПраздники = ТабличнаяЧастьДокумента.НайтиСтроки(ПараметрыОтбора) ;
					Для Каждого Стр из МассивРаботавшихВПраздники Цикл 
						НаборЗаписейРегистра.Отбор.Сотрудник.Значение = Стр.Сотрудник; 
						НаборЗаписейРегистра.Отбор.Сотрудник.Использование = Истина;
						
						НаборЗаписейРегистра.Прочитать();
						Для Каждого стрРег из НаборЗаписейРегистра Цикл 
							Если стрРег.ВидРасчета = Стр.ВидРасчета и стрРег.ПериодДействияНачало = Стр.ДатаНачала Тогда 
								стрРег.Результат = Стр.Результат;
								стрРег.ОплаченоДней = Стр.ОплаченоДней;
								стрРег.ОплаченоДнейЧасов = Стр.ОплаченоДнейЧасов;
							КонецЕсли;
							
						КонецЦикла;
						
						
					КонецЦикла;
					//НаборЗаписейРегистра.Записать(Истина, ТолькоЗапись);
					НаборЗаписейРегистра.Отбор.Сотрудник.Значение = Справочники.СотрудникиОрганизаций.ПустаяСсылка(); 
					НаборЗаписейРегистра.Отбор.Сотрудник.Использование = Ложь;
					НаборЗаписейРегистра.Прочитать();
					НаборЗаписейРегистра.Записать(Истина, ТолькоЗапись);
				КонецЕсли;
				
			КонецЕсли;
			//О.Т. Аверсон 01.02.2017 № 235
			
			
			ТолькоЗапись = Истина;
			
			// если нужны данные для расчета среднего заработка
			Если СчитатьСреднийЗаработок И (НеобходимыеДанные.СреднийЗаработок ИЛИ НеобходимыеДанные.СреднийЗаработокОтпуска) И (НаборЗаписейРасчетСреднего <> Неопределено) Тогда
				
				СформироватьИЗаписатьДанныеРасчетаСреднего(ИмяРегистра, Регистратор, НаборЗаписейРасчетСреднего, КомментироватьРасчет,,,Пересчет);//Островская Татьяна 30.05.2014 № 17397
				Если ОднократныйРасчетСреднего Тогда
					СчитатьСреднийЗаработок = Ложь;
					
				КонецЕсли;
				
			КонецЕсли;
			если не ПервыйПоОкладу Тогда
				
				//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
				//ИсходныеДанные = ПолучитьДанныеДляРасчета( ИмяРегистра, ВыборкаКатегорий.КатегорияНачисления, НеобходимыеДанные,
				//	 Регистратор, ГоловнаяОрганизация, ПериодРегистрации, , Физлица, КомментироватьРасчет, , ПериодСреднегоПоОкладу, ТекЗначение ); //О.Т. 18.02.2015 № 334
				//- СВЭЙ КДЯ 01.10.19 СВФР-004756
				
				//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
				ИсходныеДанные = ПолучитьДанныеДляРасчета( ИмяРегистра, ВыборкаКатегорий.КатегорияНачисления, НеобходимыеДанные,
				ПолучитьРеквизитПервичного( Регистратор, "Ссылка" ), 
				ГоловнаяОрганизация, ПолучитьРеквизитПервичного( Регистратор, "ПериодРегистрации" ), , Физлица, КомментироватьРасчет, , ПериодСреднегоПоОкладу, ТекЗначение, Регистратор ); //О.Т. 18.02.2015 № 334 //Аверсон 13.01.2022 КВВ СВФР-008577 (Регистратор)
				//- СВЭЙ КДЯ 01.10.19 СВФР-004756
				
				
				// Поддержка способа расчета ДоначислениеПоУправленческомуУчету
				// если необходимо прогнозировать НДФЛ
				Если НеобходимыеДанные.ДанныеДляПрогнозаНДФЛ Тогда
					Если не ПовторныйРасчет Тогда
						// Составим текст запроса для выбора списка физлиц, по которым надо считать НДФЛ
						СписокФизлицТекст = 
						"ВЫБРАТЬ РАЗЛИЧНЫЕ
						|	Работники.ФизЛицо КАК Физлицо
						|ИЗ
						|	Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК Работники
						|ГДЕ
						|	Работники.Ссылка = &парамРегистратор";
						
						ДанныеДляПрогнозаНДФЛ = ДанныеДляПрогнозаНДФЛ(ПериодРегистрации, ГоловнаяОрганизация, Регистратор, СписокФизЛицТекст);
					КонецЕсли;
					КатегорияДоначисления = ВыборкаКатегорий.КатегорияНачисления;
				КонецЕсли;
				РассчитатьЗаписиНабора(ИсходныеДанные, НаборЗаписейРегистра, НеобходимыеДанные, ЗаписиДоходыНДФЛ, ГоловнаяОрганизация, ОбособленноеПодразделение, ТабличнаяЧастьДокумента, ДанныеДляПрогнозаНДФЛ, СведенияОДоначислениях, КурсВалютыУпрУчета, ПовторныйРасчет, МассивИндексыСтрокТабличнойЧасти, КомментироватьРасчет, ФормаКомментариев,НаборЗаписейРасчетСреднего,ТекЗначение);
				Если НеобходимыеДанные.ДанныеДляПрогнозаНДФЛ И ЗаписиДоходыНДФЛ <> НеОпределено Тогда
					// запись набора записей доходов НДФЛ
					// необходимо для расчета ДоначислениеПоУправленческомуУчету
					ЗаписиДоходыНДФЛ.Записать();
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры // РассчитатьЗаписиРегистраРасчета

// Перерассчитывает записи из переданного набора записей
//
// Параметры: 
//  ИмяРегистра			 - имя регистра, чьи записи будут рассчитаны
//  НаборЗаписейРегистра - набор записей, которые надо рассчитать
//	Физлица - массив физлиц для перерасчета
//	ЗаписиДоходыНДФЛ - набор записей доходов НДФЛ
//	НаборЗаписейРасчетСреднего - набор записей расчета среднего заработка
//	Организация - организацция
//	ТабличнаяЧастьДокумента - табличная часть документа по которой ведется перерасчет
//
// Возвращаемое значение:
//  Нет.
//
Процедура ПереРассчитатьЗаписиРегистраРасчета(	ИмяРегистра, 
	НаборЗаписейРегистра, 
	Физлица = Неопределено, 
	ЗаписиДоходыНДФЛ = Неопределено,
	НаборЗаписейРасчетСреднего = Неопределено,
	ГоловнаяОрганизация = Неопределено,
	ОбособленноеПодразделение = Неопределено,
	ТабличнаяЧастьДокумента = Неопределено,
	ОднократныйРасчетСреднего = Ложь) Экспорт
	
	Если НаборЗаписейРегистра.Количество() = 0 Тогда
		Возврат;
	КонецЕсли;
	// здесь предполагаем, что в наборе записей не может быть записей с разными периодами регистрации
	ПериодРегистрации = НаборЗаписейРегистра[0].ПериодРегистрации;
	
	Регистратор = НаборЗаписейРегистра.Отбор.Регистратор.Значение;
	ИмяПВР = Метаданные.РегистрыРасчета[ИмяРегистра].ПланВидовРасчета.Имя;
	
	СчитатьСреднийЗаработок = Истина;
	
	// таблица ФизлицаДляПерерасчета
	// Список физлиц по которым необходимо выполнить перерасчет
	// Поля:
	//		ФизЛицо
	// Описание:
	// Получает список неповторяющихся физлиц по которым есть записи
	// перерасчета в одной из таблиц перерасчета - по основным или дополнительным начислениям
	//
	ФизлицаДляПерерасчетаТекст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Перерасчет.ФизЛицо КАК Физлицо
	|ИЗ
	|	(ВЫБРАТЬ
	|		Перерасчет.ФизЛицо КАК ФизЛицо
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ПерерасчетОсновныхНачислений КАК Перерасчет
	|	
	|	ГДЕ
	|		Перерасчет.ОбъектПерерасчета = &парамРегистратор
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Перерасчет.ФизЛицо
	|	ИЗ
	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.ПерерасчетДополнительныхНачислений КАК Перерасчет
	|	
	|	ГДЕ
	|		Перерасчет.ОбъектПерерасчета = &парамРегистратор) КАК Перерасчет";
	
	// соответствие категории начисления и массива сособов расчета
	// для записей, которые будут перерассчитываться
	Запрос = Новый Запрос;
	Если Физлица = Неопределено Тогда
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ"
		+ ?(ИмяПВР = "ОсновныеНачисленияОрганизаций",
		"
		|	ВЫБОР
		|		КОГДА ВидРасчета.Показатель1.Предопределенный
		|			ТОГДА ВидРасчета.Показатель1
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК Показатель1,
		|	ВЫБОР
		|		КОГДА ВидРасчета.Показатель2.Предопределенный
		|			ТОГДА ВидРасчета.Показатель2
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК Показатель2,
		|	ВЫБОР
		|		КОГДА ВидРасчета.Показатель3.Предопределенный
		|			ТОГДА Показатель3
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК Показатель3,
		|	ВЫБОР
		|		КОГДА ВидРасчета.Показатель4.Предопределенный
		|			ТОГДА ВидРасчета.Показатель4
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК Показатель4,
		|	ВидРасчета.Показатель5 КАК Показатель5,
		|	ВидРасчета.ПериодДействияБазовый КАК ПериодДействияБазовый,
		|	ВидРасчета.ЗачетНормыВремени КАК ЗачетНормыВремени,
		|	ВидРасчета.ЗачетОтработанногоВремени КАК ЗачетОтработанногоВремени,","")
		+ ?(ИмяПВР = "ДополнительныеНачисленияОрганизаций",
		"
		|	ВЫБОР КОГДА КодыДоходаСВычетами.КодДохода ЕСТЬ NULL ТОГДА Ложь ИНАЧЕ Истина КОНЕЦ Как РасчетВычетов,","")
		+ "
		|   "+ИмяРегистра+".ВидРасчета.КатегорияНачисления Как КатегорияНачисления,
		|	"+ИмяРегистра+".ВидРасчета.СпособРасчета Как СпособРасчета
		|ИЗ
		|	РегистрРасчета."+ИмяРегистра+" Как "+ИмяРегистра
		+ ?(ИмяПВР = "ДополнительныеНачисленияОрганизаций",
		"
		|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ КодДохода Из РегистрСведений.НДФЛВычетыПоДоходам) Как КодыДоходаСВычетами
		|ПО "+ИмяРегистра+".ВидРасчета.КодДоходаНДФЛ = КодыДоходаСВычетами.КодДохода","")+"
		|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ("+ФизлицаДляПерерасчетаТекст+") Как ФизлицаДляПерерасчета
		|ПО ФизлицаДляПерерасчета.ФизЛицо = "+ИмяРегистра+".ФизЛицо
		|ГДЕ Регистратор = &парамРегистратор
		|УПОРЯДОЧИТЬ ПО
		|	"+ИмяРегистра+".ВидРасчета.КатегорияНачисления.Код
		|ИТОГИ ПО "+ИмяРегистра+".ВидРасчета.КатегорияНачисления";
	Иначе
		Запрос.УстановитьПараметр("парамФизлица", Физлица);
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ"
		+ ?(ИмяПВР = "ОсновныеНачисленияОрганизаций",
		"
		|	ВЫБОР
		|		КОГДА ВидРасчета.Показатель1.Предопределенный
		|			ТОГДА ВидРасчета.Показатель1
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК Показатель1,
		|	ВЫБОР
		|		КОГДА ВидРасчета.Показатель2.Предопределенный
		|			ТОГДА ВидРасчета.Показатель2
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК Показатель2,
		|	ВЫБОР
		|		КОГДА ВидРасчета.Показатель3.Предопределенный
		|			ТОГДА Показатель3
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК Показатель3,
		|	ВЫБОР
		|		КОГДА ВидРасчета.Показатель4.Предопределенный
		|			ТОГДА ВидРасчета.Показатель4
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК Показатель4,
		|	ВидРасчета.Показатель5 КАК Показатель5,
		|	ВидРасчета.ПериодДействияБазовый КАК ПериодДействияБазовый,
		|	ВидРасчета.ЗачетНормыВремени КАК ЗачетНормыВремени,
		|	ВидРасчета.ЗачетОтработанногоВремени КАК ЗачетОтработанногоВремени,","")
		+ ?(ИмяПВР = "ДополнительныеНачисленияОрганизаций",
		"
		|	ВЫБОР КОГДА КодыДоходаСВычетами.КодДохода ЕСТЬ NULL ТОГДА Ложь ИНАЧЕ Истина КОНЕЦ Как РасчетВычетов,","")
		+ "
		|   "+ИмяРегистра+".ВидРасчета.КатегорияНачисления Как КатегорияНачисления,
		|	"+ИмяРегистра+".ВидРасчета.СпособРасчета Как СпособРасчета
		|ИЗ
		|	РегистрРасчета."+ИмяРегистра+" Как "+ИмяРегистра+"
		|ГДЕ Регистратор = &парамРегистратор И Физлицо В(&парамФизлица)
		|УПОРЯДОЧИТЬ ПО
		|	"+ИмяРегистра+".ВидРасчета.КатегорияНачисления.Код
		|ИТОГИ ПО "+ИмяРегистра+".ВидРасчета.КатегорияНачисления";
		
	КонецЕсли;
	Запрос.УстановитьПараметр("парамРегистратор", Регистратор);
	
	ВыборкаКатегорий = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	
	// соответствие категорий начислений и массива способов расчета
	КатегорииСпособы = Новый Соответствие;
	Пока ВыборкаКатегорий.Следующий() Цикл
		
		// Получим структуру необходимых данных для расчетов текущей категории
		МассивСпособовРасчета	= Новый Массив;	// Массив способов расчета текущий категории
		МассивПоказателей		= Новый Массив;	// Массив видов показателей схем мотивации
		НормаВремени			= Ложь;			// Признак необходимости получения нормы времени для видов расчета
		ОтработаноВремени		= Ложь;			// Признак необходимости получения отработанного времени для видов расчета
		РасчетВычетов			= Ложь;			// Признак необходимости расчета вычетов к доходам
		НеобходимБазовыйПериод	= Ложь;			// Признак необходимости базового периода
		
		ВложеннаяВыборка = ВыборкаКатегорий.Выбрать();
		Пока ВложеннаяВыборка.Следующий() Цикл
			МассивСпособовРасчета.Добавить(ВложеннаяВыборка.СпособРасчета);
			
			Если ИмяПВР = "ОсновныеНачисленияОрганизаций" Тогда
				
				Если ВложеннаяВыборка.Показатель1 <> Null Тогда
					МассивПоказателей.Добавить(ВложеннаяВыборка.Показатель1);
				КонецЕсли;
				Если ВложеннаяВыборка.Показатель2 <> Null Тогда
					МассивПоказателей.Добавить(ВложеннаяВыборка.Показатель2);
				КонецЕсли;
				Если ВложеннаяВыборка.Показатель3 <> Null Тогда
					МассивПоказателей.Добавить(ВложеннаяВыборка.Показатель3);
				КонецЕсли;
				Если ВложеннаяВыборка.Показатель4 <> Null Тогда
					МассивПоказателей.Добавить(ВложеннаяВыборка.Показатель4);
				КонецЕсли;
				Если ВложеннаяВыборка.Показатель5 <> Null Тогда
					МассивПоказателей.Добавить(ВложеннаяВыборка.Показатель5);
				КонецЕсли;
				
				НормаВремени			= НормаВремени ИЛИ ВложеннаяВыборка.ЗачетНормыВремени;
				ОтработаноВремени		= ОтработаноВремени ИЛИ ВложеннаяВыборка.ЗачетОтработанногоВремени ИЛИ ВложеннаяВыборка.ЗачетНормыВремени;
				НеобходимБазовыйПериод	= НеобходимБазовыйПериод ИЛИ (НЕ ВложеннаяВыборка.ПериодДействияБазовый);
			КонецЕсли;
			
			Если ИмяПВР = "ДополнительныеНачисленияОрганизаций" Тогда
				РасчетВычетов = РасчетВычетов ИЛИ ВложеннаяВыборка.РасчетВычетов;
			КонецЕсли;
			
		КонецЦикла;
		
		НеобходимыеДанные = ПолучитьСтруктуруНеобходимыхДанных(МассивСпособовРасчета, МассивПоказателей);
		НеобходимыеДанные.НормаВремени			= НеобходимыеДанные.НормаВремени ИЛИ НормаВремени;
		НеобходимыеДанные.ОтработаноВремени		= НеобходимыеДанные.ОтработаноВремени ИЛИ ОтработаноВремени;
		НеобходимыеДанные.ВычетыКДоходамНДФЛ	= РасчетВычетов;
		
		Если НеобходимыеДанные.База Тогда
			НеобходимыеДанные.НормаВремениЗаМесяц	= НеобходимыеДанные.НормаВремениЗаМесяц ИЛИ НеобходимБазовыйПериод;
			НеобходимыеДанные.ОтработаноВремени		= НеобходимыеДанные.ОтработаноВремени ИЛИ НеобходимБазовыйПериод;
		КонецЕсли;
		
		Если Не НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию Тогда
			НеобходимыеДанные.НакопленныеДанныеПоДокументуОснованию = ИмяРегистра = "УдержанияРаботниковОрганизаций" И НеобходимыеДанные.База
		КонецЕсли;
		
		// если нужны данные для расчета среднего заработка
		Если СчитатьСреднийЗаработок И (НеобходимыеДанные.СреднийЗаработок ИЛИ НеобходимыеДанные.СреднийЗаработокОтпуска) И (НаборЗаписейРасчетСреднего <> Неопределено) Тогда
			СформироватьИЗаписатьДанныеРасчетаСреднего(ИмяРегистра, Регистратор, НаборЗаписейРасчетСреднего);
			Если ОднократныйРасчетСреднего Тогда
				СчитатьСреднийЗаработок = Ложь;
				
			КонецЕсли;
			
		КонецЕсли;
		
		ИсходныеДанные = ПолучитьДанныеДляРасчета(ИмяРегистра, ВыборкаКатегорий.КатегорияНачисления, НеобходимыеДанные, Регистратор, ГоловнаяОрганизация, ПериодРегистрации, Истина, Физлица);
		// Курс результата передаем равным 1, т.к. считаем, что перерасчет доступен только для реглучета
		РассчитатьЗаписиНабора(ИсходныеДанные, НаборЗаписейРегистра, НеобходимыеДанные, ЗаписиДоходыНДФЛ, ГоловнаяОрганизация, ОбособленноеПодразделение, ТабличнаяЧастьДокумента,,,,,,,,НаборЗаписейРасчетСреднего);
		
		// записываем набор после расчета каждой очередной категории
		НаборЗаписейРегистра.Записать(Истина, Истина);
		
	КонецЦикла;
	
КонецПроцедуры // ПерерассчитатьЗаписиРегистраРасчета() 

//Рассчитать налог по накоплению с начала года по пргрессивной шкале
Функция РассчитатьПрогрессивнуюШкалу(ТекущийГод, ПериодРасчета, РанееНачисленный,
	ОблагаемыйДоходЗаГод, 
	ПримененныеВычетыЛичные,
	ВычетыПримененныеДетский,
	ВычетыПримененныеДетскийЛьгота,
	ВычетыПримененныеДополнительный,
	
	ВычетыПримененныеМолодыеСпециалисты, //Аверсон ЕАЕ 31.01.2024 СВФР-012095
	
	ВычетыПримененные312,
	ВычетыПримененные311,ВидНалогообложения,Организация,Сотрудник) Экспорт //О.Т. Аверсон 27.03.2016 № 950
	//Минск расчет по прогрессивной шкале
	БазоваяВеличина	= 0;
	ТекДата = НачалоГода(ПериодРасчета);
	Пока ТекДата <= НачалоМесяца(ПериодРасчета) Цикл
		ПоследняяБазоваяВеличина = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ТекДата, Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.БазоваяВеличина)).Размер;
		Если ПоследняяБазоваяВеличина = 0 тогда
			Сообщить("Не заполнено значение базовой величины "+Текдата);
			Возврат РанееНачисленный;
		КонецЕсли;
		БазоваяВеличина = БазоваяВеличина + ПоследняяБазоваяВеличина;
		ТекДата = ДобавитьМесяц(ТекДата, 1);
	КонецЦикла;
	БазоваяВеличина = БазоваяВеличина + ПоследняяБазоваяВеличина * (12 - Месяц(ПериодРасчета));
	СБВ	=  Окр(БазоваяВеличина / 12,1,1);	
	ЗапросШкала = Новый Запрос;
	ЗапросШкала.УстановитьПараметр("СредняяБазовая", СБВ);
	ЗапросШкала.Текст = "ВЫБРАТЬ
	|	ШкалаПодоходногоНалогаСрезПоследних.НижнийПредел * &СредняяБазовая КАК НижнийПредел,
	|	ШкалаПодоходногоНалогаСрезПоследних.ВерхнийПредел * &СредняяБазовая КАК ВерхнийПредел,
	|	ШкалаПодоходногоНалогаСрезПоследних.Налог
	|ИЗ
	|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(&КонецПериода, ) КАК ШкалаПодоходногоНалогаСрезПоследних
	|ГДЕ
	|	ШкалаПодоходногоНалогаСрезПоследних.Организация = &Организация
	|	И ШкалаПодоходногоНалогаСрезПоследних.ВидНалогообложения = &ВидНалогообложения
	|
	|УПОРЯДОЧИТЬ ПО
	|	НижнийПредел";
	ЗапросШкала.УстановитьПараметр("КонецПериода", ПериодРасчета);
	ЗапросШкала.УстановитьПараметр("Организация", Организация); //О.Т. Аверсон 27.03.2016 № 950
	ЗапросШкала.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения); //О.Т. Аверсон 27.03.2016 № 950
	Шкала = ЗапросШкала.Выполнить().Выгрузить();
	
	Если Шкала.Количество() = 0 тогда
		Сообщить("Не заполнена шкала подоходного налога на период "+ Строка(ГОД(ПериодРасчета)));
		Возврат РанееНачисленный;
	КонецЕсли;
	
	//О.Т. Аверсон 30.03.2016 № 950
	ЗапросИндСтавкаНалогообл = Новый Запрос;
	ЗапросИндСтавкаНалогообл.Текст = 
	"ВЫБРАТЬ
	|	ИноеНалогообложениеПоСотрудникамСрезПоследних.НДФЛ
	|ИЗ
	|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
	|			&Период,
	|			Организация = &Организация
	|				И ВидНалогообложения = &ВидНалогообложения
	|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
	
	ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
	ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
	ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРасчета);
	ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Сотрудник); 
	РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
	ЕстьИндивидСтавка = Ложь;
	СтавкаНДФЛИнд = 0;
	Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
		ЕстьИндивидСтавка = Истина;
		СтавкаНДФЛИнд = РезИндСтавкаНалогообл[0].НДФЛ;
	КонецЕсли;
	//О.Т. Аверсон 30.03.2016 № 950
	
	ОблагаемаяСумма = ОблагаемыйДоходЗаГод - ПримененныеВычетыЛичные - ВычетыПримененныеДетский - ВычетыПримененныеДетскийЛьгота -
	ВычетыПримененныеДополнительный - ВычетыПримененныеМолодыеСпециалисты - ВычетыПримененные312 - ВычетыПримененные311; //Аверсон ЕАЕ 31.01.2024 СВФР-012095
	Накопление 		= 0;
	ВерхнийПредел 	= 0;
	Для Каждого Предел Из Шкала Цикл
		Если (ОблагаемаяСумма <= ОбщегоНазначения.ОкруглитьЗначение2016(Предел.ВерхнийПредел,ПериодРасчета,1)) ИЛИ (ОбщегоНазначения.ОкруглитьЗначение2016(Предел.ВерхнийПредел,ПериодРасчета,1) = 0) Тогда //О.Т. Аверсон 15.03.2016 № 949
			ПодоходныйНалог = Накопление + ?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,Предел.Налог) / 100 * (ОблагаемаяСумма - ВерхнийПредел );
			Прервать;
		КонецЕсли;
		Накопление = Накопление + ?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,Предел.Налог) / 100 * (ОбщегоНазначения.ОкруглитьЗначение2016(Предел.ВерхнийПредел,ПериодРасчета,1) - ВерхнийПредел); //О.Т. Аверсон 15.03.2016 № 949
		ВерхнийПредел = ОбщегоНазначения.ОкруглитьЗначение2016(Предел.ВерхнийПредел,ПериодРасчета,1); //О.Т. Аверсон 15.03.2016 № 949
	КонецЦикла;
	
	Возврат ПодоходныйНалог;
КонецФункции

// получить данные для расчета НДФЛ по ставке 13 процентов
// Параметры: 
//  ПоследнийМесяцНалоговогоПериода - месяц налогового периода, по который (включительно) считается налог. 
//  						Это текущий или будущий месяц относительно периода регистрации
//							Если Неопределено - нужно определить максимальный месяц налогового периода и 
//							минимальный месяц налоговго периода 
//  ПериодРегистрации - дата, по которую учитываются зарегистрированные доходы и начисленные налоги 
//  Организация - ссылка на организацию
//  Регистратор - ссылка на регистратор записей НДФЛ
//  СписокФизЛицТекст - текст запроса выборки списка физлиц, по которым необходимо выполнить расчет налога
//	ДополнительныеПараметрыЗапроса - структура значений параметров запроса, необходимых для выполнения текста запроса "СписокФизЛицТекст"
//
// Возвращаемое значение:
//  Нет.
//
//{{MRG[ <-> ]
Функция ПолучитьДанныеНДФЛПоРегистратору(Знач ПервыйМесяцНалоговогоПериода,
	Знач ПоследнийМесяцНалоговогоПериода,
	ПериодРегистрации,
	ОбособленноеПодразделение,
	Организация,
	Регистратор,
	Знач СписокФизЛицТекст,
	ДополнительныеПараметрыЗапроса = Неопределено,
	ЭтоПерерасчет = Ложь,
	КомментироватьРасчет = Ложь,
	ВыборкаПодразделений,
	СсылкаОтчет = Ложь,
	ФлагДляПромежуточнойВед = Ложь,РегистраторПрочиеНач = Неопределено, //О.Т. 10.02.2015 № 333
	_парамФизлицо_ = Неопределено, _парамФизлицаПерерасчета_ = Неопределено, _СписокФизЛиц_ = Неопределено //СВЭЙ 10.04.2024 КВВ СВФР-012811
	) Экспорт
	//Островская Татьяна 11.12.2012 № Исправление
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("парамОрганизация",			Организация);
	Запрос.УстановитьПараметр("РегистраторПрочиеНач",			РегистраторПрочиеНач); //О.Т. Аверсон 13.03.2017 № 396
	
	Запрос.УстановитьПараметр("парамРегистратор",			Регистратор);
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", ОбособленноеПодразделение);
	Запрос.УстановитьПараметр("парамПериодРегистрации",		НачалоМесяца(ПериодРегистрации));
	//Островская Татьяна 15.11.2012 № 15
	если СсылкаОтчет Тогда 
		Запрос.УстановитьПараметр("парамНачалоГодаРегистрации",	НачалоМесяца(ПериодРегистрации));
	Иначе 
		Запрос.УстановитьПараметр("парамНачалоГодаРегистрации",	НачалоГода(ПериодРегистрации));
	КонецЕсли;
	//Островская Татьяна 15.11.2012 № 15
	// установим дополнительные параметры
	Если ДополнительныеПараметрыЗапроса <> Неопределено Тогда
		Для каждого Поле Из ДополнительныеПараметрыЗапроса Цикл
			Запрос.УстановитьПараметр(Поле.Ключ, Поле.Значение);
		КонецЦикла;
	КонецЕсли;
	
	МенеджерВТ = Новый МенеджерВременныхТаблиц;
	Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
	
	Запрос.Текст = 
	"ВЫБРАТЬ Физлицо
	|ПОМЕСТИТЬ ВТСписокФизЛиц
	|ИЗ (" + СписокФизЛицТекст + ") СписокФизЛиц
	|ИНДЕКСИРОВАТЬ ПО Физлицо";
	Запрос.Выполнить();
	
	НалоговаяПолитикаНДФЛ = РегистрыСведений.УчетнаяПолитикаПоНДФЛ.ПолучитьПоследнее(КонецГода(ПериодРегистрации), Новый Структура("Организация", Организация)).ОсобенностиИсчисленияНДФЛ;
	Если НЕ ЗначениеЗаполнено(НалоговаяПолитикаНДФЛ) Тогда
		НалоговаяПолитикаНДФЛ = Перечисления.ОсобенностиИсчисленияНДФЛ.СтандартныеВычетыНарастающимИтогом;
	КонецЕсли;
	
	Если ПоследнийМесяцНалоговогоПериода = Неопределено Тогда
		
		// получим ПоследнийМесяцНалоговогоПериода
		Запрос.Текст = "
		|ВЫБРАТЬ ПЕРВЫЕ 1
		|	НДФЛСведенияОДоходах.Период КАК Период
		|ИЗ
		|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК Работники
		|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
		|
		|ГДЕ
		|	НДФЛСведенияОДоходах.Организация = &парамОрганизация И НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
		|
		|УПОРЯДОЧИТЬ ПО
		|	Период УБЫВ";
		Результат = Запрос.Выполнить();
		
		Если Результат.Пустой() Тогда
			ПоследнийМесяцНалоговогоПериода = КонецМесяца(ПериодРегистрации);
			
		Иначе
			Выборка = Результат.Выбрать();
			Выборка.Следующий();
			ПоследнийМесяцНалоговогоПериода = КонецМесяца(Выборка.Период);
			
		КонецЕсли;
		
	КонецЕсли;
	
	Запрос.Текст = "
	|ВЫБРАТЬ ПЕРВЫЕ 1
	|	НДФЛСведенияОДоходах.Период КАК Период
	|ИЗ
	|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК Работники
	|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
	|
	|ГДЕ
	|	НДФЛСведенияОДоходах.Организация = &парамОрганизация И НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
	|
	|УПОРЯДОЧИТЬ ПО
	|	Период";
	Результат = Запрос.Выполнить();
	
	Если Результат.Пустой() Тогда
		ПервыйМесяцНалоговогоПериода = ПериодРегистрации;
		
	Иначе
		Выборка = Результат.Выбрать();
		Выборка.Следующий();
		ПервыйМесяцНалоговогоПериода =Выборка.Период;
		
	КонецЕсли;
	
	Если ГОД(ПериодРегистрации) < 2009 тогда
		
		Запрос.УстановитьПараметр("парамСтавка13",                     Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13);
		//Запрос.УстановитьПараметр("парамСтавкаРезидента13", ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛотСтавкиНалогообложенияРезидента(Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13) / 100);
		//Островская Татьяна 15.11.2012 № 15
		если СсылкаОтчет Тогда 
			Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ПериодРегистрации));
			Запрос.УстановитьПараметр("парамНачалоГода",                   НачалоМесяца(ПериодРегистрации));
			Запрос.УстановитьПараметр("парамКонецГода",                    КонецМесяца(ПериодРегистрации));
			Запрос.УстановитьПараметр("парамПриход",                       ВидДвиженияНакопления.Приход);
		иначе
			Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ПоследнийМесяцНалоговогоПериода));
			Запрос.УстановитьПараметр("парамНачалоГода",                   НачалоГода(ПервыйМесяцНалоговогоПериода));
			Запрос.УстановитьПараметр("парамКонецГода",                    КонецГода(ПоследнийМесяцНалоговогоПериода));
			Запрос.УстановитьПараметр("парамПриход",                       ВидДвиженияНакопления.Приход);
		КонецЕсли;
		//Островская Татьяна 15.11.2012 № 15
		ВидСтроки = Новый СписокЗначений;
		ВидСтроки.Добавить(Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
		ВидСтроки.Добавить(Перечисления.НДФЛРасчетыСБюджетомВидСтроки.ВозвратНалога);
		
		Запрос.УстановитьПараметр("парамВидСтроки",                    Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
		Запрос.УстановитьПараметр("БазоваяВеличина",                   Перечисления.ВидыПараметровДляРасчетаЗарплаты.БазоваяВеличина);
		
		Запрос.УстановитьПараметр("КодВычета312", Справочники.ВычетыНДФЛ.Код640);
		//Запрос.УстановитьПараметр("КодВычета640Страх", Справочники.ВычетыНДФЛ.Код640Страх);
		Запрос.УстановитьПараметр("КодВычета311", Справочники.ВычетыНДФЛ.Код650);
		
		КодыВычетовРезидентов = Новый Массив;
		//Вычеты (льготы) кратные базовой величине
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код500);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код510);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код520);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код530);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код540);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код550);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код560);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код570);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код571);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код580);
		//Расходы по авторским
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код404);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код405);
		Запрос.УстановитьПараметр("КодыВычетовРезидентов", КодыВычетовРезидентов);
		
		//НачМесяца = НачалоГода(ПервыйМесяцНалоговогоПериода);
		//ДатыПоМесяцамТекст = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период";
		//ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +"
		//|ПОМЕСТИТЬ ВТДатыПоМесяцам";
		//Пока НачМесяца < НачалоМесяца(ПоследнийМесяцНалоговогоПериода) Цикл
		//	НачМесяца = НачалоМесяца(КонецМесяца(НачМесяца) + 1);
		//	ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +"
		//	|ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
		//КонецЦикла;
		//ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +"
		//|ИНДЕКСИРОВАТЬ ПО Период";
		
		НачМесяца = НачалоГода(ПервыйМесяцНалоговогоПериода);
		ДатыПоМесяцамТекст = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период";
		ДатыПоМесяцамТекстД = ДатыПоМесяцамТекст;
		ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +"
		|ПОМЕСТИТЬ ВТДатыПоМесяцам";
		Пока НачМесяца < НачалоМесяца(ПоследнийМесяцНалоговогоПериода) Цикл
			НачМесяца = НачалоМесяца(КонецМесяца(НачМесяца) + 1);
			ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
			ДатыПоМесяцамТекстД = ДатыПоМесяцамТекстД +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
		КонецЦикла;
		ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +"
		|ИНДЕКСИРОВАТЬ ПО Период";
		
		Запрос.Текст = ДатыПоМесяцамТекстД;
		Запрос.Текст = ДатыПоМесяцамТекст;
		Запрос.Выполнить();
		
		// Периоды
		// Таблица список периодов-физлиц по которым необходимо выполнить расчет налога
		// Поля:
		//		Период
		//		Физлицо
		
		Если ЭтоПерерасчет Тогда
			
			ПериодыТекст = 
			"ВЫБРАТЬ
			|	Работники.Физлицо,
			|	Месяцы.Период
			|ПОМЕСТИТЬ ВТПериоды
			|ИЗ
			|	ВТСписокФизЛиц КАК Работники
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|		ПО (ИСТИНА)
			|ИНДЕКСИРОВАТЬ ПО Физлицо, Период";
			
			ПериодыТекст1 = 
			"ВЫБРАТЬ
			|	Работники.Физлицо,
			|	Месяцы.Период
			|ИЗ
			|	ВТСписокФизЛиц КАК Работники
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|		ПО (ИСТИНА)";
		Иначе
			
			ПериодыТекст = 
			"ВЫБРАТЬ
			|	ПериодыДохода.ФизЛицо,
			|	Месяцы.Период
			|ПОМЕСТИТЬ ВТПериоды
			|ИЗ
			|	(ВЫБРАТЬ
			|		НДФЛСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|		МАКСИМУМ(НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)) КАК ПериодМакс,
			|		МИНИМУМ(ВЫБОР
			|				КОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|					ТОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, ГОД)
			|				ИНАЧЕ &парамНачалоГодаРегистрации
			|			КОНЕЦ) КАК ПериодМин
			|	ИЗ
			|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК Работники
			|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
			|	ГДЕ
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) МЕЖДУ &парамНачалоГодаРегистрации И &парамПериодРегистрации
			|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НДФЛСведенияОДоходах.ФизЛицо) КАК ПериодыДохода
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|		ПО (Месяцы.Период МЕЖДУ ПериодыДохода.ПериодМин И ПериодыДохода.ПериодМакс)
			|ИНДЕКСИРОВАТЬ ПО Физлицо, Период";
			
			ПериодыТекст1 = 
			"ВЫБРАТЬ
			|	ПериодыДохода.ФизЛицо,
			|	Месяцы.Период
			|ИЗ
			|	(ВЫБРАТЬ
			|		НДФЛСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|		МАКСИМУМ(НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)) КАК ПериодМакс,
			|		МИНИМУМ(ВЫБОР
			|				КОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|					ТОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, ГОД)
			|				ИНАЧЕ &парамНачалоГодаРегистрации
			|			КОНЕЦ) КАК ПериодМин
			|	ИЗ
			|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК Работники
			|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
			|	ГДЕ
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) МЕЖДУ &парамНачалоГодаРегистрации И &парамПериодРегистрации
			|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НДФЛСведенияОДоходах.ФизЛицо) КАК ПериодыДохода
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|		ПО (Месяцы.Период МЕЖДУ ПериодыДохода.ПериодМин И ПериодыДохода.ПериодМакс)";
		КонецЕсли;
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = ПериодыТекст1;
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		Запрос.Текст = ПериодыТекст;
		Запрос.Выполнить();
		ПериодыТекст = "ВТПериоды";
		
		// ПодразделенияРаботников
		//	Поля:
		//		Физлицо
		//		Период
		//		ПодразделениеОрганизации
		//
		//	Описание:
		//	список подразделений в которых работают физлица по состоянию на конец месяца налогового периода
		
		ПодразделенияРаботниковТекст = 
		"ВЫБРАТЬ
		|	Периоды.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		|	ВЫБОР
		|		КОГДА КОНЕЦПЕРИОДА(Периоды.Период, МЕСЯЦ) >= РаботникиОрганизаций.ПериодЗавершения  
		|					И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
		|			ИНАЧЕ РаботникиОрганизаций.ПодразделениеОрганизации
		|		КОНЕЦ КАК ПодразделениеОрганизации
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.ФизЛицо КАК Физлицо,
		|		Периоды.Период КАК Период,
		|		МАКСИМУМ(РаботникиОрганизаций.Период) КАК ДатаРегистра,
		|		РаботникиОрганизаций.Организация КАК Организация
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|			ПО КОНЕЦПЕРИОДА(Периоды.Период, МЕСЯЦ) >= РаботникиОрганизаций.Период
		|				И Периоды.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
		|	ГДЕ
		|		РаботникиОрганизаций.Организация = &парамОрганизация
		|		И РаботникиОрганизаций.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|		И РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Периоды.ФизЛицо,
		|		Периоды.Период,
		|		РаботникиОрганизаций.Организация) КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|		ПО Периоды.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо
		|			И Периоды.ДатаРегистра = РаботникиОрганизаций.Период
		|			И Периоды.Организация = РаботникиОрганизаций.Организация
		|ГДЕ
		|	ВЫБОР
		|		КОГДА КОНЕЦПЕРИОДА(Периоды.Период, МЕСЯЦ) >= РаботникиОрганизаций.ПериодЗавершения 
		|					И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА РаботникиОрганизаций.ПричинаИзмененияСостоянияЗавершения
		|			ИНАЧЕ РаботникиОрганизаций.ПричинаИзмененияСостояния
		|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|	И РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)";
		
		// ПодразделенияДоговорников
		//	Поля:
		//		Физлицо
		//		Период
		//		ПодразделениеОрганизации
		//
		//	Описание:
		//	список подразделений в которых работают физлица по состоянию на конец месяца налогового периода
		ПодразделенияДоговорниковТекст = 
		"ВЫБРАТЬ
		|	ДатыПоследнихДоговоров.Физлицо КАК Физлицо,
		|	МАКСИМУМ(ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) КАК ПодразделениеОрганизации,
		|	ДатыПоследнихДоговоров.Период
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.Период КАК Период,
		|		Периоды.Физлицо КАК Физлицо,
		|		ДоговорНаВыполнениеРаботСФизЛицом.Организация КАК Организация,
		|		МАКСИМУМ(ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала) КАК ДатаНачала
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		|				ПО (ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала <= КОНЕЦПЕРИОДА(Периоды.Период, МЕСЯЦ))
		|					И (ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания >= НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ))
		|					И Периоды.ФизЛицо = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.Физлицо
		|		ГДЕ
		|			ДоговорНаВыполнениеРаботСФизЛицом.Организация = &парамОбособленноеПодразделение
		|			
		|		СГРУППИРОВАТЬ ПО
		|			Периоды.Период,
		|			Периоды.ФизЛицо,
		|			ДоговорНаВыполнениеРаботСФизЛицом.Организация) КАК ДатыПоследнихДоговоров
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		|			ПО ДатыПоследнихДоговоров.Организация = ДоговорНаВыполнениеРаботСФизЛицом.Организация
		|				И ДатыПоследнихДоговоров.ДатаНачала = ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала
		|				И ДатыПоследнихДоговоров.Физлицо = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.Физлицо
		|		
		|
		|СГРУППИРОВАТЬ ПО
		|	ДатыПоследнихДоговоров.Физлицо,
		|	ДатыПоследнихДоговоров.Организация,
		|	ДатыПоследнихДоговоров.Период";
		
		ПодразделенияПоМесяцамТекст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ПодразделенияРаботников.Физлицо,
		|	ПодразделенияРаботников.Период,
		|	ПодразделенияРаботников.ПодразделениеОрганизации КАК ПодразделениеОрганизации
		|ИЗ		
		|	("+ПодразделенияРаботниковТекст+") КАК ПодразделенияРаботников
		
		|		ОБЪЕДИНИТЬ ВСЕ
		
		|ВЫБРАТЬ
		|	ПодразделенияДоговорников.Физлицо,
		|	ПодразделенияДоговорников.Период,
		|	ПодразделенияДоговорников.ПодразделениеОрганизации
		|ИЗ
		|	("+ПодразделенияДоговорниковТекст+") КАК ПодразделенияДоговорников";
		
		
		// ФизлицаНеРезиденты
		//	Поля:
		//		Физлицо
		//
		//	Описание:
		//	сисок физлиц-нерезидентов
		
		ФизлицаНеРезидентыТекст = 
		"ВЫБРАТЬ
		|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
		|	ГражданствоПоГодам.ПериодФизлица КАК Период
		|ИЗ
		|	РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
		|			ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
		|			Физлица.Период КАК ПериодФизлица,
		|			МАКСИМУМ(ГражданствоФизЛиц.Период) КАК Период
		|		ИЗ
		|			РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
		|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТПериоды КАК Физлица
		|				ПО Физлица.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
		|					И (ГражданствоФизЛиц.Период <= ВЫБОР
		|						КОГДА КОНЕЦПЕРИОДА(Физлица.Период, ГОД) >= КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
		|							ТОГДА КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
		|						ИНАЧЕ КОНЕЦПЕРИОДА(Физлица.Период, ГОД)
		|					КОНЕЦ)
		|		
		|		СГРУППИРОВАТЬ ПО
		|			ГражданствоФизЛиц.ФизЛицо,
		|			Физлица.Период) КАК ГражданствоПоГодам
		|		ПО ГражданствоПоГодам.Физлицо = ГражданствоФизЛиц.ФизЛицо
		|			И ГражданствоПоГодам.Период = ГражданствоФизЛиц.Период
		|ГДЕ
		|	ГражданствоФизЛиц.НеЯвляетсяНалоговымРезидентомРФ";
		
		// ДоходыСКодамиВычетов
		//	Поля:
		//		ФизЛицо
		//		Период
		//		КодДохода
		//		КодВычета
		//		СуммаДоходаОборот
		//		СуммаВычетаОборот
		//
		//	Описание:
		// Выбирает облагаемые налогом доходы за весь год по физлицам из СписокФизлиц
		ДоходыСКодамиВычетовТекст = 
		"ВЫБРАТЬ
		|	НДФЛОбороты.Физлицо КАК ФизЛицо,
		|	НДФЛОбороты.Период КАК Период,
		|	НДФЛОбороты.КодДохода КАК КодДохода,
		|	НДФЛОбороты.КодВычета КАК КодВычета,
		|	СУММА(НДФЛОбороты.СуммаДоходаОборот) КАК СуммаДоходаОборот,
		|	СУММА(НДФЛОбороты.СуммаВычетаОборот) КАК СуммаВычетаОборот
		|ПОМЕСТИТЬ ВТДоходыСКодамиВычетов
		|ИЗ
		|	(ВЫБРАТЬ
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) КАК Период,
		|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо,
		|		НДФЛСведенияОДоходах.КодДохода КАК КодДохода,
		|		НДФЛСведенияОДоходах.КодВычета КАК КодВычета,
		|		ЕСТЬNULL(СУММА(НДФЛСведенияОДоходах.СуммаДохода), 0) КАК СуммаДоходаОборот,
		|		ЕСТЬNULL(СУММА(НДФЛСведенияОДоходах.СуммаВычета), 0) КАК СуммаВычетаОборот
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		|			ПО Периоды.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
		|				И (Периоды.Период = НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ))
		|	ГДЕ
		|		НДФЛСведенияОДоходах.Период >= &парамНачалоГода И
		|		НДФЛСведенияОДоходах.Период <= &парамКонецМесяцаНалоговогоПериода
		//	|		И НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) <= &парамПериодРегистрации
		|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
		|		И НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		НДФЛСведенияОДоходах.КодДохода,
		|		НДФЛСведенияОДоходах.КодВычета) КАК НДФЛОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	НДФЛОбороты.Физлицо,
		|	НДФЛОбороты.Период,
		|	НДФЛОбороты.КодДохода,
		|	НДФЛОбороты.КодВычета
		|ИНДЕКСИРОВАТЬ ПО Физлицо, Период";
		
		Запрос.Текст = ДоходыСКодамиВычетовТекст;
		Запрос.Выполнить();
		
		Ставка30Текст        = "0.15";
		ТипЗначенияНДФЛТекст = "ЧИСЛО(10, 0)";
		
		ПериодыСКодамиТекст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ПериодФизлицо.Период КАК Период,
		|	ПериодФизлицо.Физлицо КАК Физлицо,
		|	ВЫБОР
		|		КОГДА ФизлицаНеРезиденты.Физлицо ЕСТЬ NULL 
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК Резидент
		|ИЗ
		|	ВТПериоды КАК ПериодФизлицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ФизлицаНеРезидентыТекст + ") КАК ФизлицаНеРезиденты
		|		ПО ФизлицаНеРезиденты.Физлицо = ПериодФизлицо.Физлицо
		|			И ФизлицаНеРезиденты.Период = ПериодФизлицо.Период";
		
		
		// ДоходыЗаГод 
		//	Поля:
		//		ФизЛицо
		//		Период
		//		Резидент
		//		ОблагаемыйДоходЗаГод
		//
		//	Описание:
		//	Выбирает по всем периодам с начала года сумму дохода нарастающим итогом за год
		
		ДоходыЗаГодТекст = "
		|ВЫБРАТЬ
		|	НДФЛОбороты.Период КАК Период,
		|	НДФЛОбороты.ФизЛицо КАК ФизЛицо,
		|	НДФЛОбороты.Резидент КАК Резидент,
		|	СУММА(НДФЛОбороты.НалогНерезидента) КАК НалогНерезидента,
		|	СУММА(НДФЛОбороты.ОблагаемыйДоходЗаПериод) КАК ОблагаемыйДоходЗаПериод,
		|	СУММА(НДФЛОбороты.ОблагаемыйДоходЗаГод) КАК ОблагаемыйДоходЗаГод
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.Период КАК Период,
		|		Периоды.Физлицо КАК ФизЛицо,
		|		Периоды.Резидент КАК Резидент,
		|		ВЫБОР КОГДА НДФЛОбороты.Период = Периоды.Период ТОГДА ВЫРАЗИТЬ((НДФЛОбороты.СуммаДоходаОборот - ВЫБОР КОГДА Периоды.Резидент ИЛИ НДФЛОбороты.КодВычета НЕ В (&КодыВычетовРезидентов) ТОГДА НДФЛОбороты.СуммаВычетаОборот ИНАЧЕ 0 КОНЕЦ) * " + Ставка30Текст + " КАК " + ТипЗначенияНДФЛТекст + ") ИНАЧЕ 0 КОНЕЦ КАК НалогНерезидента,
		|       ВЫБОР КОГДА НДФЛОбороты.Период = Периоды.Период ТОГДА НДФЛОбороты.СуммаДоходаОборот - ВЫБОР КОГДА Периоды.Резидент ИЛИ НДФЛОбороты.КодВычета НЕ В (&КодыВычетовРезидентов) ТОГДА НДФЛОбороты.СуммаВычетаОборот ИНАЧЕ 0 КОНЕЦ ИНАЧЕ 0 КОНЕЦ КАК ОблагаемыйДоходЗаПериод,
		|		НДФЛОбороты.СуммаДоходаОборот - ВЫБОР КОГДА Периоды.Резидент ИЛИ НДФЛОбороты.КодВычета НЕ В (&КодыВычетовРезидентов) ТОГДА НДФЛОбороты.СуммаВычетаОборот ИНАЧЕ 0 КОНЕЦ КАК ОблагаемыйДоходЗаГод
		|	ИЗ
		|		(" + ПериодыСКодамиТекст + ") КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходыСКодамиВычетов КАК НДФЛОбороты
		|			ПО (НДФЛОбороты.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период) И Периоды.Физлицо = НДФЛОбороты.Физлицо) КАК НДФЛОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	НДФЛОбороты.Период,
		|	НДФЛОбороты.ФизЛицо,
		|	НДФЛОбороты.Резидент";
		
		// НДФЛРасчетыСБюджетом
		//	Поля:
		//		ФизЛицо
		//		МесяцНалоговогоПериода
		//		ИсчисленныйНалог
		//		ПримененныеВычетыЛичные - уже примененные личные стандартные вычеты по НДФЛ
		//		ПолеПримененныеВычетыДетские - уже примененные вычеты на детей по НДФЛ
		//
		//	Описание:
		//	Выбирает исчисленные налоги (приходы по регистру НДФЛРасчетыСБюджетом)
		//  для СписокФизлиц
		//Островская Татьяна 11.12.2012 № исправление
		ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер; 
		НДФЛРасчетыСБюджетомТекст = 
		"ВЫБРАТЬ
		|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода КАК МесяцНалоговогоПериода,
		|	НДФЛРасчетыСБюджетом.ФизЛицо КАК ФизЛицо,
		|	ВЫБОР
		|	КОГДА НДФЛРасчетыСБюджетом.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
		|			И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
		|		ТОГДА ВЫРАЗИТЬ(НДФЛРасчетыСБюджетом.Налог / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
		|	ИНАЧЕ НДФЛРасчетыСБюджетом.Налог
		|КОНЕЦ КАК ИсчисленныйНалог,
		|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетЛичный) КАК ПримененныеВычетыЛичные,
		|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетей) КАК ПолеПримененныеВычетыДетские,
		|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетейЛьгота) КАК ПолеПримененныеВычетыДетскиеЛьгота,
		|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйДополнительныйВычет) КАК ПолеПримененныеВычетыДополнительные,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетМолодыеСпециалисты) КАК ПолеПримененныеВычетыМолодыеСпециалисты
		//Аверсон СВФР-012095
		
		|ИЗ
		|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК РаботникиОрганизации
		|		ПО РаботникиОрганизации.Физлицо = НДФЛРасчетыСБюджетом.ФизЛицо
		|ГДЕ
		|	//НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= &парамКонецМесяцаНалоговогоПериода
		|	И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода <= &парамКонецМесяцаНалоговогоПериода
		|	И НДФЛРасчетыСБюджетом.Организация = &парамОрганизация
		|	И НДФЛРасчетыСБюджетом.Регистратор <> &парамРегистратор
		|	И НДФЛРасчетыСБюджетом.Период <= &парамКонецМесяцаНалоговогоПериода //КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
		|	И НДФЛРасчетыСБюджетом.ВидДвижения = &парамПриход
		|	И НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = &парамСтавка13
		|	И НДФЛРасчетыСБюджетом.ВидСтроки = &парамВидСтроки
		|
		|СГРУППИРОВАТЬ ПО
		|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода,
		|	НДФЛРасчетыСБюджетом.ФизЛицо";
		//Островская Татьяна 11.12.2012 № исправление
		// НДФЛРасчетыСБюджетомЗаГод
		//	Поля:
		//		ФизЛицо
		//		Период
		//		ИсчисленныйНалогЗаГод
		//		ПримененныеВычетыЛичныеЗаГод
		//		ПолеПримененныеВычетыДетскиеЗаГод
		//		ПолеПримененныеВычетыНаДетейИнвалидовЗаГод
		//
		//	Описание:
		//	Выбирает исчисленные налоги нарастающим итогом за год
		//Островская Татьяна 11.12.2012 № исправление
		если СсылкаОтчет Тогда 
			НДФЛРасчетыСБюджетомТекст = СтрЗаменить(НДФЛРасчетыСБюджетомТекст,"//НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= &парамКонецМесяцаНалоговогоПериода","НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= &парамКонецМесяцаНалоговогоПериода");
		иначе
			НДФЛРасчетыСБюджетомТекст = СтрЗаменить(НДФЛРасчетыСБюджетомТекст,"//НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= &парамКонецМесяцаНалоговогоПериода","НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= &парамНачалоГода");
		КонецЕсли;
		//Островская Татьяна 11.12.2012 № исправление
		НДФЛРасчетыСБюджетомЗаГодТекст = 
		"ВЫБРАТЬ
		|	Периоды.Период КАК Период,
		|	НДФЛРасчетыСБюджетом.ФизЛицо КАК ФизЛицо,
		|   СУММА(ВЫБОР 
		|	    КОГДА ФизлицаНеРезиденты.ФизЛицо ЕСТЬ NULL 
		|	    ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ИсчисленныйНалог,0)
		|	    КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода
		|	    ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ИсчисленныйНалог, 0)
		|   КОНЕЦ) КАК ИсчисленныйНалогЗаГод,
		|	СУММА(ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПримененныеВычетыЛичные, 0)) КАК ПримененныеВычетыЛичныеЗаГод,
		|	СУММА(ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДетские, 0)) КАК ПолеПримененныеВычетыДетскиеЗаГод,
		|	СУММА(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДетскиеЛьгота) КАК ПолеПримененныеВычетыДетскиеЛьготаЗаГод,
		|	СУММА(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДополнительные) КАК ПолеПримененныеВычетыДополнительныеЗаГод,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	СУММА(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыМолодыеСпециалисты) КАК ПолеПримененныеВычетыМолодыеСпециалистыЗаГод,
		//Аверсон СВФР-012095
		
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПримененныеВычетыЛичные, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПримененныеВычетыЛичныеЗаМесяц,
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДетские, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПолеПримененныеВычетыДетскиеЗаМесяц,
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДетскиеЛьгота, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПолеПримененныеВычетыДетскиеЛьготаЗаМесяц,
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДополнительные, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПолеПримененныеВычетыДополнительныеЗаМесяц,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыМолодыеСпециалисты, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПолеПримененныеВычетыМолодыеСпециалистыЗаМесяц
		//Аверсон СВФР-012095
		
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРасчетыСБюджетомТекст + ") КАК НДФЛРасчетыСБюджетом
		|		ПО (НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период)
		|			И Периоды.Физлицо = НДФЛРасчетыСБюджетом.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ФизлицаНеРезидентыТекст + ") КАК ФизлицаНеРезиденты
		|		ПО ФизлицаНеРезиденты.Физлицо = Периоды.Физлицо
		|			И ФизлицаНеРезиденты.Период = Периоды.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	Периоды.Период,
		|	НДФЛРасчетыСБюджетом.ФизЛицо,
		|	ФизлицаНеРезиденты.ФизЛицо";
		
		// ПрименениеВычетовВОрганизации
		//	Поля:
		//		Физлицо,
		//		Период
		//
		// Описание:
		//	Выбирает список физлиц + периодв в которые применяются стандартные вычеты по 
		//	заданной организации
		
		ПрименениеВычетовВОрганизацииТекст = 
		"ВЫБРАТЬ
		|	НДФЛПрименениеВычетовСрезПоследних.Физлицо КАК Физлицо,
		|	НДФЛПрименениеВычетовСрезПоследних.Период КАК Период
		|ИЗ
		|	(ВЫБРАТЬ
		|		МАКСИМУМ(НДФЛПрименениеВычетов.Период) КАК ПериодСреза,
		|		НДФЛПрименениеВычетов.Физлицо КАК Физлицо,
		//	|		Периоды.Физлицо КАК Физлицо,
		|		Периоды.Период КАК Период
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛПрименениеВычетов КАК НДФЛПрименениеВычетов
		|			ПО Периоды.Период >= НДФЛПрименениеВычетов.Период //И НДФЛПрименениеВычетов.Физлицо = Периоды.Физлицо
		
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НДФЛПрименениеВычетов.Физлицо,
		|		Периоды.Период) КАК НДФЛПрименениеВычетовСрезПоследних
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛПрименениеВычетов КАК НДФЛПрименениеВычетов
		|		ПО НДФЛПрименениеВычетов.Период = НДФЛПрименениеВычетовСрезПоследних.ПериодСреза И НДФЛПрименениеВычетов.Физлицо = НДФЛПрименениеВычетовСрезПоследних.Физлицо
		|
		|ГДЕ
		|	НДФЛПрименениеВычетов.Организация = &парамОрганизация";
		
		// НДФЛРазмерВычетов
		// Таблица "НДФЛРазмерВычетов": - таблица это список вычетов, их размер, ограничения по доходам
		// поля:
		//		Период, 
		//		КодВычета,
		//		Размер, 
		//		ОграничениеПоДоходам,
		// Описание:	
		//	Выбираем Из Список периодов (период - год)
		//	Левое соединение с НДФЛРазмерВычетов
		//	по равенству периодов
		// 
		
		// первый год
		НачМесяца = НачалоГода(ПервыйМесяцНалоговогоПериода);
		ПериодыТекстПоГодам = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период";
		Пока НачМесяца < НачалоМесяца(ПоследнийМесяцНалоговогоПериода) Цикл
			НачМесяца = НачалоМесяца(КонецМесяца(НачМесяца) + 1);
			ПериодыТекстПоГодам = ПериодыТекстПоГодам +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
		КонецЦикла;
		
		Запрос.Текст = ПериодыТекстПоГодам;
		//НДФЛРазмерВычетов =
		//"ВЫБРАТЬ
		//|	Периоды.Период КАК Период,
		//|	ЕСТЬNULL(НДФЛРазмерВычетов.КодВычета, 0) КАК КодВычета,
		//|	НДФЛРазмерВычетов.Размер КАК Размер,
		//|	НДФЛРазмерВычетов.ОграничениеПоДоходам КАК ОграничениеПоДоходам
		//|ИЗ
		//|	(ВЫБРАТЬ
		//|		Периоды.Период КАК Период,
		//|		НДФЛРазмерВычетов.КодВычета КАК КодВычета,
		//|		МАКСИМУМ(НДФЛРазмерВычетов.Период) КАК ПериодРегистра
		//|	ИЗ
		//|		("+ПериодыТекстПоГодам+") КАК Периоды
		//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов
		//|			ПО Периоды.Период >= НДФЛРазмерВычетов.Период
		//|	
		//|	СГРУППИРОВАТЬ ПО
		//|		Периоды.Период,
		//|		НДФЛРазмерВычетов.КодВычета) КАК Периоды
		//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов
		//|		ПО НДФЛРазмерВычетов.Период = Периоды.ПериодРегистра И Периоды.КодВычета = НДФЛРазмерВычетов.КодВычета ";
		
		БазовыеВеличиныПоМесяцам = 
		"ВЫБРАТЬ
		|	Периоды.Период КАК Период,
		|	БазоваяВеличинаРег.Размер    
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.Период КАК Период,
		|		МАКСИМУМ(БазоваяВеличинаРег.Период) КАК ПериодРегистра
		|	ИЗ
		|		("+ПериодыТекстПоГодам+") КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ КАК БазоваяВеличинарег
		|			ПО БазоваяВеличинарег.Период <= Периоды.Период И БазоваяВеличинаРег.ВидПараметра = &БазоваяВеличина
		|	СГРУППИРОВАТЬ ПО
		|		Периоды.Период) КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ КАК БазоваяВеличинарег
		|		ПО БазоваяВеличинарег.Период = Периоды.Периодрегистра И БазоваяВеличинаРег.ВидПараметра = &БазоваяВеличина";
		
		Запрос.Текст = БазовыеВеличиныПоМесяцам;
		
		НДФЛРазмерВычетов =
		"ВЫБРАТЬ
		|	Периоды.Период КАК Период,
		|	ВЫБОР КОГДА (НДФЛРазмерВычетов.КодВычета) ЕСТЬ NULL ТОГДА 0 ИНАЧЕ НДФЛРазмерВычетов.КодВычета КОНЕЦ КАК КодВычета,
		|	НДФЛРазмерВычетов.Размер * БазоваяВеличина.Размер КАК Размер,    
		|	НДФЛРазмерВычетов.ОграничениеПоДоходам КАК ОграничениеПоДоходам
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.Период КАК Период,
		|		НДФЛРазмерВычетов.КодВычета КАК КодВычета,
		|		МАКСИМУМ(НДФЛРазмерВычетов.Период) КАК ПериодРегистра
		|	ИЗ
		|		("+ПериодыТекстПоГодам+") КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов
		|			ПО Периоды.Период >= НДФЛРазмерВычетов.Период
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Периоды.Период,
		|		НДФЛРазмерВычетов.КодВычета) КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+БазовыеВеличиныПоМесяцам+") КАК БазоваяВеличина
		|		ПО БазоваяВеличина.Период = Периоды.Период 
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов
		|		ПО НДФЛРазмерВычетов.Период = Периоды.ПериодРегистра И Периоды.КодВычета = НДФЛРазмерВычетов.КодВычета ";
		
		Запрос.Текст =  НДФЛРазмерВычетов;
		// ПраваНаВычеты
		//	Поля:
		//		Физлицо
		//		Период
		//		СтандартныеВычетыЛичные
		//		СтандартныеВычетыДетские
		//
		//	Описание:
		//	Выбирает по всем периодам года стандартные вычеты на которые имеет право физлицо
		
		ПраваНаВычетыТекст = 
		"ВЫБРАТЬ
		|	НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо КАК Физлицо,
		|	НДФЛСтандартныеВычетыФизлицСрезПоследних.Период КАК Период,
		|	НДФЛРазмерВычетовЛичный.ОграничениеПоДоходам КАК ОграничениеПоДоходамЛичные,
		|	НДФЛРазмерВычетовНаДетей.ОграничениеПоДоходам КАК ОграничениеПоДоходамНаДетей,
		//	|	НДФЛРазмерВычетовНаДетейИнвалидов.ОграничениеПоДоходам КАК ОграничениеПоДоходамНаДетейИнвалидов,
		|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ЕСТЬNULL(НДФЛРазмерВычетовЛичный.Размер, 0) КОНЕЦ КАК СтандартныеВычетыЛичные,
		|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ЕСТЬNULL(НДФЛРазмерВычетовНаДетей.Размер, 0) * ЕСТЬNULL(ВычетыФизлиц.КоличествоДетей, 0) КОНЕЦ КАК СтандартныеВычетыДетские,
		|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ВЫБОР КОГДА (НДФЛРазмерВычетовНаДетейЛьгота.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛРазмерВычетовНаДетейЛьгота.Размер КОНЕЦ * ВЫБОР КОГДА (ВычетыФизлиц.КоличествоДетейЛьгота) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ВычетыФизлиц.КоличествоДетейЛьгота КОНЕЦ КОНЕЦ КАК СтандартныеВычетыДетскиеЛьгота,
		|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ВЫБОР КОГДА (НДФЛРазмерВычетовДополнительный.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛРазмерВычетовДополнительный.Размер КОНЕЦ КОНЕЦ КАК СтандартныеВычетыДополнительные,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ВЫБОР КОГДА (НДФЛРазмерВычетовМолодыеСпециалисты.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛРазмерВычетовМолодыеСпециалисты.Размер КОНЕЦ КОНЕЦ КАК СтандартныеВычетыМолодыеСпециалисты
		//Аверсон СВФР-012095
		
		|ИЗ
		|	(ВЫБРАТЬ
		|		МАКСИМУМ(ВычетыФизлиц.Период) КАК ПериодСреза,
		|		ВычетыФизЛиц.Физлицо КАК Физлицо,
		//	|		Периоды.Физлицо КАК Физлицо,
		|		Периоды.Период КАК Период
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛСтандартныеВычетыФизлиц КАК ВычетыФизлиц
		|			ПО ВычетыФизлиц.Период <= Периоды.Период И ВычетыФизлиц.Физлицо = Периоды.Физлицо
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВычетыФизЛиц.Физлицо,
		|		Периоды.Период) КАК НДФЛСтандартныеВычетыФизлицСрезПоследних
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛСтандартныеВычетыФизлиц КАК ВычетыФизлиц
		|		ПО ВычетыФизлиц.Период = НДФЛСтандартныеВычетыФизлицСрезПоследних.ПериодСреза И ВычетыФизлиц.Физлицо = НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовЛичный
		|		ПО НДФЛРазмерВычетовЛичный.КодВычета = ВычетыФизлиц.КодВычетаЛичный И НДФЛРазмерВычетовЛичный.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовНаДетей
		|		ПО НДФЛРазмерВычетовНаДетей.КодВычета = ВычетыФизлиц.КодВычетаНаДетей И НДФЛРазмерВычетовНаДетей.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовНаДетейЛьгота
		|		ПО НДФЛРазмерВычетовНаДетейЛьгота.КодВычета = ВычетыФизлиц.КодВычетаНаДетейЛьгота И НДФЛРазмерВычетовНаДетейЛьгота.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовДополнительный
		|		ПО НДФЛРазмерВычетовДополнительный.КодВычета = ВычетыФизлиц.КодВычетаДополнительный И НДФЛРазмерВычетовДополнительный.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095 
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовМолодыеСпециалисты
		|		ПО НДФЛРазмерВычетовМолодыеСпециалисты.КодВычета = ВычетыФизлиц.КодВычетаМолодыеСпециалисты И НДФЛРазмерВычетовМолодыеСпециалисты.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		//Аверсон СВФР-012095
		
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ПрименениеВычетовВОрганизацииТекст + ") КАК ПрименениеВычетов
		|		ПО ПрименениеВычетов.Физлицо = НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо И ПрименениеВычетов.Период = НДФЛСтандартныеВычетыФизлицСрезПоследних.Период";
		
		// ПрименяемыеВычеты
		// Поля:
		//		Физлицо
		//		Период
		//		ПрименяемыеВычетыЛичные
		//		ПрименяемыеВычетыДетские
		//
		//	Описание:
		//	Выбирает по всем периодам года применяемые стандартные вычеты
		//  с использованием ограничения по доходам
		
		//"ВЫБРАТЬ
		//|	РаботникиОргПраваНаВычеты.Физлицо КАК Физлицо,
		//|	РаботникиОргПраваНаВычеты.Период КАК Период,
		//|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные  ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные  = 0 ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные  ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыЛичные,
		//|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетей ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетей = 0 ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыДетские,
		//|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетейИнвалидов ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетейИнвалидов = 0 ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеИнвалидов ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыДетскиеИнвалидов
		//|ИЗ
		//|	(" + ПраваНаВычетыТекст + ") КАК РаботникиОргПраваНаВычеты
		//|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ДоходыЗаГодТекст + ") КАК ДоходыЗаГод
		//|		ПО ДоходыЗаГод.Период = РаботникиОргПраваНаВычеты.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо
		//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛДоходыПредыдущегоМестаРаботы КАК НДФЛДоходыПредыдущегоМестаРаботы
		//|		ПО (НДФЛДоходыПредыдущегоМестаРаботы.Организация = &парамОрганизация) И НДФЛДоходыПредыдущегоМестаРаботы.МесяцНалоговогоПериода = РаботникиОргПраваНаВычеты.Период И НДФЛДоходыПредыдущегоМестаРаботы.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо";
		
		ПрименяемыеВычетыТекст = 
		"ВЫБРАТЬ
		|	РаботникиОргПраваНаВычеты.Физлицо КАК Физлицо,
		|	РаботникиОргПраваНаВычеты.Период КАК Период,
		|	ДоходыЗаГод.ОблагаемыйДоходЗаГод КАК ДоходДляНалога, //+ НДФЛДоходыПредыдущегоМестаРаботы.Размер КАК ДоходДляНалога,
		//Минск н
		|	РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные КАК ПрименяемыеВычетыЛичные,
		|	РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские КАК ПрименяемыеВычетыДетские,
		|	РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота КАК ПрименяемыеВычетыДетскиеЛьгота,
		|	РаботникиОргПраваНаВычеты.СтандартныеВычетыДополнительные КАК ПрименяемыеВычетыДополнительные,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095 
		|	РаботникиОргПраваНаВычеты.СтандартныеВычетыМолодыеСпециалисты КАК ПрименяемыеВычетыМолодыеСпециалисты
		//Аверсон СВФР-012095
		
		//Минск к
		|ИЗ
		|	(" + ПраваНаВычетыТекст + ") КАК РаботникиОргПраваНаВычеты
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ДоходыЗаГодТекст + ") КАК ДоходыЗаГод
		|		ПО ДоходыЗаГод.Период = РаботникиОргПраваНаВычеты.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо";
		//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛДоходыПредыдущегоМестаРаботы КАК НДФЛДоходыПредыдущегоМестаРаботы
		//|		ПО (НДФЛДоходыПредыдущегоМестаРаботы.Организация = &парамОрганизация) И НДФЛДоходыПредыдущегоМестаРаботы.МесяцНалоговогоПериода = РаботникиОргПраваНаВычеты.Период И НДФЛДоходыПредыдущегоМестаРаботы.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо";
		
		// ПрименяемыеВычетыЗаГод
		//	Поля:
		//		Физлицо
		//		Период
		//		ВычетыЛичныеЗаГод
		//		ВычетыДетскиеЗаГод
		//
		//	Описание:
		//	Выбирает по всем периодам года применяемые стандартные вычеты нарастающим итогом за год
		//
		
		ПрименяемыеВычетыЗаГодТекст = 
		"ВЫБРАТЬ
		|	ВычетыПоПериодам.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыЛичные) КАК ВычетыЛичныеЗаГод,
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыДетские) КАК ВычетыДетскиеЗаГод,
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыДетскиеЛьгота) КАК ВычетыДетскиеЛьготаЗаГод,
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыДополнительные) КАК ВычетыДополнительныеЗаГод,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыМолодыеСпециалисты) КАК ВычетыМолодыеСпециалистыЗаГод
		//Аверсон СВФР-012095
		
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ПрименяемыеВычетыТекст + ") КАК ВычетыПоПериодам
		|		ПО (ВычетыПоПериодам.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период) И ВычетыПоПериодам.Физлицо = Периоды.Физлицо
		|
		|СГРУППИРОВАТЬ ПО
		|	ВычетыПоПериодам.Физлицо,
		|	Периоды.Период";
		
		// Приходы вычетов помесячные  
		Вычеты312ПоМесяцамТекст = 
		"ВЫБРАТЬ
		|	Остатки.ФизЛицо КАК ФизЛицо,
		|	Остатки.Период КАК Период,
		|	Остатки.Год КАК НалоговыйПериод,
		|	Остатки.РазмерНачальныйОстаток КАК Вычет312Остаток,
		|	0 КАК ОборотВычеты312,
		|	0 КАК ПримененныеВычеты312
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Год,
		|		,
		|		КодВычетаИмущественный = &КодВычета312
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Остатки
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Обороты.ФизЛицо,
		|	Обороты.Период,
		|	Обороты.Год,
		|	0,
		|	Обороты.РазмерПриход,
		|	Обороты.РазмерРасход
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Месяц,
		|		,
		|		КодВычетаИмущественный = &КодВычета312
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Обороты";
		
		Вычеты311ПоМесяцамТекст = 
		"ВЫБРАТЬ
		|	Остатки.ФизЛицо КАК ФизЛицо,
		|	Остатки.Период КАК Период,
		|	Остатки.Год КАК НалоговыйПериод,
		|	Остатки.РазмерНачальныйОстаток КАК Вычет311Остаток,
		|	0 КАК ОборотВычеты311,
		|	0 КАК ПримененныеВычеты311
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Год,
		|		,
		|		КодВычетаИмущественный = &КодВычета311
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Остатки
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Обороты.ФизЛицо,
		|	Обороты.Период,
		|	Обороты.Год,
		|	0,
		|	Обороты.РазмерПриход,
		|	Обороты.РазмерРасход
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Месяц,
		|		,
		|		КодВычетаИмущественный = &КодВычета311
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Обороты";
		
		// Приходы вычетов с начала года нарастающим итогом
		Вычеты312Текст = 
		"ВЫБРАТЬ
		|	Периоды.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		//|	СУММА(Обороты.Вычет312Остаток) КАК Вычет312Остаток,
		//|	СУММА(Обороты.ПримененныеВычеты312) КАК Вычет312ЗаГод,
		|	СУММА(ВЫБОР КОГДА НАЧАЛОПЕРИОДА(Обороты.Период, МЕСЯЦ) = Периоды.Период ТОГДА Обороты.ПримененныеВычеты312 ИНАЧЕ 0 КОНЕЦ) КАК Вычет312ЗаМесяц,
		|	СУММА(Обороты.ОборотВычеты312) КАК Вычет312Остаток,
		|	СУММА(Обороты.ПримененныеВычеты312) КАК Вычет312ЗаГод
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + Вычеты312ПоМесяцамТекст + ") КАК Обороты
		|		ПО Обороты.ФизЛицо = Периоды.Физлицо И Обороты.Период <= Периоды.Период И Обороты.Период >= НАЧАЛОПЕРИОДА(Периоды.Период, Год) 
		|
		|СГРУППИРОВАТЬ ПО
		|	Периоды.Физлицо,
		|	Периоды.Период";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = Вычеты312Текст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		
		Вычеты311Текст = 
		"ВЫБРАТЬ
		|	Периоды.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		//|	СУММА(Обороты.Вычет311Остаток) КАК Вычет311Остаток,
		//|	СУММА(Обороты.ПримененныеВычеты311) КАК Вычет311ЗаГод,
		|	СУММА(ВЫБОР КОГДА НАЧАЛОПЕРИОДА(Обороты.Период, МЕСЯЦ) = Периоды.Период ТОГДА Обороты.ПримененныеВычеты311 ИНАЧЕ 0 КОНЕЦ) КАК Вычет311ЗаМесяц,
		|	СУММА(Обороты.ОборотВычеты311) КАК Вычет311Остаток,
		|	СУММА(Обороты.ПримененныеВычеты311) КАК Вычет311ЗаГод
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + Вычеты311ПоМесяцамТекст + ") КАК Обороты
		|		ПО Обороты.ФизЛицо = Периоды.Физлицо И Обороты.Период <= Периоды.Период И Обороты.Период >= НАЧАЛОПЕРИОДА(Периоды.Период, Год) 
		|
		|СГРУППИРОВАТЬ ПО
		|	Периоды.Физлицо,
		|	Периоды.Период";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = Вычеты311Текст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		// облагаемый доход с начала года
		ПолеОблагаемыйДоходЗаГод = "ЕСТЬNULL(ДоходыЗаГод.ОблагаемыйДоходЗаГод, 0)";
		
		// право на личный вычет за год
		ПолеВычетыЛичныеЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыЛичныеЗаГод, 0)";
		
		// право на вычет на детей за год
		ПолеВычетыДетскиеЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЗаГод, 0)";
		ПолеВычетыДетскиеЛьготаЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЛьготаЗаГод, 0)";
		ПолеВычетыДополнительныеЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДополнительныеЗаГод, 0)";
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		ПолеВычетыМолодыеСпециалистыЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыМолодыеСпециалистыЗаГод, 0)";
		//Аверсон СВФР-012095
		
		ПолеВычет312Остаток = "ЕСТЬNULL(Вычеты312.Вычет312Остаток, 0)";
		
		ПолеВычет311Остаток = "ЕСТЬNULL(Вычеты311.Вычет311Остаток, 0)";
		
		//// размер вычета на детей с начала года
		//ПолеПримененныеВычетыДетские = 
		//"ВЫБОР 
		//|	КОГДА ДоходыЗаГод.Резидент 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыДетскиеЗаГод + " 
		//|				ТОГДА " + ПолеВычетыДетскиеЗаГод +" 
		//|			ИНАЧЕ " + ПолеОблагаемыйДоходЗаГод + "
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		
		//ПолеПримененныеВычетыДетскиеИнвалидов = 
		//"ВЫБОР 
		//|	КОГДА ДоходыЗаГод.Резидент 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеИнвалидовЗаГод + " 
		//|				ТОГДА " + ПолеВычетыДетскиеИнвалидовЗаГод +" 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыДетскиеЗаГод + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " 
		//|			ИНАЧЕ 0 
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		//// размер примененного вычета на себя с начала года
		//ПолеПримененныеВычетыЛичные = 
		//"ВЫБОР 
		//|	КОГДА ДоходыЗаГод.Резидент 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеИнвалидовЗаГод + " 
		//|				ТОГДА " + ПолеВычетыЛичныеЗаГод + " 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод +" > "  + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеИнвалидовЗаГод + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " - " + ПолеВычетыДетскиеИнвалидовЗаГод + " 
		//|			ИНАЧЕ 0 
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		//// размер вычета по коду 312
		//ПолеПримененныеВычеты312 = 
		//"ВЫБОР 
		//|	КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеПримененныеВычетыЛичные + " + " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеВычет312Остаток + " > " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|			ИНАЧЕ " + ПолеВычет312Остаток + "
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		//// размер вычета по коду 311
		//ПолеПримененныеВычеты311 = 
		//"ВЫБОР 
		//|	КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеПримененныеВычеты312 + " + " + ПолеПримененныеВычетыЛичные + " + " + ПолеПримененныеВычетыДетские + " + " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеВычет311Остаток + " > " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|			ИНАЧЕ " + ПолеВычет311Остаток + "
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		
		// размер примененного вычета на себя с начала года
		ПолеПримененныеВычетыЛичные = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " 
		|			ТОГДА " + ПолеВычетыЛичныеЗаГод + " 
		|			ИНАЧЕ " + ПолеОблагаемыйДоходЗаГод + "
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		// размер вычета на детей с начала года
		ПолеПримененныеВычетыДетские = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " 
		|			ТОГДА " + ПолеВычетыДетскиеЗаГод +" 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыЛичныеЗаГод + " 
		|			ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыЛичныеЗаГод + " 
		|			ИНАЧЕ 0 
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		//Минск н
		// размер вычета дополнительный с начала года
		ПолеПримененныеВычетыДетскиеЛьгота = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " 
		|			ТОГДА " + ПолеВычетыДетскиеЛьготаЗаГод +" 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " 
		|			ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыЛичныеЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " 
		|			ИНАЧЕ 0 
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		
		ПолеПримененныеВычетыДополнительные = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " >= " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " + " + ПолеВычетыДополнительныеЗаГод + " 
		|			ТОГДА " + ПолеВычетыДополнительныеЗаГод +" 
		|			ИНАЧЕ ВЫБОР КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " 
		|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыЛичныеЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " - " + ПолеВычетыДетскиеЛьготаЗаГод + " 
		|				ИНАЧЕ 0 КОНЕЦ
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		ПолеПримененныеВычетыМолодыеСпециалисты = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " >= " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " + " + ПолеВычетыДополнительныеЗаГод + " + " + ПолеВычетыМолодыеСпециалистыЗаГод + " 
		|			ТОГДА " + ПолеВычетыМолодыеСпециалистыЗаГод +" 
		|			ИНАЧЕ ВЫБОР КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " + " + ПолеВычетыДополнительныеЗаГод + " 
		|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыЛичныеЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " - " + ПолеВычетыДетскиеЛьготаЗаГод + " - " + ПолеВычетыДополнительныеЗаГод + " 
		|				ИНАЧЕ 0 КОНЕЦ
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		//Аверсон СВФР-012095
		
		//Минск к
		// размер вычета по коду 312
		//Изменен Минск  добавлены Вычеты дополнительные - 10 базовых величин для определенных категорий граждан
		ПолеПримененныеВычеты312 = 
		"ВЫБОР 
		|	КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеПримененныеВычетыЛичные + " + " + ПолеПримененныеВычетыДетские + " + " + ПолеПримененныеВычетыДетскиеЛьгота + " + " + ПолеПримененныеВычетыДополнительные + " + " + ПолеПримененныеВычетыМолодыеСпециалисты + " //Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеВычет312Остаток + " > " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " - " + ПолеПримененныеВычетыМолодыеСпециалисты + " //Аверсон ЕАЕ 12.01.2024 СВФР-012095 
		|			ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " - " + ПолеПримененныеВычетыМолодыеСпециалисты + " //Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|			ИНАЧЕ " + ПолеВычет312Остаток + "
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		
		// размер вычета по коду 311
		ПолеПримененныеВычеты311 = 
		"ВЫБОР 
		|	КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеПримененныеВычеты312 + " + " + ПолеПримененныеВычетыЛичные + " + " + ПолеПримененныеВычетыДетскиеЛьгота + " + " + ПолеПримененныеВычетыДетские + " + " + ПолеПримененныеВычетыДополнительные+ " + " + ПолеПримененныеВычетыМолодыеСпециалисты + " //Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеВычет311Остаток + " > " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " - " + ПолеПримененныеВычетыМолодыеСпециалисты + " //Аверсон ЕАЕ 12.01.2024 СВФР-012095 
		|			ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " - " + ПолеПримененныеВычетыМолодыеСпециалисты + " //Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|			ИНАЧЕ " + ПолеВычет311Остаток + "
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		
		
		// сумма налога исчисленная
		ПолеНалогИсчисленный = 
		"(ВЫРАЗИТЬ(ВЫБОР 
		|				КОГДА ДоходыЗаГод.Резидент 
		|				ТОГДА (" + ПолеОблагаемыйДоходЗаГод +" - "+ ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " - " + ПолеПримененныеВычетыМолодыеСпециалисты + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычеты311+ ") //Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|				ИНАЧЕ ЕСТЬNULL(ДоходыЗаГод.НалогНерезидента, 0)
		|				КОНЕЦ КАК " + ТипЗначенияНДФЛТекст + "))";
		
		// сумма ранее исчисленного налога
		ПолеРанееНалогИсчисленный = 
		"ВЫБОР 
		|	КОГДА НДФЛРасчетыСБюджетомЗаГод.ИсчисленныйНалогЗаГод = -99999999 
		|	ТОГДА 0 
		|	ИНАЧЕ ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ИсчисленныйНалогЗаГод, 0) 
		|КОНЕЦ";
		
		// сумма ранее примененных вычетов личных
		ПолеРанееПримененныеВычетыЛичные = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПримененныеВычетыЛичныеЗаГод, 0)";
		ПолеРанееПримененныеВычетыЛичныеЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПримененныеВычетыЛичныеЗаМесяц, 0)";
		
		// сумма ранее примененных вычетов на детей
		ПолеРанееПримененныеВычетыДетские = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДетскиеЗаГод, 0)";
		ПолеРанееПримененныеВычетыДетскиеЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДетскиеЗаМесяц, 0)";
		ПолеРанееПримененныеВычетыДетскиеЛьгота = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДетскиеЛьготаЗаГод, 0)";
		ПолеРанееПримененныеВычетыДетскиеЛьготаЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДетскиеЛьготаЗаМесяц, 0)";
		ПолеРанееПримененныеВычетыДополнительные = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДополнительныеЗаГод, 0)";
		ПолеРанееПримененныеВычетыДополнительныеЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДополнительныеЗаМесяц, 0)";
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		ПолеРанееПримененныеВычетыМолодыеСпециалисты = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыМолодыеСпециалистыЗаГод, 0)";
		ПолеРанееПримененныеВычетыМолодыеСпециалистыЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыМолодыеСпециалистыЗаМесяц, 0)";
		//Аверсон СВФР-012095
		
		// сумма ранее примененных вычетов по коду 312
		ПолеРанееПримененныеВычеты312 = "ЕСТЬNULL(Вычеты312.Вычет312ЗаГод, 0)";
		ПолеРанееПримененныеВычеты312ЗаМесяц = "ЕСТЬNULL(Вычеты312.Вычет312ЗаМесяц, 0)";
		
		// сумма ранее примененных вычетов по коду 311
		ПолеРанееПримененныеВычеты311 = "ЕСТЬNULL(Вычеты311.Вычет311ЗаГод, 0)";
		ПолеРанееПримененныеВычеты311ЗаМесяц = "ЕСТЬNULL(Вычеты311.Вычет311ЗаМесяц, 0)";
		
		Если КомментироватьРасчет Тогда
			ДоходыПоВидамРасчетаТекст = "
			|ВЫБРАТЬ
			|	НДФЛСведенияОДоходах.ДоходЗаМесяц КАК ДоходЗаМесяц,
			|	НДФЛСведенияОДоходах.ВычетЗаМесяц КАК ВычетЗаМесяц,
			|	СУММА(ДоходыПоВидамРасчета.Результат) КАК ДоходЗаМесяцПоВидамРасчета,
			|	НДФЛСведенияОДоходах.Физлицо КАК Физлицо,
			|	ДоходыПоВидамРасчета.ВидРасчета КАК ВидРасчета,
			|	ДоходыПоВидамРасчета.ВидРасчета.Наименование КАК ВидРасчетаНаименование,
			|	НДФЛСведенияОДоходах.Период КАК Период
			|ИЗ
			|	(ВЫБРАТЬ
			|		СУММА(НДФЛСведенияОДоходах.СуммаДохода) КАК ДоходЗаМесяц,
			|		СУММА(НДФЛСведенияОДоходах.СуммаВычета) КАК ВычетЗаМесяц,
			|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо,
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) КАК Период
			|	ИЗ
			|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|			ПО (Месяцы.Период = НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ))
			|	ГДЕ
			|		НДФЛСведенияОДоходах.ФизЛицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
			|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НДФЛСведенияОДоходах.ФизЛицо,
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)) КАК НДФЛСведенияОДоходах
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			Начисления.Результат КАК Результат,
			|			Начисления.ФизЛицо КАК Физлицо,
			|			Начисления.ВидРасчета КАК ВидРасчета,
			|			ВЫБОР
			|				КОГДА Начисления.ВидРасчета.КодДоходаНДФЛ = &КодОплатыТрудаПоНДФЛ
			|					ТОГДА Начисления.ПериодРегистрации
			|				ИНАЧЕ Начисления.ПериодДействия
			|			КОНЕЦ КАК Период
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Начисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|				ПО (Месяцы.Период = ВЫБОР
			|						КОГДА Начисления.ВидРасчета.КодДоходаНДФЛ <> &КодОплатыТрудаПоНДФЛ
			|							ТОГДА Начисления.ПериодРегистрации
			|						ИНАЧЕ Начисления.ПериодДействия
			|					КОНЕЦ)
			|		ГДЕ
			|			Начисления.ВидРасчета.КодДоходаНДФЛ <> &ПустойКодДохода
			|			И Начисления.ФизЛицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
			|			И Начисления.Организация = &парамОрганизация
			|		
			|		ОБЪЕДИНИТЬ ВСЕ
			|		
			|		ВЫБРАТЬ
			|			Начисления.Результат,
			|			Начисления.ФизЛицо,
			|			Начисления.ВидРасчета,
			|			НАЧАЛОПЕРИОДА(Начисления.ПериодРегистрации, МЕСЯЦ)
			|		ИЗ
			|			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Начисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|				ПО (Месяцы.Период = НАЧАЛОПЕРИОДА(Начисления.ПериодРегистрации, МЕСЯЦ))
			|		ГДЕ
			|			Начисления.ВидРасчета.КодДоходаНДФЛ <> &ПустойКодДохода
			|			И Начисления.ФизЛицо  В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
			|			И Начисления.Организация = &парамОрганизация) КАК ДоходыПоВидамРасчета
			|		ПО ДоходыПоВидамРасчета.Период = НДФЛСведенияОДоходах.Период
			|			И ДоходыПоВидамРасчета.Физлицо = НДФЛСведенияОДоходах.Физлицо
			|
			|СГРУППИРОВАТЬ ПО
			|	НДФЛСведенияОДоходах.ДоходЗаМесяц,
			|	НДФЛСведенияОДоходах.ВычетЗаМесяц,
			|	НДФЛСведенияОДоходах.Физлицо,
			|	НДФЛСведенияОДоходах.Период,
			|	ДоходыПоВидамРасчета.ВидРасчета,
			|	ДоходыПоВидамРасчета.ВидРасчета.Наименование";
			Запрос.УстановитьПараметр("ПустойКодДохода" , Справочники.ДоходыНДФЛ.ПустаяСсылка());
			Запрос.УстановитьПараметр("КодОплатыТрудаПоНДФЛ", Справочники.ДоходыНДФЛ.КодДоходаПоУмолчанию);
			
		КонецЕсли;
		// ИсчисленныйНДФЛ
		//	Поля:
		//		Физлицо
		//		Период
		//		НалогУжеИсчисленный
		//		НалогИсчисленный
		//		ПримененныеВычетыЛичные
		//		ПолеПримененныеВычетыДетские
		//		ПолеПримененныеВычетыДетскиеИнвалидов
		//	    ПримененныеВычеты312
		//	    ПримененныеВычеты311
		//	
		//	Описание:
		//	Выбирает применяемые вычеты нарастающим итогом, доход нарастающим итогом и 
		//	исчисленный налог нарастающим итогом и производит расчет налога и примененных вычетов
		
		ИсчисленныйНДФЛТекст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ДоходыЗаГод.Физлицо КАК Физлицо,
		|	ДоходыЗаГод.Период КАК Период,
		|	ЕСТЬNULL(ДоходыЗаГод.Резидент, ИСТИНА) КАК Резидент,
		|	" + ПолеРанееНалогИсчисленный + " КАК НалогРанееИсчисленный,         //Минск
		//|	" + ПолеНалогИсчисленный + " КАК ПолеНалогИсчисленный,         //Минск
		|	" + ПолеОблагаемыйДоходЗаГод + " КАК ДоходЗаГод,                     //Минск
		//|	" + ПолеНалогНерезидентаЗаГод + " КАК НалогНерезидентаЗаГод,         //Минск
		|	" + ПолеПримененныеВычетыЛичные + "  КАК ПримененныеВычетыЛичные,    //Минск
		|	" + ПолеПримененныеВычетыДетские + " КАК ПримененныеВычетыДетские,   //Минск
		|	" + ПолеПримененныеВычетыДетскиеЛьгота + " КАК ПримененныеВычетыДетскиеЛьгота,   //Минск
		|	" + ПолеПримененныеВычетыДополнительные + " КАК ПримененныеВычетыДополнительные, //Минск
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	" + ПолеПримененныеВычетыМолодыеСпециалисты + " КАК ПримененныеВычетыМолодыеСпециалисты, 
		//Аверсон СВФР-012095
		
		|	" + ПолеПримененныеВычеты312 + " КАК ПримененныеВычеты312,  //Минск
		|	" + ПолеПримененныеВычеты311 + " КАК ПримененныеВычеты311";   //Минск
		//|	" + ПолеНалогИсчисленный + "-" + ПолеРанееНалогИсчисленный + " КАК НалогИсчисленный,
		//|	" + ПолеПримененныеВычетыЛичные + " КАК ПримененныеВычетыЛичные,
		//|	" + ПолеПримененныеВычетыДетские + " КАК ПримененныеВычетыДетские,
		//|	" + ПолеПримененныеВычетыДетскиеИнвалидов + " КАК ПримененныеВычетыДетскиеИнвалидов,
		//|	" + ПолеПримененныеВычеты312 + " КАК ПримененныеВычеты312,
		//|	" + ПолеПримененныеВычеты311 + " КАК ПримененныеВычеты311,
		//|	" + ПолеРанееПримененныеВычетыЛичные + " КАК РанееПримененныеВычетыЛичные,
		//|	" + ПолеРанееПримененныеВычетыДетские + " КАК РанееПримененныеВычетыДетские,
		//|	" + ПолеРанееПримененныеВычетыДетскиеИнвалидов + " КАК РанееПримененныеВычетыДетскиеИнвалидов,
		//|	" + ПолеРанееПримененныеВычеты312 + " КАК РанееПримененныеВычеты312,
		//|	" + ПолеРанееПримененныеВычеты311 + " КАК РанееПримененныеВычеты311,
		//|	" + ПолеРанееПримененныеВычетыЛичныеЗаМесяц + " КАК РанееПримененныеВычетыЛичныеЗаМесяц,
		//|	" + ПолеРанееПримененныеВычетыДетскиеЗаМесяц + " КАК РанееПримененныеВычетыДетскиеЗаМесяц,
		//|	" + ПолеРанееПримененныеВычетыДетскиеИнвалидовЗаМесяц + " КАК РанееПримененныеВычетыДетскиеИнвалидовЗаМесяц,
		//|	" + ПолеРанееПримененныеВычеты312ЗаМесяц + " КАК РанееПримененныеВычеты312ЗаМесяц,
		//|	" + ПолеРанееПримененныеВычеты311ЗаМесяц + " КАК РанееПримененныеВычеты311ЗаМесяц";
		Если КомментироватьРасчет Тогда
			ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + ",
			|	" + ПолеОблагаемыйДоходЗаГод + " КАК ОблагаемыйДоходЗаГод,
			|	" + ПолеРанееНалогИсчисленный + " КАК РанееНалогИсчисленный,
			|	ЕСТЬNULL(ДоходыПоВидамРасчета.ДоходЗаМесяц, 0) КАК ДоходЗаМесяц,
			|	ЕСТЬNULL(ДоходыПоВидамРасчета.ВычетЗаМесяц, 0) КАК ВычетЗаМесяц,
			|	ЕСТЬNULL(ДоходыПоВидамРасчета.ДоходЗаМесяцПоВидамРасчета, 0) КАК ДоходЗаМесяцПоВидамРасчета,
			|	ДоходыПоВидамРасчета.ВидРасчета КАК ВидРасчета,
			|	ДоходыПоВидамРасчета.ВидРасчета.Наименование КАК ВидРасчетаНаименование";
		КонецЕсли;
		ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + "
		|ИЗ
		|	("+ДоходыЗаГодТекст+") КАК ДоходыЗаГод
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+НДФЛРасчетыСБюджетомЗаГодТекст+") КАК НДФЛРасчетыСБюджетомЗаГод
		|		ПО НДФЛРасчетыСБюджетомЗаГод.Период = ДоходыЗаГод.Период И НДФЛРасчетыСБюджетомЗаГод.ФизЛицо = ДоходыЗаГод.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ПрименяемыеВычетыЗаГодТекст+") КАК РаботникиОргВычетыЗаГод
		|		ПО ДоходыЗаГод.Период = РаботникиОргВычетыЗаГод.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты312Текст+") КАК Вычеты312
		|		ПО Вычеты312.Период = ДоходыЗаГод.Период И Вычеты312.ФизЛицо = ДоходыЗаГод.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты311Текст+") КАК Вычеты311
		|		ПО Вычеты311.Период = ДоходыЗаГод.Период И Вычеты311.ФизЛицо = ДоходыЗаГод.ФизЛицо";
		//|	("+ПрименяемыеВычетыЗаГодТекст+") КАК РаботникиОргВычетыЗаГод
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+НДФЛРасчетыСБюджетомЗаГодТекст+") КАК НДФЛРасчетыСБюджетомЗаГод
		//|		ПО НДФЛРасчетыСБюджетомЗаГод.Период = РаботникиОргВычетыЗаГод.Период И НДФЛРасчетыСБюджетомЗаГод.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ДоходыЗаГодТекст+") КАК ДоходыЗаГод
		//|		ПО ДоходыЗаГод.Период = РаботникиОргВычетыЗаГод.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты312Текст+") КАК Вычеты312
		//|		ПО Вычеты312.Период = РаботникиОргВычетыЗаГод.Период И Вычеты312.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты311Текст+") КАК Вычеты311
		//|		ПО Вычеты311.Период = РаботникиОргВычетыЗаГод.Период И Вычеты311.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо";
		Если КомментироватьРасчет Тогда
			ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + "
			|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ДоходыПоВидамРасчетаТекст + ") КАК ДоходыПоВидамРасчета
			|		ПО ДоходыПоВидамРасчета.Период = РаботникиОргВычетыЗаГод.Период 
			|		И ДоходыПоВидамРасчета.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо";
		КонецЕсли;
		ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + "
		|
		|	УПОРЯДОЧИТЬ ПО ДоходыЗаГод.Физлицо, доходыЗаГод.Период";
		//|	ГДЕ
		//|		(" + ПолеНалогИсчисленный + " <> " + ПолеРанееНалогИсчисленный + " ИЛИ 
		//|		" + ПолеПримененныеВычеты312 + " <> " + ПолеРанееПримененныеВычеты312 + " ИЛИ 
		//|		" + ПолеПримененныеВычеты311 + " <> " + ПолеРанееПримененныеВычеты311 + " ИЛИ 
		//|		" + ПолеПримененныеВычетыЛичные + " <> " + ПолеРанееПримененныеВычетыЛичные + " ИЛИ 
		//|		" + ПолеПримененныеВычетыДетские + " <> " + ПолеРанееПримененныеВычетыДетские + " ИЛИ
		//|		" + ПолеПримененныеВычетыДетскиеИнвалидов + " <> " + ПолеРанееПримененныеВычетыДетскиеИнвалидов +")
		//|	УПОРЯДОЧИТЬ ПО РаботникиОргВычетыЗаГод.Физлицо.Наименование, РаботникиОргВычетыЗаГод.Период";
		Если КомментироватьРасчет Тогда
			ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + "
			|	ИТОГИ 
			|		МАКСИМУМ(Физлицо),
			|		МАКСИМУМ(Период),
			|		МАКСИМУМ(Резидент),
			|		МАКСИМУМ(ДоходЗаГод),
			|		МАКСИМУМ(НалогРанееИсчисленный),
			|		МАКСИМУМ(ПримененныеВычетыЛичные),
			|		МАКСИМУМ(ПримененныеВычетыДетские),
			|		МАКСИМУМ(ПримененныеВычетыДетскиеЛьгота),
			|		МАКСИМУМ(ПримененныеВычетыДополнительные),
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			|		МАКСИМУМ(ПримененныеВычетыМолодыеСпециалисты),
			//Аверсон СВФР-012095
			
			|		МАКСИМУМ(ПримененныеВычеты312),
			|		МАКСИМУМ(ПримененныеВычеты311),
			//|		МАКСИМУМ(РанееПримененныеВычетыЛичные),
			//|		МАКСИМУМ(РанееПримененныеВычетыДетские),
			//|		МАКСИМУМ(РанееПримененныеВычетыДетскиеИнвалидов),
			//|		МАКСИМУМ(РанееПримененныеВычеты312),
			//|		МАКСИМУМ(РанееПримененныеВычеты311),
			//|		МАКСИМУМ(РанееПримененныеВычетыЛичныеЗаМесяц),
			//|		МАКСИМУМ(РанееПримененныеВычетыДетскиеЗаМесяц),
			//|		МАКСИМУМ(РанееПримененныеВычетыДетскиеИнвалидовЗаМесяц),
			//|		МАКСИМУМ(РанееПримененныеВычеты312ЗаМесяц),
			//|		МАКСИМУМ(РанееПримененныеВычеты311ЗаМесяц),
			|		МАКСИМУМ(ОблагаемыйДоходЗаГод),
			|		МАКСИМУМ(РанееНалогИсчисленный),
			|		МАКСИМУМ(ДоходЗаМесяц),
			|		МАКСИМУМ(ВычетЗаМесяц),
			|		СУММА(ДоходЗаМесяцПоВидамРасчета)
			|	ПО
			|		Период";
		КонецЕсли;
		
		Запрос.Текст = ПодразделенияПоМесяцамТекст;
		ВыборкаПодразделений = Запрос.Выполнить().Выбрать();
		
		Запрос.Текст = ИсчисленныйНДФЛТекст;
		
		Возврат Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	Иначе                                         
		ЗапросДата = Новый запрос;
		ЗапросДата.Текст = 
		"ВЫБРАТЬ
		| РазмерыПараметровДляРасчетаРБСрезПоследних.Период,
		| РазмерыПараметровДляРасчетаРБСрезПоследних.ВидПараметра,
		| РазмерыПараметровДляРасчетаРБСрезПоследних.Размер
		|ИЗ
		| РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних(&ПериодРегистрации) КАК РазмерыПараметровДляРасчетаРБСрезПоследних
		|ГДЕ
		| РазмерыПараметровДляРасчетаРБСрезПоследних.ВидПараметра = &ВидПараметра";
		ЗапросДата.УстановитьПараметр("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.ДатаНачалаПодоходного);
		ЗапросДата.УстановитьПараметр("ПериодРегистрации",КонецМесяца(ПериодРегистрации));
		Результат = ЗапросДата.Выполнить().Выбрать();
		Пока Результат.Следующий() цикл
			
			ДатаПодоходного = Результат.Период;
			
		КонецЦикла;
		если не ЗначениеЗаполнено(ДатаПодоходного) тогда
			
			ПериодРег = НачалоГода(ПервыйМесяцНалоговогоПериода);
			
		ИначеЕсли Год(ПериодРегистрации)> Год(ДатаПодоходного) тогда
			
			ПериодРег = ДатаПодоходного;//НачалоГода(ПервыйМесяцНалоговогоПериода);//О.Т. 12.02.2015(Переделали на дату подоходного) 
			
		иначе
			ПериодРег = ДатаПодоходного;  
		КонецЕсли;
		
		
		Запрос.УстановитьПараметр("парамСтавка13",                     Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13);
		//Запрос.УстановитьПараметр("парамСтавкаРезидента13", ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛотСтавкиНалогообложенияРезидента(Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13) / 100);
		
		Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ПериодРегистрации));
		//Островская Татьяна 14.11.2012 № 15
		
		Запрос.УстановитьПараметр("парамМесяцаНалоговогоПер1", КонецМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("ВидДвиженияРасход", ВидДвиженияНакопления.Расход);
		Запрос.УстановитьПараметр("парамКонецМесяцаПериодРегистрации", КонецМесяца(ПериодРегистрации));  
		Запрос.УстановитьПараметр("парамМесяцаНалоговогоПер", НачалоМесяца(ПериодРегистрации));
		
		если СсылкаОтчет Тогда 
			Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ПериодРегистрации));
			Запрос.УстановитьПараметр("парамНачалоГода",                   НачалоМесяца(ПериодРегистрации));
			Запрос.УстановитьПараметр("парамКонецГода",                    КонецМесяца(ПериодРегистрации));
		Иначе 
			Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ПоследнийМесяцНалоговогоПериода));
			Запрос.УстановитьПараметр("парамНачалоГода",                   ПериодРег);
			Запрос.УстановитьПараметр("парамКонецГода",                    КонецГода(ПоследнийМесяцНалоговогоПериода));
		КонецЕсли;
		
		//Островская Татьяна 14.11.2012 № 15
		
		Запрос.УстановитьПараметр("парамПриход",                       ВидДвиженияНакопления.Приход);
		Запрос.УстановитьПараметр("парамВидСтроки",                    Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
		Запрос.УстановитьПараметр("БазоваяВеличина",                   Перечисления.ВидыПараметровДляРасчетаЗарплаты.БазоваяВеличина);
		
		Запрос.УстановитьПараметр("КодВычета312", Справочники.ВычетыНДФЛ.Код640);
		Запрос.УстановитьПараметр("КодВычета311", Справочники.ВычетыНДФЛ.Код650);
		Запрос.УстановитьПараметр("КодВычета640Страх", Справочники.ВычетыНДФЛ.Код640Страх);
		Запрос.УстановитьПараметр("КодВычета641Страх", Справочники.ВычетыНДФЛ.Код641Страх); //Аверсон 03.08.2023 КВВ СВФР-011182
		
		КодыВычетовРезидентов = Новый Массив;
		//Вычеты (льготы) кратные базовой величине
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код500);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код510);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код520);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код530);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код540);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код550);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код560);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код570);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код571);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код580);
		//Расходы по авторским
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код404);
		КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код405);
		Запрос.УстановитьПараметр("КодыВычетовРезидентов", КодыВычетовРезидентов);
		
		
		НачМесяца = НачалоГода(ПервыйМесяцНалоговогоПериода);
		ДатыПоМесяцамТекст = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период";
		ДатыПоМесяцамТекстД = ДатыПоМесяцамТекст;
		ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +"
		|ПОМЕСТИТЬ ВТДатыПоМесяцам";
		Пока НачМесяца < НачалоМесяца(ПоследнийМесяцНалоговогоПериода) Цикл
			НачМесяца = НачалоМесяца(КонецМесяца(НачМесяца) + 1);
			ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
			ДатыПоМесяцамТекстД = ДатыПоМесяцамТекстД +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
		КонецЦикла;
		ДатыПоМесяцамТекст = ДатыПоМесяцамТекст +"
		|ИНДЕКСИРОВАТЬ ПО Период";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = ДатыПоМесяцамТекстД;
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		Запрос.Текст = ДатыПоМесяцамТекст;
		Запрос.Выполнить();
		
		// Периоды
		// Таблица список периодов-физлиц по которым необходимо выполнить расчет налога
		// Поля:
		//		Период
		//		Физлицо
		
		Если ЭтоПерерасчет Тогда
			
			ПериодыТекст = 
			"ВЫБРАТЬ
			|	Работники.Физлицо,
			|	Месяцы.Период
			//|ПОМЕСТИТЬ ВТПериоды
			|ИЗ
			|	ВТСписокФизЛиц КАК Работники
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|		ПО (ИСТИНА) ";
			//|ИНДЕКСИРОВАТЬ ПО Физлицо, Период";
			
			//ПериодыТекст1 = 
			//"ВЫБРАТЬ
			//|	Работники.Физлицо,
			//|	Месяцы.Период
			//|ИЗ
			//|	ВТСписокФизЛиц КАК Работники
			//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			//|		ПО (ИСТИНА)";
		Иначе  //Островская Татьяна 09.10.2013 № 16727
			ПериодыТекст = 
			"ВЫБРАТЬ
			|	ПериодыДохода.ФизЛицо,
			|	Месяцы.Период
			//|ПОМЕСТИТЬ ВТПериоды
			|ИЗ
			|	(ВЫБРАТЬ
			|		НДФЛСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|		МАКСИМУМ(НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)) КАК ПериодМакс,
			|		МИНИМУМ(ВЫБОР
			|				КОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|					ТОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, ГОД)
			|				ИНАЧЕ &парамНачалоГодаРегистрации
			|			КОНЕЦ) КАК ПериодМин
			|	ИЗ
			|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК Работники
			|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
			|	ГДЕ
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ)МЕЖДУ &парамНачалоГодаРегистрации И &парамПериодРегистрации
			|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НДФЛСведенияОДоходах.ФизЛицо) КАК ПериодыДохода
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|		ПО (Месяцы.Период МЕЖДУ ПериодыДохода.ПериодМин И ПериодыДохода.ПериодМакс)";
			//|ИНДЕКСИРОВАТЬ ПО Физлицо, Период";
			//
			ПериодыТекст1 = 
			"ВЫБРАТЬ
			|	ПериодыДохода.ФизЛицо,
			|	Месяцы.Период
			|ИЗ
			|	(ВЫБРАТЬ
			|		НДФЛСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|		МАКСИМУМ(НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)) КАК ПериодМакс,
			|		МИНИМУМ(ВЫБОР
			|				КОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|					ТОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, ГОД)
			|				ИНАЧЕ &парамНачалоГодаРегистрации
			|			КОНЕЦ) КАК ПериодМин
			|	ИЗ
			|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК Работники
			|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
			|	ГДЕ
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ)  = &парамПериодРегистрации 
			|		ИЛИ НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)  = &парамПериодРегистрации 
			|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НДФЛСведенияОДоходах.ФизЛицо) КАК ПериодыДохода
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|		ПО (Месяцы.Период МЕЖДУ ПериодыДохода.ПериодМин И ПериодыДохода.ПериодМакс)";
		КонецЕсли;
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = ПериодыТекст1;
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		
		Запрос.Текст = ПериодыТекст;
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		РезПериоды = Запрос.Выполнить().Выбрать();
		
		//Аверсон 12.05.2023 КВВ СВФР-010826 (
		//Запрос.УстановитьПараметр("НужныйГод",Год(ПериодРегистрации)); //Аверсон 04.02.2023 КВВ СВФР-010286
		СписокНужныхЛет = Новый СписокЗначений;
		Резз = Запрос.Выполнить().Выгрузить();
		Для Каждого СтррРезз ИЗ Резз Цикл
			Год_ = Год(СтррРезз.Период);
			Если СписокНужныхЛет.НайтиПоЗначению(Год_) = Неопределено Тогда
				СписокНужныхЛет.Добавить(Год_);
			КонецЕсли;
		КонецЦикла;
		Запрос.УстановитьПараметр("спНужныйГод",СписокНужныхЛет);
		//Аверсон 12.05.2023 КВВ СВФР-010826 )
		
		ТаблицаРазмерВычетов = Новый ТаблицаЗначений;
		
		Таблица = Новый ТаблицаЗначений;
		
		Массив = Новый Массив; 
		КЧ = Новый КвалификаторыЧисла(10, 0);
		КД = Новый КвалификаторыДаты();
		Массив.Добавить(Тип("Число"));
		//Массив.Добавить(Тип("СправочникСсылка.ФизическиеЛица"));
		Массив.Добавить(Тип("Дата"));
		ОписаниеТиповЧ = Новый ОписаниеТипов(Массив, , ,КЧ);
		ОписаниеТиповД = Новый ОписаниеТипов(Массив, , ,КД);
		//ОписаниеТиповФ = Новый ОписаниеТипов(Массив);
		
		ТаблицаРазмерВычетов.Колонки.Добавить("ФизЛицо",  Новый ОписаниеТипов("СправочникСсылка.ФизическиеЛица"));
		//ТаблицаРазмерВычетов.Колонки.Добавить("ФизЛицо",ОписаниеТиповФ);
		ТаблицаРазмерВычетов.Колонки.Добавить("Период",Новый ОписаниеТипов("Дата"));
		ТаблицаРазмерВычетов.Колонки.Добавить("КолДетей",ОписаниеТиповЧ);
		ТаблицаРазмерВычетов.Колонки.Добавить("РазмерВычета",ОписаниеТиповЧ);
		ТаблицаРазмерВычетов.Колонки.Добавить("КолДетей611",ОписаниеТиповЧ);
		ТаблицаРазмерВычетов.Колонки.Добавить("РазмерВычета611",ОписаниеТиповЧ);
		//Островская Татьяна 28.02.2014 № 17
		ТаблицаРазмерВычетов.Колонки.Добавить("КолДетейУчеба",ОписаниеТиповЧ);
		ТаблицаРазмерВычетов.Колонки.Добавить("РазмерВычетаУчеба",ОписаниеТиповЧ);
		//Островская Татьяна 28.02.2014 № 17
		
		//Островская Татьяна 15.11.2013 № 16727
		пока РезПериоды.Следующий() Цикл 
			СтрокаРазмер = ТаблицаРазмерВычетов.Добавить();
			СтрокаРазмер.ФизЛицо = РезПериоды.ФизЛицо; 
			СтрокаРазмер.Период = РезПериоды.Период;
			ЗапросВычетыНаДетей = Новый Запрос;
			//Островская Татьяна 09.01.2014 № 17024
			если РезПериоды.Период >= Дата("20140101000000") Тогда 
				ЗапросВычетыНаДетей.Текст = 
				//Островская Татьяна 26.11.2013 добавила условие даты
				"ВЫБРАТЬ
				|	ВЫБОР
				|		КОГДА ВложенныйЗапрос.Имя > 1
				|			ТОГДА 0
				|		ИНАЧЕ ВложенныйЗапрос.Имя
				|	КОНЕЦ КАК Имя,
				|	ВЫБОР
				|		КОГДА ВложенныйЗапрос.Имя > 1
				|			ТОГДА 0
				|		ИНАЧЕ ВложенныйЗапрос.РазмерВРублях
				|	КОНЕЦ КАК РазмерВРублях,
				|	ВЫБОР
				|		КОГДА ВложенныйЗапрос.Имя > 1
				|			ТОГДА ВложенныйЗапрос.Имя
				|		ИНАЧЕ 0
				|	КОНЕЦ КАК Имя611,
				|	ВЫБОР
				|		КОГДА ВложенныйЗапрос.Имя > 1
				|			ТОГДА РазмерВычета611.РазмерВРублях
				|		ИНАЧЕ 0
				|	КОНЕЦ КАК РазмерВРублях611
				|ИЗ
				|	(ВЫБРАТЬ
				|		КОЛИЧЕСТВО(ВложенныйЗапрос.Имя) КАК Имя,
				|		РазмерВычета.РазмерВРублях КАК РазмерВРублях
				|	ИЗ
				|		(ВЫБРАТЬ
				|			НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя КАК Имя,
				|			НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет КАК ПрименятьВычет,
				|			НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета КАК КодВычета,
				|			НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка КАК Ссылка
				|		ИЗ
				|			Документ.НДФЛСтандартныеВычетыФизлиц.СоставСемьи КАК НДФЛСтандартныеВычетыФизлицСоставСемьи
				|		ГДЕ
				|			РАЗНОСТЬДАТ(НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаРождения, &ДатаВычета, МЕСЯЦ) <= 216
				|			И НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка.Физлицо = &Физлицо
				|			И НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета = ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код610)
				|			И НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет = ИСТИНА
				|			И НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаНачалаВычета, МЕСЯЦ) <= &ДатаВычета
				|			И НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаКонцаВычета >= &ДатаВычета
				|			И НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка.ПометкаУдаления = ЛОЖЬ //СВЭЙ 13.09.2023 КВВ СВФР-011436
				|		
				|		СГРУППИРОВАТЬ ПО
				|			НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка,
				|			НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета,
				|			НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет,
				|			НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя) КАК ВложенныйЗапрос
				|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|				ВЫБОР
				|					КОГДА НДФЛРазмерВычетовСрезПоследних.КодВычета ЕСТЬ NULL 
				|						ТОГДА 0
				|					ИНАЧЕ НДФЛРазмерВычетовСрезПоследних.КодВычета
				|				КОНЕЦ КАК Поле1,
				|				НДФЛРазмерВычетовСрезПоследних.ОграничениеПоДоходам КАК ОграничениеПоДоходам,
				|				НДФЛРазмерВычетовСрезПоследних.РазмерВРублях КАК РазмерВРублях
				|			ИЗ
				|				РегистрСведений.НДФЛРазмерВычетов.СрезПоследних(&ДатаВычета, ) КАК НДФЛРазмерВычетовСрезПоследних) КАК РазмерВычета
				|			ПО ВложенныйЗапрос.КодВычета = РазмерВычета.Поле1
				|	
				|	СГРУППИРОВАТЬ ПО
				|		РазмерВычета.РазмерВРублях) КАК ВложенныйЗапрос,
				|	(ВЫБРАТЬ
				|		ВЫБОР
				|			КОГДА НДФЛРазмерВычетовСрезПоследних.КодВычета ЕСТЬ NULL 
				|				ТОГДА 0
				|			ИНАЧЕ НДФЛРазмерВычетовСрезПоследних.КодВычета
				|		КОНЕЦ КАК Поле1,
				|		НДФЛРазмерВычетовСрезПоследних.ОграничениеПоДоходам КАК ОграничениеПоДоходам,
				|		НДФЛРазмерВычетовСрезПоследних.РазмерВРублях КАК РазмерВРублях
				|	ИЗ
				|		РегистрСведений.НДФЛРазмерВычетов.СрезПоследних(&ДатаВычета, ) КАК НДФЛРазмерВычетовСрезПоследних
				|	ГДЕ
				|		НДФЛРазмерВычетовСрезПоследних.КодВычета = ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код611)) КАК РазмерВычета611";
				//Островская Татьяна 09.01.2014 № 17024
			иначе
				
				ЗапросВычетыНаДетей.Текст = 
				//Островская Татьяна 26.11.2013 добавила условие даты
				"ВЫБРАТЬ
				|	КОЛИЧЕСТВО(ВложенныйЗапрос.Имя) КАК Имя,
				|	РазмерВычета.РазмерВРублях,
				|	0 КАК ИмяУчеба,
				|	0 КАК РазмерВРубляхУчеба,
				|	0 КАК Имя611,
				|	0 КАК РазмерВРублях611				
				|ИЗ
				|	(ВЫБРАТЬ
				|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя КАК Имя,
				|		НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет КАК ПрименятьВычет,
				|		НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета КАК КодВычета,
				|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка КАК Ссылка
				|	ИЗ
				|		Документ.НДФЛСтандартныеВычетыФизлиц.СоставСемьи КАК НДФЛСтандартныеВычетыФизлицСоставСемьи
				|	ГДЕ
				|		РАЗНОСТЬДАТ(НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаРождения, &ДатаВычета, МЕСЯЦ) <= 216
				|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка.Физлицо = &Физлицо
				|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета = ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код610)
				|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет = ИСТИНА
				|		И НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаНачалаВычета, МЕСЯЦ) <= &ДатаВычета
				|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка.ПометкаУдаления = ЛОЖЬ //СВЭЙ 13.09.2023 КВВ СВФР-011436
				|	
				|	СГРУППИРОВАТЬ ПО
				|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка,
				|		НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета,
				|		НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет,
				|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя) КАК ВложенныйЗапрос
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			ВЫБОР
				|				КОГДА НДФЛРазмерВычетовСрезПоследних.КодВычета ЕСТЬ NULL 
				|					ТОГДА 0
				|				ИНАЧЕ НДФЛРазмерВычетовСрезПоследних.КодВычета
				|			КОНЕЦ КАК Поле1,
				|			НДФЛРазмерВычетовСрезПоследних.ОграничениеПоДоходам КАК ОграничениеПоДоходам,
				|			НДФЛРазмерВычетовСрезПоследних.РазмерВРублях КАК РазмерВРублях
				|		ИЗ
				|			РегистрСведений.НДФЛРазмерВычетов.СрезПоследних(&ДатаВычета, ) КАК НДФЛРазмерВычетовСрезПоследних) КАК РазмерВычета
				|		ПО ВложенныйЗапрос.КодВычета = РазмерВычета.Поле1
				|
				|СГРУППИРОВАТЬ ПО
				|	РазмерВычета.РазмерВРублях";
			КонецЕсли;
			ЗапросВычетыНаДетей.УстановитьПараметр("ДатаВычета",РезПериоды.Период);
			ЗапросВычетыНаДетей.УстановитьПараметр("Физлицо",РезПериоды.Физлицо);
			РезВычетыНаДетей = ЗапросВычетыНаДетей.Выполнить().Выбрать();
			
			ЗапросУчеба = Новый Запрос;
			ЗапросУчеба.УстановитьПараметр("ДатаВычета",РезПериоды.Период);
			ЗапросУчеба.УстановитьПараметр("Физлицо",РезПериоды.Физлицо);
			ЗапросУчеба.Текст = 
			"ВЫБРАТЬ
			|	КОЛИЧЕСТВО(ВложенныйЗапрос.Имя) КАК Имя,
			|	РазмерВычета.РазмерВРублях КАК РазмерВРублях
			|ИЗ
			|	(ВЫБРАТЬ
			|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя КАК Имя,
			|		НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет КАК ПрименятьВычет,
			|		НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета КАК КодВычета,
			|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка КАК Ссылка
			|	ИЗ
			|		Документ.НДФЛСтандартныеВычетыФизлиц.СоставСемьи КАК НДФЛСтандартныеВычетыФизлицСоставСемьи
			|	ГДЕ
			|		НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаНачалаВычета, МЕСЯЦ) <= &ДатаВычета
			|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка.Физлицо = &Физлицо
			|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета = ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код610)
			|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет = ИСТИНА
			|		И РАЗНОСТЬДАТ(НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаРождения, &ДатаВычета, МЕСЯЦ) > 216
			|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаКонцаВычета >= &ДатаВычета //О.Т. 04.09.2014 № 215
			|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка.ПометкаУдаления = ЛОЖЬ //СВЭЙ 13.09.2023 КВВ СВФР-011436
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка,
			|		НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета,
			|		НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет,
			|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя) КАК ВложенныйЗапрос
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ВЫБОР
			|				КОГДА НДФЛРазмерВычетовСрезПоследних.КодВычета ЕСТЬ NULL 
			|					ТОГДА 0
			|				ИНАЧЕ НДФЛРазмерВычетовСрезПоследних.КодВычета
			|			КОНЕЦ КАК Поле1,
			|			НДФЛРазмерВычетовСрезПоследних.ОграничениеПоДоходам КАК ОграничениеПоДоходам,
			|			НДФЛРазмерВычетовСрезПоследних.РазмерВРублях КАК РазмерВРублях
			|		ИЗ
			|			РегистрСведений.НДФЛРазмерВычетов.СрезПоследних(&ДатаВычета, ) КАК НДФЛРазмерВычетовСрезПоследних) КАК РазмерВычета
			|		ПО ВложенныйЗапрос.КодВычета = РазмерВычета.Поле1
			|
			|СГРУППИРОВАТЬ ПО
			|	РазмерВычета.РазмерВРублях";
			РезультУчеба = ЗапросУчеба.Выполнить().Выбрать();
			если РезультУчеба.Следующий() Тогда 
				СтрокаРазмер.КолДетейУчеба = ?(ЗначениеЗаполнено(РезультУчеба.Имя),РезультУчеба.Имя,0);
				СтрокаРазмер.РазмерВычетаУчеба = ?(ЗначениеЗаполнено(РезультУчеба.РазмерВРублях),РезультУчеба.РазмерВРублях,0);
				
			иначе
				СтрокаРазмер.КолДетейУчеба = 0;
				СтрокаРазмер.РазмерВычетаУчеба = 0;
			КонецЕсли;
			
			если РезВычетыНаДетей.Следующий() Тогда 
				СтрокаРазмер.КолДетей = РезВычетыНаДетей.Имя;
				СтрокаРазмер.РазмерВычета = РезВычетыНаДетей.РазмерВРублях;
				СтрокаРазмер.КолДетей611 = РезВычетыНаДетей.Имя611;
				СтрокаРазмер.РазмерВычета611 = РезВычетыНаДетей.РазмерВРублях611;
				
			иначе
				СтрокаРазмер.КолДетей = 0;
				СтрокаРазмер.РазмерВычета = 0;
				СтрокаРазмер.КолДетей611 = 0;
				СтрокаРазмер.РазмерВычета611 = 0;
			КонецЕсли;
			
		КонецЦикла;
		//Островская Татьяна 15.11.2013 № 16727
		ПериодыТекст = 
		"Выбрать
		|Табл.Период,
		|Табл.Физлицо,
		|Табл.КолДетей,
		|Табл.РазмерВычета,
		|Табл.КолДетей611,
		|Табл.РазмерВычета611,
		|Табл.КолДетейУчеба,
		|Табл.РазмерВычетаУчеба
		|ПОМЕСТить ВТПериоды 
		|из &Таблица как Табл";
		//|ИНДЕКСИРОВАТЬ ПО Период";
		Запрос.Текст = ПериодыТекст;
		Запрос.УстановитьПараметр("Таблица",ТаблицаРазмерВычетов);
		Запрос.Выполнить();	 
		
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		//запрос.Текст = 
		//"выбрать
		//|ТЗ.Период,
		//|ТЗ.Физлицо,
		//|ТЗ.КолДетей,
		//|ТЗ.РазмерВычета
		//|из ВтПериоды как ТЗ";
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		//Островская Татьяна 09.10.2013 № 16727
		ПериодыТекст = "ВТПериоды";
		
		// Периоды
		// Таблица список периодов-физлиц по которым необходимо выполнить расчет налога
		// Поля:
		//		Период
		//		Физлицо
		
		// ПодразделенияРаботников
		//	Поля:
		//		Физлицо
		//		Период
		//		ПодразделениеОрганизации
		//
		//	Описание:
		//	список подразделений в которых работают физлица по состоянию на конец месяца налогового периода
		
		ПодразделенияРаботниковТекст = 
		"ВЫБРАТЬ
		|	Периоды.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		|	ВЫБОР
		|		КОГДА КОНЕЦПЕРИОДА(Периоды.Период, МЕСЯЦ) >= РаботникиОрганизаций.ПериодЗавершения  
		|					И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
		|			ИНАЧЕ РаботникиОрганизаций.ПодразделениеОрганизации
		|		КОНЕЦ КАК ПодразделениеОрганизации
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.ФизЛицо КАК Физлицо,
		|		Периоды.Период КАК Период,
		|		МАКСИМУМ(РаботникиОрганизаций.Период) КАК ДатаРегистра,
		|		РаботникиОрганизаций.Организация КАК Организация
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|			ПО КОНЕЦПЕРИОДА(Периоды.Период, МЕСЯЦ) >= РаботникиОрганизаций.Период
		|				И Периоды.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
		|	ГДЕ
		|		РаботникиОрганизаций.Организация = &парамОрганизация
		|		И РаботникиОрганизаций.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|		И РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Периоды.ФизЛицо,
		|		Периоды.Период,
		|		РаботникиОрганизаций.Организация) КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|		ПО Периоды.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо
		|			И Периоды.ДатаРегистра = РаботникиОрганизаций.Период
		|			И Периоды.Организация = РаботникиОрганизаций.Организация
		|ГДЕ
		|	ВЫБОР
		|		КОГДА КОНЕЦПЕРИОДА(Периоды.Период, МЕСЯЦ) >= РаботникиОрганизаций.ПериодЗавершения 
		|					И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА РаботникиОрганизаций.ПричинаИзмененияСостоянияЗавершения
		|			ИНАЧЕ РаботникиОрганизаций.ПричинаИзмененияСостояния
		|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|	И РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)";
		
		// ПодразделенияДоговорников
		//	Поля:
		//		Физлицо
		//		Период
		//		ПодразделениеОрганизации
		//
		//	Описание:
		//	список подразделений в которых работают физлица по состоянию на конец месяца налогового периода
		ПодразделенияДоговорниковТекст = 
		"ВЫБРАТЬ
		|	ДатыПоследнихДоговоров.Физлицо КАК Физлицо,
		|	МАКСИМУМ(ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) КАК ПодразделениеОрганизации,
		|	ДатыПоследнихДоговоров.Период
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.Период КАК Период,
		|		Периоды.Физлицо КАК Физлицо,
		|		ДоговорНаВыполнениеРаботСФизЛицом.Организация КАК Организация,
		|		МАКСИМУМ(ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала) КАК ДатаНачала
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		|				ПО (ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала <= КОНЕЦПЕРИОДА(Периоды.Период, МЕСЯЦ))
		|					И (ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания >= НАЧАЛОПЕРИОДА(Периоды.Период, МЕСЯЦ))
		|					И Периоды.ФизЛицо = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.Физлицо
		|		ГДЕ
		|			ДоговорНаВыполнениеРаботСФизЛицом.Организация = &парамОбособленноеПодразделение
		|			
		|		СГРУППИРОВАТЬ ПО
		|			Периоды.Период,
		|			Периоды.ФизЛицо,
		|			ДоговорНаВыполнениеРаботСФизЛицом.Организация) КАК ДатыПоследнихДоговоров
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		|			ПО ДатыПоследнихДоговоров.Организация = ДоговорНаВыполнениеРаботСФизЛицом.Организация
		|				И ДатыПоследнихДоговоров.ДатаНачала = ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала
		|				И ДатыПоследнихДоговоров.Физлицо = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.Физлицо
		|		
		|
		|СГРУППИРОВАТЬ ПО
		|	ДатыПоследнихДоговоров.Физлицо,
		|	ДатыПоследнихДоговоров.Организация,
		|	ДатыПоследнихДоговоров.Период";
		
		ПодразделенияПоМесяцамТекст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ПодразделенияРаботников.Физлицо,
		|	ПодразделенияРаботников.Период,
		|	ПодразделенияРаботников.ПодразделениеОрганизации КАК ПодразделениеОрганизации
		|ИЗ		
		|	("+ПодразделенияРаботниковТекст+") КАК ПодразделенияРаботников
		
		|		ОБЪЕДИНИТЬ ВСЕ
		
		|ВЫБРАТЬ
		|	ПодразделенияДоговорников.Физлицо,
		|	ПодразделенияДоговорников.Период,
		|	ПодразделенияДоговорников.ПодразделениеОрганизации
		|ИЗ
		|	("+ПодразделенияДоговорниковТекст+") КАК ПодразделенияДоговорников";
		
		
		
		
		
		
		//
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ПодразделенияДоговорниковТекст+") КАК ПодразделенияДоговорников
		//|		ПО ПодразделенияРаботников.Период = ПодразделенияДоговорников.Период 
		//|			И ПодразделенияРаботников.ФизЛицо = ПодразделенияДоговорников.Физлицо
		//|	УПОРЯДОЧИТЬ ПО ПодразделенияРаботников.Физлицо.Наименование, ПодразделенияРаботников.Период";
		
		// ФизлицаНеРезиденты
		//	Поля:
		//		Физлицо
		//
		//	Описание:
		//	сисок физлиц-нерезидентов
		
		ФизлицаНеРезидентыТекст = 
		"ВЫБРАТЬ
		|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
		|	ГражданствоПоГодам.ПериодФизлица КАК Период
		|ИЗ
		|	РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
		|			ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
		|			Физлица.Период КАК ПериодФизлица,
		|			МАКСИМУМ(ГражданствоФизЛиц.Период) КАК Период
		|		ИЗ
		|			РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
		|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТПериоды КАК Физлица
		|				ПО Физлица.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
		|					И (ГражданствоФизЛиц.Период <= ВЫБОР
		|						КОГДА КОНЕЦПЕРИОДА(Физлица.Период, ГОД) >= КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
		|							ТОГДА КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
		|						ИНАЧЕ КОНЕЦПЕРИОДА(Физлица.Период, ГОД)
		|					КОНЕЦ)
		|		
		|		СГРУППИРОВАТЬ ПО
		|			ГражданствоФизЛиц.ФизЛицо,
		|			Физлица.Период) КАК ГражданствоПоГодам
		|		ПО ГражданствоПоГодам.Физлицо = ГражданствоФизЛиц.ФизЛицо
		|			И ГражданствоПоГодам.Период = ГражданствоФизЛиц.Период
		|ГДЕ
		|	ГражданствоФизЛиц.НеЯвляетсяНалоговымРезидентомРФ";
		
		// ДоходыСКодамиВычетов
		//	Поля:
		//		ФизЛицо
		//		Период
		//		КодДохода
		//		КодВычета
		//		СуммаДоходаОборот
		//		СуммаВычетаОборот
		//
		//	Описание:
		// Выбирает облагаемые налогом доходы за весь год по физлицам из СписокФизлиц
		//О.Т. 10.02.2015 № 333
		ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер;
		если ФлагДляПромежуточнойВед Тогда 
			Если РегистраторПрочиеНач = Неопределено Тогда //О.Т. Аверсон 13.03.2017 № 396
				Запрос.УстановитьПараметр("ВидРасчетаРег", ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Материальная помощь"));
				ДоходыСКодамиВычетовТекст = 
				"ВЫБРАТЬ
				|	НДФЛОбороты.Физлицо КАК ФизЛицо,
				|	НДФЛОбороты.Период КАК Период,
				|	НДФЛОбороты.КодДохода КАК КодДохода,
				|	НДФЛОбороты.КодВычета КАК КодВычета,
				|	СУММА(НДФЛОбороты.СуммаДоходаОборот) КАК СуммаДоходаОборот,
				|	СУММА(НДФЛОбороты.СуммаВычетаОборот) КАК СуммаВычетаОборот
				|ПОМЕСТИТЬ ВТДоходыСКодамиВычетов
				|ИЗ
				|	(ВЫБРАТЬ
				|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) КАК Период,
				|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо,
				|		НДФЛСведенияОДоходах.КодДохода КАК КодДохода,
				|		НДФЛСведенияОДоходах.КодВычета КАК КодВычета,
				|		ЕСТЬNULL(СУММА(ВЫБОР
				|	    КОГДА НДФЛСведенияОДоходах.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				|			И НДФЛСведенияОДоходах.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				|		ТОГДА ВЫРАЗИТЬ(НДФЛСведенияОДоходах.СуммаДохода / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
				|	    ИНАЧЕ НДФЛСведенияОДоходах.СуммаДохода
				|       КОНЕЦ), 0) КАК СуммаДоходаОборот,
				|		ЕСТЬNULL(СУММА(ВЫБОР
				|	    КОГДА НДФЛСведенияОДоходах.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				|			И НДФЛСведенияОДоходах.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				|		ТОГДА ВЫРАЗИТЬ(НДФЛСведенияОДоходах.СуммаВычета / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
				|	    ИНАЧЕ НДФЛСведенияОДоходах.СуммаВычета
				|       КОНЕЦ), 0) КАК СуммаВычетаОборот
				|	ИЗ
				|		ВТПериоды КАК Периоды
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
				|				ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеОтпускаРаботникамОрганизаций КАК НачислениеОтпускаРаботникамОрганизаций
				|				ПО НДФЛСведенияОДоходах.Регистратор = НачислениеОтпускаРаботникамОрганизаций.Ссылка
				|				ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеПоБольничномуЛисту КАК НачислениеПоБольничномуЛисту
				|				ПО НДФЛСведенияОДоходах.Регистратор = НачислениеПоБольничномуЛисту.Ссылка
				|				ЛЕВОЕ СОЕДИНЕНИЕ Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций.ДополнительныеНачисления КАК РегистрацияРазовыхНачисленийРаботниковОрганизацийДополнительныеНачисления
				|				ПО НДФЛСведенияОДоходах.Регистратор = РегистрацияРазовыхНачисленийРаботниковОрганизацийДополнительныеНачисления.Ссылка
				|					И НДФЛСведенияОДоходах.НомерСтроки = РегистрацияРазовыхНачисленийРаботниковОрганизацийДополнительныеНачисления.НомерСтроки
				|			ПО Периоды.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
				|				И (Периоды.Период = НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ))
				|	ГДЕ
				|		НДФЛСведенияОДоходах.Период >= &парамНачалоГода
				|		И НДФЛСведенияОДоходах.Период <= &парамКонецМесяцаНалоговогоПериода
				|		И НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации //О.Т.(к) Аверсон 25.01.2017 №  Убрала < доход только период регистрации (СКл)
				|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
				|		И НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
				|		И ВЫБОР
				|				КОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
				|					ТОГДА НДФЛСведенияОДоходах.Регистратор ССЫЛКА Документ.НачислениеОтпускаРаботникамОрганизаций
				|					ИЛИ НДФЛСведенияОДоходах.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛисту
				|							ИЛИ НДФЛСведенияОДоходах.Регистратор ССЫЛКА Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций
				|								И РегистрацияРазовыхНачисленийРаботниковОрганизацийДополнительныеНачисления.ВидРасчета = &ВидРасчетаРег
				|				ИНАЧЕ ИСТИНА
				|			КОНЕЦ
				|	
				|	СГРУППИРОВАТЬ ПО
				|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
				|		НДФЛСведенияОДоходах.ФизЛицо,
				|		НДФЛСведенияОДоходах.КодДохода,
				|		НДФЛСведенияОДоходах.КодВычета) КАК НДФЛОбороты
				|
				|СГРУППИРОВАТЬ ПО
				|	НДФЛОбороты.Физлицо,
				|	НДФЛОбороты.Период,
				|	НДФЛОбороты.КодДохода,
				|	НДФЛОбороты.КодВычета
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	ФизЛицо,
				|	Период";
			иначе
				ДоходыСКодамиВычетовТекст = 
				"ВЫБРАТЬ
				|	НДФЛОбороты.Физлицо КАК ФизЛицо,
				|	НДФЛОбороты.Период КАК Период,
				|	НДФЛОбороты.КодДохода КАК КодДохода,
				|	НДФЛОбороты.КодВычета КАК КодВычета,
				|	СУММА(НДФЛОбороты.СуммаДоходаОборот) КАК СуммаДоходаОборот,
				|	СУММА(НДФЛОбороты.СуммаВычетаОборот) КАК СуммаВычетаОборот
				|ПОМЕСТИТЬ ВТДоходыСКодамиВычетов
				|ИЗ
				|	(ВЫБРАТЬ
				|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) КАК Период,
				|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо,
				|		НДФЛСведенияОДоходах.КодДохода КАК КодДохода,
				|		НДФЛСведенияОДоходах.КодВычета КАК КодВычета,
				|		ЕСТЬNULL(СУММА(ВЫБОР
				|	    КОГДА НДФЛСведенияОДоходах.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				|			И НДФЛСведенияОДоходах.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				|		ТОГДА ВЫРАЗИТЬ(НДФЛСведенияОДоходах.СуммаДохода / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
				|	    ИНАЧЕ НДФЛСведенияОДоходах.СуммаДохода
				|       КОНЕЦ), 0) КАК СуммаДоходаОборот,
				|		ЕСТЬNULL(СУММА(ВЫБОР
				|	    КОГДА НДФЛСведенияОДоходах.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				|			И НДФЛСведенияОДоходах.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
				|		ТОГДА ВЫРАЗИТЬ(НДФЛСведенияОДоходах.СуммаВычета / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
				|	    ИНАЧЕ НДФЛСведенияОДоходах.СуммаВычета
				|       КОНЕЦ), 0) КАК СуммаВычетаОборот
				|	ИЗ
				|ВТПериоды КАК Периоды
				|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
				|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций КАК РегистрацияРазовыхНачисленийРаботниковОрганизаций
				|		ПО НДФЛСведенияОДоходах.Регистратор = РегистрацияРазовыхНачисленийРаботниковОрганизаций.Ссылка
				|	ПО Периоды.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
				|		И (Периоды.Период = НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ))
				
				|	ГДЕ
				|		НДФЛСведенияОДоходах.Период >= &парамНачалоГода
				|		И НДФЛСведенияОДоходах.Период <= &парамКонецМесяцаНалоговогоПериода
				|		И НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации //О.Т.(к) Аверсон 25.01.2017 №  Убрала < доход только период регистрации (СКл)
				|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
				|		И НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
				|		И РегистрацияРазовыхНачисленийРаботниковОрганизаций.Ссылка В (&РегистраторПрочиеНач)
				|И ВЫБОР
				|		КОГДА НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
				|			ТОГДА НДФЛСведенияОДоходах.Регистратор ССЫЛКА Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций
				|		ИНАЧЕ ИСТИНА
				|	КОНЕЦ
				|	
				|	СГРУППИРОВАТЬ ПО
				|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
				|		НДФЛСведенияОДоходах.ФизЛицо,
				|		НДФЛСведенияОДоходах.КодДохода,
				|		НДФЛСведенияОДоходах.КодВычета) КАК НДФЛОбороты
				|
				|СГРУППИРОВАТЬ ПО
				|	НДФЛОбороты.Физлицо,
				|	НДФЛОбороты.Период,
				|	НДФЛОбороты.КодДохода,
				|	НДФЛОбороты.КодВычета
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	ФизЛицо,
				|	Период";
				
			КонецЕсли;
			
		иначе
			ДоходыСКодамиВычетовТекст = 
			"ВЫБРАТЬ
			|	НДФЛОбороты.Физлицо КАК ФизЛицо,
			|	НДФЛОбороты.Период КАК Период,
			//|   НДФЛОбороты.ПериодРегистрации КАК ПериодРегистрации,
			|	НДФЛОбороты.КодДохода КАК КодДохода,
			|	НДФЛОбороты.КодВычета КАК КодВычета,
			|	СУММА(НДФЛОбороты.СуммаДоходаОборот) КАК СуммаДоходаОборот,
			|	СУММА(НДФЛОбороты.СуммаВычетаОборот) КАК СуммаВычетаОборот
			|ПОМЕСТИТЬ ВТДоходыСКодамиВычетов
			|ИЗ
			|	(ВЫБРАТЬ
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) КАК Период,
			//|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) КАК ПериодРегистрации,
			|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо,
			|		НДФЛСведенияОДоходах.КодДохода КАК КодДохода,
			|		НДФЛСведенияОДоходах.КодВычета КАК КодВычета,
			|		ЕСТЬNULL(СУММА(ВЫБОР
			|	    КОГДА НДФЛСведенияОДоходах.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|			И НДФЛСведенияОДоходах.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|		ТОГДА ВЫРАЗИТЬ(НДФЛСведенияОДоходах.СуммаДохода / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
			|	    ИНАЧЕ НДФЛСведенияОДоходах.СуммаДохода
			|       КОНЕЦ), 0) КАК СуммаДоходаОборот,
			|		ЕСТЬNULL(СУММА(ВЫБОР
			|	    КОГДА НДФЛСведенияОДоходах.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|			И НДФЛСведенияОДоходах.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|		ТОГДА ВЫРАЗИТЬ(НДФЛСведенияОДоходах.СуммаВычета / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
			|	    ИНАЧЕ НДФЛСведенияОДоходах.СуммаВычета
			|       КОНЕЦ), 0) КАК СуммаВычетаОборот
			|	ИЗ
			|		ВТПериоды КАК Периоды
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|			ПО Периоды.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
			|				И (Периоды.Период = НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ))
			|	ГДЕ
			|		НДФЛСведенияОДоходах.Период >= &парамНачалоГода И
			|		НДФЛСведенияОДоходах.Период <= &парамКонецМесяцаНалоговогоПериода
			//заявка №1913 (база заявок Кристалла) Дмитрук О.Г.
			|		И НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) <= &парамПериодРегистрации
			//заявка №1913 
			|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|		И НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
			//|  		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
			|		НДФЛСведенияОДоходах.ФизЛицо,
			|		НДФЛСведенияОДоходах.КодДохода,
			|		НДФЛСведенияОДоходах.КодВычета) КАК НДФЛОбороты
			|
			|СГРУППИРОВАТЬ ПО
			|	НДФЛОбороты.Физлицо,
			|	НДФЛОбороты.Период,
			//|   НДФЛОбороты.ПериодРегистрации, 
			|	НДФЛОбороты.КодДохода,
			|	НДФЛОбороты.КодВычета
			|ИНДЕКСИРОВАТЬ ПО Физлицо, Период";
		КонецЕсли;
		//О.Т. 10.02.2015 № 333
		//запрос.Текст = ДоходыСКодамиВычетовТекст;
		//запрос.Выполнить();
		ДоходыСКодамиВычетовТекст1 = 
		"ВЫБРАТЬ
		|	НДФЛОбороты.Физлицо КАК ФизЛицо,
		|	НДФЛОбороты.Период КАК Период,
		//|   НДФЛОбороты.ПериодРегистрации,
		|	НДФЛОбороты.КодДохода КАК КодДохода,
		|	НДФЛОбороты.КодВычета КАК КодВычета,
		|	СУММА(НДФЛОбороты.СуммаДоходаОборот) КАК СуммаДоходаОборот,
		|	СУММА(НДФЛОбороты.СуммаВычетаОборот) КАК СуммаВычетаОборот
		|ИЗ
		|	(ВЫБРАТЬ
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) КАК Период,
		//|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) КАК ПериодРегистрации,
		|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо,
		|		НДФЛСведенияОДоходах.КодДохода КАК КодДохода,
		|		НДФЛСведенияОДоходах.КодВычета КАК КодВычета,
		|		ЕСТЬNULL(СУММА(НДФЛСведенияОДоходах.СуммаДохода), 0) КАК СуммаДоходаОборот,
		|		ЕСТЬNULL(СУММА(НДФЛСведенияОДоходах.СуммаВычета), 0) КАК СуммаВычетаОборот
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		|			ПО Периоды.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
		|				И (Периоды.Период = НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ))
		|	ГДЕ
		|		НДФЛСведенияОДоходах.Период >= &парамНачалоГода И
		|		НДФЛСведенияОДоходах.Период <= &парамКонецМесяцаНалоговогоПериода
		//заявка №1913 (база заявок Кристалла) Дмитрук О.Г.
		|		И НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) <= &парамПериодРегистрации
		//заявка №1913 
		|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
		|		И НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		//|  		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		НДФЛСведенияОДоходах.КодДохода,
		|		НДФЛСведенияОДоходах.КодВычета) КАК НДФЛОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	НДФЛОбороты.Физлицо,
		|	НДФЛОбороты.Период,
		//|   НДФЛОбороты.ПериодРегистрации,
		|	НДФЛОбороты.КодДохода,
		|	НДФЛОбороты.КодВычета";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = ДоходыСКодамиВычетовТекст1;
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		Запрос.Текст = ДоходыСКодамиВычетовТекст;
		Запрос.Выполнить();
		
		Ставка30Текст        = "0.15";
		ТипЗначенияНДФЛТекст = "ЧИСЛО(10, 0)";
		//Островская Татьяна 07.10.2013 № 16
		ПериодыСКодамиТекст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ПериодФизлицо.Период КАК Период,
		|	ПериодФизлицо.Физлицо КАК Физлицо,
		|	ВЫБОР
		|		КОГДА ФизлицаНеРезиденты.Физлицо ЕСТЬ NULL 
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК Резидент,
		|	ПериодФизлицо.РазмерВычета КАК РазмерВычета,
		|	ПериодФизлицо.КолДетей КАК КоличДетей,
		|	ПериодФизлицо.РазмерВычета КАК РазмерВычета611,
		|	ПериодФизлицо.КолДетей КАК КоличДетей611,
		|	ПериодФизлицо.РазмерВычета КАК РазмерВычетаУчеба,
		|	ПериодФизлицо.КолДетейУчеба КАК КоличДетейУчеба
		|ИЗ
		|	ВТПериоды КАК ПериодФизлицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ФизлицаНеРезидентыТекст + ") КАК ФизлицаНеРезиденты
		|		ПО ФизлицаНеРезиденты.Физлицо = ПериодФизлицо.Физлицо
		|			И ФизлицаНеРезиденты.Период = ПериодФизлицо.Период";
		
		
		// ДоходыЗаГод 
		//	Поля:
		//		ФизЛицо
		//		Период
		//		Резидент
		//		ОблагаемыйДоходЗаГод
		//
		//	Описание:
		//	Выбирает по всем периодам с начала года сумму дохода нарастающим итогом за год
		//Островская Татьяна 02.07.2013 № 16605
		ДоходыЗаГодТекст = "
		|ВЫБРАТЬ
		|	НДФЛОбороты.Период КАК Период,
		|	НДФЛОбороты.ФизЛицо КАК ФизЛицо,
		|	НДФЛОбороты.Резидент КАК Резидент,
		|	СУММА(НДФЛОбороты.НалогНерезидента) КАК НалогНерезидента,
		|	СУММА(НДФЛОбороты.ОблагаемыйДоходЗаПериод) КАК ОблагаемыйДоходЗаПериод,
		|	СУММА(НДФЛОбороты.ОблагаемыйДоходЗаГод) КАК ОблагаемыйДоходЗаГод,
		|	СУММА(НДФЛОбороты.ОблагаемыйВычетЗаПериод) КАК ОблагаемыйВычетЗаПериод,
		|	СУММА(НДФЛОбороты.ОблагаемыйВычетЗаГод) КАК ОблагаемыйВычетЗаГод,
		|	НДФЛОбороты.РазмерВычета КАК РазмерВычета,
		|	НДФЛОбороты.КоличДетей КАК КоличДетей,
		|	НДФЛОбороты.РазмерВычетаУчеба КАК РазмерВычетаУчеба,
		|	НДФЛОбороты.КоличДетейУчеба КАК КоличДетейУчеба
		//|	СУММА(НДФЛОбороты.ОблагаемыйДоходЗаБезБудущего) КАК ОблагаемыйДоходЗаБезБудущего
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.Период КАК Период,
		|		Периоды.Физлицо КАК ФизЛицо,
		|		Периоды.Резидент КАК Резидент,
		|		ВЫБОР КОГДА НДФЛОбороты.Период = Периоды.Период ТОГДА ВЫРАЗИТЬ((НДФЛОбороты.СуммаДоходаОборот - ВЫБОР КОГДА Периоды.Резидент ИЛИ НДФЛОбороты.КодВычета НЕ В (&КодыВычетовРезидентов) ТОГДА НДФЛОбороты.СуммаВычетаОборот ИНАЧЕ 0 КОНЕЦ) * " + Ставка30Текст + " КАК " + ТипЗначенияНДФЛТекст + ") ИНАЧЕ 0 КОНЕЦ КАК НалогНерезидента,
		|       ВЫБОР
		|       КОГДА НДФЛОбороты.Период = Периоды.Период
		|       	ТОГДА НДФЛОбороты.СуммаДоходаОборот
		|       ИНАЧЕ 0
		|       КОНЕЦ КАК ОблагаемыйДоходЗаПериод,
		|       НДФЛОбороты.СуммаДоходаОборот КАК ОблагаемыйДоходЗаГод,
		|       ВЫБОР
		|       		КОГДА НДФЛОбороты.Период = Периоды.Период
		|       			ТОГДА НДФЛОбороты.СуммаВычетаОборот
		|       		ИНАЧЕ 0
		|       	КОНЕЦ КАК ОблагаемыйВычетЗаПериод,
		|       	НДФЛОбороты.СуммаВычетаОборот КАК ОблагаемыйВычетЗаГод,
		|       	Периоды.РазмерВычета КАК РазмерВычета,
		|       	Периоды.КоличДетей КАК КоличДетей,
		|       	Периоды.РазмерВычетаУчеба КАК РазмерВычетаУчеба,
		|       	Периоды.КоличДетейУчеба КАК КоличДетейУчеба
		
		//|		ВЫБОР КОГДА НДФЛОбороты.Период <= &парамПериодРегистрации ТОГДА НДФЛОбороты.СуммаДоходаОборот - ВЫБОР КОГДА Периоды.Резидент ИЛИ НДФЛОбороты.КодВычета НЕ В (&КодыВычетовРезидентов) ТОГДА НДФЛОбороты.СуммаВычетаОборот ИНАЧЕ 0 КОНЕЦ ИНАЧЕ 0 КОНЕЦ КАК ОблагаемыйДоходЗаБезБудущего
		|	ИЗ
		|		(" + ПериодыСКодамиТекст + ") КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходыСКодамиВычетов КАК НДФЛОбороты
		|			ПО (НДФЛОбороты.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период) И Периоды.Физлицо = НДФЛОбороты.Физлицо) КАК НДФЛОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	НДФЛОбороты.Период,
		|	НДФЛОбороты.ФизЛицо,
		|	НДФЛОбороты.Резидент,
		|	НДФЛОбороты.РазмерВычета,
		|	НДФЛОбороты.КоличДетей,
		|	НДФЛОбороты.РазмерВычетаУчеба,
		|	НДФЛОбороты.КоличДетейУчеба";
		//Островская Татьяна 02.07.2013 № 16605
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = ДоходыЗаГодТекст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		// НДФЛРасчетыСБюджетом
		//	Поля:
		//		ФизЛицо
		//		МесяцНалоговогоПериода
		//		ИсчисленныйНалог
		//		ПримененныеВычетыЛичные - уже примененные личные стандартные вычеты по НДФЛ
		//		ПолеПримененныеВычетыДетские - уже примененные вычеты на детей по НДФЛ
		//
		//	Описание:
		//	Выбирает исчисленные налоги (приходы по регистру НДФЛРасчетыСБюджетом)
		//  для СписокФизлиц
		//Островская Татьяна 11.12.2012 № исправление
		ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер;
		если СсылкаОтчет Тогда 
			НДФЛРасчетыСБюджетомТекст = 
			"ВЫБРАТЬ
			|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода КАК МесяцНалоговогоПериода,
			|	НДФЛРасчетыСБюджетом.ФизЛицо КАК ФизЛицо,
			|	Сумма(ВЫБОР
			|	КОГДА НДФЛРасчетыСБюджетом.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|			И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|		ТОГДА ВЫРАЗИТЬ(НДФЛРасчетыСБюджетом.Налог / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
			|	ИНАЧЕ НДФЛРасчетыСБюджетом.Налог
			|   КОНЕЦ) КАК ИсчисленныйНалог,
			|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетЛичный) КАК ПримененныеВычетыЛичные,
			|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетей) КАК ПолеПримененныеВычетыДетские,
			|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетейЛьгота) КАК ПолеПримененныеВычетыДетскиеЛьгота,
			|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйДополнительныйВычет) КАК ПолеПримененныеВычетыДополнительные,
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			|	СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетМолодыеСпециалисты) КАК ПолеПримененныеВычетыМолодыеСпециалисты
			//Аверсон СВФР-012095
			
			|ИЗ
			|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК РаботникиОрганизации
			|		ПО РаботникиОрганизации.Физлицо = НДФЛРасчетыСБюджетом.ФизЛицо
			|ГДЕ
			|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ &парамМесяцаНалоговогоПер И &парамМесяцаНалоговогоПер1
			//|	И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода <= &парамКонецМесяцаНалоговогоПериода
			|	И НДФЛРасчетыСБюджетом.Организация = &парамОрганизация
			|	И НДФЛРасчетыСБюджетом.Регистратор <> &парамРегистратор
			//|	И НДФЛРасчетыСБюджетом.Период <= &парамКонецМесяцаНалоговогоПериода //КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
			|	И НДФЛРасчетыСБюджетом.ВидДвижения = &парамПриход
			|	И НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = &парамСтавка13
			|	И НДФЛРасчетыСБюджетом.ВидСтроки = &парамВидСтроки
			|
			|СГРУППИРОВАТЬ ПО
			|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода,
			|	НДФЛРасчетыСБюджетом.ФизЛицо";
		Иначе 
			НДФЛРасчетыСБюджетомТекст = 
			"ВЫБРАТЬ
			|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода КАК МесяцНалоговогоПериода,
			|	НДФЛРасчетыСБюджетом.ФизЛицо КАК ФизЛицо,
			|	Сумма(ВЫБОР
			|	КОГДА НДФЛРасчетыСБюджетом.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|			И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|		ТОГДА ВЫРАЗИТЬ(НДФЛРасчетыСБюджетом.Налог / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
			|		Когда НДФЛРасчетыСБюджетом.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)//О.Т. Аверсон 24.10.2017 № 1117
			|		ТОГДА НДФЛРасчетыСБюджетом.Налог * 10000 
			|	ИНАЧЕ НДФЛРасчетыСБюджетом.Налог
			|   КОНЕЦ) КАК ИсчисленныйНалог,
			|	СУММА(Выбор когда НДФЛРасчетыСБюджетом.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) //О.Т. Аверсон 24.10.2017 № 1117
			|	тогда НДФЛРасчетыСБюджетом.ПримененныйВычетЛичный*10000 иначе НДФЛРасчетыСБюджетом.ПримененныйВычетЛичный конец) КАК ПримененныеВычетыЛичные,
			|	СУММА(Выбор когда НДФЛРасчетыСБюджетом.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) //О.Т. Аверсон 24.10.2017 № 1117
			|	тогда НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетей*10000 иначе НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетей конец) КАК ПолеПримененныеВычетыДетские,
			|	СУММА(Выбор когда НДФЛРасчетыСБюджетом.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) //О.Т. Аверсон 24.10.2017 № 1117
			|	тогда НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетейЛьгота*10000 иначе НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетейЛьгота конец) КАК ПолеПримененныеВычетыДетскиеЛьгота,
			|	СУММА(Выбор когда НДФЛРасчетыСБюджетом.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) //О.Т. Аверсон 24.10.2017 № 1117
			|	тогда НДФЛРасчетыСБюджетом.ПримененныйДополнительныйВычет *10000 иначе НДФЛРасчетыСБюджетом.ПримененныйДополнительныйВычет конец ) КАК ПолеПримененныеВычетыДополнительные,
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			|	СУММА(Выбор когда НДФЛРасчетыСБюджетом.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|	тогда НДФЛРасчетыСБюджетом.ПримененныйВычетМолодыеСпециалисты * 10000 иначе НДФЛРасчетыСБюджетом.ПримененныйВычетМолодыеСпециалисты конец ) КАК ПолеПримененныеВычетыМолодыеСпециалисты
			//Аверсон СВФР-012095
			
			|ИЗ
			|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК РаботникиОрганизации
			|		ПО РаботникиОрганизации.Физлицо = НДФЛРасчетыСБюджетом.ФизЛицо
			|ГДЕ
			|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= &парамНачалоГода
			|	И НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода <= &парамКонецМесяцаНалоговогоПериода
			|	И НДФЛРасчетыСБюджетом.Организация = &парамОрганизация
			|	И НДФЛРасчетыСБюджетом.Регистратор <> &парамРегистратор";
			Если не ТипЗнч(Регистратор) = Тип("ДокументСсылка.НДФЛПерерасчет") Тогда 
				НДФЛРасчетыСБюджетомТекст = НДФЛРасчетыСБюджетомТекст + "
				|	И НДФЛРасчетыСБюджетом.Период <= &парамКонецМесяцаНалоговогоПериода //КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)";
			КонецЕсли;
			НДФЛРасчетыСБюджетомТекст = НДФЛРасчетыСБюджетомТекст + "
			|	И НДФЛРасчетыСБюджетом.ВидДвижения = &парамПриход
			|	И НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = &парамСтавка13
			|	И НДФЛРасчетыСБюджетом.ВидСтроки = &парамВидСтроки
			|
			|СГРУППИРОВАТЬ ПО
			|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода,
			|	НДФЛРасчетыСБюджетом.ФизЛицо";
		КонецЕсли;
		//Островская Татьяна 11.12.2012 № исправление(для отчета Использование льгот по подоходному налогу)
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = НДФЛРасчетыСБюджетомТекст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		// НДФЛРасчетыСБюджетомЗаГод
		//	Поля:
		//		ФизЛицо
		//		Период
		//		ИсчисленныйНалогЗаГод
		//		ПримененныеВычетыЛичныеЗаГод
		//		ПолеПримененныеВычетыДетскиеЗаГод
		//		ПолеПримененныеВычетыНаДетейИнвалидовЗаГод
		//
		//	Описание:
		//	Выбирает исчисленные налоги нарастающим итогом за год
		
		НДФЛРасчетыСБюджетомЗаГодТекст = 
		"ВЫБРАТЬ
		|	Периоды.Период КАК Период,
		|	НДФЛРасчетыСБюджетом.ФизЛицо КАК ФизЛицо,
		|   СУММА(ВЫБОР 
		//О.Т. Аверсон 19.05.2016 № 1173 Считать по периоду, а не с нарастающим за год
		//|	    КОГДА ФизлицаНеРезиденты.ФизЛицо ЕСТЬ NULL 
		//|	    ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ИсчисленныйНалог,0)
		//О.Т. Аверсон 19.05.2016 № 1173
		|	    КОГДА Периоды.Период = НачалоПериода(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода,месяц)
		|	    ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ИсчисленныйНалог, 0)
		|   КОНЕЦ) КАК ИсчисленныйНалогЗаГод,
		|	СУММА(ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПримененныеВычетыЛичные, 0)) КАК ПримененныеВычетыЛичныеЗаГод,
		|	СУММА(ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДетские, 0)) КАК ПолеПримененныеВычетыДетскиеЗаГод,
		|	СУММА(ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДетскиеЛьгота,0)) КАК ПолеПримененныеВычетыДетскиеЛьготаЗаГод,
		|	СУММА(ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДополнительные,0)) КАК ПолеПримененныеВычетыДополнительныеЗаГод,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	СУММА(ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыМолодыеСпециалисты,0)) КАК ПолеПримененныеВычетыМолодыеСпециалистыЗаГод,
		//Аверсон СВФР-012095
		
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПримененныеВычетыЛичные, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПримененныеВычетыЛичныеЗаМесяц,
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДетские, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПолеПримененныеВычетыДетскиеЗаМесяц,
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДетскиеЛьгота, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПолеПримененныеВычетыДетскиеЛьготаЗаМесяц,
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыДополнительные, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПолеПримененныеВычетыДополнительныеЗаМесяц,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	СУММА(ВЫБОР КОГДА Периоды.Период = НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА ЕСТЬNULL(НДФЛРасчетыСБюджетом.ПолеПримененныеВычетыМолодыеСпециалисты, 0) ИНАЧЕ 0 КОНЕЦ) КАК ПолеПримененныеВычетыМолодыеСпециалистыЗаМесяц
		//Аверсон СВФР-012095
		
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРасчетыСБюджетомТекст + ") КАК НДФЛРасчетыСБюджетом
		|		ПО (НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И КонецПериода(Периоды.Период,месяц))
		|			И Периоды.Физлицо = НДФЛРасчетыСБюджетом.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ФизлицаНеРезидентыТекст + ") КАК ФизлицаНеРезиденты
		|		ПО ФизлицаНеРезиденты.Физлицо = Периоды.Физлицо
		|			И ФизлицаНеРезиденты.Период = Периоды.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	Периоды.Период,
		|	НДФЛРасчетыСБюджетом.ФизЛицо,
		|	ФизлицаНеРезиденты.ФизЛицо";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = НДФЛРасчетыСБюджетомЗаГодТекст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		//Запрос.Текст = НДФЛРасчетыСБюджетомЗаГодТекст;
		//Запрос.Выполнить();
		// ПрименениеВычетовВОрганизации
		//	Поля:
		//		Физлицо,
		//		Период
		//
		// Описание:
		//	Выбирает список физлиц + периодв в которые применяются стандартные вычеты по 
		//	заданной организации
		
		ПрименениеВычетовВОрганизацииТекст = 
		"ВЫБРАТЬ
		|	НДФЛПрименениеВычетовСрезПоследних.Физлицо КАК Физлицо,
		|	НДФЛПрименениеВычетовСрезПоследних.Период КАК Период
		|ИЗ
		|	(ВЫБРАТЬ
		|		МАКСИМУМ(НДФЛПрименениеВычетов.Период) КАК ПериодСреза,
		|		НДФЛПрименениеВычетов.Физлицо КАК Физлицо,
		//	|		Периоды.Физлицо КАК Физлицо,
		|		Периоды.Период КАК Период
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛПрименениеВычетов КАК НДФЛПрименениеВычетов
		|			ПО Периоды.Период >= НДФЛПрименениеВычетов.Период //И НДФЛПрименениеВычетов.Физлицо = Периоды.Физлицо
		
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НДФЛПрименениеВычетов.Физлицо,
		|		Периоды.Период) КАК НДФЛПрименениеВычетовСрезПоследних
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛПрименениеВычетов КАК НДФЛПрименениеВычетов
		|		ПО НДФЛПрименениеВычетов.Период = НДФЛПрименениеВычетовСрезПоследних.ПериодСреза И НДФЛПрименениеВычетов.Физлицо = НДФЛПрименениеВычетовСрезПоследних.Физлицо
		|
		|ГДЕ
		|	НДФЛПрименениеВычетов.Организация = &парамОрганизация";
		
		НДФЛРазмерВычетов =
		"ВЫБРАТЬ
		|	Периоды.Период КАК Период,
		|	ВЫБОР КОГДА (НДФЛРазмерВычетов.КодВычета) ЕСТЬ NULL ТОГДА 0 ИНАЧЕ НДФЛРазмерВычетов.КодВычета КОНЕЦ КАК КодВычета,
		|	НДФЛРазмерВычетов.РазмерВРублях  КАК Размер,    
		|	НДФЛРазмерВычетов.ОграничениеПоДоходам КАК ОграничениеПоДоходам
		|ИЗ
		|	(ВЫБРАТЬ
		|		Периоды.Период КАК Период,
		|		НДФЛРазмерВычетов.КодВычета КАК КодВычета,
		|		МАКСИМУМ(НДФЛРазмерВычетов.Период) КАК ПериодРегистра
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов
		|			ПО Периоды.Период >= НДФЛРазмерВычетов.Период
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Периоды.Период,
		|		НДФЛРазмерВычетов.КодВычета) КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов
		|		ПО НДФЛРазмерВычетов.Период = Периоды.ПериодРегистра И Периоды.КодВычета = НДФЛРазмерВычетов.КодВычета ";
		
		Запрос.Текст =  НДФЛРазмерВычетов;
		
		// ПраваНаВычеты
		//	Поля:
		//		Физлицо
		//		Период
		//		СтандартныеВычетыЛичные
		//		СтандартныеВычетыДетские
		//
		//	Описание:
		//	Выбирает по всем периодам года стандартные вычеты на которые имеет право физлицо
		//Островская Татьяна 11.01.2014 № 17024
		ПраваНаВычетыТекст = 
		"ВЫБРАТЬ
		|	НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо КАК Физлицо,
		|	НДФЛСтандартныеВычетыФизлицСрезПоследних.Период КАК Период,
		|	ВычетыФизлиц.КоличествоДетей,";
		//О.Т. Аверсон 12.12.2017 № убрала условие. Примененный вычет личный равен был 0 - ранее примененный 83 = -83. неправильно
		//если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НДФЛПерерасчет") Тогда 
		//	ПраваНаВычетыТекст = ПраваНаВычетыТекст + " 
		//	|	выбор когда НДФЛСтандартныеВычетыФизлицСрезПоследних.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) тогда Выразить(НДФЛРазмерВычетовЛичный.ОграничениеПоДоходам/10000 как число(10,2)) иначе НДФЛРазмерВычетовЛичный.ОграничениеПоДоходам конец КАК ОграничениеПоДоходамЛичные,
		//	|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ выбор когда НДФЛСтандартныеВычетыФизлицСрезПоследних.Период >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) тогда Выразить(ЕСТЬNULL(НДФЛРазмерВычетовЛичный.Размер, 0)/10000 как число(10,2)) иначе ЕСТЬNULL(НДФЛРазмерВычетовЛичный.Размер, 0) конец КОНЕЦ КАК СтандартныеВычетыЛичные,";
		//иначе
		ПраваНаВычетыТекст = ПраваНаВычетыТекст + " 
		|	НДФЛРазмерВычетовЛичный.ОграничениеПоДоходам КАК ОграничениеПоДоходамЛичные,
		|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ЕСТЬNULL(НДФЛРазмерВычетовЛичный.Размер, 0) КОНЕЦ КАК СтандартныеВычетыЛичные,";  
		//КонецЕсли;	
		ПраваНаВычетыТекст = ПраваНаВычетыТекст + "  
		|	ВЫБОР
		|	КОГДА ПрименениеВычетов.Физлицо ЕСТЬ NULL 
		|		ТОГДА 0
		|	ИНАЧЕ ВЫБОР
		|			КОГДА НДФЛСтандартныеВычетыФизлицСрезПоследних.Период >= ДАТАВРЕМЯ(2014, 1, 1, 0, 0, 0)
		|				ТОГДА ВЫБОР
		|				КОГДА ВычетыФизлиц.КоличествоДетей >= 2 И ПериодыВычета.КолДетей >= 2 //О.Т. Аверсон 20.06.2017 № 748
		|					ТОГДА 0 //О.Т. Аверсон 20.06.2017 № 748
		|				ИНАЧЕ (ВЫРАЗИТЬ(ЕСТЬNULL(ПериодыВычета.РазмерВычета, 0) КАК ЧИСЛО(10, 0))) * (ВЫРАЗИТЬ(ПериодыВычета.КолДетей КАК ЧИСЛО(10, 0)))+
		|				(ВЫРАЗИТЬ(ЕСТЬNULL(ПериодыВычета.РазмерВычетаУчеба, 0) КАК ЧИСЛО(10, 0))) * (ВЫРАЗИТЬ(ПериодыВычета.КолДетейУчеба КАК ЧИСЛО(10, 0))) конец
		|			ИНАЧЕ ЕСТЬNULL(НДФЛРазмерВычетовНаДетей.Размер, 0) * ЕСТЬNULL(ВычетыФизлиц.КоличествоДетей, 0) + ЕСТЬNULL(ВЫБОР
		|						КОГДА ПериодыВычета.КолДетей >= 2
		|							ТОГДА (ВЫРАЗИТЬ(ЕСТЬNULL(ПериодыВычета.РазмерВычета, 0) КАК ЧИСЛО(10, 0))) * (ВЫРАЗИТЬ(ПериодыВычета.КолДетей КАК ЧИСЛО(10, 0)))
		|						ИНАЧЕ 0
		|					КОНЕЦ, 0)
		|		КОНЕЦ
		|КОНЕЦ КАК СтандартныеВычетыДетские,
		
		
		|		ВЫБОР
		|	КОГДА ПрименениеВычетов.Физлицо ЕСТЬ NULL 
		|		ТОГДА 0
		|	ИНАЧЕ ВЫБОР
		|			КОГДА НДФЛРазмерВычетовНаДетейЛьгота.Размер ЕСТЬ NULL 
		|				ТОГДА 0
		|			ИНАЧЕ НДФЛРазмерВычетовНаДетейЛьгота.Размер
		|		КОНЕЦ *  ВЫБОР
		|					КОГДА ВычетыФизлиц.КоличествоДетейЛьгота ЕСТЬ NULL 
		|						ТОГДА 0
		|					ИНАЧЕ ВычетыФизлиц.КоличествоДетейЛьгота
		|		КОНЕЦ + (ВЫРАЗИТЬ(ЕСТЬNULL(ПериодыВычета.РазмерВычета611, 0) КАК ЧИСЛО(10, 0))) * (ВЫРАЗИТЬ(ПериодыВычета.КолДетей611 КАК ЧИСЛО(10, 0)))
		|КОНЕЦ КАК СтандартныеВычетыДетскиеЛьгота,
		|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ВЫБОР КОГДА (НДФЛРазмерВычетовДополнительный.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛРазмерВычетовДополнительный.Размер КОНЕЦ КОНЕЦ КАК СтандартныеВычетыДополнительные,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ВЫБОР КОГДА (НДФЛРазмерВычетовМолодыеСпециалисты.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛРазмерВычетовМолодыеСпециалисты.Размер КОНЕЦ КОНЕЦ КАК СтандартныеВычетыМолодыеСпециалисты
		//Аверсон СВФР-012095
		
		|ИЗ
		|	(ВЫБРАТЬ
		|		МАКСИМУМ(ВычетыФизлиц.Период) КАК ПериодСреза,
		|		ВычетыФизЛиц.Физлицо КАК Физлицо,
		//	|		Периоды.Физлицо КАК Физлицо,
		|		Периоды.Период КАК Период
		|	ИЗ
		|		ВТПериоды КАК Периоды
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛСтандартныеВычетыФизлиц КАК ВычетыФизлиц
		|			ПО ВычетыФизлиц.Период <= Периоды.Период И ВычетыФизлиц.Физлицо = Периоды.Физлицо
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВычетыФизЛиц.Физлицо,
		|		Периоды.Период) КАК НДФЛСтандартныеВычетыФизлицСрезПоследних
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛСтандартныеВычетыФизлиц КАК ВычетыФизлиц
		|		ПО ВычетыФизлиц.Период = НДФЛСтандартныеВычетыФизлицСрезПоследних.ПериодСреза И ВычетыФизлиц.Физлицо = НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВтПериоды КАК ПериодыВычета
		|		ПО НДФЛСтандартныеВычетыФизлицСрезПоследних.Период = ПериодыВычета.Период
		|		И НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо = ПериодыВычета.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовЛичный
		|		ПО НДФЛРазмерВычетовЛичный.КодВычета = ВычетыФизлиц.КодВычетаЛичный И НДФЛРазмерВычетовЛичный.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовНаДетей
		|		ПО (НДФЛРазмерВычетовНаДетей.КодВычета = ВЫБОР
		|   			КОГДА ВычетыФизлиц.КоличествоДетей >= 2 и ПериодыВычета.КолДетей >=2 //О.Т. Аверсон 20.06.2017 № 748
		|   				ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код611) //О.Т. Аверсон 20.06.2017 № 748
		|   			ИНАЧЕ ВычетыФизлиц.КодВычетаНаДетей
		|   		КОНЕЦ)
		|И НДФЛРазмерВычетовНаДетей.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовНаДетейЛьгота
		|		ПО (НДФЛРазмерВычетовНаДетейЛьгота.КодВычета = ВЫБОР
		|	КОГДА ВычетыФизлиц.КоличествоДетей >= 2 и ПериодыВычета.КолДетей >=2 //О.Т. Аверсон 20.06.2017 № 748
		|		ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код611) //О.Т. Аверсон 20.06.2017 № 748
		|	ИНАЧЕ ВычетыФизлиц.КодВычетаНаДетейЛьгота
		|КОНЕЦ) И НДФЛРазмерВычетовНаДетейЛьгота.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовДополнительный
		|		ПО НДФЛРазмерВычетовДополнительный.КодВычета = ВычетыФизлиц.КодВычетаДополнительный И НДФЛРазмерВычетовДополнительный.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовМолодыеСпециалисты
		|		ПО НДФЛРазмерВычетовМолодыеСпециалисты.КодВычета = ВычетыФизлиц.КодВычетаМолодыеСпециалисты И НДФЛРазмерВычетовМолодыеСпециалисты.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Месяц)
		//Аверсон СВФР-012095
		
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ПрименениеВычетовВОрганизацииТекст + ") КАК ПрименениеВычетов
		|		ПО ПрименениеВычетов.Физлицо = НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо И ПрименениеВычетов.Период = НДФЛСтандартныеВычетыФизлицСрезПоследних.Период";
		//Островская Татьяна 11.01.2014 № 17024
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст =  ПраваНаВычетыТекст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		
		//Островская Татьяна 16.01.2014(из личного вычета убран везде вычет. Берется только доход в расчет.)
		ПрименяемыеВычетыТекст = 
		"ВЫБРАТЬ
		|	РаботникиОргПраваНаВычеты.Физлицо КАК Физлицо,
		|	РаботникиОргПраваНаВычеты.Период КАК Период,
		|	РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные,
		|	ДоходыЗаГод.ОблагаемыйДоходЗаПериод КАК ДоходДляНалога, //+ НДФЛДоходыПредыдущегоМестаРаботы.Размер КАК ДоходДляНалога,
		//Минск н
		//Островская Татьяна 16.01.2014(из личного вычета убран везде вычет. Берется только доход в расчет.)
		//Островская Татьяна 07.04.2014 (в условие добавлен доход - вычет проверка на 0+возврат Доход-Вычет)
		| ВЫБОР КОГДА ВЫБОР КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод ЕСТЬ NULL ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные И ДоходыЗаГод.ОблагаемыйДоходЗаПериод > 0  И РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные  <> 0 
		| И ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод > 0 ТОГДА //Островская Татьяна 13.01.2014
		| ВЫБОР 
		|  КОГДА  ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод > РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные
		|   ТОГДА  РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные
		|  ИНАЧЕ  ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод КОНЕЦ  // //О.Т. 07.07.2014 № 108 Добавлен -вычет
		| ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыЛичные,
		//Островская Татьяна 07.04.2014 (в условие добавлен доход - вычет проверка на 0+возврат Доход-Вычет)
		//Островская Татьяна 16.01.2014(из личного вычета убран везде вычет. Берется только доход в расчет.)
		|	ВЫБОР 
		|		КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод ЕСТЬ NULL ИЛИ ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод = 0 
		|			ТОГДА 0 
		|		ИНАЧЕ ВЫБОР 
		|				КОГДА  ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод > ЕстьNull(РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские,0) //Островская Татьяна 13.01.2014
		|					ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские
		|				КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные > 0
		|					ТОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод -ДоходыЗаГод.ОблагаемыйВычетЗаПериод- РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные
		|				ИНАЧЕ 0
		|         	 КОНЕЦ
		| 	КОНЕЦ  КАК ПрименяемыеВычетыДетские,
		|   ВЫБОР 
		|		КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод ЕСТЬ NULL ИЛИ ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод = 0 
		|			ТОГДА 0 
		|		ИНАЧЕ ВЫБОР
		|				КОГДА  ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод > РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота 
		|					ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота
		|				КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские > 0
		|					ТОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские
		|				ИНАЧЕ 0 
		|			  КОНЕЦ 
		|	КОНЕЦ КАК ПрименяемыеВычетыДетскиеЛьгота,
		|	ВЫБОР 
		|		КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод ЕСТЬ NULL ИЛИ ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод = 0 
		|			ТОГДА 0
		|		ИНАЧЕ ВЫБОР 
		|				КОГДА  ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод > РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота + РаботникиОргПраваНаВычеты.СтандартныеВычетыДополнительные 
		|	    			ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДополнительные
		|				КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота > 0
		|					ТОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота
		|				ИНАЧЕ 0 
		|			  КОНЕЦ 
		|	КОНЕЦ КАК ПрименяемыеВычетыДополнительные,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	ВЫБОР 
		|		КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод ЕСТЬ NULL ИЛИ ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод = 0 
		|			ТОГДА 0
		|		ИНАЧЕ ВЫБОР 
		|				КОГДА  ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод > (ВЫБОР
		|                                                                                                 КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод < РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные
		|                                                                                                 ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные
		|                                                                                                 ИНАЧЕ 0
		|                                                                                                 КОНЕЦ) + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота + РаботникиОргПраваНаВычеты.СтандартныеВычетыДополнительные + РаботникиОргПраваНаВычеты.СтандартныеВычетыМолодыеСпециалисты 
		|	    			ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыМолодыеСпециалисты
		|				КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод - (ВЫБОР
		|                                                                                                 КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод < РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные
		|                                                                                                 ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные
		|                                                                                                 ИНАЧЕ 0
		|                                                                                                 КОНЕЦ) - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота - РаботникиОргПраваНаВычеты.СтандартныеВычетыДополнительные > 0
		|					ТОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод- ДоходыЗаГод.ОблагаемыйВычетЗаПериод - (ВЫБОР
		|                                                                                                     КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - ДоходыЗаГод.ОблагаемыйВычетЗаПериод < РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные
		|                                                                                                     ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные
		|                                                                                                     ИНАЧЕ 0
		|                                                                                                     КОНЕЦ) - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота - РаботникиОргПраваНаВычеты.СтандартныеВычетыДополнительные //Катя Убрать ЭТО ЗДЕСЬ!!!!!
		|				ИНАЧЕ 0 
		|			  КОНЕЦ 
		|	КОНЕЦ КАК ПрименяемыеВычетыМолодыеСпециалисты
		//Аверсон СВФР-012095
		
		//Минск к
		|ИЗ
		|	(" + ПраваНаВычетыТекст + ") КАК РаботникиОргПраваНаВычеты
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ДоходыЗаГодТекст + ") КАК ДоходыЗаГод
		|		ПО ДоходыЗаГод.Период = РаботникиОргПраваНаВычеты.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо";
		//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛДоходыПредыдущегоМестаРаботы КАК НДФЛДоходыПредыдущегоМестаРаботы
		//|		ПО (НДФЛДоходыПредыдущегоМестаРаботы.Организация = &парамОрганизация) И НДФЛДоходыПредыдущегоМестаРаботы.МесяцНалоговогоПериода = РаботникиОргПраваНаВычеты.Период И НДФЛДоходыПредыдущегоМестаРаботы.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо";
		
		Запрос.Текст = ПрименяемыеВычетыТекст;
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		//Островская Татьяна 14.01.2014 № 17024
		РезПроверка = Запрос.Выполнить().Выбрать();
		Пока РезПроверка.Следующий() Цикл 
			если РезПроверка.ОграничениеПоДоходамЛичные = 0 Тогда 
				Сообщить("Отсутствует значение предела по подоходному налогу. Проверьте правильность расчета!");
			КонецЕсли;
			
		КонецЦикла;
		//Островская Татьяна 14.01.2014 № 17024
		
		//	 ПрименяемыеВычетыЗаГод
		//	Поля:
		//		Физлицо
		//		Период
		//		ВычетыЛичныеЗаГод
		//		ВычетыДетскиеЗаГод
		//
		//	Описание:
		//	Выбирает по всем периодам года применяемые стандартные вычеты нарастающим итогом за год
		//
		
		ПрименяемыеВычетыЗаГодТекст = 
		"ВЫБРАТЬ
		|	ВычетыПоПериодам.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыЛичные) КАК ВычетыЛичныеЗаГод,
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыДетские) КАК ВычетыДетскиеЗаГод,
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыДетскиеЛьгота) КАК ВычетыДетскиеЛьготаЗаГод,
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыДополнительные) КАК ВычетыДополнительныеЗаГод,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	СУММА(ВычетыПоПериодам.ПрименяемыеВычетыМолодыеСпециалисты) КАК ВычетыМолодыеСпециалистыЗаГод,
		//Аверсон СВФР-012095
		
		|   СУММА(ВЫБОР КОГДА Периоды.Период = ВычетыПоПериодам.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыЛичные ИНАЧЕ 0 КОНЕЦ) КАК ПрименяемыеВычетыЛичныеЗаПериод,
		|   СУММА(ВЫБОР КОГДА Периоды.Период = ВычетыПоПериодам.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыДетские ИНАЧЕ 0 КОНЕЦ) КАК ПрименяемыеВычетыДетскиеЗаПериод,
		|   СУММА(ВЫБОР КОГДА Периоды.Период = ВычетыПоПериодам.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыДетскиеЛьгота ИНАЧЕ 0 КОНЕЦ) КАК ПрименяемыеВычетыДетскиеЛьготаЗаПериод,
		|   СУММА(ВЫБОР КОГДА Периоды.Период = ВычетыПоПериодам.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыДополнительные ИНАЧЕ 0 КОНЕЦ) КАК ПрименяемыеВычетыДополнительныеЗаПериод,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|   СУММА(ВЫБОР КОГДА Периоды.Период = ВычетыПоПериодам.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыМолодыеСпециалисты ИНАЧЕ 0 КОНЕЦ) КАК ПрименяемыеВычетыМолодыеСпециалистыЗаПериод
		//Аверсон СВФР-012095
		
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ПрименяемыеВычетыТекст + ") КАК ВычетыПоПериодам
		|		ПО (ВычетыПоПериодам.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период) И ВычетыПоПериодам.Физлицо = Периоды.Физлицо
		|
		|СГРУППИРОВАТЬ ПО
		|	ВычетыПоПериодам.Физлицо,
		|	Периоды.Период";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = ПрименяемыеВычетыЗаГодТекст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		// Приходы вычетов помесячные  
		Вычеты640СтрахПоМесяцамТекст = 
		"ВЫБРАТЬ
		|	Остатки.ФизЛицо КАК ФизЛицо,
		|	Остатки.Период КАК Период,
		|	Остатки.Год КАК НалоговыйПериод,
		|	Остатки.РазмерНачальныйОстаток КАК Вычет640СтрахОстаток,
		|	0 КАК ОборотВычеты640Страх,
		|	0 КАК ПримененныеВычеты640Страх
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Год,
		|		,
		|		КодВычетаИмущественный = &КодВычета640Страх
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Остатки
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Обороты.ФизЛицо,
		|	Обороты.Период,
		|	Обороты.Год,
		|	0,
		|	ВЫБОР КОГДА Обороты.Период <= &парамПериодРегистрации ТОГДА Обороты.РазмерПриход ИНАЧЕ 0 КОНЕЦ,
		|	Обороты.РазмерРасход
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Месяц,
		|		,
		|		КодВычетаИмущественный = &КодВычета640Страх
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Обороты";
		
		//Аверсон 20.03.2023 КВВ СВФР-010557 (
		Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций")
			ИЛИ ТипЗнч(Регистратор) = Тип("ДокументСсылка.НДФЛПерерасчет") Тогда //Аверсон 05.04.2023 КВВ СВФР-010655
			Вычеты640СтрахПоМесяцамТекст = Вычеты640СтрахПоМесяцамТекст + "
			
			//Аверсон 12.05.2023 КВВ СВФР-010826 (
			//|	ГДЕ Обороты.Год = &НужныйГод";
			|	ГДЕ Обороты.Год В (&спНужныйГод)";
			//Аверсон 12.05.2023 КВВ СВФР-010826 )
			
		КонецЕсли;
		//Аверсон 20.03.2023 КВВ СВФР-010557 )
		
		//Запрос.Текст = Вычеты640СтрахПоМесяцамТекст;
		//Запрос.Выполнить();
		
		//Аверсон 03.08.2023 КВВ СВФР-011182 (
		// Приходы вычетов помесячные  
		Вычеты641СтрахПоМесяцамТекст = 
		"ВЫБРАТЬ
		|	Остатки.ФизЛицо КАК ФизЛицо,
		|	Остатки.Период КАК Период,
		|	Остатки.Год КАК НалоговыйПериод,
		|	Остатки.РазмерНачальныйОстаток КАК Вычет641СтрахОстаток,
		|	0 КАК ОборотВычеты641Страх,
		|	0 КАК ПримененныеВычеты641Страх
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Год,
		|		,
		|		КодВычетаИмущественный = &КодВычета641Страх
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Остатки
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Обороты.ФизЛицо,
		|	Обороты.Период,
		|	Обороты.Год,
		|	0,
		|	ВЫБОР КОГДА Обороты.Период <= &парамПериодРегистрации ТОГДА Обороты.РазмерПриход ИНАЧЕ 0 КОНЕЦ,
		|	Обороты.РазмерРасход
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Месяц,
		|		,
		|		КодВычетаИмущественный = &КодВычета641Страх
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Обороты";
		
		Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций")
			ИЛИ ТипЗнч(Регистратор) = Тип("ДокументСсылка.НДФЛПерерасчет") Тогда 
			Вычеты641СтрахПоМесяцамТекст = Вычеты641СтрахПоМесяцамТекст + "
			|	ГДЕ Обороты.Год В (&спНужныйГод)";
		КонецЕсли;
		//Запрос.Текст = Вычеты641СтрахПоМесяцамТекст;
		//Запрос.Выполнить();
		//Аверсон 03.08.2023 КВВ СВФР-011182 )
		
		Вычеты312ПоМесяцамТекст = 
		"ВЫБРАТЬ
		|	Остатки.ФизЛицо КАК ФизЛицо,
		|	Остатки.Период КАК Период,
		|	Остатки.Год КАК НалоговыйПериод,
		|	Остатки.РазмерНачальныйОстаток КАК Вычет312Остаток,
		|	0 КАК ОборотВычеты312,
		|	0 КАК ПримененныеВычеты312
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Год,
		|		,
		|		КодВычетаИмущественный = &КодВычета312
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//|			И Год = ГОД(&парамМесяцаНалоговогоПер)
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		|		) КАК Остатки //О.Т. Аверсон 20.09.2017 № 1027
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Обороты.ФизЛицо,
		|	Обороты.Период,
		|	Обороты.Год,
		|	0,
		|	ВЫБОР КОГДА Обороты.Период <= &парамПериодРегистрации ТОГДА Обороты.РазмерПриход ИНАЧЕ 0 КОНЕЦ,
		|	Обороты.РазмерРасход
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Месяц,
		|		,
		|		КодВычетаИмущественный = &КодВычета312
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//|			И Год = ГОД(&парамМесяцаНалоговогоПер)
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		|		) КАК Обороты";//О.Т. Аверсон 20.09.2017 № 1027
		
		//Аверсон 04.02.2023 КВВ СВФР-010286 (
		Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") 
			ИЛИ ТипЗнч(Регистратор) = Тип("ДокументСсылка.НДФЛПерерасчет") Тогда //Аверсон 05.04.2023 КВВ СВФР-010655
			Вычеты312ПоМесяцамТекст = Вычеты312ПоМесяцамТекст + "
			
			//Аверсон 12.05.2023 КВВ СВФР-010826 (
			//|	ГДЕ Обороты.Год = &НужныйГод";
			|	ГДЕ Обороты.Год В (&спНужныйГод)";
			//Аверсон 12.05.2023 КВВ СВФР-010826 )
			
		КонецЕсли;
		//Аверсон 04.02.2023 КВВ СВФР-010286 )
		
		//Запрос.Текст = Вычеты312ПоМесяцамТекст;
		//Запрос.Выполнить();
		
		
		Вычеты311ПоМесяцамТекст = 
		"ВЫБРАТЬ
		|	Остатки.ФизЛицо КАК ФизЛицо,
		|	Остатки.Период КАК Период,
		|	Остатки.Год КАК НалоговыйПериод,
		|	Остатки.РазмерНачальныйОстаток КАК Вычет311Остаток,
		|	0 КАК ОборотВычеты311,
		|	0 КАК ПримененныеВычеты311
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Год,
		|		,
		|		КодВычетаИмущественный = &КодВычета311
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Остатки
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	Обороты.ФизЛицо,
		|	Обороты.Период,
		|	Обороты.Год,
		|	0,
		|	Обороты.РазмерПриход,
		|	Обороты.РазмерРасход
		|ИЗ
		|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
		|		&парамНачалоГода,
		|		&парамКонецГода,
		|		Месяц,
		|		,
		|		КодВычетаИмущественный = &КодВычета311
		|			И Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
		|			И Организация = &парамОрганизация) КАК Обороты";
		
		//Аверсон 20.03.2023 КВВ СВФР-010557 (
		Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") 
			ИЛИ ТипЗнч(Регистратор) = Тип("ДокументСсылка.НДФЛПерерасчет") Тогда //Аверсон 05.04.2023 КВВ СВФР-010655
			Вычеты311ПоМесяцамТекст = Вычеты311ПоМесяцамТекст + "
			
			//Аверсон 12.05.2023 КВВ СВФР-010826 (
			//|	ГДЕ Обороты.Год = &НужныйГод";
			|	ГДЕ Обороты.Год В (&спНужныйГод)";
			//Аверсон 12.05.2023 КВВ СВФР-010826 )
			
		КонецЕсли;
		//Аверсон 20.03.2023 КВВ СВФР-010557 )
		
		// Приходы вычетов с начала года нарастающим итогом
		Вычеты640СтрахТекст = 
		"ВЫБРАТЬ
		|	Периоды.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		//|	СУММА(Обороты.Вычет312Остаток) КАК Вычет312Остаток,
		//|	СУММА(Обороты.ПримененныеВычеты312) КАК Вычет312ЗаГод,
		|	СУММА(ВЫБОР КОГДА НАЧАЛОПЕРИОДА(Обороты.Период, МЕСЯЦ) = Периоды.Период ТОГДА Обороты.ПримененныеВычеты640Страх ИНАЧЕ 0 КОНЕЦ) КАК Вычет640СтрахЗаМесяц,
		|	СУММА(Обороты.ОборотВычеты640Страх) КАК Вычет640СтрахОстаток,
		|	СУММА(Обороты.ПримененныеВычеты640Страх) КАК Вычет640СтрахЗаГод
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + Вычеты640СтрахПоМесяцамТекст + ") КАК Обороты
		|		ПО Обороты.ФизЛицо = Периоды.Физлицо И Обороты.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, Год) И Периоды.Период
		|СГРУППИРОВАТЬ ПО
		|	Периоды.Физлицо,
		|	Периоды.Период";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = Вычеты640СтрахТекст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		//Аверсон 03.08.2023 КВВ СВФР-011182 (
		// Приходы вычетов с начала года нарастающим итогом
		Вычеты641СтрахТекст = 
		"ВЫБРАТЬ
		|	Периоды.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		|	СУММА(ВЫБОР КОГДА НАЧАЛОПЕРИОДА(Обороты.Период, МЕСЯЦ) = Периоды.Период ТОГДА Обороты.ПримененныеВычеты641Страх ИНАЧЕ 0 КОНЕЦ) КАК Вычет641СтрахЗаМесяц,
		|	СУММА(Обороты.ОборотВычеты641Страх) КАК Вычет641СтрахОстаток,
		|	СУММА(Обороты.ПримененныеВычеты641Страх) КАК Вычет641СтрахЗаГод
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + Вычеты641СтрахПоМесяцамТекст + ") КАК Обороты
		|		ПО Обороты.ФизЛицо = Периоды.Физлицо И Обороты.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, Год) И Периоды.Период
		|СГРУППИРОВАТЬ ПО
		|	Периоды.Физлицо,
		|	Периоды.Период";
		
		//Запрос.Текст = Вычеты641СтрахТекст;
		//Запрос.Выполнить();
		//Аверсон 03.08.2023 КВВ СВФР-011182 )
		
		Вычеты312Текст = 
		"ВЫБРАТЬ
		|	Периоды.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		//|	СУММА(Обороты.Вычет312Остаток) КАК Вычет312Остаток,
		//|	СУММА(Обороты.ПримененныеВычеты312) КАК Вычет312ЗаГод,
		|	СУММА(ВЫБОР КОГДА НАЧАЛОПЕРИОДА(Обороты.Период, МЕСЯЦ) = Периоды.Период ТОГДА Обороты.ПримененныеВычеты312 ИНАЧЕ 0 КОНЕЦ) КАК Вычет312ЗаМесяц,
		|	СУММА(Обороты.ОборотВычеты312) КАК Вычет312Остаток,
		|	СУММА(Обороты.ПримененныеВычеты312) КАК Вычет312ЗаГод
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + Вычеты312ПоМесяцамТекст + ") КАК Обороты
		|		ПО Обороты.ФизЛицо = Периоды.Физлицо И Обороты.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, Год) И Периоды.Период
		|СГРУППИРОВАТЬ ПО
		|	Периоды.Физлицо,
		|	Периоды.Период";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = Вычеты312Текст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		
		Вычеты311Текст = 
		"ВЫБРАТЬ
		|	Периоды.Физлицо КАК Физлицо,
		|	Периоды.Период КАК Период,
		//|	СУММА(Обороты.Вычет311Остаток) КАК Вычет311Остаток,
		//|	СУММА(Обороты.ПримененныеВычеты311) КАК Вычет311ЗаГод,
		|	СУММА(ВЫБОР КОГДА НАЧАЛОПЕРИОДА(Обороты.Период, МЕСЯЦ) = Периоды.Период ТОГДА Обороты.ПримененныеВычеты311 ИНАЧЕ 0 КОНЕЦ) КАК Вычет311ЗаМесяц,
		|	СУММА(ВЫБОР
		|	КОГДА Периоды.Период >= ДАТАВРЕМЯ(2016, 7, 1)
		|		ТОГДА ВЫБОР
		|				КОГДА Обороты.Период < ДАТАВРЕМЯ(2016, 7, 1)
		|					ТОГДА ВЫРАЗИТЬ(Обороты.ОборотВычеты311 / 10000 КАК ЧИСЛО(15, 2))
		|				ИНАЧЕ Обороты.ОборотВычеты311
		|			КОНЕЦ
		|	ИНАЧЕ Обороты.ОборотВычеты311
		|	КОНЕЦ) КАК Вычет311Остаток,
		|	СУММА(Обороты.ПримененныеВычеты311) КАК Вычет311ЗаГод
		|ИЗ
		|	ВТПериоды КАК Периоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + Вычеты311ПоМесяцамТекст + ") КАК Обороты
		|		ПО Обороты.ФизЛицо = Периоды.Физлицо И Обороты.Период <= Периоды.Период И Обороты.Период >= НАЧАЛОПЕРИОДА(Периоды.Период, Год) И Обороты.Период <= &парамПериодРегистрации 
		|
		|СГРУППИРОВАТЬ ПО
		|	Периоды.Физлицо,
		|	Периоды.Период";
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//Запрос.Текст = Вычеты311Текст;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		
		
		КоличДетейДо181=
		"ВЫБРАТЬ
		|	ВЫБОР
		|		КОГДА НДФЛРазмерВычетов.КодВычета ЕСТЬ NULL 
		|			ТОГДА 0
		|		ИНАЧЕ НДФЛРазмерВычетов.КодВычета
		|	КОНЕЦ КАК КодВычета,
		|	НДФЛРазмерВычетов.ОграничениеПоДоходам КАК ОграничениеПоДоходам,
		|	НДФЛРазмерВычетов.РазмерВРублях КАК РазмерВРублях,
		|	НДФЛРазмерВычетов.Период КАК Период
		|	поместить Вычеты
		|ИЗ
		|	РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов";
		Запрос.Текст = КоличДетейДо181;
		Запрос.Выполнить();
		
		//+ СВЭЙ КДЯ 06.03.20 СВФР-005631
		//КоличДетейДо18 = 
		//"ВЫБРАТЬ
		//|	КОЛИЧЕСТВО(ВложенныйЗапрос.Имя) КАК Имя,
		//|	ВложенныйЗапрос.Период КАК Период,
		//|	ВложенныйЗапрос.ФизЛицо КАК ФизЛицо
		//|ИЗ
		//|	(ВЫБРАТЬ
		//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя КАК Имя,
		//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет КАК ПрименятьВычет,
		//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета КАК КодВычета,
		//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка КАК Ссылка,
		//|		ВложенныйЗапрос.Период КАК Период,
		//|		ВложенныйЗапрос.ФизЛицо КАК ФизЛицо
		//|	ИЗ
		//|		("+ДоходыЗаГодТекст+") КАК ВложенныйЗапрос
		//|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.НДФЛСтандартныеВычетыФизлиц.СоставСемьи КАК НДФЛСтандартныеВычетыФизлицСоставСемьи
		//|			ПО ВложенныйЗапрос.ФизЛицо = НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка.Физлицо
		//|	ГДЕ
		//|		РАЗНОСТЬДАТ(НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаРождения, ВложенныйЗапрос.Период, МЕСЯЦ) <= 216
		//|	
		//|	СГРУППИРОВАТЬ ПО
		//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка,
		//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета,
		//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет,
		//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя,
		//|		ВложенныйЗапрос.Период,
		//|		ВложенныйЗапрос.ФизЛицо) КАК ВложенныйЗапрос
		//|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|			ВЫБОР
		//|				КОГДА НДФЛРазмерВычетов.КодВычета ЕСТЬ NULL 
		//|					ТОГДА 0
		//|				ИНАЧЕ НДФЛРазмерВычетов.КодВычета
		//|			КОНЕЦ КАК КодВычета,
		//|			НДФЛРазмерВычетов.ОграничениеПоДоходам КАК ОграничениеПоДоходам,
		//|			НДФЛРазмерВычетов.РазмерВРублях КАК РазмерВРублях,
		//|			НДФЛРазмерВычетов.Период КАК Период
		//|		ИЗ
		//|			РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов) КАК РазмерВычета
		//|		ПО ВложенныйЗапрос.КодВычета = РазмерВычета.КодВычета
		//|
		//|СГРУППИРОВАТЬ ПО
		//|	ВложенныйЗапрос.Период,
		//|	ВложенныйЗапрос.ФизЛицо";
		//Запрос.Текст = КоличДетейДо18;
		//Запрос.Выполнить();
		//- СВЭЙ КДЯ 06.03.20 СВФР-005631
		
		
		
		// облагаемый доход с начала года
		ПолеОблагаемыйДоходЗаГод = "ЕСТЬNULL(ДоходыЗаГод.ОблагаемыйДоходЗаГод, 0)";
		ПолеОблагаемыйДоходЗаПериод = "ЕСТЬNULL(ДоходыЗаГод.ОблагаемыйДоходЗаПериод, 0)";
		//Островская Татьяна 02.07.2013 № 16605
		ПолеОблагаемыйВычетЗаГод = "ЕСТЬNULL(ДоходыЗаГод.ОблагаемыйВычетЗаГод, 0)";
		ПолеОблагаемыйВычетЗаПериод = "ЕСТЬNULL(ДоходыЗаГод.ОблагаемыйВычетЗаПериод, 0)";
		
		//Островская Татьяна 02.07.2013 № 16605
		
		//ПолеОблагаемыйДоходБезБудущего = "ЕСТЬNULL(ДоходыЗаГод.ОблагаемыйДоходЗаБезБудущего, 0)";
		
		// право на личный вычет за год
		ПолеВычетыЛичныеЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыЛичныеЗаГод, 0)";
		ПолеВычетыЛичныеЗаПериод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ПрименяемыеВычетыЛичныеЗаПериод, 0)"; 
		//ПолеВычетыЛичныеБезБудущего = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыЛичныеБезБудущего, 0)";
		
		// право на вычет на детей за год
		ПолеВычетыДетскиеЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЗаГод, 0)";
		//Островская Татьяна 08.10.2013 № 16727
		ПолеВычетыДетскиеБольшеДвухДетей = "ЕСТЬNULL(ВЫБОР 
		|КОГДА ДоходыЗаГод.КоличДетей >= 2 ТОГДА  ВЫРАЗИТЬ(ЕСТЬNULL(ДоходыЗаГод.РазмерВычета,0) КАК ЧИСЛО(10, 0))* ВЫРАЗИТЬ(ДоходыЗаГод.КоличДетей КАК ЧИСЛО(10, 0)) ИНАЧЕ 0 КОНЕЦ,0)";
		//Островская Татьяна 08.10.2013 № 16727
		ПолеВычетыДетскиеЗаПериод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ПрименяемыеВычетыДетскиеЗаПериод, 0)";
		
		ПолеВычетыДетскиеЛьготаЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЛьготаЗаГод, 0)";
		ПолеВычетыДетскиеЛьготаЗаПериод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ПрименяемыеВычетыДетскиеЛьготаЗаПериод, 0)";
		
		ПолеВычетыДополнительныеЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДополнительныеЗаГод, 0)";
		ПолеВычетыДополнительныеЗаПериод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ПрименяемыеВычетыДополнительныеЗаПериод, 0)";
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		ПолеВычетыМолодыеСпециалистыЗаГод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыМолодыеСпециалистыЗаГод, 0)";
		ПолеВычетыМолодыеСпециалистыЗаПериод = "ЕСТЬNULL(РаботникиОргВычетыЗаГод.ПрименяемыеВычетыМолодыеСпециалистыЗаПериод, 0)";
		//Аверсон СВФР-012095
		
		ПолеВычет640СтрахОстаток = "ЕСТЬNULL(Вычеты640Страх.Вычет640СтрахОстаток, 0)";
		
		ПолеВычет641СтрахОстаток = "ЕСТЬNULL(Вычеты641Страх.Вычет641СтрахОстаток, 0)"; //Аверсон 03.08.2023 КВВ СВФР-011182
		
		ПолеВычет312Остаток = "ЕСТЬNULL(Вычеты312.Вычет312Остаток, 0)";
		
		ПолеВычет311Остаток = "ЕСТЬNULL(Вычеты311.Вычет311Остаток, 0)";
		
		//// размер вычета на детей с начала года
		//ПолеПримененныеВычетыДетские = 
		//"ВЫБОР 
		//|	КОГДА ДоходыЗаГод.Резидент 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыДетскиеЗаГод + " 
		//|				ТОГДА " + ПолеВычетыДетскиеЗаГод +" 
		//|			ИНАЧЕ " + ПолеОблагаемыйДоходЗаГод + "
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		
		//ПолеПримененныеВычетыДетскиеИнвалидов = 
		//"ВЫБОР 
		//|	КОГДА ДоходыЗаГод.Резидент 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеИнвалидовЗаГод + " 
		//|				ТОГДА " + ПолеВычетыДетскиеИнвалидовЗаГод +" 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыДетскиеЗаГод + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " 
		//|			ИНАЧЕ 0 
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		//// размер примененного вычета на себя с начала года
		//ПолеПримененныеВычетыЛичные = 
		//"ВЫБОР 
		//|	КОГДА ДоходыЗаГод.Резидент 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеИнвалидовЗаГод + " 
		//|				ТОГДА " + ПолеВычетыЛичныеЗаГод + " 
		//|			КОГДА " + ПолеОблагаемыйДоходЗаГод +" > "  + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеИнвалидовЗаГод + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " - " + ПолеВычетыДетскиеИнвалидовЗаГод + " 
		//|			ИНАЧЕ 0 
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		//// размер вычета по коду 312
		//ПолеПримененныеВычеты312 = 
		//"ВЫБОР 
		//|	КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеПримененныеВычетыЛичные + " + " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеВычет312Остаток + " > " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|			ИНАЧЕ " + ПолеВычет312Остаток + "
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		//// размер вычета по коду 311
		//ПолеПримененныеВычеты311 = 
		//"ВЫБОР 
		//|	КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеПримененныеВычеты312 + " + " + ПолеПримененныеВычетыЛичные + " + " + ПолеПримененныеВычетыДетские + " + " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|	ТОГДА 
		//|		ВЫБОР 
		//|			КОГДА " + ПолеВычет311Остаток + " > " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеИнвалидов + " 
		//|			ИНАЧЕ " + ПолеВычет311Остаток + "
		//|		КОНЕЦ 
		//|	ИНАЧЕ 0 
		//|КОНЕЦ";
		
		
		// размер примененного вычета на себя 
		ПолеПримененныеВычетыЛичныеЗаПериод = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА выбор когда " + ПолеВычетыЛичныеЗаПериод + "<> 0 тогда 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаПериод + " > " + ПолеВычетыЛичныеЗаПериод + " 
		|			ТОГДА " + ПолеВычетыЛичныеЗаПериод + " 
		|			ИНАЧЕ " + ПолеОблагаемыйДоходЗаПериод + "
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		// размер вычета на детей с начала года
		//Островская Татьяна 08.10.2013 № 16727
		//О.Т. 05.08.2014 № 159(убран ПолеВычетыДетскиеБольшеДвухДетей)
		ПолеПримененныеВычетыДетскиеЗаПериод = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаПериод + " > " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " 
		|			ТОГДА " + ПолеВычетыДетскиеЗаПериод + "
		//" + " + ПолеВычетыДетскиеБольшеДвухДетей +" 
		|			КОГДА " + ПолеОблагаемыйДоходЗаПериод +" > " + ПолеВычетыЛичныеЗаПериод + " 
		|			ТОГДА " + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеВычетыЛичныеЗаПериод + " 
		|			ИНАЧЕ 0 
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		//Островская Татьяна 08.10.2013 № 16727
		//Минск н
		// размер вычета дополнительный с начала года
		//Островская Татьяна 08.10.2013 № 16727
		//О.Т. 05.08.2014 № 159(убран ПолеВычетыДетскиеБольшеДвухДетей)
		ПолеПримененныеВычетыДетскиеЛьготаЗаПериод = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаПериод + " > " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " + " + ПолеВычетыДетскиеЛьготаЗаПериод + " 
		|			ТОГДА " + ПолеВычетыДетскиеЛьготаЗаПериод +" 
		|			КОГДА " + ПолеОблагаемыйДоходЗаПериод +" > " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " 
		|			ТОГДА " + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеВычетыЛичныеЗаПериод + " - " + ПолеВычетыДетскиеЗаПериод + " 
		|			ИНАЧЕ 0 
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		//Островская Татьяна 08.10.2013 № 16727
		//О.Т. 05.08.2014 № 159(убран ПолеВычетыДетскиеБольшеДвухДетей)
		ПолеПримененныеВычетыДополнительныеЗаПериод = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаПериод + " > " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " + " + ПолеВычетыДетскиеЛьготаЗаПериод + " + " + ПолеВычетыДополнительныеЗаПериод + " 
		|			ТОГДА " + ПолеВычетыДополнительныеЗаПериод +" 
		|			ИНАЧЕ ВЫБОР КОГДА " + ПолеОблагаемыйДоходЗаПериод +" > " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " + " + ПолеВычетыДетскиеЛьготаЗаПериод + " 
		|				ТОГДА " + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеВычетыЛичныеЗаПериод + " - " + ПолеВычетыДетскиеЗаПериод + " - " + ПолеВычетыДетскиеЛьготаЗаПериод + " 
		|				ИНАЧЕ 0 КОНЕЦ
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ"; 
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		ПолеПримененныеВычетыМолодыеСпециалистыЗаПериод = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаПериод + " > " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " + " + ПолеВычетыДетскиеЛьготаЗаПериод + " + " + ПолеВычетыДополнительныеЗаПериод  + " + " + ПолеВычетыМолодыеСпециалистыЗаПериод + " 
		|			ТОГДА " + ПолеВычетыМолодыеСпециалистыЗаПериод +" 
		|			ИНАЧЕ ВЫБОР КОГДА " + ПолеОблагаемыйДоходЗаПериод +" > " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " + " + ПолеВычетыДетскиеЛьготаЗаПериод  + " + " + ПолеВычетыДополнительныеЗаПериод + " 
		|				ТОГДА " + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеВычетыЛичныеЗаПериод + " - " + ПолеВычетыДетскиеЗаПериод + " - " + ПолеВычетыДетскиеЛьготаЗаПериод  + " - " + ПолеВычетыДополнительныеЗаПериод + " 
		|				ИНАЧЕ 0 КОНЕЦ
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		//Аверсон СВФР-012095
		
		//Островская Татьяна 08.10.2013 № 16727
		// размер примененного вычета на себя 
		ПолеПримененныеВычетыЛичные = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА выбор когда " + ПолеВычетыЛичныеЗаГод + "<> 0 тогда 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " 
		|			ТОГДА " + ПолеВычетыЛичныеЗаГод + " 
		|			ИНАЧЕ " + ПолеОблагаемыйДоходЗаГод + "
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		// размер вычета на детей с начала года
		//Островская Татьяна 08.10.2013 № 16727
		//О.Т. 05.08.2014 № 159(убран ПолеВычетыДетскиеБольшеДвухДетей)
		ПолеПримененныеВычетыДетские = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " 
		|			ТОГДА " + ПолеВычетыДетскиеЗаГод + " 
		//+ " + ПолеВычетыДетскиеБольшеДвухДетей +" 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыЛичныеЗаГод + " 
		|			ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеОблагаемыйВычетЗаГод + " - " + ПолеВычетыЛичныеЗаГод + " //О.Т. 05.08.2014 № 159
		|			ИНАЧЕ 0 
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		//Островская Татьяна 08.10.2013 № 16727
		//Минск н
		// размер вычета дополнительный с начала года
		//Островская Татьяна 08.10.2013 № 16727
		//О.Т. 05.08.2014 № 159(убран ПолеВычетыДетскиеБольшеДвухДетей)
		ПолеПримененныеВычетыДетскиеЛьгота = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " 
		|			ТОГДА " + ПолеВычетыДетскиеЛьготаЗаГод +" 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " 
		|			ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыЛичныеЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " 
		|			ИНАЧЕ 0 
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		//Островская Татьяна 08.10.2013 № 16727
		
		//О.Т. 05.08.2014 № 159(убран ПолеВычетыДетскиеБольшеДвухДетей)
		ПолеПримененныеВычетыДополнительные = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " + " + ПолеВычетыДополнительныеЗаГод + " 
		|			ТОГДА " + ПолеВычетыДополнительныеЗаГод +" 
		|			ИНАЧЕ ВЫБОР КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " 
		|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыЛичныеЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " - " + ПолеВычетыДетскиеЛьготаЗаГод + " 
		|				ИНАЧЕ 0 КОНЕЦ
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ"; 
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		ПолеПримененныеВычетыМолодыеСпециалисты = 
		"ВЫБОР 
		|	КОГДА ДоходыЗаГод.Резидент 
		|	ТОГДА 
		|		ВЫБОР 
		|			КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " + " + ПолеВычетыДополнительныеЗаГод + " + " + ПолеВычетыМолодыеСпециалистыЗаГод + " 
		|			ТОГДА " + ПолеВычетыМолодыеСпециалистыЗаГод +" 
		|			ИНАЧЕ ВЫБОР КОГДА " + ПолеОблагаемыйДоходЗаГод +" > " + ПолеВычетыЛичныеЗаГод + " + " + ПолеВычетыДетскиеЗаГод + " + " + ПолеВычетыДетскиеЛьготаЗаГод + " + " + ПолеВычетыДополнительныеЗаГод + " 
		|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеВычетыЛичныеЗаГод + " - " + ПолеВычетыДетскиеЗаГод + " - " + ПолеВычетыДетскиеЛьготаЗаГод + " - " + ПолеВычетыДополнительныеЗаГод + " 
		|				ИНАЧЕ 0 КОНЕЦ
		|		КОНЕЦ 
		|	ИНАЧЕ 0 
		|КОНЕЦ";
		//Аверсон СВФР-012095
		
		//Островская Татьяна 08.10.2013 № 16727
		//Минск к
		// размер вычета по коду 312
		//Изменен Минск  добавлены Вычеты дополнительные - 10 базовых величин для определенных категорий граждан
		//ПолеПримененныеВычеты312 = 
		//"	ВЫБОР 
		//|		КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеПримененныеВычетыЛичные + " + " + ПолеПримененныеВычетыДетские + " + " + ПолеПримененныеВычетыДетскиеЛьгота + " + " + ПолеПримененныеВычетыДополнительные + " 
		//|		ТОГДА 
		//|			ВЫБОР 
		//|				КОГДА " + ПолеВычет312Остаток + " > " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " 
		//|				ИНАЧЕ " + ПолеВычет312Остаток + "
		//|			КОНЕЦ 
		//|		ИНАЧЕ 0 
		//|	КОНЕЦ";
		//
		//// размер вычета по коду 311
		//ПолеПримененныеВычеты311 = 
		//"ВЫБОР 
		//|		КОГДА " + ПолеОблагаемыйДоходЗаГод + " > " + ПолеПримененныеВычеты312 + " + " + ПолеПримененныеВычетыЛичные + " + " + ПолеПримененныеВычетыДетскиеЛьгота + " + " + ПолеПримененныеВычетыДетские + " + " + ПолеПримененныеВычетыДополнительные + " 
		//|		ТОГДА 
		//|			ВЫБОР 
		//|				КОГДА " + ПолеВычет311Остаток + " > " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаГод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " 
		//|				ИНАЧЕ " + ПолеВычет311Остаток + "
		//|			КОНЕЦ 
		//|		ИНАЧЕ 0 
		//|	КОНЕЦ";
		//
		
		//ПолеПримененныеВычеты312 = 
		//"	ВЫБОР 
		//|		КОГДА " + ПолеОблагаемыйДоходЗаПериод + " > " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " + " + ПолеВычетыДетскиеЛьготаЗаПериод + " + " + ПолеВычетыДополнительныеЗаПериод + " 
		//|		ТОГДА 
		//|			ВЫБОР 
		//|				КОГДА " + ПолеВычет312Остаток + " > " + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеВычетыЛичныеЗаПериод + " - " + ПолеВычетыДетскиеЗаПериод + " - " + ПолеВычетыДетскиеЛьготаЗаПериод + " - " + ПолеВычетыДополнительныеЗаПериод + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеВычетыЛичныеЗаПериод + " - " + ПолеВычетыДетскиеЗаПериод + " - " + ПолеВычетыДетскиеЛьготаЗаПериод + " - " + ПолеВычетыДополнительныеЗаПериод + " 
		//|				ИНАЧЕ " + ПолеВычет312Остаток + "
		//|			КОНЕЦ 
		//|		ИНАЧЕ 0 
		//|	КОНЕЦ";
		//
		//// размер вычета по коду 311
		//ПолеПримененныеВычеты311 = 
		//"ВЫБОР 
		//|		КОГДА " + ПолеОблагаемыйДоходЗаПериод + " > " + ПолеПримененныеВычеты312 + " + " + ПолеВычетыЛичныеЗаПериод + " + " + ПолеВычетыДетскиеЛьготаЗаПериод + " + " + ПолеВычетыДетскиеЗаПериод + " + " + ПолеВычетыДополнительныеЗаПериод + " 
		//|		ТОГДА 
		//|			ВЫБОР 
		//|				КОГДА " + ПолеВычет311Остаток + " > " + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеВычетыЛичныеЗаПериод + " - " + ПолеВычетыДетскиеЗаПериод + " - " + ПолеВычетыДетскиеЛьготаЗаПериод + " - " + ПолеВычетыДополнительныеЗаПериод + " 
		//|				ТОГДА " + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеПримененныеВычеты312 + " - " + ПолеВычетыЛичныеЗаПериод + " - " + ПолеВычетыДетскиеЗаПериод + " - " + ПолеВычетыДетскиеЛьготаЗаПериод + " - " + ПолеВычетыДополнительныеЗаПериод + " 
		//|				ИНАЧЕ " + ПолеВычет311Остаток + "
		//|			КОНЕЦ 
		//|		ИНАЧЕ 0 
		//|	КОНЕЦ";
		
		
		//ЗапросШкала = Новый Запрос;
		//ЗапросШкала.Текст = "ВЫБРАТЬ
		//|	ШкалаПодоходногоНалогаСрезПоследних.Налог
		//|ИЗ
		//|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(&КонецПериода, ) КАК ШкалаПодоходногоНалогаСрезПоследних
		//|
		//|УПОРЯДОЧИТЬ ПО
		//|	НижнийПредел";
		//ЗапросШкала.УстановитьПараметр("КонецПериода", ПериодРегистрации);
		//Шкала = ЗапросШкала.Выполнить().Выгрузить();
		//
		//
		//Запрос.УстановитьПараметр("СтавкаНалога",ОКР(Шкала[0].Налог/100,2,0));
		//О.Т. Аверсон 29.03.2016 № 950
		Массив = Новый Массив; 
		КЧ = Новый КвалификаторыЧисла(10, 2);
		Массив.Добавить(Тип("Число"));
		ОписаниеТиповЧ = Новый ОписаниеТипов(Массив, , ,КЧ);
		
		ТаблЗначФизЛица = новый ТаблицаЗначений;
		ТаблЗначФизЛица.Колонки.Добавить("ФизЛицо",Новый ОписаниеТипов("СправочникСсылка.ФизическиеЛица"));
		ТаблЗначФизЛица.Колонки.Добавить("СтавкаНалога",ОписаниеТиповЧ);
		
		Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") Тогда 
			Для Каждого стрОстновные из Регистратор.Начисления Цикл 
				МассивТаблЗнач = ТаблЗначФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрОстновные.ФизЛицо));
				Если МассивТаблЗнач.Количество()=0 Тогда 
					СтрТаблЗначФизЛица = ТаблЗначФизЛица.Добавить();
					СтрТаблЗначФизЛица.ФизЛицо = стрОстновные.ФизЛицо;
					Если стрОстновные.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
						ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
					иначе
						ВидНалогообложения = стрОстновные.Сотрудник.ВидНалогообложенияОсновной;
					КонецЕсли;
				КонецЕсли;
				
				//О.Т. Аверсон 30.03.2016 № 950
				ЗапросИндСтавкаНалогообл = Новый Запрос;
				ЗапросИндСтавкаНалогообл.Текст = 
				"ВЫБРАТЬ
				|	ИноеНалогообложениеПоСотрудникамСрезПоследних.НДФЛ
				|ИЗ
				|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
				|			&Период,
				|			Организация = &Организация
				|				И ВидНалогообложения = &ВидНалогообложения
				|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
				
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", стрОстновные.Сотрудник); 
				РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
				ЕстьИндивидСтавка = Ложь;
				СтавкаНДФЛИнд = 0;
				Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
					ЕстьИндивидСтавка = Истина;
					СтавкаНДФЛИнд = РезИндСтавкаНалогообл[0].НДФЛ;
				КонецЕсли;
				//О.Т. Аверсон 30.03.2016 № 950
				
				ЗапросШкала = Новый Запрос;
				ЗапросШкала.Текст = "ВЫБРАТЬ
				|	ШкалаПодоходногоНалогаСрезПоследних.Налог
				|ИЗ
				|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(
				|			&КонецПериода,
				|			Организация = &Организация
				|				И ВидНалогообложения = &ВидНалогообложения) КАК ШкалаПодоходногоНалогаСрезПоследних
				|
				|УПОРЯДОЧИТЬ ПО
				|	ШкалаПодоходногоНалогаСрезПоследних.НижнийПредел";
				ЗапросШкала.УстановитьПараметр("КонецПериода", ПериодРегистрации);
				ЗапросШкала.УстановитьПараметр("Организация", Организация);
				ЗапросШкала.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
				Шкала = ЗапросШкала.Выполнить().Выгрузить();
				Для Каждого СтрШкала из Шкала Цикл 
					СтрТаблЗначФизЛица.СтавкаНалога = ОКР(?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,СтрШкала.Налог)/100,2,0);
				КонецЦикла;
				
				
			КонецЦикла;
			
			Для Каждого стрДополнительные из Регистратор.ДополнительныеНачисления Цикл 
				МассивТаблЗнач = ТаблЗначФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрДополнительные.ФизЛицо));
				Если МассивТаблЗнач.Количество()=0 Тогда 
					СтрТаблЗначФизЛица = ТаблЗначФизЛица.Добавить();
					СтрТаблЗначФизЛица.ФизЛицо = стрДополнительные.ФизЛицо;
					Если стрДополнительные.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
						ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
					иначе
						ВидНалогообложения = стрДополнительные.Сотрудник.ВидНалогообложенияОсновной;
					КонецЕсли;
				КонецЕсли;
				//О.Т. Аверсон 30.03.2016 № 950
				ЗапросИндСтавкаНалогообл = Новый Запрос;
				ЗапросИндСтавкаНалогообл.Текст = 
				"ВЫБРАТЬ
				|	ИноеНалогообложениеПоСотрудникамСрезПоследних.НДФЛ
				|ИЗ
				|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
				|			&Период,
				|			Организация = &Организация
				|				И ВидНалогообложения = &ВидНалогообложения
				|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
				
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", стрДополнительные.Сотрудник); 
				РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
				ЕстьИндивидСтавка = Ложь;
				СтавкаНДФЛИнд = 0;
				Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
					ЕстьИндивидСтавка = Истина;
					СтавкаНДФЛИнд = РезИндСтавкаНалогообл[0].НДФЛ;
				КонецЕсли;
				//О.Т. Аверсон 30.03.2016 № 950
				
				ЗапросШкала = Новый Запрос;
				ЗапросШкала.Текст = "ВЫБРАТЬ
				|	ШкалаПодоходногоНалогаСрезПоследних.Налог
				|ИЗ
				|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(
				|			&КонецПериода,
				|			Организация = &Организация
				|				И ВидНалогообложения = &ВидНалогообложения) КАК ШкалаПодоходногоНалогаСрезПоследних
				|
				|УПОРЯДОЧИТЬ ПО
				|	ШкалаПодоходногоНалогаСрезПоследних.НижнийПредел";
				ЗапросШкала.УстановитьПараметр("КонецПериода", ПериодРегистрации);
				ЗапросШкала.УстановитьПараметр("Организация", Организация);
				ЗапросШкала.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
				Шкала = ЗапросШкала.Выполнить().Выгрузить();
				Для Каждого СтрШкала из Шкала Цикл 
					СтрТаблЗначФизЛица.СтавкаНалога = ОКР(?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,СтрШкала.Налог)/100,2,0);
				КонецЦикла;
			КонецЦикла; 
			//О.Т. Аверсон 28.06.2017 № 772
			Для Каждого стрДоговора из Регистратор.ДоговорыНаВыполнениеРабот Цикл 
				МассивТаблЗнач = ТаблЗначФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрДоговора.ФизЛицо));
				Если МассивТаблЗнач.Количество()=0 Тогда 
					СтрТаблЗначФизЛица = ТаблЗначФизЛица.Добавить();
					СтрТаблЗначФизЛица.ФизЛицо = стрДоговора.ФизЛицо;
					Если стрДоговора.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
						ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
					иначе
						ВидНалогообложения = стрДоговора.Сотрудник.ВидНалогообложенияОсновной;
					КонецЕсли;
				КонецЕсли;
				
				//О.Т. Аверсон 30.03.2016 № 950
				ЗапросИндСтавкаНалогообл = Новый Запрос;
				ЗапросИндСтавкаНалогообл.Текст = 
				"ВЫБРАТЬ
				|	ИноеНалогообложениеПоСотрудникамСрезПоследних.НДФЛ
				|ИЗ
				|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
				|			&Период,
				|			Организация = &Организация
				|				И ВидНалогообложения = &ВидНалогообложения
				|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
				
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
				ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", стрДоговора.Сотрудник); 
				РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
				ЕстьИндивидСтавка = Ложь;
				СтавкаНДФЛИнд = 0;
				Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
					ЕстьИндивидСтавка = Истина;
					СтавкаНДФЛИнд = РезИндСтавкаНалогообл[0].НДФЛ;
				КонецЕсли;
				//О.Т. Аверсон 30.03.2016 № 950
				
				ЗапросШкала = Новый Запрос;
				ЗапросШкала.Текст = "ВЫБРАТЬ
				|	ШкалаПодоходногоНалогаСрезПоследних.Налог
				|ИЗ
				|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(
				|			&КонецПериода,
				|			Организация = &Организация
				|				И ВидНалогообложения = &ВидНалогообложения) КАК ШкалаПодоходногоНалогаСрезПоследних
				|
				|УПОРЯДОЧИТЬ ПО
				|	ШкалаПодоходногоНалогаСрезПоследних.НижнийПредел";
				ЗапросШкала.УстановитьПараметр("КонецПериода", ПериодРегистрации);
				ЗапросШкала.УстановитьПараметр("Организация", Организация);
				ЗапросШкала.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
				Шкала = ЗапросШкала.Выполнить().Выгрузить();
				Для Каждого СтрШкала из Шкала Цикл 
					СтрТаблЗначФизЛица.СтавкаНалога = ОКР(?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,СтрШкала.Налог)/100,2,0);
				КонецЦикла;
				
				
			КонецЦикла;
			//О.Т. Аверсон 28.06.2017 № 772
			
		иначе
			ЗапросСотр = Новый Запрос;
			ЗапросСотр.УстановитьПараметр("ГоловнаяОрганизация", Организация);
			ЗапросСотр.УстановитьПараметр("парамРегистратор", Регистратор); //СВЭЙ 26.03.2024 КВВ СВФР-012716
			
			//СВЭЙ 10.04.2024 КВВ СВФР-012811 (
			Если _парамФизлицо_ <> Неопределено Тогда
				ЗапросСотр.УстановитьПараметр("парамФизлицо", _парамФизлицо_);
			КонецЕсли;
			
			Если _парамФизлицаПерерасчета_ <> Неопределено Тогда
				ЗапросСотр.УстановитьПараметр("парамФизлицаПерерасчета", _парамФизлицаПерерасчета_);
			КонецЕсли;
			
			Если _СписокФизЛиц_ <> Неопределено Тогда
				ЗапросСотр.УстановитьПараметр("СписокФизЛиц", _СписокФизЛиц_);
			КонецЕсли;
			//СВЭЙ 10.04.2024 КВВ СВФР-012811 )
			
			ЗапросСотр.Текст =
			
			//СВЭЙ 26.03.2024 КВВ СВФР-012716 (
			"ВЫБРАТЬ Физлицо
			|ПОМЕСТИТЬ ВТСписокФизЛиц
			|ИЗ (" + СписокФизЛицТекст + ") СписокФизЛиц
			|ИНДЕКСИРОВАТЬ ПО Физлицо
			|;
			//СВЭЙ 26.03.2024 КВВ СВФР-012716 )
			
			|ВЫБРАТЬ
			|	СотрудникиОрганизаций.Ссылка,
			|	ВЫБОР
			|		КОГДА СотрудникиОрганизаций.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Контракт)
			|			ТОГДА 1
			|		ИНАЧЕ 2
			|	КОНЕЦ КАК Порядок,
			|	СотрудникиОрганизаций.Физлицо
			|ИЗ
			|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
			|ГДЕ
			|	(СотрудникиОрганизаций.ВидДоговора <> ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Контракт)
			|			ИЛИ СотрудникиОрганизаций.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
			|	И СотрудникиОрганизаций.Организация = &ГоловнаяОрганизация
			|
			|И СотрудникиОрганизаций.Физлицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц) //СВЭЙ 26.03.2024 КВВ СВФР-012716
			|
			|УПОРЯДОЧИТЬ ПО
			|	Порядок";
			
			Выборка = ЗапросСотр.Выполнить().Выбрать();
			ФизЛицоПрошл = "";
			Пока Выборка.Следующий() Цикл 
				Если ФизЛицоПрошл <> Выборка.ФизЛицо Тогда 
					СтрТаблЗначФизЛица = ТаблЗначФизЛица.Добавить();
					СтрТаблЗначФизЛица.ФизЛицо = Выборка.ФизЛицо;
					Если Выборка.Ссылка.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
						ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
					иначе
						ВидНалогообложения = Выборка.Ссылка.ВидНалогообложенияОсновной;
					КонецЕсли;
					
					ЗапросИндСтавкаНалогообл = Новый Запрос;
					ЗапросИндСтавкаНалогообл.Текст = 
					"ВЫБРАТЬ
					|	ИноеНалогообложениеПоСотрудникамСрезПоследних.НДФЛ
					|ИЗ
					|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
					|			&Период,
					|			Организация = &Организация
					|				И ВидНалогообложения = &ВидНалогообложения
					|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
					
					ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
					ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
					ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
					ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Выборка.Ссылка); 
					РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
					ЕстьИндивидСтавка = Ложь;
					СтавкаНДФЛИнд = 0;
					Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
						ЕстьИндивидСтавка = Истина;
						СтавкаНДФЛИнд = РезИндСтавкаНалогообл[0].НДФЛ;
					КонецЕсли;
					//О.Т. Аверсон 30.03.2016 № 950
					
					ЗапросШкала = Новый Запрос;
					ЗапросШкала.Текст = "ВЫБРАТЬ
					|	ШкалаПодоходногоНалогаСрезПоследних.Налог
					|ИЗ
					|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(
					|			&КонецПериода,
					|			Организация = &Организация
					|				И ВидНалогообложения = &ВидНалогообложения) КАК ШкалаПодоходногоНалогаСрезПоследних
					|
					|УПОРЯДОЧИТЬ ПО
					|	ШкалаПодоходногоНалогаСрезПоследних.НижнийПредел";
					ЗапросШкала.УстановитьПараметр("КонецПериода", ПериодРегистрации);
					ЗапросШкала.УстановитьПараметр("Организация", Организация);
					ЗапросШкала.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
					Шкала = ЗапросШкала.Выполнить().Выгрузить();
					Для Каждого СтрШкала из Шкала Цикл 
						СтрТаблЗначФизЛица.СтавкаНалога = ОКР(?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,СтрШкала.Налог)/100,2,0);
					КонецЦикла;
					
				КонецЕсли;					
				
				ФизЛицоПрошл = Выборка.ФизЛицо;
			КонецЦикла;			
		КонецЕсли;
		ТаблЗначФизЛица.Свернуть("ФизЛицо,СтавкаНалога");
		ТекстФИзЛицаПоНалогообл = "ВЫБРАТЬ
		|	ТаблицаФизЛиц.ФизЛицо,
		|	ТаблицаФизЛиц.СтавкаНалога
		|ПОМЕСТИТЬ ВТФизЛицаСНалогообл
		|ИЗ
		|	&ТЗ КАК ТаблицаФизЛиц";
		Запрос.Текст = ТекстФИзЛицаПоНалогообл;
		Запрос.УстановитьПараметр("ТЗ",ТаблЗначФизЛица);
		Запрос.Выполнить();
		//О.Т. Аверсон 28.03.2016 № 950	
		
		// сумма ранее примененных вычетов личных
		ПолеРанееПримененныеВычетыЛичные = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПримененныеВычетыЛичныеЗаГод, 0)";
		ПолеРанееПримененныеВычетыЛичныеЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПримененныеВычетыЛичныеЗаМесяц, 0)";
		
		// сумма ранее примененных вычетов на детей
		ПолеРанееПримененныеВычетыДетские = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДетскиеЗаГод, 0)";
		ПолеРанееПримененныеВычетыДетскиеЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДетскиеЗаМесяц, 0)";
		ПолеРанееПримененныеВычетыДетскиеЛьгота = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДетскиеЛьготаЗаГод, 0)";
		ПолеРанееПримененныеВычетыДетскиеЛьготаЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДетскиеЛьготаЗаМесяц, 0)";
		ПолеРанееПримененныеВычетыДополнительные = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДополнительныеЗаГод, 0)";
		ПолеРанееПримененныеВычетыДополнительныеЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыДополнительныеЗаМесяц, 0)";
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		ПолеРанееПримененныеВычетыМолодыеСпециалисты = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыМолодыеСпециалистыЗаГод, 0)";
		ПолеРанееПримененныеВычетыМолодыеСпециалистыЗаМесяц = "ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ПолеПримененныеВычетыМолодыеСпециалистыЗаМесяц, 0)";
		//Аверсон СВФР-012095
		
		ПолеРанееПримененныеВычеты640Страх = "ЕСТЬNULL(Вычеты640Страх.Вычет640СтрахЗаГод, 0)";
		ПолеРанееПримененныеВычеты640СтрахЗаМесяц = "ЕСТЬNULL(Вычеты640Страх.Вычет640СтрахЗаМесяц, 0)";
		
		//Аверсон 03.08.2023 КВВ СВФР-011182 (
		ПолеРанееПримененныеВычеты641Страх = "ЕСТЬNULL(Вычеты641Страх.Вычет641СтрахЗаГод, 0)";
		ПолеРанееПримененныеВычеты641СтрахЗаМесяц = "ЕСТЬNULL(Вычеты641Страх.Вычет641СтрахЗаМесяц, 0)";
		//Аверсон 03.08.2023 КВВ СВФР-011182 )
		
		// сумма ранее примененных вычетов по коду 312
		ПолеРанееПримененныеВычеты312 = "ЕСТЬNULL(Вычеты312.Вычет312ЗаГод, 0)";
		ПолеРанееПримененныеВычеты312ЗаМесяц = "ЕСТЬNULL(Вычеты312.Вычет312ЗаМесяц, 0)";
		
		// сумма ранее примененных вычетов по коду 311
		ПолеРанееПримененныеВычеты311 = "ЕСТЬNULL(Вычеты311.Вычет311ЗаГод, 0)";
		ПолеРанееПримененныеВычеты311ЗаМесяц = "ЕСТЬNULL(Вычеты311.Вычет311ЗаМесяц, 0)";
		
		// сумма налога исчисленная
		//Островская Татьяна 02.07.2013 № 16605
		ПолеНалогИсчисленный = 
		"(ВЫРАЗИТЬ(ВЫБОР 
		|				КОГДА ДоходыЗаГод.Резидент 
		|				ТОГДА (" + ПолеОблагаемыйДоходЗаГод +" - "+ ПолеОблагаемыйВычетЗаГод +" - "+ ПолеПримененныеВычетыЛичные + " - " + ПолеПримененныеВычетыДетские + " - " + ПолеПримененныеВычетыДетскиеЛьгота + " - " + ПолеПримененныеВычетыДополнительные + " - " + ПолеПримененныеВычетыМолодыеСпециалисты +  ")* ВТФизЛицаСНалогообл.СтавкаНалога  //О.Т. Аверсон 29.03.2016 № 950 //Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|				ИНАЧЕ ЕСТЬNULL(ДоходыЗаГод.НалогНерезидента, 0)
		|				КОНЕЦ КАК " + ТипЗначенияНДФЛТекст + "))";
		//Островская Татьяна 02.07.2013 № 16605
		// сумма ранее исчисленного налога
		ПолеРанееНалогИсчисленный = 
		"ВЫБОР 
		|	КОГДА НДФЛРасчетыСБюджетомЗаГод.ИсчисленныйНалогЗаГод = -99999999 
		|	ТОГДА 0 
		|	ИНАЧЕ ЕСТЬNULL(НДФЛРасчетыСБюджетомЗаГод.ИсчисленныйНалогЗаГод, 0) 
		|КОНЕЦ";
		
		
		
		Если КомментироватьРасчет Тогда
			ДоходыПоВидамРасчетаТекст = "
			|ВЫБРАТЬ
			|	НДФЛСведенияОДоходах.ДоходЗаМесяц КАК ДоходЗаМесяц,
			|	НДФЛСведенияОДоходах.ВычетЗаМесяц КАК ВычетЗаМесяц,
			|	СУММА(ДоходыПоВидамРасчета.Результат) КАК ДоходЗаМесяцПоВидамРасчета,
			|	НДФЛСведенияОДоходах.Физлицо КАК Физлицо,
			|	ДоходыПоВидамРасчета.ВидРасчета КАК ВидРасчета,
			|	ДоходыПоВидамРасчета.ВидРасчета.Наименование КАК ВидРасчетаНаименование,
			|	НДФЛСведенияОДоходах.Период КАК Период
			|ИЗ
			|	(ВЫБРАТЬ
			|		СУММА(НДФЛСведенияОДоходах.СуммаДохода) КАК ДоходЗаМесяц,
			|		СУММА(НДФЛСведенияОДоходах.СуммаВычета) КАК ВычетЗаМесяц,
			|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо,
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) КАК Период
			|	ИЗ
			|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|			ПО (Месяцы.Период = НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ))
			|	ГДЕ
			|		НДФЛСведенияОДоходах.ФизЛицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
			|		И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	
			|	СГРУППИРОВАТЬ ПО
			|		НДФЛСведенияОДоходах.ФизЛицо,
			|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)) КАК НДФЛСведенияОДоходах
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			Начисления.Результат КАК Результат,
			|			Начисления.ФизЛицо КАК Физлицо,
			|			Начисления.ВидРасчета КАК ВидРасчета,
			|			ВЫБОР
			|				КОГДА Начисления.ВидРасчета.КодДоходаНДФЛ = &КодОплатыТрудаПоНДФЛ
			|					ТОГДА Начисления.ПериодРегистрации
			|				ИНАЧЕ Начисления.ПериодДействия
			|			КОНЕЦ КАК Период
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Начисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|				ПО (Месяцы.Период = ВЫБОР
			|						КОГДА Начисления.ВидРасчета.КодДоходаНДФЛ <> &КодОплатыТрудаПоНДФЛ
			|							ТОГДА Начисления.ПериодРегистрации
			|						ИНАЧЕ Начисления.ПериодДействия
			|					КОНЕЦ)
			|		ГДЕ
			|			Начисления.ВидРасчета.КодДоходаНДФЛ <> &ПустойКодДохода
			|			И Начисления.ФизЛицо В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
			|			И Начисления.Организация = &парамОрганизация
			|		
			|		ОБЪЕДИНИТЬ ВСЕ
			|		
			|		ВЫБРАТЬ
			|			Начисления.Результат,
			|			Начисления.ФизЛицо,
			|			Начисления.ВидРасчета,
			|			НАЧАЛОПЕРИОДА(Начисления.ПериодРегистрации, МЕСЯЦ)
			|		ИЗ
			|			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Начисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДатыПоМесяцам КАК Месяцы
			|				ПО (Месяцы.Период = НАЧАЛОПЕРИОДА(Начисления.ПериодРегистрации, МЕСЯЦ))
			|		ГДЕ
			|			Начисления.ВидРасчета.КодДоходаНДФЛ <> &ПустойКодДохода
			|			И Начисления.ФизЛицо  В (ВЫБРАТЬ Физлицо ИЗ ВТСписокФизЛиц)
			|			И Начисления.Организация = &парамОрганизация) КАК ДоходыПоВидамРасчета
			|		ПО ДоходыПоВидамРасчета.Период = НДФЛСведенияОДоходах.Период
			|			И ДоходыПоВидамРасчета.Физлицо = НДФЛСведенияОДоходах.Физлицо
			|
			|СГРУППИРОВАТЬ ПО
			|	НДФЛСведенияОДоходах.ДоходЗаМесяц,
			|	НДФЛСведенияОДоходах.ВычетЗаМесяц,
			|	НДФЛСведенияОДоходах.Физлицо,
			|	НДФЛСведенияОДоходах.Период,
			|	ДоходыПоВидамРасчета.ВидРасчета,
			|	ДоходыПоВидамРасчета.ВидРасчета.Наименование";
			Запрос.УстановитьПараметр("ПустойКодДохода" , Справочники.ДоходыНДФЛ.ПустаяСсылка());
			Запрос.УстановитьПараметр("КодОплатыТрудаПоНДФЛ", Справочники.ДоходыНДФЛ.КодДоходаПоУмолчанию);
			
		КонецЕсли;
		// ИсчисленныйНДФЛ
		//	Поля:
		//		Физлицо
		//		Период
		//		НалогУжеИсчисленный
		//		НалогИсчисленный
		//		ПримененныеВычетыЛичные
		//		ПолеПримененныеВычетыДетские
		//		ПолеПримененныеВычетыДетскиеИнвалидов
		//	    ПримененныеВычеты312
		//	    ПримененныеВычеты311
		//	
		//	Описание:
		//	Выбирает применяемые вычеты нарастающим итогом, доход нарастающим итогом и 
		//	исчисленный налог нарастающим итогом и производит расчет налога и примененных вычетов
		
		ИсчисленныйНДФЛТекст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ДоходыЗаГод.Физлицо КАК Физлицо,
		|	ДоходыЗаГод.Период КАК Период,
		|	ЕСТЬNULL(ДоходыЗаГод.Резидент, ИСТИНА) КАК Резидент,
		|	" + ПолеРанееНалогИсчисленный + " КАК НалогРанееИсчисленный,         //Минск
		|	" + ПолеНалогИсчисленный + " - " + ПолеРанееНалогИсчисленный + " КАК НалогИсчисленный,         //Минск
		|	" + ПолеОблагаемыйДоходЗаГод + " - " + ПолеОблагаемыйВычетЗаГод + " КАК ДоходЗаГод,                     //Минск
		|	" + ПолеОблагаемыйДоходЗаПериод + " - " + ПолеОблагаемыйВычетЗаПериод  + " КАК ДоходЗаПериод,
		//|	" + ПолеНалогНерезидентаЗаГод + " КАК НалогНерезидентаЗаГод,         //Минск
		|	" + ПолеПримененныеВычетыЛичные + "  КАК ПримененныеВычетыЛичные,    //Минск
		|	" + ПолеПримененныеВычетыДетские + " КАК ПримененныеВычетыДетские,   //Минск
		|	" + ПолеПримененныеВычетыДетскиеЛьгота + " КАК ПримененныеВычетыДетскиеЛьгота,   //Минск
		|	" + ПолеПримененныеВычетыДополнительные + " КАК ПримененныеВычетыДополнительные, //Минск
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	" + ПолеПримененныеВычетыМолодыеСпециалисты + " КАК ПримененныеВычетыМолодыеСпециалисты, 
		//Аверсон СВФР-012095
		
		|	" + ПолеПримененныеВычетыЛичныеЗаПериод + "  КАК ПримененныеВычетыЛичныеЗаПериод,    //Минск
		|	" + ПолеПримененныеВычетыДетскиеЗаПериод + " КАК ПримененныеВычетыДетскиеЗаПериод,   //Минск
		|	" + ПолеПримененныеВычетыДетскиеЛьготаЗаПериод + " КАК ПримененныеВычетыДетскиеЛьготаЗаПериод,   //Минск
		|	" + ПолеПримененныеВычетыДополнительныеЗаПериод + " КАК ПримененныеВычетыДополнительныеЗаПериод, //Минск
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	" + ПолеПримененныеВычетыМолодыеСпециалистыЗаПериод + " КАК ПримененныеВычетыМолодыеСпециалистыЗаПериод,
		//Аверсон СВФР-012095
		
		//Островская Татьяна 30.01.2013 № 16
		|	0  КАК ПримененныеВычеты312,  //Минск
		|	0 КАК ПримененныеВычеты311,   //Минск
		|	" + ПолеВычет640СтрахОстаток + " КАК Вычет640СтрахОстаток,
		|	" + ПолеВычет641СтрахОстаток + " КАК Вычет641СтрахОстаток, //Аверсон 03.08.2023 КВВ СВФР-011182
		|	" + ПолеВычет312Остаток + " КАК Вычет312Остаток,
		|	" + ПолеВычет311Остаток + " КАК Вычет311Остаток,
		//|	" + ПолеВычетыЛичныеЗаПериод + "  КАК ПримененныеВычетыЛичныеЗаПериод,    //Минск
		//|	" + ПолеВычетыДетскиеЗаПериод + " КАК ПримененныеВычетыДетскиеЗаПериод,   //Минск
		//|	" + ПолеВычетыДетскиеЛьготаЗаПериод + " КАК ПримененныеВычетыДетскиеЛьготаЗаПериод,   //Минск
		//|	" + ПолеВычетыДополнительныеЗаПериод + " КАК ПримененныеВычетыДополнительныеЗаПериод, //Минск
		//|	" + ПолеВычеты312ЗаПериод + " КАК ПримененныеВычеты312ЗаПериод,  //Минск
		//|	" + ПолеВычеты311ЗаПериод + " КАК ПримененныеВычеты311ЗаПериод,   //Минск
		|	" + ПолеРанееПримененныеВычетыЛичные + " КАК РанееПримененныеВычетыЛичные,
		|	" + ПолеРанееПримененныеВычетыДетские + " КАК РанееПримененныеВычетыДетские,
		|	" + ПолеРанееПримененныеВычетыДетскиеЛьгота + " КАК РанееПримененныеВычетыДетскиеЛьгота,
		|	" + ПолеРанееПримененныеВычетыДополнительные  + " КАК  РанееПримененныеВычетыДополнительные,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	" + ПолеРанееПримененныеВычетыМолодыеСпециалисты  + " КАК  РанееПримененныеВычетыМолодыеСпециалисты,
		//Аверсон СВФР-012095
		
		|	" + ПолеРанееПримененныеВычеты640Страх + " КАК РанееПримененныеВычеты640Страх,
		|	" + ПолеРанееПримененныеВычеты641Страх + " КАК РанееПримененныеВычеты641Страх, //Аверсон 03.08.2023 КВВ СВФР-011182
		|	" + ПолеРанееПримененныеВычеты312 + " КАК РанееПримененныеВычеты312,
		|	" + ПолеРанееПримененныеВычеты311 + " КАК РанееПримененныеВычеты311,
		|	" + ПолеРанееПримененныеВычетыЛичныеЗаМесяц + " КАК РанееПримененныеВычетыЛичныеЗаМесяц,
		|	" + ПолеРанееПримененныеВычетыДетскиеЗаМесяц + " КАК РанееПримененныеВычетыДетскиеЗаМесяц,
		|	" + ПолеРанееПримененныеВычетыДетскиеЛьготаЗаМесяц + " КАК РанееПримененныеВычетыДетскиеЛьготаЗаМесяц,
		|	" + ПолеРанееПримененныеВычетыДополнительныеЗаМесяц + " КАК РанееПримененныеВычетыДополнительныеЗаМесяц,
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		|	" + ПолеРанееПримененныеВычетыМолодыеСпециалистыЗаМесяц + " КАК РанееПримененныеВычетыМолодыеСпециалистыЗаМесяц,
		//Аверсон СВФР-012095
		
		|	" + ПолеРанееПримененныеВычеты640СтрахЗаМесяц + " КАК РанееПримененныеВычеты640СтрахЗаМесяц,
		|	" + ПолеРанееПримененныеВычеты641СтрахЗаМесяц + " КАК РанееПримененныеВычеты641СтрахЗаМесяц, //Аверсон 03.08.2023 КВВ СВФР-011182
		|	" + ПолеРанееПримененныеВычеты312ЗаМесяц + " КАК РанееПримененныеВычеты312ЗаМесяц,
		|	" + ПолеРанееПримененныеВычеты311ЗаМесяц + " КАК РанееПримененныеВычеты311ЗаМесяц,
		|	ДоходыЗаГод.РазмерВычета,
		|	ДоходыЗаГод.КоличДетей,
		|	ДоходыЗаГод.РазмерВычетаУчеба,
		
		//Аверсон ЕАЕ 02.02.2024 СВФР-012095
		//|   ДоходыЗаГод.ОблагаемыйДоходЗаГод,
		//|   ДоходыЗаГод.ОблагаемыйДоходЗаПериод,
		//|   ДоходыЗаГод.ОблагаемыйВычетЗаПериод,
		//|   ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыЛичныеЗаГод, 0) + ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЗаГод, 0) + ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЛьготаЗаГод, 0) + ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДополнительныеЗаГод, 0) + ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыМолодыеСпециалистыЗаГод, 0),
		//|   ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыЛичныеЗаГод, 0) + ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЗаГод, 0) + ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЛьготаЗаГод, 0) + ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДополнительныеЗаГод, 0), 
		//|   ЕСТЬNULL(ДоходыЗаГод.ОблагаемыйДоходЗаГод, 0) - ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыЛичныеЗаГод, 0) - ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЗаГод, 0) - ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДетскиеЛьготаЗаГод, 0) - ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыДополнительныеЗаГод, 0), 
		//|   ЕСТЬNULL(РаботникиОргВычетыЗаГод.ВычетыМолодыеСпециалистыЗаГод, 0) КАК ВычМСГод,
		//|   РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные КАК Личн,
		//|   РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские КАК Детск,
		//|   РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеЛьгота КАК ДетскЛьг,
		//|   РаботникиОргПраваНаВычеты.СтандартныеВычетыДополнительные КАК Доп,
		//|   РаботникиОргПраваНаВычеты.СтандартныеВычетыМолодыеСпециалисты КАК МС,
		//Аверсон СВФР-012095
		
		|	ДоходыЗаГод.КоличДетейУчеба"; //Островская Татьяна 07.10.2013 № 16
		
		Если КомментироватьРасчет Тогда
			ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + ",
			|	" + ПолеОблагаемыйДоходЗаГод + " КАК ОблагаемыйДоходЗаГод,
			|	" + ПолеРанееНалогИсчисленный + " КАК РанееНалогИсчисленный,
			|	ЕСТЬNULL(ДоходыПоВидамРасчета.ДоходЗаМесяц, 0) КАК ДоходЗаМесяц,
			|	ЕСТЬNULL(ДоходыПоВидамРасчета.ВычетЗаМесяц, 0) КАК ВычетЗаМесяц,
			|	ЕСТЬNULL(ДоходыПоВидамРасчета.ДоходЗаМесяцПоВидамРасчета, 0) КАК ДоходЗаМесяцПоВидамРасчета,
			|	ДоходыПоВидамРасчета.ВидРасчета КАК ВидРасчета,
			|	ДоходыПоВидамРасчета.ВидРасчета.Наименование КАК ВидРасчетаНаименование"; //О.Т. Аверсон 29.03.2016 № 950
		КонецЕсли;
		ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + "
		|ИЗ
		|	("+ДоходыЗаГодТекст+") КАК ДоходыЗаГод
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+НДФЛРасчетыСБюджетомЗаГодТекст+") КАК НДФЛРасчетыСБюджетомЗаГод
		|		ПО НДФЛРасчетыСБюджетомЗаГод.Период = ДоходыЗаГод.Период И НДФЛРасчетыСБюджетомЗаГод.ФизЛицо = ДоходыЗаГод.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ПрименяемыеВычетыЗаГодТекст+") КАК РаботникиОргВычетыЗаГод
		|		ПО ДоходыЗаГод.Период = РаботникиОргВычетыЗаГод.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты640СтрахТекст+") КАК Вычеты640Страх
		|		ПО Вычеты640Страх.Период = ДоходыЗаГод.Период И Вычеты640Страх.ФизЛицо = ДоходыЗаГод.ФизЛицо
		
		//Аверсон 03.08.2023 КВВ СВФР-011182 (
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты641СтрахТекст+") КАК Вычеты641Страх
		|		ПО Вычеты641Страх.Период = ДоходыЗаГод.Период И Вычеты641Страх.ФизЛицо = ДоходыЗаГод.ФизЛицо
		//Аверсон 03.08.2023 КВВ СВФР-011182 )
		
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты312Текст+") КАК Вычеты312
		|		ПО Вычеты312.Период = ДоходыЗаГод.Период И Вычеты312.ФизЛицо = ДоходыЗаГод.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты311Текст+") КАК Вычеты311
		|		ПО Вычеты311.Период = ДоходыЗаГод.Период И Вычеты311.ФизЛицо = ДоходыЗаГод.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТФизЛицаСНалогообл КАК ВТФизЛицаСНалогообл
		|		ПО ДоходыЗаГод.ФизЛицо = ВТФизЛицаСНалогообл.ФизЛицо";
		//|	("+ПрименяемыеВычетыЗаГодТекст+") КАК РаботникиОргВычетыЗаГод
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+НДФЛРасчетыСБюджетомЗаГодТекст+") КАК НДФЛРасчетыСБюджетомЗаГод
		//|		ПО НДФЛРасчетыСБюджетомЗаГод.Период = РаботникиОргВычетыЗаГод.Период И НДФЛРасчетыСБюджетомЗаГод.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ДоходыЗаГодТекст+") КАК ДоходыЗаГод
		//|		ПО ДоходыЗаГод.Период = РаботникиОргВычетыЗаГод.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты312Текст+") КАК Вычеты312
		//|		ПО Вычеты312.Период = РаботникиОргВычетыЗаГод.Период И Вычеты312.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
		//|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты311Текст+") КАК Вычеты311
		//|		ПО Вычеты311.Период = РаботникиОргВычетыЗаГод.Период И Вычеты311.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо";
		Если КомментироватьРасчет Тогда
			ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + "
			|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ДоходыПоВидамРасчетаТекст + ") КАК ДоходыПоВидамРасчета
			|		ПО ДоходыПоВидамРасчета.Период = ДоходыЗаГод.Период 
			|		И ДоходыПоВидамРасчета.ФизЛицо = ДоходыЗаГод.Физлицо";
		КонецЕсли;
		ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + "
		|
		|	УПОРЯДОЧИТЬ ПО ДоходыЗаГод.Физлицо, ДоходыЗаГод.Период";
		//|	ГДЕ
		//|		(" + ПолеНалогИсчисленный + " <> " + ПолеРанееНалогИсчисленный + " ИЛИ 
		//|		" + ПолеПримененныеВычеты312 + " <> " + ПолеРанееПримененныеВычеты312 + " ИЛИ 
		//|		" + ПолеПримененныеВычеты311 + " <> " + ПолеРанееПримененныеВычеты311 + " ИЛИ 
		//|		" + ПолеПримененныеВычетыЛичные + " <> " + ПолеРанееПримененныеВычетыЛичные + " ИЛИ 
		//|		" + ПолеПримененныеВычетыДетские + " <> " + ПолеРанееПримененныеВычетыДетские + " ИЛИ
		//|		" + ПолеПримененныеВычетыДетскиеИнвалидов + " <> " + ПолеРанееПримененныеВычетыДетскиеИнвалидов +")
		//|	УПОРЯДОЧИТЬ ПО РаботникиОргВычетыЗаГод.Физлицо.Наименование, РаботникиОргВычетыЗаГод.Период";
		Если КомментироватьРасчет Тогда
			ИсчисленныйНДФЛТекст = ИсчисленныйНДФЛТекст + "
			|	ИТОГИ 
			|		МАКСИМУМ(Физлицо),
			|		МАКСИМУМ(Период),
			|		МАКСИМУМ(Резидент),
			|		МАКСИМУМ(ДоходЗаГод),
			|		МАКСИМУМ(ДоходЗаПериод),
			|		МАКСИМУМ(НалогРанееИсчисленный),
			|		МАКСИМУМ(НалогИсчисленный),
			|		МАКСИМУМ(ПримененныеВычетыЛичные),
			|		МАКСИМУМ(ПримененныеВычетыДетские),
			|		МАКСИМУМ(ПримененныеВычетыДетскиеЛьгота),
			|		МАКСИМУМ(ПримененныеВычетыДополнительные),
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			|		МАКСИМУМ(ПримененныеВычетыМолодыеСпециалисты),
			//Аверсон СВФР-012095
			
			//|		МАКСИМУМ(ПримененныеВычеты312),
			//|		МАКСИМУМ(ПримененныеВычеты311),
			|        МАКСИМУМ(Вычет640СтрахОстаток),
			|        МАКСИМУМ(Вычет641СтрахОстаток),//Аверсон 03.08.2023 КВВ СВФР-011182
			|        МАКСИМУМ(Вычет312Остаток),
			|        МАКСИМУМ(Вычет311Остаток),
			|		МАКСИМУМ(ПримененныеВычетыЛичныеЗаПериод),
			|		МАКСИМУМ(ПримененныеВычетыДетскиеЗаПериод),
			|		МАКСИМУМ(ПримененныеВычетыДетскиеЛьготаЗаПериод),
			|		МАКСИМУМ(ПримененныеВычетыДополнительныеЗаПериод),
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			|		МАКСИМУМ(ПримененныеВычетыМолодыеСпециалистыЗаПериод),
			//Аверсон СВФР-012095
			
			//|		МАКСИМУМ(ПримененныеВычеты312ЗаПериод),
			//|		МАКСИМУМ(ПримененныеВычеты311ЗаПериод),
			|		МАКСИМУМ(РанееПримененныеВычетыЛичные),
			|		МАКСИМУМ(РанееПримененныеВычетыДетские),
			|		МАКСИМУМ(РанееПримененныеВычетыДетскиеЛьгота),
			|		МАКСИМУМ(РанееПримененныеВычетыДополнительные),
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			|		МАКСИМУМ(РанееПримененныеВычетыМолодыеСпециалисты),
			//Аверсон СВФР-012095
			
			|		МАКСИМУМ(РанееПримененныеВычеты312),
			|		МАКСИМУМ(РанееПримененныеВычеты311),
			|		МАКСИМУМ(РанееПримененныеВычетыЛичныеЗаМесяц),
			|		МАКСИМУМ(РанееПримененныеВычетыДетскиеЗаМесяц),
			|		МАКСИМУМ(РанееПримененныеВычетыДетскиеЛьготаЗаМесяц),
			|		МАКСИМУМ(РанееПримененныеВычетыДополнительныеЗаМесяц),
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			|		МАКСИМУМ(РанееПримененныеВычетыМолодыеСпециалистыЗаМесяц),
			//Аверсон СВФР-012095
			
			|		МАКСИМУМ(РанееПримененныеВычеты312ЗаМесяц),
			|		МАКСИМУМ(РанееПримененныеВычеты311ЗаМесяц),
			|		МАКСИМУМ(РанееПримененныеВычеты640СтрахЗаМесяц),
			|		МАКСИМУМ(РанееПримененныеВычеты641СтрахЗаМесяц),//Аверсон 03.08.2023 КВВ СВФР-011182
			|		МАКСИМУМ(ОблагаемыйДоходЗаГод),
			|		МАКСИМУМ(РанееНалогИсчисленный),
			|		МАКСИМУМ(ДоходЗаМесяц),
			|		МАКСИМУМ(ВычетЗаМесяц),
			|		СУММА(ДоходЗаМесяцПоВидамРасчета)
			|	ПО
			|		Период";
		КонецЕсли;
		
		Запрос.Текст = ПодразделенияПоМесяцамТекст;
		ВыборкаПодразделений = Запрос.Выполнить().Выбрать();
		
		Запрос.Текст = ИсчисленныйНДФЛТекст;
		
		
		Возврат Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	КонецЕсли;
КонецФункции  // ПолучитьДанныеНДФЛПоРегистратору

// Проверяет необходимость выполнения перерасчета документа
// если в таблицах перерасчета по документу ссылка на который передана 
// есть хоть одна запись - возращает Истина
// Параметры:
//  Регистратор - ссылка на документ
// Возвращаемое значение:
//  булево
//
Функция НеобходимостьПерерасчета(Регистратор) Экспорт
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	Перерасчет.ФизЛицо
	|ИЗ
	|	(ВЫБРАТЬ ПЕРВЫЕ 1
	|		Перерасчет.ФизЛицо КАК ФизЛицо
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ПерерасчетОсновныхНачислений КАК Перерасчет
	|	
	|	ГДЕ
	|		Перерасчет.ОбъектПерерасчета = &парамРегистратор
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ ПЕРВЫЕ 1
	|		Перерасчет.ФизЛицо
	|	ИЗ
	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.ПерерасчетДополнительныхНачислений КАК Перерасчет
	|	
	|	ГДЕ
	|		Перерасчет.ОбъектПерерасчета = &парамРегистратор) КАК Перерасчет");
	Запрос.УстановитьПараметр("парамРегистратор", Регистратор);
	Если Запрос.Выполнить().Пустой() Тогда 
		Возврат Ложь;
	Иначе
		Возврат Истина;
	КонецЕсли;
	
КонецФункции  // НеобходимостьПерерасчета

// Возвращает вид учета времени в зависимости от вида расчета и вида графика 
Функция ПолучитьВидУчетаВремени(СпособРасчета, ВидВремени, СуммированныйУчетРабочегоВремени = Ложь, НачислениеВидУчетаВремени = Неопределено,ВидРасчета1 = Неопределено) Экспорт
	
	//ТОЛИК ПЕРЕДЕЛАЛ ПОЛНОСТЬЮ
	
	// вид учета времени определяется по способу расчета
	
	//	Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам 
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке 
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке 
	////толик
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезКонтракта
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредность
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке4Разряда
	////енд
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок 
	//		или ВидВремени = Перечисления.ВидыВремени.ЧасовоеНеотработанное 
	//		или ВидВремени = Перечисления.ВидыВремени.ЧасовоеОтработанноеВПределахНормы Тогда
	//		
	//		ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;
	//			
	//	ИначеЕсли СуммированныйУчетРабочегоВремени и (СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка 
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку 
	//		или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС) Тогда 
	//		
	//		ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;
	//		
	//	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы Тогда
	Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы Тогда
		
		ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоВечернимЧасам;
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы или
		СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф или //О.Т. Аверсон 04.04.2016 № 981
		СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр или //О.Т. Аверсон 04.04.2016 № 981
		СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой Тогда //О.Т. 22.05.2015 № 	
		
		ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоНочнымЧасам;
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Питание или 
		СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням или
		СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке или
		СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням или
		СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке Тогда	
		
		ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
		
	Иначе
		Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроизвольнаяФормула
			И НачислениеВидУчетаВремени <> Неопределено Тогда
			Если НачислениеВидУчетаВремени = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы Тогда
				ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоВечернимЧасам;
			ИначеЕсли НачислениеВидУчетаВремени = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы Тогда
				ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоНочнымЧасам;
			ИначеЕсли НачислениеВидУчетаВремени = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаДни Тогда
				ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
			ИначеЕсли ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда //О.Т. Аверсон 20.12.2017 № 1369
				ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
			иначе                                                      				
				ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;	
			КонецЕсли;
		Иначе                         
			Если ВидРасчета1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням Тогда //О.Т. Аверсон 05.06.2018 № 2067
				ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
			иначе
				ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;
			КонецЕсли; 
			
		КонецЕсли;
		
	КонецЕсли;
	
	Возврат ВидУчетаВремени;
КонецФункции


////////////////////////////////////////////////////////////////////////////////
// ДАТЫ ИЗМЕНЕНИЯ ЗАКОНОДАТЕЛЬСТВА

// Возвращает дату вступления в силу Федерального закона от 30 июня 2006 г. № 90-ФЗ
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   дата
//
Функция ПолучитьДатуВступленияВСилуИзмененийТрудовогоКодекса2006() Экспорт
	
	Возврат	'20061006' // статья 3: по истечении 90 дней после дня официального опубликования - Российская газета от 7 июля 2006 г. №146 
	
КонецФункции // ПолучитьДатуВступленияВСилуИзмененийТрудовогоКодекса2006()

// Возвращает дату вступления в силу Федерального закона от 29 декабря 2006 г. № 255-ФЗ
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   дата
//
Функция ПолучитьДатуВступленияВСилуИзмененийПоСоциальнымПособиям2006() Экспорт
	
	Возврат	'20070101' // статья 19: Федеральный закон вступает в силу с 1 января 2007 года. 
	
КонецФункции // ПолучитьДатуВступленияВСилуИзмененийТрудовогоКодекса2006()

// Возвращает дату вступления в силу Постановления Правительства РФ от 24 декабря 2007 г. №922
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   дата
//
Функция ПолучитьДатуВступленияВСилуИзмененийПоОтпускам2008() Экспорт
	
	Возврат	'20080106' // Постановление опубликовано в Российской газете от 29 декабря 2007 г. №..., вступает в силу по истечении 7 календарных дней - с 6 января 2008 года. 
	
КонецФункции // ПолучитьДатуВступленияВСилуИзмененийТрудовогоКодекса2006()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ РАСЧЕТА ДОКУМЕНТОВ

// Заполняем переданный набор записей регистра расчета ОсновныеНачисленияОрганизации переданными данными
Функция ДобавитьСтрокуОсновныхНачислений(НаборЗаписей, ВыборкаПоШапкеДокумента, ВыборкаПоСтрокамДокумента) Экспорт
	
	Движение = НаборЗаписей.Добавить();
	
	СтрокаСвойствИзДокумента = "ПериодРегистрации,ФизЛицо,Организация,ОбособленноеПодразделение";
	//Островская Татьяна 05.12.2012 № 16
	СтрокаСвойствИзСтрокиДокумента = "ПериодДействияНачало,ПериодДействияКонец,ВидРасчета,Сторно,Результат,ОплаченоДнейЧасов,ОплаченоДней,ВидУчетаВремени," 
	+ "Сотрудник,ПодразделениеОрганизации,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,ДополнительныеДанные,ГрафикРаботы,ГрафикРаботыНорма,"
	+ "ДатаНачалаСобытия,Авторасчет,ВариантОбработкиЗаписиПриОтраженииВРеглУчете,"
	+ "ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание,СторнируемыйДокумент";
	//Островская Татьяна 05.12.2012 № 16
	// ресурсы по норме времени
	Если ВыборкаПоСтрокамДокумента.ЗачетНормыВремени Тогда
		СтрокаСвойствИзСтрокиДокумента = СтрокаСвойствИзСтрокиДокумента + ",НормаДней,НормаЧасов,НормаДнейПоПятидневке,НормаЧасовПоПятидневке";
	КонецЕсли;
	
	// ресурсы по отработанному времени
	Если ВыборкаПоСтрокамДокумента.ЗачетОтработанногоВремени Тогда
		СтрокаСвойствИзСтрокиДокумента = СтрокаСвойствИзСтрокиДокумента + ",ОтработаноДней,ОтработаноЧасов,ОтработаноДнейПоПятидневке,ОтработаноЧасовПоПятидневке";
	КонецЕсли; 
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоШапкеДокумента,СтрокаСвойствИзДокумента);
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоСтрокамДокумента,СтрокаСвойствИзСтрокиДокумента);
	
	Возврат Движение
	
КонецФункции // ДобавитьСтрокуОсновныхНачислений

// Заполняем переданный набор записей регистра расчета ДополнительныеНачисленияОрганизации переданными данными
Функция ДобавитьСтрокуДополнительныхНачислений(НаборЗаписей, ВыборкаПоШапкеДокумента, ВыборкаПоСтрокамДокумента) Экспорт
	
	Движение = НаборЗаписей.Добавить();
	
	СтрокаСвойствИзДокумента = "ДатаНачалаСобытия,ФизЛицо,Организация,ОбособленноеПодразделение";
	Если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда //О.Т. Аверсон 21.11.2018 № 2774
		СтрокаСвойствИзСтрокиДокумента = "БазовыйПериодНачало,БазовыйПериодКонец,ВидРасчета,Сторно,Результат,ОплаченоДнейЧасов,СторнируемыйДокумент,ЧислоМесяцев," 
		+ "Сотрудник,ПодразделениеОрганизации,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,ГрафикРаботы,ВидУчетаВремени,"
		+ "Авторасчет,ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание,ДатаНачалаСобытия";
	иначе
		СтрокаСвойствИзСтрокиДокумента = "БазовыйПериодНачало,БазовыйПериодКонец,ВидРасчета,Сторно,Результат,ОплаченоДнейЧасов,СторнируемыйДокумент,ЧислоМесяцев," 
		+ "Сотрудник,ПодразделениеОрганизации,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,ГрафикРаботы,ВидУчетаВремени,"
		+ "Авторасчет,ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание";
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоШапкеДокумента,СтрокаСвойствИзДокумента);
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоСтрокамДокумента,СтрокаСвойствИзСтрокиДокумента);
	//Островская Татьяна 02.09.2013 № 16734
	если не ЗначениеЗаполнено(Движение.БазовыйПериодНачало) Тогда 
		Движение.БазовыйПериодНачало =  НачалоДня(ВыборкаПоСтрокамДокумента.ДатаНачалаСобытия);
		Движение.БазовыйПериодКонец =  КонецДня(ВыборкаПоСтрокамДокумента.ДатаНачалаСобытия);
	КонецЕсли;
	
	//Островская Татьяна 02.09.2013 № 16734
	
	
	Движение.ПериодРегистрации   = ВыборкаПоШапкеДокумента.ПериодРегистрацииДополнительныхНачислений;
	
	Возврат Движение
	
КонецФункции // ДобавитьСтрокуДополнительныхНачислений()

// Заполняем переданный набор записей регистра расчета УдержанияРаботниковОрганизаций переданными данными
Функция ДобавитьСтрокуУдержаний(НаборЗаписей, ВыборкаПоШапкеДокумента, ВыборкаПоСтрокамДокумента) Экспорт
	
	Движение = НаборЗаписей.Добавить();
	
	СтрокаСвойствИзДокумента = "ФизЛицо,Организация,ОбособленноеПодразделение,ПериодРегистрации";
	СтрокаСвойствИзСтрокиДокумента = "БазовыйПериодНачало,БазовыйПериодКонец,ВидРасчета,Сторно,Результат," 
	+ "Сотрудник,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,ГрафикРаботы,ВидУчетаВремени,"
	+ "Авторасчет,ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание";
	
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоШапкеДокумента,СтрокаСвойствИзДокумента);
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоСтрокамДокумента,СтрокаСвойствИзСтрокиДокумента);
	
	Возврат Движение
	
КонецФункции // ДобавитьСтрокуДополнительныхНачислений()

// рассчитываем сумму за работу в документах сдельной выработки
//
// Параметры
//  ТекущиеДанные - данные строки т.ч. Выработка
//  РассчитыватьСуммуЗаРаботуВВалютеРасценки - булево, флажок пересчета суммы в валюте расценки
//
Процедура РассчитатьСуммуЗаРаботу(ОтражатьВБухгалтерскомУчете, ОтражатьВУправленческомУчете, ТекущиеДанные, Дата, ВалютаРегламентированногоУчета, ВалютаУпрУчета, КурсВалютыУпрУчета, КратностьВалютыУпрУчета, РассчитыватьСуммуЗаРаботуВВалютеРасценки = Истина) Экспорт
	
	Если РассчитыватьСуммуЗаРаботуВВалютеРасценки Тогда
		ТекущиеДанные.СуммаЗаРаботуВВалютеРасценки = ОбщегоНазначения.ОкруглитьЗначение2016(ТекущиеДанные.Расценка * ТекущиеДанные.Количество * ?(ТекущиеДанные.КоэффициентРаботыНаХолоде <> 0, ТекущиеДанные.КоэффициентРаботыНаХолоде, 1),Дата);
	КонецЕсли;
	
	Если ТекущиеДанные.Валюта = ВалютаРегламентированногоУчета Тогда
		КурсВылютыРасценки = 1;
		КратностьВылютыРасценки = 1;
	ИначеЕсли ТекущиеДанные.Валюта = ВалютаУпрУчета Тогда	
		КурсВылютыРасценки = КурсВалютыУпрУчета;
		КратностьВылютыРасценки = КратностьВалютыУпрУчета;
	Иначе	
		Структура = РегистрыСведений.КурсыВалютДляРасчетовСПерсоналом.ПолучитьПоследнее(Дата, Новый Структура("Валюта", ТекущиеДанные.Валюта));
		КурсВылютыРасценки = Структура.Курс;
		КратностьВылютыРасценки = Структура.Кратность;
	КонецЕсли; 
	
	Если ОтражатьВУправленческомУчете Тогда
		ТекущиеДанные.Сумма = ОбщегоНазначения.ПересчитатьИзВалютыВВалюту(ТекущиеДанные.СуммаЗаРаботуВВалютеРасценки,ТекущиеДанные.Валюта,ВалютаУпрУчета,
		КурсВылютыРасценки, КурсВалютыУпрУчета, КратностьВылютыРасценки, КратностьВалютыУпрУчета,Дата); //О.Т. Аверсон 12.03.2016 № 949
	КонецЕсли;
	Если ОтражатьВБухгалтерскомУчете Тогда
		ТекущиеДанные.СуммаРегл = ОбщегоНазначения.ПересчитатьИзВалютыВВалюту(ТекущиеДанные.СуммаЗаРаботуВВалютеРасценки,ТекущиеДанные.Валюта,ВалютаРегламентированногоУчета,
		КурсВылютыРасценки, 1, КратностьВылютыРасценки, 1, Дата);//О.Т. Аверсон 12.03.2016 № 949
	КонецЕсли;
	
КонецПроцедуры // РассчитатьСуммуЗаРаботу()

// Процедура рассчитывает начисления по среднему и заполняет реквизит Результат таблицы начислений
// Параметры:
//  	РассчитываемыеТаблицы  - структура из элементов, соответствующих табличным частям документа. 
//				Значение Истина для каждого из элементов структуры означает необходимость расчета 
//				соответствующей табличной части документа
// 		РежимПерерасчета - булево - признак вызов расчета при перерасчете документа
Функция РассчитатьДокументСреднегоЗаработка(Документ, РассчитываемыеТаблицы, ВыборкаПоШапкеДокумента, РежимПерерасчета = Ложь, РезультатЗапросаПоРасчетСреднего = Неопределено, ДатаНачалаТЧДатОплатаПоСреднему = Неопределено) Экспорт //Аверсон 08.11.2022 КВВ СВФР-009796 (добавлено ДатаНачалаТЧДатОплатаПоСреднему)
	//Островская Татьяна 27.12.2012 № 15	
	Перем ВалютаУпрУчета;
	Перем КурсВалютыУпрУчета;
	//Островская Татьяна 27.12.2012 № 15
	Отказ = Ложь;
	
	Ссылка = Документ.Ссылка;
	
	// Создадим наборы записей используемых регистров 
	НаборОсновныеНачисления = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.СоздатьНаборЗаписей();
	НаборОсновныеНачисления.Отбор.Регистратор.Значение = Ссылка;
	//НаборОсновныеНачисления.мВыполнятьВспомогательныеРасчеты = Ложь;
	
	НаборДополнительныеНачисления = РегистрыРасчета.ДополнительныеНачисленияРаботниковОрганизаций.СоздатьНаборЗаписей();
	НаборДополнительныеНачисления.Отбор.Регистратор.Значение = Ссылка;
	
	НаборРасчетСреднего = РегистрыРасчета.РасчетСреднегоЗаработка.СоздатьНаборЗаписей();
	НаборРасчетСреднего.Отбор.Регистратор.Значение = Ссылка;
	
	Если НЕ РассчитываемыеТаблицы.РасчетСреднего Тогда
		
		// получим реквизиты табличной части РасчетСреднего 
		
		Если РезультатЗапросаПоРасчетСреднего = Неопределено Тогда
			
			Запрос = Новый Запрос;
			
			// Установим параметры запроса
			Запрос.УстановитьПараметр("ДокументСсылка",		Ссылка);
			
			Запрос.Текст =
			"ВЫБРАТЬ
			|	СтрокаРасчетСреднего.НомерСтроки,
			|	СтрокаРасчетСреднего.Ссылка.Сотрудник КАК Сотрудник,
			|	СтрокаРасчетСреднего.Ссылка.Сотрудник.Физлицо КАК Физлицо,
			|	ВЫБОР
			|		КОГДА СтрокаРасчетСреднего.Ссылка.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
			|			ТОГДА СтрокаРасчетСреднего.Ссылка.Организация
			|		ИНАЧЕ СтрокаРасчетСреднего.Ссылка.Организация.ГоловнаяОрганизация
			|	КОНЕЦ КАК Организация,
			|	СтрокаРасчетСреднего.ВидРасчета,
			|	СтрокаРасчетСреднего.БазовыйПериодНачало КАК БазовыйПериодНачало,
			|	ВЫБОР КОГДА СтрокаРасчетСреднего.БазовыйПериодКонец <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) ТОГДА КОНЕЦПЕРИОДА(СтрокаРасчетСреднего.БазовыйПериодКонец, ДЕНЬ) ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КОНЕЦ КАК БазовыйПериодКонец,
			|	СтрокаРасчетСреднего.ОтработаноПоПятидневке,
			|	СтрокаРасчетСреднего.НормаПоПятидневке,
			|	СтрокаРасчетСреднего.ОтработаноДней,
			|	СтрокаРасчетСреднего.ОтработаноЧасов,
			|	СтрокаРасчетСреднего.ЧислоМесяцев,
			|	СтрокаРасчетСреднего.КоэффициентИндексации,";
			если ТипЗнч(Ссылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
				Запрос.Текст = Запрос.Текст + " 
				|	СтрокаРасчетСреднего.МесяцВыборки,";
			КонецЕсли;
			Запрос.Текст = Запрос.Текст + "
			|	//
			|	СтрокаРасчетСреднего.Результат
			|ИЗ
			|	Документ." + Документ.Метаданные().Имя + ".РасчетСреднего КАК СтрокаРасчетСреднего
			|
			|ГДЕ
			|	СтрокаРасчетСреднего.Ссылка = &ДокументСсылка";
			если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")  Тогда
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//","СтрокаРасчетСреднего.ДатаДоговора, СтрокаРасчетСреднего.НомерДоговора,");
			иначе
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//","");
			КонецЕсли;
			
			
			РезультатЗапросаПоРасчетСреднего = Запрос.Выполнить();
			
		КонецЕсли;
		
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		Если ТипЗнч( ВыборкаПоШапкеДокумента.Ссылка ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда" )  Тогда
			ДатаНачалаБольничного = ПолучитьРеквизитПервичного( Документ, "ДатаНачала" );
		КонецЕсли;
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		
		ВыборкаПоРасчетСреднего = РезультатЗапросаПоРасчетСреднего.Выбрать();
		Пока ВыборкаПоРасчетСреднего.Следующий() Цикл
			
			СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоРасчетСреднего.НомерСтроки) +
			""" табл. части ""Расчет среднего"": ";
			
			// Вид расчета
			Если НЕ ЗначениеЗаполнено(ВыборкаПоРасчетСреднего.ВидРасчета) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан вид расчета среднего заработка!", Отказ);
			КонецЕсли;
			
			// Дата начала базового периода
			Если НЕ ЗначениеЗаполнено(ВыборкаПоРасчетСреднего.БазовыйПериодНачало) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала базового периода!", Отказ);
				// Дата окончания базового периода
			ИначеЕсли НЕ ЗначениеЗаполнено(ВыборкаПоРасчетСреднего.БазовыйПериодКонец) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата окончания базового периода!", Отказ);
			ИначеЕсли ВыборкаПоРасчетСреднего.БазовыйПериодКонец < ВыборкаПоРасчетСреднего.БазовыйПериодНачало Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "дата начала базового периода не может быть больше даты окончания базового периода!", Отказ);
			КонецЕсли; 
			
			Если НЕ Отказ Тогда
				// Заполним записи в наборах записей регистров
				Движение = НаборРасчетСреднего.Добавить();
				
				// Свойства
				Движение.ПериодРегистрации				= ВыборкаПоШапкеДокумента.ПериодРегистрации;
				Движение.БазовыйПериодНачало			= ВыборкаПоРасчетСреднего.БазовыйПериодНачало;
				Движение.БазовыйПериодКонец				= ВыборкаПоРасчетСреднего.БазовыйПериодКонец;
				Движение.ВидРасчета						= ВыборкаПоРасчетСреднего.ВидРасчета;
				
				// Измерения
				Движение.Сотрудник						= ВыборкаПоРасчетСреднего.Сотрудник;
				Движение.Физлицо						= ВыборкаПоРасчетСреднего.Физлицо;
				Движение.Организация					= ВыборкаПоРасчетСреднего.Организация;
				
				// Ресурсы
				Движение.Результат						= ВыборкаПоРасчетСреднего.Результат;
				Движение.ОтработаноПоПятидневке			= ВыборкаПоРасчетСреднего.ОтработаноПоПятидневке;
				Движение.НормаПоПятидневке				= ВыборкаПоРасчетСреднего.НормаПоПятидневке;
				Движение.ОтработаноДней					= ВыборкаПоРасчетСреднего.ОтработаноДней;
				Движение.ОтработаноЧасов				= ВыборкаПоРасчетСреднего.ОтработаноЧасов;
				
				// Реквизиты
				Движение.КоэффициентИндексации			= ВыборкаПоРасчетСреднего.КоэффициентИндексации;
				Движение.ЧислоМесяцев					= ВыборкаПоРасчетСреднего.ЧислоМесяцев;
				Движение.ПериодРасчетаСреднегоЗаработка	= ВыборкаПоШапкеДокумента.ПериодРасчетаСреднегоЗаработка;
				Движение.ДатаНачалаСобытия				= ВыборкаПоШапкеДокумента.ДатаНачалаСобытия;
				Движение.СпособРасчета					= ВыборкаПоШапкеДокумента.СпособРасчета;
				Движение.ДатаНачалаРасчетногоПериода	= ВыборкаПоШапкеДокумента.ПериодРасчетаСреднегоЗаработкаНачало;
				Движение.ДатаОкончанияРасчетногоПериода	= ВыборкаПоШапкеДокумента.ПериодРасчетаСреднегоЗаработкаОкончание;
				Если ТипЗнч( ВыборкаПоШапкеДокумента.Ссылка ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда" )  Тогда
					//Если Движение.ДатаНачалаРасчетногоПериода>= Движение.ДатаОкончанияРасчетногоПериода Тогда //О.Т. Аверсон 06.07.2018 № 
					//	Движение.ДатаОкончанияРасчетногоПериода	 = НачалоДня(КонецМесяца(Движение.ДатаНачалаРасчетногоПериода));
					//КонецЕсли;
					
					ЗапросДоговор = Новый Запрос;
					ЗапросДоговор.Текст = 
					//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
					//"ВЫБРАТЬ
					//- СВЭЙ КДЯ 01.10.19 СВФР-004756
					//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
					"ВЫБРАТЬ РАЗЛИЧНЫЕ
					//- СВЭЙ КДЯ 01.10.19 СВФР-004756
					|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
					|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
					|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
					|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
					|ИЗ
					|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
					//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
					//|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
					//|		ПО ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка
					//|			И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета
					//|			И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
					//|			И ДополнительныеНачисленияРаботниковОрганизаций.НомерСтроки = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.НомерСтроки
					//- СВЭЙ КДЯ 01.10.19 СВФР-004756
					|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
					|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
					|ГДЕ
					|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
					|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
					|	И &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
					|	И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
					|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
					
					//Аверсон ЕАЕ 09.01.2022 СВФР-010128
					|   И ВЫБОР
					|     КОГДА &ДоговорПодряда = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
					|     ТОГДА ИСТИНА
					|     ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = &ДоговорПодряда
					|     КОНЕЦ
					//Аверсон СВФР-010128
					
					//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
					|УПОРЯДОЧИТЬ ПО
					|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала, 
					|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка 
					//- СВЭЙ КДЯ 01.10.19 СВФР-004756
					|";
					
					ЗапросДоговор.УстановитьПараметр( "Сотрудник", Документ.Сотрудник );
					
					//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
					//ЗапросДоговор.УстановитьПараметр( "ДатаНачала", Документ.ДатаНачала );
					//- СВЭЙ КДЯ 01.10.19 СВФР-004756
					
					//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
					ЗапросДоговор.УстановитьПараметр( "ДатаНачала", ДатаНачалаБольничного );
					//- СВЭЙ КДЯ 01.10.19 СВФР-004756
					
					//Аверсон ЕАЕ 09.01.2022 СВФР-010128
					ЗапросДоговор.УстановитьПараметр("ДоговорПодряда", Документ.ДоговорПодряда);
					//Аверсон СВФР-010128
					
					РезультатЗапросаДоговор = ЗапросДоговор.Выполнить();
					
					ВыборкаДетальныеЗаписи = РезультатЗапросаДоговор.Выбрать();
					ДатаНачДоговора = Дата( 1, 1, 1 );
					СписокДокументов = Новый СписокЗначений;
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						ДатаТравмыНаПроизв = ДобавитьМесяц( НачалоМесяца( Документ.ДатаНачала ), -2 );
						
						ДатаНачДоговора = ?( Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,
						Макс( ВыборкаДетальныеЗаписи.ДатаНачала, ДатаТравмыНаПроизв ), 
						ВыборкаДетальныеЗаписи.ДатаНачала );
						
						СписокДокументов.Добавить( ВыборкаДетальныеЗаписи.Ссылка );
						ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
						Пока ЗначениеЗаполнено( ПервичныйДог ) Цикл 
							Если ПервичныйДог.Проведен Тогда 
								СписокДокументов.Добавить( ПервичныйДог );
							КонецЕсли;
							ДатаНачДоговора = ?( Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,
							Макс( ПервичныйДог.ДатаНачала, ДатаТравмыНаПроизв ), 
							ПервичныйДог.ДатаНачала );
							
							//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
							//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
							//- СВЭЙ КДЯ 02.12.19 СВФР-005149
							
							//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
							Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
								//защита от зацикливания
								ПервичныйДог = Неопределено;
							Иначе	
								ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
							КонецЕсли; 					   
							//- СВЭЙ КДЯ 02.12.19 СВФР-005149
						КонецЦикла;
						
					КонецЦикла;
					
					Если ВыборкаДетальныеЗаписи.Количество() = 0 Тогда 
						
						ЗапросДоговор.Текст = 
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						//"ВЫБРАТЬ
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						"ВЫБРАТЬ РАЗЛИЧНЫЕ
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
						|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
						|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
						|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
						|ИЗ
						|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
						//|		ПО ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						|ГДЕ
						|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
						|	И &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
						|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						|УПОРЯДОЧИТЬ ПО
						|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала, 
						|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка 
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						|";
						
						
						РезультатЗапроса = ЗапросДоговор.Выполнить();
						
						ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
						СписокДокументов = Новый СписокЗначений;
						
						ДатаТравмыНаПроизв = ДобавитьМесяц( НачалоМесяца( Документ.ДатаНачала ), -2 );
						Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
							
							ДатаНачДоговора = ?( Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,
							Макс( ВыборкаДетальныеЗаписи.ДатаНачала, ДатаТравмыНаПроизв ),
							ВыборкаДетальныеЗаписи.ДатаНачала );
							
							СписокДокументов.Добавить( ВыборкаДетальныеЗаписи.Ссылка );
							ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
							Пока ЗначениеЗаполнено( ПервичныйДог ) Цикл 
								Если ПервичныйДог.Проведен Тогда 
									СписокДокументов.Добавить( ПервичныйДог );
								КонецЕсли;
								
								ДатаНачДоговора = ?( Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,
								Макс( ПервичныйДог.ДатаНачала, ДатаТравмыНаПроизв ), 
								ПервичныйДог.ДатаНачала );
								
								//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
								//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
								//- СВЭЙ КДЯ 02.12.19 СВФР-005149
								
								//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
								Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
									//защита от зацикливания
									ПервичныйДог = Неопределено;
								Иначе	
									ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
								КонецЕсли; 					   
								//- СВЭЙ КДЯ 02.12.19 СВФР-005149
							КонецЦикла;
							
						КонецЦикла;
						
						ЗапросДоговор.Текст = 
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						//"ВЫБРАТЬ
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						"ВЫБРАТЬ РАЗЛИЧНЫЕ
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
						|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
						|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
						|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
						|ИЗ
						|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						//|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
						//|		ПО ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка
						//|			И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета
						//|			И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
						//|			И ДополнительныеНачисленияРаботниковОрганизаций.НомерСтроки = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.НомерСтроки
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
						|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
						|ГДЕ
						|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
						|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
						|	И ДоговорНаВыполнениеРаботСФизЛицом.Ссылка В ( &Ссылка )
						|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						|УПОРЯДОЧИТЬ ПО
						|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала, 
						|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка 
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						|";
						
						//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
						//ЗапросДоговор.УстановитьПараметр("Сотрудник", Документ.Сотрудник);
						//ЗапросДоговор.УстановитьПараметр("ДатаНачала", Документ.ДатаНачала);
						//- СВЭЙ КДЯ 01.10.19 СВФР-004756
						ЗапросДоговор.УстановитьПараметр( "Ссылка", СписокДокументов );
						
						РезультатЗапросаДоговор = ЗапросДоговор.Выполнить();
						
						ВыборкаДетальныеЗаписи = РезультатЗапросаДоговор.Выбрать();
						
						//СписокДокументов = Новый СписокЗначений;
						ДатаТравмыНаПроизв = ДобавитьМесяц( НачалоМесяца( Документ.ДатаНачала ), -2 );
						Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
							
							ДатаНачДоговора = ?( Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве, 
							Макс( ВыборкаДетальныеЗаписи.ДатаНачала, ДатаТравмыНаПроизв ), 
							ВыборкаДетальныеЗаписи.ДатаНачала );
							Если СписокДокументов.НайтиПоЗначению( ВыборкаДетальныеЗаписи.Ссылка ) = Неопределено Тогда 
								СписокДокументов.Добавить( ВыборкаДетальныеЗаписи.Ссылка );
							КонецЕсли;
							ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
							Пока ЗначениеЗаполнено( ПервичныйДог ) Цикл 
								Если ПервичныйДог.Проведен Тогда 
									Если СписокДокументов.НайтиПоЗначению( ВыборкаДетальныеЗаписи.Ссылка ) = Неопределено Тогда
										СписокДокументов.Добавить( ПервичныйДог );
									КонецЕсли;
								КонецЕсли;
								ДатаНачДоговора = ?( Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,
								Макс( ПервичныйДог.ДатаНачала, ДатаТравмыНаПроизв ),
								ПервичныйДог.ДатаНачала );
								
								//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
								//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
								//- СВЭЙ КДЯ 02.12.19 СВФР-005149
								
								//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
								Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
									//защита от зацикливания
									ПервичныйДог = Неопределено;
								Иначе	
									ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
								КонецЕсли; 					   
								//- СВЭЙ КДЯ 02.12.19 СВФР-005149
							КонецЦикла;
							
						КонецЦикла;
						
						
						//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
						
					КонецЕсли;
					
					Запрос = Новый Запрос;
					Запрос.Текст = 
					//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
					//"ВЫБРАТЬ
					//- СВЭЙ КДЯ 01.10.19 СВФР-004756
					//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
					"ВЫБРАТЬ РАЗЛИЧНЫЕ
					//- СВЭЙ КДЯ 01.10.19 СВФР-004756
					|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор
					|ИЗ
					|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
					|ГДЕ
					|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
					|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
					|	И ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование В(&ссылка)
					|	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ДатаН И &ДатаК
					|	И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
					|";
					
					Запрос.УстановитьПараметр("ДатаК", Движение.ДатаОкончанияРасчетногоПериода);
					Запрос.УстановитьПараметр("ДатаН", ДатаНачДоговора);
					Запрос.УстановитьПараметр("Сотрудник", Документ.Сотрудник);
					Запрос.УстановитьПараметр("ссылка", СписокДокументов);
					
					РезПроверкаНаличия = Запрос.Выполнить().Выгрузить();
					Если РезПроверкаНаличия.Количество()=0 Тогда 
						Движение.ДатаОкончанияРасчетногоПериода = КонецМесяца(ДобавитьМесяц(Движение.ДатаОкончанияРасчетногоПериода,1));
					КонецЕсли;
					
					
					
					Если ДатаНачДоговора <> Дата(1,1,1) Тогда 
						Движение.ДатаНачалаРасчетногоПериода	= ДатаНачДоговора;
					КонецЕсли;
					
					
				КонецЕсли;
				Движение.Включать = Истина;
				если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")  Тогда
					Движение.ДатаДоговора 					= ВыборкаПоРасчетСреднего.ДатаДоговора;
					Движение.НомерДоговора 					= ВыборкаПоРасчетСреднего.НомерДоговора;		 
				КонецЕсли;
				Движение.МесяцВыборки			        = ВыборкаПоРасчетСреднего.МесяцВыборки;//О.Т. 17.02.2015 № 334
			КонецЕсли;
			
		КонецЦикла;
		
		Если НЕ Отказ Тогда
			НаборРасчетСреднего.Записать();
		КонецЕсли;
		
	КонецЕсли;
	
	Если Отказ Тогда
		Возврат Не Отказ;
	КонецЕсли;
	
	// Если это документ-исправление, тогда добавим сторно-записи из исправляемого документа.
	Если ЗначениеЗаполнено(Документ.ПерерассчитываемыйДокумент) Тогда
		СформироватьСторноЗаписиПоПерерассчитываемомуДокументу(Документ.ПерерассчитываемыйДокумент, ВыборкаПоШапкеДокумента, НаборОсновныеНачисления, НаборДополнительныеНачисления);
	КонецЕсли;
	//О.Т. 23.09.2014 № 17616
	ДатаНачДоговора = Неопределено;
	Если ТипЗнч( ВыборкаПоШапкеДокумента.Ссылка ) = Тип( "ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда" ) Тогда
		
		ЗапросДоговор = Новый Запрос;
		ЗапросДоговор.Текст = 
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		//"ВЫБРАТЬ
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
		|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
		|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
		|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
		|ИЗ
		|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		//|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
		//|		ПО ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка
		//|			И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета
		//|			И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
		//|			И ДополнительныеНачисленияРаботниковОрганизаций.НомерСтроки = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.НомерСтроки
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
		|ГДЕ
		|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
		|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
		|	И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
		|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
		
		//Аверсон ЕАЕ 09.01.2022 СВФР-010128
		|   И ВЫБОР
		|     КОГДА &ДоговорПодряда = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
		|     ТОГДА ИСТИНА
		|     ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = &ДоговорПодряда
		|     КОНЕЦ
		//Аверсон СВФР-010128
		
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		|УПОРЯДОЧИТЬ ПО
		|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала, 
		|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка 
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		|";
		
		ЗапросДоговор.УстановитьПараметр("Сотрудник", Документ.Сотрудник);
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		//ЗапросДоговор.УстановитьПараметр( "ДатаНачала", Документ.ДатаНачала );
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		
		//Аверсон ЕАЕ 09.01.2023 СВФР-010128
		Если ДатаНачалаБольничного = Неопределено Тогда
			ДатаНачалаБольничного = ПолучитьРеквизитПервичного(Документ, "ДатаНачала");
		КонецЕсли;
		ЗапросДоговор.УстановитьПараметр("ДоговорПодряда", Документ.ДоговорПодряда);
		//Аверсон СВФР-010128
		
		//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
		ЗапросДоговор.УстановитьПараметр( "ДатаНачала", ДатаНачалаБольничного );
		//- СВЭЙ КДЯ 01.10.19 СВФР-004756
		
		РезультатЗапросаДоговор = ЗапросДоговор.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапросаДоговор.Выбрать();
		
		СписокДокументов = Новый СписокЗначений;
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			ДатаТравмыНаПроизв = ДобавитьМесяц(НачалоМесяца(Документ.ДатаНачала),-2);
			
			ДатаНачДоговора = ?(Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаТравмыНаПроизв),ВыборкаДетальныеЗаписи.ДатаНачала);
			
			СписокДокументов.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
			ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
			Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
				Если ПервичныйДог.Проведен Тогда 
					СписокДокументов.Добавить(ПервичныйДог);
				КонецЕсли;
				ДатаНачДоговора = ?(Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ПервичныйДог.ДатаНачала,ДатаТравмыНаПроизв),ПервичныйДог.ДатаНачала);
				
				//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
				//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
				//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				
				//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
				Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
					//защита от зацикливания
					ПервичныйДог = Неопределено;
				Иначе	
					ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
				КонецЕсли; 					   
				//- СВЭЙ КДЯ 02.12.19 СВФР-005149
			КонецЦикла;
			
		КонецЦикла;
		Если ВыборкаДетальныеЗаписи.Количество() = 0 Тогда 
			
			ЗапросДоговор.Текст = 
			//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
			//"ВЫБРАТЬ
			//- СВЭЙ КДЯ 01.10.19 СВФР-004756
			//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			//- СВЭЙ КДЯ 01.10.19 СВФР-004756
			|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ИЗ
			|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|		ПО ДоговорНаВыполнениеРаботСФизЛицом.Ссылка = ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование
			|ГДЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
			|	И &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
			|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
			//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
			|УПОРЯДОЧИТЬ ПО
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала, 
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка 
			//- СВЭЙ КДЯ 01.10.19 СВФР-004756
			|";
			
			
			РезультатЗапроса = ЗапросДоговор.Выполнить();
			
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			СписокДокументов = Новый СписокЗначений;
			
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				ДатаТравмыНаПроизв = ДобавитьМесяц(НачалоМесяца(Документ.ДатаНачала),-2);
				
				ДатаНачДоговора = ?(Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаТравмыНаПроизв),ВыборкаДетальныеЗаписи.ДатаНачала);
				СписокДокументов.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
				ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
				Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
					Если ПервичныйДог.Проведен Тогда 
						СписокДокументов.Добавить(ПервичныйДог);
					КонецЕсли;
					
					ДатаНачДоговора = ?(Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ПервичныйДог.ДатаНачала,ДатаТравмыНаПроизв),ПервичныйДог.ДатаНачала);
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
						//защита от зацикливания
						ПервичныйДог = Неопределено;
					Иначе	
						ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					КонецЕсли; 					   
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				КонецЦикла;
				
			КонецЦикла;
			
			ЗапросДоговор.Текст = 
			//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
			//"ВЫБРАТЬ
			//- СВЭЙ КДЯ 01.10.19 СВФР-004756
			//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			//- СВЭЙ КДЯ 01.10.19 СВФР-004756
			|	ДоговорНаВыполнениеРаботСФизЛицом.ПервичныйДоговор КАК ПервичныйДоговор,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ИЗ
			|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
			//|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
			//|		ПО ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка
			//|			И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета
			//|			И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
			//|			И ДополнительныеНачисленияРаботниковОрганизаций.НомерСтроки = НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.НомерСтроки
			//- СВЭЙ КДЯ 01.10.19 СВФР-004756
			|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ГДЕ
			|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)
			|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
			|	И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
			|	И ДоговорНаВыполнениеРаботСФизЛицом.Ссылка В(&Ссылка)
			|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
			//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
			|УПОРЯДОЧИТЬ ПО
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала, 
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка 
			//- СВЭЙ КДЯ 01.10.19 СВФР-004756
			|";
			
			
			//+ СВЭЙ КДЯ 01.10.19 СВФР-004756
			//ЗапросДоговор.УстановитьПараметр("Сотрудник", Документ.Сотрудник);
			//ЗапросДоговор.УстановитьПараметр("ДатаНачала", Документ.ДатаНачала);
			//- СВЭЙ КДЯ 01.10.19 СВФР-004756
			ЗапросДоговор.УстановитьПараметр( "Ссылка", СписокДокументов );
			
			РезультатЗапросаДоговор = ЗапросДоговор.Выполнить();
			
			ВыборкаДетальныеЗаписи = РезультатЗапросаДоговор.Выбрать();
			
			//СписокДокументов = Новый СписокЗначений;
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				ДатаТравмыНаПроизв = ДобавитьМесяц(НачалоМесяца(Документ.ДатаНачала),-2);
				
				ДатаНачДоговора = ?(Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаТравмыНаПроизв),ВыборкаДетальныеЗаписи.ДатаНачала);
				Если СписокДокументов.НайтиПоЗначению(ВыборкаДетальныеЗаписи.Ссылка) = Неопределено Тогда
					СписокДокументов.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
				КонецЕсли;
				ПервичныйДог = ВыборкаДетальныеЗаписи.ПервичныйДоговор;
				Пока ЗначениеЗаполнено(ПервичныйДог) Цикл 
					Если ПервичныйДог.Проведен Тогда 
						Если СписокДокументов.НайтиПоЗначению(ВыборкаДетальныеЗаписи.Ссылка) = Неопределено Тогда
							СписокДокументов.Добавить(ПервичныйДог);
						КонецЕсли;
					КонецЕсли;
					ДатаНачДоговора = ?(Документ.ПричинаНетрудоспособности = Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве,Макс(ПервичныйДог.ДатаНачала,ДатаТравмыНаПроизв),ПервичныйДог.ДатаНачала);
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					//ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
					
					//+ СВЭЙ КДЯ 02.12.19 СВФР-005149
					Если ПервичныйДог = ПервичныйДог.ПервичныйДоговор Тогда
						//защита от зацикливания
						ПервичныйДог = Неопределено;
					Иначе	
						ПервичныйДог = ПервичныйДог.ПервичныйДоговор; 
					КонецЕсли; 					   
					//- СВЭЙ КДЯ 02.12.19 СВФР-005149
				КонецЦикла;
				
			КонецЦикла;
			
			
			//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
			
		КонецЕсли;
		
		
		
		
		
		Если НаборРасчетСреднего.Количество()>0 Тогда 
			ТаблицаСреднего = НаборРасчетСреднего.Выгрузить();
			ТаблицаСреднего.Свернуть("ДатаДоговора,НомерДоговора,БазовыйПериодНачало,БазовыйПериодКонец","Результат");
			Для Каждого СтрТаблица из ТаблицаСреднего Цикл 
				Документ.СформироватьДвиженияПоНачислениям( ВыборкаПоШапкеДокумента, НаборДополнительныеНачисления, Ложь, СтрТаблица, , ДатаНачДоговора, СписокДокументов );
			КонецЦикла;
		иначе
			Документ.СформироватьДвиженияПоНачислениям(ВыборкаПоШапкеДокумента, НаборДополнительныеНачисления,,,,ДатаНачДоговора,СписокДокументов);
			НаборДополнительныеНачисления.Записать(Истина, Ложь);
			//Запрос = Новый Запрос;
			//Запрос.Текст = 
			//"ВЫБРАТЬ
			//|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
			//|	ДоговорНаВыполнениеРаботСФизЛицом.Дата КАК ДатаДоговора,
			//|	ДоговорНаВыполнениеРаботСФизЛицом.Номер КАК НомерДоговора,
			//|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала как БазовыйПериодНачало
			//|ИЗ
			//|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			//|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			//|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			//|ГДЕ
			//|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидоврасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда)
			//|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
			//|	И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало МЕЖДУ &ДатаНачала И &ДатаОкончания
			//|
			//|СГРУППИРОВАТЬ ПО
			//|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			//|	ДоговорНаВыполнениеРаботСФизЛицом.Дата,
			//|	ДоговорНаВыполнениеРаботСФизЛицом.Номер,
			//|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала";
			//
			//Запрос.УстановитьПараметр("Сотрудник", ВыборкаПоШапкеДокумента.Сотрудник);
			//
			//ЗапросДаты = Новый Запрос;
			//ЗапросДаты.Текст = 
			//"ВЫБРАТЬ РАЗЛИЧНЫЕ
			//|	Основной.Сотрудник КАК Сотрудник,
			//|	РАЗНОСТЬДАТ(Основной.ПериодРасчетаСреднегоЗаработкаНачало, НАЧАЛОПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, МЕСЯЦ), МЕСЯЦ) + 1 КАК ПериодРасчетаСреднегоЗаработка,
			//|	Основной.ПериодРасчетаСреднегоЗаработкаНачало КАК НачалоБП,
			//|	КОНЕЦПЕРИОДА(Основной.ПериодРасчетаСреднегоЗаработкаОкончание, ДЕНЬ) КАК КонецБП,
			//|	Основной.БазовыйПериодНачало КАК ПериодДействияНачало,
			//|	Основной.БазовыйПериодКонец КАК ПериодДействияКонец
			//|ИЗ
			//|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Основной
			//|ГДЕ
			//|	Основной.Регистратор = &парамРегистратор
			//|	И Основной.ВидРасчета.СпособРасчета В(&парамСпособыРасчета)
			//|	И НЕ Основной.Сторно
			//|	И ВЫБОР
			//|			КОГДА &ЭтоБольничный
			//|				ТОГДА Основной.Сотрудник = &Сотрудник
			//|			ИНАЧЕ ИСТИНА
			//|		КОНЕЦ
			//|
			//|УПОРЯДОЧИТЬ ПО
			//|	Сотрудник,
			//|	НачалоБП,
			//|	КонецБП";
			//СпособыРасчетаПоСреднему = Новый Массив(1);
			//СпособыРасчетаПоСреднему[0] = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС;
			//ЗапросДаты.УстановитьПараметр("парамРегистратор", ВыборкаПоШапкеДокумента.Ссылка);
			//ЗапросДаты.УстановитьПараметр("парамСпособыРасчета", СпособыРасчетаПоСреднему);
			//ЗапросДаты.УстановитьПараметр("Сотрудник", ВыборкаПоШапкеДокумента.Сотрудник);
			//ЗапросДаты.УстановитьПараметр("ЭтоБольничный", Истина);
			//
			//РезультатДаты = ЗапросДаты.Выполнить().Выгрузить();
			//если РезультатДаты.Количество()> 0 Тогда 
			//	ДатаНачалаРасчетаСреднего = РезультатДаты[0].НачалоБП;
			//	ДатаОкончанияРасчетаСреднего = РезультатДаты[0].КонецБП;
			//КонецЕсли;
			//если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда 
			//	Колич = РезультатДаты.Количество();
			//	если Колич > 0 Тогда 
			//		НачалоБПМ = НачалоМесяца(РезультатДаты[0].ПериодДействияНачало);
			//		КонецБПМ = КонецМесяца(РезультатДаты[Колич-1].ПериодДействияКонец);
			//	КонецЕсли;
			//КонецЕсли;
			//если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда 
			//	ДатаНачалаРасчетаСреднего = НачалоБПМ;
			//	ДатаОкончанияРасчетаСреднего = КонецБПМ;
			//КонецЕсли;
			//Запрос.УстановитьПараметр("ДатаНачала", ДатаНачалаРасчетаСреднего);
			//Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончанияРасчетаСреднего);
			//
			//РезультатНачисление = Запрос.Выполнить().Выгрузить();
			//если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.БПМ Тогда 
			//	Для Кол = 1 по РезультатНачисление.Количество() Цикл 
			//		если НаборДополнительныеНачисления.Количество()>0 Тогда 
			//			Для СтрКол = 0 по НаборДополнительныеНачисления.Количество()-1 Цикл 
			//				НаборДополнительныеНачисления[СтрКол].НомерДоговора = РезультатНачисление[0].НомерДоговора;
			//				НаборДополнительныеНачисления[СтрКол].ДатаДоговора = РезультатНачисление[0].ДатаДоговора;
			//			КонецЦикла;
			//		КонецЕсли;
			//		Документ.СформироватьДвиженияПоНачислениям(ВыборкаПоШапкеДокумента, НаборДополнительныеНачисления,Истина,РезультатНачисление[Кол-1]);
			//	КонецЦикла;
			//иначе
			//	
			//	
			//	Для Кол = 1 по РезультатНачисление.Количество()-1 Цикл 
			//		если НаборДополнительныеНачисления.Количество()>0 Тогда 
			//			Для СтрКол = 0 по НаборДополнительныеНачисления.Количество()-1 Цикл 
			//				если Кол = 1 Тогда 
			//					НаборДополнительныеНачисления[СтрКол].НомерДоговора = РезультатНачисление[0].НомерДоговора;
			//					НаборДополнительныеНачисления[СтрКол].ДатаДоговора = РезультатНачисление[0].ДатаДоговора;
			//				КонецЕсли;
			//			КонецЦикла;
			//		КонецЕсли;
			//		Документ.СформироватьДвиженияПоНачислениям(ВыборкаПоШапкеДокумента, НаборДополнительныеНачисления,Истина,РезультатНачисление[Кол]);
			//	КонецЦикла;
			//КонецЕсли;
		КонецЕсли;
		
	иначе
		Документ.СформироватьДвиженияПоНачислениям(ВыборкаПоШапкеДокумента, НаборОсновныеНачисления);
	КонецЕсли;
	//О.Т. 23.09.2014 № 17616
	
	// Получим дополнительные записи, имеющие признак сторно, которые необходимо добавить 
	// в текущий набор для того, чтобы в результате сохранения получился максимальный 
	// фактический период действия
	ТаблицаСторноЗаписей = НаборОсновныеНачисления.ПолучитьДополнение();
	ТаблицаСторноЗаписей.Колонки.Удалить("ПериодРегистрации");
	ТаблицаСторноЗаписей.Колонки.ПериодРегистрацииСторно.Имя = "ПериодРегистрации";
	ТаблицаСторноЗаписей.Колонки.Удалить("ПериодДействияНачало");
	ТаблицаСторноЗаписей.Колонки.ПериодДействияНачалоСторно.Имя = "ПериодДействияНачало";
	ТаблицаСторноЗаписей.Колонки.Удалить("ПериодДействияКонец");
	ТаблицаСторноЗаписей.Колонки.ПериодДействияКонецСторно.Имя = "ПериодДействияКонец";
	//толик убрал сторно	
	//Если Ложь Тогда
	//енд
	Для каждого СтрокаСторно Из ТаблицаСторноЗаписей Цикл
		// Заполним записи в наборе записей регистра
		// и в табличной части
		
		// новая запись движений
		Движение = НаборОсновныеНачисления.Добавить();
		
		ЗаполнитьЗначенияСвойств(Движение,СтрокаСторно);
		
		// Свойства
		Движение.Сторно	= Истина;
		Движение.Авторасчет	= Истина;
		
	КонецЦикла;
	
	Если ТаблицаСторноЗаписей.Количество() <> 0 Тогда
		// если таблица сторно-записей не пустая, получим таблицу
		// начислений зависисяцих от тех начислений, которые зарегистрированы,
		
		ТаблицаОсновныхНачислений = ПолучитьТаблицуЗависимыхНачисленийОсновные(НаборОсновныеНачисления.Выгрузить());
		Для каждого СтрокаТаблицы Из ТаблицаОсновныхНачислений Цикл
			
			Если СтрокаТаблицы.Начислить > 0 Тогда
				// начисление зависит от сторнирующего, добавим не сторно
				Движение = НаборОсновныеНачисления.Добавить();
				ЗаполнитьЗначенияСвойств(Движение,СтрокаТаблицы);
				Движение.СторнируемыйДокумент = Неопределено;
				Движение.Сторно	= Ложь;
				Движение.Авторасчет	= Истина;
			КонецЕсли;
			
			Если СтрокаТаблицы.Сторнировать > 0 Тогда
				// начисление зависит от сторнируемого, добавим сторно
				Движение = НаборОсновныеНачисления.Добавить();
				ЗаполнитьЗначенияСвойств(Движение,СтрокаТаблицы);
				Движение.Сторно	= Истина;
				Движение.Авторасчет	= Истина;
			КонецЕсли;	
			
		КонецЦикла;
		
		ТаблицаДополнительныхНачислений = ПолучитьТаблицуЗависимыхНачисленийДополнительные(ТаблицаСторноЗаписей);
		Для каждого СтрокаТаблицы Из ТаблицаДополнительныхНачислений Цикл
			
			Движение = НаборДополнительныеНачисления.Добавить();
			ЗаполнитьЗначенияСвойств(Движение,СтрокаТаблицы);
			Движение.Сторно	= Истина;
			Движение.Авторасчет	= Истина;
			
			Движение = НаборДополнительныеНачисления.Добавить();
			ЗаполнитьЗначенияСвойств(Движение,СтрокаТаблицы);
			Движение.СторнируемыйДокумент = Неопределено;
			Движение.Сторно	= Ложь;
			Движение.Авторасчет	= Истина;	
			
		КонецЦикла;
		
	КонецЕсли;
	//толик
	//КонецЕсли;
	//енд
	// Очистим начисления
	//Островская Татьяна 12.11.2013
	
	//Аверсон ЕАЕ 09.03.2021 СВФР-007091
	//если Документ.Организация.КодАктивацииТранспорта = "" и ТипЗнч(Документ.Ссылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
	//	Документ.Начисления.Очистить();
	//КонецЕсли;
	//Аверсон СВФР-007091
	
	//Островская Татьяна 12.11.2013
	// рассчитываем записи начислений и если надо, записи расчета среднего заработка
	//Если РассчитываемыеТаблицы.Начисления Тогда
	//если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцам или ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда
	//Если РассчитываемыеТаблицы.РасчетСреднего Тогда
	//	РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , НаборРасчетСреднего, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,Истина);
	//Иначе
	//	РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение);
	//КонецЕсли;
	//КонецЕсли;
	//Островская Татьяна 28.12.2012 № 16068
	ТЗНаборРасчетаНачисления = новый ТаблицаЗначений;
	ТЗНаборРасчетаНачисления.Колонки.Добавить("БазовыйПериодНачало");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("БазовыйПериодКонец");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("ВидРасчета");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("МесяцВыборки");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("ВидУчетаВремени");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("Сотрудник");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("СпособРасчета");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("Результат");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("ОтработаноДней");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("ОтработаноЧасов");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("НормаЧасов");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("НормаДней");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("НормаДнейПоПятидневке");
	ТЗНаборРасчетаНачисления.Колонки.Добавить("ОтработаноДнейПоПятидневке");
	РезультатСумма = 0;
	если строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу" Тогда
		если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоТекМес Тогда 
			
			ПериодРасчета = ВыборкаПоШапкеДокумента.ПериодРегистрации;
			РезультНачисления = РасчитатьНачисление(ВыборкаПоШапкеДокумента,ПериодРасчета);
			РезультатСумма = 0;
			Пока РезультНачисления.Следующий() Цикл 
				РезультатСумма = РезультатСумма + РезультНачисления.Результат;
				НаборРасчетаНачисления = ТЗНаборРасчетаНачисления.Добавить();
				НаборРасчетаНачисления.Сотрудник = ВыборкаПоШапкеДокумента.Сотрудник;
				НаборРасчетаНачисления.МесяцВыборки = ПериодРасчета;
				если ВыборкаПоШапкеДокумента.СпособРасчетаВДнях Тогда 
					НаборРасчетаНачисления.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
				иначе
					НаборРасчетаНачисления.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;
				КонецЕсли;
				НаборРасчетаНачисления.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
				НаборРасчетаНачисления.СпособРасчета = ВыборкаПоШапкеДокумента.СпособРасчета;
				НаборРасчетаНачисления.Результат = РезультатСумма;
				НаборРасчетаНачисления.Сотрудник = ВыборкаПоШапкеДокумента.Сотрудник;
				НаборРасчетаНачисления.ОтработаноДней = РезультНачисления.ОтработаноДней;
				НаборРасчетаНачисления.ОтработаноЧасов = РезультНачисления.ОтработаноЧасов;
				НаборРасчетаНачисления.НормаЧасов = РезультНачисления.НормаЧасов;
				НаборРасчетаНачисления.НормаДней = РезультНачисления.НормаДней;
				НаборРасчетаНачисления.НормаДнейПоПятидневке = РезультНачисления.НормаДнейПоПятидневке;
				НаборРасчетаНачисления.ОтработаноДнейПоПятидневке = РезультНачисления.ОтработаноДнейПоПятидневке;
				НаборРасчетаНачисления.БазовыйПериодНачало = НачалоМесяца(ПериодРасчета);
				НаборРасчетаНачисления.БазовыйПериодКонец = КонецМесяца(ПериодРасчета);
			КонецЦикла;
		ИначеЕсли ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоПрошлТекМес Тогда 
			//Для сч = 0 по 1 Цикл 
			ПериодРасчета = ВыборкаПоШапкеДокумента.ПериодРегистрации;
			РезультНачисления = РасчитатьНачисление(ВыборкаПоШапкеДокумента,ПериодРасчета);
			РезультатСумма = 0;
			Пока РезультНачисления.Следующий() Цикл 
				РезультатСумма = РезультатСумма + РезультНачисления.Результат;
				
				НаборРасчетаНачисления = ТЗНаборРасчетаНачисления.Добавить();
				НаборРасчетаНачисления.Сотрудник = ВыборкаПоШапкеДокумента.Сотрудник;
				НаборРасчетаНачисления.МесяцВыборки = ПериодРасчета;
				если ВыборкаПоШапкеДокумента.СпособРасчетаВДнях Тогда 
					НаборРасчетаНачисления.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
				иначе
					НаборРасчетаНачисления.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;
				КонецЕсли;
				НаборРасчетаНачисления.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
				НаборРасчетаНачисления.СпособРасчета = ВыборкаПоШапкеДокумента.СпособРасчета;
				НаборРасчетаНачисления.Результат = РезультатСумма;
				НаборРасчетаНачисления.Сотрудник = ВыборкаПоШапкеДокумента.Сотрудник;
				НаборРасчетаНачисления.ОтработаноДней = РезультНачисления.ОтработаноДней;
				НаборРасчетаНачисления.ОтработаноЧасов = РезультНачисления.ОтработаноЧасов;
				НаборРасчетаНачисления.НормаЧасов = РезультНачисления.НормаЧасов;
				НаборРасчетаНачисления.НормаДней = РезультНачисления.НормаДней;
				НаборРасчетаНачисления.НормаДнейПоПятидневке = РезультНачисления.НормаДнейПоПятидневке;
				НаборРасчетаНачисления.ОтработаноДнейПоПятидневке = РезультНачисления.ОтработаноДнейПоПятидневке;
				НаборРасчетаНачисления.БазовыйПериодНачало = НачалоМесяца(ДобавитьМесяц(ПериодРасчета,-1));
				НаборРасчетаНачисления.БазовыйПериодКонец = КонецМесяца(ПериодРасчета);
			КонецЦикла;
			
			//КонецЦикла;
		ИначеЕсли ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда
			ПериодРасчета = ВыборкаПоШапкеДокумента.ПериодРегистрации;
			РезультНачисления = РасчитатьНачисление(ВыборкаПоШапкеДокумента,ПериодРасчета);
			РезультатСумма = 0;
			Пока РезультНачисления.Следующий() Цикл 
				РезультатСумма = РезультатСумма + РезультНачисления.Результат;
				
				НаборРасчетаНачисления = ТЗНаборРасчетаНачисления.Добавить();
				НаборРасчетаНачисления.Сотрудник = ВыборкаПоШапкеДокумента.Сотрудник;
				НаборРасчетаНачисления.МесяцВыборки = ПериодРасчета;
				если ВыборкаПоШапкеДокумента.СпособРасчетаВДнях Тогда 
					НаборРасчетаНачисления.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
				иначе
					НаборРасчетаНачисления.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;
				КонецЕсли;
				НаборРасчетаНачисления.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
				НаборРасчетаНачисления.СпособРасчета = ВыборкаПоШапкеДокумента.СпособРасчета;
				НаборРасчетаНачисления.Результат = РезультатСумма;
				НаборРасчетаНачисления.Сотрудник = ВыборкаПоШапкеДокумента.Сотрудник;
				НаборРасчетаНачисления.ОтработаноДней = РезультНачисления.ОтработаноДней;
				НаборРасчетаНачисления.ОтработаноЧасов = РезультНачисления.ОтработаноЧасов;
				НаборРасчетаНачисления.НормаЧасов = РезультНачисления.НормаЧасов;
				НаборРасчетаНачисления.НормаДней = РезультНачисления.НормаДней;
				НаборРасчетаНачисления.НормаДнейПоПятидневке = РезультНачисления.НормаДнейПоПятидневке;
				НаборРасчетаНачисления.ОтработаноДнейПоПятидневке = РезультНачисления.ОтработаноДнейПоПятидневке;
				НаборРасчетаНачисления.БазовыйПериодНачало = НачалоМесяца(ДобавитьМесяц(ПериодРасчета,-2));
				НаборРасчетаНачисления.БазовыйПериодКонец = КонецМесяца(ПериодРасчета);
			КонецЦикла;
			
			
		Иначеесли ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу Тогда 
			//О.Т. 18.02.2015 № 334
			ПериодРасчета = ВыборкаПоШапкеДокумента.ПериодРегистрации;
			
			//СВЭЙ 02.02.2024 КВВ СВФР-012133 (
			Если ЗначениеЗаполнено(Документ.ПервичныйБольничныйЛист) И ТипЗнч(Документ.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда  
				ДатаПриемаРаботника = УчетВремениСвэй.ПолучитьДатуПриемаСотрудника(Документ.Сотрудник); 
				Если ЗначениеЗаполнено(ДатаПриемаРаботника) И ДатаПриемаРаботника > НачалоМесяца(Документ.ПервичныйБольничныйЛист.ДатаНачала) Тогда
					стрДата = НачалоДня(ДатаПриемаРаботника);
				Иначе
					стрДата = НачалоМесяца(Документ.ПервичныйБольничныйЛист.ДатаНачала);  
				КонецЕсли;
			Иначе  
				//СВЭЙ 02.02.2024 КВВ СВФР-012133 )
				
				стрДата = НачалоМесяца(ВыборкаПоШапкеДокумента.ДатаНачала); 
			КонецЕсли;
			
			СтрДатаПО = ВыборкаПоШапкеДокумента.ДатаОкончания; //СВЭЙ 02.02.2024 КВВ СВФР-012133		
			
			Сч = 0;
			//О.Т. 18.02.2015 № 334
			//СВЭЙ 02.02.2024 КВВ СВФР-012133 (
			//пока стрДата <= ВыборкаПоШапкеДокумента.ДатаОкончания Цикл //О.Т. 18.02.2015 № 334
			Пока стрДата <= СтрДатаПО Цикл
				//СВЭЙ 02.02.2024 КВВ СВФР-012133 )
				
				Сч = Сч+1;
				ПериодРасчета = стрДата;
				
				РезультНачисления = РасчитатьНачисление(ВыборкаПоШапкеДокумента,ПериодРасчета,Истина);
				Пока РезультНачисления.Следующий() Цикл 
					РезультатСумма = РезультНачисления.Результат;
					//О.Т. Аверсон 25.05.2017 № 669
					Ставка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ВыборкаПоШапкеДокумента.ДатаНачала,Новый Структура("Сотрудник",ВыборкаПоШапкеДокумента.Сотрудник)).ЗанимаемыхСтавок; 
					РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(ПериодРасчета),Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
					Если Ставка <> 0 Тогда 
						РазмерСреднейЗарплаты = ОбщегоНазначения.ОкруглитьЗначение2016(?(Ставка<1,РазмерСреднейЗарплаты*Ставка,РазмерСреднейЗарплаты/Ставка),ВыборкаПоШапкеДокумента.ПериодРегистрации);
					КонецЕсли;
					//О.Т. Аверсон 25.05.2017 № 669
					Если Ставка < 1 Тогда
						РезультатСумма = РезультНачисления.ТарифнаяСтавка;   
					КонецЕсли;//если ставка 0,5 берем этот оклад
					НаборРасчетаНачисления = ТЗНаборРасчетаНачисления.Добавить();
					НаборРасчетаНачисления.Сотрудник = ВыборкаПоШапкеДокумента.Сотрудник;
					НаборРасчетаНачисления.МесяцВыборки = ПериодРасчета;
					если ВыборкаПоШапкеДокумента.СпособРасчетаВДнях Тогда 
						НаборРасчетаНачисления.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
					иначе
						НаборРасчетаНачисления.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоЧасам;
					КонецЕсли;
					НаборРасчетаНачисления.ВидРасчета = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
					НаборРасчетаНачисления.СпособРасчета = ВыборкаПоШапкеДокумента.СпособРасчета;
					
					Если ВыборкаПоШапкеДокумента.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоБеременностиИРодам Тогда //Аверсон 04.06.2020 КВВ СВФР-006084
						НаборРасчетаНачисления.Результат = Мин(РезультатСумма,РазмерСреднейЗарплаты);//О.Т. Аверсон 25.05.2017 № 669
						//О.Т. Аверсон 26.05.2017 № 669
						Если РазмерСреднейЗарплаты < РезультатСумма Тогда 
							Сообщить("Используется размер средней заработной платы " + Формат(РазмерСреднейЗарплаты,"ЧДЦ=2"));
						КонецЕсли;
						//О.Т. Аверсон 26.05.2017 № 669
						//Аверсон 04.06.2020 КВВ СВФР-006084 (
					Иначе
						НаборРасчетаНачисления.Результат = РезультатСумма;
					КонецЕсли;
					//Аверсон 04.06.2020 КВВ СВФР-006084 )
					
					НаборРасчетаНачисления.Сотрудник = ВыборкаПоШапкеДокумента.Сотрудник;
					//НаборРасчетаНачисления.ОтработаноДней = РезультНачисления.ОтработаноДней;
					//НаборРасчетаНачисления.ОтработаноЧасов = РезультНачисления.ОтработаноЧасов;
					//НаборРасчетаНачисления.НормаЧасов = РезультНачисления.НормаЧасов;
					//НаборРасчетаНачисления.НормаДней = РезультНачисления.НормаДней;
					//НаборРасчетаНачисления.НормаДнейПоПятидневке = РезультНачисления.НормаДнейПоПятидневке;
					//НаборРасчетаНачисления.ОтработаноДнейПоПятидневке = РезультНачисления.ОтработаноДнейПоПятидневке;
					НаборРасчетаНачисления.БазовыйПериодНачало = НачалоМесяца(ПериодРасчета);
					НаборРасчетаНачисления.БазовыйПериодКонец = КонецМесяца(ПериодРасчета);
				КонецЦикла;
				стрДата = ДобавитьМесяц(стрДата,1);//О.Т. 18.02.2015 № 334
			КонецЦикла;
			
			
			
		КонецЕсли;
	КонецЕсли;
	//Островская Татьяна 28.12.2012 № 16068
	//Островская Татьяна 28.12.2012 № 16068
	КомментироватьРасчет = Ложь;
	если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту")  или
		ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда")  Тогда //О.Т. 23.09.2014 № 17616
		если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу Тогда 
			ПервыйПоОкладу = Истина;
		иначе
			ПервыйПоОкладу = Ложь;
		КонецЕсли;
		
	иначе
		ПервыйПоОкладу = Ложь;
	КонецЕсли;	
	//О.Т. 23.09.2014 № 17616
	если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда 
		Если РассчитываемыеТаблицы.РасчетСреднего Тогда
			РассчитатьЗаписиРегистраРасчета("ДополнительныеНачисленияРаботниковОрганизаций", НаборДополнительныеНачисления, , НаборРасчетСреднего, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,Истина,,,,,,,,,,ПервыйПоОкладу);
		Иначе
			РассчитатьЗаписиРегистраРасчета("ДополнительныеНачисленияРаботниковОрганизаций", НаборДополнительныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,,,,,,,,,,,ПервыйПоОкладу);
		КонецЕсли;
		
	иначе
		
		Если РассчитываемыеТаблицы.РасчетСреднего Тогда
			РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , НаборРасчетСреднего, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,Истина,,,,,,,,,,ПервыйПоОкладу);
		Иначе
			РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,,,,,,,,,,,ПервыйПоОкладу);
		КонецЕсли;
	КонецЕсли;
	//О.Т. Аверсон 06.12.2017 Здесь сообщения не нужны
	ОбработкаКомментариев = глЗначениеПеременной("глОбработкаСообщений");
	ОбработкаКомментариев.УдалитьСообщения();
	//О.Т. Аверсон 06.12.2017
	
	//О.Т. 23.09.2014 № 17616
	
	если строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу" Тогда
		если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоТекМес Тогда 
			Если РассчитываемыеТаблицы.РасчетСреднего Тогда
				НаборРасчетСреднего.Очистить();
				
				для Каждого  СтрокаТЗНаборРасчетаНачисления из ТЗНаборРасчетаНачисления цикл
					СформироватьИЗаписатьДанныеРасчетаСреднего("ОсновныеНачисленияРаботниковОрганизаций", ВыборкаПоШапкеДокумента.Ссылка, НаборРасчетСреднего, КомментироватьРасчет,СтрокаТЗНаборРасчетаНачисления);
				КонецЦикла;
			КонецЕсли;
		ИначеЕсли ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоПрошлТекМес Тогда 
			ТаблЗн = НаборРасчетСреднего.Выгрузить();
			для Каждого СтрТаблЗн из ТаблЗн Цикл 
				если СтрТаблЗн.МесяцВыборки = ДобавитьМесяц(ВыборкаПоШапкеДокумента.ПериодРегистрации,-2) Тогда 
					ТаблЗн.Удалить(СтрТаблЗн);
				КонецЕсли;
				
			КонецЦикла;
			Если РассчитываемыеТаблицы.РасчетСреднего Тогда   
				НаборРасчетСреднего.Загрузить(ТаблЗн);
				
				для Каждого  СтрокаТЗНаборРасчетаНачисления из ТЗНаборРасчетаНачисления цикл
					ПрошлыйТек = Истина;
					СформироватьИЗаписатьДанныеРасчетаСреднего("ОсновныеНачисленияРаботниковОрганизаций", ВыборкаПоШапкеДокумента.Ссылка, НаборРасчетСреднего, КомментироватьРасчет,СтрокаТЗНаборРасчетаНачисления,ПрошлыйТек);
				КонецЦикла;
			КонецЕсли;
			
		ИначеЕсли ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда 
			Если РассчитываемыеТаблицы.РасчетСреднего Тогда
				//Документ.РасчетСреднего.Загрузить(НаборРасчетСреднего.Выгрузить());
				для Каждого  СтрокаТЗНаборРасчетаНачисления из ТЗНаборРасчетаНачисления цикл
					//	если  не Документ.РасчетСреднего.НайтиСтроки(Новый Структура("МесяцВыборки",СтрокаТЗНаборРасчетаНачисления.МесяцВыборки)).Количество()>0 Тогда 
					
					СформироватьИЗаписатьДанныеРасчетаСреднего("ОсновныеНачисленияРаботниковОрганизаций", ВыборкаПоШапкеДокумента.Ссылка, НаборРасчетСреднего, КомментироватьРасчет,СтрокаТЗНаборРасчетаНачисления);
				КонецЦикла; 
			КонецЕсли;
			
		Иначеесли ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу Тогда
			Если РассчитываемыеТаблицы.РасчетСреднего Тогда
				НаборРасчетСреднего.Очистить();
				для Каждого  СтрокаТЗНаборРасчетаНачисления из ТЗНаборРасчетаНачисления цикл 
					СформироватьИЗаписатьДанныеРасчетаСреднего("ОсновныеНачисленияРаботниковОрганизаций", ВыборкаПоШапкеДокумента.Ссылка, НаборРасчетСреднего, КомментироватьРасчет,СтрокаТЗНаборРасчетаНачисления);
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	//О.Т. 23.09.2014 № 17616
	если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛистуПоДоговорамПодряда") Тогда 
		//О.Т. Аверсон 06.12.2017
		//Если НаборДополнительныеНачисления.Количество()>0 и НаборРасчетСреднего.Количество()>0 Тогда 
		//	Для Каждого стр из НаборДополнительныеНачисления Цикл 
		//		Если стр.НомерДоговора = "" Тогда 
		//			стр.НомерДоговора = НаборРасчетСреднего[0].НомерДоговора;
		//			стр.ДатаДоговора = НаборРасчетСреднего[0].ДатаДоговора;
		//		КонецЕсли;
		//	КонецЦикла;
		//	
		//КонецЕсли;
		////О.Т. Аверсон 06.12.2017                                                                          
		//
		//Если РассчитываемыеТаблицы.РасчетСреднего Тогда
		//	РассчитатьЗаписиРегистраРасчета("ДополнительныеНачисленияРаботниковОрганизаций", НаборДополнительныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,Истина);
		//Иначе
		//	РассчитатьЗаписиРегистраРасчета("ДополнительныеНачисленияРаботниковОрганизаций", НаборДополнительныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение);
		//КонецЕсли;
		
	иначе
		
		Если РассчитываемыеТаблицы.РасчетСреднего Тогда
			//О.Т. 18.02.2015 № 334
			если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
				если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу Тогда
					для Каждого  СтрокаТЗНаборРасчетаНачисления из ТЗНаборРасчетаНачисления цикл //О.Т. 17.02.2015 № 334
						РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,Истина,,,,,,,,,,,СтрокаТЗНаборРасчетаНачисления.МесяцВыборки);//О.Т. 17.02.2015 № 334
					КонецЦикла;
				иначе
					РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,Истина);
				КонецЕсли;
			иначе
				РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,Истина);
			КонецЕсли;
			//О.Т. 18.02.2015 № 334
		Иначе
			//О.Т. 18.02.2015 № 334
			если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту") Тогда 
				если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу Тогда
					для Каждого  СтрокаТЗНаборРасчетаНачисления из ТЗНаборРасчетаНачисления цикл //О.Т. 17.02.2015 № 334
						РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение,,,,,,,,,,,,,СтрокаТЗНаборРасчетаНачисления.МесяцВыборки);//О.Т. 17.02.2015 № 334
					КонецЦикла;
				иначе
					//	РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение); // закомментировано Аверсон 20.05.2019 КВВ СВФР-004350
				КонецЕсли;
			иначе
				РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение);
			КонецЕсли;
			//О.Т. 18.02.2015 № 334
		КонецЕсли;
		
	КонецЕсли;
	//О.Т. 23.09.2014 № 17616
	
	
	//Островская Татьяна 28.12.2012 № 16068
	Если РассчитываемыеТаблицы.Начисления Тогда
		
		// перепишем записи начислений в документ
		ЗаписиНачислений = НаборОсновныеНачисления.Выгрузить();
		ЗаписиНачислений.Колонки.ПериодДействияНачало.Имя = "ДатаНачала";
		ЗаписиНачислений.Колонки.ПериодДействияКонец.Имя = "ДатаОкончания";
		
		//Аверсон ЕАЕ 09.03.2021 СВФР-007091
		Если Строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Оплата по среднему заработку" Тогда
			//Удаляем строки
			Для Каждого С Из ЗаписиНачислений Цикл
				СписокИндексовСтрок = Новый СписокЗначений;
				СтруктураОтбора = Новый Структура;
				СтруктураОтбора.Вставить("ДатаНачала", С.ДатаНачала);
				СтруктураОтбора.Вставить("ДатаОкончания", С.ДатаОкончания);
				НужныеСтроки = Документ.Начисления.НайтиСтроки(СтруктураОтбора);
				Если НужныеСтроки.Количество() > 0 Тогда
					Для Каждого н Из НужныеСтроки Цикл
						СписокИндексовСтрок.Добавить(н.НомерСтроки);
					КонецЦикла;
					СписокИндексовСтрок.СортироватьПоЗначению(НаправлениеСортировки.Убыв);
					
					Для Каждого н Из СписокИндексовСтрок Цикл
						Документ.Начисления.Удалить(н.Значение);	
					КонецЦикла;
				КонецЕсли;
			КонецЦикла;
			
			//Добавляем строки
			Для Каждого С Из ЗаписиНачислений Цикл
				//Аверсон 08.11.2022 КВВ СВФР-009796 (
				//Если ДатаНачалаТЧДатОплатаПоСреднему = Неопределено ИЛИ 
				//	(ДатаНачалаТЧДатОплатаПоСреднему <> Неопределено И ЗначениеЗаполнено(Документ.ПерерассчитываемыйДокумент) И ДатаНачалаТЧДатОплатаПоСреднему = С.ДатаНачала) Тогда 
				Если (НЕ ЗначениеЗаполнено(Документ.ПерерассчитываемыйДокумент))
					ИЛИ
					(ЗначениеЗаполнено(Документ.ПерерассчитываемыйДокумент) И НЕ Документ.ПерерассчитываемыйДокумент.НесколькоДней) //Аверсон 14.07.2023 КВВ СВФР-011110
					ИЛИ
					(ДатаНачалаТЧДатОплатаПоСреднему = Неопределено 
					ИЛИ 
					(ДатаНачалаТЧДатОплатаПоСреднему <> Неопределено 
					И ЗначениеЗаполнено(Документ.ПерерассчитываемыйДокумент) 
					И ДатаНачалаТЧДатОплатаПоСреднему = С.ДатаНачала)) Тогда
					//Аверсон 08.11.2022 КВВ СВФР-009796 )
					
					НовС = Документ.Начисления.Добавить();
					ЗаполнитьЗначенияСвойств(НовС, С);
				КонецЕсли;
			КонецЦикла;
		Иначе
			Документ.Начисления.Загрузить(ЗаписиНачислений);
		КонецЕсли;
		//Аверсон СВФР-007091
		
		ОкруглениеСреднегоЗаработка = ОбщегоНазначения.ПолучитьТочностьСреднегоЗаработка(); //ПСА 08.11.2021 СВФР-008334 +++
		если Строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу" Тогда 
			если ВыборкаПоШапкеДокумента.РаботалВПервыйДеньБЛ Тогда
				ДатаОкончанияПрошл =Дата(1,1,1);
				Для Каждого стрНачисления из Документ.Начисления Цикл 
					Если не ЗначениеЗаполнено(стрНачисления.СторнируемыйДокумент) Тогда //О.Т. Аверсон 15.08.2018 № 2331
						Если Не стрНачисления.Сторно Тогда //ПСА Аверсон 24.11.2020 СВФР-006864
							если не (ДатаОкончанияПрошл+86400 = стрНачисления.ДатаНачала) Тогда 
								если ЗначениеЗаполнено(стрНачисления.ОплаченоДней) Тогда 
									//ПСА 08.11.2021 СВФР-008334 +++
									//СуммаОдногоДня = ОбщегоНазначения.ОкруглитьЗначение2016(стрНачисления.Результат/стрНачисления.ОплаченоДней,ВыборкаПоШапкеДокумента.ПериодРегистрации);//О.Т. 06.10.2015 № 629 949
									СуммаОдногоДня = Окр(стрНачисления.Результат/стрНачисления.ОплаченоДней,ОкруглениеСреднегоЗаработка);
									//+++ПСА 08.11.2021 СВФР-008334
									стрНачисления.Результат = ОбщегоНазначения.ОкруглитьЗначение2016(стрНачисления.Результат,ВыборкаПоШапкеДокумента.ПериодРегистрации)-СуммаОдногоДня;//О.Т. Аверсон 15.03.2016 № 949
									стрНачисления.ОплаченоДней = стрНачисления.ОплаченоДней -1;
									стрНачисления.ОплаченоДнейЧасов = стрНачисления.ОплаченоДнейЧасов -1;
									
								КонецЕсли;
								Если стрНачисления.ДатаНачала = НачалоДня(КонецМесяца(стрНачисления.ДатаНачала)) Тогда 
									Документ.Начисления.Удалить(стрНачисления);
									Прервать;
								иначе
									стрНачисления.ДатаНачала = НачалоДня(КонецДня(стрНачисления.ДатаНачала)+1);
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					ДатаОкончанияПрошл = стрНачисления.ДатаОкончания;
				КонецЦикла;
				
			КонецЕсли;
		КонецЕсли;
		
		
		Если НаборДополнительныеНачисления.Количество() > 0 Тогда
			
			РассчитатьЗаписиРегистраРасчета("ДополнительныеНачисленияРаботниковОрганизаций", НаборДополнительныеНачисления, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение);	
			
			// перепишем записи начислений в документ
			ЗаписиНачислений = НаборДополнительныеНачисления.Выгрузить();
			ЗаписиНачислений.Колонки.БазовыйПериодНачало.Имя = "ДатаНачала";
			ЗаписиНачислений.Колонки.БазовыйПериодКонец.Имя  = "ДатаОкончания";
			
			Для каждого СтрокаТаблицы Из ЗаписиНачислений Цикл
				НоваяСтрока = Документ.Начисления.Добавить();
				ЗаполнитьЗначенияСвойств(НоваяСтрока,СтрокаТаблицы);
				если Строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу" Тогда 
					если ВыборкаПоШапкеДокумента.РаботалВПервыйДеньБЛ Тогда
						ДатаОкончанияПрошл =Дата(1,1,1);
						Для Каждого стрНачисления из Документ.Начисления Цикл 
							Если не ЗначениеЗаполнено(стрНачисления.СторнируемыйДокумент) Тогда //О.Т. Аверсон 15.08.2018 № 2331
								если не (ДатаОкончанияПрошл+86400 = стрНачисления.ДатаНачала) Тогда
									если ЗначениеЗаполнено(стрНачисления.ОплаченоДней) Тогда
										СуммаОдногоДня = ОбщегоНазначения.ОкруглитьЗначение2016(стрНачисления.Результат/стрНачисления.ОплаченоДней,ВыборкаПоШапкеДокумента.ПериодРегистрации); //О.Т. 06.10.2015 № 629,949
										стрНачисления.Результат = ОбщегоНазначения.ОкруглитьЗначение2016(стрНачисления.Результат,ВыборкаПоШапкеДокумента.ПериодРегистрации)-СуммаОдногоДня;//О.Т. Аверсон 15.03.2016 № 949
										стрНачисления.ОплаченоДней = стрНачисления.ОплаченоДней -1;
										стрНачисления.ОплаченоДнейЧасов = стрНачисления.ОплаченоДнейЧасов -1;
										
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							ДатаОкончанияПрошл = стрНачисления.ДатаОкончания;
							
						КонецЦикла;
						
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
		//ИначеЕсли РассчитываемыеТаблицы.РасчетСреднего Тогда
		//	НаборОсновныеНачисления.Записать();
		//	СформироватьИЗаписатьДанныеРасчетаСреднего("ОсновныеНачисленияРаботниковОрганизаций", Ссылка, НаборРасчетСреднего);
	КонецЕсли;
	
	Если РассчитываемыеТаблицы.РасчетСреднего Тогда
		// перепишем записи расчета среднего заработка в документ
		если Строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу" или
			Строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу по договорам подряда" Тогда //О.Т. 23.09.2014 № 17616
			если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоДвумМесяцамИТек Тогда
				для Каждого СтокаРасчетСр из НаборРасчетСреднего.Выгрузить() Цикл 
					если  не Документ.РасчетСреднего.НайтиСтроки(Новый Структура("МесяцВыборки",СтокаРасчетСр.МесяцВыборки)).Количество()>0 Тогда 
						СтрокаРасчетСреднего = Документ.РасчетСреднего.Добавить();
						ЗаполнитьЗначенияСвойств(СтрокаРасчетСреднего,СтокаРасчетСр);
					КонецЕсли;
				КонецЦикла;	
			иначе
				
				//СВЭЙ 02.02.2024 КВВ СВФР-012133 (
				Если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу 
					И Строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу"
					И ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.Ссылка.ПервичныйБольничныйЛист) Тогда 
					БылиИзменения = Ложь;
					Для Каждого СтокаРасчетСр из НаборРасчетСреднего.Выгрузить() Цикл 
						МВ = СтокаРасчетСр.МесяцВыборки;
						Если СтокаРасчетСр.МесяцВыборки < НачалоМесяца(ВыборкаПоШапкеДокумента.Ссылка.ДатаНачала) Тогда
							//МВ = ВыборкаПоШапкеДокумента.Ссылка.ДатаНачала;
							МВ = НачалоМесяца(ВыборкаПоШапкеДокумента.Ссылка.ДатаНачала);
							БылиИзменения = Истина;
						КонецЕсли;
						
						Если БылиИзменения 
							И НЕ Документ.РасчетСреднего.НайтиСтроки(Новый Структура("МесяцВыборки",МВ)).Количество()>0 Тогда 
							СтрокаРасчетСреднего = Документ.РасчетСреднего.Добавить();
							ЗаполнитьЗначенияСвойств(СтрокаРасчетСреднего,СтокаРасчетСр); 
							СтрокаРасчетСреднего.МесяцВыборки = МВ;     
							СтрокаРасчетСреднего.ОтработаноДней = День(КонецМесяца(МВ));
						КонецЕсли;
					КонецЦикла;  
					Если НЕ БылиИзменения Тогда
						Документ.РасчетСреднего.Загрузить(НаборРасчетСреднего.Выгрузить());
					КонецЕсли;
				Иначе
					//СВЭЙ 02.02.2024 КВВ СВФР-012133 )
					
					Документ.РасчетСреднего.Загрузить(НаборРасчетСреднего.Выгрузить());
				КонецЕсли;
			КонецЕсли;
		иначе
			Документ.РасчетСреднего.Загрузить(НаборРасчетСреднего.Выгрузить());
		КонецЕсли;
	КонецЕсли;
	
	Если РежимПерерасчета тогда
		// Для режима перерасчета запишем движения (набор записей расчета среднего уже записан)
		НаборОсновныеНачисления.Записать();
		Если НаборДополнительныеНачисления.Количество() > 0 Тогда
			НаборДополнительныеНачисления.Записать();
		КонецЕсли;
	Иначе	
		// Удаляем движения для режима интерактивного расчета
		НаборОсновныеНачисления.Очистить();
		НаборОсновныеНачисления.Записать();
		
		Если НаборДополнительныеНачисления.Количество() > 0 Тогда
			НаборДополнительныеНачисления.Очистить();
			НаборДополнительныеНачисления.Записать();
		КонецЕсли;
		
		НаборРасчетСреднего.Очистить();
		НаборРасчетСреднего.Записать();
	КонецЕсли;
	КомментироватьРасчет = Ложь;
	//О.Т. 06.10.2015 № 629
	//Островская Татьяна 21.01.2013 № 16068
	//если строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу" Тогда
	//	если ВыборкаПоШапкеДокумента.РаботалВПервыйДеньБЛ Тогда 
	//		ТаблицаНачисл = Документ.Начисления.Выгрузить();
	//		ДатаОкончанияПрошл =Дата(1,1,1);
	//		Результат = 0;
	//		для Каждого ТаблЗнач из ТаблицаНачисл Цикл 
	//			если не (ДатаОкончанияПрошл+86400 = ТаблЗнач.ДатаНачала) Тогда
	//				СтрокаНачисление = Документ.Начисления.Добавить();
	//				ЗаполнитьЗначенияСвойств(СтрокаНачисление,ТаблЗнач);  
	//				СтрокаНачисление.ДатаНачала = НачалоДня(НачалоДня(ТаблЗнач.ДатаНачала)-1);
	//				СтрокаНачисление.ДатаНачалаСобытия = НачалоДня(НачалоДня(ТаблЗнач.ДатаНачала)-1);
	//				СтрокаНачисление.ДатаОкончания = НачалоДня(НачалоДня(ТаблЗнач.ДатаНачала)-1);
	//				Результат = Результат + ТаблЗнач.Результат;
	//				если ЗначениеЗаполнено(стрНачисления.ОплаченоДней) Тогда
	//					СтрокаНачисление.Результат =Окр(-Результат/ВыборкаПоШапкеДокумента.ДнейОплаты,0);   
	//					СтрокаНачисление.ОплаченоДней = -1;
	//					СтрокаНачисление.ОплаченоДнейЧасов = -1;
	//				КонецЕсли;
	//			иначе
	//				Результат = Результат + ТаблЗнач.Результат;
	//				СтрокаНачисление.Результат =Окр(-Результат/ВыборкаПоШапкеДокумента.ДнейОплаты,0);//Островская Татьяна 20.03.2014
	//			КонецЕсли;
	//			ДатаОкончанияПрошл = ТаблЗнач.ДатаОкончания;
	//			
	//			
	//		КонецЦикла;
	//		
	//	КонецЕсли;	
	//КонецЕсли;
	//Островская Татьяна 21.01.2013 № 16068
	Возврат Не Отказ;
	
КонецФункции // РассчитатьНачисления()

Функция РасчитатьНачисление(ВыборкаПоШапкеДокумента,ПериодРасчета,ПоОкладу = Ложь)
	МассивСотрудники = ВыборкаПоШапкеДокумента.Сотрудник;
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	// подготовим временную таблицу с подразделениями
	ПоВсемПодразделениямОрганизации = Истина;
	ТекстЗапросаПоПодразделениям = 
	"ВЫБРАТЬ
	|	НЕОПРЕДЕЛЕНО КАК Подразделение
	|ПОМЕСТИТЬ ВТПодразделенияОтбора";
	
	Запрос.УстановитьПараметр("Сотрудники", МассивСотрудники);
	ТекстЗапросаПоСпискуРаботников = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СотрудникиОрганизаций.Ссылка КАК Сотрудник,
	|	СотрудникиОрганизаций.Физлицо
	|ПОМЕСТИТЬ ВТСписокРаботников
	|ИЗ
	|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
	|ГДЕ
	|	СотрудникиОрганизаций.Ссылка В(&Сотрудники)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	Запрос.Текст = ТекстЗапросаПоПодразделениям;
	Запрос.УстановитьПараметр("ПоВсемПодразделениям", Истина);
	Запрос.Выполнить();
	Запрос.Текст = ТекстЗапросаПоСпискуРаботников;
	запр = Запрос.Выполнить();
	
	
	СcылкаОбъекта = Документы.НачислениеЗарплатыРаботникамОрганизаций.ПустаяСсылка();
	
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("парамПериодРегистрации" , ПериодРасчета);
	Запрос.УстановитьПараметр("парамНачало" , НачалоМесяца(ПериодРасчета));
	Запрос.УстановитьПараметр("парамКонец" , КонецМесяца(ПериодРасчета));
	Запрос.УстановитьПараметр("парамОрганизация" , ВыборкаПоШапкеДокумента.Организация);
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("парамПодразделение" , Справочники.ПодразделенияОрганизаций.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамРегистратор" , СcылкаОбъекта);
	Запрос.УстановитьПараметр("парамНачалоМесяца" , НачалоМесяца(ПериодРасчета));
	Запрос.УстановитьПараметр("парамДатаВалютногоУчета" , НачалоМесяца(ПериодРасчета));
	Запрос.УстановитьПараметр("парамВалютаРегламентУчета" , Константы.ВалютаРегламентированногоУчета.Получить());
	Запрос.УстановитьПараметр("парамМассивСпособовРасчетовБезВалюты" , ПроведениеРасчетов.ПолучитьСписокСпособовРасчетаНеТребующихУказанияВалюты());
	Запрос.УстановитьПараметр("Год",Год(ПериодРасчета));
	Запрос.УстановитьПараметр("ЭтоПерерасчет", Ложь);
	
	
	СпособыРасчетаОтСтажа = Новый Массив;
	СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам);
	СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням);
	СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке);
	СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке);
	СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
	СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка);
	Запрос.УстановитьПараметр("СпособыРасчетаОтСтажа", СпособыРасчетаОтСтажа);
	
	
	
	Запрос.УстановитьПараметр("Ссылка", СcылкаОбъекта);
	
	
	
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	&парамНачало КАК Период,
	|	РаботникиОрганизации.Сотрудник КАК Сотрудник,
	|	ИСТИНА КАК Подходит,
	|	ВЫБОР
	|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
	|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения
	|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
	|	КОНЕЦ КАК ПодразделениеОрганизации,
	|	ВЫБОР
	|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
	|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения
	|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы
	|	КОНЕЦ КАК ГрафикРаботы,
	|	ВЫБОР
	|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
	|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА РаботникиОрганизации.ДолжностьЗавершения
	|		ИНАЧЕ РаботникиОрганизации.Должность
	|	КОНЕЦ КАК Должность
	|ПОМЕСТИТЬ ВТДвиженияРаботников
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
	|			&парамНачало,
	|			Сотрудник В
	|				(ВЫБРАТЬ
	|					ВТСписокРаботников.Сотрудник
	|				ИЗ
	|					ВТСписокРаботников КАК ВТСписокРаботников)) КАК РаботникиОрганизации
	|ГДЕ
	|	ВЫБОР
	|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
	|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|				ТОГДА РаботникиОрганизации.ПричинаИзмененияСостоянияЗавершения
	|			ИНАЧЕ РаботникиОрганизации.ПричинаИзмененияСостояния
	|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
	|	И ВЫБОР
	|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
	|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|				ТОГДА РаботникиОрганизации.ОбособленноеПодразделениеЗавершения
	|			ИНАЧЕ РаботникиОрганизации.ОбособленноеПодразделение
	|		КОНЕЦ = &парамОрганизация
	|	И ВЫБОР
	|			КОГДА &ПоВсемПодразделениям
	|				ТОГДА ИСТИНА
	|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
	|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|				ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
	|						(ВЫБРАТЬ
	|							Подразделения.Подразделение
	|						ИЗ
	|							ВТПодразделенияОтбора КАК Подразделения)
	|			ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
	|					(ВЫБРАТЬ
	|						Подразделения.Подразделение
	|					ИЗ
	|						ВТПодразделенияОтбора КАК Подразделения)
	|		КОНЕЦ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	РаботникиОрганизации.Период,
	|	РаботникиОрганизации.Сотрудник,
	|	ВЫБОР
	|		КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
	|				И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
	|				И (&ПоВсемПодразделениям
	|					ИЛИ РаботникиОрганизации.ПодразделениеОрганизации В
	|						(ВЫБРАТЬ
	|							Подразделения.Подразделение
	|						ИЗ
	|							ВТПодразделенияОтбора КАК Подразделения))
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ,
	|	РаботникиОрганизации.ПодразделениеОрганизации,
	|	РаботникиОрганизации.ГрафикРаботы,
	|	РаботникиОрганизации.Должность
	|ИЗ
	|	ВТСписокРаботников КАК СписокРаботников
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	|		ПО СписокРаботников.Сотрудник = РаботникиОрганизации.Сотрудник
	|ГДЕ
	|	РаботникиОрганизации.Период > &парамНачало
	|	И РаботникиОрганизации.Период <= &парамКонец
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Работники.ПериодЗавершения,
	|	Работники.Сотрудник,
	|	ВЫБОР
	|		КОГДА Работники.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
	|				И Работники.ОбособленноеПодразделениеЗавершения = &парамОрганизация
	|				И (&ПоВсемПодразделениям
	|					ИЛИ Работники.ПодразделениеОрганизацииЗавершения В
	|						(ВЫБРАТЬ
	|							Подразделения.Подразделение
	|						ИЗ
	|							ВТПодразделенияОтбора КАК Подразделения))
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ,
	|	Работники.ПодразделениеОрганизацииЗавершения,
	|	Работники.ГрафикРаботыЗавершения,
	|	Работники.ДолжностьЗавершения
	|ИЗ
	|	ВТСписокРаботников КАК СписокРаботников
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работники
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
	|			ПО (ПериодыПерекрытия.Период <= Работники.ПериодЗавершения)
	|				И (ПериодыПерекрытия.Период > Работники.Период)
	|				И (ПериодыПерекрытия.Сотрудник = Работники.Сотрудник)
	|		ПО СписокРаботников.Сотрудник = Работники.Сотрудник
	|ГДЕ
	|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|	И Работники.ПериодЗавершения > &парамНачало
	|	И Работники.ПериодЗавершения <= &парамКонец
	|	И ПериодыПерекрытия.Период ЕСТЬ NULL 
	|
	//|ОБЪЕДИНИТЬ ВСЕ
	//|
	//|ВЫБРАТЬ
	//|	&парамНачало,
	//|	ДоговорникиОрганизаций.Ссылка,
	//|	ИСТИНА,
	//|	NULL,
	//|	NULL,
	//|	NULL
	//|ИЗ
	//|	ВТСписокРаботников КАК СписокРаботников
	//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СотрудникиОрганизаций КАК ДоговорникиОрганизаций
	//|		ПО СписокРаботников.Сотрудник = ДоговорникиОрганизаций.Ссылка
	//|ГДЕ
	//|	ДоговорникиОрганизаций.ВидДоговора <> ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.ТрудовойДоговор)
	
	| 
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	Запрос.Выполнить();
	
	// таблица ВТЗначенияПоказателей
	// 
	// Поля:
	//   Сотрудник
	//   Показатель - введенный пользователем показатель
	//   Значение - значение показателя
	//   Валюта
	//
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Работники.Сотрудник КАК Сотрудник,
	|	Работники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	ЗначенияПоказателейСхемМотивации.Показатель КАК Показатель,
	|	ЗначенияПоказателейСхемМотивации.Валюта,
	|	ВЫБОР
	|		КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|				И (НЕ ЗначенияПоказателейСхемМотивации.Валюта В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)))
	|			ТОГДА ЗначенияПоказателейСхемМотивации.Значение * ЕСТЬNULL(Валюты.Курс / Валюты.Кратность, 0)
	|		ИНАЧЕ ЗначенияПоказателейСхемМотивации.Значение
	|	КОНЕЦ КАК Значение
	|ПОМЕСТИТЬ ВТЗначенияПоказателей
	|ИЗ
	|	ВТДвиженияРаботников КАК Работники
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			Ежемесячно.Подразделение КАК Подразделение,
	|			Ежемесячно.Показатель КАК Показатель,
	|			Ежемесячно.Валюта КАК Валюта,
	|			Ежемесячно.Значение КАК Значение,
	|			Ежемесячно.Сотрудник КАК Сотрудник
	|		ИЗ
	|			РегистрСведений.ЗначенияПоказателейСхемМотивации КАК Ежемесячно
	|		ГДЕ
	|			Ежемесячно.Значение ЕСТЬ НЕ NULL 
	|			И Ежемесячно.Организация = &парамОрганизация
	|			И Ежемесячно.ПериодДействия >= &парамНачало
	|			И Ежемесячно.ПериодДействия <= &парамКонец
	|		
	|		ОБЪЕДИНИТЬ
	|		
	|		ВЫБРАТЬ
	|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Подразделение,
	|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Показатель,
	|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Валюта,
	|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Значение,
	|			NULL
	|		ИЗ
	|			РегистрСведений.ПериодическиеЗначенияПоказателейСхемМотивации.СрезПоследних(&парамКонец, Организация = &парамОрганизация) КАК ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних) КАК ЗначенияПоказателейСхемМотивации
	|		ПО (ВЫБОР
	|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
	|						ИЛИ ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя ЕСТЬ NULL 
	|					ТОГДА Работники.Сотрудник = ЗначенияПоказателейСхемМотивации.Сотрудник
	|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|					ТОГДА Работники.ПодразделениеОрганизации = ЗначенияПоказателейСхемМотивации.Подразделение
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты
	|		ПО (Валюты.Период = &парамДатаВалютногоУчета)
	|			И (ЗначенияПоказателейСхемМотивации.Валюта = Валюты.Валюта)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Показатель
	|";
	
	Запрос.Выполнить();
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ОсновныеНачисленияОрганизацийПоказатели.Показатель КАК Показатель,
	|	ОсновныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
	|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки КАК НомерСтроки,
	|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка КАК Ссылка,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
	|			ТОГДА ИСТИНА
	|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
	|			ТОГДА ИСТИНА
	|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
	|			ТОГДА ИСТИНА
	|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ЭтоТарифнаяСтавка
	|ПОМЕСТИТЬ ВТНеЗапрашиваемыеПриКадровыхПеремещениях
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
	|ГДЕ
	|	((НЕ ОсновныеНачисленияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
	|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
	|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
	|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
	|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
	|	И ОсновныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ДополнительныеНачисленияОрганизацийПоказатели.Показатель,
	|	ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
	|	ДополнительныеНачисленияОрганизацийПоказатели.НомерСтроки,
	|	ДополнительныеНачисленияОрганизацийПоказатели.Ссылка,
	|	ВЫБОР
	|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
	|			ТОГДА ИСТИНА
	|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
	|			ТОГДА ИСТИНА
	|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
	|			ТОГДА ИСТИНА
	|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ
	|ИЗ
	|	ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК ДополнительныеНачисленияОрганизацийПоказатели
	|ГДЕ
	|	((НЕ ДополнительныеНачисленияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
	|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
	|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
	|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
	|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
	|	И ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	УдержанияОрганизацийПоказатели.Показатель,
	|	УдержанияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
	|	УдержанияОрганизацийПоказатели.НомерСтроки,
	|	УдержанияОрганизацийПоказатели.Ссылка,
	|	ВЫБОР
	|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
	|			ТОГДА ИСТИНА
	|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
	|			ТОГДА ИСТИНА
	|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
	|			ТОГДА ИСТИНА
	|		КОГДА УдержанияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ
	|ИЗ
	|	ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК УдержанияОрганизацийПоказатели
	|ГДЕ
	|	((НЕ УдержанияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
	|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
	|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
	|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
	|			ИЛИ УдержанияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
	|	И УдержанияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Показатель";
	Запрос.Выполнить();
	
	// таблица ВводимыеВПлановыхНачисленияхПоказатели
	//  виды расчета и показатели, значения которых находятся при этих в.р. в данных о плановых начислениях
	// 
	//	Поля:
	//		Ссылка - вид расчета
	//		Показатель
	//		НомерСтроки - номер строки показателя
	// 
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ОсновныеНачисленияОрганизаций.Ссылка КАК Ссылка,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
	|		КОГДА ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
	|	КОНЕЦ КАК Показатель,
	|	1 КАК НомерСтроки,
	|	ИСТИНА КАК ЭтоТарифнаяСтавка
	|ПОМЕСТИТЬ ВТВводимыеВПлановыхНачисленияхПоказатели
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке))
	|	И ОсновныеНачисленияОрганизаций.ЗачетОтработанногоВремени
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка,
	|	ОсновныеНачисленияОрганизацийПоказатели.Показатель,
	|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки,
	|	ИСТИНА
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
	|ГДЕ
	|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка.ЗачетОтработанногоВремени
	|	И ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
	|	И (НЕ ОсновныеНачисленияОрганизацийПоказатели.Показатель.Предопределенный)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка,
	|	ОсновныеНачисленияОрганизацийПоказатели.Показатель,
	|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки,
	|	ЛОЖЬ
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
	|ГДЕ
	|	ОсновныеНачисленияОрганизацийПоказатели.Показатель В
	|			(ВЫБРАТЬ
	|				ВТНеЗапрашиваемыеПриКадровыхПеремещениях.Показатель
	|			ИЗ
	|				ВТНеЗапрашиваемыеПриКадровыхПеремещениях)
	|	И (НЕ ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	
	Запрос.Выполнить();
	
	// РаботникиИНачисления
	//		Таблица движений работников с добавленными сведениями об их плановых начислениях
	// 
	//	Поля:
	//		Сотрудник 
	//		ВидРасчета - плановое начисление 
	//		Показатель1,...,6 - размеры показателей 
	//		СпособРасчета - способ расчета начисления 
	//		ГрафикРаботы - график сотрудника  
	//		ВидГрафика, СуммированныйУчетРабочегоВремени, ДлительностьРабочейНедели - реквизиты графика сотрудника 
	// 
	// Описание:
	//
	//	1. 
	//  2. 
	//
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Работники.Сотрудник КАК Сотрудник,
	|	Работники.Сотрудник.Наименование КАК СотрудникНаименование,
	|	Работники.Сотрудник.Физлицо КАК Физлицо,
	|	ВЫБОР
	|		КОГДА Работники.Период >= НачисленияРаботниковОрганизации.Период
	|				ИЛИ НачисленияРаботниковОрганизации.Период ЕСТЬ NULL 
	|			ТОГДА Работники.Период
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Период
	|	КОНЕЦ КАК Период,
	|	Работники.Подходит,
	|	Работники.Период КАК ПериодРаботники,
	|	НачисленияРаботниковОрганизации.Период КАК ПериодНачисления,
	|	НачисленияРаботниковОрганизации.ОсновноеНачисление,
	|	НачисленияРаботниковОрганизации.ВидРасчета,
	|	НачисленияРаботниковОрганизации.ВидРасчета.Наименование,
	|	НачисленияРаботниковОрганизации.ВидРасчета.ВидСтажа,
	|	НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда,
	|	НачисленияРаботниковОрганизации.ВидРасчета.КоэффициентСтажа,
	|	НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета КАК СпособРасчета,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
	|			ТОГДА НачисленияРаботниковОрганизации.ВидРасчета.ВидВремени
	|		ИНАЧЕ NULL
	|	КОНЕЦ КАК ВидВремени,
	|	НачисленияРаботниковОрганизации.Действие КАК Действие,
	//|	ВЫБОР
	//|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ = ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.Код2761)
	//|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код506)
	//|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ = ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.Код2720)
	//|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код501)
	//|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ = ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.Код2730)
	//|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код502)
	//|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ = ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.Код2760)
	//|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код503)
	//|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ = ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.Код2770)
	//|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код504)
	//|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ = ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.Код2790)
	//|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код507)
	//|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)
	//|	КОНЕЦ КАК КодВычета,
	|	ЕСТЬNULL(НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ.КодВычета,ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)) КАК КодВычета,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
	|				ИЛИ НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
	|					И (НачисленияРаботниковОрганизации.ТарифныйРазряд1 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
	|						И НачисленияРаботниковОрганизации.ТарифныйРазряд1 ЕСТЬ НЕ NULL )
	|			ТОГДА ТарифныеСтавки1.Размер
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
	|	КОНЕЦ КАК Показатель1,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд2 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд2 ЕСТЬ НЕ NULL 
	|			ТОГДА ТарифныеСтавки2.Размер
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель2
	|	КОНЕЦ КАК Показатель2,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд3 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд3 ЕСТЬ НЕ NULL 
	|			ТОГДА ТарифныеСтавки3.Размер
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель3
	|	КОНЕЦ КАК Показатель3,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд4 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд4 ЕСТЬ НЕ NULL 
	|			ТОГДА ТарифныеСтавки4.Размер
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель4
	|	КОНЕЦ КАК Показатель4,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд5 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд5 ЕСТЬ НЕ NULL 
	|			ТОГДА ТарифныеСтавки5.Размер
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель5
	|	КОНЕЦ КАК Показатель5,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд6 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
	|				И НачисленияРаботниковОрганизации.ТарифныйРазряд6 ЕСТЬ НЕ NULL 
	|			ТОГДА ТарифныеСтавки6.Размер
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель6
	|	КОНЕЦ КАК Показатель6,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
	|			ТОГДА ТарифныеСтавки1.Валюта
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
	|	КОНЕЦ КАК Валюта1,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
	|			ТОГДА ТарифныеСтавки2.Валюта
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта2
	|	КОНЕЦ КАК Валюта2,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
	|			ТОГДА ТарифныеСтавки3.Валюта
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта3
	|	КОНЕЦ КАК Валюта3,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
	|			ТОГДА ТарифныеСтавки4.Валюта
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта4
	|	КОНЕЦ КАК Валюта4,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
	|			ТОГДА ТарифныеСтавки5.Валюта
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта5
	|	КОНЕЦ КАК Валюта5,
	|	ВЫБОР
	|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
	|			ТОГДА ТарифныеСтавки6.Валюта
	|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта6
	|	КОНЕЦ КАК Валюта6,
	|	НачисленияРаботниковОрганизации.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|	Работники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	Работники.ГрафикРаботы КАК ГрафикРаботы,
	|	ЕСТЬNULL(Работники.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени,
	|	ЕСТЬNULL(ВЫБОР
	|			КОГДА Работники.ГрафикРаботы.СокращенноеРабочееВремя
	|					И Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
	|				ТОГДА Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели
	|			ИНАЧЕ Работники.ГрафикРаботы.ДлительностьРабочейНедели
	|		КОНЕЦ, 0) КАК ДлительностьРабочейНедели,
	|	Работники.ГрафикРаботы.ВидГрафика КАК ВидГрафика,
	|	Работники.Должность КАК Должность,
	|	НачисленияРаботниковОрганизации.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде
	
	|ПОМЕСТИТЬ ВТРаботникиИНачисления
	|ИЗ
	|	ВТДвиженияРаботников КАК Работники
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			&парамНачало КАК Период,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
	|					ТОГДА ИСТИНА
	|				ИНАЧЕ ЛОЖЬ
	|			КОНЕЦ КАК ОсновноеНачисление,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА ВЫБОР
	|							КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
	|								ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
	|							ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
	|						КОНЕЦ
	|				ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
	|			КОНЕЦ КАК ВидРасчета,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Действие
	|			КОНЕЦ КАК Действие,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Показатель1Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
	|			КОНЕЦ КАК Показатель1,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Показатель2Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель2
	|			КОНЕЦ КАК Показатель2,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Показатель3Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель3
	|			КОНЕЦ КАК Показатель3,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Показатель4Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель4
	|			КОНЕЦ КАК Показатель4,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Показатель5Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель5
	|			КОНЕЦ КАК Показатель5,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Показатель6Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель6
	|			КОНЕЦ КАК Показатель6,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Валюта1Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
	|			КОНЕЦ КАК Валюта1,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Валюта2Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта2
	|			КОНЕЦ КАК Валюта2,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Валюта3Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта3
	|			КОНЕЦ КАК Валюта3,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Валюта4Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта4
	|			КОНЕЦ КАК Валюта4,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Валюта5Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта5
	|			КОНЕЦ КАК Валюта5,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.Валюта6Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта6
	|			КОНЕЦ КАК Валюта6,
	|			НачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник,
	|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд1Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд1
	|			КОНЕЦ КАК ТарифныйРазряд1,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд2Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд2
	|			КОНЕЦ КАК ТарифныйРазряд2,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд3Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд3
	|			КОНЕЦ КАК ТарифныйРазряд3,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд4Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд4
	|			КОНЕЦ КАК ТарифныйРазряд4,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд5Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд5
	|			КОНЕЦ КАК ТарифныйРазряд5,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд6Завершения
	|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд6
	|			КОНЕЦ КАК ТарифныйРазряд6,
	|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде
	
	|		ИЗ
	|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
	|					&парамНачало,
	|					ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	//|                   ИспользуетсяВНаряде  = ЛОЖЬ
	|						И Сотрудник В
	|							(ВЫБРАТЬ
	|								Работники.Сотрудник
	|							ИЗ
	|								ВТСписокРаботников КАК Работники)) КАК НачисленияРаботниковОрганизации
	|		ГДЕ
	|			ВЫБОР
	|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
	|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|						ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
	|					ИНАЧЕ НачисленияРаботниковОрганизации.Действие
	|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
	|		
	|		ОБЪЕДИНИТЬ ВСЕ
	|		
	|		ВЫБРАТЬ
	|			НачисленияРаботниковОрганизации.Период,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
	|					ТОГДА ИСТИНА
	|				ИНАЧЕ ЛОЖЬ
	|			КОНЕЦ,
	|			НачисленияРаботниковОрганизации.ВидРасчета,
	|			НачисленияРаботниковОрганизации.Действие,
	|			НачисленияРаботниковОрганизации.Показатель1,
	|			НачисленияРаботниковОрганизации.Показатель2,
	|			НачисленияРаботниковОрганизации.Показатель3,
	|			НачисленияРаботниковОрганизации.Показатель4,
	|			НачисленияРаботниковОрганизации.Показатель5,
	|			НачисленияРаботниковОрганизации.Показатель6,
	|			НачисленияРаботниковОрганизации.Валюта1,
	|			НачисленияРаботниковОрганизации.Валюта2,
	|			НачисленияРаботниковОрганизации.Валюта3,
	|			НачисленияРаботниковОрганизации.Валюта4,
	|			НачисленияРаботниковОрганизации.Валюта5,
	|			НачисленияРаботниковОрганизации.Валюта6,
	|			НачисленияРаботниковОрганизации.Сотрудник,
	|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд1,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд2,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд3,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд4,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд5,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд6,
	|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде
	|		ИЗ
	|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
	|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
	|				ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
	|		ГДЕ
	|			НачисленияРаботниковОрганизации.Период > &парамНачало
	|			И НачисленияРаботниковОрганизации.Период <= &парамКонец
	|			И НачисленияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
	|			И НачисленияРаботниковОрганизации.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|		    И НачисленияРаботниковОрганизации.ИспользуетсяВНаряде = ЛОЖЬ
	|		ОБЪЕДИНИТЬ ВСЕ
	|		
	|		ВЫБРАТЬ
	|			НачисленияРаботниковОрганизации.ПериодЗавершения,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
	|					ТОГДА ИСТИНА
	|				ИНАЧЕ ЛОЖЬ
	|			КОНЕЦ,
	|			ВЫБОР
	|				КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
	|					ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
	|				ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
	|			КОНЕЦ,
	|			НачисленияРаботниковОрганизации.ДействиеЗавершения,
	|			НачисленияРаботниковОрганизации.Показатель1Завершения,
	|			НачисленияРаботниковОрганизации.Показатель2Завершения,
	|			НачисленияРаботниковОрганизации.Показатель3Завершения,
	|			НачисленияРаботниковОрганизации.Показатель4Завершения,
	|			НачисленияРаботниковОрганизации.Показатель5Завершения,
	|			НачисленияРаботниковОрганизации.Показатель6Завершения,
	|			НачисленияРаботниковОрганизации.Валюта1Завершения,
	|			НачисленияРаботниковОрганизации.Валюта2Завершения,
	|			НачисленияРаботниковОрганизации.Валюта3Завершения,
	|			НачисленияРаботниковОрганизации.Валюта4Завершения,
	|			НачисленияРаботниковОрганизации.Валюта5Завершения,
	|			НачисленияРаботниковОрганизации.Валюта6Завершения,
	|			НачисленияРаботниковОрганизации.Сотрудник,
	|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд1Завершения,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд2Завершения,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд3Завершения,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд4Завершения,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд5Завершения,
	|			НачисленияРаботниковОрганизации.ТарифныйРазряд6Завершения,
	|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде
	|		ИЗ
	|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
	|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
	|				ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковПроверка
	|				ПО НачисленияРаботниковОрганизации.Сотрудник = НачисленияРаботниковПроверка.Сотрудник
	|					И НачисленияРаботниковОрганизации.ВидРасчетаИзмерение = НачисленияРаботниковПроверка.ВидРасчетаИзмерение
	|					И НачисленияРаботниковОрганизации.ДокументОснование = НачисленияРаботниковПроверка.ДокументОснование
	|					И (НачисленияРаботниковПроверка.Период > НачисленияРаботниковОрганизации.Период)
	|					И (НачисленияРаботниковПроверка.Период <= НачисленияРаботниковОрганизации.ПериодЗавершения)
	|		ГДЕ
	|			НачисленияРаботниковОрганизации.ПериодЗавершения >= &парамНачало
	|			И НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамКонец
	|			И НачисленияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
	|			И НачисленияРаботниковОрганизации.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|			И НачисленияРаботниковОрганизации.ИспользуетсяВНаряде = ЛОЖЬ	
	|			И НачисленияРаботниковПроверка.Сотрудник ЕСТЬ NULL ) КАК НачисленияРаботниковОрганизации
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки1
	|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд1 = ТарифныеСтавки1.ТарифныйРазряд
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки2
	|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд2 = ТарифныеСтавки2.ТарифныйРазряд
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки3
	|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд3 = ТарифныеСтавки3.ТарифныйРазряд
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки4
	|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд4 = ТарифныеСтавки4.ТарифныйРазряд
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки5
	|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд5 = ТарифныеСтавки5.ТарифныйРазряд
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки6
	|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд6 = ТарифныеСтавки6.ТарифныйРазряд
	|		ПО (Работники.Подходит)
	|			И Работники.Сотрудник = НачисленияРаботниковОрганизации.Сотрудник
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";	
	Запрос.Выполнить();
	
	//получим все невводимые показатели
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СписокНачислений.Сотрудник КАК Сотрудник,
	|	СписокНачислений.Период,
	|	СписокНачислений.ПериодРаботники КАК ПериодРаботники,
	|	СписокНачислений.ПериодНачисления КАК ПериодНачисления,
	|	ВводимыеПоказатели.Показатель КАК Показатель,
	|	ВЫБОР
	|		КОГДА ВводимыеПоказатели.НомерСтроки = 1
	|			ТОГДА СписокНачислений.Показатель1
	|		КОГДА ВводимыеПоказатели.НомерСтроки = 2
	|			ТОГДА СписокНачислений.Показатель2
	|		КОГДА ВводимыеПоказатели.НомерСтроки = 3
	|			ТОГДА СписокНачислений.Показатель3
	|		КОГДА ВводимыеПоказатели.НомерСтроки = 4
	|			ТОГДА СписокНачислений.Показатель4
	|		КОГДА ВводимыеПоказатели.НомерСтроки = 5
	|			ТОГДА СписокНачислений.Показатель5
	|		КОГДА ВводимыеПоказатели.НомерСтроки = 6
	|			ТОГДА СписокНачислений.Показатель6
	|	КОНЕЦ КАК ЗначениеПоказателя
	|ПОМЕСТИТЬ ВТЗначенияВводимыхКадровыхПоказателей
	|ИЗ
	|	ВТРаботникиИНачисления КАК СписокНачислений
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВводимыеВПлановыхНачисленияхПоказатели КАК ВводимыеПоказатели
	|		ПО СписокНачислений.ВидРасчета = ВводимыеПоказатели.Ссылка
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Показатель
	|";
	Запрос.Выполнить();
	
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ПоказателиВидовРасчета.Ссылка КАК ВидРасчета,
	|	ВЫБОР 
	|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
	|			ТОГДА ЗначенияПоказателей1.Сотрудник
	|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
	|			ТОГДА ЗначенияПоказателей2.Сотрудник
	|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
	|			ТОГДА ЗначенияПоказателей3.Сотрудник
	|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
	|			ТОГДА ЗначенияПоказателей4.Сотрудник		
	|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
	|			ТОГДА ЗначенияПоказателей5.Сотрудник		
	|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
	|			ТОГДА ЗначенияПоказателей6.Сотрудник
	|	КОНЕЦ КАК Сотрудник,
	|	ВЫБОР 
	|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|			ТОГДА ЗначенияПоказателей1.ПодразделениеОрганизации
	|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|			ТОГДА ЗначенияПоказателей2.ПодразделениеОрганизации
	|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|			ТОГДА ЗначенияПоказателей3.ПодразделениеОрганизации
	|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|			ТОГДА ЗначенияПоказателей4.ПодразделениеОрганизации		
	|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|			ТОГДА ЗначенияПоказателей5.ПодразделениеОрганизации		
	|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|			ТОГДА ЗначенияПоказателей6.ПодразделениеОрганизации
	|	КОНЕЦ КАК ПодразделениеОрганизации,		
	|	ПоказателиВидовРасчета.Показатель1.ТипПоказателя КАК ТипПоказателя1,
	|	ПоказателиВидовРасчета.Показатель2.ТипПоказателя КАК ТипПоказателя2,
	|	ПоказателиВидовРасчета.Показатель3.ТипПоказателя КАК ТипПоказателя3,
	|	ПоказателиВидовРасчета.Показатель4.ТипПоказателя КАК ТипПоказателя4,
	|	ПоказателиВидовРасчета.Показатель5.ТипПоказателя КАК ТипПоказателя5,
	|	ПоказателиВидовРасчета.Показатель6.ТипПоказателя КАК ТипПоказателя6,
	|	ПоказателиВидовРасчета.Показатель1.ВозможностьИзменения КАК ВозможностьИзменения1,
	|	ПоказателиВидовРасчета.Показатель2.ВозможностьИзменения КАК ВозможностьИзменения2,
	|	ПоказателиВидовРасчета.Показатель3.ВозможностьИзменения КАК ВозможностьИзменения3,
	|	ПоказателиВидовРасчета.Показатель4.ВозможностьИзменения КАК ВозможностьИзменения4,
	|	ПоказателиВидовРасчета.Показатель5.ВозможностьИзменения КАК ВозможностьИзменения5,
	|	ПоказателиВидовРасчета.Показатель6.ВозможностьИзменения КАК ВозможностьИзменения6,
	|	ЗначенияПоказателей1.Значение КАК Показатель1,
	|	ЗначенияПоказателей2.Значение КАК Показатель2,
	|	ЗначенияПоказателей3.Значение КАК Показатель3,
	|	ЗначенияПоказателей4.Значение КАК Показатель4,
	|	ЗначенияПоказателей5.Значение КАК Показатель5,
	|	ЗначенияПоказателей6.Значение КАК Показатель6,
	|	ВЫБОР 
	|		КОГДА ЗначенияПоказателей1.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|			ТОГДА ЗначенияПоказателей1.Валюта
	|		КОГДА ЗначенияПоказателей2.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|			ТОГДА ЗначенияПоказателей2.Валюта
	|		КОГДА ЗначенияПоказателей3.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|			ТОГДА ЗначенияПоказателей3.Валюта
	|		КОГДА ЗначенияПоказателей4.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|			ТОГДА ЗначенияПоказателей4.Валюта		
	|		КОГДА ЗначенияПоказателей5.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|			ТОГДА ЗначенияПоказателей5.Валюта		
	|		КОГДА ЗначенияПоказателей6.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|			ТОГДА ЗначенияПоказателей6.Валюта
	|	КОНЕЦ КАК Валюта			
	|ПОМЕСТИТЬ ВТПоказатели
	|ИЗ
	|	(ВЫБРАТЬ
	|		Показатели.Ссылка КАК Ссылка,
	|		Показатели1.Показатель КАК Показатель1,
	|		Показатели2.Показатель КАК Показатель2,
	|		Показатели3.Показатель КАК Показатель3,
	|		Показатели4.Показатель КАК Показатель4,
	|		Показатели5.Показатель КАК Показатель5,
	|		Показатели6.Показатель КАК Показатель6
	|	ИЗ
	|		ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели1
	|			ПО Показатели.Ссылка = Показатели1.Ссылка
	|				И (Показатели1.НомерСтроки = 1)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели2
	|			ПО Показатели.Ссылка = Показатели2.Ссылка
	|				И (Показатели2.НомерСтроки = 2)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели3
	|			ПО Показатели.Ссылка = Показатели3.Ссылка
	|				И (Показатели3.НомерСтроки = 3)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели4
	|			ПО Показатели.Ссылка = Показатели4.Ссылка
	|				И (Показатели4.НомерСтроки = 4)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели5
	|			ПО Показатели.Ссылка = Показатели5.Ссылка
	|				И (Показатели5.НомерСтроки = 5)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели6
	|			ПО Показатели.Ссылка = Показатели6.Ссылка
	|				И (Показатели6.НомерСтроки = 6)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Показатели.Ссылка,
	|		Показатели1.Показатель,
	|		Показатели2.Показатель,
	|		Показатели3.Показатель,
	|		Показатели4.Показатель,
	|		Показатели5.Показатель,
	|		Показатели6.Показатель
	|	ИЗ
	|		ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели1
	|			ПО Показатели.Ссылка = Показатели1.Ссылка
	|				И (Показатели1.НомерСтроки = 1)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели2
	|			ПО Показатели.Ссылка = Показатели2.Ссылка
	|				И (Показатели2.НомерСтроки = 2)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели3
	|			ПО Показатели.Ссылка = Показатели3.Ссылка
	|				И (Показатели3.НомерСтроки = 3)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели4
	|			ПО Показатели.Ссылка = Показатели4.Ссылка
	|				И (Показатели4.НомерСтроки = 4)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели5
	|			ПО Показатели.Ссылка = Показатели5.Ссылка
	|				И (Показатели5.НомерСтроки = 5)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели6
	|			ПО Показатели.Ссылка = Показатели6.Ссылка
	|				И (Показатели6.НомерСтроки = 6)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Показатели.Ссылка,
	|		Показатели1.Показатель,
	|		Показатели2.Показатель,
	|		Показатели3.Показатель,
	|		Показатели4.Показатель,
	|		Показатели5.Показатель,
	|		Показатели6.Показатель
	|	ИЗ
	|		ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели1
	|			ПО Показатели.Ссылка = Показатели1.Ссылка
	|				И (Показатели1.НомерСтроки = 1)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели2
	|			ПО Показатели.Ссылка = Показатели2.Ссылка
	|				И (Показатели2.НомерСтроки = 2)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели3
	|			ПО Показатели.Ссылка = Показатели3.Ссылка
	|				И (Показатели3.НомерСтроки = 3)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели4
	|			ПО Показатели.Ссылка = Показатели4.Ссылка
	|				И (Показатели4.НомерСтроки = 4)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели5
	|			ПО Показатели.Ссылка = Показатели5.Ссылка
	|				И (Показатели5.НомерСтроки = 5)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели6
	|			ПО Показатели.Ссылка = Показатели6.Ссылка
	|				И (Показатели6.НомерСтроки = 6)) КАК ПоказателиВидовРасчета
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей1
	|		ПО ПоказателиВидовРасчета.Показатель1 = ЗначенияПоказателей1.Показатель
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей2
	|		ПО ПоказателиВидовРасчета.Показатель2 = ЗначенияПоказателей2.Показатель
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей3
	|		ПО ПоказателиВидовРасчета.Показатель3 = ЗначенияПоказателей3.Показатель
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей4
	|		ПО ПоказателиВидовРасчета.Показатель4 = ЗначенияПоказателей4.Показатель
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей5
	|		ПО ПоказателиВидовРасчета.Показатель5 = ЗначенияПоказателей5.Показатель
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей6
	|		ПО ПоказателиВидовРасчета.Показатель6 = ЗначенияПоказателей6.Показатель
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидРасчета
	|";
	Запрос.Выполнить();
	
	
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|	ОсновныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации
	|ПОМЕСТИТЬ ВТОсновныеНачисления
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ТаблицаДвиженийРаботников
	|		ПО ОсновныеНачисления.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
	|ГДЕ
	|	ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
	|	И ОсновныеНачисления.ПериодДействияКонец <= &парамКонец
	|	И ОсновныеНачисления.ПериодДействияНачало >= &парамНачало
	|	И ОсновныеНачисления.Организация = &парамГоловнаяОрганизация
	|	И (ОсновныеНачисления.ВидРасчета.ЗачетОтработанногоВремени
	|				И ОсновныеНачисления.ВидРасчета.ЗачетНормыВремени
	|			ИЛИ ОсновныеНачисления.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты))
	|	И (НЕ ОсновныеНачисления.Сторно)
	|	И ОсновныеНачисления.Регистратор <> &парамРегистратор
	|	И ОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";		
	Запрос.Выполнить();
	
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СписокРаботников.Сотрудник КАК Сотрудник,
	|	СводныеИндивидуальныеГрафики.Часов КАК ЧасовЗаМесяц
	|ИЗ
	|	ВТСписокРаботников КАК СписокРаботников
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
	|		ПО СписокРаботников.Сотрудник = СводныеИндивидуальныеГрафики.Сотрудник
	|			И (СводныеИндивидуальныеГрафики.Месяц = &парамПериодРегистрации)
	|ГДЕ
	|	СводныеИндивидуальныеГрафики.Сотрудник ЕСТЬ НЕ NULL";
	
	Запрос.Выполнить();
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СписокРаботников.Сотрудник КАК Сотрудник,
	|	СводныеИндивидуальныеГрафики.Часов КАК ЧасовЗаМесяц
	|ПОМЕСТИТЬ ВТНормаВремениПоСводнымИндивидуальнымГрафикам
	|ИЗ
	|	ВТСписокРаботников КАК СписокРаботников
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
	|		ПО СписокРаботников.Сотрудник = СводныеИндивидуальныеГрафики.Сотрудник
	|			И (СводныеИндивидуальныеГрафики.Месяц = &парамПериодРегистрации)
	|ГДЕ
	|	СводныеИндивидуальныеГрафики.Сотрудник ЕСТЬ НЕ NULL 
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	Запрос.Выполнить();
	
	// НормаВремениПоЕжедневнымИндивидуальнымГрафикам
	//		Таблица сотрудников и нормы времени в часах, введенной индивидуальными графиками
	// 
	//	Поля:
	//		Сотрудник,
	//		ЧасовЗаМесяц - суммируем все часы рабочего времени
	// 
	// Описание:
	//
	//	выбираем данные из рег-ра ГрафикиРаботыПоВидамВремени,	
	//	введенные доками ВводИндивидуальныхГрафиков, т.е. по строкам с выставленным флажком План
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СписокРаботников.Сотрудник КАК Сотрудник,
	|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
	|ИЗ
	|	ВТСписокРаботников КАК СписокРаботников
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|		ПО СписокРаботников.Сотрудник = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
	|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
	|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
	|			И (ГрафикиРаботыПоВидамВремени.План)
	|ГДЕ
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL
	|
	|СГРУППИРОВАТЬ ПО
	|	СписокРаботников.Сотрудник";
	
	Запрос.Выполнить();
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СписокРаботников.Сотрудник КАК Сотрудник,
	|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
	|ПОМЕСТИТЬ ВТНормаВремениПоЕжедневнымИндивидуальнымГрафикам
	|ИЗ
	|	ВТСписокРаботников КАК СписокРаботников
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|		ПО СписокРаботников.Сотрудник = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
	|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
	|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
	|			И (ГрафикиРаботыПоВидамВремени.План)
	|ГДЕ
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
	|
	|СГРУППИРОВАТЬ ПО
	|	СписокРаботников.Сотрудник
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	Запрос.Выполнить();
	
	// НормаВремениПоОбщимГрафикам
	//		Таблица сотрудников и нормы времени в часах по общим графикам
	// 
	//	Поля:
	//		Сотрудник,
	//		ЧасовЗаМесяц - суммируем все часы рабочего времени
	// 
	// Описание:
	//
	//	выбираем данные из рег-ра ГрафикиРаботыПоВидамВремени для общих графиков
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СписокРаботников.Сотрудник КАК Сотрудник,
	|	СписокРаботников.ГрафикРаботы,
	|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		СписокРаботников.Сотрудник КАК Сотрудник,
	|		ВЫБОР
	|			КОГДА СписокРаботников.ГрафикРаботы.СокращенноеРабочееВремя
	|					И СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
	|				ТОГДА СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени
	|			ИНАЧЕ СписокРаботников.ГрафикРаботы
	|		КОНЕЦ КАК ГрафикРаботы
	|	ИЗ
	|		ВТДвиженияРаботников КАК СписокРаботников) КАК СписокРаботников
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|		ПО СписокРаботников.ГрафикРаботы = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
	|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
	|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
	|			И (ГрафикиРаботыПоВидамВремени.План)
	|ГДЕ
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
	|
	|СГРУППИРОВАТЬ ПО
	|	СписокРаботников.Сотрудник,
	|	СписокРаботников.ГрафикРаботы";
	Запрос.Выполнить();
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СписокРаботников.Сотрудник КАК Сотрудник,
	|	СписокРаботников.ГрафикРаботы,
	|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
	|ПОМЕСТИТЬ ВТНормаВремениПоОбщимГрафикам
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		СписокРаботников.Сотрудник КАК Сотрудник,
	|		ВЫБОР
	|			КОГДА СписокРаботников.ГрафикРаботы.СокращенноеРабочееВремя
	|					И СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
	|				ТОГДА СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени
	|			ИНАЧЕ СписокРаботников.ГрафикРаботы
	|		КОНЕЦ КАК ГрафикРаботы
	|	ИЗ
	|		ВТДвиженияРаботников КАК СписокРаботников) КАК СписокРаботников
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|		ПО СписокРаботников.ГрафикРаботы = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
	|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
	|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
	|			И (ГрафикиРаботыПоВидамВремени.План)
	|ГДЕ
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
	|
	|СГРУППИРОВАТЬ ПО
	|	СписокРаботников.Сотрудник,
	|	СписокРаботников.ГрафикРаботы
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	Запрос.Выполнить();
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ДатыСтажа.Сотрудник КАК Сотрудник,
	|	ДатыСтажа.Физлицо,
	|	ДатыСтажа.ПериодРаботники,
	|	ДатыСтажа.ПериодСеверногоСтажа КАК ДатаРегистрацииСеверногоСтажа,
	|	СведенияОСтажеРаботыНаСевере.ПорядокНачисленияСеверныхНадбавок,
	|	СведенияОСтажеРаботыНаСевере.НачальныйПроцентСевернойНадбавки,
	|	СведенияОСтажеРаботыНаСевере.СеверныйСтажМесяцев,
	|	СведенияОСтажеРаботыНаСевере.СеверныйСтажДней
	|ПОМЕСТИТЬ ВТДанныеОСеверномСтаже
	|ИЗ
	|	(ВЫБРАТЬ
	|		СписокНачислений.Сотрудник КАК Сотрудник,
	|		СписокНачислений.Физлицо КАК Физлицо,
	|		СписокНачислений.ПериодРаботники КАК ПериодРаботники,
	|		МАКСИМУМ(СведенияОСтажеРаботыНаСевере.Период) КАК ПериодСеверногоСтажа
	|	ИЗ
	|		ВТРаботникиИНачисления КАК СписокНачислений
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОСтажеРаботыНаСевере КАК СведенияОСтажеРаботыНаСевере
	|			ПО СписокНачислений.Физлицо = СведенияОСтажеРаботыНаСевере.ФизЛицо
	|				И СписокНачислений.ПериодРаботники >= СведенияОСтажеРаботыНаСевере.Период
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СписокНачислений.Сотрудник,
	|		СписокНачислений.Физлицо,
	|		СписокНачислений.ПериодРаботники) КАК ДатыСтажа
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОСтажеРаботыНаСевере КАК СведенияОСтажеРаботыНаСевере
	|		ПО ДатыСтажа.Физлицо = СведенияОСтажеРаботыНаСевере.ФизЛицо
	|			И ДатыСтажа.ПериодСеверногоСтажа = СведенияОСтажеРаботыНаСевере.Период
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	Запрос.Выполнить();
	
	// РаботникиИНачисленияПоСхемамМотивации
	//		Таблица движений работников и сведениями об их плановых начислениях
	//      с добавленными значениями показателей, как введенными пользователями для расчета, так и 
	//      выбранными из строк плановых начислений, содержащих тарифные ставки по "основным" начислениям работника
	// 
	//	Поля:
	//		Сотрудник 
	//		ВидРасчета - плановое начисление 
	//		Показатель1,...,6 - размеры показателей 
	//		СпособРасчета - способ расчета начисления 
	//		ОкладТариф - размер трифной ставки, если начисление ее содержит  
	//		ГрафикРаботы - график сотрудника  
	//		ВидГрафика, СуммированныйУчетРабочегоВремени, ДлительностьРабочейНедели - реквизиты графика сотрудника 
	// 
	// Описание:
	//
	//	1. 
	//  2. 
	//
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СписокНачислений.Сотрудник КАК Сотрудник,
	|	СписокНачислений.СотрудникНаименование,
	|	СписокНачислений.Физлицо,
	|	СписокНачислений.ПодразделениеОрганизации,
	|	СписокНачислений.Подходит,
	|	СписокНачислений.Период,
	|	СписокНачислений.ПериодРаботники,
	|	СписокНачислений.ПериодНачисления,
	|	СписокНачислений.ОсновноеНачисление,
	|	СписокНачислений.ВидРасчета,
	|	СписокНачислений.ВидРасчетаНаименование,
	|	СписокНачислений.ВидРасчетаКоэффициентСтажа,
	|	СписокНачислений.ВидРасчетаВидСтажа,
	|	СписокНачислений.ВидРасчетаТребуетВводаТарифногоРазряда,
	|	СписокНачислений.СпособРасчета,
	|	СписокНачислений.ВидВремени,
	|	СписокНачислений.Действие,
	|	СписокНачислений.КодВычета,
	|	СписокНачислений.ДатаНачалаСобытия,
	|	СписокНачислений.ГрафикРаботы,
	|	СписокНачислений.СуммированныйУчетРабочегоВремени,
	|	СписокНачислений.ДлительностьРабочейНедели,
	|	СписокНачислений.ВидГрафика,
	|	СписокНачислений.Валюта1 КАК Валюта,
	|	СписокНачислений.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,		
	|	ВЫБОР
	|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|			ТОГДА 1
	|		ИНАЧЕ Валюты1.Курс
	|	КОНЕЦ КАК КурсВалюты,
	|	ВЫБОР
	|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
	|				И ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ NULL 
	|			ТОГДА 0
	|		КОГДА ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ НЕ NULL 
	|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
	|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
	|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель1
	|		КОГДА (СписокНачислений.Показатель1 = 0
	|				ИЛИ СписокНачислений.Показатель1 ЕСТЬ NULL )
	|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1)
	|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
	|			ТОГДА 0
	|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|			ТОГДА СписокНачислений.Показатель1
	|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|			ТОГДА СписокНачислений.Показатель1
	|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
	|	КОНЕЦ КАК Показатель1,
	|	ВЫБОР
	|		КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
	|				И ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 2)
	|			ТОГДА 0
	|		КОГДА ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
	|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
	|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
	|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель2
	|		КОГДА (СписокНачислений.Показатель2 = 0
	|				ИЛИ СписокНачислений.Показатель2 ЕСТЬ NULL )
	|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2)
	|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|		КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
	|			ТОГДА 0
	|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|			ТОГДА СписокНачислений.Показатель2
	|		КОГДА СписокНачислений.Валюта2 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|			ТОГДА СписокНачислений.Показатель2
	|		ИНАЧЕ СписокНачислений.Показатель2 * ЕСТЬNULL(Валюты2.Курс / Валюты2.Кратность, 0)
	|	КОНЕЦ КАК Показатель2,
	|	ВЫБОР
	|		КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
	|				И ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 3)
	|			ТОГДА 0
	|		КОГДА ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
	|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))				
	|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
	|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель3
	|		КОГДА СписокНачислений.Показатель3 = 0
	|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3)
	|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|		КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
	|			ТОГДА 0
	|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|			ТОГДА СписокНачислений.Показатель3
	|		КОГДА СписокНачислений.Валюта3 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|			ТОГДА СписокНачислений.Показатель3
	|		ИНАЧЕ СписокНачислений.Показатель3 * ЕСТЬNULL(Валюты3.Курс / Валюты3.Кратность, 0)
	|	КОНЕЦ КАК Показатель3,
	|	ВЫБОР
	|		КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
	|				И ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 4)
	|			ТОГДА 0
	|		КОГДА ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
	|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))		
	|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
	|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель4
	|		КОГДА СписокНачислений.Показатель4 = 0
	|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4)
	|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|		КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
	|			ТОГДА 0
	|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|			ТОГДА СписокНачислений.Показатель4
	|		КОГДА СписокНачислений.Валюта4 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|			ТОГДА СписокНачислений.Показатель4
	|		ИНАЧЕ СписокНачислений.Показатель4 * ЕСТЬNULL(Валюты4.Курс / Валюты4.Кратность, 0)
	|	КОНЕЦ КАК Показатель4,
	|	ВЫБОР
	|		КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
	|				И ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 5)
	|			ТОГДА 0
	|		КОГДА ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
	|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
	|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
	|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель5
	|		КОГДА СписокНачислений.Показатель5 = 0
	|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5)
	|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|		КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
	|			ТОГДА 0
	|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|			ТОГДА СписокНачислений.Показатель5
	|		КОГДА СписокНачислений.Валюта5 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|			ТОГДА СписокНачислений.Показатель5
	|		ИНАЧЕ СписокНачислений.Показатель5 * ЕСТЬNULL(Валюты5.Курс / Валюты5.Кратность, 0)
	|	КОНЕЦ КАК Показатель5,
	|	ВЫБОР
	|		КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
	|				И ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 6)
	|			ТОГДА 0
	|		КОГДА ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
	|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
	|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
	|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
	|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель6
	|		КОГДА СписокНачислений.Показатель6 = 0
	|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
	|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
	|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
	|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6)
	|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|		КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
	|			ТОГДА 0
	|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|			ТОГДА СписокНачислений.Показатель6
	|		КОГДА СписокНачислений.Валюта6 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|			ТОГДА СписокНачислений.Показатель6
	|		ИНАЧЕ СписокНачислений.Показатель6 * ЕСТЬNULL(Валюты6.Курс / Валюты6.Кратность, 0)
	|	КОНЕЦ КАК Показатель6,
	|	ПоказательТарифнойСтавки.Показатель КАК ВидТарифнойСтавки,
	|	ВЫБОР
	|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 1
	|			ТОГДА ВЫБОР
	|					КОГДА ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ НЕ NULL 
	|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель1
	|					КОГДА СписокНачислений.Показатель1 = 0
	|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
	|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
	|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|					КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
	|						ТОГДА 0
	|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|						ТОГДА СписокНачислений.Показатель1
	|					КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|						ТОГДА СписокНачислений.Показатель1
	|					ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
	|				КОНЕЦ
	|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 2
	|			ТОГДА ВЫБОР
	|					КОГДА ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
	|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель2
	|					КОГДА СписокНачислений.Показатель2 = 0
	|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
	|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
	|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|					КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
	|						ТОГДА 0
	|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|						ТОГДА СписокНачислений.Показатель2
	|					КОГДА СписокНачислений.Валюта2 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|						ТОГДА СписокНачислений.Показатель2
	|					ИНАЧЕ СписокНачислений.Показатель2 * ЕСТЬNULL(Валюты2.Курс / Валюты2.Кратность, 0)
	|				КОНЕЦ
	|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 3
	|			ТОГДА ВЫБОР
	|					КОГДА ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
	|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель3
	|					КОГДА СписокНачислений.Показатель3 = 0
	|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
	|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
	|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|					КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
	|						ТОГДА 0
	|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|						ТОГДА СписокНачислений.Показатель3
	|					КОГДА СписокНачислений.Валюта3 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|						ТОГДА СписокНачислений.Показатель3
	|					ИНАЧЕ СписокНачислений.Показатель3 * ЕСТЬNULL(Валюты3.Курс / Валюты3.Кратность, 0)
	|				КОНЕЦ
	|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 4
	|			ТОГДА ВЫБОР
	|					КОГДА ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
	|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель4
	|					КОГДА СписокНачислений.Показатель4 = 0
	|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
	|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
	|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|					КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
	|						ТОГДА 0
	|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|						ТОГДА СписокНачислений.Показатель4
	|					КОГДА СписокНачислений.Валюта4 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|						ТОГДА СписокНачислений.Показатель4
	|					ИНАЧЕ СписокНачислений.Показатель4 * ЕСТЬNULL(Валюты4.Курс / Валюты4.Кратность, 0)
	|				КОНЕЦ
	|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 5
	|			ТОГДА ВЫБОР
	|					КОГДА ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
	|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель5
	|					КОГДА СписокНачислений.Показатель5 = 0
	|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
	|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
	|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|					КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
	|						ТОГДА 0
	|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|						ТОГДА СписокНачислений.Показатель5
	|					КОГДА СписокНачислений.Валюта5 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|						ТОГДА СписокНачислений.Показатель5
	|					ИНАЧЕ СписокНачислений.Показатель5 * ЕСТЬNULL(Валюты5.Курс / Валюты5.Кратность, 0)
	|				КОНЕЦ
	|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 6
	|			ТОГДА ВЫБОР
	|					КОГДА ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
	|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель6
	|					КОГДА СписокНачислений.Показатель6 = 0
	|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
	|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
	|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
	|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
	|					КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
	|						ТОГДА 0
	|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
	|						ТОГДА СписокНачислений.Показатель6
	|					КОГДА СписокНачислений.Валюта6 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|						ТОГДА СписокНачислений.Показатель6
	|					ИНАЧЕ СписокНачислений.Показатель6 * ЕСТЬNULL(Валюты6.Курс / Валюты6.Кратность, 0)
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ОкладТариф
	|ПОМЕСТИТЬ ВТРаботникиИНачисленияПоСхемамМотивации
	|ИЗ
	|	ВТРаботникиИНачисления КАК СписокНачислений
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказатели КАК ПоказателиВведенныеПриРасчете
	|		ПО СписокНачислений.ВидРасчета = ПоказателиВведенныеПриРасчете.ВидРасчета
	|			И (СписокНачислений.Сотрудник = ПоказателиВведенныеПриРасчете.Сотрудник
	|				ИЛИ СписокНачислений.ПодразделениеОрганизации = ПоказателиВведенныеПриРасчете.ПодразделениеОрганизации
	|				)
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
	|			НеВводимыеПоказатели.Ссылка КАК Ссылка,
	|			НеВводимыеПоказатели.НомерСтроки КАК НомерСтроки,
	|			НеВводимыеПоказатели.Показатель КАК Показатель,
	|			НеВводимыеПоказатели.ПоказательВозможностьИзменения КАК ПоказательВозможностьИзменения,
	|			НеВводимыеПоказатели.ЭтоТарифнаяСтавка КАК ЭтоТарифнаяСтавка,
	|			СУММА(ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя) КАК ЗначениеПоказателя,
	|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник КАК Сотрудник,
	|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период,
	|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники КАК ПериодРаботники
	|		ИЗ
	|			ВТНеЗапрашиваемыеПриКадровыхПеремещениях КАК НеВводимыеПоказатели
	|				ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
	|				ПО НеВводимыеПоказатели.Показатель = ЗначенияВводимыхКадровыхПоказателей.Показатель
	|		ГДЕ
	|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
	|		
	|		СГРУППИРОВАТЬ ПО
	|			НеВводимыеПоказатели.Ссылка,
	|			НеВводимыеПоказатели.НомерСтроки,
	|			НеВводимыеПоказатели.Показатель,
	|			НеВводимыеПоказатели.ПоказательВозможностьИзменения,
	|			НеВводимыеПоказатели.ЭтоТарифнаяСтавка,
	|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник,
	|			ЗначенияВводимыхКадровыхПоказателей.Период,
	|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники) КАК ЗначенияВводимыхКадровыхПоказателей
	|		ПО СписокНачислений.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
	|			И (КОНЕЦПЕРИОДА(СписокНачислений.Период, МЕСЯЦ) = КОНЕЦПЕРИОДА(ЗначенияВводимыхКадровыхПоказателей.Период, МЕСЯЦ))
	|			И СписокНачислений.ПериодРаботники = ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники
	|			И СписокНачислений.ВидРасчета = ЗначенияВводимыхКадровыхПоказателей.Ссылка
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты1
	|		ПО (Валюты1.Период = &парамДатаВалютногоУчета)
	|			И СписокНачислений.Валюта1 = Валюты1.Валюта
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты2
	|		ПО (Валюты2.Период = &парамДатаВалютногоУчета)
	|			И СписокНачислений.Валюта2 = Валюты2.Валюта
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты3
	|		ПО (Валюты3.Период = &парамДатаВалютногоУчета)
	|			И СписокНачислений.Валюта3 = Валюты3.Валюта
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты4
	|		ПО (Валюты4.Период = &парамДатаВалютногоУчета)
	|			И СписокНачислений.Валюта4 = Валюты4.Валюта
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты5
	|		ПО (Валюты5.Период = &парамДатаВалютногоУчета)
	|			И СписокНачислений.Валюта5 = Валюты5.Валюта
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты6
	|		ПО (Валюты6.Период = &парамДатаВалютногоУчета)
	|			И СписокНачислений.Валюта6 = Валюты6.Валюта
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТВводимыеВПлановыхНачисленияхПоказатели КАК ПоказательТарифнойСтавки
	|		ПО СписокНачислений.ВидРасчета = ПоказательТарифнойСтавки.Ссылка
	|			И (ПоказательТарифнойСтавки.Показатель В (ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная), ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая), ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)))
	|ГДЕ
	|	ВЫБОР
	|			КОГДА СписокНачислений.Подходит
	|				ТОГДА (НЕ СписокНачислений.ВидРасчета ЕСТЬ NULL )
	|			ИНАЧЕ ИСТИНА
	|		КОНЕЦ
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	Запрос.Выполнить();
	
	//Основной текст запроса
	ОсновнойТекстЗапроса = 
	"ВЫБРАТЬ
	|	СписокНачислений.Сотрудник КАК Сотрудник,
	|	СписокНачислений.СотрудникНаименование КАК СотрудникНаименование,
	|	СписокНачислений.Физлицо КАК Физлицо,
	|	СписокНачислений.ПодразделениеОрганизации,
	|	СписокНачислений.Подходит,
	|	СписокНачислений.Период,
	|	СписокНачислений.ПериодРаботники КАК ПериодРаботники,
	|	СписокНачислений.ПериодНачисления КАК ПериодНачисления,
	|	СписокНачислений.ОсновноеНачисление КАК ОсновноеНачисление,
	|	СписокНачислений.ВидРасчета КАК ВидРасчета,
	|	СписокНачислений.ВидРасчетаНаименование,
	|	ЕСТЬNULL(СписокНачислений.ВидРасчетаТребуетВводаТарифногоРазряда, ЛОЖЬ) КАК ТребуетВводаТарифногоРазряда,
	|	СписокНачислений.СпособРасчета,
	|	СписокНачислений.ВидВремени,
	|	СписокНачислений.Действие,
	|	СписокНачислений.КодВычета,
	|	СписокНачислений.ДатаНачалаСобытия,
	|	СписокНачислений.ГрафикРаботы,
	|	СписокНачислений.СуммированныйУчетРабочегоВремени,
	|	СписокНачислений.Валюта,
	|	СписокНачислений.КурсВалюты,
	|	СписокНачислений.ВидТарифнойСтавки,
	|	СписокНачислений.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
	|	ВЫБОР
	|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
	|			ТОГДА СписокНачислений.ОкладТариф
	|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
	|			ТОГДА ВЫРАЗИТЬ(ВЫБОР
	|						КОГДА ЕСТЬNULL(ВариантыВстроенныхАлгоритмовРасчетаЗарплаты.ПорядокПересчетаМесячнойСтавкиВЧасовую, ЗНАЧЕНИЕ(Перечисление.ПорядкиПересчетаМесячнойСтавкиВЧасовую.ПоСреднемуКоличествуЧасовВМесяце)) = ЗНАЧЕНИЕ(Перечисление.ПорядкиПересчетаМесячнойСтавкиВЧасовую.ПоСреднемуКоличествуЧасовВМесяце)
	|							ТОГДА ВЫБОР
	|									КОГДА ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоРабочихДней, 0) = 0
	|										ТОГДА 0
	|									КОГДА СписокНачислений.ДлительностьРабочейНедели = 0
	|										ТОГДА 0
	|									ИНАЧЕ СписокНачислений.ОкладТариф / (СписокНачислений.ДлительностьРабочейНедели / 5 * (ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоРабочихДней, 0) + ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоПредпраздничныхДней, 0)) - ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоПредпраздничныхДней, 0)) * 12
	|								КОНЕЦ
	|						КОГДА ВЫБОР
	|								КОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
	|									ТОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц
	|								КОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
	|									ТОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц
	|								ИНАЧЕ ЕСТЬNULL(НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц, 0)
	|							КОНЕЦ = 0
	|							ТОГДА 0
	|						ИНАЧЕ СписокНачислений.ОкладТариф / ВЫБОР
	|								КОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
	|									ТОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц
	|								КОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
	|									ТОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц
	|								ИНАЧЕ ЕСТЬNULL(НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц, 0)
	|							КОНЕЦ
	|					КОНЕЦ КАК ЧИСЛО(15, 3))
	|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
	|			ТОГДА ВЫРАЗИТЬ(ВЫБОР
	|						КОГДА СписокНачислений.ДлительностьРабочейНедели = 0
	|							ТОГДА 0
	|						ИНАЧЕ СписокНачислений.ОкладТариф / СписокНачислений.ДлительностьРабочейНедели * ВЫБОР
	|								КОГДА СписокНачислений.ВидГрафика = ЗНАЧЕНИЕ(Перечисление.ВидыРабочихГрафиков.Шестидневка)
	|									ТОГДА 6
	|								ИНАЧЕ 5
	|							КОНЕЦ
	|					КОНЕЦ КАК ЧИСЛО(15, 3))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ЧасоваяТарифнаяСтавка,
	|	СписокНачислений.Показатель1,
	|	СписокНачислений.Показатель2,
	|	СписокНачислений.Показатель3,
	|	СписокНачислений.Показатель4,
	|	СписокНачислений.Показатель5,
	|	СписокНачислений.Показатель6,
	|	СведенияОСтажеРаботыНаСевере.ДатаРегистрацииСеверногоСтажа,
	|	СведенияОСтажеРаботыНаСевере.ПорядокНачисленияСеверныхНадбавок,
	|	СведенияОСтажеРаботыНаСевере.НачальныйПроцентСевернойНадбавки,
	|	СведенияОСтажеРаботыНаСевере.СеверныйСтажМесяцев,
	|	СведенияОСтажеРаботыНаСевере.СеверныйСтажДней,
	|	ШкалаКоэффициентовСтажа.Величина КАК КоэффициентСтажа,
	|	ШкалаСледКоэффициентовСтажа.Величина КАК СледКоэффициентСтажа,
	|	ВЫБОР
	|		КОГДА НЕ ШкалаСледКоэффициентовСтажа.Величина ЕСТЬ NULL 
	|			ТОГДА ВЫБОР
	|					КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > Стажи.РазмерДней
	|						ТОГДА ДЕНЬ(Стажи.ДатаОтсчета) - Стажи.РазмерДней
	|					ИНАЧЕ ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, -1)) - (Стажи.РазмерДней - ДЕНЬ(Стажи.ДатаОтсчета))
	|				КОНЕЦ
	|	КОНЕЦ КАК ДеньСменыКоэффициентаСтажа,
	|	ВЫБОР
	|		КОГДА &ЭтоПерерасчет
	|			ТОГДА ЛОЖЬ
	|		КОГДА ОсновныеНачисления.Сотрудник ЕСТЬ NULL 
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК УжеПроведен,
	|	НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник КАК Сотрудник1,
	|	НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц,
	|	НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник КАК Сотрудник2,
	|	НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц КАК ЧасовЗаМесяц1,
	|	НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц КАК ЧасовЗаМесяц2
	|ИЗ
	|	ВТРаботникиИНачисленияПоСхемамМотивации КАК СписокНачислений
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОСеверномСтаже КАК СведенияОСтажеРаботыНаСевере
	|		ПО СписокНачислений.Сотрудник = СведенияОСтажеРаботыНаСевере.Сотрудник
	|			И СписокНачислений.ПериодРаботники = СведенияОСтажеРаботыНаСевере.ПериодРаботники
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ФизическиеЛица.Стажи КАК Стажи
	|		ПО СписокНачислений.ВидРасчетаВидСтажа = Стажи.ВидСтажа
	|			И СписокНачислений.Физлицо = Стажи.Ссылка
	|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаКоэффициентовСтажа
	|		ПО СписокНачислений.ВидРасчетаКоэффициентСтажа = ШкалаКоэффициентовСтажа.КоэффициентСтажа
	|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
	|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
	|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
	|					ТОГДА 1
	|				ИНАЧЕ 0
	|			КОНЕЦ >= ШкалаКоэффициентовСтажа.СтажС * &Месяцы)
	|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
	|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
	|					ТОГДА 1
	|				ИНАЧЕ 0
	|			КОНЕЦ < ВЫБОР
	|				КОГДА ШкалаКоэффициентовСтажа.СтажПо = 0
	|					ТОГДА 999999
	|				ИНАЧЕ ШкалаКоэффициентовСтажа.СтажПо * &Месяцы
	|			КОНЕЦ)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаСледКоэффициентовСтажа
	|		ПО СписокНачислений.ВидРасчетаКоэффициентСтажа = ШкалаСледКоэффициентовСтажа.КоэффициентСтажа
	|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
	|			И (ШкалаСледКоэффициентовСтажа.НомерСтрокиШкалы = ШкалаКоэффициентовСтажа.НомерСтрокиШкалы + 1)
	|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
	|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) >= ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
	|					ТОГДА 1
	|				ИНАЧЕ 0
	|			КОНЕЦ = ШкалаКоэффициентовСтажа.СтажПо * &Месяцы - 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			СУММА(ВЫБОР
	|					КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Рабочий)
	|						ТОГДА 1
	|					ИНАЧЕ 0
	|				КОНЕЦ) КАК ЧислоРабочихДней,
	|			СУММА(ВЫБОР
	|					КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Предпраздничный)
	|						ТОГДА 1
	|					ИНАЧЕ 0
	|				КОНЕЦ) КАК ЧислоПредпраздничныхДней
	|		ИЗ
	|			РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
	|		ГДЕ
	|			РегламентированныйПроизводственныйКалендарь.Год = &Год) КАК ДанныеПроизводственногоКалендаря
	|		ПО (ИСТИНА)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоСводнымИндивидуальнымГрафикам КАК НормаВремениПоСводнымИндивидуальнымГрафикам
	|		ПО СписокНачислений.Сотрудник = НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоЕжедневнымИндивидуальнымГрафикам КАК НормаВремениПоЕжедневнымИндивидуальнымГрафикам
	|		ПО СписокНачислений.Сотрудник = НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоОбщимГрафикам КАК НормаВремениПоОбщимГрафикам
	|		ПО СписокНачислений.Сотрудник = НормаВремениПоОбщимГрафикам.Сотрудник
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ВариантыВстроенныхАлгоритмовРасчетаЗарплаты КАК ВариантыВстроенныхАлгоритмовРасчетаЗарплаты
	|		ПО (ИСТИНА)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОсновныеНачисления КАК ОсновныеНачисления
	|		ПО СписокНачислений.Сотрудник = ОсновныеНачисления.Сотрудник
	|			И СписокНачислений.ПодразделениеОрганизации = ОсновныеНачисления.ПодразделениеОрганизации
	|
	|УПОРЯДОЧИТЬ ПО
	|	СотрудникНаименование,
	|	Сотрудник,
	|	ПериодРаботники,
	|	ПериодНачисления,
	|	ОсновноеНачисление УБЫВ,
	|	ВидРасчета";
	Запрос.УстановитьПараметр("Месяцы",?(ВыборкаПоШапкеДокумента.Организация.ИНН = "100765738",12,1));
	
	Запрос.Текст = ОсновнойТекстЗапроса;
	РезультатЗапроса = Запрос.Выполнить().Выбрать();
	ВыборкаКатегорий = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	РезультатСумма = 0;	
	СписокВидовРасчета = новый СписокЗначений;
	если Строка(ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка)) = "Начисление по больничному листу" Тогда
		если ВыборкаПоШапкеДокумента.ТипРасчета = Перечисления.ТипРасчетаБЛ.ПоОкладу Тогда 
			Пока ВыборкаКатегорий.Следующий() Цикл
				если ВыборкаКатегорий.ЧасоваяТарифнаяСтавка > 0 Тогда 
					СписокВидовРасчета.Добавить(ВыборкаКатегорий.ВидРасчета);
				КонецЕсли;
			КонецЦикла;
		иначе
			Пока ВыборкаКатегорий.Следующий() Цикл
				СписокВидовРасчета.Добавить(ВыборкаКатегорий.ВидРасчета);
			КонецЦикла;
		КонецЕсли;
	иначе
		Пока ВыборкаКатегорий.Следующий() Цикл
			СписокВидовРасчета.Добавить(ВыборкаКатегорий.ВидРасчета);
		КонецЦикла;
	КонецЕсли;
	СписокВидовРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("По окладу"));
	
	ЗапросНачисления = Новый Запрос;
	если ПоОкладу Тогда 
		//О.Т. Аверсон 02.02.2016 № 844
		//О.Т. Аверсон 01.03.2017 № 347
		ФлагРасчетБЛОтСтавки1Разряда = Ложь;
		РасчетБЛОтСтавки1РазрядаИКоэффициентов = Ложь; //О.Т. Аверсон 03.11.2017 № 1203
		ФлагВалютныеОклады = Ложь;
		ЗапросУчетная = Новый Запрос;
		ЗапросУчетная.Текст = 
		"ВЫБРАТЬ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.РасчетБЛОтСтавки1Разряда,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.ВалютныеОклады,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.РасчетБЛОтСтавки1РазрядаИКоэффициентов
		|ИЗ
		|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
		|ГДЕ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
		
		ЗапросУчетная.УстановитьПараметр("Организация", ВыборкаПоШапкеДокумента.Организация);
		
		РезультатЗапросаУчетная = ЗапросУчетная.Выполнить().Выбрать();		
		Пока РезультатЗапросаУчетная.Следующий() Цикл
			ФлагРасчетБЛОтСтавки1Разряда = РезультатЗапросаУчетная.РасчетБЛОтСтавки1Разряда;
			ФлагВалютныеОклады = РезультатЗапросаУчетная.ВалютныеОклады;
			РасчетБЛОтСтавки1РазрядаИКоэффициентов = РезультатЗапросаУчетная.РасчетБЛОтСтавки1РазрядаИКоэффициентов;
		КонецЦикла;
		//О.Т. Аверсон 01.03.2017 № 347
		Если не ФлагРасчетБЛОтСтавки1Разряда и не РасчетБЛОтСтавки1РазрядаИКоэффициентов Тогда  
			
			Если ФлагВалютныеОклады Тогда //О.Т. Аверсон 01.03.2017 № 347
				ЗапросНачисления.УстановитьПараметр("Курс",ВыборкаПоШапкеДокумента.Ссылка.Курс);
				ЗапросНачисления.Текст =
				"ВЫБРАТЬ
				|	СУММА(ЕСТЬNULL(ВЫБОР
				|				КОГДА ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.СуммаВВалюте = 0
				|					ТОГДА ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка
				|				ИНАЧЕ ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.СуммаВВалюте * &Курс
				|			КОНЕЦ, 0)) КАК Результат,
				|	ВЫБОР
				|		КОГДА ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.СуммаВВалюте = 0
				|			ТОГДА ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка
				|		ИНАЧЕ ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.СуммаВВалюте * &Курс
				|	КОНЕЦ КАК ТарифнаяСтавка,
				|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник
				|ИЗ
				|	РегистрСведений.ТарифныеСтавкиРаботниковОрганизации.СрезПоследних(
				|			&ПериодРегистрации1,
				|			Сотрудник = &Сотрудник
				|				) КАК ТарифныеСтавкиРаботниковОрганизацииСрезПоследних
				|
				|СГРУППИРОВАТЬ ПО
				|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник,
				|	ВЫБОР
				|		КОГДА ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.СуммаВВалюте = 0
				|			ТОГДА ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка
				|		ИНАЧЕ ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.СуммаВВалюте * &Курс
				|	КОНЕЦ";
			иначе
				ЗапросНачисления.Текст =
				"ВЫБРАТЬ
				|	СУММА(ЕСТЬNULL(ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка, 0)) КАК Результат,
				|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка,
				|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник
				|ИЗ
				|	РегистрСведений.ТарифныеСтавкиРаботниковОрганизации.СрезПоследних(
				
				//СВЭЙ 05.02.2024 КВВ СВФР-012133 (
				//|			&ПериодРегистрации1,
				|			&ПериодРегистрации1_ТС,
				//СВЭЙ 05.02.2024 КВВ СВФР-012133 )
				
				|			Сотрудник = &Сотрудник
				|				) КАК ТарифныеСтавкиРаботниковОрганизацииСрезПоследних
				|
				|СГРУППИРОВАТЬ ПО
				|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка,
				|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник";
			КонецЕсли;
			
		ИначеЕсли ФлагРасчетБЛОтСтавки1Разряда Тогда 
			ЗапросНачисления.Текст = 
			"ВЫБРАТЬ
			|	СУММА(ЕСТЬNULL(ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер * РаботникиОрганизацийСрезПоследних.КоэффициентЕТС, 0)) КАК Результат,
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка,
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник,
			|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер,
			|	РаботникиОрганизацийСрезПоследних.КоэффициентЕТС
			|ИЗ
			|	РегистрСведений.ТарифныеСтавкиРаботниковОрганизации.СрезПоследних(&ПериодРегистрации1, ) КАК ТарифныеСтавкиРаботниковОрганизацииСрезПоследних
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ПериодРегистрации1, ) КАК РаботникиОрганизацийСрезПоследних
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.СрезПоследних(&ПериодРегистрации1, ) КАК ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних
			|			ПО РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда = ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.ТарифнаяСтавка
			|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Организация
			|		ПО ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
			|			И ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Организация = РаботникиОрганизацийСрезПоследних.Организация
			|ГДЕ
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник = &Сотрудник
			|
			|СГРУППИРОВАТЬ ПО
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка,
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник,
			|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер,
			|	РаботникиОрганизацийСрезПоследних.КоэффициентЕТС";
		иначе
			ЗапросНачисления.Текст = 
			"ВЫБРАТЬ
			|	СУММА(ЕСТЬNULL(ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер * РаботникиОрганизацийСрезПоследних.КоэффициентЕТС * РаботникиОрганизацийСрезПоследних.ПовышенныйКоэффициентЕТС, 0)) КАК Результат,
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка,
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник,
			|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер,
			|	РаботникиОрганизацийСрезПоследних.КоэффициентЕТС
			|ИЗ
			|	РегистрСведений.ТарифныеСтавкиРаботниковОрганизации.СрезПоследних(&ПериодРегистрации1, ) КАК ТарифныеСтавкиРаботниковОрганизацииСрезПоследних
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ПериодРегистрации1, ) КАК РаботникиОрганизацийСрезПоследних
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.СрезПоследних(&ПериодРегистрации1, ) КАК ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних
			|			ПО РаботникиОрганизацийСрезПоследних.ТарифнаяСтавкаПервогоРазряда = ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.ТарифнаяСтавка
			|			И РаботникиОрганизацийСрезПоследних.Организация = ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Организация
			|		ПО ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
			|			И ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Организация = РаботникиОрганизацийСрезПоследних.Организация
			|ГДЕ
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник = &Сотрудник
			|
			|СГРУППИРОВАТЬ ПО
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.ТарифнаяСтавка,
			|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник,
			|	ТарифныеСтавкиПервогоРазрядаОрганизацийСрезПоследних.Размер,
			|	РаботникиОрганизацийСрезПоследних.КоэффициентЕТС";
		КонецЕсли;
		//О.Т. Аверсон 02.02.2016 № 844
	иначе
		ЗапросНачисления.Текст = 
		"ВЫБРАТЬ
		|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
		|	СУММА(ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В (&ВидРасчетаСписок)
		|				ТОГДА ОсновныеНачисленияРаботниковОрганизаций.Результат / ОсновныеНачисленияРаботниковОрганизаций.ОтработаноДней * &ДниБольничный
		|			ИНАЧЕ ОсновныеНачисленияРаботниковОрганизаций.Результат
		|		КОНЕЦ) КАК Результат,
		|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноДней) КАК ОтработаноДней,
		|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноЧасов) КАК ОтработаноЧасов,
		|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
		|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.НормаДней) КАК НормаДней,
		|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.НормаЧасов) КАК НормаЧасов,
		|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.НормаДнейПоПятидневке) КАК НормаДнейПоПятидневке,
		|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноДнейПоПятидневке) КАК ОтработаноДнейПоПятидневке
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		|ГДЕ
		|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
		|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
		|
		|СГРУППИРОВАТЬ ПО
		|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
		|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник";
	КонецЕсли;
	ВидРасчетаСписок = Новый СписокЗначений;
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
	ВидРасчетаСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("По окладу"));
	ЗапросНачисления.УстановитьПараметр("ПериодРегистрации",НачалоМесяца(ПериодРасчета));
	ЗапросНачисления.УстановитьПараметр("ПериодРегистрации1",КонецМесяца(ПериодРасчета));
	ЗапросНачисления.УстановитьПараметр("ВидРасчета",СписокВидовРасчета);
	ЗапросНачисления.УстановитьПараметр("ВидРасчетаСписок",ВидРасчетаСписок);
	ЗапросНачисления.УстановитьПараметр("ДниБольничный",ВыборкаПоШапкеДокумента.ДнейОплаты);
	ЗапросНачисления.УстановитьПараметр("ПоОкладу",ПоОкладу);
	
	ЗапросНачисления.УстановитьПараметр("Сотрудник",ВыборкаПоШапкеДокумента.Сотрудник);
	
	//СВЭЙ 05.02.2024 КВВ СВФР-012133 (
	ЗапросНачисления.УстановитьПараметр("ПериодРегистрации1_ТС",КонецМесяца(ПериодРасчета));
	Если ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеПоБольничномуЛисту")
		И ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.Ссылка.ПервичныйБольничныйЛист) Тогда
		ПериодРасчета_ТС = КонецМесяца(ВыборкаПоШапкеДокумента.Ссылка.ПервичныйБольничныйЛист.ДатаНачала);  
		ЗапросНачисления.УстановитьПараметр("ПериодРегистрации1_ТС",ПериодРасчета_ТС);
	КонецЕсли;
	//СВЭЙ 05.02.2024 КВВ СВФР-012133 )	
	
	РезультНачисления = ЗапросНачисления.Выполнить().Выбрать();
	
	Возврат РезультНачисления;
КонецФункции  //РасчитатьНачисление


// Процедура получает курс валюты упр учета для целей расчетов с персоналом 
// и валюту упручета
// Параметры:
//		ДатаКурса
//		ВалютаУпрУчета - в парамтер будет передана ссылка на валюту
//		КурсВалютыУпрУчета - в параметр будет передан курс
//		ВалютаРегламентированногоУчета - валюта регламентированного учета
//
Процедура ПолучитьКурсВалютыУпрУчета(ДатаКурса, ВалютаУпрУчета, КурсВалютыУпрУчета, ВалютаРегламентированногоУчета) Экспорт
	ВалютаУпрУчета = Константы.ВалютаУправленческогоУчета.Получить();
	Если ВалютаРегламентированногоУчета = ВалютаУпрУчета Тогда
		КурсВалютыУпрУчета = 1;
	Иначе
		Отбор = Новый Структура("Валюта", ВалютаУпрУчета);
		СведенияОКурсе = РегистрыСведений.КурсыВалютДляРасчетовСПерсоналом.Получить(НачалоМесяца(ДатаКурса), Отбор);
		КурсВалютыУпрУчета = ?(СведенияОКурсе.Кратность = 0, 0 , СведенияОКурсе.Курс / СведенияОКурсе.Кратность);
	КонецЕсли;
КонецПроцедуры	

// Разбивает строку таблицы начислений на помесячные записи (длиной не более месяца)
// Параметры:
//		СтрокаНачислений - строка таблицы начислений, которую следует разбить
//		ТаблицаНачислений - таблица начислений, имеющая 2 обязательные колонки: КолонкаДатаНачала и  КолонкаДатаОкончания
//		КоллекцияКолонокТаблицы - коллекция колонок таблицы
//		КолонкаДатаНачала - имя колонки, содержащей дату начала периода записи
//		КолонкаДатаОкончания - имя колонки, содержащей дату окончания периода записи
Процедура РазбитьСтрокуНачисленийНаПомесячныеЗаписи(СтрокаНачислений, ТаблицаНачислений, КолонкаДатаНачала = "ДатаНачала", КолонкаДатаОкончания = "ДатаОкончания") Экспорт
	
	НачалоПериода = СтрокаНачислений[КолонкаДатаНачала];
	КонецПериода = СтрокаНачислений[КолонкаДатаОкончания];
	
	Если НачалоМесяца(НачалоПериода) = НачалоМесяца(КонецПериода) ИЛИ КонецПериода < НачалоПериода Тогда
		Возврат;// разбивать не надо
	КонецЕсли; 
	
	РазницаВМесяцах = (Год(КонецПериода)*12 + Месяц(КонецПериода)) - (Год(НачалоПериода)*12 + Месяц(НачалоПериода));
	
	// У первоначальной строки дату конца установим в конец первого месяца
	СтрокаНачислений[КолонкаДатаОкончания] = КонецМесяца(НачалоПериода);	
	
	ОчередноеНачалоМесяца = НачалоМесяца(НачалоПериода);
	Для Счетчик = 1 По РазницаВМесяцах Цикл
		
		НоваяСтрока = ТаблицаНачислений.Добавить();
		
		// Скопируем строку
		ЗаполнитьЗначенияСвойств(НоваяСтрока,СтрокаНачислений);
		
		// Установим период
		ОчередноеНачалоМесяца = ДобавитьМесяц(ОчередноеНачалоМесяца, 1);
		НоваяСтрока[КолонкаДатаНачала] = ОчередноеНачалоМесяца;	
		НоваяСтрока[КолонкаДатаОкончания] = КонецМесяца(ОчередноеНачалоМесяца);	
		
	КонецЦикла;
	
	// Для  последней строки установим конец периода в конец разбиваемого периода
	НоваяСтрока[КолонкаДатаОкончания]	 = КонецПериода;
	
КонецПроцедуры

// Сворачивает таблицу значений в которой расположены движения НДФЛСведенияОДоходах
// опирается на структуру метаданных - сворачивает все ресурсы по измерениям+реквизитам 
// Парамтеры:
//	ДвиженияНДФЛСведенияОДоходах - таблица значений
// Возвращаемое значение:
//	нет
Процедура СвернутьДвиженияНДФЛСведенияОДоходах(ДвиженияНДФЛСведенияОДоходах) Экспорт
	
	СтрокаСуммирования = "";
	Для Каждого Изм Из Метаданные.РегистрыНакопления["НДФЛСведенияОДоходах"].Ресурсы Цикл
		СтрокаСуммирования = СтрокаСуммирования + Изм.Имя +",";
	КонецЦикла;
	СтрокаСуммирования = Лев(СтрокаСуммирования, СтрДлина(СтрокаСуммирования)-1);// удалим последнюю запятую
	
	СтрокаГруппировки = "Регистратор,Период,";
	Для Каждого Изм Из Метаданные.РегистрыНакопления["НДФЛСведенияОДоходах"].Измерения Цикл
		СтрокаГруппировки = СтрокаГруппировки + Изм.Имя +",";
	КонецЦикла;
	Для Каждого Изм Из Метаданные.РегистрыНакопления["НДФЛСведенияОДоходах"].Реквизиты Цикл
		СтрокаГруппировки = СтрокаГруппировки + Изм.Имя +",";
	КонецЦикла;
	СтрокаГруппировки = Лев(СтрокаГруппировки, СтрДлина(СтрокаГруппировки)-1);// удалим последнюю запятую
	
	ДвиженияНДФЛСведенияОДоходах.Свернуть(СтрокаГруппировки,СтрокаСуммирования);
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПОЛУЧЕНИЕ СПИСКОВ СПОСОБОВ РАСЧЕТА

// Возвращает список регламентированных алгоритмов начислений
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокОсновныхВариантовНачисленийОрганизации() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Процентом);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП); //О.Т. Аверсон 04.11.2016 № 1501
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ФиксСуммойПропорционльноОтработанномуВремени);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СдельныйПриработок);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СделкаПоЧасовойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПогрузочноРазгрузочныеРаботы);//О.Т. Аверсон 02.11.2017 № 1183
	
	
	//РБ
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо1_5лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаВИЧ);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо18ЛетНадб40);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСНадбавкой40До3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСтарше3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериНадб40До3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо1_5Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРаботающейМатериДо3Лет);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.НулеваяСумма);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);//О.Т. Аверсон 03.04.2016 № 981
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);//О.Т. Аверсон 03.04.2016 № 981
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой);//О.Т. 22.05.2015 № 
	//О.Т. Аверсон 15.10.2015 № 637
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМЗПотМесячнойМЗП);
	//О.Т. Аверсон 15.10.2015 № 637
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплатыИнвалидам1и2гр); //Аверсон 10.02.2023 КВВ СВФР-010320
	
	//+ СВЭЙ КДЯ 09.10.19 СВФР-004842
	СписокСпособов.Добавить( Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоМЗПотСреднегодовойГрафика );
	//- СВЭЙ КДЯ 09.10.19 СВФР-004842
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
	
	//Толик
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезКонтракта);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиПоИнструкции);//О.Т. Аверсон 04.04.2016 № 981
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезПовышенийИДоплат); //Аверсон 05.12.2022 КВВ СВФР-009956
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиДляВакантнойДолжности); //Аверсон 07.04.2023 КВВ СВФР-010563
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Питание);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Разъездные);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредность);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредностьОтОтработанногоВремени);//О.Т. Аверсон 02.04.2016 № 972
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДетскийДень);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаБригаду);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке4Разряда);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПрямойСдельныйЗаработок);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаИзБюджета);//О.Т. Аверсон 04.11.2016 № 1501
	
	//Конец Толик
	
	// заявка №1602 (база заявок Кристалла)
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1Разряда);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1РазрядаОтрВр);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1РазрядаПоРаботнику);//О.Т. Аверсон 07.09.2016 № 1436
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ВоинскоеЗвание);//О.Т. Аверсон 18.05.2017 № 592
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.КоэффициентОтБазовогоОкладаОтОтрабВр);//О.Т. Аверсон 18.05.2017 № 592
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.КоэффициентОтТарифнойСтавки1РазрядаОтОтрабВр);//О.Т. Аверсон 18.05.2017 № 592
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СуточныйНаряд);//О.Т. Аверсон 06.06.2017 № 594
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МПЕПО);//О.Т. Аверсон 06.06.2017 № 594
	
	// //Аверсон-софт, Островская Татьяна 21.03.2012 №15092
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаЗаместительство); //Островская Татьяна 20.03.2013 № 16341
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоОкладу); //Островская Татьяна 20.03.2013 № 16341
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоТарифу);//Островская Татьяна 20.03.2013 № 16341
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.РазницаВОкладах);//О.Т. Аверсон 26.10.2017 № 1158
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме);//Островская Татьяна 25.03.2013 № 16351
	//О.Т. 27.01.2015 № 17821
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаДетейВВозрастеОт3До18);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаВторогоИПоследующихДо3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей); //О.Т. Аверсон 21.07.2017 № 851
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид);//О.Т. Аверсон 21.07.2017 № 851
	//О.Т. 27.01.2015 № 17821
	// заявка №1602
	
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2УП3);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2ДП3);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ДП2УП3);
	//
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МинП1_П2УП3);
	//
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ОП2);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ОП2ДП3);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ОП2УП3);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П3ДП1ОП2);
	//
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2ОП3);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ДП2ОП3);
	//
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2УП3ДП4);
	//
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3ОП4);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МинП1_П2УП3ОП4);
	
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1ВП2_0);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2ДП3ВП4_0);	 
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2_П5ДП3УП4);	 
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2_П3УП4ДП5);	 
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3УП4ДП5);	 
	
	//Аверсон ЕАЕ 02.02.2024 СВФР-012141
	Орг = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "ОсновнаяОрганизация");
	Если СокрЛП(Орг.ИНН) = "790056159" Тогда //Бобруйсксельмаш
		СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтОтработанныхЧасов);
		
	//Аверсон ЕАЕ 07.02.2024 СВФР-012254
	ИначеЕсли СокрЛП(Орг.ИНН) = "700103211" Тогда //Климовичи
		СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтОтработанныхЧасовЧасоваяТарифнаяСтавка);
		СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтОтработанныхЧасовСтавкаПервогоРазряда);
	КонецЕсли;
	//Аверсон СВФР-012141
	
	Возврат СписокСпособов
	
КонецФункции // ПолучитьСписокОсновныхВариантовНачисленийОрганизации()

// Возвращает список регламентированных алгоритмов начислений
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокДополнительныхВариантовНачислений() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Процентом);
	//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП); //О.Т. Аверсон 04.11.2016 № 1501
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);//О.Т. 08.10.2014 № 17616
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Питание);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.РаспределениеПремииПоКТУ);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет);
	//заявка №1633 (база заявок Кристалла) Дмитрук О.Г.
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо1_5лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо3Лет);
	//заявка №1633 
	//О.Т. 27.01.2015 № 17821
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаДетейВВозрастеОт3До18);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаВторогоИПоследующихДо3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей);//О.Т. Аверсон 21.07.2017 № 851
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид);//О.Т. Аверсон 21.07.2017 № 851
	//О.Т. 27.01.2015 № 17821
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МПЕПО); //О.Т. Аверсон 07.06.2017 № 594
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Разъездные);
	Возврат СписокСпособов
	
КонецФункции // ПолучитьСписокДополнительныхВариантовНачислений()

// Возвращает список алгоритмов начислений, зависящих от среднего заработка
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокНачисленийПоСреднемуЗаработку() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	
	Возврат СписокСпособов
	
КонецФункции // ПолучитьСписокДополнительныхВариантовНачислений()

// Возвращает список алгоритмов начислений, являющихся почасовыми отклонениями
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокНачисленийПочасовыхОтклонений() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.ВидыВремени.ЧасовоеНеотработанное);
	СписокСпособов.Добавить(Перечисления.ВидыВремени.ЧасовоеОтработанноеВПределахНормы);
	
	Возврат СписокСпособов
	
КонецФункции // ПолучитьСписокДополнительныхВариантовНачислений()

// Возвращает список регламентированных алгоритмов удержаний
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокВариантовУдержанийОрганизации() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеФиксированнойСуммой);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Процентом);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП); //О.Т. Аверсон 04.11.2016 № 1501
	//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы);
	//заявка №1676 (база заявок Кристалла) Дмитрук О.Г.
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеФиксированнойСуммойОтБазы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом);//О.Т. Аверсон 23.12.2015 № 781
	//О.Т. Аверсон 17.05.2017 № 639
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела);
	//О.Т. Аверсон 17.05.2017 № 639
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПределаСНДФЛ);//О.Т. Аверсон 30.12.2016 № 118
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ);//О.Т. Аверсон 24.05.2017 № 665
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела); //О.Т. Аверсон 24.05.2017 № 665
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой);//О.Т. Аверсон 24.05.2017 № 665
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой); //О.Т. Аверсон 24.05.2017 № 665
	//заявка №1676
	Возврат СписокСпособов
	
КонецФункции // ПолучитьСписокВариантовУдержанийОрганизации()

// Возвращает список управленческих алгоритмов начислений
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокВариантовУпрНачислений() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2УП3);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2ДП3);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ДП2УП3);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МинП1_П2УП3);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ОП2);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ОП2ДП3);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ОП2УП3);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П3ДП1ОП2);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2ОП3);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1ДП2ОП3);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.П1УП2УП3ДП4);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3ОП4);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МинП1_П2УП3ОП4);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1ВП2_0);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2ДП3ВП4_0);	 
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2_П5ДП3УП4);	 	 
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2_П3УП4ДП5);	 
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3УП4ДП5);	 
	
	
	Возврат СписокСпособов
	
КонецФункции // ПолучитьСписокВариантовУпрНачислений()

// Возвращает список алгоритмов начислений надбавок
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокВариантовНадбавок() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Процентом);
	//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП); //О.Т. Аверсон 04.11.2016 № 1501
	
	//толик	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезКонтракта);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиПоИнструкции);//О.Т. Аверсон 04.04.2016 № 981
	//енд
	
	Возврат СписокСпособов
	
КонецФункции // ПолучитьСписокВариантовНадбавок()

// Возвращает список алгоритмов начислений, не требующих указания валюты начислений
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокСпособовРасчетаНеТребующихУказанияВалюты() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);//О.Т. Аверсон 04.04.2016 № 981
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);//О.Т. Аверсон 04.04.2016 № 981
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой); //О.Т. 22.05.2015 № 
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет);
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеПоУходуЗаРебенкомДо3Лет);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Процентом);
	//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП);//О.Т. Аверсон 04.11.2016 № 1501
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.НулеваяСумма);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ); //О.Т. Аверсон 24.05.2017 № 665
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела); //О.Т. Аверсон 24.05.2017 № 665
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой); //О.Т. Аверсон 24.05.2017 № 665
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой); //О.Т. Аверсон 24.05.2017 № 665
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
	
	Возврат СписокСпособов;
	
КонецФункции 

// Возвращает алгоритмы начислений, не требующих указания валюты начислений, в виде соответствия
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Соответствие, содержащая подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСоответствиеСпособовРасчетаТребующихВалюту() Экспорт
	
	Список = ПолучитьСписокСпособовРасчетаНеТребующихУказанияВалюты();
	СоответствиеСпособов = Новый Соответствие;
	Для Сч = 0 По Перечисления.СпособыРасчетаОплатыТруда.Количество() - 1 Цикл
		Значение = Перечисления.СпособыРасчетаОплатыТруда.Получить(Сч);
		СоответствиеСпособов.Вставить(Значение, Список.НайтиПоЗначению(Значение) = Неопределено);
	КонецЦикла;  
	
	Возврат СоответствиеСпособов
	
КонецФункции // Получить()

// Возвращает список алгоритмов основных начислений
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокВариантовОсновныхНачислений() Экспорт
	
	СписокСпособов = Новый СписокЗначений;
	
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок);
	
	Возврат СписокСпособов
	
КонецФункции // ПолучитьСписокВариантовОсновныхНачислений

// Возвращает список предопределенных начислений
Функция ПредопределенныеНачисленияОрганизации() Экспорт
	
	СписокПредопределенныхВР = Новый СписокЗначений;
	Запрос = Новый Запрос("ВЫБРАТЬ
	|	ОсновныеНачисленияОрганизаций.Ссылка,
	|	ОсновныеНачисленияОрганизаций.Наименование
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
	|
	|ГДЕ
	|	(ОсновныеНачисленияОрганизаций.Предопределенный)");
	
	Результат = Запрос.Выполнить().Выбрать();
	Пока Результат.Следующий() Цикл
		СписокПредопределенныхВР.Добавить(Результат.Ссылка,Результат.Наименование);
	КонецЦикла;
	
	Возврат СписокПредопределенныхВР
	
КонецФункции

// Возвращает список видов государственных единовременных пособий за счет ФСС
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления ВидыГосударственныхПособий
//
Функция ПолучитьСписокЕдиновременныхПособийЗаСчетФСС() Экспорт
	
	СписокПособий = Новый СписокЗначений;
	
	СписокПособий.Добавить(Перечисления.ВидыГосударственныхПособий.ПриРожденииРебенка);
	СписокПособий.Добавить(Перечисления.ВидыГосударственныхПособий.ПриРожденииВторогоИПоследующихДетей);
	СписокПособий.Добавить(Перечисления.ВидыГосударственныхПособий.ПриПостановкеНаУчетВРанниеСрокиБеременности);
	СписокПособий.Добавить(Перечисления.ВидыГосударственныхПособий.ВСвязиСоСмертью);
	СписокПособий.Добавить(Перечисления.ВидыГосударственныхПособий.ПриУсыновленииРебенка);
	
	Возврат СписокПособий
	
КонецФункции

// Возвращает список кодов вычетов, относящихся к конкретным доходам
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   список значений, содержащий ссылки на предопределенные эл-ты спр-ка ВычетыНДФЛ
//
Функция ПолучитьСписокВычетовКДоходам() Экспорт
	
	СписокВычетов = Новый СписокЗначений;
	
	СписокВычетов.Добавить(Справочники.ВычетыНДФЛ.Код600);
	СписокВычетов.Добавить(Справочники.ВычетыНДФЛ.Код610);
	СписокВычетов.Добавить(Справочники.ВычетыНДФЛ.Код611);
	СписокВычетов.Добавить(Справочники.ВычетыНДФЛ.Код640);
	СписокВычетов.Добавить(Справочники.ВычетыНДФЛ.Код620);
	СписокВычетов.Добавить(Справочники.ВычетыНДФЛ.Код650);
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	ВычетыНДФЛ.Ссылка,
	|	ВычетыНДФЛ.Код + "" ("" + ВычетыНДФЛ.Наименование + "")"" КАК Представление
	|ИЗ
	|	Справочник.ВычетыНДФЛ КАК ВычетыНДФЛ
	|ГДЕ
	|	(НЕ ВычетыНДФЛ.Ссылка В (&Ссылка))
	|	И (НЕ ВычетыНДФЛ.ПометкаУдаления)
	|
	|УПОРЯДОЧИТЬ ПО
	|	ВычетыНДФЛ.Код");
	
	Запрос.УстановитьПараметр("Ссылка",СписокВычетов);
	Выборка = Запрос.Выполнить().Выбрать();
	СписокВычетов.Очистить();
	Пока Выборка.Следующий() Цикл
		СписокВычетов.Добавить(Выборка.Ссылка,Выборка.Представление);
	КонецЦикла;
	
	Возврат СписокВычетов
	
КонецФункции // ПолучитьСписокВычетовКДоходам()

// В зависимости от даты начала события предлагаем для выбора разные наборы составляющих
//
// Параметры
//  ДатаНачалаСобытия - дата, дата события, с которым связана выплата среднего заработка
//
// Возвращаемое значение:
//   Список значений, элементы которого представляют собой предопредеелнные в.р. из ПВР СреднийЗаработок
//
Функция ПолучитьПереченьСоставляющихСреднегоЗаработка(ДатаНачалаСобытия) Экспорт
	
	СписокВыбора = Новый СписокЗначений;
	ПроверяемаяДата = ?(ЗначениеЗаполнено(ДатаНачалаСобытия),ДатаНачалаСобытия,ОбщегоНазначения.ПолучитьРабочуюДату());
	СписокВыбора.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
	СписокВыбора.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
	СписокВыбора.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
	СписокВыбора.Добавить(ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии);
	
	Возврат СписокВыбора
	
КонецФункции // ПолучитьПереченьСоставляющихСреднего()

// Возвращает список процентных способов расчета
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   Список значений, содержащий подходящий перечень значений перечисления СпособыРасчетаОплатыТруда
//
Функция ПолучитьСписокНачисленийПроцентом()
	
	СписокСпособов = Новый Массив;
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Процентом);
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
	//Аверсон-софт, Островская Татьяна 20.03.2012
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы);
	//Аверсон-софт, Островская Татьяна 20.03.2012
	СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП); //О.Т. Аверсон 04.11.2016 № 1501
	//СписокСпособов.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка);
	
	Возврат СписокСпособов;
	
КонецФункции

//+ СВЭЙ КДЯ 12.08.19 СВФР-004602
// возвращает список видов расчета для документов "НачислениеОтпускаРаботникамОрганизаций" и "РасчетПриУвольненииРаботникаОрганизаций"
Функция ПолучитьСписокСоставляющихСреднегоЗаработкаДляОтпуска() Экспорт
	СписокСоставляющихСреднегоЗаработка = Новый Массив(10); //БЫЛО 8 Аверсон 11.07.2021 КВВ СВФР-007560  //Аверсон ЕАЕ 17.10.2022 СВФР-009668 было 9
	СписокСоставляющихСреднегоЗаработка[0] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
	СписокСоставляющихСреднегоЗаработка[1] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент;
	СписокСоставляющихСреднегоЗаработка[2] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
	СписокСоставляющихСреднегоЗаработка[3] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям;
	СписокСоставляющихСреднегоЗаработка[4] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
	СписокСоставляющихСреднегоЗаработка[5] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые;
	СписокСоставляющихСреднегоЗаработка[6] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент;
	//+ СВЭЙ КДЯ 13.08.19 СВФР-004602
	СписокСоставляющихСреднегоЗаработка[7] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку;
	//- СВЭЙ КДЯ 13.08.19 СВФР-004602
	СписокСоставляющихСреднегоЗаработка[8] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему;  //Аверсон 11.07.2021 КВВ СВФР-007560
	
	//Аверсон ЕАЕ 17.10.2022 СВФР-009668
	СписокСоставляющихСреднегоЗаработка[9] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах;
	//Аверсон СВФР-009668
	
	Возврат СписокСоставляющихСреднегоЗаработка;
КонецФункции // ПолучитьСписокСоставляющихСреднегоЗаработкаДляОтпуска
//- СВЭЙ КДЯ 12.08.19 СВФР-004602


////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ РАБОТЫ С ВИДАМИ РАСЧЕТА

// Эта функция возвращает информацию о виде расчета из переданного соответствия
// Если в соответствии не найдена информация о виде расчета - она подготавливается и 
// помещается в соответствие
// Применяется для работы с формами, в которых активно требуется получать 
// информащцию о видах расчета, например, при выводе строки табличного поля
//
// Параметры:      
//	СведенияОВидахРасчета - соответствие, у котрого в качестве ключа - ПланВидовРасчетаСсылка, а 
//  				  в качестве значения - структура из элементов
//					  РазмерТребуется - булево - если да, то при вводе такого 
//										вида расчета требуется проставлять значение "размер" 
//										(суммы, проценты и проч. показатели, используемые при расчете)
//
//	ВидРасчета - ПланВидовРасчетаСсылка
//
// Возвращаемое значение:
//  Описанная выше структура
//
Функция ПолучитьСведенияОВидеРасчета(СведенияОВидахРасчета, ВидРасчета) Экспорт
	
	СведенияОВидеРасчета = СведенияОВидахРасчета[ВидРасчета];
	
	Если СведенияОВидеРасчета = Неопределено Тогда
		
		ИзменениеПоказателяНеУказано = Перечисления.ИзменениеПоказателейСхемМотивации.ПустаяСсылка();
		
		СведенияОВидеРасчета = Новый Структура("
		|КодДоходаНДФЛ, 
		|СпособРасчета, 
		|ЗачетОтработанногоВремени,
		|ЗачетНормыВремени,
		|ВидВремени,
		|ПериодРасчетаСреднегоЗаработка,
		|ПорядокОпределенияРасчетногоПериодаСреднегоЗаработка,
		|РазмерТребуется,
		|НеТребуетВалюты,
		|ТребуетВводаТарифногоРазряда,
		|ОбозначениеВТабелеУчетаРабочегоВремени", 
		Неопределено,            			// КодДоходаНДФЛ
		Неопределено,            			// СпособРасчета
		Ложь,            					// ЗачетОтработанногоВремени
		Ложь,            					// ЗачетНормыВремени
		Неопределено,      					// ВидВремени
		0,            						// ПериодРасчетаСреднегоЗаработка
		Перечисления.ПорядокОпределенияРасчетногоПериодаСреднегоЗаработка.ПоТрудовомуЗаконодательству,
		Ложь,								// РазмерТребуется
		Ложь,                               // НеТребуетВалюты
		Ложь,                              // ТребуетВводаТарифногоРазряда
		Неопределено);                      // ОбозначениеВТабелеУчетаРабочегоВремени
		
		СпособРасчета = ВидРасчета.СпособРасчета;
		ТипВР = ТипЗнч(ВидРасчета);
		// размер требует способ расчета
		СведенияОВидеРасчета.СпособРасчета = СпособРасчета;
		СведенияОВидеРасчета.РазмерТребуется = СпособРасчетаТребуетРазмер(СпособРасчета);
		СведенияОВидеРасчета.НеТребуетВалюты = СпособРасчетаНеТребуетВалюты(СпособРасчета);
		// размер требует вид расчета
		Если ТипВР = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
			ЗаполнитьЗначенияСвойств(СведенияОВидеРасчета,ВидРасчета,"ВидВремени,ЗачетОтработанногоВремени,ЗачетНормыВремени,КодДоходаНДФЛ,ТребуетВводаТарифногоРазряда,ПорядокОпределенияРасчетногоПериодаСреднегоЗаработка,ПериодРасчетаСреднегоЗаработка,ОбозначениеВТабелеУчетаРабочегоВремени");
			Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок Тогда
				СведенияОВидеРасчета.РазмерТребуется = Истина;
			КонецЕсли;	
			Если СведенияОВидеРасчета.ТребуетВводаТарифногоРазряда Тогда
				СведенияОВидеРасчета.НеТребуетВалюты = Истина
			КонецЕсли;
		КонецЕсли;
		Если ТипВР = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций")  Тогда
			ЗаполнитьЗначенияСвойств(СведенияОВидеРасчета,ВидРасчета,"КодДоходаНДФЛ,ТребуетВводаТарифногоРазряда,ПорядокОпределенияРасчетногоПериодаСреднегоЗаработка");
			Если СведенияОВидеРасчета.ТребуетВводаТарифногоРазряда Тогда
				СведенияОВидеРасчета.НеТребуетВалюты = Истина
			КонецЕсли;
			Если ПолучитьСписокНачисленийПоСреднемуЗаработку().НайтиПоЗначению(СпособРасчета) <> Неопределено Тогда
				СведенияОВидеРасчета.ПериодРасчетаСреднегоЗаработка = ВидРасчета.ЧислоМесяцев;
			КонецЕсли;
		КонецЕсли;
		Если ТипВР = Тип("ПланВидовРасчетаСсылка.УдержанияОрганизаций") Тогда
			Если ПолучитьСписокНачисленийПоСреднемуЗаработку().НайтиПоЗначению(СпособРасчета) <> Неопределено Тогда
				ЗаполнитьЗначенияСвойств(СведенияОВидеРасчета,ВидРасчета,"ПорядокОпределенияРасчетногоПериодаСреднегоЗаработка,ПериодРасчетаСреднегоЗаработка");
			КонецЕсли;
		КонецЕсли;
		
		СведенияОВидахРасчета[ВидРасчета] = СведенияОВидеРасчета;
	КонецЕсли;
	
	Возврат СведенияОВидеРасчета;
	
КонецФункции  // ПолучитьСведенияОВидеРасчета

// функция проверяет необходимость задавать размер для расчета по заданному способу
// Парамерты:
//	СпособРасчета
//
// Возвращаемое значение:
//	булево - признак того, нужен ли размер для расчета таким способом
//
Функция СпособРасчетаТребуетРазмер(СпособРасчета) Экспорт
	Возврат НЕ (
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.НулеваяСумма 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1ДП2ОП3
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1ДП2УП3
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1ОП2
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1ОП2ДП3
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1ОП2УП3
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1УП2
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1УП2ДП3
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1УП2ОП3
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1УП2УП3
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П1УП2УП3ДП4
	//или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.П3ДП1ОП2
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3ОП4
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МаксП1_П2УП3УП4ДП5
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МаксП1ВП2_0
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2_П3УП4ДП5
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2_П5ДП3УП4
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МаксП1УП2ДП3ВП4_0
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МинП1_П2УП3
	// или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МинП1_П2УП3
	);
КонецФункции

Функция СпособРасчетаНеТребуетВалюты(СпособРасчета) Экспорт
	
	Возврат (
	
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф Или //О.Т. Аверсон 04.04.2016 № 981
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр Или //О.Т. Аверсон 04.04.2016 № 981
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой Или  //О.Т. 22.05.2015 № 
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСтарше3Лет Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом или
	//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП Или //О.Т. Аверсон 04.11.2016 № 1501
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.НулеваяСумма Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ Или //О.Т. Аверсон 24.05.2017 № 665
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела Или //О.Т. Аверсон 24.05.2017 № 665
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой Или //О.Т. Аверсон 24.05.2017 № 665
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой Или //О.Т. Аверсон 24.05.2017 № 665
	
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка Или
	СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом
	
	);
	
КонецФункции

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ, предназначенные для реализации способа расчета 
// ДоначислениеПоУправленческомуУчету

// Подобрать размер доначисления 
// 
// Параметры:
//  Сведения - сведения для расчета доначислений, соответсвие ключ которого - Сотрудник, значение - структура 
//  Сотрудник
//  РасчетныйПериод
// 
// Возвращаемое значение: число - размер доначисления
//
Функция ПодобратьДоначисление(Сведения, Сотрудник, РасчетныйПериод)
	
	Если Сведения = Неопределено Тогда
		Возврат 0;
	КонецЕсли;
	
	ТочностьПодбораРезультата = 0.01;
	
	Сведение = Сведения[Сотрудник];
	Если Сведение = Неопределено Тогда
		Возврат 0;
	КонецЕсли;
	Если Сведение.КВыплатеПоУпрУчету = 0 Тогда
		Возврат 0;
	КонецЕсли;
	ВсегоНачислено = Сведение.УжеНачисленоДоДоначисления;
	ВсегоНачисленоПослеДоначисления = 0;
	ВсегоНачисленоДоИПриДоначислении = Сведение.УжеНачисленоДоДоначисления;
	РанееДоначислено = 0;
	Для Каждого ЭлементПрогноза Из Сведение.ПрогнозНДФЛ Цикл
		СтрокаПрогноза = ЭлементПрогноза.Значение;
		РанееДоначислено = РанееДоначислено + СтрокаПрогноза.НачисленоПриДоначислении;
		ВсегоНачислено = ВсегоНачислено + СтрокаПрогноза.НачисленоДоДоначисления + СтрокаПрогноза.НачисленоПриДоначислении + СтрокаПрогноза.НачисленоПослеДоначисления;
		ВсегоНачисленоПослеДоначисления = ВсегоНачисленоПослеДоначисления + СтрокаПрогноза.НачисленоПослеДоначисления;
		ВсегоНачисленоДоИПриДоначислении = ВсегоНачисленоДоИПриДоначислении + СтрокаПрогноза.НачисленоДоДоначисления + СтрокаПрогноза.НачисленоПриДоначислении;
	КонецЦикла;
	
	ПерваяСтрокаПрогноза = Неопределено;
	// начальный прогноз                                
	Для Каждого ЭлементПрогноза Из Сведение.ПрогнозНДФЛ Цикл
		Если ПерваяСтрокаПрогноза = Неопределено Тогда
			ПерваяСтрокаПрогноза = ЭлементПрогноза.Значение;
		КонецЕсли;
		СтрокаПрогноза = ЭлементПрогноза.Значение;
		// для начальной оценки берем первую попавшуюся ставку
		Ставка = ?(ЭлементПрогноза.Значение.Резидент, 0.13, 0.30);
		Прервать;
	КонецЦикла;
	Если ВсегоНачисленоПослеДоначисления <> 0 Тогда
		СуммарныйПроцент = ВсегоНачисленоПослеДоначисления / ВсегоНачисленоДоИПриДоначислении * 100;
	Иначе
		СуммарныйПроцент = Сведение.СуммарныйПроцент;
	КонецЕсли;
	НачислитьПрогноз = (Сведение.КВыплатеПоУпрУчету - (ВсегоНачислено - ПрогнозНДФЛ(ПерваяСтрокаПрогноза.ОблагаемыйДоходЗаГод - Сведение.УжеНачисленоДоДоначисления + ВсегоНачисленоДоИПриДоначислении, ПерваяСтрокаПрогноза, 0,РасчетныйПериод))) / (1 + СуммарныйПроцент / 100) /(1 - Ставка); //О.Т. Аверсон 14.03.2016 № 949 добавление периода
	Для Сч = 1 По 20 Цикл
		Если не Сведение.ЕстьДоначисление Тогда
			Возврат 0;
		КонецЕсли;
		ВсегоИсчисленный = 0;
		Для Каждого ЭлементПрогноза Из Сведение.ПрогнозНДФЛ Цикл
			СтрокаПрогноза = ЭлементПрогноза.Значение;
			Ставка = ?(СтрокаПрогноза.Резидент, 0.13, 0.30);
			ПолнОблагаемыйДоходЗаГод = 
			СтрокаПрогноза.ОблагаемыйДоходЗаГод 
			+ ?(ЭлементПрогноза.Ключ = РасчетныйПериод, НачислитьПрогноз, 0) 
			//+ ?(ЭлементПрогноза.Ключ = РасчетныйПериод, Сведение.УжеНачисленоДоДоначисления, 0) 
			+ СтрокаПрогноза.НачисленоПриДоначислении + СтрокаПрогноза.НачисленоДоДоначисления 
			+ (СтрокаПрогноза.НачисленоДоДоначисления + ?(ЭлементПрогноза.Ключ = РасчетныйПериод, НачислитьПрогноз, 0) 
			+ СтрокаПрогноза.НачисленоПриДоначислении) * СуммарныйПроцент / 100;
			
			НалогИсчисленный = ПрогнозНДФЛ(ПолнОблагаемыйДоходЗаГод, СтрокаПрогноза, ВсегоИсчисленный,РасчетныйПериод);//О.Т. Аверсон 14.03.2016 № 949
			ВсегоИсчисленный  = ВсегоИсчисленный + НалогИсчисленный;
		КонецЦикла;
		Если РанееДоначислено > 0 Тогда
			// это повторная попытка расчета
			Разница = Сведение.КВыплатеПоУпрУчету - (ВсегоНачислено + НачислитьПрогноз + НачислитьПрогноз * СуммарныйПроцент / 100 - ВсегоИсчисленный);
		Иначе
			Разница = Сведение.КВыплатеПоУпрУчету - (ВсегоНачислено + НачислитьПрогноз + (ВсегоНачислено + НачислитьПрогноз) * СуммарныйПроцент / 100 - ВсегоИсчисленный);
		КонецЕсли;
		
		Если Разница < ТочностьПодбораРезультата и Разница > - ТочностьПодбораРезультата Тогда
			// выполнен точный расчет
			Прервать;
		ИначеЕсли Разница < 1 и Разница > - 1 Тогда
			// разница меньше 1
			НачислитьПрогноз = НачислитьПрогноз + Разница;
		Иначе
			НачислитьПрогноз = НачислитьПрогноз + Разница/(1 - Ставка);
		КонецЕсли;
		
	КонецЦикла;
	Возврат Макс(0, НачислитьПрогноз + РанееДоначислено);
	
КонецФункции


// расчет прогнозируемой суммы НДФЛ за некоторый период 
// Парамтеры:
//  ПолнОблагаемыйДоходЗаГод - размер дохода периода
//  СтрокаПрогноза - структура, содержащая сведения для прогноза 
//  ДопВсегоИсчисленный - дополнительная сумма уже исчисленного НДФЛ для данного 
//          периода (помимо той суммы, которая содержится в структуре СтрокаПрогноза 
//
// Возвращаемое значение: число - размер прогнозируемого налога
//
Функция ПрогнозНДФЛ(ПолнОблагаемыйДоходЗаГод, СтрокаПрогноза, ДопВсегоИсчисленный,Период)//О.Т. Аверсон 14.03.2016 № 949 добавление периода
	Если СтрокаПрогноза.Резидент Тогда
		Ставка = 0.13;
		ВычетыЛичныеЗаГод = ?(ПолнОблагаемыйДоходЗаГод >= СтрокаПрогноза.ОграничениеПоДоходамЛичные,
		СтрокаПрогноза.ВычетыЛичныеДоТекПериода,
		СтрокаПрогноза.ВычетыЛичныеДоТекПериода + СтрокаПрогноза.ВычетыЛичные);
		ВычетыДетскиеЗаГод = ?(ПолнОблагаемыйДоходЗаГод >= СтрокаПрогноза.ОграничениеПоДоходамНаДетей,
		СтрокаПрогноза.ВычетыДетскиеДоТекПериода,
		СтрокаПрогноза.ВычетыДетскиеДоТекПериода + СтрокаПрогноза.ВычетыДетские);
		ВычетыДетскиеИнвалидовЗаГод = ?(ПолнОблагаемыйДоходЗаГод >= СтрокаПрогноза.ОграничениеПоДоходамНаДетейИнвалидов,
		СтрокаПрогноза.ВычетыДетскиеИнвалидовДоТекПериода,
		СтрокаПрогноза.ВычетыДетскиеИнвалидовДоТекПериода + СтрокаПрогноза.ВычетыДетскиеИнвалидов);
		ПримененныеВычетыДетские = ?(ПолнОблагаемыйДоходЗаГод > ВычетыДетскиеЗаГод, 
		ВычетыДетскиеЗаГод, 
		ПолнОблагаемыйДоходЗаГод);
		ПримененныеВычетыДетскиеИнвалидов = ?(ПолнОблагаемыйДоходЗаГод > ВычетыДетскиеИнвалидовЗаГод + ВычетыДетскиеЗаГод, 
		ВычетыДетскиеИнвалидовЗаГод,
		?(ВычетыДетскиеИнвалидовЗаГод > ПолнОблагаемыйДоходЗаГод - ВычетыДетскиеЗаГод, 
		ПолнОблагаемыйДоходЗаГод - ВычетыДетскиеЗаГод,
		ВычетыДетскиеИнвалидовЗаГод));
		ПримененныеВычетыЛичные = ?(ПолнОблагаемыйДоходЗаГод > ВычетыЛичныеЗаГод + ВычетыДетскиеЗаГод + ВычетыДетскиеИнвалидовЗаГод, 
		ВычетыЛичныеЗаГод, 
		?(ВычетыЛичныеЗаГод > ПолнОблагаемыйДоходЗаГод - ВычетыЛичныеЗаГод - ВычетыДетскиеИнвалидовЗаГод, 
		ПолнОблагаемыйДоходЗаГод - ВычетыЛичныеЗаГод - ВычетыДетскиеИнвалидовЗаГод,
		ВычетыЛичныеЗаГод));
		ПримененныеВычеты312 = ?(ПолнОблагаемыйДоходЗаГод > ПримененныеВычетыЛичные + ПримененныеВычетыДетские + ПримененныеВычетыДетскиеИнвалидов, 
		?(СтрокаПрогноза.Вычет312Остаток > ПолнОблагаемыйДоходЗаГод - ПримененныеВычетыЛичные - ПримененныеВычетыДетские - ПримененныеВычетыДетскиеИнвалидов,
		ПолнОблагаемыйДоходЗаГод - ПримененныеВычетыЛичные - ПримененныеВычетыДетские - ПримененныеВычетыДетскиеИнвалидов,
		СтрокаПрогноза.Вычет312Остаток),
		0);
		ПримененныеВычеты311 = ?(ПолнОблагаемыйДоходЗаГод > ПримененныеВычеты312 + ПримененныеВычетыЛичные + ПримененныеВычетыДетские + ПримененныеВычетыДетскиеИнвалидов,
		?(СтрокаПрогноза.Вычет311Остаток > ПолнОблагаемыйДоходЗаГод - ПримененныеВычеты312 - ПримененныеВычетыЛичные - ПримененныеВычетыДетские - ПримененныеВычетыДетскиеИнвалидов,
		ПолнОблагаемыйДоходЗаГод - ПримененныеВычеты312 - ПримененныеВычетыЛичные - ПримененныеВычетыДетские - ПримененныеВычетыДетскиеИнвалидов,
		СтрокаПрогноза.Вычет311Остаток),
		0);
		
		Возврат ОбщегоНазначения.ОкруглитьЗначение2016((ПолнОблагаемыйДоходЗаГод - ПримененныеВычетыЛичные - ПримененныеВычетыДетские - ПримененныеВычетыДетскиеИнвалидов - ПримененныеВычеты312 - ПримененныеВычеты311) * Ставка,Период) - СтрокаПрогноза.ИсчисленныйНалогДоТекПериода + ДопВсегоИсчисленный;//О.Т. Аверсон 14.03.2016 № 949
	Иначе
		Ставка = 0.30;
		Возврат ПолнОблагаемыйДоходЗаГод * Ставка;
	КонецЕсли;
КонецФункции

// получение списка физлиц, для которых требуется уточнение размера доначисления
// Параметры:
//  СведенияОДоначислениях - сведения для расчета доначислений, соответсвие ключ которого - Физлицо, значение - структура 
// Возвращаемое значение: массив ссылок на физлица
//  
Функция ФизлицаТребующиеПересчета(СведенияОДоначислениях,ПериодРегистрации) Экспорт
	Физлица = Новый Массив();
	ДопустимаяПогрешностьРасчета = 1;
	Для Каждого ЭлементСведений Из СведенияОДоначислениях Цикл
		Сведение = ЭлементСведений.Значение;
		Физлицо = ЭлементСведений.Ключ;
		Если не Сведение.ЕстьДоначисление Тогда
			// не было доначисления
			Продолжить;
		КонецЕсли;
		ВсегоИсчисленный = 0;
		ВсегоНачисленоПриДоначислении = 0;
		ВсегоНачислено = Сведение.УжеНачисленоДоДоначисления;
		Для Каждого ЭлементПрогноза Из Сведение.ПрогнозНДФЛ Цикл
			СтрокаПрогноза = ЭлементПрогноза.Значение;
			Если СтрокаПрогноза.Резидент Тогда
				ПолнОблагаемыйДоходЗаГод = СтрокаПрогноза.ОблагаемыйДоходЗаГод + СтрокаПрогноза.НачисленоПриДоначислении + СтрокаПрогноза.НачисленоПослеДоначисления + СтрокаПрогноза.НачисленоДоДоначисления;
				НалогИсчисленный = ПрогнозНДФЛ(ПолнОблагаемыйДоходЗаГод, СтрокаПрогноза, ВсегоИсчисленный,ПериодРегистрации);//О.Т. Аверсон 14.03.2016 № 949
				ВсегоИсчисленный  = ВсегоИсчисленный + НалогИсчисленный;
				ВсегоНачислено = ВсегоНачислено + СтрокаПрогноза.НачисленоДоДоначисления + СтрокаПрогноза.НачисленоПриДоначислении + СтрокаПрогноза.НачисленоПослеДоначисления;
				ВсегоНачисленоПриДоначислении = ВсегоНачисленоПриДоначислении + СтрокаПрогноза.НачисленоПриДоначислении;
			КонецЕсли;
		КонецЦикла;
		Если ВсегоНачисленоПриДоначислении = 0 Тогда
			// доначисление оказалось "нулевым"
			Продолжить;
		КонецЕсли;
		Если ВсегоНачислено - ВсегоИсчисленный - Сведение.КВыплатеПоУпрУчету > ДопустимаяПогрешностьРасчета или ВсегоНачислено - ВсегоИсчисленный - Сведение.КВыплатеПоУпрУчету < - ДопустимаяПогрешностьРасчета Тогда
			Физлица.Добавить(Физлицо);
		КонецЕсли;
	КонецЦикла;
	Возврат Физлица;
	
КонецФункции

// получение данных для прогноза НДФЛ
// Парамтеры:
//  ПериодРегистрации
//  Организация
//  Регистратор
//  СписокФизЛицТекст - фрагмент текста запроса, предстаавляющий собой условие на список физлиц
//          ДополнительныеПараметрыЗапроса - стрруктура, параметры запроса, которые требуется установить при 
//          для выполнения фрагмента запроса СписокФизЛицТекст
// Возвращаемое значение: результат запроса с данными для прогноза НДФЛ
//
Функция ДанныеДляПрогнозаНДФЛ(ПериодРегистрации, Организация, Регистратор, СписокФизЛицТекст, ДополнительныеПараметрыЗапроса = Неопределено)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("парамОрганизация",       Организация);
	Запрос.УстановитьПараметр("парамРегистратор",       Регистратор);
	Запрос.УстановитьПараметр("парамПериодРегистрации", НачалоМесяца(ПериодРегистрации));
	
	НалоговаяПолитикаНДФЛ = РегистрыСведений.УчетнаяПолитикаПоНДФЛ.ПолучитьПоследнее(КонецГода(ПериодРегистрации), Новый Структура("Организация", Организация)).ОсобенностиИсчисленияНДФЛ;
	Если НЕ ЗначениеЗаполнено(НалоговаяПолитикаНДФЛ) Тогда
		НалоговаяПолитикаНДФЛ = Перечисления.ОсобенностиИсчисленияНДФЛ.СтандартныеВычетыНарастающимИтогом;
	КонецЕсли;
	
	// установим дополнительные параметры
	Если ДополнительныеПараметрыЗапроса <> Неопределено Тогда
		Для каждого Поле Из ДополнительныеПараметрыЗапроса Цикл
			Запрос.УстановитьПараметр(Поле.Ключ, Поле.Значение);
		КонецЦикла;
	КонецЕсли; 
	
	// получим ПоследнийМесяцНалоговогоПериода
	Запрос.Текст = "
	|ВЫБРАТЬ ПЕРВЫЕ 1
	|	НДФЛСведенияОДоходах.Период КАК Период
	|ИЗ
	|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + СписокФизЛицТекст + ") КАК Работники
	|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
	|
	|ГДЕ
	|	НДФЛСведенияОДоходах.Организация = &парамОрганизация
	|
	|УПОРЯДОЧИТЬ ПО
	|	Период УБЫВ";
	Результат = Запрос.Выполнить();
	
	Если Результат.Пустой() Тогда
		ПоследнийМесяцНалоговогоПериода = КонецМесяца(ПериодРегистрации);
		
	Иначе
		Выборка = Результат.Выбрать();
		Выборка.Следующий();
		ПоследнийМесяцНалоговогоПериода = КонецМесяца(Выборка.Период);
		
	КонецЕсли;
	
	// получим самый ранний месяц налогового периода
	Запрос.Текст = "
	|ВЫБРАТЬ ПЕРВЫЕ 1
	|	НДФЛСведенияОДоходах.Период КАК Период
	|ИЗ
	|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + СписокФизЛицТекст + ") КАК Работники
	|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
	|
	|ГДЕ
	|	НДФЛСведенияОДоходах.Организация = &парамОрганизация И НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
	|
	|УПОРЯДОЧИТЬ ПО
	|	Период";
	Результат = Запрос.Выполнить();
	
	Если Результат.Пустой() Тогда
		ПервыйМесяцНалоговогоПериода = ПериодРегистрации;
		
	Иначе
		Выборка = Результат.Выбрать();
		Выборка.Следующий();
		ПервыйМесяцНалоговогоПериода = НачалоМесяца(Выборка.Период);
		
	КонецЕсли;
	
	Запрос.УстановитьПараметр("парамСтавка13",                     Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13);
	Запрос.УстановитьПараметр("парамСтавкаРезидента13",            ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛотСтавкиНалогообложенияРезидента(Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13) / 100);
	
	Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ПоследнийМесяцНалоговогоПериода));
	
	Запрос.УстановитьПараметр("парамПерваяПоловинаГода", КонецМесяца(Дата(2016,06,01)));
	Запрос.УстановитьПараметр("парамВтораяПоловинаГода", Дата(2016,07,01));
	
	
	Запрос.УстановитьПараметр("парамНачалоГода",                   НачалоГода(ПервыйМесяцНалоговогоПериода));
	Запрос.УстановитьПараметр("парамКонецГода",                    КонецГода(ПоследнийМесяцНалоговогоПериода));
	Запрос.УстановитьПараметр("парамПриход",                       ВидДвиженияНакопления.Приход);
	Запрос.УстановитьПараметр("парамВидСтроки",                    Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
	
	Запрос.УстановитьПараметр("КодВычета312", Справочники.ВычетыНДФЛ.Код312);
	Запрос.УстановитьПараметр("КодВычета311", Справочники.ВычетыНДФЛ.Код311);
	
	КодыВычетовРезидентов = Новый Массив;
	КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код401);
	КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код402);
	КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код403);
	КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код404);
	КодыВычетовРезидентов.Добавить(Справочники.ВычетыНДФЛ.Код405);
	Запрос.УстановитьПараметр("КодыВычетовРезидентов", КодыВычетовРезидентов);
	
	// Периоды
	// Таблица список периодов-физлиц по которым необходимо выполнить расчет налога
	// Поля:
	//		Период
	//		Физлицо
	
	ПериодыТекст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) КАК Период,
	|	НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо
	|ИЗ
	|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + СписокФизЛицТекст + ") КАК Работники
	|		ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
	|
	|ГДЕ
	|	НДФЛСведенияОДоходах.Период МЕЖДУ &парамНачалоГода И &парамКонецМесяцаНалоговогоПериода И
	|	НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) <= &парамПериодРегистрации И
	|	НДФЛСведенияОДоходах.Организация = &парамОрганизация И
	|	НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	| 	&парамПериодРегистрации,
	|	Работники.Физлицо
	|ИЗ
	|	(" + СписокФизЛицТекст + ") КАК Работники";
	
	// ФизлицаНеРезиденты
	//	Поля:
	//		Физлицо
	//
	//	Описание:
	//	сисок физлиц-нерезидентов
	
	ФизлицаНеРезидентыТекст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ГражданствоФизЛиц.ФизЛицо
	|ИЗ
	|	РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&парамКонецГода) КАК ГражданствоФизЛиц
	|
	|ГДЕ
	|	(ГражданствоФизЛиц.НеЯвляетсяНалоговымРезидентомРФ)";
	
	// ДоходыСКодамиВычетов
	//	Поля:
	//		ФизЛицо
	//		Период
	//		КодДохода
	//		КодВычета
	//		СуммаДоходаОборот
	//		СуммаВычетаОборот
	//
	//	Описание:
	// Выбирает облагаемые налогом доходы за весь год по физлицам из СписокФизлиц
	ДоходыСКодамиВычетовТекст = 
	"ВЫБРАТЬ
	|	НДФЛОбороты.Физлицо КАК ФизЛицо,
	|	НДФЛОбороты.Период КАК Период,
	|	НДФЛОбороты.КодДохода КАК КодДохода,
	|	НДФЛОбороты.КодВычета КАК КодВычета,
	|	СУММА(НДФЛОбороты.СуммаДоходаОборот) КАК СуммаДоходаОборот,
	|	СУММА(НДФЛОбороты.СуммаВычетаОборот) КАК СуммаВычетаОборот
	|ИЗ
	|	(ВЫБРАТЬ
	|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) КАК Период,
	|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо,
	|		НДФЛСведенияОДоходах.КодДохода КАК КодДохода,
	|		НДФЛСведенияОДоходах.КодВычета КАК КодВычета,
	|		СУММА(НДФЛСведенияОДоходах.СуммаДохода) КАК СуммаДоходаОборот,
	|		СУММА(НДФЛСведенияОДоходах.СуммаВычета) КАК СуммаВычетаОборот
	|	ИЗ
	|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + СписокФизЛицТекст + ") КАК Работники
	|			ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
	|	
	|	ГДЕ
	|		НДФЛСведенияОДоходах.Период МЕЖДУ &парамНачалоГода И &парамКонецМесяцаНалоговогоПериода И
	|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) <= &парамПериодРегистрации И
	|		НДФЛСведенияОДоходах.Организация = &парамОрганизация И
	|		НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
	|	
	|	СГРУППИРОВАТЬ ПО
	|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
	|		НДФЛСведенияОДоходах.ФизЛицо,
	|		НДФЛСведенияОДоходах.КодДохода,
	|		НДФЛСведенияОДоходах.КодВычета) КАК НДФЛОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	НДФЛОбороты.Физлицо,
	|	НДФЛОбороты.Период,
	|	НДФЛОбороты.КодДохода,
	|	НДФЛОбороты.КодВычета";
	
	Ставка30Текст        = "0.3";
	ТипЗначенияНДФЛТекст = "ЧИСЛО(10, 0)";
	
	ПериодыСКодамиТекст = 
	"ВЫБРАТЬ
	|	ПериодФизлицо.Период КАК Период,
	|	ПериодФизлицо.Физлицо КАК Физлицо,
	|	ВЫБОР КОГДА (ФизлицаНеРезиденты.ФизЛицо) ЕСТЬ NULL  ТОГДА ИСТИНА ИНАЧЕ ЛОЖЬ КОНЕЦ КАК Резидент,
	|	КодДоходаФизлицо.КодДохода КАК КодДохода
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ) КАК Период,
	|		НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо
	|	ИЗ
	|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + СписокФизЛицТекст + ") КАК Работники
	|			ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
	|	
	|	ГДЕ
	|		НДФЛСведенияОДоходах.Период МЕЖДУ &парамНачалоГода И &парамКонецМесяцаНалоговогоПериода И
	|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) <= &парамПериодРегистрации И
	|		НДФЛСведенияОДоходах.Организация = &парамОрганизация И
	|		НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
	|
	|		ОБЪЕДИНИТЬ
	|		
	|		ВЫБРАТЬ
	|			&парамПериодРегистрации,
	|			Работники.Физлицо
	|		ИЗ
	|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|				Работники.ФизЛицо КАК Физлицо
	|			ИЗ
	|				Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК Работники
	|			ГДЕ
	|				Работники.Ссылка = &парамРегистратор) КАК Работники) КАК ПериодФизлицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
	|			НДФЛСведенияОДоходах.КодДохода КАК КодДохода,
	|			НДФЛСведенияОДоходах.ФизЛицо КАК Физлицо
	|		ИЗ
	|			РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
	|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + СписокФизЛицТекст + ") КАК Работники
	|				ПО Работники.Физлицо = НДФЛСведенияОДоходах.ФизЛицо
	|		
	|		ГДЕ
	|			НДФЛСведенияОДоходах.Период МЕЖДУ &парамНачалоГода И &парамКонецМесяцаНалоговогоПериода И
	|			НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.ПериодРегистрации, МЕСЯЦ) <= &парамПериодРегистрации И
	|			НДФЛСведенияОДоходах.Организация = &парамОрганизация И
	|			НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13) КАК КодДоходаФизлицо
	|		ПО КодДоходаФизлицо.Физлицо = ПериодФизлицо.Физлицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ФизлицаНеРезидентыТекст + ") КАК ФизлицаНеРезиденты
	|		ПО ФизлицаНеРезиденты.ФизЛицо = КодДоходаФизлицо.Физлицо";
	
	
	// ДоходыЗаГод 
	//	Поля:
	//		ФизЛицо
	//		Период
	//		Резидент
	//		ОблагаемыйДоходЗаГод
	//
	//	Описание:
	//	Выбирает по всем периодам с начала года сумму дохода нарастающим итогом за год
	
	ДоходыЗаГодТекст = "
	|ВЫБРАТЬ
	|	НДФЛОбороты.Период КАК Период,
	|	НДФЛОбороты.ФизЛицо КАК ФизЛицо,
	|	НДФЛОбороты.Резидент КАК Резидент,
	|	СУММА(НДФЛОбороты.НалогНерезидента) КАК НалогНерезидента,
	|	СУММА(НДФЛОбороты.ОблагаемыйДоходЗаПериод) КАК ОблагаемыйДоходЗаПериод,
	|	СУММА(НДФЛОбороты.ОблагаемыйДоходЗаГод) КАК ОблагаемыйДоходЗаГод
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		Периоды.Физлицо КАК ФизЛицо,
	|		Периоды.Резидент КАК Резидент,
	|		ВЫБОР КОГДА НДФЛОбороты.Период = Периоды.Период ТОГДА ВЫРАЗИТЬ((НДФЛОбороты.СуммаДоходаОборот - ВЫБОР КОГДА Периоды.Резидент ИЛИ НДФЛОбороты.КодВычета НЕ В (&КодыВычетовРезидентов) ТОГДА НДФЛОбороты.СуммаВычетаОборот ИНАЧЕ 0 КОНЕЦ) * " + Ставка30Текст + " КАК " + ТипЗначенияНДФЛТекст + ") ИНАЧЕ 0 КОНЕЦ КАК НалогНерезидента,
	|       ВЫБОР КОГДА НДФЛОбороты.Период = Периоды.Период ТОГДА НДФЛОбороты.СуммаДоходаОборот - ВЫБОР КОГДА Периоды.Резидент ИЛИ НДФЛОбороты.КодВычета НЕ В (&КодыВычетовРезидентов) ТОГДА НДФЛОбороты.СуммаВычетаОборот ИНАЧЕ 0 КОНЕЦ ИНАЧЕ 0 КОНЕЦ КАК ОблагаемыйДоходЗаПериод,
	|		НДФЛОбороты.СуммаДоходаОборот - ВЫБОР КОГДА Периоды.Резидент ИЛИ НДФЛОбороты.КодВычета НЕ В (&КодыВычетовРезидентов) ТОГДА НДФЛОбороты.СуммаВычетаОборот ИНАЧЕ 0 КОНЕЦ КАК ОблагаемыйДоходЗаГод
	|	ИЗ
	|		(" + ПериодыСКодамиТекст + ") КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ (" + ДоходыСКодамиВычетовТекст + ") КАК НДФЛОбороты
	|			ПО (НДФЛОбороты.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период) И Периоды.Физлицо = НДФЛОбороты.Физлицо И Периоды.КодДохода = НДФЛОбороты.КодДохода) КАК НДФЛОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	НДФЛОбороты.Период,
	|	НДФЛОбороты.ФизЛицо,
	|	НДФЛОбороты.Резидент";
	
	// НДФЛРасчетыСБюджетом
	//	Поля:
	//		ФизЛицо
	//		МесяцНалоговогоПериода
	//		ИсчисленныйНалог
	//
	//	Описание:
	//	Выбирает исчисленные налоги (приходы по регистру НДФЛРасчетыСБюджетом)
	//  для СписокФизлиц
	
	НДФЛРасчетыСБюджетомТекст = "
	|ВЫБРАТЬ
	|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода КАК МесяцНалоговогоПериода,
	|	НДФЛРасчетыСБюджетом.ФизЛицо КАК ФизЛицо,
	|	СУММА(НДФЛРасчетыСБюджетом.Налог) КАК ИсчисленныйНалог
	|ИЗ
	|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ("+СписокФизлицТекст+") КАК РаботникиОрганизации
	|		ПО РаботникиОрганизации.Физлицо = НДФЛРасчетыСБюджетом.ФизЛицо
	|
	|ГДЕ
	|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода >= &парамНачалоГода И
	|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода <= &парамКонецМесяцаНалоговогоПериода И
	|	НДФЛРасчетыСБюджетом.Организация = &парамОрганизация И
	|	НДФЛРасчетыСБюджетом.Регистратор <> &парамРегистратор И
	|	НДФЛРасчетыСБюджетом.Период <= &парамКонецМесяцаНалоговогоПериода И
	|	НДФЛРасчетыСБюджетом.ВидДвижения = &парамПриход И 
	|	НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = &парамСтавка13 И 
	|	НДФЛРасчетыСБюджетом.ВидСтроки = &парамВидСтроки
	|
	|СГРУППИРОВАТЬ ПО
	|	НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода,
	|	НДФЛРасчетыСБюджетом.ФизЛицо";
	
	// НДФЛРасчетыСБюджетомЗаГод
	//	Поля:
	//		ФизЛицо
	//		Период
	//		ИсчисленныйНалогЗаГод
	//
	//	Описание:
	//	Выбирает исчисленные налоги нарастающим итогом за год
	
	НДФЛРасчетыСБюджетомЗаГодТекст = 
	"ВЫБРАТЬ
	|	Периоды.Период КАК Период,
	|	НДФЛРасчетыСБюджетом.ФизЛицо КАК ФизЛицо,
	|	ВЫБОР КОГДА (ФизлицаНеРезиденты.ФизЛицо) ЕСТЬ NULL  ТОГДА СУММА(НДФЛРасчетыСБюджетом.ИсчисленныйНалог) ИНАЧЕ МАКСИМУМ(ВЫБОР КОГДА Периоды.Период <> НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода ТОГДА -(99999999) ИНАЧЕ НДФЛРасчетыСБюджетом.ИсчисленныйНалог КОНЕЦ) КОНЕЦ КАК ИсчисленныйНалогДоТекПериода
	|ИЗ
	|	(" + ПериодыТекст + ") КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + НДФЛРасчетыСБюджетомТекст + ") КАК НДФЛРасчетыСБюджетом
	|		ПО (НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период) И Периоды.Физлицо = НДФЛРасчетыСБюджетом.Физлицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
	|			ГражданствоФизЛиц.ФизЛицо КАК ФизЛицо
	|		ИЗ
	|			РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&парамКонецГода) КАК ГражданствоФизЛиц
	|		ГДЕ
	|			(ГражданствоФизЛиц.НеЯвляетсяНалоговымРезидентомРФ)) КАК ФизлицаНеРезиденты
	|		ПО ФизлицаНеРезиденты.ФизЛицо = Периоды.Физлицо
	|
	|СГРУППИРОВАТЬ ПО
	|	Периоды.Период,
	|	НДФЛРасчетыСБюджетом.ФизЛицо,
	|	ФизлицаНеРезиденты.ФизЛицо";
	
	// ПрименениеВычетовВОрганизации
	//	Поля:
	//		Физлицо,
	//		Период
	//
	// Описание:
	//	Выбирает список физлиц + периодв в которые применяются стандартные вычеты по 
	//	заданной организации
	
	ПрименениеВычетовВОрганизацииТекст = 
	"ВЫБРАТЬ
	|	НДФЛПрименениеВычетовСрезПоследних.Физлицо КАК Физлицо,
	|	НДФЛПрименениеВычетовСрезПоследних.Период КАК Период
	|ИЗ
	|	(ВЫБРАТЬ
	|		МАКСИМУМ(НДФЛПрименениеВычетов.Период) КАК ПериодСреза,
	|		Периоды.Физлицо КАК Физлицо,
	|		Периоды.Период КАК Период
	|	ИЗ
	|		("+ПериодыТекст+") КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛПрименениеВычетов КАК НДФЛПрименениеВычетов
	|			ПО Периоды.Период >= НДФЛПрименениеВычетов.Период И НДФЛПрименениеВычетов.Физлицо = Периоды.Физлицо
	
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Периоды.Физлицо,
	|		Периоды.Период) КАК НДФЛПрименениеВычетовСрезПоследних
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛПрименениеВычетов КАК НДФЛПрименениеВычетов
	|		ПО НДФЛПрименениеВычетов.Период = НДФЛПрименениеВычетовСрезПоследних.ПериодСреза И НДФЛПрименениеВычетов.Физлицо = НДФЛПрименениеВычетовСрезПоследних.Физлицо
	|
	|ГДЕ
	|	НДФЛПрименениеВычетов.Организация = &парамОрганизация";
	
	// НДФЛРазмерВычетов
	// Таблица "НДФЛРазмерВычетов": - таблица это список вычетов, их размер, ограничения по доходам
	// поля:
	//		Период, 
	//		КодВычета,
	//		Размер, 
	//		ОграничениеПоДоходам,
	// Описание:	
	//	Выбираем Из Список периодов (период - год)
	//	Левое соединение с НДФЛРазмерВычетов
	//	по равенству периодов
	// 
	
	// первый год
	НачалоГода = НачалоГода(ПоследнийМесяцНалоговогоПериода);	
	ПериодыТекстПоГодам = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачалоГода,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период";
	Для Сч = Год(ПервыйМесяцНалоговогоПериода)+ 1 По Год(ПоследнийМесяцНалоговогоПериода) Цикл
		НачалоГода = НачалоГода(НачалоГода - 1);
		ПериодыТекстПоГодам = ПериодыТекстПоГодам +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(НачалоГода,"ДФ=гггг,М,д,Ч,м,с") + ")";
	КонецЦикла;
	
	НДФЛРазмерВычетов =
	"ВЫБРАТЬ
	|	Периоды.Период КАК Период,
	|	ЕСТЬNULL(НДФЛРазмерВычетов.КодВычета, 0) КАК КодВычета,
	|	НДФЛРазмерВычетов.Размер КАК Размер,
	|	НДФЛРазмерВычетов.ОграничениеПоДоходам КАК ОграничениеПоДоходам
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		НДФЛРазмерВычетов.КодВычета КАК КодВычета,
	|		МАКСИМУМ(НДФЛРазмерВычетов.Период) КАК ПериодРегистра
	|	ИЗ
	|		("+ПериодыТекстПоГодам+") КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов
	|			ПО Периоды.Период >= НДФЛРазмерВычетов.Период
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Периоды.Период,
	|		НДФЛРазмерВычетов.КодВычета) КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛРазмерВычетов КАК НДФЛРазмерВычетов
	|		ПО НДФЛРазмерВычетов.Период = Периоды.ПериодРегистра И Периоды.КодВычета = НДФЛРазмерВычетов.КодВычета ";
	
	// ПраваНаВычеты
	//	Поля:
	//		Физлицо
	//		Период
	//		СтандартныеВычетыЛичные
	//		СтандартныеВычетыДетские
	//
	//	Описание:
	//	Выбирает по всем периодам года стандартные вычеты на которые имеет право физлицо
	
	ПраваНаВычетыТекст = 
	"ВЫБРАТЬ
	|	НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо КАК Физлицо,
	|	НДФЛСтандартныеВычетыФизлицСрезПоследних.Период КАК Период,
	|	НДФЛРазмерВычетовЛичный.ОграничениеПоДоходам КАК ОграничениеПоДоходамЛичные,
	|	НДФЛРазмерВычетовНаДетей.ОграничениеПоДоходам КАК ОграничениеПоДоходамНаДетей,
	|	НДФЛРазмерВычетовНаДетейИнвалидов.ОграничениеПоДоходам КАК ОграничениеПоДоходамНаДетейИнвалидов,
	|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ЕСТЬNULL(НДФЛРазмерВычетовЛичный.Размер, 0) КОНЕЦ КАК СтандартныеВычетыЛичные,
	|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ЕСТЬNULL(НДФЛРазмерВычетовНаДетей.Размер, 0) * ЕСТЬNULL(ВычетыФизлиц.КоличествоДетей, 0) КОНЕЦ КАК СтандартныеВычетыДетские,
	|	ВЫБОР КОГДА (ПрименениеВычетов.Физлицо) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ЕСТЬNULL(НДФЛРазмерВычетовНаДетейИнвалидов.Размер, 0) * ЕСТЬNULL(ВычетыФизлиц.КоличествоДетейИнвалидов, 0) КОНЕЦ КАК СтандартныеВычетыДетскиеИнвалидов
	|ИЗ
	|	(ВЫБРАТЬ
	|		МАКСИМУМ(ВычетыФизлиц.Период) КАК ПериодСреза,
	|		Периоды.Физлицо КАК Физлицо,
	|		Периоды.Период КАК Период
	|	ИЗ
	|		(" + ПериодыТекст + ") КАК Периоды
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛСтандартныеВычетыФизлиц КАК ВычетыФизлиц
	|			ПО ВычетыФизлиц.Период <= Периоды.Период И ВычетыФизлиц.Физлицо = Периоды.Физлицо
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Периоды.Физлицо,
	|		Периоды.Период) КАК НДФЛСтандартныеВычетыФизлицСрезПоследних
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛСтандартныеВычетыФизлиц КАК ВычетыФизлиц
	|		ПО ВычетыФизлиц.Период = НДФЛСтандартныеВычетыФизлицСрезПоследних.ПериодСреза И ВычетыФизлиц.Физлицо = НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовЛичный
	|		ПО НДФЛРазмерВычетовЛичный.КодВычета = ВычетыФизлиц.КодВычетаЛичный И НДФЛРазмерВычетовЛичный.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Год)
	|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовНаДетей
	|		ПО НДФЛРазмерВычетовНаДетей.КодВычета = ВычетыФизлиц.КодВычетаНаДетей И НДФЛРазмерВычетовНаДетей.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Год)
	|		ЛЕВОЕ СОЕДИНЕНИЕ (" + НДФЛРазмерВычетов + ") КАК НДФЛРазмерВычетовНаДетейИнвалидов
	|		ПО НДФЛРазмерВычетовНаДетейИнвалидов.КодВычета = ВычетыФизлиц.КодВычетаНаДетейИнвалидов И НДФЛРазмерВычетовНаДетейИнвалидов.Период = НАЧАЛОПЕРИОДА(НДФЛСтандартныеВычетыФизлицСрезПоследних.Период, Год)
	|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ПрименениеВычетовВОрганизацииТекст + ") КАК ПрименениеВычетов
	|		ПО ПрименениеВычетов.Физлицо = НДФЛСтандартныеВычетыФизлицСрезПоследних.Физлицо И ПрименениеВычетов.Период = НДФЛСтандартныеВычетыФизлицСрезПоследних.Период";
	
	// ПрименяемыеВычеты
	// Поля:
	//		Физлицо
	//		Период
	//		ПрименяемыеВычетыЛичные
	//		ПрименяемыеВычетыДетские
	//
	//	Описание:
	//	Выбирает по всем периодам года применяемые стандартные вычеты
	//  с использованием ограничения по доходам
	
	Если НалоговаяПолитикаНДФЛ = Перечисления.ОсобенностиИсчисленияНДФЛ.СтандартныеВычетыНарастающимИтогом Тогда
		
		ПрименяемыеВычетыТекст = 
		"ВЫБРАТЬ
		|	РаботникиОргПраваНаВычеты.Физлицо КАК Физлицо,
		|	РаботникиОргПраваНаВычеты.Период КАК Период,
		|	РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные КАК ОграничениеПоДоходамЛичные,
		|	РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетей КАК ОграничениеПоДоходамНаДетей,
		|	РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетейИнвалидов КАК ОграничениеПоДоходамНаДетейИнвалидов,
		|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные  ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные  = 0 ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные  ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыЛичные,
		|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетей ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетей = 0 ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыДетские,
		|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетейИнвалидов ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетейИнвалидов = 0 ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеИнвалидов ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыДетскиеИнвалидов
		|ИЗ
		|	(" + ПраваНаВычетыТекст + ") КАК РаботникиОргПраваНаВычеты
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ДоходыЗаГодТекст + ") КАК ДоходыЗаГод
		|		ПО ДоходыЗаГод.Период = РаботникиОргПраваНаВычеты.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛДоходыПредыдущегоМестаРаботы КАК НДФЛДоходыПредыдущегоМестаРаботы
		|		ПО (НДФЛДоходыПредыдущегоМестаРаботы.Организация = &парамОрганизация) И НДФЛДоходыПредыдущегоМестаРаботы.МесяцНалоговогоПериода = РаботникиОргПраваНаВычеты.Период И НДФЛДоходыПредыдущегоМестаРаботы.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо";
	Иначе
		
		ПрименяемыеВычетыТекст = 
		"ВЫБРАТЬ
		|	РаботникиОргПраваНаВычеты.Физлицо КАК Физлицо,
		|	РаботникиОргПраваНаВычеты.Период КАК Период,
		|	РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные КАК ОграничениеПоДоходамЛичные,
		|	РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетей КАК ОграничениеПоДоходамНаДетей,
		|	РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетейИнвалидов КАК ОграничениеПоДоходамНаДетейИнвалидов,
		|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные  ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамЛичные  = 0 ТОГДА 
		|ВЫБОР
		|    КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод > РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеИнвалидов + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские
		|        ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыЛичные
		|    КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеИнвалидов > 0
		|    ТОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеИнвалидов
		|    ИНАЧЕ 0
		|КОНЕЦ  ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыЛичные,
		|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетей ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетей = 0 ТОГДА 
		|ВЫБОР
		|    КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод > РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские
		|        ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские
		|    ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаПериод
		|КОНЕЦ ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыДетские,
		|	ВЫБОР КОГДА ВЫБОР КОГДА (ДоходыЗаГод.ОблагаемыйДоходЗаГод) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ДоходыЗаГод.ОблагаемыйДоходЗаГод КОНЕЦ + ВЫБОР КОГДА (НДФЛДоходыПредыдущегоМестаРаботы.Размер) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ НДФЛДоходыПредыдущегоМестаРаботы.Размер КОНЕЦ <= РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетейИнвалидов ИЛИ РаботникиОргПраваНаВычеты.ОграничениеПоДоходамНаДетейИнвалидов = 0 ТОГДА 
		|ВЫБОР
		|    КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод > РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеИнвалидов + РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские
		|        ТОГДА РаботникиОргПраваНаВычеты.СтандартныеВычетыДетскиеИнвалидов
		|    КОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские > 0
		|    ТОГДА ДоходыЗаГод.ОблагаемыйДоходЗаПериод - РаботникиОргПраваНаВычеты.СтандартныеВычетыДетские
		|    ИНАЧЕ 0
		|КОНЕЦ ИНАЧЕ 0 КОНЕЦ КАК ПрименяемыеВычетыДетскиеИнвалидов
		|ИЗ
		|	(" + ПраваНаВычетыТекст + ") КАК РаботникиОргПраваНаВычеты
		|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ДоходыЗаГодТекст + ") КАК ДоходыЗаГод
		|		ПО ДоходыЗаГод.Период = РаботникиОргПраваНаВычеты.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛДоходыПредыдущегоМестаРаботы КАК НДФЛДоходыПредыдущегоМестаРаботы
		|		ПО (НДФЛДоходыПредыдущегоМестаРаботы.Организация = &парамОрганизация) И НДФЛДоходыПредыдущегоМестаРаботы.МесяцНалоговогоПериода = РаботникиОргПраваНаВычеты.Период И НДФЛДоходыПредыдущегоМестаРаботы.ФизЛицо = РаботникиОргПраваНаВычеты.Физлицо";
	КонецЕсли;
	
	// ПрименяемыеВычетыЗаГод
	//	Поля:
	//		Физлицо
	//		Период
	//		ВычетыЛичныеЗаГод
	//		ВычетыДетскиеЗаГод
	//
	//	Описание:
	//	Выбирает по всем периодам года применяемые стандартные вычеты нарастающим итогом за год
	//
	ПрименяемыеВычетыЗаГодТекст = 
	"ВЫБРАТЬ
	|	ВычетыПоПериодам.Физлицо КАК Физлицо,
	|	Периоды.Период КАК Период,
	|	ВычетыПоПериодам.ОграничениеПоДоходамЛичные,
	|	ВычетыПоПериодам.ОграничениеПоДоходамНаДетей,
	|	ВычетыПоПериодам.ОграничениеПоДоходамНаДетейИнвалидов,
	|	СУММА(ВЫБОР КОГДА ВычетыПоПериодам.Период = Периоды.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыЛичные ИНАЧЕ 0 КОНЕЦ) КАК ВычетыЛичные,
	|	СУММА(ВЫБОР КОГДА ВычетыПоПериодам.Период = Периоды.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыДетские ИНАЧЕ 0 КОНЕЦ) КАК ВычетыДетские,
	|	СУММА(ВЫБОР КОГДА ВычетыПоПериодам.Период = Периоды.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыДетскиеИнвалидов ИНАЧЕ 0 КОНЕЦ) КАК ВычетыДетскиеИнвалидов,
	|	СУММА(ВЫБОР КОГДА ВычетыПоПериодам.Период < Периоды.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыЛичные ИНАЧЕ 0 КОНЕЦ) КАК ВычетыЛичныеДоТекПериода,
	|	СУММА(ВЫБОР КОГДА ВычетыПоПериодам.Период < Периоды.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыДетские ИНАЧЕ 0 КОНЕЦ) КАК ВычетыДетскиеДоТекПериода,
	|	СУММА(ВЫБОР КОГДА ВычетыПоПериодам.Период < Периоды.Период ТОГДА ВычетыПоПериодам.ПрименяемыеВычетыДетскиеИнвалидов ИНАЧЕ 0 КОНЕЦ) КАК ВычетыДетскиеИнвалидовДоТекПериода
	|ИЗ
	|	(" + ПериодыТекст + ") КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ (" + ПрименяемыеВычетыТекст + ") КАК ВычетыПоПериодам
	|		ПО (ВычетыПоПериодам.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, ГОД) И Периоды.Период) И ВычетыПоПериодам.Физлицо = Периоды.Физлицо
	|
	|СГРУППИРОВАТЬ ПО
	|	ВычетыПоПериодам.Физлицо,
	|	ВычетыПоПериодам.ОграничениеПоДоходамЛичные,
	|	ВычетыПоПериодам.ОграничениеПоДоходамНаДетей,
	|	ВычетыПоПериодам.ОграничениеПоДоходамНаДетейИнвалидов,
	|	Периоды.Период";
	
	// Приходы вычетов помесячные  
	Вычеты312ПоМесяцамТекст = 
	"ВЫБРАТЬ
	|	Остатки.ФизЛицо КАК ФизЛицо,
	|	Остатки.Период КАК Период,
	|	Остатки.Год КАК НалоговыйПериод,
	|	Остатки.РазмерНачальныйОстаток КАК Вычет312Остаток,
	|	0 КАК ПримененныеВычеты312
	|ИЗ
	|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
	|		&парамНачалоГода,
	|		&парамКонецГода,
	|		Год,
	|		,
	|		КодВычетаИмущественный = &КодВычета312
	|           И Физлицо В (" + СписокФизлицТекст + ")
	|		    И Организация = &парамОрганизация) КАК Остатки
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Обороты.ФизЛицо,
	|	Обороты.Период,
	|	Обороты.Год,
	|	Обороты.РазмерПриход,
	|	Обороты.РазмерРасход
	|ИЗ
	|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
	|		&парамНачалоГода,
	|		&парамКонецГода,
	|		Месяц,
	|		,
	|		КодВычетаИмущественный = &КодВычета312
	|           И Физлицо В (" + СписокФизлицТекст + ")
	|		    И Организация = &парамОрганизация) КАК Обороты";
	
	Вычеты311ПоМесяцамТекст = 
	"ВЫБРАТЬ
	|	Остатки.ФизЛицо КАК ФизЛицо,
	|	Остатки.Период КАК Период,
	|	Остатки.Год КАК НалоговыйПериод,
	|	Остатки.РазмерНачальныйОстаток КАК Вычет311Остаток,
	|	0 КАК ПримененныеВычеты311
	|ИЗ
	|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
	|		&парамНачалоГода,
	|		&парамКонецГода,
	|		Год,
	|		,
	|		КодВычетаИмущественный = &КодВычета311
	|           И Физлицо В (" + СписокФизлицТекст + ")
	|		    И Организация = &парамОрганизация) КАК Остатки
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Обороты.ФизЛицо,
	|	Обороты.Период,
	|	Обороты.Год,
	|	Обороты.РазмерПриход,
	|	Обороты.РазмерРасход
	|ИЗ
	|	РегистрНакопления.НДФЛИмущественныеВычетыФизлиц.ОстаткиИОбороты(
	|		&парамНачалоГода,
	|		&парамКонецГода,
	|		Месяц,
	|		,
	|		КодВычетаИмущественный = &КодВычета311
	|           И Физлицо В (" + СписокФизлицТекст + ")
	|		    И Организация = &парамОрганизация) КАК Обороты";
	
	// Приходы вычетов с начала года нарастающим итогом
	Вычеты312Текст = 
	"ВЫБРАТЬ
	|	Периоды.Физлицо КАК Физлицо,
	|	Периоды.Период КАК Период,
	|	СУММА(Обороты.Вычет312Остаток) КАК Вычет312Остаток,
	|	СУММА(Обороты.ПримененныеВычеты312) КАК Вычет312ЗаГод,
	|	СУММА(ВЫБОР КОГДА НАЧАЛОПЕРИОДА(Обороты.Период, МЕСЯЦ) = Периоды.Период ТОГДА Обороты.ПримененныеВычеты312 ИНАЧЕ 0 КОНЕЦ) КАК Вычет312ЗаМесяц
	|ИЗ
	|	(" + ПериодыТекст + ") КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ (" + Вычеты312ПоМесяцамТекст + ") КАК Обороты
	|		ПО Обороты.ФизЛицо = Периоды.Физлицо И Обороты.НалоговыйПериод = ГОД(Периоды.Период) И Обороты.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, Год) И Периоды.Период   
	|
	|СГРУППИРОВАТЬ ПО
	|	Периоды.Физлицо,
	
	|	Периоды.Период";
	
	Вычеты311Текст = 
	"ВЫБРАТЬ
	|	Периоды.Физлицо КАК Физлицо,
	|	Периоды.Период КАК Период,
	|	СУММА(Обороты.Вычет311Остаток) КАК Вычет311Остаток,
	|	СУММА(Обороты.ПримененныеВычеты311) КАК Вычет311ЗаГод,
	|	СУММА(ВЫБОР КОГДА НАЧАЛОПЕРИОДА(Обороты.Период, МЕСЯЦ) = Периоды.Период ТОГДА Обороты.ПримененныеВычеты311 ИНАЧЕ 0 КОНЕЦ) КАК Вычет311ЗаМесяц
	|ИЗ
	|	(" + ПериодыТекст + ") КАК Периоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ (" + Вычеты311ПоМесяцамТекст + ") КАК Обороты
	|		ПО Обороты.ФизЛицо = Периоды.Физлицо И Обороты.НалоговыйПериод = ГОД(Периоды.Период) И Обороты.Период МЕЖДУ НАЧАЛОПЕРИОДА(Периоды.Период, Год) И Периоды.Период 
	|
	|СГРУППИРОВАТЬ ПО
	|	Периоды.Физлицо,
	|	Периоды.Период";
	
	ПрогнозНДФЛТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	РаботникиОргВычетыЗаГод.Физлицо,
	|	РаботникиОргВычетыЗаГод.Период,
	|	РаботникиОргВычетыЗаГод.ВычетыЛичныеДоТекПериода КАК ВычетыЛичныеДоТекПериода,
	|	РаботникиОргВычетыЗаГод.ВычетыДетскиеДоТекПериода КАК ВычетыДетскиеДоТекПериода,
	|	РаботникиОргВычетыЗаГод.ВычетыДетскиеИнвалидовДоТекПериода КАК ВычетыДетскиеИнвалидовДоТекПериода,
	|	РаботникиОргВычетыЗаГод.ВычетыЛичные КАК ВычетыЛичные,
	|	РаботникиОргВычетыЗаГод.ВычетыДетские КАК ВычетыДетские,
	|	РаботникиОргВычетыЗаГод.ВычетыДетскиеИнвалидов КАК ВычетыДетскиеИнвалидов,
	|	РаботникиОргВычетыЗаГод.ОграничениеПоДоходамЛичные КАК ОграничениеПоДоходамЛичные,
	|	РаботникиОргВычетыЗаГод.ОграничениеПоДоходамНаДетей КАК ОграничениеПоДоходамНаДетей,
	|	РаботникиОргВычетыЗаГод.ОграничениеПоДоходамНаДетейИнвалидов КАК ОграничениеПоДоходамНаДетейИнвалидов,
	|	НДФЛРасчетыСБюджетомЗаГод.ИсчисленныйНалогДоТекПериода КАК ИсчисленныйНалогДоТекПериода,
	|	ДоходыЗаГод.ОблагаемыйДоходЗаГод КАК ОблагаемыйДоходЗаГод,
	|	ДоходыЗаГод.Резидент КАК Резидент,
	|   Вычеты312.Вычет312Остаток КАК Вычет312Остаток,
	|   Вычеты311.Вычет311Остаток КАК Вычет311Остаток
	|ИЗ
	|	("+ПрименяемыеВычетыЗаГодТекст+") КАК РаботникиОргВычетыЗаГод
	|		ЛЕВОЕ СОЕДИНЕНИЕ ("+НДФЛРасчетыСБюджетомЗаГодТекст+") КАК НДФЛРасчетыСБюджетомЗаГод
	|		ПО НДФЛРасчетыСБюджетомЗаГод.Период = РаботникиОргВычетыЗаГод.Период И НДФЛРасчетыСБюджетомЗаГод.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ДоходыЗаГодТекст+") КАК ДоходыЗаГод
	|		ПО ДоходыЗаГод.Период = РаботникиОргВычетыЗаГод.Период И ДоходыЗаГод.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты312Текст+") КАК Вычеты312
	|		ПО Вычеты312.Период = РаботникиОргВычетыЗаГод.Период И Вычеты312.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ("+Вычеты311Текст+") КАК Вычеты311
	|		ПО Вычеты311.Период = РаботникиОргВычетыЗаГод.Период И Вычеты311.ФизЛицо = РаботникиОргВычетыЗаГод.Физлицо
	|
	|	ГДЕ
	|		РаботникиОргВычетыЗаГод.Период >= &парамПериодРегистрации";
	
	Запрос.Текст = ПрогнозНДФЛТекст;
	
	Возврат Запрос.Выполнить().Выбрать();
	
КонецФункции

// создание структуры - строки прогноза НДФЛ
// используется в РассчитатьЗаписьРегистраРасчета для формирования сведений для расчета доначислений
Функция СоздатьСтрокуПрогнозаНДФЛ()
	СтрокаПрогноза = Новый Структура("
	|ИсчисленныйНалогДоТекПериода,
	|ОблагаемыйДоходЗаГод,
	|Резидент,
	|ВычетыЛичныеДоТекПериода,
	|ВычетыДетскиеДоТекПериода,
	|ВычетыДетскиеИнвалидовДоТекПериода,
	|ВычетыЛичные,
	|ВычетыДетские,
	|ВычетыДетскиеИнвалидов,
	|ОграничениеПоДоходамЛичные,
	|ОграничениеПоДоходамНаДетей,
	|ОграничениеПоДоходамНаДетейИнвалидов,
	|Вычет312Остаток,
	|Вычет311Остаток,
	|НачисленоДоДоначисления,
	|НачисленоПриДоначислении,
	|НачисленоПослеДоначисления", 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
	Возврат СтрокаПрогноза;
	
КонецФункции

// заполнение структуры - строки прогноза НДФЛ по данным из выборки по результату запроса
// 
// Парамтеры: 
// СтрокаПрогноза - структура 
// ДанныеДляПрогнозаНДФЛ - спозиционированная выборка по результатам запроса
//
Процедура ЗаполнитьСтрокуПрогнозаНДФЛ(СтрокаПрогноза, ДанныеДляПрогнозаНДФЛ)
	СтрокаПрогноза.ИсчисленныйНалогДоТекПериода = ?(ДанныеДляПрогнозаНДФЛ.ИсчисленныйНалогДоТекПериода = Null, 0, ДанныеДляПрогнозаНДФЛ.ИсчисленныйНалогДоТекПериода);
	СтрокаПрогноза.ОблагаемыйДоходЗаГод = ?(ДанныеДляПрогнозаНДФЛ.ОблагаемыйДоходЗаГод = Null, 0, ДанныеДляПрогнозаНДФЛ.ОблагаемыйДоходЗаГод);
	СтрокаПрогноза.ВычетыЛичныеДоТекПериода = ?(ДанныеДляПрогнозаНДФЛ.ВычетыЛичныеДоТекПериода = Null, 0, ДанныеДляПрогнозаНДФЛ.ВычетыЛичныеДоТекПериода);
	СтрокаПрогноза.ВычетыДетскиеДоТекПериода = ?(ДанныеДляПрогнозаНДФЛ.ВычетыДетскиеДоТекПериода = Null, 0, ДанныеДляПрогнозаНДФЛ.ВычетыДетскиеДоТекПериода);
	СтрокаПрогноза.ВычетыДетскиеИнвалидовДоТекПериода = ?(ДанныеДляПрогнозаНДФЛ.ВычетыДетскиеИнвалидовДоТекПериода = Null, 0, ДанныеДляПрогнозаНДФЛ.ВычетыДетскиеИнвалидовДоТекПериода);
	СтрокаПрогноза.ВычетыЛичные = ?(ДанныеДляПрогнозаНДФЛ.ВычетыЛичные = Null, 0, ДанныеДляПрогнозаНДФЛ.ВычетыЛичные);
	СтрокаПрогноза.ВычетыДетские = ?(ДанныеДляПрогнозаНДФЛ.ВычетыДетские = Null, 0, ДанныеДляПрогнозаНДФЛ.ВычетыДетские);
	СтрокаПрогноза.ВычетыДетскиеИнвалидов = ?(ДанныеДляПрогнозаНДФЛ.ВычетыДетскиеИнвалидов = Null, 0, ДанныеДляПрогнозаНДФЛ.ВычетыДетскиеИнвалидов);
	СтрокаПрогноза.ОграничениеПоДоходамЛичные = ?(ДанныеДляПрогнозаНДФЛ.ОграничениеПоДоходамЛичные = Null, 0, ДанныеДляПрогнозаНДФЛ.ОграничениеПоДоходамЛичные);
	СтрокаПрогноза.ОграничениеПоДоходамНаДетей = ?(ДанныеДляПрогнозаНДФЛ.ОграничениеПоДоходамНаДетей = Null, 0, ДанныеДляПрогнозаНДФЛ.ОграничениеПоДоходамНаДетей);
	СтрокаПрогноза.ОграничениеПоДоходамНаДетейИнвалидов = ?(ДанныеДляПрогнозаНДФЛ.ОграничениеПоДоходамНаДетейИнвалидов = Null, 0, ДанныеДляПрогнозаНДФЛ.ОграничениеПоДоходамНаДетейИнвалидов);
	СтрокаПрогноза.Вычет312Остаток = ?(ДанныеДляПрогнозаНДФЛ.Вычет312Остаток = Null, 0, ДанныеДляПрогнозаНДФЛ.Вычет312Остаток);
	СтрокаПрогноза.Вычет311Остаток = ?(ДанныеДляПрогнозаНДФЛ.Вычет311Остаток = Null, 0, ДанныеДляПрогнозаНДФЛ.Вычет311Остаток);
	
КонецПроцедуры

// позиционирование по физлицу выборки с данными для прогноза НДФЛ 
// Параметры:
//  ДанныеДляПрогнозаНДФЛ - выборка
//  Физлицо
//
Функция ПозиционироватьДанныеПрогнозаНДФЛ(ДанныеДляПрогнозаНДФЛ, Физлицо)
	СтруктураПоиска = Новый Структура("Физлицо");
	СтруктураПоиска.Физлицо = Физлицо;
	Если ДанныеДляПрогнозаНДФЛ.НайтиСледующий(СтруктураПоиска) Тогда
		Возврат Истина;
	Иначе
		ДанныеДляПрогнозаНДФЛ.Сбросить();
		Если ДанныеДляПрогнозаНДФЛ.НайтиСледующий(СтруктураПоиска) Тогда
			Возврат Истина;
		КонецЕсли;
	КонецЕсли;
	Возврат Ложь;
КонецФункции

// проверка того, что способ расчета относится к договорам
Функция ЭтоДоговор(СпособРасчета) Экспорт
	Возврат СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой; 
КонецФункции

// проверка того, что показатель схемы мотивации является предопределенным показателем 
// не требующим ввода (т.е. рассчитываемым автоматически)
Функция ЭтоПоказательСАвторасчетом(Показатель) Экспорт
	Возврат     Показатель = Справочники.ПоказателиСхемМотивации.ВремяВДнях 
	или Показатель = Справочники.ПоказателиСхемМотивации.ВремяВЧасах
	или Показатель = Справочники.ПоказателиСхемМотивации.НормаВремениВДнях
	или Показатель = Справочники.ПоказателиСхемМотивации.НормаВремениВЧасах
	или Показатель = Справочники.ПоказателиСхемМотивации.СдельнаяВыработка
	или Показатель = Справочники.ПоказателиСхемМотивации.РасчетнаяБаза			
	или Показатель = Справочники.ПоказателиСхемМотивации.Стаж			
	или Показатель = Справочники.ПоказателиСхемМотивации.Нуль;
	
КонецФункции

////////////////////////////////////////////////////////////////////////////////
// РАБОТА СО СТАЖЕМ
// 

// проверка того, что способ расчета относится к расчетам от стажа по тарифным ставкам
Функция ЭтоРасчетОтСтажаПоТарифу(СпособРасчета) Экспорт
	Возврат СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке
	//толик
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом;
КонецФункции

// проверка того, что способ расчета относится к расчетам от стажа
Функция ЭтоРасчетОтСтажа(СпособРасчета) Экспорт
	Возврат СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке 
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом
	//толик
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС
	или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом;
КонецФункции

// Проверяет является ли способ расчета тем способом, которому требуется 
// информация о проценте надбавки за северный стаж
//
// Параметры:
//  СпособРасчета - ПеречислениеСсылка.СпособыРасчетаОплатыТруда
//
Функция ЭтоРасчетСеверныхНадбавок(СпособРасчета) Экспорт
	Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка Тогда
		Возврат Истина;
	КонецЕсли;
	Возврат Ложь;
КонецФункции

// ПолучитьПроцентыСевернойНадбавкиЗаПериод
// Предназначена для получения информации о процентах северной надбавки и датах начала их действия 
// за определенный период
// Параметры:
//  ДатаРегистрации - дата регистрации записи о стаже
//  ПорядокНачисления - порядок начисления северной надбавки - ПеречислениеСсылка.ПорядокНачисленияСеверныхНадбавок
//  НачальныйПроцент - процент на дату ДатаРегистрации
//  Месяцев - количество месяцев стажа на дату ДатаРегистрации
//  Дней - количество дней стажа на дату ДатаРегистрации
//  ДатаНачала - начало периода, в котором мы получаем сведения о процентах надбавки
//  ДатаОкончания - конец периода, в котором мы получаем сведения о процентах надбавки
//
// Возвращаемое значение:
//  Массив структур вида "Период, Процент"
//
Функция ПолучитьПроцентыСевернойНадбавкиЗаПериод(ДатаРегистрации, ПорядокНачисления, 
	НачальныйПроцент, Месяцев, Дней, ДатаНачала, ДатаОкончания) Экспорт
	
	мДлинаДня = 60*60*24;
	ВозврМассив = Новый Массив;
	
	// в общем случае шкала может состоять из двух участков
	РазмерПериода1 = 0;
	РазмерПрироста1 = 0;
	Ограничение1 = 0;
	РазмерПериода2 = 0;
	РазмерПрироста2 = 0;
	Ограничение2 = 0;
	Если      ПорядокНачисления = Перечисления.ПорядокНачисленияСеверныхНадбавок.Группа1Льготная Тогда
		РазмерПериода1 = 6;
		РазмерПрироста1 = 20;
		Ограничение1 = 60;
		РазмерПериода2 = 6;
		РазмерПрироста2 = 10;
		Ограничение2 = 100;
	ИначеЕсли ПорядокНачисления = Перечисления.ПорядокНачисленияСеверныхНадбавок.Группа1Обычная Тогда
		РазмерПериода1 = 6;
		РазмерПрироста1 = 10;
		Ограничение1 = 100;
	ИначеЕсли ПорядокНачисления = Перечисления.ПорядокНачисленияСеверныхНадбавок.Группа2Льготная Тогда
		РазмерПериода1 = 6;
		РазмерПрироста1 = 20;
		Ограничение1 = 60;
		РазмерПериода2 = 12;
		РазмерПрироста2 = 20;
		Ограничение2 = 80;
	ИначеЕсли ПорядокНачисления = Перечисления.ПорядокНачисленияСеверныхНадбавок.Группа2Обычная Тогда
		РазмерПериода1 = 6;
		РазмерПрироста1 = 10;
		Ограничение1 = 60;
		РазмерПериода2 = 12;
		РазмерПрироста2 = 10;
		Ограничение2 = 80;
	ИначеЕсли ПорядокНачисления = Перечисления.ПорядокНачисленияСеверныхНадбавок.Группа3Льготная Тогда
		РазмерПериода1 = 6;
		РазмерПрироста1 = 10;
		Ограничение1 = 50;
	ИначеЕсли ПорядокНачисления = Перечисления.ПорядокНачисленияСеверныхНадбавок.Группа3Обычная Тогда
		РазмерПериода1 = 12;
		РазмерПрироста1 = 10;
		Ограничение1 = 50;
	ИначеЕсли ПорядокНачисления = Перечисления.ПорядокНачисленияСеверныхНадбавок.Группа4Льготная Тогда
		РазмерПериода1 = 6;
		РазмерПрироста1 = 10;
		Ограничение1 = 30;
	ИначеЕсли ПорядокНачисления = Перечисления.ПорядокНачисленияСеверныхНадбавок.Группа4Обычная Тогда
		РазмерПериода1 = 12;
		РазмерПрироста1 = 10;
		Ограничение1 = 10;
		РазмерПериода2 = 24;
		РазмерПрироста2 = 10;
		Ограничение2 = 30;
	Иначе // порядок не указан
		Элемент = Новый Структура("Период, Процент", ДатаНачала, 0);
		ВозврМассив.Добавить(Элемент);
		Возврат ВозврМассив;
	КонецЕсли;
	
	ДатаОтсчета = ДатаРегистрации - Дней * мДлинаДня;
	ПрошлоМесяцевПослеДатыОтсчета = (Год(ДатаНачала) - Год(ДатаОтсчета)) * 12 + Месяц(ДатаНачала) - Месяц(ДатаОтсчета) -
	?(День(ДатаНачала) >= День(ДатаОтсчета), 0, 1);
	ПрошлоМесяцев = (Год(ДатаНачала) - Год(ДатаОтсчета)) * 12 + Месяц(ДатаНачала) - Месяц(ДатаОтсчета) -
	?(День(ДатаНачала) >= День(ДатаОтсчета), 0, 1) + Месяцев;
	Если РазмерПериода2 = 0 Тогда    
		// у шкалы только один участок
		ПрошлоПериодов = Цел(ПрошлоМесяцев / РазмерПериода1);
		ОстатокМесяцев = ПрошлоМесяцев - ПрошлоПериодов * РазмерПериода1;
		Процент = Мин(НачальныйПроцент + ПрошлоПериодов * РазмерПрироста1, Ограничение1);
		Элемент = Новый Структура("Период, Процент", ДатаНачала, Процент);
		ВозврМассив.Добавить(Элемент);
		ДатаСменыПроцента = ДобавитьМесяц(ДатаОтсчета, ПрошлоМесяцевПослеДатыОтсчета + РазмерПериода1 - ОстатокМесяцев);
		Пока ДатаСменыПроцента < ДатаОкончания Цикл
			Процент = Мин(Процент + РазмерПрироста1, Ограничение1);
			Элемент = Новый Структура("Период, Процент", ДатаСменыПроцента, Процент);
			ВозврМассив.Добавить(Элемент);
			Если Процент = Ограничение1 Тогда
				Прервать;
			КонецЕсли;
			ДатаСменыПроцента = ДобавитьМесяц(ДатаСменыПроцента, РазмерПериода1);
		КонецЦикла;
	ИначеЕсли НачальныйПроцент >= Ограничение1 Тогда
		// используем уже второй участок шкалы
		ПрошлоПериодов = Цел(ПрошлоМесяцев / РазмерПериода2);
		Процент = Мин(НачальныйПроцент + ПрошлоПериодов * РазмерПрироста2, Ограничение2);
		Элемент = Новый Структура("Период, Процент", ДатаНачала, Процент);
		ВозврМассив.Добавить(Элемент);
		ДатаСменыПроцента = ДобавитьМесяц(ДатаОтсчета, (ПрошлоПериодов + 1) * РазмерПериода2);
		Пока ДатаСменыПроцента < ДатаОкончания Цикл
			Процент = Мин(Процент + РазмерПрироста2, Ограничение2);
			Элемент = Новый Структура("Период, Процент", ДатаСменыПроцента, Процент);
			ВозврМассив.Добавить(Элемент);
			Если Процент = Ограничение2 Тогда
				Прервать;
			КонецЕсли;
			ДатаСменыПроцента = ДобавитьМесяц(ДатаСменыПроцента, РазмерПериода1);
		КонецЦикла;
	Иначе
		// два участка у шкалы
		ДатаСменыПроцента = ДобавитьМесяц(ДатаОтсчета, - Месяцев);
		Процент = НачальныйПроцент;
		РазмерПрироста = РазмерПрироста1;
		РазмерПериода = РазмерПериода1;
		Ограничение = Ограничение1;
		Если ДатаСменыПроцента >= ДатаНачала И ДатаСменыПроцента <= ДатаОкончания Тогда
			Элемент = Новый Структура("Период, Процент", ДатаНачала, Макс(Процент - РазмерПрироста,0));
			ВозврМассив.Добавить(Элемент);
			Элемент = Новый Структура("Период, Процент", ДатаСменыПроцента, НачальныйПроцент);
			ВозврМассив.Добавить(Элемент);
		Иначе
			Пока ДатаСменыПроцента < ДатаОкончания Цикл
				Если ДатаСменыПроцента = ДатаНачала Тогда
					Элемент = Новый Структура("Период, Процент", ДатаСменыПроцента, Процент);
					ВозврМассив.Добавить(Элемент);
					Прервать;
				ИначеЕсли ДатаСменыПроцента > ДатаНачала Тогда
					Элемент = Новый Структура("Период, Процент", ДатаНачала, Макс(Процент - РазмерПрироста,НачальныйПроцент));
					ВозврМассив.Добавить(Элемент);
					Элемент = Новый Структура("Период, Процент", ДатаСменыПроцента, Процент);
					ВозврМассив.Добавить(Элемент);
					Прервать;
				КонецЕсли;
				Процент = Процент + РазмерПрироста;
				Если Процент > Ограничение Тогда
					Если Процент > Ограничение2 Тогда 
						Процент = Ограничение2;
						Прервать;
					Иначе
						// если уже перешли на второй участок...
						// сначала отменим увеличение процента
						Процент = Процент - РазмерПрироста;
						// сменим параметры участка шкалы
						РазмерПрироста = РазмерПрироста2;
						РазмерПериода = РазмерПериода2;
						Ограничение = Ограничение2;
						// установим процент с использованием новых параметров
						Процент = Процент + РазмерПрироста;
					КонецЕсли;
				КонецЕсли;
				ДатаСменыПроцента = ДобавитьМесяц(ДатаСменыПроцента, РазмерПериода);
				Если ДатаСменыПроцента > ДатаОкончания Тогда
					// если это уже за пределами периода - отменим увеличение процента
					Процент = Процент - РазмерПрироста;
					Прервать;
				КонецЕсли;
			КонецЦикла;
			// если так ничего и не добавили - вернем последнее значение процента на дату начала периода
			Если ВозврМассив.Количество() = 0 Тогда
				Элемент = Новый Структура("Период, Процент", ДатаНачала, Процент);
				ВозврМассив.Добавить(Элемент);
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
	Возврат ВозврМассив;
	
КонецФункции

// Функция выбирает стажи по физлицу из ТЧ "Стажи" справочника "Физические лица"
//
// Параметры
//  Физлицо		– СправочникСсылка.ФизическиеЛица – работник, которому вычисляется стаж
//  ДопУсловие	– Строка – строка дополнительного условия в запрос
//  ВидСтажа	– СправочникСсылка.ВидыСтажа - значение параметра для дополнительного условия
//
// Возвращаемое значение:
//   ВыборкаИзРезультатаЗапроса   – выборка со стажами работника
//
Функция ВыбратьСтажиРаботника(Физлицо, ДопУсловие = Неопределено, ВидСтажа = Неопределено) Экспорт
	
	Запрос = Новый Запрос;
	ТекстЗапроса = 
	
	"ВЫБРАТЬ ПЕРВЫЕ 4
	|	ФизическиеЛицаСтажи.ВидСтажа,
	|	ФизическиеЛицаСтажи.ВидСтажа.Наименование КАК Наименование,
	|	ФизическиеЛицаСтажи.ДатаОтсчета,
	|	ФизическиеЛицаСтажи.РазмерМесяцев,
	|	ФизическиеЛицаСтажи.РазмерДней
	|ИЗ
	|	Справочник.ФизическиеЛица.Стажи КАК ФизическиеЛицаСтажи
	|ГДЕ
	|	ФизическиеЛицаСтажи.Ссылка = &Физлицо";
	
	Если ДопУсловие <> Неопределено Тогда
		
		ТекстЗапроса = ТекстЗапроса + " " + ДопУсловие;
		
		Если ВидСтажа <> Неопределено Тогда
			
			Запрос.УстановитьПараметр("ВидСтажа", ВидСтажа);
			
		КонецЕсли; 
		
	КонецЕсли; 
	
	Запрос.Текст = ТекстЗапроса;
	Запрос.УстановитьПараметр("Физлицо", Физлицо);
	
	Возврат Запрос.Выполнить().Выбрать()
	
КонецФункции // ВыбратьСтажиРаботника()

// Функция определяет процента оплаты БЛ в зависимости от стажа работника
//
// Параметры: 
//  Дата - Дата, обычно текущая дата
//  ДатаНачала - Дата, дата на которую формируется стаж - дата начала события
//  Физлицо - Справочник.ФизическиеЛица, физ. лицо для которого определяется стаж
//  Организация - Справочник.Организации, организация (головная), где работает физлицо.
//
// Возвращаемое значение:
//  число - процент оплаты Больничного листа
//
Функция ЗаполнитьПроцентОплатыОтСтажа(Дата, ДатаНачала, Физлицо, Организация) Экспорт
	
	Если ДатаНачала >= ПолучитьДатуВступленияВСилуИзмененийПоСоциальнымПособиям2006() Тогда
		
		Запрос = Новый Запрос;
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ВЫБОР
		|		КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &ДатаАктуальности
		|				И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостоянияЗавершения
		|		ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния
		|	КОНЕЦ КАК ПричинаИзмененияСостояния
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
		|		&ДатаАктуальности,
		|		Сотрудник.Физлицо = &Физлицо
		|			И Организация = &ГоловнаяОрганизация
		|			И Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)) КАК РаботникиОрганизацийСрезПоследних
		|ГДЕ
		|	ВЫБОР
		|			КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &ДатаАктуальности
		|					И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостоянияЗавершения
		|			ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния
		|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)";
		
		Запрос.Текст = ТекстЗапроса;
		Запрос.УстановитьПараметр("ДатаАктуальности",			ДатаНачала);
		Запрос.УстановитьПараметр("Физлицо",					Физлицо);
		Запрос.УстановитьПараметр("ГоловнаяОрганизация",		Организация);
		
		УжеНеРаботает = Запрос.Выполнить().Пустой(); // в рег-ре РаботникиОрганизаций нет других записей, кроме как об увольнении
		
	Иначе
		УжеНеРаботает = Ложь; // не проверяется	
	КонецЕсли;
	Если УжеНеРаботает Тогда
		Возврат 60;
	Иначе
		
		ДатаСтажа = ПолучитьНачалоСтажаДляБольничногоЛиста(ДатаНачала, Физлицо, Организация);
		Если НЕ ЗначениеЗаполнено(ДатаСтажа) Тогда
			ДатаСтажа = Дата;
		КонецЕсли;
		
		Лет	= 0;
		ОбщегоНазначения.РазобратьРазностьДат(ДатаНачала, ДатаСтажа, Лет);
		
		Возврат ?(Лет >= 8, 100,?(Лет >= 5, 80, 60));
	КонецЕсли;
	
КонецФункции

// определяет начало непрерывного стажа физлица
//
// Параметры
//  ДатаНачала - Дата, дата на которую формируется стаж
//  Физлицо - Справочник.ФизическиеЛица, физ. лицо для которого определяется стаж
//  Организация - Справочник.Организации, организация, где работает физлицо.
//
// Возвращаемое значение:
//  дата - дата начала непрерывного стажа
//
Функция ПолучитьНачалоСтажаДляБольничногоЛиста(ДатаНачала, Физлицо, Организация, ВидСтажа = Неопределено) Экспорт
	
	Если ВидСтажа = Неопределено Тогда
		ВидСтажа = ?(ДатаНачала < ПолучитьДатуВступленияВСилуИзмененийПоСоциальнымПособиям2006(),Справочники.ВидыСтажа.НепрерывныйСтаж,Справочники.ВидыСтажа.НепрерывныйСтаж); //странная проверка для РБ   Справочники.ВидыСтажа.СтраховойСтажДляБЛ на ложь
	КонецЕсли;
	
	ВыборкаПоСтажу = ВыбратьСтажиРаботника(Физлицо, "И ФизическиеЛицаСтажи.ВидСтажа = &ВидСтажа", ВидСтажа);
	Если ВыборкаПоСтажу.Следующий() Тогда
		
		ДатаСтажа = ДобавитьМесяц(ВыборкаПоСтажу.ДатаОтсчета, - ВыборкаПоСтажу.РазмерМесяцев) - ВыборкаПоСтажу.РазмерДней*86400;
		
	Иначе // стаж не введен, возьмем дату последнего приема на работу.
		
		Запрос = Новый Запрос;
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ЕСТЬNULL(МАКСИМУМ(РаботникиОрганизацийСрезПоследних.Период), ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)) КАК Период
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
		|		&ДатаАктуальности,
		|		Сотрудник.Физлицо = &Физлицо
		|			И Организация = &ГоловнаяОрганизация
		|			И Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|			И ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)) КАК РаботникиОрганизацийСрезПоследних";
		
		Запрос.Текст = ТекстЗапроса;
		Запрос.УстановитьПараметр("ДатаАктуальности",			ДатаНачала);
		Запрос.УстановитьПараметр("Физлицо",					Физлицо);
		Запрос.УстановитьПараметр("ГоловнаяОрганизация",		Организация);
		
		Выборка = Запрос.Выполнить().Выбрать();
		Если Выборка.Следующий() Тогда
			ДатаСтажа = Выборка.Период
		Иначе 
			ДатаСтажа = Дата(1,1,1)
		КонецЕсли; 
		
	КонецЕсли; 
	
	Возврат ДатаСтажа
	
КонецФункции // ПолучитьНачалоСтажаДляБольничногоЛиста()

////////////////////////////////////////////////////////////////////////////////
// ОБСЛУЖИВАНИЕ ПЕРЕРАСЧЕТОВ
// 

// процедура выполняет дописывание наборов записей перерасчетов основных начислений по 
// переданной выборке
// выборка должна содержать уникальные комбинации Физлицо+Регистратор (т.е. ОбъектПерерасчета)
// которых еще нет в таблице перерасчета
Процедура ДописатьПерерасчетыОсновныхНачислений(Выборка) Экспорт
	Наборы = Новый Соответствие;
	Пока Выборка.Следующий() Цикл
		Набор = Наборы[Выборка.Регистратор];
		Если Набор = Неопределено Тогда
			Набор = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетОсновныхНачислений.СоздатьНаборЗаписей();
			Набор.Отбор.ОбъектПерерасчета.Значение = Выборка.Регистратор;
			Набор.Отбор.ОбъектПерерасчета.Использование = Истина;
			Наборы.Вставить(Выборка.Регистратор, Набор);
		КонецЕсли;
		НоваяСтрока = Набор.Добавить();
		НоваяСтрока.ОбъектПерерасчета	= Выборка.Регистратор;
		НоваяСтрока.ФизЛицо				= Выборка.Физлицо;
		НоваяСтрока.Организация			= Выборка.Организация;
	КонецЦикла;
	Для Каждого ЭлементСтруктуры Из Наборы Цикл
		// дописываем набор записей по данному объекту перерасчета
		ЭлементСтруктуры.Значение.Записать(Ложь);
	КонецЦикла;
КонецПроцедуры

Процедура ОбработатьТаблицуПерерасчетов(Ссылка) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Регистратор", Ссылка);
	
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Перерасчеты.ОбъектПерерасчета КАК ОбъектПерерасчетаОсновные,
	|	ПерерасчетыДоп.ОбъектПерерасчета КАК ОбъектПерерасчетаДополнительные
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК Начисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ПерерасчетОсновныхНачислений КАК Перерасчеты
	|		ПО Начисления.СторнируемыйДокумент = Перерасчеты.ОбъектПерерасчета
	|			И Начисления.ФизЛицо = Перерасчеты.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.ПерерасчетДополнительныхНачислений КАК ПерерасчетыДоп
	|		ПО Начисления.СторнируемыйДокумент = ПерерасчетыДоп.ОбъектПерерасчета
	|			И Начисления.ФизЛицо = ПерерасчетыДоп.ФизЛицо
	|ГДЕ
	|	Начисления.Регистратор = &Регистратор
	|	И Начисления.Сторно";
	
	Запрос.Текст = ТекстЗапроса;
	
	ВыборкаОбъектПерерасчета = Запрос.Выполнить().Выбрать();
	Пока ВыборкаОбъектПерерасчета.Следующий() Цикл
		Если ЗначениеЗаполнено(ВыборкаОбъектПерерасчета.ОбъектПерерасчетаОсновные) Тогда
			НаборЗаписейПерерасчета = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетОсновныхНачислений.СоздатьНаборЗаписей();
			НаборЗаписейПерерасчета.Отбор.ОбъектПерерасчета.Значение = ВыборкаОбъектПерерасчета.ОбъектПерерасчетаОсновные;
			НаборЗаписейПерерасчета.Отбор.ОбъектПерерасчета.Использование = Истина;
			НаборЗаписейПерерасчета.Записать();	
		КонецЕсли;
		Если ЗначениеЗаполнено(ВыборкаОбъектПерерасчета.ОбъектПерерасчетаДополнительные) Тогда
			НаборЗаписейПерерасчета = РегистрыРасчета.ДополнительныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетДополнительныхНачислений.СоздатьНаборЗаписей();
			НаборЗаписейПерерасчета.Отбор.ОбъектПерерасчета.Значение = ВыборкаОбъектПерерасчета.ОбъектПерерасчетаДополнительные;
			НаборЗаписейПерерасчета.Отбор.ОбъектПерерасчета.Использование = Истина;
			НаборЗаписейПерерасчета.Записать();	
		КонецЕсли;
	КонецЦикла;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Перерасчеты.ОбъектПерерасчета КАК ОбъектПерерасчетаОсновные,
	|	ПерерасчетыДоп.ОбъектПерерасчета КАК ОбъектПерерасчетаДополнительные
	|ИЗ
	|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК Начисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ПерерасчетОсновныхНачислений КАК Перерасчеты
	|		ПО Начисления.СторнируемыйДокумент = Перерасчеты.ОбъектПерерасчета
	|			И Начисления.ФизЛицо = Перерасчеты.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.ПерерасчетДополнительныхНачислений КАК ПерерасчетыДоп
	|		ПО Начисления.СторнируемыйДокумент = ПерерасчетыДоп.ОбъектПерерасчета
	|			И Начисления.ФизЛицо = ПерерасчетыДоп.ФизЛицо
	|ГДЕ
	|	Начисления.Регистратор = &Регистратор
	|	И Начисления.Сторно";
	
	Запрос.Текст = ТекстЗапроса;
	
	ВыборкаОбъектПерерасчета = Запрос.Выполнить().Выбрать();
	Пока ВыборкаОбъектПерерасчета.Следующий() Цикл
		Если ЗначениеЗаполнено(ВыборкаОбъектПерерасчета.ОбъектПерерасчетаОсновные) Тогда
			НаборЗаписейПерерасчета = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетОсновныхНачислений.СоздатьНаборЗаписей();
			НаборЗаписейПерерасчета.Отбор.ОбъектПерерасчета.Значение = ВыборкаОбъектПерерасчета.ОбъектПерерасчетаОсновные;
			НаборЗаписейПерерасчета.Отбор.ОбъектПерерасчета.Использование = Истина;
			НаборЗаписейПерерасчета.Записать();	
		КонецЕсли;
		Если ЗначениеЗаполнено(ВыборкаОбъектПерерасчета.ОбъектПерерасчетаДополнительные) Тогда
			НаборЗаписейПерерасчета = РегистрыРасчета.ДополнительныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетДополнительныхНачислений.СоздатьНаборЗаписей();
			НаборЗаписейПерерасчета.Отбор.ОбъектПерерасчета.Значение = ВыборкаОбъектПерерасчета.ОбъектПерерасчетаДополнительные;
			НаборЗаписейПерерасчета.Отбор.ОбъектПерерасчета.Использование = Истина;
			НаборЗаписейПерерасчета.Записать();	
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

// Возвращает список кодов дохода, не требующих ни ввода вычетов, ни исчисления налога по ставкам 9% или 35%
//
// Параметры
//  нет
//
// Возвращаемое значение:
//  список значений, содержащий ссылки на предопределенные эл-ты спр-ка ДоходыНДФЛ 
//
Функция ПолучитьСписокКодовДоходаОсновныхНачислений() Экспорт 
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	ДоходыНДФЛ.Ссылка,
	|	ДоходыНДФЛ.Представление
	|ИЗ
	|	Справочник.ДоходыНДФЛ КАК ДоходыНДФЛ
	|ГДЕ
	|	(НЕ ДоходыНДФЛ.Ссылка В (&ЧастичноОблагаемыеДоходы))");
	//|	И ДоходыНДФЛ.СтавкаНалогообложенияРезидента = &СтавкаНалогообложенияРезидента
	
	
	СписокКодовДохода = Новый Массив;
	//РФ
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2201);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2202);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2203);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2204);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2205);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2206);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2207);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2208);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2209);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2761);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2720);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2730);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2740);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2760);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2770);
	//СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код2790);
	//Запрос.УстановитьПараметр("СтавкаНалогообложенияРезидента", Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13);
	
	//РБ
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код301);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код302);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код303);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код304);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код305);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код306);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код307);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код308);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код309);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код310);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код311);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код312);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код313);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код314);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код315);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код12117);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код12124);
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.Код12119);
	
	Запрос.УстановитьПараметр("ЧастичноОблагаемыеДоходы",СписокКодовДохода);
	
	СписокКодовДохода = Новый СписокЗначений;
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		СписокКодовДохода.Добавить(Выборка.Ссылка,Выборка.Представление);
	КонецЦикла;
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.ПустаяСсылка(),"");
	Возврат СписокКодовДохода;
	
КонецФункции // ПолучитьСписокКодовДоходаТребующихДополнительнойОбработки()

// Возвращает список кодов дохода, облагаемых по ставке 13%
//
// Параметры
//  нет
//
// Возвращаемое значение:
//  список значений, содержащий ссылки на предопределенные эл-ты спр-ка ДоходыНДФЛ 
//
Функция ПолучитьСписокКодовДоходаДополнительныхНачислений() Экспорт 
	
	СписокКодовДохода = Новый СписокЗначений;
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	ДоходыНДФЛ.Ссылка,
	|	ДоходыНДФЛ.Представление
	|ИЗ
	|	Справочник.ДоходыНДФЛ КАК ДоходыНДФЛ");
	//|ГДЕ
	//|	ДоходыНДФЛ.СтавкаНалогообложенияРезидента = &СтавкаНалогообложенияРезидента");
	//					  
	//Запрос.УстановитьПараметр("СтавкаНалогообложенияРезидента",Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13);					  
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		СписокКодовДохода.Добавить(Выборка.Ссылка,Выборка.Представление);
	КонецЦикла;
	СписокКодовДохода.Добавить(Справочники.ДоходыНДФЛ.ПустаяСсылка(),"");
	
	Возврат СписокКодовДохода
	
КонецФункции // ПолучитьСписокКодовДоходаДопНачисленийТребующихДополнительнойОбработки()

// Процедура выполняет дописывание наборов записей перерасчетов в
// регистр сведений ЗаполнениеПлановыхНачислений
//
Процедура ДописатьПерерасчетыВЗаполнениеПлановыхНачислений(Выборка) Экспорт
	
	Наборы = Новый Соответствие;
	Пока Выборка.Следующий() Цикл
		Набор = Наборы[Выборка.ОбъектЗаполнения];
		Если Набор = Неопределено Тогда
			Набор = РегистрыСведений.ЗаполнениеПлановыхНачислений.СоздатьНаборЗаписей();
			Набор.Отбор.ОбъектЗаполнения.Значение = Выборка.ОбъектЗаполнения;
			Набор.Отбор.ОбъектЗаполнения.Использование = Истина;
			Наборы.Вставить(Выборка.ОбъектЗаполнения, Набор);
		КонецЕсли;
		ЗаполнитьЗначенияСвойств(Набор.Добавить(),Выборка);
	КонецЦикла;
	
	Для Каждого ЭлементыСтруктуры Из Наборы Цикл
		ЭлементыСтруктуры.Значение.Записать(Ложь);
	КонецЦикла;
	
КонецПроцедуры // ДописатьПерерасчетыВЗаполнениеПлановыхНачислений()

// Удаляем записи перезаполнений как по самому документу, так и по исходному документу,
// если переданный документ является исправлением
//
// Параметры
//  ДокументСсылка - ссылка на документ, для которого требуется удалить записи рег-ра перезаполнений
//  
Процедура УдалитьСведенияОПерезаполненииДокумента(ДокументСсылка, СотрудникиДокумента = Неопределено, ТолькоПоИсправленнымДокументам = Ложь) Экспорт
	
	НаборПерезаполнения = РегистрыСведений.ЗаполнениеПлановыхНачислений.СоздатьНаборЗаписей();
	НаборПерезаполнения.Отбор.ОбъектЗаполнения.Использование = Истина;
	НаборПерезаполнения.Отбор.ОбъектЗаполнения.ВидСравнения = ВидСравнения.Равно;
	
	Если НаборПерезаполнения.Отбор.ОбъектЗаполнения.ТипЗначения.СодержитТип(ТипЗнч(ДокументСсылка)) Тогда
		
		НаборСотрудниковПерезаполнения = РегистрыСведений.ЗаполнениеПлановыхНачислений.СоздатьНаборЗаписей();
		НаборСотрудниковПерезаполнения.Отбор.ОбъектЗаполнения.Использование = Истина;
		НаборСотрудниковПерезаполнения.Отбор.ОбъектЗаполнения.ВидСравнения = ВидСравнения.Равно;
		
		МассивИсправленныхДокументов = Новый Массив;
		
		// проверим, является ли переданный документ чьим-нибудь исправлением
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДокументыИсправления.ПерерассчитываемыйДокумент КАК ОбъектПерерасчета
		|ИЗ
		|	Документ." + ДокументСсылка.Метаданные().Имя + " КАК ДокументыИсправления
		|ГДЕ
		|	ДокументыИсправления.Ссылка = &Исправление";
		Запрос.УстановитьПараметр("Исправление", ДокументСсылка);
		
		Выборка = Запрос.Выполнить().Выбрать();
		Выборка.Следующий();
		ОбъектПерерасчета = Выборка.ОбъектПерерасчета;
		
		Если ЗначениеЗаполнено(ОбъектПерерасчета) Тогда
			
			// выберем исправленных сотрудников - соответствующие им записи перерасчетов надо будет также удалить
			ЗапросСотрудников = Новый Запрос;
			ЗапросСотрудников.Текст =
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ЗаполнениеПлановыхНачислений.Сотрудник
			|ИЗ
			|	РегистрСведений.ЗаполнениеПлановыхНачислений КАК ЗаполнениеПлановыхНачислений
			|ГДЕ
			|	ЗаполнениеПлановыхНачислений.ОбъектЗаполнения = &ОбъектЗаполнения
			|	И (&ПоВсемСотрудникам
			|			ИЛИ ЗаполнениеПлановыхНачислений.Сотрудник В (&Сотрудники))";
			ЗапросСотрудников.УстановитьПараметр("ОбъектЗаполнения", ДокументСсылка);
			ЗапросСотрудников.УстановитьПараметр("Сотрудники", СотрудникиДокумента);
			ЗапросСотрудников.УстановитьПараметр("ПоВсемСотрудникам", СотрудникиДокумента = Неопределено);
			МассивСотрудников = ЗапросСотрудников.Выполнить().Выгрузить().ВыгрузитьКолонку("Сотрудник");
			
			// выявим все исправленные документы
			Пока ЗначениеЗаполнено(ОбъектПерерасчета) Цикл
				
				МассивИсправленныхДокументов.Добавить(ОбъектПерерасчета);
				Запрос.УстановитьПараметр("Исправление", ОбъектПерерасчета);
				Выборка = Запрос.Выполнить().Выбрать();
				Выборка.Следующий();
				ОбъектПерерасчета = Выборка.ОбъектПерерасчета;
				
			КонецЦикла;
			
		КонецЕсли;
		
		Если Не ТолькоПоИсправленнымДокументам Тогда 
			Если СотрудникиДокумента = Неопределено Тогда // удалим все записи перезаполнений по самому документу
				НаборПерезаполнения.Отбор.ОбъектЗаполнения.Значение = ДокументСсылка;
				НаборПерезаполнения.Записать(Истина);
			Иначе // удалим записи перезаполнений по переданным сотрудникам
				НаборПерезаполнения.Отбор.ОбъектЗаполнения.Значение = ДокументСсылка;
				НаборСотрудниковПерезаполнения.Отбор.ОбъектЗаполнения.Значение = ДокументСсылка;
				НаборПерезаполнения.Прочитать();
				Для каждого Запись Из НаборПерезаполнения Цикл
					Если СотрудникиДокумента.Найти(Запись.Сотрудник) = Неопределено Тогда
						ЗаполнитьЗначенияСвойств(НаборСотрудниковПерезаполнения.Добавить(),Запись);
					КонецЕсли;
				КонецЦикла;
				НаборСотрудниковПерезаполнения.Записать(Истина);
				НаборСотрудниковПерезаполнения.Очистить();
			КонецЕсли;
		КонецЕсли;
		
		// для цепочки исправленных документов удалим записи перерасчетов по исправленным 
		// в переданном документе сотрудникам
		Для каждого Значение Из МассивИсправленныхДокументов Цикл
			НаборПерезаполнения.Отбор.ОбъектЗаполнения.Значение = Значение;
			НаборСотрудниковПерезаполнения.Отбор.ОбъектЗаполнения.Значение = Значение;
			НаборПерезаполнения.Прочитать();
			Для каждого Запись Из НаборПерезаполнения Цикл
				Если МассивСотрудников.Найти(Запись.Сотрудник) = Неопределено Тогда
					ЗаполнитьЗначенияСвойств(НаборСотрудниковПерезаполнения.Добавить(),Запись);
				КонецЕсли;
			КонецЦикла;
			НаборСотрудниковПерезаполнения.Записать(Истина);
			НаборСотрудниковПерезаполнения.Очистить();
		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры

// Удаляем записи перерасчетов как по самому документу, так и по исходному документу,
// если переданный документ является исправлением
//
// Параметры
//  ДокументСсылка - ссылка на документ, для которого требуется удалить записи таблиц перерасчетов
//  
Процедура УдалитьСведенияОПерерасчетеДокумента(ДокументСсылка, ТолькоПоИсправленнымДокументам = Ложь) Экспорт
	
	ПерерасчетыПоДокументам = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетОсновныхНачислений.СоздатьНаборЗаписей();
	ПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Использование = Истина;
	ПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.ВидСравнения = ВидСравнения.Равно;
	
	ДопПерерасчетыПоДокументам = РегистрыРасчета.ДополнительныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетДополнительныхНачислений.СоздатьНаборЗаписей();
	ДопПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Использование = Истина;
	ДопПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.ВидСравнения = ВидСравнения.Равно;
	
	СредПерерасчетыПоДокументам = РегистрыРасчета.РасчетСреднегоЗаработка.Перерасчеты.ПерерасчетСреднегоЗаработка.СоздатьНаборЗаписей();
	СредПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Использование = Истина;
	СредПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.ВидСравнения = ВидСравнения.Равно;
	
	МассивИсправленныхДокументов = Новый Массив;
	ТипРегистратора = ТипЗнч(ДокументСсылка);
	Если ТипРегистратора <> Тип("ДокументСсылка.ОтпускПоУходуЗаРебенком") Тогда
		
		// проверим, является ли переданный документ чьим-нибудь исправлением
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДокументыИсправления.ПерерассчитываемыйДокумент КАК ОбъектПерерасчета
		|ИЗ
		|	Документ." + ДокументСсылка.Метаданные().Имя + " КАК ДокументыИсправления
		|ГДЕ
		|	ДокументыИсправления.Ссылка = &Исправление";
		Запрос.УстановитьПараметр("Исправление", ДокументСсылка);
		
		Выборка = Запрос.Выполнить().Выбрать();
		Выборка.Следующий();
		ОбъектПерерасчета = Выборка.ОбъектПерерасчета;
		
		Если ЗначениеЗаполнено(ОбъектПерерасчета) Тогда
			
			ПерерасчетыФизлицПоДокументам = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетОсновныхНачислений.СоздатьНаборЗаписей();
			ПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.Использование = Истина;
			ПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.ВидСравнения = ВидСравнения.Равно;
			
			ДопПерерасчетыФизлицПоДокументам = РегистрыРасчета.ДополнительныеНачисленияРаботниковОрганизаций.Перерасчеты.ПерерасчетДополнительныхНачислений.СоздатьНаборЗаписей();
			ДопПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.Использование = Истина;
			ДопПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.ВидСравнения = ВидСравнения.Равно;
			
			СредПерерасчетыФизлицПоДокументам = РегистрыРасчета.РасчетСреднегоЗаработка.Перерасчеты.ПерерасчетСреднегоЗаработка.СоздатьНаборЗаписей();
			СредПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.Использование = Истина;
			СредПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.ВидСравнения = ВидСравнения.Равно;
			
			// выберем исправленных физлиц - соответствующие им записи перерасчетов надо будет также удалить
			ЗапросФизлиц = Новый Запрос;
			ЗапросФизлиц.Текст =
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо
			|ИЗ
			|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|ГДЕ
			|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор
			|	И ДополнительныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент = &ИсходныйДокумент
			|	И ДополнительныеНачисленияРаботниковОрганизаций.Сторно
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо
			|ИЗ
			|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			|ГДЕ
			|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор
			|	И ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент = &ИсходныйДокумент
			|	И ОсновныеНачисленияРаботниковОрганизаций.Сторно
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	РасчетСреднегоЗаработка.ФизЛицо
			|ИЗ
			|	РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
			|ГДЕ
			|	РасчетСреднегоЗаработка.Регистратор = &Регистратор";
			ЗапросФизлиц.УстановитьПараметр("Регистратор", ДокументСсылка);
			ЗапросФизлиц.УстановитьПараметр("ИсходныйДокумент", ОбъектПерерасчета);
			МассивФизлиц = ЗапросФизлиц.Выполнить().Выгрузить().ВыгрузитьКолонку("ФизЛицо");
			
			// выявим все исправленные документы
			Пока ЗначениеЗаполнено(ОбъектПерерасчета) Цикл
				
				МассивИсправленныхДокументов.Добавить(ОбъектПерерасчета);
				Запрос.УстановитьПараметр("Исправление", ОбъектПерерасчета);
				Выборка = Запрос.Выполнить().Выбрать();
				Выборка.Следующий();
				ОбъектПерерасчета = Выборка.ОбъектПерерасчета;
				
			КонецЦикла;
			
		КонецЕсли;
		
	КонецЕсли;
	
	Если ПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.ТипЗначения.СодержитТип(ТипРегистратора) тогда
		
		Если Не ТолькоПоИсправленнымДокументам Тогда // удалим все записи перерасчетов по самому документу
			ПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Значение = ДокументСсылка;
			ПерерасчетыПоДокументам.Записать();
		КонецЕсли;
		
		// для цепочки исправленных документов удалим записи перерасчетов по исправленным 
		// в переданном документе сотрудникам
		Для каждого Значение Из МассивИсправленныхДокументов Цикл
			ПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Значение = Значение;
			ПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.Значение = Значение;
			ПерерасчетыПоДокументам.Прочитать();
			Для каждого Запись Из ПерерасчетыПоДокументам Цикл
				Если МассивФизлиц.Найти(Запись.ФизЛицо) = Неопределено Тогда
					ЗаполнитьЗначенияСвойств(ПерерасчетыФизлицПоДокументам.Добавить(),Запись);
				КонецЕсли;
			КонецЦикла;
			ПерерасчетыФизлицПоДокументам.Записать();
			ПерерасчетыФизлицПоДокументам.Очистить();
		КонецЦикла;
		
	КонецЕсли;
	Если ДопПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.ТипЗначения.СодержитТип(ТипРегистратора) тогда
		
		Если Не ТолькоПоИсправленнымДокументам Тогда // удалим все записи перерасчетов по самому документу
			ДопПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Значение = ДокументСсылка;
			ДопПерерасчетыПоДокументам.Записать();
		КонецЕсли;
		
		// для цепочки исправленных документов удалим записи перерасчетов по исправленным 
		// в переданном документе сотрудникам
		Для каждого Значение Из МассивИсправленныхДокументов Цикл
			ДопПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Значение = Значение;
			ДопПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.Значение = Значение;
			ДопПерерасчетыПоДокументам.Прочитать();
			Для каждого Запись Из ДопПерерасчетыПоДокументам Цикл
				Если МассивФизлиц.Найти(Запись.ФизЛицо) = Неопределено Тогда
					ЗаполнитьЗначенияСвойств(ДопПерерасчетыФизлицПоДокументам.Добавить(),Запись);
				КонецЕсли;
			КонецЦикла;
			ДопПерерасчетыФизлицПоДокументам.Записать();
			ДопПерерасчетыФизлицПоДокументам.Очистить();
		КонецЦикла;
	КонецЕсли;
	Если СредПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.ТипЗначения.СодержитТип(ТипРегистратора) тогда
		
		Если Не ТолькоПоИсправленнымДокументам Тогда // удалим все записи перерасчетов по самому документу
			СредПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Значение = ДокументСсылка;
			СредПерерасчетыПоДокументам.Записать();
		КонецЕсли;
		
		// для цепочки исправленных документов удалим записи перерасчетов по исправленным 
		// в переданном документе сотрудникам
		Для каждого Значение Из МассивИсправленныхДокументов Цикл
			СредПерерасчетыПоДокументам.Отбор.ОбъектПерерасчета.Значение = Значение;
			СредПерерасчетыФизлицПоДокументам.Отбор.ОбъектПерерасчета.Значение = Значение;
			СредПерерасчетыПоДокументам.Прочитать();
			Для каждого Запись Из СредПерерасчетыПоДокументам Цикл
				Если МассивФизлиц.Найти(Запись.ФизЛицо) = Неопределено Тогда
					ЗаполнитьЗначенияСвойств(СредПерерасчетыФизлицПоДокументам.Добавить(),Запись);
				КонецЕсли;
			КонецЦикла;
			СредПерерасчетыФизлицПоДокументам.Записать();
			СредПерерасчетыФизлицПоДокументам.Очистить();
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры

// Обрабатывает и возвращает таблицу сторно записей, добавляя колонку СторнируемыйДокумент
//
// Параметры
//  ТаблицаСторноЗаписей  – <Таблица значений> – таблица сторно записей
//
// Возвращаемое значение:
//   <Таблица значений>   – таблица сторно записей в которую добавлена колонка СторнируемыйДокумент
//
Функция ПолучитьТаблицуСторноЗаписей(ТаблицаСторноЗаписей) Экспорт
	
	Если ТаблицаСторноЗаписей.Количество() = 0 Тогда
		Возврат ТаблицаСторноЗаписей;
	КонецЕсли;	
	
	МенеджерВТ = Новый МенеджерВременныхТаблиц;
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ТаблицаСторноЗаписей.Сотрудник КАК Сотрудник,
	|	ТаблицаСторноЗаписей.ВидРасчета КАК ВидРасчета,
	|	ТаблицаСторноЗаписей.ПериодРегистрации КАК ПериодРегистрации,
	|	ТаблицаСторноЗаписей.ПериодРегистрацииСторно,
	|	ТаблицаСторноЗаписей.ПериодДействияНачало КАК ПериодДействияНачало,
	|	ТаблицаСторноЗаписей.ПериодДействияКонец КАК ПериодДействияКонец,
	|	ТаблицаСторноЗаписей.ПериодДействияНачалоСторно,
	|	ТаблицаСторноЗаписей.ПериодДействияКонецСторно,
	|	ТаблицаСторноЗаписей.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|	ТаблицаСторноЗаписей.БазовыйПериодНачало,
	|	ТаблицаСторноЗаписей.БазовыйПериодКонец,
	|	ТаблицаСторноЗаписей.ФизЛицо,
	|	ТаблицаСторноЗаписей.Организация,
	|	ТаблицаСторноЗаписей.ГрафикРаботы,
	|	ТаблицаСторноЗаписей.ГрафикРаботыНорма,
	|	ТаблицаСторноЗаписей.ВидУчетаВремени,
	|	ТаблицаСторноЗаписей.Показатель1,
	|	ТаблицаСторноЗаписей.Показатель2,
	|	ТаблицаСторноЗаписей.Показатель3,
	|	ТаблицаСторноЗаписей.Показатель4,
	|	ТаблицаСторноЗаписей.Показатель5,
	|	ТаблицаСторноЗаписей.Показатель6,
	|	ТаблицаСторноЗаписей.ПодразделениеОрганизации,
	|	ТаблицаСторноЗаписей.ОбособленноеПодразделение,
	|	ТаблицаСторноЗаписей.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ТаблицаСторноЗаписей.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ТаблицаСторноЗаписей.Авторасчет,
	|	ТаблицаСторноЗаписей.ДополнительныеДанные,
	|	ТаблицаСторноЗаписей.ВариантАлгоритмаРасчета
	|ПОМЕСТИТЬ ВТ_ТаблицаСторноЗаписей
	|ИЗ
	|	&ТаблицаСторноЗаписей КАК ТаблицаСторноЗаписей
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	ВидРасчета,
	|	ПериодРегистрации,
	|	ПериодДействияНачало,
	|	ПериодДействияКонец,
	|	ДатаНачалаСобытия";
	
	Запрос.УстановитьПараметр("ТаблицаСторноЗаписей", ТаблицаСторноЗаписей);
	Запрос.Текст = ТекстЗапроса;
	Запрос.Выполнить();
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ОсновныеНачисления.Регистратор КАК СторнируемыйДокумент,
	|	ТаблицаСторноЗаписей.Сотрудник,
	|	ТаблицаСторноЗаписей.ВидРасчета КАК ВидРасчета,
	|	ТаблицаСторноЗаписей.ПериодРегистрации,
	|	ТаблицаСторноЗаписей.ПериодРегистрацииСторно,
	|	ТаблицаСторноЗаписей.ПериодДействияНачало КАК ПериодДействияНачало,
	|	ТаблицаСторноЗаписей.ПериодДействияКонец,
	|	ТаблицаСторноЗаписей.ПериодДействияНачалоСторно,
	|	ТаблицаСторноЗаписей.ПериодДействияКонецСторно,
	|	ТаблицаСторноЗаписей.ДатаНачалаСобытия,
	|	ТаблицаСторноЗаписей.БазовыйПериодНачало,
	|	ТаблицаСторноЗаписей.БазовыйПериодКонец,
	|	ТаблицаСторноЗаписей.ФизЛицо,
	|	ТаблицаСторноЗаписей.Организация,
	|	ТаблицаСторноЗаписей.ГрафикРаботы,
	|	ТаблицаСторноЗаписей.ГрафикРаботыНорма,
	|	ТаблицаСторноЗаписей.ВидУчетаВремени,
	|	ТаблицаСторноЗаписей.Показатель1,
	|	ТаблицаСторноЗаписей.Показатель2,
	|	ТаблицаСторноЗаписей.Показатель3,
	|	ТаблицаСторноЗаписей.Показатель4,
	|	ТаблицаСторноЗаписей.Показатель5,
	|	ТаблицаСторноЗаписей.Показатель6,
	|	ТаблицаСторноЗаписей.ПодразделениеОрганизации,
	|	ТаблицаСторноЗаписей.ОбособленноеПодразделение,
	|	ТаблицаСторноЗаписей.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ТаблицаСторноЗаписей.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ТаблицаСторноЗаписей.Авторасчет,
	|	ТаблицаСторноЗаписей.ДополнительныеДанные,
	|	ТаблицаСторноЗаписей.ВариантАлгоритмаРасчета
	|ИЗ
	|	ВТ_ТаблицаСторноЗаписей КАК ТаблицаСторноЗаписей
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|		ПО ТаблицаСторноЗаписей.Сотрудник = ОсновныеНачисления.Сотрудник
	|			И ТаблицаСторноЗаписей.ВидРасчета = ОсновныеНачисления.ВидРасчета
	|			И ТаблицаСторноЗаписей.ПериодРегистрации = ОсновныеНачисления.ПериодРегистрации
	|			И ТаблицаСторноЗаписей.ПериодДействияНачало = ОсновныеНачисления.ПериодДействияНачало
	|			И ТаблицаСторноЗаписей.ПериодДействияКонец = ОсновныеНачисления.ПериодДействияКонец
	|			И ТаблицаСторноЗаписей.ДатаНачалаСобытия = ОсновныеНачисления.ДатаНачалаСобытия
	|
	|УПОРЯДОЧИТЬ ПО
	|	ВидРасчета,
	|	ПериодДействияНачало
	|АВТОУПОРЯДОЧИВАНИЕ";
	
	Запрос.Текст = ТекстЗапроса;
	
	Возврат Запрос.Выполнить().Выгрузить();	
	
КонецФункции // ПолучитьТаблицуСторноЗаписей()

// Процедура формирует сторно-записи по перерассчитываемому документу
Процедура СформироватьСторноЗаписиПоПерерассчитываемомуДокументу(ПерерассчитываемыйДокумент = Неопределено, ВыборкаПоШапкеДокумента = Неопределено, НаборОсновныеНачисления = Неопределено, НаборДополнительныеНачисления = Неопределено, НаборУдержания = Неопределено) Экспорт 
	
	Если Не ЗначениеЗаполнено(ПерерассчитываемыйДокумент) Тогда // по переданному документу заведомо нет движений
		Возврат
	КонецЕсли;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ПерерассчитываемыйДокумент", ПерерассчитываемыйДокумент);
	Запрос.УстановитьПараметр("ПериодРегистрации", ВыборкаПоШапкеДокумента.ПериодРегистрации);
	Запрос.УстановитьПараметр("ДокументИсправление", ВыборкаПоШапкеДокумента.Ссылка);
	
	Если НаборОсновныеНачисления <> Неопределено Тогда // выполним запрос по основным начислениям
		//Островская Татьяна 05.12.2012 № 16
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ОсновныеНачисления.Сотрудник,
		|	ОсновныеНачисления.ВидРасчета,
		|	ОсновныеНачисления.ВидРасчета.ЗачетОтработанногоВремени КАК ЗачетОтработанногоВремени,
		|	ОсновныеНачисления.ВидРасчета.ЗачетНормыВремени КАК ЗачетНормыВремени,
		|	ОсновныеНачисления.Показатель1,
		|	ОсновныеНачисления.Показатель2,
		|	ОсновныеНачисления.Показатель3,
		|	ОсновныеНачисления.Показатель4,
		|	ОсновныеНачисления.Показатель5,
		|	ОсновныеНачисления.Показатель6,
		|	-ОсновныеНачисления.Результат - ЕСТЬNULL(СУММА(СторноНачисления.Результат), 0) КАК Результат,
		|	-ОсновныеНачисления.ОплаченоДнейЧасов - ЕСТЬNULL(СУММА(СторноНачисления.ОплаченоДнейЧасов), 0) КАК ОплаченоДнейЧасов,
		|	-ОсновныеНачисления.ОтработаноДней - ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДней), 0) КАК ОтработаноДней,
		|	-ОсновныеНачисления.ОтработаноЧасов - ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасов), 0) КАК ОтработаноЧасов,
		|	-ОсновныеНачисления.ОтработаноДнейПоПятидневке - ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДнейПоПятидневке), 0) КАК ОтработаноДнейПоПятидневке,
		|	-ОсновныеНачисления.ОтработаноЧасовПоПятидневке - ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасовПоПятидневке), 0) КАК ОтработаноЧасовПоПятидневке,
		|	-ОсновныеНачисления.НормаДней - ЕСТЬNULL(СУММА(СторноНачисления.НормаДней), 0) КАК НормаДней,
		|	-ОсновныеНачисления.НормаЧасов - ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасов), 0) КАК НормаЧасов,
		|	-ОсновныеНачисления.НормаДнейПоПятидневке - ЕСТЬNULL(СУММА(СторноНачисления.НормаДнейПоПятидневке), 0) КАК НормаДнейПоПятидневке,
		|	-ОсновныеНачисления.НормаЧасовПоПятидневке - ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасовПоПятидневке), 0) КАК НормаЧасовПоПятидневке,
		|	ОсновныеНачисления.ПодразделениеОрганизации,
		|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
		|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
		|	ОсновныеНачисления.ДополнительныеДанные,
		|	ОсновныеНачисления.ДатаНачалаСобытия,
		|	НЕОПРЕДЕЛЕНО КАК ВариантОбработкиЗаписиПриОтраженииВРеглУчете,
		|	ОсновныеНачисления.ПериодДействияНачало,
		|	ОсновныеНачисления.ПериодДействияКонец,
		|	ОсновныеНачисления.ГрафикРаботы,
		|	ОсновныеНачисления.ГрафикРаботыНорма,
		|	ОсновныеНачисления.ВидУчетаВремени,
		|	ЛОЖЬ КАК Авторасчет,
		|	ИСТИНА КАК Сторно,
		|	ОсновныеНачисления.Регистратор КАК СторнируемыйДокумент,
		|	-ОсновныеНачисления.ОплаченоДней - ЕСТЬNULL(СУММА(СторноНачисления.ОплаченоДней), 0) КАК ОплаченоДней
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК СторноНачисления
		|		ПО ОсновныеНачисления.Сотрудник = СторноНачисления.Сотрудник
		|			И ОсновныеНачисления.ВидРасчета = СторноНачисления.ВидРасчета
		|			И (СторноНачисления.ПериодДействияНачало МЕЖДУ ОсновныеНачисления.ПериодДействияНачало И ОсновныеНачисления.ПериодДействияКонец)
		|			И (СторноНачисления.ПериодДействияКонец МЕЖДУ ОсновныеНачисления.ПериодДействияНачало И ОсновныеНачисления.ПериодДействияКонец)
		|			И (СторноНачисления.ПериодРегистрации > ОсновныеНачисления.ПериодРегистрации)
		|			И (СторноНачисления.ПериодРегистрации <= &ПериодРегистрации)
		|			И (СторноНачисления.СторнируемыйДокумент = ОсновныеНачисления.Регистратор)
		|			И (СторноНачисления.Сторно)
		|			И (СторноНачисления.Регистратор <> &ДокументИсправление)
		|ГДЕ
		|	НЕ ОсновныеНачисления.Сторно
		|	И ОсновныеНачисления.Регистратор = &ПерерассчитываемыйДокумент
		|
		|СГРУППИРОВАТЬ ПО
		|	ОсновныеНачисления.Сотрудник,
		|	ОсновныеНачисления.ВидРасчета,
		|	ОсновныеНачисления.Показатель1,
		|	ОсновныеНачисления.Показатель2,
		|	ОсновныеНачисления.Показатель3,
		|	ОсновныеНачисления.Показатель4,
		|	ОсновныеНачисления.Показатель5,
		|	ОсновныеНачисления.Показатель6,
		|	ОсновныеНачисления.ПодразделениеОрганизации,
		|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
		|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
		|	ОсновныеНачисления.ДополнительныеДанные,
		|	ОсновныеНачисления.ДатаНачалаСобытия,
		|	ОсновныеНачисления.ПериодДействияНачало,
		|	ОсновныеНачисления.ПериодДействияКонец,
		|	ОсновныеНачисления.ГрафикРаботы,
		|	ОсновныеНачисления.ГрафикРаботыНорма,
		|	ОсновныеНачисления.ВидУчетаВремени,
		|	ОсновныеНачисления.Регистратор,
		|	ОсновныеНачисления.Результат,
		|	ОсновныеНачисления.НормаДней,
		|	ОсновныеНачисления.НормаЧасов,
		|	ОсновныеНачисления.НормаДнейПоПятидневке,
		|	ОсновныеНачисления.ОтработаноДней,
		|	ОсновныеНачисления.ОтработаноЧасов,
		|	ОсновныеНачисления.ОтработаноДнейПоПятидневке,
		|	ОсновныеНачисления.ОплаченоДнейЧасов,
		|	ОсновныеНачисления.ОтработаноЧасовПоПятидневке,
		|	ОсновныеНачисления.НормаЧасовПоПятидневке,
		|	ОсновныеНачисления.ВидРасчета.ЗачетОтработанногоВремени,
		|	ОсновныеНачисления.ВидРасчета.ЗачетНормыВремени,
		|	ОсновныеНачисления.ОплаченоДней";
		//Островская Татьяна 05.12.2012 № 15
		Выборка = Запрос.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			ДобавитьСтрокуОсновныхНачислений(НаборОсновныеНачисления, ВыборкаПоШапкеДокумента, Выборка);
			
		КонецЦикла;
		
	КонецЕсли;
	
	Если НаборДополнительныеНачисления <> Неопределено Тогда // выполним запрос по дополнительным начислениям
		//Островская Татьяна 15.11.2012 № 15
		если Строка(ТипЗнч(ПерерассчитываемыйДокумент)) = "Начисление отпуска работникам организаций" Тогда 
			//заявка №1921 (база заявок Кристалла) Дмитрук О.Г.
			Если (ВыборкаПоШапкеДокумента.Ссылка.КоэффициентОтпуска = 0 или ВыборкаПоШапкеДокумента.Ссылка.КоэффициентОтпуска = 1)
				ИЛИ (ВыборкаПоШапкеДокумента.Ссылка.ДнейЧасовКомпенсацииОтпуска <> 0) Тогда  //Аверсон 04.05.2021 КВВ СВФР-007553
				//заявка №1921
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	ДополнительныеНачисления.Сотрудник,
				|	ДополнительныеНачисления.ВидРасчета,
				|	ДополнительныеНачисления.Показатель1,
				|	ДополнительныеНачисления.Показатель2,
				|	ДополнительныеНачисления.Показатель3,
				|	ДополнительныеНачисления.Показатель4,
				|	ДополнительныеНачисления.Показатель5,
				|	ДополнительныеНачисления.Показатель6,
				|	-ДополнительныеНачисления.Результат КАК Результат,
				|	-ДополнительныеНачисления.ОплаченоДнейЧасов КАК ОплаченоДнейЧасов,
				|	ДополнительныеНачисления.ПодразделениеОрганизации,
				|	ДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
				|	ДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
				|	ДополнительныеНачисления.ДатаНачалаСобытия,
				|	ДополнительныеНачисления.ГрафикРаботы,
				|	ДополнительныеНачисления.ВидУчетаВремени,
				|	ЛОЖЬ КАК Авторасчет,
				|	ИСТИНА КАК Сторно,
				|	ДополнительныеНачисления.Регистратор КАК СторнируемыйДокумент,
				|	ДополнительныеНачисления.ЧислоМесяцев,
				|	ДополнительныеНачисления.БазовыйПериодНачало,
				|	ДополнительныеНачисления.БазовыйПериодКонец
				|ИЗ
				|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
				|ГДЕ
				|	(НЕ ДополнительныеНачисления.Сторно)
				|	И ДополнительныеНачисления.Регистратор = &ПерерассчитываемыйДокумент";
				// выполним запрос по дополнительным начислениям
				Выборка = Запрос.Выполнить().Выбрать();
				Пока Выборка.Следующий() Цикл
					ДобавитьСтрокуДополнительныхНачислений(НаборДополнительныеНачисления, ВыборкаПоШапкеДокумента, Выборка);
				КонецЦикла;//О.Т. 31.07.2015 № для бутб
			КонецЕсли; 
		Иначе 
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	ДополнительныеНачисления.Сотрудник,
			|	ДополнительныеНачисления.ВидРасчета,
			|	ДополнительныеНачисления.Показатель1,
			|	ДополнительныеНачисления.Показатель2,
			|	ДополнительныеНачисления.Показатель3,
			|	ДополнительныеНачисления.Показатель4,
			|	ДополнительныеНачисления.Показатель5,
			|	ДополнительныеНачисления.Показатель6,
			|	-ДополнительныеНачисления.Результат КАК Результат,
			|	-ДополнительныеНачисления.ОплаченоДнейЧасов КАК ОплаченоДнейЧасов,
			|	ДополнительныеНачисления.ПодразделениеОрганизации,
			|	ДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
			|	ДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
			|	ДополнительныеНачисления.ДатаНачалаСобытия,
			|	ДополнительныеНачисления.ГрафикРаботы,
			|	ДополнительныеНачисления.ВидУчетаВремени,
			|	ЛОЖЬ КАК Авторасчет,
			|	ИСТИНА КАК Сторно,
			|	ДополнительныеНачисления.Регистратор КАК СторнируемыйДокумент,
			|	ДополнительныеНачисления.ЧислоМесяцев,
			|	ДополнительныеНачисления.БазовыйПериодНачало,
			|	ДополнительныеНачисления.БазовыйПериодКонец
			|ИЗ
			|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
			|ГДЕ
			|	(НЕ ДополнительныеНачисления.Сторно)
			|	И ДополнительныеНачисления.Регистратор = &ПерерассчитываемыйДокумент";
			// выполним запрос по дополнительным начислениям
			Выборка = Запрос.Выполнить().Выбрать();
			Пока Выборка.Следующий() Цикл
				ДобавитьСтрокуДополнительныхНачислений(НаборДополнительныеНачисления, ВыборкаПоШапкеДокумента, Выборка);
			КонецЦикла;//О.Т. 31.07.2015 № для бутб
			
			//Островская Татьяна 15.11.2012 № 15  
		КонецЕсли;
		
		
	КонецЕсли;
	
	Если НаборУдержания <> Неопределено Тогда // выполним запрос по удержаниям
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	УдержанияРаботниковОрганизаций.Сотрудник,
		|	УдержанияРаботниковОрганизаций.ВидРасчета,
		|	УдержанияРаботниковОрганизаций.Показатель1,
		|	УдержанияРаботниковОрганизаций.Показатель2,
		|	УдержанияРаботниковОрганизаций.Показатель3,
		|	УдержанияРаботниковОрганизаций.Показатель4,
		|	УдержанияРаботниковОрганизаций.Показатель5,
		|	УдержанияРаботниковОрганизаций.Показатель6,
		|	-УдержанияРаботниковОрганизаций.Результат КАК Результат,
		|	УдержанияРаботниковОрганизаций.ПериодРасчетаСреднегоЗаработкаНачало,
		|	УдержанияРаботниковОрганизаций.ПериодРасчетаСреднегоЗаработкаОкончание,
		|	УдержанияРаботниковОрганизаций.ДатаНачалаСобытия,
		|	УдержанияРаботниковОрганизаций.ГрафикРаботы,
		|	УдержанияРаботниковОрганизаций.ВидУчетаВремени,
		|	ЛОЖЬ КАК Авторасчет,
		|	ИСТИНА КАК Сторно,
		|	УдержанияРаботниковОрганизаций.Регистратор КАК СторнируемыйДокумент,
		|	УдержанияРаботниковОрганизаций.БазовыйПериодНачало,
		|	УдержанияРаботниковОрганизаций.БазовыйПериодКонец
		|ИЗ
		|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизаций
		|ГДЕ
		|	(НЕ УдержанияРаботниковОрганизаций.Сторно)
		|	И УдержанияРаботниковОрганизаций.Регистратор = &ПерерассчитываемыйДокумент";
		
		// выполним запрос по дополнительным начислениям
		Выборка = Запрос.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			ДобавитьСтрокуУдержаний(НаборУдержания, ВыборкаПоШапкеДокумента, Выборка);
		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры // СформироватьСторноЗаписиПоПерерассчитываемомуДокументу()


// Функция получает по таблице начислений таблицу зависимых начислений
//
// Параметры
//  ТаблицаНачислений  – <Таблица значений> – таблица начислений по которым необходимо собрать зависимые начисления
//  
// Возвращаемое заначение - – <Таблица значений>
Функция ПолучитьТаблицуЗависимыхНачисленийОсновные(ТаблицаНачислений) Экспорт
	
	Если ТаблицаНачислений.Количество() = 0 Тогда
		Возврат ТаблицаНачислений;
	КонецЕсли;	
	
	МенеджерВТ = Новый МенеджерВременныхТаблиц;
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
	
	// поместим таблицу значений во временную таблицу
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ТаблицаНачислений.Сотрудник КАК Сотрудник,
	|	ТаблицаНачислений.ВидРасчета КАК ВидРасчета,
	|	ТаблицаНачислений.ПериодРегистрации КАК ПериодРегистрации,
	|	ТаблицаНачислений.ПериодДействия КАК ПериодДействия,
	|	ТаблицаНачислений.ПериодДействияНачало КАК ПериодДействияНачало,
	|	ТаблицаНачислений.ПериодДействияКонец КАК ПериодДействияКонец,
	|	ТаблицаНачислений.Сторно
	|ПОМЕСТИТЬ ВТ_ОсновныеНачисления
	|ИЗ
	|	&ТаблицаНачислений КАК ТаблицаНачислений
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	ВидРасчета,
	|	ПериодРегистрации,
	|	ПериодДействия,
	|	ПериодДействияНачало,
	|	ПериодДействияКонец";
	
	Запрос.УстановитьПараметр("ТаблицаНачислений", ТаблицаНачислений);
	Запрос.Текст = ТекстЗапроса;
	Запрос.Выполнить();
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ЗависимыеНачисления.Сотрудник,
	|	ЗависимыеНачисления.ВидРасчета КАК ВидРасчета,
	|	ЗависимыеНачисления.ПериодДействияНачало КАК ПериодДействияНачало,
	|	ЗависимыеНачисления.ПериодДействияКонец,
	|	ЗависимыеНачисления.Сторнировать,
	|	ЗависимыеНачисления.Начислить КАК Начислить,
	|	ЗависимыеНачисления.ПериодРегистрации,
	|	ЗависимыеНачисления.ПериодДействия,
	|	ЗависимыеНачисления.БазовыйПериодНачало,
	|	ЗависимыеНачисления.БазовыйПериодКонец,
	|	ЗависимыеНачисления.Сторно,
	|	ЗависимыеНачисления.ФизЛицо,
	|	ЗависимыеНачисления.Организация,
	|	ЗависимыеНачисления.ГрафикРаботы,
	|	ЗависимыеНачисления.ГрафикРаботыНорма,
	|	ЗависимыеНачисления.ВидУчетаВремени,
	|	ЗависимыеНачисления.Показатель1,
	|	ЗависимыеНачисления.Показатель2,
	|	ЗависимыеНачисления.Показатель3,
	|	ЗависимыеНачисления.Показатель4,
	|	ЗависимыеНачисления.Показатель5,
	|	ЗависимыеНачисления.Показатель6,
	|	ЗависимыеНачисления.ПодразделениеОрганизации,
	|	ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ЗависимыеНачисления.ДатаНачалаСобытия,
	|	ЗависимыеНачисления.ОбособленноеПодразделение,
	|	ЗависимыеНачисления.Авторасчет,
	|	ЗависимыеНачисления.СторнируемыйДокумент
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|		ЗависимыеНачисления.ВидРасчета КАК ВидРасчета,
	|		МИНИМУМ(ВЫБОР
	|				КОГДА ОсновныеНачисления.ПериодДействияНачало < ЗависимыеНачисления.ПериодДействияНачало
	|					ТОГДА ЗависимыеНачисления.ПериодДействияНачало
	|				ИНАЧЕ ОсновныеНачисления.ПериодДействияНачало
	|			КОНЕЦ) КАК ПериодДействияНачало,
	|		МАКСИМУМ(ВЫБОР
	|				КОГДА ОсновныеНачисления.ПериодДействияКонец > ЗависимыеНачисления.ПериодДействияКонец
	|					ТОГДА ЗависимыеНачисления.ПериодДействияКонец
	|				ИНАЧЕ ОсновныеНачисления.ПериодДействияКонец
	|			КОНЕЦ) КАК ПериодДействияКонец,
	|		СУММА(ВЫБОР
	|				КОГДА ОсновныеНачисления.Сторно
	|					ТОГДА 1
	|				ИНАЧЕ 0
	|			КОНЕЦ) КАК Сторнировать,
	|		СУММА(ВЫБОР
	|				КОГДА (НЕ ОсновныеНачисления.Сторно)
	|					ТОГДА 1
	|				ИНАЧЕ 0
	|			КОНЕЦ) КАК Начислить,
	|		ОсновныеНачисления.ПериодРегистрации КАК ПериодРегистрации,
	|		ОсновныеНачисления.ПериодДействия КАК ПериодДействия,
	|		ЗависимыеНачисления.БазовыйПериодНачало КАК БазовыйПериодНачало,
	|		ЗависимыеНачисления.БазовыйПериодКонец КАК БазовыйПериодКонец,
	|		ЗависимыеНачисления.Сторно КАК Сторно,
	|		ЗависимыеНачисления.ФизЛицо КАК ФизЛицо,
	|		ЗависимыеНачисления.Организация КАК Организация,
	|		ЗависимыеНачисления.ГрафикРаботы КАК ГрафикРаботы,
	|		ЗависимыеНачисления.ГрафикРаботыНорма КАК ГрафикРаботыНорма,
	|		ЗависимыеНачисления.ВидУчетаВремени КАК ВидУчетаВремени,
	|		ЗависимыеНачисления.Показатель1 КАК Показатель1,
	|		ЗависимыеНачисления.Показатель2 КАК Показатель2,
	|		ЗависимыеНачисления.Показатель3 КАК Показатель3,
	|		ЗависимыеНачисления.Показатель4 КАК Показатель4,
	|		ЗависимыеНачисления.Показатель5 КАК Показатель5,
	|		ЗависимыеНачисления.Показатель6 КАК Показатель6,
	|		ЗависимыеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|		ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаНачало КАК ПериодРасчетаСреднегоЗаработкаНачало,
	|		ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание КАК ПериодРасчетаСреднегоЗаработкаОкончание,
	|		ЗависимыеНачисления.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|		ЗависимыеНачисления.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|		ЗависимыеНачисления.Авторасчет КАК Авторасчет,
	|		ЗависимыеНачисления.Регистратор КАК СторнируемыйДокумент
	|	ИЗ
	|		ВТ_ОсновныеНачисления КАК ОсновныеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
	|					(Сотрудник, ПериодДействия) В
	|						(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|							ОсновныеНачисления.Сотрудник,
	|							ОсновныеНачисления.ПериодДействия
	|						ИЗ
	|							ВТ_ОсновныеНачисления КАК ОсновныеНачисления)) КАК ЗависимыеНачисления
	|			ПО ОсновныеНачисления.Сотрудник = ЗависимыеНачисления.Сотрудник
	|				И ОсновныеНачисления.ПериодДействия = ЗависимыеНачисления.ПериодДействия
	|				И ОсновныеНачисления.ПериодДействияНачало < ЗависимыеНачисления.ПериодДействияКонец
	|				И ОсновныеНачисления.ПериодДействияКонец > ЗависимыеНачисления.ПериодДействияНачало
	|				И (ЗависимыеНачисления.ПериодРегистрации < ОсновныеНачисления.ПериодРегистрации)
	|				И ((НЕ ЗависимыеНачисления.Сторно))
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ВедущиеВидыРасчета КАК Ведущие
	|			ПО (Ведущие.Ссылка = ЗависимыеНачисления.ВидРасчета)
	|				И (Ведущие.ВидРасчета = ОсновныеНачисления.ВидРасчета)
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ВытесняющиеВидыРасчета КАК Вытесняющие
	|			ПО (Вытесняющие.Ссылка = ЗависимыеНачисления.ВидРасчета)
	|				И (Вытесняющие.ВидРасчета = ОсновныеНачисления.ВидРасчета)
	|	ГДЕ
	|		((НЕ Ведущие.ВидРасчета ЕСТЬ NULL )
	|				ИЛИ (НЕ Вытесняющие.ВидРасчета ЕСТЬ NULL ))
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ОсновныеНачисления.Сотрудник,
	|		ЗависимыеНачисления.ВидРасчета,
	|		ОсновныеНачисления.ПериодРегистрации,
	|		ОсновныеНачисления.ПериодДействия,
	|		ЗависимыеНачисления.БазовыйПериодНачало,
	|		ЗависимыеНачисления.БазовыйПериодКонец,
	|		ЗависимыеНачисления.Сторно,
	|		ЗависимыеНачисления.ФизЛицо,
	|		ЗависимыеНачисления.Организация,
	|		ЗависимыеНачисления.ГрафикРаботы,
	|		ЗависимыеНачисления.ГрафикРаботыНорма,
	|		ЗависимыеНачисления.ВидУчетаВремени,
	|		ЗависимыеНачисления.Показатель1,
	|		ЗависимыеНачисления.Показатель2,
	|		ЗависимыеНачисления.Показатель3,
	|		ЗависимыеНачисления.Показатель4,
	|		ЗависимыеНачисления.Показатель5,
	|		ЗависимыеНачисления.Показатель6,
	|		ЗависимыеНачисления.ПодразделениеОрганизации,
	|		ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|		ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|		ЗависимыеНачисления.ДатаНачалаСобытия,
	|		ЗависимыеНачисления.ОбособленноеПодразделение,
	|		ЗависимыеНачисления.Авторасчет,
	|		ЗависимыеНачисления.Регистратор) КАК ЗависимыеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ОсновныеНачисления КАК ВТ_ОсновныеНачисления
	|		ПО ЗависимыеНачисления.Сотрудник = ВТ_ОсновныеНачисления.Сотрудник
	|			И ЗависимыеНачисления.ВидРасчета = ВТ_ОсновныеНачисления.ВидРасчета
	|ГДЕ
	|	ВТ_ОсновныеНачисления.ВидРасчета ЕСТЬ NULL 
	|
	|УПОРЯДОЧИТЬ ПО
	|	Начислить УБЫВ,
	|	ВидРасчета,
	|	ПериодДействияНачало
	|АВТОУПОРЯДОЧИВАНИЕ";
	
	Запрос.Текст = ТекстЗапроса;
	
	Возврат Запрос.Выполнить().Выгрузить();	
	
КонецФункции // ПолучитьТаблицуЗависимыхНачисленийОсновные()

// Функция получает по таблице начислений таблицу зависимых начислений
//
// Параметры
//  ТаблицаНачислений  – <Таблица значений> – таблица начислений по которым необходимо собрать зависимые начисления
//  
// Возвращаемое заначение - – <Таблица значений>
Функция ПолучитьТаблицуЗависимыхНачисленийДополнительные(ТаблицаНачислений) Экспорт
	
	Если ТаблицаНачислений.Количество() = 0 Тогда
		Возврат ТаблицаНачислений;
	КонецЕсли;	
	
	МенеджерВТ = Новый МенеджерВременныхТаблиц;
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
	
	// поместим таблицу значений во временную таблицу
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ТаблицаНачислений.Сотрудник КАК Сотрудник,
	|	ТаблицаНачислений.ВидРасчета КАК ВидРасчета,
	|	ТаблицаНачислений.ПериодРегистрации КАК ПериодРегистрации,
	|	ТаблицаНачислений.ПериодДействияНачало КАК ПериодДействияНачало,
	|	ТаблицаНачислений.ПериодДействияКонец КАК ПериодДействияКонец
	|ПОМЕСТИТЬ ВТ_ОсновныеНачисления
	|ИЗ
	|	&ТаблицаНачислений КАК ТаблицаНачислений
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	ВидРасчета,
	|	ПериодРегистрации,
	|	ПериодДействияНачало,
	|	ПериодДействияКонец";
	
	Запрос.УстановитьПараметр("ТаблицаНачислений", ТаблицаНачислений);
	Запрос.Текст = ТекстЗапроса;
	Запрос.Выполнить();
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|	ЗависимыеНачисления.ВидРасчета КАК ВидРасчета,
	|	ОсновныеНачисления.ПериодРегистрации КАК ПериодРегистрации,
	|	ЗависимыеНачисления.БазовыйПериодНачало КАК БазовыйПериодНачало,
	|	ЗависимыеНачисления.БазовыйПериодКонец КАК БазовыйПериодКонец,
	|	ЗависимыеНачисления.Сторно КАК Сторно,
	|	ЗависимыеНачисления.ФизЛицо КАК ФизЛицо,
	|	ЗависимыеНачисления.Организация КАК Организация,
	|	ЗависимыеНачисления.ГрафикРаботы КАК ГрафикРаботы,
	|	ЗависимыеНачисления.ВидУчетаВремени КАК ВидУчетаВремени,
	|	ЗависимыеНачисления.Показатель1 КАК Показатель1,
	|	ЗависимыеНачисления.Показатель2 КАК Показатель2,
	|	ЗависимыеНачисления.Показатель3 КАК Показатель3,
	|	ЗависимыеНачисления.Показатель4 КАК Показатель4,
	|	ЗависимыеНачисления.Показатель5 КАК Показатель5,
	|	ЗависимыеНачисления.Показатель6 КАК Показатель6,
	|	ЗависимыеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаНачало КАК ПериодРасчетаСреднегоЗаработкаНачало,
	|	ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание КАК ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ЗависимыеНачисления.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
	|	ЗависимыеНачисления.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|	ЗависимыеНачисления.ЧислоМесяцев,
	|	ЗависимыеНачисления.Регистратор КАК СторнируемыйДокумент
	|ИЗ
	|	ВТ_ОсновныеНачисления КАК ОсновныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ЗависимыеНачисления
	|		ПО ОсновныеНачисления.Сотрудник = ЗависимыеНачисления.Сотрудник
	|			И (НАЧАЛОПЕРИОДА(ЗависимыеНачисления.ПериодРегистрации, МЕСЯЦ) < ОсновныеНачисления.ПериодРегистрации)
	|			И ОсновныеНачисления.ПериодДействияНачало < ЗависимыеНачисления.БазовыйПериодКонец
	|			И ОсновныеНачисления.ПериодДействияКонец > ЗависимыеНачисления.БазовыйПериодНачало
	|			И (НЕ ЗависимыеНачисления.Сторно)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.ВедущиеВидыРасчета КАК Ведущие
	|		ПО (Ведущие.Ссылка = ЗависимыеНачисления.ВидРасчета)
	|			И (Ведущие.ВидРасчета = ОсновныеНачисления.ВидРасчета)
	|ГДЕ
	|	(НЕ Ведущие.ВидРасчета ЕСТЬ NULL )
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисления.Сотрудник,
	|	ЗависимыеНачисления.ВидРасчета,
	|	ОсновныеНачисления.ПериодРегистрации,
	|	ЗависимыеНачисления.БазовыйПериодНачало,
	|	ЗависимыеНачисления.БазовыйПериодКонец,
	|	ЗависимыеНачисления.Сторно,
	|	ЗависимыеНачисления.ФизЛицо,
	|	ЗависимыеНачисления.Организация,
	|	ЗависимыеНачисления.ГрафикРаботы,
	|	ЗависимыеНачисления.ВидУчетаВремени,
	|	ЗависимыеНачисления.ПодразделениеОрганизации,
	|	ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ЗависимыеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ЗависимыеНачисления.ДатаНачалаСобытия,
	|	ЗависимыеНачисления.ОбособленноеПодразделение,
	|	ЗависимыеНачисления.Показатель1,
	|	ЗависимыеНачисления.Показатель2,
	|	ЗависимыеНачисления.Показатель3,
	|	ЗависимыеНачисления.Показатель4,
	|	ЗависимыеНачисления.Показатель5,
	|	ЗависимыеНачисления.Показатель6,
	|	ЗависимыеНачисления.ЧислоМесяцев,
	|	ЗависимыеНачисления.Регистратор";
	
	Запрос.Текст = ТекстЗапроса;
	
	Возврат Запрос.Выполнить().Выгрузить();
	
КонецФункции // ПолучитьТаблицуЗависимыхНачисленийОсновные()





////////////////////////////////////////////////////////////////////////////////
// Формульные расчеты

Функция ПолучитьHTLMКодФормулыРасчета(ФормулаРасчета, Показатели, Режим, ВыводитьИдентификатор = Ложь) Экспорт
	
	Числа = "0123456789";
	
	
	ОператорыИФункции				=  ".,+,-,/,*,ЦЕЛ,INT,ОКР,ROUND,МАКС,MAX,МИН,MIN,?,=,<,>,<=,>=,ОЦЕНИТЬПО,(,),И,ИЛИ,НЕ,OR,AND,NOT";
	ОператорыИФункцииОднойСтрокой	=  ".,+,-,/,*,?,=,<,>,(,)";
	
	МассивРазделителей = Новый Массив;
	МассивРазделителей.Добавить(" ");
	МассивРазделителей.Добавить(Символы.ВК);
	МассивРазделителей.Добавить(Символы.ВТаб);
	МассивРазделителей.Добавить(Символы.НПП);
	МассивРазделителей.Добавить(Символы.ПС);
	МассивРазделителей.Добавить(Символы.ПФ);
	МассивРазделителей.Добавить(Символы.Таб);
	
	СловоСобрано		= Ложь;
	НайденПоказатель	= Ложь;
	
	Слово = "";
	
	ДлинаСтроки					= СтрДлина(ФормулаРасчета);
	НовыйHTMLКодФормулыРасчета	= "";
	
	
	// разбор слов
	НомерАнализируемогоСимвола = 1;
	Пока НомерАнализируемогоСимвола <= ДлинаСтроки Цикл
		
		Символ = Сред(ФормулаРасчета, НомерАнализируемогоСимвола, 1);
		
		Если Символ = "." И Слово = "ИсходныеДанные" и Сред(ФормулаРасчета, НомерАнализируемогоСимвола+1, 10) = "Показатель" Тогда
			
			
			НомерАнализируемогоСимвола = НомерАнализируемогоСимвола + 10;
			НомерПоказателя = "";
			ШагВнутриЦикла = 0;
			ПродолжитьЦикл = Истина;
			Пока ПродолжитьЦикл Цикл
				
				НомерАнализируемогоСимвола = НомерАнализируемогоСимвола + 1;
				СимволДляСравненияСЧислом = Сред(ФормулаРасчета, НомерАнализируемогоСимвола, 1);
				Если Найти(Числа, СимволДляСравненияСЧислом) <> 0 Тогда
					НомерПоказателя = НомерПоказателя + СимволДляСравненияСЧислом;
					ПродолжитьЦикл  = (НомерАнализируемогоСимвола <= ДлинаСтроки);
				Иначе
					ПродолжитьЦикл = Ложь;
				КонецЕсли;
				
			КонецЦикла;
			
			Если Режим = "Текст" Тогда
				Если ВыводитьИдентификатор Тогда
					ПоказательДляФормулы = Строка(Показатели[Число(НомерПоказателя) - 1].Показатель.Идентификатор);
				Иначе
					ПоказательДляФормулы = Строка(Показатели[Число(НомерПоказателя) - 1].Показатель);
				КонецЕсли;
			Иначе
				ПоказательДляФормулы = "<FONT color=#0000ff>" + Строка(Показатели[Число(НомерПоказателя) - 1].Показатель)+"</FONT>";
			КонецЕсли;
			
			НовыйHTMLКодФормулыРасчета = НовыйHTMLКодФормулыРасчета + ПоказательДляФормулы;
			
			НайденПоказатель = Истина;
			
			Слово = "";
			
		ИначеЕсли  МассивРазделителей.Найти(Символ) <> Неопределено Или Найти(ОператорыИФункцииОднойСтрокой, Символ) Тогда
			
			СловоСобрано = Истина;
			НайденПоказатель = Ложь;
			Слово = Слово + Символ;
		Иначе
			
			// символ не разделитель, можно его добавить к слову
			Слово = Слово + Символ;
			Если ДлинаСтроки = НомерАнализируемогоСимвола Тогда 
				СловоСобрано = Истина;
			КонецЕсли;
			НайденПоказатель = Ложь;
		КонецЕсли;
		
		Если СловоСобрано И Не НайденПоказатель Тогда
			//	ФормулаРасчета	= СтрЗаменить(ФормулаРасчета, "ИсходныеДанные.Показатель"+Показатель.НомерСтроки, ПоказательДляФормулы);
			НовыйHTMLКодФормулыРасчета = НовыйHTMLКодФормулыРасчета + Слово;
			СловоСобрано = Ложь;
			Слово = "";
		КонецЕсли;
		
		Если НЕ НайденПоказатель Тогда
			НомерАнализируемогоСимвола = НомерАнализируемогоСимвола + 1;
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат НовыйHTMLКодФормулыРасчета;
	
КонецФункции //ПолучитьHTLMКодФормулыРасчета


Функция ПолучитьТекстПоказателя(НеобходимыеДанные, ВидПВР, Предопределенный = Ложь, КомментироватьРасчет)		
	
	Если 	НеобходимыеДанные.СдельныйЗаработок или 
		НеобходимыеДанные.ОтработаноВремени или 
		НеобходимыеДанные.НормаВремениЗаМесяц или
		НеобходимыеДанные.Стаж или
		НеобходимыеДанные.ВремяВКалендарныхДнях или
		НеобходимыеДанные.База Тогда
		Если ВидПВР = "УдержанияРаботниковОрганизаций" Или ВидПВР = "ДополнительныеНачисленияРаботниковОрганизаций" Или ВидПВР = "УправленческиеУдержания" Тогда
			Показатель1Текст = "ВЫБОР "+
			?(НеобходимыеДанные.Стаж, "                 
			|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.Стаж)
			|		ТОГДА РАЗНОСТЬДАТ(ДанныеОСтаже.Период, Основной.БазовыйПериодКонец, МЕСЯЦ)", "") + 
			?(НеобходимыеДанные.ВремяВКалендарныхДнях, "
			|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ВремяВКалендарныхДнях)
			|		ТОГДА РАЗНОСТЬДАТ(Основной.БазовыйПериодНачало, Основной.БазовыйПериодКонец, ДЕНЬ) + 1  ", "")+
			?(НеобходимыеДанные.КалендарныхДнейВмесяце, "
			|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.КалендарныхДнейВмесяце)
			|		ТОГДА РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(Основной.БазовыйПериодНачало,МЕСЯЦ), КОНЕЦПЕРИОДА(Основной.БазовыйПериодКонец,МЕСЯЦ), ДЕНЬ) + 1  ", "");
			
		Иначе
			Показатель1Текст = "ВЫБОР "+
			?(НеобходимыеДанные.Стаж, "                 
			|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.Стаж)
			|		ТОГДА РАЗНОСТЬДАТ(ДанныеОСтаже.Период, КОНЕЦПЕРИОДА(Основной.ПериодДействия, МЕСЯЦ), МЕСЯЦ)", "") + 
			?(НеобходимыеДанные.ВремяВКалендарныхДнях, "                 
			|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ВремяВКалендарныхДнях)
			|		ТОГДА РАЗНОСТЬДАТ(ФактическийПериодДействия.ПериодДействияНачало, ФактическийПериодДействия.ПериодДействияКонец, ДЕНЬ) + 1 ", "")+
			?(НеобходимыеДанные.КалендарныхДнейВмесяце, "
			|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.КалендарныхДнейВмесяце)
			|		ТОГДА РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(Основной.ПериодДействияНачало,МЕСЯЦ), КОНЕЦПЕРИОДА(Основной.ПериодДействияНачало,МЕСЯЦ), ДЕНЬ) + 1  ", "")+
			//Островская Татьяна 18.02.2014 № 17126
			?(НеобходимыеДанные.ТарифнаяСтавка1Разряда, "
			|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавка1Разряда)
			|		ТОГДА ставки.Размер", "");
			//Островская Татьяна 18.02.2014 № 17126
		КонецЕсли;
		Если ВидПВР = "ОсновныеНачисленияРаботниковОрганизаций" Тогда
			НазваниеРеквизитаВидУчетаРабочегоВремени = ".ОбозначениеВТабелеУчетаРабочегоВремени";
		ИначеЕсли ВидПВР = "УправленческиеНачисления" Тогда
			НазваниеРеквизитаВидУчетаРабочегоВремени = ".ВидУчетаРабочегоВремени";
		Иначе
			НазваниеРеквизитаВидУчетаРабочегоВремени = "";
		КонецЕсли;
		
		Показатель1Текст = Показатель1Текст +
		?(НеобходимыеДанные.СдельныйЗаработок, "
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.СдельнаяВыработка) 
		|		ТОГДА ВЫБОР
		|			КОГДА ЕСТЬNULL(ДанныеОСдельномЗаработке.ОшибкаВводаФактическойВыработки, ЛОЖЬ)
		|				ТОГДА 0
		|			ИНАЧЕ ДанныеОСдельномЗаработке.СуммаЗаработка
		|		КОНЕЦ", "") + 
		?(НеобходимыеДанные.ОтработаноВремени, "
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ВремяВДнях)  
		|		ТОГДА ВЫБОР
		|			КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
		|				ТОГДА 0
		|			КОГДА Основной.ВидРасчета" + НазваниеРеквизитаВидУчетаРабочегоВремени + " НЕ В
		|				(ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка),
		|				 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Сверхурочные),
		|				 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы),
		|				 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы),
		|				 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа))
		|				И НЕ ОтработаноПоВидуВремениНачисления.Дней ЕСТЬ NULL
		|				ТОГДА
		|					ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Дней, 0)
		|			ИНАЧЕ " + ?(ВидПВР = "УправленческиеНачисления", "
		|					 ЕСТЬNULL(ВЫБОР
		|						КОГДА Основной.ВидУчетаВремени = &ПоДням
		|							ТОГДА ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
		|						ИНАЧЕ ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
		|						КОНЕЦ, 0)", "
		|					 ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ДнейПоТабелю, ВЫБОР
		|								КОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ)
		|									ТОГДА 0
		|								ИНАЧЕ ЕСТЬNULL(СводныеИндивидуальныеГрафики.ДнейПоГрафику, ЕСТЬNULL(ВЫБОР
		|												КОГДА Основной.ВидУчетаВремени = &ПоДням
		|													ТОГДА ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
		|												ИНАЧЕ ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
		|											КОНЕЦ, 0))
		|							КОНЕЦ)") + "
		|		КОНЕЦ 
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ВремяВЧасах)
		|		ТОГДА ВЫБОР
		|			КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
		|				ТОГДА 0
		|			КОГДА Основной.ВидРасчета" + НазваниеРеквизитаВидУчетаРабочегоВремени + " НЕ В
		|				(ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка),
		|				 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Сверхурочные),
		|				 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы),
		|				 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы),
		|				 ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа))
		|				И НЕ ОтработаноПоВидуВремениНачисления.Часов ЕСТЬ NULL
		|				ТОГДА
		|					ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Часов, 0)
		|			ИНАЧЕ " + ?(ВидПВР = "УправленческиеНачисления", "
		|					ЕСТЬNULL(ВЫБОР
		|						КОГДА Основной.ВидУчетаВремени = &ПоДням
		|							ТОГДА ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
		|						ИНАЧЕ ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
		|						КОНЕЦ, 0)", "
		|					ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ЧасовПоТабелю, ВЫБОР
		|							КОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.ОшибкаВводаИндивидуальногоГрафикаРаботы, ЛОЖЬ)
		|								ТОГДА 0
		|							ИНАЧЕ ЕСТЬNULL(СводныеИндивидуальныеГрафики.ЧасовПоГрафику, ЕСТЬNULL(ВЫБОР
		|											КОГДА Основной.ВидУчетаВремени = &ПоДням
		|												ТОГДА ДанныеГрафика.ДополнительноеЗначениеФактическийПериодДействия
		|											ИНАЧЕ ДанныеГрафика.ОсновноеЗначениеФактическийПериодДействия
		|										КОНЕЦ, 0)) - ЕСТЬNULL(ВремяПоТабелю.ОтработаноЧасовПоТабелюОтклонение, 0)
		|						КОНЕЦ)") + "
		|		КОНЕЦ" + 
		?(НеобходимыеДанные.ВсегоОтработаноВремени, "
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ОтработаноВремениВДнях)  
		|		ТОГДА ВЫБОР
		|			КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
		|				ТОГДА 0
		|			ИНАЧЕ ЕСТЬNULL(ВсегоОтработаноВремени.ВсегоОтработаноДней, 0)
		|		КОНЕЦ 
		//О.Т. Аверсон 24.09.2017 № 
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ОтработаноВремени)
		|ТОГДА ВЫБОР
		|		КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
		|			ТОГДА NULL
		|		КОГДА Выбор когда Основной.Регистратор ссылка Документ.ОплатаСовмещенияСотрудников тогда Основной.Регистратор.ЗаполнениеПоГруппеРасчетов и &ТекЗначение иначе ложь конец тогда  
		|		     Основной.ОплаченоДнейЧасов
		|		КОГДА ВЫБОР
		|					КОГДА &ОтработанноеВремяТолькоПоТабелю
		|						ТОГДА Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени.РабочееВремя
		|					ИНАЧЕ НЕ Основной.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени В (ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка), ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Сверхурочные), ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы), ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы), ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа))
		|				КОНЕЦ
		|				И ВЫБОР
		|					КОГДА &ОтработанноеВремяТолькоПоТабелю
		|						ТОГДА ИСТИНА
		|					ИНАЧЕ ОтработаноПоВидуВремениНачисления.Дней ЕСТЬ НЕ NULL 
		|				КОНЕЦ
		|			ТОГДА ВЫБОР
		|					КОГДА Основной.ВидУчетаВремени = &ПоДням
		|						ТОГДА ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Дней, 0)
		|					ИНАЧЕ ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Часов, 0)
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА Основной.ВидУчетаВремени = &ПоДням
		|					ТОГДА ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Дней, 0)
		|				ИНАЧЕ ЕСТЬNULL(ОтработаноПоВидуВремениНачисления.Часов, 0)
		|			КОНЕЦ  
		|	КОНЕЦ
		//О.Т. Аверсон 24.09.2017 № 
		
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ОтработаноВремениВЧасах)
		|		ТОГДА ВЫБОР
		|			КОГДА ЕСТЬNULL(ВремяВведенноеВЦеломЗаПериод.ОшибкаВводаОтработанногоВремени, ЛОЖЬ)
		|				ТОГДА 0
		|			ИНАЧЕ ЕСТЬNULL(ВсегоОтработаноВремени.ВсегоОтработаноЧасов - ЕСТЬNULL(ВремяПоТабелю.ОтработаноЧасовПоТабелюОтклонение, 0), 0)
		|		КОНЕЦ",""), "") +
		?(НеобходимыеДанные.НормаВремениЗаМесяц, "
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.НормаВремениВДнях)
		|		ТОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.НормаДнейПоГрафику, ВЫБОР 
		|																			КОГДА Основной.ВидУчетаВремени = &ПоДням 
		|																				ТОГДА Выбор когда Основной.ВидРасчета.СпособРасчета = Значение(Перечисление.СпособыРасчетаОплатыТруда.ПроизвольнаяФормула) тогда НормаВремениПоОбщемуГрафику.НормаДней иначе ЕстьNULL(ДанныеГрафика.ОсновноеЗначениеНормаПериодДействия,НормаВремениПоОбщемуГрафику.НормаДней) конец //О.Т. Аверсон 19.09.2017 № 1045
		|																				ИНАЧЕ Выбор когда Основной.ВидРасчета.СпособРасчета = Значение(Перечисление.СпособыРасчетаОплатыТруда.ПроизвольнаяФормула) тогда НормаВремениПоОбщемуГрафику.НормаЧасов иначе ЕстьNULL(ДанныеГрафика.ДополнительноеЗначениеНормаПериодДействия,НормаВремениПоОбщемуГрафику.НормаЧасов) конец //О.Т. Аверсон 19.09.2017 № 1045
		|																		КОНЕЦ)
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.НормаВремениВЧасах)
		|		ТОГДА ЕСТЬNULL(СводныеИндивидуальныеГрафики.НормаЧасовПоГрафику, ВЫБОР 
		|																			КОГДА Основной.ВидУчетаВремени = &ПоДням 
		|																				ТОГДА Выбор когда Основной.ВидРасчета.СпособРасчета = Значение(Перечисление.СпособыРасчетаОплатыТруда.ПроизвольнаяФормула) тогда НормаВремениПоОбщемуГрафику.НормаДней иначе ЕстьNULL(ДанныеГрафика.ДополнительноеЗначениеНормаПериодДействия,НормаВремениПоОбщемуГрафику.НормаДней) конец //О.Т. Аверсон 19.09.2017 № 1045
		|																				ИНАЧЕ Выбор когда Основной.ВидРасчета.СпособРасчета = Значение(Перечисление.СпособыРасчетаОплатыТруда.ПроизвольнаяФормула) тогда НормаВремениПоОбщемуГрафику.НормаЧасов иначе ЕстьNULL(ДанныеГрафика.ОсновноеЗначениеНормаПериодДействия,НормаВремениПоОбщемуГрафику.НормаЧасов) конец //О.Т. Аверсон 19.09.2017 № 1045
		|																		КОНЕЦ)", "");
		
		Показатель1Текст = Показатель1Текст +		
		?(НеобходимыеДанные.База, "
		|	КОГДА Показатели.Показатель1 = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.РасчетнаяБаза)
		|		ТОГДА ЕСТЬNULL(База.РезультатБаза,0)", "");	
		Если Предопределенный Тогда
			
			Показатель1Текст = Показатель1Текст + "				
			|ИНАЧЕ 0
			|КОНЕЦ ";
		Иначе
			Показатель1Текст = Показатель1Текст + "				
			|ИНАЧЕ ВЫБОР КОГДА Показатели.Показатель1.ТипПоказателя В (&ШкальныеПоказатели)
			|		ТОГДА Показатели.Показатель1
			|	    ИНАЧЕ  Основной.Показатель1 / ВЫБОР КОГДА Показатели.Показатель1.ТипПоказателя В (&ПроцентныеПоказатели) ТОГДА 100 ИНАЧЕ 1 КОНЕЦ
			|КОНЕЦ КОНЕЦ";
			
		КонецЕсли;
	Иначе
		Если Предопределенный Тогда
			
			Показатель1Текст = Показатель1Текст + "				
			|ИНАЧЕ 0
			|КОНЕЦ ";
		Иначе
			
			Показатель1Текст = "ВЫБОР 
			|КОГДА Показатели.Показатель1.ТипПоказателя В (&ШкальныеПоказатели)
			|		ТОГДА Показатели.Показатель1
			|	  	ИНАЧЕ  Основной.Показатель1 / ВЫБОР КОГДА Показатели.Показатель1.ТипПоказателя В (&ПроцентныеПоказатели) ТОГДА 100 ИНАЧЕ 1 КОНЕЦ
			|КОНЕЦ";
		КонецЕсли;
	КонецЕсли;
	
	Возврат Показатель1Текст;
	
КонецФункции //ПолучитьТекстПоказателя

// Формирует текстовую интерпретацию формулы по способу расчета и показателям для отображения
// на экране.
//
// Параметры
//  Объект - ПланВидовРасчетаОбъект для ПВР УправленческиеНачисления или УправленческиеУдержания
//	Режим - "Текст" - форумал выводится в виде текста, "HTML" - в виде HTML кода, по умолчанию = "Текст"
// Возвращаемое значение:
//   Строка   – содержит текстовую интерпретацию формулы расчета.
//
Функция ВизуализироватьФормулуРасчета(Объект, Режим = "Текст") Экспорт
	
	СпособРасчета = Объект.СпособРасчета;
	
	Если Режим = "HTML" Тогда
		
		СтрокаФормулы ="
		|	<HTML><HEAD>
		|	</HEAD>
		|	<BODY vlink=#000 link=#000 scroll=auto rightMargin=0><FONT face=""MS Sans Serif"" size=1>
		|";
		
		//СписокУпрСпособов = ПроведениеРасчетов.ПолучитьСписокВариантовУпрНачислений();
		//СтрокаФормулы = СтрокаФормулы +"<FONT face=""MS Sans Serif"" size=2>";
		//Если СписокУпрСпособов.НайтиПоЗначению(СпособРасчета) = Неопределено Тогда
		//	СтрокаФормулы = СтрокаФормулы + "
		//	|Описание формулы расчета";				
		//Иначе
		//	СтрокаФормулы = СтрокаФормулы + "
		//	|Описание формулы расчета (щелкните подчеркнутый показатель для изменения)";
		//КонецЕсли;
		//СтрокаФормулы = СтрокаФормулы + "
		//|</FONT>
		//|<HR>";
		//Если Объект.Показатель1.Пустая() Тогда
		//	Показатель1 = "<a href=./0><FONT id=""Indicator0"" color=#0000ff><Показатель 1></FONT></a>&nbsp";
		//Иначе
		//	Показатель1 = "<a href=./0> <FONT id=""Indicator0"" color=#993366>" + Строка(Объект.Показатель1)+"</FONT></a>&nbsp";
		//КонецЕсли;
		//Если Объект.Показатель2.Пустая() Тогда
		//	Показатель2 = "<a href=./1><FONT id=""Indicator1"" color=#0000ff><Показатель 2></FONT></a>&nbsp";
		//Иначе		
		//	Показатель2 = "<a href=./1> <FONT id=""Indicator1"" color=#993366>" + Строка(Объект.Показатель2)+"</FONT></a>&nbsp";
		//КонецЕсли;
		//Если Объект.Показатель3.Пустая() Тогда
		//	Показатель3 = "<a href=./2><FONT id=""Indicator2"" color=#0000ff><Показатель 3></FONT></a>&nbsp";			
		//Иначе
		//	Показатель3 = "<a href=./2> <FONT id=""Indicator2"" color=#993366>" + Строка(Объект.Показатель3)+"</FONT></a>&nbsp";
		//КонецЕсли;
		//Если Объект.Показатель4.Пустая() Тогда
		//	Показатель4 = "<a href=./3><FONT id=""Indicator3"" color=#0000ff><Показатель 4></FONT></a>";						
		//Иначе	
		//	Показатель4 = "<a href=./3> <FONT id=""Indicator3"" color=#993366>" + Строка(Объект.Показатель4)+"</FONT></a>";
		//КонецЕсли;	
		//Если Объект.Показатель5.Пустая() Тогда
		//	Показатель5 = "<a href=./4><FONT id=""Indicator4"" color=#0000ff><Показатель 5></FONT></a>&nbsp";						
		//Иначе
		//	Показатель5 = "<a href=./4> <FONT id=""Indicator4"" color=#993366>" + Строка(Объект.Показатель5)+"</FONT></a>&nbsp";
		//КонецЕсли;	
	КонецЕсли;
	
	Если  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Фиксированная сумма>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Фиксированная сумма></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксСуммойПропорционльноОтработанномуВремени Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Фиксированная сумма> / <Норма времени за месяц в днях> * <Отработанное время в днях>"	
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Фиксированная сумма></FONT> делить на <FONT color=#993366><Норма времени за месяц в днях></FONT> умножить на <FONT color=#993366><Отработанное время в днях></FONT>"			
		КонецЕсли;				
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Фиксированная сумма>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Фиксированная сумма></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Фиксированная сумма>, до удержания указанной в документе суммы";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Фиксированная сумма>, до удержания указанной в документе суммы</FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Сдельная выработка>";		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Сдельная выработка></FONT>"			
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.НулеваяСумма Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<0>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><0></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоначислениеПоУправленческомуУчету Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<От обратного>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><От обратного></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка до 3х лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка до 3х лет></FONT>"
		КонецЕсли;
		//О.Т. 27.01.2015 № 17821
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаДетейВВозрастеОт3До18 Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на детей в возрасте от3 до18>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на детей в возрасте от3 до18></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаВторогоИПоследующихДо3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на второго и последующих до3 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на второго и последующих до3 лет></FONT>"
		КонецЕсли;
		//О.Т. 27.01.2015 № 17821
		//О.Т. Аверсон 21.07.2017 № 851
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на второго и последующих до3 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие старше 3-х лет из отдельных категорий семей></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на второго и последующих до3 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие старше 3-х лет из отдельных категорий семей (инвалид)></FONT>"
		КонецЕсли;	
		//О.Т. Аверсон 21.07.2017 № 851
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка> * <Отработанное время в днях>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка></FONT> умножить на <FONT color=#993366><Отработанное время в днях></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СделкаПоЧасовойТарифнойСтавке Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка> * <Отработанное время в часах>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT>"						
		КонецЕсли;
		
		//О.Т. Аверсон 02.11.2017 № 1183
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПогрузочноРазгрузочныеРаботы Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Должностной оклад (тарифный оклад + повышения по окладу)> / <Отработанное время в часах> * <Количество часов на авто> * <% за погр-разгр. работы>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Должностной оклад (тарифный оклад + повышения по окладу)></FONT> делить <FONT color=#993366><Отработанное время в часах></FONT> умножить на <FONT color=#993366><Количество часов на авто></FONT> умножить на <FONT color=#993366><Процент за погр-разгр. работы></FONT>"						
		КонецЕсли;
		//О.Т. Аверсон 02.11.2017 № 1183
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Процент оплаты> * <Расчетная база>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Процент оплаты></FONT> умножить на <FONT color=#993366><Расчетная база></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПочтовыйСбор Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Процент сбора> * <Сумма по исполнительному листу>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Процент сбора></FONT> умножить на <FONT color=#993366><Сумма по исполнительному листу></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Процент удержаний> * (<Расчетная база> - <Исчисленный НДФЛ>)"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Процент удержаний></FONT> умножить на <FONT color=#993366>(<Расчетная база> за вычетом <Исчисленный НДФЛ>)</FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Процент удержаний> * (<Расчетная база> - <Исчисленный НДФЛ>), до удержания указанной в документе суммы"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Процент удержаний></FONT> умножить на <FONT color=#993366>(<Расчетная база> за вычетом <Исчисленный НДФЛ>), до удержания указанной в документе суммы</FONT>"			
		КонецЕсли;
		//О.Т. Аверсон 24.05.2017 № 665	
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Процент удержаний> * (<Расчетная база> - <Исчисленный НДФЛ> - <Пенсионный фонд>)"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Процент удержаний></FONT> умножить на <FONT color=#993366>(<Расчетная база> за вычетом <Исчисленный НДФЛ> и <Пенсионный фонд>)</FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Процент удержаний> * (<Расчетная база> - <Исчисленный НДФЛ> - <Пенсионный фонд>), до удержания указанной в документе суммы"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Процент удержаний></FONT> умножить на <FONT color=#993366>(<Расчетная база> за вычетом <Исчисленный НДФЛ> и <Пенсионный фонд>), до удержания указанной в документе суммы</FONT>"			
		КонецЕсли;
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Фиксированная сумма>, сравнение минимального значения с (<Расчетная база> - <Исчисленный НДФЛ> - <Пенсионный фонд>)"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Фиксированная сумма></FONT>, сравнение минимального значения с <FONT color=#993366>(<Расчетная база> за вычетом <Исчисленный НДФЛ> и <Пенсионный фонд>)</FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Фиксированная сумма>, сравнение минимального значения с (<Расчетная база> - <Исчисленный НДФЛ> - <Пенсионный фонд>), до удержания указанной в документе суммы"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Фиксированная сумма></FONT> сравнение минимального значения с <FONT color=#993366>(<Расчетная база> за вычетом <Исчисленный НДФЛ> и <Пенсионный фонд>), до удержания указанной в документе суммы</FONT>"			
		КонецЕсли;
		
		//О.Т. Аверсон 24.05.2017 № 665
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВечерниеЧасы Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Часовая тарифная ставка> * <Процент доплаты> * <Вечернее время в часах>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Часовая тарифная ставка></FONT> умножить на <FONT color=#993366><Процент доплаты></FONT> умножить на <FONT color=#993366><Вечернее время в часах></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасы или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Часовая тарифная ставка> * <Процент доплаты> * <Ночное время в часах>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Часовая тарифная ставка></FONT> умножить на <FONT color=#993366><Процент доплаты></FONT> умножить на <FONT color=#993366><Ночное время в часах></FONT>"			
		КонецЕсли;
		//О.Т. 22.05.2015 № 
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыРасчетОтСреднегодовой Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Часовая тарифная ставка> * <Процент доплаты> * <Ночное время в часах>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Часовая тарифная ставка></FONT> умножить на <FONT color=#993366><Процент доплаты></FONT> умножить на <FONT color=#993366><Ночное время в часах></FONT>"			
		КонецЕсли; //О.Т. 22.05.2015 № 
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку 
		Или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням Тогда		
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Средний дневной (часовой) заработок> * <Время в днях (часах)>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Средний дневной (часовой) заработок></FONT> умножить на <FONT color=#993366><Время в днях (часах)></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС Тогда		
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Средний дневной заработок> * <Время в календарных днях>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Средний дневной заработок></FONT> умножить на <FONT color=#993366><Время в календарных днях></FONT>"			
		КонецЕсли;
		
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСтарше3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка старше 3-х лет>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка старше 3-х лет></FONT>"			
		КонецЕсли;
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Средний дневной заработок> * <Время в днях>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Средний дневной заработок></FONT> умножить на <FONT color=#993366><Время в днях></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка (оклад)> / <Норма времени за месяц в днях> * <Отработанное время в днях>"	
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка (оклад)></FONT> делить на <FONT color=#993366><Норма времени за месяц в днях></FONT> умножить на <FONT color=#993366><Отработанное время в днях></FONT>"			
		КонецЕсли;			
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка (оклад)> / <Норма времени за месяц в часах> * <Отработанное время в часах>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка (оклад)></FONT> делить на <FONT color=#993366><Норма времени за месяц в часах></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Стаж> оценить по <Шкала дневной тарифной ставки> умножить на <Отработанное время в днях>"	
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Стаж></FONT> оценить по <FONT color=#993366><Шкала дневной тарифной ставки></FONT> умножить на <FONT color=#993366><Отработанное время в днях></FONT>"
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Стаж> оценить по <Шкала месячной тарифной ставки>  / <Норма времени за месяц в днях> умножить на <Отработанное время в днях>"
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Стаж></FONT> оценить по <FONT color=#993366><Шкала месячной тарифной ставки></FONT> делить на <FONT color=#993366><Норма времени за месяц в днях></FONT> умножить на <FONT color=#993366><Отработанное время в днях></FONT>"
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Стаж> оценить по <Шкала часовой тарифной ставки> * <Отработанное время в часах>"	
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Стаж></FONT> оценить по <FONT color=#993366><Шкала часовой тарифной ставки></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Стаж> оценить по <Шкала месячной тарифной ставки>  / <Норма времени за месяц в часах> * <Отработанное время в часах>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Стаж></FONT> оценить по <FONT color=#993366><Шкала месячной тарифной ставки></FONT> делить на <FONT color=#993366><Норма времени за месяц в часах></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT>"			
		КонецЕсли;
		//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Стаж> оценить по <Шкала процентов оплаты> * <Расчетная база>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Стаж></FONT> оценить по <FONT color=#993366><Шкала процентов оплаты></FONT> умножить на <FONT color=#993366><Расчетная база></FONT>"			
		КонецЕсли;		
		//О.Т. Аверсон 04.11.2016 № 1501
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы  Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "(<Тарифная ставка часовая> * <Отработанные часы> + <Расчетная база>)*<Процент оплаты>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Стаж></FONT> оценить по <FONT color=#993366><Шкала процентов оплаты></FONT> умножить на <FONT color=#993366><Расчетная база></FONT>"			
		КонецЕсли;		
		//О.Т. Аверсон 04.11.2016 № 1501
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Расчетная база> * <Отработанное время> / <Норма времени> * <Процент оплаты>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Расчетная база></FONT> умножить на <FONT color=#993366><Отработанное время></FONT> делить на <FONT color=#993366><Норма времени></FONT> умножить на <FONT color=#993366><Процент оплаты></FONT>"			
		КонецЕсли;	
		//О.Т. Аверсон 04.11.2016 № 1501
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Северный стаж> оценить по <Шкала надбавок> * <Расчетная база>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Северный стаж></FONT> оценить по <FONT color=#993366><Шкала надбавок></FONT> умножить на <FONT color=#993366><Расчетная база></FONT>"			
		КонецЕсли;						
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "Максимум(<Средний заработок> - <Начислено>, <0>)";		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = Максимум(<FONT color=#993366><Средний заработок></FONT> вычесть <FONT color=#993366><Начислено></FONT> , <FONT color=#993366><0>)</FONT>"		
		КонецЕсли;
		//РБ	
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СдельныйПриработок Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Сдельная выработка> - <Тарифная ставка> * <Отработанное время в часах>"		
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Сдельная выработка></FONT> вычесть <FONT color=#993366><Тарифная ставка></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT>"			
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо1_5лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие матери-одиночке до 1.5 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие матери-одиночке до 1.5 лет></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеМатериОдиночкеДо3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие матери-одиночке до 3 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие матери-одиночке до 3 лет></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаВИЧ Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка ВИЧ-инфицированного>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка ВИЧ-инфицированного></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо18ЛетНадб40 Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка старше 3х лет надбавка 40%>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка старше 3х лет надбавка 40%></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка до 3 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка до 3 лет></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка-инвалида>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка-инвалида></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаСНадбавкой40До3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие по уходу за ребенком-инвалидом в возрасте до 18 лет (120%БПМ)>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие по уходу за ребенком-инвалидом в возрасте до 18 лет (120%БПМ)></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериНадб40До3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка не работающей матери надбавкой 40%  до 3 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка не работающей матери надбавкой 40%  до 3 лет></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо1_5Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка не работающей матери-одиночке  до 1.5 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка не работающей матери-одиночке  до 1.5 лет></FONT>"
		КонецЕсли;
		
		//Толик
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка/оклад с контрактом> * <Отработанное время в часах> * Процент"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка (оклад) с контрактом></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT> умножить на <FONT color=#993366><Процент></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезКонтракта Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка/оклад без контракта> * <Отработанное время в часах> * Процент"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка (оклад) без контракта></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT> умножить на <FONT color=#993366><Процент></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиПоИнструкции Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка по инструкции> * <Отработанное время в часах> * Процент"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка (оклад) по инструкции></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT> умножить на <FONT color=#993366><Процент></FONT>"			
		КонецЕсли;
		
		//Аверсон 05.12.2022 КВВ СВФР-009956 (
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиБезПовышенийИДоплат Тогда
		//процент надбавки * (тарифная ставка месячная (ТС 1 р-да *тарифный коэффициент) / норма рабочих часов в расчетном месяце*отработано часов)
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Процент> * ( (<Тарифная ставка 1 разряда> * <Тарифный коэффициент>) / <Норма рабочих часов> * <Отработано часов> )";								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Процент></FONT> умножить на <FONT color=#993366> ( ( <Тарифная ставка 1 разряда></FONT> умножить на <FONT color=#993366><Тарифный коэффициент> ) </FONT> разделить на <FONT color=#993366> <Норма рабочих часов></FONT> умножить на <FONT color=#993366><Отработано часов> ) </FONT>"			
		КонецЕсли;		
		//Аверсон 05.12.2022 КВВ СВФР-009956 )
		
		//Аверсон 07.04.2023 КВВ СВФР-010563 (
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавкиДляВакантнойДолжности Тогда
		Если Режим = "Текст" Тогда
			
			//Аверсон ЕАЕ 20.09.2024 СВФР-013560
			//СтрокаФормулы = "<Процент> * ( (<Тарифная ставка 1 разряда вакантной должности> * <Тарифный коэффициент вакантной должности>) / <Норма рабочих часов> * <Отработано часов> )";
			СтрокаФормулы = "<Процент> * ( (<Тарифная ставка 1 разряда вакантной должности> * <Тарифный коэффициент вакантной должности> * <Кол-во ставок вакантной должности>) / <Норма рабочих часов> * <Отработано часов> )";								
			//Аверсон СВФР-013560
			
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			
			//Аверсон ЕАЕ 20.09.2024 СВФР-013560
			//|Результат = <FONT color=#993366><Процент></FONT> умножить на <FONT color=#993366> ( ( <Тарифная ставка 1 разряда вакантной должности></FONT> умножить на <FONT color=#993366><Тарифный коэффициент вакантной должности> ) </FONT> разделить на <FONT color=#993366> <Норма рабочих часов></FONT> умножить на <FONT color=#993366><Отработано часов> ) </FONT>"			
			|Результат = <FONT color=#993366><Процент></FONT> умножить на <FONT color=#993366> ( ( <Тарифная ставка 1 разряда вакантной должности></FONT> умножить на <FONT color=#993366><Тарифный коэффициент вакантной должности></FONT> умножить на <FONT color=#993366><Кол-во ставок вакантной должности>) </FONT> разделить на <FONT color=#993366> <Норма рабочих часов></FONT> умножить на <FONT color=#993366><Отработано часов> ) </FONT>"			
			//Аверсон СВФР-013560
			
		КонецЕсли;	
		//Аверсон 07.04.2023 КВВ СВФР-010563 )
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка/оклад расчетный> * <Отработанное время в часах> * Процент от стажа"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка (оклад)></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT> умножить на <FONT color=#993366><Процент от стажа></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредность Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка 1 разряда по предприятию> * <Отработанное время во вредных условиях в часах> * Процент"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка 1 разряда по предприятию></FONT> умножить на <FONT color=#993366><Отработанное время во вредных условиях в часах></FONT> умножить на <FONT color=#993366><Процент></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредностьОтОтработанногоВремени Тогда //О.Т. Аверсон 02.04.2016 № 972
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка 1 разряда по предприятию> * <Отработанное время во вредных условиях в часах> * Процент / Норма часов"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка 1 разряда по предприятию></FONT> умножить на <FONT color=#993366><Отработанное время во вредных условиях в часах></FONT> умножить на <FONT color=#993366><Процент></FONT> делить на <FONT color=#993366><Норму часов></FONT>"			
		КонецЕсли;
		//О.Т. Аверсон 04.11.2016 № 1501
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1РазрядаОтрВр Тогда //О.Т. Аверсон 02.04.2016 № 972
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка 1 разряда> * <Отработанное время> * Процент / Норма времени"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка 1 разряда></FONT> умножить на <FONT color=#993366><Отработанное время></FONT> умножить на <FONT color=#993366><Процент></FONT> делить на <FONT color=#993366><Норму времени></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаИзБюджета Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Доплата из бюджета> * <Отработанное время>  / Норма времени"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Доплата из бюджета></FONT> умножить на <FONT color=#993366><Отработанное время></FONT> делить на <FONT color=#993366><Норму времени></FONT>"			
		КонецЕсли;
		//О.Т. Аверсон 04.11.2016 № 1501
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаБригаду Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка 1 разряда по организации> * <Отработанное время> * Процент"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка 1 разряда по организации></FONT> умножить на <FONT color=#993366><Отработанное время></FONT> умножить на <FONT color=#993366><Процент></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Питание Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Дни> * <Стоимость талона на питание>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Дни></FONT> умножить на <FONT color=#993366><Стоимость талона на питание></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Разъездные Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Дни> * <Сумма разъездных>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Дни></FONT> умножить на <FONT color=#993366><Сумма разъездных></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДетскийДень Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Оплата детского дня за час> * <Часы>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Оплата детского дня за час></FONT> умножить на <FONT color=#993366><Часы></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.РаспределениеПремииПоКТУ Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Коэффициент> * <Сумму премии>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Коэффициент></FONT> умножить на <FONT color=#993366><Сумму премии></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке4Разряда Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка 4 разряда> * <Отработанное время в часах>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка 4 разряда></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПрямойСдельныйЗаработок Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Прямой сдельный заработок>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Прямой сдельный заработок></FONT>"			
		КонецЕсли;
		
		//Конец Толик
		
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРабМатериОдиночкеДо3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Пособие на ребенка не работающей матери-одиночке  до 3 лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Пособие на ребенка не работающей матери-одиночке  до 3 лет></FONT>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНеРаботающейМатериДо3Лет Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<ПособиеНеРаботающейМатериДо3Лет>";
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><ПособиеНеРаботающейМатериДо3Лет></FONT>"
		КонецЕсли;
		//Островская Татьяна 20.03.2013 № 16341
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаЗаместительство Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Расчет в зависимости от выбранного варианта в документе.>";
			//"(<Должностной (тарифный) оклад замещаемого> - <Должностной (тарифный) оклад замещающего>)/ <Норма времени за месяц в часах> * <Отработанное время в часах>"	
			
		Иначе               
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Расчет в зависимости от выбранного варианта в документе.> "
			
			//|Результат = <FONT color=#993366><Должностной (тарифный) оклад замещаемого></FONT> вычесть <FONT color=#993366><Должностной (тарифный) оклад замещающего></FONT>  делить на <FONT color=#993366><Норма времени за месяц в часах></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT>"
		КонецЕсли;
		
		//О.Т. Аверсон 26.10.2017 № 1158
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.РазницаВОкладах Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "(<Оклад замещаемого> - <Оклад замещающего>)/ <Норма времени за месяц в часах> * <Отработанное время в часах>"
			
		Иначе               
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Оклад замещаемого></FONT> вычесть <FONT color=#993366><Оклад замещающего></FONT>  делить на <FONT color=#993366><Норма времени за месяц в часах></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT>"
		КонецЕсли;
		//О.Т. Аверсон 26.10.2017 № 1158
		
		
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоОкладу Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка (оклад) замещаемого> / <Норма времени за месяц в часах> * <Отработанное время в часах>  * <Процент доплаты> "	
		Иначе               
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка (оклад) замещаемого></FONT>  делить на <FONT color=#993366><Норма времени за месяц в часах></FONT> умножить на <FONT color=#993366><Отработанное время в часах></FONT> умножить на <FONT color=#993366><Процент доплаты>"
		КонецЕсли;
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоТарифу Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы =  "<Часовая тарифная ставка замещаемого> * <Отработанное время в часах>  * <Процент доплаты> "	
		Иначе               
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Часовая тарифная ставка замещаемого></FONT>  умножить на <FONT color=#993366><Отработанное время в часах></FONT> умножить на <FONT color=#993366><Процент доплаты>"
		КонецЕсли;	
		//Островская Татьяна 20.03.2013 № 16341	
		//Островская Татьяна 25.03.2013 № 16351
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы =  "<Полные годы работы по шкале стажа> * <Сумма за год стажа>  / <Норма времени по графику> * <Отработанное время> "	
		Иначе               
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Полные годы работы по шкале стажа></FONT>  умножить на <FONT color=#993366><Сумма за год стажа></FONT> делить на <FONT color=#993366><Норма времени по графику></FONT>  умножить на <FONT color=#993366><Отработанное время></FONT>"
		КонецЕсли;	
		//Островская Татьяна 25.03.2013 № 16351
		
		//Аверсон 10.02.2023 КВВ СВФР-010320 (
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплатыИнвалидам1и2гр Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "Максимум(<Минимальная зарплата часовая РБ для инвалидов I и II гр.> * <Отработанное время в часах> - <Расчетная база>,<0>)"	
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат =  Максимум(<FONT color=#993366><Минимальная зарплата часовая РБ для инвалидов I и II гр.></FONT> умножить на <FONT color=#993366>Отработанное время в часах></FONT> вычесть <FONT color=#993366> <Расчетная база> </FONT>,<FONT color=#993366><0>)</FONT> (отработанное время из начисления)"			
		КонецЕсли;	
		//Аверсон 10.02.2023 КВВ СВФР-010320 )
		
		//О.Т. Аверсон 15.10.2015 № 637
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты Тогда
		
		
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "Максимум(<Часовая минимальная зарплата > * <Отработанное время в часах> - <Расчетная база>,<0>)"	
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат =  Максимум(<FONT color=#993366><Часовая минимальная зарплата ></FONT>  умножить на <FONT color=#993366>Отработанное время в часах></FONT> вычесть <FONT color=#993366> <Расчетная база> </FONT>,<FONT color=#993366><0>)</FONT> (отработанное время из начисления)"			
		КонецЕсли;	
		
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМЗПотМесячнойМЗП Тогда
		
		
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "Максимум(<Месячная минимальная зарплата > / <Норма времени за месяц в часах> * <Отработанное время в часах> - <Расчетная база>,<0>)"	
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат =  Максимум(<FONT color=#993366><Месячная минимальная зарплата ></FONT> делить на <FONT color=#993366><Норма времени за месяц в часах></FONT>  умножить на <FONT color=#993366><Отработанное время в часах></FONT> вычесть <FONT color=#993366> <Расчетная база> </FONT>,<FONT color=#993366><0>)</FONT>"			
		КонецЕсли;
		
		//+ СВЭЙ КДЯ 09.10.19 СВФР-004842
	ИначеЕсли  СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоМЗПотСреднегодовойГрафика Тогда
		
		
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "Максимум(<Месячная минимальная зарплата > / <Среднегодовая норма времени в часах> * <Отработанное время в часах> - <Расчетная база>,<0>)"	
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат =  Максимум(<FONT color=#993366><Месячная минимальная зарплата ></FONT> делить на <FONT color=#993366><Среднегодовая норма времени в часах></FONT>  умножить на <FONT color=#993366><Отработанное время в часах></FONT> вычесть <FONT color=#993366> <Расчетная база> </FONT>,<FONT color=#993366><0>)</FONT>"			
		КонецЕсли;
		
		//- СВЭЙ КДЯ 09.10.19 СВФР-004842
		
		
		//О.Т. Аверсон 15.10.2015 № 637
	ИначеЕсли Объект.ПроизвольнаяФормулаРасчета Тогда
		
		ФормулаРасчета	= Объект.ФормулаРасчета;
		
		ФормулаРасчета	= СтрЗаменить(ФормулаРасчета, "ПроведениеРасчетов.", "");
		
		СимволыДляЗамены = "/=-+*()?<,";
		
		Если Режим = "Текст" Тогда
			
			// заменим подставим вместо ИсходныеДанные.ПоказательN нужные показатели
			СтрокаФормулы = ПолучитьHTLMКодФормулыРасчета(ФормулаРасчета, Объект.Показатели, Режим);
			
		Иначе
			
			НоваяФормулаРасчета = "";
			Для НомерСимвола = 1 По СтрДлина(ФормулаРасчета) Цикл
				Символ = Сред(ФормулаРасчета,НомерСимвола,1);
				Если Найти(СимволыДляЗамены,Символ) > 0 Тогда
					НоваяФормулаРасчета = НоваяФормулаРасчета + "<FONT color=#FF0000>" + Символ + "</FONT>"; 
				Иначе
					НоваяФормулаРасчета = НоваяФормулаРасчета + Символ;
				КонецЕсли;
			КонецЦикла;	
			
			ФормулаРасчета = НоваяФормулаРасчета;
			
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " NOT ", "<FONT color=#FF0000> NOT </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " OR ", "<FONT color=#FF0000> OR </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " AND ", "<FONT color=#FF0000> AND </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " И ", "<FONT color=#FF0000> И </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " ИЛИ ", "<FONT color=#FF0000> ИЛИ </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " НЕ ", "<FONT color=#FF0000> НЕ </FONT>"); 
			
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " not ", "<FONT color=#FF0000> not </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " or ", "<FONT color=#FF0000> or </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " and ", "<FONT color=#FF0000> and </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " и ", "<FONT color=#FF0000> и </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " или ", "<FONT color=#FF0000> или </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " не ", "<FONT color=#FF0000> не </FONT>");
			
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " Not ", "<FONT color=#FF0000> Not </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " Or ", "<FONT color=#FF0000> Or </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " And ", "<FONT color=#FF0000> And </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " Или ", "<FONT color=#FF0000> Или </FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, " Не ", "<FONT color=#FF0000> Не </FONT>");		
			
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, "Цел", "<FONT color=#0000ff>Цел</FONT>"); 
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, "Окр", "<FONT color=#0000ff>Окр</FONT>");
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, "Макс", "<FONT color=#0000ff>Макс</FONT>");
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, "Мин", "<FONT color=#0000ff>Мин</FONT>");
			ФормулаРасчета = СтрЗаменить(ФормулаРасчета, "ОценитьПо", "<FONT color=#0000ff>ОценитьПо</FONT>");		
			
			СтрокаФормулы = СтрокаФормулы + "Результат = " +  ПолучитьHTLMКодФормулыРасчета(ФормулаРасчета, Объект.Показатели, Режим);
			
		КонецЕсли;
		// заявка №1602 (база заявок Кристалла) Дмитрук О.Г.  
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1Разряда Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка 1 разряда по предприятию> * Процент"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка 1 разряда по предприятию></FONT> умножить на <FONT color=#993366><Процент></FONT>"			
		КонецЕсли;
		// заявка №1602		
		
		// заявка №1676 (база заявок Кристалла) Дмитрук О.Г.  
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки1РазрядаПоРаботнику Тогда //О.Т. Аверсон 07.09.2016 № 1436
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка 1 разряда по работнику> * Процент"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка 1 разряда по работнику></FONT> умножить на <FONT color=#993366><Процент></FONT>"			
		КонецЕсли;
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ВоинскоеЗвание Тогда //О.Т. Аверсон 18.05.2017 № 592
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Базовый оклад> * <Коэффициент> * <Отработанное время>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Базовый оклад></FONT> умножить на <FONT color=#993366><Коэффициент></FONT>умножить на <FONT color=#993366><Отработанное время></FONT>"			
		КонецЕсли;
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.КоэффициентОтБазовогоОкладаОтОтрабВр Тогда //О.Т. Аверсон 18.05.2017 № 592
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Базовый оклад> * <Коэффициент> * <Отработанное время>/<Норма>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Базовый оклад></FONT> умножить на <FONT color=#993366><Коэффициент></FONT>умножить на <FONT color=#993366><Отработанное время></FONT>делить на <FONT color=#993366><Норма></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.КоэффициентОтТарифнойСтавки1РазрядаОтОтрабВр Тогда //О.Т. Аверсон 18.05.2017 № 592
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Тарифная ставка 1 разряда> * <Коэффициент> * <Отработанное время>/<Норма>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Тарифная ставка 1 разряда></FONT> умножить на <FONT color=#993366><Коэффициент></FONT>умножить на <FONT color=#993366><Отработанное время></FONT>делить на <FONT color=#993366><Норма></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СуточныйНаряд Тогда //О.Т. Аверсон 18.05.2017 № 594
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Базовый оклад> * <Коэффициент>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Базовый оклад></FONT> умножить на <FONT color=#993366><Коэффициент></FONT>"			
		КонецЕсли;
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.МПЕПО Тогда //О.Т. Аверсон 18.05.2017 № 594
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Расчетная база> * <Коэффициент>"								
		Иначе
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Расчетная база></FONT> умножить на <FONT color=#993366><Коэффициент></FONT>"			
		КонецЕсли;
		
		
	ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеФиксированнойСуммойОтБазы Тогда
		Если Режим = "Текст" Тогда
			СтрокаФормулы = "<Фиксированная сумма (натурального продукта)>, от указанного предела";
		Иначе                                       
			СтрокаФормулы = СтрокаФормулы + "
			|Результат = <FONT color=#993366><Фиксированная сумма (натурального продукта)>, от указанного предела</FONT>"
		КонецЕсли;
		// заявка №1676		
		
	Иначе
		СтрокаФормулы = ""	
	КонецЕсли;
	
	Если Режим = "HTML" Тогда
		СтрокаФормулы = СтрокаФормулы + "
		|</font></html>"
	КонецЕсли;
	
	
	Возврат СтрокаФормулы;
	
КонецФункции // ВизуализироватьФормулуРасчета()

// Процедура обеспечивает ввод формульных начислений и удержаний
Процедура УстановитьПараметрыВидаРасчета(Параметр, Объект, Элементыформы) Экспорт
	
	Объект.ФормулаРасчета				= Параметр[0];
	Объект.СпособРасчета 				= Перечисления.СпособыРасчетаОплатыТруда.ПроизвольнаяФормула;
	Объект.ПроизвольнаяФормулаРасчета	= Истина;
	
	ПарамПоказатели = Параметр[1];
	
	ОбъектПоказатели = Объект.Показатели;
	ОбъектПоказатели.Очистить();
	Для Каждого ОбъектПоказатель Из ОбъектПоказатели Цикл
		Если ПарамПоказатели.Найти(ОбъектПоказатель.Показатель) = Неопределено Тогда
			ОбъектПоказатель.Показатель = Справочники.ПоказателиСхемМотивации.ПустаяСсылка();
		КонецЕсли;
	КонецЦикла;
	Для Каждого Показатель Из ПарамПоказатели Цикл
		Если ОбъектПоказатели.Найти(Показатель,"Показатель") = Неопределено Тогда
			НовыйПоказатель				= Объект.Показатели.Добавить();
			
			Если Показатель.ТипПоказателя <> Перечисления.ТипыПоказателейСхемМотивации.ОценочнаяШкалаПроцентная И
				Показатель.ТипПоказателя <> Перечисления.ТипыПоказателейСхемМотивации.ОценочнаяШкалаЧисловая И
				Показатель.ВозможностьИзменения <> Перечисления.ИзменениеПоказателейСхемМотивации.ВводитсяПриРасчете И
				Показатель.ВозможностьИзменения <> Перечисления.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете Тогда
				
				Если (Показатель.ТарифнаяСтавка Или Показатель = Справочники.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная Или
					Показатель = Справочники.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая Или
					Показатель = Справочники.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная) Тогда
					Если Объект.Метаданные().Реквизиты.Найти("ЗачетОтработанногоВремени") = Неопределено Тогда
						НовыйПоказатель.ЗапрашиватьПриКадровыхПеремещениях = Ложь;
					ИначеЕсли Объект.ЗачетОтработанногоВремени Тогда
						НовыйПоказатель.ЗапрашиватьПриКадровыхПеремещениях = Истина;
					ИНаче
						НовыйПоказатель.ЗапрашиватьПриКадровыхПеремещениях = Ложь;
					КонецЕсли;
				Иначе
					НовыйПоказатель.ЗапрашиватьПриКадровыхПеремещениях = Истина;
				КонецЕсли;
			КонецЕсли;
			НовыйПоказатель.Показатель	= Показатель;
		КонецЕсли;
	КонецЦикла;
	
	Элементыформы.СпособРасчетаПредставление.УстановитьТекст(ВизуализироватьФормулуРасчета(Объект, "HTML"));
	
КонецПроцедуры


Процедура ПроверкаПоказателейВПлановыхНачислениях(ВыборкаПоСтрокамДокумента, СтрокаНачалаСообщенияОбОшибке, ЭтоНачисление, Отказ, Заголовок, ИспользуютсяНачисленияВВалюте, СоответствиеВалютныеСпособыРасчета = Неопределено) Экспорт
	
	Если ВыборкаПоСтрокамДокумента.ПроизвольнаяФормулаРасчета Тогда
		Для СчПоказателя = 1 По Мин(ВыборкаПоСтрокамДокумента.КоличествоПоказателей, 6) Цикл
			ТипПоказателя = ВыборкаПоСтрокамДокумента["Показатель" + СчПоказателя + "ТипПоказателя"];
			ВозможностьИзменения = ВыборкаПоСтрокамДокумента["Показатель" + СчПоказателя + "ВозможностьИзменения"];
			ЗапрашиватьПриКадровыхПеремещениях = ВыборкаПоСтрокамДокумента["Показатель" + СчПоказателя + "ЗапрашиватьПриКадровыхПеремещениях"];
			Если ВозможностьИзменения = Перечисления.ИзменениеПоказателейСхемМотивации.НеИзменяется И ЗапрашиватьПриКадровыхПеремещениях
				Или ВозможностьИзменения = Перечисления.ИзменениеПоказателейСхемМотивации.ИзменяетсяПриРасчете	Тогда
				
				// проверка постоянных показателей
				Если ВыборкаПоСтрокамДокумента["Показатель" + СчПоказателя] = 0 Тогда
					// размер 
					Если Не ВыборкаПоСтрокамДокумента["Показатель" + СчПоказателя + "Предопределенный"]
						и ТипПоказателя <> Перечисления.ТипыПоказателейСхемМотивации.ОценочнаяШкалаПроцентная
						и ТипПоказателя <> Перечисления.ТипыПоказателейСхемМотивации.ОценочнаяШкалаЧисловая
						и ТипПоказателя <> Перечисления.ТипыПоказателейСхемМотивации.ТарифныйРазряд Тогда
						ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + " не указан размер показателя " + ВыборкаПоСтрокамДокумента["Показатель" + СчПоказателя+"Наименование"], Отказ, Заголовок);
					КонецЕсли;
				КонецЕсли;
				Если ЭтоНачисление Тогда
					Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента["ТарифныйРазряд" + СчПоказателя])
						и ТипПоказателя = Перечисления.ТипыПоказателейСхемМотивации.ТарифныйРазряд Тогда
						ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан размер тарифа " + ВыборкаПоСтрокамДокумента["Показатель" + СчПоказателя+"Наименование"], Отказ, Заголовок);
					КонецЕсли;	
				КонецЕсли;	
				// валюта (для денежного показателя)
				Если ИспользуютсяНачисленияВВалюте Тогда
					Если ТипПоказателя = Перечисления.ТипыПоказателейСхемМотивации.Денежный 
						и НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента["Валюта" + СчПоказателя]) 
						и ТипПоказателя <> Перечисления.ТипыПоказателейСхемМотивации.ТарифныйРазряд Тогда
						ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке +  "не указана валюта!", Отказ, Заголовок);
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
	Иначе
		Если ИспользуютсяНачисленияВВалюте Тогда
			// Валюта
			Если ВыборкаПоСтрокамДокумента.КоличествоПоказателей > 0 
				И (Не ЭтоНачисление Или Не ВыборкаПоСтрокамДокумента.ТребуетВводаТарифногоРазряда)
				И Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.Валюта1) 
				И СоответствиеВалютныеСпособыРасчета[ВыборкаПоСтрокамДокумента.СпособРасчета] 
				И СпособРасчетаТребуетРазмер(ВыборкаПоСтрокамДокумента.СпособРасчета) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не задана валюта!", Отказ, Заголовок);
			КонецЕсли;
		КонецЕсли;
		
		// Размер оплаты
		Если ВыборкаПоСтрокамДокумента.КоличествоПоказателей > 0 И ВыборкаПоСтрокамДокумента.Действие <> Перечисления.ВидыДействияСНачислением.Прекратить И СпособРасчетаТребуетРазмер(ВыборкаПоСтрокамДокумента.СпособРасчета) Тогда
			Если ЭтоНачисление И ВыборкаПоСтрокамДокумента.Показатель1 = 0 и Не ВыборкаПоСтрокамДокумента.ТребуетВводаТарифногоРазряда Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан размер начисления!", Отказ, Заголовок);
			ИначеЕсли ЭтоНачисление И ВыборкаПоСтрокамДокумента.ТарифныйРазряд1.Пустая() И ВыборкаПоСтрокамДокумента.ТребуетВводаТарифногоРазряда Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан разряд!", Отказ, Заголовок);
			ИначеЕсли Не ЭтоНачисление И ВыборкаПоСтрокамДокумента.Показатель1 = 0 Тогда 
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан размер удержания!", Отказ, Заголовок);
			КонецЕсли;
		КонецЕсли;
		
		
	КонецЕсли;
	
КонецПроцедуры //ПроверкаПоказаетелей

////////////////////////////////////////////////////////////////////////////////
// ИСПРАВЛЕНИЕ ДОКУМЕНТОВ

// Функция получает документ(ы), которым был исправлен расчетный документ
//
// Параметры
//  ДокументСсылка - ссылка на документ, включенный в механизм исправлений
//  Режим - строка, допустимые значения: "КритерийОтбора", "ТаблицаДокумента" 
//  ИмяДокумента - имя соответствующего объекта метаданных
//
// Возвращаемое значение:
//   Режим = "КритерийОтбора": массив документов-исправлений, возможно, пустой.
//   Режим = "ТаблицаДокумента": ссылка на документ того же вида, что и переданный параметр; 
//   или Неопределено, если документ-исправление не найден.
//
Функция ПолучитьДокументИсправление(ДокументСсылка = Неопределено, Режим = Неопределено, ИмяДокумента = Неопределено) Экспорт 
	
	Если Не ЗначениеЗаполнено(ДокументСсылка) Тогда
		Возврат Неопределено	
	КонецЕсли;	
	
	Если Режим = Неопределено Тогда
		Режим = ?(ДокументСсылка.Метаданные().Реквизиты.Найти("Сотрудник") = Неопределено, "КритерийОтбора","ТаблицаДокумента")	
	КонецЕсли;
	
	Если Режим = "КритерийОтбора" Тогда
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	ДокументыИсправления.Ссылка
		|ИЗ
		|	КритерийОтбора.ДокументыИсправления(&ИсходныйДокумент) КАК ДокументыИсправления
		|";
	ИначеЕсли Режим = "ТаблицаДокумента" Тогда
		Если Не ЗначениеЗаполнено(ИмяДокумента) Тогда
			ИмяДокумента = ДокументСсылка.Метаданные().Имя;
		КонецЕсли;
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	ДокументыИсправления.Ссылка
		|ИЗ
		|	Документ." + ИмяДокумента + " КАК ДокументыИсправления
		|ГДЕ
		|	ДокументыИсправления.ПерерассчитываемыйДокумент = &ИсходныйДокумент";
	Иначе
		Возврат Неопределено	
	КонецЕсли;
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.УстановитьПараметр("ИсходныйДокумент",ДокументСсылка);
	Результат = Запрос.Выполнить();
	
	Если Режим = "КритерийОтбора" Тогда
		Возврат Результат.Выгрузить().ВыгрузитьКолонку("Ссылка");
	Иначе
		Выборка = Результат.Выбрать();
		Если Выборка.Следующий() Тогда
			Возврат Выборка.Ссылка
		Иначе
			Возврат Неопределено	
		КонецЕсли;
	КонецЕсли;
	
КонецФункции

// Функция получает документ(ы), которым был исправлен расчетный документ
//
// Параметры
//  ДокументСсылка - ссылка на документ, включенный в механизм исправлений
//  Режим - строка, допустимые значения: "КритерийОтбора", "ТаблицаДокумента" 
//
// Возвращаемое значение:
//   Режим = "КритерийОтбора": массив документов-исправлений, возможно, пустой.
//   Режим = "ТаблицаДокумента": ссылка на документ того же вида, что и переданный параметр; 
//   или Неопределено, если документ-исправление не найден.
//
Функция ПолучитьДокументСторнирование(ДокументСсылка = Неопределено) Экспорт 
	
	Если Не ЗначениеЗаполнено(ДокументСсылка) Тогда
		Возврат Неопределено	
	КонецЕсли;	
	
	Запрос = Новый Запрос();
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ДокументыИсправления.Ссылка
	|ИЗ
	|	Документ.Сторнирование КАК ДокументыИсправления
	|ГДЕ
	|	ДокументыИсправления.СторнируемыйДокумент = &ИсходныйДокумент";
	
	Запрос.УстановитьПараметр("ИсходныйДокумент",ДокументСсылка);
	
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		Возврат Выборка.Ссылка
	Иначе
		Возврат Документы.Сторнирование.ПустаяСсылка()
	КонецЕсли;
	
КонецФункции

// Определяет, можно ли изменять документ "задним числом", т.е. проверяет
//   отсутствие исправлений и сторнирований.
//
// Параметры
//  ДокументСсылка - ссылка на документ, включенный в механизм исправлений
//  ОписаниеПричиныОтказа - переменная, куда возвращается описание проблемы
//
// Возвращаемое значение:
//  булево
//
Функция ДокументНельзяИзменятьЗаднимЧислом(ДокументСсылка = Неопределено, ОписаниеПричиныОтказа = "") Экспорт 
	
	ОписаниеПричиныОтказа = "";
	Если Не ЗначениеЗаполнено(ДокументСсылка) Тогда
		Возврат Ложь
	ИначеЕсли ЗначениеЗаполнено(ПолучитьДокументИсправление(ДокументСсылка)) Тогда
		ОписаниеПричиныОтказа = "Документ был исправлен, перерасчет документа ""задним числом"" запрещен!";
		Возврат Истина
	ИначеЕсли ЗначениеЗаполнено(ПолучитьДокументСторнирование(ДокументСсылка)) Тогда
		ОписаниеПричиныОтказа = "Документ был сторнирован, перерасчет документа ""задним числом"" запрещен!";
		Возврат Истина
	КонецЕсли;
	
	Возврат Ложь
	
КонецФункции



// Выбирает из документов-исправлений сотрудников и помещает их в соответствие
//
// Параметры
//  ТекстЗапроса - строка. содержит текст запроса выора сотрудников
//  ДокументыИсправления - массив документов-исправлений
//  ИмяПоля - строка, имя поля запроса, содержащего сотрудника
//  ИмяПараметра - строка, имя параметра запроса, содержащего документы-исправления
//
// Возвращаемое значение:
//   Соответствие с сотрудниками документов исправлений
//
Функция СформироватьСоответствиеСотрудниковСИсправлениями(ТекстЗапроса = "", ДокументыИсправления = Неопределено, ИмяПоля = "Сотрудник", ИмяПараметра = "Исправления") Экспорт
	
	Сотрудники = Новый Соответствие;
	
	Если ПустаяСтрока(ТекстЗапроса) Или Не ЗначениеЗаполнено(ДокументыИсправления) Тогда
		Возврат	Сотрудники
	КонецЕсли;
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.УстановитьПараметр(ИмяПараметра,ДокументыИсправления);
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		Сотрудники.Вставить(Выборка[ИмяПоля], Истина);
	КонецЦикла;
	
	Возврат Сотрудники
	
КонецФункции // СформироватьСоответствиеСотрудниковСИсправлениями()

// Обработчик подписки ПередЗаписьюДокументаИсправление
// 
Процедура ПередЗаписьюДокументаПроверкаИсправленногоДокумента(Источник, Отказ, РежимЗаписи, РежимПроведения) Экспорт
	Если РежимЗаписи = РежимЗаписиДокумента.ОтменаПроведения Или РежимЗаписи = РежимЗаписиДокумента.Проведение Тогда
		Если ЗначениеЗаполнено(ПолучитьДокументИсправление(Источник.Ссылка)) Тогда
			Если РежимЗаписи = РежимЗаписиДокумента.Проведение Тогда
				ТекстСообщенияОбОшибке = "Документ был исправлен, проведение документа запрещено!";
			Иначе 	
				ТекстСообщенияОбОшибке = "Документ был исправлен, отмена проведения документа запрещена!";
			КонецЕсли;
			ОбщегоНазначения.СообщитьОбОшибке(ТекстСообщенияОбОшибке, Отказ);
		ИначеЕсли ЗначениеЗаполнено(ПолучитьДокументСторнирование(Источник.Ссылка)) Тогда
			Если РежимЗаписи = РежимЗаписиДокумента.Проведение Тогда
				ТекстСообщенияОбОшибке = "Документ был сторнирован, проведение документа запрещено!";
			Иначе 	
				ТекстСообщенияОбОшибке = "Документ был сторнирован, отмена проведения документа запрещена!";
			КонецЕсли;
			ОбщегоНазначения.СообщитьОбОшибке(ТекстСообщенияОбОшибке, Отказ);
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры

// Проверяет соответствует ли указанный код вычета коду дохода по НДФЛ
//
// Параметры
//  КодДохода - тип СправочникСсылка.ДоходыНДФЛ, код дохода
//  КодВычета - тип СправочникСсылка.ВычетыНДФЛ, проверяемый код вычета
//
// Возвращаемое значение:
//   булево - ответ на вопрос "соответствует ли?"
//
Функция ВычетСоответствуетДоходу(КодДохода = Неопределено, КодВычета = Неопределено, СоответствиеДоходовИВычетов = Неопределено) Экспорт
	
	Возврат КодВычета = КодДохода.КодВычета;
	
КонецФункции // ПроверитьСоответствиеДоходаИВычета()

// Выбирает все зарегистрированные в ИБ категории расчета кроме Справочники.КатегорииРасчетов.Первичное
//
// Параметры
//  нет
//
// Возвращаемое значение:
//   список значений с категориями для выбора
//
Функция ПолучитьСписокЗависимыхКатегорийРасчета() Экспорт
	
	// Установим значение переключателя "ОчередностьНачисления" и список выбора для реквизита "КатегорияРасчета"
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Первичное", Справочники.КатегорииРасчетов.Первичное);
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	КатегорииРасчетов.Ссылка,
	|	КатегорииРасчетов.Наименование
	|ИЗ
	|	Справочник.КатегорииРасчетов КАК КатегорииРасчетов
	|ГДЕ
	|	КатегорииРасчетов.Ссылка <> &Первичное
	|
	|УПОРЯДОЧИТЬ ПО
	|	КатегорииРасчетов.Код";
	Категории = Запрос.Выполнить().Выбрать();
	СписокКатегорийРасчета = Новый СписокЗначений;
	Пока Категории.Следующий() Цикл
		СписокКатегорийРасчета.Добавить(Категории.Ссылка, Категории.Наименование);
	КонецЦикла;
	
	Возврат СписокКатегорийРасчета
	
КонецФункции // ПолучитьСписокВычетовКДоходам()

Функция ПолучитьСписокНеДопустимыхВР() Экспорт //Островская Татьяна 20.03.2013 № 16341
	
	СписокНедопустимыхВР = Новый СписокЗначений;
	СписокНедопустимыхВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные);
	
	Запрос = Новый Запрос;
	СпособыРасчета = Новый Массив;
	СпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаЗаместительство);
	СпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоОкладу);
	СпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаСовмещениеПоТарифу);
	//О.Т. Аверсон 26.10.2017 № 1158
	СпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.РазницаВОкладах);
	//О.Т. Аверсон 26.10.2017 № 1158
	Запрос.УстановитьПараметр("СпособыРасчета",СпособыРасчета);
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ОсновныеНачисленияОрганизаций.Ссылка КАК ВидРасчета
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияОрганизаций.СпособРасчета В(&СпособыРасчета)";
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		СписокНедопустимыхВР.Добавить(Выборка.ВидРасчета);
	КонецЦикла;
	
	Возврат СписокНедопустимыхВР
	
КонецФункции //Островская Татьяна 20.03.2013 № 16341

Функция ПолучитьКалендарныеДниБезОтпускаБольничного(Сотрудник,Дата, УсловиеДляБПМ,ДатаНачалаДоговора = Неопределено,ДатаОкончанияДоговора = Неопределено,СообщениеОПересечении) Экспорт //Островская Татьяна 12.09.2013 № 16778  //Аверсон 27.12.2021 КВВ СВФР-008547 (СообщениеОПересечении)
	ДниИсключение = 0;
	ДеньПриема = 0;
	//ЗапросДниИзРегРасчета = Новый Запрос;
	//ЗапросДниИзРегРасчета.Текст = 
	ЗапросИсклДни = Новый Запрос;
	ЗапросИсклДни.Текст =
	"ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.Дней > 0
	|			ТОГДА РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) + 1 - ВложенныйЗапрос.Дней
	|		ИНАЧЕ РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) + 1
	|	КОНЕЦ КАК Дней,
	//Аверсон 07.07.2020 КВВ СВФР-006227 (
	|	ВЫБОР КОГДА СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОплаченоДней) <> 0 
	|		ТОГДА СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОплаченоДней) ИНАЧЕ
	|		СУММА(ОсновныеНачисленияРаботниковОрганизаций.НормаДней) 
	|	КОНЕЦ КАК ДнейФакт,
	//Аверсон 07.07.2020 КВВ СВФР-006227 )
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
	|	СУММА(ВЫБОР
	|	КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(перечисление.ВидыДнейПроизводственногоКалендаря.праздник)
	//(начало) закомментировано Кухарчуком Д.Я. 08.08.18, Задача СВФР-002275 
	//|			И НЕ(ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(справочник.Классификаториспользованиярабочеговремени.основнойотпуск)
	//|					ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(справочник.Классификаториспользованиярабочеговремени.Болезнь)
	//|					ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(справочник.Классификаториспользованиярабочеговремени.ДополнительныйОтпуск))
	//(конец ) закомментировано Кухарчуком Д.Я. 08.08.18, Задача СВФР-002275
	//(начало) добавлено Кухарчуком Д.Я. 08.08.18, Задача СВФР-002275 
	|			И (ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(справочник.Классификаториспользованиярабочеговремени.основнойотпуск)
	|					ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(справочник.Классификаториспользованиярабочеговремени.ДополнительныйОтпуск))
	//(конец ) добавлено Кухарчуком Д.Я. 08.08.18, Задача СВФР-002275
	|		ТОГДА 1
	|	ИНАЧЕ 0
	|	КОНЕЦ) КАК ДниПраздники,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ПериодДействияНачало,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ПериодДействияКонец,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
	|		ПО ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало <= РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
	|			И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец >= РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) + 1 КАК Дней,
	|			ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
	|			СУММА(ВЫБОР
	|					КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(перечисление.ВидыДнейПроизводственногоКалендаря.праздник)
	|						ТОГДА 1
	|					ИНАЧЕ 0
	|				КОНЕЦ) КАК ДниПраздники,
	|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ПериодДействияНачало,
	|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ПериодДействияКонец,
	|			ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации КАК ПериодРегистрации,
	|			ОсновныеНачисленияРаботниковОрганизаций.Сторно КАК Сторно,
	|			ВЫБОР
	|				КОГДА ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент = НЕОПРЕДЕЛЕНО
	|						ИЛИ ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент, 1) = 1
	|					ТОГДА ОсновныеНачисленияРаботниковОрганизаций.Регистратор
	|				ИНАЧЕ ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент
	|			КОНЕЦ КАК СторнируемыйДокумент,
	|			ВЫБОР
	|				КОГДА ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент = НЕОПРЕДЕЛЕНО
	|						ИЛИ ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент, 1) = 1
	|					ТОГДА 1
	|				ИНАЧЕ 0
	|			КОНЕЦ КАК Вытеснение,
	|			ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета
	|		ИЗ
	|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
	|				ПО ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало <= РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
	|					И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец >= РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
	|		ГДЕ
	|			ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчетаИсклСторно)
	|			И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
	|			И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &Период И &Период1
	|			И ОсновныеНачисленияРаботниковОрганизаций.Сторно
	|		
	|		СГРУППИРОВАТЬ ПО
	|			ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
	|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
	|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,
	|			ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
	|			ОсновныеНачисленияРаботниковОрганизаций.Сторно,
	|			РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) + 1,
	|			ВЫБОР
	|				КОГДА ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент = НЕОПРЕДЕЛЕНО
	|						ИЛИ ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент, 1) = 1
	|					ТОГДА ОсновныеНачисленияРаботниковОрганизаций.Регистратор
	|				ИНАЧЕ ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент
	|			КОНЕЦ,
	|			ВЫБОР
	|				КОГДА ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент = НЕОПРЕДЕЛЕНО
	|						ИЛИ ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент, 1) = 1
	|					ТОГДА 1
	|				ИНАЧЕ 0
	|			КОНЕЦ,
	|			ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета) КАК ВложенныйЗапрос
	|		ПО ОсновныеНачисленияРаботниковОрганизаций.Регистратор = ВложенныйЗапрос.СторнируемыйДокумент
	|		И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = ВложенныйЗапрос.ВидРасчета //О.Т. Аверсон 01.03.2017 № 369
	
	//Аверсон ЕАЕ 15.02.2021 СВФР-007156
	|		И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало = ВложенныйЗапрос.ПериодДействияНачало
	|		И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец = ВложенныйЗапрос.ПериодДействияКонец
	//Аверсон СВФР-007156
	
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчетаИскл)
	|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
	|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &Период И &Период1
	|	И НЕ ОсновныеНачисленияРаботниковОрганизаций.Сторно
	|	И ВЫБОР
	|	КОГДА ВложенныйЗапрос.Дней > 0
	|		ТОГДА РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) + 1 - ВложенныйЗапрос.Дней
	|	ИНАЧЕ РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) + 1
	|	КОНЕЦ <> 0  //О.Т. Аверсон 01.03.2017 № 369
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.Дней > 0
	|			ТОГДА РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) + 1 - ВложенныйЗапрос.Дней
	|		ИНАЧЕ РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) + 1
	|	КОНЕЦ
	|
	|УПОРЯДОЧИТЬ ПО
	|	Дней УБЫВ";
	
	
	
	ЗапросИсклДни.УстановитьПараметр("Сотрудник", Сотрудник);
	ПараметрыОтбора = Новый СписокЗначений;
	ПараметрыОтбораСторно = Новый СписокЗначений;
	//Островская Татьяна 10.09.2013 № 16623
	Если Сотрудник.Организация.ИНН = "800009185" и Дата < Дата(2014,1,1)  Тогда
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
	Иначе
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуБЛ);
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛЛиквидаторамЧАЭС);
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоУходу);
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыПоТКРФ);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.РождениеРебенка);//О.Т. Аверсон 16.08.2018 № 2307
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СмертьБлизкогоРодственника);//О.Т. Аверсон 16.08.2018 № 2307
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоБеременностиИРодам);
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты);
		ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Невыход);
		
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуБЛ);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛЛиквидаторамЧАЭС);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоУходу);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыПоТКРФ);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.РождениеРебенка);//О.Т. Аверсон 16.08.2018 № 2307
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СмертьБлизкогоРодственника);//О.Т. Аверсон 16.08.2018 № 2307
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоБеременностиИРодам);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты);
		ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Невыход);
	КонецЕсли;
	//О.Т. 01.10.2014 № 236
	Для Каждого СтрГруппа из Справочники.ГруппыРасчетов.КаленДниБезОтпИБЛ.Основные Цикл 
		Если не (Сотрудник.Организация.ИНН = "800009185" и Дата < Дата(2014,1,1)) и 
			
			//Аверсон 21.02.2023 КВВ СВФР-010392 (
			//(СтрГруппа.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпКалендарныеДни или
			//СтрГруппа.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпШестидневка) 
			СтрГруппа.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням Тогда
			//Аверсон 21.02.2023 КВВ СВФР-010392 )
			
			Продолжить;
		иначе
			ПараметрыОтбора.Добавить(СтрГруппа.ВидРасчета);
			ПараметрыОтбораСторно.Добавить(СтрГруппа.ВидРасчета);
		КонецЕсли;
	КонецЦикла;
	//О.Т. 01.10.2014 № 236
	ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпКалендарныеДни);
	
	ПараметрыОтбора1 = Новый СписокЗначений;
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.НеоплачиваемыйОтпускПоРазрешениюРаботодателя);
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОсновнойОтпуск);
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускПоБеременностиИРодам);
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускНаОбучение);
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускНаОбучениеНеоплачиваемый);
	
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.НеявкиПоНевыясненнымПричинам);
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ОтпускПоУходуЗаРебенком);
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ДополнительныйОтпуск);
	ПараметрыОтбора1.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Болезнь);
	//Островская Татьяна 10.09.2013 № 16623
	ЗапросИсклДни.УстановитьПараметр("ВидРасчетаИскл", ПараметрыОтбора);
	ЗапросИсклДни.УстановитьПараметр("ВидРасчетаИсклСторно", ПараметрыОтбораСторно);
	ЗапросИсклДни.УстановитьПараметр("ВидИспользованияРВ", ПараметрыОтбора1);
	//О.Т. 09.10.2014 № 17616
	Если ДатаНачалаДоговора = Неопределено Тогда
		ЗапросИсклДни.УстановитьПараметр("Период", НачалоМесяца(Дата));
		ЗапросИсклДни.УстановитьПараметр("Период1", КонецМесяца(Дата));
	Иначе
		ЗапросИсклДни.УстановитьПараметр("Период", ДатаНачалаДоговора);
		ЗапросИсклДни.УстановитьПараметр("Период1", ДатаОкончанияДоговора);
	КонецЕсли;
	//О.Т. 09.10.2014 № 17616
	ТЧДаты = Новый ТаблицаЗначений;
	ТЧДаты.Колонки.Добавить("Дата");
	ТЧДаты.Колонки.Добавить("ВидРасчета");
	ДниИсключение = 0;
	ДниПраздники = 0;
	РезИсклДни = ЗапросИсклДни.Выполнить().Выбрать();
	ТЗ_РезИсклДни =ЗапросИсклДни.Выполнить().Выгрузить();  //Аверсон 07.07.2020 КВВ СВФР-006227
	ДниПраздниковДляСообщения = Новый СписокЗначений;//О.Т. 16.04.2015 для госпиталя
	
	пока РезИсклДни.Следующий() Цикл  
		ДатаНачальная = РезИсклДни.ПериодДействияНачало;
		
		Для счДней=1 по РезИсклДни.Дней Цикл 
			
			СтрокаДата = ТЧДаты.Добавить();
			Отбор = Новый Структура();
			Отбор.Вставить("Дата",ДатаНачальная);
			ПоискДата = ТЧДаты.НайтиСтроки(Отбор);
			если ПоискДата.Количество() =0 Тогда 
				//Аверсон 24.09.2020 КВВ СВФР-006227 (
				ДнейФакт_ТзСтр = 0;
				Для Каждого СтрТЗ_РезИсклДни Из ТЗ_РезИсклДни Цикл
					Если НачалоДня(ДатаНачальная) >= СтрТЗ_РезИсклДни.ПериодДействияНачало
						И КонецДня(ДатаНачальная) <= СтрТЗ_РезИсклДни.ПериодДействияКонец Тогда
						ДнейФакт_ТзСтр = ДнейФакт_ТзСтр + СтрТЗ_РезИсклДни.ДнейФакт;
					КонецЕсли;
				КонецЦикла;
				//Аверсон 24.09.2020 КВВ СВФР-006227 )
				
				//Аверсон 07.07.2020 КВВ СВФР-006227 (
				Если (НЕ Справочники.ГруппыРасчетов.КаленДниБезОтпИБЛ.НеПолныйДеньНеИсклИзКалендарных ИЛИ
					(Справочники.ГруппыРасчетов.КаленДниБезОтпИБЛ.НеПолныйДеньНеИсклИзКалендарных И ДнейФакт_ТзСтр >= 1)) или 
					РезИсклДни.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты Тогда 
					//ТЗ_РезИсклДни.Итог("ДнейФакт") >= 1) Тогда
					//Аверсон 07.07.2020 КВВ СВФР-006227 )
					ДниИсключение = ДниИсключение +1;
					СтрокаДата.Дата = ДатаНачальная;
					СтрокаДата.ВидРасчета = РезИсклДни.ВидРасчета; 
				КонецЕсли;
				//Аверсон 27.12.2021 КВВ СВФР-008547 (
			Иначе
				Если ЗначениеЗаполнено(СообщениеОПересечении) Тогда
					Если Найти(СообщениеОПересечении,Формат(ДатаНачальная, "ДЛФ=Д"))=0 Тогда
						СообщениеОПересечении = СообщениеОПересечении + ", " + Формат(ДатаНачальная, "ДЛФ=Д");
					КонецЕсли;
				Иначе
					СообщениеОПересечении = Формат(ДатаНачальная, "ДЛФ=Д");
				КонецЕсли;
				//Аверсон 27.12.2021 КВВ СВФР-008547 )
			КонецЕсли;
			//О.Т. 16.04.2015 Удалить через полгода
			Если Сотрудник.Организация.ИНН = "100765738" Тогда
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	РегламентированныйПроизводственныйКалендарь.ВидДня,
				|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
				|ИЗ
				|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
				|ГДЕ
				|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря = &ДатаКалендаря";
				
				Запрос.УстановитьПараметр("ДатаКалендаря", ДатаНачальная);
				
				РезультатЗапроса = Запрос.Выполнить();
				
				ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					ВидДня = ВыборкаДетальныеЗаписи.ВидДня;
				КонецЦикла;
				
				Если ВидДня = Перечисления.ВидыДнейПроизводственногоКалендаря.Праздник и РезИсклДни.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет Тогда 
					ДниПраздниковДляСообщения.Добавить(Формат(ДатаНачальная,"ДЛФ=Д"));
				КонецЕсли;
				
				
			КонецЕсли;
			
			ДатаНачальная = ДатаНачальная+86400;
		КонецЦикла;  
		
		//Аверсон 22.11.2021 КВВ СВФР-008408 (
		ПраздничныхДнейВПериоде = РезИсклДни.ДниПраздники;
		Если ПраздничныхДнейВПериоде > 0 
			ИЛИ (ПраздничныхДнейВПериоде = 0 И РезИсклДни.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуБЛ) Тогда //СВЭЙ 27.09.2023 КВВ СВФР-011516
			ЗапросСторноПраздники = Новый Запрос;
			ЗапросСторноПраздники.Текст = "
			|ВЫБРАТЬ 
			|ОснНачСотрОрг.Сотрудник,
			|СУММА(ВЫБОР
			|КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Праздник)
			|И (ОснНачСотрОрг.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ОсновнойОтпуск)
			|ИЛИ ОснНачСотрОрг.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ДополнительныйОтпуск))
			|ТОГДА 1
			|ИНАЧЕ 0
			|КОНЕЦ) КАК ДниПраздникиСторно
			|
			|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНачСотрОрг
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
			|ПО ОснНачСотрОрг.ПериодДействияНачало <= РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
			|И ОснНачСотрОрг.ПериодДействияКонец >= РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
			|
			|ГДЕ ОснНачСотрОрг.Сотрудник = &Сотрудник";
			
			Если ПраздничныхДнейВПериоде > 0 Тогда //СВЭЙ 27.09.2023 КВВ СВФР-011516
				ЗапросСторноПраздники.Текст = ЗапросСторноПраздники.Текст + "
				|И ОснНачСотрОрг.ВидРасчета = &ВидРасчета";
			КонецЕсли;
			
			ЗапросСторноПраздники.Текст = ЗапросСторноПраздники.Текст + "
			|И ОснНачСотрОрг.Сторно = Истина       
			|И (ОснНачСотрОрг.ПериодДействияНачало >= &ДатаНачала
			|И ОснНачСотрОрг.ПериодДействияКонец <= &ДатаОкончания)
			|И (ОснНачСотрОрг.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ОсновнойОтпуск)
			|ИЛИ ОснНачСотрОрг.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ДополнительныйОтпуск))
			|
			|СГРУППИРОВАТЬ ПО 
			|ОснНачСотрОрг.Сотрудник";                              
			ЗапросСторноПраздники.УстановитьПараметр("Сотрудник",РезИсклДни.Сотрудник);
			ЗапросСторноПраздники.УстановитьПараметр("ВидРасчета",РезИсклДни.ВидРасчета);
			ЗапросСторноПраздники.УстановитьПараметр("ДатаНачала",РезИсклДни.ПериодДействияНачало);
			ЗапросСторноПраздники.УстановитьПараметр("ДатаОкончания",РезИсклДни.ПериодДействияКонец);
			РезЗапросСторноПраздники = ЗапросСторноПраздники.Выполнить().Выгрузить();
			Если РезЗапросСторноПраздники.Количество() > 0 Тогда
				ПраздничныхДнейВПериоде = ПраздничныхДнейВПериоде - РезЗапросСторноПраздники[0].ДниПраздникиСторно;
			КонецЕсли;
		КонецЕсли;
		
		//ДниПраздники = ДниПраздники +РезИсклДни.ДниПраздники;
		ДниПраздники = ДниПраздники +ПраздничныхДнейВПериоде;
		//Аверсон 22.11.2021 КВВ СВФР-008408 )
		
	КонецЦикла;   
	//О.Т. 16.04.2015 Удалить через полгода 
	Если Сотрудник.Организация.ИНН = "100765738" Тогда
		Если ДниПраздниковДляСообщения.Количество()>0 Тогда
			ДниДляСообщения = "";
			Разделитель = "";
			Для Каждого стрДни из ДниПраздниковДляСообщения Цикл
				если ДниДляСообщения <> "" Тогда 
					Разделитель = ","
				КонецЕсли;
				
				ДниДляСообщения = ДниДляСообщения + Разделитель+ стрДни.Значение;
			КонецЦикла;
			
			Сообщить("В период отпуска были праздничные дни "+ДниДляСообщения+". Откорректируйте календарные дни!" );
		КонецЕсли;
	КонецЕсли;
	//О.Т. 16.04.2015 Удалить через полгода 
	
	
	// Удалить условие ИНН 31.12.14
	Если не (Сотрудник.Организация.ИНН = "800009185" и Дата < Дата(2014,1,1))  Тогда
		ПараметрыОтбора = Новый СписокЗначений;  
		ПараметрыОтбораСторно = Новый СписокЗначений;
		
		//Аверсон 21.02.2023 КВВ СВФР-010392 (
		//ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпКалендарныеДни);
		//ПараметрыОтбора.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпШестидневка);  
		//ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпКалендарныеДни);
		//ПараметрыОтбораСторно.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпШестидневка);
		
		З_ПВР = Новый Запрос;
		З_ПВР.Текст = "ВЫБРАТЬ 
		|ОсновныеНачисленияОрганизаций.Ссылка
		|ИЗ ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
		|ГДЕ
		|ОсновныеНачисленияОрганизаций.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)";
		РезЗ_ПВР = З_ПВР.Выполнить().Выгрузить();
		Для Каждого СтрРезЗ_ПВР ИЗ РезЗ_ПВР Цикл
			ПараметрыОтбора.Добавить(СтрРезЗ_ПВР.Ссылка);
			ПараметрыОтбораСторно.Добавить(СтрРезЗ_ПВР.Ссылка);
		КонецЦикла;
		//Аверсон 21.02.2023 КВВ СВФР-010392 )
		
		ЗапросИсклДни.УстановитьПараметр("ВидРасчетаИскл", ПараметрыОтбора);
		ЗапросИсклДни.УстановитьПараметр("ВидРасчетаИсклСторно", ПараметрыОтбораСторно);
		//ТЧДаты = Новый ТаблицаЗначений;
		//ТЧДаты.Колонки.Добавить("Дата");
		если не ЗначениеЗаполнено(ДниПраздники) Тогда 
			ДниПраздники = 0;
		КонецЕсли;
		РезИсклДни = ЗапросИсклДни.Выполнить().Выбрать(); 
		пока РезИсклДни.Следующий() Цикл  
			ДатаНачальная = РезИсклДни.ПериодДействияНачало;
			ПраздникиРасч = РезИсклДни.ДниПраздники;
			Для счДней=1 по РезИсклДни.Дней Цикл 
				Отбор = Новый Структура();
				Отбор.Вставить("Дата",ДатаНачальная);
				ПоискДата = ТЧДаты.НайтиСтроки(Отбор);
				если ПоискДата.Количество() =0 Тогда
					СтрокаДата = ТЧДаты.Добавить();       					
					ДниИсключение = ДниИсключение +1;
					СтрокаДата.Дата = ДатаНачальная;
				иначеесли ПоискДата[0].ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуБЛ и РезИсклДни.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпКалендарныеДни Тогда 
					
					ЗапросПраздник = Новый Запрос;
					ЗапросПраздник.Текст = 
					"ВЫБРАТЬ
					|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
					|ИЗ
					|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
					|ГДЕ
					|	РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Праздник)
					|	И РегламентированныйПроизводственныйКалендарь.ДатаКалендаря = &ДатаКалендаря";
					ЗапросПраздник.УстановитьПараметр("ДатаКалендаря",ДатаНачальная);
					РезультатПраздник = ЗапросПраздник.Выполнить().Выгрузить();
					Если РезультатПраздник.Количество()<> 0 Тогда 					
						ПраздникиРасч = ПраздникиРасч -1;
					КонецЕсли;
				КонецЕсли;
				ДатаНачальная = ДатаНачальная+86400;
			КонецЦикла;  
			ДниПраздники = ДниПраздники +ПраздникиРасч;
			
			
		КонецЦикла;
	КонецЕсли;
	//О.Т. Аверсон 21.10.2015 № 
	ЗапросИсклДниКл = Новый Запрос;
	ЗапросИсклДниКл.Текст = 
	"ВЫБРАТЬ
	|	РабочееВремяРаботниковОрганизаций.Сотрудник,
	|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК ДнейЯвки,
	|	ВложенныйЗапрос.Дней,
	|	РаботникиОрганизацийСрезПоследних.Период КАК ДатаПриема
	|ИЗ
	|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			РабочееВремяРаботниковОрганизаций.Сотрудник КАК Сотрудник,
	|			СУММА(ВЫБОР
	|					КОГДА РабочееВремяРаботниковОрганизаций.Дней = 0
	|							ИЛИ РабочееВремяРаботниковОрганизаций.Дней = NULL
	|						ТОГДА 1
	|					ИНАЧЕ РабочееВремяРаботниковОрганизаций.Дней
	|				КОНЕЦ) КАК Дней
	|		ИЗ
	|			РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
	|		ГДЕ
	|			РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&ВидИспользованияРВ)
	|			И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
	|			И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период1
	|		
	|		СГРУППИРОВАТЬ ПО
	|			РабочееВремяРаботниковОрганизаций.Сотрудник) КАК ВложенныйЗапрос
	|		ПО РабочееВремяРаботниковОрганизаций.Сотрудник = ВложенныйЗапрос.Сотрудник
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период1, ) КАК РаботникиОрганизацийСрезПоследних
	|		ПО РабочееВремяРаботниковОрганизаций.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
	|ГДЕ
	|	НЕ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&ВидИспользованияРВ)
	|	И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
	|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период1
	|
	|СГРУППИРОВАТЬ ПО
	|	РабочееВремяРаботниковОрганизаций.Сотрудник,
	|	ВложенныйЗапрос.Дней,
	|	РаботникиОрганизацийСрезПоследних.Период";
	ЗапросИсклДниКл.УстановитьПараметр("Сотрудник", Сотрудник);
	ПараметрыОтбора = Новый СписокЗначений;
	//Островская Татьяна 10.09.2013 № 16623
	//ПараметрыОтбора.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ДополнительныеВыходныеДниНеОплачиваемые);
	
	//Островская Татьяна 10.09.2013 № 16623
	ЗапросИсклДниКл.УстановитьПараметр("ВидИспользованияРВ", ПараметрыОтбора);
	ЗапросИсклДниКл.УстановитьПараметр("Период", НачалоМесяца(Дата));
	ЗапросИсклДниКл.УстановитьПараметр("Период1", КонецМесяца(Дата));
	РезИсклДниКл = ЗапросИсклДниКл.Выполнить().Выбрать();
	если РезИсклДниКл.Следующий() Тогда 
		ДниИсключение = ДниИсключение + ?(ЗначениеЗаполнено(РезИсклДниКл.Дней),РезИсклДниКл.Дней,0); 						
	КонецЕсли;
	//О.Т. Аверсон 21.10.2015 № 
	
	
	//Островская Татьяна 11.10.2013 № 16835
	//Островская Татьяна 17.10.2013 № 16839
	ЗапросИсклДни.Текст =
	"ВЫБРАТЬ
	|	МАКСИМУМ(РаботникиОрганизаций.Период) КАК ДатаПриема
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|ГДЕ
	|	РаботникиОрганизаций.Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию
	|	И РаботникиОрганизаций.Сотрудник = &Сотрудник";
	
	//Островская Татьяна 11.10.2013 № 16835
	//Островская Татьяна 17.10.2013 № 16839
	РезИсклДни = ЗапросИсклДни.Выполнить().Выбрать();
	если РезИсклДни.Следующий() Тогда 
		если не РезИсклДни.ДатаПриема = null Тогда 
			если  Месяц(РезИсклДни.ДатаПриема) = Месяц(Дата) и Год(РезИсклДни.ДатаПриема) = Год(Дата) Тогда 
				ДеньПриема = День(РезИсклДни.ДатаПриема)-1;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	Если УсловиеДляБПМ Тогда
		ДеньПриема   =0;
		ДниИсключение  =0;
		ДниПраздники =0;
	КонецЕсли;
	//О.Т. 09.10.2014 № 17616
	если ДатаНачалаДоговора = Неопределено Тогда 
		КалендарныеДни = День(КонецМесяца(Дата)) - ДеньПриема - ДниИсключение + ДниПраздники; //Островская Татьяна 11.10.2013 № 16835
	иначе
		КалендарныеДни = День(ДатаОкончанияДоговора) - День(ДатаНачалаДоговора)+1 - ДеньПриема - ДниИсключение + ДниПраздники; //Островская Татьяна 11.10.2013 № 16835
	КонецЕсли;
	//О.Т. 09.10.2014 № 17616
	Возврат КалендарныеДни;
	
	
КонецФункции

Функция ПоискВидаРасчетаПоГруппеРасчета(СтрокаДвижений)
	
	//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
	// Данный фрагмент построен конструктором.
	// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
	|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
	|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
	|ИЗ
	|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
	|	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
	|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	РабочееВремяРаботниковОрганизаций.Сотрудник
	|ИЗ
	|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
	|ГДЕ
	|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
	|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
	|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&ВидИспользованияРабочегоВремени)";
	
	ГруппаРасчетов = Справочники.ГруппыРасчетов.НеПроизводитсяДоплатыДоМЗП;
	СписокВидыРасчета = Новый СписокЗначений;
	СписокВидыВремени = Новый СписокЗначений;
	Для Каждого стр из ГруппаРасчетов.Основные Цикл 
		СписокВидыРасчета.Добавить(стр.ВидРасчета);
	КонецЦикла;
	Для Каждого стр из ГруппаРасчетов.КлассификаторИспользованияРВ Цикл 
		СписокВидыВремени.Добавить(стр.ВидКлассификатора);
	КонецЦикла;
	
	Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", СписокВидыВремени);
	Запрос.УстановитьПараметр("ВидРасчета", СписокВидыРасчета);
	Запрос.УстановитьПараметр("ПериодРегистрации", СтрокаДвижений.ПериодРегистрации);
	Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(СтрокаДвижений.ПериодРегистрации));
	Запрос.УстановитьПараметр("Сотрудник", СтрокаДвижений.Сотрудник);
	
	РезультатЗапроса = Запрос.Выполнить().Выгрузить();
	Если РезультатЗапроса.Количество()> 0 Тогда 
		Возврат истина;
	иначе
		Возврат Ложь;
	КонецЕсли;
	
КонецФункции

Функция ПроверкаПриказаНаРаботуВПраздникиИПереносДней(Организация,Сотрудник,ДатаНач,ДатаКон) Экспорт   
	//СВЭЙ 04.07.2024 КВВ СВФР-013163 (
	
	//сначала проверить док.ПриказНаРаботуВПраздничныеИВыходныеДни, 
	//если нет приказа, то перенос дней РегистрСведений.ПеренесенныеРабочиеДни
	
	ВозвращаемоеЗначение = 0;
	З = Новый Запрос;
	З.Текст = "ВЫБРАТЬ
	|СУММА(РаботаВВыходные.ОтработаноЧасов) КАК ОтработаноЧасов
	|ИЗ Документ.ПриказНаРаботуВПраздничныеИВыходныеДни.РаботникиОрганизации КАК РаботаВВыходные
	|ГДЕ РаботаВВыходные.Ссылка.Проведен   
	|И РаботаВВыходные.Ссылка.Организация = &Организация
	|И РаботаВВыходные.Сотрудник = &Сотрудник
	|И РаботаВВыходные.ДатаВыхода МЕЖДУ &ДатаНач И &ДатаКон
	|И РаботаВВыходные.ЯвкаВТабель";    
	З.УстановитьПараметр("Организация",Организация);
	З.УстановитьПараметр("Сотрудник",Сотрудник);
	З.УстановитьПараметр("ДатаНач",ДатаНач);
	З.УстановитьПараметр("ДатаКон",ДатаКон);
	РезЗ = З.Выполнить().Выгрузить();
	Если ЗначениеЗаполнено(РезЗ[0].ОтработаноЧасов) Тогда
		ВозвращаемоеЗначение = РезЗ[0].ОтработаноЧасов;	
	Иначе       
		ДатаПроверки = ДатаНач;
		Пока ДатаПроверки <= НачалоДня(ДатаКон) Цикл
			З = Новый Запрос;
			З.Текст = "ВЫБРАТЬ
			|ПеренесенныеРабочиеДни.ВыходнойДень КАК ВыходнойДень
			|ПОМЕСТИТЬ ВтПереносы
			|ИЗ РегистрСведений.ПеренесенныеРабочиеДни КАК ПеренесенныеРабочиеДни
			|ГДЕ
			|ПеренесенныеРабочиеДни.РабочийДень = &ДатаПроверки
			|;
			|ВЫБРАТЬ     
			|ГрафикиРаботыПоВидамВремени.Дата,
			|РаботникиОрганизаций.ГрафикРаботы,
			|ГрафикиРаботыПоВидамВремени.ВидВремени,
			|ГрафикиРаботыПоВидамВремени.ОсновноеЗначение
			|ИЗ РегистрСведений.РаботникиОрганизаций.СРезПоследних(&ДатаПроверки) КАК РаботникиОрганизаций 
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
			|ПО ГрафикиРаботыПоВидамВремени.ГрафикРаботы = РаботникиОрганизаций.ГрафикРаботы
			|И ГрафикиРаботыПоВидамВремени.ВидВремени = &ВидВремени
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтПереносы КАК ВтПереносы
			|ПО ГрафикиРаботыПоВидамВремени.Дата = ВтПереносы.ВыходнойДень
			|ГДЕ РаботникиОрганизаций.Сотрудник = &Сотрудник
			|И ВтПереносы.ВыходнойДень = ГрафикиРаботыПоВидамВремени.Дата
			|И РаботникиОрганизаций.Организация = &Организация";   
			З.УстановитьПараметр("Организация",Организация);
			З.УстановитьПараметр("Сотрудник",Сотрудник);
			З.УстановитьПараметр("ДатаПроверки",ДатаПроверки);
			З.УстановитьПараметр("ВидВремени",Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
			РезЗ = З.Выполнить().Выгрузить();
			Для Каждого Стр ИЗ РезЗ Цикл
			ВозвращаемоеЗначение = ВозвращаемоеЗначение + Стр.ОсновноеЗначение; 
			КонецЦикла;
			ДатаПроверки = КонецДня(ДатаПроверки) + 1;
		КонецЦикла;
	КонецЕсли;
	
	Возврат ВозвращаемоеЗначение;
	//СВЭЙ 04.07.2024 КВВ СВФР-013163 )
	
КонецФункции


Функция ПроверитьКомандировкиИОплатуПоСреднему(Организация,Сотрудник,ДатаНач,ДатаКон) Экспорт //Аверсон ЕАЕ 10.02.2021 СВФР-007090 (Экспорт)
	//Аверсон 15.08.2019 КВВ СВФР-004608 (
	ВозвращаемоеЗначение = 0;
	ТЗ = Новый ТаблицаЗначений;    
	ТЗ.Колонки.Добавить("Дней");
	ТЗ.Колонки.Добавить("Норма");
	ТЗ.Колонки.Добавить("Часов");
	ТЗ.Колонки.Добавить("НормаЧ");
	
	УчетнаяПолитикаЗапросДнКоманд = Новый Запрос; 
	УчетнаяПолитикаЗапросДнКоманд.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОплатаКомандировокКакРабВремяБезОплатыПоСр
	|ИЗ РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
	УчетнаяПолитикаЗапросДнКоманд.УстановитьПараметр("Организация",Организация);
	УчетнаяПолитикаЗапросДнКоманд = УчетнаяПолитикаЗапросДнКоманд.Выполнить().Выгрузить();
	Если УчетнаяПолитикаЗапросДнКоманд[0].ОплатаКомандировокКакРабВремяБезОплатыПоСр Тогда
		ЗапросПоКоманд = Новый Запрос;
		ЗапросПоКоманд.Текст = 
		"ВЫБРАТЬ
		|	Командировки.Сотрудник,
		|	Командировки.ДатаНачала,
		|	Командировки.ДатаОкончания,
		|	Командировки.Ссылка	
		|ИЗ Документ.КомандировкиОрганизаций.РаботникиОрганизации КАК Командировки
		|ГДЕ Командировки.Сотрудник = &Сотр
		//Аверсон 02.09.2020 КВВ СВФР-006497 (
		//|	И Командировки.ДатаНачала >= &ДНач
		//|	И Командировки.ДатаОкончания <= &ДКон
		|	И (Командировки.ДатаНачала МЕЖДУ &ДНач И &ДКон
		|		ИЛИ Командировки.ДатаОкончания МЕЖДУ &ДНач И &ДКон)
		//Аверсон 02.09.2020 КВВ СВФР-006497 )
		
		//Аверсон ЕАЕ 11.11.2021 СВФР-008367
		|	И (Не Командировки.ОтменаКомандировки)
		//Аверсон СВФР-008367
		
		|	И Командировки.Ссылка.Проведен";
		ЗапросПоКоманд.УстановитьПараметр("Сотр",Сотрудник);
		ЗапросПоКоманд.УстановитьПараметр("ДНач",ДатаНач);
		ЗапросПоКоманд.УстановитьПараметр("ДКон",ДатаКон);
		ТЗКом = ЗапросПоКоманд.Выполнить().Выгрузить();
		Если ТЗКом.Количество() <> 0 Тогда //Есть командировки
			КолвоДнКом = 0;   НормаДнКом = 0; КолвоЧКом = 0;   НормаЧКом = 0;
			Для Каждого Т1 ИЗ ТЗКом Цикл       
				//Аверсон 27.11.2020 КВВ СВФР-006888 ( 
				ДатаНачКом = Макс(Т1.ДатаНачала,ДатаНач);    
				ДатаКонКом = Мин(Т1.ДатаОкончания,ДатаКон);  
				ТекДатаКом = ДатаНачКом;                      
				Пока ТекДатаКом <= ДатаКонКом Цикл
					//Аверсон 27.11.2020 КВВ СВФР-006888 )
					ЗапросПоКомандИОплатаПоСр = Новый Запрос; 
					ЗапросПоКомандИОплатаПоСр.Текст =
					
					"ВЫБРАТЬ 
					|ОплатаПоСр.Ссылка,
					|ОплатаПоСр.Ссылка.Сотрудник,
					
					//Аверсон ЕАЕ 30.03.2021 СВФР-007400
					//|ОплатаПоСр.Ссылка.ДатаНачала КАК ДатаНачала,
					//|ОплатаПоСр.Ссылка.ДатаОкончания КАК ДатаОкончания
					|ОплатаПоСр.ДатаНачала КАК ДатаНачала,
					|ОплатаПоСр.ДатаОкончания КАК ДатаОкончания
					//Аверсон СВФР-007400
					
					|ИЗ Документ.ОплатаПоСреднемуЗаработку.Начисления КАК ОплатаПоСр
					|ГДЕ ОплатаПоСр.Ссылка.Сотрудник = &Сотр
					
					//Аверсон ЕАЕ 30.03.2021 СВФР-007400
					//|И &ДНач МЕЖДУ ОплатаПоСр.Ссылка.ДатаНачала И ОплатаПоСр.Ссылка.ДатаОкончания
					|И &ДНач МЕЖДУ ОплатаПоСр.ДатаНачала И ОплатаПоСр.ДатаОкончания
					//Аверсон СВФР-007400
					
					|И ОплатаПоСр.Ссылка.Проведен
					|И ТИПЗНАЧЕНИЯ(ОплатаПоСр.ВидРасчета) = ТИП(ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
					|И ОплатаПоСр.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = &ЭтоКомандировка";
					
					ЗапросПоКомандИОплатаПоСр.УстановитьПараметр("Сотр",Сотрудник);
					ЗапросПоКомандИОплатаПоСр.УстановитьПараметр("ДНач",ТекДатаКом);
					ЗапросПоКомандИОплатаПоСр.УстановитьПараметр("ЭтоКомандировка",Справочники.КлассификаторИспользованияРабочегоВремени.Командировка);
					ТЗКомСр = ЗапросПоКомандИОплатаПоСр.Выполнить().Выгрузить();
					
					Если ТЗКомСр.Количество() = 0 Тогда // нет Оплаты по среднему
						//КолвоДнКом = КолвоДнКом + 1;   //Аверсон 23.06.2020 КВВ СВФР-006176 (закомментировано)
						//КолвоЧКом = КолвоЧКом + 8;     //Аверсон 23.06.2020 КВВ СВФР-006176 (закомментировано)
						ТекДата = ТекДатаКом;
						ЗГрафика = Новый Запрос;
						ЗГрафика.Текст = 
						
						//Аверсон 05.05.2023 КВВ СВФР-010803 (
						"ВЫБРАТЬ
						|ПеренесенныеРабочиеДни.ВыходнойДень КАК ВыходнойДень
						|ПОМЕСТИТЬ ВтПереносы
						|ИЗ РегистрСведений.ПеренесенныеРабочиеДни КАК ПеренесенныеРабочиеДни
						|ГДЕ
						|ПеренесенныеРабочиеДни.ВыходнойДень = &ДатаПроверки
						|;
						//Аверсон 05.05.2023 КВВ СВФР-010803 )
						
						|ВЫБРАТЬ
						|РаботникиОрганизаций.Период,
						|РаботникиОрганизаций.ГрафикРаботы,
						|ГрафикиРаботыПоВидамВремени.ВидВремени,
						|ГрафикиРаботыПоВидамВремени.ОсновноеЗначение,
						|ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение,
						//Аверсон ЕАЕ 03.02.2021 СВФР-007103
						|ГрафикиРаботыПоВидамВремени.ОсновноеЗначение КАК ОсновноеЗначениеНорма,
						|ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение КАК ДополнительноеЗначениеНорма
						//Аверсон СВФР-007103
						|ИЗ РегистрСведений.РаботникиОрганизаций.СРезПоследних(&ДатаПроверки) КАК РаботникиОрганизаций 
						|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
						|ПО ГрафикиРаботыПоВидамВремени.ГрафикРаботы = РаботникиОрганизаций.ГрафикРаботы
						|И ГрафикиРаботыПоВидамВремени.Дата = &ДатаПроверки
						|И ГрафикиРаботыПоВидамВремени.ВидВремени = &ВидВремени
						
						//Аверсон 05.05.2023 КВВ СВФР-010803 (
						|
						|ЛЕВОЕ СОЕДИНЕНИЕ ВтПереносы КАК ВтПереносы
						|ПО ГрафикиРаботыПоВидамВремени.Дата = ВтПереносы.ВыходнойДень
						|
						//Аверсон 05.05.2023 КВВ СВФР-010803 )
						
						|ГДЕ РаботникиОрганизаций.Сотрудник = &Сотрудник
						//Аверсон ЕАЕ 03.02.2021 СВФР-007103
						
						|И ВтПереносы.ВыходнойДень ЕСТЬ NULL //Аверсон 05.05.2023 КВВ СВФР-010803
						|
						|ОБЪЕДИНИТЬ ВСЕ
						|
						//|ВЫБРАТЬ
						//|	ГрафикиРаботыПоВидамВремени.Дата,
						//|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы,
						//|	ГрафикиРаботыПоВидамВремени.ВидВремени,
						//|	ГрафикиРаботыПоВидамВремени.ОсновноеЗначение,
						//|	ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение,
						//|	0,
						//|	0
						//|ИЗ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
						//|ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СостояниеРаботниковОрганизаций КАК СостояниеРаботниковОрганизаций
						//|ПО ГрафикиРаботыПоВидамВремени.Дата = НАЧАЛОПЕРИОДА(СостояниеРаботниковОрганизаций.Период,ДЕНЬ)
						//|	И СостояниеРаботниковОрганизаций.Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияРаботникаОрганизации.РаботаВПраздничныеИВыходныеДни)
						//|ГДЕ ГрафикиРаботыПоВидамВремени.ГрафикРаботы = &Сотрудник
						//|	И ГрафикиРаботыПоВидамВремени.Дата = &ДатаПроверки
						//|	И ГрафикиРаботыПоВидамВремени.ВидВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Праздники)
						|ВЫБРАТЬ
						|	&ДатаПроверки,
						|	РаботаВВыходные.ГрафикРаботы,
						|	ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Праздники),
						|	РаботаВВыходные.ОтработаноЧасов,
						|	1,
						|	0,
						|	0
						|ИЗ Документ.ПриказНаРаботуВПраздничныеИВыходныеДни.РаботникиОрганизации КАК РаботаВВыходные
						|ГДЕ РаботаВВыходные.Ссылка.Проведен
						|	И РаботаВВыходные.Сотрудник = &Сотрудник
						|	И РаботаВВыходные.ДатаВыхода = &ДатаПроверки
						|	И РаботаВВыходные.ЯвкаВТабель
						|";
						//Аверсон СВФР-007103
						
						ЗГрафика.УстановитьПараметр("ДатаПроверки", ТекДата);
						ЗГрафика.УстановитьПараметр("Сотрудник", Сотрудник);
						ЗГрафика.УстановитьПараметр("ВидВремени",Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
						РезультатЗГрафика = ЗГрафика.Выполнить().Выгрузить();
						ДанныеИндивидуальногоГрафикаПред = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальномуЗаИнтервал(НачалоДня(ТекДата), КонецДня(ТекДата), Сотрудник);
						//Аверсон СМА 10.12.21
						Если ДанныеИндивидуальногоГрафикаПред.ЕстьГрафик Тогда
							Отбор =новый структура();
							Отбор.Вставить("ВидВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
							НайденныеСтроки = РезультатЗГрафика.НайтиСтроки(Отбор);
							Если  НайденныеСтроки.Количество()>0 Тогда
								Для каждого стр из  НайденныеСтроки цикл
									стр.ОсновноеЗначение =  ДанныеИндивидуальногоГрафикаПред.КоличествоЧасов;
									стр.ДополнительноеЗначение =  ДанныеИндивидуальногоГрафикаПред.КоличествоДней; 
								конеццикла;
							КонецЕсли;
						КонецЕсли;
						Если Организация.ФлКомандировкиПоТабелю Тогда
							Запрос = Новый Запрос;
							Запрос.Текст = 
							"ВЫБРАТЬ РАЗРЕШЕННЫЕ
							|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник,
							|	РабочееВремяРаботниковОрганизацийОбороты.ВидИспользованияРабочегоВремени,
							|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ДнейОборот) КАК Дней,
							|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ЧасовОборот) КАК Часов,
							|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ДнейПоНормеОборот) КАК ДнейПоНорме,
							|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ЧасовПоНормеОборот) КАК ЧасовПоНорме
							|ИЗ
							|	РегистрНакопления.РабочееВремяРаботниковОрганизаций.Обороты(
							|			&НачалоПериода,
							|			&КонецПериода,
							|			Авто,
							|			Сотрудник = &Сотрудник
							|				И ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Командировка)) КАК РабочееВремяРаботниковОрганизацийОбороты
							|
							|СГРУППИРОВАТЬ ПО
							|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник,
							|	РабочееВремяРаботниковОрганизацийОбороты.ВидИспользованияРабочегоВремени";
							
							Запрос.УстановитьПараметр("КонецПериода", КонецДня(ТекДата));
							Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(ТекДата));
							Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
							
							РезультатЗапроса = Запрос.Выполнить();
							
							ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
							
							Если ВыборкаДетальныеЗаписи.Следующий() Тогда
								НормаДнКом = НормаДнКом + ВыборкаДетальныеЗаписи.ДнейПоНорме;
								НормаЧКом = НормаЧКом + ВыборкаДетальныеЗаписи.ЧасовПоНорме;
								КолвоДнКом = КолвоДнКом + ВыборкаДетальныеЗаписи.Дней;
								КолвоЧКом = КолвоЧКом + ВыборкаДетальныеЗаписи.Часов;
							КонецЕсли;
							
						Иначе
							
							//Аверсон ЕАЕ 03.02.2021 СВФР-007103
							//НормаДнКом = НормаДнКом + РезультатЗГрафика.Итог("ДополнительноеЗначение");
							//НормаЧКом = НормаЧКом + РезультатЗГрафика.Итог("ОсновноеЗначение");
							НормаДнКом = НормаДнКом + РезультатЗГрафика.Итог("ДополнительноеЗначениеНорма");
							НормаЧКом = НормаЧКом + РезультатЗГрафика.Итог("ОсновноеЗначениеНорма");
							КолвоДнКом = КолвоДнКом + РезультатЗГрафика.Итог("ДополнительноеЗначение");
							КолвоЧКом = КолвоЧКом + РезультатЗГрафика.Итог("ОсновноеЗначение");
							//Аверсон СВФР-007103
							
							//Аверсон ЕАЕ 18.06.2021 СВФР-007742
							Если РезультатЗГрафика.Количество() = 0 
								ИЛИ (РезультатЗГрафика.Итог("ДополнительноеЗначениеНорма") = 0 И РезультатЗГрафика.Итог("ОсновноеЗначениеНорма") = 0
								И РезультатЗГрафика.Итог("ДополнительноеЗначение") = 0 И РезультатЗГрафика.Итог("ОсновноеЗначение") = 0) Тогда
								//Пробуем получить данные индивидуального графика
								ДанныеИндивидуальногоГрафика = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальномуЗаИнтервал(НачалоДня(ТекДата), КонецДня(ТекДата), Сотрудник);
								НормаДнКом = НормаДнКом + ДанныеИндивидуальногоГрафика.КоличествоДней;
								НормаЧКом = НормаЧКом + ДанныеИндивидуальногоГрафика.КоличествоЧасов;
								КолвоДнКом = КолвоДнКом + ДанныеИндивидуальногоГрафика.КоличествоДней;
								КолвоЧКом = КолвоЧКом + ДанныеИндивидуальногоГрафика.КоличествоЧасов;
								
								Если ДанныеИндивидуальногоГрафика.КоличествоДней = 0 И ДанныеИндивидуальногоГрафика.КоличествоЧасов = 0 Тогда
									//Пробуем получить данные РН Рабочее время сотрудника по виду времени Командировка
									
									Запрос = Новый Запрос;
									Запрос.Текст = 
									"ВЫБРАТЬ РАЗРЕШЕННЫЕ
									|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник,
									|	РабочееВремяРаботниковОрганизацийОбороты.ВидИспользованияРабочегоВремени,
									|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ДнейОборот) КАК Дней,
									|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ЧасовОборот) КАК Часов,
									|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ДнейПоНормеОборот) КАК ДнейПоНорме,
									|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ЧасовПоНормеОборот) КАК ЧасовПоНорме
									|ИЗ
									|	РегистрНакопления.РабочееВремяРаботниковОрганизаций.Обороты(
									|			&НачалоПериода,
									|			&КонецПериода,
									|			Авто,
									|			Сотрудник = &Сотрудник
									|				И ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Командировка)) КАК РабочееВремяРаботниковОрганизацийОбороты
									|
									|СГРУППИРОВАТЬ ПО
									|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник,
									|	РабочееВремяРаботниковОрганизацийОбороты.ВидИспользованияРабочегоВремени";
									
									Запрос.УстановитьПараметр("КонецПериода", КонецДня(ТекДата));
									Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(ТекДата));
									Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
									
									РезультатЗапроса = Запрос.Выполнить();
									
									ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
									
									Если ВыборкаДетальныеЗаписи.Следующий() Тогда
										НормаДнКом = НормаДнКом + ВыборкаДетальныеЗаписи.ДнейПоНорме;
										НормаЧКом = НормаЧКом + ВыборкаДетальныеЗаписи.ЧасовПоНорме;
										КолвоДнКом = КолвоДнКом + ВыборкаДетальныеЗаписи.Дней;
										КолвоЧКом = КолвоЧКом + ВыборкаДетальныеЗаписи.Часов;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							//Аверсон СВФР-007742
						КонецЕсли;
					КонецЕсли;															
					ТекДатаКом = КонецДня(ТекДатаКом) + 1;
				КонецЦикла;				
			КонецЦикла;
			Стр = ТЗ.Добавить();
			//Аверсон 23.06.2020 КВВ СВФР-006176 (
			//Стр.Дней = КолвоДнКом;
			//Стр.Часов = КолвоЧКом;
			
			//Аверсон ЕАЕ 03.02.2021 СВФР-007103
			//Стр.Дней = НормаДнКом;
			//Стр.Часов = НормаЧКом;
			Стр.Дней = КолвоДнКом;
			Стр.Часов = КолвоЧКом;
			//Аверсон СВФР-007103
			
			//Аверсон 23.06.2020 КВВ СВФР-006176 )
			Стр.Норма = НормаДнКом;
			Стр.НормаЧ = НормаЧКом;	
		КонецЕсли;
	КонецЕсли;
	Возврат ТЗ;
	//Аверсон 15.08.2019 КВВ СВФР-004608 )
КонецФункции

//Аверсон ЕАЕ 09.11.2021 СВФР-008318
Функция ЭтоДолжностьСИндивидуальнымПроцентомНочных(Должн, Орг)
	ИндПроцентНочных = Ложь;
	Если Орг.ИНН = "100071565" или Орг.ИНН =  "100194961" Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
		|	ДолжностиОрганизаций.ИнойПроцентПовышений
		|ИЗ
		|	Справочник.ДолжностиОрганизаций КАК ДолжностиОрганизаций
		|ГДЕ
		|	ДолжностиОрганизаций.Ссылка = &Должн";
		
		Запрос.УстановитьПараметр("Должн", Должн);
		
		РезультатЗапроса = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Если ВыборкаДетальныеЗаписи.Следующий() Тогда
			ИндПроцентНочных = ВыборкаДетальныеЗаписи.ИнойПроцентПовышений;
		КонецЕсли;
	КонецЕсли;        
	//Аверсон СВФР-008824  
	Возврат ИндПроцентНочных;
КонецФункции
//Аверсон СВФР-008318

//Аверсон ЕАЕ 16.05.2022 СВФР-008969
Функция ПолучитьПериодыНачисления(Сотр, ВидРасч, Нач, Кон)
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета,
	|	&НачалоПериода КАК Период,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель1,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Действие,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ПериодЗавершения,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ДействиеЗавершения
	|ПОМЕСТИТЬ ВтПлановыеНачисления
	|ИЗ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(&НачалоПериода, Сотрудник = &Сотрудник И ВидРасчета = &ВидРасчета) КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ПлановыеНачисленияРаботниковОрганизаций.Сотрудник,
	|	ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета,
	|	ПлановыеНачисленияРаботниковОрганизаций.Период КАК Период,
	|	ПлановыеНачисленияРаботниковОрганизаций.Показатель1,
	|	ПлановыеНачисленияРаботниковОрганизаций.Действие,
	|	ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения,
	|	ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения
	|ИЗ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
	|ГДЕ ПлановыеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник 
	|	И ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета = &ВидРасчета
	|	И ПлановыеНачисленияРаботниковОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|;
	|//////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|ПлановыеНачисления.Сотрудник,
	|ПлановыеНачисления.ВидРасчета,
	|ПлановыеНачисления.Период КАК НачалоПериода,
	|МИНИМУМ(ВЫБОР
	|		КОГДА ПлановыеНачисления.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
	|		ТОГДА ВЫБОР КОГДА ДОБАВИТЬКДАТЕ(ПлановыеНачисления.ПериодЗавершения, СЕКУНДА, -1) > &КонецПериода ТОГДА &КонецПериода ИНАЧЕ ДОБАВИТЬКДАТЕ(ПлановыеНачисления.ПериодЗавершения, СЕКУНДА, -1) КОНЕЦ
	|		ИНАЧЕ ДОБАВИТЬКДАТЕ(ПлановыеНачисленияБольше.Период, СЕКУНДА, -1)
	|		КОНЕЦ) КАК КонецПериода,
	|ПлановыеНачисления.Показатель1		
	|ИЗ ВтПлановыеНачисления КАК ПлановыеНачисления
	|ЛЕВОЕ СОЕДИНЕНИЕ ВтПлановыеНачисления КАК ПлановыеНачисленияБольше
	|ПО ПлановыеНачисления.Период < ПлановыеНачисленияБольше.Период 
	|	И ПлановыеНачисленияБольше.Действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить) 
	|ГДЕ ПлановыеНачисления.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
	|СГРУППИРОВАТЬ ПО
	|	ПлановыеНачисления.Сотрудник,
	|	ПлановыеНачисления.ВидРасчета,
	|	ПлановыеНачисления.Период,
	|	ПлановыеНачисления.Показатель1";
	
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("Сотрудник", Сотр);
	Запрос.УстановитьПараметр("ВидРасчета", ВидРасч);
	Запрос.УстановитьПараметр("НачалоПериода", Нач);
	Запрос.УстановитьПараметр("КонецПериода", Кон);
	ТЗ = Запрос.Выполнить().выгрузить();
	Возврат ТЗ;
КонецФункции
//Аверсон СВФР-008969

//Аверсон ЕАЕ 17.10.2022 СВФР-009668
Функция РассчитатьЗаработок(ТЧ)
	МассивСтрок = ТЧ.НайтиСтроки(Новый Структура("Включать", Истина));
	ТЗ = ТЧ.Выгрузить(МассивСтрок);
	Заработок = ТЗ.Итог("ЗаработокСУчетомИндексации");
	Возврат Заработок;
КонецФункции

Функция РассчитатьОтработаноЧасов(ТЧ)
	МассивСтрок = ТЧ.НайтиСтроки(Новый Структура("Включать", Истина));
	ТЗ = ТЧ.Выгрузить(МассивСтрок);
	ТЗ.Свернуть("МесяцВыборки,ОтработаноЧасов");
	ОтработаноЧасов = ТЗ.Итог("ОтработаноЧасов");
	Возврат ОтработаноЧасов;
КонецФункции
//Аверсон СВФР-009668

//Аверсон ЕАЕ 31.10.2022 СВФР-009732
Функция ПолучитьСписокВидовРасчетаПриНеполныхМесяцах()
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СреднийЗаработокБазовыеВидыРасчета.ВидРасчета
	|ИЗ
	|	ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
	|ГДЕ
	|	СреднийЗаработокБазовыеВидыРасчета.Ссылка = &Ссылка";
	
	Запрос.УстановитьПараметр("Ссылка", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускПриНеполныхМесяцах);
	ТЗ = Запрос.Выполнить().Выгрузить();
	Сп = ТЗ.ВыгрузитьКолонку("ВидРасчета");
	Возврат Сп;
КонецФункции
//Аверсон СВФР-009732

//Аверсон ЕАЕ 18.01.2024 СВФР-012159
Функция ПроверитьОплатуПоСреднему(Организация,Сотрудник,ДатаНач,ДатаКон) Экспорт 
	ТЗ = Новый ТаблицаЗначений;    
	ТЗ.Колонки.Добавить("Дней");
	ТЗ.Колонки.Добавить("Часов");
	
	ТекДатаПериода = ДатаНач; 
	
	КолвоДней = 0;
	КолвоЧасов = 0;
	МассивОплатаПоСреднему = Новый Массив;
	Пока ТекДатаПериода <= ДатаКон Цикл
		Запрос = Новый Запрос; 
		Запрос.Текст =
		
		"ВЫБРАТЬ 
		|ОплатаПоСр.Ссылка,
		|ОплатаПоСр.Ссылка.Сотрудник,
		
		|ОплатаПоСр.ОплаченоДней КАК ОтработаноДней,
		|ОплатаПоСр.ОплаченоДнейЧасов КАК ОтработаноЧасов
		
		|ИЗ Документ.ОплатаПоСреднемуЗаработку.Начисления КАК ОплатаПоСр
		|ГДЕ ОплатаПоСр.Ссылка.Сотрудник = &Сотр
		
		|И &ДНач МЕЖДУ ОплатаПоСр.ДатаНачала И ОплатаПоСр.ДатаОкончания
		
		|И ОплатаПоСр.Ссылка.Проведен
		|И ТИПЗНАЧЕНИЯ(ОплатаПоСр.ВидРасчета) = ТИП(ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
		|И ОплатаПоСр.Ссылка.СниматьОтработанныеЧасыВЗарплате = Истина;
		|";
		
		Запрос.УстановитьПараметр("Сотр",Сотрудник);
		Запрос.УстановитьПараметр("ДНач",ТекДатаПериода);
		//Запрос.УстановитьПараметр("ЭтоКомандировка",Справочники.КлассификаторИспользованияРабочегоВремени.Командировка);
		
		РезультатЗапроса = Запрос.Выполнить();
		Если Не РезультатЗапроса.Пустой() Тогда
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			
			Если ВыборкаДетальныеЗаписи.Следующий() Тогда
				Если МассивОплатаПоСреднему.Найти(ВыборкаДетальныеЗаписи.Ссылка) = Неопределено Тогда
					КолвоДней = КолвоДней + ВыборкаДетальныеЗаписи.ОтработаноДней;
					КолвоЧасов = КолвоЧасов + ВыборкаДетальныеЗаписи.ОтработаноЧасов;
					
					МассивОплатаПоСреднему.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		ТекДатаПериода = КонецДня(ТекДатаПериода) + 1;
	КонецЦикла;				
	Стр = ТЗ.Добавить();
	Стр.Дней = КолвоДней;
	Стр.Часов = КолвоЧасов;
	Возврат ТЗ;
КонецФункции
//Аверсон СВФР-012159

//Аверсон ЕАЕ 03.11.2025 СВФР-017037
Функция ПроверитьОплатуПоСреднемуНочные(Организация,Сотрудник,ДатаНач,ДатаКон) Экспорт 
	ТЗ = Новый ТаблицаЗначений;    
	ТЗ.Колонки.Добавить("Дней");
	ТЗ.Колонки.Добавить("Часов");
	
	ТекДатаПериода = ДатаНач; 
	
	КолвоДней = 0;
	КолвоЧасов = 0;
	КолвоДнейНочных = 0;
	КолвоЧасовНочных = 0;
	
	МассивОплатаПоСреднему = Новый Массив;
	Пока ТекДатаПериода <= ДатаКон Цикл
		Запрос = Новый Запрос; 
		Запрос.Текст =
		
		"ВЫБРАТЬ 
		|ОплатаПоСр.Ссылка,
		|ОплатаПоСр.Ссылка.Сотрудник,
		
		|ОплатаПоСр.ОплаченоДней КАК ОтработаноДней,
		|ОплатаПоСр.ОплаченоДнейЧасов КАК ОтработаноЧасов,
		
		|ОплатаПоСр.ДатаНачала,
		|ОплатаПоСр.ДатаОкончания
		
		|ИЗ Документ.ОплатаПоСреднемуЗаработку.Начисления КАК ОплатаПоСр
		|ГДЕ ОплатаПоСр.Ссылка.Сотрудник = &Сотр
		
		|И &ДНач МЕЖДУ ОплатаПоСр.ДатаНачала И ОплатаПоСр.ДатаОкончания
		
		|И ОплатаПоСр.Ссылка.Проведен
		|И ТИПЗНАЧЕНИЯ(ОплатаПоСр.ВидРасчета) = ТИП(ПланВидовРасчета.ОсновныеНачисленияОрганизаций)
		|И ОплатаПоСр.Ссылка.СниматьОтработанныеЧасыВЗарплате = Истина;
		|";
		
		Запрос.УстановитьПараметр("Сотр",Сотрудник);
		Запрос.УстановитьПараметр("ДНач",ТекДатаПериода);
		//Запрос.УстановитьПараметр("ЭтоКомандировка",Справочники.КлассификаторИспользованияРабочегоВремени.Командировка);
		
		РезультатЗапроса = Запрос.Выполнить();
		Если Не РезультатЗапроса.Пустой() Тогда
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			
			Если ВыборкаДетальныеЗаписи.Следующий() Тогда
				Если МассивОплатаПоСреднему.Найти(ВыборкаДетальныеЗаписи.Ссылка) = Неопределено Тогда
					КолвоДней = КолвоДней + ВыборкаДетальныеЗаписи.ОтработаноДней;
					КолвоЧасов = КолвоЧасов + ВыборкаДетальныеЗаписи.ОтработаноЧасов;
					
					МассивОплатаПоСреднему.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
					
					ДанныеНочные = ПолучитьКоличествоНочныхЧасов(Сотрудник, ВыборкаДетальныеЗаписи.ДатаНачала, ВыборкаДетальныеЗаписи.ДатаОкончания);
					КолвоЧасовНочных = КолвоЧасовНочных + ДанныеНочные.Часов;
					КолвоДнейНочных = КолвоДнейНочных + ДанныеНочные.Дней;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		ТекДатаПериода = КонецДня(ТекДатаПериода) + 1;
	КонецЦикла;				
	Стр = ТЗ.Добавить();
	Стр.Дней = КолвоДнейНочных;
	Стр.Часов = КолвоЧасовНочных;
	
	Возврат ТЗ;
КонецФункции

Функция ПолучитьКоличествоНочныхЧасов(Сотр, Нач, Кон)
	СтруктураНочные = Новый Структура;
	СтруктураНочные.Вставить("Часов", 0);
	СтруктураНочные.Вставить("Дней", 0);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник,
		|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ЧасовОборот) КАК Часов,
		|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ДнейОборот) КАК Дней
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций.Обороты(
		|			&Нач,
		|			&Кон,
		|			Авто,
		|			Сотрудник = &Сотр
		|				И ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы)) КАК РабочееВремяРаботниковОрганизацийОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник";
	
	Запрос.УстановитьПараметр("Кон", Кон);
	Запрос.УстановитьПараметр("Нач", Нач);
	Запрос.УстановитьПараметр("Сотр", Сотр);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		СтруктураНочные.Дней =  ВыборкаДетальныеЗаписи.Дней;
		СтруктураНочные.Часов = ВыборкаДетальныеЗаписи.Часов;
	КонецЦикла;
	
	Возврат СтруктураНочные;
КонецФункции
//Аверсон СВФР-017037

//Аверсон ЕАЕ 12.02.2024 СВФР-012254
Функция ПолучитьЧТС(Орг, Сотр, Период) Экспорт //Аверсон ЕАЕ 16.10.2025 СВФР-017031 (Экспорт)
	ЧТС = 0;
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель1
	|ИЗ
	|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
	|			&Период,
	|			Организация = &Организация
	|				И Сотрудник = &Сотрудник
	|				И Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
	
	//Аверсон ЕАЕ 07.02.2025 СВФР-014830
	//|               И ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой)
	|И ВидРасчета В (&СписокВидовРасчетаЧТС)
	//Аверсон СВФР-014830
	
	|) КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
	//|ГДЕ
	//|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке)
	|
	|СГРУППИРОВАТЬ ПО
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель1";
	Запрос.УстановитьПараметр("Организация", Орг);
	Запрос.УстановитьПараметр("Сотрудник", Сотр);
	Запрос.УстановитьПараметр("Период", Период);
	
	//Аверсон ЕАЕ 07.02.2025 СВФР-014830
	СписокВидовРасчетаЧТС = Новый Массив;
	СписокВидовРасчетаЧТС.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
	СдельноВод = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Сдельно вод.", Истина);
	Если НЕ СдельноВод.Пустая() Тогда
		СписокВидовРасчетаЧТС.Добавить(СдельноВод);	
	КонецЕсли;
	Запрос.УстановитьПараметр("СписокВидовРасчетаЧТС", СписокВидовРасчетаЧТС);
	//Аверсон СВФР-014830
	
	Результат = Запрос.Выполнить();
	Если Не Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Если Выборка.Следующий() Тогда
			ЧТС = Выборка.Показатель1;	
		КонецЕсли;
	КонецЕсли;
	
	Возврат ЧТС;
КонецФункции

Функция СотрудникРаботаетПоЧасовойТарифнойСтавке(Док, Сотр, Нач, Кон)
	РаботаетПоЧТС = Истина;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаОкончания
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка = &Док
		|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник = &Сотр
		|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета В(&СписокВидовРасчета)
		//Аверсон ЕАЕ 15.05.2024 СВФР-012913
		//|	И НАЧАЛОПЕРИОДА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала, ДЕНЬ) = НАЧАЛОПЕРИОДА(&ДатаНач, ДЕНЬ)
		//|	И НАЧАЛОПЕРИОДА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаОкончания, ДЕНЬ) = НАЧАЛОПЕРИОДА(&ДатаКон, ДЕНЬ)";
		|	И НАЧАЛОПЕРИОДА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала, ДЕНЬ) <= НАЧАЛОПЕРИОДА(&ДатаКон, ДЕНЬ)
		|	И НАЧАЛОПЕРИОДА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаОкончания, ДЕНЬ) >= НАЧАЛОПЕРИОДА(&ДатаНач, ДЕНЬ)";
		//Аверсон СВФР-012913
	
	Запрос.УстановитьПараметр("ДатаКон", Кон);
	Запрос.УстановитьПараметр("ДатаНач", Нач);
	Запрос.УстановитьПараметр("Док", Док);
	Запрос.УстановитьПараметр("Сотр", Сотр);
	СписокВидовРасчета = Новый Массив;
	СписокВидовРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
	СписокВидовРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
	Запрос.УстановитьПараметр("СписокВидовРасчета", СписокВидовРасчета);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Если ВыборкаДетальныеЗаписи.Следующий() Тогда
		РаботаетПоЧТС = Ложь;
	КонецЕсли;
	
	Возврат РаботаетПоЧТС;
КонецФункции

Функция РемонтЧасов(Сотр, Нач, Кон)
	//Был = Ложь;
	РемонтЧасов = 0;
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
		|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
		|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.Результат) КАК Результат,
		|   СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноЧасов) КАК ОтработаноЧасов
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		|ГДЕ
		|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = &ВидРасчетаРемонт
		|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало = &Нач
		|	И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ) = НАЧАЛОПЕРИОДА(&Кон, ДЕНЬ)
		|
		|СГРУППИРОВАТЬ ПО
		|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник";
	
	Запрос.УстановитьПараметр("ВидРасчетаРемонт", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Ремонт", Истина));
	Запрос.УстановитьПараметр("Кон", Кон);
	Запрос.УстановитьПараметр("Нач", Нач);
	Запрос.УстановитьПараметр("Сотрудник", Сотр);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Если ВыборкаДетальныеЗаписи.Следующий() Тогда
		//Был = Истина;
		РемонтЧасов = ВыборкаДетальныеЗаписи.ОтработаноЧасов;
	КонецЕсли;
	
	Возврат РемонтЧасов;
КонецФункции

Функция ПроверитьОплатуПоСреднемуВременныйПеревод(Орг,Сотр,ДатаНач,ДатаКон) 
	Была = Ложь;
	Запрос = Новый Запрос; 
	Запрос.Текст =
	
	"ВЫБРАТЬ 
	|ОплатаПоСр.Ссылка,
	|ОплатаПоСр.Ссылка.Сотрудник,
	
	|ОплатаПоСр.ОплаченоДней КАК ОтработаноДней,
	|ОплатаПоСр.ОплаченоДнейЧасов КАК ОтработаноЧасов
	
	|ИЗ Документ.ОплатаПоСреднемуЗаработку.Начисления КАК ОплатаПоСр
	|ГДЕ ОплатаПоСр.Ссылка.Сотрудник = &Сотр
	
	|И (ОплатаПоСр.ДатаНачала <= &Кон 
	|И ОплатаПоСр.ДатаОкончания >= &Нач)
	
	|И ОплатаПоСр.Ссылка.Проведен
	|И ОплатаПоСр.ВидРасчета В (&ВидРасчетаОплатаПоСреднему)
	|И ОплатаПоСр.Ссылка.Организация = &Орг;
	|";
	
	Запрос.УстановитьПараметр("Сотр", Сотр);
	Запрос.УстановитьПараметр("Нач", НачалоДня(ДатаНач));
	Запрос.УстановитьПараметр("Кон", КонецДня(ДатаКон));
	
	//Аверсон ЕАЕ 15.01.2025 СВФР-014608
	//МассивВР = Новый Массив;
	//ВР1 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("оплата по среднему (перевод)", Истина);
	//Если Не ВР1.Пустая() Тогда
	//	МассивВР.Добавить(ВР1);
	//КонецЕсли;
	//ВР2 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("оплата по среднему (перевод)20", Истина);
	//Если Не ВР2.Пустая() Тогда
	//	МассивВР.Добавить(ВР2);
	//КонецЕсли;
	МассивВР = ПолучитьВРОплатаПоСреднему();
	//Аверсон СВФР-014608

	Запрос.УстановитьПараметр("ВидРасчетаОплатаПоСреднему", МассивВР);
	Запрос.УстановитьПараметр("Орг", Орг);
	
	РезультатЗапроса = Запрос.Выполнить();
	Если Не РезультатЗапроса.Пустой() Тогда
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Если ВыборкаДетальныеЗаписи.Следующий() Тогда
			Была = Истина;
		КонецЕсли;
	КонецЕсли;
	Возврат Была;
КонецФункции

//Аверсон ЕАЕ 15.01.2025 СВФР-014608
Функция ПолучитьВРОплатаПоСреднему()
	МассивВР = Новый Массив;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	ОсновныеНачисленияОрганизаций.Ссылка
		|ИЗ
		|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
		|ГДЕ
		|	НЕ ОсновныеНачисленияОрганизаций.ПометкаУдаления
		|	И (ОсновныеНачисленияОрганизаций.Наименование = ""оплата по среднему (перевод)""
		|			ИЛИ ОсновныеНачисленияОрганизаций.Наименование = ""оплата по среднему (перевод)20"")";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		МассивВР.Добавить(ВыборкаДетальныеЗаписи.Ссылка);
	КонецЦикла;
	
	Возврат МассивВР;
КонецФункции
//Аверсон СВФР-014608

Функция ПроверитьВременныйПеревод(Орг,Сотр,ДатаНач,ДатаКон) 
	Был = Ложь;
	Запрос = Новый Запрос; 
	Запрос.Текст =
	
	"ВЫБРАТЬ 
	|КадровоеПеремещениеОрганизаций.Ссылка,
	|КадровоеПеремещениеОрганизаций.Сотрудник
	
	|ИЗ Документ.КадровоеПеремещениеОрганизаций.РаботникиОрганизации КАК КадровоеПеремещениеОрганизаций
	|ГДЕ КадровоеПеремещениеОрганизаций.Сотрудник = &Сотр
	
	|И (КадровоеПеремещениеОрганизаций.ДатаНачала <= &Кон 
	|И КадровоеПеремещениеОрганизаций.ДатаОкончания >= &Нач) 
	|ИЛИ (КадровоеПеремещениеОрганизаций.ДатаНачала <= &Кон
	|И КадровоеПеремещениеОрганизаций.ДатаОкончанияДляОтчетаБобруйск >= &Нач)
	
	|И КадровоеПеремещениеОрганизаций.Ссылка.Проведен
	|И КадровоеПеремещениеОрганизаций.Ссылка.Организация = &Орг;
	|";
	
	Запрос.УстановитьПараметр("Сотр", Сотр);
	Запрос.УстановитьПараметр("Нач", НачалоДня(ДатаНач));
	Запрос.УстановитьПараметр("Кон", КонецДня(ДатаКон));
	Запрос.УстановитьПараметр("Орг", Орг);
	
	РезультатЗапроса = Запрос.Выполнить();
	Если Не РезультатЗапроса.Пустой() Тогда
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Если ВыборкаДетальныеЗаписи.Следующий() Тогда
			Был = Истина;
		КонецЕсли;
	КонецЕсли;
	Возврат Был;
КонецФункции
//Аверсон СВФР-012159

//Аверсон ЕАЕ 15.05.2024 СВФР-012983
Функция ПолучитьОбщийФОТ(ДокПремии)
	ФОТ = 0;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СУММА(ПремииРаботниковОрганизацийНачисления.Показатель1 * ПремииРаботниковОрганизацийНачисления.Показатель2) КАК ФОТ
		|ИЗ
		|	Документ.ПремииРаботниковОрганизаций.Начисления КАК ПремииРаботниковОрганизацийНачисления
		|ГДЕ
		|	ПремииРаботниковОрганизацийНачисления.Ссылка = &ДокПремии";
	
	Запрос.УстановитьПараметр("ДокПремии", ДокПремии);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Если ВыборкаДетальныеЗаписи.Следующий() Тогда
		ФОТ = ВыборкаДетальныеЗаписи.ФОТ;
	КонецЕсли;
	
	Возврат ФОТ;
КонецФункции

Функция ПолучитьПолныеГодыОтДатыПриема(СтрокаДвижений) Экспорт
	
	ПолныеГодыПоШкале = 0;
	ЗапросШкала = Новый Запрос;
	ЗапросШкала.Текст = 
	"ВЫБРАТЬ
	|	РАЗНОСТЬДАТ(РаботникиОрганизаций.Период, &ДатаСравнения, МЕСЯЦ) КАК СтажМесяцев
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|ГДЕ
	|	РаботникиОрганизаций.Сотрудник = &Сотрудник
	|И РаботникиОрганизаций.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)
	|";
	ЗапросШкала.УстановитьПараметр( "Сотрудник",  СтрокаДвижений.Сотрудник);
	Если Найти( ТипЗнч(СтрокаДвижений), " табличная часть строка" ) > 0 Тогда
		ДатаСравнения = СтрокаДвижений.ДатаНачала;
	ИначеЕсли Найти( ТипЗнч(СтрокаДвижений), "Выборка из результата запроса" ) > 0 Тогда
		ДатаСравнения = СтрокаДвижений.Период;
	ИначеЕсли Найти(ТипЗнч(СтрокаДвижений),"Структура") > 0 Тогда
		ДатаСравнения = СтрокаДвижений.ДатаСравнения;
	Иначе	
		ДатаСравнения = СтрокаДвижений.ПериодРегистрации;
	КонецЕсли; 
	ЗапросШкала.УстановитьПараметр( "ДатаСравнения", ДатаСравнения );
	РезультатЗапроса = ЗапросШкала.Выполнить();
	Если Не РезультатЗапроса.Пустой() Тогда
		ПолныеГодыПоШкале = РезультатЗапроса.Выгрузить().Итог("СтажМесяцев");
		ПолныеГодыПоШкале = Цел(ПолныеГодыПоШкале/12);
	КонецЕсли;
	Возврат ПолныеГодыПоШкале;
	
КонецФункции // ПолучитьПолныеГоды()
//Аверсон СВФР-012983

//Аверсон ЕАЕ 24.05.2024 СВФР-012937
Функция БылаПовременнаяОплата(Сотр, ПериодРегистрации)
	Была = Ложь;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
		|	ПовременнаяОплатаПриСделкеРаботникиОрганизации.Сотрудник
		|ИЗ
		|	Документ.ПовременнаяОплатаПриСделке.РаботникиОрганизации КАК ПовременнаяОплатаПриСделкеРаботникиОрганизации
		|ГДЕ
		|	ПовременнаяОплатаПриСделкеРаботникиОрганизации.Ссылка.Проведен
		|	И ПовременнаяОплатаПриСделкеРаботникиОрганизации.Ссылка.ПериодРегистрации = &ПериодРегистрации
		|	И ПовременнаяОплатаПриСделкеРаботникиОрганизации.Ссылка.ВидРасчета В(&СписокВидовРасчета)
		|	И ПовременнаяОплатаПриСделкеРаботникиОрганизации.Сотрудник = &Сотрудник";
	
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	Запрос.УстановитьПараметр("Сотрудник", Сотр);
	СписокВидовРасчета = Новый Массив;
	ВР = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СдельнаяОплата;
	//Если Не ВР.Пустая() Тогда
	СписокВидовРасчета.Добавить(ВР);
	//КонецЕсли;
	ВР = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Бригадные наряды", Истина);
	Если Не ВР.Пустая() Тогда
		СписокВидовРасчета.Добавить(ВР);
	КонецЕсли;
	Запрос.УстановитьПараметр("СписокВидовРасчета", СписокВидовРасчета);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Если ВыборкаДетальныеЗаписи.Следующий() Тогда
		Была = Истина;
	КонецЕсли;
	
	Возврат Была;
КонецФункции
//Аверсон СВФР-012937

//Аверсон ЕАЕ 05.05.2025 СВФР-015387
Функция ПроверитьПростои(Орг,Сотр,Нач,Кон)
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ДнейОборот) КАК Дней,
		|	СУММА(РабочееВремяРаботниковОрганизацийОбороты.ЧасовОборот) КАК Часов,
		|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций.Обороты(
		|			&Нач,
		|			&Кон,
		|			Авто,
		|			Организация = &Орг
		|				И Сотрудник = &Сотр
		|				И ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПростойПоВинеРаботодателя)) КАК РабочееВремяРаботниковОрганизацийОбороты
		|ГДЕ
		|	РабочееВремяРаботниковОрганизацийОбороты.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
		|
		|СГРУППИРОВАТЬ ПО
		|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник";
	
	Запрос.УстановитьПараметр("Кон", Кон);
	Запрос.УстановитьПараметр("Нач", Нач);
	Запрос.УстановитьПараметр("Орг", Орг);
	Запрос.УстановитьПараметр("Сотр", Сотр);
	
	ТЗ = Запрос.Выполнить().Выгрузить();
	
	Возврат ТЗ;
КонецФункции
//Аверсон СВФР-015387

//Аверсон ЕАЕ 01.07.2025 СВФР-015776
Функция ПолучитьОтработаноЧасовПоСделке(Орг, Сотр, Нач, Кон)
	ОтработаноЧасовПоСделке = 0;
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноЧасов) КАК ЧасовПоСделке,
	|	СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОтработаноДней) КАК ДнейПоСделке
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ПовременнаяОплатаПриСделке
	|И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
	|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
	|	И ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация";
	Запрос.УстановитьПараметр("Организация", Орг);
	Запрос.УстановитьПараметр("ПериодРегистрации", Нач);
	Запрос.УстановитьПараметр("ПериодРегистрации1", Кон);
	Запрос.УстановитьПараметр("Сотрудник", Сотр);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ОтработаноЧасовПоСделке = ?(ВыборкаДетальныеЗаписи.ЧасовПоСделке = NULL,0,ВыборкаДетальныеЗаписи.ЧасовПоСделке);
	КонецЦикла;  
	Возврат ОтработаноЧасовПоСделке;
КонецФункции

Функция ПолучитьСписокПовышенийСуммой()
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ГруппыРасчетовОсновные.ВидРасчета
		|ИЗ
		|	Справочник.ГруппыРасчетов.Основные КАК ГруппыРасчетовОсновные
		|ГДЕ
		|	ГруппыРасчетовОсновные.Ссылка = ЗНАЧЕНИЕ(Справочник.ГруппыРасчетов.Повышения)";
	
	СписокПовышенийСуммой = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("ВидРасчета");
	
	Возврат СписокПовышенийСуммой;
КонецФункции
//Аверсон СВФР-015776

//Аверсон ЕАЕ 11.08.2025 СВФР-016381
Функция ПолучитьОтработанноеВремяДляРасчетаППС(Организация, ПериодРегистрации, СписокСотрудников, ТЗСводныйТабель, ПоРаботникамОрганизаций, ДатаНач, ДатаКон) Экспорт
	
	ЗапросПоСотрудникам = Новый Запрос;
	ЗапросПоСотрудникам.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
	|	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря КАК Дата,
	|	0 КАК ОтработаноЧасов,
	|	&ВидДеятельности,
	|	0 КАК ТарифВзносов,
	|	РаботникиОрганизацийСрезПоследних.Организация,
	|	0 КАК Группа,
	|	РаботникиОрганизацийСрезПоследних.ГрафикРаботы,
	|	0 КАК ПроцентЗанятости,
	|	""                    "" КАК Причина,
	|	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК Физлицо,
	|	РаботникиОрганизацийСрезПоследних.Должность
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
	|			&КонДата,
	|			Организация = &Организация
	|				И ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) КАК РаботникиОрганизацийСрезПоследних,
	|	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
	|ГДЕ
	|	РаботникиОрганизацийСрезПоследних.Сотрудник В(&СписокСотрудник)
	|	И РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачДата И &КонДата
	|	И РаботникиОрганизацийСрезПоследних.Организация = &Организация
	|
	|УПОРЯДОЧИТЬ ПО
	|	Сотрудник,
	|	Дата";
	
	ЗапросПоСотрудникам.УстановитьПараметр("Организация", Организация);
	ЗапросПоСотрудникам.УстановитьПараметр("СписокСотрудник", СписокСотрудников);
	ЗапросПоСотрудникам.УстановитьПараметр("ВидДеятельности", Справочники.ОсобыеУсловияТруда.ПустаяСсылка());
	//ЗапросПоСотрудникам.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
	//ЗапросПоСотрудникам.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
	ЗапросПоСотрудникам.УстановитьПараметр("НачДата", ДатаНач);
	ЗапросПоСотрудникам.УстановитьПараметр("КонДата", ДатаКон);
	
	ТаблицаДанных = ЗапросПоСотрудникам.Выполнить().Выгрузить();
	
	//Запрос по Индивидуальным графикам
	ЗапросПоГрафикам = Новый Запрос;
	ЗапросПоГрафикам.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ГрафикиРаботыПоВидамВремени.ОсновноеЗначение,
	|	ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение,
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы КАК Сотрудник,
	|	ГрафикиРаботыПоВидамВремени.Дата
	|ИЗ
	|	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|ГДЕ
	|	ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &НачДата И &КонДата
	|	И ГрафикиРаботыПоВидамВремени.ГрафикРаботы В(&СписокСотрудник)
	|	И ГрафикиРаботыПоВидамВремени.План
	|	И ГрафикиРаботыПоВидамВремени.ВидВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)";
	
	ЗапросПоГрафикам.УстановитьПараметр("СписокСотрудник", СписокСотрудников);
	//ЗапросПоГрафикам.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
	//ЗапросПоГрафикам.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
	ЗапросПоГрафикам.УстановитьПараметр("НачДата", ДатаНач);
	ЗапросПоГрафикам.УстановитьПараметр("КонДата", ДатаКон);
	
	ТаблицаГрафиков = ЗапросПоГрафикам.Выполнить().Выгрузить();
	
	//Запрос по Отпускам
	ЗапросПоОтпускам = Новый Запрос;
	ЗапросПоОтпускам.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК Начало,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК Конец
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|	(НЕ ОсновныеНачисленияРаботниковОрганизаций.Сторно)
	|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)
	|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия МЕЖДУ &НачДата И &КонДата
	//|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &НачДата И &КонДата

	|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В(&СписокСотрудник)";
	
	ЗапросПоОтпускам.УстановитьПараметр("СписокСотрудник", СписокСотрудников);
	ЗапросПоОтпускам.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
	ЗапросПоОтпускам.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
	
	ТаблицаОтпусков = ЗапросПоОтпускам.Выполнить().Выгрузить();
	
	//убираем дни не подлежащие СП1 и СП2	
	ЗапросИсключений = Новый Запрос;
	ЗапросИсключений.Текст = 
	"ВЫБРАТЬ
	|	ГрафикиРаботыПоВидамВремени.Дата КАК ПериодДействияНачало,
	|	ГрафикиРаботыПоВидамВремени.Дата КАК ПериодДействияКонец,
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы КАК Сотрудник,
	|	ГрафикиРаботыПоВидамВремени.ВидВремени.Наименование КАК Причина
	|ИЗ
	|	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|ГДЕ
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы В(&СписокСотрудник)
	|	И ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &НачДата И &КонДата
	|	И ГрафикиРаботыПоВидамВремени.ВидВремени.ИсключатьИзПУ6
	|
	|УПОРЯДОЧИТЬ ПО
	|	Сотрудник";
	
	//ЗапросИсключений.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
	//ЗапросИсключений.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
	ЗапросИсключений.УстановитьПараметр("НачДата", ДатаНач);
	ЗапросИсключений.УстановитьПараметр("КонДата", ДатаКон);
	ЗапросИсключений.УстановитьПараметр("СписокСотрудник", СписокСотрудников);
	
	ТаблицаИсключений = ЗапросИсключений.Выполнить().Выгрузить();
	
	Для Каждого СтрокаИсключений Из ТаблицаИсключений Цикл
		СтрокиПУ6 = ТаблицаДанных.НайтиСтроки(Новый Структура("Сотрудник", СтрокаИсключений.Сотрудник));
		Для Каждого СтрокаПУ6 Из СтрокиПУ6 Цикл
			Если СтрокаПУ6.Дата >= СтрокаИсключений.ПериодДействияНачало И СтрокаПУ6.Дата <= СтрокаИсключений.ПериодДействияКонец Тогда
				СтрокаПУ6.Причина = СтрокаИсключений.Причина;
				#Если Клиент Тогда
					Сообщить(Строка(СтрокаПУ6.Сотрудник)+" "+Строка(СтрокаПУ6.Дата)+" "+Строка(СтрокаПУ6.Причина));
				#КонецЕсли
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	//перем для изменения сотрудника
	ГруппаСотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
	ГруппаВидДеятельности = Справочники.ОсобыеУсловияТруда.ПустаяСсылка();
	ГруппаДолжность = Справочники.ДолжностиОрганизаций.ПустаяСсылка();
	Группа = 0;
	
	ТЗСводныйТабель = Новый ТаблицаЗначений;
	ТЗСводныйТабель.Колонки.Добавить("ФизЛицо");
	
	Для Каждого Строка Из ТаблицаДанных Цикл
		Если НЕ ЗначениеЗаполнено(Строка.Причина) Тогда
			СтрокаРегистра1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Строка.Дата,
			Новый Структура("Сотрудник, Организация", Строка.Сотрудник, Строка.Организация));
			//Если ПериодРегистрации = Дата(2016,12,1) и не ЗначениеЗаполнено(мСтрокаРегистра1.ВидДеятельностиИзмерение) Тогда //О.Т. Аверсон 24.03.2017 № 449
			//	мСтрокаРегистра1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ДобавитьМесяц(мСтрока.Дата,1),
			//	Новый Структура("Сотрудник, Организация", мСтрока.Сотрудник, мСтрока.Организация));
			//КонецЕсли;
			
			//Аверсон ЕАЕ 15.03.2021 СВФР-007324
			Если Не ПоРаботникамОрганизаций Тогда
				ВидДеятельности = ПолучитьВидДеятельности(Строка.Сотрудник, Строка.Дата);
			КонецЕсли;
			//Аверсон СВФР-007324
			
			//СтрокаРегистра = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Строка.Дата,
			//Новый Структура("Сотрудник, Организация", Строка.Сотрудник, Строка.Организация));
			
			//Аверсон ЕАЕ 15.03.2021 СВФР-007324
			//мСтрока.ВидДеятельности = мСтрокаРегистра1.ВидДеятельностиИзмерение;
			Если ПоРаботникамОрганизаций Тогда
				Строка.ВидДеятельности = СтрокаРегистра1.ВидДеятельностиИзмерение;
			Иначе
				Строка.ВидДеятельности = ВидДеятельности;
			КонецЕсли;
			//Аверсон СВФР-007324
			
			Строка.Должность = СтрокаРегистра1.Должность;
			Строка.ТарифВзносов = РегистрыСведений.ТарифыВзносовНаППС.ПолучитьПоследнее(Строка.Дата,
			Новый Структура("ВидДеятельности", СтрокаРегистра1.ВидДеятельностиИзмерение)).Процент;
			Если ЗначениеЗаполнено(Строка.ВидДеятельности) Тогда
				//отработанное время
				СтрокаРегистраГрафикСотрудника = РегистрыСведений.ГрафикиРаботыПоВидамВремени.Получить(
				Новый Структура("ГрафикРаботы, Месяц, План, ВидУчетаВремени, Дата, ВидВремени",
				Строка.Сотрудник, НачалоМесяца(Строка.Дата), Ложь, Перечисления.ВидыУчетаВремени.ПоЧасам, Строка.Дата, Справочники.КлассификаторИспользованияРабочегоВремени.Работа));
				Строка.ОтработаноЧасов = СтрокаРегистраГрафикСотрудника.ОсновноеЗначениеПолное;
				
				если СтрокаРегистраГрафикСотрудника.ОсновноеЗначениеПолное = 0 Тогда 	
					Если Организация.ИНН="100765738" Тогда
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
						|	И РабочееВремяРаботниковОрганизаций.ДатаНачала = &Период";
					иначе
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов
						|ИЗ
						|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
						|ГДЕ
						|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
						|	И РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
						|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
						|	И РабочееВремяРаботниковОрганизаций.Период = &Период";
					КонецЕсли;
					
					
					
					Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
					Запрос.УстановитьПараметр("Период", Строка.Дата);
					Запрос.УстановитьПараметр("Сотрудник", Строка.Сотрудник);
					
					РезультатЗапроса = Запрос.Выполнить();
					
					ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
					
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						Строка.ОтработаноЧасов = ?(ЗначениеЗаполнено(ВыборкаДетальныеЗаписи.Часов),ВыборкаДетальныеЗаписи.Часов,0);
						если ТЗСводныйТабель.НайтиСтроки(Новый Структура("Физлицо",Строка.Физлицо)).Количество()=0 Тогда 
							СтрТЗСводныйТабель = ТЗСводныйТабель.Добавить();
							СтрТЗСводныйТабель.ФизЛицо = Строка.Сотрудник.Физлицо;
						КонецЕсли;
						
					КонецЦикла;
					
				КонецЕсли;
				
				//время по графику индивидуальному графику
				СтрокаРегистраГрафик = ТаблицаГрафиков.НайтиСтроки(Новый Структура("Сотрудник, Дата", Строка.Сотрудник, Строка.Дата));
				Если СтрокаРегистраГрафик.Количество() = 0 Тогда
					СтрокаРегистраГрафик = РегистрыСведений.ГрафикиРаботыПоВидамВремени.Получить(
					Новый Структура("ГрафикРаботы, Месяц, План, ВидУчетаВремени, Дата, ВидВремени",
					Строка.ГрафикРаботы, НачалоМесяца(Строка.Дата), Истина, Перечисления.ВидыУчетаВремени.ПоЧасам, Строка.Дата, Справочники.КлассификаторИспользованияРабочегоВремени.Работа));
					ЧасовПоГрафику = СтрокаРегистраГрафик.ОсновноеЗначение;
				Иначе
					ЧасовПоГрафику = СтрокаРегистраГрафик[0].ОсновноеЗначение;
				КонецЕсли;
				
				Если ЗначениеЗаполнено(ЧасовПоГрафику) Тогда
					Строка.ПроцентЗанятости = (Строка.ОтработаноЧасов/ЧасовПоГрафику)*100;
					Если Строка.ПроцентЗанятости = 0 Тогда
						СтрокиОтпуска = ТаблицаОтпусков.НайтиСтроки(Новый Структура("Сотрудник", Строка.Сотрудник));
						Для Каждого СтрокОтпуска Из СтрокиОтпуска Цикл
							Если  Строка.Дата >= СтрокОтпуска.Начало И Строка.Дата <= СтрокОтпуска.Конец Тогда
								Строка.ПроцентЗанятости = 222.99;
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
				Иначе
					Строка.ПроцентЗанятости = 100;
				КонецЕсли;
			КонецЕсли;
			Если ГруппаСотрудник <> Строка.Сотрудник Или ГруппаВидДеятельности <> Строка.ВидДеятельности Или ГруппаДолжность <> Строка.Должность Тогда
				Группа = Группа + 1;
				Строка.Группа = Группа;
				ГруппаСотрудник = Строка.Сотрудник;
				ГруппаВидДеятельности = Строка.ВидДеятельности;
				ГруппаДолжность = Строка.Должность;
			Иначе
				Строка.Группа = Группа;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	//удалим пустые строки
	ПустоеЗначение = ТаблицаДанных.НайтиСтроки(Новый Структура("ВидДеятельности", Справочники.ОсобыеУсловияТруда.ПустаяСсылка()));
	Для Каждого Строка Из ПустоеЗначение Цикл
		ТаблицаДанных.Удалить(Строка);
	КонецЦикла;
	
	Возврат ТаблицаДанных;
КонецФункции

Функция СформироватьТаблицуЗаработка(СписокФизЛиц, ПоРаботникамОрганизаций = Истина, Организация, ПериодРегистрации, ПодразделениеОрганизации, ОтработанноеВремя, Регистратор, ДатаНач, ДатаКон) 
	
	//СписокФизЛиц = тзИсчисленныйЕСН.ВыгрузитьКолонку("ФизЛицо");
	
	Запрос = Новый Запрос;
	Измерения = Новый Массив(1);
	Измерения[0] = "Сотрудник";
	
	Разрезы = Новый Массив(4);
	Разрезы[0] = "ДоходФСЗН";
	Разрезы[1] = "ДоходСтрах";
	Разрезы[2] = "ДоходЕдиногоПлатежа";
	Разрезы[3] = "КодДоходаЕСН";
	
	Запрос.УстановитьПараметр("парамИзмерения",		Измерения);
	Запрос.УстановитьПараметр("парамРазрезыЕСН",	Разрезы);
	Запрос.УстановитьПараметр("парамКатегорияПервичная", Справочники.КатегорииРасчетов.Первичное);
	Запрос.УстановитьПараметр("парамПустойСпособЕСНУ", Перечисления.ДоходыФСС_НС.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюКодДоходаЕСН", Перечисления.ДоходыФСС_НС.Облагается);
	Запрос.УстановитьПараметр("парамСпособНеОблагаетсяКодДоходаЕСН", Перечисления.ДоходыФСС_НС.НеОблагается);
	Запрос.УстановитьПараметр("парамПустойКодЕСНУ", Справочники.ДоходыЕСН.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюКодЕСН", Справочники.ДоходыЕСН.ОблагаетсяПолностью);
	Запрос.УстановитьПараметр("ОблагаетсяСтрах", Справочники.ДоходыЕСН.ОблагаетсяСтрах);
	
	Запрос.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("ОтчисленияНаППС", Перечисления.ДоходыФСС_НС.Облагается);
	//Запрос.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
	//Запрос.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("Период", ДатаНач);
	Запрос.УстановитьПараметр("Период1", ДатаКон);
	Запрос.УстановитьПараметр("ВидДеятельности", Справочники.ОсобыеУсловияТруда.ПустаяСсылка());
	Запрос.УстановитьПараметр("Должность", Справочники.ДолжностиОрганизаций.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюКодДоходаЕСН", Перечисления.ДоходыФСС_НС.Облагается);
	Запрос.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
	
	
	ПенсФондБудМес = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца)).размер;
	если ?(Организация.ИНН = "100765738", ПенсФондБудМес = 0,ПенсФондБудМес = 1) тогда //О.Т. Аверсон 31.01.2017 поменяла местами 0 и 1 
		ТекстЗапроса = 
		
		//Аверсон ЕАЕ 06.11.2022 СВФР-009799
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОснНачисления.Сотрудник,
		|	ОснНачисления.ФизЛицо,
		|	ОснНачисления.ПериодРегистрации
		|ПОМЕСТИТЬ ВТНужныеОснНачисления
		|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНачисления
		|ГДЕ 	
		|	ВЫБОР
		|	КОГДА ОснНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|	ТОГДА ОснНачисления.Организация
		|	ИНАЧЕ ОснНачисления.ПодразделениеОрганизации.Владелец
		|	КОНЕЦ = &Организация
		|И 
		//|((ОснНачисления.ПериодРегистрации МЕЖДУ &период И &Период1
		|((ОснНачисления.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА(&период,МЕСЯЦ) И КОНЕЦПЕРИОДА(&Период1,МЕСЯЦ)
		|И 
		//|(ОснНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1 ИЛИ ОснНачисления.ПериодДействияНачало < &период)
		|(ОснНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1)
		|)
		|ИЛИ
		|(ОснНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1
		//|И (ОснНачисления.ПериодРегистрации < &период))
		|И (ОснНачисления.ПериодРегистрации < НАЧАЛОПЕРИОДА(&период,МЕСЯЦ)))
		|)
		|	И ОснНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			ТекстЗапроса = ТекстЗапроса + "
			|	И ОснНачисления.ПодразделениеОрганизации = &Подразделение";
		КонецЕсли;
		ТекстЗапроса = ТекстЗапроса + "
		|		И ОснНачисления.ФизЛицо В(&СписокФизЛиц)
		
		//
		//|ОБЪЕДИНИТЬ ВСЕ
		//|
		//|ВЫБРАТЬ
		//|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник,
		//|   НачислениеЗарплатыРаботникамОрганизацийНачисления.ФизЛицо,
		//|   НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПериодРегистрации
		//|ИЗ Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
		//|ГДЕ НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка = &Регистратор
		//|	ВЫБОР
		//|	КОГДА НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		//|	ТОГДА НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.Организация
		//|	ИНАЧЕ НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПодразделениеОрганизации.Владелец
		//|	КОНЕЦ = &Организация
		//|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.ФизЛицо В(&СписокФизЛиц)
		//|	И 
		//|		((НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПериодРегистрации МЕЖДУ &период И &Период1
		//|   	И (НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала МЕЖДУ &период И &Период1 ИЛИ НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала < &период)
		//|       )
		//|       ИЛИ
		//|      (НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала МЕЖДУ &период И &Период1
		//|       И (НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПериодРегистрации < &период))
		//|       )
		//|   И НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС
		//|   И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.Проведен = ЛОЖЬ
		//
		
		|; 
		|////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТНужныеОснНачисления.ФизЛицо,
		|	ВТНужныеОснНачисления.Сотрудник,
		|	ВТНужныеОснНачисления.ПериодРегистрации,
		|	МАКСИМУМ(Гражданство.Период) КАК МаксПериод
		|ПОМЕСТИТЬ ВТПериодыГражданства
		|ИЗ ВТНужныеОснНачисления
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК Гражданство
		|ПО ВТНужныеОснНачисления.ФизЛицо = Гражданство.ФизЛицо
		|	И Гражданство.Период < ВТНужныеОснНачисления.ПериодРегистрации
		|СГРУППИРОВАТЬ ПО
		|	ВТНужныеОснНачисления.ФизЛицо,
		|	ВТНужныеОснНачисления.Сотрудник,
		|	ВТНужныеОснНачисления.ПериодРегистрации
		|; 
		|////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТПериодыГражданства.ФизЛицо,
		|	ВТПериодыГражданства.Сотрудник,
		|	ВТПериодыГражданства.ПериодРегистрации,
		|   Гражданство.НеИмеетПравоНаПенсию
		|ПОМЕСТИТЬ ВТГражданство
		|ИЗ ВТПериодыГражданства
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК Гражданство
		|ПО ВТПериодыГражданства.ФизЛицо = Гражданство.ФизЛицо
		|	И ВТПериодыГражданства.МаксПериод = Гражданство.Период
		|;
		|////////////////////////////////////////////////////////////////////////////
		//Аверсон СВФР-009799
		
		|ВЫБРАТЬ
		|	ДанныеУчета.Регистратор КАК Регистратор,
		|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
		|	ДанныеУчета.Сотрудник,
		|	ДанныеУчета.ФизЛицо,
		|	ДанныеУчета.КодДоходаЕСН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходФСЗН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходСтрах,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходЕдиныйПлатеж,
		|	ДанныеУчета.СпособРасчета,
		|	ДанныеУчета.ВидРасчета,
		|	СУММА(ДанныеУчета.Результат) КАК Результат,
		|	ДанныеУчета.ПериодДействияНачало КАК ПериодВзаиморасчетов,
		|	ДанныеУчета.ПериодДействияКонец КАК ПериодКонец,
		|	ДанныеУчета.ГрафикРаботы,
		|	ДанныеУчета.Сторно,
		|	ДанныеУчета.ВидУчетаВремени,
		|	ДанныеУчета.НеИмеетПравоНаПенсию,
		|	&ВидДеятельности,
		|	&Должность,
		|	0 КАК Тип,
		|	ДанныеУчета.Регистратор.ИсключитьИзПУ6
		|ИЗ
		|	(ВЫБРАТЬ
		|		ОсновныеНачисления.Регистратор КАК Регистратор,
		|		ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
		|		ОсновныеНачисления.Сотрудник КАК Сотрудник,
		|		ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		|		ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
		|		ВЫБОР
		|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА ОсновныеНачисления.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ ОсновныеНачисления.ВидРасчета.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|				ТОГДА &ОблагаетсяСтрах
		|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
		|		КОНЕЦ КАК КодДоходаЕСН,
		|		ОсновныеНачисления.Организация КАК Организация,
		|		ОсновныеНачисления.Результат КАК Результат,
		|		ОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало,
		|		ОсновныеНачисления.ПериодДействияКонец КАК ПериодДействияКонец,
		|		ОсновныеНачисления.ГрафикРаботы КАК ГрафикРаботы,
		|		ОсновныеНачисления.ВидУчетаВремени КАК ВидУчетаВремени,
		|		ОсновныеНачисления.Сторно КАК Сторно,
		|		ОсновныеНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
		|		НеПравоНаПенсию.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
		|	ИЗ
		|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|					ОсновныеНачисления.Сотрудник КАК Сотрудник,
		|					ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		|					ОсновныеНачисления.Организация КАК Организация,
		|					ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
		|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
		|				ИЗ
		|					РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
		|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
		|						ПО ОсновныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
		|							И ОсновныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
		|							И ОсновныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
		|							И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ОсновныеНачисления.ПериодДействияНачало)
		|				ГДЕ
		|					ВЫБОР
		|							КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|								ТОГДА ОсновныеНачисления.Организация
		|							ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
		|						КОНЕЦ = &Организация
		//|					И ОсновныеНачисления.ПериодРегистрации = &Период
		|					И ОсновныеНачисления.ПериодРегистрации = НАЧАЛОПЕРИОДА(&Период,МЕСЯЦ)
		|				
		|				СГРУППИРОВАТЬ ПО
		|					ОсновныеНачисления.Сотрудник,
		|					ОсновныеНачисления.Сотрудник.Физлицо,
		|					ОсновныеНачисления.Организация,
		|					ОсновныеНачисления.ВидРасчета) КАК СведенияОНачисленияхСрез
		|				ПО (СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник)
		|					И (СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация)
		|					И (СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета)
		|					И (СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период)
		|			ПО (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ОсновныеНачисления.Сотрудник)
		|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ОсновныеНачисления.Организация)
		|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ОсновныеНачисления.ВидРасчета)
		
		//Аверсон ЕАЕ 06.11.2022 СВФР-009799
		//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|				ГражданствоФизЛиц.ФизЛицо КАК ФизЛицо,
		//|				ГражданствоФизЛиц.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
		//|			ИЗ  
		//|				РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц) КАК НеПравоНаПенсию
		//|			ПО ОсновныеНачисления.ФизЛицо = НеПравоНаПенсию.ФизЛицо
		
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТГражданство КАК НеПравоНаПенсию
		|ПО ОсновныеНачисления.ФизЛицо = НеПравоНаПенсию.ФизЛицо
		|	И ОсновныеНачисления.ПериодРегистрации = НеПравоНаПенсию.ПериодРегистрации
		
		//Аверсон ЕАЕ 14.12.2022 СВФР-010013
		|	И ОсновныеНачисления.Сотрудник = НеПравоНаПенсию.Сотрудник
		//Аверсон СВФР-010013
		
		//Аверсон СВФР-009799
		
		|	ГДЕ
		|		ВЫБОР
		|				КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|					ТОГДА ОсновныеНачисления.Организация
		|				ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
		|			КОНЕЦ = &Организация";
		
		//Аверсон 15.06.2021 КВВ СВФР-007702 (
		////Аверсон 20.11.2020 КВВ СВФР-006848 (
		////|		И ОсновныеНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1
		//Если ПоРегистрации Тогда
		//	ТекстЗапроса = ТекстЗапроса + "                                 
		//	|		И ОсновныеНачисления.ПериодРегистрации МЕЖДУ &период И &Период1";
		//Иначе
		//	ТекстЗапроса = ТекстЗапроса + "
		//	|		И ОсновныеНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1";
		//КонецЕсли;  
		////Аверсон 20.11.2020 КВВ СВФР-006848 )
		ТекстЗапроса = ТекстЗапроса + "
		|И 
		//|((ОсновныеНачисления.ПериодРегистрации МЕЖДУ &период И &Период1
		|((ОсновныеНачисления.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА(&период,МЕСЯЦ) И КОНЕЦПЕРИОДА(&Период1,МЕСЯЦ)
		|	И 
		|	(ОсновныеНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1
		//|		ИЛИ
		//|	ОсновныеНачисления.ПериодДействияНачало < &период
		|)
		|  )
		|  ИЛИ
		|(ОсновныеНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1
		|И
		//|(ОсновныеНачисления.ПериодРегистрации < &период)
		|(ОсновныеНачисления.ПериодРегистрации < НАЧАЛОПЕРИОДА(&период,МЕСЯЦ))
		|)
		|)";
		//Аверсон 15.06.2021 КВВ СВФР-007702 )
		
		ТекстЗапроса = ТекстЗапроса + "
		|		И ОсновныеНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			ТекстЗапроса = ТекстЗапроса + "
			|	И ОсновныеНачисления.ПодразделениеОрганизации = &Подразделение";
		КонецЕсли;
		ТекстЗапроса = ТекстЗапроса + "
		|		И ОсновныеНачисления.ФизЛицо В(&СписокФизЛиц)) КАК ДанныеУчета
		
		
		
		|ГДЕ
		|	ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН = ИСТИНА
		|	И ЕСТЬNULL(ДанныеУчета.Регистратор.ИсключитьИзПУ6, ЛОЖЬ) <> ИСТИНА
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеУчета.ВидРасчета,
		|	ДанныеУчета.СпособРасчета,
		|	ДанныеУчета.Сторно,
		|	ДанныеУчета.ПериодДействияКонец,
		|	ДанныеУчета.КодДоходаЕСН,
		|	ДанныеУчета.Сотрудник,
		|	ДанныеУчета.ВидУчетаВремени,
		|	ДанныеУчета.ГрафикРаботы,
		|	ДанныеУчета.ПериодДействияНачало,
		|	ДанныеУчета.ФизЛицо,
		|	ДанныеУчета.НеИмеетПравоНаПенсию,
		|	ДанныеУчета.НомерСтроки,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ДанныеУчета.Регистратор,
		|	ДанныеУчета.Регистратор.ИсключитьИзПУ6
		|
		|УПОРЯДОЧИТЬ ПО
		|	Регистратор,
		|	НомерСтроки";
	иначе
		ТекстЗапроса =
		
		//Аверсон ЕАЕ 08.11.2022 СВФР-009799 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ  
		|	ОснНачисления.Сотрудник,
		|	ОснНачисления.ФизЛицо,
		|	ОснНачисления.ПериодРегистрации
		|ПОМЕСТИТЬ ВТНужныеОснНачисления
		|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНачисления
		|ГДЕ 
		|ВЫБОР
		|КОГДА ОснНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|ТОГДА ОснНачисления.Организация
		|ИНАЧЕ ОснНачисления.ПодразделениеОрганизации.Владелец
		|КОНЕЦ = &Организация
		|И ОснНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС
		|И 
		//|((ОснНачисления.ПериодРегистрации МЕЖДУ &период И &Период1
		|((ОснНачисления.ПериодРегистрации МЕЖДУ НАЧАОПЕРИОДА(&период,МЕСЯЦ) И КОНЕЦПЕРИОДА(&Период1,МЕСЯЦ)
		|	И 
		|	(ОснНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1
		//|		ИЛИ
		//|	ОснНачисления.ПериодДействияНачало < &период
		|)
		|  )
		|  ИЛИ
		|(ОснНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1
		|И
		//|(ОснНачисления.ПериодРегистрации < &период)
		|(ОснНачисления.ПериодРегистрации < НАЧАЛОПЕРИОДА(&период,МЕСЯЦ))
		|)
		|)";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			ТекстЗапроса = ТекстЗапроса + "
			|	И ОснНачисления.ПодразделениеОрганизации = &Подразделение";
		КонецЕсли;
		ТекстЗапроса = ТекстЗапроса + "
		|		И ОснНачисления.ФизЛицо В(&СписокФизЛиц)
        |;
		|//////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТНужныеОснНачисления.ФизЛицо,
		|	ВТНужныеОснНачисления.Сотрудник,
		|	ВТНужныеОснНачисления.ПериодРегистрации,
		|	МАКСИМУМ(Гражданство.Период) КАК МаксПериод
		|ПОМЕСТИТЬ ВТПериодыГражданства
		|ИЗ ВТНужныеОснНачисления
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК Гражданство
		|ПО ВТНужныеОснНачисления.ФизЛицо = Гражданство.ФизЛицо
		|	И Гражданство.Период < ВТНужныеОснНачисления.ПериодРегистрации
		|СГРУППИРОВАТЬ ПО
		|	ВТНужныеОснНачисления.ФизЛицо,
		|	ВТНужныеОснНачисления.Сотрудник,
		|	ВТНужныеОснНачисления.ПериодРегистрации
		|; 
		|////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТПериодыГражданства.ФизЛицо,
		|	ВТПериодыГражданства.Сотрудник,
		|	ВТПериодыГражданства.ПериодРегистрации,
		|   Гражданство.НеИмеетПравоНаПенсию
		|ПОМЕСТИТЬ ВТГражданство
		|ИЗ ВТПериодыГражданства
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК Гражданство
		|ПО ВТПериодыГражданства.ФизЛицо = Гражданство.ФизЛицо
		|	И ВТПериодыГражданства.МаксПериод = Гражданство.Период
		|;
		|////////////////////////////////////////////////////////////////////////////
		//Аверсон СВФР-009799
		
		|ВЫБРАТЬ
		|	ДанныеУчета.Регистратор КАК Регистратор,
		|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
		|	ДанныеУчета.Сотрудник,
		|	ДанныеУчета.ФизЛицо,
		|	ДанныеУчета.КодДоходаЕСН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходФСЗН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходСтрах,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходЕдиныйПлатеж,
		|	ДанныеУчета.СпособРасчета,
		|	ДанныеУчета.ВидРасчета,
		|	СУММА(ДанныеУчета.Результат) КАК Результат,
		|	ДанныеУчета.ПериодДействияНачало КАК ПериодВзаиморасчетов,
		|	ДанныеУчета.ПериодДействияКонец КАК ПериодКонец,
		|	ДанныеУчета.ГрафикРаботы,
		|	ДанныеУчета.Сторно,
		|	ДанныеУчета.ВидУчетаВремени,
		|	ДанныеУчета.НеИмеетПравоНаПенсию,
		|	&ВидДеятельности,
		|	&Должность,
		|	0 КАК Тип,
		|	ДанныеУчета.Регистратор.ИсключитьИзПУ6
		|ИЗ
		|	(ВЫБРАТЬ
		|		ОсновныеНачисления.Регистратор КАК Регистратор,
		|		ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
		|		ОсновныеНачисления.Сотрудник КАК Сотрудник,
		|		ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		|		ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
		|		ВЫБОР
		|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА ОсновныеНачисления.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ ОсновныеНачисления.ВидРасчета.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|				ТОГДА &ОблагаетсяСтрах
		|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
		|		КОНЕЦ КАК КодДоходаЕСН,
		|		ОсновныеНачисления.Организация КАК Организация,
		|		ОсновныеНачисления.Результат КАК Результат,
		|		ОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало,
		|		ОсновныеНачисления.ПериодДействияКонец КАК ПериодДействияКонец,
		|		ОсновныеНачисления.ГрафикРаботы КАК ГрафикРаботы,
		|		ОсновныеНачисления.ВидУчетаВремени КАК ВидУчетаВремени,
		|		ОсновныеНачисления.Сторно КАК Сторно,
		|		ОсновныеНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
		|		НеПравоНаПенсию.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
		|	ИЗ
		|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|					ОсновныеНачисления.Сотрудник КАК Сотрудник,
		|					ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		|					ОсновныеНачисления.Организация КАК Организация,
		|					ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
		|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
		|				ИЗ
		|					РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
		|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
		|						ПО ОсновныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
		|							И ОсновныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
		|							И ОсновныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
		|							И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ОсновныеНачисления.ПериодДействияНачало)
		|				ГДЕ
		|					ВЫБОР
		|							КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|								ТОГДА ОсновныеНачисления.Организация
		|							ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
		|						КОНЕЦ = &Организация
		//|					И ОсновныеНачисления.ПериодРегистрации = &Период
		|					И ОсновныеНачисления.ПериодРегистрации = НАЧАЛОПЕРИОДА(&Период,МЕСЯЦ)
		|				
		|				СГРУППИРОВАТЬ ПО
		|					ОсновныеНачисления.Сотрудник,
		|					ОсновныеНачисления.Сотрудник.Физлицо,
		|					ОсновныеНачисления.Организация,
		|					ОсновныеНачисления.ВидРасчета) КАК СведенияОНачисленияхСрез
		|				ПО (СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник)
		|					И (СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация)
		|					И (СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета)
		|					И (СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период)
		|			ПО (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ОсновныеНачисления.Сотрудник)
		|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ОсновныеНачисления.Организация)
		|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ОсновныеНачисления.ВидРасчета)
		
		//Аверсон ЕАЕ 08.11.2022 СВФР-009799
		//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|				ГражданствоФизЛиц.ФизЛицо КАК ФизЛицо,
		//|				ГражданствоФизЛиц.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
		//|			ИЗ
		//|				РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц) КАК НеПравоНаПенсию
		//|			ПО ОсновныеНачисления.ФизЛицо = НеПравоНаПенсию.ФизЛицо 
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТГражданство КАК НеПравоНаПенсию
		|ПО ОсновныеНачисления.ФизЛицо = НеПравоНаПенсию.ФизЛицо
		|	И ОсновныеНачисления.ПериодРегистрации = НеПравоНаПенсию.ПериодРегистрации
		
		//Аверсон ЕАЕ 14.12.2022 СВФР-010013
		|	И ОсновныеНачисления.Сотрудник = НеПравоНаПенсию.Сотрудник
		//Аверсон СВФР-010013
		
		//Аверсон СВФР-009799
		
		|	ГДЕ
		|		ВЫБОР
		|				КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|					ТОГДА ОсновныеНачисления.Организация
		|				ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
		|			КОНЕЦ = &Организация
		|		И ОсновныеНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС";
		
		//Аверсон 16.06.2021 КВВ СВФР-007702 (
		//|		И ОсновныеНачисления.ПериодРегистрации = &Период
		ТекстЗапроса = ТекстЗапроса + "
		|И 
		//|((ОсновныеНачисления.ПериодРегистрации МЕЖДУ &период И &Период1
		|((ОсновныеНачисления.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА(&период,МЕСЯЦ) И КОНЕЦПЕРИОДА(&Период1,МЕСЯЦ)
		|	И 
		|	(ОсновныеНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1
		//|		ИЛИ
		//|	ОсновныеНачисления.ПериодДействияНачало < &период
		|)
		|  )
		|  ИЛИ
		|(ОсновныеНачисления.ПериодДействияНачало МЕЖДУ &период И &Период1
		|И
		//|(ОсновныеНачисления.ПериодРегистрации < &период)
		|(ОсновныеНачисления.ПериодРегистрации < НАЧАЛОПЕРИОДА(&период,МЕСЯЦ))
		|)
		|)";
		//Аверсон 16.06.2021 КВВ СВФР-007702 )
		
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			ТекстЗапроса = ТекстЗапроса + "
			|	И ОсновныеНачисления.ПодразделениеОрганизации = &Подразделение";
		КонецЕсли;
		ТекстЗапроса = ТекстЗапроса + "
		|		И ОсновныеНачисления.ФизЛицо В(&СписокФизЛиц)) КАК ДанныеУчета
		|ГДЕ
		|	ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН = ИСТИНА
		|	И ЕСТЬNULL(ДанныеУчета.Регистратор.ИсключитьИзПУ6, ЛОЖЬ) <> ИСТИНА
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеУчета.Регистратор,
		|	ДанныеУчета.НомерСтроки,
		|	ДанныеУчета.Сотрудник,
		|	ДанныеУчета.ФизЛицо,
		|	ДанныеУчета.КодДоходаЕСН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ДанныеУчета.СпособРасчета,
		|	ДанныеУчета.ВидРасчета,
		|	ДанныеУчета.ПериодДействияНачало,
		|	ДанныеУчета.ПериодДействияКонец,
		|	ДанныеУчета.ГрафикРаботы,
		|	ДанныеУчета.Сторно,
		|	ДанныеУчета.ВидУчетаВремени,
		|	ДанныеУчета.НеИмеетПравоНаПенсию,
		|	ДанныеУчета.Регистратор.ИсключитьИзПУ6
		|
		|УПОРЯДОЧИТЬ ПО
		|	Регистратор,
		|	НомерСтроки";
		
	КонецЕсли;
	Запрос.Текст = ТекстЗапроса;
	
	
	
	
	
	
	//"ВЫБРАТЬ
	//|	РасчетЕСНОсновныеНачисления.ФизЛицо,
	//|	РасчетЕСНОсновныеНачисления.ДоходФСЗН,
	//|	РасчетЕСНОсновныеНачисления.ПериодДействияНачало КАК ПериодВзаиморасчетов,
	//|	СУММА(РасчетЕСНОсновныеНачисления.Результат) КАК Результат,
	//|	РасчетЕСНОсновныеНачисления.Сотрудник,
	//|	&ВидДеятельности,
	//|	&Должность,
	//|	0 КАК Тип,
	//|	РасчетЕСНОсновныеНачисления.ПериодДействияКонец КАК ПериодКонец
	//|ИЗ
	//|	Документ.РасчетЕСН.ОсновныеНачисления КАК РасчетЕСНОсновныеНачисления
	//|ГДЕ
	//|	РасчетЕСНОсновныеНачисления.ФизЛицо В(&СписокФизЛиц)
	//|	И НАЧАЛОПЕРИОДА(РасчетЕСНОсновныеНачисления.Ссылка.ПериодРегистрации, МЕСЯЦ) = &Период
	//|	И РасчетЕСНОсновныеНачисления.Ссылка.Проведен
	//|	И РасчетЕСНОсновныеНачисления.Ссылка.Организация = &Организация
	//|	И РасчетЕСНОсновныеНачисления.ДоходФСЗН = &ОтчисленияНаППС
	//|	И РасчетЕСНОсновныеНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС
	//|
	//|СГРУППИРОВАТЬ ПО
	//|	РасчетЕСНОсновныеНачисления.ДоходФСЗН,
	//|	РасчетЕСНОсновныеНачисления.ПериодДействияНачало,
	//|	РасчетЕСНОсновныеНачисления.ФизЛицо,
	//|	РасчетЕСНОсновныеНачисления.Сотрудник,
	//|	РасчетЕСНОсновныеНачисления.ПериодДействияКонец";
	ИсходнаяТаблица = Запрос.Выполнить().Выгрузить();
	
	//Аверсон 21.07.2021 КВВ СВФР-007892 (
	ЗПраздников = Новый Запрос;
	ЗПраздников.Текст = "ВЫБРАТЬ
	|РегламентированныйПроизводственныйКалендарь.ДатаКалендаря КАК ДатаКалендаря
	|ИЗ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
	|ГДЕ РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачМесяца И &КонМесяца
	|И РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Праздник)";
	ЗПраздников.УстановитьПараметр("НачМесяца",НачалоМесяца(ПериодРегистрации));
	ЗПраздников.УстановитьПараметр("КонМесяца",КонецМесяца(ПериодРегистрации));
	ТЗПраздников = ЗПраздников.Выполнить().Выгрузить();
	//Аверсон 21.07.2021 КВВ СВФР-007892 )
	
	//Аверсон 13.11.2020 КВВ СВФР-006819 (
	СписокВР1 = Новый СписокЗначений;
	Для Каждого Строка Из Справочники.ГруппыРасчетов.ИсключенияИзЗаписейСтажаПоППС.Повышения Цикл  // 3 ТЧ
		СписокВР1.Добавить(Строка.ВидРасчета.Ссылка);
	КонецЦикла;
	СписокВР2 = Новый СписокЗначений;
	Для Каждого Строка Из Справочники.ГруппыРасчетов.ИсключенияИзЗаписейСтажаПоППС.Доплаты Цикл   // 4 ТЧ
		
		//Аверсон 15.06.2021 КВВ СВФР-007702 ( (закомментировано)
		////Аверсон 26.05.2021 КВВ СВФР-007574 (
		//ЗначВСпискеВР1 = СписокВР1.НайтиПоЗначению(Строка.ВидРасчета.Ссылка);
		//Если НЕ ЗначВСпискеВР1 = Неопределено Тогда
		//	//Аверсон 26.05.2021 КВВ СВФР-007574 )
		//Аверсон 15.06.2021 КВВ СВФР-007702 ) (закомментировано)
		
		СписокВР2.Добавить(Строка.ВидРасчета.Ссылка);
		//КонецЕсли;
	КонецЦикла;
	
	Если СписокВР1.Количество() <> 0 И СписокВР2.Количество() <> 0 Тогда
		ТЗПериодовСотрИсхТабл = Новый ТаблицаЗначений;
		ТЗПериодовСотрИсхТабл.Колонки.Добавить("ПериодВзаиморасчетов");
		ТЗПериодовСотрИсхТабл.Колонки.Добавить("Сотрудник");
		ТЗПериодовСотрИсхТабл.Колонки.Добавить("ВидРасчета");
		ТЗПериодовСотрИсхТабл.Колонки.Добавить("ПериодНачалаДок");
		ТЗПериодовСотрИсхТабл.Колонки.Добавить("НачМесПериодНачалаДок");
		
		ИсходнаяТаблицаКопия = ИсходнаяТаблица.Скопировать(); //СВЭЙ 30.10.2023 КВВ СВФР-011719
		
		Для Каждого СтрТЗПер ИЗ ИсходнаяТаблица Цикл
			НайденныйЭлт = СписокВР2.НайтиПоЗначению(СтрТЗПер.ВидРасчета);
			Если НайденныйЭлт <> Неопределено Тогда
				
				//СВЭЙ 30.10.2023 КВВ СВФР-011719 (
				Если СтрТЗПер.Сторно = Истина Тогда
					Продолжить;
				КонецЕсли;  
				ОтборСторно = Новый Структура;    
				ОтборСторно.Вставить("Сторно", Истина);
				ОтборСторно.Вставить("ВидРасчета", СтрТЗПер.ВидРасчета);
				ОтборСторно.Вставить("ПериодКонец", СтрТЗПер.ПериодКонец);
				ОтборСторно.Вставить("ПериодВзаиморасчетов", СтрТЗПер.ПериодВзаиморасчетов);
				ОтборСторно.Вставить("Результат", -СтрТЗПер.Результат); 
				ОтборСторно.Вставить("ФизЛицо", СтрТЗПер.ФизЛицо);
				ОтборСторно.Вставить("Сотрудник", СтрТЗПер.Сотрудник);
				
				СтрокиСторно = ИсходнаяТаблицаКопия.НайтиСтроки(ОтборСторно);
				Если СтрокиСторно.Количество() > 0 Тогда
					Продолжить;
				КонецЕсли;
				//СВЭЙ 30.10.2023 КВВ СВФР-011719 )
				
				Стр00 = ТЗПериодовСотрИсхТабл.Добавить();
				Стр00.Сотрудник = СтрТЗПер.Сотрудник;
				Стр00.ПериодВзаиморасчетов = СтрТЗПер.ПериодВзаиморасчетов;
				Стр00.ВидРасчета = СтрТЗПер.ВидРасчета;
				Если ТипЗнч(СтрТЗПер.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда
					//Стр00.ПериодНачалаДок = СтрТЗПер.Регистратор.ДатаНачалаОсновногоОтпуска;
					Стр00.ПериодНачалаДок = ?(ЗначениеЗаполнено(СтрТЗПер.Регистратор.ДатаНачалаОсновногоОтпуска),СтрТЗПер.Регистратор.ДатаНачалаОсновногоОтпуска,СтрТЗПер.Регистратор.ДатаНачалаДополнительногоОтпуска); //СВЭЙ 30.10.2023 КВВ СВФР-011719
				Иначе
					Стр00.ПериодНачалаДок = СтрТЗПер.ПериодВзаиморасчетов;
				КонецЕсли;
				Стр00.НачМесПериодНачалаДок = НачалоМесяца(Стр00.ПериодНачалаДок);
			КонецЕсли;
		КонецЦикла;
		ТЗПериодовСотрИсхТабл.Свернуть("ПериодВзаиморасчетов,ПериодНачалаДок,Сотрудник,НачМесПериодНачалаДок,ВидРасчета");
		ТЗПериодовСотрИсхТабл.Сортировать("Сотрудник,ПериодВзаиморасчетов,ПериодНачалаДок");
		
		ТЗПериодовСотрИсхТабл5 = ТЗПериодовСотрИсхТабл.Скопировать(); //СВЭЙ 30.10.2023 КВВ СВФР-011719
		
		ТЗПериодовСотрИсхТабл2 = ТЗПериодовСотрИсхТабл.Скопировать(,"НачМесПериодНачалаДок,Сотрудник");
		ТЗПериодовСотрИсхТабл2.Свернуть("Сотрудник,НачМесПериодНачалаДок");
		
		Для Каждого Стр2 ИЗ ТЗПериодовСотрИсхТабл2 Цикл
			З = Новый Запрос;
			З.Текст = "ВЫБРАТЬ 
			|ОснНач.ПериодДействияНачало, //Аверсон 29.07.2021 КВВ СВФР-007892 (пункт 2)
			|ОснНач.ПериодДействияКонец
			|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНач
			|ГДЕ ОснНач.Сотрудник = &Сотрудник
			|И ОснНач.ВидРасчета В (&СписокВР)
			|И ОснНач.ПериодДействияНачало МЕЖДУ &Начало И &Окончание";
			З.УстановитьПараметр("Сотрудник",Стр2.Сотрудник);
			З.УстановитьПараметр("СписокВР",СписокВР1);
			З.УстановитьПараметр("Начало",Стр2.НачМесПериодНачалаДок);
			З.УстановитьПараметр("Окончание",КонецМесяца(Стр2.НачМесПериодНачалаДок));
			РезЗ = З.Выполнить().Выгрузить();
			Если РезЗ.Количество() <> 0 Тогда
				Для Каждого Стр3 ИЗ РезЗ Цикл
					ДатаПроверкиС = Стр3.ПериодДействияНачало; //Аверсон 29.07.2021 КВВ СВФР-007892 (пункт 2)
					ДатаПроверки = Стр3.ПериодДействияКонец;
					
					Отбор = Новый Структура;
					Отбор.Вставить("Сотрудник", Стр2.Сотрудник);
					Строки1 = ТЗПериодовСотрИсхТабл.НайтиСтроки(Отбор);
					Для Каждого Стр3 Из Строки1 Цикл
						//Аверсон 29.07.2021 КВВ СВФР-007892 (пункт 2) (
						Удалять = Ложь;
						Если НачалоДня(Стр3.ПериодНачалаДок) >= НачалоДня(ДатаПроверкиС)
							И КонецДня(Стр3.ПериодНачалаДок) <= КонецДня(ДатаПроверки) 
							И НачалоМесяца(Стр3.ПериодНачалаДок) = НачалоМесяца(ПериодРегистрации) Тогда
							Удалять = Истина;	
						КонецЕсли;
						Если НЕ Удалять Тогда
							//Аверсон 29.07.2021 КВВ СВФР-007892 (пункт 2) )
							//Аверсон 21.07.2021 КВВ СВФР-007892 (
							//Если ДатаПроверки < Стр3.ПериодНачалаДок Тогда
							Вчера = НачалоДня(Стр3.ПериодНачалаДок)-1;
							Если ДеньНедели(Вчера) = 6 ИЛИ ДеньНедели(Вчера) = 7 Тогда
								Вчера = Вчера - (60*60*24) * ?(ДеньНедели(Вчера) = 6,1,2);
							КонецЕсли;
							Если ТЗПраздников.Количество() > 0 Тогда
								Для Каждого СтрТЗПраздников Из ТЗПраздников Цикл
									Если НачалоДня(Вчера) = НачалоДня(СтрТЗПраздников.ДатаКалендаря) Тогда
										Вчера = НачалоДня(Вчера)-1;
									КонецЕсли;
								КонецЦикла;
							КонецЕсли;
							Если НачалоДня(ДатаПроверки) = НачалоДня(Вчера) Тогда
								//Аверсон 21.07.2021 КВВ СВФР-007892 )
								Удалять = Истина;  //Аверсон 29.07.2021 КВВ СВФР-007892 (пункт 2)
							КонецЕсли;
						КонецЕсли;
						
						//СВЭЙ 30.10.2023 КВВ СВФР-011719 (
						Если НЕ Удалять Тогда     
							З2 = Новый Запрос;
							З2.Текст = "ВЫБРАТЬ 
							|ОснНач.ПериодДействияНачало, 
							|ОснНач.ПериодДействияКонец
							|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНач
							|ГДЕ ОснНач.Сотрудник = &Сотрудник 
							|И ОснНач.Сторно = Ложь
							|И ОснНач.ВидРасчета = &ВР
							|И ОснНач.ПериодДействияКонец = &ДатаПроверки";
							З2.УстановитьПараметр("Сотрудник",Стр2.Сотрудник);
							З2.УстановитьПараметр("ВР",Стр3.ВидРасчета);
							З2.УстановитьПараметр("ДатаПроверки",НачалоДня(Стр3.ПериодНачалаДок)-1);
							РезЗ2 = З2.Выполнить().Выгрузить();
							Если РезЗ2.Количество() <> 0 Тогда 
								Для Каждого СтрЗ2 ИЗ РезЗ2 Цикл 
									НачВР = СтрЗ2.ПериодДействияНачало; 
									Отбор6 = Новый Структура;             
									Отбор6.Вставить("Сотрудник", Стр3.Сотрудник);
									Отбор6.Вставить("ПериодВзаиморасчетов", НачВР);
									Отбор6.Вставить("ВидРасчета", Стр3.ВидРасчета);
									Строки6 = ИсходнаяТаблицаКопия.НайтиСтроки(Отбор6); 
									Если Строки6.Количество() > 0 Тогда
										Отбор7 = Новый Структура;             
										Отбор7.Вставить("Сотрудник", Стр3.Сотрудник);
										Отбор7.Вставить("ПериодВзаиморасчетов", НачВР);
										Отбор7.Вставить("ВидРасчета", Стр3.ВидРасчета);
										Строки7 = ИсходнаяТаблица.НайтиСтроки(Отбор7); 
										Если Строки7.Количество() = 0 Тогда
											Удалять = Истина;
										КонецЕсли;
									КонецЕсли;
								КонецЦикла;
							КонецЕсли;
						КонецЕсли;
						//СВЭЙ 30.10.2023 КВВ СВФР-011719 )
						
						Если Удалять Тогда  //Аверсон 29.07.2021 КВВ СВФР-007892 (пункт 2)
							Отбор2 = Новый Структура;             
							Отбор2.Вставить("Сотрудник", Стр3.Сотрудник);
							Отбор2.Вставить("ПериодВзаиморасчетов", Стр3.ПериодВзаиморасчетов);
							Отбор2.Вставить("ВидРасчета", Стр3.ВидРасчета);
							Строки2 = ИсходнаяТаблица.НайтиСтроки(Отбор2);
							Для Каждого Стр4 Из Строки2 Цикл
								ИсходнаяТаблица.Удалить(Стр4); 
							КонецЦикла;
						КонецЕсли;
					КонецЦикла;
				КонецЦикла;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;	
	//Аверсон 13.11.2020 КВВ СВФР-006819 )
	
	//Аверсон 15.06.2021 КВВ СВФР-007702 (
	//Аверсон ЕАЕ 02.10.2025 СВФР-016381
	//Если ПоРаботникамОрганизаций Тогда
	//	СтаршийИндексКолонок = ИсходнаяТаблица.Колонки.Количество() - 1; 
	//	Индекс = ИсходнаяТаблица.Количество() - 1; 
	//	Пока Индекс >= 0 Цикл 
	//		Для Сч = 0 По СтаршийИндексКолонок Цикл 
	//			ВД = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ИсходнаяТаблица[Индекс].ПериодВзаиморасчетов,Новый Структура("Сотрудник",ИсходнаяТаблица[Индекс].Сотрудник)).ВидДеятельностиИзмерение;
	//			Если НЕ ЗначениеЗаполнено(ВД) Тогда
	//				ИсходнаяТаблица.Удалить(Индекс); 
	//				Прервать; 
	//			КонецЕсли; 
	//		КонецЦикла; 
	//		Индекс = Индекс - 1; 
	//	КонецЦикла;
	//КонецЕсли;
	//Аверсон СВФР-016381
	//Аверсон 15.06.2021 КВВ СВФР-007702 )
	
	если ?(Организация.ИНН = "100765738", ПенсФондБудМес = 0,ПенсФондБудМес = 1) тогда
		ТекстЗапроса = 
		
		//Аверсон ЕАЕ 08.11.2022 СВФР-009799
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ДопНачисления.ФизЛицо,
		|	ДопНачисления.Сотрудник,
		|	ДопНачисления.ПериодРегистрации
		|ПОМЕСТИТЬ ВТНужныеДопНачисления
		|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДопНачисления
		|ГДЕ
		|		ВЫБОР
		|				КОГДА ДопНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|					ТОГДА ДопНачисления.Организация
		|				ИНАЧЕ ДопНачисления.ПодразделениеОрганизации.Владелец
		|			КОНЕЦ = &Организация
		//|		И НАЧАЛОПЕРИОДА(ДопНачисления.ПериодРегистрации, МЕСЯЦ) = &Период
		//|		И ДопНачисления.ПериодРегистрации = &Период
		|       И ДопНачисления.БазовыйПериодНачало МЕЖДУ &Период И &Период1
		|		И ДопНачисления.ФизЛицо В(&СписокФизЛиц)
		|		И ДопНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС
		|;
		|///////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТНужныеДопНачисления.ФизЛицо,
		|	ВТНужныеДопНачисления.Сотрудник,
		|	ВТНужныеДопНачисления.ПериодРегистрации,
		|	МАКСИМУМ(Гражданство.Период) КАК МаксПериод
		|ПОМЕСТИТЬ ВТПериодыГражданства
		|ИЗ ВТНужныеДопНачисления
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК Гражданство
		|ПО ВТНужныеДопНачисления.ФизЛицо = Гражданство.ФизЛицо
		|	И Гражданство.Период < ВТНужныеДопНачисления.ПериодРегистрации
		|СГРУППИРОВАТЬ ПО
		|	ВТНужныеДопНачисления.ФизЛицо,
		|	ВТНужныеДопНачисления.Сотрудник,
		|	ВТНужныеДопНачисления.ПериодРегистрации
		|; 
		|////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТПериодыГражданства.ФизЛицо,
		|	ВТПериодыГражданства.Сотрудник,
		|	ВТПериодыГражданства.ПериодРегистрации,
		|   Гражданство.НеИмеетПравоНаПенсию
		|ПОМЕСТИТЬ ВТГражданство
		|ИЗ ВТПериодыГражданства
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК Гражданство
		|ПО ВТПериодыГражданства.ФизЛицо = Гражданство.ФизЛицо
		|	И ВТПериодыГражданства.МаксПериод = Гражданство.Период
		|;
		|////////////////////////////////////////////////////////////////////////////
		//Аверсон СВФР-009799
		
		|ВЫБРАТЬ
		|	ДанныеУчета.Регистратор КАК Регистратор,
		|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
		|	ДанныеУчета.Сотрудник,
		|	ДанныеУчета.ФизЛицо,
		|	ДанныеУчета.КодДоходаЕСН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходФСЗН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходСтрах,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходЕдиныйПлатеж,
		|	ДанныеУчета.ВидРасчета,
		|	ДанныеУчета.СпособРасчета,
		|	СУММА(ДанныеУчета.Результат) КАК Результат,
		|	ДанныеУчета.НачалоБазовогоПериода КАК ПериодВзаиморасчетов,
		|	ДанныеУчета.КонецБазовогоПериода КАК БазовыйПериодКонец,
		|	ДанныеУчета.БазовыйНачало КАК БазовыйНачало,
		|	ДанныеУчета.БазовыйКонец КАК БазовыйКонец,
		|	ДанныеУчета.ПериодРегистрации,
		|	ДанныеУчета.НеИмеетПравоНаПенсию,
		|	&ВидДеятельности,
		|	&Должность,
		|	0 КАК Тип,
		|	ДанныеУчета.ВидРасчета.ВидПремии КАК ВидПремии
		|ИЗ
		|	(ВЫБРАТЬ
		|		ДополнительныеНачисления.Регистратор КАК Регистратор,
		|		ДополнительныеНачисления.НомерСтроки КАК НомерСтроки,
		|		ДополнительныеНачисления.Сотрудник КАК Сотрудник,
		|		ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисления.ВидРасчета.ПериодРегистрацииКакБазовый
		|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ)
		|			ИНАЧЕ ДополнительныеНачисления.БазовыйПериодНачало
		|		КОНЕЦ КАК НачалоБазовогоПериода,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисления.ВидРасчета.ПериодРегистрацииКакБазовый
		|				ТОГДА КОНЕЦПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ)
		|			ИНАЧЕ ДополнительныеНачисления.БазовыйПериодКонец
		|		КОНЕЦ КАК КонецБазовогоПериода,
		|		ДополнительныеНачисления.БазовыйПериодНачало КАК БазовыйНачало,
		|		ДополнительныеНачисления.БазовыйПериодКонец КАК БазовыйКонец,
		|		ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
		|		ВЫБОР
		|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА ДополнительныеНачисления.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ ДополнительныеНачисления.ВидРасчета.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|				ТОГДА &ОблагаетсяСтрах
		|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
		|		КОНЕЦ КАК КодДоходаЕСН,
		|		ДополнительныеНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
		|		ДополнительныеНачисления.Организация КАК Организация,
		|		ДополнительныеНачисления.Результат КАК Результат,
		|		ДополнительныеНачисления.ПериодРегистрации КАК ПериодРегистрации,
		|		НеПравоНаПенсию.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
		|	ИЗ
		|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|					ДополнительныеНачисления.Сотрудник КАК Сотрудник,
		|					ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		|					ДополнительныеНачисления.Организация КАК Организация,
		|					ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
		|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
		|				ИЗ
		|					РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
		|						ПО ДополнительныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
		|							И ДополнительныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
		|							И ДополнительныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
		|							И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ДополнительныеНачисления.ПериодРегистрации)
		|				ГДЕ
		|					ВЫБОР
		|							КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|								ТОГДА ДополнительныеНачисления.Организация
		|							ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
		|						КОНЕЦ = &Организация
		//|					И НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ) = &Период
		//|					И ДополнительныеНачисления.БазовыйПериодНачало = &Период
		|       			И ДополнительныеНачисления.БазовыйПериодНачало МЕЖДУ &Период И &Период1
		|				
		|				СГРУППИРОВАТЬ ПО
		|					ДополнительныеНачисления.Сотрудник,
		|					ДополнительныеНачисления.Сотрудник.Физлицо,
		|					ДополнительныеНачисления.Организация,
		|					ДополнительныеНачисления.ВидРасчета) КАК СведенияОНачисленияхСрез
		|				ПО (СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник)
		|					И (СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация)
		|					И (СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета)
		|					И (СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период)
		|			ПО (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ДополнительныеНачисления.Сотрудник)
		|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ДополнительныеНачисления.Организация)
		|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ДополнительныеНачисления.ВидРасчета)
		
		//Аверсон ЕАЕ 08.11.2022 СВФР-009799
		//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|				ГражданствоФизЛиц.ФизЛицо КАК ФизЛицо,
		//|				ГражданствоФизЛиц.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
		//|			ИЗ
		//|				РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц) КАК НеПравоНаПенсию
		//|			ПО ДополнительныеНачисления.ФизЛицо = НеПравоНаПенсию.ФизЛицо
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТГражданство КАК НеПравоНаПенсию
		|ПО ДополнительныеНачисления.ФизЛицо = НеПравоНаПенсию.ФизЛицо
		|	И ДополнительныеНачисления.ПериодРегистрации = НеПравоНаПенсию.ПериодРегистрации
		//Аверсон СВФР-009799
		
		|	ГДЕ
		|		ВЫБОР
		|				КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|					ТОГДА ДополнительныеНачисления.Организация
		|				ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
		|			КОНЕЦ = &Организация
		//|		И НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &Период
		//|		И ДополнительныеНачисления.ПериодРегистрации = &Период
		|       И ДополнительныеНачисления.БазовыйПериодНачало МЕЖДУ &Период И &Период1
		|		И ДополнительныеНачисления.ФизЛицо В(&СписокФизЛиц)
		|		И ДополнительныеНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ДополнительныеНачисления.БазовыйПериодНачало,
		|		ДополнительныеНачисления.БазовыйПериодКонец,
		|		ДополнительныеНачисления.Регистратор,
		|		ДополнительныеНачисления.Сотрудник,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисления.ВидРасчета.ПериодРегистрацииКакБазовый
		|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ)
		|			ИНАЧЕ ДополнительныеНачисления.БазовыйПериодНачало
		|		КОНЕЦ,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисления.ВидРасчета.ПериодРегистрацииКакБазовый
		|				ТОГДА КОНЕЦПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ)
		|			ИНАЧЕ ДополнительныеНачисления.БазовыйПериодКонец
		|		КОНЕЦ,
		|		ВЫБОР
		|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА ДополнительныеНачисления.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ ДополнительныеНачисления.ВидРасчета.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|				ТОГДА &ОблагаетсяСтрах
		|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
		|		КОНЕЦ,
		|		ДополнительныеНачисления.ВидРасчета,
		|		ДополнительныеНачисления.Организация,
		|		ДополнительныеНачисления.ПериодРегистрации,
		|		НеПравоНаПенсию.НеИмеетПравоНаПенсию,
		|		ДополнительныеНачисления.НомерСтроки,
		|		ДополнительныеНачисления.Сотрудник.Физлицо,
		|		ДополнительныеНачисления.ВидРасчета.СпособРасчета,
		|		ДополнительныеНачисления.Результат) КАК ДанныеУчета
		|ГДЕ
		|	ЕСТЬNULL(ДанныеУчета.Регистратор.ИсключитьИзПУ6, ЛОЖЬ) <> ИСТИНА
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеУчета.СпособРасчета,
		|	ДанныеУчета.ВидРасчета,
		|	ДанныеУчета.НеИмеетПравоНаПенсию,
		|	ДанныеУчета.ПериодРегистрации,
		|	ДанныеУчета.БазовыйКонец,
		|	ДанныеУчета.БазовыйНачало,
		|	ДанныеУчета.КонецБазовогоПериода,
		|	ДанныеУчета.НачалоБазовогоПериода,
		|	ДанныеУчета.Сотрудник,
		|	ДанныеУчета.КодДоходаЕСН,
		|	ДанныеУчета.ФизЛицо,
		|	ДанныеУчета.Регистратор,
		|	ДанныеУчета.НомерСтроки,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ДанныеУчета.ВидРасчета.ВидПремии
		|
		|УПОРЯДОЧИТЬ ПО
		|	Регистратор,
		|	НомерСтроки";
	иначе
		ТекстЗапроса = 
		
		//Аверсон ЕАЕ 08.11.2022 СВФР-009799
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ДопНачисления.ФизЛицо,
		|	ДопНачисления.Сотрудник,
		|	ДопНачисления.ПериодРегистрации
		|ПОМЕСТИТЬ ВТНужныеДопНачисления
		|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДопНачисления
		|ГДЕ
		|		ВЫБОР
		|				КОГДА ДопНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|					ТОГДА ДопНачисления.Организация
		|				ИНАЧЕ ДопНачисления.ПодразделениеОрганизации.Владелец
		|			КОНЕЦ = &Организация
		//|		И НАЧАЛОПЕРИОДА(ДопНачисления.ПериодРегистрации, МЕСЯЦ) = &Период
		//|		И ДопНачисления.ПериодРегистрации = &Период
		|       И ДопНачисления.БазовыйПериодНачало МЕЖДУ &Период И &Период1
		|		И ДопНачисления.ФизЛицо В(&СписокФизЛиц)
		|		И ДопНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС 
		|;
		|///////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТНужныеДопНачисления.ФизЛицо,
		|	ВТНужныеДопНачисления.Сотрудник,
		|	ВТНужныеДопНачисления.ПериодРегистрации,
		|	МАКСИМУМ(Гражданство.Период) КАК МаксПериод
		|ПОМЕСТИТЬ ВТПериодыГражданства
		|ИЗ ВТНужныеДопНачисления
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК Гражданство
		|ПО ВТНужныеДопНачисления.ФизЛицо = Гражданство.ФизЛицо
		|	И Гражданство.Период < ВТНужныеДопНачисления.ПериодРегистрации
		|СГРУППИРОВАТЬ ПО
		|	ВТНужныеДопНачисления.ФизЛицо,
		|	ВТНужныеДопНачисления.Сотрудник,
		|	ВТНужныеДопНачисления.ПериодРегистрации
		|; 
		|////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТПериодыГражданства.ФизЛицо,
		|	ВТПериодыГражданства.Сотрудник,
		|	ВТПериодыГражданства.ПериодРегистрации,
		|   Гражданство.НеИмеетПравоНаПенсию
		|ПОМЕСТИТЬ ВТГражданство
		|ИЗ ВТПериодыГражданства
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК Гражданство
		|ПО ВТПериодыГражданства.ФизЛицо = Гражданство.ФизЛицо
		|	И ВТПериодыГражданства.МаксПериод = Гражданство.Период
		|;
		|////////////////////////////////////////////////////////////////////////////
		//Аверсон СВФР-009799
		
		|ВЫБРАТЬ
		|	ДанныеУчета.Регистратор КАК Регистратор,
		|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
		|	ДанныеУчета.Сотрудник,
		|	ДанныеУчета.ФизЛицо,
		|	ДанныеУчета.КодДоходаЕСН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходФСЗН,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходСтрах,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ КАК ДоходЕдиныйПлатеж,
		|	ДанныеУчета.ВидРасчета,
		|	ДанныеУчета.СпособРасчета,
		|	СУММА(ДанныеУчета.Результат) КАК Результат,
		|	ДанныеУчета.НачалоБазовогоПериода КАК ПериодВзаиморасчетов,
		|	ДанныеУчета.КонецБазовогоПериода КАК БазовыйПериодКонец,
		|	ДанныеУчета.БазовыйНачало КАК БазовыйНачало,
		|	ДанныеУчета.БазовыйКонец КАК БазовыйКонец,
		|	ДанныеУчета.ПериодРегистрации,
		|	ДанныеУчета.НеИмеетПравоНаПенсию,
		|	&ВидДеятельности,
		|	&Должность,
		|	0 КАК Тип,
		|	ДанныеУчета.ВидРасчета.ВидПремии КАК ВидПремии
		|ИЗ
		|	(ВЫБРАТЬ
		|		ДополнительныеНачисления.Регистратор КАК Регистратор,
		|		ДополнительныеНачисления.НомерСтроки КАК НомерСтроки,
		|		ДополнительныеНачисления.Сотрудник КАК Сотрудник,
		|		ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисления.ВидРасчета.ПериодРегистрацииКакБазовый
		|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ)
		|			ИНАЧЕ ДополнительныеНачисления.БазовыйПериодНачало
		|		КОНЕЦ КАК НачалоБазовогоПериода,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисления.ВидРасчета.ПериодРегистрацииКакБазовый
		|				ТОГДА КОНЕЦПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ)
		|			ИНАЧЕ ДополнительныеНачисления.БазовыйПериодКонец
		|		КОНЕЦ КАК КонецБазовогоПериода,
		|		ДополнительныеНачисления.БазовыйПериодНачало КАК БазовыйНачало,
		|		ДополнительныеНачисления.БазовыйПериодКонец КАК БазовыйКонец,
		|		ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
		|		ВЫБОР
		|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА ДополнительныеНачисления.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
		|				ТОГДА ВЫБОР
		|						КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|							ТОГДА &ОблагаетсяСтрах
		|						ИНАЧЕ ДополнительныеНачисления.ВидРасчета.КодДоходаЕСН
		|					КОНЕЦ
		|			КОГДА НеПравоНаПенсию.НеИмеетПравоНаПенсию = ИСТИНА
		|				ТОГДА &ОблагаетсяСтрах
		|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
		|		КОНЕЦ КАК КодДоходаЕСН,
		|		ДополнительныеНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
		|		ДополнительныеНачисления.Организация КАК Организация,
		|		ДополнительныеНачисления.Результат КАК Результат,
		|		ДополнительныеНачисления.ПериодРегистрации КАК ПериодРегистрации,
		|		НеПравоНаПенсию.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
		|	ИЗ
		|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|					ДополнительныеНачисления.Сотрудник КАК Сотрудник,
		|					ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		|					ДополнительныеНачисления.Организация КАК Организация,
		|					ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
		|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
		|				ИЗ
		|					РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
		|						ПО ДополнительныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
		|							И ДополнительныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
		|							И ДополнительныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
		|							И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ДополнительныеНачисления.ПериодРегистрации)
		|				ГДЕ
		|					ВЫБОР
		|							КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|								ТОГДА ДополнительныеНачисления.Организация
		|							ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
		|						КОНЕЦ = &Организация
		//|					И НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &Период
		//|					И ДополнительныеНачисления.ПериодРегистрации = &Период
		|       			И ДополнительныеНачисления.БазовыйПериодНачало МЕЖДУ &Период И &Период1
		|				
		|				СГРУППИРОВАТЬ ПО
		|					ДополнительныеНачисления.Сотрудник,
		|					ДополнительныеНачисления.Сотрудник.Физлицо,
		|					ДополнительныеНачисления.Организация,
		|					ДополнительныеНачисления.ВидРасчета) КАК СведенияОНачисленияхСрез
		|				ПО (СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник)
		|					И (СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация)
		|					И (СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета)
		|					И (СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период)
		|			ПО (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ДополнительныеНачисления.Сотрудник)
		|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ДополнительныеНачисления.Организация)
		|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ДополнительныеНачисления.ВидРасчета)
		
		//Аверсон ЕАЕ 08.11.2022 СВФР-009799
		//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|				ГражданствоФизЛиц.ФизЛицо КАК ФизЛицо,
		//|				ГражданствоФизЛиц.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
		//|			ИЗ
		//|				РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц) КАК НеПравоНаПенсию
		//|			ПО ДополнительныеНачисления.ФизЛицо = НеПравоНаПенсию.ФизЛицо
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТГражданство КАК НеПравоНаПенсию
		|ПО ДополнительныеНачисления.ФизЛицо = НеПравоНаПенсию.ФизЛицо
		|	И ДополнительныеНачисления.ПериодРегистрации = НеПравоНаПенсию.ПериодРегистрации
		//Аверсон СВФР-009799
		
		|	ГДЕ
		|		ВЫБОР
		|				КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
		|					ТОГДА ДополнительныеНачисления.Организация
		|				ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
		|			КОНЕЦ = &Организация
		//|		И НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &Период
		//|		И ДополнительныеНачисления.ПериодРегистрации = &Период
		|       И ДополнительныеНачисления.БазовыйПериодНачало МЕЖДУ &Период И &Период1
		|		И ДополнительныеНачисления.ФизЛицо В(&СписокФизЛиц)
		|		И ДополнительныеНачисления.ВидРасчета.ОтчисленияНаППС = &ОтчисленияНаППС) КАК ДанныеУчета
		|ГДЕ
		|	ЕСТЬNULL(ДанныеУчета.Регистратор.ИсключитьИзПУ6, ЛОЖЬ) <> ИСТИНА
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеУчета.Регистратор,
		|	ДанныеУчета.Сотрудник,
		|	ДанныеУчета.ФизЛицо,
		|	ДанныеУчета.КодДоходаЕСН,
		|	ДанныеУчета.ВидРасчета,
		|	ДанныеУчета.СпособРасчета,
		|	ДанныеУчета.НачалоБазовогоПериода,
		|	ДанныеУчета.КонецБазовогоПериода,
		|	ДанныеУчета.БазовыйНачало,
		|	ДанныеУчета.БазовыйКонец,
		|	ДанныеУчета.ПериодРегистрации,
		|	ДанныеУчета.НеИмеетПравоНаПенсию,
		|	ДанныеУчета.НомерСтроки,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
		|			ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
		|		ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
		|	КОНЕЦ,
		|	ДанныеУчета.ВидРасчета.ВидПремии
		|
		|УПОРЯДОЧИТЬ ПО
		|	Регистратор,
		|	НомерСтроки";
	КонецЕсли;
	Запрос.Текст = ТекстЗапроса;
	
	Результат = Запрос.Выполнить().Выбрать();
	//Островская Татьяна 11.06.2013 № 16547
	
	Пока Результат.Следующий() Цикл
		
		
		//Аверсон 13.11.2020 КВВ СВФР-006819 (
		Добавлять = Истина;
		Если СписокВР1.Количество() <> 0 И СписокВР2.Количество() <> 0 Тогда
			НайденныйЭлт = СписокВР2.НайтиПоЗначению(Результат.ВидРасчета);
			Если НайденныйЭлт <> Неопределено Тогда
				Если ТипЗнч(Результат.Регистратор) = Тип("ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций") Тогда
					_ПериодНачалаДок = Результат.Регистратор.ДатаНачалаОсновногоОтпуска;
				Иначе
					_ПериодНачалаДок = Результат.ПериодВзаиморасчетов;
				КонецЕсли;
				_НачМесПериодНачалаДок = НачалоМесяца(_ПериодНачалаДок);
				
				З = Новый Запрос;
				З.Текст = "ВЫБРАТЬ 
				|ОснНач.ПериодДействияКонец
				|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНач
				|ГДЕ ОснНач.Сотрудник = &Сотрудник
				|И ОснНач.ВидРасчета В (&СписокВР)
				|И ОснНач.ПериодДействияНачало МЕЖДУ &Начало И &Окончание";
				З.УстановитьПараметр("Сотрудник",Результат.Сотрудник);
				З.УстановитьПараметр("СписокВР",СписокВР1);
				З.УстановитьПараметр("Начало",_НачМесПериодНачалаДок);
				З.УстановитьПараметр("Окончание",КонецМесяца(_НачМесПериодНачалаДок));
				РезЗ = З.Выполнить().Выгрузить();
				Если РезЗ.Количество() <> 0 Тогда
					Для Каждого Стр3 ИЗ РезЗ Цикл
						ДатаПроверки = Стр3.ПериодДействияКонец;
						Если ДатаПроверки < _ПериодНачалаДок Тогда
							Добавлять = Ложь;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;	
		
		//Аверсон 15.06.2021 КВВ СВФР-007702 (
		//Аверсон ЕАЕ 02.10.2025 СВФР-016381
		//Если ПоРаботникамОрганизаций Тогда
		//	ВД = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Результат.ПериодВзаиморасчетов,Новый Структура("Сотрудник",Результат.Сотрудник)).ВидДеятельностиИзмерение;
		//	Если НЕ ЗначениеЗаполнено(ВД) Тогда
		//		Добавлять = Ложь;
		//	КонецЕсли;
		//КонецЕсли;
		//Аверсон СВФР-016381
		//Аверсон 15.06.2021 КВВ СВФР-007702 )
		
		Если Добавлять Тогда
			//Аверсон 13.11.2020 КВВ СВФР-006819 )
			мНоваяСтрока = ИсходнаяТаблица.Добавить();
			ЗаполнитьЗначенияСвойств(мНоваяСтрока, Результат);
			мНоваяСтрока.Тип = 1;
			
			//Аверсон 14.02.2023 КВВ СВФР-010249 (
			Если НЕ ЗначениеЗаполнено(мНоваяСтрока.ПериодКонец) Тогда
				мНоваяСтрока.ПериодКонец = ?(ЗначениеЗаполнено(Результат.БазовыйПериодКонец),КонецДня(Результат.БазовыйПериодКонец),КонецДня(Результат.БазовыйКонец));
			КонецЕсли;
			//Аверсон 14.02.2023 КВВ СВФР-010249 )
			
			мПериодНачало = НачалоМесяца(ПериодРегистрации);
			мПериодКонец = КонецМесяца(ПериодРегистрации);
			//Аверсон 06.09.2021 КВВ СВФР-008065 ( (закомментировано)
			//Если не (Результат.ВидПремии = Перечисления.ВидыПремии.НеПремия ИЛИ (не ЗначениеЗаполнено(Результат.ВидПремии))) Тогда
			//	мВремя = ПрочиеПроцедуры.ОтработанноеВремяПоСводнымГраффикам(мПериодНачало, мПериодКонец, Результат.Сотрудник, Справочники.КлассификаторИспользованияРабочегоВремени.Работа, Ложь,,Организация).Часов;
			//	СтрокиОтработанногоВремени = тзИсчисленныйЕСН.НайтиСтроки(Новый Структура("ФизЛицо", Результат.ФизЛицо));
			//	Если СтрокиОтработанногоВремени.Количество() <> 0 И ЗначениеЗаполнено(мВремя) Тогда
			//		Если ЗначениеЗаполнено(СтрокиОтработанногоВремени[0].ОтработаноЧасов) Тогда
			//			мНоваяСтрока.Результат = мНоваяСтрока.Результат/мВремя*?(СтрокиОтработанногоВремени[0].ОтработаноЧасов > мВремя, мВремя, СтрокиОтработанногоВремени[0].ОтработаноЧасов);
			//		КонецЕсли;
			//	КонецЕсли;
			//КонецЕсли;
			//Аверсон 06.09.2021 КВВ СВФР-008065 ) (закомментировано)
		КонецЕсли;
	КонецЦикла;
	
	Для Каждого мСтрокаНачислений Из ИсходнаяТаблица Цикл
		мДатаНачала = ОтработанноеВремя.НайтиСтроки(Новый Структура("ФизЛицо", мСтрокаНачислений.ФизЛицо));
		
		Если мДатаНачала.Количество() <> 0 И мСтрокаНачислений.Тип = 1 Тогда
			мСтрокаРегистра = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(мДатаНачала[0].Дата,
			Новый Структура("Сотрудник, Организация", мСтрокаНачислений.Сотрудник, Организация));
			
			мСтрокаРегистра1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(мДатаНачала[0].Дата,
			Новый Структура("Сотрудник, Организация", мСтрокаНачислений.Сотрудник, Организация));
			
			Если ПериодРегистрации = Дата(2016,12,1) и не ЗначениеЗаполнено(мСтрокаРегистра1.ВидДеятельностиИзмерение) Тогда  //О.Т. Аверсон 24.03.2017 № 449
				мСтрокаРегистра1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ДобавитьМесяц(мДатаНачала[0].Дата,1),
				Новый Структура("Сотрудник, Организация", мСтрокаНачислений.Сотрудник, Организация));
			КонецЕсли;
			
		Иначе
			мСтрокаРегистра = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(мСтрокаНачислений.ПериодВзаиморасчетов,
			Новый Структура("Сотрудник, Организация", мСтрокаНачислений.Сотрудник, Организация));
			
			мСтрокаРегистра1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(мСтрокаНачислений.ПериодВзаиморасчетов,
			Новый Структура("Сотрудник, Организация", мСтрокаНачислений.Сотрудник, Организация));
			Если ПериодРегистрации = Дата(2016,12,1) и не ЗначениеЗаполнено(мСтрокаРегистра1.ВидДеятельностиИзмерение) Тогда //О.Т. Аверсон 24.03.2017 № 449
				мСтрокаРегистра1 = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ДобавитьМесяц(мСтрокаНачислений.ПериодВзаиморасчетов,1),
				Новый Структура("Сотрудник, Организация", мСтрокаНачислений.Сотрудник, Организация));
			КонецЕсли;
		КонецЕсли;
		
		Если ПоРаботникамОрганизаций Тогда //Аверсон ЕАЕ 15.03.2021 СВФР-007324 условие
			
			//проверка корректности по датам
			мСтрокаРегистраПроверка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(мСтрокаНачислений.ПериодКонец,
			Новый Структура("Сотрудник, Организация", мСтрокаНачислений.Сотрудник, Организация));
			Если ПериодРегистрации = Дата(2016,12,1) и ЗначениеЗаполнено(мСтрокаРегистра.ВидДеятельностиИзмерение) Тогда  //О.Т. Аверсон 24.03.2017 № 449
				Если мСтрокаРегистра1.ВидДеятельностиИзмерение <> мСтрокаРегистраПроверка.ВидДеятельностиИзмерение Тогда
					ОбщегоНазначения.СообщитьОбОшибке("Ошибка периода по сотруднику "+Строка(мСтрокаНачислений.Сотрудник));
				КонецЕсли;
			ИначеЕсли ПериодРегистрации <> Дата(2016,12,1) Тогда 
				Если мСтрокаРегистра1.ВидДеятельностиИзмерение <> мСтрокаРегистраПроверка.ВидДеятельностиИзмерение Тогда
					ОбщегоНазначения.СообщитьОбОшибке("Ошибка периода по сотруднику "+Строка(мСтрокаНачислений.Сотрудник));
				КонецЕсли;
			КонецЕсли;
			//
			
			//Аверсон ЕАЕ 02.10.2025 СВФР-016381
			//Если Не мСтрокаРегистра1.ВидДеятельностиИзмерение.ИспользуетсяВПУ6 Тогда
			//	мСтрокаНачислений.ДоходФСЗН = Перечисления.ДоходыФСС_НС.НеОблагается;
			//КонецЕсли;
			//Аверсон СВФР-016381
			
			//Аверсон ЕАЕ 15.03.2021 СВФР-007324
		Иначе
			//проверка корректности по датам
			ВидДеятельностиПроверка = ПолучитьВидДеятельности(мСтрокаНачислений.Сотрудник,мСтрокаНачислений.ПериодКонец);
			
			ВидДеятельности = ПолучитьВидДеятельности(мСтрокаНачислений.Сотрудник, мСтрокаНачислений.ПериодВзаиморасчетов);
			
			Если ВидДеятельности <> ВидДеятельностиПроверка Тогда
				ОбщегоНазначения.СообщитьОбОшибке("Ошибка периода по сотруднику "+Строка(мСтрокаНачислений.Сотрудник));
			КонецЕсли;
		КонецЕсли;
		//Аверсон СВФР-007324
		
		мСтрокаНачислений.ПериодВзаиморасчетов = НачалоМесяца(мСтрокаНачислений.ПериодВзаиморасчетов);
		
		//Аверсон ЕАЕ 15.03.2021 СВФР-007324
		Если ПоРаботникамОрганизаций Тогда
			мСтрокаНачислений.ВидДеятельности = мСтрокаРегистра1.ВидДеятельностиИзмерение;
		Иначе
			мСтрокаНачислений.ВидДеятельности = ВидДеятельности;
		КонецЕсли;
		//Аверсон СВФР-007324
		
		мСтрокаНачислений.Должность = мСтрокаРегистра.Должность;
	КонецЦикла;
	
	
	мПустоеЗначение = ИсходнаяТаблица.НайтиСтроки(Новый Структура("ДоходФСЗН", Перечисления.ДоходыФСС_НС.НеОблагается));
	Для Каждого мСтрока Из мПустоеЗначение Цикл
		ИсходнаяТаблица.Удалить(мСтрока);
	КонецЦикла;
	
	ИсходнаяТаблица.Свернуть("ФизЛицо, ПериодВзаиморасчетов,ВидДеятельности,Должность", "Результат");
	
	Если ИсходнаяТаблица.Количество() = 0 Тогда
		#Если Клиент Тогда
			Если ПоРаботникамОрганизаций Тогда
				Предупреждение("Не рассчитаны отчисления с ФОТ и ЗП !!!");
				
				//Аверсон ЕАЕ 15.03.2021 СВФР-007324
			Иначе
				Предупреждение("Не рассчитаны отчисления с ФОТ и ЗП или нет данных в регистре сведений Дополнительные данные для ППС!!!");
			КонецЕсли;
			//Аверсон
		#КонецЕсли
	КонецЕсли;
	
	Возврат ИсходнаяТаблица;
	
КонецФункции

Функция ПолучитьВидДеятельности(Сотр, Дат)
	ВидД = Справочники.ОсобыеУсловияТруда.ПустаяСсылка();
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
	|	ДополнительныеДанныеДляППССрезПоследних.ВидДеятельности
	|ИЗ
	|	РегистрСведений.ДополнительныеДанныеДляППС.СрезПоследних(&Дат, Сотрудник = &Сотр) КАК ДополнительныеДанныеДляППССрезПоследних";
	
	Запрос.УстановитьПараметр("Дат", Дат);
	Запрос.УстановитьПараметр("Сотр", Сотр);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ВидД = ВыборкаДетальныеЗаписи.ВидДеятельности;
	КонецЦикла;
	
	Возврат ВидД;
КонецФункции
//Аверсон СВФР-016381