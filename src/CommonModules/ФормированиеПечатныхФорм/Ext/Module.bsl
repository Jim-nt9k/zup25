// Возвращает структуру данных со сводным описанием контрагента
//
// Параметры: 
//  СписокСведений - список значений со значенийми параметров организации
//   СписокСведений формируется функцией СведенияОЮрФизЛице
//  Список         - список запрашиваемых параметров организаиии
//  СПрефиксом     - Признак выводить или нет префикс параметра организации
//
// Возвращаемое значение:
//  Строка - описатель организации / контрагента / физ.лица.
//
Функция ОписаниеОрганизации(СписокСведений, Список = "", СПрефиксом = Истина) Экспорт

	Если ПустаяСтрока(Список) Тогда
		Список = "ПолноеНаименование,ИНН,ЮридическийАдрес,Телефоны,НомерСчета,Банк,БИК,КоррСчет";
	КонецЕсли; 

	Результат = "";

	СоответствиеПараметров = Новый Соответствие();
	СоответствиеПараметров.Вставить("ПолноеНаименование", " ");
	СоответствиеПараметров.Вставить("ИНН",        " ИНН ");
	СоответствиеПараметров.Вставить("КПП",        " КПП ");
	СоответствиеПараметров.Вставить("ЮридическийАдрес",   " ");
	СоответствиеПараметров.Вставить("Телефоны",   " тел.: ");
	СоответствиеПараметров.Вставить("НомерСчета", " р/с ");
	СоответствиеПараметров.Вставить("Банк",       " в банке ");
	СоответствиеПараметров.Вставить("БИК",        " БИК ");
	СоответствиеПараметров.Вставить("КоррСчет",   " к/с ");
	СоответствиеПараметров.Вставить("КодПоОКПО",  " Код по ОКПО ");

	ЧислоПараметров = СтрЧислоВхождений(Список, ",");
	Для Счетчик = 1 по ЧислоПараметров Цикл

		ПозЗапятой = Найти(Список, ",");

		Если ПозЗапятой > 0  Тогда
			ИмяПараметра = Лев(Список, ПозЗапятой - 1);
			Список = Сред(Список, ПозЗапятой + 1, СтрДлина(Список));

			Попытка
				СтрокаДополнения = "";
				СписокСведений.Свойство(ИмяПараметра, СтрокаДополнения);

				Если ПустаяСтрока(СтрокаДополнения) Тогда
					Продолжить;
				КонецЕсли;

				Префикс = СоответствиеПараметров[ИмяПараметра];
				Если Не ПустаяСтрока(Результат)  Тогда
					Результат = Результат + ",";
				КонецЕсли; 

				Результат = Результат + ?(СПрефиксом = Истина, Префикс, "") + СтрокаДополнения;
			Исключение
				Сообщить("Не удалось определить значение параметра организации: " + ИмяПараметра, СтатусСообщения.Внимание);
			КонецПопытки;

		КонецЕсли; 

	КонецЦикла;

	Возврат Результат;

КонецФункции // ОписаниеОрганизации()

// Стандартная для данной конфигурации функция форматирования сумм
//
// Параметры: 
//  Сумма  - число, которое мы хотим форматировать, 
//  Валюта - ссылка на элемент справочника валют, если задан, то к в результирующую строку
//           будет добавлено представление валюты
//  ЧН     - строка, представляющая нулевое значение числа,
//  ЧРГ    - символ-разделитель групп целой части числа.
//
// Возвращаемое значение:
//  Отформатированная должным образом строковое представление суммы.
//
Функция ФорматСумм(Сумма, Валюта = Неопределено, ЧН = "", ЧРГ = "",Дата = Неопределено) Экспорт

	//О.Т. Аверсон 22.06.2016 № 949
	Если Дата = Неопределено Тогда 
		ФорматнаяСтрока = "ЧЦ=15;ЧДЦ=2";
	иначе
		ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(Дата,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер;
		ФорматнаяСтрока = "ЧЦ=15;ЧДЦ="+Строка(ЗначениеОкругления);
	КонецЕсли;
	//О.Т. Аверсон 22.06.2016 № 949
	
	ФорматнаяСтрока = ФорматнаяСтрока +
					?(ЗначениеЗаполнено(ЧН), ";" + "ЧН=" + ЧН, "") +
					?(ЗначениеЗаполнено(ЧРГ), ";" + "ЧРГ=" + ЧРГ, "");
	РезультирующаяСтрока = СокрЛ(Формат(Сумма, ФорматнаяСтрока));
	
	Если ЗначениеЗаполнено(Валюта) Тогда
		РезультирующаяСтрока = РезультирующаяСтрока + " " + СокрП(Валюта);
	КонецЕсли;

	Возврат РезультирующаяСтрока;

КонецФункции // ФорматСумм()

// Возвращает значение истина если за, переданный период заполнен регламетированный производственный календарь
//
// Параметры:
//
//  НачалоПериода - дата начала периода
//  КонецПериода - дата конца периода
//
Функция ЗаполненРегламентированныйПроизводственныйКалендарь(НачалоПериода, КонецПериода) Экспорт
	
	ТЗ = "ВЫБРАТЬ
	     |	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
	     |ИЗ
	     |	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
	     |ГДЕ
	     |	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &НачалоПериода И &КонецПериода";
		 
	Запрос = Новый Запрос(ТЗ);
	Запрос.УстановитьПараметр("НачалоПериода", НачалоПериода);
	Запрос.УстановитьПараметр("КонецПериода",  КонецПериода);
	
	Возврат НЕ Запрос.Выполнить().Пустой();
	
КонецФункции  //ЗаполненРегламентированныйПроизводственныйКалендарь()

// Устанавливает отбор при выбор подразддления организации или сотрудника органиазации в отборе СКД
// 
// Параметры:
//  Элемент              - элемент выбора
//  КомпоновщикНастроек  - компоновщик настроек
//  ПоляОрганизаций      - поля СКД, в которых назначается отбор по организации
//  Объект               - отчет
//  СтандартнаяОбработка - признак стандартной обработки
//
Процедура ПодставитьОтборОрганизации(Элемент, КомпоновщикНастроек, ПоляОрганизаций = Неопределено, Объект, СтандартнаяОбработка) Экспорт
	
	СписокПолеОргаинзация = Новый СписокЗначений;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("ПолеКомпоновкиДанных") тогда
		СписокПолеОргаинзация.Добавить(ПоляОрганизаций);
	КонецЕсли;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("СписокЗначений") тогда
		СписокПолеОргаинзация = ПоляОрганизаций;
	КонецЕсли;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("Массив") тогда
		СписокПолеОргаинзация.ЗагрузитьЗначения(ПоляОрганизаций);
	КонецЕсли;
	
	Организация = Неопределено;
	
	Для каждого ЭлементОтбора из КомпоновщикНастроек.Настройки.Отбор.Элементы Цикл
		
		Если СписокПолеОргаинзация.НайтиПоЗначению(ЭлементОтбора.ЛевоеЗначение) <> Неопределено И ТипЗнч(ЭлементОтбора.ПравоеЗначение) = Тип("СправочникСсылка.Организации") тогда
			
			Организация = ЭлементОтбора.ПравоеЗначение;
			Прервать;
			
		КонецЕсли;
		
	КонецЦикла;	
	
	Если Организация <> Неопределено тогда
		
		Если ТипЗнч(Элемент.Значение) = Тип("СправочникСсылка.ПодразделенияОрганизаций") тогда
			
			Элемент.ВыборПоВладельцу = Организация;
			
		ИначеЕсли ТипЗнч(Элемент.Значение) = Тип("СправочникСсылка.СотрудникиОрганизаций") тогда
			
			ПроцедурыУправленияПерсоналом.ОткрытьФормуВыбораСотрудникаОрганизации(Элемент, Объект, Истина, ОбщегоНазначения.ПолучитьРабочуюДату(), ОбщегоНазначения.ГоловнаяОрганизация(Организация), 1, СтандартнаяОбработка, Элемент.Значение);
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры //ПодставитьОтборОрганизации()

// Копирует упорядочивания из элемента структуры настройки СКД в отчет
//
// Параметры:
//  Настройка - настройки схемы компоновки данных
//
Процедура ПеренестиПорядокВОтчет(Настройки) Экспорт
	
	Если Настройки.Структура.Количество() <> 0 тогда
		
		Если ТипЗнч(Настройки.Структура[0]) = Тип("ТаблицаКомпоновкиДанных") тогда
			
			Если Настройки.Структура[0].Строки.Количество() <> 0 тогда
				
				ПеренестиПорядок(Настройки, Настройки.Структура[0].Строки[0]);
				
			КонецЕсли;
			
			Если Настройки.Структура[0].Колонки.Количество() <> 0 тогда
				
				ПеренестиПорядок(Настройки, Настройки.Структура[0].Колонки[0]);
				
			КонецЕсли;
			
		ИначеЕсли ТипЗнч(Настройки.Структура[0]) = Тип("ГруппировкаТаблицыКомпоновкиДанных") тогда
			
			ПеренестиПорядок(Настройки, Настройки.Структура[0].Строки[0]);
			
		ИначеЕсли ТипЗнч(Настройки.Структура[0]) = Тип("ДиаграммаКомпоновкиДанных") тогда
			
			Если Настройки.Структура[0].Серии.Количество() <> 0 тогда
				
				ПеренестиПорядок(Настройки, Настройки.Структура[0].Серии[0]);
				
			КонецЕсли;
			
			Если Настройки.Структура[0].Точки.Количество() <> 0 тогда
				
				ПеренестиПорядок(Настройки, Настройки.Структура[0].Точки[0]);
				
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры //ПеренестиВсеУпорядочиванияВОтчет()

// Копирует упорядочивания из группировки объекта в отчет
//
// Параметры:
//  Настройка - настройки схемы компоновки данных
//  Структура - структура настройки компоновки данных
//
Процедура ПеренестиПорядок(Настройки, Структура) Экспорт
	
	ТиповыеОтчеты.СкопироватьЭлементы(Настройки.Порядок, Структура.Порядок);
	
	Структура.Порядок.Элементы.Очистить();
	
	Структура.Порядок.Элементы.Добавить(Тип("АвтоЭлементПорядкаКомпоновкиДанных"));
	
	Если Структура.Структура.Количество() <> 0 тогда
		
		ПеренестиПорядок(Настройки, Структура.Структура[0]);
		
	КонецЕсли;
	
КонецПроцедуры //ПеренестиУпорядочивание()

////////////////////////////////////////////////////////////////////////////////
//  Общие процедуры печати 

Функция ЧасовПоГруппеРасчетовУвеличениеНормыГрафикаВОплатеПоСреднему(Сотрудник,ДатаЗапроса, ВР = Неопределено) 
	//Аверсон 13.06.2022 КВВ СВФР-009195 (
	Часов = 0;
	ЧасовНВ =0;
	СписокВР = Новый СписокЗначений;
	ГруппаРасчетов = Справочники.ГруппыРасчетов.УвеличениеНормыГрафикаВОплатеПоСреднему;
	Для Каждого Стр из ГруппаРасчетов.Основные Цикл 
		Если ВР = Неопределено 
			ИЛИ (ВР <> Неопределено И ВР = Стр.ВидРасчета) Тогда
		СписокВР.Добавить(Стр.ВидРасчета);
		КонецЕсли;
	КонецЦикла;
	
	//Аверсон 12.07.2022 КВВ СВФР-009332 (
	СписокВВ = Новый СписокЗначений;
	Для Каждого Стр из ГруппаРасчетов.КлассификаторИспользованияРВ Цикл 
		Если ВР = Неопределено Тогда
		СписокВВ.Добавить(Стр.ВидКлассификатора);
		КонецЕсли;
	КонецЦикла;
	//Аверсон 12.07.2022 КВВ СВФР-009332 )
	
	Если СписокВР.Количество() > 0 ИЛИ СписокВВ.Количество() > 0 Тогда	//Аверсон 12.07.2022 КВВ СВФР-009332		
		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ
		|СУММА(ОсновныеНачисленияРаботниковОрганизаций.ОплаченоДнейЧасов) КАК Часов
		|ПОМЕСТИТЬ ВтЧасов //Аверсон 12.07.2022 КВВ СВФР-009332
		|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		|ГДЕ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В (&СписокВР)
		|И НАЧАЛОПЕРИОДА(&ДатаЗапроса,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия,МЕСЯЦ) 
		|И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|
		//Аверсон 12.07.2022 КВВ СВФР-009332 (
		|ОБЪЕДИНИТЬ
		|ВЫБРАТЬ
		|СУММА(РабочееВремяРаботниковОрганизаций.Часов) 
		|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|ГДЕ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&СписокВВ)
		|И НАЧАЛОПЕРИОДА(&ДатаЗапроса,МЕСЯЦ) = НАЧАЛОПЕРИОДА(РабочееВремяРаботниковОрганизаций.Период,МЕСЯЦ) 
		|И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
		|;
		|ВЫБРАТЬ 
		|СУММА(ВтЧасов.Часов) КАК Часов
		|ИЗ ВтЧасов КАК ВтЧасов";
		//Аверсон 12.07.2022 КВВ СВФР-009332 )
		
		Запрос.УстановитьПараметр("Сотрудник",Сотрудник);
		Запрос.УстановитьПараметр("ДатаЗапроса",ДатаЗапроса);
		Запрос.УстановитьПараметр("СписокВР",СписокВР);
		Запрос.УстановитьПараметр("СписокВВ",СписокВВ); //Аверсон 12.07.2022 КВВ СВФР-009332

		РезЗапрос = Запрос.Выполнить().Выгрузить();
		Если РезЗапрос.Количество() > 0 Тогда
			//Часов = РезЗапрос[0].Часов;
			Часов = РезЗапрос.Итог("Часов"); //Аверсон 12.07.2022 КВВ СВФР-009332
		КонецЕсли;
		ЗапросНВ = Новый Запрос;
		ЗапросНВ.Текст =
		"ВЫБРАТЬ
		|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|ГДЕ
		|	РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
		|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
		|	И РабочееВремяРаботниковОрганизаций.Период >= &Период
		|	И РабочееВремяРаботниковОрганизаций.Период <= &Период2";   
		ЗапросНВ.УстановитьПараметр("Сотрудник",Сотрудник);
		ЗапросНВ.УстановитьПараметр("Период", НачалоМесяца(ДатаЗапроса));
		ЗапросНВ.УстановитьПараметр("Период2", КонецМесяца(ДатаЗапроса));
		ЗапросНВ.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.НайтиПоНаименованию("Дополнительные выходные дни (без сохранения зарабо",истина));
		РезультатНВ = ЗапросНВ.Выполнить().Выбрать();
		ДопВремя = 0; 
		Пока РезультатНВ.Следующий() Цикл
			ЧасовНВ =?(РезультатНВ.Часов=null,0,РезультатНВ.Часов);
		КонецЦикла; 		
	КонецЕсли;
	Возврат ?(ЗначениеЗаполнено(Часов),Часов-ЧасовНВ,0-ЧасовНВ);
	//Аверсон 13.06.2022 КВВ СВФР-009195 )
КонецФункции


//Островская Татьяна 16.11.2012 № 15
Функция ПечатьРасчетаСреднегоЗаработка(ДокументСсылка, ДатаСобытия, ПродолжительностьРасчетногоПериода, ОписаниеОплачиваемогоПериода, СпособРасчета, Знач ИспользоватьСреднеЧасовойЗаработок = Неопределено, СписокСоставляющихСреднегоЗаработка = Неопределено, ВыводитьЗаголовок = Истина, ОтражатьДолюВремени = Истина, СтруктураПоказателей = Неопределено,ТЧНачисления = Неопределено,СреднийЧасовойЗаработокДляКомпОтпуска=Неопределено) Экспорт
//Островская Татьяна 16.11.2012 № 15	
	СрКолвоКДн = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ДатаСобытия),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячноеКалендДней)).Размер; //Аверсон 10113 04.01.2023
	Попытка
		МетаданныеДокумента = ДокументСсылка.Метаданные();
		ИмяИсточникаДанных = МетаданныеДокумента.Имя;
	Исключение
		Возврат Новый ТабличныйДокумент
	КонецПопытки;
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_РасчетСреднегоЗаработка";
	//О.Т. 25.09.2014 № 17568
	если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда 
		Макет = ПолучитьОбщийМакет("РасчетСреднегоЗаработкаПриУв");
	иначе
		Макет = ПолучитьОбщийМакет("РасчетСреднегоЗаработка");
	КонецЕсли;
	//О.Т. 25.09.2014 № 17568
	СекцияШапка = Макет.ПолучитьОбласть("Шапка");
	СекцияЗаголовокНачислений = Макет.ПолучитьОбласть("ЗаголовокНачислений");
	СекцияЗаголовокРабочегоМеста = Макет.ПолучитьОбласть("ЗаголовокРабочегоМеста");
	СекцияМесячныйЗаработок = Макет.ПолучитьОбласть("МесячныйЗаработок");
	
	//Аверсон 27.01.2022 КВВ СВФР-008638 (
	Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
		СекцияМесячныйЗаработокПоВР = Макет.ПолучитьОбласть("МесячныйЗаработокПоВР");
	КонецЕсли;
	//Аверсон 27.01.2022 КВВ СВФР-008638 )
	
	СекцияСерединаОтчета = Макет.ПолучитьОбласть("СерединаОтчета");
	СекцияДоляВремени = Макет.ПолучитьОбласть("ДоляВремени");
	СекцияЗаголовокПремий = Макет.ПолучитьОбласть("ЗаголовокПремий");
	СекцияПремии = Макет.ПолучитьОбласть("Премии");
	//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
	СекцияЗаголовокГодовыхПремий = Макет.ПолучитьОбласть( "ЗаголовокГодовыхПремий" );
	СекцияГодовойПремии = Макет.ПолучитьОбласть( "ГодовыеПремии" );
	//- СВЭЙ 05.03.19 КДЯ СВФР-003194
	//+ СВЭЙ КДЯ 07.02.20 СВФР-005462 перенесено ниже
	//СекцияПодвал = Макет.ПолучитьОбласть("Подвал");
	//- СВЭЙ КДЯ 07.02.20 СВФР-005462
	если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда 
		СекцияДетали = Макет.ПолучитьОбласть("Детали");//О.Т. 26.09.2014 № 17568
	КонецЕсли;
	
	Запрос = Новый Запрос;
	
	Организация = ДокументСсылка.Организация;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка",			ДокументСсылка);
	Запрос.УстановитьПараметр("ГоловнаяОрганизация",	ОбщегоНазначения.ГоловнаяОрганизация(Организация));
	Запрос.УстановитьПараметр("ДатаНачалаСобытия",		ДатаСобытия);
	Запрос.УстановитьПараметр("Сотрудник",				ДокументСсылка.Сотрудник);
	Запрос.УстановитьПараметр("Физлицо",				ДокументСсылка.Сотрудник.Физлицо);
	
	//Аверсон 15.12.2022 КВВ СВФР-010017 (
	//Запрос.УстановитьПараметр("ИспользоватьСреднеЧасовойЗаработок" , ИспользоватьСреднеЧасовойЗаработок);
	Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда //Аверсон 07.01.2023 КВВ СВФР-010017
		Запрос.УстановитьПараметр("ИспользоватьСреднеЧасовойЗаработок" , СреднийЧасовойЗаработокДляКомпОтпуска);
		
		//Аверсон 07.01.2023 КВВ СВФР-010017 (
	Иначе
		Запрос.УстановитьПараметр("ИспользоватьСреднеЧасовойЗаработок" , ИспользоватьСреднеЧасовойЗаработок);
	КонецЕсли;
	//Аверсон 07.01.2023 КВВ СВФР-010017 )
	
	//Аверсон 15.12.2022 КВВ СВФР-010017 )

	Если ИспользоватьСреднеЧасовойЗаработок = Неопределено Тогда
		Если МетаданныеДокумента.Реквизиты.Найти("СпособРегистрацииВремени") <> Неопределено Тогда
			ТекстПоляИспользоватьСреднеЧасовойЗаработок = "
			|	ВЫБОР
			|		КОГДА Документ.СпособРегистрацииВремени = ЗНАЧЕНИЕ(Перечисление.СпособыРегистрацииВремени.РегистрацияДляЧастиСмены) 
			|			ИЛИ ВЫБОР
			|					КОГДА РаботникиОрганизацииСрезПоследних.ПериодЗавершения <= &ДатаНачалаСобытия
			|							И РаботникиОрганизацииСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|						ТОГДА ЕСТЬNULL(РаботникиОрганизацииСрезПоследних.ГрафикРаботыЗавершения.СуммированныйУчетРабочегоВремени, ЛОЖЬ)
			|					ИНАЧЕ ЕСТЬNULL(РаботникиОрганизацииСрезПоследних.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ) 
			|				КОНЕЦ			
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ КАК ИспользоватьСреднеЧасовойЗаработок"
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням 
			Или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке Тогда
			// Решение Верховного Суда РФ от 13.07.2006 № ГКПИ06-637
			ТекстПоляИспользоватьСреднеЧасовойЗаработок = "
			|	Ложь КАК ИспользоватьСреднеЧасовойЗаработок"  
		Иначе
			ТекстПоляИспользоватьСреднеЧасовойЗаработок = "
			|ВЫБОР
			|	КОГДА РаботникиОрганизацииСрезПоследних.ПериодЗавершения <= &ДатаНачалаСобытия
			|			И РаботникиОрганизацииСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|		ТОГДА ЕСТЬNULL(РаботникиОрганизацииСрезПоследних.ГрафикРаботыЗавершения.СуммированныйУчетРабочегоВремени, ЛОЖЬ)
			|	ИНАЧЕ ЕСТЬNULL(РаботникиОрганизацииСрезПоследних.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ) 
			|КОНЕЦ КАК ИспользоватьСреднеЧасовойЗаработок"
		КонецЕсли;
	Иначе
		ТекстПоляИспользоватьСреднеЧасовойЗаработок ="
		|	&ИспользоватьСреднеЧасовойЗаработок КАК ИспользоватьСреднеЧасовойЗаработок"
	КонецЕсли;
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Документ.Представление,
	|	Документ.Ссылка,
	|	Документ.Сотрудник,
	|	Документ.Сотрудник.Физлицо КАК Физлицо,
	|	Документ.Организация,
	|	ВЫРАЗИТЬ(Документ.Организация.НаименованиеПолное КАК СТРОКА(300)) КАК НаименованиеОрганизации,
	|	ЕСТЬNULL(ФИОФизлица.Фамилия + "" "" + ФИОФизлица.Имя + "" "" + ФИОФизлица.Отчество, Документ.Сотрудник.Наименование) КАК ФИОРаботника,
	|	Документ.Сотрудник.Код КАК ТабельныйНомер,"
	+ ТекстПоляИспользоватьСреднеЧасовойЗаработок + "
	|ИЗ
	|	Документ." + ИмяИсточникаДанных + " КАК Документ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ДатаНачалаСобытия, Сотрудник = &Сотрудник) КАК РаботникиОрганизацииСрезПоследних
	|		ПО (ИСТИНА)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&ДатаНачалаСобытия, ФизЛицо = &ФизЛицо) КАК ФИОФизлица
	|		ПО (ИСТИНА)
	|ГДЕ
	|	Документ.Ссылка = &ДокументСсылка";

	Результат = Запрос.Выполнить();
	Если Не Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Выборка.Следующий();
		Если ИспользоватьСреднеЧасовойЗаработок = Неопределено Тогда
			ИспользоватьСреднеЧасовойЗаработок = Выборка.ИспользоватьСреднеЧасовойЗаработок;
		КонецЕсли;
		ЗаполнитьЗначенияСвойств(СекцияШапка.Параметры,Выборка);
	КонецЕсли;
	
	//+ СВЭЙ КДЯ 07.02.20 СВФР-005462
	СуфЧас = ?( ИспользоватьСреднеЧасовойЗаработок И ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций"), "Час", "" );
	СекцияПодвал = Макет.ПолучитьОбласть( "Подвал" + СуфЧас );
	//- СВЭЙ КДЯ 07.02.20 СВФР-005462
	
	Если ВыводитьЗаголовок Тогда
		СекцияШапка.Параметры.Представление = РаботаСДиалогами.СформироватьЗаголовокДокумента(ДокументСсылка,МетаданныеДокумента.Синоним);
		СекцияШапка.Параметры.ОписаниеОплачиваемогоПериода = ОписаниеОплачиваемогоПериода;
		
		СекцияШапка.Параметры.ДатаНачалаРасчетногоПериода = Формат(ДобавитьМесяц(НачалоМесяца(ДатаСобытия), - ПродолжительностьРасчетногоПериода),"ДФ=dd.MM.yyyy");
		СекцияШапка.Параметры.ДатаОкончанияРасчетногоПериода = Формат(НачалоДня(НачалоМесяца(ДатаСобытия) - 1),"ДФ=dd.MM.yyyy");     
		

		СекцияШапка.Параметры.СпособРасчета = ?(СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет,Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС,СпособРасчета);
		Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") тогда
			//если заполнено в шапке, считам из этой даты
			Если ЗначениеЗаполнено(ДокументСсылка.ДатаНачалаВыборки) Тогда   
				СекцияШапка.Параметры.ДатаНачалаРасчетногоПериода = Формат(ДокументСсылка.ДатаНачалаВыборки,"ДФ=dd.MM.yyyy");
				СекцияШапка.Параметры.ДатаОкончанияРасчетногоПериода = Формат(ДобавитьМесяц(ДокументСсылка.ДатаНачалаВыборки, + ПродолжительностьРасчетногоПериода)-1,"ДФ=dd.MM.yyyy");
			КонецЕсли;

			//Аверсон ЕАЕ 16.02.2022 СВФР-008705
			Если ДокументСсылка.НачислятьМатериальнуюПомощь Тогда
				СекцияШапка.Параметры.СпособРасчета = СокрЛП(ДокументСсылка.МатериальнаяПомощьВидРасчета);
			Иначе
			//Аверсон СВФР-008705
				СекцияШапка.Параметры.СпособРасчета = СокрЛП(ДокументСсылка.ВидРасчета);
			КонецЕсли;
			
		КонецЕсли;
	КонецЕсли;
	
	
	Если СписокСоставляющихСреднегоЗаработка = Неопределено Тогда
		Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням 
			Или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке 
			Или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку
			Или СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка
			Тогда
			если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(ДокументСсылка) = Тип("ДокументОбъект.ОплатаПоСреднемуЗаработку") Тогда 
				СписокСоставляющихСреднегоЗаработка = Новый Массив(8);
			иначе
				СписокСоставляющихСреднегоЗаработка = Новый Массив(7);
			КонецЕсли;

			//+ СВЭЙ КДЯ СВФР-004602 12.08.19
			Если ТипЗнч( ДокументСсылка ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) 
					ИЛИ ТипЗнч( ДокументСсылка ) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" ) Тогда
					
				СписокСоставляющихСреднегоЗаработка	= ПроведениеРасчетов.ПолучитьСписокСоставляющихСреднегоЗаработкаДляОтпуска();
			Иначе		
			//- СВЭЙ КДЯ СВФР-004602 12.08.19 
						
				СписокСоставляющихСреднегоЗаработка[0] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку;
				СписокСоставляющихСреднегоЗаработка[1] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
				
				СписокСоставляющихСреднегоЗаработка[2] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
				СписокСоставляющихСреднегоЗаработка[3] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент;//О.Т. Аверсон 16.04.2019 № 4189
				СписокСоставляющихСреднегоЗаработка[4] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
				//СписокСоставляющихСреднегоЗаработка[2] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремии;
				СписокСоставляющихСреднегоЗаработка[5] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям;
				СписокСоставляющихСреднегоЗаработка[6] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
				если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") или ТипЗнч(ДокументСсылка) = Тип("ДокументОбъект.ОплатаПоСреднемуЗаработку") Тогда 
					СписокСоставляющихСреднегоЗаработка[7] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему;
				КонецЕсли;
				
			//+ СВЭЙ КДЯ СВФР-004602 12.08.19
			КонецЕсли; // ТипЗнч( ДокументСсылка ) = Тип( "ДокументСсылка.НачислениеОтпускаРаботникамОрганизаций" ) ИЛИ ТипЗнч( ДокументСсылка ) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" )
			//- СВЭЙ КДЯ СВФР-004602 12.08.19 
			
			//СписокСоставляющихСреднегоЗаработка[5] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуИндексируемые;
			//СписокСоставляющихСреднегоЗаработка[6] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые;
			//СписокСоставляющихСреднегоЗаработка[7] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямИндексируемые;
			//СписокСоставляющихСреднегоЗаработка[8] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямНеИндексируемые;
			//СписокСоставляющихСреднегоЗаработка[9] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямНеИндексируемые;
			//СписокСоставляющихСреднегоЗаработка[10] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииНеИндексируемые;
			//СписокСоставляющихСреднегоЗаработка[11] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииИндексируемые;
			//СписокСоставляющихСреднегоЗаработка[12] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииНеИндексируемые;
		//ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПособиеПоУходуЗаРебенкомДо1_5Лет Тогда
		//	СписокСоставляющихСреднегоЗаработка = Новый Массив(5); 
		//	СписокСоставляющихСреднегоЗаработка[0] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуПособий;
		//	СписокСоставляющихСреднегоЗаработка[1] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямПособий;
		//	СписокСоставляющихСреднегоЗаработка[2] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииПособий;
		//	СписокСоставляющихСреднегоЗаработка[3] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПособий;
		//	СписокСоставляющихСреднегоЗаработка[4] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииПособий;
		ИначеЕсли СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС Тогда
			СписокСоставляющихСреднегоЗаработка = Новый Массив(10); 
			СписокСоставляющихСреднегоЗаработка[0] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку;
			СписокСоставляющихСреднегоЗаработка[1] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
			СписокСоставляющихСреднегоЗаработка[3] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям;
			СписокСоставляющихСреднегоЗаработка[4] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
			//СписокСоставляющихСреднегоЗаработка[4] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииПособий;
			//СписокСоставляющихСреднегоЗаработка[5] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
			//СписокСоставляющихСреднегоЗаработка[6] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямБЛ;
			//СписокСоставляющихСреднегоЗаработка[7] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииБЛ;
			//СписокСоставляющихСреднегоЗаработка[8] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямБЛ;
			//СписокСоставляющихСреднегоЗаработка[9] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииБЛ;
		КонецЕсли;
		
	КонецЕсли;
	
	ОсновнойЗаработок = Новый Массив(4);
	ОсновнойЗаработок[0] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку;
	ОсновнойЗаработок[1] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
	ОсновнойЗаработок[2] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
	ОсновнойЗаработок[3] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент; //О.Т. Аверсон 16.04.2019 № 4189
	
	//ОсновнойЗаработок[1] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ;
	//ОсновнойЗаработок[2] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуПособий;
	//ОсновнойЗаработок[3] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуИндексируемые;
	//
	ФиксированныеПремии = Новый Массив(6);
	ФиксированныеПремии[0] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
	//ФиксированныеПремии[1] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямБЛ;
	//ФиксированныеПремии[2] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремии;
	//ФиксированныеПремии[3] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииБЛ;
	//ФиксированныеПремии[4] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямНеИндексируемые;
	//ФиксированныеПремии[5] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииНеИндексируемые;
	
	ПоФиксПремиям = Новый Массив(3);
	ПоФиксПремиям[0] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
	//ПоФиксПремиям[1] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямБЛ;
	
	ПоПремиям = Новый Массив(8);
	ПоПремиям[0] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям;
	ПоПремиям[0] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему;//О.Т. Аверсон 16.05.2016 № 1071
	//ПоПремиям[1] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямБЛ;
	//ПоПремиям[2] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПособий;
	//ПоПремиям[3] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямПособий;
	//ПоПремиям[4] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииПособий;
	//ПоПремиям[5] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииПособий;
	//ПоПремиям[6] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямИндексируемые;
	//ПоПремиям[7] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииИндексируемые;
	
	Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") и 
		?(ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку"), ДокументСсылка.ДатаНачала >= Дата(2017,10,1) и ДокументСсылка.ДатаНачала <= Дата(2018,01,17), ложь) Тогда //О.Т. Аверсон 08.11.2017 № 1206     		
		ПоФиксПремиямНеИндексируемые = Новый Массив(4);
	иначе
		ПоФиксПремиямНеИндексируемые = Новый Массив(4);
		ПоФиксПремиямНеИндексируемые[0] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
		//ПоФиксПремиямНеИндексируемые[1] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииБЛ;
		//ПоФиксПремиямНеИндексируемые[2] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксГодовойПремииНеИндексируемые;
		//ПоФиксПремиямНеИндексируемые[3] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиямНеИндексируемые;
	КонецЕсли;
	
	//Островская Татьяна 24.05.2013 № 16498
	Индексируемые = Новый Массив(9);
	//Индексируемые[0] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуИндексируемые;
	//Индексируемые[1] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямИндексируемые;
	//Индексируемые[2] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремииИндексируемые;
	Индексируемые[3] = ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям;
	Индексируемые[3] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиям;
	Индексируемые[4] = ПланыВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему; //О.Т. Аверсон 16.05.2016 № 1071
	Индексируемые[5] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку;
	Индексируемые[6] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
	Индексируемые[7] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпуск;
	Индексируемые[8] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуОтпускАгент;//О.Т. Аверсон 16.04.2019 № 4189
	//Островская Татьяна 24.05.2013 № 16498
	Запрос.УстановитьПараметр("Регистратор", ДокументСсылка);
	Запрос.УстановитьПараметр("СпособРасчета", СпособРасчета);
	Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням и ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда 
		если ДокументСсылка.СреднийЧасовойЗаработокДляКомпОтпуска Тогда 
			Запрос.УстановитьПараметр("ИспользоватьСреднеЧасовойЗаработок", СреднийЧасовойЗаработокДляКомпОтпуска);
		иначе
			//Аверсон 15.12.2022 КВВ СВФР-010017 (
			//Запрос.УстановитьПараметр("ИспользоватьСреднеЧасовойЗаработок", ИспользоватьСреднеЧасовойЗаработок);
			Запрос.УстановитьПараметр("ИспользоватьСреднеЧасовойЗаработок", СреднийЧасовойЗаработокДляКомпОтпуска);
			//Аверсон 15.12.2022 КВВ СВФР-010017 )
		КонецЕсли;
	иначе
		Запрос.УстановитьПараметр("ИспользоватьСреднеЧасовойЗаработок", ИспользоватьСреднеЧасовойЗаработок);
	КонецЕсли;
	
	//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
	ГодовыеПремии = Новый Массив(1);
	ГодовыеПремии[0] = ПланыВидовРасчета.СреднийЗаработок.ПоГодовойПремии;
	Запрос.УстановитьПараметр("ГодовыеПремии", ГодовыеПремии);
	//- СВЭЙ 05.03.19 КДЯ СВФР-003194
	
	Запрос.УстановитьПараметр("СписокСоставляющихСреднегоЗаработка", СписокСоставляющихСреднегоЗаработка);
	Запрос.УстановитьПараметр("Индексируемые",						Индексируемые);
	Запрос.УстановитьПараметр("ОсновнойЗаработок",					ОсновнойЗаработок);
	//+ СВЭЙ КДЯ 13.08.19 СВФР-004602
	//Запрос.УстановитьПараметр("ОсновнойЗаработокНеиндексируемый",	ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
	//- СВЭЙ КДЯ 13.08.19 СВФР-004602
	//+ СВЭЙ КДЯ 13.08.19 СВФР-004602
	ОсновнойЗаработокНеиндексируемый = Новый Массив(2);
	ОсновнойЗаработокНеиндексируемый[0] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемые;
	ОсновнойЗаработокНеиндексируемый[1] = ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуНеИндексируемыеАгент;
	Запрос.УстановитьПараметр("ОсновнойЗаработокНеиндексируемый",	ОсновнойЗаработокНеиндексируемый);
	//- СВЭЙ КДЯ 13.08.19 СВФР-004602
	Запрос.УстановитьПараметр("ПоФиксПремиям",						ПоФиксПремиям);
	Запрос.УстановитьПараметр("ПоПремиям",							ПоПремиям);
	Запрос.УстановитьПараметр("ВсеФиксированныеПремии",				ФиксированныеПремии);
	Запрос.УстановитьПараметр("ПоФиксПремиямНеИндексируемые",		ПоФиксПремиямНеИндексируемые);
	Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда //О.Т. Аверсон 07.12.2018 № 2913
		ПериодРСЗ = ДокументСсылка.ВидРасчета.ПериодРасчетаСреднегоЗаработка;
		КоличествоМесяцевРасчета = -ДокументСсылка.ВидРасчета.ПериодРасчетаСреднегоЗаработка;
		СекундыКонцаПериода = -1;
		
		мМесяц = НачалоМесяца(ДокументСсылка.ДатаНачала);
		мСтрока = РегистрыСведений.РаботникиОрганизаций.СрезПервых('19000101000000',
		Новый Структура("Организация, Сотрудник", ДокументСсылка.Организация, ДокументСсылка.Сотрудник));
		Если мСтрока.Количество() <>  0 Тогда
			
			ДатаПриемаНаРаботу = мСтрока[0].Период;
			НачалоМесяцаПриема = НачалоМесяца( ДатаПриемаНаРаботу );
			НачалоПрошлогогоМесяца = ДобавитьМесяц( мМесяц, -1 );
			НачалоПозапрошлогогоМесяца = ДобавитьМесяц( мМесяц, -2 );
			Если НачалоМесяцаПриема = мМесяц Тогда
				ПериодРСЗ = ДокументСсылка.ВидРасчета.ПериодРасчетаСреднегоЗаработка-1;
				КоличествоМесяцевРасчета = 0;
				СекундыКонцаПериода = КонецМесяца(мМесяц)-мМесяц;
			ИначеЕсли НачалоМесяцаПриема = НачалоПрошлогогоМесяца
				ИЛИ НачалоМесяцаПриема = НачалоПозапрошлогогоМесяца И ДатаПриемаНаРаботу > НачалоПозапрошлогогоМесяца Тогда
				ПериодРСЗ = ДокументСсылка.ВидРасчета.ПериодРасчетаСреднегоЗаработка - 1;
				КоличествоМесяцевРасчета = -1;
			КонецЕсли;
			//(конец) добавлено Кухарчуком Д.Я. 13.09.18, Задача СВФР-002436
		КонецЕсли;
		
		Запрос.УстановитьПараметр("ПериодРСЗ",	ПериодРСЗ);
		
		Запрос.УстановитьПараметр("РасчетныйПериодНачало",				?(ЗначениеЗаполнено(ДокументСсылка.ДатаНачалаВыборки),ДокументСсылка.ДатаНачалаВыборки,ДобавитьМесяц(НачалоМесяца(ДатаСобытия), - ПродолжительностьРасчетногоПериода))); 
		Запрос.УстановитьПараметр("РасчетныйПериодОкончание",			?(ЗначениеЗаполнено(ДокументСсылка.ДатаНачалаВыборки),НачалоДня(ДобавитьМесяц(ДокументСсылка.ДатаНачалаВыборки,ПериодРСЗ)+СекундыКонцаПериода),НачалоДня(НачалоМесяца(ДатаСобытия) - 1)));
	иначе 		
		Запрос.УстановитьПараметр("РасчетныйПериодНачало",				ДобавитьМесяц(НачалоМесяца(ДатаСобытия), - ПродолжительностьРасчетногоПериода));
		Запрос.УстановитьПараметр("РасчетныйПериодОкончание",			НачалоДня(НачалоМесяца(ДатаСобытия) - 1));
	КонецЕсли;
	
	// по окончательным данным проведенного документа
	// собираем итоговые данные и рассчитываем средний заработок
	//О.Т. 26.09.2014 № 17568
	если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда
		если ДокументСсылка.ВыходноеПособиеПоСокр Тогда 
			ФлагВыхоноеПособиеПоСокр = Истина;
		иначе
			ФлагВыхоноеПособиеПоСокр = Ложь;
		КонецЕсли;
		
	иначе
		ФлагВыхоноеПособиеПоСокр = Ложь;
	КонецЕсли;
	
	//+ СВЭЙ КДЯ 07.02.20 СВФР-005462
	ЗначениеТочностьСреднего = ОбщегоНазначения.ПолучитьТочностьСреднегоЗаработка();
	//- СВЭЙ КДЯ 07.02.20 СВФР-005462
	
	если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") и СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку 
		и ФлагВыхоноеПособиеПоСокр Тогда
		
		//+ СВЭЙ КДЯ 07.02.20 СВФР-005462 //расчет перенесен в основную ветку ( см. выше )
		//ТочностьСреднего = Константы.ТочностьСреднегоЗаработка.Получить();
		//Если ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр0 Тогда 
		//	ЗначениеТочностьСреднего = 0;
		//ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр1 Тогда 
		//	ЗначениеТочностьСреднего = 1;
		//ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр2 Тогда 
		//	ЗначениеТочностьСреднего = 2;
		//ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр3 Тогда 
		//	ЗначениеТочностьСреднего = 3;
		//ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр4 Тогда 
		//	ЗначениеТочностьСреднего = 4;
		//иначе
		//	ЗначениеТочностьСреднего = 0;
		//КонецЕсли;
		//- СВЭЙ КДЯ 07.02.20 СВФР-005462
		
		//+ СВЭЙ КДЯ 27.09.19 СВФР-004834
		//Запрос = Новый Запрос;
		//Запрос.Текст = 
		//"ВЫБРАТЬ
		//|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.МесяцВыборки,
		//|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.ОтработаноДней,
		//|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.ОтработаноЧасов,
		//|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.Результат * ВЫБОР
		//|		КОГДА РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.КоэффициентИндексации < 1
		//|			ТОГДА 1
		//|		ИНАЧЕ РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.КоэффициентИндексации
		//|	КОНЕЦ КАК Результат,
		//|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.НомерСтроки,
		//|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.Ссылка.Сотрудник,
		//|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.БазовыйПериодНачало
		//|ИЗ
		//|	Документ.РасчетПриУвольненииРаботникаОрганизаций.РасчетСреднего КАК РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего
		//|ГДЕ
		//|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.Ссылка = &Ссылка";
		//- СВЭЙ КДЯ 27.09.19 СВФР-004834
		
		//+ СВЭЙ КДЯ 27.09.19 СВФР-004834
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.МесяцВыборки,
		|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.Ссылка.Сотрудник,
		|	МАКСИМУМ(РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.ОтработаноДней) КАК ОтработаноДней,
		|	МАКСИМУМ(РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.ОтработаноЧасов) КАК ОтработаноЧасов,
		|	СУММА(РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.Результат * ВЫБОР
		|			КОГДА РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.КоэффициентИндексации < 1
		|				ТОГДА 1
		|			ИНАЧЕ РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.КоэффициентИндексации
		//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
		|		КОНЕЦ * ВЫБОР 
		|					КОГДА РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.ВидРасчета.Наименование ПОДОБНО ""%годовой%"" 
		|						ТОГДА 0 
		|						ИНАЧЕ 1 
		//- СВЭЙ КДЯ 26.02.20 СВФР-005574
		|		КОНЕЦ ) КАК Результат,
		//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
		|	СУММА(РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.Результат * ВЫБОР
		|			КОГДА РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.КоэффициентИндексации < 1
		|				ТОГДА 1
		|			ИНАЧЕ РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.КоэффициентИндексации
		|		КОНЕЦ * ВЫБОР 
		|					КОГДА РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.ВидРасчета.Наименование ПОДОБНО ""%годовой%"" 
		|						ТОГДА 1 
		|						ИНАЧЕ 0 
		|		КОНЕЦ ) КАК ГодоваяПремия,
		//- СВЭЙ КДЯ 26.02.20 СВФР-005574
		|	МИНИМУМ(РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.БазовыйПериодНачало) КАК БазовыйПериодНачало
		|ИЗ
		|	Документ.РасчетПриУвольненииРаботникаОрганизаций.РасчетСреднего КАК РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего
		|ГДЕ
		|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.Ссылка = &Ссылка
		|
		|СГРУППИРОВАТЬ ПО
		|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.МесяцВыборки,
		|	РасчетПриУвольненииРаботникаОрганизацийРасчетСреднего.Ссылка.Сотрудник";
		//- СВЭЙ КДЯ 27.09.19 СВФР-004834
		
		Запрос.УстановитьПараметр("Ссылка", ДокументСсылка);
		ОбщийИтог = 0;
		РезультатСредний = Запрос.Выполнить().Выбрать();
		сч = 0;
		Пока РезультатСредний.Следующий() Цикл
			//О.Т. Аверсон 25.10.2017 № 1108
			Если сч = 0 Тогда 
				Если РезультатСредний.БазовыйПериодНачало <> ДобавитьМесяц(НачалоМесяца(ДатаСобытия), - ПродолжительностьРасчетногоПериода) Тогда 
					СекцияШапка.Параметры.ДатаНачалаРасчетногоПериода = Формат(ДобавитьМесяц(НачалоМесяца(ДатаСобытия), - ПродолжительностьРасчетногоПериода - ПродолжительностьРасчетногоПериода),"ДФ=dd.MM.yyyy");
					СекцияШапка.Параметры.ДатаОкончанияРасчетногоПериода = Формат(НачалоДня(КонецМесяца(ДобавитьМесяц(НачалоМесяца(ДатаСобытия) - 1,- ПродолжительностьРасчетногоПериода))),"ДФ=dd.MM.yyyy");   				
					ТабДокумент.Вывести(СекцияШапка);
				иначе
					ТабДокумент.Вывести(СекцияШапка);
				КонецЕсли;
			КонецЕсли;
			НормаВремени = ПрочиеПроцедуры.ПолучитьНормуВремениПоГраффику(НачалоМесяца(РезультатСредний.МесяцВыборки),КонецМесяца(РезультатСредний.МесяцВыборки),РезультатСредний.Сотрудник).НормаДней;
			
			//+ СВЭЙ КДЯ 27.09.19 СВФР-004834
			//сч = 1;
			//О.Т. Аверсон 25.10.2017 № 1108
			//
			//СекцияДетали.Параметры["ОтработаноДней"+РезультатСредний.НомерСтроки] = РезультатСредний.ОтработаноДней;
			//СекцияДетали.Параметры["НормаДней"+РезультатСредний.НомерСтроки] = НормаВремени;
			//СекцияДетали.Параметры["Заработок"+РезультатСредний.НомерСтроки] = РезультатСредний.Результат;
			//СекцияДетали.Параметры["МесяцРасчета"+РезультатСредний.НомерСтроки] = Формат(РезультатСредний.МесяцВыборки,"ДФ=""ММММ""");
			//СекцияДетали.Параметры["Рез"+РезультатСредний.НомерСтроки] = Окр(РезультатСредний.Результат / РезультатСредний.ОтработаноДней * НормаВремени,ЗначениеТочностьСреднего);
			//- СВЭЙ КДЯ 27.09.19 СВФР-004834
			
			//+ СВЭЙ КДЯ 27.09.19 СВФР-004834
			сч = сч + 1;
			
			СекцияДетали.Параметры[ "ОтработаноДней" + сч ] = РезультатСредний.ОтработаноДней;
			СекцияДетали.Параметры[ "НормаДней" + сч ] = НормаВремени;
			СекцияДетали.Параметры[ "Заработок" + сч ] = РезультатСредний.Результат
			                                                    //+ СВЭЙ КДЯ 26.02.20 СВФР-005574
																+ Окр( РезультатСредний.ГодоваяПремия 
																		* РезультатСредний.ОтработаноДней / НормаВремени,
																	    ЗначениеТочностьСреднего
																	  )	
																//- СВЭЙ КДЯ 26.02.20 СВФР-005574
			                                              ;
			СекцияДетали.Параметры[ "МесяцРасчета" + сч ] = Формат( РезультатСредний.МесяцВыборки,"ДФ=""ММММ""");
			//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
			//СекцияДетали.Параметры[ "Рез" + сч ] = Окр( РезультатСредний.Результат * НормаВремени / РезультатСредний.ОтработаноДней, ЗначениеТочностьСреднего );
			//ОбщийИтог = ОбщийИтог + РезультатСредний.Результат * НормаВремени / РезультатСредний.ОтработаноДней;
			//- СВЭЙ КДЯ 26.02.20 СВФР-005574
			//- СВЭЙ КДЯ 27.09.19 СВФР-004834
			
			//+ СВЭЙ КДЯ 26.02.20 СВФР-005574
			РезультатМесяца = Окр( РезультатСредний.Результат * НормаВремени / РезультатСредний.ОтработаноДней, ЗначениеТочностьСреднего ) + РезультатСредний.ГодоваяПремия;
			СекцияДетали.Параметры[ "Рез" + сч ] = РезультатМесяца;
			ОбщийИтог = ОбщийИтог + РезультатМесяца;
			//- СВЭЙ КДЯ 26.02.20 СВФР-005574
													
						
		КонецЦикла;
		СекцияДетали.Параметры.СуммаМес1 = СекцияДетали.Параметры.Рез1;
		СекцияДетали.Параметры.СуммаМес2 = СекцияДетали.Параметры.Рез2;
        СекцияДетали.Параметры.КолМес = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ВыходноеПособиеПоСокр.ЧислоМесяцев;
		СекцияДетали.Параметры.Размер = ДокументСсылка.ДнейЧасовВыходногоПособия;
		СекцияДетали.Параметры.РезИтог = Окр(ОбщийИтог/ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ВыходноеПособиеПоСокр.ЧислоМесяцев 
		* ДокументСсылка.ДнейЧасовВыходногоПособия,ЗначениеТочностьСреднего);
		СтруктураОтветственный = ФормированиеПечатныхФорм.ФамилияИнициалыФизЛица(ДокументСсылка.Ответственный);
		
		СекцияПодвал.Параметры.ДолжностьФИО = СтруктураОтветственный.Должность;
		СекцияПодвал.Параметры.ОтветственныйФИО = СтруктураОтветственный.ФИО;
		ТабДокумент.Вывести(СекцияДетали);
		
		//О.Т. 26.09.2014 № 17568	
	иначе
		
		//Островская Татьяна 01.03.2013 № 16286
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработок)
		|			ТОГДА 1
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработокНеиндексируемый)
		|			ТОГДА 2
		//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ГодовыеПремии)
		|			ТОГДА 4
		//- СВЭЙ 05.03.19 КДЯ СВФР-003194
		|		ИНАЧЕ 3
		|	КОНЕЦ КАК ПорядокЗаписей,
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработок)
		|			ТОГДА ВЫБОР
		|					КОГДА РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.РасчетПриУвольненииРаботникаОрганизаций
		|						ТОГДА ВЫБОР
		|								КОГДА РасчетСреднегоЗаработка.Включать
		|									ТОГДА РасчетСреднегоЗаработка.Результат
		|								ИНАЧЕ 0
		|							КОНЕЦ
		|					ИНАЧЕ РасчетСреднегоЗаработка.Результат
		|				КОНЕЦ * ВЫБОР
		|					КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|						ТОГДА 1
		|					ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|				КОНЕЦ
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработокНеиндексируемый)
		|			ТОГДА ВЫБОР
		|					КОГДА РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.РасчетПриУвольненииРаботникаОрганизаций
		|						ТОГДА ВЫБОР
		|								КОГДА РасчетСреднегоЗаработка.Включать
		|									ТОГДА РасчетСреднегоЗаработка.Результат
		|								ИНАЧЕ 0
		|							КОНЕЦ
		|					ИНАЧЕ РасчетСреднегоЗаработка.Результат
		|				КОНЕЦ
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ВсегоЗаработка,
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ВсеФиксированныеПремии)
		|			ТОГДА РасчетСреднегоЗаработка.Результат
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ФиксПремий,
		|	ВЫБОР
		|		КОГДА (РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработок)
		|				ИЛИ РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработокНеиндексируемый))
		|				И РасчетСреднегоЗаработка.Сотрудник = &Сотрудник
		//+ СВЭЙ КДЯ 28.08.19 СВФР-004602		
		////+ СВЭЙ КДЯ 12.08.19 СВФР-004602		
		//|				И РасчетСреднегоЗаработка.Включать
		////- СВЭЙ КДЯ 12.08.19 СВФР-004602		
		//- СВЭЙ КДЯ 28.08.19 СВФР-004602		
		//+ СВЭЙ КДЯ 28.08.19 СВФР-004602		
		|				И ( РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку 
		|					ИЛИ РасчетСреднегоЗаработка.Включать )
		//- СВЭЙ КДЯ 28.08.19 СВФР-004602		
		|			ТОГДА ВЫБОР
		|					КОГДА &ИспользоватьСреднеЧасовойЗаработок
		|						ТОГДА РасчетСреднегоЗаработка.ОтработаноЧасов
		|					ИНАЧЕ РасчетСреднегоЗаработка.ОтработаноДней
		|				КОНЕЦ
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ВсегоДнейРасчетногоПериода,
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработок) ИЛИ НЕ РасчетСреднегоЗаработка.Включать
		//+ СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|				И НЕ РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку 
		//- СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|			ТОГДА 0
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработокНеиндексируемый)
		|			ТОГДА 0
		//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ГодовыеПремии)
		|			ТОГДА 0
		//- СВЭЙ 05.03.19 КДЯ СВФР-003194
		|		ИНАЧЕ 
		|			ВЫБОР
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоПремиям)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоФиксПремиям)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.НормаПоПятидневке = 0
		|								ТОГДА 0
		|							ИНАЧЕ РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
		|						КОНЕЦ
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоФиксПремиямНеИндексируемые)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * Выбор когда РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку тогда ВЫБОР //О.Т. Аверсон 22.03.2018 № 1755
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ иначе 1 конец * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.НормаПоПятидневке = 0
		|								ТОГДА 0
		|							ИНАЧЕ РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
		|						КОНЕЦ
		|				ИНАЧЕ РасчетСреднегоЗаработка.Результат
		|			КОНЕЦ * ВЫБОР
		|				КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
		|					ТОГДА РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / ВЫБОР КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0 ТОГДА 1 ИНАЧЕ РасчетСреднегоЗаработка.ЧислоМесяцев КОНЕЦ
		|				ИНАЧЕ 1
		|			КОНЕЦ
		|	КОНЕЦ КАК ВсегоУчтеноПремий,
		//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета НЕ В (&ГодовыеПремии) ИЛИ НЕ РасчетСреднегоЗаработка.Включать
		//+ СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|				И НЕ РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку 
		//- СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|			ТОГДА 0
		|		ИНАЧЕ 
		|			ВЫБОР
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоПремиям)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоФиксПремиям)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.НормаПоПятидневке = 0
		|								ТОГДА 0
		|							ИНАЧЕ РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
		|						КОНЕЦ
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоФиксПремиямНеИндексируемые)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * Выбор когда РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку тогда ВЫБОР //О.Т. Аверсон 22.03.2018 № 1755
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ иначе 1 конец * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.НормаПоПятидневке = 0
		|								ТОГДА 0
		|							ИНАЧЕ 
		
		//Аверсон 09.08.2021 КВВ СВФР-007817 (
		//РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
		|ВЫБОР КОГДА 
		|(РасчетСреднегоЗаработка.ОтработаноПоПятидневке < РасчетСреднегоЗаработка.НормаПоПятидневке)
		//ПСА 01.10.2021 СВФР-8202 ---|И (РасчетСреднегоЗаработка.КоэффициентИндексации = 1)
		|ТОГДА
		|РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
		|ИНАЧЕ 1
		|КОНЕЦ
		//Аверсон 09.08.2021 КВВ СВФР-007817 )
		
		|						КОНЕЦ
		|				ИНАЧЕ РасчетСреднегоЗаработка.Результат
		|			КОНЕЦ * ВЫБОР
		|				КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев > РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
		|					ТОГДА РасчетСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / ВЫБОР КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0 ТОГДА 1 ИНАЧЕ РасчетСреднегоЗаработка.ЧислоМесяцев КОНЕЦ
		|				ИНАЧЕ 1
		|			КОНЕЦ
		|	КОНЕЦ КАК ВсегоУчтеноГодовыхПремий,
		//- СВЭЙ 05.03.19 КДЯ СВФР-003194
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ВсеФиксированныеПремии)
		|			ТОГДА РасчетСреднегоЗаработка.ОтработаноПоПятидневке
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ВсегоДнейОтработано,
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ВсеФиксированныеПремии)
		|			ТОГДА ВЫБОР
		|					КОГДА РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.РасчетПриУвольненииРаботникаОрганизаций
		|						ТОГДА ВЫБОР
		|								КОГДА РасчетСреднегоЗаработка.Включать
		|									ТОГДА РасчетСреднегоЗаработка.НормаПоПятидневке
		|								ИНАЧЕ 0
		|							КОНЕЦ
		|					ИНАЧЕ РасчетСреднегоЗаработка.НормаПоПятидневке
		|				КОНЕЦ
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ВсегоДнейПоНорме,
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработок) ИЛИ НЕ РасчетСреднегоЗаработка.Включать
		//+ СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|				И НЕ РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку 
		//- СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|			ТОГДА 0
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработокНеиндексируемый)
		|			ТОГДА 0
		//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ГодовыеПремии)
		|			ТОГДА 0
		//- СВЭЙ 05.03.19 КДЯ СВФР-003194
		|		ИНАЧЕ 
		|			ВЫБОР
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоФиксПремиям)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоПремиям)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоФиксПремиямНеИндексируемые) и РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку //О.Т. Аверсон 22.03.2018 № 1755
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.НормаПоПятидневке = 0
		|								ТОГДА 0
		|							ИНАЧЕ РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
		|						КОНЕЦ

		|				ИНАЧЕ РасчетСреднегоЗаработка.Результат
		|			КОНЕЦ / ВЫБОР КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0 ТОГДА 1 ИНАЧЕ РасчетСреднегоЗаработка.ЧислоМесяцев КОНЕЦ
		|	КОНЕЦ КАК МесячнаяЧастьПремий,
		//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета НЕ В (&ГодовыеПремии) ИЛИ НЕ РасчетСреднегоЗаработка.Включать
		//+ СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|				И НЕ РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку 
		//- СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|			ТОГДА 0
		|		ИНАЧЕ 
		|			ВЫБОР
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоФиксПремиям)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоПремиям)
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ
		|				КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ПоФиксПремиямНеИндексируемые) и РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку //О.Т. Аверсон 22.03.2018 № 1755
		|					ТОГДА РасчетСреднегоЗаработка.Результат * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|								ТОГДА 1
		|							ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|						КОНЕЦ * ВЫБОР
		|							КОГДА РасчетСреднегоЗаработка.НормаПоПятидневке = 0
		|								ТОГДА 0
		|							ИНАЧЕ 
		//Аверсон 09.08.2021 КВВ СВФР-007817 (
		//РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
		|ВЫБОР КОГДА 
		|(РасчетСреднегоЗаработка.ОтработаноПоПятидневке < РасчетСреднегоЗаработка.НормаПоПятидневке)
		//ПСА 01.10.2021 СВФР-8202 ---|И (РасчетСреднегоЗаработка.КоэффициентИндексации = 1)
		|ТОГДА
		|РасчетСреднегоЗаработка.ОтработаноПоПятидневке / РасчетСреднегоЗаработка.НормаПоПятидневке
		|ИНАЧЕ 1
		|КОНЕЦ
		//Аверсон 09.08.2021 КВВ СВФР-007817 )
		|						КОНЕЦ

		|				ИНАЧЕ РасчетСреднегоЗаработка.Результат
		|			КОНЕЦ / ВЫБОР КОГДА РасчетСреднегоЗаработка.ЧислоМесяцев = 0 ТОГДА 1 ИНАЧЕ РасчетСреднегоЗаработка.ЧислоМесяцев КОНЕЦ
		|	КОНЕЦ КАК МесячнаяЧастьГодовыхПремий,
		//- СВЭЙ 05.03.19 КДЯ СВФР-003194
		|	НАЧАЛОПЕРИОДА(РасчетСреднегоЗаработка.МесяцВыборки, МЕСЯЦ) КАК МесяцРасчетногоПериода,
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&Индексируемые)
		|			ТОГДА ВЫБОР
		|					КОГДА РасчетСреднегоЗаработка.КоэффициентИндексации < 1
		|						ТОГДА 1
		|					ИНАЧЕ РасчетСреднегоЗаработка.КоэффициентИндексации
		|				КОНЕЦ
		|		ИНАЧЕ 1
		|	КОНЕЦ КАК КоэффициентИндексации,
		|	РасчетСреднегоЗаработка.Результат,
		|	РасчетСреднегоЗаработка.ЧислоМесяцев КАК МесяцевПремии,
		|	ВЫБОР
		|		КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &ДатаНачалаСобытия
		|				И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизацииЗавершения.Наименование
		|		ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации.Наименование
		|	КОНЕЦ + ""; "" + ВЫБОР
		|		КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &ДатаНачалаСобытия
		|				И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА РаботникиОрганизацийСрезПоследних.ДолжностьЗавершения.Наименование
		|		ИНАЧЕ РаботникиОрганизацийСрезПоследних.Должность.Наименование
		|	КОНЕЦ КАК РабочееМесто,
		|	РасчетСреднегоЗаработка.Сотрудник КАК Сотрудник,
		|	ВЫБОР
		|		КОГДА ЕСТЬNULL(РасчетСреднегоЗаработка.Сотрудник.ВидЗанятости, РасчетСреднегоЗаработка.Регистратор.Сотрудник.ВидЗанятости) = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|			ТОГДА ""По внутр. совм-ву""
		|		ИНАЧЕ ""Основное рабочее место""
		|	КОНЕЦ КАК ВидЗанятости,
		|	РасчетСреднегоЗаработка.МесяцВыборки,
		//+ СВЭЙ КДЯ 29.08.19 СВФР-004692		
		//|	РасчетСреднегоЗаработка.Включать,
		//- СВЭЙ КДЯ 29.08.19 СВФР-004692		
		//+ СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|	РасчетСреднегоЗаработка.Включать 
		|		ИЛИ РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку КАК Включать,
		//- СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|	ВЫБОР
		|		КОГДА РасчетСреднегоЗаработка.Включать
		//+ СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|				ИЛИ РасчетСреднегоЗаработка.Регистратор ССЫЛКА Документ.ОплатаПоСреднемуЗаработку
		//- СВЭЙ КДЯ 29.08.19 СВФР-004692		
		|			ТОГДА ""Вкл""
		|		ИНАЧЕ ""Не вкл""
		|	КОНЕЦ КАК Включать1,
		|	Выбор КОГДА РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработок) или РасчетСреднегоЗаработка.ВидРасчета В (&ОсновнойЗаработокНеиндексируемый) тогда РасчетСреднегоЗаработка.НормаПоПятидневке иначе 0 конец как НормаПоПятидневке,
		
		//Аверсон 21.09.2020 КВВ СВФР-006593 ( 
		|  РасчетСреднегоЗаработка.РезультатДляПремии
		//Аверсон 21.09.2020 КВВ СВФР-006593 )
		
		|ИЗ
		|	РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(
		|				&ДатаНачалаСобытия,
		|				Сотрудник В
		|						(ВЫБРАТЬ РАЗЛИЧНЫЕ
		|							РасчетСреднегоЗаработка.Сотрудник
		|						ИЗ
		|							РегистрРасчета.РасчетСреднегоЗаработка КАК РасчетСреднегоЗаработка
		|						ГДЕ
		|							РасчетСреднегоЗаработка.Регистратор = &Регистратор)
		|					И Организация = &ГоловнаяОрганизация) КАК РаботникиОрганизацийСрезПоследних
		|		ПО РасчетСреднегоЗаработка.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
		|ГДЕ
		|	РасчетСреднегоЗаработка.Регистратор = &Регистратор
		|	И РасчетСреднегоЗаработка.СпособРасчета = &СпособРасчета
		|	И (РасчетСреднегоЗаработка.Результат <> 0
		|			ИЛИ РасчетСреднегоЗаработка.ОтработаноДней <> 0
		|			ИЛИ РасчетСреднегоЗаработка.ОтработаноЧасов <> 0)";
		//ПСА 18.02.2021 СВФР-007185+++
		Если ТипЗнч(ДокументСсылка) <> Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда
			Запрос.Текст = Запрос.Текст + "
			|	И РасчетСреднегоЗаработка.ДатаНачалаРасчетногоПериода = &РасчетныйПериодНачало
			|	И РасчетСреднегоЗаработка.ДатаОкончанияРасчетногоПериода = &РасчетныйПериодОкончание";
		КонецЕсли;
		//+++ПСА 18.02.2021 СВФР-007185
	    Запрос.Текст = Запрос.Текст + "
		|	И РасчетСреднегоЗаработка.ВидРасчета В(&СписокСоставляющихСреднегоЗаработка)
		|
		|УПОРЯДОЧИТЬ ПО
		//+ СВЭЙ КДЯ 12.08.19 СВФР-004602
		//не менять порядок сортировки, он влияет на подсчет кол-ва месяцев
		|	РасчетСреднегоЗаработка.МесяцВыборки,  
		//- СВЭЙ КДЯ 12.08.19 СВФР-004602
		|	ПорядокЗаписей
		//+ СВЭЙ КДЯ 12.08.19 СВФР-004602
		////Аверсон 04.05.2019 КВВ СВФР-004312 (
		////|	РасчетСреднегоЗаработка.БазовыйПериодНачало  // закомментировано
		//| , РасчетСреднегоЗаработка.МесяцВыборки 
		////Аверсон 04.05.2019 КВВ СВФР-004312 )
		//- СВЭЙ КДЯ 12.08.19 СВФР-004602
		|ИТОГИ
		|	СУММА(ВсегоЗаработка),
		|	СУММА(ФиксПремий),
		|	СУММА(ВсегоДнейРасчетногоПериода),
		|	СУММА(ВсегоУчтеноПремий),
		//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
		|	СУММА(ВсегоУчтеноГодовыхПремий),
		//- СВЭЙ 05.03.19 КДЯ СВФР-003194
		|	МАКСИМУМ(ВсегоДнейОтработано),
		|	МАКСИМУМ(ВсегоДнейПоНорме),
		|	СУММА(НормаПоПятидневке)
		|ПО
		|	ОБЩИЕ,
		|	Сотрудник";
		//Островская Татьяна 01.03.2013 № 16286
		Результат = Запрос.Выполнить();
		
		СтруктураПоказателей = Новый Структура("
		|ВсегоДнейРасчетногоПериода,
		|НормаПоПятидневке,
		|ВсегоЗаработка,
		|ВсегоУчтеноПремий,
		//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
		|ВсегоУчтеноГодовыхПремий,
		//- СВЭЙ 05.03.19 КДЯ СВФР-003194
		|ОбщийЗаработок, 
		|Средний",0,0,0,0,0,0,0);
		
		//О.Т. Аверсон 25.10.2017 № 1108
		Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") и Результат.Пустой() Тогда 
			Запрос.УстановитьПараметр("РасчетныйПериодНачало",				ДобавитьМесяц(НачалоМесяца(ДатаСобытия), - ПродолжительностьРасчетногоПериода - ПродолжительностьРасчетногоПериода));
			Запрос.УстановитьПараметр("РасчетныйПериодОкончание",			НачалоДня(КонецМесяца(ДобавитьМесяц(НачалоМесяца(ДатаСобытия) - 1,- ПродолжительностьРасчетногоПериода))));
			Результат = Запрос.Выполнить(); 
			
			СекцияШапка.Параметры.ДатаНачалаРасчетногоПериода = Формат(ДобавитьМесяц(НачалоМесяца(ДатаСобытия), - ПродолжительностьРасчетногоПериода - ПродолжительностьРасчетногоПериода),"ДФ=dd.MM.yyyy");
			СекцияШапка.Параметры.ДатаОкончанияРасчетногоПериода = Формат(НачалоДня(КонецМесяца(ДобавитьМесяц(НачалоМесяца(ДатаСобытия) - 1,- ПродолжительностьРасчетногоПериода))),"ДФ=dd.MM.yyyy"); 
			
			ТабДокумент.Вывести(СекцияШапка);
		иначе
			ТабДокумент.Вывести(СекцияШапка); 
		КонецЕсли;
		//О.Т. Аверсон 25.10.2017 № 1108
		
		
		Если Не Результат.Пустой() Тогда
			
			// уточним названия колонок и показателей
			//СреднийЧасовойЗаработокДляКомпОтпуска = Ложь; //нельзя просто ставить ложь, если приходит истина
			// уточним названия колонок и показателей
			Если СреднийЧасовойЗаработокДляКомпОтпуска = Неопределено Тогда
				СреднийЧасовойЗаработокДляКомпОтпуска = Ложь;
			КонецЕсли;
			//Аверсон 07.01.2023 КВВ СВФР-010017 (
			Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда 
				_ИспользоватьСреднеЧасовойЗаработок_ = СреднийЧасовойЗаработокДляКомпОтпуска;
			Иначе 
				_ИспользоватьСреднеЧасовойЗаработок_ = ИспользоватьСреднеЧасовойЗаработок;
			КонецЕсли;
			////Аверсон 15.12.2022 КВВ СВФР-010017 (
			////Если ИспользоватьСреднеЧасовойЗаработок Тогда
			//Если СреднийЧасовойЗаработокДляКомпОтпуска Тогда
			////Аверсон 15.12.2022 КВВ СВФР-010017 )
			Если _ИспользоватьСреднеЧасовойЗаработок_ Тогда
			//Аверсон 07.01.2023 КВВ СВФР-010017 )
			
				СекцияЗаголовокРабочегоМеста.Параметры.ЕдиницаИзмерения = "часов";
				СекцияДоляВремени.Параметры.ЕдиницаИзмерения = "часов";
				СекцияПодвал.Параметры.ЕдиницаИзмерения = "часов";
				СекцияПодвал.Параметры.ОписаниеЗаработка = "Среднечасовой";
				
				//+ СВЭЙ КДЯ 07.02.20 СВФР-005462
			ИначеЕсли ТипЗнч(ДокументСсылка) = Тип( "ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций" ) 
				И ДокументСсылка.СреднийЧасовойЗаработокДляКомпОтпуска Тогда
				СекцияЗаголовокРабочегоМеста.Параметры.ЕдиницаИзмерения = "часов";
				СекцияДоляВремени.Параметры.ЕдиницаИзмерения = "часов";
				СекцияПодвал.Параметры.ЕдиницаИзмерения = "часов";
				СекцияПодвал.Параметры.ОписаниеЗаработка = "Среднедневной";
				//- СВЭЙ КДЯ 07.02.20 СВФР-005462
				
			Иначе
				СекцияЗаголовокРабочегоМеста.Параметры.ЕдиницаИзмерения = "дней";
				СекцияДоляВремени.Параметры.ЕдиницаИзмерения = "дней";
				СекцияПодвал.Параметры.ЕдиницаИзмерения = "дней";
				СекцияПодвал.Параметры.ОписаниеЗаработка = "Среднедневной";
			КонецЕсли;
			СтруктураИтоговПоРабочемуМесту = Новый Структура("
			|ВсегоДнейРасчетногоПериода,
			|НормаПоПятидневке,
			|ВсегоЗаработка,
			|ВсегоДнейОтработано,
			|ВсегоДнейПоНорме,
			|ДоляВремени",0,0,0,0,0);
			
			ВыводитьЗаголовокРабочегоМеста = Истина;
			ВыводитьИтогиПредыдущегоРабочегоМеста = Ложь;
			ТабДокумент.Вывести(СекцияЗаголовокНачислений);
			
			// Формирование раздела по начислениям за расчетный период по рабочим местам
			//Островская Татьяна 01.03.2013 № 16286
			Выборка = Результат.Выбрать();
			ДатаПрошл = "";
			КоличествоМесяцев = 0;
			КоличествоДней = 0;
			Пока Выборка.Следующий() Цикл
				
				если ДатаПрошл <> Выборка.МесяцВыборки Тогда 
					если Строка(Выборка.МесяцВыборки) <> "" Тогда 
						если Выборка.Включать или ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда 
							КоличествоМесяцев = КоличествоМесяцев +1;
							КоличествоДней = КоличествоДней + Выборка.ВсегоДнейРасчетногоПериода;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				ДатаПрошл = Выборка.МесяцВыборки;
			КонецЦикла;

			НормаКолвоЧасПоСр = 0;//Аверсон 21.09.2020 КВВ СВФР-006593
			
			//Аверсон 27.01.2022 КВВ СВФР-008638 (
			СписокОсновныеВР = Новый СписокЗначений;
			Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") И ДокументСсылка.НеСворачиватьНачисленияПриПечати Тогда
				ЗапросПоОснВР = Новый Запрос;
				ЗапросПоОснВР.Текст = "ВЫБРАТЬ
				|СреднийЗаработокБазовыеВидыРасчета.ВидРасчета КАК ВидРасчета
				|ИЗ ПланВидовРасчета.СреднийЗаработок.БазовыеВидыРасчета КАК СреднийЗаработокБазовыеВидыРасчета
				|ГДЕ СреднийЗаработокБазовыеВидыРасчета.Ссылка = ЗНАЧЕНИЕ(ПланВидовРасчета.СреднийЗаработок.ПоГодовойПремии)
				|ИЛИ СреднийЗаработокБазовыеВидыРасчета.Ссылка = ЗНАЧЕНИЕ(ПланВидовРасчета.СреднийЗаработок.ПоПремиямПоСреднему)";
				РезЗапросПоОснВР = ЗапросПоОснВР.Выполнить().Выгрузить();
				Если РезЗапросПоОснВР.Количество() > 0 Тогда
					РезЗапросПоОснВР.Свернуть("ВидРасчета");
					СписокОсновныеВР.ЗагрузитьЗначения(РезЗапросПоОснВР.ВыгрузитьКолонку("ВидРасчета"));
				КонецЕсли;
			КонецЕсли;
			//Аверсон 27.01.2022 КВВ СВФР-008638 )
			
			//Островская Татьяна 01.03.2013 № 16286
			Выборка = Результат.Выбрать();
			Пока Выборка.Следующий() Цикл
				Если Выборка.ТипЗаписи() = ТипЗаписиЗапроса.ОбщийИтог Тогда
					
					//заполнение итогами по расчету среднего заработка
					ЗаполнитьЗначенияСвойств(СтруктураПоказателей,Выборка);
					ОтражатьДолюВремени = ОтражатьДолюВремени И Выборка.ФиксПремий <> 0;
					
					//+ СВЭЙ КДЯ 07.02.20 СВФР-005462
					ОбщийЗаработок = Выборка.ВсегоЗаработка + Выборка.ВсегоУчтеноГодовыхПремий 
										+ Выборка.ВсегоУчтеноПремий;
					СтруктураПоказателей.ОбщийЗаработок = Формат( ОбщийЗаработок, "ЧЦ=17; ЧДЦ=4; ЧН=-" );
					//- СВЭЙ КДЯ 07.02.20 СВФР-005462
					
					
					если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") и СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку Тогда  
						СекцияПодвал.Параметры.ВсегоМесяцевРасчета = КоличествоДней;
					ИначеЕсли  ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
						СекцияПодвал.Параметры.ВсегоМесяцевРасчета = КоличествоДней;
						
						//Аверсон ЕАЕ 19.02.2025 СВФР-014648
						Орг = ДокументСсылка.Организация;
						Если Орг.СравнениеЗПВОплатеПоСреднему Тогда
							РезультатРасчета = "Результат расчета фактической заработной платы за " +ДокументСсылка.Начисления.Итог("ОплаченоДнейЧасов")+ " "+СформатироватьСтроку(ДокументСсылка.Начисления.Итог("ОплаченоДнейЧасов"),"",Истина)+":" + Формат(ДокументСсылка.СравнениеЗарплаты.Итог("РезультатРасчета"),"ЧДЦ=2");
						Иначе
							РезультатРасчета = "";
						КонецЕсли;
						СекцияПодвал.Параметры.РезультатРасчета = РезультатРасчета;
						//Аверсон СВФР-014648
						
					иначе
						Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням и ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда 
							
							//+ СВЭЙ КДЯ 07.02.20 СВФР-005462
							если ИспользоватьСреднеЧасовойЗаработок Тогда
								
								СреднийЧасовойЗаработок = Окр( ОбщийЗаработок / КоличествоДней, 
																ЗначениеТочностьСреднего );
										    
								СекцияПодвал.Параметры.СреднийЧасовойЗаработок = СреднийЧасовойЗаработок;    
								СекцияПодвал.Параметры.Коэффиц = " / "+СрКолвоКДн;
								
								ЧасовПоГрафикуВГодуУвольнения = 
								ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени( 
									ДокументСсылка.Сотрудник, Перечисления.ВидыУчетаВремени.ПоЧасам, 
									НачалоГода( ДокументСсылка.ДатаУвольнения ), КонецГода( ДокументСсылка.ДатаУвольнения ),
									ДокументСсылка.Организация );
								СекцияПодвал.Параметры.ЧасовПоГрафикуВГодуУвольнения = ЧасовПоГрафикуВГодуУвольнения;
								СреднийМесячныйЗаработок = Окр( СреднийЧасовойЗаработок * ЧасовПоГрафикуВГодуУвольнения / 12, ЗначениеТочностьСреднего );
								СекцияПодвал.Параметры.СреднийМесячныйЗаработок = СреднийМесячныйЗаработок;
							//- СВЭЙ КДЯ 07.02.20 СВФР-005462
							
							иначеесли ДокументСсылка.СреднийЧасовойЗаработокДляКомпОтпуска Тогда
								 
								СреднемесНормаРабЧасов = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ДокументСсылка.ПериодРегистрации),Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов)).Размер;
								
								СекцияПодвал.Параметры.ВсегоМесяцевРасчета = Строка(КоличествоДней)+ " * " + Строка(СреднемесНормаРабЧасов);    
								СекцияПодвал.Параметры.Коэффиц = " / "+СрКолвоКДн;
							иначе
								СекцияПодвал.Параметры.ВсегоМесяцевРасчета = КоличествоМесяцев;    
								СекцияПодвал.Параметры.Коэффиц = "/ "+СрКолвоКДн;    								
							КонецЕсли;
							
						иначе
							СекцияПодвал.Параметры.ВсегоМесяцевРасчета = КоличествоМесяцев;    
							СекцияПодвал.Параметры.Коэффиц = "/ "+СрКолвоКДн;
						КонецЕсли;
					КонецЕсли;
					//Островская Татьяна 17.04.2014 № 17287
					
					//+ СВЭЙ КДЯ 07.02.20 СВФР-005462 //расчет перенесен в основную ветку ( см. выше )
					//ТочностьСреднего = Константы.ТочностьСреднегоЗаработка.Получить();
					//Если ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр0 Тогда 
					//	ЗначениеТочностьСреднего = 0;
					//ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр1 Тогда 
					//	ЗначениеТочностьСреднего = 1;
					//ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр2 Тогда 
					//	ЗначениеТочностьСреднего = 2;
					//ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр3 Тогда 
					//	ЗначениеТочностьСреднего = 3;
					//ИначеЕсли ТочностьСреднего = Перечисления.ПорядокОкругленияСреднегоЗаработка.Окр4 Тогда 
					//	ЗначениеТочностьСреднего = 4;
					//иначе
					//	ЗначениеТочностьСреднего = 0;
					//КонецЕсли;
					//- СВЭЙ КДЯ 07.02.20 СВФР-005462
					
					если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") и СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку Тогда 
						СтруктураПоказателей.Средний = ?(ЗначениеЗаполнено(ЗначениеТочностьСреднего),Окр(?(КоличествоДней = 0,0, (Выборка.ВсегоЗаработка 
															//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
															+ Выборка.ВсегоУчтеноГодовыхПремий
															//- СВЭЙ 05.03.19 КДЯ СВФР-003194
															+ Выборка.ВсегоУчтеноПремий) / КоличествоДней), ЗначениеТочностьСреднего ),
						Окр(?(КоличествоДней = 0,0, (Выборка.ВсегоЗаработка 
															//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
															+ Выборка.ВсегоУчтеноГодовыхПремий
															//- СВЭЙ 05.03.19 КДЯ СВФР-003194
															+ Выборка.ВсегоУчтеноПремий) / КоличествоДней)));
						
					ИначеЕсли ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
						
						СтруктураПоказателей.Средний = ?(ЗначениеЗаполнено(ЗначениеТочностьСреднего),Окр(?(КоличествоДней = 0,0, (Выборка.ВсегоЗаработка 
															//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
															+ Выборка.ВсегоУчтеноГодовыхПремий
															//- СВЭЙ 05.03.19 КДЯ СВФР-003194
															+ Выборка.ВсегоУчтеноПремий) / КоличествоДней), ЗначениеТочностьСреднего ),
						Окр(?(КоличествоДней = 0,0, (Выборка.ВсегоЗаработка 
															//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
															+ Выборка.ВсегоУчтеноГодовыхПремий
															//- СВЭЙ 05.03.19 КДЯ СВФР-003194
															+ Выборка.ВсегоУчтеноПремий) / КоличествоДней)));
						
					иначе
						Если СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням и ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") Тогда 
							
							//+ СВЭЙ КДЯ 07.02.20 СВФР-005462
							если ИспользоватьСреднеЧасовойЗаработок Тогда
								
								СтруктураПоказателей.Средний = 
									Окр( СреднийМесячныйЗаработок / СрКолвоКДн, ЗначениеТочностьСреднего );
							//- СВЭЙ КДЯ 07.02.20 СВФР-005462
							
							иначеесли ДокументСсылка.СреднийЧасовойЗаработокДляКомпОтпуска Тогда
							
								//+ СВЭЙ КДЯ 07.02.20 СВФР-005462
								//СреднемесНормаРабЧасов = РегистрыСведений.РазмерыПараметровДляРасчетаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ДокументСсылка.ПериодРегистрации),Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СреднемесячнаяНормаЧасов)).Размер;
								//
								//
								//СтруктураПоказателей.Средний = ?(ЗначениеЗаполнено(ЗначениеТочностьСреднего),Окр(?(КоличествоДней = 0,0, (Выборка.ВсегоЗаработка 
								//									//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
								//									+ Выборка.ВсегоУчтеноГодовыхПремий
								//									//- СВЭЙ 05.03.19 КДЯ СВФР-003194
								//									+ Выборка.ВсегоУчтеноПремий)  /  КоличествоДней * СреднемесНормаРабЧасов /СрКолвоКДн), ЗначениеТочностьСреднего ),
								//Окр(?(КоличествоМесяцев = 0,0, (Выборка.ВсегоЗаработка 
								//									//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
								//									+ Выборка.ВсегоУчтеноГодовыхПремий
								//									//- СВЭЙ 05.03.19 КДЯ СВФР-003194
								//									+ Выборка.ВсегоУчтеноПремий) / КоличествоМесяцев/СрКолвоКДн)));
								//- СВЭЙ КДЯ 07.02.20 СВФР-005462
								
								
								СтруктураПоказателей.Средний = 
									Окр( ?( КоличествоДней = 0, 0, ОбщийЗаработок /  КоличествоДней 
											* СреднемесНормаРабЧасов / СрКолвоКДн ), ЗначениеТочностьСреднего );
								
							иначе
								СтруктураПоказателей.Средний = ?(ЗначениеЗаполнено(ЗначениеТочностьСреднего),Окр(?(КоличествоМесяцев = 0,0, (Выборка.ВсегоЗаработка 
																	//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
																	+ Выборка.ВсегоУчтеноГодовыхПремий
																	//- СВЭЙ 05.03.19 КДЯ СВФР-003194
																	+ Выборка.ВсегоУчтеноПремий) / КоличествоМесяцев/СрКолвоКДн),ЗначениеТочностьСреднего),
								Окр(?(КоличествоМесяцев = 0,0, (Выборка.ВсегоЗаработка 
																	//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
																	+ Выборка.ВсегоУчтеноГодовыхПремий
																	//- СВЭЙ 05.03.19 КДЯ СВФР-003194
																	+ Выборка.ВсегоУчтеноПремий) / КоличествоМесяцев/СрКолвоКДн)));
							КонецЕсли;
						иначе  						
							СтруктураПоказателей.Средний = ?(ЗначениеЗаполнено(ЗначениеТочностьСреднего),Окр(?(КоличествоМесяцев = 0,0, (Выборка.ВсегоЗаработка 
																//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
																+ Выборка.ВсегоУчтеноГодовыхПремий
																//- СВЭЙ 05.03.19 КДЯ СВФР-003194
																+ Выборка.ВсегоУчтеноПремий) / КоличествоМесяцев/СрКолвоКДн),ЗначениеТочностьСреднего),
							Окр(?(КоличествоМесяцев = 0,0, (Выборка.ВсегоЗаработка 
																//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
																+ Выборка.ВсегоУчтеноГодовыхПремий
																//- СВЭЙ 05.03.19 КДЯ СВФР-003194
																+ Выборка.ВсегоУчтеноПремий) / КоличествоМесяцев/СрКолвоКДн)));
						КонецЕсли;
						
					КонецЕсли;
					//Островская Татьяна 17.04.2014 № 17287
				ИначеЕсли Выборка.ТипЗаписи() = ТипЗаписиЗапроса.ИтогПоГруппировке Тогда
					Если ВыводитьИтогиПредыдущегоРабочегоМеста Тогда // итоги предыдущего р.м.
						ЗаполнитьЗначенияСвойств(СекцияСерединаОтчета.Параметры,СтруктураИтоговПоРабочемуМесту);
						ТабДокумент.Вывести(СекцияСерединаОтчета);
						Если ОтражатьДолюВремени Тогда
							ЗаполнитьЗначенияСвойств(СекцияДоляВремени.Параметры,СтруктураИтоговПоРабочемуМесту);
							ТабДокумент.Вывести(СекцияДоляВремени);
						КонецЕсли;
					Иначе
						ВыводитьИтогиПредыдущегоРабочегоМеста = Истина;
					КонецЕсли;
					
					// заполнение итогами по очередному р.м.
					ЗаполнитьЗначенияСвойств(СтруктураИтоговПоРабочемуМесту,Выборка);
					СтруктураИтоговПоРабочемуМесту.ДоляВремени = ?(СтруктураИтоговПоРабочемуМесту.ВсегоДнейПоНорме = 0,0, Формат(СтруктураИтоговПоРабочемуМесту.ВсегоДнейОтработано / СтруктураИтоговПоРабочемуМесту.ВсегоДнейПоНорме,"ЧДЦ=10"));
					ВыводитьЗаголовокРабочегоМеста = Истина;
					
				//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
				//ИначеЕсли Выборка.ПорядокЗаписей <> 3 Тогда
				ИначеЕсли Выборка.ПорядокЗаписей = 1 ИЛИ Выборка.ПорядокЗаписей = 2 Тогда
				//- СВЭЙ 05.03.19 КДЯ СВФР-003194
					Если ВыводитьЗаголовокРабочегоМеста Тогда
						ВыводитьЗаголовокРабочегоМеста = Ложь;
						ЗаполнитьЗначенияСвойств(СекцияЗаголовокРабочегоМеста.Параметры,Выборка);
						ТабДокумент.Вывести(СекцияЗаголовокРабочегоМеста);
					КонецЕсли;
					ЗаполнитьЗначенияСвойств(СекцияМесячныйЗаработок.Параметры,Выборка);
					//Аверсон 21.09.2020 КВВ СВФР-006593 (
					Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") И ДокументСсылка.ФлагОплатаПоЧасам Тогда
						
						//Аверсон 08.06.2022 КВВ СВФР-009185 (
						ДатаВыборки = Выборка.МесяцВыборки;
						Если Выборка.Сотрудник.ВидДоговора <> Перечисления.ВидыДоговоровСФизЛицами.Подряда Тогда
							З = Новый Запрос;
							З.Текст = 
							"ВЫБРАТЬ ПЕРВЫЕ 1
							|	РаботникиОрганизаций.Период КАК ДатаПриема
							|ИЗ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
							|ГДЕ
							|	РаботникиОрганизаций.Сотрудник = &Сотрудник
							|	И РаботникиОрганизаций.Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию		
							|УПОРЯДОЧИТЬ ПО
							|	Период УБЫВ";
							З.УстановитьПараметр("Сотрудник",Выборка.Сотрудник);
							ВыборкаЗ = З.Выполнить().Выбрать();
							Если ВыборкаЗ.Следующий() Тогда
								ДатаПриемаСотрудника = ВыборкаЗ.ДатаПриема;	
							КонецЕсли;
							Если НачалоМесяца(ДатаВыборки) = НачалоМесяца(ДатаПриемаСотрудника) Тогда
								ДатаВыборки = ДатаПриемаСотрудника;
							КонецЕсли;
						КонецЕсли;
						//Аверсон 08.06.2022 КВВ СВФР-009185 )
						
						//НормаПоИндивидуальному = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(Выборка.МесяцВыборки,Выборка.Сотрудник);
						НормаПоИндивидуальному = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(ДатаВыборки,Выборка.Сотрудник); //Аверсон 08.06.2022 КВВ СВФР-009185
						НормаВремениПоГрафику = 0;
						Если НЕ ЗначениеЗаполнено(НормаПоИндивидуальному.КоличествоЧасов) Тогда
							//НормаВремениПоГрафику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Выборка.МесяцВыборки,Новый Структура("Сотрудник",Выборка.Сотрудник)).ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(Выборка.МесяцВыборки),Организация);
							НормаВремениПоГрафику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ДатаВыборки,Новый Структура("Сотрудник",Выборка.Сотрудник)).ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(ДатаВыборки),Организация); //Аверсон 08.06.2022 КВВ СВФР-009185
						Иначе
							НормаВремениПоГрафику = НормаПоИндивидуальному.КоличествоЧасов;
						КонецЕсли;
						
						//Аверсон 13.06.2022 КВВ СВФР-009195 (
						ЧасовПоГруппеРасчетов = ЧасовПоГруппеРасчетовУвеличениеНормыГрафикаВОплатеПоСреднему(Выборка.Сотрудник,ДатаВыборки); 
						НормаВремениПоГрафику = НормаВремениПоГрафику + ЧасовПоГруппеРасчетов;
						//Аверсон 13.06.2022 КВВ СВФР-009195 )
						
						НормаКолвоЧасПоСр = НормаКолвоЧасПоСр + НормаВремениПоГрафику;
						СекцияМесячныйЗаработок.Параметры.НормаПоПятидневке = НормаВремениПоГрафику;
					КонецЕсли;
					//Аверсон 21.09.2020 КВВ СВФР-006593 )
					ОблВывода = ТабДокумент.Вывести(СекцияМесячныйЗаработок);
					
					//Аверсон 27.01.2022 КВВ СВФР-008638 (
					Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") И ДокументСсылка.НеСворачиватьНачисленияПриПечати Тогда
						ТабДокумент.Область(ОблВывода.Верх, ОблВывода.Лево, ОблВывода.Низ, ОблВывода.Лево).Шрифт = Новый Шрифт(,,ИСТИНА,,,);
						
						ЗапросРасшифровкаПоВР = Новый Запрос;
						ЗапросРасшифровкаПоВР.Текст = 
						"ВЫБРАТЬ 
						|РасшифровкаРасчетаСреднего.ВидРасчета КАК ВидРасчета,
						|РасшифровкаРасчетаСреднего.ВидРасчета.Наименование КАК НаимВР,
						|РасшифровкаРасчетаСреднего.Результат КАК Результат,
						|РасшифровкаРасчетаСреднего.НачисленнаяЗП КАК НачисленнаяЗП,
						|РасшифровкаРасчетаСреднего.ОтработаноДней КАК ОтработаноДней,
						|РасшифровкаРасчетаСреднего.ОтработаноЧасов КАК ОтработаноЧасов
						|ИЗ РегистрСведений.РасшифровкаРасчетаСреднего КАК РасшифровкаРасчетаСреднего
						|ГДЕ
						|РасшифровкаРасчетаСреднего.Документ = &Документ
						|И НЕ РасшифровкаРасчетаСреднего.ВидРасчета В (&ОсновныеВР) 
						|И МЕСЯЦ(РасшифровкаРасчетаСреднего.МесяцВыборки) = &МесяцВыборки";
						
						ЗапросРасшифровкаПоВР.УстановитьПараметр("Документ", ДокументСсылка);
						ЗапросРасшифровкаПоВР.УстановитьПараметр("МесяцВыборки", Месяц(Выборка.МесяцРасчетногоПериода));
						ЗапросРасшифровкаПоВР.УстановитьПараметр("ОсновныеВР",СписокОсновныеВР);

						РезЗапросРасшифровкаПоВР = ЗапросРасшифровкаПоВР.Выполнить().Выгрузить();
						Если РезЗапросРасшифровкаПоВР.Количество() > 0 Тогда
							РезЗапросРасшифровкаПоВР.Сортировать("НаимВР");
							Для Каждого СтрРезЗапросРасшифровкаПоВР ИЗ РезЗапросРасшифровкаПоВР Цикл
								ЗаполнитьЗначенияСвойств(СекцияМесячныйЗаработокПоВР.Параметры,СтрРезЗапросРасшифровкаПоВР);
								ВсегоДнРП = ?(ДокументСсылка.ФлагОплатаПоЧасам = Истина,СтрРезЗапросРасшифровкаПоВР.ОтработаноЧасов,СтрРезЗапросРасшифровкаПоВР.ОтработаноДней);
								СекцияМесячныйЗаработокПоВР.Параметры.ВсегоДнейРасчетногоПериода = ВсегоДнРП;
								
								//Аверсон 08.06.2022 КВВ СВФР-009185 (
								ДатаВыборки = Выборка.МесяцВыборки;
								Если Выборка.Сотрудник.ВидДоговора <> Перечисления.ВидыДоговоровСФизЛицами.Подряда Тогда
									З = Новый Запрос;
									З.Текст = 
									"ВЫБРАТЬ ПЕРВЫЕ 1
									|	РаботникиОрганизаций.Период КАК ДатаПриема
									|ИЗ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
									|ГДЕ
									|	РаботникиОрганизаций.Сотрудник = &Сотрудник
									|	И РаботникиОрганизаций.Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию		
									|УПОРЯДОЧИТЬ ПО
									|	Период УБЫВ";
									З.УстановитьПараметр("Сотрудник",Выборка.Сотрудник);
									ВыборкаЗ = З.Выполнить().Выбрать();
									Если ВыборкаЗ.Следующий() Тогда
										ДатаПриемаСотрудника = ВыборкаЗ.ДатаПриема;	
									КонецЕсли;
									Если НачалоМесяца(ДатаВыборки) = НачалоМесяца(ДатаПриемаСотрудника) Тогда
										ДатаВыборки = ДатаПриемаСотрудника;
									КонецЕсли;
								КонецЕсли;
								//Аверсон 08.06.2022 КВВ СВФР-009185 )
								
								НормаВремениПоГрафику = 0;
								Если ЗначениеЗаполнено(ВсегоДнРП) Тогда
									//НормаПоИндивидуальному = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(Выборка.МесяцВыборки,Выборка.Сотрудник);
									НормаПоИндивидуальному = ПрочиеПроцедуры.ПолучитьДанныеПоИндивидуальному(ДатаВыборки,Выборка.Сотрудник); //Аверсон 08.06.2022 КВВ СВФР-009185

									Если НЕ ЗначениеЗаполнено(НормаПоИндивидуальному.КоличествоЧасов) Тогда
										//НормаВремениПоГрафику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Выборка.МесяцВыборки,Новый Структура("Сотрудник",Выборка.Сотрудник)).ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(Выборка.МесяцВыборки),Организация);
										НормаВремениПоГрафику = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафику(РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ДатаВыборки,Новый Структура("Сотрудник",Выборка.Сотрудник)).ГрафикРаботы, Перечисления.ВидыУчетаВремени.ПоЧасам, НачалоМесяца(ДатаВыборки),Организация); //Аверсон 08.06.2022 КВВ СВФР-009185
									Иначе
										НормаВремениПоГрафику = НормаПоИндивидуальному.КоличествоЧасов;
									КонецЕсли;
									Если НЕ ДокументСсылка.ФлагОплатаПоЧасам Тогда //при включенном флаге, учитывалось выше //Аверсон 08.06.2022 КВВ СВФР-009185
										НормаКолвоЧасПоСр = НормаКолвоЧасПоСр + НормаВремениПоГрафику;
									КонецЕсли;
								КонецЕсли;
								
								//Аверсон 13.06.2022 КВВ СВФР-009195 (
								Если ДокументСсылка.ФлагОплатаПоЧасам Тогда
									ЧасовПоГруппеРасчетов = ЧасовПоГруппеРасчетовУвеличениеНормыГрафикаВОплатеПоСреднему(Выборка.Сотрудник,ДатаВыборки,СекцияМесячныйЗаработокПоВР.Параметры.ВидРасчета); 
									НормаВремениПоГрафику = НормаВремениПоГрафику + ЧасовПоГруппеРасчетов;
								КонецЕсли;
								//Аверсон 13.06.2022 КВВ СВФР-009195 )
								
								СекцияМесячныйЗаработокПоВР.Параметры.НормаПоПятидневке = НормаВремениПоГрафику;
								
								ТабДокумент.Вывести(СекцияМесячныйЗаработокПоВР);
							КонецЦикла;
						КонецЕсли;
					КонецЕсли;
					//Аверсон 27.01.2022 КВВ СВФР-008638 )
					
				КонецЕсли;
			КонецЦикла;
			Если ВыводитьЗаголовокРабочегоМеста Тогда
				ТабДокумент.Вывести(СекцияЗаголовокРабочегоМеста);
			КонецЕсли;
			// итоги последнего по порядку р.м.
			ЗаполнитьЗначенияСвойств(СекцияСерединаОтчета.Параметры,СтруктураИтоговПоРабочемуМесту);
			
			//Аверсон 21.09.2020 КВВ СВФР-006593 (
			Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") И ДокументСсылка.ФлагОплатаПоЧасам Тогда
				СекцияСерединаОтчета.Параметры.НормаПоПятидневке = НормаКолвоЧасПоСр;
			КонецЕсли;
			//Аверсон 21.09.2020 КВВ СВФР-006593 )

			ТабДокумент.Вывести(СекцияСерединаОтчета);
			Если ОтражатьДолюВремени Тогда
				ЗаполнитьЗначенияСвойств(СекцияДоляВремени.Параметры,СтруктураИтоговПоРабочемуМесту);
				ТабДокумент.Вывести(СекцияДоляВремени);
			КонецЕсли;
			
			// Формирование раздела по начисленным премиям
			ТабДокумент.Вывести(СекцияЗаголовокПремий);
			ВыводитьПустуюСтрокуПремии = Истина;
			Выборка = Результат.Выбрать();
			Пока Выборка.Следующий() Цикл
				Если Выборка.ТипЗаписи() = ТипЗаписиЗапроса.ДетальнаяЗапись И Выборка.ПорядокЗаписей = 3 Тогда
					ЗаполнитьЗначенияСвойств(СекцияПремии.Параметры,Выборка);
					СекцияПремии.Параметры.МесяцРасчетногоПериода = Формат(СекцияПремии.Параметры.МесяцРасчетногоПериода,"ДФ='ММММ гггг ""г.""'");
					//Аверсон 21.09.2020 КВВ СВФР-006593 (
					Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") И Выборка.РезультатДляПремии <> 0 Тогда
						СекцияПремии.Параметры.Результат = Выборка.РезультатДляПремии;
					КонецЕсли;
					//Аверсон 21.09.2020 КВВ СВФР-006593 )
					ТабДокумент.Вывести(СекцияПремии);
					ВыводитьПустуюСтрокуПремии = Ложь;
				КонецЕсли;
			КонецЦикла;
			Если ВыводитьПустуюСтрокуПремии Тогда
				СекцияПремии.Область(1,2,1,2).Текст = "";
				ТабДокумент.Вывести(СекцияПремии);
			КонецЕсли;
			
			//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
			// Формирование раздела по начисленным годовым премиям
			СекцияЗаголовокГодовыхПремий.Параметры.ВсегоУчтеноПремий = СтруктураПоказателей.ВсегоУчтеноПремий;
			ТабДокумент.Вывести(СекцияЗаголовокГодовыхПремий);
			ВыводитьПустуюСтрокуГодовойПремии = Истина;
			Выборка = Результат.Выбрать();
			Пока Выборка.Следующий() Цикл
				Если Выборка.ТипЗаписи() = ТипЗаписиЗапроса.ДетальнаяЗапись И Выборка.ПорядокЗаписей = 4 Тогда
					ЗаполнитьЗначенияСвойств(СекцияГодовойПремии.Параметры,Выборка);
					СекцияГодовойПремии.Параметры.МесяцРасчетногоПериода = Формат(СекцияГодовойПремии.Параметры.МесяцРасчетногоПериода,"ДФ='ММММ гггг ""г.""'");
					//Аверсон 21.09.2020 КВВ СВФР-006593 (
					Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") И Выборка.РезультатДляПремии <> 0 Тогда
						СекцияПремии.Параметры.Результат = Выборка.РезультатДляПремии;
					КонецЕсли;
					//Аверсон 21.09.2020 КВВ СВФР-006593 )
					ТабДокумент.Вывести(СекцияГодовойПремии);
					ВыводитьПустуюСтрокуГодовойПремии = Ложь;
				КонецЕсли;
			КонецЦикла;
			Если ВыводитьПустуюСтрокуГодовойПремии Тогда
				СекцияГодовойПремии.Область(1,2,1,2).Текст = "";
				ТабДокумент.Вывести(СекцияГодовойПремии);
			КонецЕсли;
			//- СВЭЙ 05.03.19 КДЯ СВФР-003194
			
			
			Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") и СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку Тогда
				ЗапросСуммаКомпенс = Новый Запрос;
				ЗапросСуммаКомпенс.Текст = 
				"ВЫБРАТЬ
				|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
				|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
				|	ДополнительныеНачисленияРаботниковОрганизаций.ОплаченоДнейЧасов
				|ИЗ
				|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор
				|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = &ВидРасчета";
				ЗапросСуммаКомпенс.УстановитьПараметр("Регистратор",ДокументСсылка);
				ЗапросСуммаКомпенс.УстановитьПараметр("ВидРасчета",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ВыходноеПособие);
				РезЗапрос = ЗапросСуммаКомпенс.Выполнить().Выбрать();
				Пока РезЗапрос.Следующий() Цикл 
					СекцияПодвал.Параметры.СуммаВыходногоПособия = "Сумма выходного пособия составила: "+СтруктураПоказателей.Средний+" * "+РезЗапрос.ОплаченоДнейЧасов+" = "+ РезЗапрос.Результат;
				КонецЦикла;
				//Аверсон 05.07.2019 КВВ СВФР-004495 (
			ИначеЕсли ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.РасчетПриУвольненииРаботникаОрганизаций") и НЕ СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку Тогда
				ЗапросСуммаКомпенс = Новый Запрос;
				ЗапросСуммаКомпенс.Текст = 
				"ВЫБРАТЬ
				|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
				|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
				|	ДополнительныеНачисленияРаботниковОрганизаций.ОплаченоДнейЧасов
				|ИЗ
				|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор  
				|	И (ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &ПоСреднемуКалДн ИЛИ
				|   ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &ПоСреднемуРабДн)";
				ЗапросСуммаКомпенс.УстановитьПараметр("Регистратор",ДокументСсылка);
				ЗапросСуммаКомпенс.УстановитьПараметр("ПоСреднемуКалДн", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
				ЗапросСуммаКомпенс.УстановитьПараметр("ПоСреднемуРабДн", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке);
				
				РезЗапрос = ЗапросСуммаКомпенс.Выполнить().Выбрать();
				Если РезЗапрос.Количество() > 0 Тогда
					СумОплДнЧас = 0; СумРез = 0;
					Пока РезЗапрос.Следующий() Цикл 
						СумОплДнЧас = СумОплДнЧас + РезЗапрос.ОплаченоДнейЧасов;
						СумРез = СумРез + РезЗапрос.Результат;
					КонецЦикла;
					СекцияПодвал.Параметры.СуммаКомпенсации = "Сумма компенсации составила: "+СтруктураПоказателей.Средний+" * "+СумОплДнЧас+" = "+ СумРез;
				КонецЕсли;
				//Аверсон 05.07.2019 КВВ СВФР-004495 )
			Иначе				
				ЗапросСуммаКомпенс = Новый Запрос;
				ЗапросСуммаКомпенс.Текст = 
				"ВЫБРАТЬ
				|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
				|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
				|	ДополнительныеНачисленияРаботниковОрганизаций.ОплаченоДнейЧасов
				|ИЗ
				|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор
				|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = &ВидРасчета";
				ЗапросСуммаКомпенс.УстановитьПараметр("Регистратор",ДокументСсылка);
				ЗапросСуммаКомпенс.УстановитьПараметр("ВидРасчета",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДни);
				РезЗапрос = ЗапросСуммаКомпенс.Выполнить().Выбрать();
				Пока РезЗапрос.Следующий() Цикл 
					СекцияПодвал.Параметры.СуммаКомпенсации = "Сумма компенсации составила: "+СтруктураПоказателей.Средний+" * "+РезЗапрос.ОплаченоДнейЧасов+" = "+ РезЗапрос.Результат;
				КонецЦикла;
			КонецЕсли;

			
			//Островская Татьяна 24.05.2013 № 16498
			СтруктураОтветственный = ФормированиеПечатныхФорм.ФамилияИнициалыФизЛица(ДокументСсылка.Ответственный);
			
			СекцияПодвал.Параметры.ДолжностьФИО = СтруктураОтветственный.Должность;
			СекцияПодвал.Параметры.ОтветственныйФИО = СтруктураОтветственный.ФИО;
			//Островская Татьяна 24.05.2013 № 16498
			// Итоги по расчету среднего заработка
			ЗаполнитьЗначенияСвойств(СекцияПодвал.Параметры,СтруктураПоказателей);
			//Островская Татьяна 16.11.2012 № 16000
			если не ТЧНачисления = Неопределено Тогда 
				РезультатПоКолДней = 0;
				КоличествоДней = 0;
				СтрокаДень = "";
				Для Каждого СтрНачисления из ТЧНачисления Цикл 
					РезультатПоКолДней = РезультатПоКолДней + СтрНачисления.Результат;
					КоличествоДней = КоличествоДней + СтрНачисления.ОплаченоДней;
				КонецЦикла;
				ФлагЧасы = Ложь;
				если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
					если ДокументСсылка.ФлагОплатаПоЧасам Тогда 
						КоличествоДней = ДокументСсылка.ЗначениеОплатаПоЧасам;
						ФлагЧасы = Истина;
						
						//Аверсон 29.04.2023 КВВ СВФР-010772 (
						Если КоличествоДней = 0 Тогда   
							КоличествоДней = ДокументСсылка.Начисления.Итог("ОплаченоДнейЧасов");
						КонецЕсли;
						//Аверсон 29.04.2023 КВВ СВФР-010772 )
					КонецЕсли;
				КонецЕсли;
				

				СекцияПодвал.Параметры.ИтогоПоДням = "Итого начислено за "+ КоличествоДней+" "+ СформатироватьСтроку(КоличествоДней,СтрокаДень,ФлагЧасы)+": "+ РезультатПоКолДней; 
				//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
				СекцияПодвал.Параметры.ИтогоПоДнямПрописью = 
					?( ЗначениеЗаполнено( РезультатПоКолДней ), "( " + 
					ЧислоПрописью( РезультатПоКолДней, , "рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 2" ) + " )", "" ); 
				//- СВЭЙ 05.03.19 КДЯ СВФР-003194
				
			КонецЕсли;
			//Островская Татьяна 16.11.2012 № 16000
			ТабДокумент.Вывести(СекцияПодвал);
			
		КонецЕсли;
		если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
			Если ДокументСсылка.РучнойРасчетСреднегоЗаработка Тогда 
				СекцияПодвал = Макет.ПолучитьОбласть("ПодвалРучнойРасчет");

				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	ВЫБОР
				|		КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &ДатаНачалаСобытия
				|				И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизацииЗавершения.Наименование
				|		ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации.Наименование
				|	КОНЕЦ + ""; "" + ВЫБОР
				|		КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &ДатаНачалаСобытия
				|				И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА РаботникиОрганизацийСрезПоследних.ДолжностьЗавершения.Наименование
				|		ИНАЧЕ РаботникиОрганизацийСрезПоследних.Должность.Наименование
				|	КОНЕЦ КАК РабочееМесто
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|			&ДатаНачалаСобытия,
				|			Сотрудник = &Сотрудник
				|				И Организация = &ГоловнаяОрганизация) КАК РаботникиОрганизацийСрезПоследних";
								
				Запрос.УстановитьПараметр("Регистратор", ДокументСсылка);
				Запрос.УстановитьПараметр("ГоловнаяОрганизация",	ОбщегоНазначения.ГоловнаяОрганизация(Организация));
				Запрос.УстановитьПараметр("ДатаНачалаСобытия",		ДатаСобытия);
				Запрос.УстановитьПараметр("Сотрудник",		ДокументСсылка.Сотрудник);

				
				РезультатЗапроса = Запрос.Выполнить().Выбрать();
				пока РезультатЗапроса.Следующий() Цикл 
					СекцияПодвал.Параметры.РабочееМесто = РезультатЗапроса.РабочееМесто;
				КонецЦикла;
				
				
				Если ДокументСсылка.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство Тогда 
					СекцияПодвал.Параметры.ВидЗанятости = "По внутр. совм-ву";
				иначе
					СекцияПодвал.Параметры.ВидЗанятости = "Основное рабочее место";
				КонецЕсли;
				
				
				
				
				Если ИспользоватьСреднеЧасовойЗаработок Тогда
					СекцияПодвал.Параметры.ОписаниеЗаработка = "Среднечасовой";
				Иначе
					СекцияПодвал.Параметры.ОписаниеЗаработка = "Среднедневной";
				КонецЕсли;
				
				ЗапросСуммаКомпенс = Новый Запрос;
				ЗапросСуммаКомпенс.Текст = 
				"ВЫБРАТЬ
				|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
				|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
				|	ДополнительныеНачисленияРаботниковОрганизаций.ОплаченоДнейЧасов
				|ИЗ
				|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = &Регистратор
				|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = &ВидРасчета";
				ЗапросСуммаКомпенс.УстановитьПараметр("Регистратор",ДокументСсылка);
				ЗапросСуммаКомпенс.УстановитьПараметр("ВидРасчета",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.КомпенсацияОтпускаКалендарныеДни);
				РезЗапрос = ЗапросСуммаКомпенс.Выполнить().Выбрать();
				Пока РезЗапрос.Следующий() Цикл 
					СекцияПодвал.Параметры.СуммаКомпенсации = "Сумма компенсации составила: "+СтруктураПоказателей.Средний+" * "+РезЗапрос.ОплаченоДнейЧасов+" = "+ РезЗапрос.Результат;
				КонецЦикла;
				
				СтруктураОтветственный = ФормированиеПечатныхФорм.ФамилияИнициалыФизЛица(ДокументСсылка.Ответственный);
				
				СекцияПодвал.Параметры.ДолжностьФИО = СтруктураОтветственный.Должность;
				СекцияПодвал.Параметры.ОтветственныйФИО = СтруктураОтветственный.ФИО;
				//Островская Татьяна 24.05.2013 № 16498
				// Итоги по расчету среднего заработка
				ЗаполнитьЗначенияСвойств(СекцияПодвал.Параметры,СтруктураПоказателей);
				
				если не ТЧНачисления = Неопределено Тогда 
					РезультатПоКолДней = 0;
					КоличествоДней = 0;
					СтрокаДень = "";
					Для Каждого СтрНачисления из ТЧНачисления Цикл 
						РезультатПоКолДней = РезультатПоКолДней + СтрНачисления.Результат;
						КоличествоДней = КоличествоДней + СтрНачисления.ОплаченоДней;
					КонецЦикла;
					ФлагЧасы = Ложь;
					если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ОплатаПоСреднемуЗаработку") Тогда
						если ДокументСсылка.ФлагОплатаПоЧасам Тогда 
							КоличествоДней = ДокументСсылка.ЗначениеОплатаПоЧасам;
							ФлагЧасы = Истина;
						КонецЕсли;
					КонецЕсли;
					
					СекцияПодвал.Параметры.ИтогоПоДням = "Итого начислено за "+ КоличествоДней+" "+ СформатироватьСтроку(КоличествоДней,СтрокаДень,ФлагЧасы)+": "+ РезультатПоКолДней; 
					//+ СВЭЙ 05.03.19 КДЯ СВФР-003194
					СекцияПодвал.Параметры.ИтогоПоДнямПрописью = 
						?( ЗначениеЗаполнено( РезультатПоКолДней ), "( " + 
						ЧислоПрописью( РезультатПоКолДней, , "рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 2" ) + " )", "" ); 
					//- СВЭЙ 05.03.19 КДЯ СВФР-003194
					СекцияПодвал.Параметры.Средний = ДокументСсылка.РазмерСреднегоЗаработка;
				КонецЕсли;
				//Островская Татьяна 16.11.2012 № 16000
				
				//Аверсон ЕАЕ 19.02.2025 СВФР-014648 
				Орг = ДокументСсылка.Организация;
				Если Орг.СравнениеЗПВОплатеПоСреднему Тогда
					РезультатРасчета = "Результат расчета заработной платы за часы: " + Формат(ДокументСсылка.СравнениеЗарплаты.Итог("РезультатРасчета"),"ЧДЦ=2");
				Иначе
					РезультатРасчета = "";
				КонецЕсли;
				СекцияПодвал.Параметры.РезультатРасчета = РезультатРасчета; 
				//Аверсон СВФР-014648
				
				ТабДокумент.Вывести(СекцияПодвал);

				
				
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЕсли;

	Возврат ТабДокумент;
	
КонецФункции // ПечатьРасчетаСреднегоЗаработка	

Функция СформатироватьСтроку(Сумма, ФорматСтроки,ФлагЧасы = Ложь) Экспорт
	если Число(Прав(Сумма,1)) = 0 или Число(Прав(Сумма,1)) >= 5 Тогда
		если ФлагЧасы Тогда 
			ФорматСтроки = "часов";
		иначе
			ФорматСтроки = "дней";
		КонецЕсли;
	ИначеЕсли Число(Прав(Сумма,1)) = 1 Тогда 
		если ФлагЧасы Тогда 
			ФорматСтроки = "час";
		иначе
			ФорматСтроки = "день";
		КонецЕсли;
	ИначеЕсли Число(Прав(Сумма,1)) >=2 и Число(Прав(Сумма,1)) <5 Тогда 
		если ФлагЧасы Тогда 
			ФорматСтроки = "часа";
		иначе
			ФорматСтроки = "дня";
		КонецЕсли;
	КонецЕсли;
	Возврат ФорматСтроки;
  
	
КонецФункции



// Возвращает процент северной надбавки на указаную дату
//
// Параметры:
//  ДатаРегистрации - дата регистрации записи о стаже
//  ПорядокНачисления - порядок начисления северной надбавки - ПеречислениеСсылка.ПорядокНачисленияСеверныхНадбавок
//  НачальныйПроцент - процент на дату ДатаРегистрации
//  Месяцев - количество месяцев стажа на дату ДатаРегистрации
//  Дней - количество дней стажа на дату ДатаРегистрации
//  Дата - начало периода, в котором мы получаем сведения о процентах надбавки

Функция ПолучитьПроцентСевернойНадбавкиНаДату(ДатаРегистрацииСеверногоСтажа, ПорядокНачисленияСеверныхНадбавок, НачальныйПроцентСевернойНадбавки, СеверныйСтажМесяцев, СеверныйСтажДней, ОкончаниеПериодаЗаполнения) Экспорт
	
	Массив = ПроведениеРасчетов.ПолучитьПроцентыСевернойНадбавкиЗаПериод(
					ДатаРегистрацииСеверногоСтажа, 
					ПорядокНачисленияСеверныхНадбавок, 
					НачальныйПроцентСевернойНадбавки,
					СеверныйСтажМесяцев,
					СеверныйСтажДней,
					ОкончаниеПериодаЗаполнения,
					ОкончаниеПериодаЗаполнения);
					
	Процент = Массив[Массив.Количество()-1].Процент;
					
	Возврат Процент;

КонецФункции //ПолучитьПроцентСевернойНадбавкиНаДату

// Подобрать значение сотрудника
// 
Процедура ОбработатьАвтоПодборТекста(Элемент,  Текст, ТекстАвтоПодбора, КомпоновщикНастроек, ПоляОрганизаций = Неопределено, Объект, СтандартнаяОбработка) Экспорт
	
	СписокПолеОргаинзация = Новый СписокЗначений;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("ПолеКомпоновкиДанных") тогда
		СписокПолеОргаинзация.Добавить(ПоляОрганизаций);
	КонецЕсли;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("СписокЗначений") тогда
		СписокПолеОргаинзация = ПоляОрганизаций;
	КонецЕсли;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("Массив") тогда
		СписокПолеОргаинзация.ЗагрузитьЗначения(ПоляОрганизаций);
	КонецЕсли;
	
	Организация = Неопределено;
	
	Для каждого ЭлементОтбора из КомпоновщикНастроек.Настройки.Отбор.Элементы Цикл
		
		Если СписокПолеОргаинзация.НайтиПоЗначению(ЭлементОтбора.ЛевоеЗначение) <> Неопределено И ТипЗнч(ЭлементОтбора.ПравоеЗначение) = Тип("СправочникСсылка.Организации") тогда
			
			Организация = ЭлементОтбора.ПравоеЗначение;
			Прервать;
			
		КонецЕсли;
		
	КонецЦикла;	
	
	Если Организация <> Неопределено тогда
		
		Если ТипЗнч(Элемент.Значение) = Тип("СправочникСсылка.СотрудникиОрганизаций") тогда
			
			ТекстАвтоПодбора = ПроцедурыУправленияПерсоналом.ПодобратьФИОРаботникаКандидата(СтандартнаяОбработка, "РаботникиОрганизации", Текст, Организация, , ложь);
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры //ОбработатьОкночаниеВводаТекстаВотчете()

// Подобрать значение сотрудника
// 
Процедура ОбработатьОбработатьОкончаниеВводаТекста(Элемент,  Текст, Значение, КомпоновщикНастроек, ПоляОрганизаций = Неопределено, Объект, СтандартнаяОбработка) Экспорт
	
	СписокПолеОргаинзация = Новый СписокЗначений;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("ПолеКомпоновкиДанных") тогда
		СписокПолеОргаинзация.Добавить(ПоляОрганизаций);
	КонецЕсли;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("СписокЗначений") тогда
		СписокПолеОргаинзация = ПоляОрганизаций;
	КонецЕсли;
	
	Если ТипЗнч(ПоляОрганизаций) = Тип("Массив") тогда
		СписокПолеОргаинзация.ЗагрузитьЗначения(ПоляОрганизаций);
	КонецЕсли;
	
	Организация = Неопределено;
	
	Для каждого ЭлементОтбора из КомпоновщикНастроек.Настройки.Отбор.Элементы Цикл
		
		Если СписокПолеОргаинзация.НайтиПоЗначению(ЭлементОтбора.ЛевоеЗначение) <> Неопределено И ТипЗнч(ЭлементОтбора.ПравоеЗначение) = Тип("СправочникСсылка.Организации") тогда
			
			Организация = ЭлементОтбора.ПравоеЗначение;
			Прервать;
			
		КонецЕсли;
		
	КонецЦикла;	
	
	Если Организация <> Неопределено тогда
		
		Если ТипЗнч(Элемент.Значение) = Тип("СправочникСсылка.СотрудникиОрганизаций") тогда
			
			Значение = ПроцедурыУправленияПерсоналом.ПодобратьСписокРаботниковКандидатов(СтандартнаяОбработка, "РаботникиОрганизации", Текст, Элемент.Значение, Организация, , ложь);
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры //ОбработатьОкночаниеВводаТекстаВотчете()

 
// Проверяет, умещаются ли переданные табличные документы на страницу при печати.
//
// Параметры
//  ТабДокумент        – Табличный документ
//  ВыводимыеОбласти   – Массив из проверяемых таблиц или табличный документ
//  РезультатПриОшибке - Какой возвращать результат при возникновении ошибки
//
// Возвращаемое значение:
//   Булево   – умещаются или нет переданные документы
//
Функция ПроверитьВыводТабличногоДокумента(ТабДокумент, ВыводимыеОбласти, РезультатПриОшибке = Истина) Экспорт

	Попытка
		Возврат ТабДокумент.ПроверитьВывод(ВыводимыеОбласти);
	Исключение
		Возврат РезультатПриОшибке;
	КонецПопытки;

КонецФункции // ПроверитьВыводТабличногоДокумента()


//Островская Татьяна 12.02.2013 № 16216
Функция ФамилияИнициалыФизЛица(ОбъектИлиСтрока = "", Фамилия = " ", Имя = " ", Отчество = " ") Экспорт

	ТипОбъекта = ТипЗнч(ОбъектИлиСтрока);
	Если ТипОбъекта = Тип("Строка") Тогда
		ФИО = РазложитьСтрокуВМассивПодстрок(СокрЛП(ОбъектИлиСтрока.ФизЛицо), " ");
		ФизЛицо = ФИО;
	ИначеЕсли ТипОбъекта = Тип("СправочникСсылка.ФизическиеЛица") Или ТипОбъекта = Тип("СправочникОбъект.ФизическиеЛица") Тогда 
		ФИО = РазложитьСтрокуВМассивПодстрок(СокрЛП(ОбъектИлиСтрока.Наименование), " ");
		ФизЛицо = ОбъектИлиСтрока;
	ИначеЕсли ТипОбъекта = Тип("СправочникСсылка.Пользователи") Или ТипОбъекта = Тип("СправочникОбъект.Пользователи")Тогда
		ФИО = РазложитьСтрокуВМассивПодстрок(СокрЛП(ОбъектИлиСтрока.ФизЛицо.Наименование), " ");
		ФизЛицо = ОбъектИлиСтрока.ФизЛицо;
	ИначеЕсли ТипОбъекта = Тип("СправочникСсылка.СотрудникиОрганизаций") Или ТипОбъекта = Тип("СправочникОбъект.СотрудникиОрганизаций") Тогда 
		ФИО = РазложитьСтрокуВМассивПодстрок(СокрЛП(ОбъектИлиСтрока.Наименование), " ");
		ФизЛицо = ОбъектИлиСтрока;

	Иначе
		// используем возможно переданные отдельные строки
		Возврат ?(Не ПустаяСтрока(Фамилия), 
		          Фамилия + ?(Не ПустаяСтрока(Имя), " " + Лев(Имя,1) + "." + ?(Не ПустаяСтрока(Отчество), Лев(Отчество,1) + ".", ""), ""),
		          "")
	КонецЕсли;
	
	КоличествоПодстрок = ФИО.Количество();
	Фамилия            = ?(КоличествоПодстрок > 0, ФИО[0], "");
	Имя                = ?(КоличествоПодстрок > 1, ФИО[1], "");
	Отчество           = ?(КоличествоПодстрок > 2, ФИО[2], "");
	ЗапросДолжность = Новый Запрос;
	ЗапросДолжность.Текст = 
	"ВЫБРАТЬ
	|	РаботникиОрганизацийСрезПоследних.Должность,
	|	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций.СрезПоследних КАК РаботникиОрганизацийСрезПоследних
	|ГДЕ
	|	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо = &Физлицо";
	ЗапросДолжность.УстановитьПараметр("Физлицо",ФизЛицо);
	РезДолжность = ЗапросДолжность.Выполнить().Выбрать();
	Должность = "";
	Если РезДолжность.Следующий() Тогда 
		Должность = РезДолжность.Должность;
		
	КонецЕсли;
	МассивСтуктура = Новый Структура("ФИО, Должность");

	МассивСтуктура.Вставить("ФИО",?(Не ПустаяСтрока(Фамилия),?(Не ПустаяСтрока(Имя), " " + Лев(Имя,1) + "." + ?(Не ПустаяСтрока(Отчество), Лев(Отчество, 1) + ".", ""), "") + " "+ Фамилия, ""));
	МассивСтуктура.Вставить("Должность",Должность);	
	Возврат МассивСтуктура;
	
КонецФункции
//Островская Татьяна 12.02.2013 № 16216
//Островская Татьяна 12.02.2013 № 16216
Функция РазложитьСтрокуВМассивПодстрок(Знач Строка, Знач Разделитель = ",", Знач ПропускатьПустыеСтроки = Неопределено) Экспорт
	
	Результат = Новый Массив;
	
	// для обеспечения обратной совместимости
	Если ПропускатьПустыеСтроки = Неопределено Тогда
		ПропускатьПустыеСтроки = ?(Разделитель = " ", Истина, Ложь);
		Если ПустаяСтрока(Строка) Тогда 
			Если Разделитель = " " Тогда
				Результат.Добавить("");
			КонецЕсли;
			Возврат Результат;
		КонецЕсли;
	КонецЕсли;
	//
	
	Позиция = Найти(Строка, Разделитель);
	Пока Позиция > 0 Цикл
		Подстрока = Лев(Строка, Позиция - 1);
		Если Не ПропускатьПустыеСтроки Или Не ПустаяСтрока(Подстрока) Тогда
			Результат.Добавить(Подстрока);
		КонецЕсли;
		Строка = Сред(Строка, Позиция + СтрДлина(Разделитель));
		Позиция = Найти(Строка, Разделитель);
	КонецЦикла;
	
	Если Не ПропускатьПустыеСтроки Или Не ПустаяСтрока(Строка) Тогда
		Результат.Добавить(Строка);
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции 
//Островская Татьяна 12.02.2013 № 16216

Функция ОтветственныеЛицаОрганизации (Организация) Экспорт 
	Запрос = Новый Запрос;
	Запрос.Текст = 
	 "ВЫБРАТЬ
	 |	ОрганизацииОтветственныеЛица.ОтветственноеЛицо,
	 |	ОрганизацииОтветственныеЛица.Сотрудник,
	 |	ОрганизацииОтветственныеЛица.Должность
	 |ИЗ
	 |	Справочник.Организации.ОтветственныеЛица КАК ОрганизацииОтветственныеЛица
	 |ГДЕ
	 |	ОрганизацииОтветственныеЛица.Ссылка = &Ссылка";
	 Запрос.УстановитьПараметр("Ссылка", Организация);
	 РезЗапрос = Запрос.Выполнить().Выгрузить();
	 Возврат РезЗапрос;
КонецФункции
