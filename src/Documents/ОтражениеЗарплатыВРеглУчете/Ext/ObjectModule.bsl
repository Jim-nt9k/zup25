////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ

// при изменении структуры результата запроса необходимо корректировать эти номера
// стартовый номер для субконто дебета - позволяет адресоваться в строке из данных бухучета
// к конкретному субконто по его номеру 
Перем НомерДт;

// стартовый номер для субконто кредита - позволяет адресоваться в строке из данных бухучета
// к конкретному субконто по его номеру 
Перем НомерКт;

// номера субконто для счета РасчетыПоИсполнительнымДокументамРаботников, который обрабатывается специальным образом
Перем мНомерСубконтоКонтрагентыКт;
Перем мНомерСубконтоИсполнДокументыКт;

//Налоговый режим организации
Перем мУСН;
Перем мОбъектНалогообложенияУСН;
Перем мЕНВД;
Перем мФСС_БЛ;

Перем мДлинаСуток;

Перем мТаблицаОшибок;

Перем ТЗПовременки, РезЗРаспр, ТЗДанныеУчета, ТЗПостНачССчетомИНомГруппой; //Аверсон 08.07.2023 КВВ СВФР-010889

////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

// Процедура осуществляет печать документа. Можно направить печать на 
// экран или принтер, а также распечатать необходмое количество копий.
//
//	Название макета печати передается в качестве параметра,
//	по переданному названию находим имя макета в соответствии.
//
// Параметры:
//	НазваниеМакета	- строка, название макета.
//
Функция Печать(ИмяМакета, КоличествоЭкземпляров = 1, НаПринтер = Ложь) Экспорт
	
	// Получить экземпляр документа на печать
	ИмяФормы = "";
	Если ИмяМакета = "РаспределениеЗарплаты" Тогда
		ИмяФормы = " (Распределение зарплаты)";
		ТабДокумент = ПечатьРаспределениеЗарплаты();
		
	ИначеЕсли ИмяМакета = "ВедомостьУдержаний" Тогда
		ИмяФормы = " (Ведомость удержаний)";
		ТабДокумент = ПечатьВедомостьУдержаний();
		
	ИначеЕсли ИмяМакета = "КнигаХозяйственныхОпераций" Тогда
		ИмяФормы = " (Книга хозяйственных операций)";
		ТабДокумент = ПечатьКнигаХозяйственныхОпераций(0);
		
	ИначеЕсли ИмяМакета = "КнигаХозяйственныхОперацийПодробно" Тогда
		ИмяФормы = " (Книга хозяйственных операций (подробно))";
		ТабДокумент = ПечатьКнигаХозяйственныхОпераций(1);
		//Островская Татьяна 02.10.2013 № 16828
	ИначеЕсли ИмяМакета = "Макет" Тогда
		//ИмяФормы = " (Ведомость удержаний111)";
		ИмяФормы = " (Расшифровка ФСЗН и БГС из Расчет взносов с ФОТ)"; //Аверсон 13.08.2020 КВВ СВФР-006325
		ТабДокумент = ПечатьПроверка();	
		//Островская Татьяна 02.10.2013 № 16828	
		//Аверсон 26.08.2020 КВВ СВФР-006325 (
	ИначеЕсли ИмяМакета = "Макет1" Тогда
		ИмяФормы = " (Расшифровка ФСЗН и БГС из 4-ой закладки)"; 
		ТабДокумент = ПечатьРасшФСЗНБГС();	
		//Аверсон 26.08.2020 КВВ СВФР-006325 )
		
		//Аверсон 04.07.2023 КВВ СВФР-010889 (
	ИначеЕсли ИмяМакета = "ВедомостьРаспределенияФОТПоСчетам_Виток" Тогда
		ИмяФормы = "Ведомость распределения ФОТ по счетам";
		ТабДокумент = ПечатьВедомостиФОТВиток();
		//Аверсон 04.07.2023 КВВ СВФР-010889 )
		
		//Аверсон 11.07.2023 КВВ СВФР-010889 (
	ИначеЕсли ИмяМакета = "ВедомостьРаспределенияФОТПоСчетам_Виток_Расш" Тогда
		ИмяФормы = "Ведомость распределения ФОТ по счетам (расшифровка)";
		ТабДокумент = ПечатьВедомостиФОТВиток(Истина);
		//Аверсон 11.07.2023 КВВ СВФР-010889 )
		
	КонецЕсли;
	
	Возврат РаботаСДиалогами.НапечататьДокумент(ТабДокумент, КоличествоЭкземпляров, НаПринтер, РаботаСДиалогами.СформироватьЗаголовокДокумента(ЭтотОбъект,Метаданные().Синоним + ИмяФормы));
	
КонецФункции // Печать()

Функция ПроверкаФизлицоНаИнвалидность(ФизЛицо)
	Запрос = Новый Запрос;
	
	ТекстЗапроса = "ВЫБРАТЬ
	|	СведенияОбИнвалидностиФизлицСрезПоследних.Период,
	|	СведенияОбИнвалидностиФизлицСрезПоследних.Физлицо,
	|	СведенияОбИнвалидностиФизлицСрезПоследних.Инвалидность,
	|	СведенияОбИнвалидностиФизлицСрезПоследних.СерияСправки,
	|	СведенияОбИнвалидностиФизлицСрезПоследних.ДатаВыдачи,
	|	ВЫБОР
	|		КОГДА СведенияОбИнвалидностиФизлицСрезПоследних.ГруппаИнвалидности = &парамГруппа1
	|				ИЛИ СведенияОбИнвалидностиФизлицСрезПоследних.ГруппаИнвалидности = &парамГруппа2
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Группа,
	|	СведенияОбИнвалидностиФизлицСрезПоследних.СрокДействияСправки
	|ИЗ
	|	РегистрСведений.СведенияОбИнвалидностиФизлиц.СрезПоследних(&Период, ) КАК СведенияОбИнвалидностиФизлицСрезПоследних
	|ГДЕ
	|	СведенияОбИнвалидностиФизлицСрезПоследних.Инвалидность
	|	И СведенияОбИнвалидностиФизлицСрезПоследних.Физлицо = &Физлицо";
	
	Запрос.УстановитьПараметр("парамГруппа1","I");
	Запрос.УстановитьПараметр("парамГруппа2","II");
	Запрос.УстановитьПараметр("Период",КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("Физлицо",Физлицо);
	
	Запрос.Текст = ТекстЗапроса;
	
	Возврат  Запрос.Выполнить();
	
КонецФункции

Процедура Автозаполнение(ТочностьРасчетов = 2) Экспорт //Аверсон ЕАЕ 17.06.2020 СВФР-006057 (добавлен параметр ТочностьРасчетов)
	
	мТаблицаОшибок = Новый ТаблицаЗначений;
	мТаблицаОшибок.Колонки.Добавить("Сотрудник");
	мТаблицаОшибок.Колонки.Добавить("ВидРасчета");
	мТаблицаОшибок.Колонки.Добавить("ПериодДействияНачало");
	мТаблицаОшибок.Колонки.Добавить("ПериодДействияКонец");
	мТаблицаОшибок.Колонки.Добавить("ДоляЕНВДПоБазе");
	мТаблицаОшибок.Колонки.Добавить("ДоляРаботодателяПоБазе");
	
	
	НаборЗаписейОсновной = РегистрыРасчета.БУОсновныеНачисления.СоздатьНаборЗаписей();
	НаборЗаписейОсновной.Отбор.Регистратор.Значение = Ссылка;
	
	НаборЗаписейДополнительный = РегистрыРасчета.БУДополнительныеНачисления.СоздатьНаборЗаписей();
	НаборЗаписейДополнительный.Отбор.Регистратор.Значение = Ссылка;
	
	// сначала очищаем соответствующие движения
	Для Каждого Набор Из Движения Цикл
		Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.БУОсновныеНачисления") Тогда
			НаборЗаписейОсновной.Записать();
		КонецЕсли;
		Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.БУДополнительныеНачисления") Тогда
			НаборЗаписейДополнительный.Записать();
		КонецЕсли;
	КонецЦикла;
	
	// определим налоговый режим
	БухгалтерскийИНалоговыйУчет.ОбновитьДанныеУчетнойПолитикиПоНалоговомуУчету(глЗначениеПеременной("глУчетнаяПолитикаПоНалоговомуУчету"), КонецМесяца(ПериодРегистрации), Организация);
	УчетнаяПолитика = глЗначениеПеременной("глУчетнаяПолитикаПоНалоговомуУчету")[КонецМесяца(ПериодРегистрации)][Организация];
	мУСН = УчетнаяПолитика.УСН;
	мОбъектНалогообложенияУСН = УчетнаяПолитика.ОбъектНалогообложенияУСН;
	мЕНВД = УчетнаяПолитика.ОрганизацияЯвляетсяПлательщикомЕНВД;
	мФСС_БЛ = УчетнаяПолитика.УплачиватьДобровольныеВзносыВФСС;
	
	// запрос по соответсвиям статей затрат начислений и статей затарт для 
	// отражения б/л за счет работодателя
	ДополнительныеСтатьиЗатратЗапрос = Новый Запрос(
	"ВЫБРАТЬ
	|   СоответствиеСтатейЗатратОтраженияЗарплатыВРеглУчете.ВидСтатьиЗатрат,
	|   СоответствиеСтатейЗатратОтраженияЗарплатыВРеглУчете.СтатьяЗатратНачисления,
	|   СоответствиеСтатейЗатратОтраженияЗарплатыВРеглУчете.СтатьяЗатрат
	|ИЗ
	|   РегистрСведений.СоответствиеСтатейЗатратОтраженияЗарплатыВРеглУчете КАК СоответствиеСтатейЗатратОтраженияЗарплатыВРеглУчете
	|ГДЕ
	|   СоответствиеСтатейЗатратОтраженияЗарплатыВРеглУчете.ВидСтатьиЗатрат = &ПособияЗаСчетРаботодателя");
	
	ДополнительныеСтатьиЗатратЗапрос.УстановитьПараметр("ДатаЗапроса", ПериодРегистрации);
	ДополнительныеСтатьиЗатратЗапрос.УстановитьПараметр("ПособияЗаСчетРаботодателя", Перечисления.ВидыДополнительныхСтатейЗатрат.ПособияЗаСчетРаботодателя);
	ДополнительныеСтатьиЗатрат = ДополнительныеСтатьиЗатратЗапрос.Выполнить().Выгрузить();
	
	ПараметрыПолученияСубконто = Новый Соответствие;
	ПараметрыПолученияСубконто[Тип("СправочникСсылка.СтатьиЗатрат")] = Новый Структура("ВидСтатьиЗатрат, ДополнительныеСтатьиЗатрат", 
	Перечисления.ВидыДополнительныхСтатейЗатрат.ПособияЗаСчетРаботодателя, 
	ДополнительныеСтатьиЗатрат);
	
	
	ТаблицаНачислений = ПолучитьТаблицуНачислений();
	
	СтруктураПоиска = Новый Структура;
	СписокНачисленийДляОтбора = Новый СписокЗначений;
	
	Успешно = Истина;
	
	//Аверсон ЕАЕ 16.06.2020 СВФР-006057
	//(20) этот запрос вынесен из цикла
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.БезУчетаКодаВР, //Аверсон 31.07.2023 КВВ СВФР-010889
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
	|ИЗ
	|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
	|ГДЕ
	|	НачалоПериода(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц) = &ПериодРегистрации
	//|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник
	|";
	
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	//Запрос.УстановитьПараметр("ВидРасчетаСпособОтраженияВБухучете",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете);
	//
	//Запрос.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДт1",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1);
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДт2",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2);
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДт3",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3);
	//
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДтНУ1",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1);
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДтНУ2",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2);
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДтНУ3",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3);
	//
	//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1",СпособПоУмолчанию.СубконтоДт1);
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2",СпособПоУмолчанию.СубконтоДт2);
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3",СпособПоУмолчанию.СубконтоДт3);
	//
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1",СпособПоУмолчанию.СубконтоДтНУ1);
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2",СпособПоУмолчанию.СубконтоДтНУ2);
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3",СпособПоУмолчанию.СубконтоДтНУ3);
	//
	//Запрос.УстановитьПараметр("ВидРасчета",ДанныеУчета.ВидРасчета);
	//
	//Запрос.УстановитьПараметр("ПодразделениеОрганизации",ДанныеУчета.ПодразделениеОрганизации);
	//Запрос.УстановитьПараметр("Сотрудник", ДанныеУчета.Сотрудник);
	
	ТЗДанныеУчета = Запрос.Выполнить().Выгрузить();
	//!!!
	//Аверсон
	
	//Аверсон 02.08.2023 КВВ СВФР-010889 (
	Если Организация.ИНН = "100194961" Тогда
		ЗПостНачССчетомИНомГруппой = Новый Запрос;
		ЗПостНачССчетомИНомГруппой.Текст = "ВЫБРАТЬ
		|НачисленияРаботниковОрганизации.Сотрудник,
		|НачисленияРаботниковОрганизации.ВидРасчета,
		|НачисленияРаботниковОрганизации.СчетВОтражение КАК Счет,
		|НачисленияРаботниковОрганизации.НомГруппаВОтражение КАК НомГруппа,
		|НачисленияРаботниковОрганизации.ПодразделениеВОтражение КАК Подразделение
		|ИЗ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(&парамНачало,
		|ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)) КАК НачисленияРаботниковОрганизации
		|ГДЕ
		|ВЫБОР
		|КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
		|И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
		|ИНАЧЕ НачисленияРаботниковОрганизации.Действие
		|КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|И (НачисленияРаботниковОрганизации.СчетВОтражение <> ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)
		|ИЛИ НачисленияРаботниковОрганизации.НомГруппаВОтражение <> ЗНАЧЕНИЕ(Справочник.НоменклатурныеГруппы.ПустаяСсылка))";
		ЗПостНачССчетомИНомГруппой.УстановитьПараметр("парамНачало", ПериодРегистрации);
		ТЗПостНачССчетомИНомГруппой = ЗПостНачССчетомИНомГруппой.Выполнить().Выгрузить();
	КонецЕсли;
	//Аверсон 02.08.2023 КВВ СВФР-010889 )
	
	Для Счетчик = 0 По 3 Цикл
		
		СписокНачисленийДляОтбора.Очистить();
		
		СтруктураПоиска.Вставить("ПорядокРасчета", Счетчик);
		
		//основные начисления
		СтруктураПоиска.Вставить("ВидНачисления", "Основные");
		СтрокиТаблицы = ТаблицаНачислений.НайтиСтроки(СтруктураПоиска);
		Для каждого Строка Из СтрокиТаблицы Цикл
			СписокНачисленийДляОтбора.Добавить(Строка.ВидРасчета);
		КонецЦикла;
		Если СписокНачисленийДляОтбора.Количество() > 0 Тогда
			//получим и обработаем данные учета
			ДанныеУчета = ПолучитьДанныеУчета(СписокНачисленийДляОтбора, Истина, ?(Счетчик = 0, Истина, Ложь));
			
			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
			//ОбработатьДанныеУчета(ДанныеУчета, Успешно, НаборЗаписейОсновной, ПараметрыПолученияСубконто);
			ОбработатьДанныеУчета(ДанныеУчета, Успешно, НаборЗаписейОсновной, ПараметрыПолученияСубконто, ТЗДанныеУчета, ТочностьРасчетов);
			//Аверсон
		КонецЕсли;
		
		//дополнительные начисления
		СписокНачисленийДляОтбора.Очистить();
		СтруктураПоиска.Вставить("ВидНачисления", "Дополнительные");
		СтрокиТаблицы = ТаблицаНачислений.НайтиСтроки(СтруктураПоиска);
		Для каждого Строка Из СтрокиТаблицы Цикл
			СписокНачисленийДляОтбора.Добавить(Строка.ВидРасчета);
		КонецЦикла;
		Если СписокНачисленийДляОтбора.Количество() > 0 Тогда
			//получим и обработаем данные учета
			ДанныеУчета = ПолучитьДанныеУчета(СписокНачисленийДляОтбора, Ложь, ?(Счетчик = 0, Истина, Ложь));
			
			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
			//ОбработатьДанныеУчета(ДанныеУчета, Успешно, НаборЗаписейДополнительный, ПараметрыПолученияСубконто);
			ОбработатьДанныеУчета(ДанныеУчета, Успешно, НаборЗаписейДополнительный, ПараметрыПолученияСубконто, ТЗДанныеУчета, ТочностьРасчетов);
			//Аверсон
		КонецЕсли;
		
	КонецЦикла;	
	
	НаборЗаписейОсновной.Прочитать();
	
	ВременнаяТаблица = НаборЗаписейОсновной.Выгрузить();
	ВременнаяТаблица.Свернуть("ВидРасчета,Сотрудник,ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетКт,СубконтоКт1,СубконтоКт2, СубконтоКт3,
	|СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,СчетКтНУ,СубконтоКтНУ1,СубконтоКтНУ2,СубконтоКтНУ3,
	|ПериодДействияНачало,ПериодДействияКонец","Результат");
	ОсновныеНачисления.Загрузить(ВременнаяТаблица);
	
	НаборЗаписейДополнительный.Прочитать();
	
	ВременнаяТаблица = НаборЗаписейДополнительный.Выгрузить();
	ВременнаяТаблица.Свернуть("ВидРасчета,Сотрудник,ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетКт,СубконтоКт1,СубконтоКт2, СубконтоКт3,
	
	//Аверсон ЕАЕ 22.06.2022 СВФР-009233
	//|СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,СчетКтНУ,СубконтоКтНУ1,СубконтоКтНУ2,СубконтоКтНУ3","Результат");
	|СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,СчетКтНУ,СубконтоКтНУ1,СубконтоКтНУ2,СубконтоКтНУ3,БазовыйПериодНачало,БазовыйПериодКонец","Результат");
	//Аверсон СВФР-009233
	
	ДополнительныеНачисления.Загрузить(ВременнаяТаблица);
	//ПСА 21-12-2020 СВФР-006967 +++
	Для Каждого СтрокаТч Из ДополнительныеНачисления Цикл
		Если СтрокаТЧ.ВидРасчета.ПрочееОтражениеКтЗатратногоСчета Тогда
			СчетЗамены = СтрокаТЧ.ВидРасчета.ЗатратныйСчет;
			Если ЗначениеЗаполнено(СчетЗамены) Тогда
				СтрокаТЧ.СчетКт = СчетЗамены;
			КонецЕсли;	
		КонецЕсли;	
	КонецЦикла;	
	//+++ПСА 21-12-2020 СВФР-006967
	
	// очистим движения
	Для Каждого Набор Из Движения Цикл
		Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.БУОсновныеНачисления") 
			или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.БУДополнительныеНачисления") Тогда
			Набор.Очистить();
			Набор.Записать();
		КонецЕсли;
	КонецЦикла;
	
	Если НЕ Успешно Тогда
		// есть ошибки в сборе данных по отражению начислений
		
		ТекстСообщения = "Для автоматического учета начислений при формировании проводок не хватает данных!";
		РодительскаяСтрока = ОбщегоНазначения.КомментарийРасчета(ТекстСообщения);
		
		Если мТаблицаОшибок.Количество() > 0 Тогда
			// сообщим пользователю об ошибках
			// таблица ошибок собирается только по пособиям
			
			СтруктураПоискаОсновныеНачисиления = Новый Структура("Сотрудник,ВидРасчета,ПериодДействияНачало,ПериодДействияКонец,СчетДт");
			СтруктураПоискаДополнительныеНачисиления = Новый Структура("Сотрудник,ВидРасчета,СчетДт");
			
			мТаблицаОшибок.Сортировать("ВидРасчета, ДоляЕНВДПоБазе, ДоляРаботодателяПоБазе");
			ТекущийВР = Неопределено;
			ДоляЕНВДПоБазе = Неопределено;
			ДоляРаботодателяПоБазе =  Неопределено;
			
			Для каждого СтрокаТаблицыОшибок Из мТаблицаОшибок Цикл
				ВР = СтрокаТаблицыОшибок.ВидРасчета;
				
				Если ЗначениеЗаполнено(СтрокаТаблицыОшибок.ПериодДействияНачало) Тогда
					СтруктураПоискаОсновныеНачисиления.Сотрудник  = СтрокаТаблицыОшибок.Сотрудник;	
					СтруктураПоискаОсновныеНачисиления.ВидРасчета = СтрокаТаблицыОшибок.ВидРасчета;
					СтруктураПоискаОсновныеНачисиления.ПериодДействияНачало = СтрокаТаблицыОшибок.ПериодДействияНачало;
					СтруктураПоискаОсновныеНачисиления.ПериодДействияКонец  = НачалоДня(СтрокаТаблицыОшибок.ПериодДействияКонец);
					СтруктураПоискаОсновныеНачисиления.СчетДт  = ПланыСчетов.Хозрасчетный.ПустаяСсылка();
					НайденныеСтроки = ОсновныеНачисления.НайтиСтроки(СтруктураПоискаОсновныеНачисиления);
					ТекстСообщения = "Основные начисления, ";
				Иначе
					СтруктураПоискаДополнительныеНачисиления.Сотрудник  = СтрокаТаблицыОшибок.Сотрудник;	
					СтруктураПоискаДополнительныеНачисиления.ВидРасчета = СтрокаТаблицыОшибок.ВидРасчета;
					СтруктураПоискаДополнительныеНачисиления.СчетДт  = ПланыСчетов.Хозрасчетный.ПустаяСсылка();
					НайденныеСтроки = ДополнительныеНачисления.НайтиСтроки(СтруктураПоискаДополнительныеНачисиления);
					ТекстСообщения = "Дополнительные начисления, ";
				КонецЕсли;
				
				Для каждого СтрокаТЧ Из НайденныеСтроки Цикл
					ТекстСообщенияПоСтроке = ТекстСообщения + "строка номер: " + СтрокаТЧ.НомерСтроки;
					ОбщегоНазначения.КомментарийРасчета(ТекстСообщенияПоСтроке, РодительскаяСтрока);
				КонецЦикла;
				
			КонецЦикла;
		КонецЕсли;	
		
		Возврат;
		
	КонецЕсли;
	
	АвтозаполнениеПроводок(ТочностьРасчетов);
	
КонецПроцедуры //  Автозаполнение

// + СВЭЙ КДЯ 31.05.19 СВФР-004379
Процедура ОчиститьСубконтоНУБезСчетов( ПромежуточнаяТаблица )
	Для каждого Стр Из ПромежуточнаяТаблица Цикл
		
		Если НЕ ЗначениеЗаполнено( Стр.СчетДтНУ )  Тогда
			
			Стр.СубконтоДтНУ1 = Неопределено;		
			Стр.СубконтоДтНУ2 = Неопределено;		
			Стр.СубконтоДтНУ3 = Неопределено;		
			
		КонецЕсли; 	
		
		Если НЕ ЗначениеЗаполнено( Стр.СчетКтНУ )  Тогда
			
			Стр.СубконтоКтНУ1 = Неопределено;		
			Стр.СубконтоКтНУ2 = Неопределено;		
			Стр.СубконтоКтНУ3 = Неопределено;		
			
		КонецЕсли; 	
		
	КонецЦикла; 		
КонецПроцедуры // ОчиститьСубконтоНУБезСчетов

Функция ЭтоУточнениеНабораСубконто( ИсходныйНаборСубконто, УточняющийНаборСубконто ) Экспорт
	Перем ЗначениеФункции, ПриоритетИсходногоНабораСубконто, ПриоритетУточняющегоНабораСубконто;
	
	ПриоритетИсходногоНабораСубконто = 
	?( ЗначениеЗаполнено( ИсходныйНаборСубконто.Субконто1 ), 100, 0 )
	+ ?( ЗначениеЗаполнено( ИсходныйНаборСубконто.Субконто2 ), 10, 0 )
	+ ?( ЗначениеЗаполнено( ИсходныйНаборСубконто.Субконто3 ),  1, 0 );
	
	ПриоритетУточняющегоНабораСубконто = 
	?( ЗначениеЗаполнено( УточняющийНаборСубконто.СубконтоДт1 ), 100, 0 )
	+ ?( ЗначениеЗаполнено( УточняющийНаборСубконто.СубконтоДт2 ), 10, 0 )
	+ ?( ЗначениеЗаполнено( УточняющийНаборСубконто.СубконтоДт3 ),  1, 0 );
	
	
	Если ПриоритетУточняющегоНабораСубконто > ПриоритетИсходногоНабораСубконто Тогда
		ЗначениеФункции = Истина;
	Иначе
		ЗначениеФункции = Ложь;
	КонецЕсли;
	
	Возврат ЗначениеФункции;
КонецФункции // ЭтоУточнениеНабораСубконто()
// - СВЭЙ КДЯ 31.05.19 СВФР-004379


Процедура АвтозаполнениеПроводок(ТочностьРасчетов = 2) Экспорт  //Аверсон ЕАЕ 17.06.2020 СВФР-006057 (добавлен параметр ТочностьРасчетов)   
	УчетнаяПолитикаПерсонал = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация", Ссылка.Организация));
	Если УчетнаяПолитикаПерсонал = Неопределено тогда
		Сообщить("Не определена учетная политика по персоналу");
		Возврат;
	КонецЕсли;
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Резервы.Наименование,
	|	Резервы.Ссылка
	|ИЗ
	|	Справочник.Резервы КАК Резервы";
	
	РезультатЗапросаРезурв = Запрос.Выполнить().Выбрать();
	Пока РезультатЗапросаРезурв.Следующий() Цикл
		Если Найти(РезультатЗапросаРезурв.Наименование,"БГС")> 0 Тогда 
			СубконтоРезервБГС = РезультатЗапросаРезурв.Ссылка;
		ИначеЕсли Найти(РезультатЗапросаРезурв.Наименование,"ФСЗН")> 0 Тогда 
			СубконтоРезервФСЗН = РезультатЗапросаРезурв.Ссылка;
		КонецЕсли;			
	КонецЦикла;
	// ПСА 21.09.2020 СВФР-006587 ++
	ОрганизацияИНН = Организация.ИНН;
	//+ СВЭЙ КДЯ 31.05.19 СВФР-004379
	ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
	СчетКтБГС =  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
	Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетБУ;
	//- СВЭЙ КДЯ 31.05.19 СВФР-004379
	
	//+ СВЭЙ КДЯ 06.06.19 СВФР-004427
	СчетКтФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
	Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;
	//- СВЭЙ КДЯ 06.06.19 СВФР-004427
	
	
	//О.Т. Аверсон 11.11.2016 № 16
	ЗапросУчПолитика = Новый Запрос;
	ЗапросУчПолитика.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтражениеЗарплатыПоВидамРасчета
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
	ЗапросУчПолитика.УстановитьПараметр("Организация",Организация);
	РезУчПолитика = ЗапросУчПолитика.Выполнить().Выбрать();
	ОтражениеПоВидамРасчета = Ложь;
	пока  РезУчПолитика.Следующий() цикл
		ОтражениеПоВидамРасчета = РезУчПолитика.ОтражениеЗарплатыПоВидамРасчета; 		
	КонецЦикла;
	//О.Т. Аверсон 11.11.2016 № 16
	
	ОтражениеВУчете.Очистить();
	
	Записать(); // запишем документ
	ВыборкаПоДоходам = СформироватьЗапросПоДоходам().Выбрать();
	
	// определим налоговый режим
	БухгалтерскийИНалоговыйУчет.ОбновитьДанныеУчетнойПолитикиПоНалоговомуУчету(глЗначениеПеременной("глУчетнаяПолитикаПоНалоговомуУчету"), КонецМесяца(ПериодРегистрации), Организация);
	УчетнаяПолитика = глЗначениеПеременной("глУчетнаяПолитикаПоНалоговомуУчету")[КонецМесяца(ПериодРегистрации)][Организация];
	мОбъектНалогообложенияУСН = УчетнаяПолитика.ОбъектНалогообложенияУСН;
	мУСН = УчетнаяПолитика.УСН;
	
	// запишем движения по текущему состоянию табличной части с начислениями
	// как при проведении
	НаборЗаписейОсновной = РегистрыРасчета.БУОсновныеНачисления.СоздатьНаборЗаписей();
	НаборЗаписейОсновной.Отбор.Регистратор.Значение = Ссылка;
	
	НаборЗаписейДополнительный = РегистрыРасчета.БУДополнительныеНачисления.СоздатьНаборЗаписей();
	НаборЗаписейДополнительный.Отбор.Регистратор.Значение = Ссылка;
	
	ПлохиеДанные = Ложь;
	
	Пока ВыборкаПоДоходам.Следующий() Цикл
		ПроверитьЗаполнениеСтрокиДохода(ВыборкаПоДоходам, ПлохиеДанные, Не мУСН);
		ДобавитьСтрокуВДвиженияПоДоходам(ВыборкаПоДоходам, НаборЗаписейОсновной, НаборЗаписейДополнительный);
	КонецЦикла;
	
	Если ПлохиеДанные Тогда
		Возврат;
	КонецЕсли;
	
	Для Каждого Набор Из Движения Цикл
		Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.БУОсновныеНачисления") Тогда
			НаборЗаписейОсновной.Записать();
		КонецЕсли;
		Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.БУДополнительныеНачисления") Тогда
			НаборЗаписейДополнительный.Записать();
		КонецЕсли;
	КонецЦикла;
	
	ГоловнаяОрганизация = ОбщегоНазначения.ГоловнаяОрганизация(Организация);
	
	// фактически - создаем структуру промежуточной таблицы
	ПромежуточнаяТаблица = ОтражениеВУчете.Выгрузить();
	//+ СВЭЙ КДЯ 31.05.19 СВФР-004379
	ПромежуточнаяТаблица.Колонки.Добавить( "ФизЛицо" );
	//- СВЭЙ КДЯ 31.05.19 СВФР-004379
	ПромежуточнаяТаблица.Колонки.Добавить( "СуммаДолиРаспред" ); //Аверсон 10.09.2020 КВВ СВФР-006325
	
	// готовим список счетов
	
	//Островская Татьяна 02.10.2013 № 16828
	ТекстыЗапросовФСЗН = ПолучитьЗапросДляФСЗН();
	//Островская Татьяна 02.10.2013 № 16828
	
	
	Запрос = Новый Запрос(ТекстыЗапросовФСЗН.ОтраженоЕСНИсчисленногоТекст); //Островская Татьяна 02.10.2013 № 16828
	
	//Выберем счета из регисьра сведений СтавкиОтчисленийСФОТиЗП
	
	СписокСчетовУчетаЕСН = Новый СписокЗначений;
	СписокСчетовУчетаЕСН.Добавить(РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	Новый Структура("Организация,ВидОтчисления", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).СчетБУ);//О.Т. Аверсон 25.03.2016 № 950
	
	СписокСчетовУчетаЕСН.Добавить(РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	Новый Структура("Организация,ВидОтчисления", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж)).СчетБУ);//О.Т. Аверсон 25.03.2016 № 950
	
	СписокСчетовУчетаЕСН.Добавить(РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	Новый Структура("Организация,ВидОтчисления", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд)).СчетБУ); //О.Т. Аверсон 25.03.2016 № 950
	
	СписокСчетовУчетаЕСН.Добавить(РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
	Новый Структура("Организация", Организация)).СчетБУ);
	
	Запрос.УстановитьПараметр("парамСписокСчетовКт", СписокСчетовУчетаЕСН);
	Запрос.УстановитьПараметр("парамСубконтоКт1", Перечисления.ВидыПлатежейВГосБюджет.Налог);
	Запрос.УстановитьПараметр("парамОрганизация", Организация);
	Запрос.УстановитьПараметр("парамНачалоПериода", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
	
	ОтраженоРанееВНалоговомПериоде = Запрос.Выполнить().Выгрузить();
	Для каждого СтрокаИсточник Из ОтраженоРанееВНалоговомПериоде Цикл
		СтрокаПриемник = ПромежуточнаяТаблица.Добавить();
		Для каждого Колонка Из ОтраженоРанееВНалоговомПериоде.Колонки Цикл
			СтрокаПриемник[Колонка.Имя] = СтрокаИсточник[Колонка.Имя];	
		КонецЦикла; 
	КонецЦикла; 
	
	Запрос = Новый Запрос(ТекстыЗапросовФСЗН.КоэффициентыОтраженияЕСНТекст); //Островская Татьяна 02.10.2013 № 16828
	
	Запрос.УстановитьПараметр("парамОрганизация", Организация);
	Запрос.УстановитьПараметр("РасчетФСЗНотБПМ", РасчетФСЗНотБПМ);
	Запрос.УстановитьПараметр("парамБПМ", РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,
	Новый Структура("Видпараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер);
	Запрос.УстановитьПараметр("парамНачалоПериода", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамПериод", НачалоМесяца(ПериодРегистрации));
	
	Запрос.УстановитьПараметр("Счет97", ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов);
	Запрос.УстановитьПараметр("СчетН97", ПланыСчетов.Налоговый.РасходыНаОплатуТрудаБудущихПериодов);
	
	Запрос.УстановитьПараметр("РБПНаОплатуТруда", Справочники.РасходыБудущихПериодов.РБПНаОплатуТруда);
	Запрос.УстановитьПараметр("ОтпускБудПериода", Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ОплатаОтпускаБуд);
	//СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("ВидОтчисления",Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд));
	//Островская Татьяна 10.09.2013 № 16725
	РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
	//Островская Татьяна 10.09.2013 № 16725
	БазаОграниченияФСЗН = РазмерСреднейЗарплаты; //СтруктураПенс.ОграничениеПоДоходам(выбирается из запроса)
	Запрос.УстановитьПараметр("Ограничение", БазаОграниченияФСЗН);
	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
	Запрос.УстановитьПараметр("ПериодДляОграничения", КонецМесяца(ПериодРегистрации)); //О.Т. Аверсон 25.03.2016 № 950
	Запрос.УстановитьПараметр("ПустаяСсылкаВидНалогообложения", Справочники.ВидыНалогообложения.ПустаяСсылка()); //О.Т. Аверсон 25.03.2016 № 950
	//О.Т. 21.01.2015 № 17778
	ПараметрБез97Счета = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ОбязательноеСтрахованиеБез97)).Размер;//О.Т. 21.01.2015 № 17778
	
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	ПараметрПенсионныйФондБудущегоМесяца = 
	РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее( ПериодРегистрации,
	Новый Структура( "ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца ) 
	).Размер;
	ЭтоПодстановка97Счета = ( ПараметрБез97Счета = 2 И ПараметрПенсионныйФондБудущегоМесяца = 1 );
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	
	если ПараметрБез97Счета = 0 
		//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
		ИЛИ ЭтоПодстановка97Счета	
		//- СВЭЙ КДЯ 12.02.20 СВФР-005491
		Тогда 
		ПараметрБез97Счета = Ложь;
	иначе
		ПараметрБез97Счета = Истина;
	КонецЕсли;
	//О.Т. 21.01.2015 № 17778
	
	ОтражениеВБУ = Запрос.Выполнить().Выгрузить();
	//ОтражениеВБУ_ = Запрос.Выполнить().Выгрузить();
	
	Если НЕ НеРаспределятьДопНачисления Тогда //СВЭЙ 10.05.2024 КВВ СВФР-013002
		//Аверсон 12.08.2020 КВВ СВФР-006325 (
		ЗапросПоОтпускамДругогоПериодаРегистрации(ОтражениеВБУ,НачалоМесяца(ПериодРегистрации),ПодразделениеОрганизации);
	КонецЕсли;
	//ОтражениеВБУ.Сортировать("ВспомогательныйСчет");
	//ОтражениеВБУ.Сортировать("СчетДт,ВспомогательныйСчет");
	ОтражениеВБУ.Сортировать("ФизЛицо,СчетДт,ВспомогательныйСчет");  //Аверсон 19.08.2020 КВВ СВФР-006325 Физлицо
	
	//Аверсон 12.08.2020 КВВ СВФР-006325 )
	
	Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
		Запрос.Текст = ТекстыЗапросовФСЗН.КоэффициентыОтраженияЕСНТекст1;
		//+ Аверсон СМА 19.05.2020  СВФР-005987
		Запрос.Текст = СТРЗаменить(Запрос.Текст,"(НЕ(НЕ ПараметрОбязательноеСтрахованиеБез97_2.Размер ЕСТЬ NULL", "Истина"); 
		Запрос.Текст = СТРЗаменить(Запрос.Текст,"НЕ ПараметрПенсионныйФондБудущегоМесяца_1.Размер ЕСТЬ NULL))", "Истина");
		// - Аверсон СМА 19.05.2020  СВФР-005987
		ОтражениеВБУДляБазы = Запрос.Выполнить().Выгрузить();
		//Аверсон 15.09.2020 КВВ СВФР-006569 (
	Иначе
		ОтражениеВБУДляБазы = Новый ТаблицаЗначений;
		//Аверсон 15.09.2020 КВВ СВФР-006569 )
	КонецЕсли;
	
	Запрос = Новый Запрос(ТекстыЗапросовФСЗН.ЕСНИсчисленныйТекст); //Островская Татьяна 02.10.2013 № 16828
	
	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамНачалоПериода", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецПериода", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ОбщегоНазначения.ГоловнаяОрганизация(Организация));
	Запрос.УстановитьПараметр("парамМуж", Перечисления.ПолФизическихЛиц.Мужской);
	
	// для заполнения данных по ЕСН нужно получить максимальные ставки ЕСН
	// и передать их в качестве параметров в запрос ЕСНИсчисленный
	//О.Т. Аверсон 25.03.2016 № 950 не использовалось, убрала
	//Запрос.УстановитьПараметр("СтавкаФСЗН", РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	//										Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).Размер);
	//Запрос.УстановитьПараметр("СтавкаЕдиныйПлатеж", РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	//										Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж)).Размер);
	//Запрос.УстановитьПараметр("СтавкаПенсионныйФонд", РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	//										Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд)).Размер);
	//Запрос.УстановитьПараметр("СтавкаСтрах", РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
	//										Новый Структура("Организация", Организация)).Ставка);
	//О.Т. Аверсон 25.03.2016 № 950
	Выборка = Запрос.Выполнить().Выбрать();
	
	ОсновныеСчетаСотрудников = СформироватьЗапросПоОсновнымСчетамСотрудников().Выгрузить(); 
	//О.Т. Аверсон 25.03.2016 № 950 убрано
	//СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	//										Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).Размер;
	//СтавкаФСЗНИнвалиды = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	//										Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)).Размер;																					
	//СтавкаЕдиныйПлатеж = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	//										Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж)).Размер;
	//СтавкаСтрах = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
	//										Новый Структура("Организация", Организация)).Ставка;
	
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	КолонкиПодстановки = 
	"СчетДт_ДляПодстановки,  
	|СубконтоДт1_ДляПодстановки, СубконтоДт2_ДляПодстановки, СубконтоДт3_ДляПодстановки, 
	|СчетДтНУ_ДляПодстановки,
	|СубконтоДтНУ1_ДляПодстановки, СубконтоДтНУ2_ДляПодстановки, СубконтоДтНУ3_ДляПодстановки 
	|";
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	
	если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
		ОтражениеВБУ.Свернуть("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,ПериодРегистрации,ПериодДействия,ФлагДля97Сч"
		+ ?( ЭтоПодстановка97Счета, ", " + КолонкиПодстановки, "" ) //+ СВЭЙ КДЯ 12.02.20 СВФР-005491
		);
	иначе
		если (ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета Тогда //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)		
			ОтражениеВБУ.Свернуть("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,ПериодРегистрации,ПериодДействия,Проверка,ВидРасчета,ФлагДля97Сч"
			+ ?( ЭтоПодстановка97Счета, ", " + КолонкиПодстановки, "" ) //+ СВЭЙ КДЯ 12.02.20 СВФР-005491
			, "БазаФСЗН,БазаСтрах,БазаЕдиныйПлатеж,БазаФСЗНБУ,БазаСтрахБУ,БазаЕдиныйПлатежБУ"
			); //Островская Татьяна 10.09.2013 № 16725
		иначе
			ОтражениеВБУ.Свернуть("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,ПериодРегистрации,ПериодДействия,Проверка,ФлагДля97Сч"
			+ ?( ЭтоПодстановка97Счета, ", " + КолонкиПодстановки, "" ) //+ СВЭЙ КДЯ 12.02.20 СВФР-005491
			, "БазаФСЗН,БазаСтрах,БазаЕдиныйПлатеж,БазаФСЗНБУ,БазаСтрахБУ,БазаЕдиныйПлатежБУ" 
			);
			
			
		КонецЕсли;
	КонецЕсли;
	//ОтражениеВБУ_.Свернуть("ФизЛицо", "БазаФСЗН,БазаСтрах,БазаЕдиныйПлатеж");
	
	СЗДляДоплаты = Новый ТаблицаЗначений;
	СЗДляДоплаты.Колонки.Добавить("ФизЛицо");
	СЗДляДоплаты.Колонки.Добавить("Период");
	
	ТЗКорректировкаКопеек = Новый ТаблицаЗначений;
	ТЗКорректировкаКопеек.Колонки.Добавить("ФизЛицо");
	ТЗКорректировкаКопеек.Колонки.Добавить("СуммаФСЗН");
	ТЗКорректировкаКопеек.Колонки.Добавить("СуммаБГС");
	ТЗКорректировкаКопеек.Колонки.Добавить("СуммаЕдиныйПлатеж");
	ТЗКорректировкаКопеек.Колонки.Добавить("ДоляСпособаОтраженияФСЗН");
	ТЗКорректировкаКопеек.Колонки.Добавить("ДоляСпособаОтраженияБГС");
	
	//О.Т. Аверсон 31.08.2018 № 2322
	ТЗКорректировкаКопеекПоИтогу = Новый ТаблицаЗначений;
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("ФизЛицо");
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("Субконто1");
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("Субконто2");
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("Субконто3"); 	
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаФСЗН");
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаБГС");
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаЕдиныйПлатеж");
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаСравненияФСЗН");
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаСравненияБГС");
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаСравненияЕдиныйПлатеж"); 
	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("Проверить");
	//О.Т. Аверсон 31.08.2018 № 2322
	
	ТЗОбщаяБазы = новый ТаблицаЗначений;
	ТЗОбщаяБазы.Колонки.Добавить("ФизЛицо");
	ТЗОбщаяБазы.Колонки.Добавить("БазаФСЗН");
	ТЗОбщаяБазы.Колонки.Добавить("БазаБГС");
	ТЗОбщаяБазы.Колонки.Добавить("БазаЕдиный");
	ТЗОбщаяБазы.Колонки.Добавить("КолСчетов");
	ТЗОбщаяБазы.Колонки.Добавить("СчетНеИзРаспределения");
	
	ТЗДляУдельногоВеса = Новый ТаблицаЗначений;
	ТЗДляУдельногоВеса.Колонки.Добавить("ФизЛицо");
	ТЗДляУдельногоВеса.Колонки.Добавить("ПроцентыСумм");
	ТЗДляУдельногоВеса.Колонки.Добавить("КолСчетовСумм");
	
	ТЗДляУдельногоВесаБГС = Новый ТаблицаЗначений;
	ТЗДляУдельногоВесаБГС.Колонки.Добавить("ФизЛицо");
	ТЗДляУдельногоВесаБГС.Колонки.Добавить("ПроцентыСумм");
	ТЗДляУдельногоВесаБГС.Колонки.Добавить("КолСчетовСумм");
	
	
	ТЗДляУдельногоВесаЕдиный = Новый ТаблицаЗначений;
	ТЗДляУдельногоВесаЕдиный.Колонки.Добавить("ФизЛицо");
	ТЗДляУдельногоВесаЕдиный.Колонки.Добавить("ПроцентыСумм");
	ТЗДляУдельногоВесаЕдиный.Колонки.Добавить("КолСчетовСумм");
	
	СписокФизЛицОбщая = Новый СписокЗначений;
	для Каждого стр из ОсновныеНачисления Цикл 
		//Аверсон ЕАЕ 04.06.2020 СВФР-006057
		//ПроверитьСотрудника = СписокФизЛицОбщая.НайтиПоЗначению(стр.Сотрудник.ФизЛицо);
		ПроверитьСотрудника = СписокФизЛицОбщая.НайтиПоЗначению(стр.ФизЛицо);
		//Аверсон
		если ПроверитьСотрудника =  Неопределено Тогда
			//Аверсон ЕАЕ 04.06.2020 СВФР-006057
			//СписокФизЛицОбщая.Добавить(стр.Сотрудник.ФизЛицо);
			СписокФизЛицОбщая.Добавить(стр.ФизЛицо);
			//Аверсон
		КонецЕсли;		
	КонецЦикла;
	
	для Каждого стр из ДополнительныеНачисления Цикл 
		ПроверитьСотрудника = СписокФизЛицОбщая.НайтиПоЗначению(стр.Сотрудник.ФизЛицо);
		если ПроверитьСотрудника =  Неопределено Тогда
			СписокФизЛицОбщая.Добавить(стр.Сотрудник.ФизЛицо);
		КонецЕсли;		
	КонецЦикла;
	
	//Аверсон ЕАЕ 08.06.2020 СВФР-006057
	//!!!(1)!!!этот запрос вынесен из цикла
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ТЗ.ФизЛицо,
	|	ТЗ.ПериодРегистрации
	|ПОМЕСТИТЬ ВТТЗ
	|ИЗ &ТЗ КАК ТЗ
	|;
	|/////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТТЗ.ФизЛицо,
	|	ВТТЗ.ПериодРегистрации,
	|	ЕстьNull(ГражданствоФизЛиц.Период, ДАТАВРЕМЯ(1,1,1)) КАК ГражданствоФизЛицПериод,
	|	ЕстьNull(ГражданствоФизЛиц.НеИмеетПравоНаПенсию, Ложь) КАК НеИмеетПравоНаПенсию,
	|	ЕстьNull(ГражданствоФизЛиц.ИнаяСтавка, 0) КАК ИнаяСтавка,
	|	ЕстьNull(ГражданствоФизЛиц.Страна.УчастникЕАЭС, Ложь) КАК УчастникЕАЭС
	|ПОМЕСТИТЬ ВТДанныеРС
	|ИЗ ВТТЗ
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|ПО ВТТЗ.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
	|	И ВТТЗ.ПериодРегистрации >= ГражданствоФизЛиц.Период
	|ГДЕ ЕстьNull(ГражданствоФизЛиц.Период, ДАТАВРЕМЯ(1,1,1)) <> ДАТАВРЕМЯ(1,1,1)
	|;
	|////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТДанныеРС.ФизЛицо,
	|	ВТДанныеРС.ПериодРегистрации,
	|	МАКСИМУМ(ВТДанныеРС.ГражданствоФизЛицПериод) КАК ГражданствоФизЛицПериод
	|ПОМЕСТИТЬ ВТМаксПериоды
	|ИЗ ВТДанныеРС
	|СГРУППИРОВАТЬ ПО
	|	ВТДанныеРС.ФизЛицо,
	|	ВТДанныеРС.ПериодРегистрации
	|;                 
	|////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТМаксПериоды.ФизЛицо,
	|	ВТМаксПериоды.ПериодРегистрации,
	|	ЕСТЬNULL(ВТДанныеРС.НеИмеетПравоНаПенсию, ЛОЖЬ) КАК НеИмеетПравоНаПенсию,
	|	ЕСТЬNULL(ВТДанныеРС.ИнаяСтавка, 0) КАК ИнаяСтавка,
	|	ЕСТЬNULL(ВТДанныеРС.УчастникЕАЭС, ЛОЖЬ) КАК УчастникЕАЭС
	|ИЗ ВТМаксПериоды
	|ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеРС
	|ПО ВТМаксПериоды.ФизЛицо = ВТДанныеРС.ФизЛицо
	|	И ВТМаксПериоды.ПериодРегистрации = ВТДанныеРС.ПериодРегистрации
	//|ГДЕ ЕСТЬNULL(ВТДанныеРС.НеИмеетПравоНаПенсию, ЛОЖЬ) = ИСТИНА
	|";
	ЗапросГр = Новый Запрос;
	ЗапросГр.Текст = Текст;
	ЗапросГр.УстановитьПараметр("ТЗ", ОтражениеВБУ);
	ТЗГражданство = ЗапросГр.Выполнить().Выгрузить();
	//!!!
	//Аверсон
	
	//Аверсон ЕАЕ 08.06.2020 СВФР-006057
	//!!!(2), (4), (7)!!!этот запрос вынесен из цикла
	//три запроса объединены: ФСЗН и Обязательное страхование и Единый платеж
	Текст = "ВЫБРАТЬ
	|	ЕСНИсчисленный.ФизЛицо,
	|	ЕСНИсчисленный.ФСЗНОборот КАК ФСЗН,
	|	ЕСНИсчисленный.ОбязательноеСтрахованиеОборот КАК ОбязательноеСтрахование,
	|	ЕСНИсчисленный.ЕдиныйПлатежОборот КАК ЕдиныйПлатеж,
	|	100 как ДоляСпособаОтражения
	|ИЗ
	|	РегистрНакопления.ЕСНИсчисленный.Обороты(&Период, &Период1, Авто, ФизЛицо В (&СписокФизЛиц) И Организация = &Организация) КАК ЕСНИсчисленный
	|ГДЕ
	|( НЕ &ПодразделениеЗаполнено 
	|		ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение))
	|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) > НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, МЕСЯЦ) 
	|И (ЕСНИсчисленный.ФСЗНОборот <> 0 ИЛИ ЕСНИсчисленный.ОбязательноеСтрахованиеОборот <> 0 ИЛИ ЕСНИсчисленный.ЕдиныйПлатежОборот <> 0)
	//|СГРУППИРОВАТЬ ПО
	//|	ЕСНИсчисленный.ФизЛицо
	|";
	
	ЗапросЕСНИсчисленный = Новый Запрос;
	ЗапросЕСНИсчисленный.Текст = Текст;
	
	//Аверсон 31.07.2020 КВВ СВФР-006325 (
	ОтражениеВБУ.Сортировать("ФизЛицо");
	
	Если ОтражениеВБУДляБазы.Количество() <> 0 Тогда   //Аверсон 09.09.2020 КВВ СВФР-006325
		ОтражениеВБУДляБазы.Сортировать("ФизЛицо");
	КонецЕсли;
	
	Если НалогиИзДокументаРасчетФзносовСФОТ Тогда //Аверсон 15.09.2020 КВВ СВФР-006569 
		
		ТЗОтражение1 = ОтражениеВБУ.Скопировать();
		ТЗОтражение2 = ОтражениеВБУДляБазы.Скопировать();
		ТЗОтражение1.Свернуть("ФизЛицо");
		ТЗОтражение2.Свернуть("ФизЛицо");
		
		ТЗОтражение3 = РазницаТаблицЗначений(ТЗОтражение1, ТЗОтражение2, "ФизЛицо");
		Если ТЗОтражение3.Количество() > 0 Тогда 
			// если сотрудника нет в одной из таблиц, вероятнее всего, у него нет начислений в док."Расчет взносов с ФОТ и ЗП", где ВР=Оклад по часам, Оклад по дням, Оплата по часовому тарифу даже с нулевым результатом. 
			//Необходимо перепровести Начисление ЗП и перезаполнить Расчет взносов.
			Для Каждого СтрТЗОтражение3 ИЗ ТЗОтражение3 Цикл
				Сообщить(СтрТЗОтражение3.ФизЛицо.Наименование + ": проверьте начисления в док.""Расчет отчислений с ФОТ и ЗП""."); 
			КонецЦикла;
		КонецЕсли;
		//Аверсон 31.07.2020 КВВ СВФР-006325 )
		
	КонецЕсли;  
	
	СписокФизЛиц = ОтражениеВБУ.ВыгрузитьКолонку("ФизЛицо");
	//СписокФизЛиц = ОтражениеВБУДляБазы.ВыгрузитьКолонку("ФизЛицо");
	
	УдалитьПовторяющиесяЭлементыМассива(СписокФизЛиц,1);  //Аверсон 28.07.2020 КВВ СВФР-006325
	
	
	ЗапросЕСНИсчисленный.УстановитьПараметр("Организация", Организация);
	ЗапросЕСНИсчисленный.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	ЗапросЕСНИсчисленный.УстановитьПараметр("ПодразделениеЗаполнено", ЗначениеЗаполнено(ПодразделениеОрганизации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
	ТЗЕСНИсчисленныйРБП = ЗапросЕСНИсчисленный.Выполнить().Выгрузить();
	
	//ТЗЕСНИсчисленныйРБПФСЗН = ТЗЕСНИсчисленныйРБП.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйРБПФСЗН.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйРБПФСЗН[НомСтр];
	//		Если НужнаяСтрока.ФСЗН = 0 Тогда
	//			ТЗЕСНИсчисленныйРБПФСЗН.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	//
	//ТЗЕСНИсчисленныйРБПОбязательноеСтрахование = ТЗЕСНИсчисленныйРБП.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйРБПОбязательноеСтрахование.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйРБПОбязательноеСтрахование[НомСтр];
	//		Если НужнаяСтрока.ОбязательноеСтрахование = 0 Тогда
	//			ТЗЕСНИсчисленныйРБПОбязательноеСтрахование.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	//
	//ТЗЕСНИсчисленныйРБПЕдиныйПлатеж = ТЗЕСНИсчисленныйРБП.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйРБПЕдиныйПлатеж.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйРБПЕдиныйПлатеж[НомСтр];
	//		Если НужнаяСтрока.ЕдиныйПлатеж = 0 Тогда
	//			ТЗЕСНИсчисленныйРБПЕдиныйПлатеж.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	//!!!
	//Аверсон
	
	//Аверсон ЕАЕ 12.06.2020 СВФР-006057
	//(17),(18),(19) этот запрос вынесен из цикла
	ЗапросБазаДляРаспр = Новый Запрос;
	ЗапросБазаДляРаспр.Текст = 
	"ВЫБРАТЬ
	|   ЕСНИсчисленный.ФизЛицо,
	|	ЕСНИсчисленный.ФСЗНОборот КАК ФСЗН,
	|	ЕСНИсчисленный.ОбязательноеСтрахованиеОборот КАК ОбязательноеСтрахование,
	|	ЕСНИсчисленный.ЕдиныйПлатежОборот КАК ЕдиныйПлатеж
	|ИЗ
	|	РегистрНакопления.ЕСНИсчисленный.Обороты(&Период,&Период1,Авто,ФизЛицо В (&СписокФизЛиц) И Организация = &Организация) КАК ЕСНИсчисленный
	|ГДЕ
	|	( НЕ &ПодразделениеЗаполнено 
	|		ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение) )
	|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, МЕСЯЦ)
	//|СГРУППИРОВАТЬ ПО
	//|	ЕСНИсчисленный.ФизЛицо	
	|";
	ЗапросБазаДляРаспр.УстановитьПараметр("Организация", Организация);
	ЗапросБазаДляРаспр.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
	ЗапросБазаДляРаспр.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
	ЗапросБазаДляРаспр.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
	ЗапросБазаДляРаспр.УстановитьПараметр("ПодразделениеЗаполнено", ЗначениеЗаполнено(ПодразделениеОрганизации));
	ЗапросБазаДляРаспр.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	ТЗЕСНИсчисленныйРБПМеньше = ЗапросБазаДляРаспр.Выполнить().Выгрузить();
	//!!!
	//Аверсон
	
	//Аверсон ЕАЕ 08.06.2020 СВФР-006057
	//!!!(3), (5), (8)!!!этот запрос вынесен из цикла
	//три запроса объединены: ФСЗН и Обязательное страхование и Единый платеж
	//Текст =	"ВЫБРАТЬ
	//|	ЕСНИсчисленный.ФизЛицо,
	//|	ЕСНИсчисленный.ФСЗНОборот КАК ФСЗН,
	//|	ЕСНИсчисленный.ОбязательноеСтрахованиеОборот КАК ОбязательноеСтрахование,
	//|	ЕСНИсчисленный.ЕдиныйПлатежОборот КАК ЕдиныйПлатеж,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения КАК ДоляСпособаОтражения,
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)) КАК СчетДт,
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) КАК СубконтоДт2,
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) КАК СубконтоДт1
	//|ИЗ
	//|	РегистрНакопления.ЕСНИсчисленный.Обороты(&Период, &Период1, Авто, ФизЛицо В (&СписокФизЛиц) И Организация = &Организация) КАК ЕСНИсчисленный
	//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
	//|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
	//|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
	//|			И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
	//
	//|			И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)) В (&СписокСчетДт)
	//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
	//|			И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) В (&СписокСубконтоДт2)
	//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)
	//|           И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) В (&СписокСубконтоДт1)
	//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)
	//|ГДЕ
	//
	//|( НЕ &ПодразделениеЗаполнено 
	//|		ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение) )
	//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, МЕСЯЦ)
	//|	И (ЕСНИсчисленный.ФСЗНОборот <> 0 ИЛИ ЕСНИсчисленный.ОбязательноеСтрахованиеОборот <> 0 ИЛИ ЕСНИсчисленный.ЕдиныйПлатежОборот <> 0)
	//|
	//|СГРУППИРОВАТЬ ПО
	//|	ЕСНИсчисленный.ФизЛицо,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)),
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1),
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1)
	//|";
	//ЗапросЕСНИсчисленный = Новый Запрос;
	//ЗапросЕСНИсчисленный.Текст = Текст;
	//
	//СписокСчетДт = ОтражениеВБУ.ВыгрузитьКолонку("СчетДт");
	//СписокСчетДт.Добавить(ПланыСчетов.Хозрасчетный.ПустаяСсылка());
	//
	//СписокСубконтоДт2 = ОтражениеВБУ.ВыгрузитьКолонку("СубконтоДт2");
	//СписокСубконтоДт2.Добавить(1);
	//
	//СписокСубконтоДт1 = ОтражениеВБУ.ВыгрузитьКолонку("СубконтоДт1");
	//СписокСубконтоДт1.Добавить(1);
	//
	//ЗапросЕСНИсчисленный.УстановитьПараметр("Организация", Организация);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
	//ЗапросЕСНИсчисленный.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("ПодразделениеЗаполнено", ЗначениеЗаполнено(ПодразделениеОрганизации));
	//ЗапросЕСНИсчисленный.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСчетДт", СписокСчетДт);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСубконтоДт2", СписокСубконтоДт2);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСубконтоДт1", СписокСубконтоДт1);
	//
	//ТЗЕСНИсчисленныйСДопУсловием = ЗапросЕСНИсчисленный.Выполнить().Выгрузить();
	
	//////////////////////////////////////////////////////////////////////////////////
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ТЗ.ФизЛицо,
	|	ТЗ.СчетДт,
	|	ТЗ.СубконтоДт1,
	|	ТЗ.СубконтоДт2
	|ПОМЕСТИТЬ ВТТЗ
	|ИЗ &ТЗ КАК ТЗ
	|;
	|///////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТТЗ.ФизЛицо,
	|	ВТТЗ.СчетДт,
	|	ВТТЗ.СубконтоДт1,
	|	ВТТЗ.СубконтоДт2,
	|	ЕСТЬNULL(ЕСНИсчисленныйОбороты.ФСЗНОборот, 0) КАК ФСЗН,
	|	ЕСТЬNULL(ЕСНИсчисленныйОбороты.ОбязательноеСтрахованиеОборот, 0) КАК ОбязательноеСтрахование,
	|	ЕСТЬNULL(ЕСНИсчисленныйОбороты.ЕдиныйПлатежОборот, 0) КАК ЕдиныйПлатеж,
	|   ЕСНИсчисленныйОбороты.ПериодСекунда КАК Период,
	|   ЕСНИсчисленныйОбороты.ПериодВзаиморасчетов,
	|   ЕСНИсчисленныйОбороты.Регистратор.ПодразделениеОрганизации как ПодрОрг //Аверсон 13.08.2020 КВВ СВФР-006325
	|ПОМЕСТИТЬ ВТЕСНИсчисленный
	|ИЗ ВТТЗ
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЕСНИсчисленный.Обороты(&Период, &Период1, Авто, ФизЛицо В (&СписокФизЛиц) И Организация = &Организация) КАК ЕСНИсчисленныйОбороты
	|ПО ВТТЗ.ФизЛицо = ЕСНИсчисленныйОбороты.ФизЛицо
	|ГДЕ ЕСТЬNULL(ЕСНИсчисленныйОбороты.ФСЗНОборот, 0) <> 0 ИЛИ ЕСТЬNULL(ЕСНИсчисленныйОбороты.ОбязательноеСтрахованиеОборот, 0) <> 0 ИЛИ ЕСТЬNULL(ЕСНИсчисленныйОбороты.ЕдиныйПлатежОборот, 0) <> 0
	|И ( НЕ &ПодразделениеЗаполнено 
	|		ИЛИ ЕСНИсчисленныйОбороты.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение) )
	|И 	НАЧАЛОПЕРИОДА(ЕСНИсчисленныйОбороты.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленныйОбороты.ПериодСекунда, МЕСЯЦ)
	|;
	|//////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ                                     
	|	ВТЕСНИсчисленный.ФизЛицо,
	|   ВТЕСНИсчисленный.ОбязательноеСтрахование,
	|   ВТЕСНИсчисленный.ЕдиныйПлатеж,
	|   ВТЕСНИсчисленный.ФСЗН,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения КАК ДоляСпособаОтражения,
	//|   ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) КАК СчетДт,
	//|   ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) КАК СубконтоДт1,
	//|   ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) КАК СубконтоДт2
	|   ВТЕСНИсчисленный.СчетДт,
	|   ВТЕСНИсчисленный.СубконтоДт1,
	|   ВТЕСНИсчисленный.СубконтоДт2
	|ИЗ ВТЕСНИсчисленный
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
	|ПО ВТЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
	|И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация = &Организация
	|И НАЧАЛОПЕРИОДА(ВТЕСНИсчисленный.Период, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
	|И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = ВТЕСНИсчисленный.СчетДт
	|	ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
	|И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = ВТЕСНИсчисленный.СубконтоДт2
	|	ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)
	|И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = ВТЕСНИсчисленный.СубконтоДт1
	|	ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)
	|ГДЕ НАЧАЛОПЕРИОДА(ВТЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ВТЕСНИсчисленный.Период, МЕСЯЦ)
	|И ( НЕ &ПодразделениеЗаполнено ИЛИ ВТЕСНИсчисленный.ПодрОрг В ИЕРАРХИИ (&Подразделение)) //Аверсон 13.08.2020 КВВ СВФР-006325
	|";
	ЗапросЕСНИсчисленный = Новый Запрос;
	ЗапросЕСНИсчисленный.Текст = Текст;
	ЗапросЕСНИсчисленный.УстановитьПараметр("Организация", Организация);
	ЗапросЕСНИсчисленный.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	ЗапросЕСНИсчисленный.УстановитьПараметр("ПодразделениеЗаполнено", ЗначениеЗаполнено(ПодразделениеОрганизации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСчетДт", СписокСчетДт);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСубконтоДт2", СписокСубконтоДт2);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСубконтоДт1", СписокСубконтоДт1);
	ЗапросЕСНИсчисленный.УстановитьПараметр("ТЗ", ОтражениеВБУ);
	ТЗЕСНИсчисленныйСДопУсловием = ЗапросЕСНИсчисленный.Выполнить().Выгрузить();
	/////////////////////////////////////////////////////////////////////////////////
	
	//ТЗЕСНИсчисленныйСДопУсловиемФСЗН = ТЗЕСНИсчисленныйСДопУсловием.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйСДопУсловиемФСЗН.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйСДопУсловиемФСЗН[НомСтр];
	//		Если НужнаяСтрока.ФСЗН = 0 Тогда
	//			ТЗЕСНИсчисленныйСДопУсловиемФСЗН.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	//
	//ТЗЕСНИсчисленныйСДопУсловиемОбязательноеСтрахование = ТЗЕСНИсчисленныйСДопУсловием.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйСДопУсловиемОбязательноеСтрахование.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйСДопУсловиемОбязательноеСтрахование[НомСтр];
	//		Если НужнаяСтрока.ОбязательноеСтрахование = 0 Тогда
	//			ТЗЕСНИсчисленныйСДопУсловиемОбязательноеСтрахование.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	//
	//ТЗЕСНИсчисленныйСДопУсловиемЕдиныйПлатеж = ТЗЕСНИсчисленныйСДопУсловием.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйСДопУсловиемЕдиныйПлатеж.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйСДопУсловиемЕдиныйПлатеж[НомСтр];
	//		Если НужнаяСтрока.ЕдиныйПлатеж = 0 Тогда
	//			ТЗЕСНИсчисленныйСДопУсловиемЕдиныйПлатеж.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	
	////////////////////////////////////////////////////////////////////////////////////
	
	//Текст =	"ВЫБРАТЬ
	//|   ЕСНИсчисленный.ФизЛицо,
	//|	ЕСНИсчисленный.ФСЗНОборот КАК ФСЗН,
	//|	ЕСНИсчисленный.ОбязательноеСтрахованиеОборот КАК ОбязательноеСтрахование,
	//|	ЕСНИсчисленный.ЕдиныйПлатежОборот КАК ЕдиныйПлатеж,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения КАК ДоляСпособаОтражения,
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)) КАК СчетДт,
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) КАК СубконтоДт2
	//|ИЗ
	//|	РегистрНакопления.ЕСНИсчисленный.Обороты(&Период, &Период1, Авто, ФизЛицо В (&СписокФизЛиц) И Организация = &Организация) КАК ЕСНИсчисленный
	//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
	//|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
	//|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
	//|			И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
	//
	//|			И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)) В (&СписокСчетДт) 
	//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
	//|			И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) В (&СписокСубконтоДт2)
	//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)
	//|ГДЕ
	//
	//|( НЕ &ПодразделениеЗаполнено 
	//|		ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение) )
	//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, МЕСЯЦ)
	//|	И (ЕСНИсчисленный.ФСЗНОборот <> 0 ИЛИ ЕСНИсчисленный.ОбязательноеСтрахованиеОборот <> 0 ИЛИ ЕСНИсчисленный.ЕдиныйПлатежОборот <> 0)
	//|
	//|СГРУППИРОВАТЬ ПО
	//|	ЕСНИсчисленный.ФизЛицо,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)),
	//|	ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1)
	//|";
	//ЗапросЕСНИсчисленный = Новый Запрос;
	//ЗапросЕСНИсчисленный.Текст = Текст;
	//
	//ЗапросЕСНИсчисленный.УстановитьПараметр("Организация", Организация);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
	//ЗапросЕСНИсчисленный.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("ПодразделениеЗаполнено", ЗначениеЗаполнено(ПодразделениеОрганизации));
	//ЗапросЕСНИсчисленный.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСчетДт", СписокСчетДт);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСубконтоДт2", СписокСубконтоДт2);
	//
	//ТЗЕСНИсчисленныйБезДопУсловия = ЗапросЕСНИсчисленный.Выполнить().Выгрузить();
	
	////////////////////////////////////////////////////////////////////////////////////////////
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ТЗ.ФизЛицо,
	|	ТЗ.СчетДт,
	//|	ТЗ.СубконтоДт1,
	|	ТЗ.СубконтоДт2
	|ПОМЕСТИТЬ ВТТЗ
	|ИЗ &ТЗ КАК ТЗ
	|;
	|///////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТТЗ.ФизЛицо,
	|	ВТТЗ.СчетДт,
	//|	ВТТЗ.СубконтоДт1,
	|	ВТТЗ.СубконтоДт2,
	|	ЕСТЬNULL(ЕСНИсчисленныйОбороты.ФСЗНОборот, 0) КАК ФСЗН,
	|	ЕСТЬNULL(ЕСНИсчисленныйОбороты.ОбязательноеСтрахованиеОборот, 0) КАК ОбязательноеСтрахование,
	|	ЕСТЬNULL(ЕСНИсчисленныйОбороты.ЕдиныйПлатежОборот, 0) КАК ЕдиныйПлатеж,
	|   ЕСНИсчисленныйОбороты.ПериодСекунда КАК Период,
	|   ЕСНИсчисленныйОбороты.ПериодВзаиморасчетов,
	|   ЕСНИсчисленныйОбороты.Регистратор.ПодразделениеОрганизации как ПодрОрг //Аверсон 13.08.2020 КВВ СВФР-006325
	|ПОМЕСТИТЬ ВТЕСНИсчисленный
	|ИЗ ВТТЗ
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЕСНИсчисленный.Обороты(&Период, &Период1, Авто, ФизЛицо В (&СписокФизЛиц) И Организация = &Организация) КАК ЕСНИсчисленныйОбороты
	|ПО ВТТЗ.ФизЛицо = ЕСНИсчисленныйОбороты.ФизЛицо
	|ГДЕ ЕСТЬNULL(ЕСНИсчисленныйОбороты.ФСЗНОборот, 0) <> 0 ИЛИ ЕСТЬNULL(ЕСНИсчисленныйОбороты.ОбязательноеСтрахованиеОборот, 0) <> 0 ИЛИ ЕСТЬNULL(ЕСНИсчисленныйОбороты.ЕдиныйПлатежОборот, 0) <> 0
	|И ( НЕ &ПодразделениеЗаполнено 
	|		ИЛИ ЕСНИсчисленныйОбороты.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение) )
	|И 	НАЧАЛОПЕРИОДА(ЕСНИсчисленныйОбороты.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленныйОбороты.ПериодСекунда, МЕСЯЦ)
	
	|;
	|//////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТЕСНИсчисленный.ФизЛицо,
	|   ВТЕСНИсчисленный.ОбязательноеСтрахование,
	|   ВТЕСНИсчисленный.ЕдиныйПлатеж,
	|   ВТЕСНИсчисленный.ФСЗН,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения КАК ДоляСпособаОтражения,
	//|   ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) КАК СчетДт,
	//|   ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) КАК СубконтоДт1,
	//|   ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) КАК СубконтоДт2
	|   ВТЕСНИсчисленный.СчетДт,
	|   ВТЕСНИсчисленный.СубконтоДт2
	|ИЗ ВТЕСНИсчисленный
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
	|ПО ВТЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
	|И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация = &Организация
	|И НАЧАЛОПЕРИОДА(ВТЕСНИсчисленный.Период, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
	|И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = ВТЕСНИсчисленный.СчетДт
	|	ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
	|И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = ВТЕСНИсчисленный.СубконтоДт2
	|	ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)
	//|И (ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = ВТЕСНИсчисленный.СубконтоДт1
	//|	ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1
	|ГДЕ НАЧАЛОПЕРИОДА(ВТЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ВТЕСНИсчисленный.Период, МЕСЯЦ)
	|И ( НЕ &ПодразделениеЗаполнено ИЛИ ВТЕСНИсчисленный.ПодрОрг В ИЕРАРХИИ (&Подразделение)) //Аверсон 13.08.2020 КВВ СВФР-006325
	|";
	ЗапросЕСНИсчисленный = Новый Запрос;
	ЗапросЕСНИсчисленный.Текст = Текст;
	ЗапросЕСНИсчисленный.УстановитьПараметр("Организация", Организация);
	ЗапросЕСНИсчисленный.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	ЗапросЕСНИсчисленный.УстановитьПараметр("ПодразделениеЗаполнено", ЗначениеЗаполнено(ПодразделениеОрганизации));
	ЗапросЕСНИсчисленный.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСчетДт", СписокСчетДт);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСубконтоДт2", СписокСубконтоДт2);
	//ЗапросЕСНИсчисленный.УстановитьПараметр("СписокСубконтоДт1", СписокСубконтоДт1);
	ЗапросЕСНИсчисленный.УстановитьПараметр("ТЗ", ОтражениеВБУ);
	ТЗЕСНИсчисленныйБезДопУсловия = ЗапросЕСНИсчисленный.Выполнить().Выгрузить();
	///////////////////////////////////////////////////////////////////////////////////////////
	
	//ТЗЕСНИсчисленныйБезДопУсловияФСЗН = ТЗЕСНИсчисленныйБезДопУсловия.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйБезДопУсловияФСЗН.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйБезДопУсловияФСЗН[НомСтр];
	//		Если НужнаяСтрока.ФСЗН = 0 Тогда
	//			ТЗЕСНИсчисленныйБезДопУсловияФСЗН.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	//
	//ТЗЕСНИсчисленныйБезДопУсловияОбязательноеСтрахование = ТЗЕСНИсчисленныйБезДопУсловия.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйБезДопУсловияОбязательноеСтрахование.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйБезДопУсловияОбязательноеСтрахование[НомСтр];
	//		Если НужнаяСтрока.ОбязательноеСтрахование = 0 Тогда
	//			ТЗЕСНИсчисленныйБезДопУсловияОбязательноеСтрахование.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	//
	//ТЗЕСНИсчисленныйБезДопУсловияЕдиныйПлатеж = ТЗЕСНИсчисленныйБезДопУсловия.Скопировать();
	//КолСтр = ТЗЕСНИсчисленныйБезДопУсловияЕдиныйПлатеж.Количество();
	//Если  КолСтр > 0 Тогда
	//	НомерПоследнейСтроки = КолСтр - 1;
	//	Для н = -НомерПоследнейСтроки По 0 Цикл
	//		НомСтр = -н;
	//		НужнаяСтрока = ТЗЕСНИсчисленныйБезДопУсловияЕдиныйПлатеж[НомСтр];
	//		Если НужнаяСтрока.ЕдиныйПлатеж = 0 Тогда
	//			ТЗЕСНИсчисленныйБезДопУсловияЕдиныйПлатеж.Удалить(НужнаяСтрока);	
	//		КонецЕсли;
	//	КонецЦикла;
	//КонецЕсли;
	//!!!
	//Аверсон
	
	//Аверсон ЕАЕ 08.06.2020 СВФР-006057
	//(6) этот запрос вынесен из цикла
	Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	ТЗ.ФизЛицо,
	|	ТЗ.ПериодДействия
	|ПОМЕСТИТЬ ВТТЗ
	|ИЗ &ТЗ КАК ТЗ
	|;
	|///////////////////////////////
	//РаботникиОрганизацийСрезПоследних
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТТЗ.ФизЛицо,
	|	ВТТЗ.ПериодДействия,
	|	ЕстьNull(РаботникиОрганизаций.Период, ДАТАВРЕМЯ(1,1,1)) КАК Период,
	|	ЕстьNull(РаботникиОрганизаций.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)) КАК Сотрудник,
	|	ЕстьNull(РаботникиОрганизаций.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|	ЕстьNull(РаботникиОрганизаций.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК ПодразделениеОрганизации
	|ПОМЕСТИТЬ ВТСотрудники
	|ИЗ ВТТЗ
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|ПО ВТТЗ.ФизЛицо = РаботникиОрганизаций.Сотрудник.ФизЛицо
	|	И ВТТЗ.ПериодДействия >= РаботникиОрганизаций.Период
	|ГДЕ 
	|ЕстьNull(РаботникиОрганизаций.Период, ДАТАВРЕМЯ(1,1,1)) <> ДАТАВРЕМЯ(1,1,1)
	|;
	|/////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТСотрудники.ФизЛицо,
	|	ВТСотрудники.ПериодДействия,
	|	МАКСИМУМ(ВТСотрудники.Период) КАК Период
	|ПОМЕСТИТЬ ВТМаксимальныеПериоды
	|ИЗ ВТСотрудники
	|СГРУППИРОВАТЬ ПО
	|	ВТСотрудники.ФизЛицо,
	|	ВТСотрудники.ПериодДействия
	|;
	|/////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
	|	ВТМаксимальныеПериоды.ФизЛицо,
	|	ВТМаксимальныеПериоды.ПериодДействия,
	|	ЕстьNull(ВТСотрудники.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)) КАК Сотрудник,
	|	ЕстьNull(ВТСотрудники.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|	ЕстьNull(ВТСотрудники.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК ПодразделениеОрганизации
	|ПОМЕСТИТЬ РаботникиОрганизацийСрезПоследних
	|ИЗ ВТМаксимальныеПериоды
	|ЛЕВОЕ СОЕДИНЕНИЕ ВТСотрудники
	|ПО ВТМаксимальныеПериоды.ФизЛицо = ВТСотрудники.ФизЛицо
	|	И ВТМаксимальныеПериоды.ПериодДействия = ВТСотрудники.ПериодДействия
	|	И ВТМаксимальныеПериоды.Период = ВТСотрудники.Период
	|;
	|/////////////////////////////
	//УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	ВТТЗ.ФизЛицо,
	|	ВТТЗ.ПериодДействия,
	|	ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период, ДАТАВРЕМЯ(1,1,1)) КАК Период,
	|	ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухУчете, ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)) КАК СпособОтраженияВБухУчете,
	|	ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|	ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)) КАК Сотрудник
	|ПОМЕСТИТЬ ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|ИЗ ВТТЗ
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|ПО ВТТЗ.ФизЛицо = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник.ФизЛицо
	|	И ВТТЗ.ПериодДействия >= УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
	|ГДЕ ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период, ДАТАВРЕМЯ(1,1,1)) <> ДАТАВРЕМЯ(1,1,1)
	|;
	|/////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ФизЛицо,
	|	ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ПериодДействия,
	|	МАКСИМУМ(ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период) КАК Период
	|ПОМЕСТИТЬ ВТМаксимальныеПериоды2
	|ИЗ ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|СГРУППИРОВАТЬ ПО
	|	ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ФизЛицо,
	|	ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ПериодДействия
	|;
	|/////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТМаксимальныеПериоды2.ФизЛицо,
	|	ВТМаксимальныеПериоды2.ПериодДействия,
	|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухУчете, ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)) КАК СпособОтраженияВБухУчете,
	|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|   ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)) КАК Сотрудник
	|ПОМЕСТИТЬ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|ИЗ ВТМаксимальныеПериоды2
	|ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|ПО ВТМаксимальныеПериоды2.ФизЛицо = ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ФизЛицо
	|	И ВТМаксимальныеПериоды2.ПериодДействия = ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ПериодДействия
	|	И ВТМаксимальныеПериоды2.Период = ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
	|;
	|/////////////////////////////
	//УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	ВТТЗ.ПериодДействия,
	|	ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период, ДАТАВРЕМЯ(1,1,1)) КАК Период,
	|	ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|	ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК ПодразделениеОрганизации,
	|	ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухУчете, ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)) КАК СпособОтраженияВБухУчете
	|ПОМЕСТИТЬ ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|ИЗ ВТТЗ
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|ПО ВТТЗ.ПериодДействия >= УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период
	|ГДЕ ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период, ДАТАВРЕМЯ(1,1,1)) <> ДАТАВРЕМЯ(1,1,1)
	|;
	|/////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПериодДействия,
	|	МАКСИМУМ(ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период) КАК Период
	|ПОМЕСТИТЬ ВТМаксимальныеПериоды1
	|ИЗ ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|СГРУППИРОВАТЬ ПО
	|	ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПериодДействия
	|;
	|/////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТМаксимальныеПериоды1.ПериодДействия,
	|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК ПодразделениеОрганизации,
	|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухУчете, ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)) КАК СпособОтраженияВБухУчете
	|ПОМЕСТИТЬ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|ИЗ ВТМаксимальныеПериоды1
	|ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|ПО ВТМаксимальныеПериоды1.ПериодДействия = ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПериодДействия
	|	И ВТМаксимальныеПериоды1.Период = ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период
	|;
	|/////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	РаботникиОрганизацийСрезПоследних.ФизЛицо,
	|	РаботникиОрганизацийСрезПоследних.Сотрудник,
	|	РаботникиОрганизацийСрезПоследних.ПериодДействия,
	|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1
	|ИЗ РаботникиОрганизацийСрезПоследних
	|ЛЕВОЕ СОЕДИНЕНИЕ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
	|	И РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
	|ЛЕВОЕ СОЕДИНЕНИЕ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|ПО РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Организация
	|	И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации 
	|";
	ЗапросПодр = Новый Запрос;
	ЗапросПодр.Текст = Текст;
	
	СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	
	ЗапросПодр.УстановитьПараметр("ТЗ", ОтражениеВБУ);
	ЗапросПодр.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1",   СпособПоУмолчанию.СубконтоДт1);
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1",   СпособПоУмолчанию.СубконтоДт1); 
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2",   СпособПоУмолчанию.СубконтоДт2); 
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3",   СпособПоУмолчанию.СубконтоДт3);
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт",        СпособПоУмолчанию.СчетДт);
	ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ",      СпособПоУмолчанию.СчетДтНУ);
	
	ТЗПодр = ЗапросПодр.Выполнить().Выгрузить();
	//!!!///////////////////////////////
	//Аверсон
	
	КоличествоСтрокСчетаВспомогательный = ОтражениеВБУ.НайтиСтроки(Новый структура("СчетДт",ПланыСчетов.Хозрасчетный.Вспомогательный));
	Если КоличествоСтрокСчетаВспомогательный.Количество() > 0 Тогда
		
		//Аверсон ЕАЕ 09.06.2020 СВФР-006057
		//(9), (11) этот запрос вынесен из цикла
		Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	ТЗ.ФизЛицо,
		|	ТЗ.ПериодДействия
		|ПОМЕСТИТЬ ВТТЗ
		|ИЗ &ТЗ КАК ТЗ
		|;
		|///////////////////////////////
		//РаботникиОрганизацийСрезПоследних
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	ВТТЗ.ФизЛицо,
		|	КОНЕЦПЕРИОДА(ВТТЗ.ПериодДействия, Месяц) КАК ПериодДействия,
		|	ЕстьNull(РаботникиОрганизаций.Период, ДАТАВРЕМЯ(1,1,1)) КАК Период,
		|	ЕстьNull(РаботникиОрганизаций.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)) КАК Сотрудник,
		|	ЕстьNull(РаботникиОрганизаций.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	ЕстьNull(РаботникиОрганизаций.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК ПодразделениеОрганизации
		|ПОМЕСТИТЬ ВТСотрудники
		|ИЗ ВТТЗ
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|ПО ВТТЗ.ФизЛицо = РаботникиОрганизаций.Сотрудник.ФизЛицо
		|	И КОНЕЦПЕРИОДА(ВТТЗ.ПериодДействия, Месяц) >= РаботникиОрганизаций.Период
		|ГДЕ 
		|ЕстьNull(РаботникиОрганизаций.Период, ДАТАВРЕМЯ(1,1,1)) <> ДАТАВРЕМЯ(1,1,1)
		|;
		|/////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ 
		|	ВТСотрудники.ФизЛицо,
		|	ВТСотрудники.ПериодДействия,
		|	МАКСИМУМ(ВТСотрудники.Период) КАК Период
		|ПОМЕСТИТЬ ВТМаксимальныеПериоды
		|ИЗ ВТСотрудники
		|СГРУППИРОВАТЬ ПО
		|	ВТСотрудники.ФизЛицо,
		|	ВТСотрудники.ПериодДействия
		|;
		|/////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	ВТМаксимальныеПериоды.ФизЛицо,
		|	ВТМаксимальныеПериоды.ПериодДействия,
		|	ЕстьNull(ВТСотрудники.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)) КАК Сотрудник,
		|	ЕстьNull(ВТСотрудники.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	ЕстьNull(ВТСотрудники.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК ПодразделениеОрганизации
		|ПОМЕСТИТЬ РаботникиОрганизацийСрезПоследних
		|ИЗ ВТМаксимальныеПериоды
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТСотрудники
		|ПО ВТМаксимальныеПериоды.ФизЛицо = ВТСотрудники.ФизЛицо
		|	И ВТМаксимальныеПериоды.ПериодДействия = ВТСотрудники.ПериодДействия
		|	И ВТМаксимальныеПериоды.Период = ВТСотрудники.Период
		|;
		|/////////////////////////////
		//УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	ВТТЗ.ФизЛицо,
		|	КОНЕЦПЕРИОДА(ВТТЗ.ПериодДействия, Месяц) КАК ПериодДействия,
		|	ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период, ДАТАВРЕМЯ(1,1,1)) КАК Период,
		|	ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухУчете, ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)) КАК СпособОтраженияВБухУчете,
		|	ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)) КАК Сотрудник
		|ПОМЕСТИТЬ ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		|ИЗ ВТТЗ
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		|ПО ВТТЗ.ФизЛицо = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник.ФизЛицо
		|	И КОНЕЦПЕРИОДА(ВТТЗ.ПериодДействия, Месяц) >= УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
		|ГДЕ ЕстьNull(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период, ДАТАВРЕМЯ(1,1,1)) <> ДАТАВРЕМЯ(1,1,1)
		|;
		|/////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ФизЛицо,
		|	ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ПериодДействия,
		|	МАКСИМУМ(ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период) КАК Период
		|ПОМЕСТИТЬ ВТМаксимальныеПериоды2
		|ИЗ ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		|СГРУППИРОВАТЬ ПО
		|	ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ФизЛицо,
		|	ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ПериодДействия
		|;
		|/////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	ВТМаксимальныеПериоды2.ФизЛицо,
		|	ВТМаксимальныеПериоды2.ПериодДействия,
		|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухУчете, ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)) КАК СпособОтраженияВБухУчете,
		|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|   ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник, ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)) КАК Сотрудник
		|ПОМЕСТИТЬ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		|ИЗ ВТМаксимальныеПериоды2
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		|ПО ВТМаксимальныеПериоды2.ФизЛицо = ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ФизЛицо
		|	И ВТМаксимальныеПериоды2.ПериодДействия = ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ПериодДействия
		|	И ВТМаксимальныеПериоды2.Период = ВТУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
		|;
		|/////////////////////////////
		//УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	КОНЕЦПЕРИОДА(ВТТЗ.ПериодДействия, Месяц) КАК ПериодДействия,
		|	ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период, ДАТАВРЕМЯ(1,1,1)) КАК Период,
		|	ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК ПодразделениеОрганизации,
		|	ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухУчете, ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)) КАК СпособОтраженияВБухУчете
		|ПОМЕСТИТЬ ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
		|ИЗ ВТТЗ
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
		|ПО КОНЕЦПЕРИОДА(ВТТЗ.ПериодДействия, Месяц) >= УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период
		|ГДЕ ЕстьNull(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период, ДАТАВРЕМЯ(1,1,1)) <> ДАТАВРЕМЯ(1,1,1)
		|;
		|/////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПериодДействия,
		
		//Аверсон ЕАЕ 20.09.2022 СВФР-009555
		|   ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации, 
		//Аверсон СВФР-009555
		
		|	МАКСИМУМ(ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период) КАК Период
		|ПОМЕСТИТЬ ВТМаксимальныеПериоды1
		|ИЗ ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
		|СГРУППИРОВАТЬ ПО
		|	ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПериодДействия,
		
		//Аверсон ЕАЕ 20.09.2022 СВФР-009555
		|   ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации 
		//Аверсон СВФР-009555
		
		|;
		|/////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	ВТМаксимальныеПериоды1.ПериодДействия,
		|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) КАК ПодразделениеОрганизации,
		|	ЕстьNull(ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухУчете, ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)) КАК СпособОтраженияВБухУчете
		|ПОМЕСТИТЬ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
		|ИЗ ВТМаксимальныеПериоды1
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
		|ПО ВТМаксимальныеПериоды1.ПериодДействия = ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПериодДействия
		|	И ВТМаксимальныеПериоды1.Период = ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период
		
		//Аверсон ЕАЕ 20.09.2022 СВФР-009555
		|   И ВТМаксимальныеПериоды1.ПодразделениеОрганизации = ВТУчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации
		//Аверсон СВФР-009555
		
		|;
		|/////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ Различные
		|	РаботникиОрганизацийСрезПоследних.ФизЛицо,
		|	РаботникиОрганизацийСрезПоследних.Сотрудник,
		|	РаботникиОрганизацийСрезПоследних.ПериодДействия,
		|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
		|	ВЫБОР
		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт1
		|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
		|	КОНЕЦ КАК СубконтоДт1,
		|	ВЫБОР
		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СчетДт
		|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
		|	КОНЕЦ КАК СчетДт,
		|	ВЫБОР
		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт2
		|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
		|	КОНЕЦ КАК СубконтоДт2,
		|	ВЫБОР
		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт3
		|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
		|	КОНЕЦ КАК СубконтоДт3,
		|	ВЫБОР
		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ1
		|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
		|	КОНЕЦ КАК СубконтоДтНУ1,
		|	ВЫБОР
		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ2
		|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
		|	КОНЕЦ КАК СубконтоДтНУ2,
		|	ВЫБОР
		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ3
		|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
		|	КОНЕЦ КАК СубконтоДтНУ3,
		|	ВЫБОР
		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СчетДтНУ
		|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДтНУ
		|	КОНЕЦ КАК СчетДтНУ
		|ИЗ РаботникиОрганизацийСрезПоследних
		|ЛЕВОЕ СОЕДИНЕНИЕ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		|ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
		|	И РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
		|ЛЕВОЕ СОЕДИНЕНИЕ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
		|ПО РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Организация
		|	И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации 
		|";
		ЗапросПодр = Новый Запрос;
		ЗапросПодр.Текст = Текст;
		
		СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
		
		ЗапросПодр.УстановитьПараметр("ТЗ", ОтражениеВБУ);
		ЗапросПодр.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1",   СпособПоУмолчанию.СубконтоДт1);
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1",   СпособПоУмолчанию.СубконтоДт1); 
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2",   СпособПоУмолчанию.СубконтоДт2); 
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3",   СпособПоУмолчанию.СубконтоДт3);
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт",        СпособПоУмолчанию.СчетДт);
		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ",      СпособПоУмолчанию.СчетДтНУ);
		
		ТЗПодрКонецМесяца = ЗапросПодр.Выполнить().Выгрузить();
		//!!!///////////////////////////////
		//Аверсон
	КонецЕсли;
	
	//Аверсон ЕАЕ 09.06.2020 СВФР-006057
	//(10),(12),(16) этот запрос вынесен из цикла
	Текст = 
	"ВЫБРАТЬ
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник,
	|   РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.ФизЛицо КАК ФизЛицо,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
	|ИЗ
	|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
	|ГДЕ
	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
	|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.ФизЛицо В (&СписокФизЛиц)
	|";
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	ТЗРаспределениеОсновногоЗаработкаРаботниковОрганизаций = Запрос.Выполнить().Выгрузить();
	//!!!
	//Аверсон
	
	//Аверсон ЕАЕ 09.06.2020 СВФР-006057
	//(13), (14) этот запрос вынесен из цикла
	Текст = 
	"ВЫБРАТЬ
	|	УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник,
	|   УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник.ФизЛицо КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
	|	КОНЕЦ КАК СчетДт,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДтНУ
	|	КОНЕЦ КАК СчетДтНУ
	|ИЗ
	|	РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|ГДЕ
	|	УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация = &Организация
	|И УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник.ФизЛицо В (&СписокФизЛиц)
	|	";
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1",   СпособПоУмолчанию.СубконтоДт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1",   СпособПоУмолчанию.СубконтоДт1); 
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2",   СпособПоУмолчанию.СубконтоДт2); 
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3",   СпособПоУмолчанию.СубконтоДт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт",        СпособПоУмолчанию.СчетДт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ",      СпособПоУмолчанию.СчетДтНУ);
	Запрос.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	ТЗУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете = Запрос.Выполнить().Выгрузить();
	//Аверсон
	
	//Аверсон ЕАЕ 12.06.2020 СВФР-006057
	//(15)этот запрос вынесен из цикла
	ЗапросИндСтавкаНалогообл = Новый Запрос;
	ЗапросИндСтавкаНалогообл.Текст = 
	"ВЫБРАТЬ
	|	ИноеНалогообложениеПоСотрудникамСрезПоследних.Сотрудник,
	|   ИноеНалогообложениеПоСотрудникамСрезПоследних.ВидНалогообложения,
	|	ИноеНалогообложениеПоСотрудникамСрезПоследних.ФСЗН,
	|	ИноеНалогообложениеПоСотрудникамСрезПоследних.БГС
	|ИЗ
	|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
	|			&Период,
	|			Организация = &Организация
	//|				И ВидНалогообложения = &ВидНалогообложения
	//|				И Сотрудник = &Сотрудник
	|) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
	
	//ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
	ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
	ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
	//ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Сотрудник); 
	ТЗРезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
	//!!!
	//Аверсон
	// ПСА 21.09.2020 СВФР-006587 +++
	ТЗ_ЭтоДоговорПодряда = Новый ТаблицаЗначений;
	ТЗ_ЭтоДоговорПодряда.Колонки.Добавить("ФизЛицо");
	ТЗ_ЭтоДоговорПодряда.Колонки.Добавить("ЭтоДоговорПодряда");
	ТЗ_ЭтоДоговорПодряда.Колонки.Добавить("СчетДт"); //Аверсон 15.10.2020 КВВ СВФР-006691
	//выплаты из прибыли
	ЗапросСтатья = Новый Запрос;
	ЗапросСтатья.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация,
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваФСЗН3,
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваСтрах3
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
	ЗапросСтатья.УстановитьПараметр("Организация",Организация);
	Рез = ЗапросСтатья.Выполнить().Выбрать();
	СтатьяЗатратФСЗН = Неопределено;
	СтатьяЗатратСтрах = Неопределено;
	пока  Рез.Следующий() цикл
		СтатьяЗатратФСЗН = Рез.СубконтоРезерваФСЗН3;
		СтатьяЗатратСтрах = Рез.СубконтоРезерваСтрах3;
	КонецЦикла;
	// +++ПСА 21.09.2020 СВФР-006587 
	
	Для Каждого ТекСтрокаОтражениеВБУ Из ОтражениеВБУ Цикл
		СуммаУжеРаспределенная = ложь;
		//О.Т. Аверсон 25.03.2016 № 950
		ОбработкаПрерыванияПользователя();//О.Т. Аверсон 09.11.2017 № 1219
		
		СотрПрошл = "";
		ОснНач = ОсновныеНачисления.НайтиСтроки(Новый структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
		Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
		СписокСотрудников = Новый СписокЗначений;
		для Каждого стрОснНач из ОснНач Цикл 
			ПроверитьСотрудника = СписокСотрудников.НайтиПоЗначению(стрОснНач.Сотрудник);
			если ПроверитьСотрудника =  Неопределено Тогда
				если ОснНач <> СотрПрошл Тогда
					Сотрудник = стрОснНач.Сотрудник;
					СписокСотрудников.Добавить(Сотрудник); 
				КонецЕсли;
			КонецЕсли;
			СотрПрошл = стрОснНач.Сотрудник;
		КонецЦикла; 
		
		ОснНач = ДополнительныеНачисления.НайтиСтроки(Новый структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
		
		для Каждого стрОснНач из ОснНач Цикл 
			ПроверитьСотрудника = СписокСотрудников.НайтиПоЗначению(стрОснНач.Сотрудник);
			если ПроверитьСотрудника =  Неопределено Тогда 
				если ОснНач <> СотрПрошл Тогда
					Сотрудник = стрОснНач.Сотрудник;
					СписокСотрудников.Добавить(Сотрудник); 
				КонецЕсли;
			КонецЕсли;
			СотрПрошл = стрОснНач.Сотрудник;
		КонецЦикла;
		// ПСА 21.09.2020 СВФР-006587 --
		//ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
		Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
		иначе
			ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
		КонецЕсли;
		
		//Аверсон ЕАЕ 12.06.2020 СВФР-006057
		//(15) этот запрос вынесен из цикла !!!
		//ЗапросИндСтавкаНалогообл = Новый Запрос;
		//ЗапросИндСтавкаНалогообл.Текст = 
		//"ВЫБРАТЬ
		//|	ИноеНалогообложениеПоСотрудникамСрезПоследних.ФСЗН,
		//|	ИноеНалогообложениеПоСотрудникамСрезПоследних.БГС
		//|ИЗ
		//|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
		//|			&Период,
		//|			Организация = &Организация
		//|				И ВидНалогообложения = &ВидНалогообложения
		//|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
		//
		//ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
		//ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
		//ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
		//ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Сотрудник); 
		//РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
		//!!!
		СтрОтбора = Новый Структура;
		СтрОтбора.Вставить("Сотрудник", Сотрудник);
		СтрОтбора.Вставить("ВидНалогообложения", ВидНалогообложения);
		РезИндСтавкаНалогообл = ТЗРезИндСтавкаНалогообл.НайтиСтроки(СтрОтбора);
		//Аверсон
		
		ЕстьИндивидСтавка = Ложь;
		СтавкаФСЗНИнд = 0;
		СтавкаБГСИнд = 0;
		Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
			ЕстьИндивидСтавка = Истина;
			СтавкаФСЗНИнд = РезИндСтавкаНалогообл[0].ФСЗН;
			СтавкаБГСИнд = РезИндСтавкаНалогообл[0].БГС;
		КонецЕсли;
		
		Если ЕстьИндивидСтавка Тогда 
			СтавкаФСЗН = СтавкаФСЗНИнд;
			СтавкаФСЗНИнвалиды = СтавкаФСЗНИнд;
			СтавкаСтрах = СтавкаБГСИнд;
		иначе 
			СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).Размер;
			СтавкаФСЗНИнвалиды = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды,ВидНалогообложения)).Размер; 
			СтавкаСтрах = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Ставка;
		КонецЕсли;																					
		СтавкаЕдиныйПлатеж = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
		Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж,ВидНалогообложения)).Размер;
		
		//О.Т. Аверсон 25.03.2016 № 950
		
		//О.Т. 12.05.2015 № 428
		
		//Аверсон ЕАЕ 08.06.2020 СВФР-006057
		//!!!(1) этот запрос вынесен из цикла !!!!!!
		НеПравоНаПенсию = Ложь;
		ЗначениеИнойСтавки = 0;
		ФлагУчастникЕАЭС = Ложь;
		//Запрос = Новый Запрос;
		//Запрос.Текст  = 
		//"ВЫБРАТЬ
		//|	ГражданствоФизЛицСрезПоследних.ФизЛицо,
		//|	ГражданствоФизЛицСрезПоследних.Страна,
		//|	ГражданствоФизЛицСрезПоследних.НеИмеетПравоНаПенсию
		//|ИЗ
		//Аверсон ЕАЕ 04.06.2020
		//|	РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&Период, ) КАК ГражданствоФизЛицСрезПоследних
		//|	РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&Период, ФизЛицо = &ФизЛицо И НеИмеетПравоНаПенсию = ИСТИНА) КАК ГражданствоФизЛицСрезПоследних
		//|ГДЕ
		//|	ГражданствоФизЛицСрезПоследних.ФизЛицо = &ФизЛицо
		//|	И ГражданствоФизЛицСрезПоследних.НеИмеетПравоНаПенсию = ИСТИНА
		//Аверсон
		//|";
		//Запрос.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
		//Запрос.УстановитьПараметр("Период", ТекСтрокаОтражениеВБУ.ПериодРегистрации);//О.Т. 06.04.2015
		//Выборка = Запрос.Выполнить().Выбрать();
		
		//Аверсон ЕАЕ 04.06.2020
		//Пока Выборка.Следующий() цикл
		//	
		//	НеПравоНаПенсию =	Выборка.НеИмеетПравоНаПенсию;
		//	
		//КонецЦикла;
		//Если Выборка.Следующий() Тогда
		//	НеПравоНаПенсию = Истина;
		//КонецЕсли;
		//Аверсон
		//!!!
		
		СтрОтбора = Новый Структура;
		СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
		СтрОтбора.Вставить("ПериодРегистрации", ТекСтрокаОтражениеВБУ.ПериодРегистрации);
		МассивСтрок = ТЗГражданство.НайтиСтроки(СтрОтбора);
		Если МассивСтрок.Количество() > 0 Тогда
			НужнаяСтрока = МассивСтрок[0];
			НеПравоНаПенсию = НужнаяСтрока.НеИмеетПравоНаПенсию;
			ЗначениеИнойСтавки = НужнаяСтрока.ИнаяСтавка;
			ФлагУчастникЕАЭС = НужнаяСтрока.УчастникЕАЭС;
		КонецЕсли;
		//Аверсон
		
		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда
			МассивБаза = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
			Если МассивБаза.Количество()>0 Тогда 
				
			иначе
				//Аверсон ЕАЕ 12.06.2020 СВФР-006057
				//(16) этот запрос вынесен из цикла
				
				//Запрос = Новый Запрос;
				//Запрос.Текст = 
				//"ВЫБРАТЬ
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
				//|ИЗ
				//|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
				//|ГДЕ
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
				//|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник";
				//
				//Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
				//Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРегистрации));
				//Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
				//Запрос.УстановитьПараметр("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
				//Запрос.УстановитьПараметр("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
				//
				//ТЗРаспределСчета = Запрос.Выполнить().Выгрузить();
				
				//СтрОтбора = Новый Структура;
				//СтрОтбора.Вставить("Сотрудник", Сотрудник);
				//ТЗРаспределСчета = ТЗРаспределениеОсновногоЗаработкаРаботниковОрганизаций.НайтиСтроки(СтрОтбора); //(теперь это массив)
				//Аверсон
				
				СтрТЗОбщаяБазы = "";
				МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо)); 
				ТЗБазаРаспрДобавленные = Новый ТаблицаЗначений;
				ТЗБазаРаспрДобавленные.Колонки.Добавить("ФизЛицо");
				ТЗБазаРаспрДобавленные.Колонки.Добавить("СчетДт");   				
				ТЗБазаРаспрДобавленные.Колонки.Добавить("СубконтоДт2");   				
				ТЗБазаРаспрДобавленные.Колонки.Добавить("БазаФСЗН");
				ТЗБазаРаспрДобавленные.Колонки.Добавить("БазаБГС");
				ТЗБазаРаспрДобавленные.Колонки.Добавить("БазаЕдиный");
				ТЗБазаРаспрДобавленные.Колонки.Добавить("ВидРасчета");
				ТЗБазаРаспрДобавленные.Колонки.Добавить("ПериодДействия");//О.Т. Аверсон 20.07.2018 
				
				//О.Т. Аверсон 30.08.2018 № 2322
				ПроверкаКолСчетов = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета",ТекСтрокаОтражениеВБУ.ФизЛицо,ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда));
				КолСчетовПоДог = 0;
				СчетПрошл = "";
				Для Каждого стр из ПроверкаКолСчетов Цикл 
					Если СчетПрошл <> стр.СчетДт Тогда 
						КолСчетовПоДог = КолСчетовПоДог+1;
					КонецЕсли;   									
					СчетПрошл = стр.СчетДт;
				КонецЦикла;
				//О.Т. Аверсон 30.08.2018 № 2322
				
				
				
				Для Каждого СтрМассивСтрок из  МассивСтрок Цикл 
					Если не СтрМассивСтрок.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда 
						СчетДобавлен = Ложь;
						Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
							БазаФСЗН = СтрМассивСтрок.БазаФСЗНБУ;
						иначе
							БазаФСЗН = СтрМассивСтрок.БазаФСЗН;
						КонецЕсли;
						
						//Аверсон ЕАЕ 12.06.2020 СВФР-006057
						//МассивСтрокРаспр = ТЗРаспределСчета.НайтиСтроки(Новый Структура("СчетДт,СубконтоДт2",СтрМассивСтрок.СчетДт,СтрМассивСтрок.СубконтоДт2));
						МассивСтрокРаспр = ТЗРаспределениеОсновногоЗаработкаРаботниковОрганизаций.НайтиСтроки(Новый Структура("Сотрудник,СчетДт,СубконтоДт2",Сотрудник,СтрМассивСтрок.СчетДт,СтрМассивСтрок.СубконтоДт2));
						//Аверсон
						
						//Аверсон 09.09.2020 КВВ СВФР-006325 (
						Если ?(ТипЗнч(СтрМассивСтрок.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций"),истина,МассивСтрокРаспр.Количество()>0) 
							И ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаФСЗН,ВидРасчета",СтрМассивСтрок.ФизЛицо,БазаФСЗН,СтрМассивСтрок.ВидРасчета)).Количество()>0 
							И ЗначениеЗаполнено(МассивСтрокРаспр)
							И МассивСтрокРаспр[0].ДоляСпособаОтражения <> 100 Тогда 
						Иначе
							//Аверсон 09.09.2020 КВВ СВФР-006325 )
							
							//Аверсон 28.07.2020 КВВ СВФР-006325 ( закомментировано
							//Если ?(ТипЗнч(СтрМассивСтрок.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций"),истина,МассивСтрокРаспр.Количество()>0) и 
							//	ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаФСЗН,ВидРасчета",СтрМассивСтрок.ФизЛицо,БазаФСЗН,СтрМассивСтрок.ВидРасчета)).Количество()>0 Тогда 
							//иначе
							//Аверсон 28.07.2020 КВВ СВФР-006325 ) закомментировано
							
							//СВЭЙ 17.04.2024 КВВ СВФР-012659 (
							Если НеРаспределятьДопНачисления И 
								?(ТипЗнч(СтрМассивСтрок.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций"),Истина,МассивСтрокРаспр.Количество()>0) 
								и ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаФСЗН,ВидРасчета",СтрМассивСтрок.ФизЛицо,БазаФСЗН,СтрМассивСтрок.ВидРасчета)).Количество()>0 
								Тогда 
							иначе
								//СВЭЙ 17.04.2024 КВВ СВФР-012659 )
								
								Если ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",СтрМассивСтрок.ФизЛицо)).Количество()>0 Тогда 
									Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
										СтрТЗОбщаяБазы.БазаФСЗН = ?(СтрТЗОбщаяБазы.БазаФСЗН = Неопределено,0,СтрТЗОбщаяБазы.БазаФСЗН) + СтрМассивСтрок.БазаФСЗНБУ;
									иначе
										СтрТЗОбщаяБазы.БазаФСЗН = ?(СтрТЗОбщаяБазы.БазаФСЗН = Неопределено,0,СтрТЗОбщаяБазы.БазаФСЗН) + СтрМассивСтрок.БазаФСЗН;
									КонецЕсли;
									//СтрТЗОбщаяБазы.БазаБГС = СтрТЗОбщаяБазы.БазаБГС + ТекСтрокаОтражениеВБУ.БазаБГС; 
									Если МассивСтрокРаспр.Количество()=0 Тогда 
										//Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
										СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
										//КонецЕсли;
									КонецЕсли;
									СчетДобавлен = Истина;
									
								иначе
									СтрТЗОбщаяБазы = ТЗОбщаяБазы.Добавить();
									СтрТЗОбщаяБазы.ФизЛицо = СтрМассивСтрок.ФизЛицо;
									Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
										СтрТЗОбщаяБазы.БазаФСЗН = СтрМассивСтрок.БазаФСЗНБУ;
									иначе
										СтрТЗОбщаяБазы.БазаФСЗН = СтрМассивСтрок.БазаФСЗН;
									КонецЕсли;
									
									//СтрТЗОбщаяБазы.БазаБГС = ТекСтрокаОтражениеВБУ.БазаБГС; 
									Если МассивСтрокРаспр.Количество()=0 Тогда
										//Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
										СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
										//КонецЕсли;
									КонецЕсли;
									СчетДобавлен = Истина;
								КонецЕсли;
								СтрТЗБазаРаспрДобавленные = ТЗБазаРаспрДобавленные.Добавить();
								ЗаполнитьЗначенияСвойств(СтрТЗБазаРаспрДобавленные,СтрМассивСтрок);
								СтрТЗБазаРаспрДобавленные.БазаФСЗН = БазаФСЗН;
							КонецЕсли;
							//КонецЕсли;   //Аверсон 28.07.2020 КВВ СВФР-006325  закомментировано
						КонецЕсли; //Аверсон 09.09.2020 КВВ СВФР-006325
						Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
							БазаСтрах = СтрМассивСтрок.БазаСтрахБУ;
						иначе
							БазаСтрах = СтрМассивСтрок.БазаСтрах;
						КонецЕсли;
						
						//Аверсон 09.09.2020 КВВ СВФР-006325 (
						Если МассивСтрокРаспр.Количество()>0 
							И ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаБГС,ВидРасчета,ПериодДействия",СтрМассивСтрок.ФизЛицо,БазаСтрах,СтрМассивСтрок.ВидРасчета,СтрМассивСтрок.ПериодДействия)).Количество()>0 
							И ЗначениеЗаполнено(МассивСтрокРаспр)
							И МассивСтрокРаспр[0].ДоляСпособаОтражения <> 100 Тогда 
						Иначе
							//Аверсон 09.09.2020 КВВ СВФР-006325 )
							
							//Аверсон 19.08.2020 КВВ СВФР-006325 ( закомментировано
							//Если МассивСтрокРаспр.Количество()>0 и ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаБГС,ВидРасчета,ПериодДействия",СтрМассивСтрок.ФизЛицо,БазаСтрах,СтрМассивСтрок.ВидРасчета,СтрМассивСтрок.ПериодДействия)).Количество()>0 Тогда 
							//иначе
							//Аверсон 19.08.2020 КВВ СВФР-006325 ) закомментировано
							
							//СВЭЙ 17.04.2024 КВВ СВФР-012659 (
							Если НеРаспределятьДопНачисления И 
								?(ТипЗнч(СтрМассивСтрок.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций"),Истина,МассивСтрокРаспр.Количество()>0) 
								и ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаБГС,ВидРасчета",СтрМассивСтрок.ФизЛицо,БазаСтрах,СтрМассивСтрок.ВидРасчета)).Количество()>0 
								Тогда 
							иначе
								//СВЭЙ 17.04.2024 КВВ СВФР-012659 )
								
								Если ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",СтрМассивСтрок.ФизЛицо)).Количество()>0 Тогда 
									//СтрТЗОбщаяБазы.БазаФСЗН = СтрТЗОбщаяБазы.БазаФСЗН + ТекСтрокаОтражениеВБУ.БазаФСЗН;
									Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1  Тогда //О.Т. Аверсон 30.08.2018 № 2322
										СтрТЗОбщаяБазы.БазаБГС = ?(СтрТЗОбщаяБазы.БазаБГС = Неопределено,0,СтрТЗОбщаяБазы.БазаБГС) + СтрМассивСтрок.БазаСтрахБУ;
									иначе
										СтрТЗОбщаяБазы.БазаБГС = ?(СтрТЗОбщаяБазы.БазаБГС = Неопределено,0,СтрТЗОбщаяБазы.БазаБГС) + СтрМассивСтрок.БазаСтрах;
									КонецЕсли;
									
									
									Если не СчетДобавлен Тогда 
										
										Если МассивСтрокРаспр.Количество()=0 Тогда
											//Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
											СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
											//КонецЕсли;
										КонецЕсли;
									КонецЕсли;
									СчетДобавлен = Истина;
									
								иначе
									СтрТЗОбщаяБазы = ТЗОбщаяБазы.Добавить();
									СтрТЗОбщаяБазы.ФизЛицо = СтрМассивСтрок.ФизЛицо;
									//СтрТЗОбщаяБазы.БазаФСЗН = ТекСтрокаОтражениеВБУ.БазаФСЗН;
									Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
										СтрТЗОбщаяБазы.БазаБГС = СтрМассивСтрок.БазаСтрахБУ;
									иначе
										СтрТЗОбщаяБазы.БазаБГС = СтрМассивСтрок.БазаСтрах;
									КонецЕсли;
									
									Если не СчетДобавлен Тогда 
										Если МассивСтрокРаспр.Количество()=0 Тогда 
											//Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
											СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
											//КонецЕсли;
										КонецЕсли;
									КонецЕсли;
									СчетДобавлен = Истина;
								КонецЕсли;
								Если не СчетДобавлен Тогда 
									СтрТЗБазаРаспрДобавленные = ТЗБазаРаспрДобавленные.Добавить();
									ЗаполнитьЗначенияСвойств(СтрТЗБазаРаспрДобавленные,СтрМассивСтрок);
								КонецЕсли;             							
								СтрТЗБазаРаспрДобавленные.БазаБГС = БазаСтрах;
							КонецЕсли;
							//	КонецЕсли; //Аверсон 19.08.2020 КВВ СВФР-006325 закомментировано
						КонецЕсли; //Аверсон 09.09.2020 КВВ СВФР-006325
						//единый налог
						Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
							БазаЕдиныйПлатеж = СтрМассивСтрок.БазаЕдиныйПлатежБУ;
						иначе
							БазаЕдиныйПлатеж = СтрМассивСтрок.БазаЕдиныйПлатеж;
						КонецЕсли;
						Если МассивСтрокРаспр.Количество()>0 и ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаЕдиный,ВидРасчета,ПериодДействия",СтрМассивСтрок.ФизЛицо,БазаЕдиныйПлатеж,СтрМассивСтрок.ВидРасчета,СтрМассивСтрок.ПериодДействия)).Количество()>0 Тогда 
						иначе
							Если ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",СтрМассивСтрок.ФизЛицо)).Количество()>0 Тогда 
								//СтрТЗОбщаяБазы.БазаФСЗН = СтрТЗОбщаяБазы.БазаФСЗН + ТекСтрокаОтражениеВБУ.БазаФСЗН;
								Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
									СтрТЗОбщаяБазы.БазаЕдиный = ?(СтрТЗОбщаяБазы.БазаЕдиный = Неопределено,0,СтрТЗОбщаяБазы.БазаЕдиный) + СтрМассивСтрок.БазаЕдиныйПлатежБУ; 
								иначе
									СтрТЗОбщаяБазы.БазаЕдиный = ?(СтрТЗОбщаяБазы.БазаЕдиный = Неопределено,0,СтрТЗОбщаяБазы.БазаЕдиный) + СтрМассивСтрок.БазаЕдиныйПлатеж; 
								КонецЕсли;
								Если не СчетДобавлен Тогда 
									
									Если МассивСтрокРаспр.Количество()=0 Тогда 
										//Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
										СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
										//КонецЕсли;
									КонецЕсли;
								КонецЕсли;
								
							иначе
								СтрТЗОбщаяБазы = ТЗОбщаяБазы.Добавить();
								СтрТЗОбщаяБазы.ФизЛицо = СтрМассивСтрок.ФизЛицо;
								//СтрТЗОбщаяБазы.БазаФСЗН = ТекСтрокаОтражениеВБУ.БазаФСЗН;
								Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
									СтрТЗОбщаяБазы.БазаЕдиный = СтрМассивСтрок.БазаЕдиныйПлатежБУ; 
								иначе
									СтрТЗОбщаяБазы.БазаЕдиный = СтрМассивСтрок.БазаЕдиныйПлатеж; 
								КонецЕсли;
								
								Если не СчетДобавлен Тогда 
									Если МассивСтрокРаспр.Количество()=0 Тогда 
										//Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
										СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
										//КонецЕсли;
									КонецЕсли;
								КонецЕсли;
								
							КонецЕсли;
							Если не СчетДобавлен Тогда 
								СтрТЗБазаРаспрДобавленные = ТЗБазаРаспрДобавленные.Добавить();
								ЗаполнитьЗначенияСвойств(СтрТЗБазаРаспрДобавленные,СтрМассивСтрок);
							КонецЕсли;
							СтрТЗБазаРаспрДобавленные.БазаЕдиный = БазаЕдиныйПлатеж;
						КонецЕсли;
						
						
						
					КонецЕсли;
					
				КонецЦикла;
				МассивСтрок1 = ОтражениеВБУ.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
				//МасТЗОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",СтрМассивСтрок.ФизЛицо));
				МасТЗОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",?(СтрМассивСтрок=Неопределено,ТекСтрокаОтражениеВБУ.ФизЛицо,СтрМассивСтрок.ФизЛицо))); //Аверсон 15.11.2022 КВВ СВФР-009850
				
				
				Для Каждого стрМассив из МассивСтрок1 Цикл 
					Если не стрМассив.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда						
						Если МасТЗОбщаяБазы.Количество()>0 Тогда 
							МасТЗОбщаяБазы[0].КолСчетов = ?(МасТЗОбщаяБазы[0].КолСчетов=Неопределено,0,МасТЗОбщаяБазы[0].КолСчетов)+1;
						КонецЕсли;   						
					КонецЕсли; 					
				КонецЦикла;
				
			КонецЕсли;
			
		КонецЕсли;
		
		//О.Т. 27.04.2015 № 415
		
		//Аверсон ЕАЕ 08.06.2020 СВФР-006057
		//этот запрос вынесен из цикла и объединен с запросом (1)!!!
		//ЗапросГр = Новый Запрос;
		//ЗапросГр.Текст = 
		//"ВЫБРАТЬ
		//|	ГражданствоФизЛицСрезПоследних.Страна.УчастникЕАЭС КАК УчастникЕАЭС,
		//|	ГражданствоФизЛицСрезПоследних.ИнаяСтавка
		//|ИЗ
		//|	РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&Период, ФизЛицо = &ФизЛицо) КАК ГражданствоФизЛицСрезПоследних";
		//
		//ЗапросГр.УстановитьПараметр("Период", ТекСтрокаОтражениеВБУ.ПериодРегистрации);
		//ЗапросГр.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
		//РезультатЗапросаГр = ЗапросГр.Выполнить();		
		//ВыборкаДетальныеЗаписиГр = РезультатЗапросаГр.Выбрать();	
		//ФлагУчастникЕАЭС = Ложь;
		//ЗначениеИнойСтавки = 0;
		//Пока ВыборкаДетальныеЗаписиГр.Следующий() Цикл
		//	ФлагУчастникЕАЭС = ?(ВыборкаДетальныеЗаписиГр.УчастникЕАЭС = NULL, Ложь,ВыборкаДетальныеЗаписиГр.УчастникЕАЭС);		
		//	ЗначениеИнойСтавки = ВыборкаДетальныеЗаписиГр.ИнаяСтавка;
		//КонецЦикла;	
		//Аверсон
		
		Если ЕстьИндивидСтавка Тогда 
			СтавкаФСЗН = СтавкаФСЗНИнд;
		иначе
			если (ФлагУчастникЕАЭС и НеПравоНаПенсию) Тогда 
				СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
				Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды,ВидНалогообложения)).Размер;
			ИначеЕсли (ФлагУчастникЕАЭС и не НеПравоНаПенсию) или (ФлагУчастникЕАЭС = Ложь и НеПравоНаПенсию = Ложь) Тогда 
				СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
				Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).Размер;
			ИначеЕсли НеПравоНаПенсию и не ФлагУчастникЕАЭС Тогда 	
				СтавкаФСЗН = 0;
			КонецЕсли; 
			Если ЗначениеИнойСтавки > 0 Тогда 
				СтавкаФСЗН = ЗначениеИнойСтавки;
			КонецЕсли;
			
		КонецЕсли;
		
		//О.Т. 29.04.2015 № 415, 428
		
		СубконтоКредита = Перечисления.ВидыПлатежейВГосБюджет.Налог;
		ПроверкаТаблицы = ОтражениеВБУ.НайтиСтроки(Новый Структура("ФизЛицо,ПериодРегистрации",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.ПериодРегистрации));
		СуммаПроверка = 0;
		//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
		// Данный фрагмент построен конструктором.
		// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
		
		//Аверсон ЕАЕ 08.06.2020 СВФР-006057
		//!!!(6) этот запрос вынесен из цикла
		
		//ЗапросПодр = Новый Запрос;
		//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
		//ЗапросПодр.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
		//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
		//ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
		//
		//ЗапросПодр.Текст = 
		//"ВЫБРАТЬ
		//|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
		//|	КОНЕЦ КАК СубконтоДт1
		//|ИЗ
		//|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, ) КАК РаботникиОрганизацийСрезПоследних
		//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		//|		ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
		//|			И РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
		//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
		//|		ПО РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
		//|		И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации //О.Т. 01.09.2015
		//|ГДЕ";
		
		СтрОтбораПодр = Новый Структура;
		СтрОтбораПодр.Вставить("ПериодДействия", ТекСтрокаОтражениеВБУ.ПериодДействия);
		
		если ЗначениеЗаполнено(Сотрудник) Тогда 
			
			//ЗапросПодр.Текст = ЗапросПодр.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник в (&Физлицо)";
			//ЗапросПодр.УстановитьПараметр("Физлицо", Сотрудник);
			СтрОтбораПодр.Вставить("Сотрудник", Сотрудник);
		иначе
			//ЗапросПодр.Текст = ЗапросПодр.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо = &Физлицо";
			//ЗапросПодр.УстановитьПараметр("Физлицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			СтрОтбораПодр.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
		КонецЕсли;
		//ЗапросПодр.УстановитьПараметр("Период", ТекСтрокаОтражениеВБУ.ПериодДействия);
		МассивСтрокПодр = ТЗПодр.НайтиСтроки(СтрОтбораПодр);
		
		//РезультатЗапроса = ЗапросПодр.Выполнить();
		//
		//ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		//!!!
		//Аверсон
		
		Подразделение= "";
		ПродолжитьЦикл = Ложь;
		
		//Аверсон ЕАЕ 09.06.2020 СВФР-006057
		//Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Для Каждого ВыборкаДетальныеЗаписи Из МассивСтрокПодр Цикл
			//Аверсон
			Подразделение = ВыборкаДетальныеЗаписи.ПодразделениеОрганизации;
			если ТипЗнч(ТекСтрокаОтражениеВБУ.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда 
				если ЗначениеЗаполнено(ВыборкаДетальныеЗаписи.СубконтоДт1) Тогда 
					Подразделение = ВыборкаДетальныеЗаписи.СубконтоДт1;
				иначе
					Подразделение = ВыборкаДетальныеЗаписи.ПодразделениеОрганизации;
				КонецЕсли;
				
				если не Подразделение = ТекСтрокаОтражениеВБУ.субконтоДт1 Тогда
					если не СписокСотрудников.Количество()> 1 Тогда 
						Если не НалогиИзДокументаРасчетФзносовСФОТ Тогда 
							ПродолжитьЦикл = Истина;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
		если ПродолжитьЦикл Тогда
			Сообщить("Налоги, вероятно, посчитаны неверно по " + ТекСтрокаОтражениеВБУ.ФизЛицо.Наименование);//Когда есть к примеру кадровое перемещение по подразд
			Продолжить;
		КонецЕсли;
		//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
		
		//О.Т. Аверсон 06.04.2017 № 514
		
		//Аверсон ЕАЕ 08.06.2020 СВФР-006057
		//этот запрос вынесен из цикла (2) и (3)!!!
		Если ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда 
			//ЗапросФСЗНБГС = Новый Запрос;
			//ЗапросФСЗНБГС.Текст = 
			//"ВЫБРАТЬ
			////Аверсон ЕАЕ 04.06.2020
			////|	ЕСНИсчисленный.ФСЗН,
			//|	ЕСНИсчисленный.ФСЗНОборот КАК ФСЗН,
			////Аверсон
			//|	100 как ДоляСпособаОтражения
			//|ИЗ
			//
			////Аверсон ЕАЕ 04.06.2020
			////|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
			//|	РегистрНакопления.ЕСНИсчисленный.Обороты(&Период, &Период1, Авто, ФизЛицо = &ФизЛицо И Организация = &Организация) КАК ЕСНИсчисленный
			////Аверсон
			//
			//|ГДЕ
			//
			////Аверсон ЕАЕ 04.06.2020
			////|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
			////|	И ЕСНИсчисленный.Организация = &Организация
			////+ СВЭЙ КДЯ 13.11.19 СВФР-005042
			////|	И 
			////Аверсон
			//
			//|( НЕ &ПодразделениеЗаполнено 
			//|		ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение) )
			////- СВЭЙ КДЯ 13.11.19 СВФР-005042
			//
			////Аверсон ЕАЕ 04.06.2020
			////|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
			////Аверсон
			//
			//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) > НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, МЕСЯЦ) 
			//
			////Аверсон ЕАЕ 04.06.2020
			////|И ЕСНИсчисленный.ФСЗН <> 0";
			//|И ЕСНИсчисленный.ФСЗНОборот <> 0";
			
			
			СтрОтбора = Новый Структура;
			СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			
			//МассивСтрокЕСНИсчисленный = ТЗЕСНИсчисленныйРБПФСЗН.НайтиСтроки(СтрОтбора);
			МассивСтрокЕСНИсчисленный = ТЗЕСНИсчисленныйРБП.НайтиСтроки(СтрОтбора);
			//Аверсон
		иначе
			
			//Аверсон ЕАЕ 08.06.2020 СВФР-006057
			//	ЗапросФСЗНБГС = Новый Запрос;
			//	ЗапросФСЗНБГС.Текст = 
			//	"ВЫБРАТЬ
			//	
			//	//Аверсон ЕАЕ 04.06.2020
			//	//|	ЕСНИсчисленный.ФСЗН,
			//	|	ЕСНИсчисленный.ФСЗНОборот КАК ФСЗН,
			//	//Аверсон
			//	
			//	|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
			//	|ИЗ
			//	
			//	//Аверсон ЕАЕ 04.06.2020
			//	//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
			//	|	РегистрНакопления.ЕСНИсчисленный.Обороты(&Период, &Период1, Авто, ФизЛицо = &ФизЛицо И Организация = &Организация) КАК ЕСНИсчисленный
			//	//Аверсон
			//	
			//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
			//	|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
			//	|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
			//	|			И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
			//	|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
			//	|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
			//	|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2
			//	|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)";
			//	//О.Т. Аверсон 19.10.2017 № 1147
			//	Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1)  Тогда //О.Т. Аверсон 29.08.2018 № 2322 // и не ТипЗнч(ТекСтрокаОтражениеВБУ.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций")
			//		ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + " 
			//	|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1
			//	|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)";
			//	КонецЕсли;
			//    //О.Т. Аверсон 19.10.2017 № 1147
			//
			//	ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + "
			//	|ГДЕ
			//	
			//	//Аверсон ЕАЕ 04.06.2020
			//	//|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
			//	//|	И ЕСНИсчисленный.Организация = &Организация
			//	//Аверсон
			//	
			//	//+ СВЭЙ КДЯ 13.11.19 СВФР-005042
			//	//|	И 
			//	|( НЕ &ПодразделениеЗаполнено 
			//	|		ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение) )
			//	//- СВЭЙ КДЯ 13.11.19 СВФР-005042
			//	
			//	//Аверсон ЕАЕ 04.06.2020
			//	//|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
			//	//Аверсон
			//	
			//	|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодСекунда, МЕСЯЦ)
			//	
			//	//Аверсон ЕАЕ 04.06.2020
			//	//|	И ЕСНИсчисленный.ФСЗН <> 0";
			//	|	И ЕСНИсчисленный.ФСЗНОборот <> 0";
			//	//Аверсоно
			//КонецЕсли;
			//
			//ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
			//ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
			//ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
			//ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",ТекСтрокаОтражениеВБУ.СчетДт);
			//ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт2",ТекСтрокаОтражениеВБУ.СубконтоДт2);
			//ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт1",ТекСтрокаОтражениеВБУ.СубконтоДт1);
			////+ СВЭЙ КДЯ 13.11.19 СВФР-005042
			//ЗапросФСЗНБГС.УстановитьПараметр( "Подразделение", ПодразделениеОрганизации );
			//ЗапросФСЗНБГС.УстановитьПараметр( "ПодразделениеЗаполнено", ЗначениеЗаполнено( ПодразделениеОрганизации ) );
			////- СВЭЙ КДЯ 13.11.19 СВФР-005042
			//
			
			//ТЗЕСНИсчисленныйБезДопУсловияКопия = ТЗЕСНИсчисленныйБезДопУсловияФСЗН.Скопировать();
			//ТЗЕСНИсчисленныйСДопУсловиемКопия = ТЗЕСНИсчисленныйСДопУсловиемФСЗН.Скопировать();
			//ТЗЕСНИсчисленныйБезДопУсловияКопия = ТЗЕСНИсчисленныйБезДопУсловия.Скопировать();
			//ТЗЕСНИсчисленныйБезДопУсловияКопия.Сортировать("ФизЛицо,СчетДт,СубконтоДт2,ФСЗН возр");
			//ТЗЕСНИсчисленныйСДопУсловиемКопия = ТЗЕСНИсчисленныйСДопУсловием.Скопировать();
			//ТЗЕСНИсчисленныйСДопУсловиемКопия.Сортировать("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,ФСЗН возр");
			
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ПланыСчетов.Хозрасчетный.ПустаяСсылка());
			//
			//МассивСтрокСПустымСчетДт = ТЗЕСНИсчисленныйБезДопУсловияКопия.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСчетДт Цикл
			//	ЭлСтр.СчетДт = ТекСтрокаОтражениеВБУ.СчетДт;	
			//КонецЦикла;
			//
			//МассивСтрокСПустымСчетДт_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСчетДт_1 Цикл
			//	ЭлСтр.СчетДт = ТекСтрокаОтражениеВБУ.СчетДт;	
			//КонецЦикла;
			
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", 1);
			//
			//МассивСтрокСПустымСубконтоДт2 = ТЗЕСНИсчисленныйБезДопУсловияКопия.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт2 Цикл
			//	ЭлСтр.СубконтоДт2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;	
			//КонецЦикла;
			//
			//МассивСтрокСПустымСубконтоДт2_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт2_1 Цикл
			//	ЭлСтр.СубконтоДт2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;	
			//КонецЦикла;
			//
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			//
			//МассивСтрокБезДопУсловия = ТЗЕСНИсчисленныйБезДопУсловияКопия.НайтиСтроки(СтрОтбора);
			//
			//СтрОтбора.Вставить("СубконтоДт1", 1);
			//
			//МассивСтрокСПустымСубконтоДт1_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт1_1 Цикл
			//	ЭлСтр.СубконтоДт1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;	
			//КонецЦикла;
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			//СтрОтбора.Вставить("СубконтоДт1", ТекСтрокаОтражениеВБУ.СубконтоДт1);
			//
			//МассивСтрокСДопУсловием = ТЗЕСНИсчисленныйСДопУсловиемКопия.НайтиСтроки(СтрОтбора);
			
			//Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1) Тогда
			//	МассивСтрокЕСНИсчисленный = МассивСтрокСДопУсловием;
			//Иначе
			//	МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия;
			//КонецЕсли;
			
			СтрОтбора = Новый Структура;
			СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			
			МассивСтрокБезДопУсловия = ТЗЕСНИсчисленныйБезДопУсловия.НайтиСтроки(СтрОтбора);
			
			СтрОтбора.Вставить("СубконтоДт1", ТекСтрокаОтражениеВБУ.СубконтоДт1);
			
			МассивСтрокСДопУсловием = ТЗЕСНИсчисленныйСДопУсловием.НайтиСтроки(СтрОтбора);
			
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			ФлагУдалитьПовторы = Ложь;   
			Если МассивСтрокСДопУсловием.Количество() < МассивСтрокБезДопУсловия.Количество() Тогда 
				ФлагУдалитьПовторы = Истина;
			КонецЕсли;
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			
			Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1) Тогда
				МассивСтрокЕСНИсчисленный = МассивСтрокСДопУсловием;
			Иначе
				МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия;
			КонецЕсли;
		КонецЕсли;
		//РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
		//ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
		//Аверсон
		
		ЕстьПроцент = Ложь;
		
		//Аверсон ЕАЕ 16.06.2020 СВФР-006057
		//Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл 
		//	Если ЗначениеЗаполнено(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) Тогда 
		//		ЕстьПроцент = Истина;
		//	КонецЕсли;  			
		//КонецЦикла;
		Для Каждого ЭлСтр Из МассивСтрокЕСНИсчисленный Цикл
			Если ЗначениеЗаполнено(ЭлСтр.ДоляСпособаОтражения) Тогда
				ЕстьПроцент = Истина;
				Прервать;
			КонецЕсли;
		КонецЦикла;
		//Аверсон
		
		Если не НалогиИзДокументаРасчетФзносовСФОТ Тогда 
			//ОтражениеВБУДляБазы = Новый ТаблицаЗначений;
			МассивСтрокПоСчету = Новый Массив;
		иначе
			МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
		КонецЕсли;
		
		
		ЭтоОснНач = Ложь;
		Если МассивСтрокПоСчету.Количество()>0 Тогда 
			стрМассив = МассивСтрокПоСчету[0]; 
			ЭтоОснНач = ТипЗнч(стрМассив.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций");
		КонецЕсли;
		
		Если не ЕстьПроцент и ?(ОрганизацияИНН = "192798722",ЭтоОснНач, Истина) Тогда //и ЭтоОснНач //О.Т. Аверсон 25.03.2019 № 4135
			//Аверсон ЕАЕ 17.06.2020 СВФР-006057
			//ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1","");
			//ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)","");
			МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия; 
			//Аверсон
			
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			Если ФлагУдалитьПовторы Тогда
				УдалитьПовторяющиесяЭлементыМассива(МассивСтрокЕСНИсчисленный,4);
			КонецЕсли;
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
		КонецЕсли;
		
		//Аверсон ЕАЕ 17.06.2020 СВФР-006057
		//РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
		//ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
		//Аверсон
		
		БазаФСЗН = 0;
		БазаФСЗНПрошл = 0;
		БазаФСЗНПрошл1 = 0;
		ДоляСпособаОтраженияВТаблицеФСЗН = 0;
		
		//Аверсон ЕАЕ 17.06.2020 СВФР-006057
		//Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл
		Для Каждого ВыборкаДетальныеЗаписиФСЗНБГС Из МассивСтрокЕСНИсчисленный Цикл
			//Аверсон
			если ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН <> 0 Тогда
				КолСчетовИзОбщейБазы = 0;
				МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
				Если МассивОбщаяБазы.Количество()>0 Тогда 
					КолСчетовИзОбщейБазы = МассивОбщаяБазы[0].КолСчетов;
					Если МассивОбщаяБазы[0].СчетНеИзРаспределения <> Неопределено Тогда 
						МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
						БазаОбщаяФСЗН = 0;
						
						ПроверкаПериодДействияПрошл = "";
						ПроверкаБазаФСЗНПрошл = "";
						ПроверкаБазаФСЗННУПрошл = "";
						Для Каждого стрМассив из МассивСтрокПоСчету Цикл //О.Т. Аверсон 30.08.2018 № 2322  							  
							Если стрМассив.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда Тогда
								
								
								ПроверкаКолСчетов = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета",ТекСтрокаОтражениеВБУ.ФизЛицо,ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда));
								КолСчетовПоДог = 0;
								СчетПрошл = "";
								Субконто1Прошл = "";
								Для Каждого стр из ПроверкаКолСчетов Цикл 
									Если СчетПрошл <> стр.СчетДт или Субконто1Прошл <> стр.СубконтоДт1 Тогда 
										КолСчетовПоДог = КолСчетовПоДог+1;
									КонецЕсли;   									
									СчетПрошл = стр.СчетДт;
									Субконто1Прошл = стр.СубконтоДт1;
								КонецЦикла;
								
								Если КолСчетовПоДог>1 Тогда 
									Если ПроверкаПериодДействияПрошл <> стрМассив.ПериодДействия и ПроверкаБазаФСЗНПрошл <> стрМассив.БазаФСЗН и ПроверкаБазаФСЗННУПрошл = стрМассив.БазаФСЗНБУ Тогда 
										Продолжить;
									КонецЕсли;     																
								КонецЕсли;
								
								Если КолСчетовПоДог>1 Тогда 
									БазаОбщаяФСЗН = БазаОбщаяФСЗН + стрМассив.БазаФСЗНБУ;
								иначе
									БазаОбщаяФСЗН = БазаОбщаяФСЗН + стрМассив.БазаФСЗН;
								КонецЕсли;
								ПроверкаПериодДействияПрошл = стрМассив.ПериодДействия; 
								ПроверкаБазаФСЗНПрошл = стрМассив.БазаФСЗН;
								ПроверкаБазаФСЗННУПрошл = стрМассив.БазаФСЗНБУ;
							ИначеЕсли ТипЗнч(стрМассив.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") И НеРаспределятьДопНачисления Тогда//СВЭЙ 17.04.2024 КВВ СВФР-012659 (флаг НеРаспределятьДопНачисления) //и ОрганизацияИНН = "192798722" Тогда //О.Т. Аверсон 28.11.2018 № 2785
								БазаОбщаяФСЗН = БазаОбщаяФСЗН + стрМассив.БазаФСЗНБУ;	
							иначе
								БазаОбщаяФСЗН = БазаОбщаяФСЗН + стрМассив.БазаФСЗН;
							КонецЕсли;                  							
						КонецЦикла; 
						//БазаОбщаяФСЗН = БазаОбщаяФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						
						
						//УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаФСЗН=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаОбщаяФСЗН / МассивОбщаяБазы[0].БазаФСЗН * 100,ПериодРегистрации));
						УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаФСЗН=0,0,БазаОбщаяФСЗН / МассивОбщаяБазы[0].БазаФСЗН * 100);
						
						
						БазаФСЗН1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * УдельныйВесДляПропорции / 100;  
						
						БазаФСЗН = БазаФСЗН1	* ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						
						ДоляСпособаОтраженияВТаблицеФСЗН = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
						
						Если МассивОбщаяБазы[0].БазаФСЗН = 0 и БазаОбщаяФСЗН = 0 Тогда 
							МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда
								Если МассивДляУдельногоВеса[0].ПроцентыСумм <> 100 Тогда 
									БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
									УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
								КонецЕсли;
							иначе
								БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
								УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
							КонецЕсли;
						КонецЕсли;
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции;  
							Если БазаФСЗНПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							КонецЕсли;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
							Если БазаФСЗНПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
						КонецЕсли;
					иначе
						БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						БазаФСЗН1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
							МассивДляУдельногоВеса[0].ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);  
							Если БазаФСЗНПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							КонецЕсли;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
							Если БазаФСЗНПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
					
				иначе
					БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
					БазаФСЗН1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
				КонецЕсли;
				Если ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
					БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
					БазаФСЗН1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
				КонецЕсли;
				
				//Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
				//	МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
				//	КолСчетовОбщий = 0;
				//	Если МассивДляУдельногоВеса.Количество()>0 Тогда 
				//		УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
				//		КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
				//	КонецЕсли;
				
				//	
				//	МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
				//	Если МассивКорректировкаКопеек.Количество()>0 Тогда 
				//		
				//		МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
				//		Если  КолСчетовОбщий = КолСчетовИзОбщейБазы Тогда
				//			Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН Тогда
				//				БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации)-0.01; 							
				//			КонецЕсли;
				//			Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН Тогда
				//				БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации)+0.01; 							
				//			КонецЕсли;
				//		КонецЕсли;
				//		
				//	иначе
				//		СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
				//		СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
				//		СтрТЗКорректировкаКопеек.СуммаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
				//		СтрТЗКорректировкаКопеек.СуммаБГС = 0;
				//		СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
				//	КонецЕсли;
				//	
				//КонецЕсли;
			КонецЕсли;
			
			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
			//БазаФСЗНПрошл = БазаФСЗНПрошл + ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
			//БазаФСЗНПрошл = БазаФСЗНПрошл + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БазаФСЗН,,ТочностьРасчетов);   //Аверсон 05.08.2020 КВВ СВФР-006325 перенесено ниже в условие про ЭтоДоговорПодряда
			//Аверсон
			
			//+ Аверсон СМА 21.05.2020 СВФР-005914
			//БазаФСЗНПрошл1 = БазаФСЗНПрошл1 + ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН;
			
			//Аверсон 29.06.2020 КВВ СВФР-006178 ( 
			// ПСА 21.09.2020 СВФР-006587 +++
			
			//НайденныеСтроки = ТЗ_ЭтоДоговорПодряда.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо));
			НайденныеСтроки = ТЗ_ЭтоДоговорПодряда.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт",ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт)); //Аверсон 15.10.2020 КВВ СВФР-006691
			Если НайденныеСтроки.Количество() = 0 Тогда
				//ЭтоДоговорПодряда = ПроверкаДоговораПодряда(ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо, ПериодРегистрации);
				ЭтоДоговорПодряда = ПроверкаДоговораПодряда(ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо, ПериодРегистрации,ТекСтрокаОтражениеВБУ.СчетДт); //Аверсон 15.10.2020 КВВ СВФР-006691
				НоваяСтрокаТЗ = ТЗ_ЭтоДоговорПодряда.Добавить();
				НоваяСтрокаТЗ.ФизЛицо = ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо;
				НоваяСтрокаТЗ.ЭтоДоговорПодряда = ЭтоДоговорПодряда;
				НоваяСтрокаТЗ.СчетДт = ТекСтрокаОтражениеВБУ.СчетДт; //Аверсон 15.10.2020 КВВ СВФР-006691
			Иначе
				ЭтоДоговорПодряда = НайденныеСтроки[0].ЭтоДоговорПодряда;
			КонецЕсли;	
			// +++ПСА 21.09.2020 СВФР-006587	
			
			//Аверсон 15.10.2020 КВВ СВФР-006691 (
			Если ЭтоДоговорПодряда Тогда
				ЭтоДоговорПодряда = ?(СколькоСотрудниковФизЛица(ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо)>1,Ложь,Истина);	
			КонецЕсли;
			//Аверсон 15.10.2020 КВВ СВФР-006691 )
			
			//ПСА 03.02.2021 СВФР-007148+++
			//Если ЭтоДоговорПодряда Тогда
			Если ЭтоДоговорПодряда и МассивОбщаяБазы.Количество()> 0 и МассивОбщаяБазы[0].КолСчетов = 1 Тогда
				//+++ПСА 03.02.2021 СВФР-007148	
				БазаФСЗНПрошл1 = БазаФСЗНПрошл1 + ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН;
				БазаФСЗНПрошл = БазаФСЗНПрошл + ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН;   //Аверсон 05.08.2020 КВВ СВФР-006325
			Иначе
				//Аверсон 29.06.2020 КВВ СВФР-006178 )
				БазаФСЗНПрошл1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН;
				БазаФСЗНПрошл = БазаФСЗНПрошл + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БазаФСЗН,,ТочностьРасчетов);   //Аверсон 05.08.2020 КВВ СВФР-006325
			КонецЕсли;
			//-Аверсон СМА 21.05.2020 СВФР-005914
		КонецЦикла;
		БазаФСЗН = БазаФСЗНПрошл;
		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
			МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
			МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
			Для Каждого стрОбщБаза из МассивОбщаяБазы Цикл //стрОбщБаза.КолСчетов > 1 и
				//Аверсон ЕАЕ 17.06.2020 СВФР-006057
				//Если ВыборкаДетальныеЗаписиФСЗНБГС.Количество()=0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
				Если МассивСтрокЕСНИсчисленный.Количество()=0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
					//Аверсон	
					//Аверсон ЕАЕ 12.06.2020 СВФР-006057
					//(17) этот запрос вынесен из цикла
					//ЗапросБазаДляРаспр = Новый Запрос;
					//ЗапросБазаДляРаспр.Текст = 
					//"ВЫБРАТЬ
					//|	ЕСНИсчисленный.ФСЗН
					//|ИЗ
					//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
					//|ГДЕ
					//|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
					////+ СВЭЙ КДЯ 13.11.19 СВФР-005042
					//|	И ( НЕ &ПодразделениеЗаполнено 
					//|		ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение) )
					////- СВЭЙ КДЯ 13.11.19 СВФР-005042
					//|	И ЕСНИсчисленный.Организация = &Организация
					//|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
					//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)";
					//ЗапросБазаДляРаспр.УстановитьПараметр("Организация", Организация);
					//ЗапросБазаДляРаспр.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
					//ЗапросБазаДляРаспр.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
					//ЗапросБазаДляРаспр.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					////+ СВЭЙ КДЯ 13.11.19 СВФР-005042
					//ЗапросБазаДляРаспр.УстановитьПараметр( "Подразделение", ПодразделениеОрганизации );
					//ЗапросБазаДляРаспр.УстановитьПараметр( "ПодразделениеЗаполнено", ЗначениеЗаполнено( ПодразделениеОрганизации ) );
					////- СВЭЙ КДЯ 13.11.19 СВФР-005042
					//РезБазаДляРаспр = ЗапросБазаДляРаспр.Выполнить().Выгрузить();
					
					СтрОтбора = Новый Структура;
					СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					РезБазаДляРаспр = ТЗЕСНИсчисленныйРБПМеньше.НайтиСтроки(СтрОтбора);
					//Аверсон
					//!!!
					
					Если МассивДляУдельногоВеса.Количество()>0 Тогда 
						Если МассивДляУдельногоВеса[0].КолСчетовСумм+1 = стрОбщБаза.КолСчетов Тогда 
							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
							БазаПоСчету = 0;
							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаФСЗН;
							КонецЦикла; 
							
							СуммаДляРаспр = 0;
							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ФСЗН;
							КонецЦикла;
							СуммаУжеРаспределенная = Ложь;
							Если МассивДляУдельногоВеса[0].ПроцентыСумм >= 100 Тогда 
								УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,БазаПоСчету / стрОбщБаза.БазаФСЗН * 100);
							иначе
								УдельныйВесДляПропорции = 100-МассивДляУдельногоВеса[0].ПроцентыСумм;
								СуммаУжеРаспределенная = Истина;
							КонецЕсли;
							
							БазаФСЗН = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							БазаФСЗН1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							
							МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							иначе
								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
								СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
							
							
							
						иначе
							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
							БазаПоСчету = 0;
							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаФСЗН;
							КонецЦикла; 
							
							//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаФСЗН * 100,ПериодРегистрации));
							УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,БазаПоСчету / стрОбщБаза.БазаФСЗН * 100);
							СуммаДляРаспр = 0;
							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ФСЗН;
							КонецЦикла;
							
							БазаФСЗН = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							БазаФСЗН1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							
							МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							иначе
								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
								СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
							
							
						КонецЕсли;
					иначе
						МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
						БазаПоСчету = 0;
						Для Каждого стрмассивСтрок из МассивСтрок Цикл 
							БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаФСЗН;
						КонецЦикла; 
						
						//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаФСЗН * 100,ПериодРегистрации));
						УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,БазаПоСчету / стрОбщБаза.БазаФСЗН * 100);
						СуммаДляРаспр = 0;
						Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
							СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ФСЗН;
						КонецЦикла;
						
						БазаФСЗН = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
						БазаФСЗН1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
						
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
							МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
							СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
						КонецЕсли;
						
						
					КонецЕсли;
					
					
					//если БазаФСЗН <> 0 Тогда 
					//	Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
					//		МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
					//		КолСчетовОбщий = 0;
					//		Если МассивДляУдельногоВеса.Количество()>0 Тогда 
					//			УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
					//			КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
					//		КонецЕсли;
					//		
					//		МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
					//		Если МассивКорректировкаКопеек.Количество()>0 Тогда 
					//			
					//			МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
					//			Если  КолСчетовОбщий = стрОбщБаза.КолСчетов Тогда
					//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = СуммаДляРаспр Тогда
					//					БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации)-0.01; 							
					//				КонецЕсли;
					//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = СуммаДляРаспр Тогда
					//					БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации)+0.01; 							
					//				КонецЕсли;
					//			КонецЕсли;
					//			
					//		иначе
					//			СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
					//			СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
					//			СтрТЗКорректировкаКопеек.СуммаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
					//			СтрТЗКорректировкаКопеек.СуммаБГС = 0;
					//			СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
					//		КонецЕсли;
					//		
					//	КонецЕсли;
					//КонецЕсли;
					
					
				КонецЕсли;
				
			КонецЦикла;
		КонецЕсли;
		
		
		//О.Т. Аверсон 06.04.2017 № 514
		
		для Каждого стрПроверкаТаблицы из ПроверкаТаблицы Цикл 
			СуммаПроверка = СуммаПроверка + ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,стрПроверкаТаблицы.БазаФСЗНБУ);
		КонецЦикла;
		КоличествоСтрокПоФизЛицу = 0;
		если ((ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета) и не НалогиИзДокументаРасчетФзносовСФОТ Тогда //О.Т. 11.06.2015 №   //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
			КоличествоСтрокПоФизЛицу1 = ОтражениеВБУ.НайтиСтроки(Новый Структура("ФизЛицо,ПериодРегистрации,ВидРасчета",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.ПериодРегистрации,ТекСтрокаОтражениеВБУ.ВидРасчета));
		Иначе
			КоличествоСтрокПоФизЛицу1 = ОтражениеВБУ.НайтиСтроки(Новый Структура("ФизЛицо,ПериодРегистрации",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.ПериодРегистрации)); //Островская Татьяна 07.05.2014 № 17239
		КонецЕсли;
		для Каждого стрКоличествоСтрокПоФизЛицу из КоличествоСтрокПоФизЛицу1 Цикл 
			если ТипЗнч(стрКоличествоСтрокПоФизЛицу.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций") и ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,стрКоличествоСтрокПоФизЛицу.БазаФСЗН) > ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,стрКоличествоСтрокПоФизЛицу.БазаФСЗНБУ) Тогда 		
				
				ЗапросПодр = Новый Запрос;
				СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
				ЗапросПодр.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
				СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
				ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
				
				ЗапросПодр.Текст = 
				"ВЫБРАТЬ
				|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
				|	ВЫБОР
				|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
				|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
				|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
				|	КОНЕЦ КАК СубконтоДт1
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, ) КАК РаботникиОрганизацийСрезПоследних
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
				|		ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
				|			И РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
				|		ПО РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
				|		И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации //О.Т. 01.09.2015
				|ГДЕ";
				
				если ЗначениеЗаполнено(Сотрудник) Тогда 
					
					ЗапросПодр.Текст = ЗапросПодр.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник = &Физлицо";
					ЗапросПодр.УстановитьПараметр("Физлицо", Сотрудник);
				иначе
					ЗапросПодр.Текст = ЗапросПодр.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо = &Физлицо";
					ЗапросПодр.УстановитьПараметр("Физлицо", стрКоличествоСтрокПоФизЛицу.ФизЛицо);
				КонецЕсли;
				ЗапросПодр.УстановитьПараметр("Период", стрКоличествоСтрокПоФизЛицу.ПериодДействия);
				
				РезультатЗапроса = ЗапросПодр.Выполнить();
				
				ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
				Подразделение= "";
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					если ЗначениеЗаполнено(ВыборкаДетальныеЗаписи.СубконтоДт1) Тогда 
						Подразделение = ВыборкаДетальныеЗаписи.СубконтоДт1;
					иначе
						Подразделение = ВыборкаДетальныеЗаписи.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЦикла;
				
				если ЗначениеЗаполнено(Подразделение) Тогда 
					если Подразделение = стрКоличествоСтрокПоФизЛицу.СубконтоДт1 и ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,ТекСтрокаОтражениеВБУ.БазаФСЗН)<>0 Тогда 
						КоличествоСтрокПоФизЛицу = КоличествоСтрокПоФизЛицу +1;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
		КонецЦикла;
		
		
		
		//ФСЗН
		
		Если ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,ТекСтрокаОтражениеВБУ.БазаФСЗН) <> 0 Тогда
			
			РезультатПоИнвалидам = ПроверкаФизлицоНаИнвалидность(ТекСтрокаОтражениеВБУ.ФизЛицо).Выгрузить();
			
			Строка = ПромежуточнаяТаблица.Добавить();
			если ((ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета) и не НалогиИзДокументаРасчетФзносовСФОТ Тогда //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
				Строка.ВидРасчета = ТекСтрокаОтражениеВБУ.ВидРасчета;
			КонецЕсли;
			
			// ПСА 21.09.2020 СВФР-006587 --- вынесен из цикла
			////выплаты из прибыли
			//ЗапросСтатья = Новый Запрос;
			//ЗапросСтатья.Текст = 
			//"ВЫБРАТЬ
			//|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация,
			//|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваФСЗН3,
			//|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваСтрах3
			//|ИЗ
			//|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
			//|ГДЕ
			//|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
			//ЗапросСтатья.УстановитьПараметр("Организация",Организация);
			//Рез = ЗапросСтатья.Выполнить().Выбрать();
			//СтатьяЗатратФСЗН = Неопределено;
			//СтатьяЗатратСтрах = Неопределено;
			//пока  Рез.Следующий() цикл
			//	СтатьяЗатратФСЗН = Рез.СубконтоРезерваФСЗН3;
			//	СтатьяЗатратСтрах = Рез.СубконтоРезерваСтрах3;
			//КонецЦикла;
			//-- ПСА 21.09.2020 СВФР-006587
			
			//О.Т. Аверсон 14.04.2017 № 547
			НомерСубконто = 0;
			Для Каждого стрВидыСубконто из ТекСтрокаОтражениеВБУ.СчетДт.ВидыСубконто Цикл 
				Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
					НомерСубконто = стрВидыСубконто.НомерСтроки;							
				КонецЕсли;  						
			КонецЦикла;
			НомерСубконтоНУ = 0;
			Для Каждого стрВидыСубконто из ТекСтрокаОтражениеВБУ.СчетДтНУ.ВидыСубконто Цикл 
				Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
					НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
				КонецЕсли;  						
			КонецЦикла;
			//О.Т. Аверсон 14.04.2017 № 547
			
			Если ТекСтрокаОтражениеВБУ.СчетДт <> ПланыСчетов.Хозрасчетный.ВыплатыизПрибыли Тогда
				
				//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
				если не СтатьяЗатратФСЗН = Неопределено тогда
					
					если ТекСтрокаОтражениеВБУ.СубконтоДт3 = Неопределено тогда
						если ТекСтрокаОтражениеВБУ.СубконтоДт2 = Неопределено тогда
							если ТекСтрокаОтражениеВБУ.СубконтоДт1 = Неопределено тогда
								Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
								Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратФСЗН,Строка.СубконтоДт1);//О.Т. Аверсон 14.04.2017 № 547
							иначе
								
								Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
								//Островская Татьяна 14.10.2013 № 16849
								если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
									Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт1);
								иначе
									Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт1);
									Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт2);//О.Т. Аверсон 14.04.2017 № 547
								КонецЕсли;
								//Островская Татьяна 14.10.2013 № 16849
							КонецЕсли;
						иначе
							Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
							//Островская Татьяна 03.05.2013 № 16463
							//Островская Татьяна 14.10.2013 № 16849
							если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда 
								Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаФСС;
								Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
							иначе	
								Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт1);
								Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт2);
								Строка.СубконтоДт3		= ?(НомерСубконто = 3,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт3);//О.Т. Аверсон 14.04.2017 № 547
							КонецЕсли;
							//Островская Татьяна 14.10.2013 № 16849
							//Островская Татьяна 03.05.2013 № 16463
						КонецЕсли;
					иначе
						
						Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
						//Островская Татьяна 03.05.2013 № 16463
						если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
							Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаФСС;
						иначе
							Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт1);
						КонецЕсли;
						//Островская Татьяна 03.05.2013 № 16463
						Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт2);
						Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДт3);
					КонецЕсли;
				Иначе 
					Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
					//Островская Татьяна 03.05.2013 № 16463
					если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
						Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаФСС;
					иначе
						Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
					КонецЕсли;
					//Островская Татьяна 03.05.2013 № 16463
					Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
					Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
				КонецЕсли;
				//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
			Иначе	
				НайтиСтроки = ОсновныеСчетаСотрудников.Найти(ТекСтрокаОтражениеВБУ.ФизЛицо, "ФизЛицо");
				
				Если НайтиСтроки = Неопределено Тогда
					Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
					Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
					Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
					Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;				
				Иначе
					Если ТекСтрокаОтражениеВБУ.СчетДт <> НайтиСтроки.СчетДт Тогда
						Строка.СчетДт			= НайтиСтроки.СчетДт;
						Строка.СубконтоДт1		= НайтиСтроки.СубконтоДт1;
						Строка.СубконтоДт2		= НайтиСтроки.СубконтоДт2;
						Строка.СубконтоДт3		= НайтиСтроки.СубконтоДт3;
					иначе
						Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
						Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
						Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
						Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
			если не СтатьяЗатратФСЗН = Неопределено тогда
				если ТекСтрокаОтражениеВБУ.СубконтоДтНУ3 = Неопределено тогда
					если ТекСтрокаОтражениеВБУ.СубконтоДтНУ2 = Неопределено тогда
						если ТекСтрокаОтражениеВБУ.СубконтоДтНУ1 = Неопределено тогда
							Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
							Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,Строка.СубконтоДтНУ1);//О.Т. Аверсон 14.04.2017 № 547
						иначе
							Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
							//Островская Татьяна 14.10.2013 № 16849
							если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
								Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ1);
							иначе
								Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ1);
								Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);//О.Т. Аверсон 14.04.2017 № 547
							КонецЕсли;
							//Островская Татьяна 14.10.2013 № 16849 
						КонецЕсли;
					Иначе 
						Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
						//Островская Татьяна 03.05.2013 № 16463
						//Островская Татьяна 14.10.2013 № 16849
						если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
							Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаФСС;
							Строка.СубконтоДтНУ2	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ2; 
						иначе
							Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ1);
							Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);
							Строка.СубконтоДтНУ3	= ?(НомерСубконтоНУ = 3,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ3);//О.Т. Аверсон 14.04.2017 № 547 
						КонецЕсли;
						//Островская Татьяна 14.10.2013 № 16849
						//Островская Татьяна 03.05.2013 № 16463  
					КонецЕсли;
				иначе
					Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
					//Островская Татьяна 03.05.2013 № 16463
					если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
						Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаФСС;
					иначе
						Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ1);
					КонецЕсли;
					//Островская Татьяна 03.05.2013 № 16463
					Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);
					
					Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратФСЗН,ТекСтрокаОтражениеВБУ.СубконтоДтНУ3);
					
				КонецЕсли;
			иначе
				Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
				//Островская Татьяна 03.05.2013 № 16463
				если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
					Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаФСС;
				иначе
					Строка.СубконтоДтНУ1	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ1;
				КонецЕсли;
				//Островская Татьяна 03.05.2013 № 16463
				Строка.СубконтоДтНУ2	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ2;
				Строка.СубконтоДтНУ3	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ3;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
			
			ЕстьРаспределение = Ложь;
			если ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
				//Аверсон ЕАЕ 17.06.2020 СВФР-006057
				//(11) этот запрос вынесен из цикла
				
				//ЗапросДля000 = Новый Запрос;
				//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
				//ЗапросДля000.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
				//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
				//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1); 
				//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2); 
				//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
				//
				//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
				//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
				//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
				//
				//
				//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
				//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
				//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ", СпособПоУмолчанию.СчетДтНУ);
				//
				//
				//ЗапросДля000.Текст = 
				//"ВЫБРАТЬ
				//|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
				//|	ВЫБОР
				//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
				//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
				//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
				//|	КОНЕЦ КАК СубконтоДт1,
				//|	ВЫБОР
				//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
				//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
				//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
				//|	КОНЕЦ КАК СчетДт,
				//|	ВЫБОР
				//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
				//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
				//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
				//|	КОНЕЦ КАК СубконтоДт2,
				//|	ВЫБОР
				//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
				//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
				//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
				//|	КОНЕЦ КАК СубконтоДт3,
				//|	ВЫБОР
				//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
				//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
				//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
				//|	КОНЕЦ КАК СубконтоДтНУ1,
				//|	ВЫБОР
				//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
				//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
				//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
				//|	КОНЕЦ КАК СубконтоДтНУ2,
				//|	ВЫБОР
				//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
				//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
				//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
				//|	КОНЕЦ КАК СубконтоДтНУ3,
				//|	ВЫБОР
				//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
				//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
				//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
				//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДтНУ
				//|	КОНЕЦ КАК СчетДтНУ
				//|ИЗ
				//|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, ) КАК РаботникиОрганизацийСрезПоследних
				//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
				//|		ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
				//|			И РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
				//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
				//|		ПО РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
				//|			И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации
				//|ГДЕ
				//|	";
				
				СтрОтбораПодр = Новый Структура;
				СтрОтбораПодр.Вставить("ПериодДействия", КонецМесяца(ТекСтрокаОтражениеВБУ.ПериодДействия));
				
				если ЗначениеЗаполнено(Сотрудник) Тогда 
					
					//ЗапросДля000.Текст = ЗапросДля000.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник в (&Физлицо)";
					//ЗапросДля000.УстановитьПараметр("Физлицо", Сотрудник);
					
					СтрОтбораПодр.Вставить("Сотрудник", Сотрудник);
				иначе
					//ЗапросДля000.Текст = ЗапросДля000.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо = &Физлицо";
					//ЗапросДля000.УстановитьПараметр("Физлицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					
					СтрОтбораПодр.Вставить("Физлицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
				КонецЕсли;
				
				//ЗапросДля000.УстановитьПараметр("Период", КонецМесяца(ТекСтрокаОтражениеВБУ.ПериодДействия));
				//РезультатДля000 = ЗапросДля000.Выполнить().Выгрузить();
				
				РезультатДля000 = ТЗПодрКонецМесяца.НайтиСтроки(СтрОтбораПодр);
				//Аверсон
				
				//Аверсон ЕАЕ 17.06.2020 СВФР-006057
				//(12) этот запрос вынесен из цикла
				
				//Запрос = Новый Запрос;
				//Запрос.Текст = 
				//"ВЫБРАТЬ
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
				//|ИЗ
				//|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
				//|ГДЕ
				//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
				//|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник";
				//
				//Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
				//Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРегистрации));
				//Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
				
				СтрОтбора = Новый Структура;
				СтрОтбора.Вставить("Сотрудник", Сотрудник);
				
				ТЗРаспределСчетаМассив = ТЗРаспределениеОсновногоЗаработкаРаботниковОрганизаций.НайтиСтроки(СтрОтбора);
				
				//ТЗРаспределСчета = Запрос.Выполнить().Выгрузить();
				//Аверсон
				
				//Аверсон ЕАЕ 17.06.2020
				//Если ТЗРаспределСчета.Количество()>0 Тогда
				Если ТЗРаспределСчетаМассив.Количество()>0 Тогда 
					ЕстьРаспределение = истина;
					//РезультатДля000 = ТЗРаспределСчета;
					РезультатДля000 = ТЗРаспределСчетаМассив;
				КонецЕсли;
				//Аверсон
				
				Сч = 0;
				ОбщаяСуммаРаспределения = 0;
				ОбщаяСумма = 0;
				Для Каждого стр из РезультатДля000 Цикл
					Если сч > 0 Тогда 
						Строка = ПромежуточнаяТаблица.Добавить();
						если ((ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета) и не НалогиИзДокументаРасчетФзносовСФОТ Тогда  //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
							Строка.ВидРасчета = ТекСтрокаОтражениеВБУ.ВидРасчета;
						КонецЕсли;
						
					КонецЕсли;
					
					//О.Т. Аверсон 14.04.2017 № 547
					НомерСубконто = 0;
					Для Каждого стрВидыСубконто из стр.СчетДт.ВидыСубконто Цикл 
						Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
							НомерСубконто = стрВидыСубконто.НомерСтроки;							
						КонецЕсли;  						
					КонецЦикла;
					НомерСубконтоНУ = 0;
					Для Каждого стрВидыСубконто из стр.СчетДтНУ.ВидыСубконто Цикл 
						Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
							НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
						КонецЕсли;  						
					КонецЦикла;
					//О.Т. Аверсон 14.04.2017 № 547
					
					
					//О.Т. Аверсон 26.01.2018 № 1502
					ЗапросОсн = Новый Запрос;
					ЗапросОсн.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
					если ЗначениеЗаполнено(Сотрудник) Тогда
						ЗапросОсн.Текст = 
						"ВЫБРАТЬ
						|	ТЧ.ФизЛицо,
						|	ТЧ.СубконтоДт1,
						|	ТЧ.СубконтоДт2,
						|	ТЧ.СубконтоДт3,
						|	ТЧ.СубконтоДтНУ1,
						|	ТЧ.СубконтоДтНУ2,
						|	ТЧ.СубконтоДтНУ3
						|	ПОМЕСТИТЬ ВТОсн
						|ИЗ
						|	&ТЧОсновные КАК ТЧ
						|ГДЕ
						|	ТЧ.СчетДт = &СчетДт
						|	И &Период МЕЖДУ ТЧ.ПериодДействияНачало И ТЧ.ПериодДействияКонец
						|	И ТЧ.Сотрудник = &Сотрудник";
						ЗапросОсн.УстановитьПараметр("Сотрудник",Сотрудник);
						ЗапросОсн.УстановитьПараметр("СчетДт",стр.СчетДт);
						ЗапросОсн.УстановитьПараметр("Период",ТекСтрокаОтражениеВБУ.ПериодДействия);
						ЗапросОсн.УстановитьПараметр("ТЧОсновные",ОсновныеНачисления);
						ЗапросОсн.Выполнить();
						ЗапросОсн.Текст = 
						"ВЫБРАТЬ
						|	ТЧ.ФизЛицо,
						|	ТЧ.СубконтоДт1,
						|	ТЧ.СубконтоДт2,
						|	ТЧ.СубконтоДт3,
						|	ТЧ.СубконтоДтНУ1,
						|	ТЧ.СубконтоДтНУ2,
						|	ТЧ.СубконтоДтНУ3
						|ИЗ ВТОсн как ТЧ";
						
					иначе
						ЗапросОсн.Текст = 
						"ВЫБРАТЬ
						|	ТЧ.ФизЛицо,
						|	ТЧ.СубконтоДт1,
						|	ТЧ.СубконтоДт2,
						|	ТЧ.СубконтоДт3,
						|	ТЧ.СубконтоДтНУ1,
						|	ТЧ.СубконтоДтНУ2,
						|	ТЧ.СубконтоДтНУ3
						|	ПОМЕСТИТЬ ВТОсн
						|ИЗ
						|	&ТЧОсновные КАК ТЧ
						|ГДЕ
						|	ТЧ.СчетДт = &СчетДт
						|	И &Период МЕЖДУ ТЧ.ПериодДействияНачало И ТЧ.ПериодДействияКонец
						|	И ТЧ.ФизЛицо = &ФизЛицо";
						ЗапросОсн.УстановитьПараметр("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо);
						ЗапросОсн.УстановитьПараметр("СчетДт",стр.СчетДт);
						ЗапросОсн.УстановитьПараметр("Период",ТекСтрокаОтражениеВБУ.ПериодДействия);
						ЗапросОсн.УстановитьПараметр("ТЧОсновные",ОсновныеНачисления);
						ЗапросОсн.Выполнить();
						ЗапросОсн.Текст = 
						"ВЫБРАТЬ
						|	ТЧ.ФизЛицо,
						|	ТЧ.СубконтоДт1,
						|	ТЧ.СубконтоДт2,
						|	ТЧ.СубконтоДт3,
						|	ТЧ.СубконтоДтНУ1,
						|	ТЧ.СубконтоДтНУ2,
						|	ТЧ.СубконтоДтНУ3
						|ИЗ ВТОсн как ТЧ";
						
						
					КонецЕсли;
					РезЗапросОсн = ЗапросОсн.Выполнить().Выбрать();
					Если РезЗапросОсн.Следующий() Тогда 
						Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДт1);
						Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДт2);
						Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДт3);
						Если ЗначениеЗаполнено( стр.СчетДтНУ) Тогда
							Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДтНУ1);
							Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДтНУ2);
							Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДтНУ3);
						КонецЕсли;
					иначе 
						ЗапросОсн.Текст = 
						"ВЫБРАТЬ
						|	ТЧ.ФизЛицо,
						|	ТЧ.СубконтоДт1,
						|	ТЧ.СубконтоДт2,
						|	ТЧ.СубконтоДт3,
						|	ТЧ.СубконтоДтНУ1,
						|	ТЧ.СубконтоДтНУ2,
						|	ТЧ.СубконтоДтНУ3
						|	ПОМЕСТИТЬ ВТДоп
						|ИЗ
						|	&ТЧДополит КАК ТЧ
						|ГДЕ
						|	ТЧ.СчетДт = &СчетДт
						|	И ТЧ.Сотрудник = &Сотрудник";
						ЗапросОсн.УстановитьПараметр("ТЧДополит", ДополнительныеНачисления);
						ЗапросОсн.Выполнить();
						
						ЗапросОсн.Текст = 
						"ВЫБРАТЬ
						|	ТЧ.ФизЛицо,
						|	ТЧ.СубконтоДт1,
						|	ТЧ.СубконтоДт2,
						|	ТЧ.СубконтоДт3,
						|	ТЧ.СубконтоДтНУ1,
						|	ТЧ.СубконтоДтНУ2,
						|	ТЧ.СубконтоДтНУ3
						|ИЗ ВТДоп как ТЧ";
						РезЗапросОсн = ЗапросОсн.Выполнить().Выбрать();
						Если РезЗапросОсн.Следующий() Тогда
							Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДт1);
							Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДт2);
							Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДт3);
							Если ЗначениеЗаполнено( стр.СчетДтНУ) Тогда
								Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДтНУ1);
								Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДтНУ2);
								Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратФСЗН,РезЗапросОсн.СубконтоДтНУ3);
							КонецЕсли;
							
						иначе	
							Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратФСЗН,стр.СубконтоДт1);
							Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратФСЗН,стр.СубконтоДт2);
							Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратФСЗН,стр.СубконтоДт3);
							Если ЗначениеЗаполнено( стр.СчетДтНУ) Тогда 
								Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,стр.СубконтоДтНУ1);
								Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратФСЗН,стр.СубконтоДтНУ2);
								Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратФСЗН,стр.СубконтоДтНУ3);
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					//О.Т. Аверсон 26.01.2018 № 1502
					
					Строка.СчетДт = стр.СчетДт;
					Строка.СчетДтНУ = стр.СчетДтНУ;
					
					
					Если ЕстьРаспределение Тогда 
						Строка.СчетКт = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
						Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;//О.Т. Аверсон 25.03.2016 № 950
						Строка.СубконтоКт1 = СубконтоКредита;
						Строка.СчетКтНУ	= РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
						Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 25.03.2016 № 950
						//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
						
						СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 25.03.2016 № 950
						//Островская Татьяна 10.09.2013 № 16725
						РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ТекСтрокаОтражениеВБУ.ПериодРегистрации) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
						//Островская Татьяна 10.09.2013 № 16725
						БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
						//Островская Татьяна 07.05.2014 № 17239
						если НалогиИзДокументаРасчетФзносовСФОТ Тогда //О.Т. Аверсон 06.04.2017 № 514
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
							Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БазаФСЗН,,ТочностьРасчетов);
							//Аверсон
						иначе
							
							если КоличествоСтрокПоФизЛицу>1 Тогда 
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
								Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);
								//Аверсон
							иначе
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
								Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
								//Аверсон
							КонецЕсли;
							//Островская Татьяна 07.05.2014 № 17239
							
							
							//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
							
							Если РезультатПоИнвалидам.Количество() = 0 Тогда
								//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
								//Островская Татьяна 07.05.2014 № 17239
								если КоличествоСтрокПоФизЛицу>1 Тогда
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
									Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
									//Аверсон
								иначе
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
									Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
									//Аверсон
								КонецЕсли;
								//Островская Татьяна 07.05.2014 № 17239
								//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
							Иначе
								Если РезультатПоИнвалидам[0].Группа = 1 тогда
									//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
									//Островская Татьяна 07.05.2014 № 17239
									если КоличествоСтрокПоФизЛицу>1 Тогда
										//Аверсон ЕАЕ 16.06.2020 СВФР-006057
										//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
										Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
										//Аверсон
									иначе
										//Аверсон ЕАЕ 16.06.2020 СВФР-006057
										//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
										Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
										//Аверсон
									КонецЕсли;
									//Островская Татьяна 07.05.2014 № 17239
									//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
									//Сообщить("инвалид: " + ТекСтрокаОтражениеВБУ.ФизЛицо.Наименование);
								Иначе
									//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
									//Островская Татьяна 07.05.2014 № 17239
									если КоличествоСтрокПоФизЛицу>1 Тогда
										//Аверсон ЕАЕ 16.06.2020 СВФР-006057
										//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
										Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
										//Аверсон
									иначе
										//Аверсон ЕАЕ 16.06.2020 СВФР-006057
										//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
										Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
										//Аверсон
									КонецЕсли;
									//Островская Татьяна 07.05.2014 № 17239
									
									//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
								КонецЕсли;
							КонецЕсли;
							
							
							
							
						КонецЕсли;
						Если сч = 0 Тогда 
							ОбщаяСумма = Строка.Сумма;
						КонецЕсли;
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма * Стр.ДоляСпособаОтражения/100,ПериодРегистрации);
						Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма * Стр.ДоляСпособаОтражения/100,,ТочностьРасчетов);
						//Аверсон
						Строка.СуммаДолиРаспред = ?(Стр.ДоляСпособаОтражения=100,0,Строка.Сумма); //Аверсон 10.09.2020 КВВ СВФР-006325
						
						ОбщаяСуммаРаспределения = ОбщаяСуммаРаспределения + Строка.Сумма;
						Если ОбщаяСумма <> ОбщаяСуммаРаспределения и сч+1 = РезультатДля000.Количество() Тогда 
							Строка.Сумма = Строка.Сумма + (ОбщаяСумма-ОбщаяСуммаРаспределения);
						КонецЕсли;
						
						Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
							МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							КолСчетовОбщий = 0;
							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
								УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
								КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
							КонецЕсли;
							
							МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивКорректировкаКопеек.Количество()>0 Тогда 
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации);
								МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов);
								//Аверсон
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации) 
								//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации) 
								Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаФСЗН,,ТочностьРасчетов)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,БазаФСЗН1,СуммаДляРаспр),,ТочностьРасчетов) 
									//Аверсон
									
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
									//или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
									или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаФСЗН,,ТочностьРасчетов)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН,СуммаДляРаспр),,ТочностьРасчетов) Тогда
									//Аверсон
									
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации)-0.01; 
									Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов)-0.01; 	
									//Аверсон
									
									МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН -0.01;									
								КонецЕсли;
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации)
								//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
								//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации)
								//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
								Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаФСЗН,,ТочностьРасчетов)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,БазаФСЗН1,СуммаДляРаспр),,ТочностьРасчетов)
									или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаФСЗН,,ТочностьРасчетов)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН,СуммаДляРаспр),,ТочностьРасчетов) Тогда
									//Аверсон
									
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации)+0.01; 
									Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов)+0.01;
									//Аверсон
									
									МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН +0.01;									
								КонецЕсли;
								//Если МассивКорректировкаКопеек[0].ДоляСпособаОтраженияФСЗН>=100 Тогда 
								//	МассивКорректировкаКопеек[0].СуммаФСЗН = 0;
								//	МассивКорректировкаКопеек[0].ДоляСпособаОтраженияФСЗН = 0;
								//КонецЕсли;								
								
							иначе
								СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
								СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗКорректировкаКопеек.СуммаФСЗН = Строка.Сумма;
								СтрТЗКорректировкаКопеек.СуммаБГС = 0;
								СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;								
								//Если СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН>=100 Тогда 
								//	СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
								//	СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = 0;
								//КонецЕсли;
								
								//+ СВЭЙ КДЯ 23.05.19 СВФР-004375
								СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = 0;
								СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС = 0;								
								//- СВЭЙ КДЯ 23.05.19 СВФР-004375
							КонецЕсли;
							
							//О.Т. Аверсон 31.08.2018 № 2322
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН),СуммаДляРаспр),ПериодРегистрации);
							//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),СуммаДляРаспр),ПериодРегистрации);
							
							//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),СуммаДляРаспр),,ТочностьРасчетов);
							СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0, ?(МассивСтрокЕСНИсчисленный.Количество()=1,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),?(ЗначениеЗаполнено(БазаФСЗНПрошл),БазаФСЗНПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН))   ,СуммаДляРаспр),,ТочностьРасчетов); //Аверсон 26.08.2020 КВВ СВФР-006325
							
							//Аверсон
							
							МассивКорректировкаКопеек = ТЗКорректировкаКопеекПоИтогу.НайтиСтроки(Новый Структура("ФизЛицо,СуммаСравненияФСЗН",ТекСтрокаОтражениеВБУ.ФизЛицо,СуммаОбщая));
							Если МассивКорректировкаКопеек.Количество()>0 Тогда 
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации);
								МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов);
								//Аверсон
								
								//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
								//МассивКорректировкаКопеек[0].Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
								//МассивКорректировкаКопеек[0].Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
								//МассивКорректировкаКопеек[0].Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
								//- СВЭЙ КДЯ 01.06.19 СВФР-004379
								
								//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
								СтрКорр = МассивКорректировкаКопеек[0];
								Если ЭтоУточнениеНабораСубконто( СтрКорр, ТекСтрокаОтражениеВБУ ) Тогда
									
									СтрКорр.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
									СтрКорр.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
									СтрКорр.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
									
								КонецЕсли;
								//- СВЭЙ КДЯ 01.06.19 СВФР-004379
								
							иначе								
								СтрТЗКорректировкаКопеекПоИтогу = ТЗКорректировкаКопеекПоИтогу.Добавить();
								СтрТЗКорректировкаКопеекПоИтогу.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗКорректировкаКопеекПоИтогу.СуммаФСЗН = Строка.Сумма;
								СтрТЗКорректировкаКопеекПоИтогу.СуммаБГС = 0;
								СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = 0;
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН),СуммаДляРаспр),ПериодРегистрации);
								//СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),СуммаДляРаспр),ПериодРегистрации);
								//Аверсон 10.09.2020 КВВ СВФР-006325 (
								Если Строка.СуммаДолиРаспред <> 0 Тогда 
									СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = Строка.СуммаДолиРаспред;
								Иначе
									//Аверсон 10.09.2020 КВВ СВФР-006325)
									СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл),БазаФСЗНПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),СуммаДляРаспр),,ТочностьРасчетов);  
								КонецЕсли;
								//Аверсон
								
								СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = 0;
								СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияЕдиныйПлатеж = 0;
								СтрТЗКорректировкаКопеекПоИтогу.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
								СтрТЗКорректировкаКопеекПоИтогу.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
								СтрТЗКорректировкаКопеекПоИтогу.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
								
							КонецЕсли;
							//О.Т. Аверсон 31.08.2018 № 2322
							
						КонецЕсли;
						
						//+ СВЭЙ КДЯ 06.06.19 СВФР-004427
						Если Строка.СчетКт = СчетКтФСЗН Тогда
							Строка.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
						КонецЕсли; 
						//- СВЭЙ КДЯ 06.06.19 СВФР-004427
						
						Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
					КонецЕсли;
					Сч = Сч + 1;
					
				КонецЦикла;
				Если РезультатДля000.Количество() = 0 Тогда
					//Аверсон ЕАЕ 17.06.2020 СВФР-006057
					//(13) Этот запрос вынесен из цикла
					
					//ЗапросДля000.Текст = 
					//"ВЫБРАТЬ
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
					//|	КОНЕЦ КАК СубконтоДт1,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
					//|	КОНЕЦ КАК СчетДт,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
					//|	КОНЕЦ КАК СубконтоДт2,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
					//|	КОНЕЦ КАК СубконтоДт3,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
					//|	КОНЕЦ КАК СубконтоДтНУ1,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
					//|	КОНЕЦ КАК СубконтоДтНУ2,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
					//|	КОНЕЦ КАК СубконтоДтНУ3,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДтНУ
					//|	КОНЕЦ КАК СчетДтНУ
					//|ИЗ
					//|	РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
					//|ГДЕ
					//|	УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация = &Организация
					//|	";
					
					СтрОтбора = Новый Структура;
					
					если ЗначениеЗаполнено(Сотрудник) Тогда 
						
						//ЗапросДля000.Текст = ЗапросДля000.Текст + "	И УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник в (&Физлицо)";
						//ЗапросДля000.УстановитьПараметр("Физлицо", Сотрудник);
						
						СтрОтбора.Вставить("Сотрудник", Сотрудник);
					иначе
						//ЗапросДля000.Текст = ЗапросДля000.Текст + "	И УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник.Физлицо = &Физлицо";
						//ЗапросДля000.УстановитьПараметр("Физлицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
						
						СтрОтбора.Вставить("Физлицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					КонецЕсли;
					//ЗапросДля000.УстановитьПараметр("Организация", Организация);					
					РезультатЗапроса = Запрос.Выполнить();
					
					//РезультатДля000 = ЗапросДля000.Выполнить().Выгрузить();
					РезультатДля000 = ТЗУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.НайтиСтроки(СтрОтбора);
					//Аверсон
					
					Для Каждого стр из РезультатДля000 Цикл
						//О.Т. Аверсон 14.04.2017 № 547
						НомерСубконто = 0;
						Для Каждого стрВидыСубконто из стр.СчетДт.ВидыСубконто Цикл 
							Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
								НомерСубконто = стрВидыСубконто.НомерСтроки;							
							КонецЕсли;  						
						КонецЦикла;
						НомерСубконтоНУ = 0;
						Для Каждого стрВидыСубконто из стр.СчетДтНУ.ВидыСубконто Цикл 
							Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
								НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
							КонецЕсли;  						
						КонецЦикла;
						//О.Т. Аверсон 14.04.2017 № 547
						
						Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратФСЗН,стр.СубконтоДт1);
						Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратФСЗН,стр.СубконтоДт2);
						Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратФСЗН,стр.СубконтоДт3);
						Строка.СчетДт = стр.СчетДт;
						Строка.СчетДтНУ = стр.СчетДтНУ;
						
						Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,стр.СубконтоДт1);
						Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратФСЗН,стр.СубконтоДт2);
						Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратФСЗН,стр.СубконтоДт3);
						
					КонецЦикла;
					Если РезультатДля000.Количество() = 0 Тогда 
						
						//О.Т. Аверсон 14.04.2017 № 547
						НомерСубконто = 0;
						Для Каждого стрВидыСубконто из СпособПоУмолчанию.СчетДт.ВидыСубконто Цикл 
							Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
								НомерСубконто = стрВидыСубконто.НомерСтроки;							
							КонецЕсли;  						
						КонецЦикла;
						НомерСубконтоНУ = 0;
						Для Каждого стрВидыСубконто из СпособПоУмолчанию.СчетДтНУ.ВидыСубконто Цикл 
							Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
								НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
							КонецЕсли;  						
						КонецЦикла;
						//О.Т. Аверсон 14.04.2017 № 547
						
						
						СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
						Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратФСЗН,СпособПоУмолчанию.СубконтоДт1);
						Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратФСЗН,СпособПоУмолчанию.СубконтоДт2);
						Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратФСЗН,СпособПоУмолчанию.СубконтоДт3);
						Строка.СчетДт = СпособПоУмолчанию.СчетДт;
						Строка.СчетДтНУ = СпособПоУмолчанию.СчетДтНУ;
						
						Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратФСЗН,СпособПоУмолчанию.СубконтоДт1);
						Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратФСЗН,СпособПоУмолчанию.СубконтоДт2);
						Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратФСЗН,СпособПоУмолчанию.СубконтоДт3);
					КонецЕсли;
					
				КонецЕсли;
				
			КонецЕсли;
			Если не ЕстьРаспределение Тогда 
				Строка.СчетКт = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
				Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;//О.Т. Аверсон 25.03.2016 № 950
				Строка.СубконтоКт1 = СубконтоКредита;
				Строка.СчетКтНУ	= РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
				Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 25.03.2016 № 950
				//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
				
				СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 25.03.2016 № 950
				//Островская Татьяна 10.09.2013 № 16725
				РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ТекСтрокаОтражениеВБУ.ПериодРегистрации) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
				//Островская Татьяна 10.09.2013 № 16725
				БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
				//Островская Татьяна 07.05.2014 № 17239
				если НалогиИзДокументаРасчетФзносовСФОТ Тогда //О.Т. Аверсон 06.04.2017 № 514
					
					//Аверсон ЕАЕ 16.06.2020 СВФР-006057
					//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
					Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БазаФСЗН,,ТочностьРасчетов);
					//Аверсон
				иначе
					
					если КоличествоСтрокПоФизЛицу>1 Тогда 
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
						Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
						//Аверсон
					иначе
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
						Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
						//Аверсон
					КонецЕсли;
					//Островская Татьяна 07.05.2014 № 17239
					
					
					//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
					
					Если РезультатПоИнвалидам.Количество() = 0 Тогда
						//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
						//Островская Татьяна 07.05.2014 № 17239
						если КоличествоСтрокПоФизЛицу>1 Тогда
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
							Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
							//Аверсон
						иначе
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
							//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
							//Аверсон
						КонецЕсли;
						//Островская Татьяна 07.05.2014 № 17239
						//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
					Иначе
						Если РезультатПоИнвалидам[0].Группа = 1 тогда
							//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
							//Островская Татьяна 07.05.2014 № 17239
							если КоличествоСтрокПоФизЛицу>1 Тогда
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
								Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
								//Аверсон
							иначе
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
								Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
								//Аверсон
							КонецЕсли;
							//Островская Татьяна 07.05.2014 № 17239
							//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
							//Сообщить("инвалид: " + ТекСтрокаОтражениеВБУ.ФизЛицо.Наименование);
						Иначе
							//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
							//Островская Татьяна 07.05.2014 № 17239
							если КоличествоСтрокПоФизЛицу>1 Тогда
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
								Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
								//Аверсон
							иначе
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
								Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Мин(ТекСтрокаОтражениеВБУ.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
								//Аверсон
							КонецЕсли;
							//Островская Татьяна 07.05.2014 № 17239
							
							//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
						КонецЕсли;
					КонецЕсли;
					
					
				КонецЕсли;
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
				|ИЗ
				|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
				|ГДЕ
				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник
				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2";
				
				Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
				
				
				если ЗначениеЗаполнено(Сотрудник) Тогда 
					
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник","И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник");
					Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
				иначе
					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник","И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.ФизЛицо");
					Запрос.УстановитьПараметр("Сотрудник", ТекСтрокаОтражениеВБУ.ФизЛицо);
				КонецЕсли;
				
				Запрос.УстановитьПараметр("СчетДт",ТекСтрокаОтражениеВБУ.СчетДт);
				Запрос.УстановитьПараметр("СубконтоДт2",ТекСтрокаОтражениеВБУ.СубконтоДт2);
				
				
				РезультатЗапросаТЗ = Запрос.Выполнить().Выгрузить();
				
				Если РезультатЗапросаТЗ.Количество()>0 Тогда
					//Аверсон ЕАЕ 16.06.2020 СВФР-006057
					//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма * ?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0 или СуммаУжеРаспределенная,100,РезультатЗапросаТЗ[0].ДоляСпособаОтражения)/100,ПериодРегистрации);
					//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма * ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,100,РезультатЗапросаТЗ[0].ДоляСпособаОтражения)/100,ПериодРегистрации);
					Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма * ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,100,РезультатЗапросаТЗ[0].ДоляСпособаОтражения)/100,,ТочностьРасчетов);
					//Аверсон
				КонецЕсли;
				
				Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
					МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
					КолСчетовОбщий = 0;
					Если МассивДляУдельногоВеса.Количество()>0 Тогда 
						УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
						КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
					КонецЕсли;
					
					МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
					Если МассивКорректировкаКопеек.Количество()>0 Тогда 
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации);
						МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов);
						//Аверсон
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//МассивКорректировкаКопеек[0].ДоляСпособаОтраженияФСЗН = МассивКорректировкаКопеек[0].ДоляСпособаОтраженияФСЗН + ?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0 или СуммаУжеРаспределенная,ДоляСпособаОтраженияВТаблицеФСЗН,?(РезультатЗапросаТЗ.Количество()=0,0,РезультатЗапросаТЗ[0].ДоляСпособаОтражения));
						МассивКорректировкаКопеек[0].ДоляСпособаОтраженияФСЗН = МассивКорректировкаКопеек[0].ДоляСпособаОтраженияФСЗН + ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,ДоляСпособаОтраженияВТаблицеФСЗН,?(РезультатЗапросаТЗ.Количество()=0,0,РезультатЗапросаТЗ[0].ДоляСпособаОтражения));
						//Аверсон
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации)
						//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
						//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации)
						//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
						Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаФСЗН,,ТочностьРасчетов)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,БазаФСЗН1,СуммаДляРаспр),,ТочностьРасчетов)
							или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаФСЗН,,ТочностьРасчетов)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН,СуммаДляРаспр),,ТочностьРасчетов) Тогда
							//Аверсон
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации)-0.01; 
							Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов)-0.01;
							//Аверсон
							
							МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН -0.01;
						КонецЕсли;
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации)
						//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
						//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации)
						//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
						Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаФСЗН,,ТочностьРасчетов)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,БазаФСЗН1,СуммаДляРаспр),,ТочностьРасчетов)
							или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаФСЗН,,ТочностьРасчетов)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН,СуммаДляРаспр),,ТочностьРасчетов) Тогда
							//Аверсон
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации)+0.01; 
							Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов)+0.01;
							//Аверсон
							
							МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН +0.01;
						КонецЕсли;
						//Если МассивКорректировкаКопеек[0].ДоляСпособаОтраженияФСЗН>=100 Тогда 
						//	МассивКорректировкаКопеек[0].СуммаФСЗН = 0;
						//	МассивКорректировкаКопеек[0].ДоляСпособаОтраженияФСЗН = 0;
						//КонецЕсли;
						
						
					иначе
						СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
						СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
						СтрТЗКорректировкаКопеек.СуммаФСЗН = Строка.Сумма;
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = ?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0 или СуммаУжеРаспределенная,ДоляСпособаОтраженияВТаблицеФСЗН,?(РезультатЗапросаТЗ.Количество()=0,0,РезультатЗапросаТЗ[0].ДоляСпособаОтражения));
						СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,ДоляСпособаОтраженияВТаблицеФСЗН,?(РезультатЗапросаТЗ.Количество()=0,0,РезультатЗапросаТЗ[0].ДоляСпособаОтражения));
						//Аверсон
						СтрТЗКорректировкаКопеек.СуммаБГС = 0;
						СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
						СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС = 0;
						
						//Если СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН>=100 Тогда 
						//	СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
						//	СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = 0;
						//КонецЕсли;
					КонецЕсли;
					
					//О.Т. Аверсон 31.08.2018 № 2322
					
					//Аверсон ЕАЕ 16.06.2020 СВФР-006057
					//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН),СуммаДляРаспр),ПериодРегистрации);
					//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),СуммаДляРаспр),ПериодРегистрации);
					
					
					//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),СуммаДляРаспр),,ТочностьРасчетов);
					СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0, ?(МассивСтрокЕСНИсчисленный.Количество()=1,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),?(ЗначениеЗаполнено(БазаФСЗНПрошл),БазаФСЗНПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН))   ,СуммаДляРаспр),,ТочностьРасчетов); //Аверсон 26.08.2020 КВВ СВФР-006325
					
					//Аверсон
					
					МассивКорректировкаКопеек = ТЗКорректировкаКопеекПоИтогу.НайтиСтроки(Новый Структура("ФизЛицо,СуммаСравненияФСЗН",ТекСтрокаОтражениеВБУ.ФизЛицо,СуммаОбщая));
					Если МассивКорректировкаКопеек.Количество()>0 Тогда
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации);
						МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов);	
						//Аверсон
						
						//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
						//МассивКорректировкаКопеек[0].Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
						//МассивКорректировкаКопеек[0].Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
						//МассивКорректировкаКопеек[0].Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
						//- СВЭЙ КДЯ 01.06.19 СВФР-004379
						
						//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
						СтрКорр = МассивКорректировкаКопеек[0];
						Если ЭтоУточнениеНабораСубконто( СтрКорр, ТекСтрокаОтражениеВБУ ) Тогда
							
							СтрКорр.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
							СтрКорр.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
							СтрКорр.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
							
						КонецЕсли;
						//- СВЭЙ КДЯ 01.06.19 СВФР-004379
						
					иначе								
						СтрТЗКорректировкаКопеекПоИтогу = ТЗКорректировкаКопеекПоИтогу.Добавить();
						СтрТЗКорректировкаКопеекПоИтогу.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
						СтрТЗКорректировкаКопеекПоИтогу.СуммаФСЗН = Строка.Сумма;
						СтрТЗКорректировкаКопеекПоИтогу.СуммаБГС = 0;
						СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = 0;
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН =ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН),СуммаДляРаспр),ПериодРегистрации);
						//СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН =ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),СуммаДляРаспр),ПериодРегистрации);
						СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН =ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл),БазаФСЗНПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ФСЗН),СуммаДляРаспр),,ТочностьРасчетов); 
						//Аверсон
						
						СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = 0;
						СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияЕдиныйПлатеж = 0;
						СтрТЗКорректировкаКопеекПоИтогу.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
						СтрТЗКорректировкаКопеекПоИтогу.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
						СтрТЗКорректировкаКопеекПоИтогу.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
					КонецЕсли;
					//О.Т. Аверсон 31.08.2018 № 2322
					
				КонецЕсли;
				
				
				//+ СВЭЙ КДЯ 06.06.19 СВФР-004427
				Если Строка.СчетКт = СчетКтФСЗН Тогда
					Строка.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
				КонецЕсли; 
				//- СВЭЙ КДЯ 06.06.19 СВФР-004427
				
				Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
			КонецЕсли;
			
			
		КонецЕсли;
		
		
		//Обязательное страхование
		
		//О.Т. Аверсон 06.04.2017 № 514
		
		//Аверсон ЕАЕ 08.06.2020 СВФР-006057
		//(4) этот запрос вынесен из цикла!!!!!!!!!
		Если ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда 
			//ЗапросФСЗНБГС = Новый Запрос;
			//ЗапросФСЗНБГС.Текст = 
			//"ВЫБРАТЬ
			//|	ЕСНИсчисленный.ОбязательноеСтрахование, 100 как ДоляСпособаОтражения
			//|ИЗ
			//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
			//|ГДЕ
			//|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
			//|	И ЕСНИсчисленный.Организация = &Организация
			//|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
			//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) > НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ) И ЕСНИсчисленный.ОбязательноеСтрахование <> 0";
			
			СтрОтбора = Новый Структура;
			СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//МассивСтрокЕСНИсчисленный = ТЗЕСНИсчисленныйРБПОбязательноеСтрахование.НайтиСтроки(СтрОтбора);
			МассивСтрокЕСНИсчисленный = ТЗЕСНИсчисленныйРБП.НайтиСтроки(СтрОтбора);
		иначе
			//!!!(5) этот запрос вынесен из цикла
			
			//ЗапросФСЗНБГС = Новый Запрос;
			//ЗапросФСЗНБГС.Текст = 
			//"ВЫБРАТЬ
			//|	ЕСНИсчисленный.ОбязательноеСтрахование,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
			//|ИЗ
			//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
			//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
			//|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
			//|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
			//|			И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
			//|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
			//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
			//|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2
			//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)";
			////О.Т. Аверсон 19.10.2017 № 1147
			//Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1)  Тогда //О.Т. Аверсон 29.08.2018 № 2322 //и не ТипЗнч(ТекСтрокаОтражениеВБУ.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций")
			//	ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + " 
			//	|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1
			//	|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)";
			//КонецЕсли;
			////О.Т. Аверсон 19.10.2017 № 1147
			//
			//ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + "
			//|ГДЕ
			//|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
			//|	И ЕСНИсчисленный.Организация = &Организация
			//|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
			//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
			//
			//|	И ЕСНИсчисленный.ОбязательноеСтрахование <> 0";
			
			//ТЗЕСНИсчисленныйБезДопУсловияКопия2 = ТЗЕСНИсчисленныйБезДопУсловияОбязательноеСтрахование.Скопировать();
			//ТЗЕСНИсчисленныйСДопУсловиемКопия2 = ТЗЕСНИсчисленныйСДопУсловиемОбязательноеСтрахование.Скопировать();
			//ТЗЕСНИсчисленныйБезДопУсловияКопия2 = ТЗЕСНИсчисленныйБезДопУсловия.Скопировать();
			//ТЗЕСНИсчисленныйСДопУсловиемКопия2 = ТЗЕСНИсчисленныйСДопУсловием.Скопировать();
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ПланыСчетов.Хозрасчетный.ПустаяСсылка());
			//
			//МассивСтрокСПустымСчетДт = ТЗЕСНИсчисленныйБезДопУсловияКопия2.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСчетДт Цикл
			//	ЭлСтр.СчетДт = ТекСтрокаОтражениеВБУ.СчетДт;	
			//КонецЦикла;
			//
			//МассивСтрокСПустымСчетДт_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия2.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСчетДт_1 Цикл
			//	ЭлСтр.СчетДт = ТекСтрокаОтражениеВБУ.СчетДт;	
			//КонецЦикла;
			
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", 1);
			//
			//МассивСтрокСПустымСубконтоДт2 = ТЗЕСНИсчисленныйБезДопУсловияКопия2.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт2 Цикл
			//	ЭлСтр.СубконтоДт2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;	
			//КонецЦикла;
			//
			//МассивСтрокСПустымСубконтоДт2_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия2.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт2_1 Цикл
			//	ЭлСтр.СубконтоДт2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;	
			//КонецЦикла;
			//
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			//
			//МассивСтрокБезДопУсловия = ТЗЕСНИсчисленныйБезДопУсловияКопия2.НайтиСтроки(СтрОтбора);
			//
			//СтрОтбора.Вставить("СубконтоДт1", 1);
			//
			//МассивСтрокСПустымСубконтоДт1_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия2.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт1_1 Цикл
			//	ЭлСтр.СубконтоДт1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;	
			//КонецЦикла;
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			//СтрОтбора.Вставить("СубконтоДт1", ТекСтрокаОтражениеВБУ.СубконтоДт1);
			//
			//МассивСтрокСДопУсловием = ТЗЕСНИсчисленныйСДопУсловиемКопия2.НайтиСтроки(СтрОтбора);
			//
			//Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1) Тогда
			//	МассивСтрокЕСНИсчисленный = МассивСтрокСДопУсловием;
			//Иначе
			//	МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия;
			//КонецЕсли;
			
			СтрОтбора = Новый Структура;
			СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			
			МассивСтрокБезДопУсловия = ТЗЕСНИсчисленныйБезДопУсловия.НайтиСтроки(СтрОтбора);
			
			СтрОтбора.Вставить("СубконтоДт1", ТекСтрокаОтражениеВБУ.СубконтоДт1);
			
			МассивСтрокСДопУсловием = ТЗЕСНИсчисленныйСДопУсловием.НайтиСтроки(СтрОтбора);
			
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			ФлагУдалитьПовторы = Ложь;   
			
			Если МассивСтрокСДопУсловием.Количество() < МассивСтрокБезДопУсловия.Количество() Тогда 
				ФлагУдалитьПовторы = Истина;
			КонецЕсли;
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			
			Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1) Тогда
				МассивСтрокЕСНИсчисленный = МассивСтрокСДопУсловием;
			Иначе
				МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия;
			КонецЕсли;
		КонецЕсли;
		
		//ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
		//ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
		//ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
		//ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
		//ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",ТекСтрокаОтражениеВБУ.СчетДт);
		//ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт2",ТекСтрокаОтражениеВБУ.СубконтоДт2);
		//ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт1",ТекСтрокаОтражениеВБУ.СубконтоДт1);
		//!!!
		//Аверсон
		
		//Аверсон ЕАЕ 17.06.2020 СВФР-006057
		//РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
		//ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
		ЕстьПроцент = Ложь;
		//Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл 
		Для Каждого ЭлСтр Из МассивСтрокЕСНИсчисленный Цикл
			//Аверсон
			Если ЗначениеЗаполнено(ЭлСтр.ДоляСпособаОтражения) Тогда 
				ЕстьПроцент = Истина;
			КонецЕсли;  			
		КонецЦикла;
		
		Если не НалогиИзДокументаРасчетФзносовСФОТ Тогда 
			ОтражениеВБУДляБазы = Новый ТаблицаЗначений;
			МассивСтрокПоСчету = Новый Массив;
		иначе
			МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
		КонецЕсли;
		
		ЭтоОснНач = Ложь;
		Если МассивСтрокПоСчету.Количество()>0 Тогда 
			стрМассив = МассивСтрокПоСчету[0]; 
			ЭтоОснНач = ТипЗнч(стрМассив.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций");
		КонецЕсли;
		
		Если не ЕстьПроцент и ?(ОрганизацияИНН = "192798722",ЭтоОснНач, Истина) Тогда //и ЭтоОснНач //О.Т. Аверсон 25.03.2019 № 4135
			//Аверсон ЕАЕ 17.06.2020
			//ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1","");
			//ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)","");
			МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия;
			//Аверсон
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			Если ФлагУдалитьПовторы Тогда
				УдалитьПовторяющиесяЭлементыМассива(МассивСтрокЕСНИсчисленный,4);
			КонецЕсли;
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
		КонецЕсли;
		
		//Аверсон ЕАЕ 17.06.2020
		//РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
		//ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
		//Аверсон
		
		БГС = 0;
		БГСПрошл = 0;
		БГСПрошл1 = 0;
		ДоляСпособаОтраженияВТаблицеБГС = 0;
		
		//Аверсон ЕАЕ 17.06.2020
		//Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл
		Для Каждого ВыборкаДетальныеЗаписиФСЗНБГС Из МассивСтрокЕСНИсчисленный Цикл
			//Аверсон
			если ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование <> 0 Тогда 
				КолСчетовИзОбщейБазы = 0;
				МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
				Если МассивОбщаяБазы.Количество()>0 Тогда 
					КолСчетовИзОбщейБазы = МассивОбщаяБазы[0].КолСчетов;
					Если МассивОбщаяБазы[0].СчетНеИзРаспределения <> Неопределено Тогда 
						МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
						БазаОбщаяБГС = 0;
						
						ПроверкаПериодДействияПрошл = "";
						ПроверкаБазаБГСПрошл = "";
						ПроверкаБазаБГСНУПрошл = "";
						Для Каждого стрМассив из МассивСтрокПоСчету Цикл 
							Если стрМассив.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда Тогда //О.Т. Аверсон 30.08.2018 № 2322
								
								ПроверкаКолСчетов = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета",ТекСтрокаОтражениеВБУ.ФизЛицо,ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда));
								КолСчетовПоДог = 0;
								СчетПрошл = "";
								Субконто1Прошл = ""; //СВЭЙ 17.04.2024 КВВ СВФР-012659 
								Для Каждого стр из ПроверкаКолСчетов Цикл 
									Если СчетПрошл <> стр.СчетДт 
										ИЛИ Субконто1Прошл <> стр.СубконтоДт1 Тогда //СВЭЙ 17.04.2024 КВВ СВФР-012659 
										КолСчетовПоДог = КолСчетовПоДог+1;
									КонецЕсли;   									
									СчетПрошл = стр.СчетДт;
									Субконто1Прошл = стр.СубконтоДт1; //СВЭЙ 17.04.2024 КВВ СВФР-012659
								КонецЦикла;
								
								Если КолСчетовПоДог>1 Тогда 
									Если ПроверкаПериодДействияПрошл <> стрМассив.ПериодДействия и ПроверкаБазаБГСПрошл <> стрМассив.БазаСтрах и ПроверкаБазаБГСНУПрошл = стрМассив.БазаСтрахБУ Тогда 
										Продолжить;
									КонецЕсли;     																
								КонецЕсли;
								
								
								Если КолСчетовПоДог>1 Тогда 
									БазаОбщаяБГС = БазаОбщаяБГС + стрМассив.БазаСтрахБУ;
								иначе
									БазаОбщаяБГС = БазаОбщаяБГС + стрМассив.БазаСтрах;
								КонецЕсли;
								ПроверкаПериодДействияПрошл = стрМассив.ПериодДействия; 
								ПроверкаБазаБГСПрошл = стрМассив.БазаСтрах;
								ПроверкаБазаБГСНУПрошл = стрМассив.БазаСтрахБУ;
								
								//СВЭЙ 17.04.2024 КВВ СВФР-012659 (
							ИначеЕсли ТипЗнч(стрМассив.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций") И НеРаспределятьДопНачисления Тогда//и ОрганизацияИНН = "192798722" Тогда 
								БазаОбщаяБГС = БазаОбщаяБГС + стрМассив.БазаФСЗНБУ;	
								//СВЭЙ 17.04.2024 КВВ СВФР-012659 )	
							иначе
								БазаОбщаяБГС = БазаОбщаяБГС + стрМассив.БазаСтрах;
							КонецЕсли;                  							
							
						КонецЦикла;  
						//БазаОбщаяБГС = БазаОбщаяБГС * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						
						
						//УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаБГС=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаОбщаяБГС / МассивОбщаяБазы[0].БазаБГС * 100,ПериодРегистрации));
						УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаБГС=0,0,БазаОбщаяБГС / МассивОбщаяБазы[0].БазаБГС * 100);
						
						БГС1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * УдельныйВесДляПропорции / 100;
						
						БГС = БГС1 * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						
						ДоляСпособаОтраженияВТаблицеБГС = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
						
						
						Если МассивОбщаяБазы[0].БазаБГС = 0 и БазаОбщаяБГС = 0 Тогда 
							МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда
								Если МассивДляУдельногоВеса[0].ПроцентыСумм <> 100 Тогда 
									БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
									УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
								КонецЕсли;
							иначе
								БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
								УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
							КонецЕсли;
						КонецЕсли;
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда							
							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции;  
							Если БГСПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							КонецЕсли;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
							Если БГСПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
						КонецЕсли;
					иначе
						БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						БГС1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда							
							МассивДляУдельногоВеса[0].ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);  
							Если БГСПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							КонецЕсли;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
							Если БГСПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					
					
				иначе
					БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
					БГС1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
				КонецЕсли;
				Если ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
					БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
					БГС1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
					
				КонецЕсли;
				
				
				
				
				//Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
				//	МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
				//	УдельныйВесОбщий = 0;
				//	КолСчетовОбщий = 0;
				//	Если МассивДляУдельногоВеса.Количество()>0 Тогда 
				//		УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
				//		КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
				//	КонецЕсли;
				//	
				//	МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
				//	Если МассивКорректировкаКопеек.Количество()>0 тогда
				//		
				//		МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
				//		Если  КолСчетовОбщий = КолСчетовИзОбщейБазы Тогда
				//			Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование Тогда
				//				БГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации)-0.01; 							
				//			КонецЕсли;
				//			Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование Тогда
				//				БГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации)+0.01; 							
				//			КонецЕсли;
				//			
				//		КонецЕсли;
				//		
				//	иначе
				//		СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
				//		СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
				//		СтрТЗКорректировкаКопеек.СуммаБГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
				//		СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
				//		СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
				//	КонецЕсли;
				
				//КонецЕсли;
			КонецЕсли;
			
			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
			//БГСПрошл = БГСПрошл + ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
			//БГСПрошл = БГСПрошл + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БГС,,ТочностьРасчетов); //Аверсон 05.08.2020 КВВ СВФР-006325 перенесено ниже в условие про ЭтоДоговорПодряда
			//Аверсон
			
			//+ Аверсон СМА 21.05.2020 СВФР-005914
			//БГСПрошл1 = БГСПрошл1 + ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование;
			//Аверсон 29.06.2020 КВВ СВФР-006178 (
			// ПСА 21.09.2020 СВФР-006587 +++
			//НайденныеСтроки = ТЗ_ЭтоДоговорПодряда.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо));
			НайденныеСтроки = ТЗ_ЭтоДоговорПодряда.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт",ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт));//Аверсон 15.10.2020 КВВ СВФР-006691
			Если НайденныеСтроки.Количество() = 0 Тогда
				//ЭтоДоговорПодряда = ПроверкаДоговораПодряда(ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо, ПериодРегистрации);
				ЭтоДоговорПодряда = ПроверкаДоговораПодряда(ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо, ПериодРегистрации,ТекСтрокаОтражениеВБУ.СчетДт); //Аверсон 15.10.2020 КВВ СВФР-006691
				НоваяСтрокаТЗ = ТЗ_ЭтоДоговорПодряда.Добавить();
				НоваяСтрокаТЗ.ФизЛицо = ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо;
				НоваяСтрокаТЗ.ЭтоДоговорПодряда = ЭтоДоговорПодряда;
				НоваяСтрокаТЗ.СчетДт = ТекСтрокаОтражениеВБУ.СчетДт;  //Аверсон 15.10.2020 КВВ СВФР-006691
			Иначе
				ЭтоДоговорПодряда = НайденныеСтроки[0].ЭтоДоговорПодряда;
			КонецЕсли;	
			// +++ПСА 21.09.2020 СВФР-006587
			
			//Аверсон 15.10.2020 КВВ СВФР-006691 (
			Если ЭтоДоговорПодряда Тогда
				ЭтоДоговорПодряда = ?(СколькоСотрудниковФизЛица(ВыборкаДетальныеЗаписиФСЗНБГС.ФизЛицо)>1,Ложь,Истина);	
			КонецЕсли;
			//Аверсон 15.10.2020 КВВ СВФР-006691 )
			
			//ПСА 03.02.2021 СВФР-007148+++
			//Если ЭтоДоговорПодряда Тогда
			Если ЭтоДоговорПодряда и МассивОбщаяБазы.Количество()> 0 и МассивОбщаяБазы[0].КолСчетов = 1 Тогда
				//+++ПСА 03.02.2021 СВФР-007148	
				БГСПрошл1 = БГСПрошл1 + ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование;
				БГСПрошл = БГСПрошл + ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование; //Аверсон 05.08.2020 КВВ СВФР-006325
				//	БГСПрошл = БГСПрошл + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БГС,,ТочностьРасчетов); //Аверсон 16.08.2020 КВВ СВФР-006325
			Иначе
				//Аверсон 29.06.2020 КВВ СВФР-006178 )
				БГСПрошл1 =ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование;
				БГСПрошл = БГСПрошл + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БГС,,ТочностьРасчетов); //Аверсон 05.08.2020 КВВ СВФР-006325
			КонецЕсли;
			//- Аверсон СМА 21.05.2020 СВФР-005914
		КонецЦикла;
		БГС = БГСПрошл;
		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
			МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
			МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
			Для Каждого стрОбщБаза из МассивОбщаяБазы Цикл //стрОбщБаза.КолСчетов > 1
				Если МассивСтрокЕСНИсчисленный.Количество()=0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда  //стрОбщБаза.СчетНеИзРаспределения <> Неопределено и 
					
					//Аверсон ЕАЕ 12.06.2020 СВФР-006057
					//(18) этот запрос вынесен из цикла
					
					//ЗапросБазаДляРаспр = Новый Запрос;
					//ЗапросБазаДляРаспр.Текст = 
					//"ВЫБРАТЬ
					//|	ЕСНИсчисленный.ОбязательноеСтрахование
					//|ИЗ
					//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
					//|ГДЕ
					//|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
					//|	И ЕСНИсчисленный.Организация = &Организация
					//|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
					//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)";
					//ЗапросБазаДляРаспр.УстановитьПараметр("Организация", Организация);
					//ЗапросБазаДляРаспр.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
					//ЗапросБазаДляРаспр.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
					//ЗапросБазаДляРаспр.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					//РезБазаДляРаспр = ЗапросБазаДляРаспр.Выполнить().Выгрузить();
					СтрОтбора = Новый Структура;
					СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					РезБазаДляРаспр = ТЗЕСНИсчисленныйРБПМеньше.НайтиСтроки(СтрОтбора);
					//!!!
					//Аверсон
					
					Если МассивДляУдельногоВеса.Количество()>0 Тогда 
						Если МассивДляУдельногоВеса[0].КолСчетовСумм+1 = стрОбщБаза.КолСчетов Тогда 
							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
							БазаПоСчету = 0;
							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаСтрах;
							КонецЦикла;
							
							СуммаДляРаспр = 0;
							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ОбязательноеСтрахование;
							КонецЦикла;
							СуммаУжеРаспределенная = Ложь;
							Если МассивДляУдельногоВеса[0].ПроцентыСумм >= 100 Тогда 
								УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС=0,0,БазаПоСчету / стрОбщБаза.БазаБГС * 100);
							иначе
								УдельныйВесДляПропорции = 100-МассивДляУдельногоВеса[0].ПроцентыСумм;
								СуммаУжеРаспределенная = Истина;
							КонецЕсли;
							БГС = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							БГС1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							
							МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							иначе
								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
								СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
							
							
						иначе
							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
							БазаПоСчету = 0;
							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаСтрах;
							КонецЦикла; 
							
							//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаБГС * 100,ПериодРегистрации));
							УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС=0,0,БазаПоСчету / стрОбщБаза.БазаБГС * 100);
							СуммаДляРаспр = 0;
							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл         
								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ОбязательноеСтрахование;
							КонецЦикла;
							
							БГС = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							БГС1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							
							МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							иначе
								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
								СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
							
							
						КонецЕсли;
					иначе
						МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
						БазаПоСчету = 0;
						Для Каждого стрмассивСтрок из МассивСтрок Цикл 
							БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаСтрах;
						КонецЦикла; 
						
						//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаБГС * 100,ПериодРегистрации));
						УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС=0,0,БазаПоСчету / стрОбщБаза.БазаБГС * 100);
						СуммаДляРаспр = 0;
						Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
							СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ОбязательноеСтрахование;
						КонецЦикла;
						
						БГС = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
						БГС1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
						
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
							МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
							СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
						КонецЕсли;
						
						
					КонецЕсли;
					
					
					//если БГС <> 0 Тогда 
					//	Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
					//		МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
					//		КолСчетовОбщий = 0;
					//		Если МассивДляУдельногоВеса.Количество()>0 Тогда 
					//			УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
					//			КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
					//		КонецЕсли;
					//		
					//		МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
					//		Если МассивКорректировкаКопеек.Количество()>0 Тогда 
					//			
					//			МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации); 
					//			Если  КолСчетовОбщий = стрОбщБаза.КолСчетов Тогда
					//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = СуммаДляРаспр Тогда
					//					БГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации)-0.01; 							
					//				КонецЕсли;
					//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = СуммаДляРаспр Тогда
					//					БГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации)+0.01; 							
					//				КонецЕсли;
					//			КонецЕсли;
					//			
					//		иначе
					//			СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
					//			СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
					//			СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
					//			СтрТЗКорректировкаКопеек.СуммаБГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
					//			СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
					//		КонецЕсли;
					//		
					//	КонецЕсли;
					//КонецЕсли;
					
					
				КонецЕсли;
				
			КонецЦикла;
		КонецЕсли;
		
		//О.Т. Аверсон 06.04.2017 № 514
		если ?(ТекСтрокаОтражениеВБУ.ФлагДля97Сч = 1, не ПараметрБез97Счета,истина) Тогда //О.Т. 13.02.2015 № 17778
			Если ?(НалогиИзДокументаРасчетФзносовСФОТ,БГС,ТекСтрокаОтражениеВБУ.БазаСтрах) <> 0 Тогда
				Строка = ПромежуточнаяТаблица.Добавить();
				если ((ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета) и не НалогиИзДокументаРасчетФзносовСФОТ Тогда //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
					Строка.ВидРасчета = ТекСтрокаОтражениеВБУ.ВидРасчета;
				КонецЕсли;
				
				//О.Т. Аверсон 14.04.2017 № 547
				НомерСубконто = 0;
				Для Каждого стрВидыСубконто из ТекСтрокаОтражениеВБУ.СчетДт.ВидыСубконто Цикл 
					Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
						НомерСубконто = стрВидыСубконто.НомерСтроки;							
					КонецЕсли;  						
				КонецЦикла;
				НомерСубконтоНУ = 0;
				Для Каждого стрВидыСубконто из ТекСтрокаОтражениеВБУ.СчетДтНУ.ВидыСубконто Цикл 
					Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
						НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
					КонецЕсли;  						
				КонецЦикла;
				//О.Т. Аверсон 14.04.2017 № 547
				
				Если ТекСтрокаОтражениеВБУ.СчетДт <> ПланыСчетов.Хозрасчетный.ВыплатыизПрибыли Тогда
					//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
					если не СтатьяЗатратСтрах = Неопределено тогда
						если ТекСтрокаОтражениеВБУ.СубконтоДт3 = Неопределено тогда
							если ТекСтрокаОтражениеВБУ.СубконтоДт2 = Неопределено  тогда
								если ТекСтрокаОтражениеВБУ.СубконтоДт1 = Неопределено тогда
									Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
									Строка.СубконтоДт1	= ?(НомерСубконто = 1,СтатьяЗатратСтрах,Строка.СубконтоДт1);//О.Т. Аверсон 14.04.2017 № 547
								иначе
									Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
									//Островская Татьяна 14.10.2013 № 16849
									если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
										Строка.СубконтоДт1	    = ТекСтрокаОтражениеВБУ.СубконтоДт1
									иначе
										Строка.СубконтоДт1	    = ?(НомерСубконто = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт1);
										Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт2);//О.Т. Аверсон 14.04.2017 № 547
									КонецЕсли;
									//Островская Татьяна 14.10.2013 № 16849
								КонецЕсли;
							иначе
								Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
								//Островская Татьяна 03.05.2013 № 16463
								//Островская Татьяна 14.10.2013 № 16849
								если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
									Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
									Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
								иначе
									Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт1);
									Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт2);
									Строка.СубконтоДт3		= ?(НомерСубконто = 3,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт3);//О.Т. Аверсон 14.04.2017 № 547
								КонецЕсли;
								//Островская Татьяна 14.10.2013 № 16849
								//Островская Татьяна 03.05.2013 № 16463
							КонецЕсли;
						иначе
							Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
							//Островская Татьяна 03.05.2013 № 16463
							если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
								Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
							иначе
								Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт1);
							КонецЕсли;
							//Островская Татьяна 03.05.2013 № 16463
							Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт2);
							Строка.СубконтоДт3		= ?(НомерСубконто = 3,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт3); //О.Т. Аверсон 14.04.2017 № 547
							
						КонецЕсли;
					иначе
						Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
						//Островская Татьяна 03.05.2013 № 16463
						если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
							Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
						иначе
							Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
						КонецЕсли; //Островская Татьяна 03.05.2013 № 16463
						Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
						Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
						
					КонецЕсли;
					//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411			
				Иначе	
					НайтиСтроки = ОсновныеСчетаСотрудников.Найти(ТекСтрокаОтражениеВБУ.ФизЛицо, "ФизЛицо");
					
					Если НайтиСтроки = Неопределено Тогда
						Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
						Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
						Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
						Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
					Иначе
						Если ТекСтрокаОтражениеВБУ.СчетДт <> НайтиСтроки.СчетДт Тогда
							Строка.СчетДт			= НайтиСтроки.СчетДт;
							Строка.СубконтоДт1		= НайтиСтроки.СубконтоДт1;
							Строка.СубконтоДт2		= НайтиСтроки.СубконтоДт2;
							Строка.СубконтоДт3		= НайтиСтроки.СубконтоДт3;
						иначе
							Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
							Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
							Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
							Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
				//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
				если не СтатьяЗатратСтрах = Неопределено тогда
					если ТекСтрокаОтражениеВБУ.СубконтоДтНУ3 = Неопределено тогда
						если ТекСтрокаОтражениеВБУ.СубконтоДтНУ2 = Неопределено тогда
							если ТекСтрокаОтражениеВБУ.СубконтоДтНУ1 = Неопределено тогда
								Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
								Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,Строка.СубконтоДтНУ1);//О.Т. Аверсон 14.04.2017 № 547
							иначе
								Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
								//Островская Татьяна 14.10.2013 № 16849
								если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
									Строка.СубконтоДтНУ1	    = ТекСтрокаОтражениеВБУ.СубконтоДт1;
								иначе
									Строка.СубконтоДтНУ1	    = ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт1);
									Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);//О.Т. Аверсон 14.04.2017 № 547
								КонецЕсли;
								//Островская Татьяна 14.10.2013 № 16849
							КонецЕсли;
						иначе
							Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
							//Островская Татьяна 03.05.2013 № 16463  
							//Островская Татьяна 14.10.2013 № 16849
							если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
								Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
								Строка.СубконтоДтНУ2	= СтатьяЗатратСтрах;
							иначе
								Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ1);
								Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);
								Строка.СубконтоДтНУ3	= ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ3);//О.Т. Аверсон 14.04.2017 № 547
							КонецЕсли;
							//Островская Татьяна 14.10.2013 № 16849
							//Островская Татьяна 03.05.2013 № 16463
						КонецЕсли;
					Иначе 
						Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
						//Островская Татьяна 03.05.2013 № 16463
						если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
							Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
						иначе
							Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ1);
						КонецЕсли;
						//Островская Татьяна 03.05.2013 № 16463
						Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);
						Строка.СубконтоДтНУ3	= ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ3);//О.Т. Аверсон 14.04.2017 № 547
						
					КонецЕсли;
				иначе
					Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
					//Островская Татьяна 03.05.2013 № 16463
					если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
						Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
					иначе
						Строка.СубконтоДтНУ1	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ1;
					КонецЕсли; //Островская Татьяна 03.05.2013 № 16463
					Строка.СубконтоДтНУ2	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ2;
					Строка.СубконтоДтНУ3	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ3;
					
				КонецЕсли;
				//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
				ЕстьРаспределение = Ложь;
				если ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
					//Аверсон ЕАЕ 17.06.2020 СВФР-006057
					//(9) этот запрос вынесен из цикла
					//ЗапросДля000 = Новый Запрос;
					//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
					//ЗапросДля000.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
					//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
					//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1); 
					//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2); 
					//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
					//
					//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
					//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
					//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
					//
					//
					//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
					//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
					//ЗапросДля000.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ", СпособПоУмолчанию.СчетДтНУ);
					
					
					//ЗапросДля000.Текст = 
					//"ВЫБРАТЬ
					//|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
					//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
					//|	КОНЕЦ КАК СубконтоДт1,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
					//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
					//|	КОНЕЦ КАК СчетДт,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
					//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
					//|	КОНЕЦ КАК СубконтоДт2,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
					//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
					//|	КОНЕЦ КАК СубконтоДт3,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
					//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
					//|	КОНЕЦ КАК СубконтоДтНУ1,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
					//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
					//|	КОНЕЦ КАК СубконтоДтНУ2,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
					//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
					//|	КОНЕЦ КАК СубконтоДтНУ3,
					//|	ВЫБОР
					//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
					//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
					//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
					//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДтНУ
					//|	КОНЕЦ КАК СчетДтНУ
					//|ИЗ
					//|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, ) КАК РаботникиОрганизацийСрезПоследних
					//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
					//|		ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
					//|			И РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
					//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
					//|		ПО РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
					//|			И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации
					//|ГДЕ
					//|	";
					
					СтрОтбораПодр = Новый Структура;
					СтрОтбораПодр.Вставить("ПериодДействия", КонецМесяца(ТекСтрокаОтражениеВБУ.ПериодДействия));
					если ЗначениеЗаполнено(Сотрудник) Тогда 
						
						//ЗапросДля000.Текст = ЗапросДля000.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник в (&Физлицо)";
						//ЗапросДля000.УстановитьПараметр("Физлицо", Сотрудник);
						
						СтрОтбораПодр.Вставить("Сотрудник", Сотрудник);
					иначе
						//ЗапросДля000.Текст = ЗапросДля000.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо = &Физлицо";
						//ЗапросДля000.УстановитьПараметр("Физлицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
						
						СтрОтбораПодр.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					КонецЕсли;
					//ЗапросДля000.УстановитьПараметр("Период", КонецМесяца(ТекСтрокаОтражениеВБУ.ПериодДействия));
					
					РезультатДля000 = ТЗПодрКонецМесяца.НайтиСтроки(СтрОтбораПодр);
					//РезультатДля000 = ЗапросДля000.Выполнить().Выгрузить();
					//Аверсон
					
					//Аверсон ЕАЕ 17.06.2020 СВФР-006057
					//(10) и этот запрос вынесен из цикла
					//Запрос = Новый Запрос;
					//Запрос.Текст = 
					//"ВЫБРАТЬ
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
					//|ИЗ
					//|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
					//|ГДЕ
					//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
					//|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник";
					//
					//Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
					//Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРегистрации));
					//Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
					
					СтрОтбора = Новый Структура;
					СтрОтбора.Вставить("Сотрудник", Сотрудник);
					ТЗРаспределСчетаМассив = ТЗРаспределениеОсновногоЗаработкаРаботниковОрганизаций.НайтиСтроки(СтрОтбора);
					
					//ТЗРаспределСчета = Запрос.Выполнить().Выгрузить();
					
					//Если ТЗРаспределСчета.Количество()>0 Тогда 
					Если ТЗРаспределСчетаМассив.Количество()>0 Тогда 
						ЕстьРаспределение = истина;
						//РезультатДля000 = ТЗРаспределСчета;
						РезультатДля000 = ТЗРаспределСчетаМассив;
					КонецЕсли;
					//Аверсон
					
					Сч = 0;
					ОбщаяСуммаРаспределения = 0;
					ОбщаяСумма = 0;					
					Для Каждого стр из РезультатДля000 Цикл
						Если сч > 0 Тогда 
							Строка = ПромежуточнаяТаблица.Добавить();
							если ((ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета) и не НалогиИзДокументаРасчетФзносовСФОТ Тогда //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
								Строка.ВидРасчета = ТекСтрокаОтражениеВБУ.ВидРасчета;
							КонецЕсли;
							
						КонецЕсли;
						
						//О.Т. Аверсон 14.04.2017 № 547
						НомерСубконто = 0;
						Для Каждого стрВидыСубконто из стр.СчетДт.ВидыСубконто Цикл 
							Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
								НомерСубконто = стрВидыСубконто.НомерСтроки;							
							КонецЕсли;  						
						КонецЦикла;
						НомерСубконтоНУ = 0;
						Для Каждого стрВидыСубконто из стр.СчетДтНУ.ВидыСубконто Цикл 
							Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
								НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
							КонецЕсли;  						
						КонецЦикла;
						//О.Т. Аверсон 14.04.2017 № 547
						
						//О.Т. Аверсон 26.01.2018 № 1502
						ЗапросОсн = Новый Запрос;
						ЗапросОсн.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
						если ЗначениеЗаполнено(Сотрудник) Тогда
							ЗапросОсн.Текст = 
							"ВЫБРАТЬ
							|	ТЧ.ФизЛицо,
							|	ТЧ.СубконтоДт1,
							|	ТЧ.СубконтоДт2,
							|	ТЧ.СубконтоДт3,
							|	ТЧ.СубконтоДтНУ1,
							|	ТЧ.СубконтоДтНУ2,
							|	ТЧ.СубконтоДтНУ3
							|	ПОМЕСТИТЬ ВТОсн
							|ИЗ
							|	&ТЧОсновные КАК ТЧ
							|ГДЕ
							|	ТЧ.СчетДт = &СчетДт
							|	И &Период МЕЖДУ ТЧ.ПериодДействияНачало И ТЧ.ПериодДействияКонец
							|	И ТЧ.Сотрудник = &Сотрудник";
							ЗапросОсн.УстановитьПараметр("Сотрудник",Сотрудник);
							ЗапросОсн.УстановитьПараметр("СчетДт",стр.СчетДт);
							ЗапросОсн.УстановитьПараметр("Период",ТекСтрокаОтражениеВБУ.ПериодДействия);
							ЗапросОсн.УстановитьПараметр("ТЧОсновные",ОсновныеНачисления);
							ЗапросОсн.Выполнить();
							ЗапросОсн.Текст = 
							"ВЫБРАТЬ
							|	ТЧ.ФизЛицо,
							|	ТЧ.СубконтоДт1,
							|	ТЧ.СубконтоДт2,
							|	ТЧ.СубконтоДт3,
							|	ТЧ.СубконтоДтНУ1,
							|	ТЧ.СубконтоДтНУ2,
							|	ТЧ.СубконтоДтНУ3
							|ИЗ ВТОсн как ТЧ";
							
						иначе
							ЗапросОсн.Текст = 
							"ВЫБРАТЬ
							|	ТЧ.ФизЛицо,
							|	ТЧ.СубконтоДт1,
							|	ТЧ.СубконтоДт2,
							|	ТЧ.СубконтоДт3,
							|	ТЧ.СубконтоДтНУ1,
							|	ТЧ.СубконтоДтНУ2,
							|	ТЧ.СубконтоДтНУ3
							|	ПОМЕСТИТЬ ВТОсн
							|ИЗ
							|	&ТЧОсновные КАК ТЧ
							|ГДЕ
							|	ТЧ.СчетДт = &СчетДт
							|	И &Период МЕЖДУ ТЧ.ПериодДействияНачало И ТЧ.ПериодДействияКонец
							|	И ТЧ.ФизЛицо = &ФизЛицо";
							ЗапросОсн.УстановитьПараметр("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо);
							ЗапросОсн.УстановитьПараметр("СчетДт",стр.СчетДт);
							ЗапросОсн.УстановитьПараметр("Период",ТекСтрокаОтражениеВБУ.ПериодДействия);
							ЗапросОсн.УстановитьПараметр("ТЧОсновные",ОсновныеНачисления);
							ЗапросОсн.Выполнить();
							ЗапросОсн.Текст = 
							"ВЫБРАТЬ
							|	ТЧ.ФизЛицо,
							|	ТЧ.СубконтоДт1,
							|	ТЧ.СубконтоДт2,
							|	ТЧ.СубконтоДт3,
							|	ТЧ.СубконтоДтНУ1,
							|	ТЧ.СубконтоДтНУ2,
							|	ТЧ.СубконтоДтНУ3
							|ИЗ ВТОсн как ТЧ";
							
							
						КонецЕсли;
						РезЗапросОсн = ЗапросОсн.Выполнить().Выбрать();
						Если РезЗапросОсн.Следующий() Тогда 
							Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДт1);
							Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДт2);
							Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДт3);
							Если ЗначениеЗаполнено( стр.СчетДтНУ) Тогда
								Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДтНУ1);
								Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДтНУ2);
								Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДтНУ3);
							КонецЕсли;
						иначе 
							ЗапросОсн.Текст = 
							"ВЫБРАТЬ
							|	ТЧ.ФизЛицо,
							|	ТЧ.СубконтоДт1,
							|	ТЧ.СубконтоДт2,
							|	ТЧ.СубконтоДт3,
							|	ТЧ.СубконтоДтНУ1,
							|	ТЧ.СубконтоДтНУ2,
							|	ТЧ.СубконтоДтНУ3
							|	ПОМЕСТИТЬ ВТДоп
							|ИЗ
							|	&ТЧДополит КАК ТЧ
							|ГДЕ
							|	ТЧ.СчетДт = &СчетДт
							|	И ТЧ.Сотрудник = &Сотрудник";
							ЗапросОсн.УстановитьПараметр("ТЧДополит", ДополнительныеНачисления);
							ЗапросОсн.Выполнить();
							ЗапросОсн.Текст = 
							"ВЫБРАТЬ
							|	ТЧ.ФизЛицо,
							|	ТЧ.СубконтоДт1,
							|	ТЧ.СубконтоДт2,
							|	ТЧ.СубконтоДт3,
							|	ТЧ.СубконтоДтНУ1,
							|	ТЧ.СубконтоДтНУ2,
							|	ТЧ.СубконтоДтНУ3
							|ИЗ ВТДоп как ТЧ";
							РезЗапросОсн = ЗапросОсн.Выполнить().Выбрать();
							Если РезЗапросОсн.Следующий() Тогда
								Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДт1);
								Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДт2);
								Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДт3);
								Если ЗначениеЗаполнено( стр.СчетДтНУ) Тогда
									Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДтНУ1);
									Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДтНУ2);
									Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,РезЗапросОсн.СубконтоДтНУ3);
								КонецЕсли;
								
							иначе	
								Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратСтрах,стр.СубконтоДт1);
								Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратСтрах,стр.СубконтоДт2);
								Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратСтрах,стр.СубконтоДт3);
								Если ЗначениеЗаполнено( стр.СчетДтНУ) Тогда 
									Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,стр.СубконтоДтНУ1);
									Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,стр.СубконтоДтНУ2);
									Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,стр.СубконтоДтНУ3);
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//О.Т. Аверсон 26.01.2018 № 1502
						
						Строка.СчетДт = стр.СчетДт;
						Строка.СчетДтНУ = стр.СчетДтНУ;
						
						
						Если ЕстьРаспределение Тогда 
							КоррСчет				=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
							Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетБУ; //О.Т. Аверсон 30.03.2016 № 950
							
							Строка.СчетКт			=  КоррСчет;
							
							Субконто    = Новый Массив(3);
							Для тт=0 по 2 цикл
								Субконто[тт] = Неопределено;
							КонецЦикла;
							
							Для тт=0 по КоррСчет.ВидыСубконто.Количество()-1 Цикл
								Если НЕ Коррсчет.ВидыСубконто[тт].ВидСубконто = Неопределено тогда
									Если Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("ПеречислениеСсылка.ВидыПлатежейВГосБюджет")) Тогда
										Субконто[тт] = Перечисления.ВидыПлатежейВГосБюджет.Налог;
										
									ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Организации")) Тогда
										Субконто[тт] = Организация;
										
									ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Контрагенты")) Тогда
										Субконто[тт] =РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
										Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Контрагент; //О.Т. Аверсон 30.03.2016 № 950
										
									ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ДоговорыКонтрагентов")) Тогда
										Субконто[тт] = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
										Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Договор;//О.Т. Аверсон 30.03.2016 № 950
										
									КонецЕсли;
								КонецЕсли;
								
							КонецЦикла;
							
							Строка.СубконтоКт1		= Субконто[0];
							Строка.СубконтоКт2		= Субконто[1];
							Строка.СубконтоКт3		= Субконто[2];
							
							Строка.СчетКтНУ			=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
							Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 30.03.2016 № 950
							//Островская Татьяна 07.05.2014 № 17239
							//если КоличествоСтрокПоФизЛицу>1 Тогда
							//		Строка.Сумма			= Окр(ТекСтрокаОтражениеВБУ.БазаСтрахБУ * СтавкаСтрах / 100, 2);
							//	иначе
							
							Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(БГС, ПериодРегистрации);
								Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БГС,,ТочностьРасчетов);
								//Аверсон
							иначе
								Если ПериодРегистрации < Дата(2016,07,1) Тогда //О.Т. Аверсон 16.03.2016 № 949
									Строка.Сумма			= Окр(ТекСтрокаОтражениеВБУ.БазаСтрах * СтавкаСтрах / 100, 2);
								иначе
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаОтражениеВБУ.БазаСтрах * СтавкаСтрах / 100, ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
									Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ТекСтрокаОтражениеВБУ.БазаСтрах * СтавкаСтрах / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
									//Аверсон
								КонецЕсли;
							КонецЕсли;
							
							Если сч = 0 Тогда 
								ОбщаяСумма = Строка.Сумма;
							КонецЕсли;
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма * Стр.ДоляСпособаОтражения/100,ПериодРегистрации);
							Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма * Стр.ДоляСпособаОтражения/100,,ТочностьРасчетов);
							//Аверсон
							
							//Аверсон 10.09.2020 КВВ СВФР-006325 (
							Строка.СуммаДолиРаспред = ?(Стр.ДоляСпособаОтражения=100,0,Строка.Сумма); 
							
							Если Строка.СчетКт = СчетКтБГС И НЕ ЗначениеЗаполнено(Строка.ФизЛицо) И Стр.ДоляСпособаОтражения <> 100 Тогда  
								Строка.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							КонецЕсли;
							//Аверсон 10.09.2020 КВВ СВФР-006325 )
							
							
							ОбщаяСуммаРаспределения = ОбщаяСуммаРаспределения + Строка.Сумма;
							Если ОбщаяСумма <> ОбщаяСуммаРаспределения и сч+1 = РезультатДля000.Количество() Тогда 
								Строка.Сумма = Строка.Сумма + (ОбщаяСумма-ОбщаяСуммаРаспределения);
							КонецЕсли;
							
							Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
								КолСчетовОбщий = 0;
								Если МассивДляУдельногоВеса.Количество()>0 Тогда 
									УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
									КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
								КонецЕсли;
								
								МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
								Если МассивКорректировкаКопеек.Количество()>0 Тогда 
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации);
									МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов);
									//Аверсон
									
									МассивКорректировкаКопеек[0].ДоляСпособаОтраженияБГС = МассивКорректировкаКопеек[0].ДоляСпособаОтраженияБГС + ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,ДоляСпособаОтраженияВТаблицеБГС,Стр.ДоляСпособаОтражения);
									
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,БГС1,СуммаДляРаспр),ПериодРегистрации)
									//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование,СуммаДляРаспр),ПериодРегистрации) Тогда
									//	Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации)-0.01; 	
									Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаБГС,,ТочностьРасчетов)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,БГС1,СуммаДляРаспр),,ТочностьРасчетов)
										или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаБГС,,ТочностьРасчетов)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование,СуммаДляРаспр),,ТочностьРасчетов) Тогда
										Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов)-0.01; 	
										//Аверсон
										
										МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС -0.01;
										
									КонецЕсли;
									
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,БГС1,СуммаДляРаспр),ПериодРегистрации)
									//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование,СуммаДляРаспр),ПериодРегистрации) Тогда
									//	Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации)+0.01; 
									Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаБГС,,ТочностьРасчетов)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,БГС1,СуммаДляРаспр),,ТочностьРасчетов)
										или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаБГС,,ТочностьРасчетов)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование,СуммаДляРаспр),,ТочностьРасчетов) Тогда
										Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов)+0.01; 
										//Аверсон
										
										МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС +0.01;
										
									КонецЕсли;
									
									//Если МассивКорректировкаКопеек[0].ДоляСпособаОтраженияБГС>=100 Тогда 
									//	МассивКорректировкаКопеек[0].СуммаБГС = 0;
									//	МассивКорректировкаКопеек[0].ДоляСпособаОтраженияБГС = 0;
									//КонецЕсли;
									
									
									
								иначе
									СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
									СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
									СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
									СтрТЗКорректировкаКопеек.СуммаБГС = Строка.Сумма;
									СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
									СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС = ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,ДоляСпособаОтраженияВТаблицеБГС,Стр.ДоляСпособаОтражения);
									СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = 0;
									
									//Если СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС>=100 Тогда 
									//	СтрТЗКорректировкаКопеек.СуммаБГС = 0;
									//	СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС= 0;
									//КонецЕсли;
									
								КонецЕсли;
								
								//О.Т. Аверсон 31.08.2018 № 2322
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр),ПериодРегистрации);
								
								//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр),,ТочностьРасчетов);
								СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0, ?(МассивСтрокЕСНИсчисленный.Количество()=1,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование))   ,СуммаДляРаспр),,ТочностьРасчетов); //Аверсон 26.08.2020 КВВ СВФР-006325
								
								//Аверсон
								
								МассивКорректировкаКопеек = ТЗКорректировкаКопеекПоИтогу.НайтиСтроки(Новый Структура("ФизЛицо,СуммаСравненияБГС",ТекСтрокаОтражениеВБУ.ФизЛицо,СуммаОбщая));
								Если МассивКорректировкаКопеек.Количество()>0 Тогда
									
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации);
									МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма,,ТочностьРасчетов);
									//Аверсон
									МассивКорректировкаКопеек[0].СуммаСравненияБГС = МассивКорректировкаКопеек[0].СуммаСравненияБГС + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр),,ТочностьРасчетов);//Аверсон 13.08.2020 КВВ СВФР-006325
									
									//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
									//МассивКорректировкаКопеек[0].Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
									//МассивКорректировкаКопеек[0].Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
									//МассивКорректировкаКопеек[0].Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
									//- СВЭЙ КДЯ 01.06.19 СВФР-004379
									
									//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
									СтрКорр = МассивКорректировкаКопеек[0];
									Если ЭтоУточнениеНабораСубконто( СтрКорр, ТекСтрокаОтражениеВБУ ) Тогда
										
										СтрКорр.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
										СтрКорр.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
										СтрКорр.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
										
									КонецЕсли;
									//- СВЭЙ КДЯ 01.06.19 СВФР-004379
									
								иначе								
									СтрТЗКорректировкаКопеекПоИтогу = ТЗКорректировкаКопеекПоИтогу.Добавить();
									СтрТЗКорректировкаКопеекПоИтогу.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
									СтрТЗКорректировкаКопеекПоИтогу.СуммаФСЗН = 0;
									СтрТЗКорректировкаКопеекПоИтогу.СуммаБГС = Строка.Сумма;
									СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = 0;
									
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр),ПериодРегистрации);
									
									//Аверсон 10.09.2020 КВВ СВФР-006325 (
									Если Строка.СуммаДолиРаспред <> 0 Тогда 
										СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = Строка.СуммаДолиРаспред;
									Иначе
										//Аверсон 10.09.2020 КВВ СВФР-006325)
										СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр),,ТочностьРасчетов); //Аверсон 28.07.2020 КВВ СВФР-006325 БГСПрошл1 на БГСПрошл 
									КонецЕсли;
									//Аверсон
									
									СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = 0;
									СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияЕдиныйПлатеж = 0;
									СтрТЗКорректировкаКопеекПоИтогу.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
									СтрТЗКорректировкаКопеекПоИтогу.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
									СтрТЗКорректировкаКопеекПоИтогу.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
								КонецЕсли;
								//О.Т. Аверсон 31.08.2018 № 2322
								
								
							КонецЕсли;
							
							
							//	КонецЕсли;
							//Островская Татьяна 07.05.2014 № 17239
							Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ОбязательноеСтрахование;
						КонецЕсли;
						Сч = Сч + 1;
						
					КонецЦикла;
					Если РезультатДля000.Количество() = 0 Тогда
						//Аверсон ЕАЕ 17.06.2020 СВФР-006057
						//(14) этот запрос вынесен из цикла
						
						//ЗапросДля000.Текст = 
						//"ВЫБРАТЬ
						//|	ВЫБОР
						//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
						//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
						//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
						//|	КОНЕЦ КАК СубконтоДт1,
						//|	ВЫБОР
						//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
						//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
						//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
						//|	КОНЕЦ КАК СчетДт,
						//|	ВЫБОР
						//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
						//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
						//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
						//|	КОНЕЦ КАК СубконтоДт2,
						//|	ВЫБОР
						//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
						//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
						//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
						//|	КОНЕЦ КАК СубконтоДт3,
						//|	ВЫБОР
						//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
						//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
						//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
						//|	КОНЕЦ КАК СубконтоДтНУ1,
						//|	ВЫБОР
						//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
						//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
						//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
						//|	КОНЕЦ КАК СубконтоДтНУ2,
						//|	ВЫБОР
						//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
						//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
						//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
						//|	КОНЕЦ КАК СубконтоДтНУ3,
						//|	ВЫБОР
						//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
						//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
						//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДтНУ
						//|	КОНЕЦ КАК СчетДтНУ
						//|ИЗ
						//|	РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
						//|ГДЕ
						//|	УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация = &Организация
						//|	";
						
						СтрОтбора = Новый Структура;
						
						если ЗначениеЗаполнено(Сотрудник) Тогда 
							
							//ЗапросДля000.Текст = ЗапросДля000.Текст + "	И УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник в (&Физлицо)";
							//ЗапросДля000.УстановитьПараметр("Физлицо", Сотрудник);
							
							СтрОтбора.Вставить("Сотрудник", Сотрудник);
						иначе
							//ЗапросДля000.Текст = ЗапросДля000.Текст + "	И УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник.Физлицо = &Физлицо";
							//ЗапросДля000.УстановитьПараметр("Физлицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
							
							СтрОтбора.Вставить("Физлицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
						КонецЕсли;
						//ЗапросДля000.УстановитьПараметр("Организация", Организация);					
						РезультатЗапроса = Запрос.Выполнить();
						
						//РезультатДля000 = ЗапросДля000.Выполнить().Выгрузить();
						РезультатДля000 = ТЗУчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.НайтиСтроки(СтрОтбора);
						//Аверсон
						
						Для Каждого стр из РезультатДля000 Цикл
							//О.Т. Аверсон 14.04.2017 № 547
							НомерСубконто = 0;
							Для Каждого стрВидыСубконто из стр.СчетДт.ВидыСубконто Цикл 
								Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
									НомерСубконто = стрВидыСубконто.НомерСтроки;							
								КонецЕсли;  						
							КонецЦикла;
							НомерСубконтоНУ = 0;
							Для Каждого стрВидыСубконто из стр.СчетДтНУ.ВидыСубконто Цикл 
								Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
									НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
								КонецЕсли;  						
							КонецЦикла;
							//О.Т. Аверсон 14.04.2017 № 547
							
							Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратСтрах,стр.СубконтоДт1);
							Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратСтрах,стр.СубконтоДт2);
							Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратСтрах,стр.СубконтоДт3);
							Строка.СчетДт = стр.СчетДт;
							Строка.СчетДтНУ = стр.СчетДтНУ;
							
							Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,стр.СубконтоДт1);
							Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,стр.СубконтоДт2);
							Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,стр.СубконтоДт3);
							
						КонецЦикла;
						Если РезультатДля000.Количество() = 0 Тогда 
							//О.Т. Аверсон 14.04.2017 № 547
							НомерСубконто = 0;
							Для Каждого стрВидыСубконто из СпособПоУмолчанию.СчетДт.ВидыСубконто Цикл 
								Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
									НомерСубконто = стрВидыСубконто.НомерСтроки;							
								КонецЕсли;  						
							КонецЦикла;
							НомерСубконтоНУ = 0;
							Для Каждого стрВидыСубконто из СпособПоУмолчанию.СчетДтНУ.ВидыСубконто Цикл 
								Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
									НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
								КонецЕсли;  						
							КонецЦикла;
							//О.Т. Аверсон 14.04.2017 № 547
							СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
							Строка.СубконтоДт1 = ?(НомерСубконто = 1,СтатьяЗатратСтрах,СпособПоУмолчанию.СубконтоДт1);
							Строка.СубконтоДт2 = ?(НомерСубконто = 2,СтатьяЗатратСтрах,СпособПоУмолчанию.СубконтоДт2);
							Строка.СубконтоДт3 = ?(НомерСубконто = 3,СтатьяЗатратСтрах,СпособПоУмолчанию.СубконтоДт3);
							Строка.СчетДт = СпособПоУмолчанию.СчетДт;
							Строка.СчетДтНУ = СпособПоУмолчанию.СчетДтНУ;
							
							Строка.СубконтоДтНУ1 = ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,СпособПоУмолчанию.СубконтоДт1);
							Строка.СубконтоДтНУ2 = ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,СпособПоУмолчанию.СубконтоДт2);
							Строка.СубконтоДтНУ3 = ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,СпособПоУмолчанию.СубконтоДт3);
						КонецЕсли;
						
					КонецЕсли;
					
				КонецЕсли;
				
				
				
				Если не ЕстьРаспределение Тогда 
					КоррСчет				=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
					Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетБУ; //О.Т. Аверсон 30.03.2016 № 950
					
					Строка.СчетКт			=  КоррСчет;
					
					Субконто    = Новый Массив(3);
					Для тт=0 по 2 цикл
						Субконто[тт] = Неопределено;
					КонецЦикла;
					
					Для тт=0 по КоррСчет.ВидыСубконто.Количество()-1 Цикл
						Если НЕ Коррсчет.ВидыСубконто[тт].ВидСубконто = Неопределено тогда
							Если Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("ПеречислениеСсылка.ВидыПлатежейВГосБюджет")) Тогда
								Субконто[тт] = Перечисления.ВидыПлатежейВГосБюджет.Налог;
								
							ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Организации")) Тогда
								Субконто[тт] = Организация;
								
							ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Контрагенты")) Тогда
								Субконто[тт] =РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
								Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Контрагент; //О.Т. Аверсон 30.03.2016 № 950
								
							ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ДоговорыКонтрагентов")) Тогда
								Субконто[тт] = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
								Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Договор;//О.Т. Аверсон 30.03.2016 № 950
								
							КонецЕсли;
						КонецЕсли;
						
					КонецЦикла;
					
					Строка.СубконтоКт1		= Субконто[0];
					Строка.СубконтоКт2		= Субконто[1];
					Строка.СубконтоКт3		= Субконто[2];
					
					Строка.СчетКтНУ			=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
					Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 30.03.2016 № 950
					//Островская Татьяна 07.05.2014 № 17239
					//если КоличествоСтрокПоФизЛицу>1 Тогда
					//		Строка.Сумма			= Окр(ТекСтрокаОтражениеВБУ.БазаСтрахБУ * СтавкаСтрах / 100, 2);
					//	иначе
					
					Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(БГС, ПериодРегистрации);
						Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(БГС,,ТочностьРасчетов);
						//Аверсон
					иначе
						Если ПериодРегистрации < Дата(2016,07,1) Тогда //О.Т. Аверсон 16.03.2016 № 949
							Строка.Сумма			= Окр(ТекСтрокаОтражениеВБУ.БазаСтрах * СтавкаСтрах / 100, 2);
						иначе
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаОтражениеВБУ.БазаСтрах * СтавкаСтрах / 100, ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
							Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ТекСтрокаОтражениеВБУ.БазаСтрах * СтавкаСтрах / 100, ,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
							//Аверсон
						КонецЕсли;
					КонецЕсли;
					
					Запрос = Новый Запрос;
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
					|ИЗ
					|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
					|ГДЕ
					|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
					|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник
					|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
					|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2";
					
					Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
					
					
					если ЗначениеЗаполнено(Сотрудник) Тогда 
						
						Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник","И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник");
						Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
					иначе
						Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник","И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.ФизЛицо");
						Запрос.УстановитьПараметр("Сотрудник", ТекСтрокаОтражениеВБУ.ФизЛицо);
					КонецЕсли;
					
					Запрос.УстановитьПараметр("СчетДт",ТекСтрокаОтражениеВБУ.СчетДт);
					Запрос.УстановитьПараметр("СубконтоДт2",ТекСтрокаОтражениеВБУ.СубконтоДт2);
					
					
					РезультатЗапросаТЗ = Запрос.Выполнить().Выгрузить();
					
					Если РезультатЗапросаТЗ.Количество()>0 Тогда
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма * ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,100,РезультатЗапросаТЗ[0].ДоляСпособаОтражения)/100,ПериодРегистрации);
						Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма * ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,100,РезультатЗапросаТЗ[0].ДоляСпособаОтражения)/100, ,ТочностьРасчетов);
						//Аверсон
					КонецЕсли;
					
					Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
						МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						КолСчетовОбщий = 0;
						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
							УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
							КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
						КонецЕсли;
						
						МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивКорректировкаКопеек.Количество()>0 Тогда 
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации);
							МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма, ,ТочностьРасчетов);
							//Аверсон
							
							МассивКорректировкаКопеек[0].ДоляСпособаОтраженияБГС = МассивКорректировкаКопеек[0].ДоляСпособаОтраженияБГС + ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,ДоляСпособаОтраженияВТаблицеБГС,?(РезультатЗапросаТЗ.Количество()=0,0,РезультатЗапросаТЗ[0].ДоляСпособаОтражения));
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,БГС1,СуммаДляРаспр),ПериодРегистрации)
							//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование,СуммаДляРаспр),ПериодРегистрации) Тогда
							//	Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации)-0.01; 	
							Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаБГС, ,ТочностьРасчетов)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,БГС1,СуммаДляРаспр), ,ТочностьРасчетов)
								или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаБГС, ,ТочностьРасчетов)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование,СуммаДляРаспр), ,ТочностьРасчетов) Тогда
								Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма, ,ТочностьРасчетов)-0.01; 	
								//Аверсон
								
								МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС -0.01;
								
							КонецЕсли;
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,БГС1,СуммаДляРаспр),ПериодРегистрации)
							//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование,СуммаДляРаспр),ПериодРегистрации) Тогда
							//	Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации)+0.01; 
							Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаБГС, ,ТочностьРасчетов)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,БГС1,СуммаДляРаспр), ,ТочностьРасчетов)
								или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаБГС, ,ТочностьРасчетов)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование,СуммаДляРаспр), ,ТочностьРасчетов) Тогда
								Строка.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма, ,ТочностьРасчетов)+0.01; 
								//Аверсон	
								
								МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС +0.01;
								
							КонецЕсли;
							
							//Если МассивКорректировкаКопеек[0].ДоляСпособаОтраженияБГС>=100 Тогда 
							//	МассивКорректировкаКопеек[0].СуммаБГС = 0;
							//	МассивКорректировкаКопеек[0].ДоляСпособаОтраженияБГС = 0;
							//КонецЕсли;
							
							
							
						иначе
							СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
							СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
							СтрТЗКорректировкаКопеек.СуммаБГС = Строка.Сумма;
							СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
							СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС = ?(МассивСтрокЕСНИсчисленный.Количество()>0 или СуммаУжеРаспределенная,ДоляСпособаОтраженияВТаблицеБГС,?(РезультатЗапросаТЗ.Количество()=0,0,РезультатЗапросаТЗ[0].ДоляСпособаОтражения));
							СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = 0;
							
							//Если СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС>=100 Тогда 
							//	СтрТЗКорректировкаКопеек.СуммаБГС = 0;
							//	СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС= 0;
							//КонецЕсли;
							
						КонецЕсли;
						
						//О.Т. Аверсон 31.08.2018 № 2322
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//СуммаОбщая =ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр),ПериодРегистрации);
						//СуммаОбщая =ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр), ,ТочностьРасчетов);//Аверсон 28.07.2020 КВВ СВФР-006325 БГСПрошл1 на БГСПрошл
						
						//СуммаОбщая =ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр), ,ТочностьРасчетов);//Аверсон 18.08.2020 КВВ СВФР-006325 БГСПрошл на БГСПрошл1
						СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0, ?(МассивСтрокЕСНИсчисленный.Количество()=1,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование))   ,СуммаДляРаспр),,ТочностьРасчетов); //Аверсон 26.08.2020 КВВ СВФР-006325
						
						//Аверсон
						
						МассивКорректировкаКопеек = ТЗКорректировкаКопеекПоИтогу.НайтиСтроки(Новый Структура("ФизЛицо,СуммаСравненияБГС",ТекСтрокаОтражениеВБУ.ФизЛицо,СуммаОбщая));
						Если МассивКорректировкаКопеек.Количество()>0 Тогда 
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.Сумма,ПериодРегистрации);
							МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(Строка.Сумма, ,ТочностьРасчетов);
							//Аверсон
							//		МассивКорректировкаКопеек[0].СуммаСравненияБГС = МассивКорректировкаКопеек[0].СуммаСравненияБГС + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр), ,ТочностьРасчетов);//Аверсон 13.08.2020 КВВ СВФР-006325   //Аверсон 17.08.2020 ЗАКОММ
							//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
							//МассивКорректировкаКопеек[0].Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
							//МассивКорректировкаКопеек[0].Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
							//МассивКорректировкаКопеек[0].Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
							//- СВЭЙ КДЯ 01.06.19 СВФР-004379
							
							//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
							СтрКорр = МассивКорректировкаКопеек[0];
							Если ЭтоУточнениеНабораСубконто( СтрКорр, ТекСтрокаОтражениеВБУ ) Тогда
								
								СтрКорр.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
								СтрКорр.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
								СтрКорр.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
								
							КонецЕсли;
							//- СВЭЙ КДЯ 01.06.19 СВФР-004379
							
						иначе								
							СтрТЗКорректировкаКопеекПоИтогу = ТЗКорректировкаКопеекПоИтогу.Добавить();
							СтрТЗКорректировкаКопеекПоИтогу.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗКорректировкаКопеекПоИтогу.СуммаФСЗН = 0;
							СтрТЗКорректировкаКопеекПоИтогу.СуммаБГС = Строка.Сумма;
							СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = 0;
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = ОбщегоНазначения.ОкруглитьЗначение2016(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр),ПериодРегистрации);
							СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(?(МассивСтрокЕСНИсчисленный.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ОбязательноеСтрахование),СуммаДляРаспр), ,ТочностьРасчетов);  //Аверсон 28.07.2020 КВВ СВФР-006325 БГСПрошл1 на БГСПрошл
							//Аверсон
							
							СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = 0;
							СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияЕдиныйПлатеж = 0;
							СтрТЗКорректировкаКопеекПоИтогу.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
							СтрТЗКорректировкаКопеекПоИтогу.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
							СтрТЗКорректировкаКопеекПоИтогу.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
						КонецЕсли;
						//О.Т. Аверсон 31.08.2018 № 2322
						
					КонецЕсли;
					
					
					
					//	КонецЕсли;
					//Островская Татьяна 07.05.2014 № 17239
					Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ОбязательноеСтрахование;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		//О.Т. 18.09.2014 № 224
		////Доплата
		//Запрос = Новый Запрос;
		//Запрос.Текст = 
		//"ВЫБРАТЬ
		//|	ЕСНИсчисленный.ПериодВзаиморасчетов,
		//|	ЕСНИсчисленный.ФизЛицо,
		//|	СУММА(ЕСНИсчисленный.Доплата) КАК Доплата
		//|ИЗ
		//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		//|ГДЕ
		//|	ЕСНИсчисленный.Период МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1
		//|	И ЕСНИсчисленный.Организация = &Организация
		//|	И ЕСНИсчисленный.ФизЛицо = &ФизЛицо
		//|
		//|СГРУППИРОВАТЬ ПО
		//|	ЕСНИсчисленный.ПериодВзаиморасчетов,
		//|	ЕСНИсчисленный.ФизЛицо";
		//
		//Запрос.УстановитьПараметр("Организация", Организация);
		//Запрос.УстановитьПараметр("ПериодВзаиморасчетов", ТекСтрокаОтражениеВБУ.ПериодРегистрации);
		//Запрос.УстановитьПараметр("ПериодВзаиморасчетов1", КонецМесяца(ТекСтрокаОтражениеВБУ.ПериодРегистрации));//О.Т. 19.06.2015 № 461
		//Запрос.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
		//
		//Результат = Запрос.Выполнить();
		//
		//ВыборкаДетальныеЗаписи = Результат.Выбрать();
		//
		//Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		//	
		//	Если ВыборкаДетальныеЗаписи.Доплата <> 0 и не (ВыборкаДетальныеЗаписи.Доплата = Null или ВыборкаДетальныеЗаписи.Доплата = Неопределено) Тогда
		//		ЭлементСЗ = СЗДляДоплаты.НайтиСтроки(новый Структура("ФизЛицо,Период",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.ПериодРегистрации));
		//		если ЭлементСЗ.Количество()>0 Тогда 
		//			Продолжить;
		//		КонецЕсли;
		//		
		//		Строка = ПромежуточнаяТаблица.Добавить();
		//		если (Организация.ИНН = "191307958" или ОтражениеПоВидамРасчета) и не НалогиИзДокументаРасчетФзносовСФОТ Тогда
		//			Строка.ВидРасчета = ТекСтрокаОтражениеВБУ.ВидРасчета;
		//		КонецЕсли;
		//		
		//		//О.Т. Аверсон 14.04.2017 № 547
		//		НомерСубконто = 0;
		//		Для Каждого стрВидыСубконто из ТекСтрокаОтражениеВБУ.СчетДт.ВидыСубконто Цикл 
		//			Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
		//				НомерСубконто = стрВидыСубконто.НомерСтроки;							
		//			КонецЕсли;  						
		//		КонецЦикла;
		//		НомерСубконтоНУ = 0;
		//		Для Каждого стрВидыСубконто из ТекСтрокаОтражениеВБУ.СчетДтНУ.ВидыСубконто Цикл 
		//			Если стрВидыСубконто.ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
		//				НомерСубконтоНУ = стрВидыСубконто.НомерСтроки;							
		//			КонецЕсли;  						
		//		КонецЦикла;
		//		//О.Т. Аверсон 14.04.2017 № 547
		//		
		//		Если ТекСтрокаОтражениеВБУ.СчетДт <> ПланыСчетов.Хозрасчетный.ВыплатыизПрибыли Тогда
		//			//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
		//			если не СтатьяЗатратСтрах = Неопределено тогда
		//				если ТекСтрокаОтражениеВБУ.СубконтоДт3 = Неопределено тогда
		//					если ТекСтрокаОтражениеВБУ.СубконтоДт2 = Неопределено  тогда
		//						если ТекСтрокаОтражениеВБУ.СубконтоДт1 = Неопределено тогда
		//							Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
		//							Строка.СубконтоДт1	= ?(НомерСубконто = 1,СтатьяЗатратСтрах,Строка.СубконтоДт1);//О.Т. Аверсон 14.04.2017 № 547
		//						иначе
		//							Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
		//							//Островская Татьяна 14.10.2013 № 16849
		//							если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
		//								Строка.СубконтоДт1	    = ТекСтрокаОтражениеВБУ.СубконтоДт1
		//							иначе
		//								Строка.СубконтоДт1	    = ?(НомерСубконто = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт1);
		//								Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт2); //О.Т. Аверсон 14.04.2017 № 547
		//							КонецЕсли;
		//							//Островская Татьяна 14.10.2013 № 16849
		//						КонецЕсли;
		//					иначе
		//						Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
		//						//Островская Татьяна 03.05.2013 № 16463
		//						//Островская Татьяна 14.10.2013 № 16849
		//						если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
		//							Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
		//							Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
		//						иначе
		//							Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт1);
		//							Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт2);
		//							Строка.СубконтоДт3		= ?(НомерСубконто = 3,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт3);//О.Т. Аверсон 14.04.2017 № 547
		//						КонецЕсли;
		//						//Островская Татьяна 14.10.2013 № 16849
		//						//Островская Татьяна 03.05.2013 № 16463
		//					КонецЕсли;
		//				иначе
		//					Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
		//					//Островская Татьяна 03.05.2013 № 16463
		//					если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
		//						Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
		//					иначе
		//						Строка.СубконтоДт1		= ?(НомерСубконто = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт1);
		//					КонецЕсли;
		//					//Островская Татьяна 03.05.2013 № 16463
		//					Строка.СубконтоДт2		= ?(НомерСубконто = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт2);
		//					Строка.СубконтоДт3		= ?(НомерСубконто = 3,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт3); //О.Т. Аверсон 14.04.2017 № 547
		//					
		//				КонецЕсли;
		//			иначе
		//				Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
		//				//Островская Татьяна 03.05.2013 № 16463
		//				если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
		//					Строка.СубконтоДт1		= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
		//				иначе
		//					Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
		//				КонецЕсли; //Островская Татьяна 03.05.2013 № 16463
		//				Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
		//				Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
		//				
		//			КонецЕсли;
		//			//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411			
		//		Иначе	
		//			НайтиСтроки = ОсновныеСчетаСотрудников.Найти(ТекСтрокаОтражениеВБУ.ФизЛицо, "ФизЛицо");
		//			
		//			Если НайтиСтроки = Неопределено Тогда
		//				Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
		//				Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
		//				Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
		//				Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
		//			Иначе
		//				Если ТекСтрокаОтражениеВБУ.СчетДт <> НайтиСтроки.СчетДт Тогда
		//					Строка.СчетДт			= НайтиСтроки.СчетДт;
		//					Строка.СубконтоДт1		= НайтиСтроки.СубконтоДт1;
		//					Строка.СубконтоДт2		= НайтиСтроки.СубконтоДт2;
		//					Строка.СубконтоДт3		= НайтиСтроки.СубконтоДт3;
		//				иначе
		//					Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
		//					Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
		//					Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
		//					Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
		//				КонецЕсли;
		//			КонецЕсли;
		//		КонецЕсли;
		//		//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
		//		если не СтатьяЗатратСтрах = Неопределено тогда
		//			если ТекСтрокаОтражениеВБУ.СубконтоДтНУ3 = Неопределено тогда
		//				если ТекСтрокаОтражениеВБУ.СубконтоДтНУ2 = Неопределено тогда
		//					если ТекСтрокаОтражениеВБУ.СубконтоДт1 = Неопределено тогда
		//						Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
		//						Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,Строка.СубконтоДтНУ1);//О.Т. Аверсон 14.04.2017 № 547
		//					иначе
		//						
		//						Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
		//						//Островская Татьяна 14.10.2013 № 16849
		//						если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
		//							Строка.СубконтоДтНУ1	    = ТекСтрокаОтражениеВБУ.СубконтоДт1
		//						иначе
		//							Строка.СубконтоДтНУ1	    = ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДт1);
		//							Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);//О.Т. Аверсон 14.04.2017 № 547
		//						КонецЕсли;
		//						//Островская Татьяна 14.10.2013 № 16849
		//					КонецЕсли;
		//				иначе
		//					Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
		//					//Островская Татьяна 03.05.2013 № 16463  
		//					//Островская Татьяна 14.10.2013 № 16849
		//					если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
		//						Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
		//						Строка.СубконтоДтНУ2	= СтатьяЗатратСтрах;
		//					иначе
		//						Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ1);
		//						Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);
		//						Строка.СубконтоДтНУ3	= ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ3);//О.Т. Аверсон 14.04.2017 № 547
		//					КонецЕсли;
		//					//Островская Татьяна 14.10.2013 № 16849
		//					//Островская Татьяна 03.05.2013 № 16463
		//				КонецЕсли;
		//			Иначе 
		//				Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
		//				//Островская Татьяна 03.05.2013 № 16463
		//				если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
		//					Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
		//				иначе
		//					Строка.СубконтоДтНУ1	= ?(НомерСубконтоНУ = 1,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ1);
		//				КонецЕсли;
		//				//Островская Татьяна 03.05.2013 № 16463
		//				Строка.СубконтоДтНУ2	= ?(НомерСубконтоНУ = 2,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ2);
		//				Строка.СубконтоДтНУ3	= ?(НомерСубконтоНУ = 3,СтатьяЗатратСтрах,ТекСтрокаОтражениеВБУ.СубконтоДтНУ3);//О.Т. Аверсон 14.04.2017 № 547
		//				
		//			КонецЕсли;
		//		иначе
		//			Строка.СчетДтНУ			= ТекСтрокаОтражениеВБУ.СчетДтНУ;
		//			//Островская Татьяна 03.05.2013 № 16463
		//			если  Лев(ТекСтрокаОтражениеВБУ.СчетДт,2) = "97" Тогда
		//				Строка.СубконтоДтНУ1	= Справочники.РасходыБудущихПериодов.РБПНаЕСН;
		//			иначе
		//				Строка.СубконтоДтНУ1	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ1;
		//			КонецЕсли; //Островская Татьяна 03.05.2013 № 16463
		//			Строка.СубконтоДтНУ2	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ2;
		//			Строка.СубконтоДтНУ3	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ3;
		//			
		//		КонецЕсли;
		//		//Аверсон-софт, Островская Татьяна 18.06.2012 № 15411
		//		
		//		
		//		КоррСчет				=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
		//		Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетБУ;//О.Т. Аверсон 30.03.2016 № 950
		//		
		//		Строка.СчетКт			=  КоррСчет;
		//		
		//		Субконто    = Новый Массив(3);
		//		Для тт=0 по 2 цикл
		//			Субконто[тт] = Неопределено;
		//		КонецЦикла;
		//		
		//		Для тт=0 по КоррСчет.ВидыСубконто.Количество()-1 Цикл
		//			Если НЕ Коррсчет.ВидыСубконто[тт].ВидСубконто = Неопределено тогда
		//				Если Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("ПеречислениеСсылка.ВидыПлатежейВГосБюджет")) Тогда
		//					Субконто[тт] = Перечисления.ВидыПлатежейВГосБюджет.Налог;
		//					
		//				ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Организации")) Тогда
		//					Субконто[тт] = Организация;
		//					
		//				ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Контрагенты")) Тогда
		//					Субконто[тт] =РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
		//					Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Контрагент;//О.Т. Аверсон 30.03.2016 № 950
		//					
		//				ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ДоговорыКонтрагентов")) Тогда
		//					Субконто[тт] = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
		//					Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Договор;//О.Т. Аверсон 30.03.2016 № 950
		//					
		//				КонецЕсли;
		//			КонецЕсли;
		//			
		//		КонецЦикла;
		//		
		//		Строка.СубконтоКт1		= Субконто[0];
		//		Строка.СубконтоКт2		= Субконто[1];
		//		Строка.СубконтоКт3		= Субконто[2];
		//		
		//		Строка.СчетКтНУ			=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
		//		Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 30.03.2016 № 950
		//		Если ПериодРегистрации < Дата(2016,07,1) Тогда //О.Т. Аверсон 16.03.2016 № 949
		//			Строка.Сумма			= Окр(ВыборкаДетальныеЗаписи.Доплата,2);
		//		иначе
		//			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
		//			//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаДетальныеЗаписи.Доплата,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
		//			Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ВыборкаДетальныеЗаписи.Доплата,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
		//			//Аверсон
		//			
		//		КонецЕсли;
		//		
		//		//Островская Татьяна 07.05.2014 № 17239
		//		Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ОбязательноеСтрахование;
		//	КонецЕсли;
		//КонецЦикла;
		СтрСЗДляДоплаты = СЗДляДоплаты.Добавить();
		СтрСЗДляДоплаты.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
		СтрСЗДляДоплаты.Период = ТекСтрокаОтражениеВБУ.ПериодРегистрации;//О.Т. 02.03.2015 № 17778
		//О.Т. 18.09.2014 № 224
		
		
		//+ СВЭЙ КДЯ 31.05.19 СВФР-004379
		// + Аверсон СМА 22.05.2020 СВФР-005987
		Если  Строка = Неопределено Тогда
		Иначе
			// - Аверсон СМА 22.05.2020	СВФР-005987
			Если Строка.СчетКт = СчетКтБГС И НЕ ЗначениеЗаполнено(Строка.ФизЛицо) Тогда  //Аверсон 14.08.2020 КВВ СВФР-006325  (условие на если не заполнено физлицо)
				Строка.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
			КонецЕсли;
		КонецЕсли;
		//- СВЭЙ КДЯ 31.05.19 СВФР-004379
		
		//Чрезвычайный налог
		
		//О.Т. Аверсон 06.04.2017 № 514
		Если ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
			//Аверсон ЕАЕ 17.06.2020 СВФР-006057
			//(7) этот запрос вынесен из цикла
			//ЗапросФСЗНБГС = Новый Запрос;
			//ЗапросФСЗНБГС.Текст = 
			//"ВЫБРАТЬ
			//|	ЕСНИсчисленный.ЕдиныйПлатеж, 100 как ДоляСпособаОтражения
			//|ИЗ
			//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
			//|ГДЕ
			//|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
			//|	И ЕСНИсчисленный.Организация = &Организация
			//|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
			//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) > НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ) И ЕСНИсчисленный.ЕдиныйПлатеж <> 0";
			
			СтрОтбора = Новый Структура;
			СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//МассивСтрокЕСНИсчисленный = ТЗЕСНИсчисленныйРБПЕдиныйПлатеж.НайтиСтроки(СтрОтбора);
			МассивСтрокЕСНИсчисленный = ТЗЕСНИсчисленныйРБП.НайтиСтроки(СтрОтбора);
			//Аверсон
		иначе
			//Аверсон ЕАЕ 17.06.2020 СВФР-006057
			//(8) этот запрос вынесен из цикла
			//ЗапросФСЗНБГС = Новый Запрос;
			//ЗапросФСЗНБГС.Текст = 
			//"ВЫБРАТЬ
			//|	ЕСНИсчисленный.ЕдиныйПлатеж,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
			//|ИЗ
			//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
			//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
			//|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
			//|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
			//|			И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
			//|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
			//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
			//|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2
			//|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)";
			////О.Т. Аверсон 19.10.2017 № 1147
			//Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1) Тогда //О.Т. Аверсон 29.08.2018 № 2322 //и не ТипЗнч(ТекСтрокаОтражениеВБУ.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций")
			//	ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + " 
			//	|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1
			//	|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)";
			//КонецЕсли;
			////О.Т. Аверсон 19.10.2017 № 1147
			//
			//ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + "
			//|ГДЕ
			//|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
			//|	И ЕСНИсчисленный.Организация = &Организация
			//|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
			//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
			//|	И ЕСНИсчисленный.ЕдиныйПлатеж <> 0";
			
			//ТЗЕСНИсчисленныйБезДопУсловияКопия3 = ТЗЕСНИсчисленныйБезДопУсловияЕдиныйПлатеж.Скопировать();
			//ТЗЕСНИсчисленныйСДопУсловиемКопия3 = ТЗЕСНИсчисленныйСДопУсловиемЕдиныйПлатеж.Скопировать();
			//ТЗЕСНИсчисленныйБезДопУсловияКопия3 = ТЗЕСНИсчисленныйБезДопУсловия.Скопировать();
			//ТЗЕСНИсчисленныйСДопУсловиемКопия3 = ТЗЕСНИсчисленныйСДопУсловием.Скопировать();
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ПланыСчетов.Хозрасчетный.ПустаяСсылка());
			//
			//МассивСтрокСПустымСчетДт = ТЗЕСНИсчисленныйБезДопУсловияКопия3.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСчетДт Цикл
			//	ЭлСтр.СчетДт = ТекСтрокаОтражениеВБУ.СчетДт;	
			//КонецЦикла;
			//
			//МассивСтрокСПустымСчетДт_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия3.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСчетДт_1 Цикл
			//	ЭлСтр.СчетДт = ТекСтрокаОтражениеВБУ.СчетДт;	
			//КонецЦикла;
			
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", 1);
			//
			//МассивСтрокСПустымСубконтоДт2 = ТЗЕСНИсчисленныйБезДопУсловияКопия3.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт2 Цикл
			//	ЭлСтр.СубконтоДт2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;	
			//КонецЦикла;
			//
			//МассивСтрокСПустымСубконтоДт2_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия3.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт2_1 Цикл
			//	ЭлСтр.СубконтоДт2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;	
			//КонецЦикла;
			//
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			//
			//МассивСтрокБезДопУсловия = ТЗЕСНИсчисленныйБезДопУсловияКопия3.НайтиСтроки(СтрОтбора);
			//
			//СтрОтбора.Вставить("СубконтоДт1", 1);
			//
			//МассивСтрокСПустымСубконтоДт1_1 = ТЗЕСНИсчисленныйСДопУсловиемКопия3.НайтиСтроки(СтрОтбора);
			//Для Каждого ЭлСтр Из МассивСтрокСПустымСубконтоДт1_1 Цикл
			//	ЭлСтр.СубконтоДт1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;	
			//КонецЦикла;
			//
			//СтрОтбора = Новый Структура;
			//СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			//СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			//СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			//СтрОтбора.Вставить("СубконтоДт1", ТекСтрокаОтражениеВБУ.СубконтоДт1);
			//
			//МассивСтрокСДопУсловием = ТЗЕСНИсчисленныйСДопУсловиемКопия3.НайтиСтроки(СтрОтбора);
			//
			//Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1) Тогда
			//	МассивСтрокЕСНИсчисленный = МассивСтрокСДопУсловием;
			//Иначе
			//	МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия;
			//КонецЕсли;
			СтрОтбора = Новый Структура;
			СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
			СтрОтбора.Вставить("СчетДт", ТекСтрокаОтражениеВБУ.СчетДт);
			СтрОтбора.Вставить("СубконтоДт2", ТекСтрокаОтражениеВБУ.СубконтоДт2);
			
			МассивСтрокБезДопУсловия = ТЗЕСНИсчисленныйБезДопУсловия.НайтиСтроки(СтрОтбора);
			
			СтрОтбора.Вставить("СубконтоДт1", ТекСтрокаОтражениеВБУ.СубконтоДт1);
			
			МассивСтрокСДопУсловием = ТЗЕСНИсчисленныйСДопУсловием.НайтиСтроки(СтрОтбора);
			
			Если ЗначениеЗаполнено(ТекСтрокаОтражениеВБУ.СубконтоДт1) Тогда
				МассивСтрокЕСНИсчисленный = МассивСтрокСДопУсловием;
			Иначе
				МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия;
			КонецЕсли;
			//Аверсон
		КонецЕсли;
		
		//Аверсон ЕАЕ 17.06.2020 СВФР-006057
		//ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
		//ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
		//ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
		//ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
		//ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",ТекСтрокаОтражениеВБУ.СчетДт);
		//ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт2",ТекСтрокаОтражениеВБУ.СубконтоДт2);
		//ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт1",ТекСтрокаОтражениеВБУ.СубконтоДт1);
		
		//РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
		//ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
		//Аверсон
		
		ЕстьПроцент = Ложь;
		
		//Аверсон ЕАЕ 17.06.2020 СВФР-006057
		//Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл 
		Для Каждого ЭлСтр Из МассивСтрокЕСНИсчисленный Цикл
			//Аверсон
			Если ЗначениеЗаполнено(ЭлСтр.ДоляСпособаОтражения) Тогда 
				ЕстьПроцент = Истина;
			КонецЕсли;  			
		КонецЦикла;
		Если не НалогиИзДокументаРасчетФзносовСФОТ Тогда 
			ОтражениеВБУДляБазы = Новый ТаблицаЗначений;
			МассивСтрокПоСчету = Новый Массив;
		иначе
			МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
		КонецЕсли;
		ЭтоОснНач = Ложь;
		Если МассивСтрокПоСчету.Количество()>0 Тогда 
			стрМассив = МассивСтрокПоСчету[0]; 
			ЭтоОснНач = ТипЗнч(стрМассив.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций");
		КонецЕсли;
		
		Если не ЕстьПроцент и ?(ОрганизацияИНН = "192798722",ЭтоОснНач, Истина) Тогда //и ЭтоОснНач //О.Т. Аверсон 25.03.2019 № 4135
			//Аверсон ЕАЕ 17.06.2020 СВФР-006057
			//ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1","");
			//ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)","");
			МассивСтрокЕСНИсчисленный = МассивСтрокБезДопУсловия;
			//Аверсон
		КонецЕсли;
		
		//Аверсон ЕАЕ 17.06.2020 СВФР-006057
		//РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
		//ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
		//Аверсон
		
		ЕдиныйПлатеж = 0;
		ЕдиныйПлатежПрошл = 0;
		ЕдиныйПлатежПрошл1 = 0;
		//Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл
		Для Каждого ВыборкаДетальныеЗаписиФСЗНБГС Из МассивСтрокЕСНИсчисленный Цикл	
			если ВыборкаДетальныеЗаписиФСЗНБГС.ЕдиныйПлатеж <> 0 Тогда 
				КолСчетовИзОбщейБазы = 0;
				МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
				Если МассивОбщаяБазы.Количество()>0 Тогда 
					КолСчетовИзОбщейБазы = МассивОбщаяБазы[0].КолСчетов;
					Если МассивОбщаяБазы[0].СчетНеИзРаспределения <> Неопределено Тогда 
						МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
						БазаОбщаяЕдиный = 0;
						
						ПроверкаПериодДействияПрошл = "";
						ПроверкаБазаЕдиныйПрошл = "";
						ПроверкаБазаЕдиныйНУПрошл = "";
						Для Каждого стрМассив из МассивСтрокПоСчету Цикл
							Если стрМассив.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда Тогда //О.Т. Аверсон 30.08.2018 № 2322
								ПроверкаКолСчетов = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета",ТекСтрокаОтражениеВБУ.ФизЛицо,ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда));
								КолСчетовПоДог = 0;
								СчетПрошл = "";
								Для Каждого стр из ПроверкаКолСчетов Цикл 
									Если СчетПрошл <> стр.СчетДт Тогда 
										КолСчетовПоДог = КолСчетовПоДог+1;
									КонецЕсли;   									
									СчетПрошл = стр.СчетДт;
								КонецЦикла;
								
								Если КолСчетовПоДог>1 Тогда 
									Если ПроверкаПериодДействияПрошл <> стрМассив.ПериодДействия и ПроверкаБазаЕдиныйПрошл <> стрМассив.БазаЕдиныйПлатеж и ПроверкаБазаЕдиныйНУПрошл = стрМассив.БазаЕдиныйПлатежБУ Тогда 
										Продолжить;
									КонецЕсли;     																
								КонецЕсли;
								
								Если КолСчетовПоДог>1 Тогда 
									БазаОбщаяЕдиный = БазаОбщаяЕдиный + стрМассив.БазаЕдиныйПлатежБУ;
								иначе
									БазаОбщаяЕдиный = БазаОбщаяЕдиный + стрМассив.БазаЕдиныйПлатеж; 
								КонецЕсли;
								ПроверкаПериодДействияПрошл = стрМассив.ПериодДействия; 
								ПроверкаБазаЕдиныйПрошл = стрМассив.БазаЕдиныйПлатеж;
								ПроверкаБазаЕдиныйНУПрошл = стрМассив.БазаЕдиныйПлатежБУ;
								
							иначе
								БазаОбщаяЕдиный = БазаОбщаяЕдиный + стрМассив.БазаЕдиныйПлатеж; 
							КонецЕсли; 
							
						КонецЦикла;  
						БазаОбщаяЕдиный = БазаОбщаяЕдиный * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						
						//УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаЕдиный=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаОбщаяЕдиный / МассивОбщаяБазы[0].БазаЕдиный * 100,ПериодРегистрации));
						УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаЕдиный=0,0,БазаОбщаяЕдиный / МассивОбщаяБазы[0].БазаЕдиный * 100);
						
						ЕдиныйПлатеж = ВыборкаДетальныеЗаписиФСЗНБГС.ЕдиныйПлатеж * УдельныйВесДляПропорции / 100;
						
						Если МассивОбщаяБазы[0].БазаЕдиный = 0 и БазаОбщаяЕдиный = 0 Тогда 
							МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда
								Если МассивДляУдельногоВеса[0].ПроцентыСумм <> 100 Тогда 
									ЕдиныйПлатеж = ВыборкаДетальныеЗаписиФСЗНБГС.ЕдиныйПлатеж * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
									УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
								КонецЕсли;
							иначе
								ЕдиныйПлатеж = ВыборкаДетальныеЗаписиФСЗНБГС.ЕдиныйПлатеж * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
								УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
							КонецЕсли;
						КонецЕсли;
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
							Если ЕдиныйПлатежПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							КонецЕсли;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
							Если ЕдиныйПлатежПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
						КонецЕсли;
					иначе
						ЕдиныйПлатеж = ВыборкаДетальныеЗаписиФСЗНБГС.ЕдиныйПлатеж * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
							МассивДляУдельногоВеса[0].ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения); 
							Если ЕдиныйПлатежПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							КонецЕсли;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
							Если ЕдиныйПлатежПрошл = 0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					
					
				иначе
					ЕдиныйПлатеж = ВыборкаДетальныеЗаписиФСЗНБГС.ЕдиныйПлатеж * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
				КонецЕсли;
				Если ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
					ЕдиныйПлатеж = ВыборкаДетальныеЗаписиФСЗНБГС.ЕдиныйПлатеж * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
				КонецЕсли;
				
				
				Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
					МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
					КолСчетовОбщий = 0;
					Если МассивДляУдельногоВеса.Количество()>0 Тогда 
						УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
						КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
					КонецЕсли;
					
					МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
					Если МассивКорректировкаКопеек.Количество()>0 Тогда 
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж = МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж + ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
						МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж = МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
						//Аверсон
						
						Если  КолСчетовОбщий = КолСчетовИзОбщейБазы Тогда
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,ПериодРегистрации)-0.01 = СуммаДляРаспр
							//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,ПериодРегистрации)-0.01 = Окр(СуммаДляРаспр,2) Тогда
							//	ЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации)-0.01; 							
							//КонецЕсли;
							Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,,ТочностьРасчетов)-0.01 = СуммаДляРаспр
								или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,,ТочностьРасчетов)-0.01 = Окр(СуммаДляРаспр,2) Тогда
								ЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов)-0.01; 							
							КонецЕсли;
							//Аверсон
							
							//Аверсон ЕАЕ 16.06.2020 СВФР-006057
							//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,ПериодРегистрации)+0.01 = СуммаДляРаспр
							//	или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,ПериодРегистрации)+0.01 = Окр(СуммаДляРаспр,2) Тогда
							//	ЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации)+0.01; 							
							//КонецЕсли;
							Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,,ТочностьРасчетов)+0.01 = СуммаДляРаспр
								или ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,,ТочностьРасчетов)+0.01 = Окр(СуммаДляРаспр,2) Тогда
								ЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов)+0.01; 							
							КонецЕсли;
							//Аверсон
							
						КонецЕсли;
						
					иначе
						СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
						СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
						СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
						//Аверсон
						
						СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
						СтрТЗКорректировкаКопеек.СуммаБГС = 0;
						//+ СВЭЙ КДЯ 23.05.19 СВФР-004375
						СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = 0;
						СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС = 0;								
						//- СВЭЙ КДЯ 23.05.19 СВФР-004375
					КонецЕсли;
					
					//О.Т. Аверсон 31.08.2018 № 2322
					СуммаОбщая = Окр(СуммаДляРаспр,2);
					МассивКорректировкаКопеек = ТЗКорректировкаКопеекПоИтогу.НайтиСтроки(Новый Структура("ФизЛицо,СуммаСравненияЕдиныйПлатеж",ТекСтрокаОтражениеВБУ.ФизЛицо,СуммаОбщая));
					Если МассивКорректировкаКопеек.Количество()>0 Тогда
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж = МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж + ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
						МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж = МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
						//Аверсон
						
						//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
						//МассивКорректировкаКопеек[0].Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
						//МассивКорректировкаКопеек[0].Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
						//МассивКорректировкаКопеек[0].Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
						//- СВЭЙ КДЯ 01.06.19 СВФР-004379
						
						//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
						СтрКорр = МассивКорректировкаКопеек[0];
						Если ЭтоУточнениеНабораСубконто( СтрКорр, ТекСтрокаОтражениеВБУ ) Тогда
							
							СтрКорр.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
							СтрКорр.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
							СтрКорр.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
							
						КонецЕсли;
						//- СВЭЙ КДЯ 01.06.19 СВФР-004379
						
					иначе								
						СтрТЗКорректировкаКопеекПоИтогу = ТЗКорректировкаКопеекПоИтогу.Добавить();
						СтрТЗКорректировкаКопеекПоИтогу.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
						
						//Аверсон ЕАЕ 16.06.2020 СВФР-006057
						//СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
						СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
						//Аверсон
						
						СтрТЗКорректировкаКопеекПоИтогу.СуммаФСЗН = 0;
						СтрТЗКорректировкаКопеекПоИтогу.СуммаБГС = 0;								
						СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = 0;
						СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = 0;
						СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияЕдиныйПлатеж = Окр(СуммаДляРаспр,2);
						СтрТЗКорректировкаКопеекПоИтогу.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
						СтрТЗКорректировкаКопеекПоИтогу.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
						СтрТЗКорректировкаКопеекПоИтогу.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
					КонецЕсли;
					//О.Т. Аверсон 31.08.2018 № 2322
					
				КонецЕсли;
			КонецЕсли;
			
			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
			//ЕдиныйПлатежПрошл = ЕдиныйПлатежПрошл + ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
			ЕдиныйПлатежПрошл = ЕдиныйПлатежПрошл + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
			//Аверсон
			
			ЕдиныйПлатежПрошл1 = ЕдиныйПлатежПрошл1 + ВыборкаДетальныеЗаписиФСЗНБГС.ЕдиныйПлатеж;//О.Т. Аверсон 31.08.2018 № 2322
		КонецЦикла;
		ЕдиныйПлатеж = ЕдиныйПлатежПрошл;
		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
			МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
			МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
			Для Каждого стрОбщБаза из МассивОбщаяБазы Цикл //стрОбщБаза.КолСчетов > 1
				Если МассивСтрокЕСНИсчисленный.Количество()=0 и не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда //стрОбщБаза.СчетНеИзРаспределения <> Неопределено и 
					//Аверсон ЕАЕ 12.06.2020 СВФР-006057
					//(19) этот запрос вынесен из цикла
					
					//ЗапросБазаДляРаспр = Новый Запрос;
					//ЗапросБазаДляРаспр.Текст = 
					//"ВЫБРАТЬ
					//|	ЕСНИсчисленный.ЕдиныйПлатеж
					//|ИЗ
					//|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
					//|ГДЕ
					//|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
					//|	И ЕСНИсчисленный.Организация = &Организация
					//|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
					//|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)";
					//ЗапросБазаДляРаспр.УстановитьПараметр("Организация", Организация);
					//ЗапросБазаДляРаспр.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
					//ЗапросБазаДляРаспр.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
					//ЗапросБазаДляРаспр.УстановитьПараметр("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					//РезБазаДляРаспр = ЗапросБазаДляРаспр.Выполнить().Выгрузить();
					СтрОтбора = Новый Структура;
					СтрОтбора.Вставить("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо);
					РезБазаДляРаспр = ТЗЕСНИсчисленныйРБПМеньше.НайтиСтроки(СтрОтбора);
					//!!!
					//Аверсон
					
					Если МассивДляУдельногоВеса.Количество()>0 Тогда 
						Если МассивДляУдельногоВеса[0].КолСчетовСумм+1 = стрОбщБаза.КолСчетов Тогда 
							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
							БазаПоСчету = 0;
							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаЕдиныйПлатеж;
							КонецЦикла;
							
							СуммаДляРаспр = 0;
							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ЕдиныйПлатеж;
							КонецЦикла;
							СуммаУжеРаспределенная = Ложь;
							Если МассивДляУдельногоВеса[0].ПроцентыСумм >= 100 Тогда 
								УдельныйВесДляПропорции = ?(стрОбщБаза.БазаЕдиный=0,0,БазаПоСчету / стрОбщБаза.БазаЕдиный * 100);
							иначе
								УдельныйВесДляПропорции = 100-МассивДляУдельногоВеса[0].ПроцентыСумм;
								СуммаУжеРаспределенная = Истина;
							КонецЕсли;
							
							ЕдиныйПлатеж = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							
							МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							иначе
								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.Добавить();
								СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
							
							
						иначе
							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
							БазаПоСчету = 0;
							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаЕдиныйПлатеж;
							КонецЦикла; 
							
							//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаЕдиный=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаЕдиный * 100,ПериодРегистрации));
							УдельныйВесДляПропорции = ?(стрОбщБаза.БазаЕдиный=0,0,БазаПоСчету / стрОбщБаза.БазаЕдиный * 100);
							
							СуммаДляРаспр = 0;
							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ЕдиныйПлатеж;
							КонецЦикла;
							
							ЕдиныйПлатеж = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
							
							МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
							иначе
								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.Добавить();
								СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
							КонецЕсли;
							
							
						КонецЕсли;
					иначе
						МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",ТекСтрокаОтражениеВБУ.ФизЛицо,ТекСтрокаОтражениеВБУ.СчетДт,ТекСтрокаОтражениеВБУ.СубконтоДт1,ТекСтрокаОтражениеВБУ.СубконтоДт2,ТекСтрокаОтражениеВБУ.СубконтоДт3));
						БазаПоСчету = 0;
						Для Каждого стрмассивСтрок из МассивСтрок Цикл 
							БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаЕдиныйПлатеж;
						КонецЦикла; 
						
						//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаЕдиный=0,0,?(стрОбщБаза.БазаЕдиный <>0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаЕдиный * 100,ПериодРегистрации),0));
						УдельныйВесДляПропорции = ?(стрОбщБаза.БазаЕдиный=0,0,?(стрОбщБаза.БазаЕдиный <>0,БазаПоСчету / стрОбщБаза.БазаЕдиный * 100,0));
						СуммаДляРаспр = 0;
						Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
							СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ЕдиныйПлатеж;
						КонецЦикла;
						
						ЕдиныйПлатеж = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
						
						
						МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
							МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
						иначе
							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.Добавить();
							СтрТЗДляУдельногоВеса.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
							СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
						КонецЕсли;
						
						
					КонецЕсли;
					
					
					если ЕдиныйПлатеж <> 0 Тогда 
						Если не ТекСтрокаОтражениеВБУ.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
							МассивДляУдельногоВеса = ТЗДляУдельногоВесаЕдиный.НайтиСтроки(Новый Структура("ФизЛицо", ТекСтрокаОтражениеВБУ.ФизЛицо));
							КолСчетовОбщий = 0;
							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
								УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
								КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
							КонецЕсли;
							
							МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",ТекСтрокаОтражениеВБУ.ФизЛицо));
							Если МассивКорректировкаКопеек.Количество()>0 Тогда 
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж = МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж + ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
								МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж = МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
								//Аверсон
								
								Если  КолСчетовОбщий = стрОбщБаза.КолСчетов Тогда
									
									//Аверсон ЕАЕ 16.06.2020 СВФР-006057
									//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,ПериодРегистрации)-0.01 = МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ЕдиныйПлатеж Тогда
									//	ЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации)-0.01; 							
									//КонецЕсли;
									//Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,ПериодРегистрации)+0.01 = МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ЕдиныйПлатеж Тогда
									//	ЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации)+0.01; 							
									//КонецЕсли;
									Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,,ТочностьРасчетов)-0.01 = МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ЕдиныйПлатеж Тогда
										ЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов)-0.01; 							
									КонецЕсли;
									Если ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж,,ТочностьРасчетов)+0.01 = МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ЕдиныйПлатеж Тогда
										ЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов)+0.01; 							
									КонецЕсли;
									//Аверсон
									
								КонецЕсли;
								
							иначе
								СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
								СтрТЗКорректировкаКопеек.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
								СтрТЗКорректировкаКопеек.СуммаБГС = 0;
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
								СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
								//Аверсон
								
								//+ СВЭЙ КДЯ 23.05.19 СВФР-004375
								СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияФСЗН = 0;
								СтрТЗКорректировкаКопеек.ДоляСпособаОтраженияБГС = 0;								
								//- СВЭЙ КДЯ 23.05.19 СВФР-004375
							КонецЕсли;
							
							//О.Т. Аверсон 31.08.2018 № 2322
							СуммаОбщая = ?(ЗначениеЗаполнено(ЕдиныйПлатежПрошл1),ЕдиныйПлатежПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ЕдиныйПлатеж);
							МассивКорректировкаКопеек = ТЗКорректировкаКопеекПоИтогу.НайтиСтроки(Новый Структура("ФизЛицо,СуммаСравненияЕдиныйПлатеж",ТекСтрокаОтражениеВБУ.ФизЛицо,СуммаОбщая));
							Если МассивКорректировкаКопеек.Количество()>0 Тогда 
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж = МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж + ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
								МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж = МассивКорректировкаКопеек[0].СуммаЕдиныйПлатеж + ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
								//Аверсон
								
								//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
								//МассивКорректировкаКопеек[0].Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
								//МассивКорректировкаКопеек[0].Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
								//МассивКорректировкаКопеек[0].Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
								//- СВЭЙ КДЯ 01.06.19 СВФР-004379
								
								//+ СВЭЙ КДЯ 01.06.19 СВФР-004379
								СтрКорр = МассивКорректировкаКопеек[0];
								Если ЭтоУточнениеНабораСубконто( СтрКорр, ТекСтрокаОтражениеВБУ ) Тогда
									
									СтрКорр.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
									СтрКорр.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
									СтрКорр.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
									
								КонецЕсли;
								//- СВЭЙ КДЯ 01.06.19 СВФР-004379
								
							иначе								
								СтрТЗКорректировкаКопеекПоИтогу = ТЗКорректировкаКопеекПоИтогу.Добавить();
								СтрТЗКорректировкаКопеекПоИтогу.ФизЛицо = ТекСтрокаОтражениеВБУ.ФизЛицо;
								
								//Аверсон ЕАЕ 16.06.2020 СВФР-006057
								//СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
								СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
								//Аверсон
								
								СтрТЗКорректировкаКопеекПоИтогу.СуммаФСЗН = 0;
								СтрТЗКорректировкаКопеекПоИтогу.СуммаБГС = 0;								
								СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = 0;
								СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = 0;
								СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияЕдиныйПлатеж = ?(ЗначениеЗаполнено(ЕдиныйПлатежПрошл1),ЕдиныйПлатежПрошл1,МассивСтрокЕСНИсчисленный[МассивСтрокЕСНИсчисленный.Количество() - 1].ЕдиныйПлатеж);
								СтрТЗКорректировкаКопеекПоИтогу.Субконто1 = ТекСтрокаОтражениеВБУ.СубконтоДт1;
								СтрТЗКорректировкаКопеекПоИтогу.Субконто2 = ТекСтрокаОтражениеВБУ.СубконтоДт2;
								СтрТЗКорректировкаКопеекПоИтогу.Субконто3 = ТекСтрокаОтражениеВБУ.СубконтоДт3;
							КонецЕсли;
							//О.Т. Аверсон 31.08.2018 № 2322
							
						КонецЕсли;
					КонецЕсли;
					
					
				КонецЕсли;
				
			КонецЦикла;
		КонецЕсли;
		
		//О.Т. Аверсон 06.04.2017 № 514
		Если ?(НалогиИзДокументаРасчетФзносовСФОТ,ЕдиныйПлатеж,ТекСтрокаОтражениеВБУ.БазаЕдиныйПлатеж) <> 0 Тогда
			Строка = ПромежуточнаяТаблица.Добавить();
			если ((ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета) и не НалогиИзДокументаРасчетФзносовСФОТ Тогда //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
				Строка.ВидРасчета = ТекСтрокаОтражениеВБУ.ВидРасчета;
			КонецЕсли;
			
			Если ТекСтрокаОтражениеВБУ.СчетДт <> ПланыСчетов.Хозрасчетный.ВыплатыизПрибыли Тогда
				Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
				Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
				Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
				Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
			Иначе	
				НайтиСтроки = ОсновныеСчетаСотрудников.Найти(ТекСтрокаОтражениеВБУ.ФизЛицо, "ФизЛицо");
				
				Если НайтиСтроки = Неопределено Тогда
					Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
					Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
					Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
					Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
				Иначе
					Если ТекСтрокаОтражениеВБУ.СчетДт <> НайтиСтроки.СчетДт Тогда
						Строка.СчетДт			= НайтиСтроки.СчетДт;
						Строка.СубконтоДт1		= НайтиСтроки.СубконтоДт1;
						Строка.СубконтоДт2		= НайтиСтроки.СубконтоДт2;
						Строка.СубконтоДт3		= НайтиСтроки.СубконтоДт3;
					иначе
						Строка.СчетДт			= ТекСтрокаОтражениеВБУ.СчетДт;
						Строка.СубконтоДт1		= ТекСтрокаОтражениеВБУ.СубконтоДт1;
						Строка.СубконтоДт2		= ТекСтрокаОтражениеВБУ.СубконтоДт2;
						Строка.СубконтоДт3		= ТекСтрокаОтражениеВБУ.СубконтоДт3;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			Строка.СчетДтНУ		    = ТекСтрокаОтражениеВБУ.СчетДтНУ;				
			Строка.СубконтоДтНУ1	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3	= ТекСтрокаОтражениеВБУ.СубконтоДтНУ3;
			
			// ЕдиныйПлатеж
			Строка.СчетКт			=  РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж,ВидНалогообложения)).СчетБУ; //О.Т. Аверсон 25.03.2016 № 950
			
			Строка.СубконтоКт1		= СубконтоКредита;
			Строка.СчетКтНУ			=  РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж,ВидНалогообложения)).СчетНУ; //О.Т. Аверсон 25.03.2016 № 950
			//Островская Татьяна 07.05.2014 № 17239
			Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
				
				//Аверсон ЕАЕ 16.06.2020 СВФР-006057
				//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(ЕдиныйПлатеж,ПериодРегистрации);
				Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ЕдиныйПлатеж,,ТочностьРасчетов);
				//Аверсон
			иначе				
				если КоличествоСтрокПоФизЛицу>1 Тогда
					
					//Аверсон ЕАЕ 16.06.2020 СВФР-006057
					//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаОтражениеВБУ.БазаЕдиныйПлатежБУ * СтавкаЕдиныйПлатеж / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
					Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ТекСтрокаОтражениеВБУ.БазаЕдиныйПлатежБУ * СтавкаЕдиныйПлатеж / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
					//Аверсон
				иначе
					//Аверсон ЕАЕ 16.06.2020 СВФР-006057
					//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаОтражениеВБУ.БазаЕдиныйПлатеж * СтавкаЕдиныйПлатеж / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
					Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ТекСтрокаОтражениеВБУ.БазаЕдиныйПлатеж * СтавкаЕдиныйПлатеж / 100,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
					//Аверсон
				КонецЕсли;
			КонецЕсли;
			//Островская Татьяна 07.05.2014 № 17239
			
			Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ЧрезвычайныйНалог;
		КонецЕсли;
		
	КонецЦикла;
	
	// + СВЭЙ КДЯ 31.05.19 СВФР-004379
	//ТЗКорректировкаКопеекПоИтогу.Свернуть("Субконто1,Субконто2,Субконто3","СуммаФСЗН,СуммаБГС,СуммаЕдиныйПлатеж,СуммаСравненияФСЗН,СуммаСравненияБГС,СуммаСравненияЕдиныйПлатеж");
	// - СВЭЙ КДЯ 31.05.19 СВФР-004379
	// + СВЭЙ КДЯ 31.05.19 СВФР-004379
	ТЗКорректировкаКопеекПоИтогу.Сортировать( "ФизЛицо" );
	ТЗКорректировкаКопеекПоИтогу.Свернуть("ФизЛицо,Субконто1,Субконто2,Субконто3","СуммаФСЗН,СуммаБГС,СуммаЕдиныйПлатеж,СуммаСравненияФСЗН,СуммаСравненияБГС,СуммаСравненияЕдиныйПлатеж");
	// - СВЭЙ КДЯ 31.05.19 СВФР-004379
	Для Каждого стр из ТЗКорректировкаКопеекПоИтогу Цикл 
		Если стр.СуммаФСЗН <> стр.СуммаСравненияФСЗН Тогда 
			КолКопеекНеСовпадения = стр.СуммаФСЗН - стр.СуммаСравненияФСЗН;
			
			//+ СВЭЙ КДЯ 06.06.19 СВФР-004427
			//СчетКт69 = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
			//Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;
			//МассивПромТаблица = ПромежуточнаяТаблица.НайтиСтроки(Новый Структура("СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетКт",стр.Субконто1,стр.Субконто2,стр.Субконто3,СчетКт69));
			//- СВЭЙ КДЯ 06.06.19 СВФР-004427
			
			//+ СВЭЙ КДЯ 06.06.19 СВФР-004427
			МассивПромТаблица = ПромежуточнаяТаблица.НайтиСтроки( Новый Структура( "ФизЛицо,СчетКт", стр.ФизЛицо, СчетКтФСЗН ) );
			//- СВЭЙ КДЯ 31.05.19 СВФР-004379
			
			Если МассивПромТаблица.Количество()>0 Тогда 
				МассивПромТаблица[0].Сумма = МассивПромТаблица[0].Сумма - КолКопеекНеСовпадения;
			КонецЕсли;
		КонецЕсли;
		Если стр.СуммаБГС <> стр.СуммаСравненияБГС Тогда 
			КолКопеекНеСовпадения = стр.СуммаБГС - стр.СуммаСравненияБГС;
			// + СВЭЙ КДЯ 31.05.19 СВФР-004379		
			//МассивПромТаблица = ПромежуточнаяТаблица.НайтиСтроки(Новый Структура("СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетКт",стр.Субконто1,стр.Субконто2,стр.Субконто3,СчетКтБГС));
			//СчетКтБГС =  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//		Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетБУ;
			
			//МассивПромТаблица = ПромежуточнаяТаблица.НайтиСтроки(Новый Структура("СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетКт",стр.Субконто1,стр.Субконто2,стр.Субконто3,СчетКтБГС));
			// - СВЭЙ КДЯ 31.05.19 СВФР-004379
			// + СВЭЙ КДЯ 31.05.19 СВФР-004379		
			МассивПромТаблица = ПромежуточнаяТаблица.НайтиСтроки( Новый Структура( "ФизЛицо,СчетКт", стр.ФизЛицо, СчетКтБГС ) );
			// - СВЭЙ КДЯ 31.05.19 СВФР-004379
			
			Если МассивПромТаблица.Количество()>0 Тогда 
				МассивПромТаблица[0].Сумма = МассивПромТаблица[0].Сумма - КолКопеекНеСовпадения;
			КонецЕсли;
		КонецЕсли;
		Если стр.СуммаЕдиныйПлатеж <> стр.СуммаСравненияЕдиныйПлатеж Тогда 
			КолКопеекНеСовпадения = стр.СуммаЕдиныйПлатеж - стр.СуммаСравненияЕдиныйПлатеж;
			СчетКтЕдиный =  РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж,ВидНалогообложения)).СчетБУ;
			МассивПромТаблица = ПромежуточнаяТаблица.НайтиСтроки(Новый Структура("СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетКт",стр.Субконто1,стр.Субконто2,стр.Субконто3,СчетКтЕдиный));
			Если МассивПромТаблица.Количество()>0 Тогда 
				МассивПромТаблица[0].Сумма = МассивПромТаблица[0].Сумма - КолКопеекНеСовпадения;
			КонецЕсли;
		КонецЕсли;
		
		
		
	КонецЦикла;
	
	
	//Пенсионный фонд (по работникам)
	
	//Аверсон ЕАЕ 20.06.2024 СВФР-012907
	//Климовичи
	Если ОрганизацияИНН = "700103211" Тогда
		ЕСНИсчисленныйТекст = 
		"ВЫБРАТЬ
		|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|   ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		//|   ЕСНИсчисленный.Сотрудник.СчетУчета КАК СчетУчета,
		|	СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд
		|ИЗ               
		|	РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	
		|ГДЕ
		|	ЕСНИсчисленный.Период >= &парамНачалоПериода И
		|	ЕСНИсчисленный.Период < &парамКонецПериода И
		|	ЕСНИсчисленный.ОбособленноеПодразделение = &парамОбособленноеПодразделение";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			ЕСНИсчисленныйТекст = ЕСНИсчисленныйТекст+"
			|	И ЕСНИсчисленный.ФизЛицо В (&ФизЛицо)";
		КонецЕсли;
		ЕСНИсчисленныйТекст = ЕСНИсчисленныйТекст+"	
		|	
		|СГРУППИРОВАТЬ ПО
		|   ЕСНИсчисленный.Сотрудник,
		//|   ЕСНИсчисленный.Сотрудник.СчетУчета,
		|	ЕСНИсчисленный.ФизЛицо";
	Иначе
		//Аверсон СВФР-012907
		
		ЕСНИсчисленныйТекст = 
		"ВЫБРАТЬ
		|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|	СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд
		|ИЗ               
		|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|	
		|ГДЕ
		|	ЕСНИсчисленный.Период >= &парамНачалоПериода И
		|	ЕСНИсчисленный.Период < &парамКонецПериода И
		|	ЕСНИсчисленный.ОбособленноеПодразделение = &парамОбособленноеПодразделение";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			ЕСНИсчисленныйТекст = ЕСНИсчисленныйТекст+"
			//|	И ЕСНИсчисленный.ФизЛицо В (&ФизЛицо)";
			|	И ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";
			//     берем подразделение по регистратору СВФР-015924
		КонецЕсли;
		ЕСНИсчисленныйТекст = ЕСНИсчисленныйТекст+"	
		|	
		|СГРУППИРОВАТЬ ПО
		|	ЕСНИсчисленный.ФизЛицо";
	КонецЕсли;
	
	Запрос = Новый Запрос(ЕСНИсчисленныйТекст);
	Запрос.УстановитьПараметр("ФизЛицо", СписокФизЛицОбщая);
	Запрос.УстановитьПараметр("парамНачалоПериода", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецПериода", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);// СВФР-015924
	
	СчетДебета = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда;
	
	СчетКредита = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд)).СчетБУ;
	СубконтоКредита = Перечисления.ВидыПлатежейВГосБюджет.Налог;
	ВыборкаПФ = Запрос.Выполнить().Выбрать();
	Пока ВыборкаПФ.Следующий() Цикл
		//О.Т. Аверсон 25.03.2016 № 950
		СотрПрошл = "";
		ОснНач = ОсновныеНачисления.НайтиСтроки(Новый структура("ФизЛицо",ВыборкаПФ.Физлицо));
		Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
		СписокСотрудников = Новый СписокЗначений;
		для Каждого стрОснНач из ОснНач Цикл 
			ПроверитьСотрудника = СписокСотрудников.НайтиПоЗначению(стрОснНач.Сотрудник);
			если ПроверитьСотрудника =  Неопределено Тогда
				если ОснНач <> СотрПрошл Тогда
					Сотрудник = стрОснНач.Сотрудник;
					СписокСотрудников.Добавить(Сотрудник); 
				КонецЕсли;
			КонецЕсли;
			СотрПрошл = стрОснНач.Сотрудник;
		КонецЦикла; 
		
		ОснНач = ДополнительныеНачисления.НайтиСтроки(Новый структура("ФизЛицо",ВыборкаПФ.Физлицо));
		
		для Каждого стрОснНач из ОснНач Цикл 
			ПроверитьСотрудника = СписокСотрудников.НайтиПоЗначению(стрОснНач.Сотрудник);
			если ПроверитьСотрудника =  Неопределено Тогда 
				если ОснНач <> СотрПрошл Тогда
					Сотрудник = стрОснНач.Сотрудник;
					СписокСотрудников.Добавить(Сотрудник); 
				КонецЕсли;
			КонецЕсли;
			СотрПрошл = стрОснНач.Сотрудник;
		КонецЦикла;
		ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
		Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
		иначе
			ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
		КонецЕсли;
		
		Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда  
			ЗапросСотр = Новый Запрос;
			ЗапросСотр.Текст = 
			"ВЫБРАТЬ
			|	РаботникиОрганизацийСрезПоследних.Сотрудник
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, Сотрудник.Физлицо = &ФизЛицо) КАК РаботникиОрганизацийСрезПоследних
			|ГДЕ
			|	НЕ РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций";
			
			ЗапросСотр.УстановитьПараметр("Период", КонецМесяца(ПериодРегистрации));
			ЗапросСотр.УстановитьПараметр("Физлицо", ВыборкаПФ.Физлицо);
			
			РезультатЗапросаСотр = ЗапросСотр.Выполнить().Выгрузить();
			Если РезультатЗапросаСотр.Количество()>1 Тогда 
				Сообщить("По физлицу "+Строка(ВыборкаПФ.Физлицо)+" присутствует несколько сотрудников. Проверьте правильность заполнение счета кредита!");
			КонецЕсли;  
			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
			Если РезультатЗапросаСотр.Количество()>0 Тогда
				Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
					ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
				иначе
					ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		СчетКредита = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
		Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения)).СчетБУ;
		//О.Т. Аверсон 25.03.2016 № 950
		
		//Аверсон ЕАЕ 19.06.2024 Климовичи
		Если ОрганизацияИНН = "700103211" Тогда
			Строка = ПромежуточнаяТаблица.Добавить();
			//Если ЗначениеЗаполнено(ВыборкаПФ.СчетУчета) Тогда
			//	Строка.СчетДт = ВыборкаПФ.СчетУчета;
			//Иначе
			ДанныеСчетДт = ПолучитьСчетДт(ВыборкаПФ.ФизЛицо, Неопределено, ВыборкаПФ.Сотрудник, Ложь);
			Строка.СчетДт = ДанныеСчетДт.СчетДт;
			Если ЗначениеЗаполнено(Строка.СчетДт) Тогда
				Если Лев(Строка.СчетДт.Код,2) = "26" ИЛИ Лев(Строка.СчетДт.Код,2) = "25" Тогда
					Строка.СубконтоДт1 = ДанныеСчетДт.СубконтоДт1;
					Строка.СубконтоДт2 = ДанныеСчетДт.СубконтоДт2;
				ИначеЕсли Лев(Строка.СчетДт.Код,2) = "70" Тогда
					Строка.СубконтоДт1 = ВыборкаПФ.Физлицо;
				КонецЕсли;
			Иначе
				Строка.СчетДт = СчетДебета;
				Строка.СубконтоДт1 	= ВыборкаПФ.Физлицо;
			КонецЕсли;
			//КонецЕсли;
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= СубконтоКредита;
			Строка.Сумма		= ВыборкаПФ.ПенсионныйФонд;
			Строка.ПризнакПроводки	= Перечисления.ПризнакПроводки.Удержание;
			Строка.ВидРасчета		= ПланыВидовРасчета.УдержанияОрганизаций.ПенсионныйФонд;
		Иначе	
			Строка = ПромежуточнаяТаблица.Добавить();
			Строка.СчетДт 		= СчетДебета;
			Строка.СубконтоДт1 	= ВыборкаПФ.Физлицо;
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= СубконтоКредита;
			Если ОрганизацияИНН = "806000046"  Тогда
				ДанныеСотрудника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("Сотрудник",Сотрудник));
				Подразделение = ДанныеСотрудника.ПодразделениеОрганизации; 
				Если Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.Совместитель Тогда
					Строка.СчетДт =  ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.04");        
				ИначеЕсли  ДанныеСотрудника.Должность.Категория = Справочники.КатегорииРаботников.НайтиПоНаименованию("Страховые агенты") Тогда
					Строка.СчетДт =  ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.02");   
				ИначеЕсли Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.ДоговорПодряда и ЗначениеЗаполнено(Сотрудник.КодIBS) Тогда
					Строка.СчетДт =  ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.03"); 
				ИначеЕсли Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.ДоговорПодряда Тогда
					Строка.СчетДт =  ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.05"); 
				Иначе
					Строка.СчетДт =  ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.01");   
				КонецЕсли;
				Строка.СубконтоКт2 = ПодразделениеОрганизации;
			КонецЕсли;
			Строка.Сумма		= ВыборкаПФ.ПенсионныйФонд;
			Строка.ПризнакПроводки	= Перечисления.ПризнакПроводки.Удержание;
			Строка.ВидРасчета		= ПланыВидовРасчета.УдержанияОрганизаций.ПенсионныйФонд;
		КонецЕсли;
	КонецЦикла;
	
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	Если ЭтоПодстановка97Счета Тогда
		
		СтрокиДляПодстановки = 
		ПромежуточнаяТаблица.НайтиСтроки( Новый Структура( "СчетДт, СчетКт",
		ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов, СчетКтБГС ) );
		
		СтрокиКУдалению = Новый Массив;	//+ СВЭЙ КДЯ 19.03.20 СВФР-005700
		
		Для каждого Стр Из СтрокиДляПодстановки Цикл
			
			//+ СВЭЙ КДЯ 19.03.20 СВФР-005700
			Если СтрокиКУдалению.Найти( Стр ) <> Неопределено Тогда
				Продолжить;	
			КонецЕсли; 
			//- СВЭЙ КДЯ 19.03.20 СВФР-005700
			
			СтрокиОтражениеВБУ = ОтражениеВБУ.НайтиСтроки( Новый Структура( 
			"ФизЛицо, СчетДт", Стр.ФизЛицо, Стр.СчетДт )  );
			
			//+ СВЭЙ КДЯ 19.03.20 СВФР-005700	 
			//Если СтрокиОтражениеВБУ.Количество() <> 1 Тогда
			//- СВЭЙ КДЯ 19.03.20 СВФР-005700
			
			//+ СВЭЙ КДЯ 19.03.20 СВФР-005700
			Если СтрокиОтражениеВБУ.Количество() < 1 Тогда
				//- СВЭЙ КДЯ 19.03.20 СВФР-005700
				Продолжить;
			КонецЕсли;
			
			//+ СВЭЙ КДЯ 19.03.20 СВФР-005700
			СтрокиДубли = ПромежуточнаяТаблица.НайтиСтроки( Новый Структура( "ФизЛицо, СчетДт, СчетКт",
			Стр.ФизЛицо, ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов, СчетКтБГС ) );
			Для каждого СтрокаДубль Из СтрокиДубли Цикл
				Если Стр = СтрокаДубль Тогда Продолжить; КонецЕсли;
				СтрокиКУдалению.Добавить( СтрокаДубль );
			КонецЦикла; 				
			//- СВЭЙ КДЯ 19.03.20 СВФР-005700
			Если  не Организация.УчетБГС97 Тогда
				СтрокаОтражениеВБУ = СтрокиОтражениеВБУ[0];	
				Стр.СчетДт = СтрокаОтражениеВБУ.СчетДт_ДляПодСтановки;
				Стр.СубконтоДт1 = СтрокаОтражениеВБУ.СубконтоДт1_ДляПодСтановки;
				Стр.СубконтоДт2 = СтрокаОтражениеВБУ.СубконтоДт2_ДляПодСтановки;
				Стр.СубконтоДт3 = СтрокаОтражениеВБУ.СубконтоДт3_ДляПодСтановки;
				Стр.СчетДтНУ = СтрокаОтражениеВБУ.СчетДтНУ_ДляПодСтановки;
				Стр.СубконтоДтНУ1 = СтрокаОтражениеВБУ.СубконтоДтНУ1_ДляПодСтановки;
				Стр.СубконтоДтНУ2 = СтрокаОтражениеВБУ.СубконтоДтНУ2_ДляПодСтановки;
				Стр.СубконтоДтНУ3 = СтрокаОтражениеВБУ.СубконтоДтНУ3_ДляПодСтановки;
			КонецЕсли;
		КонецЦикла;  // Стр Из ПромежуточнаяТаблица
		
		ОбщегоНазначения.УдалитьСтрокиИзТаблицы( ПромежуточнаяТаблица, СтрокиКУдалению ); //+ СВЭЙ КДЯ 19.03.20 СВФР-005700	
		
	КонецЕсли; // ЭтоПодстановка97Счета
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	
	//Аверсон 16.05.2022 КВВ СВФР-009035 (
	ТЗЗапросПоДогПод = Новый ТаблицаЗначений;
	Если РасчетДогПодрядаИзДопНач Тогда
		ЗапросПоДогПод = Новый Запрос;
		ЗапросПоДогПод.Текст = "
		|ВЫБРАТЬ 
		|ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ФизЛицо КАК ФизЛицо,
		|ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|СУММА(ДополнительныеНачисленияРаботниковОрганизаций.Результат) КАК Результат
		|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		|ПО ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
		|И (ДоговорНаВыполнениеРаботСФизЛицом.Организация = &ГоловнаяОрганизация)
		|И (&парамПериод МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)
		|И ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации = ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации
		|И ДоговорНаВыполнениеРаботСФизЛицом.Проведен //Аверсон 23.06.2022 КВВ СВФР-009220
		|ГДЕ
		|НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,МЕСЯЦ) = &парамПериод
		|И (ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяПолностью)
		|ИЛИ ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиЕП)
		|ИЛИ ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗН)
		|ИЛИ ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиСТРАХ))
		|И 
		|(
		|ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ТипРаботника = ЗНАЧЕНИЕ(Перечисление.ТипыРаботников.ДоговорПодряда)
		|ИЛИ 
		|(ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ТипРаботника <> ЗНАЧЕНИЕ(Перечисление.ТипыРаботников.ДоговорПодряда)
		|И (ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Подряда)
		|)))
		|
		|СГРУППИРОВАТЬ ПО
		|ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ФизЛицо,
		|ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации";
		ЗапросПоДогПод.УстановитьПараметр("ГоловнаяОрганизация", Организация);
		ЗапросПоДогПод.УстановитьПараметр("парамПериод", НачалоМесяца(ПериодРегистрации));
		ТЗЗапросПоДогПод = ЗапросПоДогПод.Выполнить().Выгрузить();
		
	КонецЕсли;
	//Аверсон 16.05.2022 КВВ СВФР-009035 )
	
	//Аверсон 29.08.2020 КВВ СВФР-006325 (
	ТЗПоДокРасчетЕСН = СуммыПоДокРасчетЕСН();
	ПромежуточнаяТаблицаКопияДляСравненияСРасчетЕСН = ПромежуточнаяТаблица.Скопировать();
	ПромежуточнаяТаблицаКопияДляСравненияСРасчетЕСН.Свернуть("ПризнакПроводки,ФизЛицо","Сумма"); 
	ПромежуточнаяТаблицаКопияДляСравненияСРасчетЕСН.Сортировать("ПризнакПроводки,ФизЛицо");
	Для Каждого СтрТЗПоДокРасчетЕСН Из ТЗПоДокРасчетЕСН Цикл
		ФсзнРасчетЕСН = СтрТЗПоДокРасчетЕСН.ФСЗН;
		БГСРасчетЕСН = СтрТЗПоДокРасчетЕСН.ОбязательноеСтрахование;
		
		СтрОтбора = Новый Структура;
		СтрОтбора.Вставить("ФизЛицо", СтрТЗПоДокРасчетЕСН.Физлицо);
		СтрОтбора.Вставить("ПризнакПроводки",Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты);
		РезПоиска = ПромежуточнаяТаблицаКопияДляСравненияСРасчетЕСН.НайтиСтроки(СтрОтбора);
		
		//Аверсон 16.05.2022 КВВ СВФР-009035 (
		НЕВведеныИзменения = Истина;
		Если ТЗЗапросПоДогПод.Количество() > 0 Тогда
			СтрОтбора0 = Новый Структура;
			СтрОтбора0.Вставить("ФизЛицо", СтрТЗПоДокРасчетЕСН.Физлицо);
			РезПоиска0 = ТЗЗапросПоДогПод.НайтиСтроки(СтрОтбора0);
			Если РезПоиска0.Количество() <> 0 Тогда
				
				РезПоискаПТ = ПромежуточнаяТаблица.НайтиСтроки(СтрОтбора);
				Если РезПоискаПТ.Количество() <> 0 Тогда 
					
					Для Каждого ЭлРезПоискаПТ ИЗ РезПоискаПТ Цикл
						СтрОтбора1 = Новый Структура;
						СтрОтбора1.Вставить("ФизЛицо", СтрТЗПоДокРасчетЕСН.Физлицо);
						СтрОтбора1.Вставить("ПодразделениеОрганизации",ЭлРезПоискаПТ.СубконтоДт1);
						РезПоиска1 = ТЗЗапросПоДогПод.НайтиСтроки(СтрОтбора1);
						Если РезПоиска1.Количество() <> 0 Тогда
							Для Каждого СтрРезПоиска1 ИЗ РезПоиска1 Цикл
								Если ЭлРезПоискаПТ.Сумма <> Окр((СтрРезПоиска1.Результат * СтавкаФСЗН)/100,2) Тогда
									//	Сообщить(СокрЛП(СтрТЗПоДокРасчетЕСН.Физлицо) + " скорректирована сумма ФСЗН с " + СокрЛП(ЭлРезПоискаПТ.Сумма) + " до " + СокрЛП(Окр((СтрРезПоиска1.Результат * СтавкаФСЗН)/100,2)));
									ЭлРезПоискаПТ.Сумма = Окр((СтрРезПоиска1.Результат * СтавкаФСЗН)/100,2);
									
									НЕВведеныИзменения = Ложь;
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;	
		Если НЕВведеныИзменения Тогда
			//Аверсон 16.05.2022 КВВ СВФР-009035 )
			
			РазницаФСЗН = ФсзнРасчетЕСН - ?(РезПоиска.Количество() > 0,РезПоиска[0].Сумма,0);
			Если РазницаФСЗН <> 0 Тогда
				РезПоискаПТ = ПромежуточнаяТаблица.НайтиСтроки(СтрОтбора);
				Если РезПоискаПТ.Количество() <> 0 Тогда  //Аверсон 14.09.2020 КВВ СВФР-006325
					РезПоискаПТ[0].Сумма = РезПоискаПТ[0].Сумма + РазницаФСЗН;
					//	Сообщить(СокрЛП(СтрТЗПоДокРасчетЕСН.Физлицо) + " скорректирована сумма ФСЗН на " + СокрЛП(РазницаФСЗН));
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		СтрОтбора = Новый Структура;
		СтрОтбора.Вставить("ФизЛицо", СтрТЗПоДокРасчетЕСН.Физлицо);
		СтрОтбора.Вставить("ПризнакПроводки",Перечисления.ПризнакПроводки.ОбязательноеСтрахование);
		РезПоиска = ПромежуточнаяТаблицаКопияДляСравненияСРасчетЕСН.НайтиСтроки(СтрОтбора);
		//Аверсон 16.05.2022 КВВ СВФР-009035 (
		НЕВведеныИзменения = Истина;
		Если ТЗЗапросПоДогПод.Количество() > 0 Тогда
			СтрОтбора0 = Новый Структура;
			СтрОтбора0.Вставить("ФизЛицо", СтрТЗПоДокРасчетЕСН.Физлицо);
			РезПоиска0 = ТЗЗапросПоДогПод.НайтиСтроки(СтрОтбора0);
			Если РезПоиска0.Количество() <> 0 Тогда
				
				РезПоискаПТ = ПромежуточнаяТаблица.НайтиСтроки(СтрОтбора);
				Если РезПоискаПТ.Количество() <> 0 Тогда 
					
					Для Каждого ЭлРезПоискаПТ ИЗ РезПоискаПТ Цикл
						СтрОтбора1 = Новый Структура;
						СтрОтбора1.Вставить("ФизЛицо", СтрТЗПоДокРасчетЕСН.Физлицо);
						СтрОтбора1.Вставить("ПодразделениеОрганизации",ЭлРезПоискаПТ.СубконтоДт1);
						РезПоиска1 = ТЗЗапросПоДогПод.НайтиСтроки(СтрОтбора1);
						Если РезПоиска1.Количество() <> 0 Тогда
							Для Каждого СтрРезПоиска1 ИЗ РезПоиска1 Цикл
								Если ЭлРезПоискаПТ.Сумма <> Окр((СтрРезПоиска1.Результат * СтавкаСтрах)/100,2) Тогда
									//	Сообщить(СокрЛП(СтрТЗПоДокРасчетЕСН.Физлицо) + " скорректирована сумма БГС с " + СокрЛП(ЭлРезПоискаПТ.Сумма) + " до " + СокрЛП(Окр((СтрРезПоиска1.Результат * СтавкаСтрах)/100,2)));
									ЭлРезПоискаПТ.Сумма = Окр((СтрРезПоиска1.Результат * СтавкаСтрах)/100,2);
									НЕВведеныИзменения = Ложь;
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;	
		Если НЕВведеныИзменения Тогда
			//Аверсон 16.05.2022 КВВ СВФР-009035 )
			
			РазницаБГС = БГСРасчетЕСН - ?(РезПоиска.Количество() > 0,РезПоиска[0].Сумма,0);
			Если РазницаБГС <> 0 Тогда
				РезПоискаПТ = ПромежуточнаяТаблица.НайтиСтроки(СтрОтбора);
				Если РезПоискаПТ.Количество() <> 0 Тогда   //Аверсон 14.09.2020 КВВ СВФР-006325
					РезПоискаПТ[0].Сумма = РезПоискаПТ[0].Сумма + РазницаБГС;
					//	Сообщить(СокрЛП(СтрТЗПоДокРасчетЕСН.Физлицо) + " скорректирована сумма БГС на " + СокрЛП(РазницаБГС));
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
	КонецЦикла;
	//Аверсон 29.08.2020 КВВ СВФР-006325 )
	
	//Аверсон 28.07.2020 КВВ СВФР-006325 ( 	
	ПромежуточнаяТаблицаКопия = ПромежуточнаяТаблица.Скопировать();
	ПромежуточнаяТаблицаКопия.Свернуть("ПризнакПроводки,ФизЛицо","Сумма"); 
	ПромежуточнаяТаблицаКопия.Сортировать("ПризнакПроводки,ФизЛицо");
	
	ПромежуточнаяТаблицаКопия2 = ПромежуточнаяТаблица.Скопировать();
	ПромежуточнаяТаблицаКопия2.Свернуть("ФизЛицо",); 
	ПромежуточнаяТаблицаКопия2.Сортировать("ФизЛицо");
	
	//Аверсон 26.08.2020 КВВ СВФР-006325 (	
	ТЗРасшФСЗНБГС = Новый ТаблицаЗначений;    
	
	ТЗРасшФСЗНБГС.Колонки.Добавить("ФизЛицо");
	ТЗРасшФСЗНБГС.Колонки.Добавить("ФСЗН");
	ТЗРасшФСЗНБГС.Колонки.Добавить("БГС");
	//Аверсон 26.08.2020 КВВ СВФР-006325 )
	
	ИтогФСЗН2= 0; ИтогБГС2 = 0;
	Для Каждого СтрТЗКопия2 ИЗ ПромежуточнаяТаблицаКопия2 Цикл
		Если НЕ ЗначениеЗаполнено(СтрТЗКопия2.Физлицо) Тогда
			Продолжить;
		КонецЕсли;
		//Аверсон 26.08.2020 КВВ СВФР-006325 (
		СтрТЗРасшФСЗНБГС = ТЗРасшФСЗНБГС.Добавить();
		СтрТЗРасшФСЗНБГС.ФизЛицо = СтрТЗКопия2.Физлицо;
		//Аверсон 26.08.2020 КВВ СВФР-006325 )
		ФСЗН2 = 0; БГС2 = 0;
		СтрОтбора = Новый Структура;
		СтрОтбора.Вставить("ФизЛицо", СтрТЗКопия2.Физлицо);
		РезКопия = ПромежуточнаяТаблицаКопия.НайтиСтроки(СтрОтбора);
		
		Для Каждого СтрТЗКопия ИЗ РезКопия Цикл
			Если Найти(Сокрлп(СтрТЗКопия.ПризнакПроводки),"Фонд социальной защиты") > 0 Тогда
				ФСЗН2 = СтрТЗКопия.Сумма;
			ИначеЕсли Найти(Сокрлп(СтрТЗКопия.ПризнакПроводки),"Обязательное страхование") > 0 Тогда
				БГС2 = СтрТЗКопия.Сумма;
			КонецЕсли;
		КонецЦикла;
		
		//Аверсон 26.08.2020 КВВ СВФР-006325 (
		СтрТЗРасшФСЗНБГС.ФСЗН = ФСЗН2;
		СтрТЗРасшФСЗНБГС.БГС = БГС2;
		//Аверсон 26.08.2020 КВВ СВФР-006325 )
	КонецЦикла;
	
	РасшифровкаСуммФСЗНиБГС.Загрузить(ТЗРасшФСЗНБГС); //Аверсон 26.08.2020 КВВ СВФР-006325
	
	//Аверсон 28.07.2020 КВВ СВФР-006325 )
	
	// вычеркнем обнулившиеся суммы
	// + СВЭЙ КДЯ 31.05.19 СВФР-004379
	ПромежуточнаяТаблица.Колонки.Удалить( "ФизЛицо" );
	ОчиститьСубконтоНУБезСчетов( ПромежуточнаяТаблица );
	// - СВЭЙ КДЯ 31.05.19 СВФР-004379
	
	ПромежуточнаяТаблица.Свернуть( "СчетДт,СчетКт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СубконтоКт1,СубконтоКт2,СубконтоКт3,СчетДтНУ,СчетКтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,СубконтоКтНУ1,СубконтоКтНУ2,СубконтоКтНУ3,ПризнакПроводки,ВидРасчета", "Сумма");
	
	//О.Т. 03.03.2015
	Для Каждого стрПромежуточнаяТаблица из ПромежуточнаяТаблица Цикл
		Если Лев(стрПромежуточнаяТаблица.СчетДт,2) = "96" и стрПромежуточнаяТаблица.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты и
			ЗначениеЗаполнено(СубконтоРезервФСЗН) Тогда
			стрПромежуточнаяТаблица.СубконтоДт1 = СубконтоРезервФСЗН; 
		ИначеЕсли Лев(стрПромежуточнаяТаблица.СчетДт,2) = "96" и стрПромежуточнаяТаблица.ПризнакПроводки = Перечисления.ПризнакПроводки.ОбязательноеСтрахование и
			ЗначениеЗаполнено(СубконтоРезервБГС) Тогда
			стрПромежуточнаяТаблица.СубконтоДт1 = СубконтоРезервБГС;
		КонецЕсли;
		//Аверсон ЕАЕ 16.06.2020 СВФР-006057
		//стрПромежуточнаяТаблица.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016(стрПромежуточнаяТаблица.Сумма,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
		стрПромежуточнаяТаблица.Сумма = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(стрПромежуточнаяТаблица.Сумма,,ТочностьРасчетов);//О.Т. Аверсон 17.03.2016 № 949
		//Аверсон
		Если ЗначениеЗаполнено(УчетнаяПолитикаПерсонал.СчетДтУчитываемый) и ЗначениеЗаполнено(УчетнаяПолитикаПерсонал.СчетДтНеУчитываемый) Тогда 
			Если стрПромежуточнаяТаблица.СчетДт = УчетнаяПолитикаПерсонал.СчетДтУчитываемый и (Лев(стрПромежуточнаяТаблица.СчетКт,2) = "69" или Лев(стрПромежуточнаяТаблица.СчетКт,2) = "76") Тогда  
				стрПромежуточнаяТаблица.СчетДт =  УчетнаяПолитикаПерсонал.СчетДтНеУчитываемый;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	//О.Т. 03.03.2015
	НулевыеСтроки = ПромежуточнаяТаблица.НайтиСтроки(Новый Структура("Сумма",0));
	Для каждого СтрокаТаблицы Из НулевыеСтроки Цикл
		ПромежуточнаяТаблица.Удалить(СтрокаТаблицы)
	КонецЦикла;
	
	//////////////////////////////////////////////////////////////////////////////////////////////////
	// отражение начислений
	
	// БУНачисления
	//	Поля:
	//		СчетДт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		СчетКт
	//		СубконтоКт1
	//		СубконтоКт2
	//		СубконтоКт3
	//		СчетДтНУ,
	//		Субконто255НК,
	//		Результат
	// Объединение:
	// 
	
	БУНачисленияТекст = 
	"ВЫБРАТЬ
	|	БУНачисления.СчетДт,
	|	ВЫБОР
	|		КОГДА БУНачисления.СчетДт = &Счет97
	|			ТОГДА &РБПНаОплатуТруда
	|		ИНАЧЕ БУНачисления.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА БУНачисления.СчетДт = &Счет97
	|			ТОГДА БУНачисления.Физлицо
	|		ИНАЧЕ БУНачисления.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА БУНачисления.СчетДт = &Счет97
	|			ТОГДА Неопределено 
	|		ИНАЧЕ БУНачисления.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|	БУНачисления.СчетКт,
	|	БУНачисления.СубконтоКт1,
	|	БУНачисления.СубконтоКт2,
	|	БУНачисления.СубконтоКт3,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3,
	|	БУНачисления.СчетКтНУ,
	|	БУНачисления.СубконтоКтНУ1,
	|	ВЫБОР
	|		КОГДА БУНачисления.СчетДт = &Счет97
	|			ТОГДА &ОтпускБудПериода
	|		ИНАЧЕ БУНачисления.СубконтоКтНУ2
	|	КОНЕЦ КАК СубконтоКтНУ2,
	|	БУНачисления.СубконтоКтНУ3,
	|	СУММА(БУНачисления.Результат) КАК Результат";
	если (ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета Тогда  //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
		БУНачисленияТекст = БУНачисленияТекст +",
		|	БУНачисления.ВидРасчета";
	КонецЕсли;
	
	БУНачисленияТекст = БУНачисленияТекст +"
	|ИЗ
	|	(ВЫБРАТЬ
	|		ВЫБОР
	|			КОГДА НЕ БУОсновныеНачисления.СчетДт В ИЕРАРХИИ (&СчетаИсключения)
	|					И БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|				ТОГДА &Счет97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДт
	|		КОНЕЦ КАК СчетДт,
	|		БУОсновныеНачисления.СубконтоДт1 КАК СубконтоДт1,
	|		БУОсновныеНачисления.СубконтоДт2 КАК СубконтоДт2,
	|		БУОсновныеНачисления.СубконтоДт3 КАК СубконтоДт3,
	|		БУОсновныеНачисления.СчетКт КАК СчетКт,
	|		БУОсновныеНачисления.СубконтоКт1 КАК СубконтоКт1,
	|		БУОсновныеНачисления.СубконтоКт2 КАК СубконтоКт2,
	|		БУОсновныеНачисления.СубконтоКт3 КАК СубконтоКт3,
	|		ВЫБОР
	|			КОГДА НЕ БУОсновныеНачисления.СчетКтНУ В ИЕРАРХИИ (&СчетаИсключения)
	|					И БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|				ТОГДА &СчетН97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДтНУ
	|		КОНЕЦ КАК СчетДтНУ,
	|		БУОсновныеНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1,
	|		БУОсновныеНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2,
	|		БУОсновныеНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3,
	|		БУОсновныеНачисления.СчетКтНУ КАК СчетКтНУ,
	|		БУОсновныеНачисления.СубконтоКтНУ1 КАК СубконтоКтНУ1,
	|		БУОсновныеНачисления.СубконтоКтНУ2 КАК СубконтоКтНУ2,
	|		БУОсновныеНачисления.СубконтоКтНУ3 КАК СубконтоКтНУ3,
	|		БУОсновныеНачисления.Сотрудник.Физлицо КАК Физлицо,
	|		БУОсновныеНачисления.Сотрудник КАК Сотрудник,
	|		БУОсновныеНачисления.Результат КАК Результат";
	если (ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета Тогда  //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
		БУНачисленияТекст = БУНачисленияТекст +",
		|		БУОсновныеНачисления.ВидРасчета КАК ВидРасчета";
	КонецЕсли;
	
	БУНачисленияТекст = БУНачисленияТекст +"
	|	ИЗ
	|		РегистрРасчета.БУОсновныеНачисления КАК БУОсновныеНачисления
	
	//Аверсон ЕАЕ 05.06.2025 СВФР-015924
	//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	//|				БУНачисленияСрез.Сотрудник.Физлицо КАК ФизЛицо,
	//|				БУНачисленияСрез.Сотрудник КАК Сотрудник,
	//|				РаботникиОрганизации.Должность КАК Должность,
	//|				ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) КАК ПодразделениеОрганизации
	//|			ИЗ
	//|				(ВЫБРАТЬ
	//|					МАКСИМУМ(РаботникиОрганизации.Период) КАК ПериодСреза,
	//|					БУНачисления.Сотрудник.Физлицо КАК ФизЛицо,
	//|					БУНачисления.Сотрудник КАК Сотрудник
	//|				ИЗ
	//|					РегистрРасчета.БУОсновныеНачисления КАК БУНачисления
	//|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	//|						ПО БУНачисления.ПериодДействияНачало >= РаботникиОрганизации.Период
	//|							И БУНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
	//|							И (РаботникиОрганизации.Организация = &ГоловнаяОрганизация)
	//|				ГДЕ
	//|					БУНачисления.ПериодРегистрации = &парамПериод
	//|					И БУНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение
	//|				
	//|				СГРУППИРОВАТЬ ПО
	//|					БУНачисления.Сотрудник.Физлицо,
	//|					БУНачисления.Сотрудник) КАК БУНачисленияСрез
	//|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	//|		ПО БУНачисленияСрез.ПериодСреза = РаботникиОрганизации.Период
	//|			И БУНачисленияСрез.Сотрудник = РаботникиОрганизации.Сотрудник
	//|			И (РаботникиОрганизации.Организация = &ГоловнаяОрганизация)
	//|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
	//|		ПО БУНачисленияСрез.Сотрудник = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
	//|			И (ДоговорНаВыполнениеРаботСФизЛицом.Организация = &ГоловнаяОрганизация)
	//|			И (&парамПериод МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)) КАК Должности
	//|			ПО БУОсновныеНачисления.Сотрудник = Должности.Сотрудник
	//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	//|			ПО  БУОсновныеНачисления.Сотрудник = ОсновныеНачисления.Сотрудник
	//|					И НАЧАЛОПЕРИОДА(БУОсновныеНачисления.ПериодРегистрации,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодРегистрации,МЕСЯЦ)
	//|					И БУОсновныеНачисления.ВидРасчета = ОсновныеНачисления.ВидРасчета
	//|					И (ОсновныеНачисления.Организация = &ГоловнаяОрганизация)
	//|					И БУОсновныеНачисления.Результат = ОсновныеНачисления.Результат
	//|                   И НАЧАЛОПЕРИОДА(БУОсновныеНачисления.ПериодДействияНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодДействияНачало,ДЕНЬ)
	//|                   И НАЧАЛОПЕРИОДА(БУОсновныеНачисления.ПериодДействияКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодДействияКонец,ДЕНЬ)
	
	|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|						ОсновныеНачисления.Сотрудник,
	|						ОсновныеНачисления.ПериодРегистрации,
	|						ОсновныеНачисления.ВидРасчета,
	//|						ОсновныеНачисления.Организация,
	|						ОсновныеНачисления.ПериодДействияНачало,
	|						ОсновныеНачисления.ПериодДействияКонец,
	|                       ОсновныеНачисления.ПодразделениеОрганизации,
	|						СУММА(ОсновныеНачисления.Результат) КАК Результат
	|					ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|					ГДЕ НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодРегистрации,МЕСЯЦ) = &парамПериод
	|                   	И ОсновныеНачисления.Организация = &ГоловнаяОрганизация
	|					СГРУППИРОВАТЬ ПО
	|						ОсновныеНачисления.Сотрудник,
	|						ОсновныеНачисления.ПериодРегистрации,
	|						ОсновныеНачисления.ВидРасчета,
	//|						ОсновныеНачисления.Организация,
	|                       ОсновныеНачисления.ПодразделениеОрганизации,
	|						ОсновныеНачисления.ПериодДействияНачало,
	|						ОсновныеНачисления.ПериодДействияКонец) КАК ОснНачисления
	|ПО БУОсновныеНачисления.Сотрудник = ОснНачисления.Сотрудник
	|	И НАЧАЛОПЕРИОДА(БУОсновныеНачисления.ПериодРегистрации,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ОснНачисления.ПериодРегистрации,МЕСЯЦ)
	|	И БУОсновныеНачисления.ВидРасчета = ОснНачисления.ВидРасчета
	|	И БУОсновныеНачисления.Результат = ОснНачисления.Результат
	|   И НАЧАЛОПЕРИОДА(БУОсновныеНачисления.ПериодДействияНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(ОснНачисления.ПериодДействияНачало,ДЕНЬ)
	|   И НАЧАЛОПЕРИОДА(БУОсновныеНачисления.ПериодДействияКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(ОснНачисления.ПериодДействияКонец,ДЕНЬ)
	
	//Аверсон СВФР-015924
	
	|	ГДЕ
	|		БУОсновныеНачисления.ПериодРегистрации = &парамПериод
	|		И БУОсновныеНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		БУНачисленияТекст = БУНачисленияТекст +"
		
		//Аверсон ЕАЕ 05.06.2025 СВФР-015924
		//|		И Должности.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
		|		И ОснНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
		//Аверсон СВФР-015924
		
	КонецЕсли;
	БУНачисленияТекст = БУНачисленияТекст +"
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		БУДополнительныеНачисления.СчетДт,
	|		БУДополнительныеНачисления.СубконтоДт1,
	|		БУДополнительныеНачисления.СубконтоДт2,
	|		БУДополнительныеНачисления.СубконтоДт3,
	|		БУДополнительныеНачисления.СчетКт,
	|		БУДополнительныеНачисления.СубконтоКт1,
	|		БУДополнительныеНачисления.СубконтоКт2,
	|		БУДополнительныеНачисления.СубконтоКт3,
	|		БУДополнительныеНачисления.СчетДтНУ,
	|		БУДополнительныеНачисления.СубконтоДтНУ1,
	|		БУДополнительныеНачисления.СубконтоДтНУ2,
	|		БУДополнительныеНачисления.СубконтоДтНУ3,
	|		БУДополнительныеНачисления.СчетКтНУ,
	|		БУДополнительныеНачисления.СубконтоКтНУ1,
	|		БУДополнительныеНачисления.СубконтоКтНУ2,
	|		БУДополнительныеНачисления.СубконтоКтНУ3,
	|		БУДополнительныеНачисления.Сотрудник.Физлицо,
	|		БУДополнительныеНачисления.Сотрудник,
	|		БУДополнительныеНачисления.Результат";
	если (ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета Тогда  //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
		БУНачисленияТекст = БУНачисленияТекст +",
		|		БУДополнительныеНачисления.ВидРасчета";
	КонецЕсли;
	
	БУНачисленияТекст = БУНачисленияТекст +"
	|	ИЗ
	|		РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		БУНачисленияТекст = БУНачисленияТекст +"
		
		//Аверсон ЕАЕ 05.06.2025 СВФР-015924
		//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|				БУНачисленияСрез.Сотрудник.Физлицо КАК ФизЛицо,
		//|				БУНачисленияСрез.Сотрудник КАК Сотрудник,
		//|				РаботникиОрганизации.Должность КАК Должность,
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931 3
		////|				ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) КАК ПодразделениеОрганизации
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|				МАКСИМУМ( ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) ) КАК ПодразделениеОрганизации,
		//|				КОЛИЧЕСТВО( РАЗЛИЧНЫЕ ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) ) КАК КоличествоПодразделений
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|			ИЗ
		//|				(ВЫБРАТЬ
		//|					МАКСИМУМ(РаботникиОрганизации.Период) КАК ПериодСреза,
		//|					БУНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		//|					БУНачисления.Сотрудник КАК Сотрудник
		//|				ИЗ
		//|					РегистрРасчета.БУДополнительныеНачисления КАК БУНачисления
		//|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
		//|						ПО БУНачисления.ПериодРегистрации >= НАЧАЛОПЕРИОДА(РаботникиОрганизации.Период, Месяц)
		//|							И БУНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
		//|							И (РаботникиОрганизации.Организация = &ГоловнаяОрганизация)
		//|				ГДЕ
		//|					БУНачисления.ПериодРегистрации = &парамПериод
		//|					И БУНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение
		//|				
		//|				СГРУППИРОВАТЬ ПО
		//|					БУНачисления.Сотрудник.Физлицо,
		//|					БУНачисления.Сотрудник) КАК БУНачисленияСрез
		//|
		//|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
		//|					ПО БУНачисленияСрез.ПериодСреза = РаботникиОрганизации.Период
		//|						И БУНачисленияСрез.Сотрудник = РаботникиОрганизации.Сотрудник
		//|						И (РаботникиОрганизации.Организация = &ГоловнаяОрганизация)
		//|
		//|				ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом		
		//|					ПО БУНачисленияСрез.Сотрудник = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
		//|						И (ДоговорНаВыполнениеРаботСФизЛицом.Организация = &ГоловнаяОрганизация)
		//|						И (&парамПериод МЕЖДУ НачалоПериода(ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,месяц) И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931 3
		//|                       И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
		//|				
		//|            СГРУППИРОВАТЬ ПО
		//|				БУНачисленияСрез.Сотрудник.Физлицо,
		//|				БУНачисленияСрез.Сотрудник,
		//|				РаботникиОрганизации.Должность
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|								) КАК Должности
		//|			ПО БУДополнительныеНачисления.Сотрудник = Должности.Сотрудник 
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931 3
		//
		//
		//|
		//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		//|				ПО  ISNULL( Должности.КоличествоПодразделений, 2 ) > 1
		//|					И БУДополнительныеНачисления.Сотрудник = ДополнительныеНачисления.Сотрудник
		//|					И БУДополнительныеНачисления.ПериодРегистрации = ДополнительныеНачисления.ПериодРегистрации
		//|					И БУДополнительныеНачисления.ВидРасчета = ДополнительныеНачисления.ВидРасчета
		//|					И (ДополнительныеНачисления.Организация = &ГоловнаяОрганизация)
		//|					И БУДополнительныеНачисления.Результат = ДополнительныеНачисления.Результат
		//|
		//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		//|				ПО  БУДополнительныеНачисления.Сотрудник = ДополнительныеНачисления.Сотрудник
		//|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ)
		//|					И БУДополнительныеНачисления.ВидРасчета = ДополнительныеНачисления.ВидРасчета
		//|					И (ДополнительныеНачисления.Организация = &ГоловнаяОрганизация)
		//|					И БУДополнительныеНачисления.Результат = ДополнительныеНачисления.Результат
		//|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ)
		//|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ)
		
		|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|						ДополнительныеНачисления.Сотрудник,
		
		//Аверсон ЕАЕ 24.11.2025 СВФР-017271
		//|						ДополнительныеНачисления.ПериодРегистрации,
		|						НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) КАК ПериодРегистрации,
		//Аверсон СВФР-017271
		
		|						ДополнительныеНачисления.ВидРасчета,
		//|						ДополнительныеНачисления.Организация,
		|						ДополнительныеНачисления.БазовыйПериодНачало,
		|						ДополнительныеНачисления.БазовыйПериодКонец,
		|                       ДополнительныеНачисления.ПодразделениеОрганизации,
		|						СУММА(ДополнительныеНачисления.Результат) КАК Результат
		|					ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		|					ГДЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = &парамПериод
		|                   	И ДополнительныеНачисления.Организация = &ГоловнаяОрганизация
		|					СГРУППИРОВАТЬ ПО
		|						ДополнительныеНачисления.Сотрудник,
		
		//Аверсон ЕАЕ 24.11.2025 СВФР-017271
		//|						ДополнительныеНачисления.ПериодРегистрации,
		|						НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ),
		//Аверсон СВФР-017271
		
		|						ДополнительныеНачисления.ВидРасчета,
		//|						ДополнительныеНачисления.Организация,
		|                       ДополнительныеНачисления.ПодразделениеОрганизации,
		|						ДополнительныеНачисления.БазовыйПериодНачало,
		|						ДополнительныеНачисления.БазовыйПериодКонец) КАК ДопНачисления
		|ПО БУДополнительныеНачисления.Сотрудник = ДопНачисления.Сотрудник
		|	И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ДопНачисления.ПериодРегистрации,МЕСЯЦ)
		|	И БУДополнительныеНачисления.ВидРасчета = ДопНачисления.ВидРасчета
		|	И БУДополнительныеНачисления.Результат = ДопНачисления.Результат
		|   И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДопНачисления.БазовыйПериодНачало,ДЕНЬ)
		|   И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДопНачисления.БазовыйПериодКонец,ДЕНЬ)
		
		//Аверсон СВФР-015924
		|				
		//- СВЭЙ КДЯ 16.10.19 СВФР-004931
		|";
	КонецЕсли;
	БУНачисленияТекст = БУНачисленияТекст +"
	|	ГДЕ
	|		БУДополнительныеНачисления.ПериодРегистрации = &парамПериод
	|		И БУДополнительныеНачисления.ВидРасчета.ВидПремии <> &парамВРезерв
	|		И БУДополнительныеНачисления.ВидРасчета.ВидПремии <> &парамИзРезерва
	|		И БУДополнительныеНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		БУНачисленияТекст = БУНачисленияТекст +"	
		//+ СВЭЙ КДЯ 16.10.19 СВФР-004931 3
		//|		И  Должности.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		
		//Аверсон ЕАЕ 05.06.2025 СВФР-015924
		//|		И  ( ISNULL( Должности.КоличествоПодразделений, 2 ) = 1 И Должности.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//|           ИЛИ ISNULL( Должности.КоличествоПодразделений, 2 ) > 1 
		//|				И ДополнительныеНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)  
		//|           )
		|		И  ДопНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//Аверсон СВФР-015924
		
		//- СВЭЙ КДЯ 16.10.19 СВФР-004931
		|";
	КонецЕсли;
	БУНачисленияТекст = БУНачисленияТекст +"
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		БУДополнительныеНачисления.СчетДт,
	|		БУДополнительныеНачисления.СубконтоДт1,
	|		БУДополнительныеНачисления.СубконтоДт2,
	|		БУДополнительныеНачисления.СубконтоДт3,
	|		&парамСчетРезерваБУ,
	|		&парамСубконтоРезерваБУ1,
	|		&парамСубконтоРезерваБУ2,
	|		&парамСубконтоРезерваБУ3,
	|		БУДополнительныеНачисления.СчетДтНУ,
	|		БУДополнительныеНачисления.СубконтоДтНУ1,
	|		БУДополнительныеНачисления.СубконтоДтНУ2,
	|		БУДополнительныеНачисления.СубконтоДтНУ3,
	|		&парамСчетРезерваНУ,
	|		&парамСубконтоРезерваНУ1,
	|		&парамСубконтоРезерваНУ2,
	|		&парамСубконтоРезерваНУ3,
	|		БУДополнительныеНачисления.Сотрудник.Физлицо,
	|		БУДополнительныеНачисления.Сотрудник,
	|		БУДополнительныеНачисления.Результат";
	если (ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета Тогда  //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
		БУНачисленияТекст = БУНачисленияТекст +",
		|		БУДополнительныеНачисления.ВидРасчета";
	КонецЕсли;
	
	БУНачисленияТекст = БУНачисленияТекст +"
	|	ИЗ
	|		РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		БУНачисленияТекст = БУНачисленияТекст +"
		
		//Аверсон ЕАЕ 05.06.2025 СВФР-015924
		//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|				БУНачисленияСрез.Сотрудник.Физлицо КАК ФизЛицо,
		//|				БУНачисленияСрез.Сотрудник КАК Сотрудник,
		//|				РаботникиОрганизации.Должность КАК Должность,
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931 2
		////|				ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) КАК ПодразделениеОрганизации
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|				МАКСИМУМ( ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) ) КАК ПодразделениеОрганизации,
		//|				КОЛИЧЕСТВО( РАЗЛИЧНЫЕ ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) ) КАК КоличествоПодразделений
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|			ИЗ
		//|				(ВЫБРАТЬ
		//|					МАКСИМУМ(РаботникиОрганизации.Период) КАК ПериодСреза,
		//|					БУНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		//|					БУНачисления.Сотрудник КАК Сотрудник
		//|				ИЗ
		//|					РегистрРасчета.БУДополнительныеНачисления КАК БУНачисления
		//|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
		//|						ПО БУНачисления.ПериодРегистрации >= НАЧАЛОПЕРИОДА(РаботникиОрганизации.Период, Месяц)
		//|							И БУНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
		//|							И (РаботникиОрганизации.Организация = &ГоловнаяОрганизация)
		//|				ГДЕ
		//|					БУНачисления.ПериодРегистрации = &парамПериод
		//|					И БУНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение
		//|				
		//|				СГРУППИРОВАТЬ ПО
		//|					БУНачисления.Сотрудник.Физлицо,
		//|					БУНачисления.Сотрудник) КАК БУНачисленияСрез
		//|
		//|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
		//|					ПО БУНачисленияСрез.ПериодСреза = РаботникиОрганизации.Период
		//|						И БУНачисленияСрез.Сотрудник = РаботникиОрганизации.Сотрудник
		//|						И (РаботникиОрганизации.Организация = &ГоловнаяОрганизация)
		//|
		//|				ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		//|					ПО БУНачисленияСрез.Сотрудник = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
		//|						И (ДоговорНаВыполнениеРаботСФизЛицом.Организация = &ГоловнаяОрганизация)
		//|						И (&парамПериод МЕЖДУ Началопериода(ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,месяц) И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931 2
		//|                       И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
		//|				
		//|            СГРУППИРОВАТЬ ПО
		//|				БУНачисленияСрез.Сотрудник.Физлицо,
		//|				БУНачисленияСрез.Сотрудник,
		//|				РаботникиОрганизации.Должность
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|							) КАК Должности
		//|			ПО БУДополнительныеНачисления.Сотрудник = Должности.Сотрудник
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931 2
		//|
		//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		//|				ПО  ISNULL( Должности.КоличествоПодразделений, 2 ) > 1
		//|					И БУДополнительныеНачисления.Сотрудник = ДополнительныеНачисления.Сотрудник
		//|					И БУДополнительныеНачисления.ПериодРегистрации = ДополнительныеНачисления.ПериодРегистрации
		//|					И БУДополнительныеНачисления.ВидРасчета = ДополнительныеНачисления.ВидРасчета
		//|					И (ДополнительныеНачисления.Организация = &ГоловнаяОрганизация)
		//|					И БУДополнительныеНачисления.Результат = ДополнительныеНачисления.Результат
		//|
		//|				
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		
		//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		//|				ПО  БУДополнительныеНачисления.Сотрудник = ДополнительныеНачисления.Сотрудник
		//|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ)
		//|					И БУДополнительныеНачисления.ВидРасчета = ДополнительныеНачисления.ВидРасчета
		//|					И (ДополнительныеНачисления.Организация = &ГоловнаяОрганизация)
		//|					И БУДополнительныеНачисления.Результат = ДополнительныеНачисления.Результат
		//|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ)
		//|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ)
		
		|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|						ДополнительныеНачисления.Сотрудник,
		
		//Аверсон ЕАЕ 24.11.2025 СВФР-017271
		//|						ДополнительныеНачисления.ПериодРегистрации,
		|						НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) КАК ПериодРегистрации,
		//Аверсон СВФР-017271
		
		|						ДополнительныеНачисления.ВидРасчета,
		//|						ДополнительныеНачисления.Организация,
		|						ДополнительныеНачисления.БазовыйПериодНачало,
		|						ДополнительныеНачисления.БазовыйПериодКонец,
		|                       ДополнительныеНачисления.ПодразделениеОрганизации,
		|						СУММА(ДополнительныеНачисления.Результат) КАК Результат
		|					ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		|					ГДЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = &парамПериод
		|                   	И ДополнительныеНачисления.Организация = &ГоловнаяОрганизация
		|					СГРУППИРОВАТЬ ПО
		|						ДополнительныеНачисления.Сотрудник,
		
		//Аверсон ЕАЕ 24.11.2025 СВФР-017271
		//|						ДополнительныеНачисления.ПериодРегистрации,
		|						НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ),
		//Аверсон СВФР-017271
		
		|						ДополнительныеНачисления.ВидРасчета,
		//|						ДополнительныеНачисления.Организация,
		|                       ДополнительныеНачисления.ПодразделениеОрганизации,
		|						ДополнительныеНачисления.БазовыйПериодНачало,
		|						ДополнительныеНачисления.БазовыйПериодКонец) КАК ДопНачисления
		|ПО БУДополнительныеНачисления.Сотрудник = ДопНачисления.Сотрудник
		|	И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ДопНачисления.ПериодРегистрации,МЕСЯЦ)
		|	И БУДополнительныеНачисления.ВидРасчета = ДопНачисления.ВидРасчета
		|	И БУДополнительныеНачисления.Результат = ДопНачисления.Результат
		|   И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДопНачисления.БазовыйПериодНачало,ДЕНЬ)
		|   И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДопНачисления.БазовыйПериодКонец,ДЕНЬ)
		
		//Аверсон ЕАЕ 05.06.2025 СВФР-015924
		|";
	КонецЕсли;
	БУНачисленияТекст = БУНачисленияТекст +"
	
	|	ГДЕ
	|		БУДополнительныеНачисления.ПериодРегистрации = &парамПериод
	|		И БУДополнительныеНачисления.ВидРасчета.ВидПремии = &парамВРезерв
	|		И БУДополнительныеНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		БУНачисленияТекст = БУНачисленияТекст +"	
		//+ СВЭЙ КДЯ 16.10.19 СВФР-004931 2
		//|		И  Должности.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		
		//Аверсон ЕАЕ 05.06.2025 СВФР-015924
		//|		И  ( ISNULL( Должности.КоличествоПодразделений, 2 ) = 1 И Должности.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//|           ИЛИ ISNULL( Должности.КоличествоПодразделений, 2 ) > 1 
		//|				И ДополнительныеНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)  
		//|           )
		|		И  ДопНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//Аверсон СВФР-015924
		
		//- СВЭЙ КДЯ 16.10.19 СВФР-004931
		|";
	КонецЕсли;
	БУНачисленияТекст = БУНачисленияТекст +"
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		&парамСчетРезерваБУ,
	|		&парамСубконтоРезерваБУ1,
	|		&парамСубконтоРезерваБУ2,
	|		&парамСубконтоРезерваБУ3,
	|		БУДополнительныеНачисления.СчетКт,
	|		БУДополнительныеНачисления.СубконтоКт1,
	|		БУДополнительныеНачисления.СубконтоКт2,
	|		БУДополнительныеНачисления.СубконтоКт3,
	|		&парамСчетРезерваНУ,
	|		&парамСубконтоРезерваНУ1,
	|		&парамСубконтоРезерваНУ2,
	|		&парамСубконтоРезерваНУ3,
	|		БУДополнительныеНачисления.СчетКтНУ,
	|		БУДополнительныеНачисления.СубконтоКтНУ1,
	|		БУДополнительныеНачисления.СубконтоКтНУ2,
	|		БУДополнительныеНачисления.СубконтоКтНУ3,
	|		БУДополнительныеНачисления.Сотрудник.Физлицо,
	|		БУДополнительныеНачисления.Сотрудник,
	|		БУДополнительныеНачисления.Результат";
	если (ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета Тогда  //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
		БУНачисленияТекст = БУНачисленияТекст +",
		|		БУДополнительныеНачисления.ВидРасчета";
	КонецЕсли;
	
	БУНачисленияТекст = БУНачисленияТекст +"
	|	ИЗ
	|		РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		БУНачисленияТекст = БУНачисленияТекст +"
		
		//Аверсон ЕАЕ 05.06.2025 СВФР-015924
		//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|				БУНачисленияСрез.Сотрудник.Физлицо КАК ФизЛицо,
		//|				БУНачисленияСрез.Сотрудник КАК Сотрудник,
		//|				РаботникиОрганизации.Должность КАК Должность,
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		////|				ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) КАК ПодразделениеОрганизации
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|				МАКСИМУМ( ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) ) КАК ПодразделениеОрганизации,
		//|				КОЛИЧЕСТВО( РАЗЛИЧНЫЕ ЕСТЬNULL(РаботникиОрганизации.ПодразделениеОрганизации, ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации) ) КАК КоличествоПодразделений
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|			ИЗ
		//|				(ВЫБРАТЬ
		//|					МАКСИМУМ(РаботникиОрганизации.Период) КАК ПериодСреза,
		//|					БУНачисления.Сотрудник.Физлицо КАК ФизЛицо,
		//|					БУНачисления.Сотрудник КАК Сотрудник
		//|				ИЗ
		//|					РегистрРасчета.БУДополнительныеНачисления КАК БУНачисления
		//|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
		//|						ПО БУНачисления.ПериодРегистрации >= НАЧАЛОПЕРИОДА(РаботникиОрганизации.Период, Месяц)
		//|							И БУНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
		//|							И (РаботникиОрганизации.Организация = &ГоловнаяОрганизация)
		//|				ГДЕ
		//|					БУНачисления.ПериодРегистрации = &парамПериод
		//|					И БУНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение
		//|				
		//|				СГРУППИРОВАТЬ ПО
		//|					БУНачисления.Сотрудник.Физлицо,
		//|					БУНачисления.Сотрудник) КАК БУНачисленияСрез
		//|
		//|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
		//|					ПО БУНачисленияСрез.ПериодСреза = РаботникиОрганизации.Период
		//|						И БУНачисленияСрез.Сотрудник = РаботникиОрганизации.Сотрудник
		//|						И (РаботникиОрганизации.Организация = &ГоловнаяОрганизация)
		//|
		//|				ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		//|					ПО БУНачисленияСрез.Сотрудник = ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
		//|						И (ДоговорНаВыполнениеРаботСФизЛицом.Организация = &ГоловнаяОрганизация)
		//|						И (&парамПериод МЕЖДУ НачалоПериода(ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,месяц) И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|                       И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
		//|				
		//|            СГРУППИРОВАТЬ ПО
		//|				БУНачисленияСрез.Сотрудник.Физлицо,
		//|				БУНачисленияСрез.Сотрудник,
		//|				РаботникиОрганизации.Должность
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|
		//|			) КАК Должности
		//|			ПО БУДополнительныеНачисления.Сотрудник = Должности.Сотрудник
		////+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		//
		//
		//|
		//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		//|				ПО  ISNULL( Должности.КоличествоПодразделений, 2 ) > 1
		//|					И БУДополнительныеНачисления.Сотрудник = ДополнительныеНачисления.Сотрудник
		//|					И БУДополнительныеНачисления.ПериодРегистрации = ДополнительныеНачисления.ПериодРегистрации
		//|					И БУДополнительныеНачисления.ВидРасчета = ДополнительныеНачисления.ВидРасчета
		//|					И (ДополнительныеНачисления.Организация = &ГоловнаяОрганизация)
		//|					И БУДополнительныеНачисления.Результат = ДополнительныеНачисления.Результат
		//|
		//|				
		////- СВЭЙ КДЯ 16.10.19 СВФР-004931
		
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		|				ПО  БУДополнительныеНачисления.Сотрудник = ДополнительныеНачисления.Сотрудник
		|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ)
		|					И БУДополнительныеНачисления.ВидРасчета = ДополнительныеНачисления.ВидРасчета
		|					И (ДополнительныеНачисления.Организация = &ГоловнаяОрганизация)
		|					И БУДополнительныеНачисления.Результат = ДополнительныеНачисления.Результат
		|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ)
		|					И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ)
		
		|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|						ДополнительныеНачисления.Сотрудник,
		
		//Аверсон ЕАЕ 24.11.2025 СВФР-017271
		//|						ДополнительныеНачисления.ПериодРегистрации,
		|						НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) КАК ПериодРегистрации,
		//Аверсон СВФР-017271
		
		|						ДополнительныеНачисления.ВидРасчета,
		//|						ДополнительныеНачисления.Организация,
		|						ДополнительныеНачисления.БазовыйПериодНачало,
		|						ДополнительныеНачисления.БазовыйПериодКонец,
		|                       ДополнительныеНачисления.ПодразделениеОрганизации,
		|						СУММА(ДополнительныеНачисления.Результат) КАК Результат
		|					ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
		|					ГДЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = &парамПериод
		|                   	И ДополнительныеНачисления.Организация = &ГоловнаяОрганизация
		|					СГРУППИРОВАТЬ ПО
		|						ДополнительныеНачисления.Сотрудник,
		
		//Аверсон ЕАЕ 24.11.2025 СВФР-017271
		//|						ДополнительныеНачисления.ПериодРегистрации,
		|						НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ),
		//Аверсон СВФР-017271
		
		|						ДополнительныеНачисления.ВидРасчета,
		//|						ДополнительныеНачисления.Организация,
		|                       ДополнительныеНачисления.ПодразделениеОрганизации,
		|						ДополнительныеНачисления.БазовыйПериодНачало,
		|						ДополнительныеНачисления.БазовыйПериодКонец) КАК ДопНачисления
		|ПО БУДополнительныеНачисления.Сотрудник = ДопНачисления.Сотрудник
		|	И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.ПериодРегистрации,МЕСЯЦ) = НАЧАЛОПЕРИОДА(ДопНачисления.ПериодРегистрации,МЕСЯЦ)
		|	И БУДополнительныеНачисления.ВидРасчета = ДопНачисления.ВидРасчета
		|	И БУДополнительныеНачисления.Результат = ДопНачисления.Результат
		|   И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодНачало,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДопНачисления.БазовыйПериодНачало,ДЕНЬ)
		|   И НАЧАЛОПЕРИОДА(БУДополнительныеНачисления.БазовыйПериодКонец,ДЕНЬ) = НАЧАЛОПЕРИОДА(ДопНачисления.БазовыйПериодКонец,ДЕНЬ)
		
		//Аверсон СВФР-015924
		
		|";
	КонецЕсли;
	БУНачисленияТекст = БУНачисленияТекст +"
	|	ГДЕ
	|		БУДополнительныеНачисления.ПериодРегистрации = &парамПериод
	|		И БУДополнительныеНачисления.ВидРасчета.ВидПремии = &парамИзРезерва
	|		И БУДополнительныеНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		БУНачисленияТекст = БУНачисленияТекст +"
		//+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		//|		И  Должности.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//- СВЭЙ КДЯ 16.10.19 СВФР-004931
		//+ СВЭЙ КДЯ 16.10.19 СВФР-004931
		
		//Аверсон ЕАЕ 05.06.2025 СВФР-015924
		//|		И  ( ISNULL( Должности.КоличествоПодразделений, 2 ) = 1 И Должности.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//|           ИЛИ ISNULL( Должности.КоличествоПодразделений, 2 ) > 1 
		//|				И ДополнительныеНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)  
		//|           )
		|		И  ДопНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)
		//Аверсон СВФР-015924
		
		//- СВЭЙ КДЯ 16.10.19 СВФР-004931
		|          
		|";
	КонецЕсли;
	БУНачисленияТекст = БУНачисленияТекст +") КАК БУНачисления
	|
	|СГРУППИРОВАТЬ ПО
	|	БУНачисления.СчетДт,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СчетКт,
	|	БУНачисления.СубконтоКт1,
	|	БУНачисления.СубконтоКт2,
	|	БУНачисления.СубконтоКт3,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3,
	|	БУНачисления.Сотрудник.Физлицо,
	|	БУНачисления.Сотрудник,
	|	БУНачисления.СубконтоКтНУ1,
	|	БУНачисления.СубконтоКтНУ3,
	|	БУНачисления.СчетКтНУ,";
	если (ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета Тогда  //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
		БУНачисленияТекст = БУНачисленияТекст +"
		|	БУНачисления.ВидРасчета,";
	КонецЕсли;
	
	БУНачисленияТекст = БУНачисленияТекст +"
	|	ВЫБОР
	|		КОГДА БУНачисления.СчетДт = &Счет97
	|			ТОГДА БУНачисления.Физлицо
	|		ИНАЧЕ БУНачисления.СубконтоДт2
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА БУНачисления.СчетДт = &Счет97
	|			ТОГДА &ОтпускБудПериода
	|		ИНАЧЕ БУНачисления.СубконтоКтНУ2
	|	КОНЕЦ";
	
	Запрос = Новый Запрос(БУНачисленияТекст);
	
	
	СчетаИсключения = Новый Массив();
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоСоциальномуСтрахованию);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.НематериальныеАктивы);
	//СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы); //Островская Татьяна 06.05.2014 № 17335
	//СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РезервыПредстоящихРасходов);
	
	УчетнаяПолитика = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация", Ссылка.Организация));
	Если УчетнаяПолитика = Неопределено тогда
		Сообщить("Не определена учетная политика по персоналу");
		Возврат;
	КонецЕсли;
	
	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
	Запрос.УстановитьПараметр("парамСчетРезерваБУ", УчетнаяПолитика.СчетУчетаРезерваБУ);
	Запрос.УстановитьПараметр("парамСубконтоРезерваБУ1", УчетнаяПолитика.СубконтоРезерваБУ1);
	Запрос.УстановитьПараметр("парамСубконтоРезерваБУ2", УчетнаяПолитика.СубконтоРезерваБУ2);
	Запрос.УстановитьПараметр("парамСубконтоРезерваБУ3", УчетнаяПолитика.СубконтоРезерваБУ3);
	Запрос.УстановитьПараметр("парамСчетРезерваНУ", УчетнаяПолитика.СчетУчетаРезерваНУ);
	Запрос.УстановитьПараметр("парамСубконтоРезерваНУ1", УчетнаяПолитика.СубконтоРезерваНУ1);
	Запрос.УстановитьПараметр("парамСубконтоРезерваНУ2", УчетнаяПолитика.СубконтоРезерваНУ2);
	Запрос.УстановитьПараметр("парамСубконтоРезерваНУ3", УчетнаяПолитика.СубконтоРезерваНУ3);
	
	
	Запрос.УстановитьПараметр("парамВРезерв", Перечисления.ВидыПремии.ПремияВРезерв);
	Запрос.УстановитьПараметр("парамИзРезерва", Перечисления.ВидыПремии.ПремияИзРезерва);
	Запрос.УстановитьПараметр("парамПериод", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("ГоловнаяОрганизация", ОбщегоНазначения.ГоловнаяОрганизация(Организация));
	Запрос.УстановитьПараметр("СчетаИсключения", СчетаИсключения);
	Запрос.УстановитьПараметр("парамПустойСчетНУ", ПланыСчетов.Налоговый.ПустаяСсылка());
	Запрос.УстановитьПараметр("Счет97", ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов);
	Запрос.УстановитьПараметр("СчетН97", ПланыСчетов.Налоговый.РасходыНаОплатуТрудаБудущихПериодов);
	Запрос.УстановитьПараметр("СчетН70", ПланыСчетов.Налоговый.РасчетыСПерсоналомПоОплатеТруда);
	Запрос.УстановитьПараметр("РБПНаОплатуТруда", Справочники.РасходыБудущихПериодов.РБПНаОплатуТруда);
	Запрос.УстановитьПараметр("ОтпускБудПериода", Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ОплатаОтпускаБуд);
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		
		Строка = ОтражениеВУчете.Добавить();
		Строка.СчетДт 			= Выборка.СчетДт;
		Если ОрганизацияИНН = "806000046" и СокрЛП(Выборка.СчетДт) = "77.11"  Тогда
			Строка.СчетДт 	= ПланыСчетов.Хозрасчетный.НайтиПоКоду("77.10"); 
		КонецЕсли;
		Если СокрЛП(Выборка.СчетДт) = "90.10" и Выборка.СчетКт =ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
			Строка.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный;
		КонецЕсли;   
		
		Строка.СубконтоДт1 		= Выборка.СубконтоДт1;
		Строка.СубконтоДт2 		= Выборка.СубконтоДт2;
		Строка.СубконтоДт3	 	= Выборка.СубконтоДт3;
		Строка.СчетКт 			= Выборка.СчетКт;
		Строка.СубконтоКт1 		= Выборка.СубконтоКт1;
		Строка.СубконтоКт2 		= Выборка.СубконтоКт2;
		Строка.СубконтоКт3	 	= Выборка.СубконтоКт3;
		Строка.СчетДтНУ			= Выборка.СчетДтНУ;
		Строка.СубконтоДтНУ1 	= Выборка.СубконтоДтНУ1;
		Строка.СубконтоДтНУ2 	= Выборка.СубконтоДтНУ2;
		Строка.СубконтоДтНУ3 	= Выборка.СубконтоДтНУ3;		
		Строка.СчетКтНУ			= Выборка.СчетКтНУ;
		Строка.СубконтоКтНУ1 	= Выборка.СубконтоКтНУ1;
		Строка.СубконтоКтНУ2 	= Выборка.СубконтоКтНУ2;
		Строка.СубконтоКтНУ3 	= Выборка.СубконтоКтНУ3;		
		Строка.Сумма			= Выборка.Результат;
		Строка.ПризнакПроводки	= Перечисления.ПризнакПроводки.Начисление;
		если (ОрганизацияИНН = "191307958" ИЛИ ОрганизацияИНН = "701485041" ИЛИ ОрганизацияИНН = "401166406" ИЛИ ОрганизацияИНН = "191124885") или ОтражениеПоВидамРасчета Тогда  //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
			Строка.ВидРасчета 		= Выборка.ВидРасчета;
		КонецЕсли;
	КонецЦикла;
	
	// отражение начислений
	//////////////////////////////////////////////////////////////////////////////////////////////////
	
	//////////////////////////////////////////////////////////////////////////////////////////////////
	// начало отражения удержаний
	// 
	
	// БазаСреднегоЗаработка
	//	Поля:
	//		Регистратор
	//		НомерСтроки
	//		СчетДтРазрез
	//		СчетКтРазрез
	//		СубконтоДт1Разрез
	//		СубконтоДт2Разрез
	//		СубконтоДт3Разрез
	//		СубконтоКт1Разрез
	//		СубконтоКт2Разрез
	//		СубконтоКт3Разрез
	//		РезультатБаза
	//
	
	БазаСреднегоЗаработкаТекст = 
	"ВЫБРАТЬ
	|	УдержанияРаботниковОрганизации.Регистратор КАК Регистратор,
	|	УдержанияРаботниковОрганизации.НомерСтроки КАК НомерСтроки,
	|	БазаСреднегоЗаработка.СчетДтРазрез КАК СчетДтРазрез,
	|	БазаСреднегоЗаработка.СчетКтРазрез КАК СчетКтРазрез,
	|	БазаСреднегоЗаработка.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
	|	БазаСреднегоЗаработка.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
	|	БазаСреднегоЗаработка.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
	|	БазаСреднегоЗаработка.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
	|	БазаСреднегоЗаработка.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
	|	БазаСреднегоЗаработка.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
	|	БазаСреднегоЗаработка.СчетДтНУРазрез КАК СчетДтНУРазрез,
	|	БазаСреднегоЗаработка.СчетКтНУРазрез КАК СчетКтНУРазрез,
	|	БазаСреднегоЗаработка.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
	|	БазаСреднегоЗаработка.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
	|	БазаСреднегоЗаработка.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
	|	БазаСреднегоЗаработка.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
	|	БазаСреднегоЗаработка.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
	|	БазаСреднегоЗаработка.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
	|	БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации КАК РезультатБаза
	|ИЗ
	|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.РасчетСреднегоЗаработка.БазаБУОсновныеНачисления(&парамИзмерения, &парамИзмерения, &парамРазрезыБУ, Организация = &парамОрганизация И ПериодРегистрации = &парамПериодРегистрации) КАК БазаСреднегоЗаработка
	|		ПО БазаСреднегоЗаработка.Сотрудник = УдержанияРаботниковОрганизации.Сотрудник
	|
	|ГДЕ
	|	УдержанияРаботниковОрганизации.Организация = &парамОрганизация И
	|	УдержанияРаботниковОрганизации.ПериодРегистрации = &парамПериодРегистрации И
	|	УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В(&парамПоСреднемуЗаработку)";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		БазаСреднегоЗаработкаТекст = БазаСреднегоЗаработкаТекст +"	
		|		И УдержанияРаботниковОрганизации.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
	КонецЕсли;
	
	
	
	// СведенияОбУдержанияхСрез
	//	Поля:
	//		ФизЛицо
	//		ВидРасчета
	//		Период
	// Описание:
	// вспомогательная таблица для дполучения среза последних значений в регистре УдержанияРаботниковОрганизации
	//
	
	СведенияОбУдержанияхСрезТекст = 
	"ВЫБРАТЬ
	|	УдержанияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
	//|	УдержанияРаботниковОрганизации.Сотрудник КАК Сотрудник,
	|	УдержанияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
	|	МАКСИМУМ(ПлановыеУдержанияРаботниковОрганизаций.Период) КАК Период
	|ИЗ
	|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК ПлановыеУдержанияРаботниковОрганизаций
	|		ПО УдержанияРаботниковОрганизации.ФизЛицо = ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо И УдержанияРаботниковОрганизации.ВидРасчета = ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета
	|
	|ГДЕ
	|	УдержанияРаботниковОрганизации.Организация = &парамОрганизация И
	|	УдержанияРаботниковОрганизации.ПериодРегистрации = &парамПериодРегистрации ";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		СведенияОбУдержанияхСрезТекст = СведенияОбУдержанияхСрезТекст +"	
		|		И УдержанияРаботниковОрганизации.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
	КонецЕсли;
	СведенияОбУдержанияхСрезТекст = СведенияОбУдержанияхСрезТекст +"
	|
	|СГРУППИРОВАТЬ ПО
	|	УдержанияРаботниковОрганизации.ФизЛицо,
	//|	УдержанияРаботниковОрганизации.Сотрудник,
	|	УдержанияРаботниковОрганизации.ВидРасчета";
	
	
	// ДанныеУчета
	//	Поля:
	//		Регистратор
	//		НомерСтроки
	//		ФизЛицо
	//		ДокументОснование
	//		СчетДт
	//		СчетКт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		СубконтоКт1
	//		СубконтоКт2
	//		СубконтоКт3
	//		ВидРасчета
	//		Результат
	// Описание:
	// таблица строится по регистру расчета удержаний с присоединением данных о бухучете
	//
	ДанныеУчетаТекст = 
	"ВЫБРАТЬ
	|	УдержанияРаботниковОрганизации.Регистратор КАК Регистратор,
	|	УдержанияРаботниковОрганизации.НомерСтроки КАК НомерСтроки,
	|	УдержанияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
	//|	УдержанияРаботниковОрганизации.Сотрудник КАК Сотрудник,
	|	УдержанияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СчетДт КОНЕЦ КАК СчетДт,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СчетКт КОНЕЦ КАК СчетКт,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1 КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2 КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3 КОНЕЦ КАК СубконтоДт3,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт1 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт1 КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт2 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт2 КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт3 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт3 КОНЕЦ КАК СубконтоКт3,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ КОНЕЦ КАК СчетДтНУ,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКтНУ КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СчетКтНУ КОНЕЦ КАК СчетКтНУ,	
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1 КОНЕЦ КАК СубконтоДтНУ1,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2 КОНЕЦ КАК СубконтоДтНУ2,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3 КОНЕЦ КАК СубконтоДтНУ3,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ1 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ1 КОНЕЦ КАК СубконтоКтНУ1,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ2 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ2 КОНЕЦ КАК СубконтоКтНУ2,
	|	ВЫБОР КОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ3 КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ3 КОНЕЦ КАК СубконтоКтНУ3,	
	|	УдержанияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
	|	УдержанияРаботниковОрганизации.Результат КАК Результат
	|ИЗ
	|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК ПлановыеУдержанияРаботниковОрганизаций
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ("+ СведенияОбУдержанияхСрезТекст +") КАК СведенияОбУдержанияхСрез
	|			ПО СведенияОбУдержанияхСрез.ФизЛицо = ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо И СведенияОбУдержанияхСрез.ВидРасчета = ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета И СведенияОбУдержанияхСрез.Период = ПлановыеУдержанияРаботниковОрганизаций.Период
	|		ПО ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо = УдержанияРаботниковОрганизации.ФизЛицо И ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета = УдержанияРаботниковОрганизации.ВидРасчета И ПлановыеУдержанияРаботниковОрганизаций.ДокументОснование = УдержанияРаботниковОрганизации.ДокументОснование
	|
	|ГДЕ
	|	УдержанияРаботниковОрганизации.Организация = &парамОрганизация И
	|	УдержанияРаботниковОрганизации.ПериодРегистрации = &парамПериодРегистрации";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		ДанныеУчетаТекст = ДанныеУчетаТекст +"	
		|		И УдержанияРаботниковОрганизации.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
	КонецЕсли;
	
	
	
	// ОтражениеВБухучете
	//	Поля:
	//		Регистратор КАК Регистратор,
	//		НомерСтроки КАК НомерСтроки,
	//		ФизЛицо,
	//		СчетДт,
	//		СчетКт,
	//		СубконтоДт1,
	//		СубконтоДт2,
	//		СубконтоДт3,
	//		СубконтоКт1,
	//		СубконтоКт2,
	//		СубконтоКт3,
	//		ВидРасчета
	//		Результат
	//		НомерСубконтоРаботникиДт
	//		НомерСубконтоРаботникиКт
	//		СчетДтРазрез
	//		СчетКтРазрез
	//		СубконтоДт1Разрез
	//		СубконтоДт2Разрез
	//		СубконтоДт3Разрез
	//		СубконтоКт1Разрез
	//		СубконтоКт2Разрез
	//		СубконтоКт3Разрез
	//		РезультатБаза
	//
	
	ОтражениеВБухучетеТекст = 
	"ВЫБРАТЬ
	|	ДанныеУчета.Регистратор КАК Регистратор,
	|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
	|	ДанныеУчета.ФизЛицо КАК ФизЛицо,
	//|	ДанныеУчета.Сотрудник,
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетКт,
	|	ДанныеУчета.СубконтоДт1,
	|	ДанныеУчета.СубконтоДт2,
	|	ДанныеУчета.СубконтоДт3,
	|	ДанныеУчета.СубконтоКт1,
	|	ДанныеУчета.СубконтоКт2,
	|	ДанныеУчета.СубконтоКт3,
	|	ДанныеУчета.СчетДтНУ,
	|	ДанныеУчета.СчетКтНУ,	
	|	ДанныеУчета.СубконтоДтНУ1,
	|	ДанныеУчета.СубконтоДтНУ2,
	|	ДанныеУчета.СубконтоДтНУ3,
	|	ДанныеУчета.СубконтоКтНУ1,
	|	ДанныеУчета.СубконтоКтНУ2,
	|	ДанныеУчета.СубконтоКтНУ3,	
	|	ДанныеУчета.ВидРасчета,
	|	ДанныеУчета.Результат,
	|	ДанныеУчета.ДокументОснование.Получатель Как Контрагент,
	|	ДанныеУчета.ДокументОснование Как ИсполнительныйДокумент,
	|	ВЫБОР КОГДА (ВидыСубконтоРаботникиДт.НомерСтроки) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ВидыСубконтоРаботникиДт.НомерСтроки КОНЕЦ КАК НомерСубконтоРаботникиДт,
	|	ВЫБОР КОГДА (ВидыСубконтоРаботникиКт.НомерСтроки) ЕСТЬ NULL  ТОГДА 0 ИНАЧЕ ВидыСубконтоРаботникиКт.НомерСтроки КОНЕЦ КАК НомерСубконтоРаботникиКт,
	|	ВЫБОР КОГДА ДанныеУчета.СчетКт = &СчетРасчетыПоИсполнительнымДокументамРаботников ТОГДА " + мНомерСубконтоКонтрагентыКт + " ИНАЧЕ 0 КОНЕЦ КАК НомерСубконтоКонтрагентыКт,
	|	ВЫБОР КОГДА ДанныеУчета.СчетКт = &СчетРасчетыПоИсполнительнымДокументамРаботников ТОГДА " + мНомерСубконтоИсполнДокументыКт + " ИНАЧЕ 0 КОНЕЦ КАК НомерСубконтоИсполнДокументыКт,
	|	БазаСреднегоЗаработка.СчетДтРазрез КАК СчетДтРазрез,
	|	БазаСреднегоЗаработка.СчетКтРазрез КАК СчетКтРазрез,
	|	БазаСреднегоЗаработка.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
	|	БазаСреднегоЗаработка.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
	|	БазаСреднегоЗаработка.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
	|	БазаСреднегоЗаработка.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
	|	БазаСреднегоЗаработка.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
	|	БазаСреднегоЗаработка.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
	|	БазаСреднегоЗаработка.СчетДтНУРазрез КАК СчетДтНУРазрез,
	|	БазаСреднегоЗаработка.СчетКтНУРазрез КАК СчетКтНУРазрез,
	|	БазаСреднегоЗаработка.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
	|	БазаСреднегоЗаработка.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
	|	БазаСреднегоЗаработка.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
	|	БазаСреднегоЗаработка.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
	|	БазаСреднегоЗаработка.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
	|	БазаСреднегоЗаработка.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,	
	|	БазаСреднегоЗаработка.РезультатБаза КАК РезультатБаза
	|ИЗ
	|	("+ ДанныеУчетаТекст +") КАК ДанныеУчета
	|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ БазаСреднегоЗаработкаТекст +") КАК БазаСреднегоЗаработка
	|		ПО ДанныеУчета.Регистратор = БазаСреднегоЗаработка.Регистратор И ДанныеУчета.НомерСтроки = БазаСреднегоЗаработка.НомерСтроки,
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиДт
	|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет) И ДанныеУчета.СчетДт = ВидыСубконтоРаботникиДт.Ссылка И (ВидыСубконтоРаботникиДт.ВидСубконто = &парамРаботники)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиКт
	|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет) И ДанныеУчета.СчетКт = ВидыСубконтоРаботникиКт.Ссылка И (ВидыСубконтоРаботникиКт.ВидСубконто = &парамРаботники)
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДанныеУчета.Регистратор,
	|	ДанныеУчета.НомерСтроки";
	
	
	Запрос = Новый Запрос(ОтражениеВБухучетеТекст);
	
	Измерения = Новый Массив(1);
	Измерения[0] = "Сотрудник";
	Запрос.УстановитьПараметр("парамИзмерения", Измерения);
	
	Разрезы = Новый Массив(16);
	Разрезы[0]	= "СчетДт";
	Разрезы[1]	= "СубконтоДт1";
	Разрезы[2]	= "СубконтоДт2";
	Разрезы[3]	= "СубконтоДт3";
	Разрезы[4]	= "СчетКт";
	Разрезы[5]	= "СубконтоКт1";
	Разрезы[6]	= "СубконтоКт2";
	Разрезы[7]	= "СубконтоКт3";
	Разрезы[8]	= "СчетДтНУ";
	Разрезы[9]	= "СубконтоДтНУ1";
	Разрезы[10]	= "СубконтоДтНУ2";
	Разрезы[11]	= "СубконтоДтНУ3";
	Разрезы[12]	= "СчетКтНУ";
	Разрезы[13]	= "СубконтоКтНУ1";
	Разрезы[14]	= "СубконтоКтНУ2";
	Разрезы[15]	= "СубконтоКтНУ3";	
	
	Запрос.УстановитьПараметр("парамРазрезыБУ", Разрезы);
	
	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
	Запрос.УстановитьПараметр("парамПустойСчет", ПланыСчетов.Хозрасчетный.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамРаботники", ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.РаботникиОрганизации);
	Запрос.УстановитьПараметр("парамПоСреднемуЗаработку", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку);
	Запрос.УстановитьПараметр("парамОрганизация", Организация);
	Запрос.УстановитьПараметр("парамПериодРегистрации", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	Запрос.УстановитьПараметр("СчетРасчетыПоИсполнительнымДокументамРаботников", ПланыСчетов.Хозрасчетный.РасчетыПоИсполнительнымДокументамРаботников);
	
	СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	
	Запрос.Текст = СведенияОбУдержанияхСрезТекст;
	Запрос.Текст = ДанныеУчетаТекст;
	
	Запрос.Текст = ОтражениеВБухучетеТекст;
	РезультатДанныеУчета = Запрос.Выполнить();
	
	
	// пустая ссылка на счет - для проверок способов отражения в бухучете
	ПустойСчет = ПланыСчетов.Хозрасчетный.ПустаяСсылка();
	ПустойСчетНУ = ПланыСчетов.Налоговый.ПустаяСсылка();
	
	// основная выборка - по ней ведем обход и вводим записи движений
	ДанныеУчета = РезультатДанныеУчета.Выбрать();
	Если Не ДанныеУчета.Следующий() Тогда
		ПродолжатьОбработку = Ложь;
	Иначе
		ПродолжатьОбработку = Истина;
	КонецЕсли;
	
	// вспомогательная выборка - по ней ведем суммирование базовых результатов
	ДанныеУчетаВспомогательные = РезультатДанныеУчета.Выбрать();
	
	// структура поиска для позиционирования в ДанныеНалоговогоУчетаВспомогательные
	// при необходимости суммирования "базовых2 ресурсов
	СтруктураПоиска = Новый Структура("Регистратор,НомерСтроки");
	
	Пока ПродолжатьОбработку Цикл
		СтрокаДанных = СоздатьСтрокуПромежуточнойТаблицы(ДанныеУчета, ПромежуточнаяТаблица, ПустойСчет);
		
		// выполним автозаполнение субконто если это предусмотрено способом отражения в бухучете
		// при этом отработаем только записи, которые получены из запроса
		// если не пустой счет - заполним "автозаполняемые" субконто
		
		Если Организация.ИНН <> "700103211" Тогда //Аверсон ЕАЕ 27.06.2024 СВФР-012907 не Климовичи
			
			Если ДанныеУчета.СчетДт <> ПустойСчет Тогда
				Если ДанныеУчета.НомерСубконтоРаботникиДт <> 0 Тогда
					Субконто = ДанныеУчета[НомерДт + ДанныеУчета.НомерСубконтоРаботникиДт];
					Если не ЗначениеЗаполнено(Субконто) Тогда
						СтрокаДанных["СубконтоДт" + ДанныеУчета.НомерСубконтоРаботникиДт] = ДанныеУчета.Физлицо;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
		КонецЕсли;
		
		Если ДанныеУчета.СчетКт <> ПустойСчет Тогда
			Если ДанныеУчета.НомерСубконтоРаботникиКт <> 0 Тогда
				Субконто = ДанныеУчета[НомерКт + ДанныеУчета.НомерСубконтоРаботникиКт];
				Если не ЗначениеЗаполнено(Субконто) Тогда
					СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоРаботникиКт] = ДанныеУчета.Физлицо;
				КонецЕсли;
			КонецЕсли;
			Если ДанныеУчета.НомерСубконтоКонтрагентыКт <> 0 Тогда
				Субконто = ДанныеУчета[НомерКт + ДанныеУчета.НомерСубконтоКонтрагентыКт];
				Если не ЗначениеЗаполнено(Субконто) Тогда
					СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоКонтрагентыКт] = ДанныеУчета.Контрагент;
				КонецЕсли;
			КонецЕсли;
			Если ДанныеУчета.НомерСубконтоИсполнДокументыКт <> 0 Тогда
				Субконто = ДанныеУчета[НомерКт + ДанныеУчета.НомерСубконтоИсполнДокументыКт];
				Если не ЗначениеЗаполнено(Субконто) Тогда
					СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоИсполнДокументыКт] = ДанныеУчета.ИсполнительныйДокумент;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// обработаем записи с точки зрения ЕНВД
		// если задана конкретная проводка и задан процент ЕНВД
		Если ДанныеУчета.СчетДт = ПустойСчет ИЛИ ДанныеУчета.СчетКт = ПустойСчет Тогда
			// вычисляем результат нормируя его на базу для строк базы относящихся 
			// к одной строке основного регистра
			
			// текущий ключ поиска 
			ТекущийРегистратор = ДанныеУчета.Регистратор;
			ТекущийНомерСтроки = ДанныеУчета.НомерСтроки;
			// позиционируемся во вспомогательной выборке по запросу для суммирования "базовых" данных
			СтруктураПоиска.Регистратор = ТекущийРегистратор;
			СтруктураПоиска.НомерСтроки = ТекущийНомерСтроки;
			Если 	ДанныеУчетаВспомогательные.Регистратор <> ТекущийРегистратор ИЛИ 
				ДанныеУчетаВспомогательные.НомерСтроки <> ТекущийНомерСтроки Тогда
				// ищем следующую строку во спомогательной выборке если она не является искомой	
				ДанныеУчетаВспомогательные.НайтиСледующий(СтруктураПоиска);
			КонецЕсли;
			
			СуммаПоСтроке = 0;
			// суммируем базовые ресурсы по текущей строке набора записей
			Пока ДанныеУчетаВспомогательные.Регистратор = ТекущийРегистратор И ДанныеУчетаВспомогательные.НомерСтроки = ТекущийНомерСтроки Цикл
				Если ДанныеУчетаВспомогательные.РезультатБаза = NULL Тогда
					Успешно = Ложь;
				Иначе
					СуммаПоСтроке = СуммаПоСтроке + ДанныеУчетаВспомогательные.РезультатБаза;
				КонецЕсли;
				Если Не ДанныеУчетаВспомогательные.Следующий() Тогда
					Прервать;
				КонецЕсли;
			КонецЦикла;
			
			// суммарная доля, которую уже "разбросали" на строки с одинаковым регистратором и номером строки
			СуммарнаяДоля = 0;
			// полный результат
			ПолныйРезультат = ДанныеУчета.Результат;
			// обходим строки и вычисляем долю результата по базовым записям
			ПерваяИзГруппыСтрок = Истина;
			Пока ДанныеУчета.Регистратор = ТекущийРегистратор И ДанныеУчета.НомерСтроки = ТекущийНомерСтроки Цикл
				// если это не первая из группы "базовых" строк по одной строке основного регистра
				// то создаем очередную строку движений
				Если Не ПерваяИзГруппыСтрок Тогда
					СтрокаДанных = СоздатьСтрокуПромежуточнойТаблицы(ДанныеУчета, ПромежуточнаяТаблица, ПустойСчет);
				Иначе
					ПерваяИзГруппыСтрок = Ложь;
				КонецЕсли;
				
				Если СуммаПоСтроке = 0 Тогда
					Доля = 0;
				Иначе
					Если ДанныеУчета.РезультатБаза = NULL Тогда
						Успешно = Ложь;
						Доля = 0;
					Иначе
						Доля = ПолныйРезультат * ДанныеУчета.РезультатБаза / СуммаПоСтроке;
					КонецЕсли;
				КонецЕсли;
				
				// если счет пустой - заполним счет данными базы
				Если ДанныеУчета.СчетДт = ПустойСчет Тогда
					Если ДанныеУчета.СчетДтРазрез = NULL Тогда
						Успешно = Ложь;
					Иначе
						СтрокаДанных.СчетДт 	 	= ДанныеУчета.СчетДтРазрез;
						СтрокаДанных.СубконтоДт1 	= ДанныеУчета.СубконтоДт1Разрез;
						СтрокаДанных.СубконтоДт2 	= ДанныеУчета.СубконтоДт2Разрез;
						СтрокаДанных.СубконтоДт3 	= ДанныеУчета.СубконтоДт3Разрез;						
					КонецЕсли;
				КонецЕсли;
				
				// если счет пустой - заполним счет данными базы
				Если ДанныеУчета.СчетДтНУ = ПустойСчетНУ Тогда
					Если ДанныеУчета.СчетДтНУРазрез = NULL Тогда
						Успешно = Ложь;
					Иначе								
						СтрокаДанных.СчетДтНУ 	 	= ДанныеУчета.СчетДтНУРазрез;
						СтрокаДанных.СубконтоДтНУ1 	= ДанныеУчета.СубконтоДтНУ1Разрез;
						СтрокаДанных.СубконтоДтНУ2 	= ДанныеУчета.СубконтоДтНУ2Разрез;
						СтрокаДанных.СубконтоДтНУ3 	= ДанныеУчета.СубконтоДтНУ3Разрез;
					КонецЕсли;
				КонецЕсли;
				
				// если счет пустой - заполним счет данными базы
				Если ДанныеУчета.СчетКт = ПустойСчет Тогда
					Если ДанныеУчета.СчетКтРазрез = NULL Тогда
						Успешно = Ложь;
					Иначе
						СтрокаДанных.СчетКт 	 = ДанныеУчета.СчетКтРазрез;
						СтрокаДанных.СубконтоКт1 = ДанныеУчета.СубконтоКт1Разрез;
						СтрокаДанных.СубконтоКт2 = ДанныеУчета.СубконтоКт2Разрез;
						СтрокаДанных.СубконтоКт3 = ДанныеУчета.СубконтоКт3Разрез;
					КонецЕсли;
				КонецЕсли;
				
				// если счет пустой - заполним счет данными базы
				Если ДанныеУчета.СчетКтНУ = ПустойСчетНУ Тогда
					Если ДанныеУчета.СчетКтНУРазрез = NULL Тогда
						Успешно = Ложь;
					Иначе
						СтрокаДанных.СчетКтНУ		= ДанныеУчета.СчетКтНУРазрез;
						СтрокаДанных.СубконтоКтНУ1	= ДанныеУчета.СубконтоКтНУ1Разрез;
						СтрокаДанных.СубконтоКтНУ2	= ДанныеУчета.СубконтоКтНУ2Разрез;
						СтрокаДанных.СубконтоКтНУ3	= ДанныеУчета.СубконтоКтНУ3Разрез;
					КонецЕсли;
				КонецЕсли;				
				
				СтрокаДанных.Сумма = Доля;
				СуммарнаяДоля = СуммарнаяДоля + Доля;
				Если Не ДанныеУчета.Следующий() Тогда
					ПродолжатьОбработку = Ложь;
					Прервать;
				КонецЕсли;
			КонецЦикла;
			// ошибки округления скаладываются на последнюю запись из группы базовых записей
			СтрокаДанных.Сумма = СтрокаДанных.Сумма + ПолныйРезультат - СуммарнаяДоля;
		Иначе
			Если Не ДанныеУчета.Следующий() Тогда
				ПродолжатьОбработку = Ложь;
			КонецЕсли;
		КонецЕсли;
		
	КонецЦикла;
	
	ПромежуточнаяТаблица.Свернуть( "СчетДт,СчетКт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СубконтоКт1,СубконтоКт2,СубконтоКт3,СчетДтНУ,СчетКтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,СубконтоКтНУ1,СубконтоКтНУ2,СубконтоКтНУ3,ПризнакПроводки,ВидРасчета", "Сумма");
	
	//ТЗСотрудникиДляРезерва = Новый ТаблицаЗначений;
	//ТЗСотрудникиДляРезерва.Колонки.Добавить("Сотрудник");
	//СтрТЗСотрудникиДляРезерва = ТЗСотрудникиДляРезерва.Добавить();
	//СтрТЗСотрудникиДляРезерва.Сотрудник = 
	Если ОрганизацияИНН = "806000046" Тогда
		ЗначПодр = ПодразделениеОрганизации;
		ПодрПоиска = СтрЗаменить(ЗначПодр,"Представительство Государственного предприятия ""Стравита""","Белгосстрах");
		Если ПодразделениеОрганизации.Код ="000000009" или ПодразделениеОрганизации.Код ="000000015"  Тогда
			ПодрПоиска = "Ф-л Белгосстраха по г.Минску";
		КонецЕсли;
		//КонецЕсли;
		СпрКонтрагент = Справочники.Контрагенты.Выбрать();
		Пока СпрКонтрагент.Следующий()=1 Цикл 
			Если Найти(СпрКонтрагент.НаименованиеПолное,ПодрПоиска) Тогда
				НайденКонтрагент =СпрКонтрагент.Ссылка; 
			КонецЕсли;
		КонецЦикла; 
		СпрДогоора = Справочники.ДоговорыКонтрагентов.Выбрать();
		Пока СпрДогоора.Следующий()=1 Цикл 
			Если СпрДогоора.Владелец = НайденКонтрагент Тогда
				НайденДоговор =СпрДогоора.Ссылка; 
			КонецЕсли;
		КонецЦикла;  
	КонецЕсли;
	
	Для Каждого СтрокаТаблицы Из ПромежуточнаяТаблица Цикл
		Строка = ОтражениеВУчете.Добавить();
		Строка.СчетДт 			= СтрокаТаблицы.СчетДт;
		Строка.СубконтоДт1	 	= СтрокаТаблицы.СубконтоДт1;
		Строка.СубконтоДт2	 	= СтрокаТаблицы.СубконтоДт2;
		Строка.СубконтоДт3	 	= СтрокаТаблицы.СубконтоДт3;
		Строка.СчетКт 			= СтрокаТаблицы.СчетКт;
		Строка.СубконтоКт1	 	= СтрокаТаблицы.СубконтоКт1;
		Строка.СубконтоКт2	 	= СтрокаТаблицы.СубконтоКт2;
		Строка.СубконтоКт3	 	= СтрокаТаблицы.СубконтоКт3;
		Если ОрганизацияИНН = "806000046" Тогда //ИЛИ Организация.ИНН = "700103211" Тогда //Аверсон ЕАЕ 23.05.2024 СВФР-012907 Климовичи
			Если ТипЗнч(СтрокаТаблицы.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.УдержанияОрганизаций") и
				ТипЗнч(СтрокаТаблицы.СубконтоДт1) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
				Строка.СчетДт = ?(ЗначениеЗаполнено(СтрокаТаблицы.СубконтоДт1.СчетУчета),СтрокаТаблицы.СубконтоДт1.СчетУчета, ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.01"));	
			КонецЕсли;
			Подразделение = "";
			Если  ТипЗнч(СтрокаТаблицы.СубконтоДт1) =  Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
				Подразделение = СтрокаТаблицы.СубконтоДт1;
			ИначеЕсли ТипЗнч(СтрокаТаблицы.СубконтоДт2) =  Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
				Подразделение = СтрокаТаблицы.СубконтоДт2;   					
			ИначеЕсли ТипЗнч(СтрокаТаблицы.СубконтоДт3) =  Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
				Подразделение = СтрокаТаблицы.СубконтоДт3;
			КонецЕсли;
			Если не (СокрЛП(Строка.СчетДт) = "97.02") и СокрЛП(Строка.СчетКт)= "69.01"  Тогда
				Строка.СубконтоКт2	    = СтрокаТаблицы.СубконтоДт1;
				Если СокрЛП(Строка.СчетДт) = "26.07" тогда// или СокрЛП(Строка.СчетДт) = "77.11" Тогда
					Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.09.2");
					Строка.СубконтоДт2 = СтатьяЗатратФСЗН;
				ИначеЕсли Лев(Строка.СчетДт,2) = "26" или Лев(Строка.СчетДт,2) = "77" Тогда
					Если ПериодРегистрации >= Дата(2022,10,01) Тогда
						Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.09.1");  
					Иначе
						Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.09");
					КонецЕсли;
					Строка.СубконтоДт2 = СтатьяЗатратФСЗН;
					//ИначеЕсли Лев(Строка.СчетДт,5) = "91.09" или Лев(Строка.СчетДт,2) = "69" Тогда
					//	Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.04.5");
					//	Строка.СубконтоДт1 = Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию("Расчеты по социальному страхованию (ДНПС)"); 
					//	Если  ТипЗнч(СтрокаТаблицы.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда 
					//		Строка.СубконтоДт2 = Строка.СубконтоДт3;
					//	КонецЕсли;
				ИначеЕсли Лев(Строка.СчетДт,2) = "91" или Лев(Строка.СчетДт,2) = "76" Тогда
					Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.04.5");       
					Если Найти(Строка.СубконтоДт1," (ДНПС)") Тогда  
						Строка.СубконтоДт1 = Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию("Расчеты по социальному страхованию (ДНПС)"); 
						Если  ТипЗнч(СтрокаТаблицы.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда 
							Строка.СубконтоДт2 = Строка.СубконтоДт3;
						КонецЕсли;
					Иначе
						Строка.СубконтоДт1 = Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию("Расчеты по социальному страхованию"); 
						Если  ТипЗнч(СтрокаТаблицы.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда 
							Строка.СубконтоДт2 = Строка.СубконтоДт3;
						КонецЕсли;
					КонецЕсли;
					
				КонецЕсли;
			КонецЕсли; 
			Если СокрЛП(Строка.СчетКт)= "69.01" или СокрЛП(Строка.СчетКт)= "69.02"  Тогда
				Строка.СубконтоКт2	    = ПодразделениеОрганизации;
			КонецЕсли;
			
			Если   СокрЛП(Строка.СчетКт)= "76.02" и не СокрЛП(Строка.СчетДт) = "97.02" Тогда
				//ДанныеСотрудника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("Сотрудник",Стр.Сотрудник));       БГС И ФСЗН
				//Родитель = СтрокаТаблицы.СубконтоДт1;
				//ЗначПодр = СтрокаТаблицы.СубконтоДт1.Родитель.ссылка;
				//Пока ЗначПодр <>  ЗначениеЗаполнено(Справочники.ПодразделенияОрганизаций.ПустаяСсылка()) Цикл 
				//	Родитель = ЗначПодр;
				//	Если ЗначениеЗаполнено(ЗначПодр.Родитель) Тогда
				//		ЗначПодр = ЗначПодр.Родитель;
				//	Иначе
				//		прервать
				//	КонецЕсли;
				//КонецЦикла;
				//Если ЗначениеЗаполнено(ЗначПодр) Тогда
				//Иначе
				Если СокрЛП(Строка.СчетДт) = "26.07" Тогда
					Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.23.2");
					Строка.СубконтоДт2 = СтатьяЗатратСтрах;
					Субконто3 = Справочники.Страхование_ВидыСтрахования.НайтиПоКоду("000000001");
					Строка.СубконтоДт3 = Субконто3;
				ИначеЕсли Лев(Строка.СчетДт,2) = "26" Тогда
					Если ПериодРегистрации >= Дата(2022,10,01) Тогда
						Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.23.1");
					Иначе
						Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.23");
					КонецЕсли;
					Строка.СубконтоДт2 = СтатьяЗатратСтрах;
					Субконто3 = Справочники.Страхование_ВидыСтрахования.НайтиПоКоду("000000001");
					Строка.СубконтоДт3 = Субконто3;
					//ИначеЕсли  Лев(Строка.СчетДт,5) = "91.09" или Лев(Строка.СчетДт,2) = "76" Тогда
					//	Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.04.5");
					//	Строка.СубконтоДт1 = Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию("Страховые взносы по страхованию от несч. сл. на производстве (ДНПС)");
					//	Если  ТипЗнч(СтрокаТаблицы.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда 
					//		Строка.СубконтоДт2 = Строка.СубконтоДт3;
					//	КонецЕсли;
				ИначеЕсли Лев(Строка.СчетДт,2) = "91" или Лев(Строка.СчетДт,2) = "76" Тогда
					Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.04.5");      
					Если  Найти(Строка.СубконтоДт1," (ДНПС)") Тогда 
						Строка.СубконтоДт1 = Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию("Страховые взносы по страхованию от несч. сл. на производстве (ДНПС)");
						Если  ТипЗнч(СтрокаТаблицы.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда 
							Строка.СубконтоДт2 = Строка.СубконтоДт3;
						КонецЕсли;    					
					ИНаче
						Строка.СубконтоДт1 = Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию("Страховые взносы по страхованию от несч. сл. на производстве");
						Если  ТипЗнч(СтрокаТаблицы.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда 
							Строка.СубконтоДт2 = Строка.СубконтоДт3;
						КонецЕсли; 
					КонецЕсли;
				КонецЕсли;
				
				Если не ЗначениеЗаполнено(НайденКонтрагент) Тогда
					ЗначПодр = ПодразделениеОрганизации;
					ПодрПоиска = СтрЗаменить(ЗначПодр,"Представительство Государственного предприятия ""Стравита""","Белгосстрах");
					Если ПодразделениеОрганизации.Код ="000000009" или ПодразделениеОрганизации.Код ="000000015"  Тогда
						ПодрПоиска = "Филиал Белгосстраха по г.Минску";
					КонецЕсли;
					//КонецЕсли;
					СпрКонтрагент = Справочники.Контрагенты.Выбрать();
					Пока СпрКонтрагент.Следующий()=1 Цикл 
						Если Найти(СпрКонтрагент.НаименованиеДляПоиска,ПодрПоиска) Тогда
							НайденКонтрагент =СпрКонтрагент.Ссылка; 
						КонецЕсли;
					КонецЦикла; 
					СпрДогоора = Справочники.ДоговорыКонтрагентов.Выбрать();
					Пока СпрДогоора.Следующий()=1 Цикл 
						Если СпрДогоора.Владелец = НайденКонтрагент Тогда
							НайденДоговор =СпрДогоора.Ссылка; 
						КонецЕсли;
					КонецЦикла;  
				КонецЕсли;
				Если не Найти(Строка.СубконтоКт1,"Стравита") Тогда
					Строка.СубконтоКт1 = НайденКонтрагент;
					Строка.СубконтоКт2	    = НайденДоговор;
				КонецЕсли;
			ИначеЕсли  СокрЛП(Строка.СчетКт)= "76.02" и СокрЛП(Строка.СчетДт) = "97.02" или
				СокрЛП(Строка.СчетДт) = "97.02" и СокрЛП(Строка.СчетКт)= "69.01" Тогда
				Строка.СубконтоКт2	    = ПодразделениеОрганизации;
			ИначеЕсли СокрЛП(Строка.СчетКт)= "76.14.1" Тогда
				Строка.СубконтоКт1 = СтрокаТаблицы.СубконтоКт1;
				Строка.СубконтоКт2 = СтрокаТаблицы.СубконтоКт2;	
			ИначеЕсли СокрЛП(Строка.СчетКт)= "77.07.1" Тогда
				ЗначПодр = ПодразделениеОрганизации;
				ПодрПоиска = ЗначПодр;
				СпрКонтрагент = Справочники.Контрагенты.Выбрать();
				Пока СпрКонтрагент.Следующий()=1 Цикл 
					Если Найти(СпрКонтрагент.НаименованиеПолное,ПодрПоиска) Тогда
						НайденКонтрагент =СпрКонтрагент.Ссылка; 
					КонецЕсли;
				КонецЦикла; 
				СпрДогоора = Справочники.ДоговорыКонтрагентов.Выбрать();
				Пока СпрДогоора.Следующий()=1 Цикл 
					Если СпрДогоора.Владелец = НайденКонтрагент Тогда
						НайденДоговор =СпрДогоора.Ссылка; 
					КонецЕсли;
				КонецЦикла;     				
				Строка.СубконтоКт1 = ПодразделениеОрганизации;
				Строка.СубконтоКт2 = НайденКонтрагент; 
				Строка.СубконтоКт3 = НайденДоговор;
				
			ИначеЕсли СокрЛП(Строка.СчетКт)= "76.06" Тогда
				СпрКонтрагент = Справочники.Контрагенты.Выбрать();
				Пока СпрКонтрагент.Следующий()=1 Цикл 
					Если СокрЛП(СпрКонтрагент) = СокрЛП(СтрокаТаблицы.СубконтоДт1) Тогда
						НайденКонтрагент =СпрКонтрагент.Ссылка; 
					КонецЕсли;
				КонецЦикла;  
				Строка.СубконтоКт1 = НайденКонтрагент;
			КонецЕсли;
		КонецЕсли;
		Если Лев(Строка.СчетДт,2) = "26" Тогда
			Строка.СубконтоДт1 = Подразделение;
		КонецЕсли;
		Строка.СчетДтНУ			= СтрокаТаблицы.СчетДтНУ;
		Строка.СубконтоДтНУ1 	= СтрокаТаблицы.СубконтоДтНУ1;
		Строка.СубконтоДтНУ2 	= СтрокаТаблицы.СубконтоДтНУ2;
		Строка.СубконтоДтНУ3 	= СтрокаТаблицы.СубконтоДтНУ3;		
		Строка.СчетКтНУ			= СтрокаТаблицы.СчетКтНУ;
		Строка.СубконтоКтНУ1 	= СтрокаТаблицы.СубконтоКтНУ1;
		Строка.СубконтоКтНУ2 	= СтрокаТаблицы.СубконтоКтНУ2;
		Строка.СубконтоКтНУ3 	= СтрокаТаблицы.СубконтоКтНУ3;
		Строка.Сумма			= СтрокаТаблицы.Сумма;
		Строка.ПризнакПроводки  = СтрокаТаблицы.ПризнакПроводки;
		Строка.ВидРасчета       = СтрокаТаблицы.ВидРасчета;
	КонецЦикла;
	
	//////////////////////////////////////////////////////////////////////////////////////////////////
	// отражение НДФЛ
	
	// НДФЛИсчисленный
	// Поля:
	//		Физлицо
	//		Налог
	// Описание:
	// Содержит НДФЛ исчимленный для заданной организации в заданном периоде регистрации
	
	//Аверсон ЕАЕ 19.06.2024 СВФР-012907
	//Климовичи
	Если ОрганизацияИНН = "700103211" Тогда
		НДФЛИсчисленныйТекст = 
		"ВЫБРАТЬ
		|	НДФЛРасчетыСБюджетом.ФизЛицо,
		|	СУММА(ВЫБОР
		|			КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = &парамНачисление
		|				ТОГДА НДФЛРасчетыСБюджетом.Налог
		|			ИНАЧЕ -НДФЛРасчетыСБюджетом.Налог
		|		КОНЕЦ) КАК Налог,
		| НДФЛРасчетыСБюджетом.ПодразделениеОрганизации КАК Подразделение,
		| НДФЛРасчетыСБюджетом.Регистратор
		|ИЗ
		|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		|ГДЕ
		|	(НДФЛРасчетыСБюджетом.Период >= &парамНачалоМесяца И НДФЛРасчетыСБюджетом.Период <= &парамКонецМесяца И НДФЛРасчетыСБюджетом.Организация = &парамОбособленноеПодразделение И (НЕ НДФЛРасчетыСБюджетом.Регистратор ССЫЛКА Документ.НДФЛиЕСНДоходыИНалоги) И НДФЛРасчетыСБюджетом.ВидСтроки = &парамНачисление ИЛИ НДФЛРасчетыСБюджетом.ВидСтроки = &парамПереданоНаВзыскание)";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			НДФЛИсчисленныйТекст = НДФЛИсчисленныйТекст +"	
			|		И НДФЛРасчетыСБюджетом.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
		КонецЕсли;
		НДФЛИсчисленныйТекст = НДФЛИсчисленныйТекст +"
		|
		|СГРУППИРОВАТЬ ПО
		|	НДФЛРасчетыСБюджетом.ФизЛицо,
		|	НДФЛРасчетыСБюджетом.ПодразделениеОрганизации,
		|   НДФЛРасчетыСБюджетом.Регистратор
		|";
		Запрос = Новый Запрос(НДФЛИсчисленныйТекст);
		
		Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
		Запрос.УстановитьПараметр("парамНачалоМесяца", НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("парамКонецМесяца", КонецМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
		Запрос.УстановитьПараметр("парамНачисление", Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
		Запрос.УстановитьПараметр("парамПереданоНаВзыскание", Перечисления.НДФЛРасчетыСБюджетомВидСтроки.ПереданоНаВзыскание);
		
		Выборка = Запрос.Выполнить().Выбрать();
		СчетКредита = ?(ЗначениеЗаполнено(УчетнаяПолитика.СчетУчетаНДФЛБУ),УчетнаяПолитика.СчетУчетаНДФЛБУ,ПланыСчетов.Хозрасчетный.НДФЛ);
		СубконтоКредита = ?(ЗначениеЗаполнено(УчетнаяПолитика.СубконтоНДФЛБУ1),УчетнаяПолитика.СубконтоНДФЛБУ1,Перечисления.ВидыПлатежейВГосБюджет.Налог);
		
		Пока Выборка.Следующий() Цикл
			Строка = ОтражениеВУчете.Добавить();
			//Строка.СчетДт 		= СчетДебета;
			//Строка.СубконтоДт1 	= Выборка.Физлицо;
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= СубконтоКредита;
			//Если ОрганизацияИНН = "806000046" Тогда
			//	Строка.СчетДт 		= ?(ЗначениеЗаполнено(Выборка.Физлицо.СчетУчета),Выборка.Физлицо.СчетУчета, ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.01"));
			//	Если  ПодразделениеОрганизации.Код ="000000015" Тогда
			//		Строка.СубконтоКт2	= ПодразделениеОрганизации;
			//	Иначе
			//		Строка.СубконтоКт2	= Выборка.Подразделение;
			//	КонецЕсли;
			
			//Аверсон ЕАЕ 23.05.2024 СВФР-012907
			//Климовичи
			//ИначеЕсли ОрганизацияИНН = "700103211" Тогда
			//	Строка.СчетДт 		= ?(ЗначениеЗаполнено(Выборка.Физлицо.СчетУчета),Выборка.Физлицо.СчетУчета, ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.01"));
			//Аверсон СВФР-012907
			
			//ИначеЕсли ОрганизацияИНН = "100993744" или ОрганизацияИНН = "193357089" или ОрганизацияИНН = "101505322" или ОрганизацияИНН = "190369451" Тогда  //10476
			//	Строка.СубконтоКт2	= Выборка.Подразделение;
			//КонецЕсли;
			ДанныеСчетДт = ПолучитьСчетДт(Выборка.Физлицо, Выборка.Регистратор, Неопределено, Ложь);
			Строка.СчетДт = ДанныеСчетДт.СчетДт;
			Если ЗначениеЗаполнено(Строка.СчетДт) Тогда
				Если Лев(Строка.СчетДт.Код,2) = "26" ИЛИ Лев(Строка.СчетДт.Код,2) = "25" Тогда
					Строка.СубконтоДт1 = ДанныеСчетДт.СубконтоДт1;
					Строка.СубконтоДт2 = ДанныеСчетДт.СубконтоДт2;
				ИначеЕсли Лев(Строка.СчетДт.Код,2) = "70" Тогда
					Строка.СубконтоДт1 = Выборка.Физлицо;
				КонецЕсли;
			Иначе
				Строка.СчетДт = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда;
				Строка.СубконтоДт1 = Выборка.Физлицо;
			КонецЕсли;
			Строка.Сумма		= Выборка.Налог;
			Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.Удержание;
		КонецЦикла;
		
		
	Иначе
		//Аверсон СВФР-012907		
		НДФЛИсчисленныйТекст = 
		"ВЫБРАТЬ
		|	НДФЛРасчетыСБюджетом.ФизЛицо,
		|	СУММА(ВЫБОР
		|			КОГДА НДФЛРасчетыСБюджетом.ВидСтроки = &парамНачисление
		|				ТОГДА НДФЛРасчетыСБюджетом.Налог
		|			ИНАЧЕ -НДФЛРасчетыСБюджетом.Налог
		|		КОНЕЦ) КАК Налог,
		| НДФЛРасчетыСБюджетом.ПодразделениеОрганизации КАК Подразделение
		|ИЗ
		|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		|ГДЕ
		|	(НДФЛРасчетыСБюджетом.Период >= &парамНачалоМесяца И НДФЛРасчетыСБюджетом.Период <= &парамКонецМесяца И НДФЛРасчетыСБюджетом.Организация = &парамОбособленноеПодразделение И (НЕ НДФЛРасчетыСБюджетом.Регистратор ССЫЛКА Документ.НДФЛиЕСНДоходыИНалоги) И НДФЛРасчетыСБюджетом.ВидСтроки = &парамНачисление ИЛИ НДФЛРасчетыСБюджетом.ВидСтроки = &парамПереданоНаВзыскание)";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			НДФЛИсчисленныйТекст = НДФЛИсчисленныйТекст +"	
			|		И НДФЛРасчетыСБюджетом.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
		КонецЕсли;
		НДФЛИсчисленныйТекст = НДФЛИсчисленныйТекст +"
		|
		|СГРУППИРОВАТЬ ПО
		|	НДФЛРасчетыСБюджетом.ФизЛицо,
		|	НДФЛРасчетыСБюджетом.ПодразделениеОрганизации";
		
		
		Запрос = Новый Запрос(НДФЛИсчисленныйТекст);
		
		Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
		Запрос.УстановитьПараметр("парамНачалоМесяца", НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("парамКонецМесяца", КонецМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
		Запрос.УстановитьПараметр("парамНачисление", Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
		Запрос.УстановитьПараметр("парамПереданоНаВзыскание", Перечисления.НДФЛРасчетыСБюджетомВидСтроки.ПереданоНаВзыскание);
		
		Выборка = Запрос.Выполнить().Выбрать();
		
		СчетДебета = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда;
		СчетКредита = ?(ЗначениеЗаполнено(УчетнаяПолитика.СчетУчетаНДФЛБУ),УчетнаяПолитика.СчетУчетаНДФЛБУ,ПланыСчетов.Хозрасчетный.НДФЛ);
		СубконтоКредита = ?(ЗначениеЗаполнено(УчетнаяПолитика.СубконтоНДФЛБУ1),УчетнаяПолитика.СубконтоНДФЛБУ1,Перечисления.ВидыПлатежейВГосБюджет.Налог);
		
		Пока Выборка.Следующий() Цикл
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 		= СчетДебета;
			Строка.СубконтоДт1 	= Выборка.Физлицо;
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= СубконтоКредита;
			Если ОрганизацияИНН = "806000046" Тогда
				Строка.СчетДт 		= ?(ЗначениеЗаполнено(Выборка.Физлицо.СчетУчета),Выборка.Физлицо.СчетУчета, ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.01"));
				Если  ПодразделениеОрганизации.Код ="000000015" Тогда
					Строка.СубконтоКт2	= ПодразделениеОрганизации;
				Иначе
					Строка.СубконтоКт2	= Выборка.Подразделение;
				КонецЕсли;
				
				//Аверсон ЕАЕ 23.05.2024 СВФР-012907
				//Климовичи
				//ИначеЕсли ОрганизацияИНН = "700103211" Тогда
				//	Строка.СчетДт 		= ?(ЗначениеЗаполнено(Выборка.Физлицо.СчетУчета),Выборка.Физлицо.СчетУчета, ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.01"));
				//Аверсон СВФР-012907
				
			ИначеЕсли ОрганизацияИНН = "100993744" или ОрганизацияИНН = "193357089" или ОрганизацияИНН = "101505322" или ОрганизацияИНН = "190369451" Тогда  //10476
				Строка.СубконтоКт2	= Выборка.Подразделение;
			КонецЕсли;
			Строка.Сумма		= Выборка.Налог;
			Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.Удержание;
		КонецЦикла;
	КонецЕсли;
	
	// конец отражения НДФЛ
	//////////////////////////////////////////////////////////////////////////////////////////////////
	
	
	//////////////////////////////////////////////////////////////////////////////////////////////////
	// Доходы ППС
	//
	// О.Т. 28.10.2014 259
	ЕСНСведенияОДоходахППС = 
	"ВЫБРАТЬ
	|	ВложенныйЗапрос.ФизЛицо,
	|	ВложенныйЗапрос.ПериодВзаиморасчетов,
	|	ВложенныйЗапрос.ППС КАК Сумма,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
	|	КОНЕЦ КАК СчетДт,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	//О.Т. 07.09.2015 № 571
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКт1
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт1
	//|	КОНЕЦ КАК СубконтоКт1,
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКт2
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт2
	//|	КОНЕЦ КАК СубконтоКт2,
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКт3
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт3
	//|	КОНЕЦ КАК СубконтоКт3,
	//О.Т. 07.09.2015 № 571
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
	|	КОНЕЦ КАК СчетДтНУ,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	//О.Т. 07.09.2015 № 571
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКтНУ1
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ1
	//|	КОНЕЦ КАК СубконтоКтНУ1,
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКтНУ2
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ2
	//|	КОНЕЦ КАК СубконтоКтНУ2,
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКтНУ3
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ3
	//|	КОНЕЦ КАК СубконтоКтНУ3,
	//О.Т. 07.09.2015 № 571
	|	ВложенныйЗапрос.ВидДеятельности,
	|	ВложенныйЗапрос.ПодразделениеОрганизации
	|ИЗ
	|	(ВЫБРАТЬ
	|		ЕСНСведенияОДоходахППС.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
	|		ЕСНСведенияОДоходахППС.ВидДеятельности КАК ВидДеятельности,
	|		ЕСНСведенияОДоходахППС.Организация КАК Организация,
	|		ЕСНСведенияОДоходахППС.ФизЛицо КАК ФизЛицо,
	|		ЕСНСведенияОДоходахППС.ППС КАК ППС,
	|		РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации
	|	ИЗ
	|		РегистрНакопления.ЕСНСведенияОДоходахППС КАК ЕСНСведенияОДоходахППС
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонецМесяца) КАК РаботникиОрганизацийСрезПоследних //Аверсон 09.02.2022 КВВ СВФР-008720 (добавлено (&парамКонецМесяца) )
	|			ПО ЕСНСведенияОДоходахППС.Организация = РаботникиОрганизацийСрезПоследних.Организация
	|				И ЕСНСведенияОДоходахППС.ФизЛицо = РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо
	|				И ЕСНСведенияОДоходахППС.ВидДеятельности = РаботникиОрганизацийСрезПоследних.ВидДеятельностиИзмерение //Аверсон 26.07.2022 КВВ СВФР-009388
	|	ГДЕ
	//ПСА 09.06.2021 СВФР-007668+++
	//|		ЕСНСведенияОДоходахППС.ПериодВзаиморасчетов МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца) КАК ВложенныйЗапрос
	|		ЕСНСведенияОДоходахППС.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца) КАК ВложенныйЗапрос
	//+++ПСА 09.06.2021 СВФР-007668
	
	//Аверсон ЕАЕ 17.02.2022 СВФР-008763
	//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&парамКонецМесяца, ) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	//Аверсон СВФР-008763
	
	|		ПО ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник.Организация
	|			И ВложенныйЗапрос.ФизЛицо = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник.Физлицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&парамКонецМесяца, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
	|		ПО ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
	|			И ВложенныйЗапрос.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации,
	|	РегистрСведений.РаботникиОрганизаций.СрезПоследних КАК РаботникиОрганизацийСрезПоследних
	|ГДЕ
	| Истина ";
	//|	ВложенныйЗапрос.ПериодВзаиморасчетов МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		ЕСНСведенияОДоходахППС = ЕСНСведенияОДоходахППС +"	
		|		И ВложенныйЗапрос.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
	КонецЕсли;
	ЕСНСведенияОДоходахППС = ЕСНСведенияОДоходахППС +"
	|
	|СГРУППИРОВАТЬ ПО
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
	|	КОНЕЦ,
	//О.Т. 07.09.2015 № 571
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКт2
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт2
	//|	КОНЕЦ,
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКт1
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт1
	//|	КОНЕЦ,
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКт3
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт3
	//|	КОНЕЦ,
	//О.Т. 07.09.2015 № 571
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
	|	КОНЕЦ,
	|	ВложенныйЗапрос.ФизЛицо,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
	|	КОНЕЦ,
	|	ВложенныйЗапрос.ПериодВзаиморасчетов,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
	|	КОНЕЦ,
	//О.Т. 07.09.2015 № 571
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКтНУ1
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ1
	//|	КОНЕЦ,
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКтНУ2
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ2
	//|	КОНЕЦ,
	//|	ВЫБОР
	//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоКтНУ3
	//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
	//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ3
	//|	КОНЕЦ,
	//О.Т. 07.09.2015 № 571
	|	ВложенныйЗапрос.ВидДеятельности,
	|	ВложенныйЗапрос.ППС,
	|	ВложенныйЗапрос.ПодразделениеОрганизации";//О.Т. 02.03.2015 № Группировка добавлена(двоилась запись)		
	Запрос = Новый Запрос(ЕСНСведенияОДоходахППС);
	
	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);	
	Запрос.УстановитьПараметр("парамНачалоМесяца", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецМесяца", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетКт", СпособПоУмолчанию.СчетКт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт1", СпособПоУмолчанию.СубконтоКт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт2", СпособПоУмолчанию.СубконтоКт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт3", СпособПоУмолчанию.СубконтоКт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетНУ", СпособПоУмолчанию.СчетДтНУ);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетКтНУ", СпособПоУмолчанию.СчетКтНУ);	
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ1", СпособПоУмолчанию.СубконтоКтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ2", СпособПоУмолчанию.СубконтоКтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ3", СпособПоУмолчанию.СубконтоКтНУ3);
	Запрос.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		//Аверсон ЕАЕ 17.08.2022 СВФР-009450
		
		//Строка = ОтражениеВУчете.Добавить();
		//ЗаполнитьЗначенияСвойств(Строка,Выборка);
		//СчетКт = РегистрыСведений.ТарифыВзносовНаППС.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ВидДеятельности",Выборка.ВидДеятельности));
		//Строка.СчетКт = СчетКт.СчетБУ;
		//Строка.СчетКтНУ = СчетКт.СчетНУ;
		//Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ППС;
		////О.Т. 16.07.2015
		//если не ЗначениеЗаполнено(Строка.СубконтоДт1) и ТипЗнч(Выборка.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
		//	Строка.СубконтоДт1 = Выборка.ПодразделениеОрганизации;			
		//КонецЕсли;
		//если не ЗначениеЗаполнено(Строка.СубконтоДт2) и ТипЗнч(Выборка.СубконтоДт2) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
		//	Строка.СубконтоДт2 = Выборка.ПодразделениеОрганизации;			
		//КонецЕсли;
		//если не ЗначениеЗаполнено(Строка.СубконтоДт3) и ТипЗнч(Выборка.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
		//	Строка.СубконтоДт3 = Выборка.ПодразделениеОрганизации;			
		//КонецЕсли;
		////О.Т. 16.07.2015
		////О.Т. 07.09.2015 № 571
		//СубконтоКредита = Перечисления.ВидыПлатежейВГосБюджет.Налог;
		//Строка.СубконтоКт1 = СубконтоКредита
		////О.Т. 07.09.2015 № 571
		
		//Распределение ППС
		СуммаРаспределения = Выборка.Сумма;
		СтруктураОтбора = Новый Структура;
		СтруктураОтбора.Вставить("ФизЛицо", Выборка.ФизЛицо);
		
		НужныеСтрокиОтражениеВБУ = ОтражениеВБУ.НайтиСтроки(СтруктураОтбора);
		
		//Удалим строки с 97 счетом
		Кол = НужныеСтрокиОтражениеВБУ.Количество();
		Если Кол > 0 Тогда
			ПоследнийИнд = Кол - 1;
			Для к = -ПоследнийИнд По 0 Цикл
				НужнаяСтр = НужныеСтрокиОтражениеВБУ[-к];
				Если НужнаяСтр.СчетДт.ПринадлежитЭлементу(ПланыСчетов.Хозрасчетный.РасходыБудущихПериодов) Тогда
					НужныеСтрокиОтражениеВБУ.Удалить(-к);
					Продолжить;
				КонецЕсли;
				
				//Аверсон ЕАЕ 26.10.2022 СВФР-009674
				//Удалим строки, по которым в виде расчета Отчисления на ППС "Не облагается"
				СтруктураСтроки = Новый Структура;
				СтруктураСтроки.Вставить("ФизЛицо", НужнаяСтр.ФизЛицо);
				СтруктураСтроки.Вставить("СчетДт", НужнаяСтр.СчетДт);
				СтруктураСтроки.Вставить("СубконтоДт1", НужнаяСтр.СубконтоДт1);
				СтруктураСтроки.Вставить("СубконтоДт2", НужнаяСтр.СубконтоДт2);
				СтруктураСтроки.Вставить("СубконтоДт3", НужнаяСтр.СубконтоДт3);
				ВРМассив = ОсновныеНачисления.НайтиСтроки(СтруктураСтроки);
				Если ВРМассив.Количество() = 0 Тогда
					ВРМассив = ДополнительныеНачисления.НайтиСтроки(СтруктураСтроки);
					Если ВрМассив.Количество() = 0 Тогда
						Продолжить;
					КонецЕсли;
				КонецЕсли;
				Удаляем = Истина;
				Для Каждого Эл Из ВРМассив Цикл
					ВР = Эл.ВидРасчета;
					Если ВР.ОтчисленияНаППС = Перечисления.ДоходыФСС_НС.Облагается Тогда
						//НужныеСтрокиОтражениеВБУ.Удалить(-к);
						Удаляем = Ложь;
						Прервать;
					КонецЕсли;
				КонецЦикла;
				Если Удаляем Тогда
					НужныеСтрокиОтражениеВБУ.Удалить(-к);
				КонецЕсли;
				//Аверсон СВФР-009674
				
			КонецЦикла;
		КонецЕсли;
		
		//НужныеСтрокиТЗБазаРаспрДобавленные = ТЗБазаРаспрДобавленные.НайтиСтроки(СтруктураОтбора);
		ТЗБазаПоСчетам = ОтражениеВБУДляБазы.Скопировать();
		
		//Удалим строки с 97 счетом
		Кол = ТЗБазаПоСчетам.Количество();
		Если Кол > 0 Тогда
			ПоследнийИнд = Кол - 1;
			Для к = -ПоследнийИнд По 0 Цикл
				НужнаяСтр = ТЗБазаПоСчетам[-к];
				Если НужнаяСтр.СчетДт_ДляПодстановки.ПринадлежитЭлементу(ПланыСчетов.Хозрасчетный.РасходыБудущихПериодов) Тогда
					ТЗБазаПоСчетам.Удалить(НужнаяСтр);
					Продолжить;
				КонецЕсли;
				
				//Аверсон ЕАЕ 26.10.2022 СВФР-009674
				//Удалим строки, по которым в виде расчета Отчисления на ППС "Не облагается"
				
				//СтруктураСтроки = Новый Структура;
				//СтруктураСтроки.Вставить("ФизЛицо", НужнаяСтр.ФизЛицо);
				//СтруктураСтроки.Вставить("СчетДт", НужнаяСтр.СчетДт);
				//СтруктураСтроки.Вставить("СубконтоДт1", НужнаяСтр.СубконтоДт1);
				//СтруктураСтроки.Вставить("СубконтоДт2", НужнаяСтр.СубконтоДт2);
				//СтруктураСтроки.Вставить("СубконтоДт3", НужнаяСтр.СубконтоДт3);
				//ВРМассив = ОсновныеНачисления.НайтиСтроки(СтруктураСтроки);
				//Если ВРМассив.Количество() = 0 Тогда
				//	ВРМассив = ДополнительныеНачисления.НайтиСтроки(СтруктураСтроки);
				//	Если ВрМассив.Количество() = 0 Тогда
				//		Продолжить;
				//	КонецЕсли;
				//КонецЕсли;
				//Для Каждого Эл Из 
				//ВР = ВРМассив[0].ВидРасчета;
				//Если ВР.ОтчисленияНаППС = Перечисления.ДоходыФСС_НС.НеОблагается Тогда
				//	ТЗБазаПоСчетам.Удалить(НужнаяСтр);
				//КонецЕсли;
				ВР = НужнаяСтр.ВидРасчета;
				Если ВР.ОтчисленияНаППС = Перечисления.ДоходыФСС_НС.НеОблагается Тогда
					ТЗБазаПоСчетам.Удалить(НужнаяСтр);
				КонецЕсли;
				//Аверсон СВФР-009674
			КонецЦикла;
		КонецЕсли;
		
		//ТЗОтпускаБудущихПериодов
		ТЗОтпускаБудущихПериодов = ПолучитьТЗОтпускаБудущихПериодов();
		Для Каждого СтрОтп Из ТЗОтпускаБудущихПериодов Цикл
			НоваяСтр = ТЗБазаПоСчетам.Добавить();
			НоваяСтр.ФизЛицо = СтрОтп.ФизЛицо;
			НоваяСтр.СчетДт_ДляПодстановки = СтрОтп.СчетДт;
			НоваяСтр.СубконтоДт1_ДляПодстановки = СтрОтп.СубконтоДт1;
			НоваяСтр.СубконтоДт2_ДляПодстановки = СтрОтп.СубконтоДт2;
			НоваяСтр.СубконтоДт3_ДляПодстановки = СтрОтп.СубконтоДт3;
			НоваяСтр.БазаФСЗН = СтрОтп.Результат;
		КонецЦикла;
		//////////////////////////
		
		ТЗБазаПоСчетам.Свернуть("ФизЛицо,СчетДт_ДляПодстановки,СубконтоДт1_ДляПодстановки,СубконтоДт2_ДляПодстановки,СубконтоДт3_ДляПодстановки", "БазаФСЗН");
		ТЗБазаОбщая = ТЗБазаПоСчетам.Скопировать();
		ТЗБазаОбщая.Свернуть("ФизЛицо", "БазаФСЗН");
		
		Распределили = 0;
		н = 0;
		Для Каждого СтрОтражениеВБУ Из НужныеСтрокиОтражениеВБУ Цикл
			
			Строка = ОтражениеВУчете.Добавить();
			
			Строка.СчетДт = СтрОтражениеВБУ.СчетДт;
			Строка.СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
			Строка.СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2;
			Строка.СубконтоДт3 = СтрОтражениеВБУ.СубконтоДт3;
			
			
			СчетКт = РегистрыСведений.ТарифыВзносовНаППС.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ВидДеятельности",Выборка.ВидДеятельности));
			Строка.СчетКт = СчетКт.СчетБУ;
			СубконтоКредита = Перечисления.ВидыПлатежейВГосБюджет.Налог;
			Строка.СубконтоКт1 = СубконтоКредита;
			
			Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ППС;
			
			//Строка.СчетДтНУ = СтрОтражениеВБУ.СчетДтНУ;
			//Строка.СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
			//Строка.СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2;
			//Строка.СубконтоДт3 = СтрОтражениеВБУ.СубконтоДт3;
			//Строка.СчетКтНУ = СчетКт.СчетНУ;
			Если н = НужныеСтрокиОтражениеВБУ.Количество() - 1 Тогда
				СуммаВПроводку = СуммаРаспределения - Распределили;
			Иначе
				НужнаяСтрокаБазаОбщаяДляППС = ТЗБазаОбщая.Найти(Выборка.ФизЛицо);
				Если НужнаяСтрокаБазаОбщаяДляППС <> Неопределено Тогда
					БазаОбщаяДляППС = НужнаяСтрокаБазаОбщаяДляППС.БазаФСЗН;
				Иначе
					БазаОбщаяДляППС = 0;
				КонецЕсли;
				СтруктураОтбораБазаПоСчетам = Новый Структура;
				СтруктураОтбораБазаПоСчетам.Вставить("ФизЛицо", Выборка.ФизЛицо);
				СтруктураОтбораБазаПоСчетам.Вставить("СчетДт_ДляПодстановки", СтрОтражениеВБУ.СчетДт);
				СтруктураОтбораБазаПоСчетам.Вставить("СубконтоДт1_ДляПодстановки", СтрОтражениеВБУ.СубконтоДт1);
				СтруктураОтбораБазаПоСчетам.Вставить("СубконтоДт2_ДляПодстановки", СтрОтражениеВБУ.СубконтоДт2);
				СтруктураОтбораБазаПоСчетам.Вставить("СубконтоДт3_ДляПодстановки", СтрОтражениеВБУ.СубконтоДт3);
				
				НужныеСтрокаБазаПоСчету = ТЗБазаПоСчетам.НайтиСтроки(СтруктураОтбораБазаПоСчетам);
				Если НужныеСтрокаБазаПоСчету.Количество() > 0 Тогда
					БазаПоСчету = НужныеСтрокаБазаПоСчету[0].БазаФСЗН;
				Иначе
					БазаПоСчету = 0;
				КонецЕсли;
				Если БазаОбщаяДляППС = 0 Тогда
					СуммаВПроводку = 0;
				Иначе
					СуммаВПроводку = Окр(СуммаРаспределения * БазаПоСчету / БазаОбщаяДляППС,2);
				КонецЕсли;
				Распределили = Распределили + СуммаВПроводку;
			КонецЕсли;
			Строка.Сумма = СуммаВПроводку;
			н = н + 1;
		КонецЦикла;
		//Аверсон СВФР-009450
		
		
	КонецЦикла;
	// О.Т. 28.10.2014 259
	// конец доходы ППС
	//////////////////////////////////////////////////////////////////////////////////////////////////
	
	//Аверсон ЕАЕ 25.08.2022 СВФР-009478
	//Доп.пенсия
	
	//Если Организация.УчетДополнительнойПенсии Тогда
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДополнительнаяПенсияОбороты.Сотрудник.Физлицо КАК Физлицо,
	|	СУММА(ДополнительнаяПенсияОбороты.СуммаРаботодателяОборот) КАК Сумма
	|ИЗ
	|	РегистрНакопления.ДополнительнаяПенсия.Обороты(&НачалоПериода, &КонецПериода, Авто, ) КАК ДополнительнаяПенсияОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	ДополнительнаяПенсияОбороты.Сотрудник.Физлицо";
	
	Запрос.УстановитьПараметр("КонецПериода", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("НачалоПериода", НачалоМесяца(ПериодРегистрации));
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		СуммаРаспределения = ВыборкаДетальныеЗаписи.Сумма;
		СтруктураОтбора = Новый Структура;
		СтруктураОтбора.Вставить("ФизЛицо", ВыборкаДетальныеЗаписи.ФизЛицо);
		
		ОтражениеВБУКопия = ОтражениеВБУ.Скопировать();
		Если ОтражениеВБУКопия.Колонки.Количество() = 0 Тогда
			ОтражениеВБУКопия.Колонки.Добавить("ФизЛицо");
			ОтражениеВБУКопия.Колонки.Добавить("СчетДт");
			ОтражениеВБУКопия.Колонки.Добавить("СубконтоДт1");
			ОтражениеВБУКопия.Колонки.Добавить("СубконтоДт2");
			ОтражениеВБУКопия.Колонки.Добавить("СубконтоДт3");
			//ОтражениеВБУКопия.Колонки.Добавить("БазаФСЗН");
		КонецЕсли;
		ТЗОтпускаБудущихПериодов = ПолучитьТЗОтпускаБудущихПериодов();
		Для Каждого СтрОтп Из ТЗОтпускаБудущихПериодов Цикл
			НоваяСтр = ОтражениеВБУКопия.Добавить();
			НоваяСтр.ФизЛицо = СтрОтп.ФизЛицо;
			НоваяСтр.СчетДт = СтрОтп.СчетДт;
			НоваяСтр.СубконтоДт1 = СтрОтп.СубконтоДт1;
			НоваяСтр.СубконтоДт2 = СтрОтп.СубконтоДт2;
			НоваяСтр.СубконтоДт3 = СтрОтп.СубконтоДт3;
			//НоваяСтр.БазаФСЗН = СтрОтп.Результат;
		КонецЦикла;
		
		//Аверсон ЕАЕ 20.12.2022 СВФР-010043
		ОтражениеВБУКопия.Свернуть("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3");
		//Аверсон СВФР-010043
		
		НужныеСтрокиОтражениеВБУ = ОтражениеВБУКопия.НайтиСтроки(СтруктураОтбора);
		
		//Удалим строки с 97 счетом
		Кол = НужныеСтрокиОтражениеВБУ.Количество();
		Если Кол > 0 Тогда
			ПоследнийИнд = Кол - 1;
			Для к = -ПоследнийИнд По 0 Цикл
				НужнаяСтр = НужныеСтрокиОтражениеВБУ[-к];
				Если НужнаяСтр.СчетДт.ПринадлежитЭлементу(ПланыСчетов.Хозрасчетный.РасходыБудущихПериодов) Тогда
					НужныеСтрокиОтражениеВБУ.Удалить(-к);	
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		//НужныеСтрокиТЗБазаРаспрДобавленные = ТЗБазаРаспрДобавленные.НайтиСтроки(СтруктураОтбора);
		ТЗБазаПоСчетам = ОтражениеВБУДляБазы.Скопировать();
		
		//Удалим строки с 97 счетом
		Кол = ТЗБазаПоСчетам.Количество();
		Если Кол > 0 Тогда
			ПоследнийИнд = Кол - 1;
			Для к = -ПоследнийИнд По 0 Цикл
				НужнаяСтр = ТЗБазаПоСчетам[-к];
				Если НужнаяСтр.СчетДт_ДляПодстановки.ПринадлежитЭлементу(ПланыСчетов.Хозрасчетный.РасходыБудущихПериодов) Тогда
					ТЗБазаПоСчетам.Удалить(НужнаяСтр);	
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		//ТЗОтпускаБудущихПериодов
		//ТЗОтпускаБудущихПериодов = ПолучитьТЗОтпускаБудущихПериодов();
		
		Если ТЗБазаПоСчетам.Колонки.Количество() = 0 Тогда
			ТЗБазаПоСчетам.Колонки.Добавить("ФизЛицо");
			ТЗБазаПоСчетам.Колонки.Добавить("СчетДт_ДляПодстановки");
			ТЗБазаПоСчетам.Колонки.Добавить("СубконтоДт1_ДляПодстановки");
			ТЗБазаПоСчетам.Колонки.Добавить("СубконтоДт2_ДляПодстановки");
			ТЗБазаПоСчетам.Колонки.Добавить("СубконтоДт3_ДляПодстановки");
			ТЗБазаПоСчетам.Колонки.Добавить("БазаФСЗН");
		КонецЕсли;
		
		Для Каждого СтрОтп Из ТЗОтпускаБудущихПериодов Цикл
			Если не ЭтоПодстановка97Счета Тогда     //отпуска переходящие двоит 13.07.2023
				НоваяСтр = ТЗБазаПоСчетам.Добавить();
				НоваяСтр.ФизЛицо = СтрОтп.ФизЛицо;
				НоваяСтр.СчетДт_ДляПодстановки = СтрОтп.СчетДт;
				НоваяСтр.СубконтоДт1_ДляПодстановки = СтрОтп.СубконтоДт1;
				НоваяСтр.СубконтоДт2_ДляПодстановки = СтрОтп.СубконтоДт2;
				НоваяСтр.СубконтоДт3_ДляПодстановки = СтрОтп.СубконтоДт3;
				НоваяСтр.БазаФСЗН = СтрОтп.Результат;     
			КонецЕсли;		
		КонецЦикла;
		//////////////////////////
		
		ТЗБазаПоСчетам.Свернуть("ФизЛицо,СчетДт_ДляПодстановки,СубконтоДт1_ДляПодстановки,СубконтоДт2_ДляПодстановки,СубконтоДт3_ДляПодстановки", "БазаФСЗН");
		ТЗБазаОбщая = ТЗБазаПоСчетам.Скопировать();
		ТЗБазаОбщая.Свернуть("ФизЛицо", "БазаФСЗН");
		
		Распределили = 0;
		н = 0;
		Для Каждого СтрОтражениеВБУ Из НужныеСтрокиОтражениеВБУ Цикл
			
			Строка = ОтражениеВУчете.Добавить();
			
			Строка.СчетДт = СтрОтражениеВБУ.СчетДт;
			Строка.СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
			Строка.СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2;
			Строка.СубконтоДт3 = СтрОтражениеВБУ.СубконтоДт3;
			Если ОрганизацияИНН = "806000046" Тогда
				Если ВыборкаДетальныеЗаписи.ФизЛицо.ДНПС Тогда
					Если Лев(Строка.СчетДт,2) = "91" Тогда
						Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.04.5"); 
						Строка.СубконтоДт1 =  Справочники.ПрочиеДоходыИРасходы.НайтиПокоду("00000113");
						Строка.СубконтоДт2 =  СтрОтражениеВБУ.СубконтоДт2;
					Иначе
						Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.23.2"); 
						Строка.СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
						Строка.СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2;
						Строка.СубконтоДт3 = Справочники.Страхование_ВидыСтрахования.НайтиПоНаименованию("[Указ №367] Добровольное страхование дополнительной накопительной пенсии",истина);  
					КонецЕсли;  
				ИНаче
					Если СокрЛП(СтрОтражениеВБУ.СчетДт)= "77.10" или СокрЛП(СтрОтражениеВБУ.СчетДт)= "77.11" или лев(СокрЛП(СтрОтражениеВБУ.СчетДт),2)= "26" Тогда
						Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.23.1"); 
						Строка.СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
						Строка.СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2;
						Строка.СубконтоДт3 = Справочники.Страхование_ВидыСтрахования.НайтиПоНаименованию("[Указ №367] Добровольное страхование дополнительной накопительной пенсии",истина); 
					Иначе
						Строка.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.04.5"); 
						Строка.СубконтоДт1 =  Справочники.ПрочиеДоходыИРасходы.НайтиПокоду("00000113");
						//Строка.СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
						//Строка.СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2;
						//Строка.СубконтоДт3 = Справочники.Страхование_ВидыСтрахования.НайтиПоНаименованию("[Указ №367] Добровольное страхование дополнительной накопительной пенсии",истина); 
					КонецЕсли;
				КонецЕсли;     					
			КонецЕсли;				
			СчетКт = ПолучитьДанныеСчетаДопПенсии(Организация);
			Строка.СчетКт = СчетКт.Счет;
			Строка.СубконтоКт1 = СчетКт.Субконто1;
			Строка.СубконтоКт2 = СчетКт.Субконто2;
			Строка.СубконтоКт3 = СчетКт.Субконто3;
			
			Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ДПС;
			
			Если н = НужныеСтрокиОтражениеВБУ.Количество() - 1 Тогда
				СуммаВПроводку = СуммаРаспределения - Распределили;
			Иначе
				НужнаяСтрокаБазаОбщаяДляДопПенсии = ТЗБазаОбщая.Найти(ВыборкаДетальныеЗаписи.ФизЛицо);
				Если НужнаяСтрокаБазаОбщаяДляДопПенсии <> Неопределено Тогда
					БазаОбщаяДляДопПенсии = НужнаяСтрокаБазаОбщаяДляДопПенсии.БазаФСЗН;
				Иначе
					БазаОбщаяДляДопПенсии = 0;
				КонецЕсли;
				СтруктураОтбораБазаПоСчетам = Новый Структура;
				СтруктураОтбораБазаПоСчетам.Вставить("ФизЛицо", ВыборкаДетальныеЗаписи.ФизЛицо);
				СтруктураОтбораБазаПоСчетам.Вставить("СчетДт_ДляПодстановки", СтрОтражениеВБУ.СчетДт);
				СтруктураОтбораБазаПоСчетам.Вставить("СубконтоДт1_ДляПодстановки", СтрОтражениеВБУ.СубконтоДт1);
				СтруктураОтбораБазаПоСчетам.Вставить("СубконтоДт2_ДляПодстановки", СтрОтражениеВБУ.СубконтоДт2);
				СтруктураОтбораБазаПоСчетам.Вставить("СубконтоДт3_ДляПодстановки", СтрОтражениеВБУ.СубконтоДт3);
				
				НужныеСтрокаБазаПоСчету = ТЗБазаПоСчетам.НайтиСтроки(СтруктураОтбораБазаПоСчетам);
				Если НужныеСтрокаБазаПоСчету.Количество() > 0 Тогда
					БазаПоСчету = НужныеСтрокаБазаПоСчету[0].БазаФСЗН;
				Иначе
					БазаПоСчету = 0;
				КонецЕсли;
				Если БазаОбщаяДляДопПенсии = 0 Тогда
					СуммаВПроводку = 0;
				Иначе
					СуммаВПроводку = Окр(СуммаРаспределения * БазаПоСчету / БазаОбщаяДляДопПенсии,2);
				КонецЕсли;
				Распределили = Распределили + СуммаВПроводку;
			КонецЕсли;
			Строка.Сумма = СуммаВПроводку;
			Если ОрганизацияИНН = "806000046" и СуммаВПроводку <> 0  Тогда
				Подразделение = "";
				Если  ТипЗнч(СтрОтражениеВБУ.СубконтоДт1) =  Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
					Подразделение = СтрОтражениеВБУ.СубконтоДт1;
				ИначеЕсли ТипЗнч(СтрОтражениеВБУ.СубконтоДт2) =  Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
					Подразделение = СтрОтражениеВБУ.СубконтоДт2;   					
				ИначеЕсли ТипЗнч(СтрОтражениеВБУ.СубконтоДт3) =  Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
					Подразделение = СтрОтражениеВБУ.СубконтоДт3;
				КонецЕсли;
				Если ВыборкаДетальныеЗаписи.ФизЛицо.ДНПС и Лев(СтрОтражениеВБУ.СчетДт,2) = "26" Тогда  
					СчетДТ = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.09.2");   
					//СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
					//СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2;
					СубконтоДт1 = Подразделение;
					СубконтоДт2 = СтатьяЗатратФСЗН;  
				ИначеЕсли не ВыборкаДетальныеЗаписи.ФизЛицо.ДНПС и Лев(СтрОтражениеВБУ.СчетДт,2) = "26" Тогда  
					СчетДТ = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.09.1");
					//СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
					//СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2;
					СубконтоДт1 = Подразделение;
					СубконтоДт2 = СтатьяЗатратФСЗН;  
				ИначеЕсли СокрЛП(СтрОтражениеВБУ.СчетДт)= "77.10" или СокрЛП(СтрОтражениеВБУ.СчетДт)= "77.11" Тогда
					СчетДТ = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.09.1");
					//СубконтоДт1 = СтрОтражениеВБУ.СубконтоДт1;
					//СубконтоДт2 = СтрОтражениеВБУ.СубконтоДт2; 
					СубконтоДт1 = Подразделение;
					СубконтоДт2 = СтатьяЗатратФСЗН; 			
				Иначе   
					СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.04.5"); 
					//СубконтоДт1 =  Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию("страхование за счет предприятия ДНПС",истина);
					СубконтоДт1 =  Справочники.ПрочиеДоходыИРасходы.НайтиПокоду("00000113");
					СубконтоДт2 =  СтрОтражениеВБУ.СубконтоДт2; 
				КонецЕсли;
				Строка = ОтражениеВУчете.Добавить();
				
				Строка.СчетДт = СчетДт;
				Строка.СубконтоДт1 = СубконтоДт1;
				Строка.СубконтоДт2 = СубконтоДт2;
				Строка.СубконтоДт3 = СтрОтражениеВБУ.СубконтоДт3;
				
				Строка.СчетКт = СчетКтФСЗН;
				Строка.СубконтоКт1 = СубконтоКредита;
				Строка.СубконтоКт2 = Подразделение;//СтрОтражениеВБУ.СубконтоДт1;
				//Строка.СубконтоКт3 = СчетКт.Субконто3;
				Строка.Сумма = СуммаВПроводку;    
				Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
				Строка = ОтражениеВУчете.Добавить();
				Строка.СчетДт = СчетДт;
				Строка.СубконтоДт1 = СубконтоДт1;
				Строка.СубконтоДт2 = СубконтоДт2;
				Строка.СубконтоДт3 = СтрОтражениеВБУ.СубконтоДт3;
				
				СчетКт = ПолучитьДанныеСчетаДопПенсии(Организация);
				Строка.СчетКт = СчетКтФСЗН;
				Строка.СубконтоКт1 = СубконтоКредита;
				Строка.СубконтоКт2 = Подразделение;//СтрОтражениеВБУ.СубконтоДт1;
				//Строка.СубконтоКт3 = СчетКт.Субконто3;
				Строка.Сумма = -СуммаВПроводку;  
				Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
			КонецЕсли;     
			н = н + 1;
		КонецЦикла;
	КонецЦикла;
	
	//КонецЕсли;
	
	//конец Доп.пенсия
	//Аверсон СВФР-009478
	
	//////////////////////////////////////////////////////////////////////////////////////////////////
	// отражение погашения займов
	//
	
	ПогашениеЗаймовТекст = 
	"ВЫБРАТЬ
	|	СУММА(ВЫБОР
	|			КОГДА Погашение.ВидДвижения = &Расход
	|				ТОГДА Погашение.ОсновнойДолг
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ОсновнойДолг,
	|	СУММА(ВЫБОР
	|			КОГДА Погашение.ВидДвижения = &Расход
	|				ТОГДА Погашение.Проценты
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК ПроцентыУдержано,
	|	СУММА(ВЫБОР
	|			КОГДА Погашение.ВидДвижения = &Расход
	|				ТОГДА 0
	|			ИНАЧЕ Погашение.Проценты
	|		КОНЕЦ) КАК ПроцентыНачислено,
	|	Погашение.ФизЛицо,
	|	Погашение.ДоговорЗайма.СчетУчетаПроцентовПоЗайму,
	|	Погашение.ДоговорЗайма.Субконто1,
	|	Погашение.ДоговорЗайма.Субконто2,
	|	Погашение.ДоговорЗайма.Субконто3
	|ИЗ
	|	РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК Погашение
	|ГДЕ
	|	Погашение.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
	|	И Погашение.Организация = &парамОбособленноеПодразделение
	|	И Погашение.УдержаноИзЗарплаты";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		ПогашениеЗаймовТекст = ПогашениеЗаймовТекст +"	
		|		И Погашение.ФизЛицо В (&ФизЛицо)";
	КонецЕсли;
	ПогашениеЗаймовТекст = ПогашениеЗаймовТекст +"
	|
	|СГРУППИРОВАТЬ ПО
	|	Погашение.ФизЛицо,
	|	Погашение.ДоговорЗайма.СчетУчетаПроцентовПоЗайму,
	|	Погашение.ДоговорЗайма.Субконто1,
	|	Погашение.ДоговорЗайма.Субконто2,
	|	Погашение.ДоговорЗайма.Субконто3";
	
	Запрос = Новый Запрос(ПогашениеЗаймовТекст);
	
	Запрос.УстановитьПараметр("ФизЛицо",СписокФизЛицОбщая);
	Запрос.УстановитьПараметр("парамНачалоМесяца", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецМесяца", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("Расход", ВидДвиженияНакопления.Расход);
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	СчетДебета = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда;
	СчетКредита = ПланыСчетов.Хозрасчетный.РасчетыПоПредоставленнымЗаймам;
	
	Пока Выборка.Следующий() Цикл
		Если Выборка.ОсновнойДолг <> 0 Тогда
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 		= СчетДебета;
			Строка.СубконтоДт1 	= Выборка.Физлицо;
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Выборка.Физлицо;
			Строка.Сумма		= Выборка.ОсновнойДолг;
		КонецЕсли;
		
		Если Выборка.ПроцентыУдержано <> 0 Тогда
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 		= СчетДебета;
			Строка.СубконтоДт1 	= Выборка.Физлицо;
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Выборка.Физлицо;
			Строка.Сумма		= Выборка.ПроцентыУдержано;
		КонецЕсли;
		
		Если Выборка.ПроцентыНачислено <> 0 Тогда
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 		= СчетКредита;
			Строка.СубконтоДт1 	= Выборка.Физлицо;
			Строка.СчетКт 		= Выборка.ДоговорЗаймаСчетУчетаПроцентовПоЗайму;
			Строка.СубконтоКт1 	= Выборка.ДоговорЗаймаСубконто1;
			Строка.СубконтоКт2 	= Выборка.ДоговорЗаймаСубконто2;
			Строка.СубконтоКт3 	= Выборка.ДоговорЗаймаСубконто3;
			Строка.Сумма		= Выборка.ПроцентыНачислено;
		КонецЕсли;
		
	КонецЦикла;
	
	//О.Т. Аверсон 28.09.2017 № 1082  
	Если ОрганизацияИНН = "190288027" Тогда
		ЗапросАА = Новый Запрос;
		ЗапросАА.Текст = 
		"ВЫБРАТЬ
		|	ДанныеПоАмортизацииАвтомобилей.Регистратор.СтатьяЗатрат,
		|	СУММА(ДанныеПоАмортизацииАвтомобилей.СуммаНачисления) КАК СуммаНачисления,
		|	СУММА(ДанныеПоАмортизацииАвтомобилей.ПН) КАК ПН
		|ИЗ
		|	РегистрСведений.ДанныеПоАмортизацииАвтомобилей КАК ДанныеПоАмортизацииАвтомобилей
		|ГДЕ
		|	ДанныеПоАмортизацииАвтомобилей.Организация = &Организация
		|	И ДанныеПоАмортизацииАвтомобилей.Период МЕЖДУ &Период И &Период1";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			ЗапросАА.Текст = ЗапросАА.Текст +"	
			|		И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";
		КонецЕсли;
		ЗапросАА.Текст = ЗапросАА.Текст +"
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеПоАмортизацииАвтомобилей.Регистратор.СтатьяЗатрат";
		
		ЗапросАА.УстановитьПараметр("Организация", Организация);
		ЗапросАА.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
		
		ЗапросАА.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
		ЗапросАА.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
		
		РезультатЗапросаАА = ЗапросАА.Выполнить();
		
		ВыборкаДетальныеЗаписиАА = РезультатЗапросаАА.Выбрать();
		
		Пока ВыборкаДетальныеЗаписиАА.Следующий() Цикл
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 		= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СчетДт;
			Строка.СубконтоДт1 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоДт1;
			Строка.СубконтоДт2 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоДт2;
			Строка.СубконтоДт3 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоДт3;
			Строка.СчетДтНУ 		= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СчетДтНУ;
			Строка.СубконтоДтНУ1 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоДтНУ3;
			Строка.СчетКт 		= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СчетКт;
			Строка.СубконтоКт1 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКт1;
			Строка.СубконтоКт2 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКт2;
			Строка.СубконтоКт3 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКт3;
			Строка.СчетКтНУ 		= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СчетКтНУ;
			Строка.СубконтоКтНУ1 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКтНУ1;
			Строка.СубконтоКтНУ2 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКтНУ2;
			Строка.СубконтоКтНУ3 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКтНУ3;
			Строка.Сумма		= ВыборкаДетальныеЗаписиАА.СуммаНачисления;
			
			
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 		= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СчетКт;
			Строка.СубконтоДт1 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКт1;
			Строка.СубконтоДт2 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКт2;
			Строка.СубконтоДт3 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКт3;
			Строка.СчетДтНУ 		= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СчетКтНУ;
			Строка.СубконтоДтНУ1 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКтНУ1;
			Строка.СубконтоДтНУ2 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКтНУ2;
			Строка.СубконтоДтНУ3 	= ВыборкаДетальныеЗаписиАА.РегистраторСтатьяЗатрат.СубконтоКтНУ3;
			
			
			
			УчетнаяПолитикаЗапрос = Новый Запрос; 
			УчетнаяПолитикаЗапрос.Текст = 
			"ВЫБРАТЬ
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СчетУчетаНДФЛБУ,
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоНДФЛБУ1,
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоНДФЛБУ2,
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоНДФЛБУ3,
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СчетУчетаНДФЛНУ,
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоНДФЛНУ1,
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоНДФЛНУ2,
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоНДФЛНУ3
			|ИЗ
			|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
			|ГДЕ
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
			УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",Организация);
			УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выбрать();
			РасчетОтОбратного = Ложь;
			Пока УчетнаяПолитика.Следующий() Цикл 
				Строка.СчетКт 		= УчетнаяПолитика.СчетУчетаНДФЛБУ;
				Строка.СубконтоКт1 	= УчетнаяПолитика.СубконтоНДФЛБУ1;
				Строка.СубконтоКт2 	= УчетнаяПолитика.СубконтоНДФЛБУ2;
				Строка.СубконтоКт3 	= УчетнаяПолитика.СубконтоНДФЛБУ3;
				Строка.СчетКтНУ 		= УчетнаяПолитика.СчетУчетаНДФЛНУ;
				Строка.СубконтоКтНУ1 	= УчетнаяПолитика.СубконтоНДФЛНУ1;
				Строка.СубконтоКтНУ2 	= УчетнаяПолитика.СубконтоНДФЛНУ2;
				Строка.СубконтоКтНУ3 	= УчетнаяПолитика.СубконтоНДФЛНУ3;
				
			КонецЦикла;
			
			
			Строка.Сумма		= ВыборкаДетальныеЗаписиАА.ПН;
			
			
		КонецЦикла; 
	КонецЕсли;
	//О.Т. Аверсон 28.09.2017 № 1082
	
	////////////////////////////////////////////////////////////////////////////////////////////////
	Если (ОрганизацияИНН = "100010315" ИЛИ ОрганизацияИНН = "700176068" ИЛИ ОрганизацияИНН = "400230097" ИЛИ ОрганизацияИНН = "300000265" ИЛИ ОрганизацияИНН = "500158130" ИЛИ ОрганизацияИНН = "200400628") Тогда  //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
		
		ЗапросРезерв = Новый Запрос;
		ЗапросРезерв.Текст = 
		"ВЫБРАТЬ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СчетУчетаРезерваБУ,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваБУ1,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваБУ2,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваБУ3,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СчетУчетаРезерваНУ,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваНУ1,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваНУ2,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваНУ3
		|ИЗ
		|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
		|ГДЕ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
		
		ЗапросРезерв.УстановитьПараметр("Организация", Организация);
		
		РезультатРезерв = ЗапросРезерв.Выполнить().Выбрать();
		
		СчетУчетаРезерваБУ = Неопределено;
		Пока РезультатРезерв.Следующий() Цикл
			СчетУчетаРезерваБУ = РезультатРезерв.СчетУчетаРезерваБУ;
			СубконтоРезерваБУ1 = РезультатРезерв.СубконтоРезерваБУ1;
			СубконтоРезерваБУ2 = РезультатРезерв.СубконтоРезерваБУ2;
			СубконтоРезерваБУ3 = РезультатРезерв.СубконтоРезерваБУ3;
			СчетУчетаРезерваНУ = РезультатРезерв.СчетУчетаРезерваНУ;
			СубконтоРезерваНУ1 = РезультатРезерв.СубконтоРезерваНУ1;
			СубконтоРезерваНУ2 = РезультатРезерв.СубконтоРезерваНУ2;
			СубконтоРезерваНУ3 = РезультатРезерв.СубконтоРезерваНУ3;
		КонецЦикла;
		Резерв = Справочники.Резервы.ПустаяСсылка();
		Если ТипЗнч(СубконтоРезерваБУ1) = Тип("СправочникСсылка.Резервы") тогда
			Резерв = СубконтоРезерваБУ1;
		ИначеЕсли ТипЗнч(СубконтоРезерваБУ2) = Тип("СправочникСсылка.Резервы") тогда
			Резерв = СубконтоРезерваБУ2;
		ИначеЕсли ТипЗнч(СубконтоРезерваБУ3) = Тип("СправочникСсылка.Резервы") тогда
			Резерв = СубконтоРезерваБУ3;
		КонецЕсли;
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ВложенныйЗапрос.Сотрудник,
		|	ВложенныйЗапрос.Результат КАК Сумма,
		|	ВложенныйЗапрос.СчетДт,
		|	ВложенныйЗапрос.СубконтоДт1,
		|	ВложенныйЗапрос.СубконтоДт2,
		|	ВложенныйЗапрос.СубконтоДт3,
		|	ВложенныйЗапрос.СчетДтНУ,
		|	ВложенныйЗапрос.СубконтоДтНУ1,
		|	ВложенныйЗапрос.СубконтоДтНУ2,
		|	ВложенныйЗапрос.СубконтоДтНУ3
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВложенныйЗапрос.Сотрудник КАК Сотрудник,
		|		ВложенныйЗапрос.СчетДт КАК СчетДт,
		|		ВложенныйЗапрос.СубконтоДт1 КАК СубконтоДт1,
		|		ВложенныйЗапрос.СубконтоДт2 КАК СубконтоДт2,
		|		ВложенныйЗапрос.СубконтоДт3 КАК СубконтоДт3,
		|		СУММА(ВложенныйЗапрос.Результат) КАК Результат,
		|		ВложенныйЗапрос.Организация КАК Организация,
		|		ВложенныйЗапрос.СчетДтНУ КАК СчетДтНУ,
		|		ВложенныйЗапрос.СубконтоДтНУ1 КАК СубконтоДтНУ1,
		|		ВложенныйЗапрос.СубконтоДтНУ2 КАК СубконтоДтНУ2,
		|		ВложенныйЗапрос.СубконтоДтНУ3 КАК СубконтоДтНУ3
		|	ИЗ
		|		(ВЫБРАТЬ
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник КАК Сотрудник,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета КАК ВидРасчета,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт КАК СчетДт,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1 КАК СубконтоДт1,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2 КАК СубконтоДт2,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3 КАК СубконтоДт3,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Результат КАК Результат,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.Организация КАК Организация,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДтНУ КАК СчетДтНУ,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3
		|		ИЗ
		|			Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
		|		ГДЕ
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка = &Ссылка";
		Запрос.Текст = Запрос.Текст +"
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Сотрудник,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ВидРасчета,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДт,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт1,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт2,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт3,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Результат,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка.Организация,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДтНУ,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ1,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ2,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ3
		|		ИЗ
		|			Документ.ОтражениеЗарплатыВРеглУчете.ДополнительныеНачисления КАК ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления
		|		ГДЕ
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка = &Ссылка";
		Запрос.Текст = Запрос.Текст +") КАК ВложенныйЗапрос
		|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Резервы.БазовыеВидыРасчета КАК РезервыБазовыеВидыРасчета
		|			ПО ВложенныйЗапрос.ВидРасчета = РезервыБазовыеВидыРасчета.ВидРасчета
		|	ГДЕ
		|		РезервыБазовыеВидыРасчета.Ссылка = &Резерв
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВложенныйЗапрос.Сотрудник,
		|		ВложенныйЗапрос.СчетДт,
		|		ВложенныйЗапрос.СубконтоДт1,
		|		ВложенныйЗапрос.СубконтоДт2,
		|		ВложенныйЗапрос.СубконтоДт3,
		|		ВложенныйЗапрос.Организация,
		|		ВложенныйЗапрос.СубконтоДтНУ1,
		|		ВложенныйЗапрос.СубконтоДтНУ3,
		|		ВложенныйЗапрос.СчетДтНУ,
		|		ВложенныйЗапрос.СубконтоДтНУ2) КАК ВложенныйЗапрос";
		
		Запрос.УстановитьПараметр("Ссылка", Ссылка);
		
		Запрос.УстановитьПараметр("Резерв", Резерв);
		Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
		ТЗРезультатЗапросаРезерв= Запрос.Выполнить().Выгрузить();      		
		ТЗРезультатЗапросаРезерв.Свернуть("Сотрудник,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3","Сумма");  		
		ЗначениеРезерва = РегистрыСведений.РазмерыОтчисленийВРезервы.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("Резерв",Резерв)).Размер;
		ТаблицаРезультатЗапросаРезерв = Новый ТаблицаЗначений;  
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("СчетДт");
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("СубконтоДт1");
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("СубконтоДт2");
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("СубконтоДт3");
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("СчетКт");
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("СубконтоКт1"); 
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("Сумма"); 
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("СуммаФСЗН");
		ТаблицаРезультатЗапросаРезерв.Колонки.Добавить("СуммаБГС");
		
		
		
		Для Каждого РезультатЗапросаРезерв из ТЗРезультатЗапросаРезерв Цикл 
			РезультатПоИнвалидам = ПроверкаФизлицоНаИнвалидность(РезультатЗапросаРезерв.Сотрудник.ФизЛицо).Выгрузить();
			Если РезультатПоИнвалидам.Количество() = 0 Тогда
				РезультатПоИнвалидам = Ложь;
			ИначеЕсли  РезультатПоИнвалидам[0].Группа = 1 Тогда
				РезультатПоИнвалидам = Истина;
			Иначе
				РезультатПоИнвалидам = Ложь;
			КонецЕсли;
			Если РезультатЗапросаРезерв.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
				ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
			иначе
				ВидНалогообложения = РезультатЗапросаРезерв.Сотрудник.ВидНалогообложенияОсновной;
			КонецЕсли;
			СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).Размер;
			СтавкаФСЗНИнвалиды = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды,ВидНалогообложения)).Размер; 
			СтавкаСтрах = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Ставка;
			
			СтрОтбора = Новый Структура;
			СтрОтбора.Вставить("Сотрудник", РезультатЗапросаРезерв.Сотрудник);
			СтрОтбора.Вставить("ВидНалогообложения", ВидНалогообложения);
			РезИндСтавкаНалогообл = ТЗРезИндСтавкаНалогообл.НайтиСтроки(СтрОтбора);
			
			ЕстьИндивидСтавка = Ложь;
			СтавкаФСЗНИнд = 0;
			СтавкаБГСИнд = 0;
			Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
				ЕстьИндивидСтавка = Истина;
				СтавкаФСЗНИнд = РезИндСтавкаНалогообл[0].ФСЗН;
				СтавкаБГСИнд = РезИндСтавкаНалогообл[0].БГС;
			КонецЕсли;
			
			Если ЕстьИндивидСтавка Тогда 
				СтавкаФСЗН = СтавкаФСЗНИнд;
				СтавкаФСЗНИнвалиды = СтавкаФСЗНИнд;
				СтавкаСтрах = СтавкаБГСИнд;
			КонецЕсли;		
			
			СуммаРезерва = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(РезультатЗапросаРезерв.Сумма *ЗначениеРезерва / 100,,ТочностьРасчетов);
			Если РезультатПоИнвалидам Тогда
				СуммаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(СуммаРезерва *СтавкаФСЗНИнвалиды / 100,,ТочностьРасчетов); 
			Иначе
				СуммаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(СуммаРезерва *СтавкаФСЗН / 100,,ТочностьРасчетов); 
			КонецЕсли; 
			СуммаБГС =  ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(СуммаРезерва *СтавкаСтрах / 100,,ТочностьРасчетов); 
			Строка = ТаблицаРезультатЗапросаРезерв.Добавить();        
			Строка.СчетДт= РезультатЗапросаРезерв.СчетДт;
			Строка.СубконтоДт1= РезультатЗапросаРезерв.СубконтоДт1;
			Строка.СубконтоДт2= РезультатЗапросаРезерв.СубконтоДт2;
			Строка.СубконтоДт3= РезультатЗапросаРезерв.СубконтоДт3;
			Строка.СчетКт= СчетУчетаРезерваБУ;
			Строка.СубконтоКт1= СубконтоРезерваБУ1;
			Строка.Сумма= СуммаРезерва;
			Строка.СуммаФСЗН= СуммаФСЗН;
			Строка.СуммаБГС= СуммаБГС;
		КонецЦикла;  
		ТаблицаРезультатЗапросаРезерв.Свернуть("СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетКт,СубконтоКт1","Сумма,СуммаФСЗН,СуммаБГС");  		
		Для Каждого РезультатЗапросаРезерв из ТаблицаРезультатЗапросаРезерв Цикл   
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
			Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
			Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
			Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
			Строка.СчетКт 			= РезультатЗапросаРезерв.СчетКт;
			Строка.СубконтоКт1	 	= РезультатЗапросаРезерв.СубконтоКт1;
			Строка.Сумма			= РезультатЗапросаРезерв.сумма; 
			Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.Начисление; 			
			Если РезультатЗапросаРезерв.СуммаФСЗН <> 0 Тогда
				Строка = ОтражениеВУчете.Добавить();
				Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
				Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
				Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
				Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
				Строка.СчетКт 			= РезультатЗапросаРезерв.СчетКт;
				Строка.СубконтоКт1	 	= СубконтоРезервФСЗН;
				Строка.Сумма			= РезультатЗапросаРезерв.СуммаФСЗН; 
				Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
			КонецЕсли;
			Если РезультатЗапросаРезерв.СуммаБГС <> 0 Тогда
				Строка = ОтражениеВУчете.Добавить();
				Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
				Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
				Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
				Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
				Строка.СчетКт 			= РезультатЗапросаРезерв.СчетКт;
				Строка.СубконтоКт1	 	= СубконтоРезервБГС;
				Строка.Сумма			= РезультатЗапросаРезерв.СуммаБГС; 
				Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.ОбязательноеСтрахование;
			КонецЕсли; 
		КонецЦикла;  		
	КонецЕсли;
	
	////////////////////////////////////////////////////////////////////////////////////////////////
	//О.Т. Аверсон 21.12.2017 № 1351
	// Отражение проводок по резерву
	Если ОрганизацияИНН = "100036784" Тогда 
		
		ЗапросРезерв = Новый Запрос;
		ЗапросРезерв.Текст = 
		"ВЫБРАТЬ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СчетУчетаРезерваБУ,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваБУ1,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваБУ2,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваБУ3,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СчетУчетаРезерваНУ,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваНУ1,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваНУ2,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваНУ3
		|ИЗ
		|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
		|ГДЕ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
		
		ЗапросРезерв.УстановитьПараметр("Организация", Организация);
		
		РезультатРезерв = ЗапросРезерв.Выполнить().Выбрать();
		
		СчетУчетаРезерваБУ = Неопределено;
		Пока РезультатРезерв.Следующий() Цикл
			СчетУчетаРезерваБУ = РезультатРезерв.СчетУчетаРезерваБУ;
			СубконтоРезерваБУ1 = РезультатРезерв.СубконтоРезерваБУ1;
			СубконтоРезерваБУ2 = РезультатРезерв.СубконтоРезерваБУ2;
			СубконтоРезерваБУ3 = РезультатРезерв.СубконтоРезерваБУ3;
			СчетУчетаРезерваНУ = РезультатРезерв.СчетУчетаРезерваНУ;
			СубконтоРезерваНУ1 = РезультатРезерв.СубконтоРезерваНУ1;
			СубконтоРезерваНУ2 = РезультатРезерв.СубконтоРезерваНУ2;
			СубконтоРезерваНУ3 = РезультатРезерв.СубконтоРезерваНУ3;
		КонецЦикла;
		Резерв = Справочники.Резервы.ПустаяСсылка();
		Если ТипЗнч(СубконтоРезерваБУ1) = Тип("СправочникСсылка.Резервы") тогда
			Резерв = СубконтоРезерваБУ1;
		ИначеЕсли ТипЗнч(СубконтоРезерваБУ2) = Тип("СправочникСсылка.Резервы") тогда
			Резерв = СубконтоРезерваБУ2;
		ИначеЕсли ТипЗнч(СубконтоРезерваБУ3) = Тип("СправочникСсылка.Резервы") тогда
			Резерв = СубконтоРезерваБУ3;
		КонецЕсли;
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		//"ВЫБРАТЬ
		//|	ВложенныйЗапрос.Сотрудник,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
		//|	КОНЕЦ КАК СчетДт,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
		//|	КОНЕЦ КАК СубконтоДт1,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
		//|	КОНЕЦ КАК СубконтоДт2,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
		//|	КОНЕЦ КАК СубконтоДт3,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
		//|	КОНЕЦ КАК СчетДтНУ,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
		//|	КОНЕЦ КАК СубконтоДтНУ1,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
		//|	КОНЕЦ КАК СубконтоДтНУ2,
		//|	ВЫБОР
		//|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
		//|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
		//|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
		//|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
		//|	КОНЕЦ КАК СубконтоДтНУ3,
		//|	ВложенныйЗапрос.СчетКт,
		//|	ВложенныйЗапрос.СубконтоКт1,
		//|	ВложенныйЗапрос.СубконтоКт2,
		//|	ВложенныйЗапрос.СубконтоКт3,
		//|	ВложенныйЗапрос.СчетКтНУ,
		//|	ВложенныйЗапрос.СубконтоКтНУ1,
		//|	ВложенныйЗапрос.СубконтоКтНУ2,
		//|	ВложенныйЗапрос.СубконтоКтНУ3,
		//|	ВложенныйЗапрос.ВидРасчета,
		//|	ВложенныйЗапрос.Результат как Сумма
		//|ИЗ
		//|	(ВЫБРАТЬ
		//|		ВложенныйЗапрос.Сотрудник КАК Сотрудник,
		//|		ВложенныйЗапрос.ВидРасчета КАК ВидРасчета,
		//|		ВложенныйЗапрос.СчетДт КАК СчетКт,
		//|		ВложенныйЗапрос.СубконтоДт1 КАК СубконтоКт1,
		//|		ВложенныйЗапрос.СубконтоДт2 КАК СубконтоКт2,
		//|		ВложенныйЗапрос.СубконтоДт3 КАК СубконтоКт3,
		//|		СУММА(ВложенныйЗапрос.Результат) КАК Результат,
		//|		ВложенныйЗапрос.Организация КАК Организация,
		//|		РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		//|		ВложенныйЗапрос.СчетДтНУ КАК СчетКтНУ,
		//|		ВложенныйЗапрос.СубконтоДтНУ1 КАК СубконтоКтНУ1,
		//|		ВложенныйЗапрос.СубконтоДтНУ2 КАК СубконтоКтНУ2,
		//|		ВложенныйЗапрос.СубконтоДтНУ3 КАК СубконтоКтНУ3
		//|	ИЗ
		//|		(ВЫБРАТЬ
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник КАК Сотрудник,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета КАК ВидРасчета,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт КАК СчетДт,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1 КАК СубконтоДт1,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2 КАК СубконтоДт2,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3 КАК СубконтоДт3,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Результат КАК Результат,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.Организация КАК Организация,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДтНУ КАК СчетДтНУ,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2,
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3
		//|		ИЗ
		//|			Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
		//|		ГДЕ
		//|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка = &Ссылка
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Сотрудник,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ВидРасчета,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДт,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт1,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт2,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт3,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Результат,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка.Организация,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДтНУ,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ1,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ2,
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ3
		//|		ИЗ
		//|			Документ.ОтражениеЗарплатыВРеглУчете.ДополнительныеНачисления КАК ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления
		//|		ГДЕ
		//|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка = &Ссылка) КАК ВложенныйЗапрос
		//|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Резервы.БазовыеВидыРасчета КАК РезервыБазовыеВидыРасчета
		//|			ПО ВложенныйЗапрос.ВидРасчета = РезервыБазовыеВидыРасчета.ВидРасчета
		//|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних КАК РаботникиОрганизацийСрезПоследних
		//|			ПО ВложенныйЗапрос.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
		//|	ГДЕ
		//|		РезервыБазовыеВидыРасчета.Ссылка = &Резерв
		//|	
		//|	СГРУППИРОВАТЬ ПО
		//|		ВложенныйЗапрос.Сотрудник,
		//|		ВложенныйЗапрос.ВидРасчета,
		//|		ВложенныйЗапрос.СчетДт,
		//|		ВложенныйЗапрос.СубконтоДт1,
		//|		ВложенныйЗапрос.СубконтоДт2,
		//|		ВложенныйЗапрос.СубконтоДт3,
		//|		ВложенныйЗапрос.Организация,
		//|		РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
		//|		ВложенныйЗапрос.СубконтоДтНУ1,
		//|		ВложенныйЗапрос.СубконтоДтНУ3,
		//|		ВложенныйЗапрос.СчетДтНУ,
		//|		ВложенныйЗапрос.СубконтоДтНУ2) КАК ВложенныйЗапрос
		//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&ПериодРегистрации, ) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
		//|		ПО ВложенныйЗапрос.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
		//|			И ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
		//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&ПериодРегистрации, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
		//|		ПО ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
		//|			И ВложенныйЗапрос.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации";
		
		"ВЫБРАТЬ
		|	ВложенныйЗапрос.Сотрудник,
		|	ВложенныйЗапрос.Результат КАК Сумма,
		|	ВложенныйЗапрос.СчетДт,
		|	ВложенныйЗапрос.СубконтоДт1,
		|	ВложенныйЗапрос.СубконтоДт2,
		|	ВложенныйЗапрос.СубконтоДт3,
		|	ВложенныйЗапрос.СчетДтНУ,
		|	ВложенныйЗапрос.СубконтоДтНУ1,
		|	ВложенныйЗапрос.СубконтоДтНУ2,
		|	ВложенныйЗапрос.СубконтоДтНУ3
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВложенныйЗапрос.Сотрудник КАК Сотрудник,
		|		ВложенныйЗапрос.СчетДт КАК СчетДт,
		|		ВложенныйЗапрос.СубконтоДт1 КАК СубконтоДт1,
		|		ВложенныйЗапрос.СубконтоДт2 КАК СубконтоДт2,
		|		ВложенныйЗапрос.СубконтоДт3 КАК СубконтоДт3,
		|		СУММА(ВложенныйЗапрос.Результат) КАК Результат,
		|		ВложенныйЗапрос.Организация КАК Организация,
		|		ВложенныйЗапрос.СчетДтНУ КАК СчетДтНУ,
		|		ВложенныйЗапрос.СубконтоДтНУ1 КАК СубконтоДтНУ1,
		|		ВложенныйЗапрос.СубконтоДтНУ2 КАК СубконтоДтНУ2,
		|		ВложенныйЗапрос.СубконтоДтНУ3 КАК СубконтоДтНУ3
		|	ИЗ
		|		(ВЫБРАТЬ
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник КАК Сотрудник,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета КАК ВидРасчета,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт КАК СчетДт,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1 КАК СубконтоДт1,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2 КАК СубконтоДт2,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3 КАК СубконтоДт3,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Результат КАК Результат,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.Организация КАК Организация,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДтНУ КАК СчетДтНУ,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2,
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3
		|		ИЗ
		|			Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
		//|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, ) КАК РаботникиОрганизацийСрезПоследних
		//|				ПО ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
		|		ГДЕ
		|			ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка = &Ссылка";
		//Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		//	Запрос.Текст = Запрос.Текст +"	
		//	|		И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";
		//КонецЕсли;
		Запрос.Текст = Запрос.Текст +"
		|		
		|		ОБЪЕДИНИТЬ ВСЕ
		|		
		|		ВЫБРАТЬ
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Сотрудник,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ВидРасчета,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДт,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт1,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт2,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт3,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Результат,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка.Организация,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДтНУ,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ1,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ2,
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДтНУ3
		|		ИЗ
		|			Документ.ОтражениеЗарплатыВРеглУчете.ДополнительныеНачисления КАК ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления
		//|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, ) КАК РаботникиОрганизацийСрезПоследних
		//|				ПО ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
		|		ГДЕ
		|			ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка = &Ссылка";
		//Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		//	Запрос.Текст = Запрос.Текст +"	
		//	|		И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";
		//КонецЕсли;
		Запрос.Текст = Запрос.Текст +") КАК ВложенныйЗапрос
		|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Резервы.БазовыеВидыРасчета КАК РезервыБазовыеВидыРасчета
		|			ПО ВложенныйЗапрос.ВидРасчета = РезервыБазовыеВидыРасчета.ВидРасчета
		|	ГДЕ
		|		РезервыБазовыеВидыРасчета.Ссылка = &Резерв
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ВложенныйЗапрос.Сотрудник,
		|		ВложенныйЗапрос.СчетДт,
		|		ВложенныйЗапрос.СубконтоДт1,
		|		ВложенныйЗапрос.СубконтоДт2,
		|		ВложенныйЗапрос.СубконтоДт3,
		|		ВложенныйЗапрос.Организация,
		|		ВложенныйЗапрос.СубконтоДтНУ1,
		|		ВложенныйЗапрос.СубконтоДтНУ3,
		|		ВложенныйЗапрос.СчетДтНУ,
		|		ВложенныйЗапрос.СубконтоДтНУ2) КАК ВложенныйЗапрос";
		
		Запрос.УстановитьПараметр("Ссылка", Ссылка);
		
		Запрос.УстановитьПараметр("Резерв", Резерв);
		Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
		//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
		//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
		//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2);
		//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
		//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетНУ", СпособПоУмолчанию.СчетДтНУ); 	
		//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
		//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
		//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
		//Запрос.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());   		
		
		ТЗРезультатЗапросаРезерв= Запрос.Выполнить().Выгрузить();
		
		ТЗРезультатЗапросаРезерв.Свернуть("СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3","Сумма");
		
		ЗначениеРезерва = РегистрыСведений.РазмерыОтчисленийВРезервы.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("Резерв",Резерв)).Размер;
		СтатьяЗатратРезерв = Справочники.СтатьиЗатрат.НайтиПоКоду("00000065");
		
		Для Каждого РезультатЗапросаРезерв из ТЗРезультатЗапросаРезерв Цикл 
			
			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
			//СуммаРезерва = ОбщегоНазначения.ОкруглитьЗначение2016(РезультатЗапросаРезерв.Сумма *ЗначениеРезерва / 100,ПериодРегистрации); 
			СуммаРезерва = ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(РезультатЗапросаРезерв.Сумма *ЗначениеРезерва / 100,,ТочностьРасчетов); 
			//Аверсон
			
			//Запрос = Новый Запрос;
			//Запрос.Текст = 
			//"ВЫБРАТЬ
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
			//|ИЗ
			//|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
			//|ГДЕ
			//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
			//|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник";
			//
			//Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
			//Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРегистрации));
			//Запрос.УстановитьПараметр("Сотрудник", РезультатЗапросаРезерв.Сотрудник);
			//
			//ТЗРаспределСчета = Запрос.Выполнить().Выгрузить();
			//Для Каждого СтрРаспр из ТЗРаспределСчета Цикл 
			
			
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
			Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
			Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
			Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
			Строка.СчетКт 			= СчетУчетаРезерваБУ;
			Строка.СубконтоКт1	 	= СубконтоРезерваБУ1;
			Строка.СубконтоКт2	 	= СубконтоРезерваБУ2;
			Строка.СубконтоКт3	 	= СубконтоРезерваБУ3;
			Строка.СчетДтНУ			= РезультатЗапросаРезерв.СчетДтНУ;
			Строка.СубконтоДтНУ1 	= РезультатЗапросаРезерв.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 	= РезультатЗапросаРезерв.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 	= РезультатЗапросаРезерв.СубконтоДтНУ3;		
			Строка.СчетКтНУ			= СчетУчетаРезерваНУ;
			Строка.СубконтоКтНУ1 	= СубконтоРезерваНУ1;
			Строка.СубконтоКтНУ2 	= СубконтоРезерваНУ2;
			Строка.СубконтоКтНУ3 	= СубконтоРезерваНУ3;
			Строка.Сумма			= СуммаРезерва; 
			Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.Начисление;
			Если ТипЗнч(Строка.СубконтоДт2) = Тип("СправочникСсылка.СтатьиЗатрат") Тогда
				Строка.СубконтоДт2	= СтатьяЗатратРезерв;
			ИначеЕсли ТипЗнч(Строка.СубконтоДт3) = Тип("СправочникСсылка.СтатьиЗатрат") Тогда
				Строка.СубконтоДт3	= СтатьяЗатратРезерв; 				
			КонецЕсли;
			//Строка.ВидРасчета       = РезультатЗапросаРезерв.ВидРасчета;
			
			// ФСЗН
			РезультатДляНалогов = Строка.Сумма;
			
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
			Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
			Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
			Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
			Строка.СчетДтНУ			= РезультатЗапросаРезерв.СчетДтНУ;
			Строка.СубконтоДтНУ1 	= РезультатЗапросаРезерв.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 	= РезультатЗапросаРезерв.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 	= РезультатЗапросаРезерв.СубконтоДтНУ3;
			//О.Т. Аверсон 19.07.2018 № 2240
			Строка.СчетКт = СчетУчетаРезерваБУ;
			Строка.СчетКтНУ = СчетУчетаРезерваНУ;
			
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	Резервы.Наименование,
			|	Резервы.Ссылка
			|ИЗ
			|	Справочник.Резервы КАК Резервы";
			
			РезультатЗапросаРезурв = Запрос.Выполнить().Выбрать();
			Пока РезультатЗапросаРезурв.Следующий() Цикл
				Если Найти(РезультатЗапросаРезурв.Наименование,"ФСЗН")> 0 Тогда 
					СубконтоРезерв = РезультатЗапросаРезурв.Ссылка;
					Строка.СубконтоКт1 = СубконтоРезерв;
				КонецЕсли;
				
			КонецЦикла;
			//Строка.СчетКт = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
			//Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;//О.Т. Аверсон 25.03.2016 № 950
			//Строка.СубконтоКт1 = СубконтоКредита;
			//Строка.СчетКтНУ	= РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
			//Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 25.03.2016 № 950
			//О.Т. Аверсон 19.07.2018 № 2240
			
			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
			//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(РезультатДляНалогов * ?(СтавкаФСЗН=Неопределено,0,СтавкаФСЗН) /100,ПериодРегистрации); 
			Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(РезультатДляНалогов * ?(СтавкаФСЗН=Неопределено,0,СтавкаФСЗН) /100,,ТочностьРасчетов); 
			//Аверсон
			Если ТипЗнч(Строка.СубконтоДт2) = Тип("СправочникСсылка.СтатьиЗатрат") Тогда
				Строка.СубконтоДт2	= СтатьяЗатратРезерв;
			ИначеЕсли ТипЗнч(Строка.СубконтоДт3) = Тип("СправочникСсылка.СтатьиЗатрат") Тогда
				Строка.СубконтоДт3	= СтатьяЗатратРезерв; 				
			КонецЕсли;
			Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
			
			//БГС
			Строка = ОтражениеВУчете.Добавить();
			Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
			Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
			Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
			Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
			Строка.СчетДтНУ			= РезультатЗапросаРезерв.СчетДтНУ;
			Строка.СубконтоДтНУ1 	= РезультатЗапросаРезерв.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 	= РезультатЗапросаРезерв.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 	= РезультатЗапросаРезерв.СубконтоДтНУ3;
			
			//КоррСчет				=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетБУ; //О.Т. Аверсон 30.03.2016 № 950
			//
			//Строка.СчетКт			=  КоррСчет;
			//
			//Субконто    = Новый Массив(3);
			//Для тт=0 по 2 цикл
			//	Субконто[тт] = Неопределено;
			//КонецЦикла;
			//
			//Для тт=0 по КоррСчет.ВидыСубконто.Количество()-1 Цикл
			//	Если НЕ Коррсчет.ВидыСубконто[тт].ВидСубконто = Неопределено тогда
			//		Если Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("ПеречислениеСсылка.ВидыПлатежейВГосБюджет")) Тогда
			//			Субконто[тт] = Перечисления.ВидыПлатежейВГосБюджет.Налог;
			//			
			//		ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Организации")) Тогда
			//			Субконто[тт] = Организация;
			//			
			//		ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Контрагенты")) Тогда
			//			Субконто[тт] =РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//			Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Контрагент; //О.Т. Аверсон 30.03.2016 № 950
			//			
			//		ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ДоговорыКонтрагентов")) Тогда
			//			Субконто[тт] = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//			Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Договор;//О.Т. Аверсон 30.03.2016 № 950
			//			
			//		КонецЕсли;
			//	КонецЕсли;
			//	
			//КонецЦикла;
			//
			//Строка.СубконтоКт1		= Субконто[0];
			//Строка.СубконтоКт2		= Субконто[1];
			//Строка.СубконтоКт3		= Субконто[2];
			//
			//Строка.СчетКтНУ			=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 30.03.2016 № 950
			
			//О.Т. Аверсон 19.07.2018 № 2240
			Строка.СчетКт = СчетУчетаРезерваБУ;
			Строка.СчетКтНУ = СчетУчетаРезерваНУ;
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	Резервы.Наименование,
			|	Резервы.Ссылка
			|ИЗ
			|	Справочник.Резервы КАК Резервы";
			
			РезультатЗапросаРезурв = Запрос.Выполнить().Выбрать();
			Пока РезультатЗапросаРезурв.Следующий() Цикл
				Если Найти(РезультатЗапросаРезурв.Наименование,"БГС")> 0 Тогда 
					СубконтоРезерв = РезультатЗапросаРезурв.Ссылка;
					Строка.СубконтоКт1 = СубконтоРезерв;
				КонецЕсли;
				
			КонецЦикла;
			//О.Т. Аверсон 19.07.2018 № 2240
			
			//Аверсон ЕАЕ 16.06.2020 СВФР-006057
			//Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(РезультатДляНалогов * СтавкаСтрах /100,ПериодРегистрации); 
			Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(РезультатДляНалогов * СтавкаСтрах /100,,ТочностьРасчетов); 
			//Аверсон
			Если ТипЗнч(Строка.СубконтоДт2) = Тип("СправочникСсылка.СтатьиЗатрат") Тогда
				Строка.СубконтоДт2	= СтатьяЗатратРезерв;
			ИначеЕсли ТипЗнч(Строка.СубконтоДт3) = Тип("СправочникСсылка.СтатьиЗатрат") Тогда
				Строка.СубконтоДт3	= СтатьяЗатратРезерв; 				
			КонецЕсли;
			Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.ОбязательноеСтрахование;
			
			//КонецЦикла;
			
			//Если ТЗРаспределСчета.Количество()=0 Тогда 
			//	Строка = ОтражениеВУчете.Добавить();
			//	Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
			//	Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
			//	Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
			//	Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
			//	Строка.СчетКт 			= СчетУчетаРезерваБУ;
			//	Строка.СубконтоКт1	 	= СубконтоРезерваБУ1;
			//	Строка.СубконтоКт2	 	= СубконтоРезерваБУ2;
			//	Строка.СубконтоКт3	 	= СубконтоРезерваБУ3;
			//	Строка.СчетДтНУ			= РезультатЗапросаРезерв.СчетДтНУ;
			//	Строка.СубконтоДтНУ1 	= РезультатЗапросаРезерв.СубконтоДтНУ1;
			//	Строка.СубконтоДтНУ2 	= РезультатЗапросаРезерв.СубконтоДтНУ2;
			//	Строка.СубконтоДтНУ3 	= РезультатЗапросаРезерв.СубконтоДтНУ3;		
			//	Строка.СчетКтНУ			= СчетУчетаРезерваНУ;
			//	Строка.СубконтоКтНУ1 	= СубконтоРезерваНУ1;
			//	Строка.СубконтоКтНУ2 	= СубконтоРезерваНУ2;
			//	Строка.СубконтоКтНУ3 	= СубконтоРезерваНУ3;
			//	Строка.Сумма			= СуммаРезерва;
			//	Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.Начисление;
			//	//Строка.ВидРасчета       = РезультатЗапросаРезерв.ВидРасчета;
			//	
			//	// ФСЗН
			//	РезультатДляНалогов = Строка.Сумма;
			//	
			//	Строка = ОтражениеВУчете.Добавить();
			//	Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
			//	Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
			//	Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
			//	Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
			//	Строка.СчетДтНУ			= РезультатЗапросаРезерв.СчетДтНУ;
			//	Строка.СубконтоДтНУ1 	= РезультатЗапросаРезерв.СубконтоДтНУ1;
			//	Строка.СубконтоДтНУ2 	= РезультатЗапросаРезерв.СубконтоДтНУ2;
			//	Строка.СубконтоДтНУ3 	= РезультатЗапросаРезерв.СубконтоДтНУ3;
			//	
			//	Строка.СчетКт = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
			//	Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;//О.Т. Аверсон 25.03.2016 № 950
			//	Строка.СубконтоКт1 = СубконтоКредита;
			//	Строка.СчетКтНУ	= РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
			//	Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 25.03.2016 № 950
			//	
			//	Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(РезультатДляНалогов * ?(СтавкаФСЗН=Неопределено,0,СтавкаФСЗН) /100,ПериодРегистрации); 
			//	Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
			//	
			//	//БГС
			//	Строка = ОтражениеВУчете.Добавить();
			//	Строка.СчетДт 			= РезультатЗапросаРезерв.СчетДт;
			//	Строка.СубконтоДт1	 	= РезультатЗапросаРезерв.СубконтоДт1;
			//	Строка.СубконтоДт2	 	= РезультатЗапросаРезерв.СубконтоДт2;
			//	Строка.СубконтоДт3	 	= РезультатЗапросаРезерв.СубконтоДт3;
			//	Строка.СчетДтНУ			= РезультатЗапросаРезерв.СчетДтНУ;
			//	Строка.СубконтоДтНУ1 	= РезультатЗапросаРезерв.СубконтоДтНУ1;
			//	Строка.СубконтоДтНУ2 	= РезультатЗапросаРезерв.СубконтоДтНУ2;
			//	Строка.СубконтоДтНУ3 	= РезультатЗапросаРезерв.СубконтоДтНУ3;
			//	
			//	КоррСчет				=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//	Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетБУ; //О.Т. Аверсон 30.03.2016 № 950
			//	
			//	Строка.СчетКт			=  КоррСчет;
			//	
			//	Субконто    = Новый Массив(3);
			//	Для тт=0 по 2 цикл
			//		Субконто[тт] = Неопределено;
			//	КонецЦикла;
			//	
			//	Для тт=0 по КоррСчет.ВидыСубконто.Количество()-1 Цикл
			//		Если НЕ Коррсчет.ВидыСубконто[тт].ВидСубконто = Неопределено тогда
			//			Если Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("ПеречислениеСсылка.ВидыПлатежейВГосБюджет")) Тогда
			//				Субконто[тт] = Перечисления.ВидыПлатежейВГосБюджет.Налог;
			//				
			//			ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Организации")) Тогда
			//				Субконто[тт] = Организация;
			//				
			//			ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.Контрагенты")) Тогда
			//				Субконто[тт] =РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//				Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Контрагент; //О.Т. Аверсон 30.03.2016 № 950
			//				
			//			ИначеЕсли Коррсчет.ВидыСубконто[тт].ВидСубконто.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ДоговорыКонтрагентов")) Тогда
			//				Субконто[тт] = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//				Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Договор;//О.Т. Аверсон 30.03.2016 № 950
			//				
			//			КонецЕсли;
			//		КонецЕсли;
			//		
			//	КонецЦикла;
			//	
			//	Строка.СубконтоКт1		= Субконто[0];
			//	Строка.СубконтоКт2		= Субконто[1];
			//	Строка.СубконтоКт3		= Субконто[2];
			//	
			//	Строка.СчетКтНУ			=  РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
			//	Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 30.03.2016 № 950
			
			//	
			//	Строка.Сумма			= ОбщегоНазначения.ОкруглитьЗначение2016(РезультатДляНалогов * СтавкаСтрах /100,ПериодРегистрации); 
			//	Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.ОбязательноеСтрахование;
			
			//КонецЕсли;
			
			
			
			
		КонецЦикла;  
		
	КонецЕсли;
	//О.Т. Аверсон 21.12.2017 № 1351
	
	//КорректировкаФСЗН
	//О.Т. Аверсон 16.01.2018 № 1447
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	КорректировкаФСЗН.СтатьяЗатрат,
	|	СУММА(КорректировкаФСЗН.СуммаКорректировки) КАК СуммаКорректировки
	|ИЗ
	|	РегистрСведений.КорректировкаФСЗН КАК КорректировкаФСЗН
	|ГДЕ
	|	КорректировкаФСЗН.Период МЕЖДУ &Период И &Период1
	|   И КорректировкаФСЗН.Организация = &Организация  //Аверсон 17.07.2020 КВВ СВФР-006279
	|СГРУППИРОВАТЬ ПО
	|	КорректировкаФСЗН.СтатьяЗатрат";
	
	Запрос.УстановитьПараметр("Период", ПериодРегистрации);
	Запрос.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("Организация", Организация);//Аверсон 17.07.2020 КВВ СВФР-006279
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Строка = ОтражениеВУчете.Добавить();
		Строка.СчетДт 			= ВыборкаДетальныеЗаписи.СтатьяЗатрат.СчетДт;
		Строка.СубконтоДт1	 	= ВыборкаДетальныеЗаписи.СтатьяЗатрат.СубконтоДт1;
		Строка.СубконтоДт2	 	= ВыборкаДетальныеЗаписи.СтатьяЗатрат.СубконтоДт2;
		Строка.СубконтоДт3	 	= ВыборкаДетальныеЗаписи.СтатьяЗатрат.СубконтоДт3;
		Строка.СчетКт = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
		Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;//О.Т. Аверсон 25.03.2016 № 950
		Строка.СубконтоКт1 = СубконтоКредита;
		Строка.СчетКтНУ	= РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
		Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетНУ;//О.Т. Аверсон 25.03.2016 № 950
		
		Строка.СчетДтНУ			= ВыборкаДетальныеЗаписи.СтатьяЗатрат.СчетДтНУ;
		Строка.СубконтоДтНУ1 	= ВыборкаДетальныеЗаписи.СтатьяЗатрат.СубконтоДтНУ1;
		Строка.СубконтоДтНУ2 	= ВыборкаДетальныеЗаписи.СтатьяЗатрат.СубконтоДтНУ2;
		Строка.СубконтоДтНУ3 	= ВыборкаДетальныеЗаписи.СтатьяЗатрат.СубконтоДтНУ3;		
		
		Строка.Сумма			= ВыборкаДетальныеЗаписи.СуммаКорректировки; 
		Строка.ПризнакПроводки  = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
		
		
	КонецЦикла;
	//О.Т. Аверсон 16.01.2018 № 1447
	
	//
	// отражение погашения займов
	//////////////////////////////////////////////////////////////////////////////////////////////////
	
	
	// удалим временные наборы записей
	Для Каждого Набор Из Движения Цикл
		Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.БУОсновныеНачисления") 
			или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.БУДополнительныеНачисления") Тогда
			Набор.Очистить();
			Набор.Записать();
		КонецЕсли;
	КонецЦикла;
	
	
КонецПроцедуры  // АвтозаполнениеПроводок


Функция ПолучитьЗапросДляФСЗН () //Островская Татьяна 02.10.2013 № 16828
	ТекстыЗапросовФСЗН = Новый Структура;
	
	СчетаИсключения = Новый Массив();
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоСоциальномуСтрахованию);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоНалогам);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.НематериальныеАктивы);
	//СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы); //Островская Татьяна 06.05.2014 № 17335
	//СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РезервыПредстоящихРасходов);
	
	ТекстСчетаИсключения =
	"ВЫБРАТЬ
	|	Хозрасчетный.Ссылка
	|ИЗ
	|	ПланСчетов.Хозрасчетный КАК Хозрасчетный
	|ГДЕ
	|	Хозрасчетный.Ссылка В ИЕРАРХИИ(&СчетаИсключения)";
	
	Запрос = Новый Запрос(ТекстСчетаИсключения);
	Запрос.УстановитьПараметр("СчетаИсключения", СчетаИсключения);
	СчетаИсключения = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка");
	ТекстыЗапросовФСЗН.Вставить("ТекстСчетаИсключения", ТекстСчетаИсключения);
	
	// подготовим данные по РБП
	ТекстПредыдущихПериодов =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	БУОсновныеНачисления.ПериодРегистрации КАК ПериодРегистрации
	|ИЗ
	|	РегистрРасчета.БУОсновныеНачисления КАК БУОсновныеНачисления
	|ГДЕ
	|	БУОсновныеНачисления.ПериодДействия = &парамПериод
	|	И БУОсновныеНачисления.ПериодРегистрации < &парамПериод
	|	И (НЕ БУОсновныеНачисления.СчетДт В (&СчетаИсключения))
	|	И БУОсновныеНачисления.ОбособленноеПодразделение = &парамОбособленноеПодразделение
	|
	|УПОРЯДОЧИТЬ ПО
	|	ПериодРегистрации";
	
	Запрос = Новый Запрос(ТекстПредыдущихПериодов);
	Запрос.УстановитьПараметр("парамПериод", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("СчетаИсключения", СчетаИсключения);
	ТекстыЗапросовФСЗН.Вставить("ТекстПредыдущихПериодов", ТекстПредыдущихПериодов);
	ПериодыРегистрацииПредыдущихПериодов = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("ПериодРегистрации");
	
	НачалоПериодаОтраженияВУчете = НачалоГода(ПериодРегистрации);
	Для каждого Период Из ПериодыРегистрацииПредыдущихПериодов Цикл
		НачалоПериодаОтраженияВУчете = Мин(НачалоГода(Период), НачалоПериодаОтраженияВУчете);
		Прервать
	КонецЦикла;
	
	//////////////////////////////////////////////////////////////////////////////////////////////////
	// отражение исчисленного ЕСН
	//
	
	// Периоды
	// Таблица список периодов
	// Поля:
	//		Период
	// Описание:
	//	список периодов - первые даты месяцеы с начала года по "текущий" для запроса период
	
	// конец месяца налогового периода
	КонецМесяца = КонецМесяца(НачалоПериодаОтраженияВУчете);
	// первый месяц
	ПериодыТекст = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период";
	// прибавим остальные месяцы
	Пока КонецМесяца < КонецМесяца(ПериодРегистрации) Цикл
		КонецМесяца = КонецМесяца(КонецМесяца+1);
		ПериодыТекст = ПериодыТекст +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
	КонецЦикла;
	
	// ЕСНДоходы
	// Поля:
	//		ФизЛицо
	//		ПериодРегистрации
	//		КодДоходаЕСН
	//		Результат
	//		
	//	
	//	Описание:
	//	Данные отражения доходов в учете ЕСН - для учета льгот инвалидов
	
	ЕСНДоходыТекст = 
	"ВЫБРАТЬ
	|	Доходы.Сотрудник.ФизЛицо,
	|	Доходы.Сотрудник,
	|	Доходы.ПериодРегистрации,
	|	Доходы.КодДоходаЕСН,
	|	СУММА(Доходы.Результат) КАК Результат
	|ИЗ
	|	(ВЫБРАТЬ
	|		ЕСНОсновныеНачисления.Сотрудник.ФизЛицо КАК ФизЛицо,
	|		ЕСНОсновныеНачисления.Сотрудник КАК Сотрудник,
	|		ЕСНОсновныеНачисления.КодДоходаЕСН КАК КодДоходаЕСН,
	|		ВЫБОР КОГДА ЕСНОсновныеНачисления.ПериодДействияНачало <= ЕСНОсновныеНачисления.ПериодРегистрации ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации ИНАЧЕ ЕСНОсновныеНачисления.ПериодДействияНачало КОНЕЦ КАК ПериодРегистрации,
	|		СУММА(ЕСНОсновныеНачисления.Результат) КАК Результат
	|	ИЗ
	|		РегистрРасчета.ЕСНОсновныеНачисления КАК ЕСНОсновныеНачисления
	|	
	|	ГДЕ
	|		ЕСНОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация И
	|		ЕСНОсновныеНачисления.ПериодРегистрации >= &парамНачалоПериода И
	|		ЕСНОсновныеНачисления.ПериодРегистрации <= &парамПериод И
	|		(ЕСНОсновныеНачисления.КодДоходаЕСН.ВходитВБазуФСЗН ИЛИ ЕСНОсновныеНачисления.КодДоходаЕСН.ВходитВБазуСтрах ИЛИ ЕСНОсновныеНачисления.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ЕСНОсновныеНачисления.Сотрудник.ФизЛицо,
	|		ЕСНОсновныеНачисления.Сотрудник,
	|		ЕСНОсновныеНачисления.КодДоходаЕСН,
	|		ВЫБОР КОГДА ЕСНОсновныеНачисления.ПериодДействияНачало <= ЕСНОсновныеНачисления.ПериодРегистрации ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации ИНАЧЕ ЕСНОсновныеНачисления.ПериодДействияНачало КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ЕСНДополнительныеНачисления.Сотрудник.ФизЛицо,
	|		ЕСНДополнительныеНачисления.Сотрудник,
	|		ЕСНДополнительныеНачисления.КодДоходаЕСН,
	|		ЕСНДополнительныеНачисления.ПериодРегистрации,
	|		СУММА(ЕСНДополнительныеНачисления.Результат)
	|	ИЗ
	|		РегистрРасчета.ЕСНДополнительныеНачисления КАК ЕСНДополнительныеНачисления
	|	
	|	ГДЕ
	|		ЕСНДополнительныеНачисления.ОбособленноеПодразделение = &парамОрганизация И
	|		ЕСНДополнительныеНачисления.ПериодРегистрации >= &парамНачалоПериода И
	|		ЕСНДополнительныеНачисления.ПериодРегистрации <= &парамПериод И
	|		(ЕСНДополнительныеНачисления.КодДоходаЕСН.ВходитВБазуФСЗН ИЛИ ЕСНДополнительныеНачисления.КодДоходаЕСН.ВходитВБазуСтрах ИЛИ ЕСНДополнительныеНачисления.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ЕСНДополнительныеНачисления.Сотрудник.ФизЛицо,
	|		ЕСНДополнительныеНачисления.Сотрудник,
	|		ЕСНДополнительныеНачисления.КодДоходаЕСН,
	|		ЕСНДополнительныеНачисления.ПериодРегистрации) КАК Доходы
	|
	|СГРУППИРОВАТЬ ПО
	|	Доходы.Сотрудник.ФизЛицо,
	|	Доходы.Сотрудник,
	|	Доходы.КодДоходаЕСН,
	|	Доходы.ПериодРегистрации";
	
	// БУДоходыПоВР
	//	Поля:
	//		ФизЛицо
	//		Приказ
	//		ВидРасчета
	//		ПериодРегистрации
	//		СчетДт
	//		СчетДтНУ
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		Результат
	//	
	//	Описание:
	//	Данные отражения начислений в бухучете
	ТекстыЗапросовФСЗН.Вставить("ЕСНДоходыТекст", ЕСНДоходыТекст);
	
	БУДоходыПоВРТекст = 
	"ВЫБРАТЬ
	|	Доходы.Сотрудник.Физлицо,
	|	Доходы.Сотрудник,
	|	Доходы.ВидРасчета,
	|	Доходы.ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|	Доходы.ПериодДействия,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|	Доходы.СчетДт,
	|	Доходы.СубконтоДт1,
	|	Доходы.СубконтоДт2,
	|	Доходы.СубконтоДт3,
	|	Доходы.СчетДтНУ,
	|	Доходы.СубконтоДтНУ1,
	|	Доходы.СубконтоДтНУ2,
	|	Доходы.СубконтоДтНУ3,
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|	Доходы.СчетДт_ДляПодстановки,
	|	Доходы.СубконтоДт1_ДляПодстановки,
	|	Доходы.СубконтоДт2_ДляПодстановки,
	|	Доходы.СубконтоДт3_ДляПодстановки,
	|	Доходы.СчетДтНУ_ДляПодстановки,
	|	Доходы.СубконтоДтНУ1_ДляПодстановки,
	|	Доходы.СубконтоДтНУ2_ДляПодстановки,
	|	Доходы.СубконтоДтНУ3_ДляПодстановки,
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|	СУММА(Доходы.Результат) КАК Результат,
	|	Доходы.ФлагДля97Сч
	|ИЗ
	|	(ВЫБРАТЬ
	|		БУОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
	|		БУОсновныеНачисления.Сотрудник КАК Сотрудник,
	|		БУОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействияНачало <= БУОсновныеНачисления.ПериодРегистрации
	|				ТОГДА БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 21.08.19 СВФР-004669
	//|			ИНАЧЕ БУОсновныеНачисления.ПериодДействияНачало
	//- СВЭЙ КДЯ 21.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 21.08.19 СВФР-004669
	|			ИНАЧЕ НАЧАЛОПЕРИОДА( БУОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ )
	//- СВЭЙ КДЯ 21.08.19 СВФР-004669
	|		КОНЕЦ КАК ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		БУОсновныеНачисления.ПериодДействияНачало КАК ПериодДействия,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &Счет97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДт
	|		КОНЕЦ КАК СчетДт,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &РБПНаОплатуТруда
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт1
	|		КОНЕЦ КАК СубконтоДт1,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА БУОсновныеНачисления.ФизЛицо
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт2
	|		КОНЕЦ КАК СубконтоДт2,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА Неопределено 
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт3 
	|		КОНЕЦ КАК СубконтоДт3,
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &Счет97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДт
	|		КОНЕЦ КАК СчетДт_ДляПодстановки,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &РБПНаОплатуТруда
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт1
	|		КОНЕЦ КАК СубконтоДт1_ДляПодстановки,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА БУОсновныеНачисления.ФизЛицо
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт2
	|		КОНЕЦ КАК СубконтоДт2_ДляПодстановки,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА Неопределено 
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт3 
	|		КОНЕЦ КАК СубконтоДт3_ДляПодстановки,
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &СчетН97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДтНУ
	|		КОНЕЦ КАК СчетДтНУ,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &РБПНаОплатуТруда
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ1
	|		КОНЕЦ КАК СубконтоДтНУ1,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА БУОсновныеНачисления.ФизЛицо
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ2
	|		КОНЕЦ КАК СубконтоДтНУ2,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &ОтпускБудПериода
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ3
	|		КОНЕЦ КАК СубконтоДтНУ3,
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &СчетН97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДтНУ
	|		КОНЕЦ КАК СчетДтНУ_ДляПодстановки,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &РБПНаОплатуТруда
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ1
	|		КОНЕЦ КАК СубконтоДтНУ1_ДляПодстановки,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА БУОсновныеНачисления.ФизЛицо
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ2
	|		КОНЕЦ КАК СубконтоДтНУ2_ДляПодстановки,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &ОтпускБудПериода
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ3
	|		КОНЕЦ КАК СубконтоДтНУ3_ДляПодстановки,
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		СУММА(БУОсновныеНачисления.Результат) КАК Результат,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА 1
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ФлагДля97Сч
	|	ИЗ
	|		РегистрРасчета.БУОсновныеНачисления КАК БУОсновныеНачисления
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних( &парамНачалоПериода, 
	|							ВидПараметра = ЗНАЧЕНИЕ( Перечисление.ВидыПараметровДляРасчетаЗарплаты.ОбязательноеСтрахованиеБез97 ) ) КАК ПараметрОбязательноеСтрахованиеБез97_2
	|				ПО ПараметрОбязательноеСтрахованиеБез97_2.Размер = 2
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних( &парамНачалоПериода, 
	|							ВидПараметра = ЗНАЧЕНИЕ( Перечисление.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца ) ) КАК ПараметрПенсионныйФондБудущегоМесяца_1
	|				ПО ПараметрПенсионныйФондБудущегоМесяца_1.Размер = 1
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних( &парамНачалоПериода, 
	|							ВидПараметра = ЗНАЧЕНИЕ( Перечисление.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца ) ) КАК ПараметрПенсионныйФондБудущегоМесяца
	|				ПО ПараметрПенсионныйФондБудущегоМесяца.Размер > 0
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	//+ СВЭЙ СМА 13.05.20  поменяли текст условия СВФР-005987
	|И (НЕ(НЕ ПараметрОбязательноеСтрахованиеБез97_2.Размер ЕСТЬ NULL
	|				И НЕ ПараметрПенсионныйФондБудущегоМесяца_1.Размер ЕСТЬ NULL))
	//|- СВЭЙ СМА 13.05.20  поменяли текст условия  СВФР-005987
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|	ГДЕ
	|		БУОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	//|		И БУОсновныеНачисления.ПериодРегистрации >= &парамНачалоПериода
	//|		И БУОсновныеНачисления.ПериодРегистрации <= &парамПериод
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|		И ВЫБОР
	|			КОГДА ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|				ТОГДА БУОсновныеНачисления.ПериодРегистрации
	|			КОГДА БУОсновныеНачисления.ПериодДействияНачало <= БУОсновныеНачисления.ПериодРегистрации
	|				ТОГДА БУОсновныеНачисления.ПериодРегистрации
	|			ИНАЧЕ 
	|				НАЧАЛОПЕРИОДА( БУОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ )
	|		КОНЕЦ МЕЖДУ &парамНачалоПериода И &парамПериод
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|	
	|	СГРУППИРОВАТЬ ПО
	|		БУОсновныеНачисления.Сотрудник.Физлицо,
	|		БУОсновныеНачисления.Сотрудник,
	|		БУОсновныеНачисления.ВидРасчета,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействияНачало <= БУОсновныеНачисления.ПериодРегистрации
	|				ТОГДА БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	//|			ИНАЧЕ БУОсновныеНачисления.ПериодДействияНачало
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|			ИНАЧЕ НАЧАЛОПЕРИОДА( БУОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ )
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|		КОНЕЦ,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		БУОсновныеНачисления.ПериодДействияНачало, // КАК ПериодДействия
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &Счет97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДт
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &РБПНаОплатуТруда
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт1
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА БУОсновныеНачисления.ФизЛицо
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт2
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА Неопределено 
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт3 
	|		КОНЕЦ,
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &Счет97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДт
	|		КОНЕЦ, // КАК СчетДт_ДляПодстановки
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &РБПНаОплатуТруда
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт1
	|		КОНЕЦ, // КАК СубконтоДт1_ДляПодстановки
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА БУОсновныеНачисления.ФизЛицо
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт2
	|		КОНЕЦ, // КАК СубконтоДт2_ДляПодстановки
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА Неопределено 
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДт3 
	|		КОНЕЦ, // КАК СубконтоДт3_ДляПодстановки,
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &СчетН97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДтНУ
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &РБПНаОплатуТруда
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ1
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА БУОсновныеНачисления.ФизЛицо
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ2
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА &ОтпускБудПериода
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ3
	|		КОНЕЦ,
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &СчетН97
	|			ИНАЧЕ БУОсновныеНачисления.СчетДтНУ
	|		КОНЕЦ, // КАК СчетДтНУ_ДляПодстановки
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &РБПНаОплатуТруда
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ1
	|		КОНЕЦ, // КАК СубконтоДтНУ1_ДляПодстановки
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА БУОсновныеНачисления.ФизЛицо
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ2
	|		КОНЕЦ, // КАК СубконтоДтНУ2_ДляПодстановки
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					И ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL
	|				ТОГДА &ОтпускБудПериода
	|			ИНАЧЕ БУОсновныеНачисления.СубконтоДтНУ3
	|		КОНЕЦ, // КАК СубконтоДтНУ3_ДляПодстановки
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействия > БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|					И ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|				ТОГДА 1
	|			ИНАЧЕ 0
	|		КОНЕЦ
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		БУДополнительныеНачисления.Сотрудник.Физлицо,
	|		БУДополнительныеНачисления.Сотрудник,
	|		БУДополнительныеНачисления.ВидРасчета,
	|		БУДополнительныеНачисления.ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		БУДополнительныеНачисления.ПериодРегистрации КАК ПериодДействия,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		БУДополнительныеНачисления.СчетДт,
	|		БУДополнительныеНачисления.СубконтоДт1,
	|		БУДополнительныеНачисления.СубконтоДт2,
	|		БУДополнительныеНачисления.СубконтоДт3,
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	//Аверсон 28.07.2020 КВВ СВФР-006325 (  
	//|		Неопределено КАК СчетДт_ДляПодстановки,
	//|		Неопределено КАК СубконтоДт1_ДляПодстановки,
	//|		Неопределено КАК СубконтоДт2_ДляПодстановки,
	//|		Неопределено КАК СубконтоДт3_ДляПодстановки,
	|		БУДополнительныеНачисления.СчетДт КАК СчетДт_ДляПодстановки,
	|		БУДополнительныеНачисления.СубконтоДт1 КАК СубконтоДт1_ДляПодстановки,
	|		БУДополнительныеНачисления.СубконтоДт2 КАК СубконтоДт2_ДляПодстановки,
	|		БУДополнительныеНачисления.СубконтоДт3 КАК СубконтоДт3_ДляПодстановки,
	//Аверсон 28.07.2020 КВВ СВФР-006325 )
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		БУДополнительныеНачисления.СчетДтНУ,
	|		БУДополнительныеНачисления.СубконтоДтНУ1,
	|		БУДополнительныеНачисления.СубконтоДтНУ2,
	|		БУДополнительныеНачисления.СубконтоДтНУ3,
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	//Аверсон 28.07.2020 КВВ СВФР-006325 (
	//|		Неопределено КАК СчетДтНУ_ДляПодстановки,
	//|		Неопределено КАК СубконтоДтНУ1_ДляПодстановки,
	//|		Неопределено КАК СубконтоДтНУ2_ДляПодстановки,
	//|		Неопределено КАК СубконтоДтНУ3_ДляПодстановки,
	|		БУДополнительныеНачисления.СчетДтНУ КАК СчетДтНУ_ДляПодстановки,
	|		БУДополнительныеНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1_ДляПодстановки,
	|		БУДополнительныеНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2_ДляПодстановки,
	|		БУДополнительныеНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3_ДляПодстановки,
	//Аверсон 28.07.2020 КВВ СВФР-006325 )
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		СУММА(БУДополнительныеНачисления.Результат),
	|		0
	|	ИЗ
	|		РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления
	|	ГДЕ
	|		БУДополнительныеНачисления.ОбособленноеПодразделение = &парамОрганизация
	|		И БУДополнительныеНачисления.ПериодРегистрации >= &парамНачалоПериода
	|		И БУДополнительныеНачисления.ПериодРегистрации <= &парамПериод
	|	
	|	СГРУППИРОВАТЬ ПО
	|		БУДополнительныеНачисления.Сотрудник.Физлицо,
	|		БУДополнительныеНачисления.Сотрудник,
	|		БУДополнительныеНачисления.ВидРасчета,
	|		БУДополнительныеНачисления.ПериодРегистрации,
	|		БУДополнительныеНачисления.СчетДт,
	|		БУДополнительныеНачисления.СубконтоДт1,
	|		БУДополнительныеНачисления.СубконтоДт2,
	|		БУДополнительныеНачисления.СубконтоДт3,
	|		БУДополнительныеНачисления.СчетДтНУ,
	|		БУДополнительныеНачисления.СубконтоДтНУ1,
	|		БУДополнительныеНачисления.СубконтоДтНУ2,
	|		БУДополнительныеНачисления.СубконтоДтНУ3) КАК Доходы
	|
	|СГРУППИРОВАТЬ ПО
	|	Доходы.Сотрудник.Физлицо,
	|	Доходы.Сотрудник,
	|	Доходы.ВидРасчета,
	|	Доходы.ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|	Доходы.ПериодДействия,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|	Доходы.СчетДт,
	|	Доходы.СчетДтНУ,
	|	Доходы.СубконтоДт1,
	|	Доходы.СубконтоДт2,
	|	Доходы.СубконтоДт3,
	|	Доходы.СубконтоДтНУ1,
	|	Доходы.СубконтоДтНУ2,
	|	Доходы.СубконтоДтНУ3,
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|	Доходы.СчетДт_ДляПодстановки,
	|	Доходы.СубконтоДт1_ДляПодстановки,
	|	Доходы.СубконтоДт2_ДляПодстановки,
	|	Доходы.СубконтоДт3_ДляПодстановки,
	|	Доходы.СчетДтНУ_ДляПодстановки,
	|	Доходы.СубконтоДтНУ1_ДляПодстановки,
	|	Доходы.СубконтоДтНУ2_ДляПодстановки,
	|	Доходы.СубконтоДтНУ3_ДляПодстановки,
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|	Доходы.ФлагДля97Сч"; //О.Т. 17.09.2015 № 17778
	
	ТекстыЗапросовФСЗН.Вставить("БУДоходыПоВРТекст", БУДоходыПоВРТекст);
	// ЕСНДоходыПоВР
	//	Поля:
	//		ФизЛицо
	//		Приказ
	//		ВидРасчета
	//		ПериодРегистрации
	//		КодДоходаЕСН
	//		Результат
	//
	// Описание:
	//	список доходов по кодам ЕСН в разрезе видов расчета
	//
	//Островская Татьяна 25.04.2013 № 16
	ЕСНДоходыПоВРТекст = 
	"ВЫБРАТЬ
	|	Доходы.ФизЛицо КАК ФизЛицо,
	|	Доходы.Сотрудник КАК Сотрудник,
	|	Доходы.ВидРасчета КАК ВидРасчета,
	|	Доходы.КодДоходаЕСН КАК КодДоходаЕСН,
	|	Доходы.ПериодРегистрации КАК ПериодРегистрации,
	|	Доходы.Результат КАК Результат,
	|	Доходы.ПериодДействия,
	|	Доходы.Проверка
	|ИЗ
	|	(ВЫБРАТЬ
	|		ВложенныйЗапрос.ФизЛицо КАК ФизЛицо,
	|		ВложенныйЗапрос.Сотрудник КАК Сотрудник,
	|		ВложенныйЗапрос.ВидРасчета КАК ВидРасчета,
	|		ВложенныйЗапрос.КодДоходаЕСН КАК КодДоходаЕСН,
	|		ВложенныйЗапрос.ПериодРегистрации КАК ПериодРегистрации,
	|		СУММА(ВложенныйЗапрос.Результат) КАК Результат,
	|		ВложенныйЗапрос.ПериодДействия КАК ПериодДействия,
	|		СУММА(ВЫБОР
	|				КОГДА ВложенныйЗапрос.Результат > СтавкиОтчисленийСФОТиЗПСрезПоследних.ОграничениеПоДоходам * &Ограничение
	|					ТОГДА 1
	|				ИНАЧЕ 0
	|			КОНЕЦ) КАК Проверка
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ЕСНОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
	|			ЕСНОсновныеНачисления.Сотрудник КАК Сотрудник,
	|			ЕСНОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|			ЕСНОсновныеНачисления.КодДоходаЕСН КАК КодДоходаЕСН,
	|			ВЫБОР
	|				КОГДА ЕСНОсновныеНачисления.ПериодДействияНачало <= ЕСНОсновныеНачисления.ПериодРегистрации
	|					ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 21.08.19 СВФР-004669
	//|				ИНАЧЕ ЕСНОсновныеНачисления.ПериодДействияНачало
	//- СВЭЙ КДЯ 21.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 21.08.19 СВФР-004669
	|				ИНАЧЕ НАЧАЛОПЕРИОДА( ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ )
	//- СВЭЙ КДЯ 21.08.19 СВФР-004669
	|			КОНЕЦ КАК ПериодРегистрации,
	|			ЕСНОсновныеНачисления.Результат КАК Результат,
	|			ЕСНОсновныеНачисления.ПериодДействияНачало КАК ПериодДействия,
	|			ЕСНОсновныеНачисления.Организация КАК Организация
	|		ИЗ
	|			РегистрРасчета.ЕСНОсновныеНачисления КАК ЕСНОсновныеНачисления
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних( &парамНачалоПериода, 
	|							ВидПараметра = ЗНАЧЕНИЕ( Перечисление.ВидыПараметровДляРасчетаЗарплаты.ОбязательноеСтрахованиеБез97 ) ) КАК ПараметрОбязательноеСтрахованиеБез97_2
	|				ПО ПараметрОбязательноеСтрахованиеБез97_2.Размер = 2
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних( &парамНачалоПериода, 
	|							ВидПараметра = ЗНАЧЕНИЕ( Перечисление.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца ) ) КАК ПараметрПенсионныйФондБудущегоМесяца_1
	|				ПО ПараметрПенсионныйФондБудущегоМесяца_1.Размер = 1
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних( &парамНачалоПериода, 
	|							ВидПараметра = ЗНАЧЕНИЕ( Перечисление.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца ) ) КАК ПараметрПенсионныйФондБудущегоМесяца
	|				ПО ПараметрПенсионныйФондБудущегоМесяца.Размер > 0
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|					И НЕ ( НЕ ПараметрОбязательноеСтрахованиеБез97_2.Размер IS NULL
	|                       	И НЕ ПараметрПенсионныйФондБудущегоМесяца_1.Размер IS NULL )
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|		ГДЕ
	|			ЕСНОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	//|			И ЕСНОсновныеНачисления.ПериодРегистрации >= &парамНачалоПериода
	//|			И ЕСНОсновныеНачисления.ПериодРегистрации <= &парамПериод
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|			И ВЫБОР
	|				КОГДА ПараметрПенсионныйФондБудущегоМесяца.Размер IS NULL
	|					ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации
	|				КОГДА ЕСНОсновныеНачисления.ПериодДействияНачало <= ЕСНОсновныеНачисления.ПериодРегистрации
	|					ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации
	|				ИНАЧЕ 
	|					НАЧАЛОПЕРИОДА( ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ )
	|			КОНЕЦ МЕЖДУ &парамНачалоПериода И &парамПериод
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|			И (ЕСНОсновныеНачисления.КодДоходаЕСН.ВходитВБазуФСЗН
	|					ИЛИ ЕСНОсновныеНачисления.КодДоходаЕСН.ВходитВБазуСтрах
	|					ИЛИ ЕСНОсновныеНачисления.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж)";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
		ЕСНДоходыПоВРТекст = ЕСНДоходыПоВРТекст + "
		|			и ЕСНОсновныеНачисления.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
	КонецЕсли;
	ЕСНДоходыПоВРТекст = ЕСНДоходыПоВРТекст + "
	|		
	|		ОБЪЕДИНИТЬ ВСЕ
	|		
	|		ВЫБРАТЬ
	|			ЕСНДополнительныеНачисления.Сотрудник.Физлицо,
	|			ЕСНДополнительныеНачисления.Сотрудник,
	|			ЕСНДополнительныеНачисления.ВидРасчета,
	|			ЕСНДополнительныеНачисления.КодДоходаЕСН,
	|			ЕСНДополнительныеНачисления.ПериодРегистрации,
	|			СУММА(ЕСНДополнительныеНачисления.Результат),
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	//|			ЕСНДополнительныеНачисления.БазовыйПериодНачало,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	
	//Аверсон 29.06.2020 КВВ СВФР-006178 (
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	//|			НАЧАЛОПЕРИОДА( ЕСНДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ ),
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|			НАЧАЛОПЕРИОДА( ЕСНДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ ),
	//Аверсон 29.06.2020 КВВ СВФР-006178 )
	
	|			ЕСНДополнительныеНачисления.Организация
	|		ИЗ
	|			РегистрРасчета.ЕСНДополнительныеНачисления КАК ЕСНДополнительныеНачисления
	|		ГДЕ
	|			ЕСНДополнительныеНачисления.ОбособленноеПодразделение = &парамОрганизация
	|			И ЕСНДополнительныеНачисления.ПериодРегистрации >= &парамНачалоПериода
	|			И ЕСНДополнительныеНачисления.ПериодРегистрации <= &парамПериод
	|			И (ЕСНДополнительныеНачисления.КодДоходаЕСН.ВходитВБазуФСЗН
	|					ИЛИ ЕСНДополнительныеНачисления.КодДоходаЕСН.ВходитВБазуСтрах
	|					ИЛИ ЕСНДополнительныеНачисления.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж)";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
		ЕСНДоходыПоВРТекст = ЕСНДоходыПоВРТекст + "
		|			и ЕСНДополнительныеНачисления.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
	КонецЕсли;
	ЕСНДоходыПоВРТекст = ЕСНДоходыПоВРТекст + "
	|		
	|		СГРУППИРОВАТЬ ПО
	|			ЕСНДополнительныеНачисления.Сотрудник.Физлицо,
	|			ЕСНДополнительныеНачисления.Сотрудник,
	|			ЕСНДополнительныеНачисления.ВидРасчета,
	|			ЕСНДополнительныеНачисления.КодДоходаЕСН,
	|			ЕСНДополнительныеНачисления.ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	//|			ЕСНДополнительныеНачисления.БазовыйПериодНачало,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	
	//Аверсон 29.06.2020 КВВ СВФР-006178 (
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	//|			НАЧАЛОПЕРИОДА( ЕСНДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ ),
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|			НАЧАЛОПЕРИОДА( ЕСНДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ ),
	//Аверсон 29.06.2020 КВВ СВФР-006178 )
	|			ЕСНДополнительныеНачисления.Организация) КАК ВложенныйЗапрос
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&ПериодДляОграничения, ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд)) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних
	|			ПО ВложенныйЗапрос.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних.Организация
	|				И (ВЫБОР
	|					КОГДА ВложенныйЗапрос.Сотрудник.ВидНалогообложенияОсновной = &ПустаяСсылкаВидНалогообложения
	|						ТОГДА ВложенныйЗапрос.Организация.ОсновнаяСтавкаНалогообложения
	|					ИНАЧЕ ВложенныйЗапрос.Сотрудник.ВидНалогообложенияОсновной
	|				КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидНалогообложения)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ВложенныйЗапрос.ФизЛицо,
	|		ВложенныйЗапрос.ПериодРегистрации,
	|		ВложенныйЗапрос.Сотрудник,
	|		ВложенныйЗапрос.КодДоходаЕСН,
	|		ВложенныйЗапрос.ВидРасчета,
	|		ВложенныйЗапрос.ПериодДействия) КАК Доходы"; //О.Т. Аверсон 25.03.2016 № 950
	//Островская Татьяна 25.04.2013 № 16
	ТекстыЗапросовФСЗН.Вставить("ЕСНДоходыПоВРТекст", ЕСНДоходыПоВРТекст);
	
	
	
	// ЕСНДоходыЗаГод
	//	Поля:
	//		ФизЛицо
	//		КодДоходаЕСН
	//		ПериодРегистрации
	//		Результат			- доход за период
	//		РезультатЗаГод		- доход за год нарастающим итогом
	//	Описание:
	//	соединение таблицы ЕСНДоходыЗаГод с самой собой для получения
	//	нарастающего итога
	//
	
	ЕСНДоходыЗаГодТекст = 
	"ВЫБРАТЬ
	|	ЕСНДоходыОсновная.ФизЛицо,
	|	ЕСНДоходыОсновная.КодДоходаЕСН,
	|	ЕСНДоходыОсновная.ПериодРегистрации,
	|	ЕСНДоходыОсновная.Результат,
	|	СУММА(ЕСНДоходыВспомогательная.Результат) КАК РезультатЗаГод
	|ИЗ
	|	("+ЕСНДоходыТекст +") КАК ЕСНДоходыОсновная
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ("+ЕСНДоходыТекст +") КАК ЕСНДоходыВспомогательная
	|		ПО ЕСНДоходыВспомогательная.ПериодРегистрации <= ЕСНДоходыОсновная.ПериодРегистрации И ЕСНДоходыОсновная.ФизЛицо = ЕСНДоходыВспомогательная.ФизЛицо И ЕСНДоходыОсновная.Приказ = ЕСНДоходыВспомогательная.Приказ И ЕСНДоходыОсновная.КодДоходаЕСН = ЕСНДоходыВспомогательная.КодДоходаЕСН
	|
	|СГРУППИРОВАТЬ ПО
	|	ЕСНДоходыОсновная.ФизЛицо,
	|	ЕСНДоходыОсновная.КодДоходаЕСН,
	|	ЕСНДоходыОсновная.Результат,
	|	ЕСНДоходыОсновная.ПериодРегистрации";
	ТекстыЗапросовФСЗН.Вставить("ЕСНДоходыЗаГодТекст", ЕСНДоходыЗаГодТекст);
	
	// БУДоходыСводПоВР
	//	Поля:
	//		ФизЛицо
	//		Приказ
	//		ВидРасчета
	//		ПериодРегистрации
	//		Результат
	//
	// Описание:
	//	доходы, отраженные в бухучете, сведенные по видам расчета
	//
	
	БУДоходыСводПоВРТекст = 
	"ВЫБРАТЬ
	|	Доходы.Сотрудник.ФизЛицо,
	|	Доходы.Сотрудник,
	|	Доходы.ВидРасчета,
	|	Доходы.ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|	Доходы.ПериодДействия,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|	СУММА(Доходы.Результат) КАК Результат
	|ИЗ
	|	(ВЫБРАТЬ
	|		БУОсновныеНачисления.Сотрудник.ФизЛицо КАК ФизЛицо,
	|		БУОсновныеНачисления.Сотрудник КАК Сотрудник,
	|		БУОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|		ВЫБОР КОГДА БУОсновныеНачисления.ПериодДействияНачало <= БУОсновныеНачисления.ПериодРегистрации 
	|				ТОГДА БУОсновныеНачисления.ПериодРегистрации 
	//+ СВЭЙ КДЯ 21.08.19 СВФР-004669
	//|				ИНАЧЕ БУОсновныеНачисления.ПериодДействияНачало
	//- СВЭЙ КДЯ 21.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 21.08.19 СВФР-004669
	|				ИНАЧЕ НАЧАЛОПЕРИОДА( БУОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ )
	//- СВЭЙ КДЯ 21.08.19 СВФР-004669
	|		КОНЕЦ КАК ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		БУОсновныеНачисления.ПериодДействияНачало КАК ПериодДействия,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		СУММА(БУОсновныеНачисления.Результат) КАК Результат
	|	ИЗ
	|		РегистрРасчета.БУОсновныеНачисления КАК БУОсновныеНачисления
	|	
	|	ГДЕ
	|		БУОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация И
	|		БУОсновныеНачисления.ПериодРегистрации >= &парамНачалоПериода И
	|		БУОсновныеНачисления.ПериодРегистрации <= &парамПериод
	|	
	|	СГРУППИРОВАТЬ ПО
	|		БУОсновныеНачисления.Сотрудник.ФизЛицо,
	|		БУОсновныеНачисления.Сотрудник,
	|		БУОсновныеНачисления.ВидРасчета,
	|		ВЫБОР
	|			КОГДА БУОсновныеНачисления.ПериодДействияНачало <= БУОсновныеНачисления.ПериодРегистрации
	|				ТОГДА БУОсновныеНачисления.ПериодРегистрации
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	//|			ИНАЧЕ БУОсновныеНачисления.ПериодДействияНачало
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	//+ СВЭЙ КДЯ 22.08.19 СВФР-004669
	|			ИНАЧЕ НАЧАЛОПЕРИОДА( БУОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ )
	//- СВЭЙ КДЯ 22.08.19 СВФР-004669
	|		КОНЕЦ,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		БУОсновныеНачисления.ПериодДействияНачало // КАК ПериодДействия
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		БУДополнительныеНачисления.Сотрудник.ФизЛицо,
	|		БУДополнительныеНачисления.Сотрудник,
	|		БУДополнительныеНачисления.ВидРасчета,
	|		БУДополнительныеНачисления.ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		БУДополнительныеНачисления.ПериодРегистрации КАК ПериодДействия,
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|		СУММА(БУДополнительныеНачисления.Результат)
	|	ИЗ
	|		РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления
	|	
	|	ГДЕ
	|		БУДополнительныеНачисления.ОбособленноеПодразделение = &парамОрганизация И
	|		БУДополнительныеНачисления.ПериодРегистрации >= &парамНачалоПериода И
	|		БУДополнительныеНачисления.ПериодРегистрации <= &парамПериод
	|	
	|	СГРУППИРОВАТЬ ПО
	|		БУДополнительныеНачисления.Сотрудник.ФизЛицо,
	|		БУДополнительныеНачисления.Сотрудник,
	|		БУДополнительныеНачисления.ВидРасчета,
	|		БУДополнительныеНачисления.ПериодРегистрации) КАК Доходы
	|
	|СГРУППИРОВАТЬ ПО
	|	Доходы.Сотрудник.ФизЛицо,
	|	Доходы.Сотрудник,
	|	Доходы.ВидРасчета,
	|	Доходы.ПериодРегистрации,
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|	Доходы.ПериодДействия
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|";
	ТекстыЗапросовФСЗН.Вставить("БУДоходыСводПоВРТекст", БУДоходыСводПоВРТекст);
	
	//	ЕСНДоходыБУДоходы
	//	Поля:
	//		ФизЛицо
	//		Приказ
	//		ВидРасчета
	//		ПериодРегистрации
	//		КодДоходаЕСН
	//		СчетДт
	//		СчетДтНУ
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		РезультатЕСН
	//		РезультатБУ
	//	Описание:
	//	соединение таблиц с доходами в разрезе кодов дохода ЕСН и в 
	//	разрезе отражения в бухучете
	//	сопоставление выполняется по видам расчета
	//
	
	ЕСНДоходыБУДоходыТекст = 
	"ВЫБРАТЬ
	|	ЕСНДоходыПоВР.Сотрудник.ФизЛицо,
	|	ЕСНДоходыПоВР.Сотрудник,
	|	ЕСНДоходыПоВР.ВидРасчета,
	|	ЕСНДоходыПоВР.ПериодРегистрации,
	|	ЕСНДоходыПоВР.КодДоходаЕСН,
	|	БУДоходыПоВР.СчетДт,
	|	БУДоходыПоВР.СубконтоДт1,
	|	БУДоходыПоВР.СубконтоДт2,
	|	БУДоходыПоВР.СубконтоДт3,	
	|	БУДоходыПоВР.СчетДтНУ,
	|	БУДоходыПоВР.СубконтоДтНУ1,
	|	БУДоходыПоВР.СубконтоДтНУ2,
	|	БУДоходыПоВР.СубконтоДтНУ3,	
	|	ВЫБОР КОГДА &РасчетФСЗНотБПМ 
	|		  ТОГДА ВЫБОР КОГДА ЕСНДоходыПоВР.Результат < &парамБПМ 
	|		  			  ТОГДА &парамБПМ 
	|					  ИНАЧЕ ЕСНДоходыПоВР.Результат 
	|					  КОНЕЦ
	|		  ИНАЧЕ ЕСНДоходыПоВР.Результат 
	|	КОНЕЦ КАК РезультатЕСН,
	|	ВЫБОР КОГДА &РасчетФСЗНотБПМ 
	|		  ТОГДА ВЫБОР КОГДА БУДоходыПоВР.Результат < &парамБПМ 
	|		  			  ТОГДА &парамБПМ 
	|					  ИНАЧЕ БУДоходыПоВР.Результат 
	|					  КОНЕЦ
	|		  ИНАЧЕ БУДоходыПоВР.Результат 
	|	КОНЕЦ КАК РезультатБУ,
	|	ЕСНДоходыПоВР.ПериодДействия,
	|	ЕСНДоходыПоВР.Проверка,
	|	БУДоходыПоВР.ФлагДля97Сч КАК ФлагДля97Сч //О.Т. 17.09.2015 № 17778
	//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
	|	, БУДоходыПоВР.СчетДт_ДляПодстановки,
	|	БУДоходыПоВР.СубконтоДт1_ДляПодстановки,
	|	БУДоходыПоВР.СубконтоДт2_ДляПодстановки,
	|	БУДоходыПоВР.СубконтоДт3_ДляПодстановки,
	|	БУДоходыПоВР.СчетДтНУ_ДляПодстановки,
	|	БУДоходыПоВР.СубконтоДтНУ1_ДляПодстановки,
	|	БУДоходыПоВР.СубконтоДтНУ2_ДляПодстановки,
	|	БУДоходыПоВР.СубконтоДтНУ3_ДляПодстановки
	//- СВЭЙ КДЯ 12.02.20 СВФР-005491
	|ИЗ
	|	("+ ЕСНДоходыПоВРТекст +") КАК ЕСНДоходыПоВР
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ("+ БУДоходыПоВРТекст +") КАК БУДоходыПоВР
	|		ПО ЕСНДоходыПоВР.Сотрудник = БУДоходыПоВР.Сотрудник 
	|			И ЕСНДоходыПоВР.ВидРасчета = БУДоходыПоВР.ВидРасчета 
	|			И ЕСНДоходыПоВР.ПериодРегистрации = БУДоходыПоВР.ПериодРегистрации
	//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
	|			И ЕСНДоходыПоВР.ПериодДействия = БУДоходыПоВР.ПериодДействия
	//- СВЭЙ КДЯ 09.04.20 СВФР-005832
	|";
	ТекстыЗапросовФСЗН.Вставить("ЕСНДоходыБУДоходыТекст", ЕСНДоходыБУДоходыТекст);
	// КоэффициентыОтраженияЕСН
	//	Поля:
	//		СчетДт
	//		СчетДтНУ
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		БазаФСЗН
	//		БазаСтрах
	//		БазаЕдиныйПлатеж
	// Описание:
	// таблица коэффициентов отражения составных частей исчисленного ЕСН по счетам бухучета
	//
	//Островская Татьяна 10.09.2013 № 16725
	Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
		КоэффициентыОтраженияЕСНТекст = 
		"ВЫБРАТЬ
		//Дмитрук
		|	ЕСНДоходыБУДоходы.Сотрудник.ФизЛицо КАК ФизЛицо,
		//Дмитрук
		|	ЕСНДоходыБУДоходы.СчетДт,
		|	ЕСНДоходыБУДоходы.СубконтоДт1,
		|	ЕСНДоходыБУДоходы.СубконтоДт2,
		|	ЕСНДоходыБУДоходы.СубконтоДт3,	
		|	ЕСНДоходыБУДоходы.СчетДтНУ,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ1,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ2,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ3,
		//+ СВЭЙ КДЯ 14.02.20 СВФР-005491
		|	ЕСНДоходыБУДоходы.СчетДт_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт1_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт2_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт3_ДляПодстановки,	
		|	ЕСНДоходыБУДоходы.СчетДтНУ_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ1_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ2_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ3_ДляПодстановки,
		//- СВЭЙ КДЯ 14.02.20 СВФР-005491
		|	&парамПериод как ПериодРегистрации,
		//Островская Татьяна 07.05.2014 № 17239
		|   &парамПериод Как периодДействия,
		|   ЕСНДоходыБУДоходы.ВидРасчета,
		|   ЕСНДоходыБУДоходы.ФлагДля97Сч,  //О.Т. 17.09.2015 № 17778
		|	ВЫБОР
		|	КОГДА ЕСНДоходыБУДоходы.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Вспомогательный)
		|		ТОГДА 1
		|	КОГДА ЕСНДоходыБУДоходы.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов)
		|	тогда 2 ИНАЧЕ 0
		|КОНЕЦ КАК ВспомогательныйСчет
		
		//Островская Татьяна 07.05.2014 № 17239
		|ИЗ
		
		|	("+ ЕСНДоходыБУДоходыТекст +") КАК ЕСНДоходыБУДоходы
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ БУДоходыСводПоВРТекст +") КАК БУДоходыСводПоВР
		|		ПО ЕСНДоходыБУДоходы.Сотрудник = БУДоходыСводПоВР.Сотрудник 
		|			И ЕСНДоходыБУДоходы.ВидРасчета = БУДоходыСводПоВР.ВидРасчета 
		|			И ЕСНДоходыБУДоходы.ПериодРегистрации = БУДоходыСводПоВР.ПериодРегистрации
		//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
		|			И ЕСНДоходыБУДоходы.ПериодДействия = БУДоходыСводПоВР.ПериодДействия
		//- СВЭЙ КДЯ 09.04.20 СВФР-005832
		|СГРУППИРОВАТЬ ПО
		|ЕСНДоходыБУДоходы.Сотрудник.Физлицо,
		|ЕСНДоходыБУДоходы.СчетДт,
		|ЕСНДоходыБУДоходы.СубконтоДт1,
		|ЕСНДоходыБУДоходы.СубконтоДт2,
		|ЕСНДоходыБУДоходы.СубконтоДт3,
		|ЕСНДоходыБУДоходы.СчетДтНУ,
		|ЕСНДоходыБУДоходы.СубконтоДтНУ1,
		|ЕСНДоходыБУДоходы.СубконтоДтНУ2,
		|ЕСНДоходыБУДоходы.СубконтоДтНУ3,
		//+ СВЭЙ КДЯ 14.02.20 СВФР-005491
		|	ЕСНДоходыБУДоходы.СчетДт_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт1_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт2_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт3_ДляПодстановки,	
		|	ЕСНДоходыБУДоходы.СчетДтНУ_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ1_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ2_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ3_ДляПодстановки,
		//- СВЭЙ КДЯ 14.02.20 СВФР-005491
		|ЕСНДоходыБУДоходы.ПериодРегистрации,
		|ЕСНДоходыБУДоходы.ПериодДействия,
		|ЕСНДоходыБУДоходы.ВидРасчета,
		|ЕСНДоходыБУДоходы.ФлагДля97Сч";
		
		КоэффициентыОтраженияЕСНТекст1 = 
		"ВЫБРАТЬ
		//Дмитрук
		|	ЕСНДоходыБУДоходы.Сотрудник.ФизЛицо КАК ФизЛицо,
		//Дмитрук
		|	ЕСНДоходыБУДоходы.СчетДт,
		|	ЕСНДоходыБУДоходы.СубконтоДт1,
		|	ЕСНДоходыБУДоходы.СубконтоДт2,
		|	ЕСНДоходыБУДоходы.СубконтоДт3,	
		|	ЕСНДоходыБУДоходы.СчетДтНУ,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ1,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ2,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ3,	
		//+ СВЭЙ КДЯ 14.02.20 СВФР-005491
		|	ЕСНДоходыБУДоходы.СчетДт_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт1_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт2_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт3_ДляПодстановки,	
		|	ЕСНДоходыБУДоходы.СчетДтНУ_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ1_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ2_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ3_ДляПодстановки,
		//- СВЭЙ КДЯ 14.02.20 СВФР-005491
		|	&парамПериод как ПериодРегистрации,
		//|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуФСЗН) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН / БУДоходыСводПоВР.Результат * ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаФСЗН,
		//|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуСтрах) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН / БУДоходыСводПоВР.Результат * ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаСтрах,
		//|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН / БУДоходыСводПоВР.Результат * ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаЕдиныйПлатеж
		|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуФСЗН) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН КОНЕЦ КАК БазаФСЗН,
		|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуСтрах) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН КОНЕЦ КАК БазаСтрах,
		|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН КОНЕЦ КАК БазаЕдиныйПлатеж,
		|	ЕСНДоходыБУДоходы.ПериодРегистрации,
		//Островская Татьяна 07.05.2014 № 17239
		|   ВЫБОР КОГДА НЕ ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуФСЗН ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаФСЗНБУ,
		|   ВЫБОР КОГДА НЕ ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуСтрах ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаСтрахБУ,
		|   ВЫБОР КОГДА НЕ ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаЕдиныйПлатежБУ,
		|   ЕСНДоходыБУДоходы.ПериодДействия,
		|   ЕСНДоходыБУДоходы.Проверка, ЕСНДоходыБУДоходы.ВидРасчета,
		|   ЕСНДоходыБУДоходы.ФлагДля97Сч  //О.Т. 17.09.2015 № 17778
		//Островская Татьяна 07.05.2014 № 17239
		|ИЗ
		
		|	("+ ЕСНДоходыБУДоходыТекст +") КАК ЕСНДоходыБУДоходы
		|
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ БУДоходыСводПоВРТекст +") КАК БУДоходыСводПоВР
		|		ПО ЕСНДоходыБУДоходы.Сотрудник = БУДоходыСводПоВР.Сотрудник 
		|			И ЕСНДоходыБУДоходы.ВидРасчета = БУДоходыСводПоВР.ВидРасчета 
		|			И ЕСНДоходыБУДоходы.ПериодРегистрации = БУДоходыСводПоВР.ПериодРегистрации
		//+ СВЭЙ КДЯ 09.04.20 СВФР-005832
		|			И ЕСНДоходыБУДоходы.ПериодДействия = БУДоходыСводПоВР.ПериодДействия
		//- СВЭЙ КДЯ 09.04.20 СВФР-005832
		|";
		
		ТекстыЗапросовФСЗН.Вставить("КоэффициентыОтраженияЕСНТекст1", КоэффициентыОтраженияЕСНТекст1);
		
		
	иначе
		
		КоэффициентыОтраженияЕСНТекст = 
		"ВЫБРАТЬ
		//Дмитрук
		|	ЕСНДоходыБУДоходы.Сотрудник.ФизЛицо КАК ФизЛицо,
		//Дмитрук
		|	ЕСНДоходыБУДоходы.СчетДт,
		|	ЕСНДоходыБУДоходы.СубконтоДт1,
		|	ЕСНДоходыБУДоходы.СубконтоДт2,
		|	ЕСНДоходыБУДоходы.СубконтоДт3,	
		|	ЕСНДоходыБУДоходы.СчетДтНУ,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ1,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ2,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ3,	
		//|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуФСЗН) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН / БУДоходыСводПоВР.Результат * ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаФСЗН,
		//|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуСтрах) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН / БУДоходыСводПоВР.Результат * ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаСтрах,
		//|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН / БУДоходыСводПоВР.Результат * ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаЕдиныйПлатеж
		|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуФСЗН) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН КОНЕЦ КАК БазаФСЗН,
		|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуСтрах) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН КОНЕЦ КАК БазаСтрах,
		|	ВЫБОР КОГДА НЕ(ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж) ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатЕСН КОНЕЦ КАК БазаЕдиныйПлатеж,
		|	ЕСНДоходыБУДоходы.ПериодРегистрации,
		//Островская Татьяна 07.05.2014 № 17239
		|   ВЫБОР КОГДА НЕ ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуФСЗН ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаФСЗНБУ,
		|   ВЫБОР КОГДА НЕ ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуСтрах ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаСтрахБУ,
		|   ВЫБОР КОГДА НЕ ЕСНДоходыБУДоходы.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж ИЛИ БУДоходыСводПоВР.Результат = 0 ТОГДА 0 ИНАЧЕ ЕСНДоходыБУДоходы.РезультатБУ КОНЕЦ КАК БазаЕдиныйПлатежБУ,
		|   ЕСНДоходыБУДоходы.ПериодДействия,
		|   ЕСНДоходыБУДоходы.Проверка, ЕСНДоходыБУДоходы.ВидРасчета,
		|   ЕСНДоходыБУДоходы.ФлагДля97Сч,  //О.Т. 17.09.2015 № 17778
		|   NULL КАК ВспомогательныйСчет
		//+ СВЭЙ КДЯ 12.02.20 СВФР-005491
		|	, ЕСНДоходыБУДоходы.СчетДт_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт1_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт2_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДт3_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СчетДтНУ_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ1_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ2_ДляПодстановки,
		|	ЕСНДоходыБУДоходы.СубконтоДтНУ3_ДляПодстановки
		//- СВЭЙ КДЯ 12.02.20 СВФР-005491
		//Островская Татьяна 07.05.2014 № 17239
		|ИЗ
		
		|	("+ ЕСНДоходыБУДоходыТекст +") КАК ЕСНДоходыБУДоходы
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ БУДоходыСводПоВРТекст +") КАК БУДоходыСводПоВР
		|		ПО ЕСНДоходыБУДоходы.Сотрудник = БУДоходыСводПоВР.Сотрудник 
		|			И ЕСНДоходыБУДоходы.ВидРасчета = БУДоходыСводПоВР.ВидРасчета 
		|			И ЕСНДоходыБУДоходы.ПериодРегистрации = БУДоходыСводПоВР.ПериодРегистрации
		|";
	КонецЕсли;
	//Островская Татьяна 10.09.2013 № 16725
	// ЕСНИсчисленный
	//	Поля:
	//		ФСЗН
	//		Страх
	//		ЕдиныйПлатеж
	//		ПенсионныйФонд
	// Описание:
	// просуммированный исчисленный ЕСН
	//
	ТекстыЗапросовФСЗН.Вставить("КоэффициентыОтраженияЕСНТекст", КоэффициентыОтраженияЕСНТекст);
	
	
	ЕСНИсчисленныйТекст = 
	"ВЫБРАТЬ
	|	СУММА(ЕСНПоРаботникам.ФСЗН) КАК ФСЗН,
	|	СУММА(ЕСНПоРаботникам.Страх) КАК Страх,
	|	СУММА(ЕСНПоРаботникам.ЕдиныйПлатеж) КАК ЕдиныйПлатеж,
	|	СУММА(ЕСНПоРаботникам.ПенсионныйФонд) КАК ПенсионныйФонд
	|ИЗ
	|	(ВЫБРАТЬ
	|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
	|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
	|		СУММА(ЕСНИсчисленный.ОбязательноеСтрахование) КАК Страх,
	|		СУММА(ЕСНИсчисленный.единыйплатеж) КАК ЕдиныйПлатеж,
	|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд
	|	ИЗ
	|		РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
	|	
	|	ГДЕ
	|		ЕСНИсчисленный.Период >= &парамНачалоПериода И
	|		ЕСНИсчисленный.Период < &парамКонецПериода И
	|		ЕСНИсчисленный.ОбособленноеПодразделение = &парамОбособленноеПодразделение
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ЕСНИсчисленный.ФизЛицо) КАК ЕСНПоРаботникам";
	ТекстыЗапросовФСЗН.Вставить("ЕСНИсчисленныйТекст", ЕСНИсчисленныйТекст);
	
	ОтраженоЕСНИсчисленногоТекст = 
	"ВЫБРАТЬ
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт1,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт2,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт3,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДтНУ,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДтНУ1,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДтНУ2,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДтНУ3,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКт,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКт1,
	|	СУММА(-(ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Сумма)) КАК Сумма,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКтНУ,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКтНУ1,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКтНУ2,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКтНУ3
	|ИЗ
	|	Документ.ОтражениеЗарплатыВРеглУчете.ОтражениеВУчете КАК ОтражениеЗарплатыВРеглУчетеОтражениеВУчете
	|
	|ГДЕ
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка.ПериодРегистрации >= &парамНачалоПериода И
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка.ПериодРегистрации < &парамНачалоПериода И
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка.Организация = &парамОрганизация И
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКт В ИЕРАРХИИ(&парамСписокСчетовКт) И
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКт1 = &парамСубконтоКт1 И
	|	(ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка.Проведен)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт1,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт2,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт3,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКт,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКт1,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДтНУ,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДтНУ1,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДтНУ2,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДтНУ3,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКтНУ,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКтНУ1,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКтНУ2,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКтНУ3";
	ТекстыЗапросовФСЗН.Вставить("ОтраженоЕСНИсчисленногоТекст", ОтраженоЕСНИсчисленногоТекст);
	Возврат ТекстыЗапросовФСЗН;
	
КонецФункции  //Островская Татьяна 02.10.2013 № 16828


// Получает значение субконто в том случае, если заданы правила его переопределения
//
// Параметры
//  Субконто - начальное значение субконто
//  ПараметрыПолученияСубконто - соответсвие, 
//                              ключ соответсвия - тип, 
//                              значение - параметры, которые помогают преобразовывать 
//                              субконто соотв. типа из одного значения в другое
//
// Возвращаемое значение:
//   Субконто
// Если для субконто некоторого типа не задаы параметры преобразования, то его 
// значение не изменяется
//
Функция ПолучитьСубконто(Субконто, ПараметрыПолученияСубконто)
	Параметры = ПараметрыПолученияСубконто[ТипЗнч(Субконто)];
	Если Параметры = НеОпределено Тогда
		// для субконто этого типа не заданы парамтры переопределения
		Возврат Субконто;
	КонецЕсли;
	// для статьи затрат
	Если ТипЗнч(Субконто) = Тип("СправочникСсылка.СтатьиЗатрат") Тогда
		ВидСтатьиЗатрат = Параметры.ВидСтатьиЗатрат;
		ДополнительныеСтатьиЗатрат = Параметры.ДополнительныеСтатьиЗатрат;
		КлючПоиска = Новый Структура("ВидСтатьиЗатрат, СтатьяЗатратНачисления", ВидСтатьиЗатрат, Субконто);
		Строки = ДополнительныеСтатьиЗатрат.НайтиСтроки(КлючПоиска);
		Если Строки.Количество() = 0 Тогда
			КлючПоиска = Новый Структура("ВидСтатьиЗатрат, СтатьяЗатратНачисления", ВидСтатьиЗатрат, Справочники.СтатьиЗатрат.ПустаяСсылка());
			Строки = ДополнительныеСтатьиЗатрат.НайтиСтроки(КлючПоиска);
			Если Строки.Количество() = 0 Тогда
				Возврат Субконто;
			Иначе
				Возврат Строки[0].СтатьяЗатрат;
			КонецЕсли;
		Иначе
			Возврат Строки[0].СтатьяЗатрат;
		КонецЕсли;
		// для получения субконто другого типа - дописываем ИначеЕсли...
	Иначе
		Возврат Субконто;
	КонецЕсли;
	
КонецФункции

// Возвращает доступные варианты печати документа
//
// Вовращаемое значение:
//	Струткура, каждая строка которой соответствует одному из вариантов печати
//
Функция ПолучитьСтруктуруПечатныхФорм() Экспорт
	
	СтруктураМакетов = Новый Структура;
	СтруктураМакетов.Вставить("РаспределениеЗарплаты",	"Распределение зарплаты");
	СтруктураМакетов.Вставить("ВедомостьУдержаний",		"Ведомость удержаний");
	СтруктураМакетов.Вставить("КнигаХозяйственныхОпераций",		"Книга хозяйственных операций");
	СтруктураМакетов.Вставить("КнигаХозяйственныхОперацийПодробно",		"Книга хозяйственных операций (подробно)");
	//	СтруктураМакетов.Вставить("Макет",		"Сотрудник ФСЗН");//Островская Татьяна 02.10.2013 № 16828
	СтруктураМакетов.Вставить("Макет1",		"ФСЗН и БГС по сотрудникам (4-ая закладка)");//Аверсон 26.08.2020 КВВ СВФР-006325
	СтруктураМакетов.Вставить("Макет",		"ФСЗН и БГС по сотрудникам из ""Расчет взносов с ФОТ""");//Аверсон 19.08.2020 КВВ СВФР-006325
	
	//Аверсон 11.07.2023 КВВ СВФР-010889 (
	Если Организация.ИНН = "100194961" Тогда  //Виток
		СтруктураМакетов.Вставить("ВедомостьРаспределенияФОТПоСчетам_Виток","Ведомость распределения ФОТ по счетам"); 
		СтруктураМакетов.Вставить("ВедомостьРаспределенияФОТПоСчетам_Виток_Расш","Ведомость распределения ФОТ по счетам (расшифровка)");
	КонецЕсли;
	//Аверсон 11.07.2023 КВВ СВФР-010889 )
	
	Возврат СтруктураМакетов;
	
КонецФункции // ПолучитьСтруктуруПечатныхФорм()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ

// Функция получает список начислений и последовательность обработки
// при получении данных
//
// Возвращаемое значение:
//  ТаблицаЗначений
//
Функция ПолучитьТаблицуНачислений()
	
	Запрос = Новый Запрос;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	""Основные"" КАК ВидНачисления,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.ВидРасчета.КатегорияНачисления = ЗНАЧЕНИЕ(Справочник.КатегорииРасчетов.Первичное)
	|			ТОГДА 0
	|		КОГДА ОсновныеНачисления.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуБЛ)
	|			ТОГДА ОсновныеНачисления.ВидРасчета.КатегорияНачисления.Код
	|		КОГДА ОсновныеНачисления.ВидРасчета.СтратегияОтраженияВУчете <> ЗНАЧЕНИЕ(Перечисление.СтратегииОтраженияВРеглУчетеНачислений.КакБазовыеНачисления)
	|			ТОГДА 0
	|		ИНАЧЕ ОсновныеНачисления.ВидРасчета.КатегорияНачисления.Код
	|	КОНЕЦ КАК ПорядокРасчета,
	|	ОсновныеНачисления.ВидРасчета
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		ОсновныеНачисления.ВидРасчета КАК ВидРасчета
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|	ГДЕ
	|		ОсновныеНачисления.ПериодРегистрации = &ПериодРегистрации
	|		И ОсновныеНачисления.ОбособленноеПодразделение = &Организация) КАК ОсновныеНачисления
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Дополнительные"",
	|	ВЫБОР
	|		КОГДА ДополнительныеНачисления.ВидРасчета.КатегорияНачисления = ЗНАЧЕНИЕ(Справочник.КатегорииРасчетов.Первичное)
	|				ИЛИ ДополнительныеНачисления.ВидРасчета.СтратегияОтраженияВУчете <> ЗНАЧЕНИЕ(Перечисление.СтратегииОтраженияВРеглУчетеНачислений.КакБазовыеНачисления)
	|			ТОГДА 0
	|		ИНАЧЕ ДополнительныеНачисления.ВидРасчета.КатегорияНачисления.Код
	|	КОНЕЦ,
	|	ДополнительныеНачисления.ВидРасчета
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		ДополнительныеНачисления.ВидРасчета КАК ВидРасчета
	|	ИЗ
	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
	|	ГДЕ
	|		НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &ПериодРегистрации
	|		И ДополнительныеНачисления.ОбособленноеПодразделение = &Организация) КАК ДополнительныеНачисления
	|
	|УПОРЯДОЧИТЬ ПО
	|	ПорядокРасчета";
	
	Запрос.Текст = ТекстЗапроса;
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	Запрос.УстановитьПараметр("Организация", Организация); 
	
	ТаблицаНачислений = Запрос.Выполнить().Выгрузить();	
	
	Возврат ТаблицаНачислений;
	
КонецФункции // ПолучитьТаблицуНачислений()

// автозаполнение субконто по данным строки 
Процедура АвтозаполнениеСубконто(ДанныеУчета, СтрокаДанных, ПустойСчет)
	// если не пустой счет - заполним "автозаполняемые" субконто
	
	//Аверсон ЕАЕ 26.09.2025 СВФР-016787
	
	//Аверсон ЕАЕ 30.10.2025 СВФР-017064
	//Если Организация.ИНН = "790041382" Тогда
		Если СтрокаДанных.СчетДт <> ПустойСчет Тогда
			Если (ТипЗнч(СтрокаДанных.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций") 
				
				//Аверсон ЕАЕ 12.12.2025 СВФР-017608
				ИЛИ (СтрокаДанных.СубконтоДт1 = НЕОПРЕДЕЛЕНО И ВидСубконтоСчетаПроверка(СтрокаДанных.СчетДт, 1, ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения) = Истина))
				//Аверсон СВФР-017608
				
				//Аверсон ЕАЕ 05.12.2025 СВФР-017538
				И НЕ ЗначениеЗаполнено(СтрокаДанных.СубконтоДт1) Тогда
				//Аверсон СВФР-017538
				
				СтрокаДанных.СубконтоДт1 = ДанныеУчета.ПодразделениеОрганизации;	
			КонецЕсли;
			Если (ТипЗнч(СтрокаДанных.СубконтоДт2) = Тип("СправочникСсылка.ПодразделенияОрганизаций")
				
				//Аверсон ЕАЕ 12.12.2025 СВФР-017608
				ИЛИ (СтрокаДанных.СубконтоДт2 = НЕОПРЕДЕЛЕНО И ВидСубконтоСчетаПроверка(СтрокаДанных.СчетДт, 2, ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения) = Истина))
				//Аверсон СВФР-017608
				
				//Аверсон ЕАЕ 05.12.2025 СВФР-017538
				И НЕ ЗначениеЗаполнено(СтрокаДанных.СубконтоДт2) Тогда
				//Аверсон СВФР-017538
				
				СтрокаДанных.СубконтоДт2 = ДанныеУчета.ПодразделениеОрганизации;	
			КонецЕсли;
			Если (ТипЗнч(СтрокаДанных.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций")
				
				//Аверсон ЕАЕ 12.12.2025 СВФР-017608
				ИЛИ (СтрокаДанных.СубконтоДт3 = НЕОПРЕДЕЛЕНО И ВидСубконтоСчетаПроверка(СтрокаДанных.СчетДт, 3, ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения) = Истина))
				//Аверсон СВФР-017608
				
				//Аверсон ЕАЕ 05.12.2025 СВФР-017538
				И НЕ ЗначениеЗаполнено(СтрокаДанных.СубконтоДт3) Тогда
				//Аверсон СВФР-017538
				
				СтрокаДанных.СубконтоДт3 = ДанныеУчета.ПодразделениеОрганизации;	
			КонецЕсли;

			Если ТипЗнч(СтрокаДанных.СубконтоДт1) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
				СтрокаДанных.СубконтоДт1 = ДанныеУчета.Физлицо;	
			КонецЕсли;
			Если ТипЗнч(СтрокаДанных.СубконтоДт2) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
				СтрокаДанных.СубконтоДт2 = ДанныеУчета.Физлицо;	
			КонецЕсли;
			Если ТипЗнч(СтрокаДанных.СубконтоДт3) = Тип("СправочникСсылка.ФизическиеЛица") Тогда
				СтрокаДанных.СубконтоДт3 = ДанныеУчета.Физлицо;	
			КонецЕсли;
		КонецЕсли;
	//Иначе
	//	//Аверсон СВФР-016787
	//	Если ДанныеУчета.СчетДт <> ПустойСчет Тогда
	//		Если ДанныеУчета.НомерСубконтоРаботникиДт <> 0 
	//			И НЕ ЗначениеЗаполнено(ДанныеУчета["СубконтоДт" + ДанныеУчета.НомерСубконтоРаботникиДт]) Тогда
	//			СтрокаДанных["СубконтоДт" + ДанныеУчета.НомерСубконтоРаботникиДт] = ДанныеУчета.Физлицо;
	//		КонецЕсли;
	//		//Если ДанныеУчета.НомерСубконтоРаботникиДтНУ <> 0 
	//		//	И НЕ ЗначениеЗаполнено(ДанныеУчета["СубконтоДтНУ" + ДанныеУчета.НомерСубконтоРаботникиДтНУ]) Тогда
	//		//		СтрокаДанных["СубконтоДтНУ" + ДанныеУчета.НомерСубконтоРаботникиДтНУ] = ДанныеУчета.Физлицо;
	//		//КонецЕсли;
	//		Если ДанныеУчета.НомерСубконтоПодразделенияДт <> 0 
	//			И НЕ ЗначениеЗаполнено(ДанныеУчета["СубконтоДт" + ДанныеУчета.НомерСубконтоПодразделенияДт]) Тогда
	//			СтрокаДанных["СубконтоДт" + ДанныеУчета.НомерСубконтоПодразделенияДт] = ДанныеУчета.ПодразделениеОрганизации;
	//		КонецЕсли;
	//		//Если ДанныеУчета.НомерСубконтоПодразделенияДтНУ <> 0 
	//		//	и НЕ ЗначениеЗаполнено(ДанныеУчета["СубконтоДтНУ" + ДанныеУчета.НомерСубконтоПодразделенияДтНУ]) Тогда
	//		//		СтрокаДанных["СубконтоДтНУ" + ДанныеУчета.НомерСубконтоПодразделенияДтНУ] = ДанныеУчета.ПодразделениеОрганизации;
	//		//КонецЕсли;
	//	КонецЕсли;
	//КонецЕсли;
	//Аверсон СВФР-017064
	
	Если ДанныеУчета.СчетКт <> ПустойСчет Тогда
		Если ДанныеУчета.НомерСубконтоРаботникиКт <> 0 
			и НЕ ЗначениеЗаполнено(ДанныеУчета["СубконтоКт" + ДанныеУчета.НомерСубконтоРаботникиКт]) Тогда
			СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоРаботникиКт] = ДанныеУчета.Физлицо;
		КонецЕсли;
		//Если ДанныеУчета.НомерСубконтоРаботникиКтНУ <> 0 
		//  	и НЕ ЗначениеЗаполнено(ДанныеУчета["СубконтоКтНУ" + ДанныеУчета.НомерСубконтоРаботникиКтНУ]) Тогда
		//  		СтрокаДанных["СубконтоКтНУ" + ДанныеУчета.НомерСубконтоРаботникиКтНУ] = ДанныеУчета.Физлицо;
		//  КонецЕсли;
	КонецЕсли;
	Если организация.ИНН = "806000046"  Тогда
		Если ЗначениеЗаполнено(ДанныеУчета.Сотрудник.ПодразделениеОрганизацииДляЗатрат) Тогда
			ПодразделениеОрганизацииДляЗатрат =ДанныеУчета.Сотрудник.ПодразделениеОрганизацииДляЗатрат; 
			Если ТипЗнч(СтрокаДанных.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций")Тогда
				СтрокаДанных.СубконтоДт1 = ПодразделениеОрганизацииДляЗатрат;
			ИначеЕсли ТипЗнч(СтрокаДанных.СубконтоДт2) = Тип("СправочникСсылка.ПодразделенияОрганизаций")Тогда
				СтрокаДанных.СубконтоДт2 = ПодразделениеОрганизацииДляЗатрат;					
			ИначеЕсли ТипЗнч(СтрокаДанных.СубконтоДт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций")Тогда
				СтрокаДанных.СубконтоДт3 = ПодразделениеОрганизацииДляЗатрат;
			ИначеЕсли ТипЗнч(СтрокаДанных.СубконтоКт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций")Тогда
				СтрокаДанных.СубконтоКт1 = ПодразделениеОрганизацииДляЗатрат;
			ИначеЕсли ТипЗнч(СтрокаДанных.СубконтоКт2) = Тип("СправочникСсылка.ПодразделенияОрганизаций")Тогда
				СтрокаДанных.СубконтоКт2 = ПодразделениеОрганизацииДляЗатрат;
			ИначеЕсли ТипЗнч(СтрокаДанных.СубконтоКт3) = Тип("СправочникСсылка.ПодразделенияОрганизаций")Тогда
				СтрокаДанных.СубконтоКт3 = ПодразделениеОрганизацииДляЗатрат;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры  // АвтозаполнениеСубконто

// Выделяет коэффициенты отражения из массива переданных строк отражения
//
// Параметры
//  МассивСтрокОтражения - массив строк таблицы значений
//  ИмяКолонки - строка - имя колонки таблицы значений, содержащей 
//                 коэффициенты отражения
//
// Возвращаемое значение:
//   массив чисел - коэффициентов отражения
//
Функция ВыделитьКоэффициентыОтраженияИзМассиваСтрок(МассивСтрокОтражения,ИмяКолонки)
	
	Коэффициенты = Новый Массив;
	
	Для каждого СтрокаОтражения Из МассивСтрокОтражения Цикл
		Коэффициенты.Добавить(СтрокаОтражения[ИмяКолонки]);
	КонецЦикла; 
	
	Возврат Коэффициенты
КонецФункции // ВыделитьКоэффициентыОтраженияИзМассиваСтрок()

Процедура ИзмененияПоСубконтоВитка(Стр,Счет1,Счет2,НомГруппа,ЗаменаТолькоНомГрупп = ЛОЖЬ)
	//Аверсон 15.07.2023 КВВ СВФР-010889 (
	
	КолвоСубконтоСтар1 = Стр.СчетДт.ВидыСубконто.Количество();
	КолвоСубконтоСтар2 = Стр.СчетДтНУ.ВидыСубконто.Количество();
	КолвоСубконтоНов1 = Счет1.ВидыСубконто.Количество();
	КолвоСубконтоНов2 = Счет2.ВидыСубконто.Количество();
	
	Если НЕ ЗаменаТолькоНомГрупп Тогда
		//заполняем пустые ссылки по старым видам субконто ( 
		Для А = 1 ПО КолвоСубконтоСтар1 Цикл
			Если Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
			ИначеЕсли Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
				Стр["СубконтоДт" + Строка(А)] = Справочники.СтатьиЗатрат.ПустаяСсылка();
			ИначеЕсли Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
				Стр["СубконтоДт" + Строка(А)] = Справочники.НоменклатурныеГруппы.ПустаяСсылка();	
			КонецЕсли;
		КонецЦикла;
		
		Для А = 1 ПО КолвоСубконтоСтар2 Цикл
			Если Стр.СчетДтНУ.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
			ИначеЕсли Стр.СчетДтНУ.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
				Стр["СубконтоДтНУ" + Строка(А)] = Справочники.СтатьиЗатрат.ПустаяСсылка();
			ИначеЕсли Стр.СчетДтНУ.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
				Стр["СубконтоДтНУ" + Строка(А)] = Справочники.НоменклатурныеГруппы.ПустаяСсылка();	
			КонецЕсли;
		КонецЦикла;
		//заполняем пустые ссылки по старым видам субконто )
	КонецЕсли;
	
	//заполняем новые данные по видам субконто (
	Стр.СчетДт = Счет1;
	Для А = 1 ПО КолвоСубконтоНов1 Цикл
		Если Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
		ИначеЕсли Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
		ИначеЕсли Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
			Стр["СубконтоДт" + Строка(А)] = НомГруппа;	
		КонецЕсли;
	КонецЦикла;
	Стр.СчетДтНУ = Счет2;
	Для А = 1 ПО КолвоСубконтоНов2 Цикл
		Если Стр.СчетДтНУ.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
		ИначеЕсли Стр.СчетДтНУ.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
		ИначеЕсли Стр.СчетДтНУ.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
			Стр["СубконтоДтНУ" + Строка(А)] = НомГруппа;	
		КонецЕсли;
	КонецЦикла;
	//заполняем новые данные по видам субконто )
	
	//Аверсон 15.07.2023 КВВ СВФР-010889 )
КонецПроцедуры

// получение  данных для бухучета
// Параметры:
//  СписокНачислений - список начислений, которве необходимо обработать
//  ЭтоОсновныеНачисления - булево, если Истина, то получаем данные по основным начислениям иначе - по доп.
//
// Возвращаемое значение:
//  Результат запроса
// 
Функция ПолучитьДанныеУчета(СписокНачислений, ЭтоОсновныеНачисления, ЭтоПервичныеНачисления)
	
	Запрос = Новый Запрос;
	
	Измерения = Новый Массив(1);
	Измерения[0] = "Сотрудник";
	
	Запрос.УстановитьПараметр("парамИзмерения", Измерения);
	
	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
	
	Запрос.УстановитьПараметр("парамСписокНачислений", СписокНачислений);
	Запрос.УстановитьПараметр("парамПериодРегистрации", ПериодРегистрации);
	Запрос.УстановитьПараметр("парамОрганизация", Организация);
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ОбщегоНазначения.ГоловнаяОрганизация(Организация));
	Запрос.УстановитьПараметр("парамЕстьЕНВД", мЕНВД);
	
	Разрезы = Новый Массив(16);
	Разрезы[0] = "СчетДт";
	Разрезы[1] = "СубконтоДт1";
	Разрезы[2] = "СубконтоДт2";
	Разрезы[3] = "СубконтоДт3";
	Разрезы[4] = "СчетКт";
	Разрезы[5] = "СубконтоКт1";
	Разрезы[6] = "СубконтоКт2";
	Разрезы[7] = "СубконтоКт3";
	Разрезы[8] = "СчетДтНУ";
	Разрезы[9] = "СубконтоДтНУ1";
	Разрезы[10] = "СубконтоДтНУ2";
	Разрезы[11] = "СубконтоДтНУ3";
	Разрезы[12] = "СчетКтНУ";
	Разрезы[13] = "СубконтоКтНУ1";
	Разрезы[14] = "СубконтоКтНУ2";
	Разрезы[15] = "СубконтоКтНУ3";
	//Разрезы[16] = "СчетКтУСН";
	//Разрезы[17] = "ОтражениеВУСН";	
	
	Запрос.УстановитьПараметр("парамРазрезыБУ", Разрезы);
	
	Запрос.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамПустойСчет", ПланыСчетов.Хозрасчетный.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамПустойСчетНУ", ПланыСчетов.Налоговый.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамРаботники", ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.РаботникиОрганизации);
	Запрос.УстановитьПараметр("ВидНачисленийОплатыТрудаПоСтатье255НК", ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.ВидНачисленийОплатыТрудаПоСтатье255НК);
	Запрос.УстановитьПараметр("парамПодразделения", ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения);
	Запрос.УстановитьПараметр("парамСтатьиЗатрат", ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат);
	
	СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	
	Запрос.УстановитьПараметр("парамСпособПоУмолчанию", СпособПоУмолчанию);
	Запрос.УстановитьПараметр("парамСпособНеОтражать", Справочники.СпособыОтраженияЗарплатыВРеглУчете.НеОтражатьВБухучете);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетКт", СпособПоУмолчанию.СчетКт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт1", СпособПоУмолчанию.СубконтоКт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт2", СпособПоУмолчанию.СубконтоКт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт3", СпособПоУмолчанию.СубконтоКт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетНУ", СпособПоУмолчанию.СчетДтНУ);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетКтНУ", СпособПоУмолчанию.СчетКтНУ);	
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ1", СпособПоУмолчанию.СубконтоКтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ2", СпособПоУмолчанию.СубконтоКтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ3", СпособПоУмолчанию.СубконтоКтНУ3);	
	
	Запрос.УстановитьПараметр("парамКатегорияПервичная", Справочники.КатегорииРасчетов.Первичное);
	
	МассивПоСреднемуЗаработку = Новый Массив;
	МассивПоСреднемуЗаработку.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку);
	МассивПоСреднемуЗаработку.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
	МассивПоСреднемуЗаработку.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке);
	МассивПоСреднемуЗаработку.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	МассивПоСреднемуЗаработку.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ДоплатаДоСреднегоЗаработка);
	Запрос.УстановитьПараметр("парамПоСреднемуЗаработку", МассивПоСреднемуЗаработку);
	
	//толик убрал сделку
	//МассивСдельныйЗаработок = Новый Массив;
	//МассивСдельныйЗаработок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок);
	//МассивСдельныйЗаработок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СдельныйПриработок);
	//МассивСдельныйЗаработок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СделкаПоЧасовойТарифнойСтавке);
	Запрос.УстановитьПараметр("парамСдельныйЗаработокОсн", ПрочиеПроцедуры.СформироватьСписокНачисленийСдельнойОплаты("ОсновныеНачисленияОрганизаций"));
	Запрос.УстановитьПараметр("парамСдельныйЗаработокДоп", ПрочиеПроцедуры.СформироватьСписокНачисленийСдельнойОплаты("ДополнительныеНачисленияОрганизаций"));
	
	Запрос.УстановитьПараметр("СпособРасчетаПоСреднемуЗаработкуФСС", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	
	Запрос.УстановитьПараметр("СпособРасчетаПоСреднемуЗаработкуФСС", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	
	МассивПричиныНетрудоспособности = Новый Массив;
	МассивПричиныНетрудоспособности.Добавить(Перечисления.ПричиныНетрудоспособности.ПоБеременностиИРодам);
	МассивПричиныНетрудоспособности.Добавить(Перечисления.ПричиныНетрудоспособности.ПособиеБезЗаболевания);
	МассивПричиныНетрудоспособности.Добавить(Перечисления.ПричиныНетрудоспособности.ОбщееЗаболевание);
	МассивПричиныНетрудоспособности.Добавить(Перечисления.ПричиныНетрудоспособности.ПоУходу);
	МассивПричиныНетрудоспособности.Добавить(Перечисления.ПричиныНетрудоспособности.ЛиквидаторамЧАЭС);
	МассивПричиныНетрудоспособности.Добавить(Перечисления.ПричиныНетрудоспособности.ТравмаНаПроизводстве);
	Запрос.УстановитьПараметр("ПричиныНетрудоспособности", МассивПричиныНетрудоспособности);
	
	Запрос.УстановитьПараметр("ПоДням", Перечисления.ВидыУчетаВремени.ПоДням);
	Запрос.УстановитьПараметр("ПоЗаработку", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработку);
	Запрос.УстановитьПараметр("ПоЗаработкуБЛ", ПланыВидовРасчета.СреднийЗаработок.ПоЗаработкуБЛ);
	Запрос.УстановитьПараметр("ПоПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоПремиям);
	Запрос.УстановитьПараметр("ПоФиксПремиям", ПланыВидовРасчета.СреднийЗаработок.ПоФиксПремиям);
	
	Запрос.УстановитьПараметр("ДатаЗакона202ФЗ", '20050101');
	
	//Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	НачатьТранзакцию();
	
	Если ЭтоОсновныеНачисления Тогда
		
		Если Не ЭтоПервичныеНачисления Тогда
			
			//толик	счет подразделение
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	&парамГоловнаяОрганизация КАК ГоловнаяОрганизация,
			|	ДанныеУчета.Регистратор КАК Регистратор,
			|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
			|	ДанныеУчета.Сотрудник,
			|	ДанныеУчета.ФизЛицо,
			|	ДанныеУчета.СчетДт,
			|	ДанныеУчета.СубконтоДт1,
			|	ДанныеУчета.СубконтоДт2,
			|	ДанныеУчета.СубконтоДт3,
			|	ДанныеУчета.СчетКт,
			|	ДанныеУчета.СубконтоКт1,
			|	ДанныеУчета.СубконтоКт2,
			|	ДанныеУчета.СубконтоКт3,
			|	ДанныеУчета.СчетДтНУ,
			|	ДанныеУчета.СчетКтНУ,
			|	ДанныеУчета.СубконтоДтНУ1,
			|	ДанныеУчета.СубконтоДтНУ2,
			|	ДанныеУчета.СубконтоДтНУ3,
			|	ДанныеУчета.СубконтоКтНУ1,
			|	ДанныеУчета.СубконтоКтНУ2,
			|	ДанныеУчета.СубконтоКтНУ3,
			|	ДанныеУчета.ВидРасчета,
			|	ДанныеУчета.ВидРасчета.СпособРасчета КАК СпособРасчета,
			|	ДанныеУчета.ВидРасчета.ВидНачисленияПоСт255НК КАК ВидНачисленияПоСт255НК,
			|	ДанныеУчета.ПодразделениеОрганизации,
			|	ДанныеУчета.Результат,
			|	ДанныеУчета.ПериодДействияНачало,
			|	ДанныеУчета.ПериодДействияКонец,
			|	ДанныеУчета.ГрафикРаботы,
			|	ДанныеУчета.ВидУчетаВремени,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоРаботникиДт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоРаботникиДт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоРаботникиДт,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоРаботникиКт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоРаботникиКт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоРаботникиКт,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоПодразделенияДт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоПодразделенияДт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоПодразделенияДт,
			//|	ВЫБОР
			//|		КОГДА ВидыСубконтоСтатьиЗатратДт.НомерСтроки ЕСТЬ NULL 
			//|			ТОГДА 0
			//|		ИНАЧЕ ВидыСубконтоСтатьиЗатратДт.НомерСтроки
			//|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДт,
			|	ВЫБОР
			|		КОГДА СубконтоСт255НК.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ СубконтоСт255НК.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоСт255НК,
			|	ВЫБОР
			|		КОГДА База.СчетДтРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетДтРазрез
			|		ИНАЧЕ База.СчетДтРазрез
			|	КОНЕЦ КАК СчетДтРазрез,
			|	ВЫБОР
			|		КОГДА База.СчетКтРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетКтРазрез
			|		ИНАЧЕ База.СчетКтРазрез
			|	КОНЕЦ КАК СчетКтРазрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт1Разрез
			|		ИНАЧЕ База.СубконтоДт1Разрез
			|	КОНЕЦ КАК СубконтоДт1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт2Разрез
			|		ИНАЧЕ База.СубконтоДт2Разрез
			|	КОНЕЦ КАК СубконтоДт2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт3Разрез
			|		ИНАЧЕ База.СубконтоДт3Разрез
			|	КОНЕЦ КАК СубконтоДт3Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт1Разрез
			|		ИНАЧЕ База.СубконтоКт1Разрез
			|	КОНЕЦ КАК СубконтоКт1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт2Разрез
			|		ИНАЧЕ База.СубконтоКт2Разрез
			|	КОНЕЦ КАК СубконтоКт2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт3Разрез
			|		ИНАЧЕ База.СубконтоКт3Разрез
			|	КОНЕЦ КАК СубконтоКт3Разрез,
			|	ВЫБОР
			|		КОГДА База.СчетДтНУРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетДтНУРазрез
			|		ИНАЧЕ База.СчетДтНУРазрез
			|	КОНЕЦ КАК СчетДтНУРазрез,
			|	ВЫБОР
			|		КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|		ИНАЧЕ База.СчетКтНУРазрез
			|	КОНЕЦ КАК СчетКтНУРазрез,
			|	ВЫБОР
			|		КОГДА СубконтоСт255НКБазы.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ СубконтоСт255НКБазы.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоСт255НКБазы,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ1Разрез
			|		ИНАЧЕ База.СубконтоДтНУ1Разрез
			|	КОНЕЦ КАК СубконтоДтНУ1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ2Разрез
			|		ИНАЧЕ База.СубконтоДтНУ2Разрез
			|	КОНЕЦ КАК СубконтоДтНУ2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ3Разрез
			|		ИНАЧЕ База.СубконтоДтНУ3Разрез
			|	КОНЕЦ КАК СубконтоДтНУ3Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ1Разрез
			|		ИНАЧЕ База.СубконтоКтНУ1Разрез
			|	КОНЕЦ КАК СубконтоКтНУ1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ2Разрез
			|		ИНАЧЕ База.СубконтоКтНУ2Разрез
			|	КОНЕЦ КАК СубконтоКтНУ2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ3Разрез
			|		ИНАЧЕ База.СубконтоКтНУ3Разрез
			|	КОНЕЦ КАК СубконтоКтНУ3Разрез,
			|	ВЫБОР
			|		КОГДА База.РезультатБаза ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.РезультатБаза
			|		ИНАЧЕ База.РезультатБаза
			|	КОНЕЦ КАК РезультатБаза
			|ИЗ
			|	(ВЫБРАТЬ
			|		ОсновныеНачисления.Регистратор КАК Регистратор,
			|		ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|		ОсновныеНачисления.Сотрудник КАК Сотрудник,
			|		ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДт
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
			|		КОНЕЦ КАК СчетДт,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКт
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКт
			|		КОНЕЦ КАК СчетКт,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
			|		КОНЕЦ КАК СубконтоДт1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
			|		КОНЕЦ КАК СубконтоДт2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
			|		КОНЕЦ КАК СубконтоДт3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт1
			|		КОНЕЦ КАК СубконтоКт1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт2
			|		КОНЕЦ КАК СубконтоКт2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт3
			|		КОНЕЦ КАК СубконтоКт3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
			|		КОНЕЦ КАК СчетДтНУ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКтНУ
			|		КОНЕЦ КАК СчетКтНУ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
			|		КОНЕЦ КАК СубконтоДтНУ1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
			|		КОНЕЦ КАК СубконтоДтНУ2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
			|		КОНЕЦ КАК СубконтоДтНУ3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ1
			|		КОНЕЦ КАК СубконтоКтНУ1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ2
			|		КОНЕЦ КАК СубконтоКтНУ2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ3
			|		КОНЕЦ КАК СубконтоКтНУ3,
			|		ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
			|		ОсновныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			|		ОсновныеНачисления.Результат КАК Результат,
			|		ОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало,
			|		ОсновныеНачисления.ПериодДействияКонец КАК ПериодДействияКонец,
			|		ОсновныеНачисления.ГрафикРаботы КАК ГрафикРаботы,
			|		ОсновныеНачисления.ВидУчетаВремени КАК ВидУчетаВремени
			|	ИЗ
			|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					ОсновныеНачисления.Сотрудник КАК Сотрудник,
			|					ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|					ОсновныеНачисления.Организация КАК Организация,
			|					ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
			|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
			|				ИЗ
			|					РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
			|						ПО ОсновныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
			|							И ОсновныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
			|							И ОсновныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
			|							И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ОсновныеНачисления.ПериодДействияНачало
			|				ГДЕ
			|					ВЫБОР
			|							КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|								ТОГДА ОсновныеНачисления.Организация
			|							ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|						КОНЕЦ = &парамОрганизация
			|					И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|				
			|				СГРУППИРОВАТЬ ПО
			|					ОсновныеНачисления.Сотрудник,
			|					ОсновныеНачисления.Сотрудник.Физлицо,
			|					ОсновныеНачисления.Организация,
			|					ОсновныеНачисления.ВидРасчета) КАК СведенияОНачисленияхСрез
			|				ПО СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
			|					И СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
			|					И СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
			|					И СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период
			|			ПО РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ОсновныеНачисления.Сотрудник
			|				И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ОсновныеНачисления.Организация
			|				И РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ОсновныеНачисления.ВидРасчета
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.БУОсновныеНачисления КАК БУОсновныеНачисления
			|			ПО БУОсновныеНачисления.Сотрудник = ОсновныеНачисления.Сотрудник
			|				И БУОсновныеНачисления.Организация = ОсновныеНачисления.Организация
			|				И БУОсновныеНачисления.ВидРасчета = ОсновныеНачисления.ВидРасчета
			|				И БУОсновныеНачисления.ПериодДействияНачало = ОсновныеНачисления.ПериодДействияНачало
			|				И БУОсновныеНачисления.ПериодДействияКонец = ОсновныеНачисления.ПериодДействияКонец
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&парамПериодРегистрации, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
			|			ПО ОсновныеНачисления.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&парамПериодРегистрации) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних //О.Т. Аверсон 26.01.2018 № 1502
			|			ПО ОсновныеНачисления.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Сотрудник
			|			И ОсновныеНачисления.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Организация
			
			|ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	ВложенныйЗапрос.Сотрудник КАК Сотрудник,
			|	ВложенныйЗапрос.ФизЛицо КАК ФизЛицо,
			|	ВложенныйЗапрос.Организация КАК Организация,
			|	ВложенныйЗапрос.Период КАК Период,
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|	ВложенныйЗапрос.ВидРасчета,
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|	ВложенныйЗапрос.ПериодДействияНачало КАК ПериодДействияНачало,
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			//|	УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете КАК СпособОтраженияВБухучете
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|	ISNULL( УточненияСО.СпособОтражения, 
			|	УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете ) КАК СпособОтраженияВБухучете
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|ИЗ
			|	(ВЫБРАТЬ
			|		ОсновныеНачисления.Сотрудник КАК Сотрудник,
			|		ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|		ОсновныеНачисления.Организация КАК Организация,
			|		МАКСИМУМ(УчетЗарВРеглУчете.Период) КАК Период,
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		ОсновныеНачисления.ВидРасчета,
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		ОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало
			|	ИЗ
			|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетЗарВРеглУчете
			|			ПО ОсновныеНачисления.Сотрудник = УчетЗарВРеглУчете.Сотрудник
			|				И ОсновныеНачисления.Организация = УчетЗарВРеглУчете.Организация
			|				И (УчетЗарВРеглУчете.Период <= ОсновныеНачисления.ПериодДействияНачало)
			|	ГДЕ
			|		ВЫБОР
			|				КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|					ТОГДА ОсновныеНачисления.Организация
			|				ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|			КОНЕЦ = &парамОрганизация
			|		И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|	
			|	СГРУППИРОВАТЬ ПО
			|		ОсновныеНачисления.Сотрудник,
			|		ОсновныеНачисления.Сотрудник.Физлицо,
			|		ОсновныеНачисления.Организация,
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		ОсновныеНачисления.ВидРасчета,
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		ОсновныеНачисления.ПериодДействияНачало) КАК ВложенныйЗапрос
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
			|		ПО ВложенныйЗапрос.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
			|			И ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
			|			И ВложенныйЗапрос.Период = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СпособыОтраженияЗарплатыВРеглУчете.УточненияСпособаОтраженияПоВидамРасчета КАК УточненияСО
			|		ПО УточненияСО.Ссылка = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете
			|			И УточненияСО.ВидРасчета = ВложенныйЗапрос.ВидРасчета
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|					) КАК СведенияОРаботникахСрез
			|ПО ОсновныеНачисления.Сотрудник = СведенияОРаботникахСрез.Сотрудник
			|	И ОсновныеНачисления.Организация = СведенияОРаботникахСрез.Организация
			|	И ОсновныеНачисления.ПериодДействияНачало = СведенияОРаботникахСрез.ПериодДействияНачало
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|	И ОсновныеНачисления.ВидРасчета = СведенияОРаботникахСрез.ВидРасчета
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|	ГДЕ
			|		БУОсновныеНачисления.Сотрудник ЕСТЬ NULL 
			|		И ВЫБОР
			|				КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|					ТОГДА ОсновныеНачисления.Организация
			|				ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|			КОНЕЦ = &парамОрганизация
			|		И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|		И (ВЫБОР
			|					КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|						ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт
			|					КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|						ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДт
			|					КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|						ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДт
			|					ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
			|				КОНЕЦ = &парамПустойСчет
			|				ИЛИ ВЫБОР
			|					КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|						ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт
			|					КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|						ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКт
			|					КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|						ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКт
			|					ИНАЧЕ &парамСпособПоУмолчаниюСчетКт
			|				КОНЕЦ = &парамПустойСчет)
			|		И ВЫБОР
			|				КОГДА ОсновныеНачисления.ВидРасчета.ПериодДействияБазовый
			|					ТОГДА ОсновныеНачисления.ПериодДействияКонец
			|				ИНАЧЕ ВЫБОР
			|						КОГДА ОсновныеНачисления.ВидРасчета.СпособРасчета В (&парамПоСреднемуЗаработку)
			|							ТОГДА ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание
			|						ИНАЧЕ ОсновныеНачисления.БазовыйПериодКонец
			|					КОНЕЦ
			|			КОНЕЦ >= &парамПериодРегистрации
			|		И ОсновныеНачисления.ВидРасчета В(&парамСписокНачислений)
			|		И ВЫБОР
			|				КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете
			|				КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете
			|				КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете
			|				ИНАЧЕ &парамСпособПоУмолчанию
			|			КОНЕЦ <> &парамСпособНеОтражать
			//толик		
			//		|		ОсновныеНачисления.ВидРасчета.СпособРасчета НЕ В (&парамСдельныйЗаработок)) КАК ДанныеУчета
			|		И ОсновныеНачисления.ВидРасчета НЕ В (&парамСдельныйЗаработокОсн)) КАК ДанныеУчета
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиДт
			|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетДт = ВидыСубконтоРаботникиДт.Ссылка
			|			И (ВидыСубконтоРаботникиДт.ВидСубконто = &парамРаботники)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиКт
			|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетКт = ВидыСубконтоРаботникиКт.Ссылка
			|			И (ВидыСубконтоРаботникиКт.ВидСубконто = &парамРаботники)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоПодразделенияДт
			|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетДт = ВидыСубконтоПодразделенияДт.Ссылка
			|			И (ВидыСубконтоПодразделенияДт.ВидСубконто = &парамПодразделения)
			//|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоСтатьиЗатратДт
			//|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			//|			И ДанныеУчета.СчетДт = ВидыСубконтоСтатьиЗатратДт.Ссылка
			//|			И (ВидыСубконтоСтатьиЗатратДт.ВидСубконто = &парамСтатьиЗатрат)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК СубконтоСт255НК
			|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ)
			|			И ДанныеУчета.СчетКтНУ = СубконтоСт255НК.Ссылка
			|			И (СубконтоСт255НК.ВидСубконто = &ВидНачисленийОплатыТрудаПоСтатье255НК)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаБУОсновныеНачисления(
			|				&парамИзмерения,
			|				&парамИзмерения,
			|				&парамРазрезыБУ,
			|				ВЫБОР
			|						КОГДА ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|							ТОГДА Организация
			|						ИНАЧЕ ПодразделениеОрганизации.Владелец
			|					КОНЕЦ = &парамОрганизация
			|					И ПериодРегистрации = &парамПериодРегистрации
			|					И ВЫБОР
			|						КОГДА ВидРасчета.ПериодДействияБазовый
			|							ТОГДА ПериодДействияКонец
			|						ИНАЧЕ БазовыйПериодКонец
			|					КОНЕЦ >= &парамПериодРегистрации
			|					И ВидРасчета В (&парамСписокНачислений)) КАК База
			|		ПО (ДанныеУчета.СчетДт = &парамПустойСчет
			|				ИЛИ ДанныеУчета.СчетКт = &парамПустойСчет)
			|			И ДанныеУчета.Регистратор = База.Регистратор
			|			И ДанныеУчета.НомерСтроки = База.НомерСтроки
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ОсновныеНачисления.Регистратор КАК Регистратор,
			|			ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез КАК СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез КАК СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез КАК СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез КАК СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
			|			СУММА(ВЫБОР
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработку
			|							ИЛИ БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
			|						ТОГДА БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоФиксПремиям
			|						ТОГДА ВЫБОР
			|								КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|									ТОГДА 0
			|								ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|										КОГДА БазаСреднегоЗаработка.НормаПоПятидневке = 0
			|											ТОГДА 0
			|										ИНАЧЕ БазаСреднегоЗаработка.ОтработаноПоПятидневке / БазаСреднегоЗаработка.НормаПоПятидневке * ВЫБОР
			|												КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|													ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|												ИНАЧЕ 1
			|											КОНЕЦ
			|									КОНЕЦ
			|							КОНЕЦ
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоПремиям
			|						ТОГДА ВЫБОР
			|								КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|									ТОГДА 0
			|								ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|										КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|											ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|										ИНАЧЕ 1
			|									КОНЕЦ
			|							КОНЕЦ
			|					КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|						ТОГДА 0
			|					ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * ВЫБОР
			|							КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|								ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|							ИНАЧЕ 1
			|						КОНЕЦ
			|				КОНЕЦ) КАК РезультатБаза
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.РасчетСреднегоЗаработка.БазаБУОсновныеНачисления(&парамИзмерения, &парамИзмерения, &парамРазрезыБУ, ПериодРегистрации = &парамПериодРегистрации) КАК БазаСреднегоЗаработка
			|				ПО БазаСреднегоЗаработка.Сотрудник = ОсновныеНачисления.Сотрудник
			|					И БазаСреднегоЗаработка.СпособРасчета = ОсновныеНачисления.ВидРасчета.СпособРасчета
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало = БазаСреднегоЗаработка.ДатаНачалаРасчетногоПериода
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание = БазаСреднегоЗаработка.ДатаОкончанияРасчетногоПериода
			|					И ОсновныеНачисления.Организация = БазаСреднегоЗаработка.Организация
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|						ТОГДА ОсновныеНачисления.Организация
			|					ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|				КОНЕЦ = &парамОрганизация
			|			И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|			И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание >= &парамПериодРегистрации
			|			И ОсновныеНачисления.ВидРасчета В(&парамСписокНачислений)
			|			И ОсновныеНачисления.ВидРасчета.СпособРасчета В(&парамПоСреднемуЗаработку)
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисления.Регистратор,
			|			ОсновныеНачисления.НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез
			|		
			|		ОБЪЕДИНИТЬ ВСЕ
			|		
			|		ВЫБРАТЬ
			|			ОсновныеНачисления.Регистратор,
			|			ОсновныеНачисления.НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез,
			|			СУММА(ВЫБОР
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработку
			|							ИЛИ БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
			|						ТОГДА БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоФиксПремиям
			|						ТОГДА ВЫБОР
			|								КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|									ТОГДА 0
			|								ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|										КОГДА БазаСреднегоЗаработка.НормаПоПятидневке = 0
			|											ТОГДА 0
			|										ИНАЧЕ БазаСреднегоЗаработка.ОтработаноПоПятидневке / БазаСреднегоЗаработка.НормаПоПятидневке * ВЫБОР
			|												КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|													ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|												ИНАЧЕ 1
			|											КОНЕЦ
			|									КОНЕЦ
			|							КОНЕЦ
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоПремиям
			|						ТОГДА ВЫБОР
			|								КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|									ТОГДА 0
			|								ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|										КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|											ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|										ИНАЧЕ 1
			|									КОНЕЦ
			|							КОНЕЦ
			|					КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|						ТОГДА 0
			|					ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * ВЫБОР
			|							КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|								ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|							ИНАЧЕ 1
			|						КОНЕЦ
			|				КОНЕЦ)
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.РасчетСреднегоЗаработка.БазаБУДополнительныеНачисления(&парамИзмерения, &парамИзмерения, &парамРазрезыБУ, ПериодРегистрации = &парамПериодРегистрации) КАК БазаСреднегоЗаработка
			|				ПО БазаСреднегоЗаработка.Сотрудник = ОсновныеНачисления.Сотрудник
			|					И БазаСреднегоЗаработка.СпособРасчета = ОсновныеНачисления.ВидРасчета.СпособРасчета
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало = БазаСреднегоЗаработка.ДатаНачалаРасчетногоПериода
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание = БазаСреднегоЗаработка.ДатаОкончанияРасчетногоПериода
			|					И ОсновныеНачисления.Организация = БазаСреднегоЗаработка.Организация
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|						ТОГДА ОсновныеНачисления.Организация
			|					ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|				КОНЕЦ = &парамОрганизация
			|			И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|			И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание >= &парамПериодРегистрации
			|			И ОсновныеНачисления.ВидРасчета В(&парамСписокНачислений)
			|			И ОсновныеНачисления.ВидРасчета.СпособРасчета В(&парамПоСреднемуЗаработку)
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисления.Регистратор,
			|			ОсновныеНачисления.НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез) КАК БазаСреднегоЗаработка
			|		ПО ДанныеУчета.Регистратор = БазаСреднегоЗаработка.Регистратор
			|			И ДанныеУчета.НомерСтроки = БазаСреднегоЗаработка.НомерСтроки
			|			И (ДанныеУчета.СчетДт = &парамПустойСчет
			|				ИЛИ ДанныеУчета.СчетКт = &парамПустойСчет)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК СубконтоСт255НКБазы
			|		ПО (ВЫБОР
			|				КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|					ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|				ИНАЧЕ База.СчетКтНУРазрез
			|			КОНЕЦ <> &парамПустойСчетНУ)
			|			И (ВЫБОР
			|				КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|					ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|				ИНАЧЕ База.СчетКтНУРазрез
			|			КОНЕЦ = СубконтоСт255НКБазы.Ссылка)
			|			И (СубконтоСт255НКБазы.ВидСубконто = &ВидНачисленийОплатыТрудаПоСтатье255НК)";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ТекстЗапроса = ТекстЗапроса + "
				|		ГДЕ
				|		ДанныеУчета.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";			
			КонецЕсли;
			ТекстЗапроса = ТекстЗапроса + "
			
			|
			|УПОРЯДОЧИТЬ ПО
			|	ДанныеУчета.Сотрудник.Физлицо.Наименование,
			|	Регистратор,
			|	НомерСтроки";
			
		Иначе	
			//толик			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	&парамГоловнаяОрганизация КАК ГоловнаяОрганизация,
			|	ДанныеУчета.Регистратор КАК Регистратор,
			|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
			|	ДанныеУчета.Сотрудник,
			|	ДанныеУчета.ФизЛицо,
			|	ДанныеУчета.СчетДт,
			|	ДанныеУчета.СубконтоДт1,
			|	ДанныеУчета.СубконтоДт2,
			|	ДанныеУчета.СубконтоДт3,
			|	ДанныеУчета.СчетКт,
			|	ДанныеУчета.СубконтоКт1,
			|	ДанныеУчета.СубконтоКт2,
			|	ДанныеУчета.СубконтоКт3,
			|	ДанныеУчета.СчетДтНУ,
			|	ДанныеУчета.СчетКтНУ,
			|	ДанныеУчета.СубконтоДтНУ1,
			|	ДанныеУчета.СубконтоДтНУ2,
			|	ДанныеУчета.СубконтоДтНУ3,
			|	ДанныеУчета.СубконтоКтНУ1,
			|	ДанныеУчета.СубконтоКтНУ2,
			|	ДанныеУчета.СубконтоКтНУ3,
			|	ДанныеУчета.ВидРасчета,
			|	ДанныеУчета.Сторно,
			|	ДанныеУчета.СпособРасчета,
			|	ДанныеУчета.ВидНачисленияПоСт255НК,
			|	ДанныеУчета.ПодразделениеОрганизации,
			|	ДанныеУчета.Результат,
			|	ДанныеУчета.ПериодДействияНачало,
			|	ДанныеУчета.ПериодДействияКонец,
			|	ДанныеУчета.ГрафикРаботы,
			|	ДанныеУчета.ВидУчетаВремени,
			//|	ВЫБОР
			//|		КОГДА ДанныеУчета.СчетДт <> &парамПустойСчет
			//|					И ДанныеУчета.СчетКт <> &парамПустойСчет
			//|				ИЛИ ДанныеУчета.КонецБазовогоПериода < &парамПериодРегистрации
			//|				ИЛИ ДанныеУчета.ВидРасчета.КатегорияНачисления = &парамКатегорияПервичная
			//|			ТОГДА NULL
			//|		ИНАЧЕ ДанныеУчета.ВидРасчета.КатегорияНачисления
			//|	КОНЕЦ КАК КатегорияНачисления,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоРаботникиДт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоРаботникиДт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоРаботникиДт,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоРаботникиКт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоРаботникиКт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоРаботникиКт,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоПодразделенияДт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоПодразделенияДт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоПодразделенияДт,
			//|	ВЫБОР
			//|		КОГДА ВидыСубконтоСтатьиЗатратДт.НомерСтроки ЕСТЬ NULL 
			//|			ТОГДА 0
			//|		ИНАЧЕ ВидыСубконтоСтатьиЗатратДт.НомерСтроки
			//|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДт,
			|	ВЫБОР
			|		КОГДА СубконтоСт255НК.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ СубконтоСт255НК.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоСт255НК,
			|	ВЫБОР
			|		КОГДА База.СчетДтРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетДтРазрез
			|		ИНАЧЕ База.СчетДтРазрез
			|	КОНЕЦ КАК СчетДтРазрез,
			|	ВЫБОР
			|		КОГДА База.СчетКтРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетКтРазрез
			|		ИНАЧЕ База.СчетКтРазрез
			|	КОНЕЦ КАК СчетКтРазрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт1Разрез
			|		ИНАЧЕ База.СубконтоДт1Разрез
			|	КОНЕЦ КАК СубконтоДт1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт2Разрез
			|		ИНАЧЕ База.СубконтоДт2Разрез
			|	КОНЕЦ КАК СубконтоДт2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт3Разрез
			|		ИНАЧЕ База.СубконтоДт3Разрез
			|	КОНЕЦ КАК СубконтоДт3Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт1Разрез
			|		ИНАЧЕ База.СубконтоКт1Разрез
			|	КОНЕЦ КАК СубконтоКт1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт2Разрез
			|		ИНАЧЕ База.СубконтоКт2Разрез
			|	КОНЕЦ КАК СубконтоКт2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт3Разрез
			|		ИНАЧЕ База.СубконтоКт3Разрез
			|	КОНЕЦ КАК СубконтоКт3Разрез,
			|	ВЫБОР
			|		КОГДА База.СчетДтНУРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетДтНУРазрез
			|		ИНАЧЕ База.СчетДтНУРазрез
			|	КОНЕЦ КАК СчетДтНУРазрез,
			|	ВЫБОР
			|		КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|		ИНАЧЕ База.СчетКтНУРазрез
			|	КОНЕЦ КАК СчетКтНУРазрез,
			|	ВЫБОР
			|		КОГДА СубконтоСт255НКБазы.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ СубконтоСт255НКБазы.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоСт255НКБазы,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ1Разрез
			|		ИНАЧЕ База.СубконтоДтНУ1Разрез
			|	КОНЕЦ КАК СубконтоДтНУ1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ2Разрез
			|		ИНАЧЕ База.СубконтоДтНУ2Разрез
			|	КОНЕЦ КАК СубконтоДтНУ2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ3Разрез
			|		ИНАЧЕ База.СубконтоДтНУ3Разрез
			|	КОНЕЦ КАК СубконтоДтНУ3Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ1Разрез
			|		ИНАЧЕ База.СубконтоКтНУ1Разрез
			|	КОНЕЦ КАК СубконтоКтНУ1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ2Разрез
			|		ИНАЧЕ База.СубконтоКтНУ2Разрез
			|	КОНЕЦ КАК СубконтоКтНУ2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ3Разрез
			|		ИНАЧЕ База.СубконтоКтНУ3Разрез
			|	КОНЕЦ КАК СубконтоКтНУ3Разрез,
			|	ВЫБОР
			|		КОГДА База.РезультатБаза ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.РезультатБаза
			|		ИНАЧЕ База.РезультатБаза
			|	КОНЕЦ КАК РезультатБаза
			|ИЗ
			|	(ВЫБРАТЬ
			|		ОсновныеНачисления.Регистратор КАК Регистратор,
			|		ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|		ОсновныеНачисления.Сотрудник КАК Сотрудник,
			|		ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|		ВЫБОР
			|			КОГДА ОсновныеНачисления.ВидРасчета.ПериодДействияБазовый
			|				ТОГДА ОсновныеНачисления.ПериодДействияКонец
			|			ИНАЧЕ ВЫБОР
			|					КОГДА ОсновныеНачисления.ВидРасчета.СпособРасчета В (&парамПоСреднемуЗаработку)
			|						ТОГДА ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание
			|					ИНАЧЕ ОсновныеНачисления.БазовыйПериодКонец
			|				КОНЕЦ
			|		КОНЕЦ КАК КонецБазовогоПериода,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДт
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
			|		КОНЕЦ КАК СчетДт,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКт
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКт
			|		КОНЕЦ КАК СчетКт,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
			|		КОНЕЦ КАК СубконтоДт1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
			|		КОНЕЦ КАК СубконтоДт2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
			|		КОНЕЦ КАК СубконтоДт3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт1
			|		КОНЕЦ КАК СубконтоКт1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт2
			|		КОНЕЦ КАК СубконтоКт2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт3
			|		КОНЕЦ КАК СубконтоКт3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
			|		КОНЕЦ КАК СчетДтНУ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКтНУ
			|		КОНЕЦ КАК СчетКтНУ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
			|		КОНЕЦ КАК СубконтоДтНУ1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
			|		КОНЕЦ КАК СубконтоДтНУ2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
			|		КОНЕЦ КАК СубконтоДтНУ3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ1
			|		КОНЕЦ КАК СубконтоКтНУ1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ2
			|		КОНЕЦ КАК СубконтоКтНУ2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ3
			|		КОНЕЦ КАК СубконтоКтНУ3,
			|		ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
			|		ОсновныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			|		ОсновныеНачисления.Результат КАК Результат,
			|		ОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало,
			|		ОсновныеНачисления.ПериодДействияКонец КАК ПериодДействияКонец,
			|		ОсновныеНачисления.Сторно КАК Сторно,
			|		ОсновныеНачисления.ГрафикРаботы КАК ГрафикРаботы,
			|		ОсновныеНачисления.ВидУчетаВремени КАК ВидУчетаВремени,
			|		ОсновныеНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
			|		ОсновныеНачисления.ВидРасчета.ВидНачисленияПоСт255НК КАК ВидНачисленияПоСт255НК
			|	ИЗ
			|РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ОсновныеНачисления.Сотрудник КАК Сотрудник,
			|			ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|			ОсновныеНачисления.Организация КАК Организация,
			|			ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
			|			МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
			|				ПО ОсновныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
			|					И ОсновныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
			|					И ОсновныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
			|					И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ОсновныеНачисления.ПериодДействияНачало)
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|						ТОГДА ОсновныеНачисления.Организация
			|					ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|				КОНЕЦ = &парамОрганизация
			|			И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисления.Сотрудник,
			|			ОсновныеНачисления.Сотрудник.Физлицо,
			|			ОсновныеНачисления.Организация,
			|			ОсновныеНачисления.ВидРасчета) КАК СведенияОНачисленияхСрез
			|		ПО (СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник)
			|			И (СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета)
			|			И (СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период)
			|	ПО (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ОсновныеНачисления.Сотрудник)
			|		И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ОсновныеНачисления.Организация)
			|		И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ОсновныеНачисления.ВидРасчета)
			|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.БУОсновныеНачисления КАК БУОсновныеНачисления
			|	ПО (БУОсновныеНачисления.Сотрудник = ОсновныеНачисления.Сотрудник)
			|		И (БУОсновныеНачисления.ВидРасчета = ОсновныеНачисления.ВидРасчета)
			|		И (БУОсновныеНачисления.ПериодДействияНачало = ОсновныеНачисления.ПериодДействияНачало)
			|		И (БУОсновныеНачисления.ПериодДействияКонец = ОсновныеНачисления.ПериодДействияКонец)
			|		И ОсновныеНачисления.Организация = БУОсновныеНачисления.Организация
			|		И (БУОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации)
			|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&парамПериодРегистрации, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
			|	ПО ОсновныеНачисления.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&парамПериодРегистрации) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних //О.Т. Аверсон 26.01.2018 № 1502
			|			ПО ОсновныеНачисления.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Сотрудник
			|			И ОсновныеНачисления.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Организация
			
			|	ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|		ВложенныйЗапрос.Сотрудник КАК Сотрудник,
			|		ВложенныйЗапрос.ФизЛицо КАК ФизЛицо,
			|		ВложенныйЗапрос.Организация КАК Организация,
			|		ВложенныйЗапрос.Период КАК Период,
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		ВложенныйЗапрос.ВидРасчета,
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		ВложенныйЗапрос.ПериодДействияНачало КАК ПериодДействияНачало,
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			//|		УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете КАК СпособОтраженияВБухучете
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		ISNULL( УточненияСО.СпособОтражения, 
			|		УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете ) КАК СпособОтраженияВБухучете
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|	ИЗ
			|		(ВЫБРАТЬ
			|			ОсновныеНачисления.Сотрудник КАК Сотрудник,
			|			ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|			ОсновныеНачисления.Организация КАК Организация,
			|			МАКСИМУМ(УчетЗарВРеглУчете.Период) КАК Период,
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|			ОсновныеНачисления.ВидРасчета,
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|			ОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетЗарВРеглУчете
			|				ПО ОсновныеНачисления.Сотрудник = УчетЗарВРеглУчете.Сотрудник
			|					И ОсновныеНачисления.Организация = УчетЗарВРеглУчете.Организация
			|					И (УчетЗарВРеглУчете.Период <= ОсновныеНачисления.ПериодДействияНачало)
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|						ТОГДА ОсновныеНачисления.Организация
			|					ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|				КОНЕЦ = &парамОрганизация
			|			И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисления.Сотрудник,
			|			ОсновныеНачисления.Сотрудник.Физлицо,
			|			ОсновныеНачисления.Организация,
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|			ОсновныеНачисления.ВидРасчета,
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|			ОсновныеНачисления.ПериодДействияНачало
			|		) КАК ВложенныйЗапрос
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
			|			ПО ВложенныйЗапрос.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
			|				И ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
			|				И ВложенныйЗапрос.Период = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|			ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СпособыОтраженияЗарплатыВРеглУчете.УточненияСпособаОтраженияПоВидамРасчета КАК УточненияСО
			|			ПО УточненияСО.Ссылка = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете
			|				И УточненияСО.ВидРасчета = ВложенныйЗапрос.ВидРасчета
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|					) КАК СведенияОРаботникахСрез
			|	ПО ОсновныеНачисления.Сотрудник = СведенияОРаботникахСрез.Сотрудник
			|		И ОсновныеНачисления.Организация = СведенияОРаботникахСрез.Организация
			|		И ОсновныеНачисления.ПериодДействияНачало = СведенияОРаботникахСрез.ПериодДействияНачало
			//+ СВЭЙ КДЯ 15.10.19 СВФР-004591
			|		И ОсновныеНачисления.ВидРасчета = СведенияОРаботникахСрез.ВидРасчета
			//- СВЭЙ КДЯ 15.10.19 СВФР-004591
			|	ГДЕ
			|		БУОсновныеНачисления.Сотрудник ЕСТЬ NULL 
			|		И ВЫБОР
			|				КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|					ТОГДА ОсновныеНачисления.Организация
			|				ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|			КОНЕЦ = &парамОрганизация
			|		И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|		И ВЫБОР
			|				КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете
			|				КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете
			|				КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете
			|				ИНАЧЕ &парамСпособПоУмолчанию
			|			КОНЕЦ <> &парамСпособНеОтражать
			//толик		
			//		|		И ОсновныеНачисления.ВидРасчета.СпособРасчета НЕ В (&парамСдельныйЗаработок)) КАК ДанныеУчета
			|		И ОсновныеНачисления.ВидРасчета НЕ В (&парамСдельныйЗаработокОсн)) КАК ДанныеУчета
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиДт
			|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетДт = ВидыСубконтоРаботникиДт.Ссылка
			|			И (ВидыСубконтоРаботникиДт.ВидСубконто = &парамРаботники)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиКт
			|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетКт = ВидыСубконтоРаботникиКт.Ссылка
			|			И (ВидыСубконтоРаботникиКт.ВидСубконто = &парамРаботники)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоПодразделенияДт
			|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетДт = ВидыСубконтоПодразделенияДт.Ссылка
			|			И (ВидыСубконтоПодразделенияДт.ВидСубконто = &парамПодразделения)
			//|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоСтатьиЗатратДт
			//|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			//|			И ДанныеУчета.СчетДт = ВидыСубконтоСтатьиЗатратДт.Ссылка
			//|			И (ВидыСубконтоСтатьиЗатратДт.ВидСубконто = &парамСтатьиЗатрат)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК СубконтоСт255НК
			|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ)
			|			И ДанныеУчета.СчетКтНУ = СубконтоСт255НК.Ссылка
			|			И (СубконтоСт255НК.ВидСубконто = &ВидНачисленийОплатыТрудаПоСтатье255НК)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.БазаБУОсновныеНачисления(
			|				&парамИзмерения,
			|				&парамИзмерения,
			|				&парамРазрезыБУ,
			|				ВЫБОР
			|						КОГДА ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|							ТОГДА Организация
			|						ИНАЧЕ ПодразделениеОрганизации.Владелец
			|					КОНЕЦ = &парамОрганизация
			|					И ПериодРегистрации = &парамПериодРегистрации
			|					И (НЕ ВидРасчета.СпособРасчета В (&парамПоСреднемуЗаработку))
			|					И БазовыйПериодКонец < &парамПериодРегистрации) КАК База
			|		ПО (ДанныеУчета.СчетДт = &парамПустойСчет
			|				ИЛИ ДанныеУчета.СчетКт = &парамПустойСчет)
			|			И ДанныеУчета.Регистратор = База.Регистратор
			|			И ДанныеУчета.НомерСтроки = База.НомерСтроки
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ОсновныеНачисления.Регистратор КАК Регистратор,
			|			ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез КАК СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез КАК СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез КАК СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез КАК СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
			|			СУММА(ВЫБОР
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработку
			|							ИЛИ БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
			|						ТОГДА БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоФиксПремиям
			|						ТОГДА ВЫБОР
			|								КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|									ТОГДА 0
			|								ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|										КОГДА БазаСреднегоЗаработка.НормаПоПятидневке = 0
			|											ТОГДА 0
			|										ИНАЧЕ БазаСреднегоЗаработка.ОтработаноПоПятидневке / БазаСреднегоЗаработка.НормаПоПятидневке * ВЫБОР
			|												КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|													ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|												ИНАЧЕ 1
			|											КОНЕЦ
			|									КОНЕЦ
			|							КОНЕЦ
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоПремиям
			|						ТОГДА ВЫБОР
			|								КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|									ТОГДА 0
			|								ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|										КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|											ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|										ИНАЧЕ 1
			|									КОНЕЦ
			|							КОНЕЦ
			|					КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|						ТОГДА 0
			|					ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * ВЫБОР
			|							КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|								ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|							ИНАЧЕ 1
			|						КОНЕЦ
			|				КОНЕЦ) КАК РезультатБаза
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.РасчетСреднегоЗаработка.БазаБУОсновныеНачисления(&парамИзмерения, &парамИзмерения, &парамРазрезыБУ, ПериодРегистрации = &парамПериодРегистрации) КАК БазаСреднегоЗаработка
			|				ПО БазаСреднегоЗаработка.Сотрудник = ОсновныеНачисления.Сотрудник
			|					И БазаСреднегоЗаработка.СпособРасчета = ОсновныеНачисления.ВидРасчета.СпособРасчета
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало = БазаСреднегоЗаработка.ДатаНачалаРасчетногоПериода
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание = БазаСреднегоЗаработка.ДатаОкончанияРасчетногоПериода
			|					И ОсновныеНачисления.Организация = БазаСреднегоЗаработка.Организация
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|						ТОГДА ОсновныеНачисления.Организация
			|					ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|				КОНЕЦ = &парамОрганизация
			|			И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|			И ОсновныеНачисления.ВидРасчета.СпособРасчета В(&парамПоСреднемуЗаработку)
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисления.Регистратор,
			|			ОсновныеНачисления.НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез
			|		
			|		ОБЪЕДИНИТЬ ВСЕ
			|		
			|		ВЫБРАТЬ
			|			ОсновныеНачисления.Регистратор,
			|			ОсновныеНачисления.НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез,
			|			СУММА(ВЫБОР
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработку
			|							ИЛИ БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
			|						ТОГДА БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоФиксПремиям
			|						ТОГДА ВЫБОР
			|								КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|									ТОГДА 0
			|								ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|										КОГДА БазаСреднегоЗаработка.НормаПоПятидневке = 0
			|											ТОГДА 0
			|										ИНАЧЕ БазаСреднегоЗаработка.ОтработаноПоПятидневке / БазаСреднегоЗаработка.НормаПоПятидневке * ВЫБОР
			|												КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|													ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|												ИНАЧЕ 1
			|											КОНЕЦ
			|									КОНЕЦ
			|							КОНЕЦ
			|					КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоПремиям
			|						ТОГДА ВЫБОР
			|								КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|									ТОГДА 0
			|								ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|										КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|											ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|										ИНАЧЕ 1
			|									КОНЕЦ
			|							КОНЕЦ
			|					КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|						ТОГДА 0
			|					ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * ВЫБОР
			|							КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|								ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|							ИНАЧЕ 1
			|						КОНЕЦ
			|				КОНЕЦ)
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.РасчетСреднегоЗаработка.БазаБУДополнительныеНачисления(&парамИзмерения, &парамИзмерения, &парамРазрезыБУ, ПериодРегистрации = &парамПериодРегистрации) КАК БазаСреднегоЗаработка
			|				ПО БазаСреднегоЗаработка.Сотрудник = ОсновныеНачисления.Сотрудник
			|					И БазаСреднегоЗаработка.СпособРасчета = ОсновныеНачисления.ВидРасчета.СпособРасчета
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало = БазаСреднегоЗаработка.ДатаНачалаРасчетногоПериода
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание = БазаСреднегоЗаработка.ДатаОкончанияРасчетногоПериода
			|					И ОсновныеНачисления.Организация = БазаСреднегоЗаработка.Организация
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|						ТОГДА ОсновныеНачисления.Организация
			|					ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|				КОНЕЦ = &парамОрганизация
			|			И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|			И ОсновныеНачисления.ВидРасчета.СпособРасчета В(&парамПоСреднемуЗаработку)
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисления.Регистратор,
			|			ОсновныеНачисления.НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез) КАК БазаСреднегоЗаработка
			|		ПО ДанныеУчета.Регистратор = БазаСреднегоЗаработка.Регистратор
			|			И ДанныеУчета.НомерСтроки = БазаСреднегоЗаработка.НомерСтроки
			|			И (ДанныеУчета.СчетДт = &парамПустойСчет
			|				ИЛИ ДанныеУчета.СчетКт = &парамПустойСчет)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК СубконтоСт255НКБазы
			|		ПО (ВЫБОР
			|				КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|					ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|				ИНАЧЕ База.СчетКтНУРазрез
			|			КОНЕЦ <> &парамПустойСчетНУ)
			|			И (ВЫБОР
			|				КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|					ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|				ИНАЧЕ База.СчетКтНУРазрез
			|			КОНЕЦ = СубконтоСт255НКБазы.Ссылка)
			|			И (СубконтоСт255НКБазы.ВидСубконто = &ВидНачисленийОплатыТрудаПоСтатье255НК)
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ДатыАктуальностиММОТ.Регистратор КАК Регистратор,
			|			ДатыАктуальностиММОТ.НомерСтроки КАК ОсновнойНомерСтроки,
			|			МинимальнаяОплатаТрудаРФ.Размер КАК Размер
			|		ИЗ
			|			(ВЫБРАТЬ
			|				ОсновныеНачисления.Регистратор КАК Регистратор,
			|				ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|				МАКСИМУМ(МинимальнаяОплатаТрудаРФ.Период) КАК ДатаАктуальности
			|			ИЗ
			|				РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МинимальнаяОплатаТрудаРФ КАК МинимальнаяОплатаТрудаРФ
			|					ПО МинимальнаяОплатаТрудаРФ.Период <= ОсновныеНачисления.ПериодДействияНачало
			|			ГДЕ
			|				ВЫБОР
			|						КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|							ТОГДА ОсновныеНачисления.Организация
			|						ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|					КОНЕЦ = &парамОрганизация
			|				И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|				И ОсновныеНачисления.ВидРасчета.СпособРасчета = &СпособРасчетаПоСреднемуЗаработкуФСС
			|			
			|			СГРУППИРОВАТЬ ПО
			|				ОсновныеНачисления.НомерСтроки,
			|				ОсновныеНачисления.Регистратор) КАК ДатыАктуальностиММОТ
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МинимальнаяОплатаТрудаРФ КАК МинимальнаяОплатаТрудаРФ
			|				ПО МинимальнаяОплатаТрудаРФ.Период = ДатыАктуальностиММОТ.ДатаАктуальности) КАК РазмерыММОТ
			|		ПО ДанныеУчета.Регистратор = РазмерыММОТ.Регистратор
			|			И ДанныеУчета.НомерСтроки = РазмерыММОТ.ОсновнойНомерСтроки
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ДанныеГрафика(
			|				ВидРасчета.СпособРасчета = &СпособРасчетаПоСреднемуЗаработкуФСС
			|					И ВЫБОР
			|						КОГДА ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|							ТОГДА Организация
			|						ИНАЧЕ ПодразделениеОрганизации.Владелец
			|					КОНЕЦ = &парамОрганизация
			|					И ПериодРегистрации = &парамПериодРегистрации) КАК ДанныеГрафика
			|		ПО ДанныеУчета.Регистратор = ДанныеГрафика.Регистратор
			|			И ДанныеУчета.НомерСтроки = ДанныеГрафика.НомерСтроки
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ОсновныеНачисления.Регистратор КАК Регистратор,
			|			ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|			ВЫБОР
			|				КОГДА ВЫБОР
			|						КОГДА ОсновныеНачисления.ВидУчетаВремени = &ПоДням
			|							ТОГДА ОсновныеНачисления.НормаДней
			|						ИНАЧЕ ОсновныеНачисления.НормаЧасов
			|					КОНЕЦ = 0
			|					ТОГДА 0
			|				ИНАЧЕ СУММА(ГрафикиРаботыПоВидамВремени.ОсновноеЗначение) / ВЫБОР
			|						КОГДА ОсновныеНачисления.ВидУчетаВремени = &ПоДням
			|							ТОГДА ОсновныеНачисления.НормаДней
			|						ИНАЧЕ ОсновныеНачисления.НормаЧасов
			|					КОНЕЦ
			|			КОНЕЦ КАК ДоляБЛЗаСчетРаботодателя
			|		ИЗ
			|			(ВЫБРАТЬ
			|				ОсновныеНачисления.Регистратор КАК Регистратор,
			|				ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|				ОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало,
			|				ОсновныеНачисления.ПериодДействияКонец КАК ПериодДействияКонец,
			|				ОсновныеНачисления.ГрафикРаботы КАК ГрафикРаботы,
			|				ОсновныеНачисления.ВидУчетаВремени КАК ВидУчетаВремени,
			|				ОсновныеНачисления.НормаДней КАК НормаДней,
			|				ОсновныеНачисления.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
			|				ОсновныеНачисления.НормаЧасов КАК НормаЧасов
			|			ИЗ
			|				РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|			ГДЕ
			|				ВЫБОР
			|						КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|							ТОГДА ОсновныеНачисления.Организация
			|						ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|					КОНЕЦ = &парамОрганизация
			|				И ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|				И ОсновныеНачисления.ВидРасчета.СпособРасчета = &СпособРасчетаПоСреднемуЗаработкуФСС
			|				И (НЕ ОсновныеНачисления.Регистратор.ПричинаНетрудоспособности В (&ПричиныНетрудоспособности))
			|				И РАЗНОСТЬДАТ(ОсновныеНачисления.ДатаНачалаСобытия, ОсновныеНачисления.ПериодДействияНачало, ДЕНЬ) < 2
			|				И ОсновныеНачисления.ДатаНачалаСобытия >= &ДатаЗакона202ФЗ) КАК ОсновныеНачисления
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
			|				ПО ОсновныеНачисления.ГрафикРаботы = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
			|					И ОсновныеНачисления.ВидУчетаВремени = ГрафикиРаботыПоВидамВремени.ВидУчетаВремени
			|					И ОсновныеНачисления.ПериодДействияНачало <= ГрафикиРаботыПоВидамВремени.Дата
			|					И (ДОБАВИТЬКДАТЕ(ОсновныеНачисления.ДатаНачалаСобытия, ДЕНЬ, 1) >= ГрафикиРаботыПоВидамВремени.Дата)
			|					И ОсновныеНачисления.ПериодДействияКонец >= ГрафикиРаботыПоВидамВремени.Дата
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисления.Регистратор,
			|			ОсновныеНачисления.ВидУчетаВремени,
			|			ОсновныеНачисления.НормаЧасов,
			|			ОсновныеНачисления.НормаДней,
			|			ОсновныеНачисления.НомерСтроки) КАК ДанныеУчетаБЛ
			|		ПО ДанныеУчета.Регистратор = ДанныеУчетаБЛ.Регистратор
			|			И ДанныеУчета.НомерСтроки = ДанныеУчетаБЛ.НомерСтроки";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ТекстЗапроса = ТекстЗапроса + "
				|		ГДЕ
				|		ДанныеУчета.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";			
			КонецЕсли;
			ТекстЗапроса = ТекстЗапроса + "
			|
			|УПОРЯДОЧИТЬ ПО
			|	ДанныеУчета.ФизЛицо.Наименование,
			|	Регистратор,
			|	НомерСтроки";
			
		КонецЕсли;	
		
		
	Иначе // Дополнительные начисления
		
		//толик		
		//толик		
		Если Не ЭтоПервичныеНачисления Тогда
			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	&парамГоловнаяОрганизация КАК ГоловнаяОрганизация,
			|	ДанныеУчета.Регистратор КАК Регистратор,
			|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
			|	ДанныеУчета.Сотрудник,
			|	ДанныеУчета.ФизЛицо,
			|	ДанныеУчета.СчетДт,
			|	ДанныеУчета.СубконтоДт1,
			|	ДанныеУчета.СубконтоДт2,
			|	ДанныеУчета.СубконтоДт3,
			|	ДанныеУчета.СчетКт,
			|	ДанныеУчета.СубконтоКт1,
			|	ДанныеУчета.СубконтоКт2,
			|	ДанныеУчета.СубконтоКт3,
			|	ДанныеУчета.СчетДтНУ,
			|	ДанныеУчета.СчетКтНУ,
			|	ДанныеУчета.СубконтоДтНУ1,
			|	ДанныеУчета.СубконтоДтНУ2,
			|	ДанныеУчета.СубконтоДтНУ3,
			|	ДанныеУчета.СубконтоКтНУ1,
			|	ДанныеУчета.СубконтоКтНУ2,
			|	ДанныеУчета.СубконтоКтНУ3,
			|	ДанныеУчета.ВидРасчета,
			|	ДанныеУчета.ВидРасчета.ВидНачисленияПоСт255НК КАК ВидНачисленияПоСт255НК,
			|	ДанныеУчета.ВидРасчета.СпособРасчета КАК СпособРасчета,
			|	ДанныеУчета.ПодразделениеОрганизации,
			|	ДанныеУчета.Результат,
			|	ДанныеУчета.ПериодРегистрации,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоРаботникиДт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоРаботникиДт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоРаботникиДт,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоРаботникиКт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоРаботникиКт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоРаботникиКт,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоПодразделенияДт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоПодразделенияДт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоПодразделенияДт,
			|	ВЫБОР
			|		КОГДА СубконтоСт255НК.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ СубконтоСт255НК.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоСт255НК,
			|	База.СчетДтРазрез,
			|	База.СчетКтРазрез,
			|	База.СубконтоДт1Разрез,
			|	База.СубконтоДт2Разрез,
			|	База.СубконтоДт3Разрез,
			|	База.СубконтоКт1Разрез,
			|	База.СубконтоКт2Разрез,
			|	База.СубконтоКт3Разрез,
			|	База.СчетДтНУРазрез,
			|	База.СчетКтНУРазрез,
			|	ВЫБОР
			|		КОГДА СубконтоСт255НКБазы.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ СубконтоСт255НКБазы.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоСт255НКБазы,
			|	База.СубконтоДтНУ1Разрез,
			|	База.СубконтоДтНУ2Разрез,
			|	База.СубконтоДтНУ3Разрез,
			|	База.СубконтоКтНУ1Разрез,
			|	База.СубконтоКтНУ2Разрез,
			|	База.СубконтоКтНУ3Разрез,
			|	База.РезультатБаза,
			|	ДанныеУчета.ПериодДействияНачало
			|ИЗ
			|	(ВЫБРАТЬ
			|		ДополнительныеНачисления.Регистратор КАК Регистратор,
			|		ДополнительныеНачисления.НомерСтроки КАК НомерСтроки,
			|		ДополнительныеНачисления.Сотрудник КАК Сотрудник,
			|		ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДт
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
			|		КОНЕЦ КАК СчетДт,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКт
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКт
			|		КОНЕЦ КАК СчетКт,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
			|		КОНЕЦ КАК СубконтоДт1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
			|		КОНЕЦ КАК СубконтоДт2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
			|		КОНЕЦ КАК СубконтоДт3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт1
			|		КОНЕЦ КАК СубконтоКт1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт2
			|		КОНЕЦ КАК СубконтоКт2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт3
			|		КОНЕЦ КАК СубконтоКт3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ  
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
			|		КОНЕЦ КАК СчетДтНУ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКтНУ
			|		КОНЕЦ КАК СчетКтНУ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
			|		КОНЕЦ КАК СубконтоДтНУ1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
			|		КОНЕЦ КАК СубконтоДтНУ2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
			|		КОНЕЦ КАК СубконтоДтНУ3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ1
			|		КОНЕЦ КАК СубконтоКтНУ1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ2
			|		КОНЕЦ КАК СубконтоКтНУ2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ3
			|		КОНЕЦ КАК СубконтоКтНУ3,
			|		ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
			|		ДополнительныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			|		ДополнительныеНачисления.Результат КАК Результат,
			|		ДополнительныеНачисления.ПериодРегистрации КАК ПериодРегистрации,
			|		НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ) КАК ПериодДействияНачало
			|	ИЗ
			|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					ДополнительныеНачисления.Сотрудник КАК Сотрудник,
			|					ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|					ДополнительныеНачисления.Организация КАК Организация,
			|					ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
			|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период,
			|					РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете КАК СпособОтраженияВБухучете,
			|					РеглУчетПлановыхНачисленийРаботниковОрганизаций.Регистратор КАК Регистратор
			|				ИЗ
			|					РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
			|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
			|						ПО ДополнительныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
			|							И ДополнительныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
			|							И ДополнительныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
			|							И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ДополнительныеНачисления.ПериодРегистрации)
			|				ГДЕ
			|					ВЫБОР
			|							КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|								ТОГДА ДополнительныеНачисления.Организация
			|							ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
			|						КОНЕЦ = &парамОрганизация
			|					И НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|				
			|				СГРУППИРОВАТЬ ПО
			|					ДополнительныеНачисления.Сотрудник,
			|					ДополнительныеНачисления.Сотрудник.Физлицо,
			|					ДополнительныеНачисления.Организация,
			|					ДополнительныеНачисления.ВидРасчета,
			|					РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете,
			|					РеглУчетПлановыхНачисленийРаботниковОрганизаций.Регистратор) КАК СведенияОНачисленияхСрез
			|				ПО (СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник)
			|					И (СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация)
			|					И (СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета)
			|					И (СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период)
			|					И (СведенияОНачисленияхСрез.СпособОтраженияВБухучете = РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете)
			|			ПО (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ДополнительныеНачисления.Сотрудник)
			|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ДополнительныеНачисления.Организация)
			|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ДополнительныеНачисления.ВидРасчета)
			|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Регистратор = ДополнительныеНачисления.ДокументОснование)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления
			|			ПО (БУДополнительныеНачисления.Сотрудник = ДополнительныеНачисления.Сотрудник)
			|				И (БУДополнительныеНачисления.Организация = ДополнительныеНачисления.Организация)
			|				И (БУДополнительныеНачисления.ВидРасчета = ДополнительныеНачисления.ВидРасчета)
			|				И (БУДополнительныеНачисления.ПериодРегистрации = ДополнительныеНачисления.ПериодРегистрации)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&парамПериодРегистрации, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
			|			ПО ДополнительныеНачисления.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&парамПериодРегистрации) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних  //О.Т. Аверсон 26.01.2018 № 1502
			|			ПО ДополнительныеНачисления.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Сотрудник
			|			И ДополнительныеНачисления.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Организация
			|	ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	ВложенныйЗапрос.Сотрудник КАК Сотрудник,
			|	ВложенныйЗапрос.ФизЛицо КАК ФизЛицо,
			|	ВложенныйЗапрос.Организация КАК Организация,
			|	ВложенныйЗапрос.Период КАК Период,
			|	ВложенныйЗапрос.ПериодДействияНачало КАК ПериодДействияНачало,
			|	УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете КАК СпособОтраженияВБухучете
			|ИЗ
			|	(ВЫБРАТЬ
			|		ДополнительныеНачисления.Сотрудник КАК Сотрудник,
			|		ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|		ДополнительныеНачисления.Организация КАК Организация,
			|		МАКСИМУМ(УчетЗарВРеглУчете.Период) КАК Период,
			|		ДополнительныеНачисления.БазовыйПериодНачало КАК ПериодДействияНачало
			|	ИЗ
			|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетЗарВРеглУчете
			|			ПО ДополнительныеНачисления.Сотрудник = УчетЗарВРеглУчете.Сотрудник
			|				И ДополнительныеНачисления.Организация = УчетЗарВРеглУчете.Организация
			|				И (УчетЗарВРеглУчете.Период <= ДополнительныеНачисления.БазовыйПериодНачало)
			|	ГДЕ
			|		ВЫБОР
			|				КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|					ТОГДА ДополнительныеНачисления.Организация
			|				ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
			|			КОНЕЦ = &парамОрганизация
			|		И ДополнительныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|	
			|	СГРУППИРОВАТЬ ПО
			|		ДополнительныеНачисления.Сотрудник,
			|		ДополнительныеНачисления.Сотрудник.Физлицо,
			|		ДополнительныеНачисления.Организация,
			|		ДополнительныеНачисления.БазовыйПериодНачало) КАК ВложенныйЗапрос
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
			|		ПО ВложенныйЗапрос.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
			|			И ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
			|			И ВложенныйЗапрос.Период = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
			|) КАК СведенияОРаботникахСрез
			|ПО ДополнительныеНачисления.Сотрудник = СведенияОРаботникахСрез.Сотрудник
			|	И ДополнительныеНачисления.Организация = СведенияОРаботникахСрез.Организация
			|	И ДополнительныеНачисления.БазовыйПериодНачало = СведенияОРаботникахСрез.ПериодДействияНачало
			
			|	ГДЕ
			|		БУДополнительныеНачисления.Сотрудник ЕСТЬ NULL 
			|		И ВЫБОР
			|				КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|					ТОГДА ДополнительныеНачисления.Организация
			|				ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
			|			КОНЕЦ = &парамОрганизация
			|		И НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|		И ДополнительныеНачисления.БазовыйПериодКонец >= &парамПериодРегистрации
			|		И ДополнительныеНачисления.ВидРасчета В(&парамСписокНачислений)
			|		И ВЫБОР
			|				КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете
			|				КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете
			|				КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете
			|				ИНАЧЕ &парамСпособПоУмолчанию
			|			КОНЕЦ <> &парамСпособНеОтражать
			|		И НЕ ДополнительныеНачисления.ВидРасчета В (&парамСдельныйЗаработокОсн)) КАК ДанныеУчета
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиДт
			|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетДт = ВидыСубконтоРаботникиДт.Ссылка
			|			И (ВидыСубконтоРаботникиДт.ВидСубконто = &парамРаботники)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиКт
			|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетКт = ВидыСубконтоРаботникиКт.Ссылка
			|			И (ВидыСубконтоРаботникиКт.ВидСубконто = &парамРаботники)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоПодразделенияДт
			|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетДт = ВидыСубконтоПодразделенияДт.Ссылка
			|			И (ВидыСубконтоПодразделенияДт.ВидСубконто = &парамПодразделения)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК СубконтоСт255НК
			|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ)
			|			И ДанныеУчета.СчетКтНУ = СубконтоСт255НК.Ссылка
			|			И (СубконтоСт255НК.ВидСубконто = &ВидНачисленийОплатыТрудаПоСтатье255НК)
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			База.Регистратор КАК Регистратор,
			|			База.НомерСтроки КАК НомерСтроки,
			|			База.СчетДтРазрез КАК СчетДтРазрез,
			|			База.СчетКтРазрез КАК СчетКтРазрез,
			|			База.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
			|			База.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
			|			База.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
			|			База.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
			|			База.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
			|			База.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
			|			База.СчетДтНУРазрез КАК СчетДтНУРазрез,
			|			База.СчетКтНУРазрез КАК СчетКтНУРазрез,
			|			База.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
			|			База.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
			|			База.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
			|			База.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
			|			База.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
			|			База.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
			|			СУММА(База.РезультатБаза) КАК РезультатБаза
			|		ИЗ
			|			(ВЫБРАТЬ
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.Регистратор КАК Регистратор,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.НомерСтроки КАК НомерСтроки,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СчетДтРазрез КАК СчетДтРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СчетКтРазрез КАК СчетКтРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СчетДтНУРазрез КАК СчетДтНУРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СчетКтНУРазрез КАК СчетКтНУРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.РезультатБаза КАК РезультатБаза
			|			ИЗ
			|				РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.БазаБУДополнительныеНачисления(
			|						&парамИзмерения,
			|						&парамИзмерения,
			|						&парамРазрезыБУ,
			|						ВЫБОР
			|								КОГДА ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|									ТОГДА Организация
			|								ИНАЧЕ ПодразделениеОрганизации.Владелец
			|							КОНЕЦ = &парамОрганизация
			|							И НАЧАЛОПЕРИОДА(ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|							И БазовыйПериодКонец >= &парамПериодРегистрации
			|							И ВидРасчета В (&парамСписокНачислений)) КАК ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления
			|			
			|			ОБЪЕДИНИТЬ ВСЕ
			|			
			|			ВЫБРАТЬ
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.Регистратор,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.НомерСтроки,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СчетДтРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СчетКтРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДт1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДт2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДт3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКт1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКт2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКт3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СчетДтНУРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СчетКтНУРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДтНУ1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДтНУ2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДтНУ3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКтНУ1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКтНУ2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКтНУ3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.РезультатБаза
			|			ИЗ
			|				РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.БазаБУОсновныеНачисления(
			|						&парамИзмерения,
			|						&парамИзмерения,
			|						&парамРазрезыБУ,
			|						ВЫБОР
			|								КОГДА ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|									ТОГДА Организация
			|								ИНАЧЕ ПодразделениеОрганизации.Владелец
			|							КОНЕЦ = &парамОрганизация
			|							И НАЧАЛОПЕРИОДА(ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|							И БазовыйПериодКонец >= &парамПериодРегистрации
			|							И ВидРасчета В (&парамСписокНачислений)) КАК ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления) КАК База
			|		
			|		СГРУППИРОВАТЬ ПО
			|			База.Регистратор,
			|			База.НомерСтроки,
			|			База.СчетДтРазрез,
			|			База.СчетКтРазрез,
			|			База.СубконтоДт1Разрез,
			|			База.СубконтоДт2Разрез,
			|			База.СубконтоДт3Разрез,
			|			База.СубконтоКт1Разрез,
			|			База.СубконтоКт2Разрез,
			|			База.СубконтоКт3Разрез,
			|			База.СчетДтНУРазрез,
			|			База.СчетКтНУРазрез,
			|			База.СубконтоДтНУ1Разрез,
			|			База.СубконтоДтНУ2Разрез,
			|			База.СубконтоДтНУ3Разрез,
			|			База.СубконтоКтНУ1Разрез,
			|			База.СубконтоКтНУ2Разрез,
			|			База.СубконтоКтНУ3Разрез) КАК База
			|		ПО (ДанныеУчета.СчетДт = &парамПустойСчет
			|				ИЛИ ДанныеУчета.СчетКт = &парамПустойСчет)
			|			И ДанныеУчета.Регистратор = База.Регистратор
			|			И ДанныеУчета.НомерСтроки = База.НомерСтроки
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК СубконтоСт255НКБазы
			|		ПО (База.СчетКтНУРазрез <> &парамПустойСчетНУ)
			|			И (База.СчетКтНУРазрез = СубконтоСт255НКБазы.Ссылка)
			|			И (СубконтоСт255НКБазы.ВидСубконто = &ВидНачисленийОплатыТрудаПоСтатье255НК)";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ТекстЗапроса = ТекстЗапроса + "
				|		ГДЕ
				|		ДанныеУчета.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";			
			КонецЕсли;
			ТекстЗапроса = ТекстЗапроса + "
			|
			|УПОРЯДОЧИТЬ ПО
			|	ДанныеУчета.ФизЛицо.Наименование,
			|	Регистратор,
			|	НомерСтроки";
			
		Иначе
			
			//толик	
			//Аверсон-софт, Островская Татьяна 16.08.2012 № 15714
			ТекстЗапроса = 
			
			//Аверсон ЕАЕ 23.06.2022 СВФР-009233
			"	ВЫБРАТЬ РАЗЛИЧНЫЕ
			|		ВлЗапрос.Организация,
			|		ВлЗапрос.Сотрудник,
			|		ВлЗапрос.БазовыйПериодНачало,
			|		УчОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете
			|   ПОМЕСТИТЬ ВТСпособы
			|	ИЗ
			|
			|		(ВЫБРАТЬ
			|			ДопНачисления.Сотрудник,
			|			ДопНачисления.Организация,
			|			ДопНачисления.БазовыйПериодНачало,
			|			МАКСИМУМ(УчОсновногоЗаработка.Период) КАК МаксимальныйПериод
			|		ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДопНачисления
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчОсновногоЗаработка
			|		ПО ДопНачисления.Организация = УчОсновногоЗаработка.Организация
			|			И ДопНачисления.Сотрудник = УчОсновногоЗаработка.Сотрудник
			|			И УчОсновногоЗаработка.Период <= ДопНачисления.БазовыйПериодНачало
			|		ГДЕ ДопНачисления.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ) И КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
			|		СГРУППИРОВАТЬ ПО
			|			ДопНачисления.Сотрудник,
			|			ДопНачисления.Организация,
			|			ДопНачисления.БазовыйПериодНачало) КАК ВлЗапрос
			|
			|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
			|	ПО ВлЗапрос.Организация = УчОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
			|		И ВлЗапрос.Сотрудник = УчОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
			|		И ВлЗапрос.МаксимальныйПериод = УчОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
			|;
			|/////////////////////////////////////////////////
			//Аверсон СВФР-009233
			
			|ВЫБРАТЬ
			|	&парамГоловнаяОрганизация КАК ГоловнаяОрганизация,
			|	ДанныеУчета.Регистратор КАК Регистратор,
			|	ДанныеУчета.НомерСтроки КАК НомерСтроки,
			|	ДанныеУчета.Сотрудник,
			|	ДанныеУчета.ФизЛицо,
			|	ДанныеУчета.СчетДт,
			|	ДанныеУчета.СубконтоДт1,
			|	ДанныеУчета.СубконтоДт2,
			|	ДанныеУчета.СубконтоДт3,
			|	ДанныеУчета.СчетКт,
			|	ДанныеУчета.СубконтоКт1,
			|	ДанныеУчета.СубконтоКт2,
			|	ДанныеУчета.СубконтоКт3,
			|	ДанныеУчета.СчетДтНУ,
			|	ДанныеУчета.СчетКтНУ,
			|	ДанныеУчета.СубконтоДтНУ1,
			|	ДанныеУчета.СубконтоДтНУ2,
			|	ДанныеУчета.СубконтоДтНУ3,
			|	ДанныеУчета.СубконтоКтНУ1,
			|	ДанныеУчета.СубконтоКтНУ2,
			|	ДанныеУчета.СубконтоКтНУ3,
			|	ДанныеУчета.ВидРасчета,
			|	ДанныеУчета.СпособРасчета,
			|	ДанныеУчета.ВидНачисленияПоСт255НК КАК ВидНачисленияПоСт255НК,
			|	ДанныеУчета.ПодразделениеОрганизации,
			|	ДанныеУчета.Результат,
			|	ДанныеУчета.ПериодРегистрации,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоРаботникиДт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоРаботникиДт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоРаботникиДт,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоРаботникиКт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоРаботникиКт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоРаботникиКт,
			|	ВЫБОР
			|		КОГДА ВидыСубконтоПодразделенияДт.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ ВидыСубконтоПодразделенияДт.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоПодразделенияДт,
			|	ВЫБОР
			|		КОГДА СубконтоСт255НК.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ СубконтоСт255НК.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоСт255НК,
			|	ВЫБОР
			|		КОГДА База.СчетДтРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетДтРазрез
			|		ИНАЧЕ База.СчетДтРазрез
			|	КОНЕЦ КАК СчетДтРазрез,
			|	ВЫБОР
			|		КОГДА База.СчетКтРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетКтРазрез
			|		ИНАЧЕ База.СчетКтРазрез
			|	КОНЕЦ КАК СчетКтРазрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт1Разрез
			|		ИНАЧЕ База.СубконтоДт1Разрез
			|	КОНЕЦ КАК СубконтоДт1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт2Разрез
			|		ИНАЧЕ База.СубконтоДт2Разрез
			|	КОНЕЦ КАК СубконтоДт2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДт3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДт3Разрез
			|		ИНАЧЕ База.СубконтоДт3Разрез
			|	КОНЕЦ КАК СубконтоДт3Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт1Разрез
			|		ИНАЧЕ База.СубконтоКт1Разрез
			|	КОНЕЦ КАК СубконтоКт1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт2Разрез
			|		ИНАЧЕ База.СубконтоКт2Разрез
			|	КОНЕЦ КАК СубконтоКт2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКт3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКт3Разрез
			|		ИНАЧЕ База.СубконтоКт3Разрез
			|	КОНЕЦ КАК СубконтоКт3Разрез,
			|	ВЫБОР
			|		КОГДА База.СчетДтНУРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетДтНУРазрез
			|		ИНАЧЕ База.СчетДтНУРазрез
			|	КОНЕЦ КАК СчетДтНУРазрез,
			|	ВЫБОР
			|		КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|		ИНАЧЕ База.СчетКтНУРазрез
			|	КОНЕЦ КАК СчетКтНУРазрез,
			|	ВЫБОР
			|		КОГДА СубконтоСт255НКБазы.НомерСтроки ЕСТЬ NULL 
			|			ТОГДА 0
			|		ИНАЧЕ СубконтоСт255НКБазы.НомерСтроки
			|	КОНЕЦ КАК НомерСубконтоСт255НКБазы,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ1Разрез
			|		ИНАЧЕ База.СубконтоДтНУ1Разрез
			|	КОНЕЦ КАК СубконтоДтНУ1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ2Разрез
			|		ИНАЧЕ База.СубконтоДтНУ2Разрез
			|	КОНЕЦ КАК СубконтоДтНУ2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоДтНУ3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоДтНУ3Разрез
			|		ИНАЧЕ База.СубконтоДтНУ3Разрез
			|	КОНЕЦ КАК СубконтоДтНУ3Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ1Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ1Разрез
			|		ИНАЧЕ База.СубконтоКтНУ1Разрез
			|	КОНЕЦ КАК СубконтоКтНУ1Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ2Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ2Разрез
			|		ИНАЧЕ База.СубконтоКтНУ2Разрез
			|	КОНЕЦ КАК СубконтоКтНУ2Разрез,
			|	ВЫБОР
			|		КОГДА База.СубконтоКтНУ3Разрез ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.СубконтоКтНУ3Разрез
			|		ИНАЧЕ База.СубконтоКтНУ3Разрез
			|	КОНЕЦ КАК СубконтоКтНУ3Разрез,
			|	ВЫБОР
			|		КОГДА База.РезультатБаза ЕСТЬ NULL 
			|			ТОГДА БазаСреднегоЗаработка.РезультатБаза
			|		ИНАЧЕ База.РезультатБаза
			|	КОНЕЦ КАК РезультатБаза,
			|	ДанныеУчета.ПериодДействияНачало,
			
			//Аверсон ЕАЕ 22.06.2022 СВФР-009233
			|   ДанныеУчета.БазовыйПериодНачало,
			|   ДанныеУчета.БазовыйПериодКонец
			//Аверсон СВФР-009233
			
			|ИЗ
			|	(ВЫБРАТЬ
			|		ДополнительныеНачисления.Регистратор КАК Регистратор,
			|		ДополнительныеНачисления.НомерСтроки КАК НомерСтроки,
			|		ДополнительныеНачисления.Сотрудник КАК Сотрудник,
			|		ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|		ДополнительныеНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
			|		ДополнительныеНачисления.БазовыйПериодКонец КАК КонецБазовогоПериода,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДт
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДт
			//Аверсон 28.07.2020 КВВ СВФР-006325 )			
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
			|		КОНЕЦ КАК СчетДт,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКт
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКт
			|		КОНЕЦ КАК СчетКт,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
			|		КОНЕЦ КАК СубконтоДт1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
			|		КОНЕЦ КАК СубконтоДт2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
			|		КОНЕЦ КАК СубконтоДт3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт1
			|		КОНЕЦ КАК СубконтоКт1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт2
			|		КОНЕЦ КАК СубконтоКт2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт3
			|		КОНЕЦ КАК СубконтоКт3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДтНУ
			|    КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
			|		КОНЕЦ КАК СчетДтНУ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКтНУ
			|		КОНЕЦ КАК СчетКтНУ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
			|		КОНЕЦ КАК СубконтоДтНУ1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
			|		КОНЕЦ КАК СубконтоДтНУ2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//	|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
			|		КОНЕЦ КАК СубконтоДтНУ3,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ1
			|		КОНЕЦ КАК СубконтоКтНУ1,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ2
			|		КОНЕЦ КАК СубконтоКтНУ2,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ3
			|		КОНЕЦ КАК СубконтоКтНУ3,
			|		ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
			|		ДополнительныеНачисления.ВидРасчета.ВидНачисленияПоСт255НК КАК ВидНачисленияПоСт255НК,
			|		ДополнительныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			|		ДополнительныеНачисления.Результат КАК Результат,
			|		ДополнительныеНачисления.ПериодРегистрации КАК ПериодРегистрации,
			|		НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ) КАК ПериодДействияНачало,
			
			//Аверсон ЕАЕ 22.06.2022 СВФР-009233
			|       ДополнительныеНачисления.БазовыйПериодНачало,
			|       ДополнительныеНачисления.БазовыйПериодКонец
			//Аверсон СВФР-009233
			
			|	ИЗ
			|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					ДополнительныеНачисления.Сотрудник КАК Сотрудник,
			|					ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|					ДополнительныеНачисления.Организация КАК Организация,
			|					ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
			|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период,
			|					РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете КАК СпособОтраженияВБухучете,
			|					РеглУчетПлановыхНачисленийРаботниковОрганизаций.Регистратор КАК Регистратор
			|				ИЗ
			|					РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
			|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
			|						ПО ДополнительныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
			|							И ДополнительныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
			|							И (НАЧАЛОПЕРИОДА(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период, МЕСЯЦ) <= ДополнительныеНачисления.ПериодРегистрации)
			|							И ДополнительныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
			|				ГДЕ
			|					ВЫБОР
			|							КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|								ТОГДА ДополнительныеНачисления.Организация
			|							ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
			|						КОНЕЦ = &парамОрганизация
			|					И НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|				
			|				СГРУППИРОВАТЬ ПО
			|					ДополнительныеНачисления.Сотрудник,
			|					ДополнительныеНачисления.Сотрудник.Физлицо,
			|					ДополнительныеНачисления.Организация,
			|					ДополнительныеНачисления.ВидРасчета,
			|					РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете,
			|					РеглУчетПлановыхНачисленийРаботниковОрганизаций.Регистратор) КАК СведенияОНачисленияхСрез
			|				ПО (СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник)
			|					И (СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета)
			|					И (СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период)
			|					И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = СведенияОНачисленияхСрез.Организация
			|					И (СведенияОНачисленияхСрез.СпособОтраженияВБухучете = РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете)
			|			ПО (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ДополнительныеНачисления.Сотрудник)
			|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ДополнительныеНачисления.ВидРасчета)
			|				И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Регистратор = ДополнительныеНачисления.ДокументОснование)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.БУДополнительныеНачисления КАК БУДополнительныеНачисления
			|			ПО (БУДополнительныеНачисления.Сотрудник = ДополнительныеНачисления.Сотрудник)
			|				И (БУДополнительныеНачисления.ВидРасчета = ДополнительныеНачисления.ВидРасчета)
			|				И (БУДополнительныеНачисления.ПериодРегистрации = ДополнительныеНачисления.ПериодРегистрации)
			|				И ДополнительныеНачисления.Организация = БУДополнительныеНачисления.Организация
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&парамПериодРегистрации, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
			|			ПО ДополнительныеНачисления.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации
			
			//Аверсон ЕАЕ 23.06.2022 СВФР-009233
			//получаем способ расчета на дату базового периода начало
			
			//|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&парамПериодРегистрации) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних //О.Т. Аверсон 26.01.2018 № 1502
			//|			ПО ДополнительныеНачисления.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Сотрудник
			//|			И ДополнительныеНачисления.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Организация
			
			|ЛЕВОЕ СОЕДИНЕНИЕ ВТСпособы КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних     
			|ПО ДополнительныеНачисления.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Организация
			|	И ДополнительныеНачисления.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.Сотрудник
			|   И ДополнительныеНачисления.БазовыйПериодНачало = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.БазовыйПериодНачало
			//Аверсон СВФР-009233
			
			
			|	ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	ВложенныйЗапрос.Сотрудник КАК Сотрудник,
			|	ВложенныйЗапрос.ФизЛицо КАК ФизЛицо,
			|	ВложенныйЗапрос.Организация КАК Организация,
			|	ВложенныйЗапрос.Период КАК Период,
			|	ВложенныйЗапрос.ПериодДействияНачало КАК ПериодДействияНачало,
			|	УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете КАК СпособОтраженияВБухучете
			|ИЗ
			|	(ВЫБРАТЬ
			|		ДополнительныеНачисления.Сотрудник КАК Сотрудник,
			|		ДополнительныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
			|		ДополнительныеНачисления.Организация КАК Организация,
			|		МАКСИМУМ(УчетЗарВРеглУчете.Период) КАК Период,
			|		ДополнительныеНачисления.БазовыйПериодНачало КАК ПериодДействияНачало
			|	ИЗ
			|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетЗарВРеглУчете
			|			ПО ДополнительныеНачисления.Сотрудник = УчетЗарВРеглУчете.Сотрудник
			|				И ДополнительныеНачисления.Организация = УчетЗарВРеглУчете.Организация
			|				И (УчетЗарВРеглУчете.Период <= ДополнительныеНачисления.БазовыйПериодНачало)
			|	ГДЕ
			|		ВЫБОР
			|				КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|					ТОГДА ДополнительныеНачисления.Организация
			|				ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
			|			КОНЕЦ = &парамОрганизация
			
			//Аверсон ЕАЕ 26.04.2022 СВФР-008987
			//|		И ДополнительныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|       И ДополнительныеНачисления.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ) И КОНЕЦПЕРИОДА(&парамПериодРегистрации, МЕСЯЦ)
			//Аверсон СВФР-008987
			|	
			|	
			|	СГРУППИРОВАТЬ ПО
			|		ДополнительныеНачисления.Сотрудник,
			|		ДополнительныеНачисления.Сотрудник.Физлицо,
			|		ДополнительныеНачисления.Организация,
			|		ДополнительныеНачисления.БазовыйПериодНачало) КАК ВложенныйЗапрос
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
			|		ПО ВложенныйЗапрос.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
			|			И ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
			|			И ВложенныйЗапрос.Период = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Период
			|					) КАК СведенияОРаботникахСрез
			|ПО ДополнительныеНачисления.Сотрудник = СведенияОРаботникахСрез.Сотрудник
			|	И ДополнительныеНачисления.Организация = СведенияОРаботникахСрез.Организация
			|	И ДополнительныеНачисления.БазовыйПериодНачало = СведенияОРаботникахСрез.ПериодДействияНачало
			
			|	ГДЕ
			|		БУДополнительныеНачисления.Сотрудник ЕСТЬ NULL 
			|		И ВЫБОР
			|				КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|					ТОГДА ДополнительныеНачисления.Организация
			|				ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец
			|			КОНЕЦ = &парамОрганизация
			|		И НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|		И ВЫБОР
			|				КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете
			|				КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете
			|				КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|					ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете
			|				ИНАЧЕ &парамСпособПоУмолчанию
			|			КОНЕЦ <> &парамСпособНеОтражать
			|		И НЕ ДополнительныеНачисления.ВидРасчета В (&парамСдельныйЗаработокОсн)
			|	
			|	СГРУППИРОВАТЬ ПО
			|		ДополнительныеНачисления.ПериодРегистрации,
			|		
			|		ДополнительныеНачисления.Регистратор,
			|		
			|		ДополнительныеНачисления.Сотрудник,
			|		ДополнительныеНачисления.БазовыйПериодКонец,
			|		
			|		ДополнительныеНачисления.ПодразделениеОрганизации,
			|		ДополнительныеНачисления.ВидРасчета,
			
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДт
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДт
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
			|		КОНЕЦ,   //СчетДт
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКт
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКт
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКт
			|		КОНЕЦ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
			|		КОНЕЦ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
			|		КОНЕЦ,//СубконтоДт2
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
			////Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
			|		КОНЕЦ, //СубконтоДт3
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт1
			|		КОНЕЦ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт2
			|		КОНЕЦ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКт3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт3
			|		КОНЕЦ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//	|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
			|		КОНЕЦ,  //СчетДтНУ
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СчетКтНУ
			|			ИНАЧЕ &парамСпособПоУмолчаниюСчетКтНУ
			|		КОНЕЦ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
			|		КОНЕЦ,  //СубконтоДтНУ1
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
			|		КОНЕЦ, //СубконтоДтНУ2
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
			//Аверсон 28.07.2020 КВВ СВФР-006325 (
			//|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			//	|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			//Аверсон 28.07.2020 КВВ СВФР-006325 )
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
			|		КОНЕЦ, //СубконтоДтНУ3
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ1
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ1
			|		КОНЕЦ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ2
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ2
			|		КОНЕЦ,
			|		ВЫБОР
			|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА ДополнительныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА СведенияОРаботникахСрез.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
			|				ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчетеСрезПоследних.СпособОтраженияВБухучете.СубконтоКтНУ3
			|			ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ3
			|		КОНЕЦ,
			|		ДополнительныеНачисления.НомерСтроки,
			|		ДополнительныеНачисления.Сотрудник.Физлицо,
			|		ДополнительныеНачисления.ВидРасчета.СпособРасчета,
			|		ДополнительныеНачисления.ВидРасчета.ВидНачисленияПоСт255НК,
			|		ДополнительныеНачисления.Результат,
			|		НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ),
			
			//Аверсон ЕАЕ 22.06.2022 СВФР-009233
			|       ДополнительныеНачисления.БазовыйПериодНачало,
			|       ДополнительныеНачисления.БазовыйПериодКонец
			//Аверсон СВФР-009233
			
			|) КАК ДанныеУчета
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиДт
			|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетДт = ВидыСубконтоРаботникиДт.Ссылка
			|			И (ВидыСубконтоРаботникиДт.ВидСубконто = &парамРаботники)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоРаботникиКт
			|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетКт = ВидыСубконтоРаботникиКт.Ссылка
			|			И (ВидыСубконтоРаботникиКт.ВидСубконто = &парамРаботники)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконтоПодразделенияДт
			|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
			|			И ДанныеУчета.СчетДт = ВидыСубконтоПодразделенияДт.Ссылка
			|			И (ВидыСубконтоПодразделенияДт.ВидСубконто = &парамПодразделения)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК СубконтоСт255НК
			|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ)
			|			И ДанныеУчета.СчетКтНУ = СубконтоСт255НК.Ссылка
			|			И (СубконтоСт255НК.ВидСубконто = &ВидНачисленийОплатыТрудаПоСтатье255НК)
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			База.Регистратор КАК Регистратор,
			|			База.НомерСтроки КАК НомерСтроки,
			|			База.СчетДтРазрез КАК СчетДтРазрез,
			|			База.СчетКтРазрез КАК СчетКтРазрез,
			|			База.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
			|			База.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
			|			База.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
			|			База.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
			|			База.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
			|			База.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
			|			База.СчетДтНУРазрез КАК СчетДтНУРазрез,
			|			База.СчетКтНУРазрез КАК СчетКтНУРазрез,
			|			База.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
			|			База.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
			|			База.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
			|			База.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
			|			База.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
			|			База.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
			|			СУММА(База.РезультатБаза) КАК РезультатБаза
			|		ИЗ
			|			(ВЫБРАТЬ
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.Регистратор КАК Регистратор,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.НомерСтроки КАК НомерСтроки,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СчетДтРазрез КАК СчетДтРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СчетКтРазрез КАК СчетКтРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СчетДтНУРазрез КАК СчетДтНУРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СчетКтНУРазрез КАК СчетКтНУРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления.РезультатБаза КАК РезультатБаза
			|			ИЗ
			|				РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.БазаБУДополнительныеНачисления(
			|						&парамИзмерения,
			|						&парамИзмерения,
			|						&парамРазрезыБУ,
			|						ВЫБОР
			|								КОГДА ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|									ТОГДА Организация
			|								ИНАЧЕ ПодразделениеОрганизации.Владелец
			|							КОНЕЦ = &парамОрганизация
			|							И НАЧАЛОПЕРИОДА(ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|							И БазовыйПериодКонец < &парамПериодРегистрации
			|							И НЕ ВидРасчета.СпособРасчета В (&парамПоСреднемуЗаработку)) КАК ДополнительныеНачисленияРаботниковОрганизацииБазаБУДополнительныеНачисления
			|			
			|			ОБЪЕДИНИТЬ ВСЕ
			|			
			|			ВЫБРАТЬ
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.Регистратор,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.НомерСтроки,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СчетДтРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СчетКтРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДт1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДт2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДт3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКт1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКт2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКт3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СчетДтНУРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СчетКтНУРазрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДтНУ1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДтНУ2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоДтНУ3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКтНУ1Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКтНУ2Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.СубконтоКтНУ3Разрез,
			|				ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления.РезультатБаза
			|			ИЗ
			|				РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.БазаБУОсновныеНачисления(
			|						&парамИзмерения,
			|						&парамИзмерения,
			|						&парамРазрезыБУ,
			|						ВЫБОР
			|								КОГДА ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|									ТОГДА Организация
			|								ИНАЧЕ ПодразделениеОрганизации.Владелец
			|							КОНЕЦ = &парамОрганизация
			|							И НАЧАЛОПЕРИОДА(ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|							И БазовыйПериодКонец < &парамПериодРегистрации
			|							И НЕ ВидРасчета.СпособРасчета В (&парамПоСреднемуЗаработку)) КАК ДополнительныеНачисленияРаботниковОрганизацииБазаБУОсновныеНачисления) КАК База
			|		
			|		СГРУППИРОВАТЬ ПО
			|			База.Регистратор,
			|			База.НомерСтроки,
			|			База.СчетДтРазрез,
			|			База.СчетКтРазрез,
			|			База.СубконтоДт1Разрез,
			|			База.СубконтоДт2Разрез,
			|			База.СубконтоДт3Разрез,
			|			База.СубконтоКт1Разрез,
			|			База.СубконтоКт2Разрез,
			|			База.СубконтоКт3Разрез,
			|			База.СчетДтНУРазрез,
			|			База.СчетКтНУРазрез,
			|			База.СубконтоДтНУ1Разрез,
			|			База.СубконтоДтНУ2Разрез,
			|			База.СубконтоДтНУ3Разрез,
			|			База.СубконтоКтНУ1Разрез,
			|			База.СубконтоКтНУ2Разрез,
			|			База.СубконтоКтНУ3Разрез) КАК База
			|		ПО (ДанныеУчета.СчетДт = &парамПустойСчет
			|				ИЛИ ДанныеУчета.СчетКт = &парамПустойСчет)
			|			И ДанныеУчета.Регистратор = База.Регистратор
			|			И ДанныеУчета.НомерСтроки = База.НомерСтроки
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ОсновныеНачисления.Регистратор КАК Регистратор,
			|			ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
			|			БазаСреднегоЗаработка.СчетДтРазрез КАК СчетДтРазрез,
			|			БазаСреднегоЗаработка.СчетКтРазрез КАК СчетКтРазрез,
			|			БазаСреднегоЗаработка.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
			|			БазаСреднегоЗаработка.СчетДтНУРазрез КАК СчетДтНУРазрез,
			|			БазаСреднегоЗаработка.СчетКтНУРазрез КАК СчетКтНУРазрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
			|			БазаСреднегоЗаработка.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
			|			ВЫБОР
			|				КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработку
			|						ИЛИ БазаСреднегоЗаработка.ВидРасчета = &ПоЗаработкуБЛ
			|					ТОГДА БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации
			|				КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоФиксПремиям
			|					ТОГДА ВЫБОР
			|							КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|								ТОГДА 0
			|							ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|									КОГДА БазаСреднегоЗаработка.НормаПоПятидневке = 0
			|										ТОГДА 0
			|									ИНАЧЕ БазаСреднегоЗаработка.ОтработаноПоПятидневке / БазаСреднегоЗаработка.НормаПоПятидневке * ВЫБОР
			|											КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|												ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|											ИНАЧЕ 1
			|										КОНЕЦ
			|								КОНЕЦ
			|						КОНЕЦ
			|				КОГДА БазаСреднегоЗаработка.ВидРасчета = &ПоПремиям
			|					ТОГДА ВЫБОР
			|							КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|								ТОГДА 0
			|							ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * БазаСреднегоЗаработка.КоэффициентИндексации * ВЫБОР
			|									КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|										ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|									ИНАЧЕ 1
			|								КОНЕЦ
			|						КОНЕЦ
			|				КОГДА БазаСреднегоЗаработка.ЧислоМесяцев = 0
			|					ТОГДА 0
			|				ИНАЧЕ БазаСреднегоЗаработка.РезультатБаза * ВЫБОР
			|						КОГДА БазаСреднегоЗаработка.ЧислоМесяцев > БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка
			|							ТОГДА БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка / БазаСреднегоЗаработка.ЧислоМесяцев
			|						ИНАЧЕ 1
			|					КОНЕЦ
			|			КОНЕЦ КАК РезультатБаза
			|		ИЗ
			|			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					БазаСреднегоЗаработка.СчетДтРазрез КАК СчетДтРазрез,
			|					БазаСреднегоЗаработка.СчетКтРазрез КАК СчетКтРазрез,
			|					БазаСреднегоЗаработка.СубконтоДт1Разрез КАК СубконтоДт1Разрез,
			|					БазаСреднегоЗаработка.СубконтоДт2Разрез КАК СубконтоДт2Разрез,
			|					БазаСреднегоЗаработка.СубконтоДт3Разрез КАК СубконтоДт3Разрез,
			|					БазаСреднегоЗаработка.СубконтоКт1Разрез КАК СубконтоКт1Разрез,
			|					БазаСреднегоЗаработка.СубконтоКт2Разрез КАК СубконтоКт2Разрез,
			|					БазаСреднегоЗаработка.СубконтоКт3Разрез КАК СубконтоКт3Разрез,
			|					БазаСреднегоЗаработка.СчетДтНУРазрез КАК СчетДтНУРазрез,
			|					БазаСреднегоЗаработка.СчетКтНУРазрез КАК СчетКтНУРазрез,
			|					БазаСреднегоЗаработка.СубконтоДтНУ1Разрез КАК СубконтоДтНУ1Разрез,
			|					БазаСреднегоЗаработка.СубконтоДтНУ2Разрез КАК СубконтоДтНУ2Разрез,
			|					БазаСреднегоЗаработка.СубконтоДтНУ3Разрез КАК СубконтоДтНУ3Разрез,
			|					БазаСреднегоЗаработка.СубконтоКтНУ1Разрез КАК СубконтоКтНУ1Разрез,
			|					БазаСреднегоЗаработка.СубконтоКтНУ2Разрез КАК СубконтоКтНУ2Разрез,
			|					БазаСреднегоЗаработка.СубконтоКтНУ3Разрез КАК СубконтоКтНУ3Разрез,
			|					БазаСреднегоЗаработка.ВидРасчета КАК ВидРасчета,
			|					БазаСреднегоЗаработка.КоэффициентИндексации КАК КоэффициентИндексации,
			|					БазаСреднегоЗаработка.ДатаНачалаРасчетногоПериода КАК ДатаНачалаРасчетногоПериода,
			|					БазаСреднегоЗаработка.ДатаОкончанияРасчетногоПериода КАК ДатаОкончанияРасчетногоПериода,
			|					БазаСреднегоЗаработка.РезультатБаза КАК РезультатБаза,
			|					БазаСреднегоЗаработка.ОтработаноПоПятидневке КАК ОтработаноПоПятидневке,
			|					БазаСреднегоЗаработка.НормаПоПятидневке КАК НормаПоПятидневке,
			|					БазаСреднегоЗаработка.Сотрудник КАК Сотрудник,
			|					БазаСреднегоЗаработка.Сотрудник.Физлицо КАК ФизЛицо,
			|					БазаСреднегоЗаработка.СпособРасчета КАК СпособРасчета,
			|					БазаСреднегоЗаработка.ЧислоМесяцев КАК ЧислоМесяцев,
			|					БазаСреднегоЗаработка.ПериодРасчетаСреднегоЗаработка КАК ПериодРасчетаСреднегоЗаработка,
			|					БазаСреднегоЗаработка.Организация КАК Организация
			|				ИЗ
			|					РегистрРасчета.РасчетСреднегоЗаработка.БазаБУОсновныеНачисления(&парамИзмерения, &парамИзмерения, &парамРазрезыБУ, НАЧАЛОПЕРИОДА(ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации) КАК БазаСреднегоЗаработка
			|				
			|				ОБЪЕДИНИТЬ ВСЕ
			|				
			|				ВЫБРАТЬ
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СчетДтРазрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СчетКтРазрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоДт1Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоДт2Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоДт3Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоКт1Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоКт2Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоКт3Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СчетДтНУРазрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СчетКтНУРазрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоДтНУ1Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоДтНУ2Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоДтНУ3Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоКтНУ1Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоКтНУ2Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СубконтоКтНУ3Разрез,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.ВидРасчета,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.КоэффициентИндексации,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.ДатаНачалаРасчетногоПериода,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.ДатаОкончанияРасчетногоПериода,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.РезультатБаза,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.ОтработаноПоПятидневке,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.НормаПоПятидневке,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.Сотрудник,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.Сотрудник.Физлицо,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.СпособРасчета,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.ЧислоМесяцев,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.ПериодРасчетаСреднегоЗаработка,
			|					РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления.Организация
			|				ИЗ
			|					РегистрРасчета.РасчетСреднегоЗаработка.БазаБУДополнительныеНачисления(&парамИзмерения, &парамИзмерения, &парамРазрезыБУ, НАЧАЛОПЕРИОДА(ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации) КАК РасчетСреднегоЗаработкаБазаБУДополнительныеНачисления) КАК БазаСреднегоЗаработка
			|				ПО (БазаСреднегоЗаработка.Сотрудник = ОсновныеНачисления.Сотрудник)
			|					И (БазаСреднегоЗаработка.СпособРасчета = ОсновныеНачисления.ВидРасчета.СпособРасчета)
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало = БазаСреднегоЗаработка.ДатаНачалаРасчетногоПериода
			|					И ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание = БазаСреднегоЗаработка.ДатаОкончанияРасчетногоПериода
			|					И ОсновныеНачисления.Организация = БазаСреднегоЗаработка.Организация
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL 
			|						ТОГДА ОсновныеНачисления.Организация
			|					ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец
			|				КОНЕЦ = &парамОрганизация
			|			И НАЧАЛОПЕРИОДА(ОсновныеНачисления.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации
			|			И ОсновныеНачисления.ВидРасчета.СпособРасчета В(&парамПоСреднемуЗаработку)) КАК БазаСреднегоЗаработка
			|		ПО ДанныеУчета.Регистратор = БазаСреднегоЗаработка.Регистратор
			|			И ДанныеУчета.НомерСтроки = БазаСреднегоЗаработка.НомерСтроки
			|			И (ДанныеУчета.СчетДт = &парамПустойСчет
			|				ИЛИ ДанныеУчета.СчетКт = &парамПустойСчет)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК СубконтоСт255НКБазы
			|		ПО (ВЫБОР
			|				КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|					ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|				ИНАЧЕ База.СчетКтНУРазрез
			|			КОНЕЦ <> &парамПустойСчетНУ)
			|			И (ВЫБОР
			|				КОГДА База.СчетКтНУРазрез ЕСТЬ NULL 
			|					ТОГДА БазаСреднегоЗаработка.СчетКтНУРазрез
			|				ИНАЧЕ База.СчетКтНУРазрез
			|			КОНЕЦ = СубконтоСт255НКБазы.Ссылка)
			|			И (СубконтоСт255НКБазы.ВидСубконто = &ВидНачисленийОплатыТрудаПоСтатье255НК)";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ТекстЗапроса = ТекстЗапроса + "
				|		ГДЕ
				|		ДанныеУчета.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";			
			КонецЕсли;
			ТекстЗапроса = ТекстЗапроса + "
			|
			|УПОРЯДОЧИТЬ ПО
			|	ДанныеУчета.Сотрудник.Физлицо.Наименование,
			|	Регистратор,
			|	НомерСтроки";
			//Аверсон-софт, Островская Татьяна 16.08.2012 № 15714
		КонецЕсли;
	КонецЕсли;                   
	
	Запрос.Текст = ТекстЗапроса;
	РезультатЗапроса = Запрос.Выполнить();
	
	//Аверсон 08.07.2023 КВВ СВФР-010889 (
	Если Организация.ИНН = "100194961" Тогда  //Виток
		ТЗНетНГ = Новый ТаблицаЗначений;    
		ТЗНетНГ.Колонки.Добавить("ВР");
		ТЗНетНГ.Колонки.Добавить("КодВР");
		РезультатЗапроса1 =Запрос.Выполнить().Выгрузить();
		
		РезультатЗапроса1.Колонки.Добавить("Перераспределено",Новый ОписаниеТипов("Булево"));
		
		СчЗамен = 0;
		
		ЗНеРаспр = Новый Запрос;
		ЗНеРаспр.Текст = "ВЫБРАТЬ 
		|Осн.Ссылка КАК ВР,
		|Осн.Счет КАК Счет,
		|Осн.НомГруппа КАК НомГруппа
		|ИЗ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.КодыВРДляОтражения КАК Осн
		|ГДЕ Осн.Ссылка.НеРаспределятьПоНаряду = ИСТИНА
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|ВЫБРАТЬ 
		|Доп.Ссылка,
		|Доп.Счет КАК Счет,
		|Доп.НомГруппа КАК НомГруппа
		|ИЗ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.КодыВРДляОтражения КАК Доп
		|ГДЕ Доп.Ссылка.НеРаспределятьПоНаряду = ИСТИНА";
		РезЗНеРаспр = ЗНеРаспр.Выполнить().Выгрузить();
		
		ЗРаспр = Новый Запрос;
		ЗРаспр.Текст = "ВЫБРАТЬ 
		|Осн.Ссылка КАК ВР,
		|Осн.Счет КАК Счет,
		|Осн.НомГруппа КАК НомГруппа
		|ИЗ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.КодыВРДляОтражения КАК Осн
		|ГДЕ Осн.Ссылка.НеРаспределятьПоНаряду = ЛОЖЬ
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|ВЫБРАТЬ 
		|Доп.Ссылка,
		|Доп.Счет КАК Счет,
		|Доп.НомГруппа КАК НомГруппа
		|ИЗ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.КодыВРДляОтражения КАК Доп
		|ГДЕ Доп.Ссылка.НеРаспределятьПоНаряду = ЛОЖЬ";
		РезЗРаспр = ЗРаспр.Выполнить().Выгрузить();
		
		Если ЭтоОсновныеНачисления Тогда
			ТЗПовременки = Новый ТаблицаЗначений;    
			ТЗПовременки.Колонки.Добавить("Сотрудник");
			ТЗПовременки.Колонки.Добавить("Начало");
			ТЗПовременки.Колонки.Добавить("Окончание");
			ТЗПовременки.Колонки.Добавить("Счет");
			ТЗПовременки.Колонки.Добавить("СчетНалог");
			ТЗПовременки.Колонки.Добавить("ВР");
			ТЗПовременки.Колонки.Добавить("НомГруппа");
			ТЗПовременки.Колонки.Добавить("Подр");
			ТЗПовременки.Колонки.Добавить("ПодрДок");
			ТЗПовременки.Колонки.Добавить("ПодрДокПовременка");
			ТЗПовременки.Колонки.Добавить("Результат");
			
			Для Каждого Стр из РезультатЗапроса1 Цикл 
				Если ТипЗнч(Стр.Регистратор) <> Тип("ДокументСсылка.ПовременнаяОплатаПриСделке") Тогда
					Продолжить;
				КонецЕсли;
				
				Если Стр.ВидРасчета.КодыВРДляОтражения.Количество() = 0 Тогда
					Продолжить;
				КонецЕсли;
				
				З = Новый Запрос;
				З.Текст = "ВЫБРАТЬ 
				|СН.Ссылка
				|ПОМЕСТИТЬ ВтДокСделки
				|ИЗ Документ.СдельныйНаряд.Исполнители КАК СН
				|ГДЕ СН.Ссылка.Проведен = ИСТИНА
				|И СН.Ссылка.Организация = &Организация
				|И СН.Сотрудник = &Сотрудник
				|И СН.Ссылка.ПериодРегистрации = &ДатаНачала
				|И СН.СуммаКНачислениюРегл = &Сумма
				|;
				|ВЫБРАТЬ 
				|СН.СчетЗатрат,
				|СН.СчетЗатратНУ
				|ИЗ Документ.СдельныйНаряд.Выработка КАК СН	
				|ЛЕВОЕ СОЕДИНЕНИЕ ВтДокСделки
				|ПО СН.Ссылка = ВтДокСделки.Ссылка	
				|ГДЕ СН.Ссылка = ВтДокСделки.Ссылка";
				З.УстановитьПараметр("Организация",Стр.ГоловнаяОрганизация);
				З.УстановитьПараметр("Сотрудник",Стр.Сотрудник);
				З.УстановитьПараметр("Сумма",Стр.Результат);
				З.УстановитьПараметр("ДатаНачала",НачалоМесяца(Стр.ПериодДействияНачало));
				РезЗ = З.Выполнить().Выгрузить();
				Если РезЗ.Количество() > 0 Тогда
					
					НаСчет = РезЗ[0].СчетЗатрат;
					НаСчетНалог = РезЗ[0].СчетЗатратНУ; //может через спр.Способы отражения в рег учете ?
					
					НомГруппа = Справочники.НоменклатурныеГруппы.ПустаяСсылка();
					ОтборВР = Новый Структура();
					ОтборВР.Вставить("Счет", НаСчет);
					НайденноеЗначениеВР = Стр.ВидРасчета.КодыВРДляОтражения.НайтиСтроки(ОтборВР);
					Если НайденноеЗначениеВР.Количество() = 0 Тогда
						Продолжить;
					Иначе
						НомГруппа = НайденноеЗначениеВР[0].НомГруппа;
					КонецЕсли;
					
					СтрТЗ = ТЗПовременки.Добавить();
					СтрТЗ.Сотрудник = Стр.Сотрудник;
					СтрТЗ.Начало = Стр.ПериодДействияНачало;
					СтрТЗ.Окончание = КонецДня(Стр.ПериодДействияКонец);
					СтрТЗ.Счет = НаСчет;
					СтрТЗ.СчетНалог = НаСчетНалог;
					СтрТЗ.ВР = Стр.ВидРасчета;
					СтрТЗ.НомГруппа = НомГруппа;
					СтрТЗ.Подр = Стр.ПодразделениеОрганизации;
					СтрТЗ.ПодрДок = Стр.СубконтоДт1;
					СтрТЗ.ПодрДокПовременка = ?(ЗначениеЗаполнено(Стр.Регистратор.ПодразделениеОрганизации),Стр.Регистратор.ПодразделениеОрганизации,Стр.ПодразделениеОрганизации);
					СтрТЗ.Результат = Стр.Результат;
					
					Если ЗначениеЗаполнено(СтрТЗ.ПодрДокПовременка) И
						(Стр.ПодразделениеОрганизации.ПодрИзПовременкиДляОтражения ИЛИ
						
						(СтрТЗ.ПодрДокПовременка <> СтрТЗ.Подр И 
						НЕ СтрТЗ.ПодрДокПовременка.ПринадлежитЭлементу(СтрТЗ.Подр) И 
						НЕ СтрТЗ.Подр.ПринадлежитЭлементу(СтрТЗ.ПодрДокПовременка))) Тогда
						
						Стр.ПодразделениеОрганизации = СтрТЗ.ПодрДокПовременка;
						Стр.СубконтоДт1 = СтрТЗ.ПодрДокПовременка;
						СтрТЗ.Подр = СтрТЗ.ПодрДокПовременка;
						СтрТЗ.ПодрДок = СтрТЗ.ПодрДокПовременка;
					КонецЕсли;
					
					Стр.ПериодДействияКонец = КонецДня(Стр.ПериодДействияКонец);
					
					ИзмененияПоСубконтоВитка(Стр,НаСчет,НаСчетНалог,НомГруппа);
					
					СчЗамен = СчЗамен + 1;
					Стр.Перераспределено = Истина;
				Иначе
					//Сообщить(" *** Не найден Наряд по " + СокрЛП(Стр.Сотрудник) + " на сумму " + Сокрлп(Стр.Результат) + " от " + СокрЛП(НачалоМесяца(Стр.ПериодДействияНачало)));
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		Если НЕ ЭтоОсновныеНачисления Тогда
			Для Каждого СтрРез ИЗ РезультатЗапроса1 Цикл
				СтрРез.БазовыйПериодКонец = КонецДня(СтрРез.БазовыйПериодКонец);
			КонецЦикла;
		КонецЕсли;
		
		Если ТЗПовременки.Количество() > 0 Тогда
			
			Для Каждого Стр2 ИЗ ТЗПовременки Цикл 
				Отбор2 = Новый Структура;
				Отбор2.Вставить("Сотрудник", Стр2.Сотрудник);
				//Отбор2.Вставить("ПодразделениеОрганизации", Стр2.Подр);
				//Если ЭтоОсновныеНачисления Тогда
				//	Отбор2.Вставить("ПериодДействияНачало", Стр2.Начало);
				//	Отбор2.Вставить("ПериодДействияКонец", Стр2.Окончание); 
				//Иначе
				//	Отбор2.Вставить("БазовыйПериодНачало", Стр2.Начало);
				//	Отбор2.Вставить("БазовыйПериодКонец", Стр2.Окончание); 
				//КонецЕсли;
				
				
				НаСчет = Стр2.Счет;
				НаСчетНалог = Стр2.СчетНалог;
				
				Строки3 = РезультатЗапроса1.НайтиСтроки(Отбор2);
				Для Каждого Стр3 Из Строки3 Цикл
					Если НЕ ЗначениеЗаполнено(Стр3.ПодразделениеОрганизации) Тогда
						Продолжить;
					КонецЕсли;
					
					Если ЭтоОсновныеНачисления Тогда
						Если ТипЗнч(Стр3.ВидРасчета) <> ТипЗнч(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПустаяСсылка()) Тогда
							Продолжить;
						КонецЕсли;
					Иначе
						Если ТипЗнч(Стр3.ВидРасчета) <> ТипЗнч(ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ПустаяСсылка()) Тогда
							Продолжить;
						КонецЕсли;
					КонецЕсли;
					
					Если Стр3.ВидРасчета = Стр2.ВР Тогда
						Продолжить;
					КонецЕсли;
					Если Стр3.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой Тогда
						Продолжить;
					КонецЕсли;
					Если Стр3.ВидРасчета.КодыВРДляОтражения.Количество() = 0 Тогда
						Продолжить;
					КонецЕсли;      
					
					_ПроверяемоеПодразделение_ = Стр3.ПодразделениеОрганизации;
					Если _ПроверяемоеПодразделение_.ПодрИзПовременкиДляОтражения И ЗначениеЗаполнено(Стр2.ПодрДокПовременка) Тогда
						_ПроверяемоеПодразделение_ = Стр2.ПодрДокПовременка;
					КонецЕсли;
					
					
					Если Стр2.Подр = Стр2.ПодрДокПовременка Тогда
						Если _ПроверяемоеПодразделение_ <> Стр2.Подр И НЕ _ПроверяемоеПодразделение_.ПринадлежитЭлементу(Стр2.Подр) Тогда
							Продолжить;
						КонецЕсли;
					Иначе
						Если _ПроверяемоеПодразделение_ <> Стр2.Подр И _ПроверяемоеПодразделение_ <> Стр2.ПодрДокПовременка 
							И НЕ _ПроверяемоеПодразделение_.ПринадлежитЭлементу(Стр2.Подр)
							И НЕ _ПроверяемоеПодразделение_.ПринадлежитЭлементу(Стр2.ПодрДокПовременка) Тогда
							Продолжить;
						Иначе 
							//Если СокрЛП(глЗначениеПеременной("глТекущийПользователь")) = "averson" Тогда
							//	Сообщить(" -пункт 3- " + СокрЛП(Стр2.Сотрудник) + " -- " + СокрЛП(Стр3.ВидРасчета));
							//КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					
					Если ЭтоОсновныеНачисления Тогда
						Если Стр3.ПериодДействияНачало < Стр2.Начало ИЛИ Стр3.ПериодДействияКонец > Стр2.Окончание Тогда
							Продолжить;
						КонецЕсли;
						Если Стр3.ПериодДействияНачало <> Стр2.Начало ИЛИ Стр3.ПериодДействияКонец <> Стр2.Окончание Тогда
							//Если СокрЛП(глЗначениеПеременной("глТекущийПользователь")) = "averson" Тогда
							//Сообщить(" -пункт 1,4- " + СокрЛП(Стр2.Сотрудник) + " -- " + СокрЛП(Стр3.ВидРасчета));
							//КонецЕсли;
						КонецЕсли;
						//Отбор2.Вставить("ПериодДействияНачало", Стр2.Начало);
						//Отбор2.Вставить("ПериодДействияКонец", Стр2.Окончание); 
					Иначе
						Если Стр3.БазовыйПериодНачало < Стр2.Начало ИЛИ Стр3.БазовыйПериодКонец > Стр2.Окончание Тогда
							Продолжить;
						КонецЕсли;
						Если Стр3.БазовыйПериодНачало <> Стр2.Начало ИЛИ Стр3.БазовыйПериодКонец <> Стр2.Окончание Тогда
							//Если СокрЛП(глЗначениеПеременной("глТекущийПользователь")) = "averson" Тогда
							//	Сообщить(" -пункт 1,4- " + СокрЛП(Стр2.Сотрудник) + " -- " + СокрЛП(Стр3.ВидРасчета));
							//КонецЕсли;
						КонецЕсли;
						//Отбор2.Вставить("БазовыйПериодНачало", Стр2.Начало);
						//Отбор2.Вставить("БазовыйПериодКонец", Стр2.Окончание); 
					КонецЕсли;
					
					Если Стр3.ВидРасчета.НеРаспределятьПоНаряду Тогда
						Продолжить;
						//НаСчет = Стр3.СчетДт;
						//НаСчетНалог = Стр3.СчетДтНУ;
					КонецЕсли;
					
					Если Стр3.ПодразделениеОрганизации.ПодрИзПовременкиДляОтражения И ЗначениеЗаполнено(Стр2.ПодрДокПовременка) Тогда
						Стр3.ПодразделениеОрганизации = Стр2.ПодрДокПовременка;
						Стр3.СубконтоДт1 = Стр2.ПодрДокПовременка;
					КонецЕсли;
					
					НомГруппа = Справочники.НоменклатурныеГруппы.ПустаяСсылка();
					ОтборВР = Новый Структура();
					ОтборВР.Вставить("Счет", НаСчет);
					НайденноеЗначениеВР = Стр3.ВидРасчета.КодыВРДляОтражения.НайтиСтроки(ОтборВР);
					Если НайденноеЗначениеВР.Количество() = 0 Тогда
						//Продолжить;
						СтрТЗНетНГ = ТЗНетНГ.Добавить();
						СтрТЗНетНГ.ВР = Стр3.ВидРасчета.Наименование;
						СтрТЗНетНГ.КодВР = Стр3.ВидРасчета.Код;
					Иначе
						НомГруппа = НайденноеЗначениеВР[0].НомГруппа;
					КонецЕсли;
					
					ИзмененияПоСубконтоВитка(Стр3,НаСчет,НаСчетНалог,НомГруппа,Стр3.ВидРасчета.НеРаспределятьПоНаряду);
					
					СчЗамен = СчЗамен + 1;
					Стр3.Перераспределено = Истина;
				КонецЦикла;	
				
				//ВР не распределять по нарядам (
				Для Каждого СтрНеРаспр ИЗ РезЗНеРаспр Цикл
					ОтборНеРаспр = Новый Структура;
					ОтборНеРаспр.Вставить("ВидРасчета", СтрНеРаспр.ВР);
					ОтборНеРаспр.Вставить("СчетДт", СтрНеРаспр.Счет);
					СтрокиНеРаспр = РезультатЗапроса1.НайтиСтроки(ОтборНеРаспр);
					Для Каждого СтрСтрокиНеРаспр ИЗ СтрокиНеРаспр Цикл
						Если СтрСтрокиНеРаспр.ПодразделениеОрганизации.ПодрИзПовременкиДляОтражения И ЗначениеЗаполнено(Стр2.ПодрДокПовременка) Тогда
							СтрСтрокиНеРаспр.ПодразделениеОрганизации = Стр2.ПодрДокПовременка;
							СтрСтрокиНеРаспр.СубконтоДт1 = Стр2.ПодрДокПовременка;
						КонецЕсли;
						
						ИзмененияПоСубконтоВитка(СтрСтрокиНеРаспр,СтрСтрокиНеРаспр.СчетДт,СтрСтрокиНеРаспр.СчетДтНУ,СтрНеРаспр.НомГруппа,Истина);
						СчЗамен = СчЗамен + 1;
						СтрСтрокиНеРаспр.Перераспределено = Истина;
					КонецЦикла;
				КонецЦикла;
				//ВР не распределять по нарядам )
				
				//Аверсон 13.07.2023 КВВ СВФР-010889 (
				//отпуска будущих периодов (
				Если ЭтоОсновныеНачисления Тогда
					Если НачалоМесяца(Стр2.Начало) = НачалоДня(Стр2.Начало) 
						И КонецМесяца(Стр2.Окончание) = КонецДня(Стр2.Окончание) Тогда
						Отбор6 = Новый Структура;
						Отбор6.Вставить("Сотрудник", Стр2.Сотрудник);
						Отбор6.Вставить("ПодразделениеОрганизации", Стр2.Подр);
						
						Строки6 = РезультатЗапроса1.НайтиСтроки(Отбор6);
						Для Каждого Стр6 Из Строки6 Цикл
							Если Стр6.ВидРасчета.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням Тогда
								Продолжить;
							КонецЕсли;
							Если НачалоМесяца(Стр6.ПериодДействияНачало) = НачалоМесяца(Стр2.Начало) 
								ИЛИ НачалоМесяца(Стр6.ПериодДействияНачало) < НачалоМесяца(Стр2.Начало) Тогда
								Продолжить;
							КонецЕсли;
							Если Стр6.ВидРасчета.КодыВРДляОтражения.Количество() = 0 Тогда
								Продолжить;
							КонецЕсли;
							//Сообщить("// " + СокрЛП(Стр2.Сотрудник) + " // " + СокрЛП(Стр6.ПериодДействияНачало));
							
							НомГруппа = Справочники.НоменклатурныеГруппы.ПустаяСсылка();
							ОтборВР = Новый Структура();
							ОтборВР.Вставить("Счет", НаСчет);
							НайденноеЗначениеВР = Стр6.ВидРасчета.КодыВРДляОтражения.НайтиСтроки(ОтборВР);
							Если НайденноеЗначениеВР.Количество() = 0 Тогда
								//Продолжить;
								СтрТЗНетНГ = ТЗНетНГ.Добавить();
								СтрТЗНетНГ.ВР = Стр6.ВидРасчета.Наименование;
								СтрТЗНетНГ.КодВР = Стр6.ВидРасчета.Код;
							Иначе
								НомГруппа = НайденноеЗначениеВР[0].НомГруппа;
							КонецЕсли;
							
							ИзмененияПоСубконтоВитка(Стр6,НаСчет,НаСчетНалог,НомГруппа);
							
							СчЗамен = СчЗамен + 1;
							Стр6.Перераспределено = Истина;
						КонецЦикла;	
					КонецЕсли;
				КонецЕсли;
				//отпуска будущих периодов )
				//Аверсон 13.07.2023 КВВ СВФР-010889 )
			КонецЦикла;
		КонецЕсли;
		
		Для Каждого СтрРаспр ИЗ РезЗРаспр Цикл
			ОтборПерераспределено = Новый Структура;
			ОтборПерераспределено.Вставить("Перераспределено", Ложь);
			ОтборПерераспределено.Вставить("ВидРасчета", СтрРаспр.ВР);
			ОтборПерераспределено.Вставить("СчетДт", СтрРаспр.Счет);
			СтрокиПерераспределено = РезультатЗапроса1.НайтиСтроки(ОтборПерераспределено);
			Для Каждого СтрПерераспределено Из СтрокиПерераспределено Цикл
				ИзмененияПоСубконтоВитка(СтрПерераспределено,СтрПерераспределено.СчетДт,СтрПерераспределено.СчетДтНУ,СтрРаспр.НомГруппа,Истина);
				СчЗамен = СчЗамен + 1;
				СтрПерераспределено.Перераспределено = Истина;
			КонецЦикла;
		КонецЦикла;
		
		Запрос = Новый Запрос;
		Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	*
		| ПОМЕСТИТЬ ВТТаблица
		|ИЗ
		|	&ТЗТаблица КАК ТЗТаблица";
		Запрос.УстановитьПараметр("ТЗТаблица",РезультатЗапроса1);
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	*
		|ИЗ
		|ВТТаблица КАК ВТТаблица";
		
		РезультатЗапроса = Запрос.Выполнить();
		
		Если ТЗНетНГ.Количество() > 0 Тогда
			ТЗНетНГ.Свернуть("ВР,КодВР");
			ТЗНетНГ.Сортировать("ВР");
			Для Каждого СтрТЗНетНГ ИЗ ТЗНетНГ Цикл
				Сообщить("По виду расчета """ + Сокрлп(СтрТЗНетНГ.ВР) + """ (" + СокрЛП(СтрТЗНетНГ.КодВР) + ", " + ?(ЭтоОсновныеНачисления,"осн.нач.","доп.нач.") + ") не заполнена номенклатурная группа по счету " + СокрЛП(НаСчет))
			КонецЦикла;
		КонецЕсли;
		//Если СокрЛП(глЗначениеПеременной("глТекущийПользователь")) = "averson" Тогда
		//	Сообщить("Замен/перераспределений" + ?(ЭтоОсновныеНачисления," (осн.нач.)"," (доп.нач.)") + " : " + СокрЛП(СчЗамен));	
		//КонецЕсли;
		//Аверсон 08.07.2023 КВВ СВФР-010889 )
		
	ИначеЕсли Организация.ИНН = "806000046"  Тогда
		
		РезультатЗапроса1 =Запрос.Выполнить().Выгрузить(); 
		для Каждого стр из РезультатЗапроса1 Цикл 
			
			ДанныеСотрудника = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Стр.ПериодДействияНачало,Новый Структура("Сотрудник",Стр.Сотрудник));
			ДанныеСотрудникаСчет = РегистрыСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.ПолучитьПоследнее(Стр.ПериодДействияНачало,Новый Структура("Сотрудник",Стр.Сотрудник));
			РезультатЗапросаСЗ = Неопределено;
			Если стр.Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.Совместитель Тогда 
				Запрос1 = Новый Запрос;
				Запрос1.Текст = 
				"ВЫБРАТЬ
				|	СтатьиЗатрат.Ссылка
				|ИЗ
				|	Справочник.СтатьиЗатрат КАК СтатьиЗатрат
				|ГДЕ
				|	СтатьиЗатрат.Родитель.Код = ""000000018""";
				
				РезультатЗапросаСЗ = Запрос1.Выполнить().Выбрать();
				Если СокрЛП(стр.СчетДт) ="91.04.6" Тогда
					Если СокрЛП(ДанныеСотрудникаСчет.СпособОтраженияВБухучете) = "ДНПС" Тогда 
						Если Найти(стр.СубконтоДт1," (ДНПС)") Тогда
						Иначе
							Аналитика = Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию(СокрЛП(стр.СубконтоДт1)+" (ДНПС)",истина); 
							стр.СубконтоДт1 = Аналитика; 	
						КонецЕсли;
						//стр.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.09");
					КонецЕсли;
				ИначеЕсли СокрЛП(стр.СчетДт.Родитель) ="26"   тогда
					стр.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.03");
				КонецЕсли;
				стр.СчетКт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.04");
			ИначеЕсли стр.Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.ДоговорПодряда и ЗначениеЗаполнено(стр.Сотрудник.КодIBS)  Тогда 
				стр.СчетКт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.03");   				
			ИначеЕсли стр.Сотрудник.ТипРаботника = Перечисления.ТипыРаботников.ДоговорПодряда Тогда    				
				стр.СчетКт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.05");       				
			ИначеЕсли ДанныеСотрудника.Должность.Категория = Справочники.КатегорииРаботников.НайтиПоНаименованию("Страховые агенты") Тогда
				Запрос1 = Новый Запрос;
				Запрос1.Текст = 
				"ВЫБРАТЬ
				|	СтатьиЗатрат.Ссылка
				|ИЗ
				|	Справочник.СтатьиЗатрат КАК СтатьиЗатрат
				|ГДЕ
				|	СтатьиЗатрат.Родитель.Код = ""000000039""";
				
				РезультатЗапросаСЗ = Запрос1.Выполнить().Выбрать();
				Если СокрЛП(стр.СчетДт) ="91.04.6" Тогда
				ИначеЕсли СокрЛП(стр.СчетДт.Родитель) ="26"   тогда
					стр.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.02");
				КонецЕсли;
				стр.СчетКт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.02");
				
			Иначе 
				Если СокрЛП(стр.СчетДт) ="91.04.6" Тогда
					Если СокрЛП(ДанныеСотрудникаСчет.СпособОтраженияВБухучете) = "ДНПС" Тогда 
						Если Найти(стр.СубконтоДт1," (ДНПС)") Тогда
						Иначе
							Аналитика = Справочники.ПрочиеДоходыИРасходы.НайтиПоНаименованию(СокрЛП(стр.СубконтоДт1)+" (ДНПС)",истина); 
							стр.СубконтоДт1 = Аналитика; 
						КонецЕсли;
						//стр.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("91.09");
					КонецЕсли;
				ИначеЕсли СокрЛП(стр.СчетДт.Родитель) ="26"   тогда
					Если СокрЛП(ДанныеСотрудникаСчет.СпособОтраженияВБухучете) = "ДНПС" Тогда
						стр.СчетДт = ДанныеСотрудникаСчет.СпособОтраженияВБухучете.СчетДт;
					Иначе
						стр.СчетДт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("26.01");
					КонецЕсли;
				КонецЕсли;
				стр.СчетКт = ПланыСчетов.Хозрасчетный.НайтиПоКоду("70.01");
				
			КонецЕсли;   
			Если стр.ВидРасчета = Организация.ВидРасчета Тогда
				если РезультатЗапросаСЗ <> Неопределено Тогда 
					Пока РезультатЗапросаСЗ.Следующий() Цикл
						Если Найти(РезультатЗапросаСЗ.Ссылка,"за стаж работы") тогда
							стр.СубконтоДт2 = РезультатЗапросаСЗ.Ссылка;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			ИначеЕсли СокрЛП(стр.ВидРасчета) = "Оклад по дням" Тогда
				если РезультатЗапросаСЗ <> Неопределено Тогда 
					Пока РезультатЗапросаСЗ.Следующий() Цикл
						Если Найти(РезультатЗапросаСЗ.Ссылка,"по должностным окладам") тогда
							стр.СубконтоДт2 = РезультатЗапросаСЗ.Ссылка;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			ИначеЕсли СокрЛП(стр.ВидРасчета) = "Комиссионное вознаграждение (штатные агенты)" или СокрЛП(стр.ВидРасчета) = "Комвознаграждение за кураторство (штатные агенты)" Тогда
				если РезультатЗапросаСЗ <> Неопределено Тогда 
					Пока РезультатЗапросаСЗ.Следующий() Цикл
						Если Найти(РезультатЗапросаСЗ.Ссылка,"Вознаграждение за взносы") тогда
							стр.СубконтоДт2 = РезультатЗапросаСЗ.Ссылка;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			ИначеЕсли СокрЛП(стр.ВидРасчета) = "Комиссионное вознаграждение" или СокрЛП(стр.ВидРасчета) = "Комиссионное вознаграждение за кураторство" Тогда
				если РезультатЗапросаСЗ <> Неопределено Тогда 
					Пока РезультатЗапросаСЗ.Следующий() Цикл
						Если Найти(РезультатЗапросаСЗ.Ссылка,"Вознаграждение за взносы") тогда
							стр.СубконтоДт2 = РезультатЗапросаСЗ.Ссылка;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			ИначеЕсли СокрЛП(стр.ВидРасчета) = "Надбавка за классность (себестоимость)" Тогда
				если РезультатЗапросаСЗ <> Неопределено Тогда 
					Пока РезультатЗапросаСЗ.Следующий() Цикл
						Если Найти(РезультатЗапросаСЗ.Ссылка,"за классн. водителей") тогда
							стр.СубконтоДт2 = РезультатЗапросаСЗ.Ссылка;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			ИначеЕсли  СокрЛП(стр.ВидРасчета) = "Надбавка за сложность и напряженность" Тогда
				если РезультатЗапросаСЗ <> Неопределено Тогда 
					Пока РезультатЗапросаСЗ.Следующий() Цикл
						Если Найти(РезультатЗапросаСЗ.Ссылка,"надбавки за  сложность и напряженность") тогда
							стр.СубконтоДт2 = РезультатЗапросаСЗ.Ссылка;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			ИначеЕсли  СокрЛП(стр.ВидРасчета) = "Ежемесячная премия" Тогда
				если РезультатЗапросаСЗ <> Неопределено Тогда 
					Пока РезультатЗапросаСЗ.Следующий() Цикл
						Если Найти(РезультатЗапросаСЗ.Ссылка,"Премия") тогда
							стр.СубконтоДт2 = РезультатЗапросаСЗ.Ссылка;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;   
			ИначеЕсли  СокрЛП(стр.СчетДт) = "69.01" Тогда
				стр.СубконтоДт2 = ПодразделениеОрганизации;
			КонецЕсли;       			
		КонецЦикла;
		
		
		Запрос = Новый Запрос;
		Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	*
		| ПОМЕСТИТЬ ВТТаблица
		|ИЗ
		|	&ТЗТаблица КАК ТЗТаблица";
		Запрос.УстановитьПараметр("ТЗТаблица",РезультатЗапроса1);
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	*
		|ИЗ
		|ВТТаблица КАК ВТТаблица";
		
		РезультатЗапроса = Запрос.Выполнить();
		
	КонецЕсли;
	
	
	
	ЗафиксироватьТранзакцию();
	
	Возврат РезультатЗапроса;
	
КонецФункции  // ПолучитьДанныеУчета

// создает строку движений БУОсновныеНачисления или БУДополнительныеНачисления
// вызывается из ОбработатьДанныеУчета
//
// Параметры:
//	ДанныеУчета				- спозиционированная выборка по результату запроса
//	НаборЗаписей			- набор записей
//	ЭтоОсновныеНачисления	- признак того, что передан набор записей основных начсилений
//	Пустой счет				- пустая ссылка на счет
//
Функция СоздатьСтрокуДвижений(ДанныеУчета, НаборЗаписей, ЭтоОсновныеНачисления, ПустойСчет, ТЗДанныеУчета, ТочностьРасчетов) //Аверсон ЕАЕ СВФР-006057 (добавлены параметры ТЗДанныеУчета, ТочностьРасчетов)
	
	//О.Т. Аверсон 21.11.2016 № 11
	
	//Аверсон ЕАЕ 16.06.2020 СВФР-006057
	//(20) этот запрос вынесен из цикла
	//Запрос = Новый Запрос;
	//Запрос.Текст = 
	//"ВЫБРАТЬ
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
	//|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
	//|ИЗ
	//|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
	//|ГДЕ
	//|	НачалоПериода(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц) = &ПериодРегистрации
	//|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник";
	//
	//Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	//Запрос.УстановитьПараметр("ВидРасчетаСпособОтраженияВБухучете",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете);
	//
	//Запрос.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДт1",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1);
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДт2",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2);
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДт3",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3);
	//
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДтНУ1",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1);
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДтНУ2",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2);
	//Запрос.УстановитьПараметр("ВидРасчетаСубконтоДтНУ3",ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3);
	//
	//СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1",СпособПоУмолчанию.СубконтоДт1);
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2",СпособПоУмолчанию.СубконтоДт2);
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3",СпособПоУмолчанию.СубконтоДт3);
	//
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1",СпособПоУмолчанию.СубконтоДтНУ1);
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2",СпособПоУмолчанию.СубконтоДтНУ2);
	//Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3",СпособПоУмолчанию.СубконтоДтНУ3);
	//
	//Запрос.УстановитьПараметр("ВидРасчета",ДанныеУчета.ВидРасчета);
	//
	//Запрос.УстановитьПараметр("ПодразделениеОрганизации",ДанныеУчета.ПодразделениеОрганизации);
	//Запрос.УстановитьПараметр("Сотрудник", ДанныеУчета.Сотрудник);
	//
	//РезультатЗапросаТЗ = Запрос.Выполнить().Выгрузить();
	СтрОтбора = Новый Структура;
	СтрОтбора.Вставить("Сотрудник", ДанныеУчета.Сотрудник);
	//СтрОтбора.Вставить("ПериодРегистрации", ПериодРегистрации);
	РезультатЗапросаТЗ = ТЗДанныеУчета.НайтиСтроки(СтрОтбора);
	//!!!
	//Аверсон
	//О.Т. Аверсон 21.11.2016 № 11
	
	//Аверсон ЕАЕ 23.09.2025 СВФР-016787
	//если праздничные - всю сумму отправим на способ отражения, выбранный в документе
	Продолжать = Истина;
	Если Организация.ИНН = "790041382" И (ТипЗнч(ДанныеУчета.Регистратор) = Тип("ДокументСсылка.ОплатаПраздничныхИВыходныхДнейОрганизаций") 
		ИЛИ ТипЗнч(ДанныеУчета.Регистратор) = Тип("ДокументСсылка.ОплатаСверхурочныхЧасов") 
		
		//Аверсон ЕАЕ 04.11.2025 СВФР-017147
		ИЛИ ТипЗнч(ДанныеУчета.Регистратор) = Тип("ДокументСсылка.ПовременнаяОплатаПриСделке")) Тогда
		//Аверсон СВФР-017147
		
		НомерСтроки = ДанныеУчета.НомерСтроки;
		Рез = ДанныеУчета.Результат;
		ПериодДействияНачало = ДанныеУчета.ПериодДействияНачало;
		ПериодДействияКонец = ДанныеУчета.ПериодДействияКонец;
		Регистратор = ДанныеУчета.Регистратор;
		Сотр = ДанныеУчета.Сотрудник;
		
		//Аверсон ЕАЕ 04.11.2025 СВФР-017147
		Если ТипЗнч(ДанныеУчета.Регистратор) = Тип("ДокументСсылка.ПовременнаяОплатаПриСделке") Тогда
			СпособОтражения = ПолучитьСпособОтраженияИзДокументаСделка(Регистратор, Сотр, ПериодДействияНачало,ПериодДействияКонец,Рез,НомерСтроки);
		Иначе
		//Аверсон СВФР-017147
		
			СпособОтражения = ПолучитьСпособОтраженияИзДокумента(Регистратор,Сотр,ПериодДействияНачало,ПериодДействияКонец,Рез,НомерСтроки);
		КонецЕсли;
		
		Если ЗначениеЗаполнено(СпособОтражения) Тогда
			СтрокаДанных = НаборЗаписей.Добавить();
			
			// вид расчета
			СтрокаДанных.ВидРасчета					= ДанныеУчета.ВидРасчета;
			
			// период регистрации
			СтрокаДанных.ПериодРегистрации			= ПериодРегистрации;
			
			// измерения
			СтрокаДанных.Сотрудник					= ДанныеУчета.Сотрудник;
			СтрокаДанных.Физлицо					= ДанныеУчета.Физлицо;
			СтрокаДанных.Организация				= ДанныеУчета.ГоловнаяОрганизация;
			
			// ресурсы
			СтрокаДанных.Результат					= ДанныеУчета.Результат;
			
			// реквизиты
			Если ЭтоОсновныеНачисления Тогда
				// только для БУОсновныеНачисления
				
				// период действия
				СтрокаДанных.ПериодДействияНачало	= ДанныеУчета.ПериодДействияНачало;
				СтрокаДанных.ПериодДействияКонец	= ДанныеУчета.ПериодДействияКонец;
				
				СтрокаДанных.ГрафикРаботы			= ДанныеУчета.ГрафикРаботы;
				СтрокаДанных.ВидУчетаВремени		= ДанныеУчета.ВидУчетаВремени;
				
				//Аверсон ЕАЕ 22.06.2022 СВФР-009233
			Иначе
				СтрокаДанных.БазовыйПериодНачало = ДанныеУчета.БазовыйПериодНачало;
				СтрокаДанных.БазовыйПериодКонец  = ДанныеУчета.БазовыйПериодКонец;
				//Аверсон СВФР-009233
				
			КонецЕсли;
			
			СтрокаДанных.СчетДт			= СпособОтражения.СчетДт;
			СтрокаДанных.СчетКт			= СпособОтражения.СчетКт;
			СтрокаДанных.СубконтоДт1	= СпособОтражения.СубконтоДт1;
			СтрокаДанных.СубконтоДт2	= СпособОтражения.СубконтоДт2;
			СтрокаДанных.СубконтоДт3	= СпособОтражения.СубконтоДт3;
			СтрокаДанных.СубконтоКт1	= СпособОтражения.СубконтоКт1;
			СтрокаДанных.СубконтоКт2	= СпособОтражения.СубконтоКт2;
			СтрокаДанных.СубконтоКт3	= СпособОтражения.СубконтоКт3;
			СтрокаДанных.СчетДтНУ		= СпособОтражения.СчетДтНУ;
			СтрокаДанных.СчетКтНУ		= СпособОтражения.СчетКтНУ;
			СтрокаДанных.СубконтоДтНУ1	= СпособОтражения.СубконтоДтНУ1;
			СтрокаДанных.СубконтоДтНУ2	= СпособОтражения.СубконтоДтНУ2;
			СтрокаДанных.СубконтоДтНУ3	= СпособОтражения.СубконтоДтНУ3;
			СтрокаДанных.СубконтоКтНУ1	= СпособОтражения.СубконтоКтНУ1;
			СтрокаДанных.СубконтоКтНУ2	= СпособОтражения.СубконтоКтНУ2;
			СтрокаДанных.СубконтоКтНУ3	= СпособОтражения.СубконтоКтНУ3;
			//СтрокаДанных.СчетКтУСН		= ДанныеУчета.СчетКтУСН;
			//СтрокаДанных.ОтражениеВУСН	= ДанныеУчета.ОтражениеВУСН;
			
			СтрокаДанных.ОбособленноеПодразделение = Организация;
			
			АвтозаполнениеСубконто(ДанныеУчета, СтрокаДанных, ПустойСчет);
			Продолжать = Ложь;
		Иначе
			Продолжать = Истина;
		КонецЕсли;
		
	КонецЕсли;
	
	Если Продолжать Тогда
		//Аверсон СВФР-016787
		
		если РезультатЗапросаТЗ.Количество()> 0 и не НачалоМесяца(ДанныеУчета.ПериодДействияНачало) > ПериодРегистрации и ДанныеУчета.ВидРасчета.СпособОтраженияВБухучете = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка() Тогда //О.Т. Аверсон 21.11.2016 № 11
			
			ЗначениеОстаток = ДанныеУчета.Результат;
			Сч = 1;
			для Каждого Стр из РезультатЗапросаТЗ Цикл 
				СтрокаДанных = НаборЗаписей.Добавить();
				
				// вид расчета
				СтрокаДанных.ВидРасчета					= ДанныеУчета.ВидРасчета;
				
				// период регистрации
				СтрокаДанных.ПериодРегистрации			= ПериодРегистрации;
				
				// измерения
				СтрокаДанных.Сотрудник					= ДанныеУчета.Сотрудник;
				СтрокаДанных.Физлицо					= ДанныеУчета.Физлицо;
				СтрокаДанных.Организация				= ДанныеУчета.ГоловнаяОрганизация;
				
				// ресурсы
				Если Сч = РезультатЗапросаТЗ.Количество() Тогда 
					СтрокаДанных.Результат					= ЗначениеОстаток;
				иначе
					
					//Аверсон ЕАЕ 16.06.2020 СВФР-006057
					//СтрокаДанных.Результат					= ОбщегоНазначения.ОкруглитьЗначение2016(ДанныеУчета.Результат * Стр.ДоляСпособаОтражения / 100,ПериодРегистрации);
					СтрокаДанных.Результат					= ОбщегоНазначения.ОкруглитьЗначение2016СТочностьюРасчетов(ДанныеУчета.Результат * Стр.ДоляСпособаОтражения / 100,,ТочностьРасчетов);
					//Аверсон
				КонецЕсли;
				ЗначениеОстаток = ЗначениеОстаток - СтрокаДанных.Результат;
				// реквизиты
				Если ЭтоОсновныеНачисления Тогда
					// только для БУОсновныеНачисления
					
					// период действия
					СтрокаДанных.ПериодДействияНачало	= ДанныеУчета.ПериодДействияНачало;
					СтрокаДанных.ПериодДействияКонец	= ДанныеУчета.ПериодДействияКонец;
					
					СтрокаДанных.ГрафикРаботы			= ДанныеУчета.ГрафикРаботы;
					СтрокаДанных.ВидУчетаВремени		= ДанныеУчета.ВидУчетаВремени;
					
					//Аверсон ЕАЕ 22.06.2022 СВФР-009233
				Иначе
					СтрокаДанных.БазовыйПериодНачало = ДанныеУчета.БазовыйПериодНачало;
					СтрокаДанных.БазовыйПериодКонец  = ДанныеУчета.БазовыйПериодКонец;
					//Аверсон СВФР-009233
					
				КонецЕсли;
				
				СтрокаДанных.СчетДт			= Стр.СчетДт;
				СтрокаДанных.СчетКт			= ДанныеУчета.СчетКт;
				СтрокаДанных.СубконтоДт1	= Стр.СубконтоДт1;
				СтрокаДанных.СубконтоДт2	= Стр.СубконтоДт2;
				СтрокаДанных.СубконтоДт3	= Стр.СубконтоДт3;
				СтрокаДанных.СубконтоКт1	= ДанныеУчета.СубконтоКт1;
				СтрокаДанных.СубконтоКт2	= ДанныеУчета.СубконтоКт2;
				СтрокаДанных.СубконтоКт3	= ДанныеУчета.СубконтоКт3;
				СтрокаДанных.СчетДтНУ		= Стр.СчетДтНУ;
				СтрокаДанных.СчетКтНУ		= ДанныеУчета.СчетКтНУ;
				СтрокаДанных.СубконтоДтНУ1	= Стр.СубконтоДтНУ1;
				СтрокаДанных.СубконтоДтНУ2	= Стр.СубконтоДтНУ2;
				СтрокаДанных.СубконтоДтНУ3	= Стр.СубконтоДтНУ3;
				СтрокаДанных.СубконтоКтНУ1	= ?(ДанныеУчета.НомерСубконтоСт255НК = 1, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ1);
				СтрокаДанных.СубконтоКтНУ2	= ?(ДанныеУчета.НомерСубконтоСт255НК = 2, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ2);
				СтрокаДанных.СубконтоКтНУ3	= ?(ДанныеУчета.НомерСубконтоСт255НК = 3, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ3);
				//СтрокаДанных.СчетКтУСН		= ДанныеУчета.СчетКтУСН;
				//СтрокаДанных.ОтражениеВУСН	= ДанныеУчета.ОтражениеВУСН;
				
				СтрокаДанных.ОбособленноеПодразделение = Организация;
				
				АвтозаполнениеСубконто(ДанныеУчета, СтрокаДанных, ПустойСчет);
				Сч = Сч+1;
			КонецЦикла;
			//О.Т. Аверсон 21.11.2016 № 11
		иначе
			
			СтрокаДанных = НаборЗаписей.Добавить();
			
			// вид расчета
			СтрокаДанных.ВидРасчета					= ДанныеУчета.ВидРасчета;
			
			// период регистрации
			СтрокаДанных.ПериодРегистрации			= ПериодРегистрации;
			
			// измерения
			СтрокаДанных.Сотрудник					= ДанныеУчета.Сотрудник;
			СтрокаДанных.Физлицо					= ДанныеУчета.Физлицо;
			СтрокаДанных.Организация				= ДанныеУчета.ГоловнаяОрганизация;
			
			// ресурсы
			СтрокаДанных.Результат					= ДанныеУчета.Результат;
			
			// реквизиты
			Если ЭтоОсновныеНачисления Тогда
				// только для БУОсновныеНачисления
				
				// период действия
				СтрокаДанных.ПериодДействияНачало	= ДанныеУчета.ПериодДействияНачало;
				СтрокаДанных.ПериодДействияКонец	= ДанныеУчета.ПериодДействияКонец;
				
				СтрокаДанных.ГрафикРаботы			= ДанныеУчета.ГрафикРаботы;
				СтрокаДанных.ВидУчетаВремени		= ДанныеУчета.ВидУчетаВремени;
				
				//Аверсон ЕАЕ 22.06.2022 СВФР-009233
			Иначе
				СтрокаДанных.БазовыйПериодНачало = ДанныеУчета.БазовыйПериодНачало;
				СтрокаДанных.БазовыйПериодКонец  = ДанныеУчета.БазовыйПериодКонец;
				//Аверсон СВФР-009233
				
			КонецЕсли;
			
			СтрокаДанных.СчетДт			= ДанныеУчета.СчетДт;
			СтрокаДанных.СчетКт			= ДанныеУчета.СчетКт;
			СтрокаДанных.СубконтоДт1	= ДанныеУчета.СубконтоДт1;
			СтрокаДанных.СубконтоДт2	= ДанныеУчета.СубконтоДт2;
			СтрокаДанных.СубконтоДт3	= ДанныеУчета.СубконтоДт3;
			СтрокаДанных.СубконтоКт1	= ДанныеУчета.СубконтоКт1;
			СтрокаДанных.СубконтоКт2	= ДанныеУчета.СубконтоКт2;
			СтрокаДанных.СубконтоКт3	= ДанныеУчета.СубконтоКт3;
			СтрокаДанных.СчетДтНУ		= ДанныеУчета.СчетДтНУ;
			СтрокаДанных.СчетКтНУ		= ДанныеУчета.СчетКтНУ;
			СтрокаДанных.СубконтоДтНУ1	= ДанныеУчета.СубконтоДтНУ1;
			СтрокаДанных.СубконтоДтНУ2	= ДанныеУчета.СубконтоДтНУ2;
			СтрокаДанных.СубконтоДтНУ3	= ДанныеУчета.СубконтоДтНУ3;
			СтрокаДанных.СубконтоКтНУ1	= ?(ДанныеУчета.НомерСубконтоСт255НК = 1, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ1);
			СтрокаДанных.СубконтоКтНУ2	= ?(ДанныеУчета.НомерСубконтоСт255НК = 2, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ2);
			СтрокаДанных.СубконтоКтНУ3	= ?(ДанныеУчета.НомерСубконтоСт255НК = 3, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ3);
			//СтрокаДанных.СчетКтУСН		= ДанныеУчета.СчетКтУСН;
			//СтрокаДанных.ОтражениеВУСН	= ДанныеУчета.ОтражениеВУСН;
			
			СтрокаДанных.ОбособленноеПодразделение = Организация;
			
			АвтозаполнениеСубконто(ДанныеУчета, СтрокаДанных, ПустойСчет);
		КонецЕсли;
	КонецЕсли;
	Возврат СтрокаДанных;
КонецФункции // СоздатьСтрокуДвижений()

// Функция формирует набор записей по данным из запроса
// и в том случае, если проводится обработка первичных данных
// возвращает массив категорий непервичных начислений для 
// которых необходимо выполнить формирование данных учета
//
// Параметры:
//	РезультатДанныеУчета		- выборка по резултату запроса, возвращенная функцией 
//								  ПолучитьПервичныеДанныеУчета или ПолучитьВторичныеДанныеУчета
//	ОбработкаПервичныхДанных	- проводится ли обработка первичных данных (или вторичных)
//	Успешно						- в этот параметр возвращается значение Ложь, если обработка не выполнена
//								  (например, если не оказалось базовых данных)
//	НаборЗаписей - набор записей
//
// Возвращаемое значение:
//	массив категорий начислений
//
Функция ОбработатьДанныеУчета(РезультатДанныеУчета, Успешно, НаборЗаписей, ПараметрыПолученияСубконто = НеОпределено, ТЗДанныеУчета, ТочностьРасчетов) //Аверсон ЕАЕ СВФР-006057 (добавлены параметры ТЗДанныеУчета, ТочностьРасчетов)
	
	// признак основных начислений
	ЭтоОсновныеНачисления = (ТипЗнч(НаборЗаписей) = Тип("РегистрРасчетаНаборЗаписей.БУОсновныеНачисления"));
	
	// пустая ссылка на счет - для проверок способов отражения в бухучете
	ПустойСчет = ПланыСчетов.Хозрасчетный.ПустаяСсылка();
	
	// основная выборка - по ней ведем обход и вводим записи движений
	ДанныеУчета = РезультатДанныеУчета.Выбрать();
	Если Не ДанныеУчета.Следующий() Тогда
		ПродолжатьОбработку = Ложь;
	Иначе
		ПродолжатьОбработку = Истина;
	КонецЕсли;
	
	// вспомогательная выборка - по ней ведем суммирование базовых результатов
	ДанныеУчетаВспомогательные = РезультатДанныеУчета.Выбрать();
	
	//ДатаЗакона180ФЗ = '20060101';
	//ДатаЗакона255ФЗ = ПроведениеРасчетов.ПолучитьДатуВступленияВСилуИзмененийПоСоциальнымПособиям2006();
	
	// структура поиска для позиционирования в ДанныеНалоговогоУчетаВспомогательные
	// при необходимости суммирования "базовых" ресурсов
	СтруктураПоиска = Новый Структура("Регистратор,НомерСтроки");
	
	Пока ПродолжатьОбработку Цикл
		ОбработкаПрерыванияПользователя();//О.Т. Аверсон 09.11.2017 № 1219
		СтрокаДанных = СоздатьСтрокуДвижений(ДанныеУчета, НаборЗаписей, ЭтоОсновныеНачисления, ПустойСчет, ТЗДанныеУчета, ТочностьРасчетов); //Аверсон ЕАЕ СВФР-006057 (добавлены параметры ТЗДанныеУчета, ТочностьРасчетов)
		
		//Аверсон 27.07.2023 КВВ СВФР-010889 (
		Если Организация.ИНН = "100194961" Тогда 
			Если Лев(СокрЛП(СтрокаДанных.СчетДт),2) <> "69" И Лев(СокрЛП(СтрокаДанных.СчетДт),2) <> "90" Тогда
				ИзмененияПоДолжности = Ложь;
				ДатаПроверкиДолж = ?(ЭтоОсновныеНачисления,ДанныеУчета.ПериодДействияНачало,ДанныеУчета.БазовыйПериодНачало);
				ДолжСотр = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ДатаПроверкиДолж,Новый Структура("Сотрудник",ДанныеУчета.Сотрудник)).Должность;
				Если ЗначениеЗаполнено(ДолжСотр.ОтражениеВРегУчете) Тогда
					ИзмененияПоДолжности = Истина;
				КонецЕсли;
				
				ОтборТЗПостНачССчетомИНомГруппой = Новый Структура;
				ОтборТЗПостНачССчетомИНомГруппой.Вставить("Сотрудник", ДанныеУчета.Сотрудник);
				ОтборТЗПостНачССчетомИНомГруппой.Вставить("ВидРасчета", ДанныеУчета.ВидРасчета);
				СтрокиОтборТЗПостНачССчетомИНомГруппой = ТЗПостНачССчетомИНомГруппой.НайтиСтроки(ОтборТЗПостНачССчетомИНомГруппой);
				
				ОтборТЗДанныеУчета = Новый Структура;
				ОтборТЗДанныеУчета.Вставить("Сотрудник", ДанныеУчета.Сотрудник);
				СтрокиОтборТЗДанныеУчета = ТЗДанныеУчета.НайтиСтроки(ОтборТЗДанныеУчета);
				Если НЕ ДанныеУчета.Перераспределено 
					ИЛИ СтрокиОтборТЗДанныеУчета.Количество() > 0 
					ИЛИ ИзмененияПоДолжности 
					ИЛИ СтрокиОтборТЗПостНачССчетомИНомГруппой.Количество() > 0 Тогда 
					
					МенятьНомГруппу = ?((СтрокиОтборТЗДанныеУчета.Количество() > 0 И СтрокиОтборТЗДанныеУчета[0].БезУчетаКодаВР) ИЛИ СтрокиОтборТЗПостНачССчетомИНомГруппой.Количество() > 0,Ложь,Истина);
					
					ОтборРезЗРаспр = Новый Структура;
					ОтборРезЗРаспр.Вставить("ВР", ДанныеУчета.ВидРасчета);
					ОтборРезЗРаспр.Вставить("Счет", СтрокаДанных.СчетДт);
					СтрокиРезЗРаспр = РезЗРаспр.НайтиСтроки(ОтборРезЗРаспр);
					
					Если СтрокиОтборТЗДанныеУчета.Количество() > 0 И ЗначениеЗаполнено(СтрокиОтборТЗДанныеУчета[0].СпособОтраженияВБухучете) 
						ИЛИ ИзмененияПоДолжности 
						ИЛИ СтрокиОтборТЗПостНачССчетомИНомГруппой.Количество() > 0 Тогда
						
						Если ИзмененияПоДолжности Тогда
							
							НужнаяСтр = ДолжСотр.ОтражениеВРегУчете;
							
							_БылСчетДт = СтрокаДанных.СчетДт;
							_БылСчетДтНУ = СтрокаДанных.СчетДтНУ;
							
							СтрокаДанных.СчетДт = НужнаяСтр.СчетДт;
							СтрокаДанных.СчетДтНУ = НужнаяСтр.СчетДтНУ;
							
							ОтборРезЗРаспр = Новый Структура;
							ОтборРезЗРаспр.Вставить("ВР", ДанныеУчета.ВидРасчета);
							ОтборРезЗРаспр.Вставить("Счет", СтрокаДанных.СчетДт);
							СтрокиРезЗРаспр = РезЗРаспр.НайтиСтроки(ОтборРезЗРаспр);
							
							КолвоСубконто = НужнаяСтр.СчетДт.ВидыСубконто.Количество();
							
							БылоИзменениеСубконто = Ложь;
							Для А = 1 ПО КолвоСубконто Цикл
								Если НужнаяСтр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
									Если ТипЗнч(СтрокаДанных["СубконтоДт" + Строка(А)]) <> "Подразделения организаций" Тогда
										СтрокаДанных["СубконтоДт" + Строка(А)] = Справочники.ПодразделенияОрганизаций.ПустаяСсылка(); 
										БылоИзменениеСубконто = Истина; 
									КонецЕсли;
								ИначеЕсли НужнаяСтр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
									Если ТипЗнч(СтрокаДанных["СубконтоДт" + Строка(А)]) <> "Статьи затрат" Тогда
										СтрокаДанных["СубконтоДт" + Строка(А)] = Справочники.СтатьиЗатрат.ПустаяСсылка(); 
										БылоИзменениеСубконто = Истина;
									КонецЕсли;                           
								ИначеЕсли НужнаяСтр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
									Если ТипЗнч(СтрокаДанных["СубконтоДт" + Строка(А)]) <> "Номенклатурные группы" Тогда
										СтрокаДанных["СубконтоДт" + Строка(А)] = Справочники.НоменклатурныеГруппы.ПустаяСсылка(); 
										БылоИзменениеСубконто = Истина;
									КонецЕсли; 	
								КонецЕсли;                         
							КонецЦикла;
							
						ИначеЕсли СтрокиОтборТЗПостНачССчетомИНомГруппой.Количество() > 0 Тогда
							НужныйСчет = СтрокиОтборТЗПостНачССчетомИНомГруппой[0].Счет;
							НужнаяНомГруппа = СтрокиОтборТЗПостНачССчетомИНомГруппой[0].НомГруппа;
							НужноеПодр = СтрокиОтборТЗПостНачССчетомИНомГруппой[0].Подразделение;
							
							_БылСчетДт = СтрокаДанных.СчетДт;
							_БылСчетДтНУ = СтрокаДанных.СчетДтНУ;
							
							СтрокаДанных.СчетДт = НужныйСчет;
							СтрокаДанных.СчетДтНУ = ПланыСчетов.Налоговый.ПустаяСсылка();
							
							КолвоСубконто = НужныйСчет.ВидыСубконто.Количество();
							
							Для А = 1 ПО КолвоСубконто Цикл
								Если НужныйСчет.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
									Если ТипЗнч(СтрокаДанных["СубконтоДт" + Строка(А)]) <> "Подразделения организаций" Тогда
										СтрокаДанных["СубконтоДт" + Строка(А)] = Справочники.ПодразделенияОрганизаций.ПустаяСсылка(); 
									КонецЕсли;
									СтрокаДанных["СубконтоДт" + Строка(А)] = НужноеПодр;
									
								ИначеЕсли НужныйСчет.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
									Если ТипЗнч(СтрокаДанных["СубконтоДт" + Строка(А)]) <> "Статьи затрат" Тогда
										СтрокаДанных["СубконтоДт" + Строка(А)] = Справочники.СтатьиЗатрат.ПустаяСсылка(); 
									КонецЕсли;                           
								ИначеЕсли НужныйСчет.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
									Если ТипЗнч(СтрокаДанных["СубконтоДт" + Строка(А)]) <> "Номенклатурные группы" Тогда
										СтрокаДанных["СубконтоДт" + Строка(А)] = Справочники.НоменклатурныеГруппы.ПустаяСсылка(); 
									КонецЕсли; 
									СтрокаДанных["СубконтоДт" + Строка(А)] = НужнаяНомГруппа;
								КонецЕсли;                         
							КонецЦикла;
							
							
						Иначе
							НужнаяСтр = СтрокиОтборТЗДанныеУчета[0].СпособОтраженияВБухучете;
						КонецЕсли;
						Если СтрокиОтборТЗПостНачССчетомИНомГруппой.Количество() = 0 Тогда
							НужноеПодр1 = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
							НужнаяНомГруппа1 = Справочники.НоменклатурныеГруппы.ПустаяСсылка();
							НужноеПодр2 = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
							НужнаяНомГруппа2 = Справочники.НоменклатурныеГруппы.ПустаяСсылка();
							Если СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДт1)) = "Подразделения организаций" Тогда
								НужноеПодр1 = НужнаяСтр.СубконтоДт1;
							ИначеЕсли СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДт2)) = "Подразделения организаций" Тогда
								НужноеПодр1 = НужнаяСтр.СубконтоДт2;	
							ИначеЕсли СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДт3)) = "Подразделения организаций" Тогда
								НужноеПодр1 = НужнаяСтр.СубконтоДт3;
							КонецЕсли;
							Если СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДтНУ1)) = "Подразделения организаций" Тогда
								НужноеПодр2 = НужнаяСтр.СубконтоДтНУ1;
							ИначеЕсли СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДтНУ2)) = "Подразделения организаций" Тогда
								НужноеПодр2 = НужнаяСтр.СубконтоДтНУ2;	
							ИначеЕсли СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДтНУ3)) = "Подразделения организаций" Тогда
								НужноеПодр2 = НужнаяСтр.СубконтоДтНУ3;
							КонецЕсли;
							
							Если ЗначениеЗаполнено(НужноеПодр1) Тогда
								Если СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт1)) = "Подразделения организаций" Тогда
									СтрокаДанных.СубконтоДт1 = НужноеПодр1;
								ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт2)) = "Подразделения организаций" Тогда
									СтрокаДанных.СубконтоДт2 = НужноеПодр1;
								ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт3)) = "Подразделения организаций" Тогда
									СтрокаДанных.СубконтоДт3 = НужноеПодр1;
								КонецЕсли;
							КонецЕсли;
							
							Если ЗначениеЗаполнено(НужноеПодр2) Тогда	
								Если СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ1)) = "Подразделения организаций" Тогда
									СтрокаДанных.СубконтоДтНУ1 = НужноеПодр2;
								ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ2)) = "Подразделения организаций" Тогда
									СтрокаДанных.СубконтоДтНУ2 = НужноеПодр2;
								ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ3)) = "Подразделения организаций" Тогда
									СтрокаДанных.СубконтоДтНУ3 = НужноеПодр2;
								КонецЕсли;
							КонецЕсли;
							
							Если СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДт1)) = "Номенклатурные группы" Тогда
								НужнаяНомГруппа1 = НужнаяСтр.СубконтоДт1;
							ИначеЕсли СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДт2)) = "Номенклатурные группы" Тогда
								НужнаяНомГруппа1 = НужнаяСтр.СубконтоДт2;	
							ИначеЕсли СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДт3)) = "Номенклатурные группы" Тогда
								НужнаяНомГруппа1 = НужнаяСтр.СубконтоДт3;
							КонецЕсли;
							
							Если СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДтНУ1)) = "Номенклатурные группы" Тогда
								НужнаяНомГруппа2 = НужнаяСтр.СубконтоДтНУ1;
							ИначеЕсли СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДтНУ2)) = "Номенклатурные группы" Тогда
								НужнаяНомГруппа2 = НужнаяСтр.СубконтоДтНУ2;	
							ИначеЕсли СокрЛП(ТипЗнч(НужнаяСтр.СубконтоДтНУ3)) = "Номенклатурные группы" Тогда
								НужнаяНомГруппа2 = НужнаяСтр.СубконтоДтНУ3;
							КонецЕсли;
							
							Если ЗначениеЗаполнено(НужнаяНомГруппа1) Тогда
								Если СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт1)) = "Номенклатурные группы" Тогда
									СтрокаДанных.СубконтоДт1 = НужнаяНомГруппа1;
								ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт2)) = "Номенклатурные группы" Тогда
									СтрокаДанных.СубконтоДт2 = НужнаяНомГруппа1;
								ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт3)) = "Номенклатурные группы" Тогда
									СтрокаДанных.СубконтоДт3 = НужнаяНомГруппа1;
								КонецЕсли;
							КонецЕсли;
							
							Если ЗначениеЗаполнено(НужнаяНомГруппа2) Тогда
								Если СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ1)) = "Номенклатурные группы" Тогда
									СтрокаДанных.СубконтоДтНУ1 = НужнаяНомГруппа2;
								ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ2)) = "Номенклатурные группы" Тогда
									СтрокаДанных.СубконтоДтНУ2 = НужнаяНомГруппа2;
								ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ3)) = "Номенклатурные группы" Тогда
									СтрокаДанных.СубконтоДтНУ3 = НужнаяНомГруппа2;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					
					Если МенятьНомГруппу Тогда
						Если СтрокиРезЗРаспр.Количество() > 0 Тогда
							НомГруппа = СтрокиРезЗРаспр[0].НомГруппа;
							Если СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт1)) = "Номенклатурные группы" Тогда
								СтрокаДанных.СубконтоДт1 = НомГруппа;
							ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт2)) = "Номенклатурные группы" Тогда
								СтрокаДанных.СубконтоДт2 = НомГруппа;
							ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДт3)) = "Номенклатурные группы" Тогда
								СтрокаДанных.СубконтоДт3 = НомГруппа;
							КонецЕсли;
							
							Если СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ1)) = "Номенклатурные группы" Тогда
								СтрокаДанных.СубконтоДтНУ1 = НомГруппа;
							ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ2)) = "Номенклатурные группы" Тогда
								СтрокаДанных.СубконтоДтНУ2 = НомГруппа;
							ИначеЕсли СокрЛП(ТипЗнч(СтрокаДанных.СубконтоДтНУ3)) = "Номенклатурные группы" Тогда
								СтрокаДанных.СубконтоДтНУ3 = НомГруппа;
							КонецЕсли;
						КонецЕсли;	
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		//Аверсон 27.07.2023 КВВ СВФР-010889 )
		
		Если ДанныеУчета.СчетДт <> ПустойСчет И ДанныеУчета.СчетКт <> ПустойСчет Тогда
			//СтрокаДанных.Результат = ДанныеУчета.Результат;
			
			Если Не ДанныеУчета.Следующий() Тогда
				ПродолжатьОбработку = Ложь;
			КонецЕсли;
			
		ИначеЕсли ДанныеУчета.СчетДт = ПустойСчет ИЛИ ДанныеУчета.СчетКт = ПустойСчет Тогда
			// вычисляем результат нормируя его на базу для строк базы относящихся 
			// к одной строке основного регистра
			
			// текущий ключ поиска 
			ТекущийРегистратор = ДанныеУчета.Регистратор;
			ТекущийНомерСтроки = ДанныеУчета.НомерСтроки;
			// позиционируемся во вспомогательной выборке по запросу для суммирования "базовых" данных
			СтруктураПоиска.Регистратор = ТекущийРегистратор;
			СтруктураПоиска.НомерСтроки = ТекущийНомерСтроки;
			Если 	ДанныеУчетаВспомогательные.Регистратор <> ТекущийРегистратор ИЛИ 
				ДанныеУчетаВспомогательные.НомерСтроки <> ТекущийНомерСтроки Тогда
				// ищем следующую строку во спомогательной выборке если она не является искомой	
				ДанныеУчетаВспомогательные.НайтиСледующий(СтруктураПоиска);
			КонецЕсли;
			
			СуммаПоСтроке = 0;
			// суммируем базовые ресурсы по текущей строке набора записей
			Пока ДанныеУчетаВспомогательные.Регистратор = ТекущийРегистратор И ДанныеУчетаВспомогательные.НомерСтроки = ТекущийНомерСтроки Цикл
				Если ДанныеУчетаВспомогательные.РезультатБаза = NULL Тогда
					Успешно = Ложь;
				Иначе
					СуммаПоСтроке = СуммаПоСтроке + ДанныеУчетаВспомогательные.РезультатБаза;
				КонецЕсли;
				Если Не ДанныеУчетаВспомогательные.Следующий() Тогда
					Прервать;
				КонецЕсли;
			КонецЦикла;
			// суммарная доля, которую уже "разбросали" на строки с одинаковым регистратором и номером строки
			СуммарнаяДоля = 0;
			// полный результат
			ПолныйРезультат = ДанныеУчета.Результат;
			// обходим строки и вычисляем долю результата по базовым записям
			ПерваяИзГруппыСтрок = Истина;
			Пока ДанныеУчета.Регистратор = ТекущийРегистратор И ДанныеУчета.НомерСтроки = ТекущийНомерСтроки Цикл
				// если это не первая из группы "базовых" строк по одной строке основного регистра
				// то создаем очередную строку движений
				Если Не ПерваяИзГруппыСтрок Тогда
					СтрокаДанных = СоздатьСтрокуДвижений(ДанныеУчета, НаборЗаписей, ЭтоОсновныеНачисления, ПустойСчет, ТЗДанныеУчета, ТочностьРасчетов); //Аверсон ЕАЕ СВФР-006057 (добавлены параметры ТЗДанныеУчета, ТочностьРасчетов)
				Иначе
					ПерваяИзГруппыСтрок = Ложь;
				КонецЕсли;
				
				Если СуммаПоСтроке = 0 Тогда
					Доля = 0;
				Иначе
					Если ДанныеУчета.РезультатБаза = NULL Тогда
						Успешно = Ложь;
						Доля = 0;
					Иначе
						Доля = ПолныйРезультат * ДанныеУчета.РезультатБаза / СуммаПоСтроке;
					КонецЕсли;
				КонецЕсли;
				
				// если счет пустой - заполним счет данными базы
				Если ДанныеУчета.СчетДт = ПустойСчет Тогда
					Если ДанныеУчета.СчетДтРазрез = NULL Тогда
						Успешно = Ложь;
					Иначе
						СтрокаДанных.СчетДт 	 = ДанныеУчета.СчетДтРазрез;
						СтрокаДанных.СубконтоДт1 = ДанныеУчета.СубконтоДт1Разрез;
						СтрокаДанных.СубконтоДт2 = ДанныеУчета.СубконтоДт2Разрез;
						СтрокаДанных.СубконтоДт3 = ДанныеУчета.СубконтоДт3Разрез;
						СтрокаДанных.СчетДтНУ 	 = ДанныеУчета.СчетДтНУРазрез;
						СтрокаДанных.СубконтоДтНУ1 = ДанныеУчета.СубконтоДтНУ1Разрез;
						СтрокаДанных.СубконтоДтНУ2 = ДанныеУчета.СубконтоДтНУ2Разрез;
						СтрокаДанных.СубконтоДтНУ3 = ДанныеУчета.СубконтоДтНУ3Разрез;
					КонецЕсли;
				КонецЕсли;
				// если счет пустой - заполним счет данными базы
				Если ДанныеУчета.СчетКт = ПустойСчет Тогда
					Если ДанныеУчета.СчетКтРазрез = NULL Тогда
						Успешно = Ложь;
					Иначе
						СтрокаДанных.СчетКт 	 = ДанныеУчета.СчетКтРазрез;
						СтрокаДанных.СубконтоКт1 = ДанныеУчета.СубконтоКт1Разрез;
						СтрокаДанных.СубконтоКт2 = ДанныеУчета.СубконтоКт2Разрез;
						СтрокаДанных.СубконтоКт3 = ДанныеУчета.СубконтоКт3Разрез;
						СтрокаДанных.СчетКтНУ	 = ДанныеУчета.СчетКтНУРазрез;
						СтрокаДанных.СубконтоКтНУ1 = ?(ДанныеУчета.НомерСубконтоСт255НКБазы = 1, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ1Разрез);
						СтрокаДанных.СубконтоКтНУ2 = ?(ДанныеУчета.НомерСубконтоСт255НКБазы = 2, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ2Разрез);
						СтрокаДанных.СубконтоКтНУ3 = ?(ДанныеУчета.НомерСубконтоСт255НКБазы = 3, ДанныеУчета.ВидНачисленияПоСт255НК, ДанныеУчета.СубконтоКтНУ3Разрез);
					КонецЕсли;
				КонецЕсли;
				
				СтрокаДанных.Результат = Доля;
				СуммарнаяДоля = СуммарнаяДоля + Доля;
				Если Не ДанныеУчета.Следующий() Тогда
					ПродолжатьОбработку = Ложь;
					Прервать;
				КонецЕсли;
			КонецЦикла;
			// ошибки округления скаладываются на последнюю запись из группы базовых записей
			СтрокаДанных.Результат = СтрокаДанных.Результат + ПолныйРезультат - СуммарнаяДоля;
		Иначе
			Если Не ДанныеУчета.Следующий() Тогда
				ПродолжатьОбработку = Ложь;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	// при записи данных учета не затираем уже введенные движения
	НаборЗаписей.Записать(Ложь);
	
КонецФункции	

// создает строку промежуточной таблицы, которпая впоследствии будет выгружена в табличную часть
// Параметры:
//	ДанныеУчета - спозиционированная выборка по результату запроса
//
Функция СоздатьСтрокуПромежуточнойТаблицы(ДанныеУчета, ПромежуточнаяТаблица, ПустойСчет)
	
	СтрокаДанных = ПромежуточнаяТаблица.Добавить();
	
	//Аверсон ЕАЕ 27.06.2024 СВФР-012907
	//Климовичи
	Если Организация.ИНН = "700103211" Тогда
		ДанныеСчетДт = ПолучитьСчетДт(ДанныеУчета.Физлицо, ДанныеУчета.Регистратор, Неопределено, Истина);
		СтрокаДанных.СчетДт = ДанныеСчетДт.СчетДт;
		СтрокаДанных.СчетКт			= ДанныеУчета.СчетКт;
		Если ЗначениеЗаполнено(СтрокаДанных.СчетДт) Тогда
			Если Лев(СтрокаДанных.СчетДт.Код,2) = "26" ИЛИ Лев(СтрокаДанных.СчетДт.Код,2) = "25" Тогда
				СтрокаДанных.СубконтоДт1 = ДанныеСчетДт.СубконтоДт1;
				СтрокаДанных.СубконтоДт2 = ДанныеСчетДт.СубконтоДт2;
			ИначеЕсли Лев(СтрокаДанных.СчетДт.Код,2) = "76" Тогда
				СтрокаДанных.СубконтоДт1 = Неопределено;
			ИначеЕсли Лев(СтрокаДанных.СчетДт.Код,2) = "70" Тогда
				СтрокаДанных.СубконтоДт1 = ДанныеУчета.Физлицо;
			КонецЕсли;
		Иначе
			СтрокаДанных.СчетДт = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда;
			СтрокаДанных.СубконтоДт1 = ДанныеУчета.Физлицо;
		КонецЕсли;
		СтрокаДанных.СубконтоКт1	= ДанныеУчета.СубконтоКт1;
		СтрокаДанных.СубконтоКт2	= ДанныеУчета.СубконтоКт2;
		СтрокаДанных.СубконтоКт3	= ДанныеУчета.СубконтоКт3;
		СтрокаДанных.СчетДтНУ		= ДанныеУчета.СчетДтНУ;
		СтрокаДанных.СчетКтНУ		= ДанныеУчета.СчетКтНУ;
		СтрокаДанных.СубконтоДтНУ1	= ДанныеУчета.СубконтоДтНУ1;
		СтрокаДанных.СубконтоДтНУ2	= ДанныеУчета.СубконтоДтНУ2;
		СтрокаДанных.СубконтоДтНУ3	= ДанныеУчета.СубконтоДтНУ3;
		СтрокаДанных.СубконтоКтНУ1	= ДанныеУчета.СубконтоКтНУ1;
		СтрокаДанных.СубконтоКтНУ2	= ДанныеУчета.СубконтоКтНУ2;
		СтрокаДанных.СубконтоКтНУ3	= ДанныеУчета.СубконтоКтНУ3;	
		СтрокаДанных.Сумма			= ДанныеУчета.Результат;
		СтрокаДанных.ПризнакПроводки = Перечисления.ПризнакПроводки.Удержание;
		СтрокаДанных.ВидРасчета =  ДанныеУчета.Видрасчета;
	Иначе
		//Аверсон СВФР-012907
		
		СтрокаДанных.СчетДт			= ДанныеУчета.СчетДт;
		СтрокаДанных.СчетКт			= ДанныеУчета.СчетКт;
		СтрокаДанных.СубконтоДт1	= ДанныеУчета.СубконтоДт1;
		СтрокаДанных.СубконтоДт2	= ДанныеУчета.СубконтоДт2;
		СтрокаДанных.СубконтоДт3	= ДанныеУчета.СубконтоДт3;
		СтрокаДанных.СубконтоКт1	= ДанныеУчета.СубконтоКт1;
		СтрокаДанных.СубконтоКт2	= ДанныеУчета.СубконтоКт2;
		СтрокаДанных.СубконтоКт3	= ДанныеУчета.СубконтоКт3;
		СтрокаДанных.СчетДтНУ		= ДанныеУчета.СчетДтНУ;
		СтрокаДанных.СчетКтНУ		= ДанныеУчета.СчетКтНУ;
		СтрокаДанных.СубконтоДтНУ1	= ДанныеУчета.СубконтоДтНУ1;
		СтрокаДанных.СубконтоДтНУ2	= ДанныеУчета.СубконтоДтНУ2;
		СтрокаДанных.СубконтоДтНУ3	= ДанныеУчета.СубконтоДтНУ3;
		СтрокаДанных.СубконтоКтНУ1	= ДанныеУчета.СубконтоКтНУ1;
		СтрокаДанных.СубконтоКтНУ2	= ДанныеУчета.СубконтоКтНУ2;
		СтрокаДанных.СубконтоКтНУ3	= ДанныеУчета.СубконтоКтНУ3;	
		//СтрокаДанных.СчетКтУСН		= ДанныеУчета.СчетКтУСН;
		//СтрокаДанных.ОтражениеВУСН	= ДанныеУчета.ОтражениеВУСН;	
		СтрокаДанных.Сумма			= ДанныеУчета.Результат;
		СтрокаДанных.ПризнакПроводки = Перечисления.ПризнакПроводки.Удержание;
		СтрокаДанных.ВидРасчета =  ДанныеУчета.Видрасчета;
		
		// выполним автозаполнение субконто если это предусмотрено способом отражения в бухучете
		Если ДанныеУчета.СчетДт <> ПустойСчет Тогда
			Если ДанныеУчета.НомерСубконтоРаботникиДт <> 0 Тогда
				Субконто = ДанныеУчета[НомерДт + ДанныеУчета.НомерСубконтоРаботникиДт];
				Если НЕ ЗначениеЗаполнено(Субконто) Тогда
					СтрокаДанных["СубконтоДт" + ДанныеУчета.НомерСубконтоРаботникиДт] = ДанныеУчета.Физлицо;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		Если ДанныеУчета.СчетКт <> ПустойСчет Тогда
			Если ДанныеУчета.НомерСубконтоРаботникиКт <> 0 Тогда
				Субконто = ДанныеУчета[НомерКт + ДанныеУчета.НомерСубконтоРаботникиКт];
				Если НЕ ЗначениеЗаполнено(Субконто) Тогда
					СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоРаботникиКт] = ДанныеУчета.Физлицо;
				КонецЕсли;
			КонецЕсли;
			Если ДанныеУчета.НомерСубконтоКонтрагентыКт <> 0 Тогда
				Субконто = ДанныеУчета[НомерКт + ДанныеУчета.НомерСубконтоКонтрагентыКт];
				Если НЕ ЗначениеЗаполнено(Субконто) Тогда
					СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоКонтрагентыКт] = ДанныеУчета.Контрагент;
				КонецЕсли;
			КонецЕсли;
			Если ДанныеУчета.НомерСубконтоИсполнДокументыКт <> 0 Тогда
				Субконто = ДанныеУчета[НомерКт + ДанныеУчета.НомерСубконтоИсполнДокументыКт];
				Если НЕ ЗначениеЗаполнено(Субконто) Тогда
					СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоИсполнДокументыКт] = ДанныеУчета.ИсполнительныйДокумент;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	Возврат СтрокаДанных;
	
КонецФункции // СоздатьСтрокуПромежуточнойТаблицы

// проверяет должен ли быть указан или нет счет учета по НУ
//
// Параметры
//  СчетДт,СчетКт - счета хозрасчетного плана счетов
//  СчетДтНУ	  - счет налогового плана счетов - будущий счет дебета
//
// Возвращаемое значение:
//   булево   – если сочетание корректно, то истина
//
Функция КорректноеСочетаниеСчетовНУ(СчетДт,НаименованиеСчетДт, СчетКт, СчетДтНУ, СчетКтНУ, ПризнакСтатьиЗатрат,Сообщение)
	
	Сообщение = "";
	
	Если СчетДтНУ.Пустая() Тогда
		Если (СчетКт = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда или СчетКт = ПланыСчетов.Хозрасчетный.РасчетыПоВыплатеДоходов)
			и Не (ПризнакСтатьиЗатрат = Перечисления.ОтнесениеРасходовКДеятельностиЕНВД.РасходыОтносятсяКЕНВД) Тогда
			Сообщение = "Не указан счет налогового учета!";
		КонецЕсли;
		Если НЕ СчетКтНУ.Пустая() Тогда
			Сообщение = Сообщение + ?(Сообщение = "","",Символы.ПС) + "Указан счет кредита налогового учета, но не указан счет дебета налогового учета!";
		КонецЕсли;
	Иначе
		Если (СчетДт = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда или СчетДт = ПланыСчетов.Хозрасчетный.РасчетыПоВыплатеДоходов) Тогда
			Сообщение = "Проводки в дебет "+НаименованиеСчетДт +" не должны отражаться в налоговом учете!";
		ИначеЕсли ПризнакСтатьиЗатрат = Перечисления.ОтнесениеРасходовКДеятельностиЕНВД.РасходыОтносятсяКЕНВД Тогда
			Сообщение = "Проводки по видам деятельности, облагаемым ЕНВД не должны отражаться в налоговом учете!";
		КонецЕсли;
		
		Если СчетКтНУ.Пустая() Тогда
			Сообщение = Сообщение + ?(Сообщение = "","",Символы.ПС) + "Указан счет дебета налогового учета, но не указан счет кредита налогового учета!";
		КонецЕсли;
		
	КонецЕсли;
	
	Возврат ПустаяСтрока(Сообщение)
	
КонецФункции // КорректноеСочетаниеСчетовНУ()

// Функция формирует табличный документ с печатной формой "Книга хозяйственных операций",
//
// Возвращаемое значение:
//  Табличный документ - печатная форма
//
Функция ПечатьКнигаХозяйственныхОпераций(Признак)
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ПолеСлева = 0;
	ТабДокумент.ПолеСправа = 0;
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ";
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	
	Если Признак = 0 Тогда
		Макет = ПолучитьМакет("МакетКнигаХозяйственныхОпераций");
	Иначе
		Макет = ПолучитьМакет("МакетКнигаХозяйственныхОперацийПодробно");
	КонецЕсли;
	ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
	ОбластьМакетаСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьМакетаИтоги = Макет.ПолучитьОбласть("Итоги");
	
	Проводки = ОтражениеВУчете.Выгрузить();
	Если Признак = 0 Тогда
		Проводки.Свернуть("СчетДт,СчетКт,ПризнакПроводки","Сумма");
		Проводки.Сортировать("СчетДт,ПризнакПроводки,СчетКт");
	ИначеЕсли Признак = 1 Тогда
		Проводки.Свернуть("СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетКт,СубконтоКт1,СубконтоКт2,СубконтоКт3,ПризнакПроводки","Сумма");
		Проводки.Сортировать("СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,ПризнакПроводки,СчетКт,СубконтоКт1,СубконтоКт2,СубконтоКт3");
	КонецЕсли;
	
	//шапка 
	ОбластьМакетаШапка.Параметры.Организация = Организация;
	ОбластьМакетаШапка.Параметры.Период = РаботаСДиалогами.ДатаКакМесяцПредставление(ПериодРегистрации);
	ОбластьМакетаШапка.Параметры.Дата = РабочаяДата;
	ТабДокумент.Вывести(ОбластьМакетаШапка); 
	
	//строка
	НомерПП = 0;
	Для Каждого ТекСтрока Из Проводки Цикл
		Если ТекСтрока.Сумма <> 0 Тогда
			НомерПП = НомерПП + 1;
			ОбластьМакетаСтрока.Параметры.Дата = ПериодРегистрации;
			ОбластьМакетаСтрока.Параметры.Номер = НомерПП;
			Если Признак = 0 Тогда
				ОбластьМакетаСтрока.Параметры.Наименование = ТекСтрока.СчетКт.Наименование;
			КонецЕсли;
			ОбластьМакетаСтрока.Параметры.СчетДебет = ТекСтрока.СчетДт;
			Если Признак = 1 Тогда
				ОбластьМакетаСтрока.Параметры.Субконто1Дебет = ТекСтрока.СубконтоДт1;
				ОбластьМакетаСтрока.Параметры.Субконто2Дебет = ТекСтрока.СубконтоДт2;
				ОбластьМакетаСтрока.Параметры.Субконто3Дебет = ТекСтрока.СубконтоДт3;
			КонецЕсли;
			ОбластьМакетаСтрока.Параметры.СчетКредит = ТекСтрока.СчетКт;
			Если Признак = 1 Тогда
				ОбластьМакетаСтрока.Параметры.Субконто1Кредит = ТекСтрока.СубконтоКт1;
				ОбластьМакетаСтрока.Параметры.Субконто2Кредит = ТекСтрока.СубконтоКт2;
				ОбластьМакетаСтрока.Параметры.Субконто3Кредит = ТекСтрока.СубконтоКт3;
			КонецЕсли;
			ОбластьМакетаСтрока.Параметры.Сумма = ТекСтрока.Сумма;
			ОбластьМакетаСтрока.Параметры.Описание = ТекСтрока.ПризнакПроводки;
			
			ТабДокумент.Вывести(ОбластьМакетаСтрока);
			
		КонецЕсли;
	КонецЦикла;
	
	
	//итог 
	ОбластьМакетаИтоги.Параметры.СуммаИтого = Проводки.Итог("Сумма");
	ТабДокумент.Вывести(ОбластьМакетаИтоги); 
	
	Возврат ТабДокумент;
	
КонецФункции // КнигаХозяйственныхОпераций()

//Функция формирует удержания по проводкам
//
Функция СформируемЗапросПоУдержаниям()
	Запрос = Новый Запрос;
	
	ТекстЗапроса = "ВЫБРАТЬ
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКт,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ПризнакПроводки,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ВидРасчета,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Сумма
	|ИЗ
	|	Документ.ОтражениеЗарплатыВРеглУчете.ОтражениеВУчете КАК ОтражениеЗарплатыВРеглУчетеОтражениеВУчете
	|ГДЕ
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ПризнакПроводки = ЗНАЧЕНИЕ(Перечисление.ПризнакПроводки.Удержание)
	|	И ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка = &Ссылка";
	
	Запрос.УстановитьПараметр("Ссылка",Ссылка);
	
	Запрос.Текст = ТекстЗапроса;
	
	Результат = Запрос.Выполнить();
	
	Возврат Результат;
КонецФункции


//Функция формирует начисления и налоги по проводкам
//
Функция СформируемЗапросПоНачислениям()
	Запрос = Новый Запрос;
	
	ТекстЗапроса = "ВЫБРАТЬ
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт КАК СчетДт,
	|	ВЫБОР
	|		КОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ПризнакПроводки = ЗНАЧЕНИЕ(Перечисление.ПризнакПроводки.Начисление)
	|			ТОГДА СУММА(ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Сумма)
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНачисления,
	|	ВЫБОР
	|		КОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ПризнакПроводки = ЗНАЧЕНИЕ(Перечисление.ПризнакПроводки.ФондСоциальнойЗащиты)
	|			ТОГДА СУММА(ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Сумма)
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаФСЗН,
	|	ВЫБОР
	|		КОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ПризнакПроводки = ЗНАЧЕНИЕ(Перечисление.ПризнакПроводки.ОбязательноеСтрахование)
	|			ТОГДА СУММА(ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Сумма)
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаСтрахования,
	|	ВЫБОР
	|		КОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ПризнакПроводки = ЗНАЧЕНИЕ(Перечисление.ПризнакПроводки.ЧрезвычайныйНалог)
	|			ТОГДА СУММА(ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Сумма)
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаЧН
	|ИЗ
	|	Документ.ОтражениеЗарплатыВРеглУчете.ОтражениеВУчете КАК ОтражениеЗарплатыВРеглУчетеОтражениеВУчете
	|ГДЕ
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка = &Ссылка
	|	И ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ПризнакПроводки <> ЗНАЧЕНИЕ(Перечисление.ПризнакПроводки.Удержание)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ПризнакПроводки
	|
	|УПОРЯДОЧИТЬ ПО
	|	СчетДт";
	
	Запрос.УстановитьПараметр("Ссылка",Ссылка);
	
	Запрос.Текст = ТекстЗапроса;
	
	Результат = Запрос.Выполнить();
	
	Возврат Результат;
КонецФункции

// Функция формирует табличный документ с печатной формой "Ведомость удержаний",
//
// Возвращаемое значение:
//  Табличный документ - печатная форма
//
Функция ПечатьВедомостьУдержаний()
	УчетнаяПолитика = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация", Ссылка.Организация));
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ПолеСлева = 0;
	ТабДокумент.ПолеСправа = 0;
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ";
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	
	Макет = ПолучитьМакет("МакетВедомостьУдержаний");
	ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
	ОбластьМакетаСтрока = Макет.ПолучитьОбласть("Строка");
	ОбластьМакетаСтрокаИтоги = Макет.ПолучитьОбласть("ИтогиСчет");
	ОбластьМакетаИтоги = Макет.ПолучитьОбласть("Итоги");
	
	Проводки = СформируемЗапросПоУдержаниям().Выгрузить();
	Проводки.Свернуть("СчетКт,ВидРасчета","Сумма");
	Проводки.Сортировать("СчетКт,ВидРасчета");
	
	//шапка 
	ОбластьМакетаШапка.Параметры.Организация = Организация;
	ОбластьМакетаШапка.Параметры.Период = РаботаСДиалогами.ДатаКакМесяцПредставление(ПериодРегистрации);
	ОбластьМакетаШапка.Параметры.Дата = РабочаяДата;
	ТабДокумент.Вывести(ОбластьМакетаШапка); 
	
	//строка
	НомерПП = 0; Счет = ПланыСчетов.Хозрасчетный.ПустаяСсылка();  СуммаСчетИтого = 0;
	Для Каждого ТекСтрока Из Проводки Цикл
		Если ТекСтрока.Сумма <> 0 Тогда
			Если ЗначениеЗаполнено(Счет) Тогда
				Если Счет <> ТекСтрока.СчетКт Тогда
					ОбластьМакетаСтрокаИтоги.Параметры.Счет = Счет;
					ОбластьМакетаСтрокаИтоги.Параметры.СуммаСчетИтого = СуммаСчетИтого;
					ОбластьМакетаСтрокаИтоги.Параметры.Наименование = Счет.Наименование;
					
					ТабДокумент.Вывести(ОбластьМакетаСтрокаИтоги);
					
					СуммаСчетИтого = 0;
				КонецЕсли;
			КонецЕсли;
			
			НомерПП = НомерПП + 1;
			ОбластьМакетаСтрока.Параметры.Счет = ТекСтрока.СчетКт;
			Если ЗначениеЗаполнено(УчетнаяПолитика.СчетУчетаНДФЛБУ) Тогда
				Если УчетнаяПолитика.СчетУчетаНДФЛБУ = ТекСтрока.СчетКт Тогда
					ОбластьМакетаСтрока.Параметры.Наименование = "Подоходный налог";					
				Иначе
					ОбластьМакетаСтрока.Параметры.КодВО = ТекСтрока.ВидРасчета.Код;
					ОбластьМакетаСтрока.Параметры.Наименование = ТекСтрока.ВидРасчета.Наименование;
				КонецЕсли;
			Иначе
				ОбластьМакетаСтрока.Параметры.КодВО = ТекСтрока.ВидРасчета.Код;
				ОбластьМакетаСтрока.Параметры.Наименование = ТекСтрока.ВидРасчета.Наименование;
			КонецЕсли;
			ОбластьМакетаСтрока.Параметры.Сумма = ТекСтрока.Сумма;
			
			ТабДокумент.Вывести(ОбластьМакетаСтрока);
			
			СуммаСчетИтого = СуммаСчетИтого + ТекСтрока.Сумма;
			Счет = ТекСтрока.СчетКт;
		КонецЕсли;
	КонецЦикла;
	
	//итог по счету
	ОбластьМакетаСтрокаИтоги.Параметры.Счет = Счет;
	ОбластьМакетаСтрокаИтоги.Параметры.СуммаСчетИтого = СуммаСчетИтого;
	ОбластьМакетаСтрокаИтоги.Параметры.Наименование = Счет.Наименование;
	
	ТабДокумент.Вывести(ОбластьМакетаСтрокаИтоги);
	
	//итог 
	ОбластьМакетаИтоги.Параметры.СуммаИтого = Проводки.Итог("Сумма");
	ТабДокумент.Вывести(ОбластьМакетаИтоги); 
	
	Возврат ТабДокумент;
	
КонецФункции // ПечатьВедомостьУдержаний()

// Функция формирует табличный документ с печатной формой "Распределение зарплаты",
//
// Возвращаемое значение:
//  Табличный документ - печатная форма
//
Функция ПечатьРаспределениеЗарплаты()
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ПолеСлева = 0;
	ТабДокумент.ПолеСправа = 0;
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ";
	ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
	
	ЗапросБГС = Новый Запрос;
	ЗапросБГС.Текст = 
	"ВЫБРАТЬ
	|	СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаевСрезПоследних.Ставка
	|ИЗ
	|	РегистрСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.СрезПоследних(&Период, Организация = &Организация) КАК СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаевСрезПоследних";
	
	ЗапросБГС.УстановитьПараметр("Организация", Организация);
	ЗапросБГС.УстановитьПараметр("Период", КонецМесяца(ПериодРегистрации));
	
	РезультатЗапросаБГС = ЗапросБГС.Выполнить().Выгрузить();
	ЕстьЧрезвычайныйНалог = Ложь;
	Если РезультатЗапросаБГС.Количество()>0 Тогда 
		ЕстьЧрезвычайныйНалог = Истина;
	КонецЕсли;
	
	//ФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	//		Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения));//О.Т. Аверсон 26.03.2016 № 950
	//
	//Страхование = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
	//		Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения));//О.Т. Аверсон 30.03.2016 № 950
	//
	//ЧН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
	//		Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж,ВидНалогообложения)); //О.Т. Аверсон 26.03.2016 № 950
	//
	Макет = ПолучитьМакет("МакетРаспределениеЗарплаты");
	ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка|Область1");
	ОбластьМакетаСтрока = Макет.ПолучитьОбласть("Строка|Область1");
	ОбластьМакетаИтоги = Макет.ПолучитьОбласть("Итоги|Область1");
	
	ОбластьМакетаСтрока12 = Макет.ПолучитьОбласть("Строка2|Область1");
	ОбластьМакетаИтоги12 = Макет.ПолучитьОбласть("Итоги2|Область1");
	Если ЕстьЧрезвычайныйНалог Тогда
		ОбластьМакетаШапка2 = Макет.ПолучитьОбласть("Шапка|Область2");
		ОбластьМакетаСтрока2 = Макет.ПолучитьОбласть("Строка|Область2");
		ОбластьМакетаИтоги2 = Макет.ПолучитьОбласть("Итоги|Область2");
	КонецЕсли;
	
	Проводки = СформируемЗапросПоНачислениям().Выгрузить();
	Проводки.Свернуть("СчетДт","СуммаНачисления,СуммаФСЗН,СуммаСтрахования,СуммаЧН");
	Проводки.Сортировать("СчетДт");
	Проводки.Колонки.Добавить("СуммаПревышения", Новый ОписаниеТипов("Число"));
	
	//шапка 
	ОбластьМакетаШапка.Параметры.Организация = Организация;
	ОбластьМакетаШапка.Параметры.Период = РаботаСДиалогами.ДатаКакМесяцПредставление(ПериодРегистрации);
	//ОбластьМакетаШапка.Параметры.СчетФСЗН = ФСЗН.СчетБУ;
	//ОбластьМакетаШапка.Параметры.ПроцентФСЗН = ФСЗН.Размер;
	//ОбластьМакетаШапка.Параметры.СчетСтрахования = Страхование.СчетБУ;
	//ОбластьМакетаШапка.Параметры.ПроцентСтрахования = Страхование.Ставка;								
	ОбластьМакетаШапка.Параметры.Дата = РабочаяДата;
	ТабДокумент.Вывести(ОбластьМакетаШапка); 
	
	Если ЕстьЧрезвычайныйНалог Тогда
		//ОбластьМакетаШапка2.Параметры.СчетЧН = ЧН.СчетБУ;
		//ОбластьМакетаШапка2.Параметры.ПроцентЧН = ЧН.Размер;								
		ТабДокумент.Присоединить(ОбластьМакетаШапка2); 
	КонецЕсли;
	
	//соберем данные по превышению 4 средних зарплат
	Запрос = Новый Запрос;
	
	ТекстЗапроса = "ВЫБРАТЬ
	|	РасчетЕСН.Ссылка
	|ИЗ
	|	Документ.РасчетЕСН КАК РасчетЕСН
	|ГДЕ
	|	РасчетЕСН.Проведен
	|	И РасчетЕСН.Организация = &Организация
	|	И РасчетЕСН.ПериодРегистрации = &ПериодРегистрации";
	
	Запрос.Текст = ТекстЗапроса;
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);	
	
	Результат = Запрос.Выполнить().Выбрать();
	Если Результат.Следующий() Тогда
		РасчетЕСНДокумент = Результат.Ссылка; 
	КонецЕсли;
	
	Если ЗначениеЗаполнено(РасчетЕСНДокумент) Тогда
		Запрос = Новый Запрос;
		
		ТекстЗапроса = "ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт КАК СчетДт,
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1 КАК СубконтоДт1,
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2 КАК СубконтоДт2,
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3 КАК СубконтоДт3,
		|	СУММА(ВЫБОР
		|			КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.НеОблагается)
		|				ТОГДА ЕСНСведенияОДоходах.Результат
		|			ИНАЧЕ 0
		|		КОНЕЦ) КАК СуммаПревышения,
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник.Наименование КАК СотрудникНаименование,
		|	ЕСНСведенияОДоходах.Период
		|ИЗ
		|	Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		|		ПО ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета = ЕСНСведенияОДоходах.ВидРасчета
		|			И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ФизЛицо = ЕСНСведенияОДоходах.ФизЛицо
		|ГДЕ
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка = &Ссылка
		|	И ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачПериод И &КонПериода
		|	И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ПериодДействияНачало >= &НачПериод
		|	И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ПериодДействияКонец <= &КонПериода
		|	И (ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяПолностью)
		|			ИЛИ ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиЕП)
		|			ИЛИ ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗН)
		|			ИЛИ ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиСТРАХ))
		|
		|СГРУППИРОВАТЬ ПО
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт,
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1,
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2,
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3,
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник.Наименование,
		|	ЕСНСведенияОДоходах.Период
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДт,
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт1,
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт2,
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт3,
		|	СУММА(ВЫБОР
		|			КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.НеОблагается)
		|				ТОГДА ЕСНСведенияОДоходах.Результат
		|			ИНАЧЕ 0
		|		КОНЕЦ),
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Сотрудник.Наименование,
		|	ЕСНСведенияОДоходах.Период
		|ИЗ
		|	Документ.ОтражениеЗарплатыВРеглУчете.ДополнительныеНачисления КАК ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		|		ПО ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ВидРасчета = ЕСНСведенияОДоходах.ВидРасчета
		|			И ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ФизЛицо = ЕСНСведенияОДоходах.ФизЛицо
		|ГДЕ
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка = &Ссылка
		|	И ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачПериод И &КонПериода
		|	И (ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяПолностью)
		|			ИЛИ ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиЕП)
		|			ИЛИ ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗН)
		|			ИЛИ ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиСТРАХ))
		|
		|СГРУППИРОВАТЬ ПО
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДт,
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт1,
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт2,
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт3,
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Сотрудник.Наименование,
		|	ЕСНСведенияОДоходах.Период
		|
		|УПОРЯДОЧИТЬ ПО
		|	СотрудникНаименование";
		
		Запрос.Текст = ТекстЗапроса;
		Запрос.УстановитьПараметр("Ссылка", Ссылка);
		Запрос.УстановитьПараметр("НачПериод", НачалоМесяца(Ссылка.ПериодРегистрации));
		Запрос.УстановитьПараметр("КонПериода", КонецМесяца(Ссылка.ПериодРегистрации));
		
		Результат = Запрос.Выполнить().Выбрать();
		
		Пока Результат.Следующий() Цикл
			Если Результат.Период >= НачалоМесяца(Ссылка.ПериодРегистрации) Тогда
				НоваяСтрока = Проводки.Добавить();
				НоваяСтрока.СчетДт = Результат.СчетДт;
				НоваяСтрока.СуммаПревышения = Результат.СуммаПревышения;
				Если Результат.СуммаПревышения <> 0 Тогда
					сообщить(Результат.СотрудникНаименование + " - " + Результат.СуммаПревышения);
				КонецЕсли;
			КонецЕсли;         
		КонецЦикла;
		
		Проводки.Свернуть("СчетДт","СуммаНачисления,СуммаПревышения,СуммаФСЗН,СуммаСтрахования,СуммаЧН");
		Проводки.Сортировать("СчетДт");
	КонецЕсли;
	
	//строка
	Для Каждого ТекСтрока Из Проводки Цикл
		Если ТекСтрока.СуммаНачисления <> 0 или ТекСтрока.СуммаФСЗН <> 0 или ТекСтрока.СуммаСтрахования <> 0 или ТекСтрока.СуммаЧН <> 0 Тогда
			
			ОбластьМакетаСтрока.Параметры.Счет = ТекСтрока.СчетДт;
			ОбластьМакетаСтрока.Параметры.Наименование = ТекСтрока.СчетДт.Наименование;
			ОбластьМакетаСтрока.Параметры.Сумма = ТекСтрока.СуммаНачисления;
			ОбластьМакетаСтрока.Параметры.СуммаПревышения = ТекСтрока.СуммаПревышения;	
			ОбластьМакетаСтрока.Параметры.СуммаСУчетомПревышения = ТекСтрока.СуммаНачисления - ТекСтрока.СуммаПревышения;
			ОбластьМакетаСтрока.Параметры.СуммаСтрахования = ТекСтрока.СуммаСтрахования;
			ОбластьМакетаСтрока.Параметры.СуммаФСЗН = ТекСтрока.СуммаФСЗН;
			
			ТабДокумент.Вывести(ОбластьМакетаСтрока);
			
			Если ЕстьЧрезвычайныйНалог Тогда
				ОбластьМакетаСтрока2.Параметры.СуммаЧН = ТекСтрока.СуммаЧН;	
				ТабДокумент.Присоединить(ОбластьМакетаСтрока2);
			КонецЕсли;
			
		КонецЕсли;
	КонецЦикла;
	
	
	
	//итог 
	ОбластьМакетаИтоги.Параметры.СуммаИтого = Проводки.Итог("СуммаНачисления");
	ОбластьМакетаИтоги.Параметры.СуммаИтогоПревышения = Проводки.Итог("СуммаПревышения");
	ОбластьМакетаИтоги.Параметры.СуммаИтогоСУчетомПревышения = Проводки.Итог("СуммаНачисления") - Проводки.Итог("СуммаПревышения");
	ОбластьМакетаИтоги.Параметры.СуммаСтрахованияИтого = Проводки.Итог("СуммаСтрахования");
	ОбластьМакетаИтоги.Параметры.СуммаФСЗНИтого = Проводки.Итог("СуммаФСЗН");
	
	ТабДокумент.Вывести(ОбластьМакетаИтоги); 
	
	Если ЕстьЧрезвычайныйНалог Тогда
		ОбластьМакетаИтоги2.Параметры.СуммаЧНИтого = Проводки.Итог("СуммаЧН");	
		ТабДокумент.Присоединить(ОбластьМакетаИтоги2);
	КонецЕсли;
	
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ВложенныйЗапрос.ВидНалогообложения КАК ВидНалогообложения,
	|	ВложенныйЗапрос.ВидОтчисления КАК ВидОтчисления,
	|	ВложенныйЗапрос.Размер,
	|	ВложенныйЗапрос.ОграничениеПоДоходам,
	|	ВложенныйЗапрос.СчетБУ как Счет
	|ИЗ
	|	(ВЫБРАТЬ
	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидНалогообложения КАК ВидНалогообложения,
	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления КАК ВидОтчисления,
	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер КАК Размер,
	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.ОграничениеПоДоходам КАК ОграничениеПоДоходам,
	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.СчетБУ КАК СчетБУ
	|	ИЗ
	|		РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&Период, Организация = &Организация) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ШкалаПодоходногоНалогаСрезПоследних.ВидНалогообложения,
	|		""НДФЛ"",
	|		ШкалаПодоходногоНалогаСрезПоследних.Налог,
	|		NULL,
	|		NULL
	|	ИЗ
	|		РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(&Период, Организация = &Организация) КАК ШкалаПодоходногоНалогаСрезПоследних
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаевСрезПоследних.ВидНалогообложения,
	|		""БГС"",
	|		СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаевСрезПоследних.Ставка,
	|		NULL,
	|		СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаевСрезПоследних.СчетБУ
	|	ИЗ
	|		РегистрСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.СрезПоследних(&Период, Организация = &Организация) КАК СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаевСрезПоследних) КАК ВложенныйЗапрос
	|
	|УПОРЯДОЧИТЬ ПО
	|	ВидНалогообложения,
	|	ВидОтчисления";
	
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("Период", КонецМесяца(Ссылка.ПериодРегистрации));
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	ВидНалогооблПрошл = "";
	ВидОтчисленияПрошл = "";
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Если ВидОтчисленияПрошл <> "" и ВидОтчисленияПрошл <> ВыборкаДетальныеЗаписи.ВидОтчисления Тогда 
			ТабДокумент.Вывести(ОбластьМакетаСтрока12);
		КонецЕсли;
		
		ЗаполнитьЗначенияСвойств(ОбластьМакетаСтрока12.Параметры,ВыборкаДетальныеЗаписи);
		ВидНалогооблПрошл = ВыборкаДетальныеЗаписи.ВидНалогообложения;
		ВидОтчисленияПрошл = ВыборкаДетальныеЗаписи.ВидОтчисления;
	КонецЦикла;
	ТабДокумент.Вывести(ОбластьМакетаСтрока12);
	
	ТабДокумент.Вывести(ОбластьМакетаИтоги12);
	
	Возврат ТабДокумент;
	
КонецФункции // ПечатьРаспределениеЗарплаты()

Функция ПечатьРасшФСЗНБГС()
	//Аверсон 26.08.2020 КВВ СВФР-006325 (
	Макет = ПолучитьМакет("Макет1");
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.ПолеСлева = 0;
	ТабДок.ПолеСправа = 0;
	ТабДок.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ";
	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	
	ТабДок.Очистить();
	
	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");	
	ТабДок.Вывести(ОбластьЗаголовок);
	ОбластьЗаголовок1 = Макет.ПолучитьОбласть("Строка");  
	ОбластьЗаголовок2 = Макет.ПолучитьОбласть("Подвал"); 
	
	
	Для Каждого СтрТЗ ИЗ РасшифровкаСуммФСЗНиБГС Цикл
		ОбластьЗаголовок1.Параметры.Физ = СтрТЗ.Физлицо;
		ОбластьЗаголовок1.Параметры.БазаФСЗН = СтрТЗ.ФСЗН;
		ОбластьЗаголовок1.Параметры.БазаСтрах = СтрТЗ.БГС;
		
		ТабДок.Вывести(ОбластьЗаголовок1);
	КонецЦикла;
	ОбластьЗаголовок2.Параметры.Итог = РасшифровкаСуммФСЗНиБГС.Итог("ФСЗН");
	ОбластьЗаголовок2.Параметры.ИтогСтрах = РасшифровкаСуммФСЗНиБГС.Итог("БГС");
	ТабДок.Вывести(ОбластьЗаголовок2);
	КоличествоЭкземпляров = 1; НаПринтер = Ложь;
	ИмяФормы = " (Расшифровка ФСЗН и БГС из 4-ой закладки)";
	РаботаСДиалогами.НапечататьДокумент(ТабДок, КоличествоЭкземпляров, НаПринтер, РаботаСДиалогами.СформироватьЗаголовокДокумента(ЭтотОбъект,Метаданные().Синоним + ИмяФормы));
	//Аверсон 26.08.2020 КВВ СВФР-006325 )
КонецФункции

Функция ПечатьВедомостиФОТВиток(Расшифровка = Ложь)
	//Аверсон 11.07.2023 КВВ СВФР-010889 (
	Макет = ПолучитьМакет("ВедомостьРаспределенияФОТПоСчетам_Виток");
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.ПолеСлева = 0;
	ТабДок.ПолеСправа = 0;
	ТабДок.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ";
	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	
	ТабДок.Очистить();
	
	Область1 = Макет.ПолучитьОбласть("Область1");	
	Область2 = Макет.ПолучитьОбласть("Область2"); 
	Область3 = Макет.ПолучитьОбласть("Область3");
	Область4 = Макет.ПолучитьОбласть("Область4");
	Область5 = Макет.ПолучитьОбласть("Область5");
	Область6 = Макет.ПолучитьОбласть("Область6");
	
	Область1.Параметры.Организация = Организация;
	Область1.Параметры.Период = Формат(ПериодРегистрации,"ДЛФ=Д");
	ТабДок.Вывести(Область1);    
	
	Если (ОсновныеНачисления.Количество() + ДополнительныеНачисления.Количество()) > 0 Тогда
		
		//данные по док РасчетЕСН (
		З = Новый Запрос;
		З.Текст = "ВЫБРАТЬ
		|РасчетЕСН.Ссылка
		|ПОМЕСТИТЬ ВтДок
		|ИЗ Документ.РасчетЕСН КАК РасчетЕСН
		|ГДЕ РасчетЕСН.Проведен
		|И РасчетЕСН.ПериодРегистрации = &Период
		|И РасчетЕСН.Организация = &Организация"; 
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
			З.Текст = З.Текст + "	
			|И РасчетЕСН.ПодразделениеОрганизации = &Подр";
		КонецЕсли;
		З.Текст = З.Текст + "
		|;
		|
		|ВЫБРАТЬ
		|ИСЧ.ФизЛицо,
		|ИСЧ.ПроцентФСЗН
		|ПОМЕСТИТЬ ВтПроцентыФСЗН
		|ИЗ Документ.РасчетЕСН.ИсчисленныйЕСН КАК ИСЧ
		|ГДЕ
		|ИСЧ.Ссылка В (ВЫБРАТЬ ВтДок.Ссылка ИЗ ВтДок)
		|СГРУППИРОВАТЬ ПО
		|ИСЧ.ФизЛицо,
		|ИСЧ.ПроцентФСЗН
		|;
		|
		|ВЫБРАТЬ
		|ИСТИНА КАК ОснНач,
		|ВтПроцентыФСЗН.ПроцентФСЗН,
		|ОСН.Сотрудник,
		|ОСН.Сотрудник.ФизЛицо КАК ФизЛицо,
		|ОСН.ВидРасчета,
		|ОСН.ПериодДействияНачало КАК Начало,
		|ОСН.ПериодДействияКонец КАК Окончание,
		|ВЫБОР КОГДА ОСН.ДоходФСЗН = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)  
		|ТОГДА ОСН.Результат 
		|ИНАЧЕ 0
		|КОНЕЦ КАК СуммаФСЗН,
		|ВЫБОР КОГДА ОСН.ДоходСтрах = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)  
		|ТОГДА ОСН.Результат 
		|ИНАЧЕ 0
		|КОНЕЦ КАК СуммаБГС
		|ИЗ Документ.РасчетЕСН.ОсновныеНачисления КАК ОСН
		|ЛЕВОЕ СОЕДИНЕНИЕ ВтПроцентыФСЗН
		|ПО ОСН.Сотрудник.Физлицо = ВтПроцентыФСЗН.ФизЛицо
		|ГДЕ
		|ОСН.Ссылка В (ВЫБРАТЬ ВтДок.Ссылка ИЗ ВтДок)
		|И ОСН.Результат <> 0
		|И (ОСН.ДоходФСЗН = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
		|ИЛИ ОСН.ДоходСтрах = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
		|)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|ЛОЖЬ,
		|ВтПроцентыФСЗН.ПроцентФСЗН,
		|ДОП.Сотрудник,
		|ДОП.Сотрудник.ФизЛицо,
		|ДОП.ВидРасчета,
		|ДОП.БазовыйПериодНачало КАК Начало,
		|ДОП.БазовыйПериодКонец КАК Окончание,
		|ВЫБОР КОГДА ДОП.ДоходФСЗН = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)  
		|ТОГДА ДОП.Результат 
		|ИНАЧЕ 0
		|КОНЕЦ КАК СуммаФСЗН,
		|ВЫБОР КОГДА ДОП.ДоходСтрах = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)  
		|ТОГДА ДОП.Результат 
		|ИНАЧЕ 0
		|КОНЕЦ КАК СуммаБГС
		|ИЗ Документ.РасчетЕСН.ДополнительныеНачисления КАК ДОП
		|ЛЕВОЕ СОЕДИНЕНИЕ ВтПроцентыФСЗН
		|ПО ДОП.Сотрудник.Физлицо = ВтПроцентыФСЗН.ФизЛицо
		|ГДЕ
		|ДОП.Ссылка В (ВЫБРАТЬ ВтДок.Ссылка ИЗ ВтДок)
		|И ДОП.Результат <> 0
		|И (ДОП.ДоходФСЗН = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
		|ИЛИ ДОП.ДоходСтрах = ЗНАЧЕНИЕ(Перечисление.ДоходыФСС_НС.Облагается)
		|)";
		З.УстановитьПараметр("Подр",ПодразделениеОрганизации);
		З.УстановитьПараметр("Период",ПериодРегистрации);
		З.УстановитьПараметр("Организация",Организация);  
		РезЗРасчетЕСН = З.Выполнить().Выгрузить();
		//данные по док РасчетЕСН )
		
		ТЗ = Новый ТаблицаЗначений;    
		ТЗ.Колонки.Добавить("Счет");
		ТЗ.Колонки.Добавить("Субсчет");
		ТЗ.Колонки.Добавить("Аналитика");
		ТЗ.Колонки.Добавить("Сумма");
		ТЗ.Колонки.Добавить("СуммаФСЗН11");
		ТЗ.Колонки.Добавить("ФСЗН11");
		ТЗ.Колонки.Добавить("СуммаФСЗН6");
		ТЗ.Колонки.Добавить("ФСЗН6");
		ТЗ.Колонки.Добавить("СуммаБГС");
		ТЗ.Колонки.Добавить("БГС");
		ТЗ.Колонки.Добавить("Сотрудник");
		ТЗ.Колонки.Добавить("ВидРасчета");
		ТЗ.Колонки.Добавить("ПлюсМинус");
		
		ПроцентБГС = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
		Новый Структура("Организация,ВидНалогообложения", Организация,Организация.ОсновнаяСтавкаНалогообложения)).Ставка;
		
		Для НомТЧ = 1 ПО 2 Цикл
			КакаяТЧ = ?(НомТЧ=1,ОсновныеНачисления,ДополнительныеНачисления);
			
			Для Каждого Стр ИЗ КакаяТЧ Цикл
				Если сокрлп(Стр.СчетКт) <> "70" Тогда
					Продолжить;
				КонецЕсли;
				Если Стр.СубконтоКтНУ2 = Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ОплатаОтпускаТек 
					И НачалоМесяца(?(НомТЧ=1,Стр.ПериодДействияНачало,Стр.БазовыйПериодНачало)) > НачалоМесяца(ПериодРегистрации) Тогда
					//Если СокрЛП(глЗначениеПеременной("глТекущийПользователь")) = "averson" Тогда
					//	Сообщить("--снят буд.отпуск за " + Сокрлп(?(НомТЧ=1,Стр.ПериодДействияНачало,Стр.БазовыйПериодНачало)) + " по " + Сокрлп(Стр.Сотрудник) + " в размере " + сокрЛП(Стр.Результат));
					//КонецЕсли;
					Продолжить;
				КонецЕсли;
				
				Если Стр.Результат = 0 Тогда 
					Продолжить;
				КонецЕсли;
				
				СтрТЗ = ТЗ.Добавить();
				СтрТЗ.Счет = Стр.СчетДт;
				СтрТЗ.Сотрудник = СокрЛП(Стр.Сотрудник);
				СтрТЗ.ВидРасчета = Стр.ВидРасчета;
				
				КолвоСубконто = Стр.СчетДт.ВидыСубконто.Количество();
				
				Для А = 1 ПО КолвоСубконто Цикл
					Если Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
						СтрТЗ.Субсчет = Стр["СубконтоДт" + Строка(А)].КодПодрДляОтражения;
						Если НЕ ЗначениеЗаполнено(СтрТЗ.Субсчет) Тогда
							СтрТЗ.Субсчет = "0";
						КонецЕсли;
						
					ИначеЕсли Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
					ИначеЕсли Стр.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
						СтрТЗ.Аналитика = СокрЛП(Стр["СубконтоДт" + Строка(А)]);	
					КонецЕсли;
				КонецЦикла;
				СтрТЗ.Сумма = Стр.Результат;
				
				ОтборЕСН = Новый Структура;
				ОтборЕСН.Вставить("Сотрудник", Стр.Сотрудник);
				ОтборЕСН.Вставить("ВидРасчета", Стр.ВидРасчета);
				ОтборЕСН.Вставить("Начало", ?(НомТЧ=1,Стр.ПериодДействияНачало,Стр.БазовыйПериодНачало));
				ОтборЕСН.Вставить("Окончание", ?(НомТЧ=1,Стр.ПериодДействияКонец,Стр.БазовыйПериодКонец));
				ОтборЕСН.Вставить("СуммаФСЗН", Стр.Результат);
				
				СтрокиЕСН = РезЗРасчетЕСН.НайтиСтроки(ОтборЕСН);
				Если СтрокиЕСН.Количество() > 0 Тогда
					ПерваяСтр = СтрокиЕСН[0];
					Если ПерваяСтр.ПроцентФСЗН = 11 Тогда
						СтрТЗ.СуммаФСЗН11 = ПерваяСтр.СуммаФСЗН;
						СтрТЗ.ФСЗН11 = Окр(ПерваяСтр.СуммаФСЗН * 0.11,2);
					ИначеЕсли ПерваяСтр.ПроцентФСЗН = 6 Тогда
						СтрТЗ.СуммаФСЗН6 = ПерваяСтр.СуммаФСЗН;
						СтрТЗ.ФСЗН6 = Окр(ПерваяСтр.СуммаФСЗН * 0.06,2);
					КонецЕсли;
					СтрТЗ.СуммаБГС = ПерваяСтр.СуммаБГС;
					СтрТЗ.БГС = Окр(ПерваяСтр.СуммаБГС*ПроцентБГС/100,2);
				КонецЕсли;				
			КонецЦикла;
		КонецЦикла;
		
		//Аверсон 18.07.2023 КВВ СВФР-010889 (
		//счет 97 (
		ТЗОтраж1 = ОтражениеВУчете.Выгрузить();
		ТЗОтраж1.Сортировать("СчетКт,СубконтоКтНУ2");
		
		ТЗОтраж2 = ТЗОтраж1.Скопировать();
		
		Для Сч97Сч = 1 ПО 2 Цикл
			ОтборТЗОтраж1 = Новый Структура;
			ОтборТЗОтраж1.Вставить("ПризнакПроводки",Перечисления.ПризнакПроводки.Начисление);
			
			Если Сч97Сч = 1 Тогда
				ОтборТЗОтраж1.Вставить("СчетКт",ПланыСчетов.Хозрасчетный.НайтиПоКоду("97.02"));
				ОтборТЗОтраж1.Вставить("СубконтоКтНУ2",Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ОплатаОтпускаТек);
			Иначе
				ОтборТЗОтраж1.Вставить("СчетДт",ПланыСчетов.Хозрасчетный.НайтиПоКоду("97.02"));
				ОтборТЗОтраж1.Вставить("СчетКт",ПланыСчетов.Хозрасчетный.НайтиПоКоду("70"));
				ОтборТЗОтраж1.Вставить("СубконтоКтНУ2",Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ОплатаОтпускаБуд);
				
				ТЗОснНач = ОсновныеНачисления.Выгрузить();
			КонецЕсли;
			
			СтрокиОтборТЗОтраж1 = ТЗОтраж1.НайтиСтроки(ОтборТЗОтраж1);
			
			Для Каждого Стр_Отр1 ИЗ СтрокиОтборТЗОтраж1 Цикл
				СчМ = ?(Сч97Сч = 1,2,1);
				Для М = 1 По СчМ Цикл
					Если Стр_Отр1.Сумма = 0 Тогда 
						Продолжить;
					КонецЕсли;
					
					СтрТЗ = ТЗ.Добавить();
					СтрТЗ.Счет = ?(М=1,Стр_Отр1.СчетДт,Стр_Отр1.СчетКт);
					СтрТЗ.Сотрудник = СокрЛП(?(Сч97Сч = 1,Стр_Отр1.СубконтоКт2,Стр_Отр1.СубконтоКт1));
					ЗВР = Новый Запрос;
					ЗВР.Текст = "ВЫБРАТЬ 
					|ОСН.ВидРасчета
					|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОСН
					|ГДЕ ОСН.Сотрудник = &Сотрудник
					|И ОСН.Результат = &Результат
					|И НАЧАЛОПЕРИОДА(ОСН.ПериодРегистрации,МЕСЯЦ) <> НАЧАЛОПЕРИОДА(ОСН.ПериодДействияНачало,МЕСЯЦ)
					|И НАЧАЛОПЕРИОДА(ОСН.ПериодДействияНачало,МЕСЯЦ) = &ДатаРегистрации";
					ЗВР.УстановитьПараметр("Сотрудник",?(Сч97Сч = 1,Стр_Отр1.СубконтоКт2,Стр_Отр1.СубконтоКт1));
					ЗВР.УстановитьПараметр("Результат",Стр_Отр1.Сумма);
					ЗВР.УстановитьПараметр("ДатаРегистрации",НачалоМесяца(ПериодРегистрации));
					РезЗВР = ЗВР.Выполнить().Выгрузить();
					Если РезЗВР.Количество() > 0 Тогда
						СтрТЗ.ВидРасчета = РезЗВР[0].ВидРасчета;
					Иначе
						СтрТЗ.ВидРасчета = Стр_Отр1.СубконтоКтНУ2; 
					КонецЕсли;
					
					Если Сч97Сч = 1 Тогда
						СтрокаСчета = Стр_Отр1;
					Иначе
						ОтборТЗОснНач = Новый Структура;
						ОтборТЗОснНач.Вставить("ФизЛицо",Стр_Отр1.СубконтоКт1);
						ОтборТЗОснНач.Вставить("Результат",Стр_Отр1.Сумма);
						ОтборТЗОснНач.Вставить("ВидРасчета",Стр_Отр1.ВидРасчета);
						
						СтрокиОтборТЗОснНач = ТЗОснНач.НайтиСтроки(ОтборТЗОснНач);
						Если СтрокиОтборТЗОснНач.Количество() > 0 Тогда
							СтрокаСчета = СтрокиОтборТЗОснНач[0];
						КонецЕсли;
					КонецЕсли;
					
					КолвоСубконто = СтрокаСчета.СчетДт.ВидыСубконто.Количество();
					Для А = 1 ПО КолвоСубконто Цикл
						Если СтрокаСчета.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
							СтрТЗ.Субсчет = СтрокаСчета["СубконтоДт" + Строка(А)].КодПодрДляОтражения;
							Если НЕ ЗначениеЗаполнено(СтрТЗ.Субсчет) Тогда
								СтрТЗ.Субсчет = "0";
							КонецЕсли;
						ИначеЕсли СтрокаСчета.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
						ИначеЕсли СтрокаСчета.СчетДт.ВидыСубконто[А-1].ВидСубконто=ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
							СтрТЗ.Аналитика = СокрЛП(СтрокаСчета["СубконтоДт" + Строка(А)]);	
						КонецЕсли;
					КонецЦикла;
					
					СтрТЗ.Сумма = Стр_Отр1.Сумма * ?(М=1,1,-1);
					СтрТЗ.СуммаБГС = Стр_Отр1.Сумма * ?(М=1,1,-1);
					СтрТЗ.БГС = Окр(Стр_Отр1.Сумма*ПроцентБГС/100,2) * ?(М=1,1,-1);
					
					ФСЗН11 = Окр(Стр_Отр1.Сумма * 0.11,2);
					ФСЗН6 = Окр(Стр_Отр1.Сумма * 0.06,2);
					
					ОтборТЗОтраж2 = Новый Структура;
					ОтборТЗОтраж2.Вставить("ПризнакПроводки",Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты);
					
					Если Сч97Сч = 1 Тогда
						ОтборТЗОтраж2.Вставить("СубконтоКтНУ2",Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ОплатаОтпускаТек);
						ОтборТЗОтраж2.Вставить("СчетКт",ПланыСчетов.Хозрасчетный.НайтиПоКоду("97.02"));
						ОтборТЗОтраж2.Вставить("СубконтоКт2",Стр_Отр1.СубконтоКт2); //сотр
						ОтборТЗОтраж2.Вставить("СубконтоДт1",Стр_Отр1.СубконтоДт1);  //подр
						Если ЗначениеЗаполнено(Стр_Отр1.СубконтоДт2) Тогда
							ОтборТЗОтраж2.Вставить("СубконтоДт2",Стр_Отр1.СубконтоДт2);
						КонецЕсли;
						Если ЗначениеЗаполнено(Стр_Отр1.СубконтоДт3) Тогда
							ОтборТЗОтраж2.Вставить("СубконтоДт3",Стр_Отр1.СубконтоДт3);
						КонецЕсли;
						НетВерногоФСЗН = Истина;
						СтрокиОтборТЗОтраж2 = ТЗОтраж2.НайтиСтроки(ОтборТЗОтраж2);
						Для Каждого Стр_Отр2 ИЗ СтрокиОтборТЗОтраж2 Цикл
							Если ФСЗН11 = Стр_Отр2.Сумма Тогда
								СтрТЗ.СуммаФСЗН11 = Стр_Отр1.Сумма * ?(М=1,1,-1);
								СтрТЗ.ФСЗН11 = Стр_Отр2.Сумма * ?(М=1,1,-1);
								НетВерногоФСЗН = Ложь;
								Прервать;
							ИначеЕсли ФСЗН6 = Стр_Отр2.Сумма Тогда
								СтрТЗ.СуммаФСЗН6 = Стр_Отр1.Сумма * ?(М=1,1,-1);
								СтрТЗ.ФСЗН6 = Стр_Отр2.Сумма * ?(М=1,1,-1);
								НетВерногоФСЗН = Ложь;
								Прервать;
							КонецЕсли;
						КонецЦикла;
						Если НетВерногоФСЗН Тогда
							Сообщить(СокрЛП(Стр_Отр1.СубконтоКт2) + " не совпадают суммы фсзн по отпускам!");
						КонецЕсли;						
					Иначе
						ОтборРасчетЕСН = Новый Структура;
						ОтборРасчетЕСН.Вставить("ФизЛицо",Стр_Отр1.СубконтоКт1);
						СтрокиЕСН = РезЗРасчетЕСН.НайтиСтроки(ОтборРасчетЕСН);
						Если СтрокиЕСН.Количество() > 0 Тогда
							КакойПроцент = СтрокиЕСН[0].ПроцентФСЗН;
							Если КакойПроцент = 11 Тогда
								СтрТЗ.СуммаФСЗН11 = Стр_Отр1.Сумма;
								СтрТЗ.ФСЗН11 = ФСЗН11;
							Иначе
								СтрТЗ.СуммаФСЗН6 = Стр_Отр1.Сумма;
								СтрТЗ.ФСЗН6 = ФСЗН6;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
			КонецЦикла;
		КонецЦикла;
		//счет 97 )
		//Аверсон 18.07.2023 КВВ СВФР-010889 )
		
		Если Расшифровка Тогда
			ТЗРасшифровкаВР = ТЗ.Скопировать();
			ТЗРасшифровкаВР.Свернуть("Счет,Субсчет,Аналитика,Сотрудник,ВидРасчета","Сумма,СуммаФСЗН11,ФСЗН11,СуммаФСЗН6,ФСЗН6,СуммаБГС,БГС");
			ТЗРасшифровкаВР.Сортировать("Сотрудник,ВидРасчета");
			
			ТЗРасшифровкаФИО = ТЗ.Скопировать();
			ТЗРасшифровкаФИО.Свернуть("Счет,Субсчет,Аналитика,Сотрудник","Сумма,СуммаФСЗН11,ФСЗН11,СуммаФСЗН6,ФСЗН6,СуммаБГС,БГС");
			ТЗРасшифровкаФИО.Сортировать("Сотрудник");
		Иначе
			Отбор97 = Новый Структура;
			Отбор97.Вставить("Счет",ПланыСчетов.Хозрасчетный.НайтиПоКоду("97.02"));
			СтрокиОтбор97 = ТЗ.НайтиСтроки(Отбор97);
			Если СтрокиОтбор97.Количество() > 0 Тогда
				Для Каждого Стр97 ИЗ СтрокиОтбор97 Цикл
					Стр97.ПлюсМинус = ?(Стр97.Сумма > 0, 2, 1);
					Стр97.Субсчет = "";
					Стр97.Аналитика = "";
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
		ТЗ.Свернуть("Счет,Субсчет,Аналитика,ПлюсМинус","Сумма,СуммаФСЗН11,ФСЗН11,СуммаФСЗН6,ФСЗН6,СуммаБГС,БГС");
		ТЗ.Сортировать("Счет,Субсчет,Аналитика,ПлюсМинус");
		ТЗКопия = ТЗ.Скопировать();
		ТЗКопия.Свернуть("Счет,Субсчет","Сумма,СуммаФСЗН11,ФСЗН11,СуммаФСЗН6,ФСЗН6,СуммаБГС,БГС");
		ТЗКопия.Сортировать("Счет,Субсчет");
		
		Область3.Параметры.ИтогоВсего = "ВСЕГО:";       																							
		Область3.Параметры.СуммаЗП_Кт70_Ит = ТЗ.Итог("Сумма");
		Область3.Параметры.ФСЗН11_СуммаЗП_Ит = ТЗ.Итог("СуммаФСЗН11");
		Область3.Параметры.ФСЗН11_Кт69_Ит = ТЗ.Итог("ФСЗН11");
		Область3.Параметры.ФСЗН6_СуммаЗП_Ит = ТЗ.Итог("СуммаФСЗН6");
		Область3.Параметры.ФСЗН6_Кт69_Ит = ТЗ.Итог("ФСЗН6");
		Область3.Параметры.БГС_СуммаЗП_Ит = ТЗ.Итог("СуммаБГС");
		Область3.Параметры.БГС_Кт76_Ит = ТЗ.Итог("БГС");
		ТабДок.Вывести(Область3);
		ТабДок.Вывести(Область4);
		
		Для Каждого СтрКоп ИЗ ТЗКопия Цикл
			
			Отбор = Новый Структура;
			Отбор.Вставить("Счет", СтрКоп.Счет);
			Отбор.Вставить("Субсчет", СтрКоп.Субсчет);
			Строки = ТЗ.НайтиСтроки(Отбор);
			
			Для Каждого СтрТЗ ИЗ Строки Цикл
				Область2.Параметры.Сч = СтрТЗ.Счет;
				Область2.Параметры.ССч = СтрТЗ.Субсчет;	
				Область2.Параметры.Аналитика = СтрТЗ.Аналитика;
				Область2.Параметры.СуммаЗП_Кт70 = СтрТЗ.Сумма;	
				Область2.Параметры.ФСЗН11_СуммаЗП = СтрТЗ.СуммаФСЗН11;
				Область2.Параметры.ФСЗН11_Кт69 = СтрТЗ.ФСЗН11;
				Область2.Параметры.ФСЗН6_СуммаЗП = СтрТЗ.СуммаФСЗН6;
				Область2.Параметры.ФСЗН6_Кт69 = СтрТЗ.ФСЗН6;
				Область2.Параметры.БГС_СуммаЗП = СтрТЗ.СуммаБГС;
				Область2.Параметры.БГС_Кт76 = СтрТЗ.БГС;
				
				ТабДок.Вывести(Область2);
				
				Если Расшифровка Тогда
					Отбор4 = Новый Структура;
					Отбор4.Вставить("Счет", СтрТЗ.Счет);
					Отбор4.Вставить("Субсчет", СтрТЗ.Субсчет);
					Отбор4.Вставить("Аналитика", СтрТЗ.Аналитика);
					Строки4 = ТЗРасшифровкаФИО.НайтиСтроки(Отбор4);
					Для Каждого Стр4 ИЗ Строки4 Цикл
						Область5.Параметры.ФИО = Стр4.Сотрудник;
						Область5.Параметры.СуммаЗП_Кт70_ФИО = Стр4.Сумма;	
						Область5.Параметры.ФСЗН11_СуммаЗП_ФИО = Стр4.СуммаФСЗН11;
						Область5.Параметры.ФСЗН11_Кт69_ФИО = Стр4.ФСЗН11;
						Область5.Параметры.ФСЗН6_СуммаЗП_ФИО = Стр4.СуммаФСЗН6;
						Область5.Параметры.ФСЗН6_Кт69_ФИО = Стр4.ФСЗН6;
						Область5.Параметры.БГС_СуммаЗП_ФИО = Стр4.СуммаБГС;
						Область5.Параметры.БГС_Кт76_ФИО = Стр4.БГС;
						ТабДок.Вывести(Область5);
						
						Отбор5 = Новый Структура;
						Отбор5.Вставить("Счет", СтрТЗ.Счет);
						Отбор5.Вставить("Субсчет", СтрТЗ.Субсчет);
						Отбор5.Вставить("Аналитика", СтрТЗ.Аналитика);
						Отбор5.Вставить("Сотрудник", Стр4.Сотрудник);
						
						Строки5 = ТЗРасшифровкаВР.НайтиСтроки(Отбор5);
						Для Каждого Стр5 ИЗ Строки5 Цикл
							Область6.Параметры.ВР = Стр5.ВидРасчета;
							Область6.Параметры.СуммаЗП_Кт70_ВР = Стр5.Сумма;	
							Область6.Параметры.ФСЗН11_СуммаЗП_ВР = Стр5.СуммаФСЗН11;
							Область6.Параметры.ФСЗН11_Кт69_ВР= Стр5.ФСЗН11;
							Область6.Параметры.ФСЗН6_СуммаЗП_ВР = Стр5.СуммаФСЗН6;
							Область6.Параметры.ФСЗН6_Кт69_ВР = Стр5.ФСЗН6;
							Область6.Параметры.БГС_СуммаЗП_ВР = Стр5.СуммаБГС;
							Область6.Параметры.БГС_Кт76_ВР = Стр5.БГС;
							ТабДок.Вывести(Область6);
						КонецЦикла;
					КонецЦикла;
				КонецЕсли;
			КонецЦикла;
			
			Область3.Параметры.ИтогоВсего = "итого по счету:";
			Область3.Параметры.СуммаЗП_Кт70_Ит = СтрКоп.Сумма;
			Область3.Параметры.ФСЗН11_СуммаЗП_Ит = СтрКоп.СуммаФСЗН11;
			Область3.Параметры.ФСЗН11_Кт69_Ит = СтрКоп.ФСЗН11;
			Область3.Параметры.ФСЗН6_СуммаЗП_Ит = СтрКоп.СуммаФСЗН6;
			Область3.Параметры.ФСЗН6_Кт69_Ит = СтрКоп.ФСЗН6;
			Область3.Параметры.БГС_СуммаЗП_Ит = СтрКоп.СуммаБГС;
			Область3.Параметры.БГС_Кт76_Ит = СтрКоп.БГС;
			
			ТабДок.Вывести(Область3);
		КонецЦикла;
	КонецЕсли;
	
	КоличествоЭкземпляров = 1; НаПринтер = Ложь;
	ИмяФормы = " Ведомость распределения ФОТ по счетам";
	РаботаСДиалогами.НапечататьДокумент(ТабДок, КоличествоЭкземпляров, НаПринтер, РаботаСДиалогами.СформироватьЗаголовокДокумента(ЭтотОбъект,Метаданные().Синоним + ИмяФормы));
	//Аверсон 11.07.2023 КВВ СВФР-010889 )
КонецФункции



Функция СуммыПоДокРасчетЕСН()
	//Аверсон 29.08.2020 КВВ СВФР-006325 (
	З = Новый Запрос;
	З.Текст = "ВЫБРАТЬ
	|РасчетЕСН.Ссылка
	|ПОМЕСТИТЬ ВтДок
	|ИЗ Документ.РасчетЕСН КАК РасчетЕСН
	|ГДЕ РасчетЕСН.Проведен
	|И РасчетЕСН.ПериодРегистрации = &Период
	|И РасчетЕСН.Организация = &Организация"; //Аверсон 14.09.2020 КВВ СВФР-006325
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
		З.Текст = З.Текст + "	
		|И РасчетЕСН.ПодразделениеОрганизации = &Подр";
	КонецЕсли;
	З.Текст = З.Текст + "
	|;
	|ВЫБРАТЬ
	|ИсчисленныйЕСН.ФизЛицо,
	|Сумма(ИсчисленныйЕСН.ФСЗН),
	|Сумма(ИсчисленныйЕСН.ОбязательноеСтрахование)
	|ИЗ Документ.РасчетЕСН.ИсчисленныйЕСН КАК ИсчисленныйЕСН
	|ГДЕ
	|ИсчисленныйЕСН.Ссылка В (ВЫБРАТЬ ВтДок.Ссылка ИЗ ВтДок)
	|СГРУППИРОВАТЬ ПО
	|ИсчисленныйЕСН.ФизЛицо
	|УПОРЯДОЧИТЬ ПО 
	|ИсчисленныйЕСН.ФизЛицо.Наименование";
	З.УстановитьПараметр("Подр",ПодразделениеОрганизации);
	З.УстановитьПараметр("Период",ПериодРегистрации);
	З.УстановитьПараметр("Организация",Организация);  //Аверсон 14.09.2020 КВВ СВФР-006325
	РезЗ = З.Выполнить().Выгрузить();
	Возврат РезЗ;
	//Аверсон 29.08.2020 КВВ СВФР-006325 )
КонецФункции

Функция СколькоСотрудниковФизЛица(ФизЛицо)
	//Аверсон 15.10.2020 КВВ СВФР-006691 (
	З = Новый Запрос;
	З.Текст = "ВЫБРАТЬ
	|ОснНач.ФизЛицо,
	|ОснНач.Сотрудник,
	|ОснНач.Сотрудник.Код
	|ИЗ Документ.РасчетЕСН.ОсновныеНачисления КАК ОснНач
	|ГДЕ  ОснНач.Ссылка.Проведен
	|И ОснНач.Ссылка.ПериодРегистрации = &Период
	|И ОснНач.Ссылка.Организация = &Организация
	|И ОснНач.ФизЛицо = &ФизЛицо";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
		З.Текст = З.Текст + "	
		|И ОснНач.Ссылка.ПодразделениеОрганизации = &Подр";
	КонецЕсли;
	З.Текст = З.Текст + "
	|СГРУППИРОВАТЬ ПО
	|ОснНач.ФизЛицо,
	|ОснНач.Сотрудник
	|ОБЪЕДИНИТЬ ВСЕ
	|ВЫБРАТЬ
	|ДопНач.ФизЛицо,
	|ДопНач.Сотрудник,
	|ДопНач.Сотрудник.Код
	|ИЗ Документ.РасчетЕСН.ДополнительныеНачисления КАК ДопНач
	|ГДЕ ДопНач.Ссылка.Проведен
	|И ДопНач.Ссылка.ПериодРегистрации = &Период
	|И ДопНач.Ссылка.Организация = &Организация
	|И ДопНач.ФизЛицо = &ФизЛицо";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
		З.Текст = З.Текст + "	
		|И ДопНач.Ссылка.ПодразделениеОрганизации = &Подр";
	КонецЕсли;
	З.Текст = З.Текст + "
	|СГРУППИРОВАТЬ ПО
	|ДопНач.ФизЛицо,
	|ДопНач.Сотрудник";
	З.УстановитьПараметр("Подр",ПодразделениеОрганизации);
	З.УстановитьПараметр("Период",ПериодРегистрации);
	З.УстановитьПараметр("Организация",Организация); 
	З.УстановитьПараметр("ФизЛицо",ФизЛицо); 
	РезЗ = З.Выполнить().Выгрузить();
	РезЗ.Свернуть("ФизЛицо,Сотрудник");
	Возврат РезЗ.Количество();
	//Аверсон 15.10.2020 КВВ СВФР-006691 )
КонецФункции

Функция ПечатьПроверка()
	//Аверсон 19.08.2020 КВВ СВФР-006325 (
	Макет = ПолучитьМакет("Макет");
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.ПолеСлева = 0;
	ТабДок.ПолеСправа = 0;
	ТабДок.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ";
	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	
	ТабДок.Очистить();
	
	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");	
	ТабДок.Вывести(ОбластьЗаголовок);
	ОбластьЗаголовок1 = Макет.ПолучитьОбласть("Строка");  
	ОбластьЗаголовок2 = Макет.ПолучитьОбласть("Подвал"); 
	
	РезЗ = СуммыПоДокРасчетЕСН();
	
	Для Каждого СтрТЗ ИЗ РезЗ Цикл
		ОбластьЗаголовок1.Параметры.Физ = СтрТЗ.Физлицо;
		ОбластьЗаголовок1.Параметры.БазаФСЗН = СтрТЗ.ФСЗН;
		ОбластьЗаголовок1.Параметры.БазаСтрах = СтрТЗ.ОбязательноеСтрахование;
		
		ТабДок.Вывести(ОбластьЗаголовок1);
	КонецЦикла;
	ОбластьЗаголовок2.Параметры.Итог = РезЗ.Итог("ФСЗН");
	ОбластьЗаголовок2.Параметры.ИтогСтрах = РезЗ.Итог("ОбязательноеСтрахование");
	ТабДок.Вывести(ОбластьЗаголовок2);
	КоличествоЭкземпляров = 1; НаПринтер = Ложь;
	ИмяФормы = " (Расшифровка ФСЗН и БГС из Расчет взносов с ФОТ)";
	РаботаСДиалогами.НапечататьДокумент(ТабДок, КоличествоЭкземпляров, НаПринтер, РаботаСДиалогами.СформироватьЗаголовокДокумента(ЭтотОбъект,Метаданные().Синоним + ИмяФормы));
	//Аверсон 19.08.2020 КВВ СВФР-006325 )
КонецФункции


//Функция ПечатьПроверка() //Островская Татьяна 03.10.2013 № 16828
//	
//	ГоловнаяОрганизация = ОбщегоНазначения.ГоловнаяОрганизация(Организация);
//	
//	
//	//Островская Татьяна 02.10.2013 № 16828
//	ТекстыЗапросовФСЗН = ПолучитьЗапросДляФСЗН();
//	//Островская Татьяна 02.10.2013 № 16828
//	
//	
//	
//	Запрос = Новый Запрос(ТекстыЗапросовФСЗН.ОтраженоЕСНИсчисленногоТекст);
//	
//	//Выберем счета из регисьра сведений СтавкиОтчисленийСФОТиЗП
//	
//	СписокСчетовУчетаЕСН = Новый СписокЗначений;
//	СписокСчетовУчетаЕСН.Добавить(РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//	Новый Структура("Организация,ВидОтчисления", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).СчетБУ);
//	
//	СписокСчетовУчетаЕСН.Добавить(РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//	Новый Структура("Организация,ВидОтчисления", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж)).СчетБУ);
//	
//	СписокСчетовУчетаЕСН.Добавить(РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//	Новый Структура("Организация,ВидОтчисления", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд)).СчетБУ);
//	
//	СписокСчетовУчетаЕСН.Добавить(РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
//	Новый Структура("Организация", Организация)).СчетБУ);
//	
//	Запрос.УстановитьПараметр("парамСписокСчетовКт", СписокСчетовУчетаЕСН);
//	Запрос.УстановитьПараметр("парамСубконтоКт1", Перечисления.ВидыПлатежейВГосБюджет.Налог);
//	Запрос.УстановитьПараметр("парамОрганизация", Организация);
//	Запрос.УстановитьПараметр("парамНачалоПериода", НачалоМесяца(ПериодРегистрации));
//	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
//	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
//	
//	ОтраженоРанееВНалоговомПериоде = Запрос.Выполнить().Выгрузить();
//	
//	
//	Запрос = Новый Запрос(ТекстыЗапросовФСЗН.КоэффициентыОтраженияЕСНТекст);
//	
//	Запрос.УстановитьПараметр("парамОрганизация", Организация);
//	Запрос.УстановитьПараметр("РасчетФСЗНотБПМ", РасчетФСЗНотБПМ);
//	Запрос.УстановитьПараметр("парамБПМ", РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,
//	Новый Структура("Видпараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер);
//	Запрос.УстановитьПараметр("парамНачалоПериода", НачалоМесяца(ПериодРегистрации));
//	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
//	Запрос.УстановитьПараметр("парамПериод", НачалоМесяца(ПериодРегистрации));
//	
//	Запрос.УстановитьПараметр("Счет97", ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов);
//	Запрос.УстановитьПараметр("СчетН97", ПланыСчетов.Налоговый.РасходыНаОплатуТрудаБудущихПериодов);
//	
//	Запрос.УстановитьПараметр("РБПНаОплатуТруда", Справочники.РасходыБудущихПериодов.РБПНаОплатуТруда);
//	Запрос.УстановитьПараметр("ОтпускБудПериода", Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ОплатаОтпускаБуд);
//	//СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("ВидОтчисления",Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд));
//	//Островская Татьяна 10.09.2013 № 16725
//	РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//	//Островская Татьяна 10.09.2013 № 16725
//	БазаОграниченияФСЗН = РазмерСреднейЗарплаты; //СтруктураПенс.ОграничениеПоДоходам*(расчитывается в запросе)№ 950
//	Запрос.УстановитьПараметр("Ограничение", БазаОграниченияФСЗН);
//	Запрос.УстановитьПараметр("ПустаяСсылкаВидНалогообложения", Справочники.ВидыНалогообложения.ПустаяСсылка()); //О.Т. Аверсон 25.03.2016 № 950
//	Запрос.УстановитьПараметр("ПериодДляОграничения", КонецМесяца(ПериодРегистрации)); //О.Т. Аверсон 25.03.2016 № 950
//	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
//	ОтражениеВБУОбщ = Запрос.Выполнить().Выгрузить();
//	
//	//Аверсон 16.08.2020 КВВ СВФР-006325 (
//	ЗапросПоОтпускамДругогоПериодаРегистрации(ОтражениеВБУОбщ,НачалоМесяца(ПериодРегистрации),ПодразделениеОрганизации);
//	//ОтражениеВБУОбщ.Сортировать("ВспомогательныйСчет");
//	ОтражениеВБУОбщ.Сортировать("СчетДт,ВспомогательныйСчет");
//	//Аверсон 16.08.2020 КВВ СВФР-006325 )	
//	
//	если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//		ОтражениеВБУОбщ.Свернуть("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,ПериодРегистрации,ПериодДействия,ФлагДля97Сч");
//	иначе  		
//		ОтражениеВБУОбщ.Свернуть("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3,СчетДтНУ,СубконтоДтНУ1,СубконтоДтНУ2,СубконтоДтНУ3,ПериодРегистрации,ПериодДействия,Проверка,ФлагДля97Сч", "БазаФСЗН,БазаСтрах,БазаЕдиныйПлатеж,БазаФСЗНБУ,БазаСтрахБУ,БазаЕдиныйПлатежБУ");
//	КонецЕсли;
//	
//	Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//		Запрос.Текст = ТекстыЗапросовФСЗН.КоэффициентыОтраженияЕСНТекст1;
//		ОтражениеВБУДляБазы = Запрос.Выполнить().Выгрузить();
//	КонецЕсли;
//	
//	
//	//ОтражениеВБУОбщ.Свернуть("","БазаФСЗН");
//	СубконтоКредита = Перечисления.ВидыПлатежейВГосБюджет.Налог;
//	//СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//	//Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).Размер;
//	//СтавкаФСЗНИнвалиды = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//	//Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)).Размер;																					
//	//СтавкаЕдиныйПлатеж = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//	//Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж)).Размер;
//	//СтавкаСтрах = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
//	//Новый Структура("Организация", Организация)).Ставка;
//	
//	ПромежуточнаяТаблица = Новый ТаблицаЗначений;
//	ПромежуточнаяТаблица.Колонки.Добавить("ФизЛицо",,"ФизЛицо");
//	ПромежуточнаяТаблица.Колонки.Добавить("БазаФСЗН",,"БазаФСЗН");
//	ПромежуточнаяТаблица.Колонки.Добавить("БазаСтрах",,"БазаСтрах");
//	СЗДляДоплаты = Новый ТаблицаЗначений;
//	СЗДляДоплаты.Колонки.Добавить("ФизЛицо");
//	СЗДляДоплаты.Колонки.Добавить("Период");//О.Т. 02.03.2015 № 17778
//	
//	ТЗКорректировкаКопеек = Новый ТаблицаЗначений;
//	ТЗКорректировкаКопеек.Колонки.Добавить("ФизЛицо");
//	ТЗКорректировкаКопеек.Колонки.Добавить("СуммаФСЗН");
//	ТЗКорректировкаКопеек.Колонки.Добавить("СуммаБГС");
//	ТЗКорректировкаКопеек.Колонки.Добавить("СуммаЕдиныйПлатеж");
//	ТЗКорректировкаКопеек.Колонки.Добавить("ДоляСпособаОтраженияФСЗН");
//	ТЗКорректировкаКопеек.Колонки.Добавить("ДоляСпособаОтраженияБГС");
//	
//	//О.Т. Аверсон 31.08.2018 № 2322
//	ТЗКорректировкаКопеекПоИтогу = Новый ТаблицаЗначений;
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("ФизЛицо");
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("Субконто1");
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("Субконто2");
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("Субконто3"); 	
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаФСЗН");
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаБГС");
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаЕдиныйПлатеж");
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаСравненияФСЗН");
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаСравненияБГС");
//	ТЗКорректировкаКопеекПоИтогу.Колонки.Добавить("СуммаСравненияЕдиныйПлатеж"); 
//	//О.Т. Аверсон 31.08.2018 № 2322
//	
//	
//	ТЗОбщаяБазы = новый ТаблицаЗначений;
//	ТЗОбщаяБазы.Колонки.Добавить("ФизЛицо");
//	ТЗОбщаяБазы.Колонки.Добавить("БазаФСЗН");
//	ТЗОбщаяБазы.Колонки.Добавить("БазаБГС");
//	ТЗОбщаяБазы.Колонки.Добавить("БазаЕдиный");
//	ТЗОбщаяБазы.Колонки.Добавить("КолСчетов");
//	ТЗОбщаяБазы.Колонки.Добавить("СчетНеИзРаспределения");
//	
//	ТЗДляУдельногоВеса = Новый ТаблицаЗначений;
//	ТЗДляУдельногоВеса.Колонки.Добавить("ФизЛицо");
//	ТЗДляУдельногоВеса.Колонки.Добавить("ПроцентыСумм");
//	ТЗДляУдельногоВеса.Колонки.Добавить("КолСчетовСумм");
//	
//	ТЗДляУдельногоВесаБГС = Новый ТаблицаЗначений;
//	ТЗДляУдельногоВесаБГС.Колонки.Добавить("ФизЛицо");
//	ТЗДляУдельногоВесаБГС.Колонки.Добавить("ПроцентыСумм");
//	ТЗДляУдельногоВесаБГС.Колонки.Добавить("КолСчетовСумм");
//	
//	ТЗДляУдельногоВесаЕдиный = Новый ТаблицаЗначений;
//	ТЗДляУдельногоВесаЕдиный.Колонки.Добавить("ФизЛицо");
//	ТЗДляУдельногоВесаЕдиный.Колонки.Добавить("ПроцентыСумм");
//	ТЗДляУдельногоВесаЕдиный.Колонки.Добавить("КолСчетовСумм");
//	
//	
//	
//	//ПромежуточнаяТаблица = ОтражениеВБУОбщ;
//	Для Каждого мСтрока из ОтражениеВБУОбщ Цикл 
//		//О.Т. Аверсон 25.03.2016 № 950
//		СуммаУжеРаспределенная=Ложь;
//		СотрПрошл = "";
//		ОснНач = ОсновныеНачисления.НайтиСтроки(Новый структура("ФизЛицо",мСтрока.ФизЛицо));
//		Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
//		СписокСотрудников = Новый СписокЗначений;
//		для Каждого стрОснНач из ОснНач Цикл 
//			ПроверитьСотрудника = СписокСотрудников.НайтиПоЗначению(стрОснНач.Сотрудник);
//			если ПроверитьСотрудника =  Неопределено Тогда
//				если ОснНач <> СотрПрошл Тогда
//					Сотрудник = стрОснНач.Сотрудник;
//					СписокСотрудников.Добавить(Сотрудник); 
//				КонецЕсли;
//			КонецЕсли;
//			СотрПрошл = стрОснНач.Сотрудник;
//		КонецЦикла; 
//		
//		ОснНач = ДополнительныеНачисления.НайтиСтроки(Новый структура("ФизЛицо",мСтрока.ФизЛицо));
//		
//		для Каждого стрОснНач из ОснНач Цикл 
//			ПроверитьСотрудника = СписокСотрудников.НайтиПоЗначению(стрОснНач.Сотрудник);
//			если ПроверитьСотрудника =  Неопределено Тогда 
//				если ОснНач <> СотрПрошл Тогда
//					Сотрудник = стрОснНач.Сотрудник;
//					СписокСотрудников.Добавить(Сотрудник); 
//				КонецЕсли;
//			КонецЕсли;
//			СотрПрошл = стрОснНач.Сотрудник;
//		КонецЦикла;
//		ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
//		Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
//			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
//		иначе
//			ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
//		КонецЕсли;
//		ЗапросИндСтавкаНалогообл = Новый Запрос;
//		ЗапросИндСтавкаНалогообл.Текст = 
//		"ВЫБРАТЬ
//		|	ИноеНалогообложениеПоСотрудникамСрезПоследних.БГС,
//		|	ИноеНалогообложениеПоСотрудникамСрезПоследних.ФСЗН
//		|ИЗ
//		|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
//		|			&Период,
//		|			Организация = &Организация
//		|				И ВидНалогообложения = &ВидНалогообложения
//		|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
//		
//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Сотрудник); 
//		РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
//		ЕстьИндивидСтавка = Ложь;
//		СтавкаФСЗНИнд = 0;
//		СтавкаБГСИнд = 0;
//		Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
//			ЕстьИндивидСтавка = Истина;
//			СтавкаФСЗНИнд = РезИндСтавкаНалогообл[0].ФСЗН;
//			СтавкаБГСИнд = РезИндСтавкаНалогообл[0].БГС;
//		КонецЕсли;
//		
//		Если ЕстьИндивидСтавка Тогда 
//			СтавкаФСЗН = СтавкаФСЗНИнд;
//			СтавкаФСЗНИнвалиды = СтавкаФСЗНИнд;
//			СтавкаСтрах = СтавкаБГСИнд;
//		иначе
//			СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).Размер;
//			СтавкаФСЗНИнвалиды = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды,ВидНалогообложения)).Размер;
//			СтавкаСтрах = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации, 
//			Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Ставка;
//		КонецЕсли;   
//		СтавкаЕдиныйПлатеж = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//		Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж,ВидНалогообложения)).Размер;
//		//О.Т. Аверсон 25.03.2016 № 950
//		
//		
//		
//		ПродолжитьЦикл = Ложь;
//		ЗапросПодр = Новый Запрос;
//		СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
//		ЗапросПодр.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
//		СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
//		ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
//		
//		ЗапросПодр.Текст = 
//		"ВЫБРАТЬ
//		|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
//		|	ВЫБОР
//		|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
//		|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
//		|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
//		|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
//		|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
//		|	КОНЕЦ КАК СубконтоДт1
//		|ИЗ
//		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, ) КАК РаботникиОрганизацийСрезПоследних
//		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
//		|		ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
//		|			И РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
//		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
//		|		ПО РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
//		|		И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации //О.Т. 01.09.2015
//		|ГДЕ";
//		
//		если ЗначениеЗаполнено(Сотрудник) Тогда 
//			
//			ЗапросПодр.Текст = ЗапросПодр.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник = &Физлицо";
//			ЗапросПодр.УстановитьПараметр("Физлицо", Сотрудник);
//		иначе
//			ЗапросПодр.Текст = ЗапросПодр.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо = &Физлицо";
//			ЗапросПодр.УстановитьПараметр("Физлицо", мСтрока.ФизЛицо);
//		КонецЕсли;
//		ЗапросПодр.УстановитьПараметр("Период", мСтрока.ПериодДействия);
//		
//		РезультатЗапроса = ЗапросПодр.Выполнить();
//		
//		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
//		
//		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
//			Подразделение = ВыборкаДетальныеЗаписи.ПодразделениеОрганизации;
//			если ТипЗнч(мСтрока.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
//				если ЗначениеЗаполнено(ВыборкаДетальныеЗаписи.СубконтоДт1) Тогда 
//					Подразделение = ВыборкаДетальныеЗаписи.СубконтоДт1;
//				иначе
//					Подразделение = ВыборкаДетальныеЗаписи.ПодразделениеОрганизации;
//				КонецЕсли;
//				если не Подразделение = мСтрока.субконтоДт1 Тогда 
//					если не СписокСотрудников.Количество()> 1 Тогда
//						Если не НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//							ПродолжитьЦикл = Истина;
//						КонецЕсли;
//					КонецЕсли;
//				КонецЕсли;
//			КонецЕсли;
//		КонецЦикла;
//		если ПродолжитьЦикл Тогда 
//			Продолжить;
//		КонецЕсли;
//		
//		
//		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда
//			МассивБаза = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//			Если МассивБаза.Количество()>0 Тогда 
//				
//			иначе
//				Запрос = Новый Запрос;
//				Запрос.Текст = 
//				"ВЫБРАТЬ
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
//				|ИЗ
//				|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//				|ГДЕ
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
//				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник";
//				
//				Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
//				Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРегистрации));
//				Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
//				Запрос.УстановитьПараметр("СчетДт", мСтрока.СчетДт);
//				Запрос.УстановитьПараметр("СубконтоДт2", мСтрока.СубконтоДт2);
//				
//				ТЗРаспределСчета = Запрос.Выполнить().Выгрузить();
//				СтрТЗОбщаяБазы = "";
//				МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо)); 
//				ТЗБазаРаспрДобавленные = Новый ТаблицаЗначений;
//				ТЗБазаРаспрДобавленные.Колонки.Добавить("ФизЛицо");
//				ТЗБазаРаспрДобавленные.Колонки.Добавить("СчетДт");   				
//				ТЗБазаРаспрДобавленные.Колонки.Добавить("СубконтоДт2");   				
//				ТЗБазаРаспрДобавленные.Колонки.Добавить("БазаФСЗН");
//				ТЗБазаРаспрДобавленные.Колонки.Добавить("БазаБГС");
//				ТЗБазаРаспрДобавленные.Колонки.Добавить("БазаЕдиный");
//				ТЗБазаРаспрДобавленные.Колонки.Добавить("ВидРасчета");
//				ТЗБазаРаспрДобавленные.Колонки.Добавить("ПериодДействия");
//				
//				//О.Т. Аверсон 30.08.2018 № 2322
//				ПроверкаКолСчетов = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета",мСтрока.ФизЛицо,ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда));
//				КолСчетовПоДог = 0;
//				СчетПрошл = "";
//				Для Каждого стр из ПроверкаКолСчетов Цикл 
//					Если СчетПрошл <> стр.СчетДт Тогда 
//						КолСчетовПоДог = КолСчетовПоДог+1;
//					КонецЕсли;   									
//					СчетПрошл = стр.СчетДт;
//				КонецЦикла;
//				//О.Т. Аверсон 30.08.2018 № 2322
//				
//				Для Каждого СтрМассивСтрок из  МассивСтрок Цикл 
//					Если не СтрМассивСтрок.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда 
//						СчетДобавлен = Ложь;
//						Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//							БазаФСЗН = СтрМассивСтрок.БазаФСЗНБУ;
//						иначе
//							БазаФСЗН = СтрМассивСтрок.БазаФСЗН;
//						КонецЕсли;
//						МассивСтрокРаспр = ТЗРаспределСчета.НайтиСтроки(Новый Структура("СчетДт,СубконтоДт2",СтрМассивСтрок.СчетДт,СтрМассивСтрок.СубконтоДт2)); 
//						//Аверсон 28.07.2020 КВВ СВФР-006325 ( закомментировано
//						//Если ?(ТипЗнч(СтрМассивСтрок.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций"),истина,МассивСтрокРаспр.Количество()>0) и ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаФСЗН,ВидРасчета",СтрМассивСтрок.ФизЛицо,БазаФСЗН,СтрМассивСтрок.ВидРасчета)).Количество()>0 Тогда 
//						//иначе
//							//Аверсон 28.07.2020 КВВ СВФР-006325 ) закомментировано
//							Если ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",СтрМассивСтрок.ФизЛицо)).Количество()>0 Тогда 
//								Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//									СтрТЗОбщаяБазы.БазаФСЗН = ?(СтрТЗОбщаяБазы.БазаФСЗН = Неопределено,0,СтрТЗОбщаяБазы.БазаФСЗН) + СтрМассивСтрок.БазаФСЗНБУ; 
//								иначе
//									СтрТЗОбщаяБазы.БазаФСЗН = ?(СтрТЗОбщаяБазы.БазаФСЗН = Неопределено,0,СтрТЗОбщаяБазы.БазаФСЗН) + СтрМассивСтрок.БазаФСЗН; 
//								КонецЕсли;
//								//СтрТЗОбщаяБазы.БазаБГС = СтрТЗОбщаяБазы.БазаБГС + ТекСтрокаОтражениеВБУ.БазаБГС; 
//								Если МассивСтрокРаспр.Количество()=0 Тогда 
//									//Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
//									СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
//									//КонецЕсли;
//								КонецЕсли;
//								СчетДобавлен = Истина;
//								
//							иначе
//								СтрТЗОбщаяБазы = ТЗОбщаяБазы.Добавить();
//								СтрТЗОбщаяБазы.ФизЛицо = СтрМассивСтрок.ФизЛицо;
//								Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//									СтрТЗОбщаяБазы.БазаФСЗН = СтрМассивСтрок.БазаФСЗНБУ; 
//								иначе
//									СтрТЗОбщаяБазы.БазаФСЗН = СтрМассивСтрок.БазаФСЗН; 
//								КонецЕсли;
//								
//								//СтрТЗОбщаяБазы.БазаБГС = ТекСтрокаОтражениеВБУ.БазаБГС; 
//								Если МассивСтрокРаспр.Количество()=0 Тогда 
//									//Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
//									СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
//									//КонецЕсли;
//								КонецЕсли;
//								СчетДобавлен = Истина;
//							КонецЕсли;
//							СтрТЗБазаРаспрДобавленные = ТЗБазаРаспрДобавленные.Добавить();
//							ЗаполнитьЗначенияСвойств(СтрТЗБазаРаспрДобавленные,СтрМассивСтрок);
//							СтрТЗБазаРаспрДобавленные.БазаФСЗН = БазаФСЗН;
//						//КонецЕсли;   //Аверсон 28.07.2020 КВВ СВФР-006325 закомментировано
//						
//						Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//							БазаСтрах = СтрМассивСтрок.БазаСтрахБУ;
//						иначе
//							БазаСтрах = СтрМассивСтрок.БазаСтрах;
//						КонецЕсли;
//						Если МассивСтрокРаспр.Количество()>0 и ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаБГС,ВидРасчета,ПериодДействия",СтрМассивСтрок.ФизЛицо,СтрМассивСтрок.БазаСтрах,СтрМассивСтрок.ВидРасчета,СтрМассивСтрок.ПериодДействия)).Количество()>0 Тогда 
//						иначе
//							Если ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",СтрМассивСтрок.ФизЛицо)).Количество()>0 Тогда 
//								//СтрТЗОбщаяБазы.БазаФСЗН = СтрТЗОбщаяБазы.БазаФСЗН + ТекСтрокаОтражениеВБУ.БазаФСЗН;
//								Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//									СтрТЗОбщаяБазы.БазаБГС = ?(СтрТЗОбщаяБазы.БазаБГС = Неопределено,0,СтрТЗОбщаяБазы.БазаБГС) + СтрМассивСтрок.БазаСтрахБУ; 
//								иначе
//									СтрТЗОбщаяБазы.БазаБГС = ?(СтрТЗОбщаяБазы.БазаБГС = Неопределено,0,СтрТЗОбщаяБазы.БазаБГС) + СтрМассивСтрок.БазаСтрах; 
//								КонецЕсли;
//								
//								Если не СчетДобавлен Тогда 
//									
//									Если МассивСтрокРаспр.Количество()=0 Тогда 
//										//Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
//										СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
//										//КонецЕсли;
//									КонецЕсли;
//								КонецЕсли;
//								СчетДобавлен = Истина;
//								
//							иначе
//								СтрТЗОбщаяБазы = ТЗОбщаяБазы.Добавить();
//								СтрТЗОбщаяБазы.ФизЛицо = СтрМассивСтрок.ФизЛицо;
//								//СтрТЗОбщаяБазы.БазаФСЗН = ТекСтрокаОтражениеВБУ.БазаФСЗН;
//								Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//									СтрТЗОбщаяБазы.БазаБГС = СтрМассивСтрок.БазаСтрахБУ; 
//								иначе
//									СтрТЗОбщаяБазы.БазаБГС = СтрМассивСтрок.БазаСтрах; 
//								КонецЕсли; 
//								Если не СчетДобавлен Тогда 
//									Если МассивСтрокРаспр.Количество()=0 Тогда 
//										//Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
//										СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
//										//КонецЕсли;
//									КонецЕсли;
//								КонецЕсли;
//								СчетДобавлен = Истина;
//							КонецЕсли;
//							Если не СчетДобавлен Тогда 
//								СтрТЗБазаРаспрДобавленные = ТЗБазаРаспрДобавленные.Добавить();
//								ЗаполнитьЗначенияСвойств(СтрТЗБазаРаспрДобавленные,СтрМассивСтрок);
//							КонецЕсли;
//							СтрТЗБазаРаспрДобавленные.БазаБГС = БазаСтрах;
//						КонецЕсли;
//						
//						//единый налог
//						Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//							БазаЕдиныйПлатеж = СтрМассивСтрок.БазаЕдиныйПлатежБУ;
//						иначе
//							БазаЕдиныйПлатеж = СтрМассивСтрок.БазаЕдиныйПлатеж;
//						КонецЕсли;
//						Если МассивСтрокРаспр.Количество()>0 и ТЗБазаРаспрДобавленные.НайтиСтроки(Новый Структура("ФизЛицо,БазаЕдиный,ВидРасчета,ПериодДействия",СтрМассивСтрок.ФизЛицо,СтрМассивСтрок.БазаЕдиныйПлатеж,СтрМассивСтрок.ВидРасчета,СтрМассивСтрок.ПериодДействия)).Количество()>0 Тогда 
//						иначе
//							Если ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",СтрМассивСтрок.ФизЛицо)).Количество()>0 Тогда 
//								//СтрТЗОбщаяБазы.БазаФСЗН = СтрТЗОбщаяБазы.БазаФСЗН + ТекСтрокаОтражениеВБУ.БазаФСЗН;
//								Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//									СтрТЗОбщаяБазы.БазаЕдиный = ?(СтрТЗОбщаяБазы.БазаЕдиный = Неопределено,0,СтрТЗОбщаяБазы.БазаЕдиный) + СтрМассивСтрок.БазаЕдиныйПлатежБУ; 
//								иначе
//									СтрТЗОбщаяБазы.БазаЕдиный = ?(СтрТЗОбщаяБазы.БазаЕдиный = Неопределено,0,СтрТЗОбщаяБазы.БазаЕдиный) + СтрМассивСтрок.БазаЕдиныйПлатеж;
//								КонецЕсли;
//								
//								Если не СчетДобавлен Тогда 
//									
//									Если МассивСтрокРаспр.Количество()=0 Тогда 
//										//Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
//										СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
//										//КонецЕсли;
//									КонецЕсли;
//								КонецЕсли;
//								
//							иначе
//								СтрТЗОбщаяБазы = ТЗОбщаяБазы.Добавить();
//								СтрТЗОбщаяБазы.ФизЛицо = СтрМассивСтрок.ФизЛицо;
//								//СтрТЗОбщаяБазы.БазаФСЗН = ТекСтрокаОтражениеВБУ.БазаФСЗН;
//								Если СтрМассивСтрок.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда и КолСчетовПоДог>1 Тогда //О.Т. Аверсон 30.08.2018 № 2322
//									СтрТЗОбщаяБазы.БазаЕдиный = СтрМассивСтрок.БазаЕдиныйПлатежБУ; 
//								иначе
//									СтрТЗОбщаяБазы.БазаЕдиный = СтрМассивСтрок.БазаЕдиныйПлатеж;
//								КонецЕсли;
//								
//								Если не СчетДобавлен Тогда 
//									Если МассивСтрокРаспр.Количество()=0 Тогда 
//										//Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
//										СтрТЗОбщаяБазы.СчетНеИзРаспределения = ?(СтрТЗОбщаяБазы.СчетНеИзРаспределения = Неопределено,0,СтрТЗОбщаяБазы.СчетНеИзРаспределения) + 1;
//										//КонецЕсли;
//									КонецЕсли;
//								КонецЕсли;
//								
//							КонецЕсли;
//							Если не СчетДобавлен Тогда 
//								СтрТЗБазаРаспрДобавленные = ТЗБазаРаспрДобавленные.Добавить();
//								ЗаполнитьЗначенияСвойств(СтрТЗБазаРаспрДобавленные,СтрМассивСтрок);
//							КонецЕсли;
//							СтрТЗБазаРаспрДобавленные.БазаЕдиный = БазаЕдиныйПлатеж;
//						КонецЕсли;
//						
//						
//						
//					КонецЕсли;
//					
//				КонецЦикла;
//				МассивСтрок1 = ОтражениеВБУОбщ.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//				МасТЗОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",СтрМассивСтрок.ФизЛицо));
//				
//				Для Каждого стрМассив из МассивСтрок1 Цикл 
//					Если не стрМассив.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда						
//						Если МасТЗОбщаяБазы.Количество()>0 Тогда 
//							МасТЗОбщаяБазы[0].КолСчетов = ?(МасТЗОбщаяБазы[0].КолСчетов=Неопределено,0,МасТЗОбщаяБазы[0].КолСчетов)+1;
//						КонецЕсли;   						
//					КонецЕсли; 					
//				КонецЦикла;
//				
//			КонецЕсли;
//			
//		КонецЕсли;
//		
//		
//		
//		//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
//		
//		//О.Т. Аверсон 06.04.2017 № 514
//		Если мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда 
//			ЗапросФСЗНБГС = Новый Запрос;
//			ЗапросФСЗНБГС.Текст = 
//			"ВЫБРАТЬ
//			|	ЕСНИсчисленный.ФСЗН, 100 как ДоляСпособаОтражения 
//			|ИЗ
//			|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//			|ГДЕ
//			|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//			|	И ЕСНИсчисленный.Организация = &Организация
//			|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//			|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) > НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ) И ЕСНИсчисленный.ФСЗН <> 0";
//			
//		иначе
//			ЗапросФСЗНБГС = Новый Запрос;
//			ЗапросФСЗНБГС.Текст = 
//			"ВЫБРАТЬ
//			|	ЕСНИсчисленный.ФСЗН,
//			|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
//			|ИЗ
//			|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//			|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
//			|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
//			|			И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
//			|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
//			|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
//			|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2
//			|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)";
//			//О.Т. Аверсон 19.10.2017 № 1147
//			Если ЗначениеЗаполнено(мСтрока.СубконтоДт1)  Тогда //О.Т. Аверсон 29.08.2018 № 2322 //и не ТипЗнч(мСтрока.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций")
//				ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + " 
//				|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1
//				|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)";
//			КонецЕсли;
//			//О.Т. Аверсон 19.10.2017 № 1147
//			
//			ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + "
//			|ГДЕ
//			|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//			|	И ЕСНИсчисленный.Организация = &Организация
//			|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//			|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
//			|	И ЕСНИсчисленный.ФСЗН <> 0
//			|	И (НЕ &ПодразделениеЗаполнено ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)) //Аверсон 13.08.2020 КВВ СВФР-006325
//			|";                                 
//		КонецЕсли;
//		
//		ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
//		ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
//		ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
//		ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо", мСтрока.ФизЛицо);
//		ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",мСтрока.СчетДт);
//		ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт2",мСтрока.СубконтоДт2);
//		ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт1",мСтрока.СубконтоДт1);
//		
//		ЗапросФСЗНБГС.УстановитьПараметр("ПодразделениеЗаполнено", ЗначениеЗаполнено(ПодразделениеОрганизации)); //Аверсон 13.08.2020 КВВ СВФР-006325
//		ЗапросФСЗНБГС.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);  //Аверсон 13.08.2020 КВВ СВФР-006325

//		
//		РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
//		ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
//		ЕстьПроцент = Ложь;
//		Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл 
//			Если ЗначениеЗаполнено(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) Тогда 
//				ЕстьПроцент = Истина;
//			КонецЕсли;  			
//		КонецЦикла;
//		Если не НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//			ОтражениеВБУДляБазы = Новый ТаблицаЗначений;
//			МассивСтрокПоСчету = Новый Массив;
//		иначе
//			МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//		КонецЕсли;
//		ЭтоОснНач = Ложь;
//		Если МассивСтрокПоСчету.Количество()>0 Тогда 
//			стрМассив = МассивСтрокПоСчету[0]; 
//			ЭтоОснНач = ТипЗнч(стрМассив.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций");
//		КонецЕсли;
//		
//		Если не ЕстьПроцент и ?(Организация.ИНН = "192798722",ЭтоОснНач, Истина) Тогда //и ЭтоОснНач //О.Т. Аверсон 25.03.2019 № 4135
//			ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1","");
//			ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)","");
//		КонецЕсли;
//		РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
//		ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
//		
//		БазаФСЗН = 0;
//		БазаФСЗНПрошл = 0;
//		БазаФСЗНПрошл1 = 0;
//		ДоляСпособаОтраженияВТаблицеФСЗН = 0;
//		Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл			
//			если ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН <> 0 Тогда
//				КолСчетовИзОбщейБазы = 0;
//				МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//				Если МассивОбщаяБазы.Количество()>0 Тогда
//					КолСчетовИзОбщейБазы = МассивОбщаяБазы[0].КолСчетов;
//					Если МассивОбщаяБазы[0].СчетНеИзРаспределения <> Неопределено Тогда 
//						МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//						БазаОбщаяФСЗН = 0;
//						
//						ПроверкаПериодДействияПрошл = "";
//						ПроверкаБазаФСЗНПрошл = "";
//						ПроверкаБазаФСЗННУПрошл = "";
//						Для Каждого стрМассив из МассивСтрокПоСчету Цикл
//							Если стрМассив.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда Тогда  //О.Т. Аверсон 30.08.2018 № 2322
//								ПроверкаКолСчетов = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета",мСтрока.ФизЛицо,ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда));
//								КолСчетовПоДог = 0;
//								СчетПрошл = "";
//								Для Каждого стр из ПроверкаКолСчетов Цикл 
//									Если СчетПрошл <> стр.СчетДт Тогда 
//										КолСчетовПоДог = КолСчетовПоДог+1;
//									КонецЕсли;   									
//									СчетПрошл = стр.СчетДт;
//								КонецЦикла;
//								
//								Если КолСчетовПоДог>1 Тогда 
//									Если ПроверкаПериодДействияПрошл <> стрМассив.ПериодДействия и ПроверкаБазаФСЗНПрошл <> стрМассив.БазаФСЗН и ПроверкаБазаФСЗННУПрошл = стрМассив.БазаФСЗНБУ Тогда 
//										Продолжить;
//									КонецЕсли;     																
//								КонецЕсли;
//								
//								Если КолСчетовПоДог>1 Тогда 
//									БазаОбщаяФСЗН = БазаОбщаяФСЗН + стрМассив.БазаФСЗНБУ;
//								иначе
//									БазаОбщаяФСЗН = БазаОбщаяФСЗН + стрМассив.БазаФСЗН;
//								КонецЕсли;
//								ПроверкаПериодДействияПрошл = стрМассив.ПериодДействия; 
//								ПроверкаБазаФСЗНПрошл = стрМассив.БазаФСЗН;
//								ПроверкаБазаФСЗННУПрошл = стрМассив.БазаФСЗНБУ;
//								
//							иначе
//								БазаОбщаяФСЗН = БазаОбщаяФСЗН + стрМассив.БазаФСЗН;
//							КонецЕсли;  
//							
//						КонецЦикла;  
//						//БазаОбщаяФСЗН = БазаОбщаяФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//						
//						//УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаФСЗН=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаОбщаяФСЗН / МассивОбщаяБазы[0].БазаФСЗН * 100,ПериодРегистрации));
//						УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаФСЗН=0,0,БазаОбщаяФСЗН / МассивОбщаяБазы[0].БазаФСЗН * 100);											
//						БазаФСЗН1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * УдельныйВесДляПропорции / 100;
//						
//						БазаФСЗН = БазаФСЗН1 * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//						
//						
//						ДоляСпособаОтраженияВТаблицеФСЗН = ДоляСпособаОтраженияВТаблицеФСЗН + ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//						
//						
//						Если МассивОбщаяБазы[0].БазаФСЗН = 0 и БазаОбщаяФСЗН = 0 Тогда 
//							МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//							Если МассивДляУдельногоВеса.Количество()>0 Тогда
//								Если МассивДляУдельногоВеса[0].ПроцентыСумм <> 100 Тогда 
//									БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//									УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//								КонецЕсли;
//							иначе
//								БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//								УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//							КонецЕсли;
//						КонецЕсли;
//						
//						МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции;
//							Если БазаФСЗНПрошл = 0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//							КонецЕсли;
//						иначе
//							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
//							СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
//							Если БазаФСЗНПрошл = 0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//							КонецЕсли;
//						КонецЕсли;
//					иначе
//						БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//						БазаФСЗН1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//						
//						МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//							МассивДляУдельногоВеса[0].ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//							Если БазаФСЗНПрошл = 0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//							КонецЕсли;
//						иначе
//							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
//							СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//							Если БазаФСЗНПрошл = 0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//							КонецЕсли;
//						КонецЕсли;
//					КонецЕсли;
//					
//					
//				иначе
//					БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//					БазаФСЗН1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//					
//				КонецЕсли;
//				Если мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//					БазаФСЗН = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//					БазаФСЗН1 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//				КонецЕсли;
//				
//				
//				//Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//				//	МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//				//	КолСчетовОбщий = 0;
//				//	Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//				//		УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
//				//		КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
//				//	КонецЕсли;
//				
//				//	МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//				//	Если МассивКорректировкаКопеек.Количество()>0 Тогда
//				//		
//				//		МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
//				//		Если  КолСчетовОбщий = КолСчетовИзОбщейБазы Тогда 
//				//			Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН Тогда
//				//				БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации)-0.01; 							
//				//			КонецЕсли;
//				//			Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН Тогда
//				//				БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации)+0.01; 							
//				//			КонецЕсли;
//				
//				//		КонецЕсли;
//				//		
//				//	иначе
//				//		СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
//				//		СтрТЗКорректировкаКопеек.ФизЛицо = мСтрока.ФизЛицо;
//				//		СтрТЗКорректировкаКопеек.СуммаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
//				//		СтрТЗКорректировкаКопеек.СуммаБГС = 0;
//				//		СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
//				//	КонецЕсли;
//				//	
//				//КонецЕсли;
//			КонецЕсли;
//			
//			//Аверсон 17.08.2020 КВВ СВФР-006325 ( 
//			ЭтоДоговорПодряда = ПроверкаДоговораПодряда(мСтрока.ФизЛицо, ПериодРегистрации);
//			Если ЭтоДоговорПодряда Тогда
//				БазаФСЗНПрошл = БазаФСЗНПрошл + ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН;
//			Иначе
//				//Аверсон 17.08.2020 КВВ СВФР-006325 )
//				БазаФСЗНПрошл = БазаФСЗНПрошл+ ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
//			КонецЕсли;
//			//+ Аверсон СМА 21.05.2020 СВФР-005914
//			//БазаФСЗНПрошл1 = БазаФСЗНПрошл1 + ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН;
//			БазаФСЗНПрошл1 =  ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН
//			// - Аверсон СМА 21.05.2020 СВФР-005914
//			
//		КонецЦикла;
//		БазаФСЗН = БазаФСЗНПрошл;
//		
//		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//			МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//			МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//			Для Каждого стрОбщБаза из МассивОбщаяБазы Цикл //стрОбщБаза.КолСчетов > 1
//				Если  ВыборкаДетальныеЗаписиФСЗНБГС.Количество()=0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда  //стрОбщБаза.СчетНеИзРаспределения <> Неопределено и
//					ЗапросБазаДляРаспр = Новый Запрос;
//					ЗапросБазаДляРаспр.Текст = 
//					"ВЫБРАТЬ
//					|	ЕСНИсчисленный.ФСЗН
//					|ИЗ
//					|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//					|ГДЕ
//					|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//					|	И ЕСНИсчисленный.Организация = &Организация
//					|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//					|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)";
//					ЗапросБазаДляРаспр.УстановитьПараметр("Организация", Организация);
//					ЗапросБазаДляРаспр.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
//					ЗапросБазаДляРаспр.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
//					ЗапросБазаДляРаспр.УстановитьПараметр("ФизЛицо", мСтрока.ФизЛицо);
//					РезБазаДляРаспр = ЗапросБазаДляРаспр.Выполнить().Выгрузить();
//					
//					Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//						Если МассивДляУдельногоВеса[0].КолСчетовСумм+1 = стрОбщБаза.КолСчетов Тогда 
//							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//							БазаПоСчету = 0;
//							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
//								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаФСЗН;
//							КонецЦикла; 
//							
//							СуммаДляРаспр = 0;
//							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
//								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ФСЗН;
//							КонецЦикла;
//							СуммаУжеРаспределенная = ЛОжь;
//							Если МассивДляУдельногоВеса[0].ПроцентыСумм >= 100 Тогда 
//								УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,БазаПоСчету / стрОбщБаза.БазаФСЗН * 100);
//							иначе
//								УдельныйВесДляПропорции = 100-МассивДляУдельногоВеса[0].ПроцентыСумм;
//								СуммаУжеРаспределенная = Истина;
//							КонецЕсли;
//							
//							БазаФСЗН = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//							БазаФСЗН1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//							
//							МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
//								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//							иначе
//								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
//								СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
//								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//							КонецЕсли;
//							
//						иначе
//							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//							БазаПоСчету = 0;
//							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
//								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаФСЗН;
//							КонецЦикла; 
//							
//							//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаФСЗН * 100,ПериодРегистрации));
//							УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,БазаПоСчету / стрОбщБаза.БазаФСЗН * 100);
//							СуммаДляРаспр = 0;
//							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
//								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ФСЗН;
//							КонецЦикла;
//							
//							БазаФСЗН = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//							БазаФСЗН1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//							
//							МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
//								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//							иначе
//								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
//								СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
//								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//							КонецЕсли;
//							
//							
//						КонецЕсли;
//					иначе
//						МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//						БазаПоСчету = 0;
//						Для Каждого стрмассивСтрок из МассивСтрок Цикл 
//							БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаФСЗН;
//						КонецЦикла; 
//						
//						//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаФСЗН * 100,ПериодРегистрации));
//						УдельныйВесДляПропорции = ?(стрОбщБаза.БазаФСЗН=0,0,БазаПоСчету / стрОбщБаза.БазаФСЗН * 100);
//						СуммаДляРаспр = 0;
//						Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
//							СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ФСЗН;
//						КонецЦикла;
//						
//						БазаФСЗН = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//						БазаФСЗН1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//						
//						
//						МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
//							МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//						иначе
//							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВеса.Добавить();
//							СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
//							СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//						КонецЕсли;
//						
//						
//					КонецЕсли;
//					
//					
//					//если БазаФСЗН <> 0 Тогда 
//					//	Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//					//		МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//					//		КолСчетовОбщий = 0;
//					//		Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//					//			УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
//					//			КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
//					//		КонецЕсли;
//					
//					//		МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//					//		Если МассивКорректировкаКопеек.Количество()>0 Тогда
//					//			
//					//			МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
//					//			Если  КолСчетовОбщий = стрОбщБаза.КолСчетов Тогда
//					//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = СуммаДляРаспр Тогда
//					//					БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации)-0.01; 							
//					//				КонецЕсли;
//					//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = СуммаДляРаспр Тогда
//					//					БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации)+0.01; 							
//					//				КонецЕсли;
//					//				
//					//			КонецЕсли;
//					//			
//					//		иначе
//					//			СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
//					//			СтрТЗКорректировкаКопеек.ФизЛицо = мСтрока.ФизЛицо;
//					//			СтрТЗКорректировкаКопеек.СуммаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
//					//			СтрТЗКорректировкаКопеек.СуммаБГС = 0;
//					//			СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
//					//		КонецЕсли;
//					//		
//					//	КонецЕсли;
//					//КонецЕсли;
//					
//					
//				КонецЕсли;
//				
//			КонецЦикла;
//		КонецЕсли;
//		//О.Т. Аверсон 06.04.2017 № 514
//		
//		
//		ПроверкаТаблицы = ОтражениеВБУОбщ.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//		СуммаПроверка = 0;
//		для Каждого стрПроверкаТаблицы из ПроверкаТаблицы Цикл 
//			СуммаПроверка = СуммаПроверка + ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,стрПроверкаТаблицы.БазаФСЗНБУ);
//		КонецЦикла;
//		
//		//О.Т. Аверсон 11.11.2016 № 16
//		ЗапросУчПолитика = Новый Запрос;
//		ЗапросУчПолитика.Текст = 
//		"ВЫБРАТЬ
//		|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтражениеЗарплатыПоВидамРасчета
//		|ИЗ
//		|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
//		|ГДЕ
//		|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
//		ЗапросУчПолитика.УстановитьПараметр("Организация",Организация);
//		РезУчПолитика = ЗапросУчПолитика.Выполнить().Выбрать();
//		ОтражениеПоВидамРасчета = Ложь;
//		пока  РезУчПолитика.Следующий() цикл
//			ОтражениеПоВидамРасчета = РезУчПолитика.ОтражениеЗарплатыПоВидамРасчета; 		
//		КонецЦикла;
//		//О.Т. Аверсон 11.11.2016 № 16
//		
//		КоличествоСтрокПоФизЛицу = 0;
//		если (Организация.ИНН = "191307958" или ОтражениеПоВидамРасчета) и не НалогиИзДокументаРасчетФзносовСФОТ Тогда //О.Т. 11.06.2015 № 
//			КоличествоСтрокПоФизЛицу1 = ОтражениеВБУОбщ.НайтиСтроки(Новый Структура("ФизЛицо,ПериодРегистрации,ВидРасчета",мСтрока.ФизЛицо,мСтрока.ПериодРегистрации,мСтрока.ВидРасчета));
//		Иначе
//			КоличествоСтрокПоФизЛицу1 = ОтражениеВБУОбщ.НайтиСтроки(Новый Структура("ФизЛицо,ПериодРегистрации",мСтрока.ФизЛицо,мСтрока.ПериодРегистрации)); //Островская Татьяна 07.05.2014 № 17239
//		КонецЕсли;
//		для Каждого стрКоличествоСтрокПоФизЛицу из КоличествоСтрокПоФизЛицу1 Цикл 
//			если ТипЗнч(стрКоличествоСтрокПоФизЛицу.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций")  и ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,стрКоличествоСтрокПоФизЛицу.БазаФСЗН) > ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,стрКоличествоСтрокПоФизЛицу.БазаФСЗНБУ) Тогда 
//				ЗапросПодр = Новый Запрос;
//				СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
//				ЗапросПодр.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
//				СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
//				ЗапросПодр.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
//				
//				ЗапросПодр.Текст = 
//				"ВЫБРАТЬ
//				|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
//				|	ВЫБОР
//				|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
//				|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
//				|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
//				|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
//				|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
//				|	КОНЕЦ КАК СубконтоДт1
//				|ИЗ
//				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, ) КАК РаботникиОрганизацийСрезПоследних
//				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
//				|		ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
//				|			И РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
//				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&Период, ) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
//				|		ПО РаботникиОрганизацийСрезПоследних.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
//				|		И РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации //О.Т. 01.09.2015
//				|ГДЕ";
//				если ЗначениеЗаполнено(Сотрудник) Тогда 
//					
//					ЗапросПодр.Текст = ЗапросПодр.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник = &Физлицо";
//					ЗапросПодр.УстановитьПараметр("Физлицо", Сотрудник);
//				иначе
//					ЗапросПодр.Текст = ЗапросПодр.Текст + "	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо = &Физлицо";
//					ЗапросПодр.УстановитьПараметр("Физлицо", стрКоличествоСтрокПоФизЛицу.ФизЛицо);
//				КонецЕсли;
//				ЗапросПодр.УстановитьПараметр("Период", стрКоличествоСтрокПоФизЛицу.ПериодДействия);
//				
//				
//				РезультатЗапроса = ЗапросПодр.Выполнить();
//				
//				ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
//				
//				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
//					
//					если ЗначениеЗаполнено(ВыборкаДетальныеЗаписи.СубконтоДт1) Тогда 
//						Подразделение = ВыборкаДетальныеЗаписи.СубконтоДт1;
//					иначе
//						Подразделение = ВыборкаДетальныеЗаписи.ПодразделениеОрганизации;
//					КонецЕсли;
//					
//				КонецЦикла;
//				
//				если ЗначениеЗаполнено(Подразделение) Тогда 
//					если Подразделение = стрКоличествоСтрокПоФизЛицу.СубконтоДт1 и ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,мСтрока.БазаФСЗН)<>0 Тогда 
//						КоличествоСтрокПоФизЛицу = КоличествоСтрокПоФизЛицу +1;
//					КонецЕсли;
//				КонецЕсли;
//			КонецЕсли;
//			
//			
//		КонецЦикла;
//		
//		СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 26.03.2016 № 950
//		РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//		БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
//		
//		
//		
//		Строка = ПромежуточнаяТаблица.Добавить();
//		
//		Строка.Физлицо = мСтрока.ФизЛицо;              
//		Если ?(НалогиИзДокументаРасчетФзносовСФОТ,БазаФСЗН,мСтрока.БазаФСЗН) <> 0 Тогда  //Аверсон 17.08.2020 КВВ СВФР-006325     //*****
//		//Островская Татьяна 07.05.2014 № 17239
//		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//			Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗН,ПериодРегистрации);
//		Иначе 
//			если КоличествоСтрокПоФизЛицу>1 Тогда 
//				Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(мСтрока.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//			иначе
//				
//				Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(мСтрока.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//			КонецЕсли;
//			
//			//Островская Татьяна 07.05.2014 № 17239
//			
//			//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//			РезультатПоИнвалидам = ПроверкаФизлицоНаИнвалидность(мСтрока.ФизЛицо).Выгрузить();
//			Если РезультатПоИнвалидам.Количество() = 0 Тогда
//				//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//				//Островская Татьяна 07.05.2014 № 17239
//				если КоличествоСтрокПоФизЛицу>1 Тогда 
//					Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(мСтрока.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//				иначе
//					
//					Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(мСтрока.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//				КонецЕсли;
//				//Островская Татьяна 07.05.2014 № 17239
//				
//				//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//			Иначе
//				Если РезультатПоИнвалидам[0].Группа = 1 тогда
//					//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//					//Островская Татьяна 07.05.2014 № 17239
//					если КоличествоСтрокПоФизЛицу>1 Тогда 
//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(мСтрока.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//					иначе
//						
//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(мСтрока.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//					КонецЕсли;
//					//Островская Татьяна 07.05.2014 № 17239
//					
//					//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//					//Сообщить("инвалид: " + ТекСтрокаОтражениеВБУ.ФизЛицо.Наименование);
//				Иначе
//					//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//					//Островская Татьяна 07.05.2014 № 17239
//					если КоличествоСтрокПоФизЛицу>1 Тогда 
//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(мСтрока.БазаФСЗНБУ,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//					иначе
//						
//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(мСтрока.БазаФСЗН,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//					КонецЕсли;
//					//Островская Татьяна 07.05.2014 № 17239
//					
//					//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//				КонецЕсли;
//			КонецЕсли;
//		КонецЕсли;
//		Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
//			Запрос = Новый Запрос;
//			Запрос.Текст = 
//			"ВЫБРАТЬ
//			|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
//			|ИЗ
//			|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//			|ГДЕ
//			|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
//			|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник
//			|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
//			|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2";
//			
//			Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
//			
//			
//			если ЗначениеЗаполнено(Сотрудник) Тогда 
//				
//				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник","И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник");
//				Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
//			иначе
//				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник","И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.ФизЛицо");
//				Запрос.УстановитьПараметр("Сотрудник", мСтрока.ФизЛицо);
//			КонецЕсли;
//			
//			Запрос.УстановитьПараметр("СчетДт",мСтрока.СчетДт);
//			Запрос.УстановитьПараметр("СубконтоДт2",мСтрока.СубконтоДт2);
//			
//			
//			РезультатЗапросаТЗ = Запрос.Выполнить().Выгрузить();
//			
//			Если РезультатЗапросаТЗ.Количество()>0 Тогда
//				Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаФСЗН * ?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0 или СуммаУжеРаспределенная,100,РезультатЗапросаТЗ[0].ДоляСпособаОтражения)/100,ПериодРегистрации);
//			КонецЕсли;
//			
//			
//		КонецЕсли;
//		Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//			МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//			КолСчетовОбщий = 0;
//			Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//				УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
//				КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
//			КонецЕсли;
//			
//			МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//			Если МассивКорректировкаКопеек.Количество()>0 Тогда 
//				
//				МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаФСЗН,ПериодРегистрации);
//				
//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации)
//					или  ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
//					Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаФСЗН,ПериодРегистрации)-0.01; 	
//					МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН -0.01;
//				КонецЕсли;
//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,БазаФСЗН1,СуммаДляРаспр),ПериодРегистрации)
//					или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаФСЗН,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН,СуммаДляРаспр),ПериодРегистрации) Тогда
//					Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаФСЗН,ПериодРегистрации)+0.01; 		
//					МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН +0.01;
//				КонецЕсли;
//				
//				
//				
//			иначе
//				СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
//				СтрТЗКорректировкаКопеек.ФизЛицо = мСтрока.ФизЛицо;
//				СтрТЗКорректировкаКопеек.СуммаФСЗН = Строка.БазаФСЗН;
//				СтрТЗКорректировкаКопеек.СуммаБГС = 0;
//				СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
//				
//				
//			КонецЕсли;
//			
//			//О.Т. Аверсон 31.08.2018 № 2322
//			//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл1),БазаФСЗНПрошл1,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН),СуммаДляРаспр),ПериодРегистрации);
//			СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл),БазаФСЗНПрошл,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН),СуммаДляРаспр),ПериодРегистрации);  //Аверсон 17.08.2020 КВВ СВФР-006325

//			МассивКорректировкаКопеек = ТЗКорректировкаКопеекПоИтогу.НайтиСтроки(Новый Структура("ФизЛицо,СуммаСравненияФСЗН",мСтрока.ФизЛицо,СуммаОбщая));
//			Если МассивКорректировкаКопеек.Количество()>0 Тогда 
//				МассивКорректировкаКопеек[0].СуммаФСЗН = МассивКорректировкаКопеек[0].СуммаФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаФСЗН,ПериодРегистрации);
//			//	МассивКорректировкаКопеек[0].СуммаСравненияФСЗН = МассивКорректировкаКопеек[0].СуммаСравненияФСЗН + ОбщегоНазначения.ОкруглитьЗначение2016(БазаФСЗНПрошл,ПериодРегистрации);  //Аверсон 17.08.2020 КВВ СВФР-006325 //17.08.2020 ЗАКОММ: ОРТО МАРТ ШЕЛЕПКОВ

//				МассивКорректировкаКопеек[0].Субконто1 = мСтрока.СубконтоДт1;
//				МассивКорректировкаКопеек[0].Субконто2 = мСтрока.СубконтоДт2;
//				МассивКорректировкаКопеек[0].Субконто3 = мСтрока.СубконтоДт3;
//				
//				
//			иначе								
//				СтрТЗКорректировкаКопеекПоИтогу = ТЗКорректировкаКопеекПоИтогу.Добавить();
//				СтрТЗКорректировкаКопеекПоИтогу.ФизЛицо = мСтрока.ФизЛицо;
//				СтрТЗКорректировкаКопеекПоИтогу.СуммаФСЗН = Строка.БазаФСЗН;
//				СтрТЗКорректировкаКопеекПоИтогу.СуммаБГС = 0;
//				СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = 0;
//			//	СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = Строка.БазаФСЗН;//Аверсон 14.08.2020 КВВ СВФР-006325 //ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл),БазаФСЗНПрошл,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН),СуммаДляРаспр),ПериодРегистрации); //Аверсон 22.07.2020 КВВ СВФР-006325 (замена БазаФСЗНПрошл1 на БазаФСЗНПрошл)
//				СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БазаФСЗНПрошл),БазаФСЗНПрошл,ВыборкаДетальныеЗаписиФСЗНБГС.ФСЗН),СуммаДляРаспр),ПериодРегистрации);   //Аверсон 17.08.2020 КВВ СВФР-006325
//				СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = 0;
//				СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияЕдиныйПлатеж = 0;
//				СтрТЗКорректировкаКопеекПоИтогу.Субконто1 = мСтрока.СубконтоДт1;
//				СтрТЗКорректировкаКопеекПоИтогу.Субконто2 = мСтрока.СубконтоДт2;
//				СтрТЗКорректировкаКопеекПоИтогу.Субконто3 = мСтрока.СубконтоДт3;
//				
//			КонецЕсли;
//			//О.Т. Аверсон 31.08.2018 № 2322
//			
//			
//		КонецЕсли;
//		КонецЕсли;//*****
//		
//		
//		//Обязательное страхование
//		//О.Т. Аверсон 06.04.2017 № 514
//		Если мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда 
//			ЗапросФСЗНБГС = Новый Запрос;
//			ЗапросФСЗНБГС.Текст = 
//			"ВЫБРАТЬ
//			|	ЕСНИсчисленный.ОбязательноеСтрахование, 100 как ДоляСпособаОтражения
//			|ИЗ
//			|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//			|ГДЕ
//			|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//			|	И ЕСНИсчисленный.Организация = &Организация
//			|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//			|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) > НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ) И ЕСНИсчисленный.ОбязательноеСтрахование <> 0";
//			
//		иначе
//			ЗапросФСЗНБГС = Новый Запрос;
//			ЗапросФСЗНБГС.Текст = 
//			"ВЫБРАТЬ
//			|	ЕСНИсчисленный.ОбязательноеСтрахование,
//			|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
//			|ИЗ
//			|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//			|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
//			|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
//			|			И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, месяц) = НАЧАЛОПЕРИОДА(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации, месяц)
//			|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
//			|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт, 1) = 1)
//			|			И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2
//			|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2, 1) = 1)";
//			//О.Т. Аверсон 19.10.2017 № 1147
//			Если ЗначениеЗаполнено(мСтрока.СубконтоДт1)  Тогда //О.Т. Аверсон 29.08.2018 № 2322 //и не ТипЗнч(мСтрока.СубконтоДт1) = Тип("СправочникСсылка.ПодразделенияОрганизаций")
//				ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + " 
//				|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1
//				|				ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)";
//			КонецЕсли;
//			//О.Т. Аверсон 19.10.2017 № 1147
//			
//			ЗапросФСЗНБГС.Текст = ЗапросФСЗНБГС.Текст + "
//			|ГДЕ
//			|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//			|	И ЕСНИсчисленный.Организация = &Организация
//			|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//			|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
//			|	И ЕСНИсчисленный.ОбязательноеСтрахование <> 0
//			|	И (НЕ &ПодразделениеЗаполнено ИЛИ ЕСНИсчисленный.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)) //Аверсон 13.08.2020 КВВ СВФР-006325
//			|";                                 

//		КонецЕсли;
//		ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
//		ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
//		ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
//		ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо", мСтрока.ФизЛицо);
//		ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",мСтрока.СчетДт);
//		ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт2",мСтрока.СубконтоДт2);
//		ЗапросФСЗНБГС.УстановитьПараметр("СубконтоДт1",мСтрока.СубконтоДт1);
//		
//		ЗапросФСЗНБГС.УстановитьПараметр("ПодразделениеЗаполнено", ЗначениеЗаполнено(ПодразделениеОрганизации)); //Аверсон 13.08.2020 КВВ СВФР-006325
//		ЗапросФСЗНБГС.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);  //Аверсон 13.08.2020 КВВ СВФР-006325
//		
//		РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
//		ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
//		ЕстьПроцент = Ложь;
//		Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл 
//			Если ЗначениеЗаполнено(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) Тогда 
//				ЕстьПроцент = Истина;
//			КонецЕсли;  			
//		КонецЦикла;
//		Если не НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//			ОтражениеВБУДляБазы = Новый ТаблицаЗначений;
//			МассивСтрокПоСчету = Новый Массив;
//		иначе
//			МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//		КонецЕсли;
//		ЭтоОснНач = Ложь;
//		Если МассивСтрокПоСчету.Количество()>0 Тогда 
//			стрМассив = МассивСтрокПоСчету[0]; 
//			ЭтоОснНач = ТипЗнч(стрМассив.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций");
//		КонецЕсли;
//		Если не ЕстьПроцент и ?(Организация.ИНН = "192798722",ЭтоОснНач, Истина) Тогда //и ЭтоОснНач //О.Т. Аверсон 25.03.2019 № 4135
//			ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 = &СубконтоДт1","");
//			ЗапросФСЗНБГС.Текст = СтрЗаменить(ЗапросФСЗНБГС.Текст,"ИЛИ ЕСТЬNULL(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1, 1) = 1)","");
//		КонецЕсли;
//		РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить();   		
//		ВыборкаДетальныеЗаписиФСЗНБГС = РезФСЗНБГС.Выбрать();
//		
//		БГС = 0;
//		БГСПрошл = 0;
//		БГСПрошл1 = 0;
//		ДоляСпособаОтраженияВТаблицеБГС = 0;
//		Пока ВыборкаДетальныеЗаписиФСЗНБГС.Следующий() Цикл
//			
//			если ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование <> 0 Тогда
//				КолСчетовИзОбщейБазы = 0;
//				МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//				Если МассивОбщаяБазы.Количество()>0 Тогда 
//					КолСчетовИзОбщейБазы = МассивОбщаяБазы[0].КолСчетов;
//					Если МассивОбщаяБазы[0].СчетНеИзРаспределения <> Неопределено Тогда 
//						МассивСтрокПоСчету = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//						БазаОбщаяБГС = 0;
//						
//						ПроверкаПериодДействияПрошл = "";
//						ПроверкаБазаБГСПрошл = "";
//						ПроверкаБазаБГСНУПрошл = "";
//						Для Каждого стрМассив из МассивСтрокПоСчету Цикл
//							Если стрМассив.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда Тогда //О.Т. Аверсон 30.08.2018 № 2322
//								ПроверкаКолСчетов = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета",мСтрока.ФизЛицо,ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда));
//								КолСчетовПоДог = 0;
//								СчетПрошл = "";
//								Для Каждого стр из ПроверкаКолСчетов Цикл 
//									Если СчетПрошл <> стр.СчетДт Тогда 
//										КолСчетовПоДог = КолСчетовПоДог+1;
//									КонецЕсли;   									
//									СчетПрошл = стр.СчетДт;
//								КонецЦикла;
//								Если КолСчетовПоДог>1 Тогда 
//									Если ПроверкаПериодДействияПрошл <> стрМассив.ПериодДействия и ПроверкаБазаБГСПрошл <> стрМассив.БазаСтрах и ПроверкаБазаБГСНУПрошл = стрМассив.БазаСтрахБУ Тогда 
//										Продолжить;
//									КонецЕсли;     																
//								КонецЕсли;
//								
//								Если КолСчетовПоДог>1 Тогда 
//									БазаОбщаяБГС = БазаОбщаяБГС + стрМассив.БазаСтрахБУ;
//								иначе
//									БазаОбщаяБГС = БазаОбщаяБГС + стрМассив.БазаСтрах;
//								КонецЕсли;
//								ПроверкаПериодДействияПрошл = стрМассив.ПериодДействия; 
//								ПроверкаБазаБГСПрошл = стрМассив.БазаСтрах;
//								ПроверкаБазаБГСНУПрошл = стрМассив.БазаСтрахБУ;
//							иначе
//								БазаОбщаяБГС = БазаОбщаяБГС + стрМассив.БазаСтрах;
//							КонецЕсли;  
//							
//						КонецЦикла;  
//						//БазаОбщаяБГС = БазаОбщаяБГС * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//						
//						//УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаБГС=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаОбщаяБГС / МассивОбщаяБазы[0].БазаБГС * 100,ПериодРегистрации));
//						УдельныйВесДляПропорции = ?(МассивОбщаяБазы[0].БазаБГС=0,0,БазаОбщаяБГС / МассивОбщаяБазы[0].БазаБГС * 100);
//						
//						
//						БГС1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * УдельныйВесДляПропорции / 100;
//						БГС = БГС1 * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//						
//						ДоляСпособаОтраженияВТаблицеБГС = ДоляСпособаОтраженияВТаблицеБГС + ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//						
//						Если МассивОбщаяБазы[0].БазаБГС = 0 и БазаОбщаяБГС = 0 Тогда 
//							МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//							Если МассивДляУдельногоВеса.Количество()>0 Тогда
//								Если МассивДляУдельногоВеса[0].ПроцентыСумм <> 100 Тогда 
//									БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//									УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//								КонецЕсли;
//							иначе
//								БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//								УдельныйВесДляПропорции = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//							КонецЕсли;
//						КонецЕсли;
//						
//						МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//							
//							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
//							Если БГСПрошл = 0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//							КонецЕсли;
//						иначе
//							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
//							СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
//							Если БГСПрошл = 0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда 
//								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//							КонецЕсли;
//						КонецЕсли;
//					иначе
//						БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//						БГС1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//						
//						МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//							
//							МассивДляУдельногоВеса[0].ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения); 
//							Если БГСПрошл = 0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//							КонецЕсли;
//						иначе
//							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
//							СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения);
//							Если БГСПрошл = 0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда 
//								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//							КонецЕсли;
//						КонецЕсли;
//					КонецЕсли;
//					
//					
//				иначе
//					БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//					БГС1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//					
//				КонецЕсли;
//				Если мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//					БГС = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//					БГС1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование * ?(ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения=null,100,ВыборкаДетальныеЗаписиФСЗНБГС.ДоляСпособаОтражения) / 100;
//				КонецЕсли;
//				
//				
//				
//				//Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//				//	МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//				//	КолСчетовОбщий = 0;
//				//	Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//				//		УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
//				//		КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
//				//	КонецЕсли;
//				//	
//				//	МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//				//	Если МассивКорректировкаКопеек.Количество()>0 Тогда
//				//		
//				//		МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
//				//		Если  КолСчетовОбщий = КолСчетовИзОбщейБазы Тогда 
//				//			Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование Тогда
//				//				БГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации)-0.01; 							
//				//			КонецЕсли;
//				//			Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование Тогда
//				//				БГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации)+0.01; 							
//				//			КонецЕсли;
//				//		КонецЕсли;
//				//		
//				//	иначе
//				//		СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
//				//		СтрТЗКорректировкаКопеек.ФизЛицо = мСтрока.ФизЛицо;
//				//		СтрТЗКорректировкаКопеек.СуммаБГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
//				//		СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
//				//		СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
//				//	КонецЕсли;
//				
//				//КонецЕсли;
//			КонецЕсли;
//			//Аверсон 17.08.2020 КВВ СВФР-006325 ( 
//			ЭтоДоговорПодряда = ПроверкаДоговораПодряда(мСтрока.ФизЛицо, ПериодРегистрации);
//			Если ЭтоДоговорПодряда Тогда
//				БГСПрошл =  БГСПрошл + ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование;
//			Иначе
//				//Аверсон 17.08.2020 КВВ СВФР-006325 )
//				БГСПрошл = БГСПрошл + ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
//			КонецЕсли;
//			//+ Аверсон СМА 21.05.2020 СВФР-005914
//			//БГСПрошл1 = БГСПрошл1 +ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование;
//			БГСПрошл1 = ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование;
//			//- Аверсон СМА 21.05.2020 СВФР-005914
//		КонецЦикла;
//		БГС = БГСПрошл;
//		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//			МассивОбщаяБазы = ТЗОбщаяБазы.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//			МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//			Для Каждого стрОбщБаза из МассивОбщаяБазы Цикл //стрОбщБаза.КолСчетов > 1
//				Если ВыборкаДетальныеЗаписиФСЗНБГС.Количество()=0 и не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда //стрОбщБаза.СчетНеИзРаспределения <> Неопределено и 
//					ЗапросБазаДляРаспр = Новый Запрос;
//					ЗапросБазаДляРаспр.Текст = 
//					"ВЫБРАТЬ
//					|	ЕСНИсчисленный.ОбязательноеСтрахование
//					|ИЗ
//					|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//					|ГДЕ
//					|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//					|	И ЕСНИсчисленный.Организация = &Организация
//					|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//					|	И НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) <= НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)";
//					ЗапросБазаДляРаспр.УстановитьПараметр("Организация", Организация);
//					ЗапросБазаДляРаспр.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
//					ЗапросБазаДляРаспр.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
//					ЗапросБазаДляРаспр.УстановитьПараметр("ФизЛицо", мСтрока.ФизЛицо);
//					РезБазаДляРаспр = ЗапросБазаДляРаспр.Выполнить().Выгрузить();
//					
//					Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//						Если МассивДляУдельногоВеса[0].КолСчетовСумм+1 = стрОбщБаза.КолСчетов Тогда 
//							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//							БазаПоСчету = 0;
//							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
//								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаСтрах;
//							КонецЦикла;
//							
//							СуммаДляРаспр = 0;
//							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
//								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ОбязательноеСтрахование;
//							КонецЦикла;
//							СуммаУжеРаспределенная = Ложь;
//							Если МассивДляУдельногоВеса[0].ПроцентыСумм >= 100 Тогда 
//								УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС=0,0,БазаПоСчету / стрОбщБаза.БазаБГС * 100);
//							иначе
//								УдельныйВесДляПропорции = 100-МассивДляУдельногоВеса[0].ПроцентыСумм;
//								СуммаУжеРаспределенная = Истина;
//							КонецЕсли;
//							
//							БГС = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//							БГС1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//							
//							
//							МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
//								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//							иначе
//								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
//								СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
//								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//							КонецЕсли;
//							
//							
//						иначе
//							МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//							БазаПоСчету = 0;
//							Для Каждого стрмассивСтрок из МассивСтрок Цикл 
//								БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаСтрах;
//							КонецЦикла; 
//							
//							//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС=0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаБГС * 100,ПериодРегистрации));
//							УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС=0,0,БазаПоСчету / стрОбщБаза.БазаБГС * 100);
//							СуммаДляРаспр = 0;
//							Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
//								СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ОбязательноеСтрахование;
//							КонецЦикла;
//							
//							БГС = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//							БГС1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//							
//							
//							МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//							Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//								МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
//								МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//							иначе
//								СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
//								СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//								СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
//								СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//							КонецЕсли;
//							
//							
//						КонецЕсли;
//					иначе
//						МассивСтрок = ОтражениеВБУДляБазы.НайтиСтроки(Новый Структура("ФизЛицо,СчетДт,СубконтоДт1,СубконтоДт2,СубконтоДт3",мСтрока.ФизЛицо,мСтрока.СчетДт,мСтрока.СубконтоДт1,мСтрока.СубконтоДт2,мСтрока.СубконтоДт3));
//						БазаПоСчету = 0;
//						Для Каждого стрмассивСтрок из МассивСтрок Цикл 
//							БазаПоСчету = БазаПоСчету + стрмассивСтрок.БазаСтрах;
//						КонецЦикла; 
//						
//						//УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС = 0,0,ОбщегоНазначения.ОкруглитьЗначение2016(БазаПоСчету / стрОбщБаза.БазаБГС * 100,ПериодРегистрации));
//						УдельныйВесДляПропорции = ?(стрОбщБаза.БазаБГС = 0,0,БазаПоСчету / стрОбщБаза.БазаБГС * 100);
//						СуммаДляРаспр = 0;
//						Для Каждого стрБазаРаспр из РезБазаДляРаспр Цикл 
//							СуммаДляРаспр = СуммаДляРаспр + стрБазаРаспр.ОбязательноеСтрахование;
//						КонецЦикла;
//						
//						БГС = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//						БГС1 = СуммаДляРаспр * УдельныйВесДляПропорции / 100;
//						
//						
//						
//						МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//						Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//							МассивДляУдельногоВеса[0].ПроцентыСумм = МассивДляУдельногоВеса[0].ПроцентыСумм + УдельныйВесДляПропорции; 
//							МассивДляУдельногоВеса[0].КолСчетовСумм = ?(МассивДляУдельногоВеса[0].КолСчетовСумм= Неопределено,0,МассивДляУдельногоВеса[0].КолСчетовСумм)+1;
//						иначе
//							СтрТЗДляУдельногоВеса = ТЗДляУдельногоВесаБГС.Добавить();
//							СтрТЗДляУдельногоВеса.ФизЛицо = мСтрока.ФизЛицо;
//							СтрТЗДляУдельногоВеса.ПроцентыСумм = ?(СтрТЗДляУдельногоВеса.ПроцентыСумм = Неопределено,0,СтрТЗДляУдельногоВеса.ПроцентыСумм)+ УдельныйВесДляПропорции;
//							СтрТЗДляУдельногоВеса.КолСчетовСумм = ?(СтрТЗДляУдельногоВеса.КолСчетовСумм= Неопределено,0,СтрТЗДляУдельногоВеса.КолСчетовСумм)+1;
//						КонецЕсли;
//						
//						
//					КонецЕсли;
//					
//					
//					//если БГС <> 0 Тогда 
//					//	Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//					//		МассивДляУдельногоВеса = ТЗДляУдельногоВесаБГС.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//					//		КолСчетовОбщий = 0;
//					//		Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//					//			УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
//					//			КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
//					//		КонецЕсли;
//					//		
//					//		МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//					//		Если МассивКорректировкаКопеек.Количество()>0 Тогда
//					//			
//					//			МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
//					//			если  КолСчетовОбщий = стрОбщБаза.КолСчетов Тогда 
//					//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = СуммаДляРаспр Тогда
//					//					БГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации)-0.01; 							
//					//				КонецЕсли;
//					//				Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = СуммаДляРаспр Тогда
//					//					БГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации)+0.01; 							
//					//				КонецЕсли;
//					//				
//					//			КонецЕсли;
//					//			
//					//		иначе
//					//			СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
//					//			СтрТЗКорректировкаКопеек.ФизЛицо = мСтрока.ФизЛицо;
//					//			СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
//					//			СтрТЗКорректировкаКопеек.СуммаБГС = ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
//					//			СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
//					//		КонецЕсли;
//					//		
//					//	КонецЕсли;
//					//КонецЕсли;
//					
//					
//				КонецЕсли;
//				
//			КонецЦикла;
//		КонецЕсли;
//		
//		//О.Т. Аверсон 06.04.2017 № 514
//		
//		Если ?(НалогиИзДокументаРасчетФзносовСФОТ,БГС,мСтрока.БазаСтрах) <> 0 Тогда
//			//Строка = ПромежуточнаяТаблица.Добавить();
//			//О.Т. 02.03.2015 № 17778
//			//если КоличествоСтрокПоФизЛицу>1 Тогда
//			//	Строка.БазаСтрах			= Окр(мСтрока.БазаСтрахБУ* СтавкаСтрах / 100);
//			//иначе
//			Если НалогиИзДокументаРасчетФзносовСФОТ Тогда 
//				Строка.БазаСтрах			= ОбщегоНазначения.ОкруглитьЗначение2016(БГС,ПериодРегистрации);
//			иначе                                                                                                                            				
//				Строка.БазаСтрах			= ОбщегоНазначения.ОкруглитьЗначение2016(мСтрока.БазаСтрах* СтавкаСтрах / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//			КонецЕсли;
//			//КонецЕсли;
//			Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.Вспомогательный Тогда
//				Запрос = Новый Запрос;
//				Запрос.Текст = 
//				"ВЫБРАТЬ
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения
//				|ИЗ
//				|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//				|ГДЕ
//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
//				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник
//				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт
//				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 = &СубконтоДт2";
//				
//				Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
//				
//				
//				если ЗначениеЗаполнено(Сотрудник) Тогда 
//					
//					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник","И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник");
//					Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
//				иначе
//					Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник","И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.ФизЛицо");
//					Запрос.УстановитьПараметр("Сотрудник", мСтрока.ФизЛицо);
//				КонецЕсли;
//				
//				Запрос.УстановитьПараметр("СчетДт",мСтрока.СчетДт);
//				Запрос.УстановитьПараметр("СубконтоДт2",мСтрока.СубконтоДт2);
//				
//				
//				РезультатЗапросаТЗ = Запрос.Выполнить().Выгрузить();
//				
//				Если РезультатЗапросаТЗ.Количество()>0 Тогда
//					Строка.БазаСтрах = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаСтрах * ?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0 или СуммаУжеРаспределенная,100,РезультатЗапросаТЗ[0].ДоляСпособаОтражения)/100,ПериодРегистрации);
//				КонецЕсли;
//				
//				
//			КонецЕсли;
//			Если не мСтрока.СчетДт = ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов Тогда
//				МассивДляУдельногоВеса = ТЗДляУдельногоВеса.НайтиСтроки(Новый Структура("ФизЛицо", мСтрока.ФизЛицо));
//				КолСчетовОбщий = 0;
//				Если МассивДляУдельногоВеса.Количество()>0 Тогда 
//					УдельныйВесОбщий = МассивДляУдельногоВеса[0].ПроцентыСумм;
//					КолСчетовОбщий = МассивДляУдельногоВеса[0].КолСчетовСумм;
//				КонецЕсли;
//				
//				МассивКорректировкаКопеек = ТЗКорректировкаКопеек.НайтиСтроки(Новый Структура("ФизЛицо",мСтрока.ФизЛицо));
//				Если МассивКорректировкаКопеек.Количество()>0 Тогда 
//					
//					МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаСтрах,ПериодРегистрации);
//					
//					Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,БГС1,СуммаДляРаспр),ПериодРегистрации)
//						или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)-0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование,СуммаДляРаспр),ПериодРегистрации) Тогда
//						Строка.БазаСтрах = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаСтрах,ПериодРегистрации)-0.01; 	
//						МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС -0.01;
//					КонецЕсли;
//					Если ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,БГС1,СуммаДляРаспр),ПериодРегистрации)
//						или ОбщегоНазначения.ОкруглитьЗначение2016(МассивКорректировкаКопеек[0].СуммаБГС,ПериодРегистрации)+0.01 = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование,СуммаДляРаспр),ПериодРегистрации) Тогда
//						Строка.БазаСтрах = ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаСтрах,ПериодРегистрации)+0.01; 	
//						МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС +0.01;
//					КонецЕсли;
//					
//				иначе
//					СтрТЗКорректировкаКопеек = ТЗКорректировкаКопеек.Добавить();
//					СтрТЗКорректировкаКопеек.ФизЛицо = мСтрока.ФизЛицо;
//					СтрТЗКорректировкаКопеек.СуммаФСЗН = 0;
//					СтрТЗКорректировкаКопеек.СуммаБГС = Строка.БазаСтрах;
//					СтрТЗКорректировкаКопеек.СуммаЕдиныйПлатеж = 0;
//					
//				КонецЕсли;
//				
//				//О.Т. Аверсон 31.08.2018 № 2322
//				//СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл1),БГСПрошл1,ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование),СуммаДляРаспр),ПериодРегистрации);
//				СуммаОбщая = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование),СуммаДляРаспр),ПериодРегистрации);//Аверсон 17.08.2020 КВВ СВФР-006325
//				МассивКорректировкаКопеек = ТЗКорректировкаКопеекПоИтогу.НайтиСтроки(Новый Структура("ФизЛицо,СуммаСравненияБГС",мСтрока.ФизЛицо,СуммаОбщая));
//				Если МассивКорректировкаКопеек.Количество()>0 Тогда 
//					МассивКорректировкаКопеек[0].СуммаБГС = МассивКорректировкаКопеек[0].СуммаБГС + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаСтрах,ПериодРегистрации);
//				//	МассивКорректировкаКопеек[0].СуммаСравненияБГС = МассивКорректировкаКопеек[0].СуммаСравненияБГС + ОбщегоНазначения.ОкруглитьЗначение2016(Строка.БазаСтрах,ПериодРегистрации); //Аверсон 14.08.2020 КВВ СВФР-006325
//				//	МассивКорректировкаКопеек[0].СуммаСравненияБГС = МассивКорректировкаКопеек[0].СуммаСравненияБГС + ОбщегоНазначения.ОкруглитьЗначение2016(БГСПрошл,ПериодРегистрации); //Аверсон 17.08.2020 КВВ СВФР-006325  //17.08.2020 ЗАКОММ: ОРТО МАРТ ШЕЛЕПКОВ
//					МассивКорректировкаКопеек[0].Субконто1 = мСтрока.СубконтоДт1;
//					МассивКорректировкаКопеек[0].Субконто2 = мСтрока.СубконтоДт2;
//					МассивКорректировкаКопеек[0].Субконто3 = мСтрока.СубконтоДт3;
//					
//					
//				иначе								
//					СтрТЗКорректировкаКопеекПоИтогу = ТЗКорректировкаКопеекПоИтогу.Добавить();
//					СтрТЗКорректировкаКопеекПоИтогу.ФизЛицо = мСтрока.ФизЛицо;
//					СтрТЗКорректировкаКопеекПоИтогу.СуммаБГС = Строка.БазаСтрах;
//					СтрТЗКорректировкаКопеекПоИтогу.СуммаФСЗН = 0;
//					СтрТЗКорректировкаКопеекПоИтогу.СуммаЕдиныйПлатеж = 0;
//					СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияФСЗН = 0;
//					СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияБГС = ОбщегоНазначения.ОкруглитьЗначение2016(?(ВыборкаДетальныеЗаписиФСЗНБГС.Количество()>0,?(ЗначениеЗаполнено(БГСПрошл),БГСПрошл,ВыборкаДетальныеЗаписиФСЗНБГС.ОбязательноеСтрахование),СуммаДляРаспр),ПериодРегистрации); //Аверсон 23.07.2020 КВВ СВФР-006325 (замена БГСПрошл1 на БГСПрошл)
//					СтрТЗКорректировкаКопеекПоИтогу.СуммаСравненияЕдиныйПлатеж = 0;
//					СтрТЗКорректировкаКопеекПоИтогу.Субконто1 = мСтрока.СубконтоДт1;
//					СтрТЗКорректировкаКопеекПоИтогу.Субконто2 = мСтрока.СубконтоДт2;
//					СтрТЗКорректировкаКопеекПоИтогу.Субконто3 = мСтрока.СубконтоДт3;
//					
//				КонецЕсли;
//				//О.Т. Аверсон 31.08.2018 № 2322
//				
//				
//			КонецЕсли;
//			
//		КонецЕсли;
//		
//		//О.Т. 18.09.2014 № 224
//		//Доплата
//		Запрос = Новый Запрос;
//		Запрос.Текст = 
//		"ВЫБРАТЬ
//		|	ЕСНИсчисленный.ПериодВзаиморасчетов,
//		|	ЕСНИсчисленный.ФизЛицо,
//		|	СУММА(ЕСНИсчисленный.Доплата) КАК Доплата
//		|ИЗ
//		|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//		|ГДЕ
//		|	ЕСНИсчисленный.Период = &ПериодВзаиморасчетов
//		|	И ЕСНИсчисленный.Организация = &Организация
//		|	И ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//		|
//		|СГРУППИРОВАТЬ ПО
//		|	ЕСНИсчисленный.ПериодВзаиморасчетов,
//		|	ЕСНИсчисленный.ФизЛицо";
//		
//		Запрос.УстановитьПараметр("Организация", Организация);
//		Запрос.УстановитьПараметр("ПериодВзаиморасчетов", ПериодРегистрации);
//		Запрос.УстановитьПараметр("ФизЛицо", мСтрока.ФизЛицо);
//		
//		Результат = Запрос.Выполнить();
//		
//		ВыборкаДетальныеЗаписи = Результат.Выбрать();
//		
//		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
//			
//			Если ВыборкаДетальныеЗаписи.Доплата > 0 и не (ВыборкаДетальныеЗаписи.Доплата = Null или ВыборкаДетальныеЗаписи.Доплата = Неопределено) Тогда
//				ЭлементСЗ = СЗДляДоплаты.НайтиСтроки(новый Структура("ФизЛицо,Период",мСтрока.ФизЛицо,ПериодРегистрации));
//				если ЭлементСЗ.Количество()>0 Тогда 
//					Продолжить;
//				КонецЕсли;
//				если мСтрока.БазаСтрах = 0 Тогда 
//					Строка = ПромежуточнаяТаблица.Добавить();
//				КонецЕсли;
//				
//				Строка.БазаСтрах			= ?(?(НалогиИзДокументаРасчетФзносовСФОТ,БГС,Строка.БазаСтрах)=Неопределено,0,?(НалогиИзДокументаРасчетФзносовСФОТ,БГС,Строка.БазаСтрах)) + ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаДетальныеЗаписи.Доплата,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//			КонецЕсли;
//		КонецЦикла;
//		СтрСЗДляДоплаты = СЗДляДоплаты.Добавить();
//		СтрСЗДляДоплаты.ФизЛицо = мСтрока.ФизЛицо;
//		СтрСЗДляДоплаты.Период = ПериодРегистрации;//О.Т. 02.03.2015 № 17778
//		//О.Т. 18.09.2014 № 224
//		
//		
//		
//	КонецЦикла;
//	//ПромежуточнаяТаблица.Свернуть("","БазаФСЗН");
//	
//	
//	ТЗКорректировкаКопеекПоИтогу.Свернуть("ФизЛицо,Субконто1,Субконто2,Субконто3","СуммаФСЗН,СуммаБГС,СуммаЕдиныйПлатеж,СуммаСравненияФСЗН,СуммаСравненияБГС,СуммаСравненияЕдиныйПлатеж");
//	Для Каждого стр из ТЗКорректировкаКопеекПоИтогу Цикл 
//		Если стр.СуммаФСЗН <> стр.СуммаСравненияФСЗН Тогда 
//			КолКопеекНеСовпадения = стр.СуммаФСЗН - стр.СуммаСравненияФСЗН;
//			СчетКт69 = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
//			Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;
//			МассивПромТаблица = ПромежуточнаяТаблица.НайтиСтроки(Новый Структура("ФизЛицо",стр.ФизЛицо));
//			Если МассивПромТаблица.Количество()>0 Тогда 
//				МассивПромТаблица[0].БазаФСЗН = МассивПромТаблица[0].БазаФСЗН - КолКопеекНеСовпадения;
//			КонецЕсли;
//		КонецЕсли;
//		Если стр.СуммаБГС <> стр.СуммаСравненияБГС Тогда 
//			КолКопеекНеСовпадения = стр.СуммаБГС - стр.СуммаСравненияБГС;
//			СчетКт69 = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",
//			Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).СчетБУ;
//			МассивПромТаблица = ПромежуточнаяТаблица.НайтиСтроки(Новый Структура("ФизЛицо",стр.ФизЛицо));
//			Если МассивПромТаблица.Количество()>0 Тогда 
//				МассивПромТаблица[0].БазаСтрах = МассивПромТаблица[0].БазаСтрах - КолКопеекНеСовпадения;
//			КонецЕсли;
//		КонецЕсли;
//		
//	КонецЦикла;
//	
//	
//	//ФСЗН
//	зПрибыль = Новый Запрос;
//	зПрибыль.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("СпособРаспределенияПрибыли", Перечисления.СпособыРаспределенияПрибыли.СчетПрибыли);
//	//СчетФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации,
//	//Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).СчетБУ;
//	//зПрибыль.УстановитьПараметр("СчетКт", СчетФСЗН);
//	
//	зПрибыль.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("СпособРаспределенияПрибыли", Перечисления.СпособыРаспределенияПрибыли.РаспределятьПрибыль);
//	//зПрибыль.УстановитьПараметр("СчетКт", СчетФСЗН);
//	зПрибыль.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("СпособРаспределенияПрибыли", Перечисления.СпособыРаспределенияПрибыли.СчетПрибыли);
//	СчетБГС = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации,
//	Новый Структура("Организация", Организация)).СчетБУ; //О.Т. Аверсон 30.03.2016 № не используется
//	зПрибыль.УстановитьПараметр("СчетКт", СчетБГС);
//	зПрибыль.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("СпособРаспределенияПрибыли", Перечисления.СпособыРаспределенияПрибыли.РаспределятьПрибыль);
//	зПрибыль.УстановитьПараметр("СчетКт", СчетБГС);
//	//СчетФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации,
//	//Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН));
//	//СчетБГС = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации,
//	//Новый Структура("Организация", Организация));
//	
//	
//	//прошлый период  
//	ПенсФондБудМес = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца)).размер;
//	зПрибыль = Новый Запрос;
//	зПрибыль.Текст = 
//	"ВЫБРАТЬ
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетКт,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКт1,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКт2,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКт3,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДтНУ,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ1,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ2,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ3,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетКтНУ,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКтНУ1,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКтНУ2,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКтНУ3,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетКтУСН,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ОтражениеВУСН,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Результат,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ПериодДействияНачало,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.ПериодРегистрации КАК Месяц,
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник
//	|ИЗ
//	|	Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
//	|ГДЕ
//	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ПериодДействияНачало МЕЖДУ &НачДата И &КонДата
//	//+ СВЭЙ КДЯ 05.06.19 СВФР-004427
//	|	И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.ПодразделениеОрганизации = &ПодразделениеОрганизации
//	//- СВЭЙ КДЯ 05.06.19 СВФР-004427
//	|	И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.Проведен = ИСТИНА
//	|	И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.ПериодРегистрации < &НачДата
//	|	И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)";
//	
//	зПрибыль.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
//	зПрибыль.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
//	
//	//+ СВЭЙ КДЯ 05.06.19 СВФР-004427
//	зПрибыль.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
//	//- СВЭЙ КДЯ 05.06.19 СВФР-004427
//	
//	тзПереходящиеОтпуска = зПрибыль.Выполнить().Выгрузить();
//	
//	//+ СВЭЙ КДЯ СВФР-004427 06.06.19
//	//если ПенсФондБудМес = 1 Тогда 
//	//	//Аверсон-софт, Островская Татьяна 27.06.2012 № 15548
//	//	ЗапросСтатья = Новый Запрос;
//	//	ЗапросСтатья.Текст = 
//	//	"ВЫБРАТЬ
//	//	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация,
//	//	|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваФСЗН3,
//	//	|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваСтрах3
//	//	|ИЗ
//	//	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
//	//	|ГДЕ
//	//	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
//	//	ЗапросСтатья.УстановитьПараметр("Организация",Организация);
//	//	Рез = ЗапросСтатья.Выполнить().Выбрать();
//	//	СтатьяЗатратФСЗН = Неопределено;
//	//	СтатьяЗатратСтрах = Неопределено;
//	//	пока  Рез.Следующий() цикл
//	//		СтатьяЗатратФСЗН = Рез.СубконтоРезерваФСЗН3;
//	//		СтатьяЗатратСтрах = Рез.СубконтоРезерваСтрах3;
//	//		
//	//	КонецЦикла;
//	//	
//	//	
//	//	Для Каждого стр из тзПереходящиеОтпуска Цикл 
//	//		
//	//		//О.Т. Аверсон 26.03.2016 № 950
//	//		ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
//	//		Если стр.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
//	//			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
//	//		иначе
//	//			ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
//	//		КонецЕсли;
//	
//	//		ЗапросИндСтавкаНалогообл = Новый Запрос;
//	//		ЗапросИндСтавкаНалогообл.Текст = 
//	//		"ВЫБРАТЬ
//	//		|	ИноеНалогообложениеПоСотрудникамСрезПоследних.БГС,
//	//		|	ИноеНалогообложениеПоСотрудникамСрезПоследних.ФСЗН
//	//		|ИЗ
//	//		|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
//	//		|			&Период,
//	//		|			Организация = &Организация
//	//		|				И ВидНалогообложения = &ВидНалогообложения
//	//		|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
//	//		
//	//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
//	//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
//	//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
//	//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Стр.Сотрудник); 
//	//		РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
//	//		ЕстьИндивидСтавка = Ложь;
//	//		СтавкаФСЗНИнд = 0;
//	//		СтавкаБГСИнд = 0;
//	//		Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
//	//			ЕстьИндивидСтавка = Истина;
//	//			СтавкаФСЗНИнд = РезИндСтавкаНалогообл[0].ФСЗН;
//	//			СтавкаБГСИнд = РезИндСтавкаНалогообл[0].БГС;
//	//		КонецЕсли;
//	//		
//	//		Если ЕстьИндивидСтавка Тогда 
//	//			СчетФСЗН = СтавкаФСЗНИнд;
//	//			СчетБГС = СтавкаБГСИнд;
//	//		иначе
//	//			СчетФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации,
//	//			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).Размер;
//	//			СчетБГС = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации,
//	//			Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Ставка;
//	//		КонецЕсли;   
//	//		//О.Т. Аверсон 25.03.2016 № 950
//	//		
//	//		Результат = стр.Результат;
//	//		если ПенсФондБудМес = 0 тогда
//	//			РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(ПериодРегистрации)) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//	//			//РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(стр.Месяц)) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//	//			СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(стр.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 26.03.2016 № 950
//	//		иначе
//	//			РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(ПериодРегистрации)) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//	//			СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 26.03.2016 № 950
//	//		КонецЕсли;
//	//		
//	//		ПенсФондБудМес = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца)).размер;
//	//		//Островская Татьяна 23.04.2013 № 16 ФСЗН ограничения
//	//		
//	//		БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
//	//		ЗапросОгр = Новый Запрос;
//	//		ЗапросОгр.Текст = 
//	//		"ВЫБРАТЬ
//	//		|	ВложенныйЗапрос.ФизЛицо,
//	//		|	СУММА(ВложенныйЗапрос.Результат) КАК Результат
//	//		|ИЗ
//	//		|	(ВЫБРАТЬ
//	//		|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ФизЛицо КАК ФизЛицо,
//	//		|		СУММА(ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Результат) КАК Результат
//	//		|	ИЗ
//	//		|		Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
//	//		|	ГДЕ
//	//		|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ФизЛицо = &ФизЛицо
//	//		|		И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка = &Ссылка
//	//		|		И (ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяПолностью)
//	//		|				ИЛИ ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиЕП)
//	//		|				ИЛИ ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗН)
//	//		|				ИЛИ ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиСТРАХ))
//	//		|			И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ПериодДействияНачало <= &ПериодДействияНачало
//	//		|	СГРУППИРОВАТЬ ПО
//	//		|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ФизЛицо
//	//		|	
//	//		|	ОБЪЕДИНИТЬ ВСЕ
//	//		|	
//	//		|	ВЫБРАТЬ
//	//		|		ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ФизЛицо,
//	//		|		СУММА(ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Результат)
//	//		|	ИЗ
//	//		|		Документ.ОтражениеЗарплатыВРеглУчете.ДополнительныеНачисления КАК ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления
//	//		|	ГДЕ
//	//		|		ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ФизЛицо = &ФизЛицо
//	//		|		И ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка = &Ссылка
//	//		|		И (ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяПолностью)
//	//		|				ИЛИ ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиЕП)
//	//		|				ИЛИ ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗН)
//	//		|				ИЛИ ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиСТРАХ))
//	//		|	
//	//		|	СГРУППИРОВАТЬ ПО
//	//		|		ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.ФизЛицо) КАК ВложенныйЗапрос
//	//		|
//	//		|СГРУППИРОВАТЬ ПО
//	//		|	ВложенныйЗапрос.ФизЛицо";
//	//		ЗапросОгр.УстановитьПараметр("Ссылка",Ссылка);
//	//		ЗапросОгр.УстановитьПараметр("ФизЛицо",стр.СубконтоКт1);
//	//		ЗапросОгр.УстановитьПараметр("ПериодДействияНачало",КонецМесяца(ПериодРегистрации));	
//	//		РезЗапрос = ЗапросОгр.Выполнить().Выбрать();
//	//		СуммаФСЗННеВыводить = Ложь;
//	//		пока РезЗапрос.Следующий() Цикл 
//	//			если РезЗапрос.Результат+Стр.Результат > БазаОграниченияФСЗН Тогда  
//	//				если РезЗапрос.Результат > БазаОграниченияФСЗН Тогда
//	//					СуммаФСЗННеВыводить = Истина;
//	//				иначе
//	//					если БазаОграниченияФСЗН-Стр.Результат > БазаОграниченияФСЗН Тогда		
//	//						СуммаФСЗННеВыводить = Истина;
//	//					иначе
//	//						если ПенсФондБудМес = 0 тогда
//	//							Результат =Стр.Результат; //мин(мСтрока.Результат,РезПерех);
//	//						иначе
//	//							РезПерех = БазаОграниченияФСЗН - РезЗапрос.Результат ;
//	//							Результат =мин(Стр.Результат,РезПерех);
//	//						КонецЕсли;
//	//					КонецЕсли;	
//	//				КонецЕсли;	
//	//			КонецЕсли;
//	//		КонецЦикла;
//	
//	
//	//		
//	//		если ПенсФондБудМес = 0 тогда
//	//			//ФСЗН
//	//			//если не СуммаФСЗННеВыводить Тогда //Островская Татьяна 24.04.2013 № 16 ФСЗН ограничения
//	//			Строка = ПромежуточнаяТаблица.Добавить();
//	//			
//	//			Строка.Физлицо = стр.СубконтоКт1;
//	//			//ОбластьЗаголовок1.Параметры.Счет = ОтражениеВБУ.СчетДт;
//	//			//ОбластьЗаголовок1.Параметры.СубДт = ОтражениеВБУ.СубконтоДт1;
//	//			//ОбластьЗаголовок1.Параметры.СубДт2 = ОтражениеВБУ.СубконтоДт2;
//	//			СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(стр.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 26.03.2016 № 950
//	//			РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(ПериодРегистрации)) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//	//			БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
//	//			
//	//			Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(?(Результат > БазаОграниченияФСЗН ,БазаОграниченияФСЗН,Результат)*СчетФСЗН/100, ПериодРегистрации);
//	//			Если НалогиИзДокументаРасчетФзносовСФОТ Тогда
//	//				
//	//				ЗапросФСЗНБГС = Новый Запрос;
//	//				ЗапросФСЗНБГС.Текст = 
//	//				"ВЫБРАТЬ
//	//				|	ЕСНИсчисленный.ФСЗН,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
//	//				|ИЗ
//	//				|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//	//				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//	//				|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
//	//				|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
//	//				|			И ЕСНИсчисленный.ПериодВзаиморасчетов = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации
//	//				|ГДЕ
//	//				|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//	//				|	И ЕСНИсчисленный.Организация = &Организация
//	//				|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//	//				|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт ИЛИ ЕстьNull(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт,1) = 1)
//	//				|	И ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1 И ЕСНИсчисленный.ФСЗН <> 0"; 						
//	//				
//	//				ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
//	//				ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(стр.Месяц));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(стр.Месяц));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ПериодВзаиморасчетов", НачалоМесяца(стр.ПериодДействияНачало));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ПериодВзаиморасчетов1", КонецМесяца(стр.ПериодДействияНачало));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",мСтрока.СчетДт);
//	//				
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо",стр.Сотрудник.Физлицо);			
//	//				РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить().Выбрать();
//	//				
//	//				СчНомерСтроки = 1;
//	//				Пока РезФСЗНБГС.Следующий() Цикл 														
//	//					
//	//					
//	//					
//	//					Если СчНомерСтроки = 1 Тогда 
//	//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((РезФСЗНБГС.ФСЗН) * ?(РезФСЗНБГС.ДоляСпособаОтражения=Null,100,РезФСЗНБГС.ДоляСпособаОтражения) / 100,стр.Месяц);
//	//						
//	//					иначе 
//	//						Если РезФСЗНБГС.СчетДт <> Null Тогда
//	//							
//	//							Строка1 = ПромежуточнаяТаблица.Добавить();
//	//							ЗаполнитьЗначенияСвойств(Строка1,Строка);
//	//							Строка1.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((РезФСЗНБГС.ФСЗН) * ?(РезФСЗНБГС.ДоляСпособаОтражения=Null,100,РезФСЗНБГС.ДоляСпособаОтражения) / 100,стр.Месяц);
//	//							
//	//							//Строка1.ОтражениеВУСН = стр.ОтражениеВУСН;
//	//							//Строка1.СчетКтУСН = стр.СчетКтУСН;
//	//							//Строка1.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
//	//						КонецЕсли;
//	//					КонецЕсли;
//	//					
//	//					
//	//					СчНомерСтроки = СчНомерСтроки+1;
//	//				КонецЦикла;
//	//				
//	//				
//	//				
//	//				//Строка.ОтражениеВУСН = стр.ОтражениеВУСН;
//	//				//Строка.СчетКтУСН = стр.СчетКтУСН;
//	//				//Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
//	//				
//	//				ЗапросФСЗНБГС = Новый Запрос;
//	//				ЗапросФСЗНБГС.Текст = 
//	//				"ВЫБРАТЬ
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
//	//				|ИЗ
//	//				|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//	//				|ГДЕ
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
//	//				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник
//	//				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт <> &СчетДт";
//	//				
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРегистрации));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("Сотрудник", стр.Сотрудник);
//	//				ЗапросФСЗНБГС.УстановитьПараметр("СчетДт", мСтрока.СчетДт);					
//	//				РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить().Выбрать();
//	//				Пока РезФСЗНБГС.Следующий() Цикл 
//	//					Если РезФСЗНБГС.СчетДт <> Null Тогда
//	//						Строка1 = ПромежуточнаяТаблица.Добавить();
//	//						ЗаполнитьЗначенияСвойств(Строка1,Строка);
//	//						
//	//						ЗапросФСЗНБГС = Новый Запрос;
//	//						ЗапросФСЗНБГС.Текст = 
//	//						"ВЫБРАТЬ
//	//						|	ЕСНИсчисленный.ФСЗН,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
//	//						|ИЗ
//	//						|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//	//						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//	//						|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
//	//						|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
//	//						|			И ЕСНИсчисленный.ПериодВзаиморасчетов = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации
//	//						|ГДЕ
//	//						|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//	//						|	И ЕСНИсчисленный.Организация = &Организация
//	//						|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//	//						|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт ИЛИ ЕстьNull(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт,1) = 1)
//	//						|	И ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1"; 						
//	//						
//	//						ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
//	//						ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(стр.Месяц));
//	//						ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(стр.Месяц));
//	//						ЗапросФСЗНБГС.УстановитьПараметр("ПериодВзаиморасчетов", НачалоМесяца(стр.ПериодДействияНачало));
//	//						ЗапросФСЗНБГС.УстановитьПараметр("ПериодВзаиморасчетов1", КонецМесяца(стр.ПериодДействияНачало));
//	//						ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",РезФСЗНБГС.СчетДт);
//	//						
//	//						
//	//						ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо",стр.Сотрудник.Физлицо);			
//	//						РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить().Выбрать();
//	//						Пока РезФСЗНБГС.Следующий() Цикл 
//	//							Строка1.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((РезФСЗНБГС.ФСЗН) * ?(РезФСЗНБГС.ДоляСпособаОтражения=Null,100,РезФСЗНБГС.ДоляСпособаОтражения) / 100,стр.Месяц);;
//	//						КонецЦикла;
//	//						
//	//						
//	//						
//	//						//Строка1.ОтражениеВУСН = стр.ОтражениеВУСН;
//	//						//Строка1.СчетКтУСН = стр.СчетКтУСН;
//	//						//Строка1.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
//	//					КонецЕсли;
//	//					
//	//				КонецЦикла;
//	//				
//	//				
//	//				
//	//				
//	//				
//	//			иначе
//	//				
//	//				
//	//				
//	//				
//	//				
//	//				
//	//				Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(?(Результат > БазаОграниченияФСЗН ,БазаОграниченияФСЗН,Результат)*СчетФСЗН/100, ПериодРегистрации);//О.Т. Аверсон 14.03.2016 № 949
//	//				//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//	//				
//	//				
//	//				//О.Т. Аверсон 09.12.2016 № 79
//	//				Если Результат > БазаОграниченияФСЗН Тогда 
//	//					
//	//					РазмерСреднейЗарплаты1 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(ПериодРегистрации)-86400) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//	//					СтруктураПенс1 = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(стр.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 24.03.2016 № 950
//	//					
//	//					БазаОграниченияФСЗН1 = СтруктураПенс1.ОграничениеПоДоходам*РазмерСреднейЗарплаты1;
//	//					
//	//					Если БазаОграниченияФСЗН < БазаОграниченияФСЗН1 Тогда 
//	//						
//	//						Строка = ПромежуточнаяТаблица.Добавить();
//	//						Строка.ФизЛицо		= стр.СубконтоКт1;
//	//						
//	//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((БазаОграниченияФСЗН-БазаОграниченияФСЗН1) *?(ЕстьИндивидСтавка,СтавкаФСЗНИнд,СчетФСЗН)/100,ПериодРегистрации);
//	//						
//	//					КонецЕсли;
//	//				КонецЕсли;
//	//			КонецЕсли;
//	//			//О.Т. Аверсон 09.12.2016 № 79
//	//			
//	//			
//	//			//КонецЕсли; //Островская Татьяна 24.04.2013 № 16 ФСЗН ограничения
//	//		иначе
//	//			
//	//			СубконтоКредита = Перечисления.ВидыПлатежейВГосБюджет.Налог;
//	//			Если ЕстьИндивидСтавка Тогда 
//	//				СтавкаФСЗН = СтавкаФСЗНИнд;
//	//				СтавкаФСЗНИнвалиды = СтавкаФСЗНИнд;
//	//				СтавкаСтрах = СтавкаБГСИнд;
//	//			иначе
//	//				СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(стр.ПериодДействияНачало, 
//	//				Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).Размер;//О.Т. Аверсон 26.03.2016 № 950
//	//				СтавкаФСЗНИнвалиды = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(стр.ПериодДействияНачало, 
//	//				Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды,ВидНалогообложения)).Размер;//О.Т. Аверсон 26.03.2016 № 950
//	//				СтавкаСтрах = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(стр.ПериодДействияНачало, 
//	//				Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Ставка; //О.Т. Аверсон 26.03.2016 № 950
//	//			КонецЕсли;
//	//			СтавкаЕдиныйПлатеж = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(стр.ПериодДействияНачало, 
//	//			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ЕдиныйПлатеж,ВидНалогообложения)).Размер;//О.Т. Аверсон 26.03.2016 № 950
//	//			
//	//			ЗапросСтатья = Новый Запрос;
//	//			ЗапросСтатья.Текст = 
//	//			"ВЫБРАТЬ
//	//			|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация,
//	//			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваФСЗН3,
//	//			|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоРезерваСтрах3
//	//			|ИЗ
//	//			|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
//	//			|ГДЕ
//	//			|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
//	//			ЗапросСтатья.УстановитьПараметр("Организация",Организация);
//	//			Рез = ЗапросСтатья.Выполнить().Выбрать();
//	//			СтатьяЗатратФСЗН = Неопределено;
//	//			СтатьяЗатратСтрах = Неопределено;
//	//			пока  Рез.Следующий() цикл
//	//				СтатьяЗатратФСЗН = Рез.СубконтоРезерваФСЗН3;
//	//				СтатьяЗатратСтрах = Рез.СубконтоРезерваСтрах3;
//	//				
//	//			КонецЦикла;
//	//			//ФСЗН
//	//			РезультатПоИнвалидам = ПроверкаФизлицоНаИнвалидность(стр.СубконтоКт1).Выгрузить();
//	//			//если не СуммаФСЗННеВыводить Тогда //Островская Татьяна 24.04.2013 № 16 ФСЗН ограничения
//	//			Строка = ПромежуточнаяТаблица.Добавить();
//	//			
//	//			Строка.Физлицо = стр.СубконтоКт1;
//	//			//ОбластьЗаголовок1.Параметры.Счет = ОтражениеВБУ.СчетДт;
//	//			//ОбластьЗаголовок1.Параметры.СубДт = ОтражениеВБУ.СубконтоДт1;
//	//			//ОбластьЗаголовок1.Параметры.СубДт2 = ОтражениеВБУ.СубконтоДт2;
//	//			СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(стр.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 26.03.2016 № 950
//	//			РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(ПериодРегистрации)) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//	//			БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
//	//			
//	//			Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(Результат,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);
//	//			Если НалогиИзДокументаРасчетФзносовСФОТ Тогда
//	//				
//	//				ЗапросФСЗНБГС = Новый Запрос;
//	//				ЗапросФСЗНБГС.Текст = 
//	//				"ВЫБРАТЬ
//	//				|	ЕСНИсчисленный.ФСЗН,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
//	//				|ИЗ
//	//				|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//	//				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//	//				|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
//	//				|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
//	//				|			И ЕСНИсчисленный.ПериодВзаиморасчетов = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации
//	//				|ГДЕ
//	//				|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//	//				|	И ЕСНИсчисленный.Организация = &Организация
//	//				|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//	//				|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт ИЛИ ЕстьNull(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт,1) = 1)
//	//				|	И ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1 И ЕСНИсчисленный.ФСЗН <> 0"; 						
//	//				
//	//				ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
//	//				ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(стр.Месяц));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(стр.Месяц));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ПериодВзаиморасчетов", НачалоМесяца(стр.ПериодДействияНачало));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ПериодВзаиморасчетов1", КонецМесяца(стр.ПериодДействияНачало));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",мСтрока.СчетДт);
//	//				
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо",стр.Сотрудник.Физлицо);			
//	//				РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить().Выбрать();
//	//				
//	//				СчНомерСтроки = 1;
//	//				Пока РезФСЗНБГС.Следующий() Цикл 														
//	//					
//	//					
//	//					
//	//					Если СчНомерСтроки = 1 Тогда 
//	//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((РезФСЗНБГС.ФСЗН) * ?(РезФСЗНБГС.ДоляСпособаОтражения=Null,100,РезФСЗНБГС.ДоляСпособаОтражения) / 100,стр.Месяц);
//	//						
//	//					иначе 
//	//						Если РезФСЗНБГС.СчетДт <> Null Тогда
//	//							
//	//							Строка1 = ПромежуточнаяТаблица.Добавить();
//	//							ЗаполнитьЗначенияСвойств(Строка1,Строка);
//	//							Строка1.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((РезФСЗНБГС.ФСЗН) * ?(РезФСЗНБГС.ДоляСпособаОтражения=Null,100,РезФСЗНБГС.ДоляСпособаОтражения) / 100,стр.Месяц);
//	//							
//	//							//Строка1.ОтражениеВУСН = стр.ОтражениеВУСН;
//	//							//Строка1.СчетКтУСН = стр.СчетКтУСН;
//	//							//Строка1.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
//	//						КонецЕсли;
//	//					КонецЕсли;
//	//					
//	//					
//	//					СчНомерСтроки = СчНомерСтроки+1;
//	//				КонецЦикла;
//	//				
//	//				
//	//				
//	//				//Строка.ОтражениеВУСН = стр.ОтражениеВУСН;
//	//				//Строка.СчетКтУСН = стр.СчетКтУСН;
//	//				//Строка.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
//	//				
//	//				ЗапросФСЗНБГС = Новый Запрос;
//	//				ЗапросФСЗНБГС.Текст = 
//	//				"ВЫБРАТЬ
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
//	//				|ИЗ
//	//				|	РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//	//				|ГДЕ
//	//				|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1
//	//				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник = &Сотрудник
//	//				|	И РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт <> &СчетДт";
//	//				
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРегистрации));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРегистрации));
//	//				ЗапросФСЗНБГС.УстановитьПараметр("Сотрудник", стр.Сотрудник);
//	//				ЗапросФСЗНБГС.УстановитьПараметр("СчетДт", мСтрока.СчетДт);					
//	//				РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить().Выбрать();
//	//				Пока РезФСЗНБГС.Следующий() Цикл 
//	//					Если РезФСЗНБГС.СчетДт <> Null Тогда
//	//						Строка1 = ПромежуточнаяТаблица.Добавить();
//	//						ЗаполнитьЗначенияСвойств(Строка1,Строка);
//	//						
//	//						ЗапросФСЗНБГС = Новый Запрос;
//	//						ЗапросФСЗНБГС.Текст = 
//	//						"ВЫБРАТЬ
//	//						|	ЕСНИсчисленный.ФСЗН,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ДоляСпособаОтражения,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт КАК СчетДт,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1 КАК СубконтоДт1,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2 КАК СубконтоДт2,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3 КАК СубконтоДт3,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
//	//						|	РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ КАК СчетДтНУ
//	//						|ИЗ
//	//						|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
//	//						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаспределениеОсновногоЗаработкаРаботниковОрганизаций КАК РаспределениеОсновногоЗаработкаРаботниковОрганизаций
//	//						|		ПО ЕСНИсчисленный.ФизЛицо = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Физлицо
//	//						|			И ЕСНИсчисленный.Организация = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.Сотрудник.Организация
//	//						|			И ЕСНИсчисленный.ПериодВзаиморасчетов = РаспределениеОсновногоЗаработкаРаботниковОрганизаций.ПериодРегистрации
//	//						|ГДЕ
//	//						|	ЕСНИсчисленный.ФизЛицо = &ФизЛицо
//	//						|	И ЕСНИсчисленный.Организация = &Организация
//	//						|	И ЕСНИсчисленный.Период МЕЖДУ &Период И &Период1
//	//						|	И (РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт = &СчетДт ИЛИ ЕстьNull(РаспределениеОсновногоЗаработкаРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт,1) = 1)
//	//						|	И ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1"; 						
//	//						
//	//						ЗапросФСЗНБГС.УстановитьПараметр("Организация", Организация);
//	//						ЗапросФСЗНБГС.УстановитьПараметр("Период", НачалоМесяца(стр.Месяц));
//	//						ЗапросФСЗНБГС.УстановитьПараметр("Период1", КонецМесяца(стр.Месяц));
//	//						ЗапросФСЗНБГС.УстановитьПараметр("ПериодВзаиморасчетов", НачалоМесяца(стр.ПериодДействияНачало));
//	//						ЗапросФСЗНБГС.УстановитьПараметр("ПериодВзаиморасчетов1", КонецМесяца(стр.ПериодДействияНачало));
//	//						ЗапросФСЗНБГС.УстановитьПараметр("СчетДт",РезФСЗНБГС.СчетДт);
//	//						
//	//						
//	//						ЗапросФСЗНБГС.УстановитьПараметр("ФизЛицо",стр.Сотрудник.Физлицо);			
//	//						РезФСЗНБГС = ЗапросФСЗНБГС.Выполнить().Выбрать();
//	//						Пока РезФСЗНБГС.Следующий() Цикл 
//	//							Строка1.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((РезФСЗНБГС.ФСЗН) * ?(РезФСЗНБГС.ДоляСпособаОтражения=Null,100,РезФСЗНБГС.ДоляСпособаОтражения) / 100,стр.Месяц);;
//	//						КонецЦикла;
//	//						
//	//						
//	//						
//	//						//Строка1.ОтражениеВУСН = стр.ОтражениеВУСН;
//	//						//Строка1.СчетКтУСН = стр.СчетКтУСН;
//	//						//Строка1.ПризнакПроводки = Перечисления.ПризнакПроводки.ФондСоциальнойЗащиты;
//	//					КонецЕсли;
//	//					
//	//				КонецЦикла;
//	//				
//	//				
//	//				
//	//				
//	//				
//	//			иначе
//	//				Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(Результат,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//	//				//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//	//				
//	//				Если РезультатПоИнвалидам.Количество() = 0 Тогда
//	//					//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614		
//	//					Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(Результат,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//	//					//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//	//				Иначе
//	//					Если РезультатПоИнвалидам[0].Группа = 1 тогда
//	//						//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//	//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(Результат,БазаОграниченияФСЗН) * СтавкаФСЗНИнвалиды / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//	//						//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//	//						//Сообщить("инвалид: " + ТекСтрокаОтражениеВБУ.ФизЛицо.Наименование);
//	//					Иначе
//	//						//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//	//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(Мин(Результат,БазаОграниченияФСЗН) * СтавкаФСЗН / 100,ПериодРегистрации);//О.Т. Аверсон 17.03.2016 № 949
//	//						//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//	//					КонецЕсли;
//	//				КонецЕсли;
//	//				
//	//				
//	//				//О.Т. Аверсон 09.12.2016 № 79
//	//				Если Результат > БазаОграниченияФСЗН Тогда 
//	//					РазмерСреднейЗарплаты1 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(ПериодРегистрации)-86400) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//	//					СтруктураПенс1 = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 24.03.2016 № 950
//	//					БазаОграниченияФСЗН1 = СтруктураПенс1.ОграничениеПоДоходам*РазмерСреднейЗарплаты1;
//	//					
//	//					Если БазаОграниченияФСЗН < БазаОграниченияФСЗН1 Тогда 
//	//						
//	//						Строка = ПромежуточнаяТаблица.Добавить();
//	//						Строка.ФизЛицо		= стр.СубконтоКт1;
//	//						
//	//						Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((БазаОграниченияФСЗН-БазаОграниченияФСЗН1) *?(ЕстьИндивидСтавка,СтавкаФСЗНИнд,СчетФСЗН)/100,ПериодРегистрации);
//	//						
//	//					КонецЕсли;
//	//				КонецЕсли;
//	//			КонецЕсли;
//	//			//О.Т. Аверсон 09.12.2016 № 79
//	//			
//	//			
//	//			
//	//			//КонецЕсли;	
//	//		КонецЕсли;
//	//		
//	//		
//	//	КонецЦикла;
//	//иначе
//	//- СВЭЙ КДЯ СВФР-004427 06.06.19
//	
//	Для Каждого стр из тзПереходящиеОтпуска Цикл 
//		
//		//О.Т. Аверсон 26.03.2016 № 950
//		ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
//		Если стр.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
//			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
//		иначе
//			ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
//		КонецЕсли;
//		
//		ЗапросИндСтавкаНалогообл = Новый Запрос;
//		ЗапросИндСтавкаНалогообл.Текст = 
//		"ВЫБРАТЬ
//		|	ИноеНалогообложениеПоСотрудникамСрезПоследних.БГС,
//		|	ИноеНалогообложениеПоСотрудникамСрезПоследних.ФСЗН
//		|ИЗ
//		|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
//		|			&Период,
//		|			Организация = &Организация
//		|				И ВидНалогообложения = &ВидНалогообложения
//		|				И Сотрудник = &Сотрудник) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
//		
//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", ПериодРегистрации);
//		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Стр.Сотрудник); 
//		РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
//		ЕстьИндивидСтавка = Ложь;
//		СтавкаФСЗНИнд = 0;
//		СтавкаБГСИнд = 0;
//		Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
//			ЕстьИндивидСтавка = Истина;
//			СтавкаФСЗНИнд = РезИндСтавкаНалогообл[0].ФСЗН;
//			СтавкаБГСИнд = РезИндСтавкаНалогообл[0].БГС;
//		КонецЕсли;
//		
//		Если ЕстьИндивидСтавка Тогда 
//			СчетФСЗН = СтавкаФСЗНИнд;
//			СчетБГС = СтавкаБГСИнд;
//		иначе
//			СчетФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации,
//			Новый Структура("Организация,ВидОтчисления,ВидНалогообложения", Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения)).Размер;
//			СчетБГС = РегистрыСведений.СтавкаВзносаНаСтрахованиеОтНесчастныхСлучаев.ПолучитьПоследнее(ПериодРегистрации,
//			Новый Структура("Организация,ВидНалогообложения", Организация,ВидНалогообложения)).Ставка;
//		КонецЕсли;   
//		//О.Т. Аверсон 25.03.2016 № 950
//		
//		Результат = стр.Результат;
//		
//		РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(ПериодРегистрации)) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//		//РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(стр.Месяц)) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//		СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(стр.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 26.03.2016 № 950
//		
//		
//		ПенсФондБудМес = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца)).размер;
//		//Островская Татьяна 23.04.2013 № 16 ФСЗН ограничения
//		
//		БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
//		
//		Если НалогиИзДокументаРасчетФзносовСФОТ Тогда
//			
//			
//		иначе
//			
//			//О.Т. Аверсон 09.12.2016 № 79
//			Если Результат > БазаОграниченияФСЗН Тогда 
//				РазмерСреднейЗарплаты1 = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(НачалоМесяца(ПериодРегистрации)-86400) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//				СтруктураПенс1 = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(стр.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));//О.Т. Аверсон 24.03.2016 № 950
//				
//				БазаОграниченияФСЗН1 = СтруктураПенс1.ОграничениеПоДоходам*РазмерСреднейЗарплаты1;
//				
//				Если БазаОграниченияФСЗН < БазаОграниченияФСЗН1 Тогда 
//					
//					Строка = ПромежуточнаяТаблица.Добавить();
//					Строка.ФизЛицо		= стр.СубконтоКт1;
//					
//					Строка.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016((БазаОграниченияФСЗН-БазаОграниченияФСЗН1) *?(ЕстьИндивидСтавка,СтавкаФСЗНИнд,СчетФСЗН)/100,ПериодРегистрации);
//					
//				КонецЕсли;
//			КонецЕсли;
//			//О.Т. Аверсон 09.12.2016 № 79
//		КонецЕсли;
//	КонецЦикла;
//	
//	//+ СВЭЙ КДЯ СВФР-004427 06.06.19
//	//КонецЕсли;	
//	//- СВЭЙ КДЯ СВФР-004427 06.06.19
//	
//	РегистраторВыбытие = Новый СписокЗначений;
//	
//	
//	Макет = ПолучитьМакет("Макет");
//	ТабДок = Новый ТабличныйДокумент;
//	ТабДок.ПолеСлева = 0;
//	ТабДок.ПолеСправа = 0;
//	ТабДок.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ";
//	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
//	
//	ТабДок.Очистить();
//	
//	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");	
//	ТабДок.Вывести(ОбластьЗаголовок);
//	ОбластьЗаголовок1 = Макет.ПолучитьОбласть("Строка");  
//	ОбластьЗаголовок2 = Макет.ПолучитьОбласть("Подвал"); 	
//	
//	////ОбластьЗаголовок.Параметры.Шапка = "Отпуска работников организации" + Символы.ПС +
//	////		"за период с "+Формат(НачДата, "ДФ='dd.MM.yyyy'")+" по "+Формат(КонДата, "ДФ='dd.MM.yyyy'");
//	//ОбластьЗаголовок1.Параметры.ПечГод = Строка(Год(НачДата))+"г.";
//	//ОбластьЗаголовок1.Параметры.ПечДатаПоСостоянию = формат(НачДата,"ДФ=""дд.ММ.гг"""); 
//	Итог = 0;
//	ИтогСтрах = 0;
//	//СтавкаФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//	//Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).Размер;
//	//СтавкаФСЗНИнвалиды = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ПериодРегистрации, 
//	//Новый Структура("ВидОтчисления", Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)).Размер;
//	ПромежуточнаяТаблица.Сортировать("ФизЛицо");
//	ПромежуточнаяТаблица.Свернуть("ФизЛицо", "БазаФСЗН,БазаСтрах");
//	//О.Т. 03.03.2015
//	Для Каждого стрПромежуточнаяТаблица из ПромежуточнаяТаблица Цикл
//		стрПромежуточнаяТаблица.БазаФСЗН = ОбщегоНазначения.ОкруглитьЗначение2016(?(стрПромежуточнаяТаблица.БазаФСЗН = null или стрПромежуточнаяТаблица.БазаФСЗН = Неопределено,0, стрПромежуточнаяТаблица.БазаФСЗН),ПериодРегистрации);//О.Т. Аверсон 14.03.2016 № 949
//		стрПромежуточнаяТаблица.БазаСтрах = ОбщегоНазначения.ОкруглитьЗначение2016(?(стрПромежуточнаяТаблица.БазаСтрах = null или стрПромежуточнаяТаблица.БазаСтрах = Неопределено,0, стрПромежуточнаяТаблица.БазаСтрах),ПериодРегистрации);//О.Т. Аверсон 14.03.2016 № 949
//	КонецЦикла;
//	//О.Т. 03.03.2015 
//	для Каждого  ОтражениеВБУ из ПромежуточнаяТаблица Цикл 
//		РезультатПоИнвалидам = ПроверкаФизлицоНаИнвалидность(ОтражениеВБУ.ФизЛицо).Выгрузить();
//		
//		ОбластьЗаголовок1.Параметры.Физ = ОтражениеВБУ.Физлицо;
//		//ОбластьЗаголовок1.Параметры.Счет = ОтражениеВБУ.СчетДт;
//		//ОбластьЗаголовок1.Параметры.СубДт = ОтражениеВБУ.СубконтоДт1;
//		//ОбластьЗаголовок1.Параметры.СубДт2 = ОтражениеВБУ.СубконтоДт2;
//		СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("ВидОтчисления",Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд));
//		РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
//		БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
//		
//		ОбластьЗаголовок1.Параметры.БазаФСЗН = ОтражениеВБУ.БазаФСЗН;
//		ОбластьЗаголовок1.Параметры.БазаСтрах = ОтражениеВБУ.БазаСтрах;
//		//Аверсон-софт, Островская Татьяна 17.07.2012 № 15614
//		
//		
//		//ОбластьЗаголовок1.Параметры.БазаСтрах = ОтражениеВБУ.БазаСтрах;
//		
//		ТабДок.Вывести(ОбластьЗаголовок1);
//		Итог = Итог + ОбластьЗаголовок1.Параметры.БазаФСЗН;
//		ИтогСтрах = ИтогСтрах + ОбластьЗаголовок1.Параметры.БазаСтрах;
//		
//	КонецЦикла;
//	
//	
//	ОбластьЗаголовок2.Параметры.Итог = Итог;
//	ОбластьЗаголовок2.Параметры.ИтогСтрах = ИтогСтрах;
//	ТабДок.Вывести(ОбластьЗаголовок2);
//	Возврат ТабДок;
//	//ТабДок.Вывести(ОбластьПодвал);
//	//
//	//	
//	//ТабДок.АвтоМасштаб = Истина;
//	//ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
//	//ТабДок.ТолькоПросмотр = Истина;
//КонецФункции

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ДЛЯ ОБЕСПЕЧЕНИЯ ПРОВЕДЕНИЯ ДОКУМЕНТА

Функция СформироватьЗапросПоДоходам()
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	""Основные"" КАК ТипСтроки,
	|	&ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	|	Основные.НомерСтроки,
	|	Основные.ВидРасчета.СпособРасчета КАК СпособРасчета,
	|	Основные.ВидРасчета,
	//	|	ВЫБОР КОГДА Основные.ВидРасчета.СпособРасчета <> &СпособРасчетаПоСреднемуЗаработкуФСС ТОГДА ИСТИНА ИНАЧЕ ЛОЖЬ КОНЕЦ КАК НеОтражаетсяВНУ,
	|	ВЫБОР КОГДА Основные.ВидРасчета.ВидНачисленияПоСт255НК = &ПустойВидНачисленияПоСт255НК И Основные.ВидРасчета.СпособРасчета <> &СпособРасчетаПоСреднемуЗаработкуФСС ТОГДА ИСТИНА ИНАЧЕ ЛОЖЬ КОНЕЦ КАК НеОтражаетсяВНУ,
	//	|	ВЫБОР КОГДА Основные.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат ТОГДА Основные.СубконтоДт1.ОтнесениеРасходовКДеятельностиЕНВД КОГДА Основные.СубконтоДт2 ССЫЛКА Справочник.СтатьиЗатрат ТОГДА Основные.СубконтоДт2.ОтнесениеРасходовКДеятельностиЕНВД КОГДА Основные.СубконтоДт3 ССЫЛКА Справочник.СтатьиЗатрат ТОГДА Основные.СубконтоДт3.ОтнесениеРасходовКДеятельностиЕНВД ИНАЧЕ NULL КОНЕЦ КАК СтатьяЗатратЕНВД,
	|	Основные.Сотрудник,
	|	Основные.Сотрудник.ФизЛицо КАК ФизЛицо,
	//|	Основные.Приказ,
	|	Основные.СчетДт,
	|	Основные.СчетДт.Наименование КАК НаименованиеСчетДт,
	|	Основные.СчетКт,
	|	Основные.СубконтоДт1,
	|	Основные.СубконтоДт2,
	|	Основные.СубконтоДт3,
	|	Основные.СубконтоКт1,
	|	Основные.СубконтоКт2,
	|	Основные.СубконтоКт3,
	|	Основные.СчетДтНУ,
	|	Основные.СчетКтНУ,
	|	Основные.СубконтоДтНУ1,
	|	Основные.СубконтоДтНУ2,
	|	Основные.СубконтоДтНУ3,
	|	Основные.СубконтоКтНУ1,
	|	Основные.СубконтоКтНУ2,
	|	Основные.СубконтоКтНУ3,
	|	Основные.Результат,
	|	Основные.ПериодДействияНачало,
	|	Основные.ПериодДействияКонец,
	|	ВЫБОР
	|		КОГДА РаботникиСрез.ПериодЗавершения <= Основные.ПериодДействияНачало
	|				И РаботникиСрез.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА РаботникиСрез.ГрафикРаботыЗавершения
	|		ИНАЧЕ РаботникиСрез.ГрафикРаботы
	|	КОНЕЦ КАК ГрафикРаботы,
	|	ЕСТЬNULL(ВЫБОР
	|			КОГДА РаботникиСрез.ПериодЗавершения <= Основные.ПериодДействияНачало
	|					И РаботникиСрез.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|				ТОГДА РаботникиСрез.ГрафикРаботыЗавершения.СуммированныйУчетРабочегоВремени
	|			ИНАЧЕ РаботникиСрез.ГрафикРаботы.СуммированныйУчетРабочегоВремени
	|		КОНЕЦ, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени,
	|	ВЫБОР
	|		КОГДА Основные.Сотрудник.Организация = &ГоловнаяОрганизация
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ОшибкаНеСоответствиеСотрудникаИОрганизации,
	
	//Аверсон ЕАЕ 23.06.2022 СВФР-009233
	|   NULL КАК БазовыйПериодНачало,
	|   NULL КАК БазовыйПериодКонец
	//Аверсон СВФР-009233
	
	|ИЗ
	|	Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК Основные
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			РаботникиСрез.Сотрудник КАК Сотрудник,
	|			Работники.ГрафикРаботы КАК ГрафикРаботы,
	|			Работники.ГрафикРаботыЗавершения КАК ГрафикРаботыЗавершения,
	|			Работники.ПериодЗавершения КАК ПериодЗавершения
	|		ИЗ
	|			(ВЫБРАТЬ
	|				МАКСИМУМ(Работники.Период) КАК ПериодСреза,
	|				Основные.Сотрудник КАК Сотрудник
	|			ИЗ
	|				Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК Основные
	|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работники
	|					ПО Работники.Период <= Основные.ПериодДействияНачало
	|						И Основные.Сотрудник = Работники.Сотрудник
	|			ГДЕ
	|				Основные.Ссылка = &парамРегистратор
	|			
	|			СГРУППИРОВАТЬ ПО
	|				Основные.Сотрудник) КАК РаботникиСрез
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работники
	|				ПО РаботникиСрез.ПериодСреза = Работники.Период
	|					И РаботникиСрез.Сотрудник = Работники.Сотрудник) КАК РаботникиСрез
	|		ПО Основные.Сотрудник = РаботникиСрез.Сотрудник
	|ГДЕ
	|	Основные.Ссылка = &парамРегистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Дополнительные"",
	|	&ГоловнаяОрганизация,
	|	Дополнительные.НомерСтроки,
	|	Дополнительные.ВидРасчета.СпособРасчета,
	|	Дополнительные.ВидРасчета,
	|	ВЫБОР КОГДА Дополнительные.ВидРасчета.ВидНачисленияПоСт255НК = &ПустойВидНачисленияПоСт255НК ТОГДА ИСТИНА ИНАЧЕ ЛОЖЬ КОНЕЦ,
	//	|	ВЫБОР КОГДА Дополнительные.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат ТОГДА Дополнительные.СубконтоДт1.ОтнесениеРасходовКДеятельностиЕНВД КОГДА Дополнительные.СубконтоДт2 ССЫЛКА Справочник.СтатьиЗатрат ТОГДА Дополнительные.СубконтоДт2.ОтнесениеРасходовКДеятельностиЕНВД КОГДА Дополнительные.СубконтоДт3 ССЫЛКА Справочник.СтатьиЗатрат ТОГДА Дополнительные.СубконтоДт3.ОтнесениеРасходовКДеятельностиЕНВД ИНАЧЕ NULL КОНЕЦ,
	|	Дополнительные.Сотрудник,
	|	Дополнительные.Сотрудник.ФизЛицо,
	//|	Дополнительные.Приказ,
	|	Дополнительные.СчетДт,
	|	Дополнительные.СчетДт.Наименование,
	|	Дополнительные.СчетКт,
	|	Дополнительные.СубконтоДт1,
	|	Дополнительные.СубконтоДт2,
	|	Дополнительные.СубконтоДт3,
	|	Дополнительные.СубконтоКт1,
	|	Дополнительные.СубконтоКт2,
	|	Дополнительные.СубконтоКт3,
	|	Дополнительные.СчетДтНУ,
	|	Дополнительные.СчетКтНУ,
	|	Дополнительные.СубконтоДтНУ1,
	|	Дополнительные.СубконтоДтНУ2,
	|	Дополнительные.СубконтоДтНУ3,
	|	Дополнительные.СубконтоКтНУ1,
	|	Дополнительные.СубконтоКтНУ2,
	|	Дополнительные.СубконтоКтНУ3,
	|	Дополнительные.Результат,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	ВЫБОР
	|		КОГДА Дополнительные.Сотрудник.Организация = &ГоловнаяОрганизация
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ,
	
	//Аверсон ЕАЕ 23.06.2022 СВФР-009233
	|   Дополнительные.БазовыйПериодНачало КАК БазовыйПериодНачало,
	|   Дополнительные.БазовыйПериодКонец КАК БазовыйПериодКонец
	//Аверсон СВФР-009233
	
	|ИЗ
	|	Документ.ОтражениеЗарплатыВРеглУчете.ДополнительныеНачисления КАК Дополнительные
	|
	|ГДЕ
	|	Дополнительные.Ссылка = &парамРегистратор");
	
	Запрос.УстановитьПараметр("парамРегистратор", Ссылка);
	Запрос.УстановитьПараметр("ГоловнаяОрганизация", ОбщегоНазначения.ГоловнаяОрганизация(Организация));
	Запрос.УстановитьПараметр("ПустойВидНачисленияПоСт255НК", Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ПустаяСсылка());
	Запрос.УстановитьПараметр("СпособРасчетаПоСреднемуЗаработкуФСС", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	
	Возврат Запрос.Выполнить();
КонецФункции

//функция возвращает оснвной счет сотрудника из "ОсновныеНачисления"
Функция СформироватьЗапросПоОсновнымСчетамСотрудников()  
	
	СписокНачислений = Новый СписокЗначений;
	СписокНачислений.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
	СписокНачислений.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
	СписокНачислений.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
	СписокНачислений.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
	
	Запрос = Новый Запрос;
	
	ТекстЗапроса = "ВЫБРАТЬ
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ФизЛицо,
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт,
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1,
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2,
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3
	|ИЗ
	|	Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
	|ГДЕ
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка = &Ссылка
	|	И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета В(&ВидРасчета)
	
	|СГРУППИРОВАТЬ ПО
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ФизЛицо,
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт,
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1,
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3,
	|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2";
	
	Запрос.УстановитьПараметр("ВидРасчета", СписокНачислений);
	Запрос.УстановитьПараметр("Ссылка", Ссылка);
	
	Запрос.Текст = ТекстЗапроса;
	
	Результат = Запрос.Выполнить();
	
	Возврат Результат;
	
КонецФункции

Функция СформироватьЗапросПоОтражениюВУчете()
	
	// готовим список счетов
	СчетаИсключения = Новый Массив();
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоСоциальномуСтрахованию);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоНалогам);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасходыБудущихПериодов);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.НераспределеннаяПрибыль);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.ПрочиеДоходыИРасходы);
	
	ТекстСчетаИсключения = 
	"ВЫБРАТЬ
	|	Хозрасчетный.Ссылка
	|ИЗ
	|	ПланСчетов.Хозрасчетный КАК Хозрасчетный
	|ГДЕ
	|	Хозрасчетный.Ссылка В ИЕРАРХИИ(&СчетаИсключения)";
	
	Запрос = Новый Запрос(ТекстСчетаИсключения);
	Запрос.УстановитьПараметр("СчетаИсключения", СчетаИсключения);
	СчетаИсключения = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка");
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.НомерСтроки КАК НомерСтроки,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт КАК СчетДт,
	|	ВЫБОР
	|		КОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт В (&СчетаИсключения)
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ОтражаетсяНУ,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт.Наименование КАК НаименованиеСчетДт,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СтатьяЗатрат.ОтнесениеРасходовКДеятельностиЕНВД КАК СтатьяЗатратЕНВД,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКт,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДтНУ,
	|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКтНУ
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.НомерСтроки КАК НомерСтроки,
	|		ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт КАК СчетДт,
	|		ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКт КАК СчетКт,
	|		ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДтНУ КАК СчетДтНУ,
	|		ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКтНУ КАК СчетКтНУ,
	|		ВЫБОР
	|			КОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт1 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт1
	|			КОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт2 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт2
	|			КОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт3 ССЫЛКА Справочник.СтатьиЗатрат
	|				ТОГДА ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт3
	|			ИНАЧЕ &ПустаяСтатьяЗатрат
	|		КОНЕЦ КАК СтатьяЗатрат
	|	ИЗ
	|		Документ.ОтражениеЗарплатыВРеглУчете.ОтражениеВУчете КАК ОтражениеЗарплатыВРеглУчетеОтражениеВУчете
	|	ГДЕ
	|		ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка = &парамРегистратор
	|		И ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Сумма <> 0) КАК ОтражениеЗарплатыВРеглУчетеОтражениеВУчете
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки");
	
	Запрос.УстановитьПараметр("парамРегистратор", Ссылка);
	Запрос.УстановитьПараметр("СчетаИсключения", СчетаИсключения);
	Запрос.УстановитьПараметр("ПустаяСтатьяЗатрат", Справочники.СтатьиЗатрат.ПустаяСсылка());
	
	Возврат Запрос.Выполнить();
	
КонецФункции

// Проверяет правильность заполнения шапки документа.
// Если какой-то из реквизтов шапки, влияющий на проведение не заполнен или
// заполнен не корректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса по шапке,
// все проверяемые реквизиты должны быть включены в выборку по шапке.
//
// Параметры: 
//  ВыборкаПоШапкеДокумента	- выборка из результата запроса по шапке документа,
//  Отказ 					- флаг отказа в проведении,
//	Заголовок				- Заголовок для сообщений об ошибках проведения.
//
Процедура ПроверитьЗаполнениеШапки(Отказ, Заголовок)
	
	Если НЕ ЗначениеЗаполнено(Организация) Тогда
		ОбщегоНазначения.СообщитьОбОшибке("Не задана организация!", Отказ, Заголовок);
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ПериодРегистрации) Тогда
		ОбщегоНазначения.СообщитьОбОшибке("Не задан период за который выполняется отражение начислений в бухгалтерском учете!", Отказ, Заголовок);
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеШапки()

Процедура ПроверитьЗаполнениеСтрокиОтраженияВУчете(ВыборкаПоДоходам, Отказ, ПроверятьСочетание, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоДоходам.НомерСтроки) + """ табл. части ""Проводки"": ";
	
	Если ВыборкаПоДоходам.СчетДт.Пустая() Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "Не указан счет дебета!", Отказ, Заголовок);
		ПроверятьСочетание = Ложь;
	КонецЕсли;
	
	Если ВыборкаПоДоходам.СчетКт.Пустая() Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "Не указан счет кредита!", Отказ, Заголовок);
		ПроверятьСочетание = Ложь;
	КонецЕсли;
	
	//Сообщение = "";
	//Если ПроверятьСочетание И ВыборкаПоДоходам.ОтражаетсяНУ И Не КорректноеСочетаниеСчетовНУ(ВыборкаПоДоходам.СчетДт,ВыборкаПоДоходам.НаименованиеСчетДт,ВыборкаПоДоходам.СчетКт,ВыборкаПоДоходам.СчетДтНУ, ВыборкаПоДоходам.СчетКтНУ, ВыборкаПоДоходам.СтатьяЗатратЕНВД, Сообщение) Тогда
	//	ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + Сообщение, Отказ, Заголовок);
	//КонецЕсли;
	
КонецПроцедуры

Процедура ПроверитьЗаполнениеСтрокиДохода(ВыборкаПоДоходам, Отказ, ПроверятьСочетание, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоДоходам.НомерСтроки) +
	""" табл. части "+ВыборкаПоДоходам.ТипСтроки+": ";
	
	Если ВыборкаПоДоходам.ВидРасчета.Пустая() Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "Не указан вид расчета!", Отказ, Заголовок);
	КонецЕсли;
	
	Если ВыборкаПоДоходам.Сотрудник.Пустая() Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "Не указан сотрудник!", Отказ, Заголовок);
	КонецЕсли;
	
	Если ВыборкаПоДоходам.СчетДт.Пустая() Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "Не указан счет дебета!", Отказ, Заголовок);
		ПроверятьСочетание = Ложь;
	КонецЕсли;
	
	Если ВыборкаПоДоходам.СчетКт.Пустая() Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "Не указан счет кредита!", Отказ, Заголовок);
		ПроверятьСочетание = Ложь;
	КонецЕсли;
	
	Сообщение = "";
	//Если ПроверятьСочетание  И Не КорректноеСочетаниеСчетовНУ(ВыборкаПоДоходам.СчетДт,ВыборкаПоДоходам.НаименованиеСчетДт,ВыборкаПоДоходам.СчетКт,ВыборкаПоДоходам.СчетДтНУ, ВыборкаПоДоходам.СчетКтНУ, Сообщение) Тогда
	//	ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + Сообщение, Отказ, Заголовок);
	//КонецЕсли;
	
	Если ВыборкаПоДоходам.ТипСтроки = "Основные" Тогда
		
		Если Не ЗначениеЗаполнено(ВыборкаПоДоходам.ПериодДействияНачало) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала!", Отказ, Заголовок);
		КонецЕсли;
		
		Если Не ЗначениеЗаполнено(ВыборкаПоДоходам.ПериодДействияКонец) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата окончания!", Отказ, Заголовок);
		КонецЕсли;
		
		Если ЗначениеЗаполнено(ВыборкаПоДоходам.ПериодДействияКонец) и ЗначениеЗаполнено(ВыборкаПоДоходам.ПериодДействияНачало) Тогда
			Если ВыборкаПоДоходам.ПериодДействияКонец < ВыборкаПоДоходам.ПериодДействияНачало Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "дата окончания не должна быть меньше даты начала!", Отказ, Заголовок);
			ИначеЕсли НачалоМесяца(ВыборкаПоДоходам.ПериодДействияКонец) <> НачалоМесяца(ВыборкаПоДоходам.ПериодДействияНачало) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "даты начала и окончания должны принадлежать одному месяцу!", Отказ, Заголовок);
			КонецЕсли;
		КонецЕсли;
		
	КонецЕсли;
	
	// Организация сотрудника должна совпадать с организацией документа
	Если ВыборкаПоДоходам.ОшибкаНеСоответствиеСотрудникаИОрганизации Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "указанный сотрудник оформлен на другую организацию!", Отказ, Заголовок);
	КонецЕсли;
	
КонецПроцедуры

// Добавляет движение в наборы записей БУОсновныеНачисления и БУДополнительныеНачисления
// Параметры:
//	ВыборкаПоДоходам - спозиционированнная выборка по данным документа
//	НаборЗаписейОсновные - набор записей типа БУОсновныеНачисления
//	НаборЗаписейДополнительные - набор записей типа БУДополнительныеНачисления
//
Процедура ДобавитьСтрокуВДвиженияПоДоходам(ВыборкаПоДоходам, НаборЗаписейОсновные, НаборЗаписейДополнительные)
	
	Если ВыборкаПоДоходам.ТипСтроки = "Основные" Тогда
		// ОсновныеНачисленияРаботниковОрганизации
		Строка = НаборЗаписейОсновные.Добавить();
		
		// свойства
		Строка.ПериодДействияНачало = ВыборкаПоДоходам.ПериодДействияНачало;
		Строка.ПериодДействияКонец  = КонецДня(ВыборкаПоДоходам.ПериодДействияКонец);
		
		// реквизиты
		Строка.ГрафикРаботы = ВыборкаПоДоходам.ГрафикРаботы;
		Строка.ВидУчетаВремени = ПроведениеРасчетов.ПолучитьВидУчетаВремени(ВыборкаПоДоходам.СпособРасчета, ВыборкаПоДоходам.СуммированныйУчетРабочегоВремени);
	Иначе
		
		Строка = НаборЗаписейДополнительные.Добавить();
		
		//Аверсон ЕАЕ 23.06.2022 СВФР-009233
		Строка.БазовыйПериодНачало = ВыборкаПоДоходам.БазовыйПериодНачало;
		Строка.БазовыйПериодКонец  = КонецДня(ВыборкаПоДоходам.БазовыйПериодКонец);
		//Аверсон СВФР-009233
	КонецЕсли;
	
	// свойства
	Строка.ВидРасчета			= ВыборкаПоДоходам.ВидРасчета;
	Строка.ПериодРегистрации	= ПериодРегистрации;
	
	// Измерения
	Строка.Сотрудник			= ВыборкаПоДоходам.Сотрудник;
	Строка.Физлицо				= ВыборкаПоДоходам.Физлицо;
	Строка.Организация			= ВыборкаПоДоходам.ГоловнаяОрганизация;
	
	// ресурсы
	Строка.Результат			= ВыборкаПоДоходам.Результат;
	
	// реквизиты
	Строка.СчетДт = ВыборкаПоДоходам.СчетДт;
	Строка.СчетКт = ВыборкаПоДоходам.СчетКт;
	Строка.СубконтоДт1 = ВыборкаПоДоходам.СубконтоДт1;
	Строка.СубконтоДт2 = ВыборкаПоДоходам.СубконтоДт2;
	Строка.СубконтоДт3 = ВыборкаПоДоходам.СубконтоДт3;
	Строка.СубконтоКт1 = ВыборкаПоДоходам.СубконтоКт1;
	Строка.СубконтоКт2 = ВыборкаПоДоходам.СубконтоКт2;
	Строка.СубконтоКт3 = ВыборкаПоДоходам.СубконтоКт3;
	Строка.СчетДтНУ = ВыборкаПоДоходам.СчетДтНУ;
	Строка.СчетКтНУ = ВыборкаПоДоходам.СчетКтНУ;
	Строка.СубконтоДтНУ1 = ВыборкаПоДоходам.СубконтоДтНУ1;
	Строка.СубконтоДтНУ2 = ВыборкаПоДоходам.СубконтоДтНУ2;
	Строка.СубконтоДтНУ3 = ВыборкаПоДоходам.СубконтоДтНУ3;
	Строка.СубконтоКтНУ1 = ВыборкаПоДоходам.СубконтоКтНУ1;
	Строка.СубконтоКтНУ2 = ВыборкаПоДоходам.СубконтоКтНУ2;
	Строка.СубконтоКтНУ3 = ВыборкаПоДоходам.СубконтоКтНУ3;
	//Строка.СчетКтУСН = ВыборкаПоДоходам.СчетКтУСН;
	//Строка.ОтражениеВУСН = ВыборкаПоДоходам.ОтражениеВУСН;
	
	Строка.ОбособленноеПодразделение = Организация;
	
КонецПроцедуры  // ДобавитьСтрокуВДвиженияПоДоходам

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ

Процедура ОбработкаПроведения(Отказ, Режим)
	
	Для Каждого Набор Из Движения Цикл
		Набор.Очистить();
	КонецЦикла;
	
	// Заголовок для сообщений об ошибках проведения.
	Заголовок = ОбщегоНазначения.ПредставлениеДокументаПриПроведении(Ссылка);
	
	ПроверитьЗаполнениеШапки(Отказ, Заголовок);
	
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	// определим налоговый режим
	БухгалтерскийИНалоговыйУчет.ОбновитьДанныеУчетнойПолитикиПоНалоговомуУчету(глЗначениеПеременной("глУчетнаяПолитикаПоНалоговомуУчету"), КонецМесяца(ПериодРегистрации), Организация);
	УчетнаяПолитика = глЗначениеПеременной("глУчетнаяПолитикаПоНалоговомуУчету")[КонецМесяца(ПериодРегистрации)][Организация];
	
	ВыборкаПоДоходам = СформироватьЗапросПоДоходам().Выбрать();
	
	Пока ВыборкаПоДоходам.Следующий() Цикл
		ПроверитьЗаполнениеСтрокиДохода(ВыборкаПоДоходам, Отказ, Не УчетнаяПолитика.УСН, Заголовок);
		Если Не Отказ Тогда
			ДобавитьСтрокуВДвиженияПоДоходам(ВыборкаПоДоходам, Движения.БУОсновныеНачисления, Движения.БУДополнительныеНачисления);
		КонецЕсли;
	КонецЦикла;
	
	ВыборкаПоОтражениюВУчете = СформироватьЗапросПоОтражениюВУчете().Выбрать();
	ВалютаРеглУчета  = Константы.ВалютаРегламентированногоУчета.Получить();
	
	Пока ВыборкаПоОтражениюВУчете.Следующий() Цикл
		
		ПроверитьЗаполнениеСтрокиОтраженияВУчете(ВыборкаПоОтражениюВУчете, Отказ,  Не УчетнаяПолитика.УСН);
		
	КонецЦикла;
	
КонецПроцедуры // ОбработкаПроведения

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(ОсновныеНачисления, ДополнительныеНачисления);
	
КонецПроцедуры

Процедура ОбработкаУдаленияПроведения(Отказ)
	Для Каждого Набор Из Движения Цикл
		Набор.Очистить();
		Набор.Записать();
	КонецЦикла
КонецПроцедуры

Процедура ВыполнитьПроверкуСотрудников() Экспорт //О.Т. 26.09.2014 № 224
	Запрос = Новый Запрос;
	ТекстыЗапросовФСЗН = ПолучитьЗапросДляФСЗН();
	Запрос.Текст = ТекстыЗапросовФСЗН.КоэффициентыОтраженияЕСНТекст;
	Запрос.УстановитьПараметр("парамОрганизация", Организация);
	Запрос.УстановитьПараметр("РасчетФСЗНотБПМ", РасчетФСЗНотБПМ);
	Запрос.УстановитьПараметр("парамБПМ", РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,
	Новый Структура("Видпараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.БПМ)).Размер);
	Запрос.УстановитьПараметр("парамНачалоПериода", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамПериод", НачалоМесяца(ПериодРегистрации));
	
	Запрос.УстановитьПараметр("Счет97", ПланыСчетов.Хозрасчетный.РасходыНаОплатуТрудаБудущихПериодов);
	Запрос.УстановитьПараметр("СчетН97", ПланыСчетов.Налоговый.РасходыНаОплатуТрудаБудущихПериодов);
	
	Запрос.УстановитьПараметр("РБПНаОплатуТруда", Справочники.РасходыБудущихПериодов.РБПНаОплатуТруда);
	Запрос.УстановитьПараметр("ОтпускБудПериода", Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.ОплатаОтпускаБуд);
	СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("ВидОтчисления",Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд));
	//Островская Татьяна 10.09.2013 № 16725
	РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
	//Островская Татьяна 10.09.2013 № 16725
	БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
	Запрос.УстановитьПараметр("Ограничение", БазаОграниченияФСЗН);
	
	Запрос.УстановитьПараметр("ПустаяСсылкаВидНалогообложения",Справочники.ВидыНалогообложения.ПустаяСсылка());
	Запрос.УстановитьПараметр("ПериодДляОграничения", КонецМесяца(ПериодРегистрации)); //О.Т. Аверсон 25.03.2016 № 950
	
	//+ СВЭЙ КДЯ 13.11.19 СВФР-005042
	Запрос.УстановитьПараметр( "ПодразделениеОрганизации", ПодразделениеОрганизации );
	//- СВЭЙ КДЯ 13.11.19 СВФР-005042
	
	Выборка = Запрос.Выполнить().Выгрузить();
	Для Каждого СтрВыборка из Выборка Цикл 
		если СтрВыборка.БазаСтрах <> СтрВыборка.БазаСтрахБУ Тогда 
			Сообщить("Не совпадают базы у физлица "+СтрВыборка.ФизЛицо+"!");
		КонецЕсли;	
	КонецЦикла;
	
	
КонецПроцедуры //О.Т. 26.09.2014 № 224

Функция ПроверкаДоговораПодряда(ФЛ,ПериодРег,СчетДт) //Аверсон 15.10.2020 КВВ СВФР-006691 (добавлен СчетДт)
	//Аверсон 29.06.2020 КВВ СВФР-006178 (
	З = Новый Запрос;
	З.Текст = "ВЫБРАТЬ
	|ДопНач.Регистратор
	|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДопНач
	|ГДЕ ДопНач.ФизЛицо = &ФЛ
	|И ДопНач.Результат <> 0
	|И ДопНач.ПериодРегистрации МЕЖДУ &НачРег И &КонРег
	//Аверсон 15.10.2020 КВВ СВФР-006691 (
	|И (ВЫБОР КОГДА ДопНач.ДокументОснование.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|		  	ТОГДА ДопНач.ДокументОснование.СпособОтраженияВБухучете.СчетДт
	|		  КОГДА ДопНач.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|		  	ТОГДА ДопНач.ВидРасчета.СпособОтраженияВБухучете.СчетДт 
	|	КОНЕЦ) = &СчетДт
	//Аверсон 15.10.2020 КВВ СВФР-006691 )
	|И ДопНач.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой)";
	З.УстановитьПараметр("ФЛ", ФЛ);
	З.УстановитьПараметр("НачРег",НачалоМесяца(ПериодРег));
	З.УстановитьПараметр("КонРег",КонецМесяца(ПериодРег));
	З.УстановитьПараметр("СчетДт",СчетДт);  //Аверсон 15.10.2020 КВВ СВФР-006691
	З.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());  //Аверсон 15.10.2020 КВВ СВФР-006691
	РезЗ = З.Выполнить().Выбрать();
	Если РезЗ.Следующий() Тогда
		Возврат Истина;
	Иначе
		Возврат Ложь;
	КонецЕсли;
	//Аверсон 29.06.2020 КВВ СВФР-006178 )
КонецФункции

Функция УдалитьПовторяющиесяЭлементыМассива(Массив,Способ) Экспорт 
	//Аверсон 28.07.2020 КВВ СВФР-006325 (
	ТекущийИндекс = 0; 
	ВсегоЭлементов = Массив.Количество(); 
	Пока ТекущийИндекс < ВсегоЭлементов Цикл 
		Индекс2 = ТекущийИндекс + 1; 
		Пока Индекс2 < ВсегоЭлементов Цикл 
			Если Способ = 1 Тогда
				Если Массив[Индекс2] = Массив[ТекущийИндекс] Тогда 
					Массив.Удалить(Индекс2); 
					ВсегоЭлементов = ВсегоЭлементов - 1; 
				Иначе 
					Индекс2 = Индекс2 + 1; 
				КонецЕсли; 
			ИначеЕсли Способ = 2 Тогда
				Если Массив[Индекс2].ДоляСпособаОтражения = Массив[ТекущийИндекс].ДоляСпособаОтражения 
					И Массив[Индекс2].ЕдиныйПлатеж = Массив[ТекущийИндекс].ЕдиныйПлатеж 
					И Массив[Индекс2].ОбязательноеСтрахование = Массив[ТекущийИндекс].ОбязательноеСтрахование 
					И Массив[Индекс2].СубконтоДт1 = Массив[ТекущийИндекс].СубконтоДт1
					И Массив[Индекс2].СубконтоДт2 = Массив[ТекущийИндекс].СубконтоДт2 
					И Массив[Индекс2].СчетДт = Массив[ТекущийИндекс].СчетДт
					И Массив[Индекс2].ФСЗН = Массив[ТекущийИндекс].ФСЗН 
					И Массив[Индекс2].ФизЛицо = Массив[ТекущийИндекс].ФизЛицо Тогда 
					Массив.Удалить(Индекс2); 
					ВсегоЭлементов = ВсегоЭлементов - 1; 
				Иначе 
					Индекс2 = Индекс2 + 1; 
				КонецЕсли; 
			ИначеЕсли Способ = 3 Тогда
				Если Массив[Индекс2].ДоляСпособаОтражения = Массив[ТекущийИндекс].ДоляСпособаОтражения 
					И Массив[Индекс2].ЕдиныйПлатеж = Массив[ТекущийИндекс].ЕдиныйПлатеж 
					И Массив[Индекс2].ОбязательноеСтрахование = Массив[ТекущийИндекс].ОбязательноеСтрахование 
					//И Массив[Индекс2].СубконтоДт1 = Массив[ТекущийИндекс].СубконтоДт1
					И Массив[Индекс2].СубконтоДт2 = Массив[ТекущийИндекс].СубконтоДт2 
					И Массив[Индекс2].СчетДт = Массив[ТекущийИндекс].СчетДт
					И Массив[Индекс2].ФСЗН = Массив[ТекущийИндекс].ФСЗН 
					И Массив[Индекс2].ФизЛицо = Массив[ТекущийИндекс].ФизЛицо Тогда 
					Массив.Удалить(Индекс2); 
					ВсегоЭлементов = ВсегоЭлементов - 1; 
				Иначе 
					Индекс2 = Индекс2 + 1; 
				КонецЕсли; 
			ИначеЕсли Способ = 4 Тогда
				Если Массив[Индекс2].ФизЛицо = Массив[ТекущийИндекс].ФизЛицо 
					И Массив[Индекс2].ОбязательноеСтрахование = Массив[ТекущийИндекс].ОбязательноеСтрахование 
					И Массив[Индекс2].ЕдиныйПлатеж = Массив[ТекущийИндекс].ЕдиныйПлатеж 
					И Массив[Индекс2].ФСЗН = Массив[ТекущийИндекс].ФСЗН
					И Массив[Индекс2].ДоляСпособаОтражения = Массив[ТекущийИндекс].ДоляСпособаОтражения 
					И Массив[Индекс2].СчетДт = Массив[ТекущийИндекс].СчетДт
					И Массив[Индекс2].СубконтоДт2 = Массив[ТекущийИндекс].СубконтоДт2 Тогда 
					Массив.Удалить(Индекс2); 
					ВсегоЭлементов = ВсегоЭлементов - 1; 
				Иначе 
					Индекс2 = Индекс2 + 1; 
				КонецЕсли; 
				
			КонецЕсли;
		КонецЦикла; 
		ТекущийИндекс = ТекущийИндекс + 1; 
	КонецЦикла; 
	Возврат Массив; 
	//Аверсон 28.07.2020 КВВ СВФР-006325 )
КонецФункции  

Функция РазницаТаблицЗначений(Таблица0, Таблица1, Измерения) Экспорт
	//Аверсон 31.07.2020 КВВ СВФР-006325 (
	ВсеКолонки = "";
	Для Каждого Колонка Из Таблица0.Колонки Цикл 
		ВсеКолонки = ВсеКолонки + ", " + Колонка.Имя
	КонецЦикла;
	ВсеКолонки = Сред(ВсеКолонки, 2);
	
	Таблица = Таблица1.Скопировать();    
	
	Таблица.Колонки.Добавить("Знак", Новый ОписаниеТипов("Число"));
	
	Таблица.ЗаполнитьЗначения(1, "Знак");
	
	Для ё = 1 По Таблица0.Количество() Цикл Таблица.Вставить(0) КонецЦикла;
	
	Для ё = 0 По Таблица0.Колонки.Количество() - 1 Цикл Таблица.ЗагрузитьКолонку(Таблица0.ВыгрузитьКолонку(ё), ё) КонецЦикла;
	
	Таблица.Колонки.Добавить("Счёт");
	Таблица.ЗаполнитьЗначения(1, "Счёт");
	
	Таблица.Свернуть(ВсеКолонки, "Знак, Счёт");
	
	Ответ = Таблица.Скопировать(Новый Структура("Счёт", 1), ВсеКолонки + ", Знак");
	
	Ответ.Сортировать(Измерения);
	
	Возврат Ответ
	//Аверсон 31.07.2020 КВВ СВФР-006325 )
КонецФункции

Процедура ЗапросПоОтпускамДругогоПериодаРегистрации(ОтражениеВБУ,парамПериод_,ПодразделениеОрганизации_)
	//Аверсон 12.08.2020 КВВ СВФР-006325 (
	З = Новый Запрос;
	//	//Аверсон 19.08.2020 КВВ СВФР-006325 (
	//	З_Текст = "ВЫБРАТЬ 
	//	|	ЕСНОсновныеНачисления.ФизЛицо,	
	//	|	ЕСНОсновныеНачисления.СчетДт,	
	//	|	ЕСНОсновныеНачисления.СубконтоДт1,	
	//	|	ЕСНОсновныеНачисления.СубконтоДт2,	
	//	|	ЕСНОсновныеНачисления.СубконтоДт3,	
	//	|	ЕСНОсновныеНачисления.СчетДтНУ,	
	//	|	ЕСНОсновныеНачисления.СубконтоДтНУ1,	
	//	|	ЕСНОсновныеНачисления.СубконтоДтНУ2,	
	//	|	ЕСНОсновныеНачисления.СубконтоДтНУ3,
	//	|	ЕСНОсновныеНачисления.СчетДт КАК СчетДт_ДляПодстановки,	
	//	|	ЕСНОсновныеНачисления.СубконтоДт1 КАК СубконтоДт1_ДляПодстановки,
	//	|	ЕСНОсновныеНачисления.СубконтоДт2 КАК СубконтоДт2_ДляПодстановки,
	//	|	ЕСНОсновныеНачисления.СубконтоДт3 КАК СубконтоДт3_ДляПодстановки,	
	//	|	ЕСНОсновныеНачисления.СчетДтНУ КАК СчетДтНУ_ДляПодстановки,	
	//	|	ЕСНОсновныеНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1_ДляПодстановки,	
	//	|	ЕСНОсновныеНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2_ДляПодстановки,	
	//	|	ЕСНОсновныеНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3_ДляПодстановки,
	//	|	ВЫБОР
	//	|		КОГДА ЕСНОсновныеНачисления.ПериодДействияНачало <= ЕСНОсновныеНачисления.ПериодРегистрации
	//	|			ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации
	//	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ)
	//	|		КОНЕЦ КАК ПериодРегистрации,
	//	|	ЕСНОсновныеНачисления.ПериодДействия,
	//	|	ЕСНОсновныеНачисления.ВидРасчета,
	//	|	0 КАК ФлагДля97Сч,
	//	|	0 КАК ВспомогательныйСчет
	//	|ИЗ РегистрРасчета.БУОсновныеНачисления КАК ЕСНОсновныеНачисления
	//	|	ГДЕ НАЧАЛОПЕРИОДА(ЕСНОсновныеНачисления.ПериодРегистрации, МЕСЯЦ) = &парамПериод
	//	|	И ЕСНОсновныеНачисления.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)
	//	|	И ЕСНОсновныеНачисления.ПериодРегистрации > НАЧАЛОПЕРИОДА(ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ)
	//	|	И ЕСНОсновныеНачисления.Результат < 0";
	//	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
	//		З_Текст = З_Текст + "
	//		|И ЕСНОсновныеНачисления.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
	//	КонецЕсли;
	//	З_Текст = З_Текст + "
	//	|СГРУППИРОВАТЬ ПО
	//	|ЕСНОсновныеНачисления.ФизЛицо,	
	//	|ЕСНОсновныеНачисления.СчетДт,	
	//	|ЕСНОсновныеНачисления.СубконтоДт1,	
	//	|ЕСНОсновныеНачисления.СубконтоДт2,	
	//	|ЕСНОсновныеНачисления.СубконтоДт3,	
	//	|ЕСНОсновныеНачисления.СчетДтНУ,	
	//	|ЕСНОсновныеНачисления.СубконтоДтНУ1,	
	//	|ЕСНОсновныеНачисления.СубконтоДтНУ2,	
	//	|ЕСНОсновныеНачисления.СубконтоДтНУ3,
	//	|ЕСНОсновныеНачисления.СчетДт,	
	//	|ЕСНОсновныеНачисления.СубконтоДт1,
	//	|ЕСНОсновныеНачисления.СубконтоДт2,
	//	|ЕСНОсновныеНачисления.СубконтоДт3,	
	//	|ЕСНОсновныеНачисления.СчетДтНУ,	
	//	|ЕСНОсновныеНачисления.СубконтоДтНУ1,	
	//	|ЕСНОсновныеНачисления.СубконтоДтНУ2,	
	//	|ЕСНОсновныеНачисления.СубконтоДтНУ3,
	//	|ВЫБОР
	//	|	КОГДА ЕСНОсновныеНачисления.ПериодДействияНачало <= ЕСНОсновныеНачисления.ПериодРегистрации
	//	|		ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации
	//	|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ)
	//	|	КОНЕЦ,
	//	|ЕСНОсновныеНачисления.ПериодДействия,
	//	|ЕСНОсновныеНачисления.ВидРасчета,
	//	|0,
	//	|0	
	//	|	
	//	|	ОБЪЕДИНИТЬ ВСЕ
	//	|
	//	|";	
	////Аверсон 19.08.2020 КВВ СВФР-006325 )	
	
	З_Текст = "ВЫБРАТЬ 
	|ЕСНОсновныеНачисления.ФизЛицо,	
	|ЕСНОсновныеНачисления.СчетДт,	
	|ЕСНОсновныеНачисления.СубконтоДт1,	
	|ЕСНОсновныеНачисления.СубконтоДт2,	
	|ЕСНОсновныеНачисления.СубконтоДт3,	
	|ЕСНОсновныеНачисления.СчетДтНУ,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ1,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ2,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ3,
	|ЕСНОсновныеНачисления.СчетДт КАК СчетДт_ДляПодстановки,	
	|ЕСНОсновныеНачисления.СубконтоДт1 КАК СубконтоДт1_ДляПодстановки,
	|ЕСНОсновныеНачисления.СубконтоДт2 КАК СубконтоДт2_ДляПодстановки,
	|ЕСНОсновныеНачисления.СубконтоДт3 КАК СубконтоДт3_ДляПодстановки,	
	|ЕСНОсновныеНачисления.СчетДтНУ КАК СчетДтНУ_ДляПодстановки,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1_ДляПодстановки,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2_ДляПодстановки,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3_ДляПодстановки,
	|ВЫБОР
	|	КОГДА ЕСНОсновныеНачисления.ПериодДействияНачало <= ЕСНОсновныеНачисления.ПериодРегистрации
	|		ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации
	|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ)
	|	КОНЕЦ КАК ПериодРегистрации,
	|ЕСНОсновныеНачисления.ПериодДействия,
	|ЕСНОсновныеНачисления.ВидРасчета,
	|0 КАК ФлагДля97Сч,
	|0 КАК ВспомогательныйСчет
	|
	|ИЗ РегистрРасчета.БУОсновныеНачисления КАК ЕСНОсновныеНачисления
	|ГДЕ НАЧАЛОПЕРИОДА(ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ) = &парамПериод
	|И ЕСНОсновныеНачисления.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)
	|И ЕСНОсновныеНачисления.ПериодРегистрации < НАЧАЛОПЕРИОДА(ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ)
	|И ЕСНОсновныеНачисления.Организация = &Организация";  //Аверсон 17.09.2020 КВВ СВФР-006585
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
		З_Текст = З_Текст + "
		|И ЕСНОсновныеНачисления.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
	КонецЕсли;
	
	//Аверсон 15.08.2020 КВВ СВФР-006325 (
	З_Текст = З_Текст + "
	|СГРУППИРОВАТЬ ПО
	|ЕСНОсновныеНачисления.ФизЛицо,	
	|ЕСНОсновныеНачисления.СчетДт,	
	|ЕСНОсновныеНачисления.СубконтоДт1,	
	|ЕСНОсновныеНачисления.СубконтоДт2,	
	|ЕСНОсновныеНачисления.СубконтоДт3,	
	|ЕСНОсновныеНачисления.СчетДтНУ,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ1,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ2,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ3,
	|ЕСНОсновныеНачисления.СчетДт,	
	|ЕСНОсновныеНачисления.СубконтоДт1,
	|ЕСНОсновныеНачисления.СубконтоДт2,
	|ЕСНОсновныеНачисления.СубконтоДт3,	
	|ЕСНОсновныеНачисления.СчетДтНУ,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ1,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ2,	
	|ЕСНОсновныеНачисления.СубконтоДтНУ3,
	|ВЫБОР
	|	КОГДА ЕСНОсновныеНачисления.ПериодДействияНачало <= ЕСНОсновныеНачисления.ПериодРегистрации
	|		ТОГДА ЕСНОсновныеНачисления.ПериодРегистрации
	|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНОсновныеНачисления.ПериодДействияНачало, МЕСЯЦ)
	|	КОНЕЦ,
	|ЕСНОсновныеНачисления.ПериодДействия,
	|ЕСНОсновныеНачисления.ВидРасчета,
	|0,
	|0";
	//Аверсон 15.08.2020 КВВ СВФР-006325 )
	
	З.Текст = З_Текст;
	З.УстановитьПараметр("парамПериод",парамПериод_);
	З.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации_);
	З.УстановитьПараметр("Организация", Организация);  //Аверсон 17.09.2020 КВВ СВФР-006585
	РезЗ = З.Выполнить().Выгрузить();
	Сч = 0;
	Если РезЗ.Количество() > 0 Тогда
		//Сообщить("Кол-во по запросу по отпускам др.периода = " + СокрЛП(РезЗ.Количество()));
		Для Каждого СтрРезЗ ИЗ РезЗ Цикл
			СтрОтбора = Новый Структура;
			СтрОтбора.Вставить("ФизЛицо", СтрРезЗ.ФизЛицо);
			СтрОтбора.Вставить("СчетДт", СтрРезЗ.СчетДт);
			СтрОтбора.Вставить("СубконтоДт1", СтрРезЗ.СубконтоДт1);	
			СтрОтбора.Вставить("СубконтоДт2", СтрРезЗ.СубконтоДт2);	
			СтрОтбора.Вставить("СубконтоДт3", СтрРезЗ.СубконтоДт3);	
			СтрОтбора.Вставить("СчетДтНУ", СтрРезЗ.СчетДтНУ);	
			СтрОтбора.Вставить("СубконтоДтНУ1", СтрРезЗ.СубконтоДтНУ1);	
			СтрОтбора.Вставить("СубконтоДтНУ2", СтрРезЗ.СубконтоДтНУ2);	
			СтрОтбора.Вставить("СубконтоДтНУ3", СтрРезЗ.СубконтоДтНУ3);	
			СтрОтбора.Вставить("СчетДт_ДляПодстановки", СтрРезЗ.СчетДт_ДляПодстановки);	
			СтрОтбора.Вставить("СубконтоДт1_ДляПодстановки", СтрРезЗ.СубконтоДт1_ДляПодстановки);	
			СтрОтбора.Вставить("СубконтоДт2_ДляПодстановки", СтрРезЗ.СубконтоДт2_ДляПодстановки);	
			СтрОтбора.Вставить("СубконтоДт3_ДляПодстановки", СтрРезЗ.СубконтоДт3_ДляПодстановки);	
			СтрОтбора.Вставить("СчетДтНУ_ДляПодстановки", СтрРезЗ.СчетДтНУ_ДляПодстановки);	
			СтрОтбора.Вставить("СубконтоДтНУ1_ДляПодстановки", СтрРезЗ.СубконтоДтНУ1_ДляПодстановки);	
			СтрОтбора.Вставить("СубконтоДтНУ2_ДляПодстановки", СтрРезЗ.СубконтоДтНУ2_ДляПодстановки);	
			СтрОтбора.Вставить("СубконтоДтНУ3_ДляПодстановки", СтрРезЗ.СубконтоДтНУ3_ДляПодстановки);	
			СтрОтбора.Вставить("ПериодРегистрации", СтрРезЗ.ПериодРегистрации);	
			СтрОтбора.Вставить("ПериодДействия", СтрРезЗ.ПериодДействия);	
			СтрОтбора.Вставить("ВидРасчета", СтрРезЗ.ВидРасчета);	
			
			РезОтбора = ОтражениеВБУ.НайтиСтроки(СтрОтбора);
			Если РезОтбора.Количество() = 0 Тогда
				Сч = Сч + 1;	
				СтрОтражениеВБУ = ОтражениеВБУ.Добавить();
				ЗаполнитьЗначенияСвойств(СтрОтражениеВБУ,СтрРезЗ);
				//Иначе
				//	Сообщить ("не взяли " + СокрЛП(СтрРезЗ.ФизЛицо));
			КонецЕсли;	
		КонецЦикла;
		//Сообщить("Кол-во добавленных в ОтражениеВБУ = " + СокрЛП(Сч));
	КонецЕсли;
	//Аверсон 12.08.2020 КВВ СВФР-006325 )
КонецПроцедуры

//Аверсон ЕАЕ 22.08.2022 СВФР-009450
Функция ПолучитьТЗОтпускаБудущихПериодов()
	зПрибыль = Новый Запрос;
	зПрибыль.Текст = 
	"ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СчетДт //О.Т. Аверсон 19.03.2018 № 1737
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДт
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДт
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
	|	КОНЕЦ КАК СчетДт,
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1.Наименование, 0) = 0 //О.Т. Аверсон 12.06.2018 № 1946
	|			ТОГДА ВложенныйЗапрос.СубконтоДт1
	|		ИНАЧЕ ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
	|		КОНЕЦ //О.Т. Аверсон 19.03.2018 № 1737
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1.Наименование, 0) = 0 //О.Т. Аверсон 12.06.2018 № 1946
	|			ТОГДА ВложенныйЗапрос.СубконтоДт1
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт1
	|		КОНЕЦ
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1.Наименование, 0) = 0 //О.Т. Аверсон 12.06.2018 № 1946
	|			ТОГДА ВложенныйЗапрос.СубконтоДт1
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт1
	|		КОНЕЦ 
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДт2
	|		ИНАЧЕ ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
	|		КОНЕЦ //О.Т. Аверсон 19.03.2018 № 1737
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДт2
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт2
	|		КОНЕЦ 
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДт2
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт2
	|		КОНЕЦ
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДт3
	|		ИНАЧЕ ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
	|		КОНЕЦ //О.Т. Аверсон 19.03.2018 № 1737
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДт3
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДт3
	|		КОНЕЦ 
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДт3
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДт3
	|		КОНЕЦ 
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|	ВложенныйЗапрос.СчетКт,
	|	ВложенныйЗапрос.СубконтоКт1,
	|	ВложенныйЗапрос.СубконтоКт2,
	|	ВложенныйЗапрос.СубконтоКт3,
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ //О.Т. Аверсон 19.03.2018 № 1737
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СчетДтНУ
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетНУ
	|	КОНЕЦ КАК СчетДтНУ,
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ1
	|		ИНАЧЕ ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОНЕЦ //О.Т. Аверсон 19.03.2018 № 1737
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ1
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОНЕЦ    		
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ1
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОНЕЦ 
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ2
	|		ИНАЧЕ ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОНЕЦ //О.Т. Аверсон 19.03.2018 № 1737
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ2
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОНЕЦ 
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ2
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОНЕЦ 
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|	ВЫБОР
	|		КОГДА ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА ЕСТЬNULL(ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ3
	|		ИНАЧЕ ВложенныйЗапрос.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОНЕЦ //О.Т. Аверсон 19.03.2018 № 1737
	|		КОГДА УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ3
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОНЕЦ 
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|		КОГДА  ЕСТЬNULL(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3.Наименование, 0) = 0
	|			ТОГДА ВложенныйЗапрос.СубконтоДтНУ3
	|		ИНАЧЕ УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОНЕЦ 
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ВложенныйЗапрос.СчетКтНУ,
	|	ВложенныйЗапрос.СубконтоКтНУ1,
	|	ВложенныйЗапрос.СубконтоКтНУ2,
	|	ВложенныйЗапрос.СубконтоКтНУ3,
	|	ВложенныйЗапрос.СчетКтУСН,
	|	ВложенныйЗапрос.ОтражениеВУСН,
	|	ВложенныйЗапрос.Результат,
	|	ВложенныйЗапрос.ВидРасчета,
	|	ВложенныйЗапрос.ПериодДействияНачало,
	|	ВложенныйЗапрос.Месяц,
	|	ВложенныйЗапрос.Сотрудник,
	|   ВложенныйЗапрос.Сотрудник.ФизЛицо КАК ФизЛицо
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт КАК СчетДт,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1 КАК СубконтоДт1,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2 КАК СубконтоДт2,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт3 КАК СубконтоДт3,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетКт КАК СчетКт,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКт1 КАК СубконтоКт1,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКт2 КАК СубконтоКт2,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКт3 КАК СубконтоКт3,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДтНУ КАК СчетДтНУ,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетКтНУ КАК СчетКтНУ,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКтНУ1 КАК СубконтоКтНУ1,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКтНУ2 КАК СубконтоКтНУ2,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоКтНУ3 КАК СубконтоКтНУ3,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетКтУСН КАК СчетКтУСН,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ОтражениеВУСН КАК ОтражениеВУСН,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Результат КАК Результат,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.ПериодРегистрации КАК Месяц,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник КАК Сотрудник,
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.Организация КАК Организация,
	|		РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации
	|	ИЗ
	|		Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&КонДата, ) КАК РаботникиОрганизацийСрезПоследних
	|			ПО ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
	|	ГДЕ
	|		ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ПериодДействияНачало МЕЖДУ &НачДата И &КонДата
	|		И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Результат <> 0
	|		И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.Проведен = ИСТИНА
	|		И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.ПериодРегистрации < &НачДата
	|		И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)
	|		И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка.Организация = &Организация) КАК ВложенныйЗапрос
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.СрезПоследних(&КонДата) КАК УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете
	|		ПО ВложенныйЗапрос.Сотрудник = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Сотрудник
	|			И ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковОрганизацииВРегламентированномУчете.Организация
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&КонДата) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних
	|		ПО ВложенныйЗапрос.Организация = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.Организация
	|			И ВложенныйЗапрос.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизацииСрезПоследних.ПодразделениеОрганизации";
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		зПрибыль.Текст = зПрибыль.Текст +"
		|		ГДЕ
		|		ВложенныйЗапрос.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";			
	КонецЕсли;
	СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	
	зПрибыль.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
	зПрибыль.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
	зПрибыль.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
	зПрибыль.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2);
	зПрибыль.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
	зПрибыль.УстановитьПараметр("парамСпособПоУмолчаниюСчетНУ", СпособПоУмолчанию.СчетДтНУ); 	
	зПрибыль.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	зПрибыль.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	зПрибыль.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	зПрибыль.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка()); 
	зПрибыль.УстановитьПараметр("Организация", Организация);
	
	зПрибыль.УстановитьПараметр("НачДата", НачалоМесяца(ПериодРегистрации));
	зПрибыль.УстановитьПараметр("КонДата", КонецМесяца(ПериодРегистрации));
	
	тзПереходящиеОтпуска = зПрибыль.Выполнить().Выгрузить();
	
	Возврат тзПереходящиеОтпуска;
КонецФункции
//Аверсон СВФР-009450

//Аверсон ЕАЕ 25.08.2022 СВФР-009478
Функция ПолучитьДанныеСчетаДопПенсии(Орг)
	СтруктураСчетаДопПенсии = Новый Структура;
	СтруктураСчетаДопПенсии.Вставить("Счет", ПланыСчетов.Хозрасчетный.ПустаяСсылка());
	СтруктураСчетаДопПенсии.Вставить("Субконто1", Неопределено);
	СтруктураСчетаДопПенсии.Вставить("Субконто2", Неопределено);
	СтруктураСчетаДопПенсии.Вставить("Субконто3", Неопределено);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация,
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.СчетДопПенсия,
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоДопПенсия1,
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоДопПенсия2,
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.СубконтоДопПенсия3
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Орг";
	
	Запрос.УстановитьПараметр("Орг", Орг);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Если ВыборкаДетальныеЗаписи.Следующий() Тогда
		СтруктураСчетаДопПенсии.Счет = ВыборкаДетальныеЗаписи.СчетДопПенсия;
		СтруктураСчетаДопПенсии.Субконто1 = ВыборкаДетальныеЗаписи.СубконтоДопПенсия1;
		СтруктураСчетаДопПенсии.Субконто2 = ВыборкаДетальныеЗаписи.СубконтоДопПенсия2;
		СтруктураСчетаДопПенсии.Субконто3 = ВыборкаДетальныеЗаписи.СубконтоДопПенсия3;
	КонецЕсли;
	Возврат СтруктураСчетаДопПенсии;
КонецФункции
//Аверсон СВФР-009478

//Аверсон ЕАЕ 19.06.2024 СВФР-012907 Климовичи
Функция ПолучитьСчетДт(ФизЛицо, Регистратор, Сотрудник, ЭтоУдержания)
	ДанныеСчетДт = Новый Структура;
	ДанныеСчетДт.Вставить("СчетДт", ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда);
	ДанныеСчетДт.Вставить("СубконтоДт1", Справочники.ПодразделенияОрганизаций.ПустаяСсылка());
	ДанныеСчетДт.Вставить("СубконтоДт2", Справочники.СтатьиЗатрат.ПустаяСсылка());
	
	Если Сотрудник = Неопределено Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ 
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник.Физлицо = &Физлицо
		|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка = &Регистратор
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник.Физлицо = &Физлицо
		|	И НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка = &Регистратор";
		
		Запрос.УстановитьПараметр("Регистратор", Регистратор);
		Запрос.УстановитьПараметр("Физлицо", Физлицо);
		
		РезультатЗапроса = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Если ВыборкаДетальныеЗаписи.Следующий() Тогда
			Сотр = ВыборкаДетальныеЗаписи.Сотрудник;
		Иначе
			Возврат ДанныеСчетДт;
		КонецЕсли;
	Иначе
		Сотр = Сотрудник;
	КонецЕсли;
	
	//Аверсон ЕАЕ 13.08.2024
	Если Сотр.ТипРаботника <> Перечисления.ТипыРаботников.ДоговорПодряда Тогда
		ДанныеСчетДт.СчетДт = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда;
		ДанныеСчетДт.СубконтоДт1 = ФизЛицо;
		//Аверсон
		
	ИначеЕсли ЗначениеЗаполнено(Сотр.СчетУчета) Тогда
		ДанныеСчетДт.СчетДт = Сотр.СчетУчета;
	ИначеЕсли ЭтоУдержания Тогда
		ДанныеСчетДт.СчетДт = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда;
		ДанныеСчетДт.СубконтоДт1 = ФизЛицо;
	Иначе
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СчетДт,
		|   ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт1,
		|   ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.СубконтоДт2
		|ИЗ
		|	Документ.ОтражениеЗарплатыВРеглУчете.ОсновныеНачисления КАК ОтражениеЗарплатыВРеглУчетеОсновныеНачисления
		|ГДЕ
		|	ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Ссылка = &Ссылка
		|	И ОтражениеЗарплатыВРеглУчетеОсновныеНачисления.Сотрудник = &Сотрудник
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СчетДт,
		|   ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт1,
		|   ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.СубконтоДт2
		|ИЗ
		|	Документ.ОтражениеЗарплатыВРеглУчете.ДополнительныеНачисления КАК ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления
		|ГДЕ
		|	ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Сотрудник = &Сотрудник
		|	И ОтражениеЗарплатыВРеглУчетеДополнительныеНачисления.Ссылка = &Ссылка";
		
		Запрос.УстановитьПараметр("Сотрудник", Сотр);
		Запрос.УстановитьПараметр("Ссылка", Ссылка);
		
		РезультатЗапроса = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Если ВыборкаДетальныеЗаписи.Следующий() Тогда
			ДанныеСчетДт.СчетДт = ВыборкаДетальныеЗаписи.СчетДт;
			ДанныеСчетДт.СубконтоДт1 = ВыборкаДетальныеЗаписи.СубконтоДт1;
			ДанныеСчетДт.СубконтоДт2 = ВыборкаДетальныеЗаписи.СубконтоДт2;
		Иначе
			Возврат ДанныеСчетДт;
		КонецЕсли;
	КонецЕсли;
	
	Возврат ДанныеСчетДт;
	
КонецФункции
//Аверсон СВФР-012907

//Аверсон ЕАЕ 23.09.2025 СВФР-016787
Функция ПолучитьСпособОтраженияИзДокумента(Регистратор,Сотр,ПериодДействияНачало,ПериодДействияКонец,Рез,НомерСтроки)
	СпособОтражения = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка();
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
		|	Док.Сотрудник,
		|	Док.Физлицо,
		|	Док.СпособОтражения,
		|	Док.ДатаВыхода
		|ИЗ
		|	Документ.ОплатаПраздничныхИВыходныхДнейОрганизаций.Начисления КАК Док
		|ГДЕ
		|	Док.Ссылка = &Регистратор
		|	И Док.Сотрудник = &Сотр
		|	И Док.Результат = &Размер
		|	И НАЧАЛОПЕРИОДА(Док.ДатаВыхода,ДЕНЬ) = &ПериодДействияНачало
		|	И КОНЕЦПЕРИОДА(Док.ДатаВыхода,ДЕНЬ) = &ПериодДействияКонец";
	Если ТипЗнч(Регистратор) = Тип("ДокументСсылка.ОплатаСверхурочныхЧасов") Тогда
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "ОплатаПраздничныхИВыходныхДнейОрганизаций", "ОплатаСверхурочныхЧасов");
	КонецЕсли;
	Запрос.УстановитьПараметр("НомерСтроки", НомерСтроки);
	Запрос.УстановитьПараметр("ПериодДействияКонец", ПериодДействияКонец);
	Запрос.УстановитьПараметр("ПериодДействияНачало", ПериодДействияНачало);
	Запрос.УстановитьПараметр("Размер", Рез);
	Запрос.УстановитьПараметр("Регистратор", Регистратор);
	Запрос.УстановитьПараметр("Сотр", Сотр);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		СпособОтражения = ВыборкаДетальныеЗаписи.СпособОтражения;
	КонецЦикла;
	Возврат СпособОтражения;
КонецФункции
//Аверсон СВФР-016787

//Аверсон ЕАЕ 04.11.2025 СВФР-017147
Функция ПолучитьСпособОтраженияИзДокументаСделка(Регистратор,Сотр,ПериодДействияНачало,ПериодДействияКонец,Рез,НомерСтроки)
	СпособОтражения = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка();
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
		|	Док.Сотрудник,
		|	Док.Физлицо,
		|	Док.СпособОтражения,
		|	Док.ДатаНачала,
		|   Док.ДатаОкончания
		|ИЗ
		|	Документ.ПовременнаяОплатаПриСделке.РаботникиОрганизации КАК Док
		|ГДЕ
		|	Док.Ссылка = &Регистратор
		|	И Док.Сотрудник = &Сотр
		|	И Док.Результат = &Размер
		|	И Док.ДатаНачала = &ПериодДействияНачало
		|	И Док.ДатаОкончания = &ПериодДействияКонец";
	Запрос.УстановитьПараметр("ПериодДействияКонец", ПериодДействияКонец);
	Запрос.УстановитьПараметр("ПериодДействияНачало", ПериодДействияНачало);
	Запрос.УстановитьПараметр("Размер", Рез);
	Запрос.УстановитьПараметр("Регистратор", Регистратор);
	Запрос.УстановитьПараметр("Сотр", Сотр);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		СпособОтражения = ВыборкаДетальныеЗаписи.СпособОтражения;
	КонецЦикла;
	Возврат СпособОтражения;

КонецФункции
//Аверсон СВФР-017147

//Аверсон ЕАЕ 12.12.2025 СВФР-017608
Функция ВидСубконтоСчетаПроверка(Сч, НомерСубконто, ВидСубконто)
	Подходит = Ложь;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ПС.Ссылка,
		|	ПС.ВидСубконто
		|ИЗ
		|	ПланСчетов.Хозрасчетный.ВидыСубконто КАК ПС
		|ГДЕ
		|	ПС.Ссылка = &Сч
		|	И ПС.НомерСтроки = &НомерСубконто
		|	И ПС.ВидСубконто = &ВидСубконто";
	
	Запрос.УстановитьПараметр("ВидСубконто", ВидСубконто);
	Запрос.УстановитьПараметр("НомерСубконто", НомерСубконто);
	Запрос.УстановитьПараметр("Сч", Сч);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если Не РезультатЗапроса.Пустой() Тогда
		Подходит = Истина;
	КонецЕсли;
	Возврат Подходит;
КонецФункции
//Аверсон СВФР-017608

////////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ

НомерДт = 4;
НомерКт = 7;
мНомерСубконтоКонтрагентыКт = 1;
мНомерСубконтоИсполнДокументыКт = 0;
мДлинаСуток = 86400;		// в секундах

