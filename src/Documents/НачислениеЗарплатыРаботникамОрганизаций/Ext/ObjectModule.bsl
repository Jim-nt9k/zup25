////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ

// Хранит соответствие доходов и положенных по ним вычетов
Перем мСоответствиеДоходовИВычетов;
Перем ОкончаниеПериодаЗаполнения2;    //Аверсон 03.09.2019 КВВ СВФР-004691
Перем ФлагРазбиватьУдержанияПоПериодам; //+ СВЭЙ КДЯ 29.11.19 СВФР-004909
////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

#Если Клиент Тогда
	
	// Заполняет показатели
	//
	Функция ЗаполнитьПоказатели(ТекущийСотрудник) Экспорт 
		
		Если ТекущийСотрудник = Неопределено Тогда
			Возврат Ложь;
		КонецЕсли;
		
		Если Начисления.Количество() = 0 И ДополнительныеНачисления.Количество() = 0 И Удержания.Количество() = 0 Тогда
			Возврат Ложь;
		КонецЕсли;
		
		ТЗНачисления	= Начисления.Выгрузить(,"Сотрудник,ВидРасчета");
		ТЗДопНачисления	= ДополнительныеНачисления.Выгрузить(,"Сотрудник,ВидРасчета");
		ТЗУдержания		= Удержания.Выгрузить(,"ФизЛицо,ВидРасчета");
		
		Запрос = Новый Запрос;
		Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		Запрос.УстановитьПараметр("Начисления",ТЗНачисления);
		Запрос.УстановитьПараметр("ДопНачисления",ТЗДопНачисления);
		Запрос.УстановитьПараметр("Удержания",ТЗУдержания);
		Запрос.УстановитьПараметр("ПарамДата",НачалоМесяца(ПериодНачисленияДатаНачала));
		Запрос.УстановитьПараметр("ПарамГоловнаяОрганизация",ОбщегоНазначения.ГоловнаяОрганизация(Организация));
		
		// получим временную таблицу с сотрудниками и видами расчетов
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Начисления.ВидРасчета КАК ВидРасчета,
		|	Начисления.Сотрудник
		|ПОМЕСТИТЬ ВТНачисления
		|ИЗ
		|	&Начисления КАК Начисления
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ВидРасчета";
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Начисления.ВидРасчета КАК ВидРасчета,
		|	Начисления.Сотрудник
		|ПОМЕСТИТЬ ВТДопНачисления
		|ИЗ
		|	&ДопНачисления КАК Начисления
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ВидРасчета";
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Удержания.ВидРасчета,
		|	Удержания.ФизЛицо КАК ФизЛицо
		|ПОМЕСТИТЬ ВТУдержания
		|ИЗ
		|	&Удержания КАК Удержания
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо";
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СотрудникиОрганизаций.Ссылка КАК Сотрудник,
		|	СотрудникиОрганизаций.ВидДоговора,
		|	СотрудникиОрганизаций.Физлицо,
		|	СотрудникиОрганизаций.ВидЗанятости КАК ВидЗанятости
		|ПОМЕСТИТЬ ВТСотрудники
		|ИЗ
		|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
		|ГДЕ
		|	СотрудникиОрганизаций.Организация = &ПарамГоловнаяОрганизация
		|	И СотрудникиОрганизаций.Физлицо В
		|			(ВЫБРАТЬ
		|				Удержания.ФизЛицо КАК ФизЛицо
		|			ИЗ
		|				ВТУдержания КАК Удержания)
		|	И СотрудникиОрганизаций.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|	И СотрудникиОрганизаций.ВидДоговора <> ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.ДоговорУправленческий)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник";
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	РаботникиОсновноеМесто.Сотрудник КАК Сотрудник,
		|	СотрудникиОрганизаций.Физлицо КАК Физлицо,
		|	СотрудникиОрганизаций.ВидЗанятости КАК ВидЗанятости
		|ПОМЕСТИТЬ ВТДанныеОРаботниках
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
		|			&ПарамДата,
		|			Сотрудник В
		|				(ВЫБРАТЬ
		|					Сотрудники.Сотрудник
		|				ИЗ
		|					ВТСотрудники КАК Сотрудники)) КАК РаботникиОсновноеМесто
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТСотрудники КАК СотрудникиОрганизаций
		|		ПО РаботникиОсновноеМесто.Сотрудник = СотрудникиОрганизаций.Сотрудник
		|ГДЕ
		|	ВЫБОР
		|			КОГДА РаботникиОсновноеМесто.ПериодЗавершения <= &ПарамДата
		|					И РаботникиОсновноеМесто.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА РаботникиОсновноеМесто.ПричинаИзмененияСостоянияЗавершения
		|			ИНАЧЕ РаботникиОсновноеМесто.ПричинаИзмененияСостояния
		|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ВидЗанятости,
		|	Физлицо";			
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Показатели.Показатель КАК Показатель,
		|	Показатели.Показатель.ВидПоказателя КАК ВидПоказателя,
		|	Начисления.Сотрудник КАК Сотрудник
		|ИЗ
		|	ВТНачисления КАК Начисления
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели
		|		ПО Начисления.ВидРасчета = Показатели.Ссылка
		|			И ((НЕ Показатели.Показатель.Предопределенный))
		|			И (Показатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.НеИзменяется))
		|			И (Показатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ПустаяСсылка))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ОценочнаяШкалаЧисловая))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ОценочнаяШкалаПроцентная))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ТарифныйРазряд))
		|ГДЕ
		|	Показатели.Показатель ЕСТЬ НЕ NULL 
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Показатели.Показатель,
		|	Показатели.Показатель.ВидПоказателя,
		|	ДопНачисления.Сотрудник
		|ИЗ
		|	ВТДопНачисления КАК ДопНачисления
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели
		|		ПО ДопНачисления.ВидРасчета = Показатели.Ссылка
		|			И ((НЕ Показатели.Показатель.Предопределенный))
		|			И (Показатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.НеИзменяется))
		|			И (Показатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ПустаяСсылка))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ОценочнаяШкалаЧисловая))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ОценочнаяШкалаПроцентная))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ТарифныйРазряд))
		|ГДЕ
		|	Показатели.Показатель ЕСТЬ НЕ NULL 
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Показатели.Показатель,
		|	Показатели.Показатель.ВидПоказателя,
		|	Сотрудники.Сотрудник
		|ИЗ
		|	ВТУдержания КАК Удержания
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели
		|		ПО Удержания.ВидРасчета = Показатели.Ссылка
		|			И ((НЕ Показатели.Показатель.Предопределенный))
		|			И (Показатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.НеИзменяется))
		|			И (Показатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ПустаяСсылка))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ОценочнаяШкалаЧисловая))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ОценочнаяШкалаПроцентная))
		|			И (Показатели.Показатель.ТипПоказателя <> ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ТарифныйРазряд))
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			СписокСотрудников.Сотрудник КАК Сотрудник,
		|			СписокСотрудников.Физлицо КАК Физлицо
		|		ИЗ
		|			(ВЫБРАТЬ
		|				МАКСИМУМ(РаботникиОсновноеМесто.Сотрудник) КАК Сотрудник,
		|				РаботникиОсновноеМесто.Физлицо КАК Физлицо,
		|				1 КАК Приоритет
		|			ИЗ
		|				ВТДанныеОРаботниках КАК РаботникиОсновноеМесто
		|			ГДЕ
		|				РаботникиОсновноеМесто.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
		|			
		|			СГРУППИРОВАТЬ ПО
		|				РаботникиОсновноеМесто.Физлицо
		|			
		|			ОБЪЕДИНИТЬ
		|			
		|			ВЫБРАТЬ
		|				МАКСИМУМ(РаботникиСовместительство.Сотрудник),
		|				РаботникиСовместительство.Физлицо,
		|				2
		|			ИЗ
		|				ВТДанныеОРаботниках КАК РаботникиСовместительство
		|			ГДЕ
		|				РаботникиСовместительство.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.Совместительство)
		|			
		|			СГРУППИРОВАТЬ ПО
		|				РаботникиСовместительство.Физлицо
		|			
		|			ОБЪЕДИНИТЬ
		|			
		|			ВЫБРАТЬ
		|				МАКСИМУМ(СотрудникиДУ.Сотрудник),
		|				СотрудникиДУ.Физлицо,
		|				ВЫБОР
		|					КОГДА СотрудникиДУ.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.ТрудовойДоговор)
		|						ТОГДА 4
		|					ИНАЧЕ 5
		|				КОНЕЦ
		|			ИЗ
		|				ВТСотрудники КАК СотрудникиДУ
		|			
		|			СГРУППИРОВАТЬ ПО
		|				СотрудникиДУ.Физлицо,
		|				ВЫБОР
		|					КОГДА СотрудникиДУ.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.ТрудовойДоговор)
		|						ТОГДА 4
		|					ИНАЧЕ 5
		|				КОНЕЦ) КАК СписокСотрудников
		|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|					СписокФизическихЛиц.Физлицо КАК Физлицо,
		|					МИНИМУМ(СписокФизическихЛиц.Приоритет) КАК Приоритет
		|				ИЗ
		|					(ВЫБРАТЬ
		|						РаботникиОсновноеМесто.Физлицо КАК Физлицо,
		|						1 КАК Приоритет
		|					ИЗ
		|						ВТДанныеОРаботниках КАК РаботникиОсновноеМесто
		|					ГДЕ
		|						РаботникиОсновноеМесто.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
		|					
		|					ОБЪЕДИНИТЬ
		|					
		|					ВЫБРАТЬ
		|						РаботникиСовместительство.Физлицо,
		|						2
		|					ИЗ
		|						ВТДанныеОРаботниках КАК РаботникиСовместительство
		|					ГДЕ
		|						РаботникиСовместительство.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.Совместительство)
		|					
		|					ОБЪЕДИНИТЬ
		|					
		|					ВЫБРАТЬ
		|						СотрудникиДУ.Физлицо,
		|						ВЫБОР
		|							КОГДА СотрудникиДУ.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.ТрудовойДоговор)
		|								ТОГДА 4
		|							ИНАЧЕ 5
		|						КОНЕЦ
		|					ИЗ
		|						ВТСотрудники КАК СотрудникиДУ) КАК СписокФизическихЛиц
		|				
		|				СГРУППИРОВАТЬ ПО
		|					СписокФизическихЛиц.Физлицо) КАК СписокФизическихЛиц
		|				ПО СписокСотрудников.Физлицо = СписокФизическихЛиц.Физлицо
		|					И СписокСотрудников.Приоритет = СписокФизическихЛиц.Приоритет) КАК Сотрудники
		|		ПО Удержания.ФизЛицо = Сотрудники.Физлицо
		|ГДЕ
		|	Показатели.Показатель ЕСТЬ НЕ NULL 
		|	И Сотрудники.Сотрудник ЕСТЬ НЕ NULL ";
		
		Результат = Запрос.Выполнить();
		Если Результат.Пустой() Тогда
			Возврат Ложь;
		Иначе
			
			ТаблицаЗапроса = Результат.Выгрузить();
			Показатели = ТаблицаЗапроса.ВыгрузитьКолонку("Показатель");
			Сотрудники = ТаблицаЗапроса.ВыгрузитьКолонку("Сотрудник");
			
			ФормаВводаПоказателей = РегистрыСведений.ЗначенияПоказателейСхемМотивации.ПолучитьФорму("ФормаВводаЗначенийПоказателей");
			ФормаВводаПоказателей.Организация		= Организация;
			ФормаВводаПоказателей.ПериодДействия	= НачалоМесяца(ПериодНачисленияДатаНачала);
			
			ФормаВводаПоказателей.ФормаАвтозаполнение(ТаблицаЗапроса, Сотрудники, Показатели);
			ФормаВводаПоказателей.мСотрудникДляОткрытия = ТекущийСотрудник;
			ФормаВводаПоказателей.Открыть();
			
			Возврат Истина;
			
		КонецЕсли;
		
	КонецФункции //ЗаполнитьПоказатели
	
	// Функция заполняет табличный документ "РасчетныйЛисток"
	//
	// Параметры:
	//	ФизЛицо	- элемент справочника "ФизическиеЛица"
	//
	// Возвращаемое значение:
	//	Табличный документ с заполненным расчетным листком
	//
	Функция ЗаполнитьТаблицуРасчетногоЛистка(ФизЛицо) Экспорт
		
		ЗапросРЛ = Новый Запрос;
		ЗапросРЛ.УстановитьПараметр("ПериодРегистрации",			НачалоМесяца(ПериодРегистрации));
		ЗапросРЛ.УстановитьПараметр("КонецПериодаРегистрации",		КонецМесяца(ПериодРегистрации));
		ЗапросРЛ.УстановитьПараметр("Расход",						ВидДвиженияНакопления.Расход);
		Авансы = Новый Массив;
		Авансы.Добавить(Перечисления.ХарактерВыплатыЗарплаты.АвансЗаПервуюПоловинуМесяца);
		Авансы.Добавить(Перечисления.ХарактерВыплатыЗарплаты.ПлановыйАванс);
		ЗапросРЛ.УстановитьПараметр("Аванс",						Авансы);
		
		
		ЗапросРЛ.УстановитьПараметр("Организация",					Организация);
		ЗапросРЛ.УстановитьПараметр("ГоловнаяОрганизация",			ОбщегоНазначения.ГоловнаяОрганизация(Организация));
		ЗапросРЛ.УстановитьПараметр("Работник",						ФизЛицо);
		ЗапросРЛ.УстановитьПараметр("Ссылка",						Ссылка);
		
		МассивКодыМатвыгоды = Новый Массив;
		МассивКодыМатвыгоды.Добавить(Справочники.ДоходыНДФЛ.Код99998проценты);
		МассивКодыМатвыгоды.Добавить(Справочники.ДоходыНДФЛ.Код99999товары);
		
		ЗапросРЛ.УстановитьПараметр("КодыМатвыгоды",				МассивКодыМатвыгоды);
		
		//из запроса исключаем данные по регистратору - этот документ, если документ проведен и модифицирован
		ИсключитьДанныеПоРегистратору = Проведен И Модифицированность() И ПериодНачисления <> Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца;
		
		//добавляем данные в расчетный листок из документа, если он не проведен или проведен и модифицирован
		ДобавитьДанныеИзДокумента = Модифицированность() Или Не Проведен Или ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца;
		
		Если ДобавитьДанныеИзДокумента И ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца Тогда
			Запрос = Новый Запрос;
			Запрос.УстановитьПараметр("Работник",ФизЛицо);
			Запрос.УстановитьПараметр("Организация",Организация);
			Запрос.УстановитьПараметр("ПериодРегистрации",ПериодРегистрации);
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка
			|ИЗ
			|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
			|ГДЕ
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Физлицо = &Работник
			|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПериодРегистрации = &ПериодРегистрации
			|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПериодНачисления = ЗНАЧЕНИЕ(Перечисление.ПериодНачисленияЗарплаты.ТекущийМесяц)
			|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.Проведен
			|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.Организация = &Организация";
			ДобавитьДанныеИзДокумента = Запрос.Выполнить().Пустой();
		КонецЕсли;
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	НачисленияУдержания.ВидДвижения КАК ВидДвижения,
		|	НачисленияУдержания.НомерСтроки КАК НомерСтроки,
		|	НачисленияУдержания.Сотрудник КАК Сотрудник,
		|	НачисленияУдержания.ВидРасчета КАК ВидРасчета,
		|	НачисленияУдержания.ПорядокВидаРасчета КАК ПорядокВидаРасчета,
		|	НачисленияУдержания.ПериодДействияНачало КАК ПериодДействияНачало,
		|	НачисленияУдержания.ПериодДействияКонец КАК ПериодДействияКонец,
		|	НачисленияУдержания.ОтработаноДней КАК ОтработаноДней,
		|	НачисленияУдержания.ОтработаноЧасов КАК ОтработаноЧасов,
		|	НачисленияУдержания.ОплаченоДней КАК ОплаченоДней,
		|	НачисленияУдержания.ОплаченоЧасов КАК ОплаченоЧасов,
		|	НачисленияУдержания.Начисления КАК Начисления,
		|	НачисленияУдержания.Удержания КАК Удержания,
		|	Сальдо.СуммаВзаиморасчетовНачальныйОстаток КАК СуммаВзаиморасчетовНачальныйОстаток,
		|	Сальдо.СуммаВзаиморасчетовКонечныйОстаток КАК СуммаВзаиморасчетовКонечныйОстаток,
		|	НачисленияУдержания.Регистратор,
		|	ПРЕДСТАВЛЕНИЕ(НачисленияУдержания.Регистратор) КАК ОписаниеРегистратора
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА 6
		|			ИНАЧЕ 1
		|		КОНЕЦ КАК ВидДвижения,
		|		ОсновныеНачисленияРаботниковОрганизации.Регистратор КАК Регистратор,
		|		ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение КАК Организация,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации КАК ПериодРегистрации,
		|		ОсновныеНачисленияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
		|		ОсновныеНачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник,
		|		ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, Значение(Перечисление.ВидыЗанятостиВОрганизации.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ КАК ВидРасчета,
		|		""А"" + ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.Код КАК ПорядокВидаРасчета,
		|		ОсновныеНачисленияРаботниковОрганизации.НомерСтроки КАК НомерСтроки,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодДействияНачало КАК ПериодДействияНачало,
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодДействияКонец КАК ПериодДействияКонец,
		|		ОсновныеНачисленияРаботниковОрганизации.ОтработаноДней КАК ОтработаноДней,
		|		ОсновныеНачисленияРаботниковОрганизации.ОтработаноЧасов КАК ОтработаноЧасов,
		|		ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуОтпКалендарныеДни)
		|			    ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДней
		|		КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)//О.Т. Аверсон 26.06.2017 № 766
		|			И (ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)//О.Т. Аверсон 26.06.2017 № 766
		|				ИЛИ ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку))//О.Т. Аверсон 26.06.2017 № 766
		|			    ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДней  //О.Т. Аверсон 26.06.2017 № 766
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|				ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов      
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК ОплаченоДней,
		|		ВЫБОР
		|			КОГДА ОсновныеНачисленияРаботниковОрганизации.ВидУчетаВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|				ТОГДА ОсновныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК ОплаченоЧасов,
		|		ОсновныеНачисленияРаботниковОрганизации.Результат КАК Начисления,
		|		0 КАК Удержания,
		|		NULL КАК ВычетНаФизлицо,
		|		NULL КАК ВычетНаДетей,
		|		NULL КАК СуммаВзаиморасчетовНачальныйОстаток,
		|		NULL КАК СуммаВзаиморасчетовКонечныйОстаток
		|	ИЗ
		|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
		|	ГДЕ
		|		ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение = &Организация
		|		И ОсновныеНачисленияРаботниковОрганизации.ФизЛицо = &Работник
		
		//Аверсон 12.09.2022 КВВ СВФР-009532 (закомментировано) (
		//|		И ВЫБОР //О.Т. Аверсон 05.12.2016 № 1501
		//|	     КОГДА ОсновныеНачисленияРаботниковОрганизации.Регистратор ССЫЛКА Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций
		//|			И ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИндексацияЗП)
		//|		     ТОГДА ЛОЖЬ
		//|	     ИНАЧЕ ИСТИНА
		//|        КОНЕЦ
		//Аверсон 12.09.2022 КВВ СВФР-009532 (закомментировано) )
		|";
		
		Если ИсключитьДанныеПоРегистратору Тогда
			ТекстЗапроса = ТекстЗапроса+"
			|И ОсновныеНачисленияРаботниковОрганизации.Регистратор <> &Ссылка";
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса+"
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|				ТОГДА 7
		|			ИНАЧЕ 2
		|		КОНЕЦ,
		|		ДополнительныеНачисленияРаботниковОрганизации.Регистратор,
		|		ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации, МЕСЯЦ),
		|		ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизации.Сотрудник,
		|		ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Наименование + ВЫБОР
		|			КОГДА ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.Сотрудник.ВидЗанятости, Значение(Перечисление.ВидыЗанятостиВОрганизации.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|				ТОГДА """"
		|			ИНАЧЕ "" (по внутр. совмест-ву)""
		|		КОНЕЦ,
		|		""Б"" + ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.Код,
		|		NULL,
		//Островская Татьяна 02.05.2014 № 17326
		|		ДополнительныеНачисленияРаботниковОрганизации.БазовыйПериодНачало,
		|		ДополнительныеНачисленияРаботниковОрганизации.БазовыйПериодКонец,
		//Островская Татьяна 02.05.2014 № 17326
		|		NULL,
		|		NULL,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|				ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК ОплаченоДней,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизации.ВидУчетаВремени <> ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|				ТОГДА ДополнительныеНачисленияРаботниковОрганизации.ОплаченоДнейЧасов
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК ОплаченоЧасов,
		|		ДополнительныеНачисленияРаботниковОрганизации.Результат,
		|		0,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизации
		|	ГДЕ
		|		ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение = &Организация
		|		И ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо = &Работник";
		
		Если ИсключитьДанныеПоРегистратору Тогда
			ТекстЗапроса = ТекстЗапроса+"
			|И ДополнительныеНачисленияРаботниковОрганизации.Регистратор <> &Ссылка";
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса+"
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		7,
		|		НДФЛСведенияОДоходах.Регистратор,
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		NULL,
		|		""Мат. выгода по займам (кредитам)"",
		|		""Б9"",
		|		NULL,
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		СУММА(НДФЛСведенияОДоходах.СуммаДохода),
		|		0,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		|	ГДЕ
		|		НДФЛСведенияОДоходах.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И НДФЛСведенияОДоходах.КодДохода В(&КодыМатвыгоды)
		|		И НДФЛСведенияОДоходах.ИсчисленоИзЗарплаты
		|		И НДФЛСведенияОДоходах.ОбособленноеПодразделение = &Организация
		|		И НДФЛСведенияОДоходах.ФизЛицо = &Работник";
		
		Если ИсключитьДанныеПоРегистратору Тогда
			ТекстЗапроса = ТекстЗапроса+"
			|И НДФЛСведенияОДоходах.Регистратор <> &Ссылка";
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса+"
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НДФЛСведенияОДоходах.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ),
		|		НДФЛСведенияОДоходах.ФизЛицо,
		|		НДФЛСведенияОДоходах.Регистратор,
		|		НАЧАЛОПЕРИОДА(НДФЛСведенияОДоходах.Период, МЕСЯЦ)
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		4,
		|		УдержанияРаботниковОрганизации.Регистратор,
		|		УдержанияРаботниковОрганизации.ОбособленноеПодразделение,
		|		УдержанияРаботниковОрганизации.ПериодРегистрации,
		|		УдержанияРаботниковОрганизации.ФизЛицо,
		|		NULL,
		|		УдержанияРаботниковОрганизации.ВидРасчета.Наименование,
		|		""А"" + УдержанияРаботниковОрганизации.ВидРасчета.Код,
		|		NULL,
		|		УдержанияРаботниковОрганизации.БазовыйПериодНачало,
		|		УдержанияРаботниковОрганизации.БазовыйПериодКонец,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		0,
		|		УдержанияРаботниковОрганизации.Результат,
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
		|	ГДЕ
		|		УдержанияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И УдержанияРаботниковОрганизации.ОбособленноеПодразделение = &Организация
		|		И УдержанияРаботниковОрганизации.ФизЛицо = &Работник";
		
		Если ИсключитьДанныеПоРегистратору Тогда
			ТекстЗапроса = ТекстЗапроса+"
			|И УдержанияРаботниковОрганизации.Регистратор <> &Ссылка";
		КонецЕсли;
		ТекстЗапроса = ТекстЗапроса+"
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		3,
		|		ЕСНИсчисленный.Регистратор,
		|		ЕСНИсчисленный.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
		|		ЕСНИсчисленный.ФизЛицо,
		|		NULL,
		|		""Пенсионный фонд "",
		|		""Б"",
		|		NULL,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		0,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ЕСНИсчисленный.ОбособленноеПодразделение = &Организация
		|		И ЕСНИсчисленный.ФизЛицо = &Работник
		|		И ЕСНИсчисленный.ПенсионныйФонд <> 0";
		
		Если ИсключитьДанныеПоРегистратору Тогда
			ТекстЗапроса = ТекстЗапроса+"
			|И ЕСНИсчисленный.Регистратор <> &Ссылка";
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса+"
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ),
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНИсчисленный.ФизЛицо,
		|		ЕСНИсчисленный.Регистратор
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		3,
		|		НДФЛРасчетыСБюджетом.Регистратор,
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		|		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		|		НДФЛРасчетыСБюджетом.ФизЛицо,
		|		NULL,
		|		""Подоходный налог "", 
		//О.Т. 24.02.2015 № 362
		//|			+ ВЫБОР КОГДА НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = Значение(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13)
		//|				ТОГДА ""по ставке 12%""
		//|			КОГДА НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента = Значение(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка09)
		//|				ТОГДА ""по дивидендам""
		//|			ИНАЧЕ ""по ставке 15%""
		//|		КОНЕЦ,
		|		""Б"",
		|		NULL,
		|		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		0,
		|		СУММА(НДФЛРасчетыСБюджетом.Налог),
		|		СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетЛичный),
		|		СУММА(НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетей + НДФЛРасчетыСБюджетом.ПримененныйВычетНаДетейИнвалидов),
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		|	ГДЕ
		|		НДФЛРасчетыСБюджетом.ВидСтроки = Значение(Перечисление.НДФЛРасчетыСБюджетомВидСтроки.Начисление)
		|		И НДФЛРасчетыСБюджетом.ИсчисленоИзЗарплаты
		|		И НДФЛРасчетыСБюджетом.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И НДФЛРасчетыСБюджетом.ОбособленноеПодразделение = &Организация
		|		И НДФЛРасчетыСБюджетом.ФизЛицо = &Работник";
		
		Если ИсключитьДанныеПоРегистратору Тогда
			ТекстЗапроса = ТекстЗапроса+"
			|И НДФЛРасчетыСБюджетом.Регистратор <> &Ссылка";
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса+"
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НДФЛРасчетыСБюджетом.ОбособленноеПодразделение,
		|		НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента,
		|		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.Период, МЕСЯЦ),
		|		НАЧАЛОПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(НДФЛРасчетыСБюджетом.МесяцНалоговогоПериода, МЕСЯЦ),
		|		НДФЛРасчетыСБюджетом.ФизЛицо,
		|		НДФЛРасчетыСБюджетом.Регистратор
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		5,
		|		ПогашениеЗаймовРаботникамиОрганизаций.Регистратор,
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация,
		|		НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо,
		|		NULL,
		|		""Погашение займа"",
		|		""В"",
		|		NULL,
		|		НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		0,
		|		СУММА(ПогашениеЗаймовРаботникамиОрганизаций.ОсновнойДолг + ПогашениеЗаймовРаботникамиОрганизаций.Проценты),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОрганизаций
		|	ГДЕ
		|		ПогашениеЗаймовРаботникамиОрганизаций.ВидДвижения = &Расход
		|		И ПогашениеЗаймовРаботникамиОрганизаций.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И ПогашениеЗаймовРаботникамиОрганизаций.УдержаноИзЗарплаты
		|		И ПогашениеЗаймовРаботникамиОрганизаций.Организация = &Организация
		|		И ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо = &Работник";
		
		Если ИсключитьДанныеПоРегистратору Тогда
			ТекстЗапроса = ТекстЗапроса+"
			|И ПогашениеЗаймовРаботникамиОрганизаций.Регистратор <> &Ссылка";
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса+"
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ПогашениеЗаймовРаботникамиОрганизаций.ДоговорЗайма,
		|		НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ),
		|		ПогашениеЗаймовРаботникамиОрганизаций.Организация,
		|		ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо,
		|		ПогашениеЗаймовРаботникамиОрганизаций.Регистратор,
		|		НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, МЕСЯЦ)
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		8,
		|		Взаиморасчеты.Регистратор,
		|		Взаиморасчеты.Организация,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		Взаиморасчеты.Физлицо,
		|		NULL,
		|		ВЫБОР
		|			КОГДА Взаиморасчеты.СпособВыплаты = Значение(Перечисление.СпособыВыплатыЗарплаты.ЧерезКассу)
		|				ТОГДА ""Через кассу ""
		|			КОГДА Взаиморасчеты.СпособВыплаты = Значение(Перечисление.СпособыВыплатыЗарплаты.ЧерезБанк)
		|				ТОГДА ""Перечислено в банк ""
		|			ИНАЧЕ ""Способ выплаты не указан ""
		|		КОНЕЦ + ВЫБОР
		|			КОГДА Взаиморасчеты.ХарактерВыплаты В(&Аванс)
		|				ТОГДА ""(аванс)""
		|			КОГДА Взаиморасчеты.ХарактерВыплаты = Значение(Перечисление.ХарактерВыплатыЗарплаты.Зарплата)
		|				ТОГДА ""(под расчет)""
		|			КОГДА Взаиморасчеты.ХарактерВыплаты = Значение(Перечисление.ХарактерВыплатыЗарплаты.ПустаяСсылка)
		|					И Взаиморасчеты.СуммаВзаиморасчетов > 0
		|				ТОГДА ""(не указано)""
		|			КОГДА Взаиморасчеты.ХарактерВыплаты = Значение(Перечисление.ХарактерВыплатыЗарплаты.ПустаяСсылка)
		|					И Взаиморасчеты.СуммаВзаиморасчетов < 0
		|				ТОГДА ""(погашено задолженности)""
		|			ИНАЧЕ ""(межрасчет)""
		|		КОНЕЦ,
		|		""Г"",
		|		NULL,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.ПериодВзаиморасчетов, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(Взаиморасчеты.ПериодВзаиморасчетов, МЕСЯЦ),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL,
		|		0,
		|		СУММА(Взаиморасчеты.СуммаВзаиморасчетов),
		|		NULL,
		|		NULL,
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		|	ГДЕ
		|		Взаиморасчеты.ВидДвижения = &Расход
		|		И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		|		И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|		И Взаиморасчеты.Организация = &Организация
		|		И Взаиморасчеты.Физлицо = &Работник";
		
		Если ИсключитьДанныеПоРегистратору Тогда
			ТекстЗапроса = ТекстЗапроса+"
			|И Взаиморасчеты.Регистратор <> &Ссылка";
		КонецЕсли;
		
		ТекстЗапроса = ТекстЗапроса+"
		|	
		|	СГРУППИРОВАТЬ ПО
		|		Взаиморасчеты.Организация,
		|		Взаиморасчеты.Физлицо,
		|		ВЫБОР
		|			КОГДА Взаиморасчеты.СпособВыплаты = Значение(Перечисление.СпособыВыплатыЗарплаты.ЧерезКассу)
		|				ТОГДА ""Через кассу ""
		|			КОГДА Взаиморасчеты.СпособВыплаты = Значение(Перечисление.СпособыВыплатыЗарплаты.ЧерезБанк)
		|				ТОГДА ""Перечислено в банк ""
		|			ИНАЧЕ ""Способ выплаты не указан ""
		|		КОНЕЦ + ВЫБОР
		|			КОГДА Взаиморасчеты.ХарактерВыплаты В(&Аванс)
		|				ТОГДА ""(аванс)""
		|			КОГДА Взаиморасчеты.ХарактерВыплаты = Значение(Перечисление.ХарактерВыплатыЗарплаты.Зарплата)
		|				ТОГДА ""(под расчет)""
		|			КОГДА Взаиморасчеты.ХарактерВыплаты = Значение(Перечисление.ХарактерВыплатыЗарплаты.ПустаяСсылка)
		|					И Взаиморасчеты.СуммаВзаиморасчетов > 0
		|				ТОГДА ""(не указано)""
		|			КОГДА Взаиморасчеты.ХарактерВыплаты = Значение(Перечисление.ХарактерВыплатыЗарплаты.ПустаяСсылка)
		|					И Взаиморасчеты.СуммаВзаиморасчетов < 0
		|				ТОГДА ""(погашено задолженности)""
		|			ИНАЧЕ ""(межрасчет)""
		|		КОНЕЦ,
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.Период, МЕСЯЦ),
		|		НАЧАЛОПЕРИОДА(Взаиморасчеты.ПериодВзаиморасчетов, МЕСЯЦ),
		|		КОНЕЦПЕРИОДА(Взаиморасчеты.ПериодВзаиморасчетов, МЕСЯЦ),
		|	    Взаиморасчеты.Регистратор) КАК НачисленияУдержания
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			СУММА(Сальдо.СуммаВзаиморасчетовНачальныйОстаток) КАК СуммаВзаиморасчетовНачальныйОстаток,
		|			СУММА(Сальдо.СуммаВзаиморасчетовКонечныйОстаток) КАК СуммаВзаиморасчетовКонечныйОстаток
		|		ИЗ
		|			(ВЫБРАТЬ
		|				ВзаиморасчетыСРаботникамиОрганизацииОстаткиИОбороты.СуммаВзаиморасчетовНачальныйОстаток КАК СуммаВзаиморасчетовНачальныйОстаток,
		|				ВзаиморасчетыСРаботникамиОрганизацииОстаткиИОбороты.СуммаВзаиморасчетовКонечныйОстаток КАК СуммаВзаиморасчетовКонечныйОстаток
		|			ИЗ
		|				РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.ОстаткиИОбороты(
		|					&ПериодРегистрации,
		|					&КонецПериодаРегистрации,
		|					Месяц,
		|					,
		|					Организация = &Организация
		|						И ФизЛицо = &Работник) КАК ВзаиморасчетыСРаботникамиОрганизацииОстаткиИОбороты
		|			
		|			ОБЪЕДИНИТЬ ВСЕ
		|			
		|			ВЫБРАТЬ
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуНачальныйОстаток,
		|				НДФЛКЗачету.СуммаНДФЛКЗачетуКонечныйОстаток
		|			ИЗ
		|				РегистрНакопления.НДФЛКЗачету.ОстаткиИОбороты(
		|					&ПериодРегистрации,
		|					&КонецПериодаРегистрации,
		|					Месяц,
		|					,
		|					Организация = &Организация
		|						И ФизЛицо = &Работник) КАК НДФЛКЗачету) КАК Сальдо) КАК Сальдо
		|		ПО (ИСТИНА)
		|
		|УПОРЯДОЧИТЬ ПО
		|	ВидДвижения,
		|	ПорядокВидаРасчета,
		|	ВидРасчета,
		|	ПериодДействияНачало";
		
		ЗапросРЛ.Текст		= ТекстЗапроса;
		РезультатЗапроса	= ЗапросРЛ.Выполнить();
		
		Макет						= Документы.НачислениеЗарплатыРаботникамОрганизаций.ПолучитьМакет("РасчетныйЛисток");
		ОбластьЗаголовокТЧ			= Макет.ПолучитьОбласть("Заголовок");
		ОбластьНачисленоУдержано	= Макет.ПолучитьОбласть("НачисленоУдержано");
		ОбластьНатурДоходыВыплаты	= Макет.ПолучитьОбласть("НатурДоходыВыплаты");
		ОбластьВсего				= Макет.ПолучитьОбласть("Всего");
		ОбластьНатуральныеДоходы	= Макет.ПолучитьОбласть("НатуральныеДоходы");
		ОбластьПодвал				= Макет.ПолучитьОбласть("Подвал");
		//О.Т. Аверсон 02.06.2016 № 1190
		Если ПериодРегистрации >= Дата(2016,07,1) Тогда 
			ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,
			Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер;
			
			ОбластьВсего.Область("R1C9").Формат =  "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьВсего.Область("R1C10").Формат = "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьВсего.Область("R1C16").Формат =  "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьВсего.Область("R1C17").Формат = "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			
			ОбластьНатуральныеДоходы.Область("R1C9").Формат =  "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьНатуральныеДоходы.Область("R1C10").Формат = "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьНатуральныеДоходы.Область("R1C16").Формат =  "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьНатуральныеДоходы.Область("R1C17").Формат = "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			
			ОбластьПодвал.Область("R1C9").Формат =  "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьПодвал.Область("R1C10").Формат = "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьПодвал.Область("R1C16").Формат =  "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			ОбластьПодвал.Область("R1C17").Формат = "ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления);
			
		КонецЕсли;
		//О.Т. Аверсон 02.06.2016 № 1190
		КолонкаНачислено		= 2;
		КолонкаПериодНачислено	= 3;
		КолонкаОтработаноДней	= 5;
		КолонкаОтработаноЧасов	= 6;
		КолонкаОплаченоДней		= 7;
		КолонкаОплаченоЧасов	= 8;
		КолонкаСуммаНачислено	= 9;
		КолонкаУдержано			= 11;
		КолонкаПериодУдержано	= 14;
		КолонкаСуммаУдержано	= 16;
		
		Линия = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		
		НеНайденыЗаписиВЗапросе	= Истина;
		
		// В этот табличный документ будет собираться данные для РЛ
		ВременныйТабличныйДокумент = Новый ТабличныйДокумент;
		
		ФИОФизлица = Физлицо.Наименование;
		
		Если ДобавитьДанныеИзДокумента Тогда
			//к результату запроса необходимо добавить данные из табличных полей документа
			
			СтруктураПоиска    = Новый Структура("ФизЛицо",ФизЛицо);
			
			ТаблицаРезультатовЗапроса = РезультатЗапроса.Выгрузить();
			СуммаНаНачалоПериода = 0;
			СуммаНаКонецПериода = 0;
			
			Если ТаблицаРезультатовЗапроса.Количество()>0 Тогда
				СуммаНаНачалоПериода = ТаблицаРезультатовЗапроса[0].СуммаВзаиморасчетовНачальныйОстаток;
				Если НЕ ЗначениеЗаполнено(СуммаНаНачалоПериода) Тогда
					СуммаНаНачалоПериода = 0;
				КонецЕсли;
				СуммаНаКонецПериода = СуммаНаНачалоПериода;
			Иначе	
				ТЗ = 
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ
				|	СУММА(Сальдо.СуммаВзаиморасчетовНачальныйОстаток) КАК СуммаВзаиморасчетовНачальныйОстаток,
				|	СУММА(Сальдо.СуммаВзаиморасчетовКонечныйОстаток) КАК СуммаВзаиморасчетовКонечныйОстаток
				|ИЗ
				|	(ВЫБРАТЬ
				|		ВзаиморасчетыСРаботникамиОрганизацииОстаткиИОбороты.СуммаВзаиморасчетовНачальныйОстаток КАК СуммаВзаиморасчетовНачальныйОстаток,
				|		ВзаиморасчетыСРаботникамиОрганизацииОстаткиИОбороты.СуммаВзаиморасчетовКонечныйОстаток КАК СуммаВзаиморасчетовКонечныйОстаток
				|	ИЗ
				|		РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций.ОстаткиИОбороты(
				|				&ПериодРегистрации,
				|				&КонецПериодаРегистрации,
				|				,
				|				,
				|				Организация = &Организация
				|					И ФизЛицо = &Работник) КАК ВзаиморасчетыСРаботникамиОрганизацииОстаткиИОбороты
				|	
				|	ОБЪЕДИНИТЬ ВСЕ
				|	
				|	ВЫБРАТЬ
				|		НДФЛКЗачету.СуммаНДФЛКЗачетуНачальныйОстаток,
				|		НДФЛКЗачету.СуммаНДФЛКЗачетуКонечныйОстаток
				|	ИЗ
				|		РегистрНакопления.НДФЛКЗачету.ОстаткиИОбороты(
				|				&ПериодРегистрации,
				|				&КонецПериодаРегистрации,
				|				,
				|				,
				|				Организация = &Организация
				|					И ФизЛицо = &Работник) КАК НДФЛКЗачету) КАК Сальдо";
				
				Запрос = Новый Запрос(ТЗ);
				Запрос.УстановитьПараметр("Работник", ФизЛицо);
				Запрос.УстановитьПараметр("Организация", Организация);
				Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
				Запрос.УстановитьПараметр("КонецПериодаРегистрации", КонецМесяца(ПериодРегистрации));
				РезультатЗапроса = Запрос.Выполнить();
				Если НЕ РезультатЗапроса.Пустой() тогда
					Выборка = РезультатЗапроса.Выбрать();
					Если Выборка.Следующий() тогда
						СуммаНаНачалоПериода = ?(Выборка.СуммаВзаиморасчетовНачальныйОстаток = NULL, 0, Выборка.СуммаВзаиморасчетовНачальныйОстаток);
						СуммаНаКонецПериода = ?(Выборка.СуммаВзаиморасчетовКонечныйОстаток = NULL, 0,  Выборка.СуммаВзаиморасчетовКонечныйОстаток);
						СуммаНаКонецПериода = ?(Проведен, СуммаНаНачалоПериода, СуммаНаКонецПериода);
					Иначе
						СуммаНаНачалоПериода = 0;
						СуммаНаКонецПериода = 0;
					КонецЕсли;
				Иначе
					СуммаНаНачалоПериода = 0;
					СуммаНаКонецПериода = 0;
				КонецЕсли;
			КонецЕсли;
			
			
			ТекстПериода = Формат(ПериодРегистрации, "ДФ = 'ММММ гггг ''г.'''");
			
			// Очистим временный табличный документ
			ВременныйТабличныйДокумент.Очистить();
			
			ВременныйТабличныйДокумент.Вывести(ОбластьЗаголовокТЧ);
			ВременныйТабличныйДокумент.Вывести(ОбластьНачисленоУдержано);
			
			ВысотаТаблицы = ВременныйТабличныйДокумент.ВысотаТаблицы + 1;
			
			ВсегоНачисления = 0; КоличествоНачислений = 0;
			ВсегоУдержания = 0; КоличествоУдержаний  = 0;
			ИтогиНачисленийИУдержанийВыведены = Ложь;
			
			Запрос = Новый Запрос();
			Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
			Запрос.УстановитьПараметр("парамФизЛицо", Физлицо);
			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	ОсновныеНачисления.Сотрудник,
			|	ОсновныеНачисления.ВидРасчета,
			|	ОсновныеНачисления.ДатаНачала,
			|	ОсновныеНачисления.ДатаОкончания,
			|	ОсновныеНачисления.Результат,
			|	ОсновныеНачисления.ОтработаноДней,
			|	ОсновныеНачисления.ОтработаноЧасов,
			|	ОсновныеНачисления.ОплаченоДнейЧасов
			|ПОМЕСТИТЬ ВТ_ОсновныеНачисления
			|ИЗ
			|	&ОсновныеНачисления КАК ОсновныеНачисления
			|ГДЕ
			|	ОсновныеНачисления.Физлицо = &парамФизЛицо";
			
			Запрос.УстановитьПараметр("ОсновныеНачисления", Начисления);
			Запрос.Текст = ТекстЗапроса;
			Запрос.Выполнить();
			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	ДополнительныеНачисления.Сотрудник,
			|	ДополнительныеНачисления.ВидРасчета,
			|	ДополнительныеНачисления.ДатаНачала,
			|	ДополнительныеНачисления.ДатаОкончания,
			|	ДополнительныеНачисления.Результат,
			|	ДополнительныеНачисления.ОплаченоДнейЧасов
			|ПОМЕСТИТЬ ВТ_ДополнительныеНачисления
			|ИЗ
			|	&ДополнительныеНачисления КАК ДополнительныеНачисления
			|ГДЕ
			|	ДополнительныеНачисления.Физлицо = &парамФизЛицо";
			
			Запрос.УстановитьПараметр("ДополнительныеНачисления", ДополнительныеНачисления);
			Запрос.Текст = ТекстЗапроса;
			Запрос.Выполнить();
			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	ДоговорыНаВыполнениеРабот.Сотрудник,
			|	ДоговорыНаВыполнениеРабот.ВидРасчета,
			|	ДоговорыНаВыполнениеРабот.ДатаНачала,
			|	ДоговорыНаВыполнениеРабот.ДатаОкончания,
			|	ДоговорыНаВыполнениеРабот.Результат
			|ПОМЕСТИТЬ ВТ_ДоговорыНаВыполнениеРабот
			|ИЗ
			|	&ДоговорыНаВыполнениеРабот КАК ДоговорыНаВыполнениеРабот
			|ГДЕ
			|	ДоговорыНаВыполнениеРабот.Физлицо = &парамФизЛицо";
			
			Запрос.УстановитьПараметр("ДоговорыНаВыполнениеРабот", ДоговорыНаВыполнениеРабот);
			Запрос.Текст = ТекстЗапроса;
			Запрос.Выполнить();
			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	Удержания.Физлицо,
			|	Удержания.ВидРасчета,
			|	Удержания.ДатаНачала,
			|	Удержания.ДатаОкончания,
			|	Удержания.Результат
			|ПОМЕСТИТЬ ВТ_Удержания
			|ИЗ
			|	&Удержания КАК Удержания
			|ГДЕ
			|	Удержания.Физлицо = &парамФизЛицо";
			
			Запрос.УстановитьПараметр("Удержания", Удержания);
			Запрос.Текст = ТекстЗапроса;
			Запрос.Выполнить();
			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	ПенсионныйФонд.Физлицо,
			|	ПенсионныйФонд.Налог,
			|	ПенсионныйФонд.МесяцНалоговогоПериода
			|ПОМЕСТИТЬ ВТ_ПенсионныйФонд
			|ИЗ
			|	&ПенсионныйФонд КАК ПенсионныйФонд
			|ГДЕ
			|	ПенсионныйФонд.Физлицо = &парамФизЛицо";
			
			Запрос.УстановитьПараметр("ПенсионныйФонд", ПенсионныйФонд);
			Запрос.Текст = ТекстЗапроса;
			Запрос.Выполнить();
			
			//Аверсон 04.08.2022 КВВ СВФР-009414 (
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	ДополнительнаяПенсия.Физлицо,
			|	ДополнительнаяПенсия.НалогДП,
			|	ДополнительнаяПенсия.МесяцДП
			|ПОМЕСТИТЬ ВТ_ДополнительнаяПенсия
			|ИЗ
			|	&ДополнительнаяПенсия КАК ДополнительнаяПенсия
			|ГДЕ
			|	ДополнительнаяПенсия.Физлицо = &парамФизЛицо";
			
			Запрос.УстановитьПараметр("ДополнительнаяПенсия", ДополнительнаяПенсия);
			Запрос.Текст = ТекстЗапроса;
			Запрос.Выполнить();
			//Аверсон 04.08.2022 КВВ СВФР-009414 )
			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	НДФЛ.Физлицо,
			|	НДФЛ.Налог + НДФЛ.НалогПоСтавке35 КАК Налог,
			|	НДФЛ.МесяцНалоговогоПериода
			|ПОМЕСТИТЬ ВТ_НДФЛ
			|ИЗ
			|	&НДФЛ КАК НДФЛ
			|ГДЕ
			|	НДФЛ.Физлицо = &парамФизЛицо";
			
			Запрос.УстановитьПараметр("НДФЛ", НДФЛ);
			Запрос.Текст = ТекстЗапроса;
			Запрос.Выполнить();
			
			ТекстЗапроса = 
			"ВЫБРАТЬ
			|	ПогашениеЗаймов.Физлицо,
			|	ПогашениеЗаймов.ПогашеноЗайма,
			|	ПогашениеЗаймов.МатериальнаяВыгода,
			|	ПогашениеЗаймов.НалогНаМатериальнуюВыгоду,
			|	ПогашениеЗаймов.СтавкаНалогообложенияМатвыгоды
			|ПОМЕСТИТЬ ВТ_ПогашениеЗаймов
			|ИЗ
			|	&ПогашениеЗаймов КАК ПогашениеЗаймов
			|ГДЕ
			|	ПогашениеЗаймов.Физлицо = &парамФизЛицо";
			
			Запрос.УстановитьПараметр("ПогашениеЗаймов", ПогашениеЗаймов);
			Запрос.Текст = ТекстЗапроса;
			Запрос.Выполнить();
			
			
			ТекстЗапросаНачисления = 
			"ВЫБРАТЬ
			|	""Начисления"" КАК Таблица,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник КАК Сотрудник,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.Наименование, ""<не указано>"") КАК ВидРасчетаНаименование,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.Код, ""Я"") КАК ВидРасчетаКод,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ) КАК ЯвляетсяДоходомВНатуральнойФорме,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.СпособРасчета КАК ВидРасчетаСпособРасчета,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ВидВремени,
			|	ВЫБОР
			|		КОГДА НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
			|			ТОГДА "" (по внутр. совмест-ву)""
			|		ИНАЧЕ """"
			|	КОНЕЦ КАК ВидЗанятости,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаОкончания,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийНачисления.Результат) КАК Результат,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ОтработаноДней) КАК ОтработаноДней,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ОтработаноЧасов) КАК ОтработаноЧасов,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ОплаченоДнейЧасов) КАК ОплаченоДнейЧасов,
			|	NULL КАК МесяцНалоговогоПериода,
			|	NULL КАК ПогашеноЗайма,
			|	NULL КАК МатериальнаяВыгода,
			|	NULL КАК НалогНаМатериальнуюВыгоду,
			|	NULL КАК СтавкаНалогообложенияМатвыгоды
			|ИЗ
			|	ВТ_ОсновныеНачисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
			|
			|СГРУППИРОВАТЬ ПО
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаОкончания,
			|	ВЫБОР
			|		КОГДА НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
			|			ТОГДА "" (по внутр. совмест-ву)""
			|		ИНАЧЕ """"
			|	КОНЕЦ,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.СпособРасчета,
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ВидВремени,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.Наименование, ""<не указано>""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.Код, ""Я""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ)
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	""ДополнительныеНачисления"",
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.Наименование, ""<не указано>""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.Код, ""Я""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ),
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.СпособРасчета,
			|	NULL,
			|	ВЫБОР
			|		КОГДА НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
			|			ТОГДА "" (по внутр. совмест-ву)""
			|		ИНАЧЕ """"
			|	КОНЕЦ,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ДатаНачала,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ДатаОкончания,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Результат),
			|	0,
			|	0,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ОплаченоДнейЧасов),
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL
			|ИЗ
			|	ВТ_ДополнительныеНачисления КАК НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления
			|
			|СГРУППИРОВАТЬ ПО
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ДатаНачала,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ДатаОкончания,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.СпособРасчета,
			|	ВЫБОР
			|		КОГДА НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
			|			ТОГДА "" (по внутр. совмест-ву)""
			|		ИНАЧЕ """"
			|	КОНЕЦ,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.Наименование, ""<не указано>""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.Код, ""Я"")
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	""ДоговорыНаВыполнениеРабот"",
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник,
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.Наименование, ""<не указано>""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.Код, ""Я""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ),
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.СпособРасчета,
			|	NULL,
			|	ВЫБОР
			|		КОГДА НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
			|			ТОГДА "" (по внутр. совмест-ву)""
			|		ИНАЧЕ """"
			|	КОНЕЦ,
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ДатаНачала,
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ДатаОкончания,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Результат),
			|	0,
			|	0,
			|	0,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL
			|ИЗ
			|	ВТ_ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
			|
			|СГРУППИРОВАТЬ ПО
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ДатаОкончания,
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета,
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ДатаНачала,
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник,
			|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.СпособРасчета,
			|	ВЫБОР
			|		КОГДА НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
			|			ТОГДА "" (по внутр. совмест-ву)""
			|		ИНАЧЕ """"
			|	КОНЕЦ,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.Наименование, ""<не указано>""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.Код, ""Я"")
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	""Удержания"",
			|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ФизЛицо,
			|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.Наименование, ""<не указано>""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.Код, ""Я""),
			|	ЛОЖЬ,
			|	NULL,
			|	NULL,
			|	NULL,
			|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ДатаНачала,
			|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ДатаОкончания,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийУдержания.Результат),
			|	0,
			|	0,
			|	0,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL
			|ИЗ
			|	ВТ_Удержания КАК НачислениеЗарплатыРаботникамОрганизацийУдержания
			|
			|СГРУППИРОВАТЬ ПО
			|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ФизЛицо,
			|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета,
			|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ДатаНачала,
			|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ДатаОкончания,
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.Наименование, ""<не указано>""),
			|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.Код, ""Я"")
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	""ПенсионныйФонд"",
			|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.ФизЛицо,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.Налог,
			|	NULL,
			|	NULL,
			|	NULL,
			|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.МесяцНалоговогоПериода,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL
			|ИЗ
			|	ВТ_ПенсионныйФонд КАК НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд
			|
			
			//Аверсон 04.08.2022 КВВ СВФР-009414 (
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	""ДополнительнаяПенсия"",
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительнаяПенсия.ФизЛицо,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительнаяПенсия.НалогДП,
			|	NULL,
			|	NULL,
			|	NULL,
			|	НачислениеЗарплатыРаботникамОрганизацийДополнительнаяПенсия.МесяцДП,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL
			|ИЗ
			|	ВТ_ДополнительнаяПенсия КАК НачислениеЗарплатыРаботникамОрганизацийДополнительнаяПенсия
			//Аверсон 04.08.2022 КВВ СВФР-009414 )
			
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	""НДФЛ"",
			|	НачислениеЗарплатыРаботникамОрганизацийНДФЛ.ФизЛицо,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	НачислениеЗарплатыРаботникамОрганизацийНДФЛ.Налог,
			|	NULL,
			|	NULL,
			|	NULL,
			|	НачислениеЗарплатыРаботникамОрганизацийНДФЛ.МесяцНалоговогоПериода,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL
			|ИЗ
			|	ВТ_НДФЛ КАК НачислениеЗарплатыРаботникамОрганизацийНДФЛ
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	""ПогашениеЗаймов"",
			|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ФизЛицо,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	NULL,
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ПогашеноЗайма),
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.МатериальнаяВыгода),
			|	СУММА(НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.НалогНаМатериальнуюВыгоду),
			|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.СтавкаНалогообложенияМатвыгоды
			|ИЗ
			|	ВТ_ПогашениеЗаймов КАК НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов
			|
			|СГРУППИРОВАТЬ ПО
			|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.СтавкаНалогообложенияМатвыгоды,
			|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ФизЛицо
			|
			|УПОРЯДОЧИТЬ ПО
			|	Сотрудник,
			|	Таблица";
			
			
			Запрос.Текст = ТекстЗапросаНачисления;
			Запрос.УстановитьПараметр("Ссылка", Ссылка);
			Запрос.УстановитьПараметр("парамФизЛицо", Физлицо);
			
			ВыборкаЗапросаПоСотрудникам = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкамСИерархией);
			
			Пока ВыборкаЗапросаПоСотрудникам.Следующий() Цикл
				
				Если ВыборкаЗапросаПоСотрудникам.Таблица = "Начисления" тогда
					
					ВидУчетаВремени = ПроведениеРасчетов.ПолучитьВидУчетаВремени(ВыборкаЗапросаПоСотрудникам.ВидРасчетаСпособРасчета, ВыборкаЗапросаПоСотрудникам.ВидРасчетаВидВремени);
					
					СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
					
					СтрокаТаблицы.ВидДвижения			= ?(ВыборкаЗапросаПоСотрудникам.ЯвляетсяДоходомВНатуральнойФорме,6,1);
					СтрокаТаблицы.ВидРасчета			= ВыборкаЗапросаПоСотрудникам.ВидРасчетаНаименование + ВыборкаЗапросаПоСотрудникам.ВидЗанятости;
					СтрокаТаблицы.ПорядокВидаРасчета	= "А" + ВыборкаЗапросаПоСотрудникам.ВидРасчетаКод;
					СтрокаТаблицы.ПериодДействияНачало	= ВыборкаЗапросаПоСотрудникам.ДатаНачала;
					СтрокаТаблицы.ПериодДействияКонец	= КонецДня(ВыборкаЗапросаПоСотрудникам.ДатаОкончания);
					СтрокаТаблицы.ОтработаноДней		= ВыборкаЗапросаПоСотрудникам.ОтработаноДней;
					СтрокаТаблицы.ОтработаноЧасов		= ВыборкаЗапросаПоСотрудникам.ОтработаноЧасов;
					СтрокаТаблицы.ОплаченоДней			= ?(ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням, ВыборкаЗапросаПоСотрудникам.ОплаченоДнейЧасов, 0);
					СтрокаТаблицы.ОплаченоЧасов			= ?(ВидУчетаВремени <> Перечисления.ВидыУчетаВремени.ПоДням, ВыборкаЗапросаПоСотрудникам.ОплаченоДнейЧасов, 0);
					СтрокаТаблицы.Начисления			= ВыборкаЗапросаПоСотрудникам.Результат;
					СтрокаТаблицы.Удержания				= 0;
					СтрокаТаблицы.Регистратор			= Неопределено;
					
				ИначеЕсли ВыборкаЗапросаПоСотрудникам.Таблица = "ДополнительныеНачисления" тогда
					
					ВидУчетаВремени = ПроведениеРасчетов.ПолучитьВидУчетаВремени(ВыборкаЗапросаПоСотрудникам.ВидРасчетаСпособРасчета, Неопределено);
					
					СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
					
					СтрокаТаблицы.ВидДвижения			= ?(ВыборкаЗапросаПоСотрудникам.ЯвляетсяДоходомВНатуральнойФорме,7,2);
					СтрокаТаблицы.ВидРасчета			= ВыборкаЗапросаПоСотрудникам.ВидРасчетаНаименование + ВыборкаЗапросаПоСотрудникам.ВидЗанятости;
					СтрокаТаблицы.ПорядокВидаРасчета	= "А" + ВыборкаЗапросаПоСотрудникам.ВидРасчетаКод;
					СтрокаТаблицы.ПериодДействияНачало	= ПериодРегистрации;
					СтрокаТаблицы.ПериодДействияКонец	= ПериодРегистрации;
					СтрокаТаблицы.ОтработаноДней		= 0;
					СтрокаТаблицы.ОтработаноЧасов		= 0;
					СтрокаТаблицы.ОплаченоДней			= ?(ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням, ВыборкаЗапросаПоСотрудникам.ОплаченоДнейЧасов, 0);
					СтрокаТаблицы.ОплаченоЧасов			= ?(ВидУчетаВремени <> Перечисления.ВидыУчетаВремени.ПоДням, ВыборкаЗапросаПоСотрудникам.ОплаченоДнейЧасов, 0);
					СтрокаТаблицы.Начисления			= ВыборкаЗапросаПоСотрудникам.Результат;
					СтрокаТаблицы.Удержания				= 0;
					СтрокаТаблицы.Регистратор			= Неопределено;
					
				ИначеЕсли ВыборкаЗапросаПоСотрудникам.Таблица = "ДоговорыНаВыполнениеРабот" тогда
					СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
					
					СтрокаТаблицы.ВидДвижения			= ?(ВыборкаЗапросаПоСотрудникам.ЯвляетсяДоходомВНатуральнойФорме,7,2);
					СтрокаТаблицы.ВидРасчета			= ВыборкаЗапросаПоСотрудникам.ВидРасчетаНаименование;
					СтрокаТаблицы.ПорядокВидаРасчета	= "А" + ВыборкаЗапросаПоСотрудникам.ВидРасчетаКод;
					СтрокаТаблицы.ПериодДействияНачало	= ВыборкаЗапросаПоСотрудникам.ДатаНачала;
					СтрокаТаблицы.ПериодДействияКонец	= КонецДня(ВыборкаЗапросаПоСотрудникам.ДатаОкончания);
					СтрокаТаблицы.ОтработаноДней		= 0;
					СтрокаТаблицы.ОтработаноЧасов		= 0;
					СтрокаТаблицы.ОплаченоДней			= 0;
					СтрокаТаблицы.ОплаченоЧасов			= 0;
					СтрокаТаблицы.Начисления			= ВыборкаЗапросаПоСотрудникам.Результат;
					СтрокаТаблицы.Удержания				= 0;
					СтрокаТаблицы.Регистратор			= Неопределено;
					
				ИначеЕсли ВыборкаЗапросаПоСотрудникам.Таблица = "ПенсионныйФонд" тогда
					
					СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
					
					СтрокаТаблицы.ВидДвижения			= 3;
					СтрокаТаблицы.ВидРасчета			= "Пенсионный фонд"; //О.Т. 16.02.2015 № 362
					СтрокаТаблицы.ПорядокВидаРасчета	= "Б";
					СтрокаТаблицы.ПериодДействияНачало	= ВыборкаЗапросаПоСотрудникам.МесяцНалоговогоПериода;
					СтрокаТаблицы.ПериодДействияКонец	= КонецДня(КонецМесяца(ВыборкаЗапросаПоСотрудникам.МесяцНалоговогоПериода));
					СтрокаТаблицы.ОтработаноДней		= 0;
					СтрокаТаблицы.ОтработаноЧасов		= 0;
					СтрокаТаблицы.ОплаченоДней			= 0;
					СтрокаТаблицы.ОплаченоЧасов			= 0;
					СтрокаТаблицы.Начисления			= 0;
					СтрокаТаблицы.Удержания				= ВыборкаЗапросаПоСотрудникам.Результат;
					СтрокаТаблицы.Регистратор			= Неопределено;
					
					//Аверсон 04.08.2022 КВВ СВФР-009414 (
				ИначеЕсли ВыборкаЗапросаПоСотрудникам.Таблица = "ДополнительнаяПенсия" тогда
					
					СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
					
					СтрокаТаблицы.ВидДвижения			= 3;
					СтрокаТаблицы.ВидРасчета			= "Дополнительная пенсия"; 
					СтрокаТаблицы.ПорядокВидаРасчета	= "Б";
					СтрокаТаблицы.ПериодДействияНачало	= ВыборкаЗапросаПоСотрудникам.МесяцНалоговогоПериода;
					СтрокаТаблицы.ПериодДействияКонец	= КонецДня(КонецМесяца(ВыборкаЗапросаПоСотрудникам.МесяцНалоговогоПериода));
					СтрокаТаблицы.ОтработаноДней		= 0;
					СтрокаТаблицы.ОтработаноЧасов		= 0;
					СтрокаТаблицы.ОплаченоДней			= 0;
					СтрокаТаблицы.ОплаченоЧасов			= 0;
					СтрокаТаблицы.Начисления			= 0;
					СтрокаТаблицы.Удержания				= ВыборкаЗапросаПоСотрудникам.Результат;
					СтрокаТаблицы.Регистратор			= Неопределено;
					//Аверсон 04.08.2022 КВВ СВФР-009414 )
					
				ИначеЕсли ВыборкаЗапросаПоСотрудникам.Таблица = "НДФЛ" тогда
					
					СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
					
					СтрокаТаблицы.ВидДвижения			= 3;
					СтрокаТаблицы.ВидРасчета			= "Подоходный налог";//О.Т. 16.02.2015 № 362
					СтрокаТаблицы.ПорядокВидаРасчета	= "Б";
					СтрокаТаблицы.ПериодДействияНачало	= ВыборкаЗапросаПоСотрудникам.МесяцНалоговогоПериода;
					СтрокаТаблицы.ПериодДействияКонец	= КонецДня(КонецМесяца(ВыборкаЗапросаПоСотрудникам.МесяцНалоговогоПериода));
					СтрокаТаблицы.ОтработаноДней		= 0;
					СтрокаТаблицы.ОтработаноЧасов		= 0;
					СтрокаТаблицы.ОплаченоДней			= 0;
					СтрокаТаблицы.ОплаченоЧасов			= 0;
					СтрокаТаблицы.Начисления			= 0;
					СтрокаТаблицы.Удержания				= ВыборкаЗапросаПоСотрудникам.Результат;
					СтрокаТаблицы.Регистратор			= Неопределено;
					
					
				ИначеЕсли ВыборкаЗапросаПоСотрудникам.Таблица = "Удержания" тогда
					
					СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
					
					СтрокаТаблицы.ВидДвижения			= 4;
					СтрокаТаблицы.ВидРасчета			= ВыборкаЗапросаПоСотрудникам.ВидРасчетаНаименование;
					СтрокаТаблицы.ПорядокВидаРасчета	= "А" + ВыборкаЗапросаПоСотрудникам.ВидРасчетаКод;
					СтрокаТаблицы.ПериодДействияНачало	= ВыборкаЗапросаПоСотрудникам.ДатаНачала;
					СтрокаТаблицы.ПериодДействияКонец	= КонецДня(ВыборкаЗапросаПоСотрудникам.ДатаОкончания);
					СтрокаТаблицы.ОтработаноДней		= 0;
					СтрокаТаблицы.ОтработаноЧасов		= 0;
					СтрокаТаблицы.ОплаченоДней			= 0;
					СтрокаТаблицы.ОплаченоЧасов			= 0;
					СтрокаТаблицы.Начисления			= 0;
					СтрокаТаблицы.Удержания				= ВыборкаЗапросаПоСотрудникам.Результат;
					СтрокаТаблицы.Регистратор			= Неопределено;		
					
				ИначеЕсли ВыборкаЗапросаПоСотрудникам.Таблица = "ПогашениеЗаймов" тогда
					Если ВыборкаЗапросаПоСотрудникам.МатериальнаяВыгода <> 0 Тогда
						
						СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
						
						СтрокаТаблицы.ВидДвижения			= 7;
						СтрокаТаблицы.ВидРасчета			= "Мат. выгода по займам (кредитам)";
						СтрокаТаблицы.ПорядокВидаРасчета	= "Б9";
						СтрокаТаблицы.ПериодДействияНачало	= ПериодРегистрации;
						СтрокаТаблицы.ПериодДействияКонец	= КонецДня(КонецМесяца(ПериодРегистрации));
						СтрокаТаблицы.ОтработаноДней		= 0;
						СтрокаТаблицы.ОтработаноЧасов		= 0;
						СтрокаТаблицы.ОплаченоДней			= 0;
						СтрокаТаблицы.ОплаченоЧасов			= 0;
						СтрокаТаблицы.Начисления			= ВыборкаЗапросаПоСотрудникам.МатериальнаяВыгода;
						СтрокаТаблицы.Удержания				= 0;
						СтрокаТаблицы.Регистратор			= Неопределено;
						
					КонецЕсли;
					
					СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
					
					СтрокаТаблицы.ВидДвижения			= 5;
					СтрокаТаблицы.ВидРасчета			= "Погашение займа";
					СтрокаТаблицы.ПорядокВидаРасчета	= "В";
					СтрокаТаблицы.ПериодДействияНачало	= ПериодРегистрации;
					СтрокаТаблицы.ПериодДействияКонец	= КонецДня(КонецМесяца(ПериодРегистрации));
					СтрокаТаблицы.ОтработаноДней		= 0;
					СтрокаТаблицы.ОтработаноЧасов		= 0;
					СтрокаТаблицы.ОплаченоДней			= 0;
					СтрокаТаблицы.ОплаченоЧасов			= 0;
					СтрокаТаблицы.Начисления			= 0;
					СтрокаТаблицы.Удержания				= ВыборкаЗапросаПоСотрудникам.ПогашеноЗайма;
					СтрокаТаблицы.Регистратор			= Неопределено;
					
					Если ВыборкаЗапросаПоСотрудникам.НалогНаМатериальнуюВыгоду <> 0 и ВыборкаЗапросаПоСотрудникам.СтавкаНалогообложенияМатвыгоды = Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка35 Тогда
						
						СтрокаТаблицы = ТаблицаРезультатовЗапроса.Добавить();
						
						СтрокаТаблицы.ВидДвижения			= 5;
						СтрокаТаблицы.ВидРасчета			= "Подоходный налог";//О.Т. 16.02.2015 № 362
						СтрокаТаблицы.ПорядокВидаРасчета	= "Б";
						СтрокаТаблицы.ПериодДействияНачало	= ПериодРегистрации;
						СтрокаТаблицы.ПериодДействияКонец	= КонецДня(КонецМесяца(ПериодРегистрации));
						СтрокаТаблицы.ОтработаноДней		= 0;
						СтрокаТаблицы.ОтработаноЧасов		= 0;
						СтрокаТаблицы.ОплаченоДней			= 0;
						СтрокаТаблицы.ОплаченоЧасов			= 0;
						СтрокаТаблицы.Начисления			= 0;
						СтрокаТаблицы.Удержания				= ВыборкаЗапросаПоСотрудникам.НалогНаМатериальнуюВыгоду;
						СтрокаТаблицы.Регистратор			= Неопределено;
						
					КонецЕсли;
					
				КонецЕсли;
				
			КонецЦикла;	
			
			ТаблицаРезультатовЗапроса.Сортировать("ВидДвижения, ПорядокВидаРасчета, ВидРасчета, ПериодДействияНачало"); 
			
			Для Каждого СтрокаТаблицы Из ТаблицаРезультатовЗапроса Цикл
				
				Если ЗначениеЗаполнено(СтрокаТаблицы.ПериодДействияКонец) Тогда
					ДатаОкончанияПериода = СтрокаТаблицы.ПериодДействияКонец
				Иначе
					ДатаОкончанияПериода = КонецМесяца(СтрокаТаблицы.ПериодДействияНачало);
				КонецЕсли;
				
				Если СтрокаТаблицы.ВидДвижения < 3 Тогда
					НомерСтроки = ВысотаТаблицы + КоличествоНачислений;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Текст = СтрокаТаблицы.ВидРасчета;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Расшифровка = СтрокаТаблицы.Регистратор;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).ПараметрРасшифровки = "Расшифровка";
					
					Если СтрокаТаблицы.Регистратор <> Неопределено Тогда
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Примечание.Текст = СтрокаТаблицы.ОписаниеРегистратора;
					КонецЕсли;
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).Текст = ОбщегоНазначения.ОписаниеПериода(СтрокаТаблицы.ПериодДействияНачало, ДатаОкончанияПериода);
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаОтработаноДней - 1).Объединить();
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОтработаноДней).Текст	= СтрокаТаблицы.ОтработаноДней;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОтработаноЧасов).Текст	= СтрокаТаблицы.ОтработаноЧасов;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОплаченоДней).Текст		= СтрокаТаблицы.ОплаченоДней;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОплаченоЧасов).Текст		= СтрокаТаблицы.ОплаченоЧасов;
					//О.Т. Аверсон 08.06.2016 № 1190
					если ПериодРегистрации >= Дата(2016,07,01) Тогда 
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).Текст = Формат(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТаблицы.Начисления,ПериодРегистрации),"ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления));
					иначе
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).Текст = Формат(СтрокаТаблицы.Начисления,"ЧЦ=15; ЧДЦ=0");
					КонецЕсли;
					//О.Т. Аверсон 08.06.2016 № 1190
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаУдержано - 1).Объединить();
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаПериодУдержано - 1).Объединить();
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаСуммаУдержано - 1).Объединить();
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).Объединить();				
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСправа = Линия;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСнизу = Линия;				
					
					КоличествоНачислений = КоличествоНачислений + 1;
					ВсегоНачисления = ВсегоНачисления + СтрокаТаблицы.Начисления;
					СуммаНаКонецПериода = СуммаНаКонецПериода + СтрокаТаблицы.Начисления;
					
				ИначеЕсли СтрокаТаблицы.ВидДвижения < 6 Тогда
					
					НомерСтроки = ВысотаТаблицы + КоличествоУдержаний;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).Текст = СтрокаТаблицы.ВидРасчета;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано).Расшифровка = СтрокаТаблицы.Регистратор;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано).ПараметрРасшифровки = "Расшифровка";
					
					
					Если СтрокаТаблицы.Регистратор <> Неопределено Тогда
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).Примечание.Текст = СтрокаТаблицы.ОписаниеРегистратора;
					КонецЕсли;
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Лево;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаПериодУдержано - 1).Объединить();
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).Текст = ОбщегоНазначения.ОписаниеПериода(СтрокаТаблицы.ПериодДействияНачало, ДатаОкончанияПериода);
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаСуммаУдержано - 1).Объединить();
					если ПериодРегистрации >= Дата(2016,07,01) Тогда 
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).Текст = Формат(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТаблицы.Удержания,ПериодРегистрации),"ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления));
					иначе
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).Текст = Формат(СтрокаТаблицы.Удержания,"ЧЦ=15; ЧДЦ=0");
					КонецЕсли;
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).Объединить();
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСправа = Линия;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСнизу = Линия;
					
					КоличествоУдержаний = КоличествоУдержаний + 1;
					ВсегоУдержания = ВсегоУдержания + СтрокаТаблицы.Удержания;
					СуммаНаКонецПериода = СуммаНаКонецПериода - СтрокаТаблицы.Удержания;
					
				Иначе
					
					// подведем итоги раздела начислений и удержаний
					// начнем раздел доходов в натуральной форме и выплат
					Если Не ИтогиНачисленийИУдержанийВыведены Тогда
						
						КолвоРасчетов = Макс(КоличествоНачислений,КоличествоУдержаний);
						
						Если КолвоРасчетов > 0 Тогда
							РасчертитьРасчетныйЛисток(ВременныйТабличныйДокумент,ВысотаТаблицы,КолвоРасчетов)
						КонецЕсли; 
						
						ОбластьВсего.Параметры.ВсегоНачисления = ВсегоНачисления;
						ОбластьВсего.Параметры.ВсегоУдержания  = ВсегоУдержания;
						
						ВременныйТабличныйДокумент.Вывести(ОбластьВсего);
						ИтогиНачисленийИУдержанийВыведены = Не ИтогиНачисленийИУдержанийВыведены;
						
						ВременныйТабличныйДокумент.Вывести(ОбластьНатурДоходыВыплаты);
						ВысотаТаблицы = ВременныйТабличныйДокумент.ВысотаТаблицы + 1;
						ВсегоНачисления = 0; КоличествоНачислений = 0;
						ВсегоУдержания = 0; КоличествоУдержаний  = 0;
						
					КонецЕсли;
					
					Если СтрокаТаблицы.ВидДвижения < 8 Тогда
						
						НомерСтроки = ВысотаТаблицы + КоличествоНачислений;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Текст = СтрокаТаблицы.ВидРасчета;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Расшифровка = СтрокаТаблицы.Регистратор;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).ПараметрРасшифровки = "Расшифровка";
						
						
						Если СтрокаТаблицы.Регистратор <> Неопределено Тогда
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Примечание.Текст = СтрокаТаблицы.ОписаниеРегистратора;
						КонецЕсли;
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).Текст = ОбщегоНазначения.ОписаниеПериода(СтрокаТаблицы.ПериодДействияНачало, ДатаОкончанияПериода);
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаОтработаноДней - 1).Объединить();
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОтработаноДней).Текст	= СтрокаТаблицы.ОтработаноДней;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОтработаноЧасов).Текст	= СтрокаТаблицы.ОтработаноЧасов;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОплаченоДней).Текст		= СтрокаТаблицы.ОплаченоДней;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОплаченоЧасов).Текст		= СтрокаТаблицы.ОплаченоЧасов;
						//О.Т. Аверсон 08.06.2016 № 1190
						если ПериодРегистрации >= Дата(2016,07,01) Тогда 
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).Текст = Формат(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТаблицы.Начисления,ПериодРегистрации),"ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления));
						иначе
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).Текст = Формат(СтрокаТаблицы.Начисления,"ЧЦ=15; ЧДЦ=0");
						КонецЕсли;
						//О.Т. Аверсон 08.06.2016 № 1190						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаУдержано - 1).Объединить();
						
						КоличествоНачислений = КоличествоНачислений + 1;
						ВсегоНачисления = ВсегоНачисления + СтрокаТаблицы.Начисления;
						//СуммаНаКонецПериода = СуммаНаКонецПериода + СтрокаТаблицы.Начисления;
						
					Иначе // остались выплаты
						
						НомерСтроки = ВысотаТаблицы + КоличествоУдержаний;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).Текст = СтрокаТаблицы.ВидРасчета;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано).Расшифровка = СтрокаТаблицы.Регистратор;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано).ПараметрРасшифровки = "Расшифровка";
						
						
						Если СтрокаТаблицы.Регистратор <> Неопределено Тогда
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).Примечание.Текст = СтрокаТаблицы.ОписаниеРегистратора;
						КонецЕсли;
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Лево;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаПериодУдержано - 1).Объединить();
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).Текст = ОбщегоНазначения.ОписаниеПериода(СтрокаТаблицы.ПериодДействияНачало, ДатаОкончанияПериода);
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаСуммаУдержано - 1).Объединить();
						//О.Т. Аверсон 08.06.2016 № 1190
						если ПериодРегистрации >= Дата(2016,07,01) Тогда 
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).Текст = Формат(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТаблицы.Удержания,ПериодРегистрации),"ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления));
						иначе
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).Текст = Формат(СтрокаТаблицы.Удержания,"ЧЦ=15; ЧДЦ=0");
						КонецЕсли;
						//О.Т. Аверсон 08.06.2016 № 1190
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).Объединить();
						
						КоличествоУдержаний = КоличествоУдержаний + 1;
						ВсегоУдержания = ВсегоУдержания + СтрокаТаблицы.Удержания;
						СуммаНаКонецПериода = СуммаНаКонецПериода - СтрокаТаблицы.Удержания;
						
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
			
			// расчертим линиями низ расчетного листками
			КолвоРасчетов = Макс(КоличествоНачислений,КоличествоУдержаний);
			
			Если КолвоРасчетов > 0 Тогда
				РасчертитьРасчетныйЛисток(ВременныйТабличныйДокумент,ВысотаТаблицы,КолвоРасчетов)
			КонецЕсли;
			
			Если Не ИтогиНачисленийИУдержанийВыведены Тогда // есть только начисления и удержания
				ОбластьВсего.Параметры.ВсегоНачисления = ВсегоНачисления;
				ОбластьВсего.Параметры.ВсегоУдержания  = ВсегоУдержания;
				ВременныйТабличныйДокумент.Вывести(ОбластьВсего);
				
			ИначеЕсли КолвоРасчетов > 0 Тогда  // остались итоги по натуральным доходам и выплатам
				ОбластьНатуральныеДоходы.Параметры.ВсегоНачисления = ВсегоНачисления;
				ОбластьНатуральныеДоходы.Параметры.ВсегоУдержания  = ВсегоУдержания;
				ВременныйТабличныйДокумент.Вывести(ОбластьНатуральныеДоходы);
				
			КонецЕсли;
			
			Если СуммаНаНачалоПериода >= 0  Тогда
				ОбластьПодвал.Параметры.ТекстДолгНаНачалоПериода = "Долг за организацией на начало месяца: ";
				ОбластьПодвал.Параметры.СуммаДолгНаНачалоПериода = СуммаНаНачалоПериода;
			Иначе
				ОбластьПодвал.Параметры.ТекстДолгНаНачалоПериода = "Долг за работником на начало месяца: ";
				ОбластьПодвал.Параметры.СуммаДолгНаНачалоПериода = 0 - СуммаНаНачалоПериода;
			КонецЕсли;
			
			Если СуммаНаКонецПериода >= 0  Тогда
				ОбластьПодвал.Параметры.ТекстДолгНаКонецПериода = "Долг за организацией на конец месяца: ";
				ОбластьПодвал.Параметры.СуммаДолгНаКонецПериода  = СуммаНаКонецПериода;
			Иначе
				ОбластьПодвал.Параметры.ТекстДолгНаКонецПериода = "Долг за работником на конец месяца: ";
				ОбластьПодвал.Параметры.СуммаДолгНаКонецПериода  = 0 - СуммаНаКонецПериода;
			КонецЕсли;
			
			ВременныйТабличныйДокумент.Вывести(ОбластьПодвал);
			
		Иначе //выводим в отчет только данные запроса
			
			Выборка = РезультатЗапроса.Выбрать();
			Если Выборка.Количество() = 0 Тогда
				//нет данных в запросе
				Возврат ВременныйТабличныйДокумент;	
			КонецЕсли;
			
			ТекстПериода = Формат(ПериодРегистрации, "ДФ = 'ММММ гггг ''г.'''");
			
			// Очистим временный табличный документ
			ВременныйТабличныйДокумент.Очистить();
			
			ВременныйТабличныйДокумент.Вывести(ОбластьЗаголовокТЧ);
			ВременныйТабличныйДокумент.Вывести(ОбластьНачисленоУдержано);
			
			ВысотаТаблицы = ВременныйТабличныйДокумент.ВысотаТаблицы + 1;
			
			ВсегоНачисления = 0; КоличествоНачислений = 0;
			ВсегоУдержания = 0; КоличествоУдержаний  = 0;
			ИтогиНачисленийИУдержанийВыведены = Ложь;
			
			Пока Выборка.Следующий() Цикл
				
				Если ЗначениеЗаполнено(Выборка.ПериодДействияКонец) Тогда
					ДатаОкончанияПериода = Выборка.ПериодДействияКонец;
					
				Иначе
					ДатаОкончанияПериода = КонецМесяца(Выборка.ПериодДействияНачало);
					
				КонецЕсли;
				
				Если Выборка.ВидДвижения < 3 Тогда
					НомерСтроки = ВысотаТаблицы + КоличествоНачислений;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Текст = Выборка.ВидРасчета;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Расшифровка = Выборка.Регистратор;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).ПараметрРасшифровки = "Расшифровка";
					Если Выборка.Регистратор <> Ссылка Тогда
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Примечание.Текст = Выборка.Регистратор;
					КонецЕсли;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).Текст = ОбщегоНазначения.ОписаниеПериода(Выборка.ПериодДействияНачало, ДатаОкончанияПериода);
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаОтработаноДней - 1).Объединить();
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОтработаноДней).Текст	= Выборка.ОтработаноДней;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОтработаноЧасов).Текст	= Выборка.ОтработаноЧасов;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОплаченоДней).Текст		= Выборка.ОплаченоДней;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОплаченоЧасов).Текст		= Выборка.ОплаченоЧасов;
					//О.Т. Аверсон 08.06.2016 № 1190
					если ПериодРегистрации >= Дата(2016,07,01) Тогда 
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).Текст = Формат(ОбщегоНазначения.ОкруглитьЗначение2016(Выборка.Начисления,ПериодРегистрации),"ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления));
					иначе
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).Текст = Формат(Выборка.Начисления,"ЧЦ=15; ЧДЦ=0");
					КонецЕсли;
					//О.Т. Аверсон 08.06.2016 № 1190
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаУдержано - 1).Объединить();
					
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаПериодУдержано - 1).Объединить();
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаСуммаУдержано - 1).Объединить();
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).Объединить();				
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСправа = Линия;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСнизу = Линия;
					
					
					КоличествоНачислений = КоличествоНачислений + 1;
					ВсегоНачисления = ВсегоНачисления + Выборка.Начисления;
					
				ИначеЕсли Выборка.ВидДвижения < 6 Тогда
					
					НомерСтроки = ВысотаТаблицы + КоличествоУдержаний;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).Текст = Выборка.ВидРасчета;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано).Расшифровка = Выборка.Регистратор;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано).ПараметрРасшифровки = "Расшифровка";
					
					Если Выборка.Регистратор <> Ссылка Тогда
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).Примечание.Текст = Выборка.Регистратор;
					КонецЕсли;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Лево;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаПериодУдержано - 1).Объединить();
					
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).Текст = ОбщегоНазначения.ОписаниеПериода(Выборка.ПериодДействияНачало, ДатаОкончанияПериода);
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаСуммаУдержано - 1).Объединить();
					//О.Т. Аверсон 08.06.2016 № 1190
					если ПериодРегистрации >= Дата(2016,07,01) Тогда 
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).Текст = Формат(ОбщегоНазначения.ОкруглитьЗначение2016(Выборка.Удержания,ПериодРегистрации),"ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления)); 
					иначе
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).Текст = Формат(Выборка.Удержания,"ЧЦ=15; ЧДЦ=0");
					КонецЕсли;
					//О.Т. Аверсон 08.06.2016 № 1190
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;								
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).Объединить();
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСправа = Линия;
					ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСнизу = Линия;
					
					КоличествоУдержаний = КоличествоУдержаний + 1;
					ВсегоУдержания = ВсегоУдержания + Выборка.Удержания;
					
				Иначе
					
					// подведем итоги раздела начислений и удержаний
					// начнем раздел доходов в натуральной форме и выплат
					Если Не ИтогиНачисленийИУдержанийВыведены Тогда
						
						КолвоРасчетов = Макс(КоличествоНачислений,КоличествоУдержаний);
						
						Если КолвоРасчетов > 0 Тогда
							РасчертитьРасчетныйЛисток(ВременныйТабличныйДокумент,ВысотаТаблицы,КолвоРасчетов)
						КонецЕсли;
						
						ОбластьВсего.Параметры.ВсегоНачисления = ВсегоНачисления;
						ОбластьВсего.Параметры.ВсегоУдержания  = ВсегоУдержания;
						
						ВременныйТабличныйДокумент.Вывести(ОбластьВсего);
						ИтогиНачисленийИУдержанийВыведены = Не ИтогиНачисленийИУдержанийВыведены;
						
						ВременныйТабличныйДокумент.Вывести(ОбластьНатурДоходыВыплаты);
						ВысотаТаблицы = ВременныйТабличныйДокумент.ВысотаТаблицы + 1;
						ВсегоНачисления = 0; КоличествоНачислений = 0;
						ВсегоУдержания = 0; КоличествоУдержаний  = 0;
						
					КонецЕсли;
					
					Если Выборка.ВидДвижения < 8 Тогда
						
						НомерСтроки = ВысотаТаблицы + КоличествоНачислений;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Текст = Выборка.ВидРасчета;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Расшифровка = Выборка.Регистратор;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).ПараметрРасшифровки = "Расшифровка";
						
						
						Если Выборка.Регистратор <> Ссылка Тогда
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).Примечание.Текст = Выборка.Регистратор;
						КонецЕсли;
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаНачислено).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).Текст = ОбщегоНазначения.ОписаниеПериода(Выборка.ПериодДействияНачало, ДатаОкончанияПериода);//Островская Татьяна 18.07.2013
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаПериодНачислено).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодНачислено, НомерСтроки, КолонкаОтработаноДней - 1).Объединить();
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОтработаноДней).Текст	= Выборка.ОтработаноДней;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОтработаноЧасов).Текст	= Выборка.ОтработаноЧасов;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОплаченоДней).Текст		= Выборка.ОплаченоДней;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаОплаченоЧасов).Текст		= Выборка.ОплаченоЧасов;
						если ПериодРегистрации >= Дата(2016,07,1) Тогда //О.Т. Аверсон 22.06.2016 № 949
							ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер; //О.Т. Аверсон 22.06.2016 № 949
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).Текст = Формат(Выборка.Начисления,"ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления));
						иначе
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).Текст = Формат(Выборка.Начисления,"ЧЦ=15; ЧДЦ=2");
						КонецЕсли;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаСуммаНачислено).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаНачислено, НомерСтроки, КолонкаУдержано - 1).Объединить();
						
						КоличествоНачислений = КоличествоНачислений + 1;
						ВсегоНачисления = ВсегоНачисления + Выборка.Начисления;
						
					Иначе // остались выплаты
						
						НомерСтроки = ВысотаТаблицы + КоличествоУдержаний;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).Текст = Выборка.ВидРасчета;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано).Расшифровка = Выборка.Регистратор;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано).ПараметрРасшифровки = "Расшифровка";
						
						Если Выборка.Регистратор <> Ссылка Тогда
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).Примечание.Текст = Выборка.Регистратор;
						КонецЕсли;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Лево;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаУдержано , НомерСтроки, КолонкаПериодУдержано - 1).Объединить();
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).Текст = ОбщегоНазначения.ОписаниеПериода(Выборка.ПериодДействияНачало, ДатаОкончанияПериода);
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаПериодУдержано).РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаПериодУдержано, НомерСтроки, КолонкаСуммаУдержано - 1).Объединить();
						//О.Т. Аверсон 08.06.2016 № 1190
						если ПериодРегистрации >= Дата(2016,07,01) Тогда 
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).Текст = Формат(ОбщегоНазначения.ОкруглитьЗначение2016(Выборка.Удержания,ПериодРегистрации),"ЧЦ=15; ЧДЦ="+Строка(ЗначениеОкругления)); 
						иначе
							ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).Текст = Формат(Выборка.Удержания,"ЧЦ=15; ЧДЦ=0");
						КонецЕсли;
						//О.Т. Аверсон 08.06.2016 № 1190
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано).ГоризонтальноеПоложение = ГоризонтальноеПоложение.Право;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).Объединить();
						
						КоличествоУдержаний = КоличествоУдержаний + 1;
						ВсегоУдержания = ВсегоУдержания + Выборка.Удержания;
						
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСправа = Линия;
						ВременныйТабличныйДокумент.Область(НомерСтроки, КолонкаСуммаУдержано, НомерСтроки, КолонкаСуммаУдержано + 1).ГраницаСнизу = Линия;
						
					КонецЕсли;
					
				КонецЕсли;
				
			КонецЦикла;
			
			// Данные для подвала
			СуммаНаНачалоПериода = Выборка.СуммаВзаиморасчетовНачальныйОстаток;
			СуммаНаКонецПериода  = Выборка.СуммаВзаиморасчетовКонечныйОстаток;
			
			// расчертим линиями низ расчетного листками
			КолвоРасчетов = Макс(КоличествоНачислений,КоличествоУдержаний);
			
			Если КолвоРасчетов > 0 Тогда
				РасчертитьРасчетныйЛисток(ВременныйТабличныйДокумент,ВысотаТаблицы,КолвоРасчетов)
			КонецЕсли;
			
			Если Не ИтогиНачисленийИУдержанийВыведены Тогда // есть только начисления и удержания
				ОбластьВсего.Параметры.ВсегоНачисления = ВсегоНачисления;
				ОбластьВсего.Параметры.ВсегоУдержания  = ВсегоУдержания;
				ВременныйТабличныйДокумент.Вывести(ОбластьВсего);
			ИначеЕсли КолвоРасчетов > 0 Тогда  // остались итоги по натуральным доходам и выплатам
				ОбластьНатуральныеДоходы.Параметры.ВсегоНачисления = ВсегоНачисления;
				ОбластьНатуральныеДоходы.Параметры.ВсегоУдержания  = ВсегоУдержания;
				ВременныйТабличныйДокумент.Вывести(ОбластьНатуральныеДоходы);
			КонецЕсли;
			
			Если СуммаНаНачалоПериода = NULL Тогда
				
				ОбластьПодвал.Параметры.ТекстДолгНаНачалоПериода = "Долг за организацией на начало месяца: ";
				ОбластьПодвал.Параметры.СуммаДолгНаНачалоПериода = 0;
				
			Иначе
				
				Если СуммаНаНачалоПериода >= 0  Тогда
					ОбластьПодвал.Параметры.ТекстДолгНаНачалоПериода = "Долг за организацией на начало месяца: ";
					ОбластьПодвал.Параметры.СуммаДолгНаНачалоПериода = СуммаНаНачалоПериода;
				Иначе
					ОбластьПодвал.Параметры.ТекстДолгНаНачалоПериода = "Долг за работником на начало месяца: ";
					ОбластьПодвал.Параметры.СуммаДолгНаНачалоПериода = 0 - СуммаНаНачалоПериода;
				КонецЕсли;
				
			КонецЕсли;
			
			Если СуммаНаКонецПериода = NULL Тогда
				
				ОбластьПодвал.Параметры.ТекстДолгНаКонецПериода = "Долг за работником на конец месяца: ";
				ОбластьПодвал.Параметры.СуммаДолгНаКонецПериода  = 0;
				
			Иначе
				
				Если СуммаНаКонецПериода >= 0  Тогда
					ОбластьПодвал.Параметры.ТекстДолгНаКонецПериода = "Долг за организацией на конец месяца: ";
					ОбластьПодвал.Параметры.СуммаДолгНаКонецПериода  = СуммаНаКонецПериода;
				Иначе
					ОбластьПодвал.Параметры.ТекстДолгНаКонецПериода = "Долг за работником на конец месяца: ";
					ОбластьПодвал.Параметры.СуммаДолгНаКонецПериода  = 0 - СуммаНаКонецПериода;
				КонецЕсли;
				
			КонецЕсли;
			
			ВременныйТабличныйДокумент.Вывести(ОбластьПодвал);
			
		КонецЕсли;
		
		Возврат ВременныйТабличныйДокумент;
		
	КонецФункции //ЗаполнитьТаблицуРасчетногоЛистка()
	
#КонецЕсли

// Выполняет автоматическое заполнение документа по данным документа и переданным параметрам
// 
// Параметры: 
//	ПостроительЗапроса - построитель запроса, который используется для ограничения состава физлиц
//						 по которым выполняется заполнение документа
//
// Возвращаемое значение:
//	Логическое - удалось ли выполнить автоматическое заполнение документа
//
Функция Автозаполнение(Запрос = Неопределено,ТЧДоговора = Ложь) Экспорт
	
	Начисления.Очистить();
	ДополнительныеНачисления.Очистить();
	НДФЛ.Очистить();
	ПенсионныйФонд.Очистить();
	ДополнительнаяПенсия.Очистить(); //Аверсон 01.07.2022 КВВ СВФР-009250
	Удержания.Очистить();
	ПогашениеЗаймов.Очистить();
	//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
	
	Возврат ВыполнитьАвтозаполнение(ПериодНачисленияДатаНачала, ПериодНачисленияДатаОкончания, Запрос,Ложь,Неопределено,Неопределено,ТЧДоговора);
	//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
КонецФункции // Автозаполнение()

Функция ПолучитьДокументыРасчетаЗаВесьМесяц() Экспорт
	
	Если ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца Тогда
		// проверим, можно ли произвести расчет - поищем "мешающие" документы
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("Ссылка",Ссылка);
		Запрос.УстановитьПараметр("ПериодРегистрации",ПериодРегистрации);
		МенеджерВТ = Новый МенеджерВременныхТаблиц;
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		Запрос.Текст =
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник КАК Сотрудник
		|ПОМЕСТИТЬ ВТСписокСотрудников
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка = &Ссылка
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка = &Ссылка
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник";
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка,
		|	ПРЕДСТАВЛЕНИЕ(НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка) КАК Представление
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокСотрудников КАК СписокСотрудников
		|		ПО НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник = СписокСотрудников.Сотрудник
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПериодРегистрации = &ПериодРегистрации
		|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.ПериодНачисления = ЗНАЧЕНИЕ(Перечисление.ПериодНачисленияЗарплаты.ТекущийМесяц)
		|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка <> &Ссылка
		|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка.Проведен
		|
		|ОБЪЕДИНИТЬ 
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка,
		|	ПРЕДСТАВЛЕНИЕ(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка)
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокСотрудников КАК СписокСотрудников
		|		ПО НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник = СписокСотрудников.Сотрудник
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка.ПериодРегистрации = &ПериодРегистрации
		|	И НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка.ПериодНачисления = ЗНАЧЕНИЕ(Перечисление.ПериодНачисленияЗарплаты.ТекущийМесяц)
		|	И НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка <> &Ссылка
		|	И НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка.Проведен";
		
		Возврат Запрос.Выполнить().Выгрузить();
	Иначе
		Возврат Новый Массив
	КонецЕсли;
	
КонецФункции

//заявка №1604 (база заявок Кристалла) Дмитрук О.Г
//Выборка корректировки премии по текущему месяцу
Функция СформироватьЗапросПоКорректировкеПремии(Сотрудник, ВидРасчета, ДатаНачала, ДатаОкончания)
	Запрос = Новый Запрос;
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	КорректировкаПроцентаПремии.Сотрудник,
	|	КорректировкаПроцентаПремии.ВидРасчета,
	|	КорректировкаПроцентаПремии.ДатаНачала,
	|	КорректировкаПроцентаПремии.ДатаОкончания,
	|	КорректировкаПроцентаПремии.Процент
	|ИЗ
	|	РегистрСведений.КорректировкаПроцентаПремии КАК КорректировкаПроцентаПремии
	|ГДЕ
	|	КорректировкаПроцентаПремии.ВидРасчета = &ВидРасчета
	|	И КорректировкаПроцентаПремии.Организация = &Организация
	|	И КорректировкаПроцентаПремии.Сотрудник = &Сотрудник	
	|	И КорректировкаПроцентаПремии.ДатаНачала <= &ДатаНачала
	|	И КорректировкаПроцентаПремии.ДатаОкончания >= &ДатаОкончания";
	
	Запрос.УстановитьПараметр("Организация", ОбщегоНазначения.ГоловнаяОрганизация(Организация));
	Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
	Запрос.УстановитьПараметр("ДатаНачала", ДатаНачала);
	Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончания);
	Запрос.УстановитьПараметр("ВидРасчета", ВидРасчета);
	
	Запрос.Текст = ТекстЗапроса;
	РезультатВыборка = Запрос.Выполнить();
	
	Возврат РезультатВыборка;
КонецФункции	
//заявка №1604 

// Заполняет документ-исправление по переданному списку сотрудников
//
Процедура ЗаполнитьПоПерерассчитываемомуДокументу(ИсходныйДокумент, Знач Сотрудники = Неопределено) Экспорт
	
	ПерерассчитываемыйДокумент = ИсходныйДокумент.Ссылка;
	
	// выполним заполнение по всем табличным частям документа
	// и получим список сотрудников для перезаполнения
	
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("ПерерассчитываемыйДокумент", ПерерассчитываемыйДокумент);
	
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	Запрос.УстановитьПараметр("Сотрудники", Сотрудники);
	Запрос.УстановитьПараметр("ПоВсемСотрудникам", Сотрудники = Неопределено);
	
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Если Сотрудники = "ПоДаннымПерерасчета" Тогда
		
		Исправления = ПроведениеРасчетов.ПолучитьДокументИсправление(ПерерассчитываемыйДокумент, "КритерийОтбора"); 
		Запрос.УстановитьПараметр("Исправления", Исправления);
		
		Запрос.Текст =
		"ВЫБРАТЬ
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник КАК Сотрудник
		|ПОМЕСТИТЬ ВТСотрудникиИсправлений
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка В(&Исправления)
		|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Сторно
		|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.СторнируемыйДокумент = &ПерерассчитываемыйДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Ссылка В(&Исправления)
		|	И НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сторно
		|	И НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.СторнируемыйДокумент = &ПерерассчитываемыйДокумент
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
		|ГДЕ
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Ссылка В(&Исправления)
		|	И НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сторно
		|	И НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.СторнируемыйДокумент = &ПерерассчитываемыйДокумент
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник";
		Запрос.Выполнить();
		
		Запрос.Текст =
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СотрудникиОрганизаций.Сотрудник,
		|	СотрудникиОрганизаций.Физлицо КАК Физлицо
		|ПОМЕСТИТЬ ВТФизлицаПерерасчета
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СотрудникиОрганизаций
		|ГДЕ
		|	СотрудникиОрганизаций.Ссылка = &ПерерассчитываемыйДокумент
		|	И СотрудникиОрганизаций.Физлицо В
		|			(ВЫБРАТЬ
		|				Перерасчет.ФизЛицо
		|			ИЗ
		|				РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ПерерасчетОсновныхНачислений КАК Перерасчет
		|			ГДЕ
		|				Перерасчет.ОбъектПерерасчета = &ПерерассчитываемыйДокумент
		|		
		|			ОБЪЕДИНИТЬ ВСЕ
		|		
		|			ВЫБРАТЬ
		|				ЗаполнениеПлановыхНачислений.Сотрудник.Физлицо
		|			ИЗ
		|				РегистрСведений.ЗаполнениеПлановыхНачислений КАК ЗаполнениеПлановыхНачислений
		|			ГДЕ
		|				ЗаполнениеПлановыхНачислений.ОбъектЗаполнения = &ПерерассчитываемыйДокумент)
		|	И (НЕ СотрудникиОрганизаций.Сотрудник В
		|				(ВЫБРАТЬ
		|					Начисления.Сотрудник
		|				ИЗ
		|					ВТСотрудникиИсправлений КАК Начисления))
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СотрудникиОрганизаций.Сотрудник,
		|	СотрудникиОрганизаций.Физлицо
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК СотрудникиОрганизаций
		|ГДЕ
		|	СотрудникиОрганизаций.Ссылка = &ПерерассчитываемыйДокумент
		|	И СотрудникиОрганизаций.Физлицо В
		|			(ВЫБРАТЬ
		|				Перерасчет.ФизЛицо
		|			ИЗ
		|				РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.ПерерасчетДополнительныхНачислений КАК Перерасчет
		|			ГДЕ
		|				Перерасчет.ОбъектПерерасчета = &ПерерассчитываемыйДокумент
		|		
		|			ОБЪЕДИНИТЬ ВСЕ
		|		
		|			ВЫБРАТЬ
		|				ЗаполнениеПлановыхНачислений.Сотрудник.Физлицо
		|			ИЗ
		|				РегистрСведений.ЗаполнениеПлановыхНачислений КАК ЗаполнениеПлановыхНачислений
		|			ГДЕ
		|				ЗаполнениеПлановыхНачислений.ОбъектЗаполнения = &ПерерассчитываемыйДокумент)
		|	И (НЕ СотрудникиОрганизаций.Сотрудник В
		|				(ВЫБРАТЬ
		|					Начисления.Сотрудник
		|				ИЗ
		|					ВТСотрудникиИсправлений КАК Начисления))
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Физлицо";
		Запрос.Выполнить();
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	СотрудникиОрганизаций.Сотрудник
		|ИЗ
		|	ВТФизлицаПерерасчета КАК СотрудникиОрганизаций";
		Сотрудники = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Сотрудник");
		Запрос.УстановитьПараметр("Сотрудники", Сотрудники);
		
	ИначеЕсли Сотрудники <> Неопределено Тогда
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СотрудникиОрганизаций.Физлицо КАК Физлицо
		|ПОМЕСТИТЬ ВТФизлицаПерерасчета
		|ИЗ
		|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
		|ГДЕ
		|	СотрудникиОрганизаций.Ссылка В(&Сотрудники)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Физлицо";
		Запрос.Выполнить();
		
	Иначе 
		
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НЕОПРЕДЕЛЕНО КАК Физлицо
		|ПОМЕСТИТЬ ВТФизлицаПерерасчета";
		Запрос.Выполнить();
		
	КонецЕсли;
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Начисления.Сотрудник,
	|	Начисления.Физлицо,
	|	Начисления.ВидРасчета,
	|	Начисления.ДатаНачала,
	|	Начисления.ДатаОкончания,
	|	Начисления.Показатель1,
	|	Начисления.Показатель2,
	|	Начисления.Показатель3,
	|	Начисления.Показатель4,
	|	Начисления.Показатель5,
	|	Начисления.Показатель6,
	|	Начисления.ПодразделениеОрганизации,
	//ПСА 22.10.2021 СВФР-008294 +++
	//|	-Начисления.Результат - ЕСТЬNULL(СУММА(СторноНачисления.Результат), 0) КАК Результат,
	//|	-Начисления.ОплаченоДнейЧасов - ЕСТЬNULL(СУММА(СторноНачисления.ОплаченоДнейЧасов), 0) КАК ОплаченоДнейЧасов,
	//|	-Начисления.ОтработаноДней - ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДней), 0) КАК ОтработаноДней,
	//|	-Начисления.ОтработаноЧасов - ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасов), 0) КАК ОтработаноЧасов,
	//|	-Начисления.ОтработаноДнейПоПятидневке - ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДнейПоПятидневке), 0) КАК ОтработаноДнейПоПятидневке,
	//|	-Начисления.ОтработаноЧасовПоПятидневке - ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасовПоПятидневке), 0) КАК ОтработаноЧасовПоПятидневке,
	//|	-Начисления.НормаДней - ЕСТЬNULL(СУММА(СторноНачисления.НормаДней), 0) КАК НормаДней,
	//|	-Начисления.НормаЧасов - ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасов), 0) КАК НормаЧасов,
	//|	-Начисления.НормаДнейПоПятидневке - ЕСТЬNULL(СУММА(СторноНачисления.НормаДнейПоПятидневке), 0) КАК НормаДнейПоПятидневке,
	//|	-Начисления.НормаЧасовПоПятидневке - ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасовПоПятидневке), 0) КАК НормаЧасовПоПятидневке,
	|	-Начисления.Результат - ЕСТЬNULL((СторноНачисления.Результат), 0) КАК Результат,
	|	-Начисления.ОплаченоДнейЧасов - ЕСТЬNULL((СторноНачисления.ОплаченоДнейЧасов), 0) КАК ОплаченоДнейЧасов,
	|	-Начисления.ОтработаноДней - ЕСТЬNULL((СторноНачисления.ОтработаноДней), 0) КАК ОтработаноДней,
	|	-Начисления.ОтработаноЧасов - ЕСТЬNULL((СторноНачисления.ОтработаноЧасов), 0) КАК ОтработаноЧасов,
	|	-Начисления.ОтработаноДнейПоПятидневке - ЕСТЬNULL((СторноНачисления.ОтработаноДнейПоПятидневке), 0) КАК ОтработаноДнейПоПятидневке,
	|	-Начисления.ОтработаноЧасовПоПятидневке - ЕСТЬNULL((СторноНачисления.ОтработаноЧасовПоПятидневке), 0) КАК ОтработаноЧасовПоПятидневке,
	|	-Начисления.НормаДней - ЕСТЬNULL((СторноНачисления.НормаДней), 0) КАК НормаДней,
	|	-Начисления.НормаЧасов - ЕСТЬNULL((СторноНачисления.НормаЧасов), 0) КАК НормаЧасов,
	|	-Начисления.НормаДнейПоПятидневке - ЕСТЬNULL((СторноНачисления.НормаДнейПоПятидневке), 0) КАК НормаДнейПоПятидневке,
	|	-Начисления.НормаЧасовПоПятидневке - ЕСТЬNULL((СторноНачисления.НормаЧасовПоПятидневке), 0) КАК НормаЧасовПоПятидневке,
	//+++ ПСА 22.10.2021 СВФР-008294 
	|	Начисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	Начисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	Начисления.ДатаНачалаСобытия,
	|	ИСТИНА КАК Сторно,
	|	&ПерерассчитываемыйДокумент КАК СторнируемыйДокумент
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК СторноНачисления
	|		ПО Начисления.Сотрудник = СторноНачисления.Сотрудник
	|			И Начисления.ВидРасчета = СторноНачисления.ВидРасчета
	|			И (СторноНачисления.ПериодДействияНачало МЕЖДУ Начисления.ДатаНачала И Начисления.ДатаОкончания)
	|			И (СторноНачисления.ПериодДействияКонец МЕЖДУ Начисления.ДатаНачала И Начисления.ДатаОкончания)
	|			И (СторноНачисления.ПериодРегистрации > Начисления.Ссылка.ПериодРегистрации)
	|			И (СторноНачисления.ПериодРегистрации <= &ПериодРегистрации)
	|			И (СторноНачисления.СторнируемыйДокумент = Начисления.Ссылка)
	|			И (СторноНачисления.Сторно)
	|ГДЕ
	|	Начисления.Ссылка = &ПерерассчитываемыйДокумент
	|	И (НЕ Начисления.Сторно)
	|	И (&ПоВсемСотрудникам
	|			ИЛИ Начисления.Сотрудник В (&Сотрудники))
	|	И Начисления.Ссылка.Проведен
	|";
	//ПСА 22.10.2021 СВФР-008294 ---
	//|СГРУППИРОВАТЬ ПО
	//|	Начисления.Сотрудник,
	//|	Начисления.Физлицо,
	//|	Начисления.ВидРасчета,
	//|	Начисления.ДатаНачала,
	//|	Начисления.ДатаОкончания,
	//|	Начисления.Показатель1,
	//|	Начисления.Показатель2,
	//|	Начисления.Показатель3,
	//|	Начисления.Показатель4,
	//|	Начисления.Показатель5,
	//|	Начисления.Показатель6,
	//|	Начисления.ПодразделениеОрганизации,
	//|	Начисления.ПериодРасчетаСреднегоЗаработкаНачало,
	//|	Начисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	//|	Начисления.ДатаНачалаСобытия,
	//|	Начисления.Результат,
	//|	Начисления.ОплаченоДнейЧасов,
	//|	Начисления.ОтработаноДней,
	//|	Начисления.ОтработаноЧасов,
	//|	Начисления.ОтработаноДнейПоПятидневке,
	//|	Начисления.ОтработаноЧасовПоПятидневке,
	//|	Начисления.НормаДней,
	//|	Начисления.НормаЧасов,
	//|	Начисления.НормаДнейПоПятидневке,
	//|	Начисления.НормаЧасовПоПятидневке";
	//---ПСА 22.10.2021 СВФР-008294
	Выборка = Запрос.Выполнить().Выбрать();
	Сотрудники = Новый Массив;
	Пока Выборка.Следующий() Цикл
		// сторно-строка
		ЗаполнитьЗначенияСвойств(Начисления.Добавить(), Выборка);
		Если Сотрудники.Найти(Выборка.Сотрудник) = Неопределено Тогда
			Сотрудники.Добавить(Выборка.Сотрудник);
		КонецЕсли;
	КонецЦикла;
	// выполним запрос к ДополнительныеНачисления
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Начисления.Сотрудник,
	|	Начисления.Физлицо,
	|	Начисления.ВидРасчета,
	|	Начисления.ДатаНачала,
	|	Начисления.ДатаОкончания,
	|	Начисления.Показатель1,
	|	Начисления.Показатель2,
	|	Начисления.Показатель3,
	|	Начисления.Показатель4,
	|	Начисления.Показатель5,
	|	Начисления.Показатель6,
	|	-Начисления.Результат КАК Результат,
	|	Начисления.ПодразделениеОрганизации,
	|	Начисления.КодВычета,
	|	-Начисления.СуммаВычета КАК СуммаВычета,
	|	ИСТИНА КАК Сторно,
	|	&ПерерассчитываемыйДокумент КАК СторнируемыйДокумент,
	|	Начисления.ДатаНачалаСобытия,
	|	Начисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	Начисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	-Начисления.ОплаченоДнейЧасов КАК ОплаченоДнейЧасов
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
	|ГДЕ
	|	Начисления.Ссылка = &ПерерассчитываемыйДокумент
	|	И (НЕ Начисления.Сторно)
	|	И (&ПоВсемСотрудникам
	|			ИЛИ Начисления.Сотрудник В (&Сотрудники))
	|	И Начисления.Ссылка.Проведен";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		// сторно-строка
		ЗаполнитьЗначенияСвойств(ДополнительныеНачисления.Добавить(), Выборка);
		Если Сотрудники.Найти(Выборка.Сотрудник) = Неопределено Тогда
			Сотрудники.Добавить(Выборка.Сотрудник);
		КонецЕсли;
	КонецЦикла;
	
	// выполним запрос к ДоговорыНаВыполнениеРабот
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	ДоговорыНаВыполнениеРабот.Сотрудник,
	|	ДоговорыНаВыполнениеРабот.Физлицо,
	|	ДоговорыНаВыполнениеРабот.ВидРасчета,
	|	ДоговорыНаВыполнениеРабот.ДатаНачала,
	|	ДоговорыНаВыполнениеРабот.ДатаОкончания,
	|	ДоговорыНаВыполнениеРабот.Размер,
	|	ДоговорыНаВыполнениеРабот.ПодразделениеОрганизации,
	|	ДоговорыНаВыполнениеРабот.КодВычета,
	|	-ДоговорыНаВыполнениеРабот.СуммаВычета КАК СуммаВычета,
	|	-ДоговорыНаВыполнениеРабот.Результат КАК Результат,
	|	ИСТИНА КАК Сторно,
	|	&ПерерассчитываемыйДокумент КАК СторнируемыйДокумент,
	|	ДоговорыНаВыполнениеРабот.ДокументОснование
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК ДоговорыНаВыполнениеРабот
	|ГДЕ
	|	ДоговорыНаВыполнениеРабот.Ссылка = &ПерерассчитываемыйДокумент
	|	И (НЕ ДоговорыНаВыполнениеРабот.Сторно)
	|	И (&ПоВсемСотрудникам
	|			ИЛИ Сотрудник В (&Сотрудники))
	|	И ДоговорыНаВыполнениеРабот.Ссылка.Проведен";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		// сторно-строка
		ЗаполнитьЗначенияСвойств(ДоговорыНаВыполнениеРабот.Добавить(), Выборка);
		Если Сотрудники.Найти(Выборка.Сотрудник) = Неопределено Тогда
			Сотрудники.Добавить(Выборка.Сотрудник);
		КонецЕсли;
	КонецЦикла;
	
	// выполним запрос к Удержания
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Удержания.ФизЛицо,
	|	Удержания.ВидРасчета,
	|	Удержания.Показатель1,
	|	Удержания.Показатель2,
	|	Удержания.Показатель3,
	|	Удержания.Показатель4,
	|	Удержания.Показатель5,
	|	Удержания.Показатель6,
	|	Удержания.ДатаНачала,
	|	Удержания.ДатаОкончания,
	|	Удержания.ДокументОснование,
	|	-Удержания.Результат КАК Результат,
	|	ИСТИНА КАК Сторно,
	|	Удержания.ПериодРасчетаСреднегоЗаработкаНачало,
	|	Удержания.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	Удержания.ДатаНачалаСобытия
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК Удержания
	|ГДЕ
	|	Удержания.Ссылка = &ПерерассчитываемыйДокумент
	|	И (НЕ Удержания.Сторно)
	|	И (&ПоВсемСотрудникам
	|			ИЛИ Удержания.ФизЛицо В
	|				(ВЫБРАТЬ
	|					Физлица.Физлицо
	|				ИЗ
	|					ВТФизлицаПерерасчета КАК Физлица))
	|	И Удержания.Ссылка.Проведен";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		// сторно-строка
		ЗаполнитьЗначенияСвойств(Удержания.Добавить(), Выборка);
	КонецЦикла;
	
	// выполним запрос к ПогашениеЗаймов
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Займы.ФизЛицо,
	|	ИСТИНА КАК Сторно,
	|	Займы.ДоговорЗайма,
	|	Займы.СтавкаНалогообложенияМатвыгоды,
	|	Займы.ПодразделениеОрганизации,
	|	-Займы.НачисленоПроцентов КАК НачисленоПроцентов,
	|	-Займы.ПогашеноПроцентов КАК ПогашеноПроцентов,
	|	-Займы.ПогашеноЗайма КАК ПогашеноЗайма,
	|	-Займы.МатериальнаяВыгода КАК МатериальнаяВыгода,
	|	-Займы.НалогНаМатериальнуюВыгоду КАК НалогНаМатериальнуюВыгоду
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов КАК Займы
	|ГДЕ
	|	Займы.Ссылка = &ПерерассчитываемыйДокумент
	|	И (НЕ Займы.Сторно)
	|	И (&ПоВсемСотрудникам
	|			ИЛИ Займы.ФизЛицо В
	|				(ВЫБРАТЬ
	|					Физлица.Физлицо
	|				ИЗ
	|					ВТФизлицаПерерасчета КАК Физлица))
	|	И Займы.Ссылка.Проведен
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Займы.ФизЛицо,
	|	ЛОЖЬ,
	|	Займы.ДоговорЗайма,
	|	Займы.СтавкаНалогообложенияМатвыгоды,
	|	Займы.ПодразделениеОрганизации,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов КАК Займы
	|ГДЕ
	|	Займы.Ссылка = &ПерерассчитываемыйДокумент
	|	И (НЕ Займы.Сторно)
	|	И (&ПоВсемСотрудникам
	|			ИЛИ Займы.ФизЛицо В
	|				(ВЫБРАТЬ
	|					Физлица.Физлицо
	|				ИЗ
	|					ВТФизлицаПерерасчета КАК Физлица))
	|	И Займы.Ссылка.Проведен";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		// сторно-строка
		ЗаполнитьЗначенияСвойств(ПогашениеЗаймов.Добавить(), Выборка);
	КонецЦикла;
	
	ЗапросПериод = Новый Запрос;
	ЗапросПериод.Текст =
	"ВЫБРАТЬ
	|	НачислениеЗарплатыРаботникамОрганизаций.ПериодНачисленияДатаНачала,
	|	НачислениеЗарплатыРаботникамОрганизаций.ПериодНачисленияДатаОкончания,
	|	НачислениеЗарплатыРаботникамОрганизаций.Организация,
	|	НачислениеЗарплатыРаботникамОрганизаций.ПодразделениеОрганизации,
	|	НачислениеЗарплатыРаботникамОрганизаций.ВидОперации
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций КАК НачислениеЗарплатыРаботникамОрганизаций
	|ГДЕ
	|	НачислениеЗарплатыРаботникамОрганизаций.Ссылка = &ПерерассчитываемыйДокумент";
	
	ЗапросПериод.УстановитьПараметр("ПерерассчитываемыйДокумент", ПерерассчитываемыйДокумент);
	Выборка = ЗапросПериод.Выполнить().Выбрать();
	Выборка.Следующий();
	
	ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод;
	ЗаполнитьЗначенияСвойств(ЭтотОбъект,Выборка);
	
	ВыполнитьАвтозаполнение(Выборка.ПериодНачисленияДатаНачала, Выборка.ПериодНачисленияДатаОкончания, , Истина, , Сотрудники);
	
КонецПроцедуры // ЗаполнитьПоПерерассчитываемомуДокументу()

// Процедура выполняет автозаполнение табличных частей только по переданным сотрудникам,
// остальные строки табличных частей документа остаются нетронутыми.
//
// Параметры: МассивСотрудников -  Массив сотрудников организации, по которым нужно сделать перезаполнение документа.
Процедура ВыполнитьПерезаполнениеПоВыбраннымСотрудникам(МассивСотрудников, МассивФизЛиц) Экспорт
	
	// сохраним табличные данные в таблицы значений
	ТаблицаНачисления = Начисления.Выгрузить();
	ТаблицаДополнительныеНачисления = ДополнительныеНачисления.Выгрузить();
	ТаблицаДоговорыНаВыполнениеРабот = ДоговорыНаВыполнениеРабот.Выгрузить();
	ТаблицаУдержания = Удержания.Выгрузить();
	ТаблицаНДФЛ = НДФЛ.Выгрузить();
	ТаблицаПогашениеЗаймов = ПогашениеЗаймов.Выгрузить();
	// Удалим из таблиц сотрудников которых нужно перезаполнить.
	
	// Удаляем из таблицы начисления
	ИндексСтроки = ТаблицаНачисления.Количество()-1;
	Пока ИндексСтроки >= 0 Цикл
		Если МассивСотрудников.Найти(ТаблицаНачисления[ИндексСтроки].Сотрудник) <> Неопределено Тогда
			ТаблицаНачисления.Удалить(ИндексСтроки);
		КонецЕсли;
		ИндексСтроки = ИндексСтроки - 1;
	КонецЦикла;
	
	// Удаляем из таблицы дополнительные начисления
	ИндексСтроки = ТаблицаДополнительныеНачисления.Количество() - 1;
	Пока ИндексСтроки >=0 Цикл
		Если МассивСотрудников.Найти(ТаблицаДополнительныеНачисления[ИндексСтроки].Сотрудник) <> Неопределено Тогда
			ТаблицаДополнительныеНачисления.Удалить(ИндексСтроки);
		КонецЕсли;
		ИндексСтроки = ИндексСтроки - 1;
	КонецЦикла;
	
	// Удаляем из таблицы договоры на выполнение работ
	ИндексСтроки = ТаблицаДоговорыНаВыполнениеРабот.Количество() - 1;
	Пока ИндексСтроки >=0 Цикл
		Если МассивСотрудников.Найти(ТаблицаДоговорыНаВыполнениеРабот[ИндексСтроки].Сотрудник) <> Неопределено Тогда
			ТаблицаДоговорыНаВыполнениеРабот.Удалить(ИндексСтроки);
		КонецЕсли;
		ИндексСтроки = ИндексСтроки - 1;
	КонецЦикла;
	
	// Удаляем из таблицы Удержания.
	ИндексСтроки = ТаблицаУдержания.Количество() - 1;
	Пока ИндексСтроки >=0 Цикл
		Если МассивФизЛиц.Найти(ТаблицаУдержания[ИндексСтроки].ФизЛицо) <> Неопределено Тогда
			ТаблицаУдержания.Удалить(ИндексСтроки);
		КонецЕсли;
		ИндексСтроки = ИндексСтроки - 1;
	КонецЦикла;
	
	// Удаляем из таблицы НДФЛ
	ИндексСтроки = ТаблицаНДФЛ.Количество() - 1;
	Пока ИндексСтроки >=0 Цикл
		Если МассивФизЛиц.Найти(ТаблицаНДФЛ[ИндексСтроки].ФизЛицо) <> Неопределено Тогда
			ТаблицаНДФЛ.Удалить(ИндексСтроки);
		КонецЕсли;
		ИндексСтроки = ИндексСтроки - 1;
	КонецЦикла;
	
	// Удаляем из таблицы Погашение Займов
	ИндексСтроки = ТаблицаПогашениеЗаймов.Количество() - 1;
	Пока ИндексСтроки >=0 Цикл
		Если МассивФизЛиц.Найти(ТаблицаПогашениеЗаймов[ИндексСтроки].ФизЛицо) <> Неопределено Тогда
			ТаблицаПогашениеЗаймов.Удалить(ИндексСтроки);
		КонецЕсли;
		ИндексСтроки = ИндексСтроки - 1;
	КонецЦикла;
	
	//Очищаем таблицы документа
	Начисления.Очистить();
	ДополнительныеНачисления.Очистить();
	НДФЛ.Очистить();
	Удержания.Очистить();
	ПогашениеЗаймов.Очистить();
	
	// Выполняем автозаполенение и расчет
	ВыполнитьАвтоЗаполнение(ПериодНачисленияДатаНачала,ПериодНачисленияДатаОкончания,,,,МассивСотрудников);
	Записать();
	РассчитатьВсе();
	
	//Добавляем в документ сотрудников из временных таблиц значений
	ДописатьСтрокиИзТаблицыВТаблицу(ТаблицаНачисления, Начисления);
	ДописатьСтрокиИзТаблицыВТаблицу(ТаблицаДополнительныеНачисления, ДополнительныеНачисления);
	ДописатьСтрокиИзТаблицыВТаблицу(ТаблицаНДФЛ, НДФЛ);
	ДописатьСтрокиИзТаблицыВТаблицу(ТаблицаУдержания, Удержания);
	ДописатьСтрокиИзТаблицыВТаблицу(ТаблицаПогашениеЗаймов, ПогашениеЗаймов);
	Если Проведен Тогда
		Записать(РежимЗаписиДокумента.Проведение);
	Иначе
		Записать();
	КонецЕсли;
	
	// удалять записи о перезаполнении из регистра не будем - они были удалены при автозаполнении
	
КонецПроцедуры // ВыполнитьПерезаполнениеПоВыбраннымСотрудникам()

// Процедура рассчитывает ресурсы для начислений
// и заполняет реквизит Результат соотвтествующих табличных частей документа
//
Функция РассчитатьНачисления(ВыборкаПоШапкеДокумента = Неопределено, ВыборкаПоНачислениям = Неопределено, ВыборкаПоДопНачислениям = Неопределено, Физлицо = Неопределено, КомментироватьРасчет = Ложь) Экспорт
	
	Перем ВалютаУпрУчета;
	Перем КурсВалютыУпрУчета;
	
	//Аверсон-софт, Плиско Ю.А. / 13.11.2014 / {Начало: 
	ПараметрыОтбора = Новый Структура;
	ПараметрыОтбора.Вставить("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные); 
	// О.Т. 02.12.2014 
	если не Физлицо = Неопределено Тогда 
		ПараметрыОтбора.Вставить("ФизЛицо",Физлицо);
	КонецЕсли;
	// О.Т. 02.12.2014 
	
	МассивРаботавшихВПраздники = Начисления.НайтиСтроки(ПараметрыОтбора) ;
	ТЗ_Начисления = Начисления.Выгрузить(МассивРаботавшихВПраздники);
	//Аверсон-софт, Плиско Ю.А. / 13.11.2014 / {Начало: 
	если Организация.ИНН = "100765738" Тогда 
		РассчитатьРаботавшихВПраздники(ТЗ_Начисления);
		ВыборкаПоШапкеДокумента = Неопределено;
		Записать();
	КонецЕсли;
	//Аверсон-софт, Плиско Ю.А. / 13.11.2014 / Конец.}
	
	//массивы для хранения индексов строк табличных частей,
	//используются для расчета по одному сотруднику
	Если Физлицо = Неопределено Тогда
		МассивИндексыСтрокНачисления = Неопределено;
		МассивИндексыСтрокДополнительныеНачисления = Неопределено;
	Иначе
		МассивИндексыСтрокНачисления = Новый Массив();
		МассивИндексыСтрокДополнительныеНачисления = Новый Массив();
	КонецЕсли;
	
	Отказ = Ложь;
	
	Если ВыборкаПоШапкеДокумента = Неопределено Тогда
		
		// Перечитаем объект и соберем данные для заполнения наборов записей регистров
		НачатьТранзакцию();
		Прочитать();
		ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
		// позиционируем выборку
		ВыборкаПоШапкеДокумента.Следующий();
		ВыборкаПоНачислениям = СформироватьЗапросПоНачисления(ВыборкаПоШапкеДокумента, Физлицо, Ложь).Выбрать();
		ВыборкаПоДопНачислениям = СформироватьЗапросПоДопНачисления(ВыборкаПоШапкеДокумента, Физлицо).Выбрать();
		ЗафиксироватьТранзакцию();
		
	КонецЕсли;
	
	
	// Создадим рабочие наборы записей
	НаборОсновныеНачисления = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.СоздатьНаборЗаписей();
	НаборОсновныеНачисления.Отбор.Регистратор.Значение = Ссылка;
	
	НаборДопНачисления = РегистрыРасчета.ДополнительныеНачисленияРаботниковОрганизаций.СоздатьНаборЗаписей();
	НаборДопНачисления.Отбор.Регистратор.Значение = Ссылка;
	
	НаборРасчетСреднего = РегистрыРасчета.РасчетСреднегоЗаработка.СоздатьНаборЗаписей();
	НаборРасчетСреднего.Отбор.Регистратор.Значение = Ссылка;
	
	ЗаписиДоходовНДФЛ = РегистрыНакопления.НДФЛСведенияОДоходах.СоздатьНаборЗаписей();
	ЗаписиДоходовНДФЛ.Отбор.Регистратор.Значение = Ссылка;
	
	// Если встретим почасовое отклонение, то записываем движения в регистр РабочееВремяРаботниковОрганизаций
	НаборЗаписейРабочееВремя = РегистрыНакопления.РабочееВремяРаботниковОрганизаций.СоздатьНаборЗаписей();	
	НаборЗаписейРабочееВремя.Отбор.Регистратор.Значение = Ссылка;
	
	
	Пока ВыборкаПоНачислениям.Следующий() Цикл
		ПроверитьЗаполнениеСтрокиНачисления(ВыборкаПоНачислениям, Отказ);
		Если НЕ Отказ Тогда
			// Заполним записи в наборах записей регистров
			ДобавитьСтрокуОсновныхНачислений(ВыборкаПоНачислениям, ВыборкаПоШапкеДокумента, НаборОсновныеНачисления);
			ДобавитьСтрокуРабочегоВремени(ВыборкаПоНачислениям, ВыборкаПоШапкеДокумента, НаборЗаписейРабочееВремя);
			
			Если НЕ (Физлицо = Неопределено)  Тогда
				МассивИндексыСтрокНачисления.Добавить(ВыборкаПоНачислениям.НомерСтроки-1);
			КонецЕсли;
			
		КонецЕсли;
	КонецЦикла;
	
	//мСоответствиеДоходовИВычетов = ПроведениеРасчетов.ПолучитьСоответствиеДоходовИВычетов();
	Пока ВыборкаПоДопНачислениям.Следующий() Цикл
		ПроверитьЗаполнениеСтрокиДопНачисления(ВыборкаПоДопНачислениям, Отказ);
		Если НЕ Отказ Тогда
			// Заполним записи в наборах записей регистров
			ДобавитьСтрокуДопНачислений(ВыборкаПоДопНачислениям, ВыборкаПоШапкеДокумента, НаборДопНачисления);
			
			Если НЕ Физлицо = Неопределено Тогда
				МассивИндексыСтрокДополнительныеНачисления.Добавить(ВыборкаПоДопНачислениям.НомерСтроки-1);
			КонецЕсли;
			
		КонецЕсли;
	КонецЦикла;
	
	Если Отказ Тогда
		
		// Удаляем движения
		Для Каждого Набор Из Движения Цикл
			Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.ОсновныеНачисленияРаботниковОрганизаций") 
				или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.ДополнительныеНачисленияРаботниковОрганизаций") 
				или ТипЗнч(Набор)=Тип("РегистрНакопленияНаборЗаписей.РабочееВремяРаботниковОрганизаций") 
				или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.РасчетСреднегоЗаработка") Тогда
				
				// Удаляем движения
				Набор.Очистить();
				Набор.Записать();
			КонецЕсли;
		КонецЦикла;
		
		Возврат Не Отказ;
	КонецЕсли;
	
	НаборЗаписейРабочееВремя.Записать();
	
	// Получим дополнительные записи, имеющие признак сторно, которые необходимо добавить 
	// в текущий набор для того, чтобы в результате сохранения получился максимальный 
	// фактический период действия
	ТаблицаСторноЗаписей = ПроведениеРасчетов.ПолучитьТаблицуСторноЗаписей(НаборОсновныеНачисления.ПолучитьДополнение());
	ИндексПоследнейСтроки = ВыборкаПоШапкеДокумента.НачисленияКоличествоСтрок;
	Для каждого СтрокаСторно Из ТаблицаСторноЗаписей Цикл
		// Заполним записи в наборе записей регистра
		// и в табличной части
		ДобавитьСтрокуСторно(НаборОсновныеНачисления, Начисления, СтрокаСторно);
		Если Не Физлицо = Неопределено Тогда
			//добавим в массив строк новые строки сторно
			МассивИндексыСтрокНачисления.Добавить(ИндексПоследнейСтроки);
			//индекс начинается с нуля, а номер строки с 1
			ИндексПоследнейСтроки = ИндексПоследнейСтроки +1;
		КонецЕсли;
	КонецЦикла;
	
	// Поддержка способа расчета ДоначислениеПоУправленческомуУчету
	СведенияОДоначислениях = Новый Соответствие;
	// категория начисления в которой встречены виды расчета со способом ДоначислениеПоУправленческомуУчету 
	КатегорияДоначисления = Неопределено;
	ПроведениеРасчетов.ПолучитьКурсВалютыУпрУчета(ПериодРегистрации, ВалютаУпрУчета, КурсВалютыУпрУчета, Константы.ВалютаРегламентированногоУчета.Получить());
	
	// нужен ли расчет Основных начислений при повторном расчете
	НеобходимРасчетОсновных = Истина;
	
	// максимальное число циклов расчета доначислений
	ЧислоЦиклов = 4;
	Для Счетчик = 1 По ЧислоЦиклов Цикл
		
		Если НеобходимРасчетОсновных Тогда
			// рассчитываем записи
			// при этом передаем не только набор записей регистра расчета, но и набор записей регисра 
			// накопления со сведениями об отработанном времени
			ПроведениеРасчетов.РассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", НаборОсновныеНачисления, ЗаписиДоходовНДФЛ, НаборРасчетСреднего, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение, Начисления, Ложь, ?(Счетчик = 1, Ложь, Истина), КатегорияДоначисления, СведенияОДоначислениях, КурсВалютыУпрУчета, МассивИндексыСтрокНачисления, Физлицо, КомментироватьРасчет);
			Если КатегорияДоначисления = Неопределено Тогда
				НеобходимРасчетОсновных = Ложь;
			КонецЕсли;
		КонецЕсли;
		
		// запишем результат расчета для расчета доп. начислений
		НаборОсновныеНачисления.Записать(Истина, Истина);
		
		Если Счетчик > 1 и НеобходимРасчетОсновных Тогда
			// если это повторный расчет и при этом выполняется расчет основных начислений
			// то не ограничиваем расчет доп. начислений определенной категорией
			ПроведениеРасчетов.РассчитатьЗаписиРегистраРасчета("ДополнительныеНачисленияРаботниковОрганизаций", НаборДопНачисления, ЗаписиДоходовНДФЛ, НаборРасчетСреднего, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение, ДополнительныеНачисления, Ложь,?(Счетчик = 1, Ложь, Истина), Неопределено, СведенияОДоначислениях, КурсВалютыУпрУчета, МассивИндексыСтрокДополнительныеНачисления, Физлицо, КомментироватьРасчет);
		Иначе
			ПроведениеРасчетов.РассчитатьЗаписиРегистраРасчета("ДополнительныеНачисленияРаботниковОрганизаций", НаборДопНачисления, ЗаписиДоходовНДФЛ, НаборРасчетСреднего, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение, ДополнительныеНачисления, Ложь,?(Счетчик = 1, Ложь, Истина), КатегорияДоначисления, СведенияОДоначислениях, КурсВалютыУпрУчета, МассивИндексыСтрокДополнительныеНачисления, Физлицо, КомментироватьРасчет);
		КонецЕсли;
		Если КатегорияДоначисления = Неопределено и Не НеобходимРасчетОсновных Тогда
			// не нашлось доначислений
			Прервать;
		КонецЕсли;
		
		ЗаписиДоходовНДФЛ.Очистить();
		ЗаписиДоходовНДФЛ.Записать();
		
		// проверка правильности доначислений
		Физлица = ПроведениеРасчетов.ФизлицаТребующиеПересчета(СведенияОДоначислениях,ПериодРегистрации);//О.Т. Аверсон 14.03.2016 № 949
		Если Физлица.Количество() = 0 Тогда
			Прервать;
		Иначе
			// не "сошлись" данные по некоторым физлицам
			Если Счетчик = ЧислоЦиклов Тогда
				Для Каждого Элемент Из Физлица Цикл
					ОбщегоНазначения.ОшибкаРасчета("" + Элемент + ": Неточно выполнен расчет - не совпадают начисления по управленческому и регламентированному учету!");
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
	КонецЦикла;
	
	//ПроведениеРасчетов.СкорректироватьНормируемыеВычетыПоНДФЛ(ЭтотОбъект);	
	
	Если КомментироватьРасчет Тогда
		// Удаляем движения, но для комментировани ярасчета НДФЛ оставляем движения по начислениям
		Для Каждого Набор Из Движения Цикл
			Если ТипЗнч(Набор)=Тип("РегистрНакопленияНаборЗаписей.РабочееВремяРаботниковОрганизаций") 
				//(начало) добавлено Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
				или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.ДополнительныеНачисленияРаботниковОрганизаций") 
				//(конец) добавлено Кухарчуком Д.Я. 09.08.18, Задача СВФР-002276
				или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.РасчетСреднегоЗаработка") Тогда
				
				// Удаляем движения
				Набор.Очистить();
				Набор.Записать();
			КонецЕсли;
		КонецЦикла;
		
	Иначе
		// Удаляем движения
		Для Каждого Набор Из Движения Цикл
			Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.ОсновныеНачисленияРаботниковОрганизаций") 
				или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.ДополнительныеНачисленияРаботниковОрганизаций") 
				или ТипЗнч(Набор)=Тип("РегистрНакопленияНаборЗаписей.РабочееВремяРаботниковОрганизаций") 
				или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.РасчетСреднегоЗаработка") Тогда
				
				// Удаляем движения
				Набор.Очистить();
				Набор.Записать();
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
	////Аверсон-софт, Плиско Ю.А. / 13.11.2014 / {Начало: 
	//если Организация.ИНН = "100765738" Тогда 
	//	РассчитатьРаботавшихВПраздники(ТЗ_Начисления);
	//КонецЕсли;
	////Аверсон-софт, Плиско Ю.А. / 13.11.2014 / Конец.}	
	
	Возврат Не Отказ;
	
КонецФункции // РассчитатьНачисления()

// Процедура рассчитывает НДФЛ
// и заполняет реквизиты табличной части
//
Процедура РассчитатьНДФЛ(Физлицо = Неопределено, КомментироватьРасчет = Ложь) Экспорт
	
	// Получим реквизиты шапки из запроса
	ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
	// позиционируем выборку
	ВыборкаПоШапкеДокумента.Следующий();
	
	Отказ = Ложь;
	ВыборкаПоНачислениям = СформироватьЗапросПоНачисления(ВыборкаПоШапкеДокумента, Физлицо, Ложь).Выбрать();
	Пока ВыборкаПоНачислениям.Следующий() Цикл
		ПроверитьЗаполнениеСтрокиНачисления(ВыборкаПоНачислениям, Отказ);
	КонецЦикла;
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	// сформируем и запишем доходы НДФЛ по начислениям документа
	НаборНДФЛСведенияОДоходах = РегистрыНакопления.НДФЛСведенияОДоходах.СоздатьНаборЗаписей();
	НаборНДФЛСведенияОДоходах.Отбор.Регистратор.Значение = Ссылка;
	НаборНДФЛСведенияОДоходах.Очистить();
	
	СформироватьДоходыПоКодамНДФЛ(ВыборкаПоШапкеДокумента, НаборНДФЛСведенияОДоходах); // по начислениям
	СформироватьДоходыПоМатвыгодеПоЗаймам(ВыборкаПоШапкеДокумента, НаборНДФЛСведенияОДоходах); // матвыгода по заемным средствам
	
	// запишем доходы НДФЛ по начислениям документа
	НаборНДФЛСведенияОДоходах.Записать();
	
	_парамФизлицо_ = Неопределено; //СВЭЙ 10.04.2024 КВВ СВФР-012811
	
	// Составим текст запроса для выбора списка физлиц, по которым надо считать НДФЛ
	Если НЕ (Физлицо = Неопределено) Тогда
		СписокФизлицТекст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &парамРегистратор и Работники.Физлицо = &парамФизлицо";
		
		ДополнительныеПараметрыЗапросаНДФЛ  = Новый Структура;
		ДополнительныеПараметрыЗапросаНДФЛ.Вставить("парамФизлицо", Физлицо);
		
		_парамФизлицо_ = Физлицо; //СВЭЙ 10.04.2024 КВВ СВФР-012811
	Иначе
		СписокФизлицТекст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &парамРегистратор";
		
		ДополнительныеПараметрыЗапросаНДФЛ  = Неопределено;
	КонецЕсли;
	
	// получение результата НДФЛ по ставке 13 процентов
	// для него передается Организация, период и ссылка на регистратор
	ВыборкаПодразделений = "";
	ДанныеНДФЛ = ПроведениеРасчетов.ПолучитьДанныеНДФЛПоРегистратору(Неопределено, Неопределено, ПериодРегистрации, Организация, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, Ссылка, СписокФизлицТекст, ДополнительныеПараметрыЗапросаНДФЛ, , КомментироватьРасчет, ВыборкаПодразделений,,,,_парамФизлицо_ ); //СВЭЙ 10.04.2024 КВВ СВФР-012811 (_парамФизлицо_)
	Если ДанныеНДФЛ <> Неопределено Тогда
		Если НЕ (Физлицо = Неопределено) Тогда
			// считаем одно физлицо
			ФизлицаСписок = Новый СписокЗначений;
			ФизлицаСписок.Добавить(Физлицо);
		Иначе
			// считаем всех
			ФизлицаСписок = НеОпределено;
		КонецЕсли;
		ЗаполнитьНаборЗаписейПоДаннымНДФЛ(, ДанныеНДФЛ, ВыборкаПоШапкеДокумента, ,ФизлицаСписок, КомментироватьРасчет, ВыборкаПодразделений);
	КонецЕсли;
	//толик НДФЛ
	
	ЗапросДата = Новый запрос;
	ЗапросДата.Текст = 
	"ВЫБРАТЬ
	| РазмерыПараметровДляРасчетаРБСрезПоследних.Период,
	| РазмерыПараметровДляРасчетаРБСрезПоследних.ВидПараметра,
	| РазмерыПараметровДляРасчетаРБСрезПоследних.Размер
	|ИЗ
	| РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних(&ПериодРегистрации) КАК РазмерыПараметровДляРасчетаРБСрезПоследних
	|ГДЕ
	| РазмерыПараметровДляРасчетаРБСрезПоследних.ВидПараметра = &ВидПараметра";
	ЗапросДата.УстановитьПараметр("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.ДатаНачалаПодоходного);
	ЗапросДата.УстановитьПараметр("ПериодРегистрации",КонецМесяца(ПериодРегистрации));
	Результат = ЗапросДата.Выполнить().Выбрать();
	ДатаПодоходного = НачалоГода(ПериодРегистрации);
	Пока Результат.Следующий() цикл
		
		ДатаПодоходного = Результат.Период;
		
	КонецЦикла;
	
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("Беларусь", Справочники.КлассификаторСтранМира.БЕЛАРУСЬ);
	Запрос.УстановитьПараметр("парамРегистратор", Ссылка);
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", Организация);
	Запрос.УстановитьПараметр("парамСтавка9", Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка9);
	Запрос.УстановитьПараметр("парамСтавка09", Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка09);
	Запрос.УстановитьПараметр("парамСтавка35", Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка35);
	Запрос.УстановитьПараметр("парамСтавка40", Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка40);
	Запрос.УстановитьПараметр("парамСтавкаРезидента9", ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛотСтавкиНалогообложенияРезидента(Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка9));
	Запрос.УстановитьПараметр("парамСтавкаРезидента09", ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛотСтавкиНалогообложенияРезидента(Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка09));
	Запрос.УстановитьПараметр("парамСтавкаРезидента35", ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛотСтавкиНалогообложенияРезидента(Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка35));
	Запрос.УстановитьПараметр("парамСтавкаРезидента40", ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛотСтавкиНалогообложенияРезидента(Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка40));
	
	Запрос.УстановитьПараметр("парамПериодРегистрации", ПериодРегистрации);
	Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ПериодРегистрации));
	Если ДатаПодоходного >  НачалоГода(ПериодРегистрации) Тогда
		Запрос.УстановитьПараметр("парамНачалоГода", ДатаПодоходного);
	иначе
		Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодРегистрации));
	КонецЕсли;
	Запрос.УстановитьПараметр("парамКонецГода", КонецГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамВидСтрокиНачисление", Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление);
	Запрос.УстановитьПараметр("парамВидДвиженияПриход", ВидДвиженияНакопления.Приход);
	Запрос.УстановитьПараметр("парамПустаяДата" , '00010101');
	Запрос.УстановитьПараметр("парамСсылка" , Ссылка);
	Запрос.УстановитьПараметр("парамПустойКодДохода" , Справочники.ДоходыНДФЛ.ПустаяСсылка());
	
	// установим дополнительные параметры
	Если ДополнительныеПараметрыЗапросаНДФЛ <> Неопределено Тогда
		Для каждого Поле Из ДополнительныеПараметрыЗапросаНДФЛ Цикл
			Запрос.УстановитьПараметр(Поле.Ключ, Поле.Значение);
		КонецЦикла;
	КонецЕсли;
	
	Запрос.Текст = СписокФизлицТекст;
	// Ранее расчитанные налоги
	РанееНачисленныеНалогиТекст = 
	"ВЫБРАТЬ
	|	РасчетыСБюджетом.ФизЛицо,
	|	Сумма(ВЫБОР КОГДА РасчетыСБюджетом.СтавкаНалогообложенияРезидента = &парамСтавка9 ТОГДА РасчетыСБюджетом.Налог ИНАЧЕ 0 КОНЕЦ) КАК НалогПоСтавке9,
	|	Сумма(ВЫБОР КОГДА РасчетыСБюджетом.СтавкаНалогообложенияРезидента = &парамСтавка09 ТОГДА РасчетыСБюджетом.Налог ИНАЧЕ 0 КОНЕЦ) КАК НалогПоСтавке09,
	|	Сумма(ВЫБОР КОГДА РасчетыСБюджетом.СтавкаНалогообложенияРезидента = &парамСтавка35 ТОГДА РасчетыСБюджетом.Налог ИНАЧЕ 0 КОНЕЦ) КАК НалогПоСтавке35,
	|	Сумма(ВЫБОР КОГДА РасчетыСБюджетом.СтавкаНалогообложенияРезидента = &парамСтавка40 ТОГДА РасчетыСБюджетом.Налог ИНАЧЕ 0 КОНЕЦ) КАК НалогПоСтавке40
	|ИЗ
	|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК РасчетыСБюджетом
	|
	|ГДЕ
	|	РасчетыСБюджетом.Организация = &парамГоловнаяОрганизация И
	|	РасчетыСБюджетом.Период <= &парамКонецМесяцаНалоговогоПериода И //парамПериодРегистрации И
	|	(РасчетыСБюджетом.МесяцНалоговогоПериода МЕЖДУ &парамНачалоГода И &парамКонецМесяцаНалоговогоПериода ИЛИ РасчетыСБюджетом.МесяцНалоговогоПериода = &парамКонецМесяцаНалоговогоПериода) И
	|	РасчетыСБюджетом.Регистратор <> &парамРегистратор И
	|	РасчетыСБюджетом.ВидДвижения = &парамВидДвиженияПриход И
	|	РасчетыСБюджетом.ФизЛицо В(" + СписокФизЛицТекст + ") И
	|	РасчетыСБюджетом.ВидСтроки = &парамВидСтрокиНачисление
	|
	|СГРУППИРОВАТЬ ПО
	|	РасчетыСБюджетом.ФизЛицо";
	
	// Составим текст запроса для выбора списка физлиц, по которым надо считать НДФЛ (исключим нерезидентов)
	СписокФизлицРезидентовТекст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ТЧРаботникиОрганизации.ФизЛицо
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК ТЧРаботникиОрганизации
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&парамКонецГода) КАК НеРезиденты
	|		ПО НеРезиденты.ФизЛицо = ТЧРаботникиОрганизации.ФизЛицо
	|
	|ГДЕ
	|	ТЧРаботникиОрганизации.Ссылка = &парамРегистратор И
	|	(((НеРезиденты.ФизЛицо) ЕСТЬ NULL ) ИЛИ ((НеРезиденты.Страна)=&Беларусь))
	|	И ТЧРаботникиОрганизации.ФизЛицо В(" + СписокФизЛицТекст + ")";
	
	Запрос.Текст = СписокФизлицРезидентовТекст;
	// НачислениеНалоговТекст
	НачислениеНалоговТекст = 
	"ВЫБРАТЬ
	|	НДФЛОбороты.ФизЛицо КАК ФизЛицо,
	|	Сумма(ВЫБОР КОГДА КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка9 ТОГДА (НДФЛОбороты.СуммаДоходаОборот-НДФЛОбороты.СуммаВычетаОборот)*&парамСтавкаРезидента9/100 ИНАЧЕ 0 КОНЕЦ) КАК НалогПоСтавке9,
	|	Сумма(ВЫБОР КОГДА КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка09 ТОГДА (НДФЛОбороты.СуммаДоходаОборот-НДФЛОбороты.СуммаВычетаОборот)*&парамСтавкаРезидента09/100 ИНАЧЕ 0 КОНЕЦ) КАК НалогПоСтавке09,
	|	Сумма(ВЫБОР КОГДА КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка35 ТОГДА (НДФЛОбороты.СуммаДоходаОборот-НДФЛОбороты.СуммаВычетаОборот)*&парамСтавкаРезидента35/100 ИНАЧЕ 0 КОНЕЦ) КАК НалогПоСтавке35,
	|	Сумма(ВЫБОР КОГДА КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка40 ТОГДА (НДФЛОбороты.СуммаДоходаОборот-НДФЛОбороты.СуммаВычетаОборот)*&парамСтавкаРезидента40/100 ИНАЧЕ 0 КОНЕЦ) КАК НалогПоСтавке40
	|ИЗ
	|	РегистрНакопления.НДФЛСведенияОДоходах.Обороты(&парамНачалоГода, &парамКонецМесяцаНалоговогоПериода, Месяц, ПериодРегистрации <= &парамПериодРегистрации И Организация = &парамГоловнаяОрганизация И ВЫБОР КОГДА Физлицо В (" + СписокФизлицРезидентовТекст + ") ТОГДА ИСТИНА ИНАЧЕ ЛОЖЬ КОНЕЦ) КАК НДФЛОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	НДФЛОбороты.ФизЛицо
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	НалогиПоСтавкам.Физлицо,
	|	Сумма(НалогиПоСтавкам.Налог9) КАК НалогПоСтавке9,
	|	Сумма(НалогиПоСтавкам.Налог09) КАК НалогПоСтавке09,
	|	Сумма(НалогиПоСтавкам.Налог35) КАК НалогПоСтавке35,
	|	Сумма(НалогиПоСтавкам.Налог40) КАК НалогПоСтавке40
	|ИЗ
	|(ВЫБРАТЬ
	|	Доходы.Физлицо,
	|	ВЫБОР КОГДА Доходы.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка9 ТОГДА СУММА(Доходы.СуммаДохода)*&парамСтавкаРезидента9/100 ИНАЧЕ 0 КОНЕЦ КАК Налог9,
	|	ВЫБОР КОГДА Доходы.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка09 ТОГДА СУММА(Доходы.СуммаДохода)*&парамСтавкаРезидента09/100 ИНАЧЕ 0 КОНЕЦ КАК Налог09,
	|	ВЫБОР КОГДА Доходы.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка35 ТОГДА СУММА(Доходы.СуммаДохода)*&парамСтавкаРезидента35/100 ИНАЧЕ 0 КОНЕЦ КАК Налог35,
	|	ВЫБОР КОГДА Доходы.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка40 ТОГДА СУММА(Доходы.СуммаДохода)*&парамСтавкаРезидента40/100 ИНАЧЕ 0 КОНЕЦ КАК Налог40
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основные.Физлицо КАК Физлицо,
	|		Основные.ВидРасчета.КодДоходаНДФЛ КАК КодДохода,
	|		Основные.ДатаНачала КАК Период,
	|		Основные.Результат КАК СуммаДохода
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Основные
	|	
	|	ГДЕ
	|		Основные.Ссылка = &парамСсылка И
	|		Основные.ВидРасчета.КодДоходаНДФЛ <> &парамПустойКодДохода И
	|		(Основные.Результат <> 0)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Дополнительные.Физлицо,
	|		Дополнительные.ВидРасчета.КодДоходаНДФЛ,
	|		ВЫБОР КОГДА Дополнительные.ДатаНачала = &парамПустаяДата ТОГДА Дополнительные.Ссылка.ПериодРегистрации ИНАЧЕ Дополнительные.ДатаНачала КОНЕЦ,
	|		Дополнительные.Результат
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Дополнительные
	|	
	|	ГДЕ
	|		Дополнительные.Ссылка = &парамСсылка И
	|		Дополнительные.ВидРасчета.КодДоходаНДФЛ <> &парамПустойКодДохода И
	|		(Дополнительные.Результат <> 0)) КАК Доходы
	|
	|СГРУППИРОВАТЬ ПО
	|	Доходы.Физлицо,
	|	Доходы.КодДохода,
	|	Доходы.Период) КАК НалогиПоСтавкам
	|
	|СГРУППИРОВАТЬ ПО
	|	НалогиПоСтавкам.ФизЛицо";
	
	НачислениеНалоговТекст1 = 
	"ВЫБРАТЬ
	|	НДФЛОбороты.ФизЛицо КАК ФизЛицо,
	|	Сумма(ВЫБОР КОГДА КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка9 ТОГДА Выразить((НДФЛОбороты.СуммаДоходаОборот-НДФЛОбороты.СуммаВычетаОборот)*&парамСтавкаРезидента9/100 как число (15,2)) ИНАЧЕ 0 КОНЕЦ )  КАК НалогПоСтавке9,
	|	Сумма(ВЫБОР КОГДА КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка09 ТОГДА Выразить((НДФЛОбороты.СуммаДоходаОборот-НДФЛОбороты.СуммаВычетаОборот)*&парамСтавкаРезидента09/100 как число (15,2)) ИНАЧЕ 0 КОНЕЦ )  КАК НалогПоСтавке09,
	|	Сумма(ВЫБОР КОГДА КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка35 ТОГДА Выразить((НДФЛОбороты.СуммаДоходаОборот-НДФЛОбороты.СуммаВычетаОборот)*&парамСтавкаРезидента35/100 как число (15,2)) ИНАЧЕ 0 КОНЕЦ ) КАК НалогПоСтавке35, //О.Т. Аверсон 11.12.2017 № 1340 округление
	|	Сумма(ВЫБОР КОГДА КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка40 ТОГДА Выразить((НДФЛОбороты.СуммаДоходаОборот-НДФЛОбороты.СуммаВычетаОборот)*&парамСтавкаРезидента40/100 как число (15,2)) ИНАЧЕ 0 КОНЕЦ )  КАК НалогПоСтавке40
	|ИЗ
	|	РегистрНакопления.НДФЛСведенияОДоходах.Обороты(&парамНачалоГода, &парамКонецМесяцаНалоговогоПериода, Месяц, ПериодРегистрации <= &парамПериодРегистрации И Организация = &парамГоловнаяОрганизация И ВЫБОР КОГДА Физлицо В (" + СписокФизлицРезидентовТекст + ") ТОГДА ИСТИНА ИНАЧЕ ЛОЖЬ КОНЕЦ) КАК НДФЛОбороты
	|ГДЕ
	|	НДФЛОбороты.ФизЛицо В(" + СписокФизЛицТекст + ")
	|СГРУППИРОВАТЬ ПО
	|	НДФЛОбороты.ФизЛицо";
	
	Запрос.Текст = НачислениеНалоговТекст1;
	
	//Запрос.Текст = НачислениеНалоговТекст;
	// Объединение запросов
	НалогиТекст = 
	"ВЫБРАТЬ
	|	ВЫБОР КОГДА НЕ НачисленныеНалоги.ФизЛицо ЕСТЬ NULL ТОГДА НачисленныеНалоги.ФизЛицо ИНАЧЕ РанееНачислено.ФизЛицо КОНЕЦ КАК ФизЛицо,
	|	ВЫБОР КОГДА НЕ НачисленныеНалоги.ФизЛицо ЕСТЬ NULL ТОГДА НачисленныеНалоги.НалогПоСтавке9 ИНАЧЕ 0 КОНЕЦ - ВЫБОР КОГДА НЕ РанееНачислено.ФизЛицо ЕСТЬ NULL ТОГДА РанееНачислено.НалогПоСтавке9 ИНАЧЕ 0 КОНЕЦ КАК НалогПоСтавке9,
	|	ВЫБОР КОГДА НЕ НачисленныеНалоги.ФизЛицо ЕСТЬ NULL ТОГДА НачисленныеНалоги.НалогПоСтавке09 ИНАЧЕ 0 КОНЕЦ - ВЫБОР КОГДА НЕ РанееНачислено.ФизЛицо ЕСТЬ NULL ТОГДА РанееНачислено.НалогПоСтавке09 ИНАЧЕ 0 КОНЕЦ КАК НалогПоСтавке09,
	|	ВЫБОР КОГДА НЕ НачисленныеНалоги.ФизЛицо ЕСТЬ NULL ТОГДА НачисленныеНалоги.НалогПоСтавке35 ИНАЧЕ 0 КОНЕЦ - ВЫБОР КОГДА НЕ РанееНачислено.ФизЛицо ЕСТЬ NULL ТОГДА РанееНачислено.НалогПоСтавке35 ИНАЧЕ 0 КОНЕЦ КАК НалогПоСтавке35,
	|	ВЫБОР КОГДА НЕ НачисленныеНалоги.ФизЛицо ЕСТЬ NULL ТОГДА НачисленныеНалоги.НалогПоСтавке40 ИНАЧЕ 0 КОНЕЦ - ВЫБОР КОГДА НЕ РанееНачислено.ФизЛицо ЕСТЬ NULL ТОГДА РанееНачислено.НалогПоСтавке40 ИНАЧЕ 0 КОНЕЦ КАК НалогПоСтавке40
	| ИЗ (" + НачислениеНалоговТекст1 + ") КАК НачисленныеНалоги
	|   ПОЛНОЕ СОЕДИНЕНИЕ (" +РанееНачисленныеНалогиТекст + ") КАК РанееНачислено
	|	ПО РанееНачислено.ФизЛицо = НачисленныеНалоги.ФизЛицо
	|";
	
	
	Запрос.Текст = РанееНачисленныеНалогиТекст;
	Запрос.Текст = НалогиТекст;
	ДанныеНДФЛТвердые = Запрос.Выполнить().Выбрать();
	
	
	СтруктураПоиска = Новый Структура("ФизЛицо");
	
	Пока ДанныеНДФЛТвердые.Следующий() Цикл
		СтруктураПоиска.Физлицо = ДанныеНДФЛТвердые.ФизЛицо;
		Строки = НДФЛ.НайтиСтроки(СтруктураПоиска);
		Если Строки.Количество() > 0 Тогда
			Строка = Строки[0];
		Иначе
			Строка = НДФЛ.Добавить();
			Строка.ФизЛицо 						= ДанныеНДФЛ.ФизЛицо;
			Строка.МесяцНалоговогоПериода 		= ПериодРегистрации;
		КонецЕсли;
		
		Если  ДанныеНДФЛТвердые.НалогПоСтавке9<>0 тогда
			Строка.НалогПоСтавке9 = Строка.НалогПоСтавке9 + ДанныеНДФЛТвердые.НалогПоСтавке9;
		КонецЕсли;
		
		Если  ДанныеНДФЛТвердые.НалогПоСтавке09<>0 тогда
			Строка.НалогПоСтавке09 = Строка.НалогПоСтавке09 + ДанныеНДФЛТвердые.НалогПоСтавке09;
		КонецЕсли;
		
		Если  ДанныеНДФЛТвердые.НалогПоСтавке35<>0 тогда
			Строка.НалогПоСтавке35 = Строка.НалогПоСтавке35 + ДанныеНДФЛТвердые.НалогПоСтавке35;
		КонецЕсли;
		
		Если  ДанныеНДФЛТвердые.НалогПоСтавке40<>0 тогда
			Строка.НалогПоСтавке40 = Строка.НалогПоСтавке40 + ДанныеНДФЛТвердые.НалогПоСтавке40;
		КонецЕсли;
		
	КонецЦикла;
	
	// Удаляем движения
	НаборНДФЛСведенияОДоходах.Очистить();
	НаборНДФЛСведенияОДоходах.Записать();
	Если ЗначениеЗаполнено(ДокВычет) Тогда
		ДокСтандВычеты=ДокВычет.Ссылка.ПолучитьОбъект();
		ДокСтандВычеты.Записать(РежимЗаписиДокумента.Запись);	
	КонецЕсли;
КонецПроцедуры  // РассчитатьНДФЛ



// Процедура рассчитывает Пенсионный фонд
// и заполняет реквизиты табличной части
//
Процедура РассчитатьПенсионныйФонд(Физлицо = Неопределено, КомментироватьРасчет = Ложь) Экспорт
	
	// Получим реквизиты шапки из запроса
	ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
	// позиционируем выборку
	ВыборкаПоШапкеДокумента.Следующий();
	
	
	Отказ = Ложь;
	ВыборкаПоНачислениям = СформироватьЗапросПоНачисления(ВыборкаПоШапкеДокумента, Физлицо, Ложь).Выбрать();
	Пока ВыборкаПоНачислениям.Следующий() Цикл
		ПроверитьЗаполнениеСтрокиНачисления(ВыборкаПоНачислениям, Отказ);
	КонецЦикла;
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	Если НЕ (ФизЛицо = Неопределено) тогда
		
		//Аверсон ЕАЕ 10.03.2025 СВФР-015145
		ТЗПенсионный = ПенсионныйФонд.Выгрузить();
		//Аверсон СВФР-015145
		
		СтруктураПоиска	= Новый Структура;
		СтруктураПоиска.Вставить("ФизЛицо",ФизЛицо);
		МассивСтрок = ПенсионныйФонд.НайтиСтроки(СтруктураПоиска);
		Для Каждого Строка из МассивСтрок Цикл
			ПенсионныйФонд.Удалить(Строка);
		КонецЦикла;
		
		//Аверсон 04.07.2022 КВВ СВФР-009250 (
		Если ДополнительнаяПенсия.Количество() <> 0 Тогда
			МассивСтрок = ДополнительнаяПенсия.НайтиСтроки(СтруктураПоиска);
			Для Каждого Строка из МассивСтрок Цикл
				ДополнительнаяПенсия.Удалить(Строка);
			КонецЦикла;
		КонецЕсли;
		//Аверсон 04.07.2022 КВВ СВФР-009250 )
		
	Иначе
		
		//Аверсон ЕАЕ 22.11.2021 СВФР-008398
		ТЗПенсионный = ПенсионныйФонд.Выгрузить();
		//Аверсон СВФР-008398
		
		ПенсионныйФонд.Очистить();	
		ДополнительнаяПенсия.Очистить(); //Аверсон 01.07.2022 КВВ СВФР-009250
	КонецЕсли;
	
	//ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,ДобавитьМесяц(ПериодРегистрации,-1),ПериодРегистрации);//Аверсон 08.07.2019 КВВ СВФР-004490
	ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,НачалоМесяца(ПериодНачисленияДатаНачала),ПериодРегистрации); //Аверсон 15.11.2019 КВВ СВФР-005009
	
	// сформируем и запишем доходы НДФЛ по начислениям документа
	НаборЕСНСведенияОДоходах = РегистрыНакопления.ЕСНСведенияОДоходах.СоздатьНаборЗаписей();
	НаборЕСНСведенияОДоходах.Отбор.Регистратор.Значение = Ссылка;
	НаборЕСНСведенияОДоходах.Очистить();
	
	СформироватьДоходыПоПенсионномуФонду(ВыборкаПоШапкеДокумента, НаборЕСНСведенияОДоходах,ФизЛицо);
	
	НаборЕСНСведенияОДоходах.Записать();
	
	ДанныеДляРасчетаЕСН = ПолучитьДанныеРасчетаЕСН(Организация,Физлицо);//О.Т. 09.10.2014 № 200
	
	//Аверсон 14.05.2020 КВВ СВФР-005913 (  
	//Аверсон 29.09.2020 КВВ СВФР-006555 (
	//ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,ДобавитьМесяц(ПериодРегистрации,-1),ПериодРегистрации);
	ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,НачалоМесяца(ПериодНачисленияДатаНачала),ПериодРегистрации);
	//Аверсон 29.09.2020 КВВ СВФР-006555 )
	ПенсФондБудМес = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодР,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца)).Размер;
	//Аверсон 14.05.2020 КВВ СВФР-005913 )
	
	// заполняем движения по регистру исчисленного ЕСН-ПФР
	Пока ДанныеДляРасчетаЕСН.Следующий() Цикл
		ОбработкаПрерыванияПользователя();
		// Пропустим нулевые строки
		Если ДанныеДляРасчетаЕСН.БазаДоходФСЗН = 0  Тогда			
			//Продолжить; //Аверсон 24.06.2020 КВВ СВФР-006194 (закомментировано)
		КонецЕсли; 
		ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,НачалоМесяца(ПериодНачисленияДатаНачала),ПериодРегистрации);
		//Аверсон 14.05.2020 КВВ СВФР-005913 (
		Если ПенсФондБудМес = 1 Тогда
			Если НачалоМесяца(ДанныеДляРасчетаЕСН.Месяц) > НачалоМесяца(ПериодР) Тогда			
				Продолжить;
			КонецЕсли; 
		КонецЕсли;
		//Аверсон 14.05.2020 КВВ СВФР-005913 )
		
		//Аверсон-софт, Островская Татьяна 20.08.2012 № 15686
		//О.Т. Аверсон 25.03.2016 № 950
		МассивОсновные = Начисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеДляРасчетаЕСН.ФизЛицо));        
		Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
		Для Каждого стрОстновные из МассивОсновные Цикл 
			Сотрудник = стрОстновные.Сотрудник;
		КонецЦикла;
		Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
			МассивДополнительные = ДополнительныеНачисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеДляРасчетаЕСН.ФизЛицо));        
			Для Каждого стрДополнительные из МассивДополнительные Цикл 
				Сотрудник = стрДополнительные.Сотрудник;
			КонецЦикла;  			
		КонецЕсли;
		//О.Т. Аверсон 28.06.2017 № 772
		Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
			МассивДоговора = ДоговорыНаВыполнениеРабот.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеДляРасчетаЕСН.ФизЛицо));        
			Для Каждого стрДоговора из МассивДоговора Цикл 
				Сотрудник = стрДоговора.Сотрудник;
			КонецЦикла;  			
		КонецЕсли;
		//О.Т. Аверсон 28.06.2017 № 772
		
		//+ СВЭЙ КДЯ 25.11.19 СВФР-005103
		Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
			МассивУдержания = Удержания.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеДляРасчетаЕСН.ФизЛицо));        
			Для Каждого стрУдержания из МассивУдержания Цикл 
				Сотрудник = стрУдержания.Сотрудник;
			КонецЦикла;  			
		КонецЕсли;
		//- СВЭЙ КДЯ 25.11.19 СВФР-005103
		
		//Аверсон ЕАЕ 22.11.2021 СВФР-008398
		Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
			МассивПенсионный = ТЗПенсионный.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеДляРасчетаЕСН.ФизЛицо));        
			Для Каждого стрПенсионный из МассивПенсионный Цикл 
				Сотрудник = стрПенсионный.Сотрудник;
			КонецЦикла;  			
		КонецЕсли;
		//Аверсон СВФР-008398
		
		Если ДанныеДляРасчетаЕСН.Месяц < ПериодР   Тогда 
			ЗапросУвольнение = Новый Запрос;
			ЗапросУвольнение.Текст = 
			"ВЫБРАТЬ
			|	РаботникиОрганизацийСрезПоследних.Период
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних
			|ГДЕ
			|	РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций";
			
			ЗапросУвольнение.УстановитьПараметр("Период", КонецМесяца(ДанныеДляРасчетаЕСН.Месяц));
			ЗапросУвольнение.УстановитьПараметр("Сотрудник", Сотрудник);
			РезультатУвольнение = ЗапросУвольнение.Выполнить().Выбрать();
			Уволен = Ложь;
			Пока РезультатУвольнение.Следующий() Цикл
				Если РезультатУвольнение.Период >= НачалоМесяца(ДанныеДляРасчетаЕСН.Месяц) и РезультатУвольнение.Период <= КонецМесяца(ДанныеДляРасчетаЕСН.Месяц) Тогда 
				иначе
					Уволен = Истина;
				КонецЕсли;
			КонецЦикла;
			Если  Уволен Тогда
				//Если уволен прошлым месяцем, а в текущем делаем расчет, ставка пенсионного иная неверная
				Сообщить("Изменен период опрееделения ставки пенс.ф." + ПериодР+ " на " +ДанныеДляРасчетаЕСН.Месяц+ " по " + ДанныеДляРасчетаЕСН.ФизЛицо);
				ПериодР = ДанныеДляРасчетаЕСН.Месяц;  
			КонецЕсли;
		КонецЕсли;
		
		ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
		Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
		иначе
			ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
		КонецЕсли;
		
		ЗапросИндСтавкаНалогообл = Новый Запрос;
		ЗапросИндСтавкаНалогообл.Текст = 
		"ВЫБРАТЬ
		|	ИноеНалогообложениеПоСотрудникамСрезПоследних.ФСЗН,
		|	ИноеНалогообложениеПоСотрудникамСрезПоследних.ПенсионныйФонд
		|ИЗ
		|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
		|			&Период,
		|			Организация = &Организация
		|				И ВидНалогообложения = &ВидНалогообложения
		//+ СВЭЙ КДЯ 25.11.19 СВФР-005103
		//|				И Сотрудник = &Сотрудник
		//- СВЭЙ КДЯ 25.11.19 СВФР-005103
		//+ СВЭЙ КДЯ 25.11.19 СВФР-005103
		|				И ( 
		|					&СотрудникЗаполнен И Сотрудник = &Сотрудник
		|                   ИЛИ НЕ &СотрудникЗаполнен И ФизЛицо = &ФизЛицо
		|				  ) 
		//- СВЭЙ КДЯ 25.11.19 СВФР-005103
		|	) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
		
		ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
		
		//Аверсон ЕАЕ 02.12.2025 СВФР-017394
		//ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", КонецМесяца(ПериодР));
		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Период", КонецМесяца(ДанныеДляРасчетаЕСН.Месяц));
		//Аверсон СВФР-017394
		
		ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Сотрудник); 
		//+ СВЭЙ КДЯ 25.11.19 СВФР-005103
		ЗапросИндСтавкаНалогообл.УстановитьПараметр( "СотрудникЗаполнен", ЗначениеЗаполнено( Сотрудник ) );
		ЗапросИндСтавкаНалогообл.УстановитьПараметр( "ФизЛицо", ДанныеДляРасчетаЕСН.ФизЛицо );
		//- СВЭЙ КДЯ 25.11.19 СВФР-005103
		РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
		ЕстьИндивидСтавка = Ложь;
		СтавкаФСЗНИнд = 0;
		СтавкаПенсионныйИнд = 0;
		Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
			ЕстьИндивидСтавка = Истина;
			СтавкаФСЗНИнд = РезИндСтавкаНалогообл[0].ФСЗН;
			СтавкаПенсионныйИнд = РезИндСтавкаНалогообл[0].ПенсионныйФонд;
		КонецЕсли;
		
		СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодР),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));
		СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодР),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ВидНалогообложения));
		СтруктураФСЗНИнвалиды = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ПериодР),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды,ВидНалогообложения));
		
		Если СтруктураПенс.Количество()<>0 тогда
			СтавкаПенсионныйФонд = СтруктураПенс.Размер;
		Иначе
			Сообщить("Не заполнена ставка пенсионного фонда");
			СтавкаПенсионныйФонд = 0;
		КонецЕсли;
		
		Если СтруктураФСЗН.Количество()<>0 тогда
			СтавкаФСЗН = СтруктураФСЗН.Размер;
		Иначе
			Сообщить("Не заполнена ставка отчислений в ФСЗН");
			СтавкаФСЗН = 0;
		КонецЕсли;
		
		Если СтруктураФСЗНИнвалиды.Количество()<>0 тогда
			СтавкаФСЗНИнвалиды = СтруктураФСЗНИнвалиды.Размер;
		Иначе
			Сообщить("Не заполнена ставка отчислений в ФСЗН по инвалидам");
			СтавкаФСЗНИнвалиды = 0;
		КонецЕсли;
		
		//О.Т. Аверсон 25.03.2016 № 950		
		
		ПенсФондБудМес = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца)).размер;
		//если ПенсФондБудМес = 1 тогда //Островская Татьяна 28.04.2014 № 17321  
		ЗапросОтп = Новый Запрос;
		ЗапросОтп.Текст = 
		"ВЫБРАТЬ
		|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор КАК Регистратор,
		|	ОсновныеНачисленияРаботниковОрганизаций.Результат КАК Результат,
		|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ПериодДействияНачало,
		|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации КАК ПериодРегистрации
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		|ГДЕ
		//|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеОтпускаРаботникамОрганизаций //Аверсон 15.06.2022 КВВ СВФР-009187 (пункт 2) (закомментировано)
		|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &ПериодДействияНачало И &ПериодДействияНачало1
		//|	И МЕСЯЦ(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации) <> МЕСЯЦ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало) //Аверсон 15.06.2022 КВВ СВФР-009187 (пункт 2) (закомментировано)
		|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации < &ПериодРегистрации   //Аверсон 03.08.2020 КВВ СВФР-006354 ( было <> &ПериодРегистрации )
		|	И ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = &ФизЛицоСтр
		|	И ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация
		
		//Аверсон 15.06.2022 КВВ СВФР-009187 (пункт 2) (
		|	И ( ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияорганизаций.ОплатаПоСреднемуОтпКалендарныеДни)
		|	ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням))
		
		//Аверсон 15.06.2022 КВВ СВФР-009187 (пункт 2) )
		|";
		
		//Аверсон 14.12.2022 КВВ СВФР-010031 (
		ЗапросОтп.Текст = ЗапросОтп.Текст + "
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор,
		|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
		|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
		|	ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации
		|ИЗ
		|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|ГДЕ
		|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало МЕЖДУ &ПериодДействияНачало И &ПериодДействияНачало1
		|	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < &ПериодРегистрации   
		|	И ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = &ФизЛицоСтр
		|	И ДополнительныеНачисленияРаботниковОрганизаций.Организация = &Организация
		|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)";
		//Аверсон 14.12.2022 КВВ СВФР-010031 )
		
		
		//Аверсон 15.06.2022 КВВ СВФР-009187 (пункт 2) (закомментировано) (
		//если Организация.ИНН = "100765738" Тогда
		//	ЗапросОтп.Текст = СтрЗаменить(ЗапросОтп.Текст,"ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеОтпускаРаботникамОрганизаций","(ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеОтпускаРаботникамОрганизаций 
		//	|	ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияорганизаций.ОплатаПоСреднемуОтпКалендарныеДни)
		//	|	ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням))");
		////Аверсон ЕАЕ 25.08.2021 СВФР-007968	
		//Иначе
		//	ЗапросОтп.Текст = СтрЗаменить(ЗапросОтп.Текст,"ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеОтпускаРаботникамОрганизаций",
		//	"( ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеОтпускаРаботникамОрганизаций ИЛИ ( ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛисту
		//	|	И ( ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияорганизаций.ОплатаПоСреднемуОтпКалендарныеДни)
		//	|	ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням) ) ) )");
		//	
		//	ЗапросОтп.Текст = СтрЗаменить(ЗапросОтп.Текст, "И МЕСЯЦ(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации) <> МЕСЯЦ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало)",
		//	"И ВЫБОР КОГДА ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеОтпускаРаботникамОрганизаций ТОГДА МЕСЯЦ(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации) <> МЕСЯЦ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало) ИНАЧЕ ИСТИНА КОНЕЦ");
		//КонецЕсли;
		////Аверсон СВФР-007968
		//Аверсон 15.06.2022 КВВ СВФР-009187 (пункт 2) (закомментировано) )
		
		ЗапросОтп.УстановитьПараметр("ПериодДействияНачало", НачалоМесяца(ДанныеДляРасчетаЕСН.Месяц));
		ЗапросОтп.УстановитьПараметр("ПериодДействияНачало1", КонецМесяца(ДанныеДляРасчетаЕСН.Месяц));
		ЗапросОтп.УстановитьПараметр("ПериодРегистрации", ПериодР);
		ЗапросОтп.УстановитьПараметр("Организация", Организация);
		
		ЗапросОтп.УстановитьПараметр("ФизЛицоСтр", ДанныеДляРасчетаЕСН.ФизЛицо);
		
		
		РезОтп = ЗапросОтп.Выполнить().Выбрать();
		БазаОтпуск = 0;
		пока РезОтп.Следующий() цикл
			Если РезОтп.ПериодРегистрации < Дата(2016,07,01) и РезОтп.ПериодДействияНачало >= Дата(2016,07,01) Тогда 
				БазаОтпуск = БазаОтпуск + ОбщегоНазначения.ОкруглитьЗначение2016(РезОтп.Результат/10000,ПериодР);//Наркевич 08.07.2014 при более одном переходящем виде расчета нужно суммировать
			иначе
				БазаОтпуск = БазаОтпуск + РезОтп.Результат;
			КонецЕсли;
		КонецЦикла;
		//иначе
		//	БазаОтпуск = 0;
		//КонецЕсли;
		//Аверсон-софт, Островская Татьяна 20.08.2012 № 15686
		
		//О.Т. 15.09.2014 № 17594
		СуммаУжеНачислПенс = 0;
		//если ПенсФондБудМес = 1 тогда
		ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодР,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер;//О.Т. Аверсон 08.08.2016
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
		|	ВЫБОР КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
		|			И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) и &ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
		|		ТОГДА ВЫРАЗИТЬ(ЕСНИсчисленный.ПенсионныйФонд / 10000 КАК ЧИСЛО(10, "+ЗначениеОкругления+"))
		|	ИНАЧЕ ЕСНИсчисленный.ПенсионныйФонд
		|   КОНЕЦ КАК ПенсионныйФонд
		|ИЗ
		|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|ГДЕ
		|	ЕСНИсчисленный.Организация = &парамГоловнаяОрганизация
		|	И ЕСНИсчисленный.ФизЛицо = &ФизЛицо
		|	И ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетовНаМесяцНач И &ПериодВзаиморасчетовНаМесяцКон
		|	И ЕСНИсчисленный.ПериодВзаиморасчетов <> &ПериодРегистрации";
		
		Запрос.УстановитьПараметр("парамГоловнаяОрганизация", Организация);
		Запрос.УстановитьПараметр("ПериодВзаиморасчетовНаМесяцНач", НачалоМесяца(ДанныеДляРасчетаЕСН.Месяц));
		Запрос.УстановитьПараметр("ПериодВзаиморасчетовНаМесяцКон", КонецМесяца(ДанныеДляРасчетаЕСН.Месяц));
		Запрос.УстановитьПараметр("ПериодРегистрации", ПериодР);
		Запрос.УстановитьПараметр("ФизЛицо", ДанныеДляРасчетаЕСН.ФизЛицо);
		РезУжеНачисленный = Запрос.Выполнить().Выбрать();
		Пока РезУжеНачисленный.Следующий() Цикл 
			СуммаУжеНачислПенс = СуммаУжеНачислПенс + РезУжеНачисленный.ПенсионныйФонд;
		КонецЦикла;
		//КонецЕсли;
		//О.Т. 15.09.2014 № 17594	
		
		
		//О.Т. 18.12.2014 № 17744
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	БазаДляНачислений.ФизЛицо КАК ФизЛицо,
		|	БазаДляНачислений.Месяц КАК Месяц,
		|	СУММА(БазаДляНачислений.БазаДоходФСЗН) КАК БазаДоходФСЗН,
		
		//Аверсон ЕАЕ 15.03.2024 СВФР-012613
		|   СУММА(БазаДляНачислений.БазаДоходФСЗНПоВидуНачислений) КАК БазаДоходФСЗНПоВидуНачислений
		//Аверсон СВФР-012613
		
		|ИЗ
		|	(ВЫБРАТЬ
		|		Основная.ФизЛицо КАК ФизЛицо,
		|		Основная.Месяц КАК Месяц,
		|		ВЫБОР
		|			КОГДА Основная.ДоходФСЗН = &парамПодлежитОбложению
		|				ТОГДА Основная.ОблагаемыйДоход
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК БазаДоходФСЗН,
		
		//Аверсон ЕАЕ 15.03.2024 СВФР-012613
		|       ВЫБОР
		|       КОГДА Основная.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН
		|       ТОГДА Основная.ОблагаемыйДоход
		|       ИНАЧЕ 0
		|       КОНЕЦ КАК БазаДоходФСЗНПоВидуНачислений,
		//Аверсон СВФР-012613
		
		|		ВЫБОР
		|			КОГДА Основная.ДоходСтрах = &парамПодлежитОбложению
		|				ТОГДА Основная.ОблагаемыйДоход
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК БазаДоходСтрах,
		|		ВЫБОР
		|			КОГДА Основная.доходЕдиныйПлатеж = &парамПодлежитОбложению
		|				ТОГДА Основная.ОблагаемыйДоход
		|			ИНАЧЕ 0
		|		КОНЕЦ КАК БазаДоходЕдиныйПлатеж
		|	ИЗ
		|		(ВЫБРАТЬ
		|			ЕСННачисления.ФизЛицо КАК ФизЛицо,
		|			ЕСННачисления.Месяц КАК Месяц,
		|			ЕСННачисления.ДоходФСЗН КАК ДоходФСЗН,
		|			ЕСННачисления.ДоходСтрах КАК ДоходСтрах,
		|			ЕСННачисления.доходЕдиныйПлатеж КАК доходЕдиныйПлатеж,
		|			ЕСННачисления.ОблагаемыйДоход КАК ОблагаемыйДоход,
		
		//Аверсон ЕАЕ 15.03.2024 СВФР-012613
		|           ЕСННачисления.ВидРасчета
		//Аверсон СВФР-012613
		
		|		ИЗ
		|			(ВЫБРАТЬ
		|				ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
		|				НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
		|				ЕСНСведенияОДоходах.ДоходФСЗН КАК ДоходФСЗН,
		|				ЕСНСведенияОДоходах.ДоходСтрах КАК ДоходСтрах,
		|				ЕСНСведенияОДоходах.доходЕдиныйПлатеж КАК доходЕдиныйПлатеж,
		|				ЕСНСведенияОДоходах.Результат КАК ОблагаемыйДоход,
		
		//Аверсон ЕАЕ 15.03.2024 СВФР-012613
		|               ЕСНСведенияОДоходах.ВидРасчета
		//Аверсон СВФР-012613
		
		|			ИЗ
		|				РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		|			ГДЕ ";
		
		// Аверсон 13.04.2022 КВВ СВФР-008951 (
		Если БазаОтпуск = 0 Тогда
			Запрос.Текст = Запрос.Текст + "
			// Аверсон 13.04.2022 КВВ СВФР-008951 )
			|				Выбор когда ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета = &СпособРасчета тогда ЕСНСведенияОДоходах.Период МЕЖДУ &парамНачалоМесяцаПериодаРегистрации И &парамКонецМесяцаПериодаРегистрации иначе Истина конец"; //Условие на отпуск. было пересечение с первым запросом
			// Аверсон 13.04.2022 КВВ СВФР-008951 (
		Иначе
			Запрос.Текст = Запрос.Текст + "
			|				ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета <> ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням)"; //Аверсон 25.03.2022 КВВ СВФР-008872
		КонецЕсли;
		Запрос.Текст = Запрос.Текст + "
		// Аверсон 13.04.2022 КВВ СВФР-008951 )
		
		|				И ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &парамНачалоМесяцаПериодаРегистрации И &парамКонецМесяцаПериодаРегистрации
		|				И ЕСНСведенияОДоходах.ОбособленноеПодразделение В(&СписокВсехПодразделенийОрганизации)
		|				И НЕ(ЕСНСведенияОДоходах.Период МЕЖДУ &ПериодРегистрации И &ПериодРегистрации1)
		|				И ЕСНСведенияОДоходах.ПериодВзаиморасчетов <> &ПериодРегистрации) КАК ЕСННачисления
		|		ГДЕ
		|			ЕСННачисления.ФизЛицо = &ФизЛицо) КАК Основная) КАК БазаДляНачислений
		|
		|СГРУППИРОВАТЬ ПО
		|	БазаДляНачислений.ФизЛицо,
		|	БазаДляНачислений.Месяц";
		Запрос.УстановитьПараметр("парамКонецМесяцаПериодаРегистрации", КонецМесяца(ДанныеДляРасчетаЕСН.Месяц));
		Запрос.УстановитьПараметр("парамНачалоМесяцаПериодаРегистрации", НачалоМесяца(ДанныеДляРасчетаЕСН.Месяц));
		Запрос.УстановитьПараметр("парамПодлежитОбложению", Перечисления.ДоходыФСС_НС.Облагается);
		СписокВсехПодразделенийОрганизации = ПроцедурыУправленияПерсоналом.ПолучитьСписокОбособленныхПодразделенийОрганизации(Организация);
		СписокВсехПодразделенийОрганизации.Добавить(Организация);
		Запрос.УстановитьПараметр("СписокВсехПодразделенийОрганизации", СписокВсехПодразделенийОрганизации);
		Запрос.УстановитьПараметр("ФизЛицо", ДанныеДляРасчетаЕСН.ФизЛицо);
		Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодР));
		Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодР));
		Запрос.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням);
		
		
		РезультатЗапроса = Запрос.Выполнить().Выбрать(); 
		СуммаБазаДрПериод = 0;
		
		//Аверсон ЕАЕ 15.03.2024 СВФР-012613
		СуммаБазаДрПериодПоВидуНачислений = 0;
		//Аверсон СВФР-012613
		
		Пока РезультатЗапроса.Следующий() Цикл
			СуммаБазаДрПериод = СуммаБазаДрПериод + РезультатЗапроса.БазаДоходФСЗН;
			
		//Аверсон ЕАЕ 15.03.2024 СВФР-012613
			СуммаБазаДрПериодПоВидуНачислений = СуммаБазаДрПериодПоВидуНачислений + РезультатЗапроса.БазаДоходФСЗНПоВидуНачислений;
		//Аверсон СВФР-012613
			
		КонецЦикла;
		//О.Т. 18.12.2014 № 17744
		
		
		НоваяСтрока = ПенсионныйФонд.Добавить();
		НоваяСтрока.Физлицо = ДанныеДляРасчетаЕСН.ФизЛицо;
		
		//Аверсон ЕАЕ 22.11.2021 СВФР-008398
		НоваяСтрока.Сотрудник = Сотрудник;
		//Аверсон СВФР-008398
		
		НоваяСтрока.ПроцентФСЗН = ?(ЕстьИндивидСтавка,СтавкаФСЗНИнд,?(ДанныеДляРасчетаЕСН.Группа = 0, СтавкаФСЗН, СтавкаФСЗНИнвалиды)); //О.Т. Аверсон 30.03.2016 № 950
		
		ВеличинаПрожиточногоМинимума = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(ДанныеДляРасчетаЕСН.Месяц),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
		РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ДанныеДляРасчетаЕСН.Месяц)-1,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
		
		ПериодРасчета					 = ?(не ЗначениеЗаполнено(ДанныеДляРасчетаЕСН.Месяц), ПериодР, ДанныеДляРасчетаЕСН.Месяц);
		НоваяСтрока.МесяцНалоговогоПериода = ПериодРасчета;
		//Аверсон-софт, Островская Татьяна 20.08.2012 № 15686
		Если СтруктураПенс.ОграничениеПоДоходам = 0 ИЛИ РазмерСреднейЗарплаты = 0 тогда
			БазаДоходПенсионныйФонд = ДанныеДляРасчетаЕСН.БазаДоходФСЗН + БазаОтпуск + СуммаБазаДрПериод;
		Иначе
			
			//Аверсон 09.06.2022 КВВ СВФР-009187 (
			
			////Аверсон 26.05.2020 КВВ СВФР-006050 (
			////БазаДоходПенсионныйФонд = ?(ДанныеДляРасчетаЕСН.БазаДоходФСЗН + БазаОтпуск + СуммаБазаДрПериод > СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты, СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты, ДанныеДляРасчетаЕСН.БазаДоходФСЗН+ БазаОтпуск + СуммаБазаДрПериод);
			//Если ПенсФондБудМес = 1 Тогда   //Аверсон 29.09.2020 КВВ СВФР-006555
			//	ЧтоСравниваем = ДанныеДляРасчетаЕСН.БазаДоходФСЗН + ?(СуммаБазаДрПериод=0,БазаОтпуск,0) + СуммаБазаДрПериод; //Если СуммаБазаДрПериод <> 0, то БазаОтпуск уже "сидит" в СуммаБазаДрПериод, не надо второй раз суммировать
			//	//Аверсон 29.09.2020 КВВ СВФР-006555 (
			//Иначе
			//	ЧтоСравниваем = ДанныеДляРасчетаЕСН.БазаДоходФСЗН + БазаОтпуск + СуммаБазаДрПериод;
			//КонецЕсли;
			////Аверсон 29.09.2020 КВВ СВФР-006555 )
			
			//Аверсон ЕАЕ 15.03.2024 СВФР-012613
			//ЧтоСравниваем = ДанныеДляРасчетаЕСН.БазаДоходФСЗН + БазаОтпуск + СуммаБазаДрПериод;
			ЧтоСравниваем = ДанныеДляРасчетаЕСН.БазаДоходФСЗН + БазаОтпуск + СуммаБазаДрПериодПоВидуНачислений; 
			//Аверсон СВФР-012613
			
			//Аверсон 09.06.2022 КВВ СВФР-009187 )
			
			
			БазаДоходПенсионныйФонд = ?(ЧтоСравниваем > СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты, СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты, ЧтоСравниваем);
			//Аверсон 26.05.2020 КВВ СВФР-006050 )
			
			//БазаДоходПенсионныйФонд = ?(ДанныеДляРасчетаЕСН.БазаДоходФСЗН + ?(ПенсФондБудМес = 1,БазаОтпуск,0) > СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты, СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты, ДанныеДляРасчетаЕСН.БазаДоходФСЗН+ ?(ПенсФондБудМес = 1,БазаОтпуск,0));
		КонецЕсли;
		//Аверсон-софт, Островская Татьяна 20.08.2012 № 15686
		//Аверсон-софт, Островская Татьяна 13.06.2012 № 15494
		НеПравоНаПенсию = Ложь;
		Запрос = Новый Запрос;
		Запрос.Текст  = 
		"ВЫБРАТЬ
		|	ГражданствоФизЛицСрезПоследних.ФизЛицо,
		|	ГражданствоФизЛицСрезПоследних.Страна,
		|	ГражданствоФизЛицСрезПоследних.НеИмеетПравоНаПенсию
		|ИЗ
		|	РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&Период, ) КАК ГражданствоФизЛицСрезПоследних
		|ГДЕ
		|	ГражданствоФизЛицСрезПоследних.ФизЛицо = &ФизЛицо
		|	И ГражданствоФизЛицСрезПоследних.НеИмеетПравоНаПенсию = ИСТИНА";
		Запрос.УстановитьПараметр("ФизЛицо", ДанныеДляРасчетаЕСН.ФизЛицо);
		Запрос.УстановитьПараметр("Период", ДанныеДляРасчетаЕСН.Месяц);//О.Т. 06.04.2015
		Выборка = Запрос.Выполнить().Выбрать();
		Пока Выборка.Следующий() цикл
			
			НеПравоНаПенсию =	Выборка.НеИмеетПравоНаПенсию;
			
		КонецЦикла;
		если  НеПравоНаПенсию тогда
			НоваяСтрока.Налог = 0;
		иначе
			НоваяСтрока.Налог = ОбщегоНазначения.ОкруглитьПоВалюте(БазаДоходПенсионныйФонд * ?(ЕстьИндивидСтавка,СтавкаПенсионныйИнд,СтавкаПенсионныйФонд)/100, Константы.ВалютаРегламентированногоУчета.Получить()) - данныеДляРасчетаЕСН.ПенсионныйФонд - СуммаУжеНачислПенс;//О.Т. 10.10.2014 Добавлена СуммаУжеНачислПенс
			
			//Аверсон 01.07.2022 КВВ СВФР-009250 (
			//Если Организация.УчетДополнительнойПенсии Тогда
			УжеУдержалиНалогДП = 0;
			Запрос = Новый Запрос;
			Запрос.Текст =
			"ВЫБРАТЬ
			|	УдержанияРаботниковОрганизаций.Сотрудник,
			|	УдержанияРаботниковОрганизаций.ВидРасчета,
			|	СУММА(УдержанияРаботниковОрганизаций.Результат) КАК Результат
			|ИЗ
			|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизаций
			|ГДЕ
			|	УдержанияРаботниковОрганизаций.БазовыйПериодНачало <= &ПериодРегистрации
			|	И УдержанияРаботниковОрганизаций.БазовыйПериодКонец >= &ПериодРегистрации1
			|	И УдержанияРаботниковОрганизаций.ВидРасчета = &ВидРасчета
			|	И УдержанияРаботниковОрганизаций.Сотрудник = &Сотрудник
			|	И УдержанияРаботниковОрганизаций.Организация = &Организация
			|
			|СГРУППИРОВАТЬ ПО
			|	УдержанияРаботниковОрганизаций.Сотрудник,
			|	УдержанияРаботниковОрганизаций.ВидРасчета"; 
			Запрос.УстановитьПараметр("Организация", Организация);
			Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
			Запрос.УстановитьПараметр("ВидРасчета", ПланыВидовРасчета.УдержанияОрганизаций.ДополнительнаяПенсия);
			Запрос.УстановитьПараметр("ПериодРегистрации", НачалоМесяца(ПериодРасчета));
			Запрос.УстановитьПараметр("ПериодРегистрации1", КонецМесяца(ПериодРасчета));
			Выборка = Запрос.Выполнить().Выбрать();
			Пока Выборка.Следующий() цикл 				
				УжеУдержалиНалогДП =	Выборка.Результат;					
			КонецЦикла;
			ПроцентДопПенсии = РегистрыСведений.ДополнительнаяПенсияРаботодательРаботник.ПолучитьПоследнее(ПериодРасчета,Новый Структура("Сотрудник",Сотрудник)).ПроцентРаботника;
			Если ПроцентДопПенсии > 0 и НоваяСтрока.Налог <> 0 Тогда
				Мес = 0;
				ОбщегоНазначения.РазобратьРазностьДат(НачалоМесяца(ПериодРегистрации),НачалоМесяца(ПериодРасчета),,Мес);
				Если Мес < 2 и  НачалоМесяца(ПериодРасчета) <= НачалоМесяца(ПериодРегистрации) или ПенсФондБудМес = 0 Тогда      		
					СтрДП = ДополнительнаяПенсия.Добавить();
					СтрДП.ФизЛицо =  ДанныеДляРасчетаЕСН.ФизЛицо;
					СтрДП.Сотрудник =  Сотрудник;
					СтрДП.МесяцДП =  ПериодРасчета;
					СтрДП.ПроцентДП = ПроцентДопПенсии;
					СтрДП.БазаДП = БазаДоходПенсионныйФонд;
					//Если ДанныеДляРасчетаЕСН.Месяц < ПериодР Тогда
					//	СтрДП.НалогДП = ОбщегоНазначения.ОкруглитьПоВалюте(БазаДоходПенсионныйФонд*ПроцентДопПенсии/100, Константы.ВалютаРегламентированногоУчета.Получить());
					//Иначе
					СтрДП.НалогДП = ОбщегоНазначения.ОкруглитьПоВалюте(БазаДоходПенсионныйФонд*ПроцентДопПенсии/100, Константы.ВалютаРегламентированногоУчета.Получить())-УжеУдержалиНалогДП;
					//Конецесли;
					Если  Организация.УчетДополнительнойПенсии Тогда
						Если Сотрудник.ТипРаботника <> Перечисления.ТипыРаботников.ДоговорПодряда Тогда
							
							Если ЗначениеЗаполнено(ДокВычет)  Тогда
								ДокВычета = ДокВычет.ПолучитьОбъект();
								ПоискСтроки = ДокВычета.РаботникиОрганизации.НайтиСтроки(Новый Структура("ФизЛицо,ДатаСобытия",Сотрудник.ФизЛицо,НачалоДня(КонецМесяца(ДобавитьМесяц(ПериодРасчета,1))))); 
								если ПоискСтроки.Количество()>0 Тогда 
									ПоискСтроки[0].Расходы = СтрДП.НалогДП 
								Иначе
									СтрокаДока = ДокВычета.РаботникиОрганизации.Добавить();
									СтрокаДока.ФизЛицо = Сотрудник.ФизЛицо;
									СтрокаДока.КодВычета = Справочники.ВычетыНДФЛ.Код641страх;
									СтрокаДока.Расходы = СтрДП.НалогДП;
									СтрокаДока.ДатаСобытия = КонецМесяца(ДобавитьМесяц(ПериодРасчета,1));    	
								КонецЕсли;
								ДокВычета.Записать(РежимЗаписиДокумента.Запись);
							Иначе 
								ДокВычета = Документы.НДФЛПодтверждениеПраваНаИмущественныйВычет.СоздатьДокумент(); 
								ДокВычета.Организация = Организация;  
								ДокВычета.ПодразделениеОрганизации = ПодразделениеОрганизации;
								ДокВычета.НалоговыйПериод = Год(КонецМесяца(ДобавитьМесяц(ПериодРасчета,1)));
								ДокВычета.Дата = ДобавитьМесяц(Дата,1);
								СтрокаДока = ДокВычета.РаботникиОрганизации.Добавить();
								СтрокаДока.ФизЛицо = Сотрудник.ФизЛицо;
								СтрокаДока.КодВычета = Справочники.ВычетыНДФЛ.Код641страх;
								СтрокаДока.Расходы = СтрДП.НалогДП;
								СтрокаДока.ДатаСобытия = КонецМесяца(ДобавитьМесяц(ПериодРасчета,1));   
								ДокВычета.Ответственный = глЗначениеПеременной("глТекущийПользователь");
								ДокВычета.Комментарий = "ДНПС по "+СокрЛП(ПодразделениеОрганизации);
								ДокВычета.Записать(РежимЗаписиДокумента.Запись);
								ДокВычет = ДокВычета.Ссылка;
							КонецЕсли;
						КонецЕсли;
						//СВФР-017571
						Лет	= 0;
						ОбщегоНазначения.РазобратьРазностьДат(КонецМесяца(ПериодРегистрации), Сотрудник.физлицо.ДатаРождения, Лет);

						Если (Сотрудник.физлицо.пол = Перечисления.ПолФизическихЛиц.Женский и лет >= 58) или
							(Сотрудник.физлицо.пол = Перечисления.ПолФизическихЛиц.Мужской и лет >= 63) Тогда 
							СтрДП.НалогДП = 0;
							Если Организация.инн = "806000046" Тогда
								Попытка
									СотрудникОб = Сотрудник.получитьОбъект();
									Стр = СотрудникОб.дополнительнаяпенсия.Добавить();
									Стр.ДатаИзменения =  ПериодРегистрации;
									Стр.ПроцентРаботодателя = 0;
									Стр.ПроцентРаботника = 0;
									СотрудникОб.записать();
								Исключение
								КонецПопытки;
								Сообщить("Сотрудник "+ СокрЛП(Сотрудник.наименование)+ " достиг пенсионного возраста, сумма ДНПС обнулена!!!");
							Иначе								
								Сообщить("Сотрудник "+ СокрЛП(Сотрудник.наименование)+ " достиг пенсионного возраста, остновите ДНПС, сумму обнулена!!!");
							КонецЕсли;
						КонецЕсли;
						//СВФР-017571
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		//Аверсон 01.07.2022 КВВ СВФР-009250 )
		
		//КонецЕсли;
		//Аверсон-софт, Островская Татьяна 13.06.2012 № 15494
		
	КонецЦикла;
	
	//Аверсон ЕАЕ 22.11.2021 СВФР-008398
	//ПенсионныйФонд.Свернуть("ФизЛицо, МесяцНалоговогоПериода, ПроцентФСЗН","Налог");
	ПенсионныйФонд.Свернуть("ФизЛицо, Сотрудник, МесяцНалоговогоПериода, ПроцентФСЗН","Налог");
	//Аверсон СВФР-008398
	
	НаборЕСНСведенияОДоходах.Очистить();
	НаборЕСНСведенияОДоходах.Записать();
КонецПроцедуры

// получает доходы ПенсонногоФонда по табличным частям с доходами
// Параметры:
//		ВыборкаПоШапкеДокумента - спозиционированная выборка по шапке документа
//		НаборЗаписей - таблица значений или набор записей рег-ра - "приемник" сведений о доходах
//		
Процедура СформироватьДоходыПоПенсионномуФонду(ВыборкаПоШапкеДокумента, НаборЗаписей, ФизЛицо = Неопределено)
	
	
	// Составим текст запроса для выбора списка физлиц, по которым надо считать песионный фонд
	Если НЕ (Физлицо = Неопределено) Тогда
		СписокФизлицТекст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &парамРегистратор и Работники.Физлицо = &парамФизлицо
		
		//Аверсон ЕАЕ 11.03.2025 СВФР-015145
		|ОБЪЕДИНИТЬ
		|ВЫБРАТЬ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &парамРегистратор и Работники.Физлицо = &парамФизлицо
		//Аверсон СВФР-015145
		
		|";
		
		ДополнительныеПараметрыЗапроса  = Новый Структура;
		ДополнительныеПараметрыЗапроса.Вставить("парамФизлицо", Физлицо);
	Иначе
		СписокФизлицТекст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &парамРегистратор
		
		//Аверсон ЕАЕ 11.03.2025 СВФР-015145
		|ОБЪЕДИНИТЬ 
		|ВЫБРАТЬ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &парамРегистратор
		//Аверсон СВФР-015145
		
		|";
		
		ДополнительныеПараметрыЗапроса  = Неопределено;
	КонецЕсли;
	
	//ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,ДобавитьМесяц(ПериодРегистрации,-1),ПериодРегистрации);//Аверсон 08.07.2019 КВВ СВФР-004490
	ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,НачалоМесяца(ПериодНачисленияДатаНачала),ПериодРегистрации); //Аверсон 15.11.2019 КВВ СВФР-005009
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("парамСсылка" , Ссылка);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюКодДоходаЕСН", Перечисления.ДоходыФСС_НС.Облагается);
	Запрос.УстановитьПараметр("парамСпособНеОблагаетсяКодДоходаЕСН", Перечисления.ДоходыФСС_НС.НеОблагается);
	Запрос.УстановитьПараметр("парамПустойКодЕСНУ", Справочники.ДоходыЕСН.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюКодЕСН", Справочники.ДоходыЕСН.ОблагаетсяПолностью);
	Запрос.УстановитьПараметр("парамПериодРегистрации",			ПериодР);
	Запрос.УстановитьПараметр("парамОрганизация",				Организация);
	Запрос.УстановитьПараметр("парамРегистратор",				Ссылка);
	
	
	// установим дополнительные параметры
	Если ДополнительныеПараметрыЗапроса <> Неопределено Тогда
		Для каждого Поле Из ДополнительныеПараметрыЗапроса Цикл
			Запрос.УстановитьПараметр(Поле.Ключ, Поле.Значение);
		КонецЦикла;
	КонецЕсли;
	
	//О.Т. 24.06.2014 № 71
	ДополнительноеУсловие = "";
	ДополнительноеУсловиеВнешнееОсновное = "";
	ДополнительноеУсловиеВнешнееДополнительное = "";
	//Если ПодразделениеОрганизации.Пустая() И Ответственный.Пустая() Тогда
	//	ДополнительноеУсловие = "";
	//	ДополнительноеУсловиеВнешнее = "";
	//ИначеЕсли ПодразделениеОрганизации.Пустая() Тогда
	//	Если глЗначениеПеременной("глУчетнаяПолитикаПоПерсоналуОрганизации")[Организация].РасчетЗарплатыОрганизацииПоОтветственным Тогда
	//		ДополнительноеУсловие = " И ПодразделениеОрганизации В ИЕРАРХИИ (ВЫБРАТЬ РАЗЛИЧНЫЕ Расчетчики.ПодразделениеОрганизации ИЗ РегистрСведений.РасчетчикиЗарплатыОрганизаций.СрезПоследних(&парамПериодРегистрации) Расчетчики ГДЕ Расчетчики.Пользователь = &парамОтветственный)";
	//		ДополнительноеУсловиеВнешнееОсновное = " И ОсновныеНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (ВЫБРАТЬ РАЗЛИЧНЫЕ Расчетчики.ПодразделениеОрганизации ИЗ РегистрСведений.РасчетчикиЗарплатыОрганизаций.СрезПоследних(&парамПериодРегистрации) Расчетчики ГДЕ Расчетчики.Пользователь = &парамОтветственный)";
	//		ДополнительноеУсловиеВнешнееДополнительное = " И ДополнительныеНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (ВЫБРАТЬ РАЗЛИЧНЫЕ Расчетчики.ПодразделениеОрганизации ИЗ РегистрСведений.РасчетчикиЗарплатыОрганизаций.СрезПоследних(&парамПериодРегистрации) Расчетчики ГДЕ Расчетчики.Пользователь = &парамОтветственный)";
	//		
	//	КонецЕсли;
	//Иначе
	//	Запрос.УстановитьПараметр("парамПодразделениеОрганизации",	ПодразделениеОрганизации);
	//	ДополнительноеУсловие = " И ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделениеОрганизации)";
	//	ДополнительноеУсловиеВнешнееОсновное = " И ОсновныеНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделениеОрганизации)";
	//	ДополнительноеУсловиеВнешнееДополнительное = " И ДополнительныеНачисления.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделениеОрганизации)";
	//КонецЕсли;
	//О.Т. 24.06.2014 № 71 Убрано условие на подразделение организации,т.к. у физлица могут быть перемещения по подразделению в середине месяца
	//Островская Татьяна 10.12.2012 № 15
	//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.КодДоходаЕСН,
	|	ВЫБОР КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН КОНЕЦ КАК ДоходФСЗН, //ДанныеУчета.ДоходФСЗН,
	|	ВЫБОР КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН КОНЕЦ КАК ДоходСтрах, //ДанныеУчета.ДоходСтрах,
	|	ВЫБОР КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН КОНЕЦ КАК ДоходЕдиныйПлатеж, //ДанныеУчета.ДоходЕдиныйПлатеж,
	|	ДанныеУчета.Результат,
	|	ДанныеУчета.ВидРасчета,
	|	ДанныеУчета.ПериодВзаимоРасчетов,
	|	ДанныеУчета.НомерСтроки,
	|	ДанныеУчета.Регистратор
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОсновныеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
	|		ВЫБОР
	|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
	|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
	|			КОГДА ОсновныеНачисления.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
	|				ТОГДА ОсновныеНачисления.ВидРасчета.КодДоходаЕСН
	|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
	|		КОНЕЦ КАК КодДоходаЕСН,
	|		ОсновныеНачисления.Организация КАК Организация,
	|		ОсновныеНачисления.Результат КАК Результат,
	|		ОсновныеНачисления.ВидРасчета,
	|		ОсновныеНачисления.ПериодДействияНачало КАК ПериодВзаимоРасчетов,
	|		ОсновныеНачисления.НомерСтроки,
	|		ОсновныеНачисления.Регистратор
	|	ИЗ
	|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|					ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|					ОсновныеНачисления.Сотрудник.ФизЛицо КАК ФизЛицо,
	|					ОсновныеНачисления.Организация КАК Организация,
	|					ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
	|				ИЗ
	|					РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|						ПО ОсновныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И ОсновныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация И ОсновныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ОсновныеНачисления.ПериодДействияНачало
	|				
	|				ГДЕ
	|					ВЫБОР КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL ТОГДА ОсновныеНачисления.Организация ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец КОНЕЦ = &парамОрганизация И
	|					ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации И ОсновныеНачисления.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")" +ДополнительноеУсловиеВнешнееОсновное+"
	|				
	|				СГРУППИРОВАТЬ ПО
	|					ОсновныеНачисления.Сотрудник,
	|					ОсновныеНачисления.Сотрудник.ФизЛицо,
	|					ОсновныеНачисления.Организация,
	|					ОсновныеНачисления.ВидРасчета) КАК СведенияОНачисленияхСрез
	|				ПО СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация И СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период
	|			ПО РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ОсновныеНачисления.Сотрудник И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ОсновныеНачисления.Организация И РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ОсновныеНачисления.ВидРасчета
	|	
	|	ГДЕ
	|		ВЫБОР КОГДА ОсновныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL ТОГДА ОсновныеНачисления.Организация ИНАЧЕ ОсновныеНачисления.ПодразделениеОрганизации.Владелец КОНЕЦ = &парамОрганизация И
	|		ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации И ОсновныеНачисления.Регистратор <> &парамРегистратор И ОсновныеНачисления.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")" +ДополнительноеУсловиеВнешнееОсновное+"  //О.Т. Аверсон 06.09.2017 № 1007
	|
	|   ОБЪЕДИНИТЬ ВСЕ
	|    ВЫБРАТЬ
	|		ДополнительныеНачисления.Сотрудник.ФизЛицо КАК ФизЛицо,
	|		ВЫБОР КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН КОГДА ДополнительныеНачисления.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ ТОГДА ДополнительныеНачисления.ВидРасчета.КодДоходаЕСН ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН КОНЕЦ КАК КодДоходаЕСН,
	|		ДополнительныеНачисления.Организация КАК Организация,
	|		ДополнительныеНачисления.Результат КАК Результат,
	|		ДополнительныеНачисления.ВидРасчета,
	|		НАЧАЛОПЕРИОДА(ДополнительныеНачисления.БазовыйПериодНачало, МЕСЯЦ) КАК ПериодВзаимоРасчетов, // О.Т. 06.11.2014 
	|		ДополнительныеНачисления.НомерСтроки,
	|		ДополнительныеНачисления.Регистратор
	|	ИЗ
	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|					ДополнительныеНачисления.Сотрудник КАК Сотрудник,
	|					ДополнительныеНачисления.Сотрудник.ФизЛицо КАК ФизЛицо,
	|					ДополнительныеНачисления.Организация КАК Организация,
	|					ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
	|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
	|				ИЗ
	|					РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
	|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|						ПО ДополнительныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И ДополнительныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация И ДополнительныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ДополнительныеНачисления.ПериодРегистрации
	|				
	|				ГДЕ
	|					ВЫБОР КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL ТОГДА ДополнительныеНачисления.Организация ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец КОНЕЦ = &парамОрганизация И
	|					НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации И ДополнительныеНачисления.Регистратор <> &парамРегистратор И ДополнительныеНачисления.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")" +ДополнительноеУсловиеВнешнееДополнительное+"
	|				
	|				СГРУППИРОВАТЬ ПО
	|					ДополнительныеНачисления.Сотрудник,
	|					ДополнительныеНачисления.Сотрудник.ФизЛицо,
	|					ДополнительныеНачисления.Организация,
	|					ДополнительныеНачисления.ВидРасчета) КАК СведенияОНачисленияхСрез
	|				ПО СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация И СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период
	|			ПО РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ДополнительныеНачисления.Сотрудник И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ДополнительныеНачисления.Организация И РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ДополнительныеНачисления.ВидРасчета
	|				
	|	ГДЕ
	|		ВЫБОР КОГДА ДополнительныеНачисления.ПодразделениеОрганизации.Владелец ЕСТЬ NULL ТОГДА ДополнительныеНачисления.Организация ИНАЧЕ ДополнительныеНачисления.ПодразделениеОрганизации.Владелец КОНЕЦ = &парамОрганизация И
	|		НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) = &парамПериодРегистрации И ДополнительныеНачисления.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")" +ДополнительноеУсловиеВнешнееДополнительное+"
	|   
	|	ОБЪЕДИНИТЬ ВСЕ
	|    
	|	 ВЫБРАТЬ
	|		Основные.Сотрудник.Физлицо КАК Физлицо,
	|		ВЫБОР
	|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
	|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
	|			КОГДА Основные.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
	|				ТОГДА Основные.ВидРасчета.КодДоходаЕСН
	|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
	|		КОНЕЦ КАК КодДоходаЕСН,
	|		&парамОрганизация КАК Организация,
	|		Основные.Результат КАК Результат,
	|		Основные.ВидРасчета,
	|		Основные.ДатаНачала КАК ПериодВзаимоРасчетов,
	|		Основные.НомерСтроки,
	|		Основные.Ссылка
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Основные
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|					Основные.Сотрудник КАК Сотрудник,
	|					Основные.Сотрудник.ФизЛицо КАК ФизЛицо,
	|					Основные.ВидРасчета КАК ВидРасчета,
	|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
	|				ИЗ
	|					Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Основные
	|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|						ПО Основные.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация  = &парамОрганизация И Основные.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= Основные.ДатаНачала
	|				
	|				ГДЕ
	|					Основные.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")
	|				
	|				СГРУППИРОВАТЬ ПО
	|					Основные.Сотрудник,
	|					Основные.Сотрудник.ФизЛицо,
	|					Основные.ВидРасчета) КАК СведенияОНачисленияхСрез
	|				ПО СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период
	|			ПО РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = Основные.Сотрудник И РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = Основные.ВидРасчета
	|	ГДЕ
	|		Основные.Ссылка = &парамРегистратор
	|       И Основные.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")
	|		И Основные.Результат <> 0
	|	ОБЪЕДИНИТЬ ВСЕ
	|    
	|	 ВЫБРАТЬ
	|		Дополнительные.Сотрудник.Физлицо КАК Физлицо,
	|		ВЫБОР
	|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
	|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
	|			КОГДА Дополнительные.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
	|				ТОГДА Дополнительные.ВидРасчета.КодДоходаЕСН
	|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
	|		КОНЕЦ КАК КодДоходаЕСН,
	|		&парамОрганизация КАК Организация,
	|		Дополнительные.Результат КАК Результат,
	|		Дополнительные.ВидРасчета,
	|		Дополнительные.ДатаНачала КАК ПериодВзаимоРасчетов,
	|		Дополнительные.НомерСтроки,
	|		Дополнительные.Ссылка
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Дополнительные
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|					Дополнительные.Сотрудник КАК Сотрудник,
	|					Дополнительные.Сотрудник.ФизЛицо КАК ФизЛицо,
	|					Дополнительные.ВидРасчета КАК ВидРасчета,
	|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
	|				ИЗ
	|					Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Дополнительные
	|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|						ПО Дополнительные.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация  = &парамОрганизация И Дополнительные.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= Дополнительные.ДатаНачала
	|				
	|				ГДЕ
	|					Дополнительные.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")
	|				
	|				СГРУППИРОВАТЬ ПО
	|					Дополнительные.Сотрудник,
	|					Дополнительные.Сотрудник.ФизЛицо,
	|					Дополнительные.ВидРасчета) КАК СведенияОНачисленияхСрез
	|				ПО СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период
	|			ПО РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = Дополнительные.Сотрудник И РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = Дополнительные.ВидРасчета
	|	ГДЕ
	|		Дополнительные.Ссылка = &парамРегистратор
	|       И Дополнительные.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")
	|		И Дополнительные.Результат <> 0
	|
	|	ОБЪЕДИНИТЬ ВСЕ
	|    
	|	 ВЫБРАТЬ
	|		Договорники.Сотрудник.Физлицо КАК Физлицо,
	|		ВЫБОР
	|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН <> &парамПустойКодЕСНУ
	|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.КодДоходаЕСН
	|			КОГДА Договорники.ВидРасчета.КодДоходаЕСН <> &парамПустойКодЕСНУ
	|				ТОГДА Договорники.ВидРасчета.КодДоходаЕСН
	|			ИНАЧЕ &парамСпособПоУмолчаниюКодЕСН
	|		КОНЕЦ КАК КодДоходаЕСН,
	|		&парамОрганизация КАК Организация,
	|		Договорники.Результат КАК Результат,
	|		Договорники.ВидРасчета,
	|		Договорники.ДатаНачала КАК ПериодВзаимоРасчетов,
	|		Договорники.НомерСтроки,
	|		Договорники.Ссылка
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Договорники
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|					Договорники.Сотрудник КАК Сотрудник,
	|					Договорники.Сотрудник.ФизЛицо КАК ФизЛицо,
	|					Договорники.ВидРасчета КАК ВидРасчета,
	|					МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
	|				ИЗ
	|					Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Договорники
	|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|						ПО Договорники.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация  = &парамОрганизация И Договорники.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= Договорники.ДатаНачала
	|				
	|				ГДЕ
	|					Договорники.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")
	|				
	|				СГРУППИРОВАТЬ ПО
	|					Договорники.Сотрудник,
	|					Договорники.Сотрудник.ФизЛицо,
	|					Договорники.ВидРасчета) КАК СведенияОНачисленияхСрез
	|				ПО СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник И СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета И СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период
	|			ПО РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = Договорники.Сотрудник И РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = Договорники.ВидРасчета
	|	ГДЕ
	|		Договорники.Ссылка = &парамРегистратор
	|       И Договорники.Сотрудник.Физлицо В (" + СписокФизЛицТекст + ")
	|		И Договорники.Результат <> 0) КАК ДанныеУчета
	|СГРУППИРОВАТЬ ПО
	|ДанныеУчета.ФизЛицо,
	|ДанныеУчета.КодДоходаЕСН,
	|ДанныеУчета.ВидРасчета,
	|ДанныеУчета.ПериодВзаимоРасчетов,
	|ВЫБОР
	|	КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуФСЗН
	|		ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
	|	ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
	|КОНЕЦ,
	|ВЫБОР
	|	КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуСтрах
	|		ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
	|	ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
	|КОНЕЦ,
	|ВЫБОР
	|	КОГДА ДанныеУчета.КодДоходаЕСН.ВходитВБазуЕдиныйПлатеж
	|		ТОГДА &парамСпособПоУмолчаниюКодДоходаЕСН
	|	ИНАЧЕ &парамСпособНеОблагаетсяКодДоходаЕСН
	|КОНЕЦ,
	|ДанныеУчета.Результат,
	|ДанныеУчета.НомерСтроки, //О.Т. Аверсон 01.03.2016 Для элемы (Были 2 одинаковые строки в регистре)
	|ДанныеУчета.Регистратор";//О.Т. Аверсон 01.03.2016 Для Элемы (Были 2 одинаковые строки в регистре)
	//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
	//Островская Татьяна 10.12.2012 № 15
	
	Запрос.Текст = ТекстЗапроса;	
	Доходы = Запрос.Выполнить().Выбрать();
	//сформируем движения ЕСНСведенияОДоходах
	Пока Доходы.Следующий() Цикл
		
		Движение = НаборЗаписей.Добавить();
		// измерения
		Движение.Период						= ПериодР;
		Движение.ПериодВзаимоРасчетов       = Доходы.ПериодВзаимоРасчетов;
		Движение.Физлицо					= Доходы.Физлицо;
		Движение.Организация				= Организация;
		
		//ресурсы
		Движение.Результат					= Доходы.Результат;
		
		//реквизиты
		Движение.КодДоходаЕСН				= Доходы.КодДоходаЕСН;
		Движение.ДоходФСЗН 					= Доходы.ДоходФСЗН;
		Движение.ДоходСтрах 				= Доходы.ДоходСтрах;
		Движение.ДоходЕдиныйПлатеж 			= Доходы.ДоходЕдиныйПлатеж;
		Движение.ОбособленноеПодразделение	= Организация;
		
		
	КонецЦикла;
	
КонецПроцедуры // СформироватьДоходыПоКодамНДФЛ()

// Предназначена для получения выборки из запроса с данными расчета ЕСН
// По текущему регистратору получает 
//    	данные о начисленной зарплате в разрезе кодов дохода ЕСН
// 		данные об инвалидности физлиц помесячно
//		присоединяет данные о скидках к доходам
//
// Параметры:
//  нет
// Возвращаемое значение:
//  Выборка результата запроса
//
Функция ПолучитьДанныеРасчетаЕСН(ГоловнаяОрганизация, ФизЛицо = Неопределено)
	
	//ЗапросДок = Новый Запрос;
	//ЗапросДок.Текст = 
	//"ВЫБРАТЬ
	//|	НачислениеЗарплатыРаботникамОрганизаций.Ссылка,
	//|	МЕСЯЦ(НачислениеЗарплатыРаботникамОрганизаций.ПериодРегистрации) КАК Месяц
	//|ИЗ
	//|	Документ.НачислениеЗарплатыРаботникамОрганизаций КАК НачислениеЗарплатыРаботникамОрганизаций
	//|ГДЕ
	//|	НачислениеЗарплатыРаботникамОрганизаций.Проведен = ИСТИНА
	//|	И МЕСЯЦ(НачислениеЗарплатыРаботникамОрганизаций.ПериодРегистрации) = &ПериодРегистрации
	//|	И ГОД(НачислениеЗарплатыРаботникамОрганизаций.ПериодРегистрации) = &ПериодРегистрации2";
	//ЗапросДок.УстановитьПараметр("ПериодРегистрации", Месяц(Ссылка.Дата - 2851200));
	//ЗапросДок.УстановитьПараметр("ПериодРегистрации2", Год(Ссылка.Дата - 2851200));
	//РезДок = ЗапросДок.Выполнить().Выбрать();
	//пока РезДок.Следующий() цикл
	//	СсылкаПред = РезДок.Ссылка;
	//КонецЦикла;
	
	//Аверсон 29.09.2020 КВВ СВФР-006555 (
	//ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,ДобавитьМесяц(ПериодРегистрации,-1),ПериодРегистрации);//Аверсон 08.07.2019 КВВ СВФР-004490
	ПериодР = ?(ПериодНачисления=Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод,НачалоМесяца(ПериодНачисленияДатаНачала),ПериодРегистрации);//Аверсон 08.07.2019 КВВ СВФР-004490
	//Аверсон 29.09.2020 КВВ СВФР-006555 )
	
	Запрос = Новый Запрос();
	Запрос.УстановитьПараметр("парамКонецМесяцаПериодаРегистрации", КонецМесяца(ПериодР));
	Запрос.УстановитьПараметр("парамНачалоМесяцаПериодаРегистрации", НачалоМесяца(ПериодР));
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("парамОбособленноеПодразделение", Организация);
	Запрос.УстановитьПараметр("парамПодлежитОбложению", Перечисления.ДоходыФСС_НС.Облагается);
	Запрос.УстановитьПараметр("парамВидСтавокЕСНиПФР", ГоловнаяОрганизация.ВидСтавокЕСНиПФР);
	Запрос.УстановитьПараметр("парамНачалоГода", НачалоГода(ПериодР));
	Запрос.УстановитьПараметр("парамГруппа1", "I");
	Запрос.УстановитьПараметр("парамГруппа2", "II");
	Запрос.УстановитьПараметр("парамГодРасчета", Год(ПериодР));
	Запрос.УстановитьПараметр("парамПериодРегистрации", ПериодР);
	Запрос.УстановитьПараметр("парамМуж", Перечисления.ПолФизическихЛиц.Мужской);
	Запрос.УстановитьПараметр("Регистратор", Ссылка);
	
	
	
	
	
	ЛьготаИнвалидов = "100000";
	
	СписокВсехПодразделенийОрганизации = ПроцедурыУправленияПерсоналом.ПолучитьСписокОбособленныхПодразделенийОрганизации(ГоловнаяОрганизация);
	СписокВсехПодразделенийОрганизации.Добавить(ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("СписокВсехПодразделенийОрганизации", СписокВсехПодразделенийОрганизации);
	// ---------------------------------------------------------------------------
	// тексты запросов
	//
	
	// Периоды
	// Таблица список периодов
	// Поля:
	//		Период
	// Описание:
	//  список периодов - первые даты месяцеы с начала года по "текущий" для запроса период
	//
	
	// конец месяца налогового периода
	КонецМесяца = КонецМесяца(НачалоГода(ПериодР));
	// первый месяц
	ПериодыТекст = "ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ") КАК Период";
	// прибавим остальные месяцы
	Для Сч = 2 По Месяц(ПериодР) Цикл
		КонецМесяца = КонецМесяца(КонецМесяца+1);
		ПериодыТекст = ПериодыТекст +" ОБЪЕДИНИТЬ ВСЕ ВЫБРАТЬ ДАТАВРЕМЯ(" + Формат(КонецМесяца,"ДФ=гггг,М,д,Ч,м,с") + ")";
	КонецЦикла;
	
	
	// ФизлицаДляРасчета
	//
	//ФизлицаДляРасчетаТекст = 
	//"ВЫБРАТЬ РАЗЛИЧНЫЕ
	//|	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо
	//|ИЗ
	//|	РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
	//|ГДЕ
	//|	ЕСНСведенияОДоходах.Период = &парамПериодРегистрации
	//|	И ЕСНСведенияОДоходах.ОбособленноеПодразделение = &парамОбособленноеПодразделение";
	
	// Составим текст запроса для выбора списка физлиц, по которым надо считать НДФЛ
	Если НЕ (Физлицо = Неопределено) Тогда
		ФизлицаДляРасчетаТекст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &Регистратор и Работники.Физлицо = &парамФизлицо
		
		//Аверсон ЕАЕ 11.03.2025 СВФР-015145
		|ОБЪЕДИНИТЬ 
		|ВЫБРАТЬ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &Регистратор и Работники.Физлицо = &парамФизлицо
		//Аверсон СВФР-015145
		
		|";
		
		ДополнительныеПараметрыЗапроса  = Новый Структура;
		ДополнительныеПараметрыЗапроса.Вставить("парамФизлицо", Физлицо);
	Иначе
		ФизлицаДляРасчетаТекст  = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &Регистратор
		
		//Аверсон ЕАЕ 11.03.2025 СВФР-015145
		|ОБЪЕДИНИТЬ
		|ВЫБРАТЬ
		|	Работники.Физлицо КАК Физлицо
		|ИЗ Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК Работники
		|
		|ГДЕ
		|	Работники.Ссылка = &Регистратор
		//Аверсон СВФР-015145
		
		|";
		
		ДополнительныеПараметрыЗапроса  = Неопределено;
	КонецЕсли;
	
	// установим дополнительные параметры
	Если ДополнительныеПараметрыЗапроса <> Неопределено Тогда
		Для каждого Поле Из ДополнительныеПараметрыЗапроса Цикл
			Запрос.УстановитьПараметр(Поле.Ключ, Поле.Значение);
		КонецЦикла;
	КонецЕсли;
	
	// ДанныеОПравеНаПенсию
	// Таблица Таблица Данные о праве на пенсию: - таблица это список иностранцев и периодов
	// Поля:
	//		Физлицо, 
	//		Месяц - месяц налогового периода
	// 
	// Описание:
	//	Выбираем Из Списка периодов
	//	Внутреннее соединение с ГражданствоФизЛиц.СрезПоследних
	//  по равенству периодов
	//  условие: что физлицо - не имеет права на пенсию
	//
	ДанныеОПравеНаПенсиюТекст = "
	|ВЫБРАТЬ
	|	Месяц(Периоды.Период) КАК Месяц,
	|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
	|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		("+ПериодыТекст+") КАК Периоды
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|			ПО Периоды.Период >= ГражданствоФизЛиц.Период
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ГражданствоФизЛиц.ФизЛицо,
	|		Периоды.Период) КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|		ПО ГражданствоФизЛиц.Период = Периоды.ПериодРегистра И ГражданствоФизЛиц.ФизЛицо = Периоды.Физлицо И ГражданствоФизЛиц.НеИмеетПравоНаПенсию
	|";
	
	
	
	
	// ДоходыПоФизлицамМесяцамКодамТекст
	// Таблица ЕСН-доходы по ФЛ и Периодам:
	// Поля:
	// Описание:
	// Выбираем из ЕСНОсновныеНачисления ,ЕСНДополнительныеНачисления и ЕСНСведенияОДоходах и суммируем результат
	// с начала года по текущий период
	ПенсФондБудМес = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодР,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ПенсионныйФондБудущегоМесяца)).размер;
	если ПенсФондБудМес = 1 тогда
		ДоходыПоФизлицамМесяцамКодамТекст = 
		"ВЫБРАТЬ
		|	ЕСННачисления.ФизЛицо КАК ФизЛицо,
		|	ЕСННачисления.Месяц,
		|	ЕСННачисления.ДоходФСЗН,
		|	ЕСННачисления.ДоходСтрах,
		|	ЕСННачисления.ДоходЕдиныйПлатеж,
		|	ЕСННачисления.ОблагаемыйДоход КАК ОблагаемыйДоход
		|ИЗ
		|	(ВЫБРАТЬ
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
		|		ЕСНСведенияОДоходах.ДоходФСЗН,
		|		ЕСНСведенияОДоходах.ДоходСтрах,
		|		ЕСНСведенияОДоходах.ДоходЕдиныйПлатеж,
		|		ЕСНСведенияОДоходах.Результат КАК ОблагаемыйДоход
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		|	
		|	ГДЕ
		//Аверсон 05.05.2020 КВВ СВФР-005913 (
		//|		ЕСНСведенияОДоходах.ПериодВзаиморасчетов >= &парамНачалоМесяцаПериодаРегистрации И
		//|		ЕСНСведенияОДоходах.ПериодВзаиморасчетов <= &парамКонецМесяцаПериодаРегистрации И
		|	ЕСНСведенияОДоходах.Период >= &парамНачалоМесяцаПериодаРегистрации И
		|	ЕСНСведенияОДоходах.Период <= &парамКонецМесяцаПериодаРегистрации
		//Аверсон 05.05.2020 КВВ СВФР-005913 )
		|		И выбор когда ЕСНСведенияОДоходах.Период между &парамНачалоМесяцаПериодаРегистрации  и &парамКонецМесяцаПериодаРегистрации тогда  не ЕСНСведенияОДоходах.Регистратор ссылка Документ.РасчетЕСН иначе истина конец //О.Т. Аверсон 20.02.2019 № 3195
		//|		И ЕСНСведенияОДоходах.Регистратор = &Регистратор
		//|		И ЕСНСведенияОДоходах.Регистратор = &Регистратор2 
		|		И ЕСНСведенияОДоходах.ОбособленноеПодразделение в (&СписокВсехПодразделенийОрганизации)) КАК ЕСННачисления
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляРасчетаТекст + ") КАК Физлица
		|		ПО ЕСННачисления.ФизЛицо = Физлица.ФизЛицо";  
	иначе
		ДоходыПоФизлицамМесяцамКодамТекст = 
		"ВЫБРАТЬ
		|	ЕСННачисления.ФизЛицо КАК ФизЛицо,
		|	ЕСННачисления.Месяц,
		|	ЕСННачисления.ДоходФСЗН,
		|	ЕСННачисления.ДоходСтрах,
		|	ЕСННачисления.ДоходЕдиныйПлатеж,
		|	ЕСННачисления.ОблагаемыйДоход КАК ОблагаемыйДоход
		|ИЗ
		|	(ВЫБРАТЬ
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
		|		ЕСНСведенияОДоходах.ДоходФСЗН,
		|		ЕСНСведенияОДоходах.ДоходСтрах,
		|		ЕСНСведенияОДоходах.ДоходЕдиныйПлатеж,
		|		ЕСНСведенияОДоходах.Результат КАК ОблагаемыйДоход
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		|	
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Период >= &парамНачалоМесяцаПериодаРегистрации И
		|		ЕСНСведенияОДоходах.Период <= &парамКонецМесяцаПериодаРегистрации И
		|		ЕСНСведенияОДоходах.Регистратор = &Регистратор 
		|		И выбор когда ЕСНСведенияОДоходах.Период между &парамНачалоМесяцаПериодаРегистрации  и &парамКонецМесяцаПериодаРегистрации тогда  не ЕСНСведенияОДоходах.Регистратор ссылка Документ.РасчетЕСН иначе истина конец И //О.Т. Аверсон 20.02.2019 № 3195
		|		ЕСНСведенияОДоходах.ОбособленноеПодразделение в (&СписокВсехПодразделенийОрганизации)) КАК ЕСННачисления
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляРасчетаТекст + ") КАК Физлица
		|		ПО ЕСННачисления.ФизЛицо = Физлица.ФизЛицо";
		
	КонецЕсли;
	
	
	Запрос.Текст = ДоходыПоФизлицамМесяцамКодамТекст;
	// ДанныеОбИнвалидности
	// Таблица Данных об Инвалидности: - таблица это список инвалидов и периодов инвалидности
	// поля:
	//		Физлицо, 
	//		Месяц - месяц налогового периода
	// Описание:	
	//	Выбираем Из Список периодов (таблица - список периодов с начала года по текущий период
	//	Внутреннее соединение с СведенияОбИнвалидностиФизлиц.СрезПоследних
	//	по равенству периодов
	//  условие: что физлицо - Инвалид
	// 
	ДанныеОбИнвалидностиТекст = "
	|ВЫБРАТЬ
	//	|	Месяц(Периоды.Период) КАК Месяц,
	|	ВЫБОР КОГДА (СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности = &парамГруппа1 ИЛИ СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности = &парамГруппа2) ТОГДА 1 ИНАЧЕ 0 КОНЕЦ КАК Группа,
	|	СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо
	|ИЗ
	|	(ВЫБРАТЬ
	//	|		Периоды.Период КАК Период,
	|		СведенияОбИнвалидностиФизлиц.Физлицо КАК Физлицо,
	|		МАКСИМУМ(СведенияОбИнвалидностиФизлиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		("+ПериодыТекст+") КАК Периоды
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
	|			ПО Периоды.Период >= СведенияОбИнвалидностиФизлиц.Период
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СведенияОбИнвалидностиФизлиц.Физлицо) КАК Периоды//,
	//	|		Периоды.Период) КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
	|		ПО СведенияОбИнвалидностиФизлиц.Период = Периоды.ПериодРегистра И СведенияОбИнвалидностиФизлиц.Физлицо = Периоды.Физлицо И СведенияОбИнвалидностиФизлиц.Инвалидность
	|";
	Запрос.Текст = ДанныеОбИнвалидностиТекст;
	
	
	// ОблагаемаяБазаПоМесяцам
	// Таблица Баз для исчисления ЕСН по месяцам налогового периода:
	// Поля:
	//		ФизЛицо
	//		Месяц - месяц налогового периода
	//		БазаФедеральныйБюджет         - база для налогообложения ЕСН в части налога в федеральный бюджет
	//		ЛьготаИнвалидуФБ   			  - сумма льготы инвалиду по ЕСН в части налога в федеральный бюджет
	//		БазаФСС                       - база для налогообложения ЕСН в части налога в ФСС
	//		ЛьготаИнвалидуФСС  			  - сумма льготы инвалиду по ЕСН в части налога в ФСС
	//		БазаФОМС					  - база для налогообложения ЕСН в части налогов в ФОМС
	//		ЛьготаИнвалидуФОМС 			  - сумма льготы инвалиду по ЕСН в части налога в ФОМС
	//		БазаПФР			   			  - база для взносов в ПФР (включая доходы, облагаемые ЕНВД)
	//		БазаПФР_ЕНВД			   	  - сумма облагаемых ПФР доходов, подподающих под ЕНВД
	//
	// Описание:
	//	
	// 	1) выбираем из ДоходыПоФизлицамМесяцамКодамТекст
	// 		и суммируем ОблагаемыйДоход для всех составных частей ЕСН. При этом учитывается входимость в базу
	// 		по флажку в справочнике - это База.
	//		Доход, облагаемый ЕНВД, не включаем в базу ЕСН. 
	//		Доход иностранца не включаем в базу ПФР.
	//		Для инвалидов считается база отдельно, но из неё исключаем договора подряда.
	//  2) суммировать ОблагаемыйДоход для всех составных частей ЕСН при входимости в базу и признака инвалидности - это ЛьготаИнвалиду по всем частям ЕСН
	
	
	ОблагаемаяБазаПоМесяцам = "
	|ВЫБРАТЬ
	|	Основная.ФизЛицо,
	|	Основная.Месяц,
	|	ВЫБОР КОГДА НЕ((Инвалид.Физлицо) ЕСТЬ NULL ) ТОГДА Инвалид.Группа ИНАЧЕ 0 КОНЕЦ КАК Группа,
	|	ВЫБОР КОГДА Основная.ДоходФСЗН = &парамПодлежитОбложению ТОГДА Основная.ОблагаемыйДоход ИНАЧЕ 0 КОНЕЦ КАК БазаДоходФСЗН,
	|	ВЫБОР КОГДА Основная.ДоходСтрах = &парамПодлежитОбложению ТОГДА Основная.ОблагаемыйДоход ИНАЧЕ 0 КОНЕЦ КАК БазаДоходСтрах,
	|	ВЫБОР КОГДА Основная.ДоходЕдиныйПлатеж = &парамПодлежитОбложению ТОГДА Основная.ОблагаемыйДоход ИНАЧЕ 0 КОНЕЦ КАК БазаДоходЕдиныйПлатеж
	|ИЗ
	|	("+ДоходыПоФизлицамМесяцамКодамТекст+") КАК Основная
	|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ДанныеОбИнвалидностиТекст+") КАК Инвалид
	|		ПО Инвалид.Физлицо = Основная.ФизЛицо //И Инвалид.Месяц = Основная.Месяц
	|";
	
	Запрос.Текст = ОблагаемаяБазаПоМесяцам;
	ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодР,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер;//О.Т. Аверсон 08.08.2016
	если ПенсФондБудМес = 1 тогда
		ИсчисленныйЕСНТекст = 
		"ВЫБРАТЬ
		|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|	ВЫБОР КОГДА ЕСНИсчисленный.ПроцентФСЗН ЕСТЬ NULL ТОГДА 35 ИНАЧЕ ЕСНИсчисленный.ПроцентФСЗН КОНЕЦ КАК ПроцентФСЗН,
		|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
		|	ВЫБОР КОГДА НЕ((Инвалид.Физлицо) ЕСТЬ NULL ) ТОГДА Инвалид.Группа ИНАЧЕ 0 КОНЕЦ КАК Группа,
		|	ВЫБОР КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
		|			И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
		|		ТОГДА ВЫРАЗИТЬ(ЕСНИсчисленный.ПенсионныйФонд / 10000 КАК ЧИСЛО(10, "+ЗначениеОкругления+"))
		|	ИНАЧЕ ЕСНИсчисленный.ПенсионныйФонд
		|   КОНЕЦ КАК ПенсионныйФонд,//О.Т. Аверсон 08.08.2016 № 
		|	ЕСНИсчисленный.ФСЗН КАК ФСЗН,
		|	ЕСНИсчисленный.ЕдиныйПлатеж КАК ЕдиныйПлатеж,
		|	ЕСНИсчисленный.ОбязательноеСтрахование КАК ОбязательноеСтрахование
		|ИЗ
		|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляРасчетаТекст + ") КАК Физлица
		|		ПО ЕСНИсчисленный.ФизЛицо = Физлица.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ДанныеОбИнвалидностиТекст+") КАК Инвалид
		|		ПО Инвалид.Физлицо = ЕСНИсчисленный.ФизЛицо //И Инвалид.Месяц = ЕСНИсчисленный.ПериодВзаиморасчетов
		|
		|ГДЕ
		|	ЕСНИсчисленный.Организация = &парамГоловнаяОрганизация И
		|	ЕСНИсчисленный.ПериодВзаиморасчетов >= &парамНачалоМесяцаПериодаРегистрации И
		|	ЕСНИсчисленный.ПериодВзаиморасчетов <= &парамКонецМесяцаПериодаРегистрации";
	иначе
		ИсчисленныйЕСНТекст = 
		"ВЫБРАТЬ
		|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|	ВЫБОР КОГДА ЕСНИсчисленный.ПроцентФСЗН ЕСТЬ NULL ТОГДА 35 ИНАЧЕ ЕСНИсчисленный.ПроцентФСЗН КОНЕЦ КАК ПроцентФСЗН,
		|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК Месяц,
		|	ВЫБОР КОГДА НЕ((Инвалид.Физлицо) ЕСТЬ NULL ) ТОГДА Инвалид.Группа ИНАЧЕ 0 КОНЕЦ КАК Группа,
		|	ВЫБОР КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
		|			И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
		|		ТОГДА ВЫРАЗИТЬ(ЕСНИсчисленный.ПенсионныйФонд / 10000 КАК ЧИСЛО(10, "+ЗначениеОкругления+"))
		|	ИНАЧЕ ЕСНИсчисленный.ПенсионныйФонд
		|   КОНЕЦ КАК ПенсионныйФонд,//О.Т. Аверсон 08.08.2016
		|	ЕСНИсчисленный.ФСЗН КАК ФСЗН,
		|	ЕСНИсчисленный.ЕдиныйПлатеж КАК ЕдиныйПлатеж,
		|	ЕСНИсчисленный.ОбязательноеСтрахование КАК ОбязательноеСтрахование
		|ИЗ
		|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляРасчетаТекст + ") КАК Физлица
		|		ПО ЕСНИсчисленный.ФизЛицо = Физлица.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ("+ДанныеОбИнвалидностиТекст+") КАК Инвалид
		|		ПО Инвалид.Физлицо = ЕСНИсчисленный.ФизЛицо //И Инвалид.Месяц = ЕСНИсчисленный.ПериодВзаиморасчетов
		|
		|ГДЕ
		|	ЕСНИсчисленный.Организация = &парамГоловнаяОрганизация И
		|	ЕСНИсчисленный.ПериодВзаиморасчетов >= &парамНачалоМесяцаПериодаРегистрации И //Островская Татьяна 28.04.2014 № 17321
		|	ЕСНИсчисленный.ПериодВзаиморасчетов <= &парамКонецМесяцаПериодаРегистрации";
		
	КонецЕсли;
	
	
	
	ДляИсчисленияЕСНТекст = "
	|ВЫБРАТЬ
	|	НачисленияПФ.ФизЛицо,
	|	НачисленияПФ.Месяц,
	|	НачисленияПФ.Группа,	
	|	СУММА(НачисленияПФ.БазаДоходФСЗН) КАК БазаДоходФСЗН,
	|	СУММА(НачисленияПФ.БазаДоходСтрах) КАК БазаДоходСтрах,
	|	СУММА(НачисленияПФ.БазаДоходЕдиныйПлатеж) КАК БазаДоходЕдиныйПлатеж,
	|	СУММА(НачисленияПФ.ПенсионныйФонд) КАК ПенсионныйФонд,
	|	СУММА(НачисленияПФ.НачисленныйФСЗН) КАК НачисленныйФСЗН,
	|	СУММА(НачисленияПФ.НачисленныйСтрах) КАК НачисленныйСтрах,
	|	СУММА(НачисленияПФ.НачисленныйЕдиныйПлатеж) КАК НачисленныйЕдиныйПлатеж
	|	ИЗ
	|		(ВЫБРАТЬ
	|			БазаДляНачислений.ФизЛицо,
	|			БазаДляНачислений.Месяц,
	|			БазаДляНачислений.Группа,
	|			СУММА(БазаДляНачислений.БазаДоходФСЗН) КАК БазаДоходФСЗН,
	|			СУММА(БазаДляНачислений.БазаДоходСтрах) КАК БазаДоходСтрах,
	|			СУММА(БазаДляНачислений.БазаДоходЕдиныйПлатеж) КАК БазаДоходЕдиныйПлатеж,
	|  			0 КАК ПенсионныйФонд,
	|  			0 КАК НачисленныйФСЗН,
	|   		0 КАК НачисленныйСтрах,
	|   		0 КАК НачисленныйЕдиныйПлатеж
	|		ИЗ
	|			("+ОблагаемаяБазаПоМесяцам+") КАК БазаДляНачислений
	|		СГРУППИРОВАТЬ ПО
	|			БазаДляНачислений.ФизЛицо,
	|			БазаДляНачислений.Месяц,
	|           БазаДляНачислений.Группа
	|
	|  		ОБЪЕДИНИТЬ ВСЕ
	|
	|		ВЫБРАТЬ
	|			Отчсиления.ФизЛицо,
	|			Отчсиления.Месяц,
	|           Отчсиления.Группа,
	|   		0 КАК БазаДоходФСЗН,
	|  			0 КАК БазаДоходСтрах,
	|  			0 КАК БазаДоходЕдиныйПлатеж,
	|			СУММА(Отчсиления.ПенсионныйФонд) КАК ПенсионныйФонд,
	|			СУММА(Отчсиления.ФСЗН) КАК НачисленныйФСЗН,
	|			СУММА(Отчсиления.ОбязательноеСтрахование) КАК НачисленныйСтрах,
	|			СУММА(Отчсиления.ЕдиныйПлатеж) КАК НачисленныйЕдиныйПлатеж
	|		ИЗ
	|			("+ИсчисленныйЕСНТекст+") КАК Отчсиления
	|	
	|		СГРУППИРОВАТЬ ПО
	|			Отчсиления.ФизЛицо,
	|			Отчсиления.Месяц,
	|			Отчсиления.Группа) НачисленияПФ
	|СГРУППИРОВАТЬ ПО
	|	НачисленияПФ.ФизЛицо,
	|	НачисленияПФ.Месяц,
	|	НачисленияПФ.Группа
	|";
	
	
	Запрос.Текст = ДляИсчисленияЕСНТекст;
	
	Возврат Запрос.Выполнить().Выбрать();
	
	
	
КонецФункции  // ПолучитьДанныеРасчетаЕСН



// Процедура рассчитывает проценты и сумму погашения займа
// и заполняет реквизиты табличной части
//
Процедура РассчитатьПогашениеЗаймов(Физлицо = Неопределено) Экспорт 
	
	Запрос = Новый Запрос();
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("парамРегистратор",Ссылка);
	Запрос.УстановитьПараметр("парамВалютаРегламентУчета" , Константы.ВалютаРегламентированногоУчета.Получить());
	Запрос.УстановитьПараметр("парамКонецГода",КонецГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамОрганизация" , Организация);
	Запрос.УстановитьПараметр("НачалоРасчетногоПериода",ПериодНачисленияДатаНачала);
	Запрос.УстановитьПараметр("КонецРасчетногоПериода",КонецДня(ПериодНачисленияДатаОкончания));
	Запрос.УстановитьПараметр("ДнейВГоду",(КонецГода(ПериодРегистрации) + 1 - НачалоГода(ПериодРегистрации)) / 86400);
	Запрос.УстановитьПараметр("СтавкаРезидента", ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛотСтавкиНалогообложенияРезидента(Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка35));
	Запрос.УстановитьПараметр("СтавкаНеРезидента", ПроцедурыУправленияПерсоналом.ЗначениеСтавкиНДФЛСНерезидента());
	Запрос.УстановитьПараметр("парамФизлицо", Физлицо);
	Запрос.УстановитьПараметр("ПоВсемФИзЛИцам", Не ЗначениеЗаполнено(Физлицо));
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Работники.ФизЛицо КАК ФизЛицо,
	|	Работники.ДоговорЗайма КАК ДоговорЗайма,
	|	Работники.НомерСтроки,
	|	Работники.ПодразделениеОрганизации,
	|	Работники.СтавкаНалогообложенияМатвыгоды,
	|	Работники.Сторно,
	|	Работники.НачисленоПроцентов,
	|	Работники.ПогашеноПроцентов,
	|	Работники.ПогашеноЗайма,
	|	Работники.МатериальнаяВыгода,
	|	Работники.НалогНаМатериальнуюВыгоду,
	|	Работники.Ссылка.Организация
	|ПОМЕСТИТЬ ВТСписокФизлицДоговоров
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов КАК Работники
	|ГДЕ
	|	Работники.Ссылка = &парамРегистратор
	|	И (&ПоВсемФИзЛИцам
	|			ИЛИ Работники.ФизЛицо В (&парамФизлицо))
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	ДоговорЗайма";
	Запрос.Выполнить();
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ВсеДанные.ФизЛицо КАК ФизЛицо,
	|	ВсеДанные.Организация,
	|	ВсеДанные.Период,
	|	СУММА(ВсеДанные.ОсновнойДолгКонечныйОстаток) КАК ОсновнойДолгКонечныйОстаток,
	|	СУММА(ВсеДанные.ПроцентыНачальныйОстаток) КАК ПроцентыНачальныйОстаток,
	|	СУММА(ВсеДанные.ПроцентыОборот) КАК ПроцентыОборот,
	|	СУММА(ВсеДанные.ПроцентыПриход) КАК ПроцентыПриход,
	|	СУММА(ВсеДанные.ПроцентыРасход) КАК ПроцентыРасход,
	|	ВсеДанные.ДоговорЗайма КАК ДоговорЗайма,
	|	ВсеДанные.ДоговорЗаймаДата,
	|	ВсеДанные.ДоговорЗаймаПроцентЗаПользованиеЗаймом,
	|	ВсеДанные.ДоговорЗаймаНачислятьМатериальнуюВыгоду,
	|	ВсеДанные.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|	ВсеДанные.ДоговорЗаймаПорядокПогашенияЗайма,
	|	ВсеДанные.ДоговорЗаймаСрокПогашения,
	|	ВсеДанные.ДоговорЗаймаНачалоПогашения,
	|	ВсеДанные.ДоговорЗаймаСуммаЗайма,
	|	ВсеДанные.ДоговорЗаймаВалютаДокумента,
	|	ВсеДанные.ДоговорЗаймаКурсДокумента,
	|	ВсеДанные.ДоговорЗаймаКратностьДокумента
	|ПОМЕСТИТЬ ВТОстаткиИОбороты
	|ИЗ
	|	(ВЫБРАТЬ
	|		ПогашениеЗаймов.ФизЛицо КАК ФизЛицо,
	|		ПогашениеЗаймов.Организация КАК Организация,
	|		ПогашениеЗаймов.Период КАК Период,
	|		ПогашениеЗаймов.ОсновнойДолгКонечныйОстаток КАК ОсновнойДолгКонечныйОстаток,
	|		ПогашениеЗаймов.ПроцентыНачальныйОстаток КАК ПроцентыНачальныйОстаток,
	|		ПогашениеЗаймов.ПроцентыОборот КАК ПроцентыОборот,
	|		ПогашениеЗаймов.ПроцентыПриход КАК ПроцентыПриход,
	|		ПогашениеЗаймов.ПроцентыРасход КАК ПроцентыРасход,
	|		ПогашениеЗаймов.ДоговорЗайма КАК ДоговорЗайма,
	|		ПогашениеЗаймов.ДоговорЗайма.Дата КАК ДоговорЗаймаДата,
	|		ПогашениеЗаймов.ДоговорЗайма.ПроцентЗаПользованиеЗаймом КАК ДоговорЗаймаПроцентЗаПользованиеЗаймом,
	|		ПогашениеЗаймов.ДоговорЗайма.НачислятьМатериальнуюВыгоду КАК ДоговорЗаймаНачислятьМатериальнуюВыгоду,
	|		ПогашениеЗаймов.ДоговорЗайма.СтавкаНалогообложенияРезидента КАК ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|		ПогашениеЗаймов.ДоговорЗайма.ПорядокПогашенияЗайма КАК ДоговорЗаймаПорядокПогашенияЗайма,
	|		ПогашениеЗаймов.ДоговорЗайма.СрокПогашения КАК ДоговорЗаймаСрокПогашения,
	|		ПогашениеЗаймов.ДоговорЗайма.НачалоПогашения КАК ДоговорЗаймаНачалоПогашения,
	|		ПогашениеЗаймов.ДоговорЗайма.СуммаЗайма КАК ДоговорЗаймаСуммаЗайма,
	|		ПогашениеЗаймов.ДоговорЗайма.ВалютаДокумента КАК ДоговорЗаймаВалютаДокумента,
	|		ПогашениеЗаймов.ДоговорЗайма.КурсДокумента КАК ДоговорЗаймаКурсДокумента,
	|		ПогашениеЗаймов.ДоговорЗайма.КратностьДокумента КАК ДоговорЗаймаКратностьДокумента
	|	ИЗ
	|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций.ОстаткиИОбороты(
	|				&НачалоРасчетногоПериода,
	|				&КонецРасчетногоПериода,
	|				День,
	|				ДвиженияИГраницыПериода,
	|				Организация = &парамОрганизация
	|					И ДоговорЗайма В
	|						(ВЫБРАТЬ
	|							СписокДоговоров.ДоговорЗайма
	|						ИЗ
	|							ВТСписокФизлицДоговоров КАК СписокДоговоров)) КАК ПогашениеЗаймов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ПогашениеЗаймов.ФизЛицо,
	|		ПогашениеЗаймов.Организация,
	|		&КонецРасчетногоПериода,
	|		-ПогашениеЗаймов.ПогашеноЗайма + ПогашениеЗаймов.ПогашеноПроцентов,
	|		0,
	|		ПогашениеЗаймов.НачисленоПроцентов - ПогашениеЗаймов.ПогашеноПроцентов,
	|		ПогашениеЗаймов.НачисленоПроцентов,
	|		ПогашениеЗаймов.ПогашеноПроцентов,
	|		ПогашениеЗаймов.ДоговорЗайма,
	|		ПогашениеЗаймов.ДоговорЗайма.Дата,
	|		ПогашениеЗаймов.ДоговорЗайма.ПроцентЗаПользованиеЗаймом,
	|		ПогашениеЗаймов.ДоговорЗайма.НачислятьМатериальнуюВыгоду,
	|		ПогашениеЗаймов.ДоговорЗайма.СтавкаНалогообложенияРезидента,
	|		ПогашениеЗаймов.ДоговорЗайма.ПорядокПогашенияЗайма,
	|		ПогашениеЗаймов.ДоговорЗайма.СрокПогашения,
	|		ПогашениеЗаймов.ДоговорЗайма.НачалоПогашения,
	|		ПогашениеЗаймов.ДоговорЗайма.СуммаЗайма,
	|		ПогашениеЗаймов.ДоговорЗайма.ВалютаДокумента,
	|		ПогашениеЗаймов.ДоговорЗайма.КурсДокумента,
	|		ПогашениеЗаймов.ДоговорЗайма.КратностьДокумента
	|	ИЗ
	|		ВТСписокФизлицДоговоров КАК ПогашениеЗаймов
	|	ГДЕ
	|		ПогашениеЗаймов.Сторно) КАК ВсеДанные
	|
	|СГРУППИРОВАТЬ ПО
	|	ВсеДанные.ФизЛицо,
	|	ВсеДанные.Организация,
	|	ВсеДанные.Период,
	|	ВсеДанные.ДоговорЗайма,
	|	ВсеДанные.ДоговорЗаймаДата,
	|	ВсеДанные.ДоговорЗаймаПроцентЗаПользованиеЗаймом,
	|	ВсеДанные.ДоговорЗаймаНачислятьМатериальнуюВыгоду,
	|	ВсеДанные.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|	ВсеДанные.ДоговорЗаймаПорядокПогашенияЗайма,
	|	ВсеДанные.ДоговорЗаймаСрокПогашения,
	|	ВсеДанные.ДоговорЗаймаНачалоПогашения,
	|	ВсеДанные.ДоговорЗаймаСуммаЗайма,
	|	ВсеДанные.ДоговорЗаймаВалютаДокумента,
	|	ВсеДанные.ДоговорЗаймаКурсДокумента,
	|	ВсеДанные.ДоговорЗаймаКратностьДокумента
	|
	|ИМЕЮЩИЕ
	|	(СУММА(ВсеДанные.ОсновнойДолгКонечныйОстаток) <> 0
	|		ИЛИ СУММА(ВсеДанные.ПроцентыПриход) <> 0
	|		ИЛИ СУММА(ВсеДанные.ПроцентыОборот) <> 0
	|		ИЛИ СУММА(ВсеДанные.ПроцентыНачальныйОстаток) <> 0
	|		ИЛИ СУММА(ВсеДанные.ПроцентыРасход) <> 0)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	ДоговорЗайма";
	Запрос.Выполнить();
	
	// ТаблицаПериодыПогашения
	// Описание
	// 1.из таблицы остатков и оборотов рег-ра ПогашениеЗаймовРаботникамиОрганизаций (выборка ПогашениеЗаймов)
	// выбираются дни, в которые были произведены какие-либо движения по займу - период движений определяет  
	// начало периода погашения (в течение которого остаток долга не изменяется) - поле ДатаС;
	// рассчитывается остаток основного долга на конец месяца (поле ОсновнойДолгНаКонецМесяца)
	// рассчитывается остаток непогашенных процентов на начало месяца (поле ПроцентыНачальныйОстаток)
	// 2.из основной таблицы того же рег-ра присоединяются даты окончания периодов погашения - поле ДатаПО  
	// 3.из договора займа выбираются его параметры: проценты, сумма займа (переведенная в валюту регламентированного учета),
	// флажок исчисления мат.выгоды и пр.
	// 4.из рег-ра сведений о ставке рефинансирования РФ выбираем дату, непосредственно предшествующую дате 
	// получения дохода в виде матвыгоды, т.е. дате начисления процентов или окончанию месяца для беспроцентных
	// займов (до 1.1.2008 - дате Договора займа)
	//
	//
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ПериодыПогашения.ДатаС,
	|	ПериодыПогашения.ДатаПО,
	|	ПериодыПогашения.ФизЛицо КАК ФизЛицо,
	|	ПериодыПогашения.ДоговорЗайма,
	|	ПериодыПогашения.ДоговорЗаймаПроцентЗаПользованиеЗаймом,
	|	ПериодыПогашения.ДоговорЗаймаНачислятьМатериальнуюВыгоду,
	|	ПериодыПогашения.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|	ПериодыПогашения.ПорядокПогашенияЗайма,
	|	ПериодыПогашения.ДоговорЗаймаНачалоПогашения,
	|	ПериодыПогашения.ДоговорЗаймаСрокПогашения,
	|	ПериодыПогашения.СуммаЗайма,
	|	ПериодыПогашения.ОсновнойДолгКонечныйОстаток,
	|	ПериодыПогашения.ОсновнойДолгНаКонецМесяца,
	|	ПериодыПогашения.ПроцентыПриход,
	|	ПериодыПогашения.ПроцентыРасход,
	|	ПериодыПогашения.ПроцентыОборот,
	|	ПериодыПогашения.ПроцентыНачальныйОстаток,
	|	МАКСИМУМ(СтавкаРефинансированияЦБ.Период) КАК ДатаСтавкиРефинансирования
	|ПОМЕСТИТЬ ВТПериодыПогашения
	|ИЗ
	|	(ВЫБРАТЬ
	|		ПогашениеЗаймов.Период КАК ДатаС,
	|		ВЫБОР
	|			КОГДА МИНИМУМ(НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, ДЕНЬ)) > &КонецРасчетногоПериода
	|					ИЛИ МИНИМУМ(НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, ДЕНЬ)) ЕСТЬ NULL 
	|				ТОГДА &КонецРасчетногоПериода
	|			ИНАЧЕ МИНИМУМ(НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, ДЕНЬ))
	|		КОНЕЦ КАК ДатаПО,
	|		ПогашениеЗаймов.ФизЛицо КАК ФизЛицо,
	|		ПогашениеЗаймов.ДоговорЗайма КАК ДоговорЗайма,
	|		ПогашениеЗаймов.ДоговорЗаймаДата КАК ДоговорЗаймаДата,
	|		ПогашениеЗаймов.ДоговорЗаймаПроцентЗаПользованиеЗаймом КАК ДоговорЗаймаПроцентЗаПользованиеЗаймом,
	|		ПогашениеЗаймов.ДоговорЗаймаНачислятьМатериальнуюВыгоду КАК ДоговорЗаймаНачислятьМатериальнуюВыгоду,
	|		ПогашениеЗаймов.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды КАК ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|		ПогашениеЗаймов.ДоговорЗаймаПорядокПогашенияЗайма КАК ПорядокПогашенияЗайма,
	|		ВЫБОР
	|			КОГДА ПогашениеЗаймов.ДоговорЗаймаНачалоПогашения < ПогашениеЗаймов.ДоговорЗаймаДата
	|				ТОГДА ПогашениеЗаймов.ДоговорЗаймаДата
	|			ИНАЧЕ ПогашениеЗаймов.ДоговорЗаймаНачалоПогашения
	|		КОНЕЦ КАК ДоговорЗаймаНачалоПогашения,
	|		ПогашениеЗаймов.ДоговорЗаймаСрокПогашения КАК ДоговорЗаймаСрокПогашения,
	|		ПогашениеЗаймов.ДоговорЗаймаСуммаЗайма * ВЫБОР
	|			КОГДА ПогашениеЗаймов.ДоговорЗаймаВалютаДокумента В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|				ТОГДА 1
	|			ИНАЧЕ ПогашениеЗаймов.ДоговорЗаймаКурсДокумента / ПогашениеЗаймов.ДоговорЗаймаКратностьДокумента
	|		КОНЕЦ КАК СуммаЗайма,
	|		ПогашениеЗаймов.ОсновнойДолгКонечныйОстаток КАК ОсновнойДолгКонечныйОстаток,
	|		ВЫБОР
	|			КОГДА КОНЕЦПЕРИОДА(ПогашениеЗаймов.Период, ДЕНЬ) = &КонецРасчетногоПериода
	|				ТОГДА ПогашениеЗаймов.ОсновнойДолгКонечныйОстаток
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ОсновнойДолгНаКонецМесяца,
	|		ПогашениеЗаймов.ПроцентыПриход КАК ПроцентыПриход,
	|		ПогашениеЗаймов.ПроцентыРасход КАК ПроцентыРасход,
	|		ПогашениеЗаймов.ПроцентыОборот КАК ПроцентыОборот,
	|		ВЫБОР
	|			КОГДА ПогашениеЗаймов.Период = &НачалоРасчетногоПериода
	|				ТОГДА ПогашениеЗаймов.ПроцентыНачальныйОстаток
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ПроцентыНачальныйОстаток
	|	ИЗ
	|		ВТОстаткиИОбороты КАК ПогашениеЗаймов
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОрганизаций
	|			ПО ПогашениеЗаймов.ФизЛицо = ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо
	|				И ПогашениеЗаймов.Организация = ПогашениеЗаймовРаботникамиОрганизаций.Организация
	|				И ПогашениеЗаймов.ДоговорЗайма = ПогашениеЗаймовРаботникамиОрганизаций.ДоговорЗайма
	|				И (ПогашениеЗаймов.Период < НАЧАЛОПЕРИОДА(ПогашениеЗаймовРаботникамиОрганизаций.Период, ДЕНЬ))
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ПогашениеЗаймов.Период,
	|		ПогашениеЗаймов.ФизЛицо,
	|		ПогашениеЗаймов.ПроцентыНачальныйОстаток,
	|		ПогашениеЗаймов.ОсновнойДолгКонечныйОстаток,
	|		ПогашениеЗаймов.ПроцентыПриход,
	|		ПогашениеЗаймов.ДоговорЗайма,
	|		ПогашениеЗаймов.ПроцентыРасход,
	|		ПогашениеЗаймов.ПроцентыОборот,
	|		ПогашениеЗаймов.ДоговорЗаймаДата,
	|		ПогашениеЗаймов.ДоговорЗаймаПроцентЗаПользованиеЗаймом,
	|		ПогашениеЗаймов.ДоговорЗаймаНачислятьМатериальнуюВыгоду,
	|		ПогашениеЗаймов.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|		ПогашениеЗаймов.ДоговорЗаймаПорядокПогашенияЗайма,
	|		ПогашениеЗаймов.ДоговорЗаймаСрокПогашения,
	|		ВЫБОР
	|			КОГДА ПогашениеЗаймов.ДоговорЗаймаНачалоПогашения < ПогашениеЗаймов.ДоговорЗаймаДата
	|				ТОГДА ПогашениеЗаймов.ДоговорЗаймаДата
	|			ИНАЧЕ ПогашениеЗаймов.ДоговорЗаймаНачалоПогашения
	|		КОНЕЦ,
	|		ПогашениеЗаймов.ДоговорЗаймаСуммаЗайма * ВЫБОР
	|			КОГДА ПогашениеЗаймов.ДоговорЗаймаВалютаДокумента В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
	|				ТОГДА 1
	|			ИНАЧЕ ПогашениеЗаймов.ДоговорЗаймаКурсДокумента / ПогашениеЗаймов.ДоговорЗаймаКратностьДокумента
	|		КОНЕЦ) КАК ПериодыПогашения
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкаРефинансированияЦБ КАК СтавкаРефинансированияЦБ
	|		ПО (ВЫБОР
	|				КОГДА ГОД(ПериодыПогашения.ДатаС) < 2008
	|					ТОГДА ПериодыПогашения.ДоговорЗаймаДата
	|				КОГДА ПериодыПогашения.ПроцентыПриход > 0
	|					ТОГДА ПериодыПогашения.ДатаПО
	|				КОГДА ПериодыПогашения.ОсновнойДолгНаКонецМесяца = 0
	|					ТОГДА ПериодыПогашения.ДатаПО
	|				ИНАЧЕ &КонецРасчетногоПериода
	|			КОНЕЦ >= СтавкаРефинансированияЦБ.Период)
	|
	|СГРУППИРОВАТЬ ПО
	|	ПериодыПогашения.ДатаС,
	|	ПериодыПогашения.ДатаПО,
	|	ПериодыПогашения.ФизЛицо,
	|	ПериодыПогашения.ДоговорЗайма,
	|	ПериодыПогашения.ДоговорЗаймаПроцентЗаПользованиеЗаймом,
	|	ПериодыПогашения.ДоговорЗаймаНачислятьМатериальнуюВыгоду,
	|	ПериодыПогашения.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|	ПериодыПогашения.ПорядокПогашенияЗайма,
	|	ПериодыПогашения.ДоговорЗаймаНачалоПогашения,
	|	ПериодыПогашения.ДоговорЗаймаСрокПогашения,
	|	ПериодыПогашения.СуммаЗайма,
	|	ПериодыПогашения.ОсновнойДолгКонечныйОстаток,
	|	ПериодыПогашения.ОсновнойДолгНаКонецМесяца,
	|	ПериодыПогашения.ПроцентыПриход,
	|	ПериодыПогашения.ПроцентыРасход,
	|	ПериодыПогашения.ПроцентыОборот,
	|	ПериодыПогашения.ПроцентыНачальныйОстаток
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо";
	Запрос.Выполнить();
	
	// Основной текст запроса
	// 1. Выборка ДанныеОПогашении
	//  поле ПогашатьЗаймВЭтомМесяце - Определяем, нужно ли погашать займ по условиям договора в текущем месяце
	//  поле ПогашеноЗайма - Рассчитывается сумма займа к погашению: как месячная доля займа или 
	//                       остаток по основному долгу на конец месяца - по условиям договора
	//  поля ПроцентыПриход и ПроцентыРасход - Суммируются начисленные и погашенные проценты по займу за месяц
	//  поле ПроцентыНачальныйОстаток - остаток непогашенных процентов на начало месяца, также будет предложен у погашению
	//  поле НачисленоПроцентов - Рассчитывается сумма процентов к начислению за месяц (по ежедневным 
	//      остаткам основного долга) как сумма по всем периодам из таблицы ПериодыПогашения начисленных по 
	//      следующей формуле процентов: 
	//            %% к начислению за период = кадендарных дней в периоде / кадендарных дней в году * процент по займу
	//  поле ПоСтавкеРефинансирования - Рассчитывается сумма процентов за месяц по ставке рефинансирования ЦБ РФ
	//        на дату Договора займа
	//  поле СтавкаНДФЛ - определяется ставка налогообложения мат.выгоды по займу налогом на доходы физлиц
	// 2. В основной выборке рассчитываются все показатели т.ч. документа
	//  поле НачисленоПроцентов - доначисляются проценты за пользование займом
	//  поле ПогашеноПроцентов - если займ в текущем месяце погашается, предлагается остаток %% с учетом начисленных за месяц
	//  поле ПогашеноЗайма - если займ в текущем месяце погашается, предлагается рассчитанная ранее сумма к 
	//                       погашению основного долга + сумма погашаемых %%
	//  поля МатериальнаяВыгода и НалогНаМатериальнуюВыгоду содержат соответственно сумму дохода и НДФЛ
	//
	
	ТекстОстаткиЗаймов = 
	"ВЫБРАТЬ
	|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ФизЛицо,
	|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ПодразделениеОрганизации,
	|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ДоговорЗайма,
	|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.СтавкаНалогообложенияМатвыгоды,
	|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.НомерСтроки КАК НомерСтроки,
	|	ВЫБОР
	|		КОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.Сторно
	|			ТОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.НачисленоПроцентов
	|		КОГДА ДанныеОПогашении.НачисленоПроцентов > ДанныеОПогашении.ПроцентыПриход
	|			ТОГДА ДанныеОПогашении.НачисленоПроцентов - ДанныеОПогашении.ПроцентыПриход
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НачисленоПроцентов,
	|	ВЫБОР
	|		КОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.Сторно
	|			ТОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ПогашеноПроцентов
	|		КОГДА ДанныеОПогашении.ПогашатьЗаймВЭтомМесяце
	|			ТОГДА ДанныеОПогашении.НачисленоПроцентов + ДанныеОПогашении.ПроцентыНачальныйОстаток - ДанныеОПогашении.ПроцентыРасход
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПогашеноПроцентов,
	|	ВЫБОР
	|		КОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.Сторно
	|			ТОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ПогашеноЗайма
	|		КОГДА ДанныеОПогашении.ПогашатьЗаймВЭтомМесяце
	|			ТОГДА ДанныеОПогашении.ПогашеноЗайма + ДанныеОПогашении.НачисленоПроцентов + ДанныеОПогашении.ПроцентыНачальныйОстаток - ДанныеОПогашении.ПроцентыРасход
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПогашеноЗайма,
	|	ВЫБОР
	|		КОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.Сторно
	|			ТОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.МатериальнаяВыгода
	|		КОГДА ДанныеОПогашении.ПоСтавкеРефинансирования > ДанныеОПогашении.НачисленоПроцентов
	|			ТОГДА ДанныеОПогашении.ПоСтавкеРефинансирования - ДанныеОПогашении.НачисленоПроцентов
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК МатериальнаяВыгода,
	|	ВЫБОР
	|		КОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.Сторно
	|			ТОГДА НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.НалогНаМатериальнуюВыгоду
	|		КОГДА ДанныеОПогашении.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды = ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка35)
	|			ТОГДА ВЫРАЗИТЬ(ВЫБОР
	|						КОГДА ДанныеОПогашении.ПоСтавкеРефинансирования > ДанныеОПогашении.НачисленоПроцентов
	|							ТОГДА ДанныеОПогашении.ПоСтавкеРефинансирования - ДанныеОПогашении.НачисленоПроцентов
	|						ИНАЧЕ 0
	|					КОНЕЦ * ДанныеОПогашении.СтавкаНДФЛ / 100 КАК ЧИСЛО(13, 0))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НалогНаМатериальнуюВыгоду,
	|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.Сторно
	|ИЗ
	|	ВТСписокФизлицДоговоров КАК НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			ПериодыПогашения.ФизЛицо КАК ФизЛицо,
	|			ПериодыПогашения.ДоговорЗайма КАК ДоговорЗайма,
	|			ПериодыПогашения.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды КАК ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|			ВЫБОР
	|				КОГДА ПериодыПогашения.ПорядокПогашенияЗайма = ЗНАЧЕНИЕ(Перечисление.ПорядокПогашенияЗаймаПроцентов.ПоОкончанииСрока)
	|						И &КонецРасчетногоПериода >= ДОБАВИТЬКДАТЕ(ПериодыПогашения.ДоговорЗаймаНачалоПогашения, МЕСЯЦ, ПериодыПогашения.ДоговорЗаймаСрокПогашения)
	|					ТОГДА ИСТИНА
	|				КОГДА ПериодыПогашения.ПорядокПогашенияЗайма <> ЗНАЧЕНИЕ(Перечисление.ПорядокПогашенияЗаймаПроцентов.ПоОкончанииСрока)
	|						И &КонецРасчетногоПериода >= ПериодыПогашения.ДоговорЗаймаНачалоПогашения
	|					ТОГДА ИСТИНА
	|				ИНАЧЕ ЛОЖЬ
	|			КОНЕЦ КАК ПогашатьЗаймВЭтомМесяце,
	|			ВЫБОР
	|				КОГДА ПериодыПогашения.ПорядокПогашенияЗайма = ЗНАЧЕНИЕ(Перечисление.ПорядокПогашенияЗаймаПроцентов.ПоОкончанииСрока)
	|					ТОГДА МАКСИМУМ(ПериодыПогашения.ОсновнойДолгНаКонецМесяца)
	|				КОГДА ПериодыПогашения.СуммаЗайма / ПериодыПогашения.ДоговорЗаймаСрокПогашения > МАКСИМУМ(ПериодыПогашения.ОсновнойДолгНаКонецМесяца)
	|					ТОГДА МАКСИМУМ(ПериодыПогашения.ОсновнойДолгНаКонецМесяца)
	|				ИНАЧЕ ПериодыПогашения.СуммаЗайма / ПериодыПогашения.ДоговорЗаймаСрокПогашения
	|			КОНЕЦ КАК ПогашеноЗайма,
	|			СУММА(ПериодыПогашения.ПроцентыНачальныйОстаток) КАК ПроцентыНачальныйОстаток,
	|			СУММА(ПериодыПогашения.ПроцентыПриход) КАК ПроцентыПриход,
	|			СУММА(ПериодыПогашения.ПроцентыРасход) КАК ПроцентыРасход,
	|			СУММА(ВЫРАЗИТЬ(ПериодыПогашения.ОсновнойДолгКонечныйОстаток * РАЗНОСТЬДАТ(ВЫБОР
	|							КОГДА ПериодыПогашения.ОсновнойДолгКонечныйОстаток > 0
	|									И ПериодыПогашения.ДатаС = &НачалоРасчетногоПериода
	|								ТОГДА ДОБАВИТЬКДАТЕ(ПериодыПогашения.ДатаС, ДЕНЬ, -1)
	|							ИНАЧЕ ПериодыПогашения.ДатаС
	|						КОНЕЦ, ВЫБОР
	|							КОГДА ПериодыПогашения.ДатаПО > &КонецРасчетногоПериода
	|									ИЛИ ПериодыПогашения.ДатаПО ЕСТЬ NULL 
	|								ТОГДА &КонецРасчетногоПериода
	|							ИНАЧЕ ПериодыПогашения.ДатаПО
	|						КОНЕЦ, ДЕНЬ) / &ДнейВГоду * ПериодыПогашения.ДоговорЗаймаПроцентЗаПользованиеЗаймом / 100 КАК ЧИСЛО(15, 2))) КАК НачисленоПроцентов,
	|			СУММА(ВЫБОР
	|					КОГДА ПериодыПогашения.ДоговорЗаймаНачислятьМатериальнуюВыгоду
	|						ТОГДА ВЫРАЗИТЬ(ПериодыПогашения.ОсновнойДолгКонечныйОстаток * РАЗНОСТЬДАТ(ВЫБОР
	|										КОГДА ПериодыПогашения.ОсновнойДолгКонечныйОстаток > 0
	|												И ПериодыПогашения.ДатаС = &НачалоРасчетногоПериода
	|											ТОГДА ДОБАВИТЬКДАТЕ(ПериодыПогашения.ДатаС, ДЕНЬ, -1)
	|										ИНАЧЕ ПериодыПогашения.ДатаС
	|									КОНЕЦ, ВЫБОР
	|										КОГДА ПериодыПогашения.ДатаПО > &КонецРасчетногоПериода
	|												ИЛИ ПериодыПогашения.ДатаПО ЕСТЬ NULL 
	|											ТОГДА &КонецРасчетногоПериода
	|										ИНАЧЕ ПериодыПогашения.ДатаПО
	|									КОНЕЦ, ДЕНЬ) / &ДнейВГоду * СтавкаРефинансированияЦБ.Размер * 3 / 4 / 100 КАК ЧИСЛО(15, 2))
	|					ИНАЧЕ 0
	|				КОНЕЦ) КАК ПоСтавкеРефинансирования,
	|			ВЫБОР
	|				КОГДА ГражданствоФизЛицСрезПоследних.НеЯвляетсяНалоговымРезидентомРФ
	|					ТОГДА &СтавкаНеРезидента
	|				ИНАЧЕ &СтавкаРезидента
	|			КОНЕЦ КАК СтавкаНДФЛ
	|		ИЗ
	|			ВТПериодыПогашения КАК ПериодыПогашения
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкаРефинансированияЦБ КАК СтавкаРефинансированияЦБ
	|				ПО ПериодыПогашения.ДатаСтавкиРефинансирования = СтавкаРефинансированияЦБ.Период
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(
	|						&парамКонецГода,
	|						ФизЛицо В
	|							(ВЫБРАТЬ
	|								СписокФизлиц.ФизЛицо
	|							ИЗ
	|								ВТСписокФизлицДоговоров КАК СписокФизлиц)) КАК ГражданствоФизЛицСрезПоследних
	|				ПО ПериодыПогашения.ФизЛицо = ГражданствоФизЛицСрезПоследних.ФизЛицо
	|		
	|		СГРУППИРОВАТЬ ПО
	|			ПериодыПогашения.ФизЛицо,
	|			ПериодыПогашения.ДоговорЗайма,
	|			ПериодыПогашения.ПорядокПогашенияЗайма,
	|			ПериодыПогашения.ДоговорЗаймаНачалоПогашения,
	|			ПериодыПогашения.ДоговорЗаймаСрокПогашения,
	|			ПериодыПогашения.ДоговорЗаймаСтавкаНалогообложенияМатВыгоды,
	|			ПериодыПогашения.СуммаЗайма,
	|			ГражданствоФизЛицСрезПоследних.НеЯвляетсяНалоговымРезидентомРФ) КАК ДанныеОПогашении
	|		ПО НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ФизЛицо = ДанныеОПогашении.ФизЛицо
	|			И НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ДоговорЗайма = ДанныеОПогашении.ДоговорЗайма
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	Запрос.Текст = ТекстОстаткиЗаймов;
	РезультатЗапроса = Запрос.Выполнить();
	Если ЗначениеЗаполнено(Физлицо) Тогда
		ВыборкаПоСсудам = РезультатЗапроса.Выбрать();
		Пока ВыборкаПоСсудам.Следующий() Цикл
			СтрокаТабличнойЧасти = ПогашениеЗаймов.Получить(ВыборкаПоСсудам.НомерСтроки-1);
			СтрокаТабличнойЧасти.НачисленоПроцентов = ВыборкаПоСсудам.НачисленоПроцентов;
			СтрокаТабличнойЧасти.МатериальнаяВыгода = ВыборкаПоСсудам.МатериальнаяВыгода;
			СтрокаТабличнойЧасти.ПогашеноЗайма	  = ВыборкаПоСсудам.ПогашеноЗайма;
			СтрокаТабличнойЧасти.ПогашеноПроцентов  = ВыборкаПоСсудам.ПогашеноПроцентов;
			СтрокаТабличнойЧасти.НалогНаМатериальнуюВыгоду = ВыборкаПоСсудам.НалогНаМатериальнуюВыгоду;
		КонецЦикла;
	Иначе	
		ПогашениеЗаймов.Загрузить(РезультатЗапроса.Выгрузить());
	КонецЕсли;
	
	//толик
	Для Каждого мСтрока Из ПогашениеЗаймов Цикл
		мСтрока.ПогашеноЗайма = ОбщегоНазначения.ОкруглитьЗначение2016(мСтрока.ПогашеноЗайма, ПериодРегистрации);//О.Т. Аверсон 15.03.2016 № 949
		Если Организация.ИНН = "790016243" Тогда  
			Если мСтрока.ДоговорЗайма.ВалютаДокумента <> Константы.ВалютаРегламентированногоУчета.Получить() Тогда
			СуммаВВалюте =  мСтрока.ДоговорЗайма.СуммаЗайма /мСтрока.ДоговорЗайма.СрокПогашения; 
			Курс = ОбщегоНазначения.ПолучитьКурсВалюты(мСтрока.ДоговорЗайма.ВалютаДокумента, КонецМесяца(ПериодРегистрации)).Курс; 
			мСтрока.ПогашеноЗайма  =  СуммаВВалюте *Курс; 
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

// Процедура рассчитывает ресурсы удержаний и заполняет 
// реквизиты Результат табличной части документа
//
Процедура РассчитатьУдержания(ВыборкаПоШапкеДокумента = Неопределено, ВыборкаПоУдержаниям = Неопределено, Физлицо = Неопределено, КомментироватьРасчет = Ложь) Экспорт
	
	//+ СВЭЙ КДЯ 29.11.19 СВФР-004909
	ФлагРазбиватьУдержанияПоПериодам = ПолучитьФлагРазбиватьУдержанияПоПериодам();
	ТЗ_ПериодыНачислений = СоздатьТаблицуПериодовНачислений();
	//- СВЭЙ КДЯ 29.11.19 СВФР-004909
	
	Отказ = Ложь;
	
	Если Физлицо = Неопределено Тогда
		МассивИндексыСтрокУдержания = Неопределено;
	Иначе
		МассивИндексыСтрокУдержания = Новый Массив();
	КонецЕсли;
	
	ИзмениласьТаблица = Ложь;
	//О.Т. Аверсон 01.09.2017 № Убрана заявка 406 по заявке 980 из-за добавления кода по заявке 859(3 п)
	////О.Т. Аверсон 14.03.2017 № 406
	//ФизЛицоПрошл = "";
	//ВидРасчетаПрошл = "";
	//ТЗУдержания = Новый ТаблицаЗначений;
	//ТЗУдержания.Колонки.Добавить("ФизЛицо");
	//ТЗУдержания.Колонки.Добавить("ВидРасчета");
	//ТЗУдержания.Колонки.Добавить("ДатаНачала");
	//
	//ИзмениласьТаблица = Ложь;
	//Если Физлицо = Неопределено Тогда 
	//	Для Каждого стр из Удержания Цикл
	//		
	//		Если ФизЛицоПрошл <> стр.ФизЛицо или ВидРасчетаПрошл <> стр.ВидРасчета Тогда 
	//			Если стр.ВидРасчета.ЭтоПрофВзносы Тогда 
	//				СтрТЗУдержания = ТЗУдержания.Добавить();
	//				ЗаполнитьЗначенияСвойств(СтрТЗУдержания,стр);	
	//			КонецЕсли;
	//		КонецЕсли;
	//		
	//		ФизЛицоПрошл = стр.ФизЛицо;
	//		ВидРасчетаПрошл = стр.ВидРасчета;  		
	//	КонецЦикла;
	//иначе
	//	мУдержания = Удержания.НайтиСтроки(Новый Структура("ФизЛицо",Физлицо)); 
	//	Для Каждого стр из мУдержания Цикл
	//		
	//		Если ВидРасчетаПрошл <> стр.ВидРасчета Тогда 
	//			Если стр.ВидРасчета.ЭтоПрофВзносы Тогда
	//				СтрТЗУдержания = ТЗУдержания.Добавить();
	//				ЗаполнитьЗначенияСвойств(СтрТЗУдержания,стр);
	//			КонецЕсли;
	//		КонецЕсли;
	//		
	//		ВидРасчетаПрошл = стр.ВидРасчета;  		
	//	КонецЦикла;
	
	//КонецЕсли;
	//
	//Для Каждого стр из ТЗУдержания Цикл 
	//	Запрос = Новый Запрос;
	//	Запрос.Текст = 
	//	"ВЫБРАТЬ
	//	|	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
	//	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало
	//	|ИЗ
	//	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	//	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.БазовыеВидыРасчета КАК УдержанияОрганизацийБазовыеВидыРасчета
	//	|		ПО ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = УдержанияОрганизацийБазовыеВидыРасчета.ВидРасчета
	//	|ГДЕ
	//	|	УдержанияОрганизацийБазовыеВидыРасчета.Ссылка = &ВидРасчета
	//	|	И ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = &ФизЛицо
	//	|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации = &ПериодРегистрации
	//	|	И (НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) > &ПериодРегистрации
	//	|			ИЛИ НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) < &ПериодРегистрации)
	//	|	И ОсновныеНачисленияРаботниковОрганизаций.Регистратор <> &Ссылка";
	//	
	//	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	//	Запрос.УстановитьПараметр("Ссылка", Ссылка);
	//	Запрос.УстановитьПараметр("ВидРасчета", стр.ВидРасчета);  
	//	Запрос.УстановитьПараметр("ФизЛицо", Стр.ФизЛицо);
	//	
	//	РезультатЗапроса = Запрос.Выполнить();  			
	//	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	//	
	//	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
	//		
	//		МассивУдержания = Удержания.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета,ДатаНачала",стр.ФизЛицо,стр.ВидРасчета,стр.ДатаНачала)); 
	//		Если МассивУдержания.Количество() > 0 Тогда 
	//			МассивНовУд = Удержания.НайтиСтроки(Новый Структура("ФизЛицо,ВидРасчета,ДатаНачала",стр.ФизЛицо,стр.ВидРасчета,НачалоМесяца(ВыборкаДетальныеЗаписи.ПериодДействияНачало)));
	//			Если МассивНовУд.Количество() = 0 Тогда 
	//				СтрУдержания = Удержания.Добавить();
	//				ЗаполнитьЗначенияСвойств(СтрУдержания,МассивУдержания[0]);
	//				СтрУдержания.ДатаНачала = НачалоМесяца(ВыборкаДетальныеЗаписи.ПериодДействияНачало);
	//				СтрУдержания.ДатаНачалаСобытия = НачалоМесяца(ВыборкаДетальныеЗаписи.ПериодДействияНачало);
	//				СтрУдержания.ДатаОкончания = КонецМесяца(ВыборкаДетальныеЗаписи.ПериодДействияНачало);
	//				СтрУдержания.Результат = 0;
	//				ИзмениласьТаблица = Истина;
	//			КонецЕсли;
	//		КонецЕсли;
	//		
	//	КонецЦикла;
	//	
	//КонецЦикла;
	//Записать();
	////О.Т. Аверсон 14.03.2017 № 406
	//О.Т. Аверсон 01.09.2017 № Убрана заявка 406 по заявке 980 из-за добавления кода по заявке 859(3 п)
	
	Если ВыборкаПоШапкеДокумента = Неопределено или ИзмениласьТаблица Тогда
		
		// Перечитаем объект и соберем данные для заполнения наборов записей регистров
		НачатьТранзакцию();
		Прочитать();
		ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
		// позиционируем выборку
		ВыборкаПоШапкеДокумента.Следующий();
		ВыборкаПоУдержаниям = СформироватьЗапросПоУдержания(ВыборкаПоШапкеДокумента, Физлицо).Выбрать();
		ЗафиксироватьТранзакцию();
		
	КонецЕсли;
	
	
	НаборУдержания = РегистрыРасчета.УдержанияРаботниковОрганизаций.СоздатьНаборЗаписей();
	НаборУдержания.Отбор.Регистратор.Значение = Ссылка;
	
	НаборНДФЛРасчетыСБюджетом = РегистрыНакопления.НДФЛРасчетыСБюджетом.СоздатьНаборЗаписей();
	НаборНДФЛРасчетыСБюджетом.Отбор.Регистратор.Значение = Ссылка;
	
	//О.Т. Аверсон 24.05.2017 № 665
	НаборЕСНИсчисленный = РегистрыНакопления.ЕСНИсчисленный.СоздатьНаборЗаписей();
	НаборЕСНИсчисленный.Отбор.Регистратор.Значение = Ссылка;
	//О.Т. Аверсон 24.05.2017 № 665
	
	НаборНДФЛИмущественныеВычетыФизлиц = РегистрыНакопления.НДФЛИмущественныеВычетыФизлиц.СоздатьНаборЗаписей();
	НаборНДФЛИмущественныеВычетыФизлиц.Отбор.Регистратор.Значение = Ссылка;
	
	НаборОсновныеНачисления = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.СоздатьНаборЗаписей();
	НаборОсновныеНачисления.Отбор.Регистратор.Значение = Ссылка;
	
	НаборДопНачисления = РегистрыРасчета.ДополнительныеНачисленияРаботниковОрганизаций.СоздатьНаборЗаписей();
	НаборДопНачисления.Отбор.Регистратор.Значение = Ссылка;
	
	// сформируем движения основных начислений по данным табличной части
	ВыборкаПоНачислениям = СформироватьЗапросПоНачисления(ВыборкаПоШапкеДокумента, Физлицо, Истина).Выбрать();
	Пока ВыборкаПоНачислениям.Следующий() Цикл 
		ПроверитьЗаполнениеСтрокиНачисления(ВыборкаПоНачислениям, Отказ);
		Если НЕ Отказ Тогда
			ДобавитьСтрокуОсновныхНачислений(ВыборкаПоНачислениям, ВыборкаПоШапкеДокумента, НаборОсновныеНачисления);
			ДобавитьПериодНачисления( ТЗ_ПериодыНачислений, ВыборкаПоНачислениям ); //+ СВЭЙ КДЯ 29.11.19 СВФР-004909
		КонецЕсли;
	КонецЦикла;
	
	//мСоответствиеДоходовИВычетов = ПроведениеРасчетов.ПолучитьСоответствиеДоходовИВычетов();
	
	ВыборкаПоДоговорам = СформироватьЗапросПоДоговорам(ВыборкаПоШапкеДокумента).Выбрать();
	Пока ВыборкаПоДоговорам.Следующий() Цикл 
		ПроверитьЗаполнениеСтрокиДоговора(ВыборкаПоДоговорам, Отказ);
		Если НЕ Отказ Тогда
			ДобавитьСтрокуДоговора(ВыборкаПоДоговорам, ВыборкаПоШапкеДокумента, НаборДопНачисления);
			ДобавитьПериодНачисления( ТЗ_ПериодыНачислений, ВыборкаПоДоговорам ); //+ СВЭЙ КДЯ 29.11.19 СВФР-004909
		КонецЕсли;
	КонецЦикла;
	
	// сформируем движения дополнительных начислений по данным табличной части
	ВыборкаПоДопНачислениям = СформироватьЗапросПоДопНачисления(ВыборкаПоШапкеДокумента, Физлицо).Выбрать();
	Пока ВыборкаПоДопНачислениям.Следующий() Цикл
		ПроверитьЗаполнениеСтрокиДопНачисления(ВыборкаПоДопНачислениям, Отказ);
		Если НЕ Отказ Тогда
			ДобавитьСтрокуДопНачислений(ВыборкаПоДопНачислениям, ВыборкаПоШапкеДокумента, НаборДопНачисления);
			ДобавитьПериодНачисления( ТЗ_ПериодыНачислений, ВыборкаПоДопНачислениям ); //+ СВЭЙ КДЯ 29.11.19 СВФР-004909
		КонецЕсли;
	КонецЦикла;
	
	//+ СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть: упрощение и оптимизация запросов
	ДополнитьПериодыНачислений( ВыборкаПоШапкеДокумента, ТЗ_ПериодыНачислений );
	//- СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть
	
	//О.Т. Аверсон 24.05.2017 № 665
	ВыборкаПоПенсионномуФонду = СформироватьЗапросПоПенсионномуФонду(ФизЛицо).Выбрать();
	
	Пока ВыборкаПоПенсионномуФонду.Следующий() Цикл
		
		ПроверитьЗаполнениеСтрокиПенсонныйФонд(ВыборкаПоПенсионномуФонду, Отказ);
		
		Если НЕ Отказ Тогда
			// Заполним записи в наборах записей регистров
			ДобавитьСтрокуПенсионныйФонд(ВыборкаПоПенсионномуФонду, ВыборкаПоШапкеДокумента, НаборЕСНИсчисленный, НаборУдержания);
		КонецЕсли;
		
	КонецЦикла;
	//О.Т. Аверсон 24.05.2017 № 665
	
	
	
	// сформируем движения НДФЛ по данным табличной части
	ВыборкаПоНДФЛ = СформироватьЗапросПоНДФЛ(Физлицо).Выбрать();
	Пока ВыборкаПоНДФЛ.Следующий() Цикл 
		// проверим очередную строку табличной части
		ПроверитьЗаполнениеСтрокиНДФЛ(ВыборкаПоНДФЛ, Отказ);
		Если НЕ Отказ Тогда
			ДобавитьСтрокуНДФЛ(ВыборкаПоНДФЛ, ВыборкаПоШапкеДокумента, НаборНДФЛРасчетыСБюджетом,НаборНДФЛИмущественныеВычетыФизлиц);
		КонецЕсли;
	КонецЦикла;
	
	// получим реквизиты табличной части погашения займов
	ВыборкаПоСтрокамДокумента = СформироватьЗапросПоПогашениеЗайма().Выбрать();
	КонецМесяца = КонецМесяца(ПериодРегистрации);
	Пока ВыборкаПоСтрокамДокумента.Следующий() Цикл 
		
		// проверим очередную строку табличной части
		ПроверитьЗаполнениеСтрокиПогашениеЗайма(ВыборкаПоСтрокамДокумента, Отказ, "");
		Если НЕ Отказ Тогда
			// Заполним записи в наборах записей регистров
			Если ВыборкаПоСтрокамДокумента.НалогНаМатериальнуюВыгоду <> 0 Тогда
				Движение = НаборНДФЛРасчетыСБюджетом.Добавить();
				
				// Свойства
				Движение.Период							= КонецМесяца;
				Движение.ВидДвижения					= ВидДвиженияНакопления.Приход;
				
				// Измерения
				Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
				Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
				Движение.МесяцНалоговогоПериода     	= КонецМесяца;
				Движение.СтавкаНалогообложенияРезидента	= ВыборкаПоСтрокамДокумента.СтавкаНалогообложенияМатвыгоды;
				
				// Ресурсы
				Движение.Налог							= ВыборкаПоСтрокамДокумента.НалогНаМатериальнуюВыгоду;
				
				// Реквизиты 
				Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
				Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации;
				Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
				Движение.ИсчисленоИзЗарплаты		= Истина;
				
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	// сформируем движения удержаний по данным табличной части без записи (запись делается процедурой РассчитатьЗаписиРегистраРасчета)
	Пока ВыборкаПоУдержаниям.Следующий() Цикл 
		ПроверитьЗаполнениеСтрокиУдержания(ВыборкаПоУдержаниям, Отказ);
		Если НЕ Отказ Тогда
			ДобавитьСтрокуУдержаний(ВыборкаПоУдержаниям, ВыборкаПоШапкеДокумента, НаборУдержания);
			Если НЕ Физлицо = Неопределено Тогда
				МассивИндексыСтрокУдержания.Добавить(ВыборкаПоУдержаниям.НомерСтроки - 1); 
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	ЗаполнитьПериодыУдержаний( ТЗ_ПериодыНачислений, НаборУдержания, МассивИндексыСтрокУдержания, Физлицо ); //+ СВЭЙ КДЯ 29.11.19 СВФР-004909
	
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	// перед тем как начать расчет, сформированные движения надо записать - 
	// по ним чуть позже будем получать дополнительные данные для расчетов
	Для Каждого Набор Из Движения Цикл
		ПроверяемыйТип = ТипЗнч(Набор);
		Если ПроверяемыйТип = Тип("РегистрРасчетаНаборЗаписей.ОсновныеНачисленияРаботниковОрганизаций") Тогда
			НаборОсновныеНачисления.Записать();
		ИначеЕсли ПроверяемыйТип = Тип("РегистрРасчетаНаборЗаписей.ДополнительныеНачисленияРаботниковОрганизаций") Тогда
			НаборДопНачисления.Записать();
		ИначеЕсли ПроверяемыйТип = Тип("РегистрНакопленияНаборЗаписей.НДФЛРасчетыСБюджетом") Тогда
			НаборНДФЛРасчетыСБюджетом.Записать();
		ИначеЕсли ПроверяемыйТип = Тип("РегистрНакопленияНаборЗаписей.НДФЛИмущественныеВычетыФизлиц") Тогда
			НаборНДФЛРасчетыСБюджетом.Записать();
			//О.Т. Аверсон 24.05.2017 № 665
		ИначеЕсли ПроверяемыйТип = Тип("РегистрНакопленияНаборЗаписей.ЕСНИсчисленный") Тогда
			НаборЕСНИсчисленный.Записать();
			//О.Т. Аверсон 24.05.2017 № 665
		КонецЕсли;
	КонецЦикла;
	
	// удержания - в последнюю очередь
	ПроведениеРасчетов.РассчитатьЗаписиРегистраРасчета("УдержанияРаботниковОрганизаций", НаборУдержания, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение, Удержания, , , , , , МассивИндексыСтрокУдержания, Физлицо, КомментироватьРасчет);
	
	// Удаляем движения
	Для Каждого Набор Из Движения Цикл
		ПроверяемыйТип = ТипЗнч(Набор);
		Если ПроверяемыйТип = Тип("РегистрРасчетаНаборЗаписей.ОсновныеНачисленияРаботниковОрганизаций") Тогда
			НаборОсновныеНачисления.Очистить();
			НаборОсновныеНачисления.Записать();
		ИначеЕсли ПроверяемыйТип = Тип("РегистрРасчетаНаборЗаписей.ДополнительныеНачисленияРаботниковОрганизаций") Тогда
			НаборДопНачисления.Очистить();
			НаборДопНачисления.Записать();
		ИначеЕсли ПроверяемыйТип = Тип("РегистрНакопленияНаборЗаписей.НДФЛРасчетыСБюджетом") Тогда
			НаборНДФЛРасчетыСБюджетом.Очистить();
			НаборНДФЛРасчетыСБюджетом.Записать();
		ИначеЕсли ПроверяемыйТип = Тип("РегистрНакопленияНаборЗаписей.НДФЛИмущественныеВычетыФизлиц") Тогда
			НаборНДФЛРасчетыСБюджетом.Очистить();
			НаборНДФЛРасчетыСБюджетом.Записать();
			//О.Т. Аверсон 24.05.2017 № 665
		ИначеЕсли ПроверяемыйТип = Тип("РегистрНакопленияНаборЗаписей.ЕСНИсчисленный") Тогда
			НаборЕСНИсчисленный.Очистить();
			НаборЕСНИсчисленный.Записать();
			//О.Т. Аверсон 24.05.2017 № 665
		КонецЕсли;
	КонецЦикла;
	НаборУдержания.Очистить();
	НаборУдержания.Записать();
	Удержания.Сортировать("ФизЛицо,ДатаНачала");//О.Т. Аверсон 30.03.2017 № 406
	
КонецПроцедуры // РассчитатьУдержания()

// Процедура рассчитывает ресурсы всех наборов записей и заполняет 
// реквизиты Результат всех табличных частей документа
//
Процедура РассчитатьВсе(ТЧДоговора = Ложь,Физлицо = Неопределено, КомментироватьРасчет = Ложь, ТолькоВсеУдержания = Ложь) Экспорт //Аверсон 12.08.2021 КВВ СВФР-007868 (ТолькоВсеУдержания)
	
	// Перечитаем объект и соберем данные для заполнения наборов записей регистров
	Если КомментироватьРасчет Тогда
		// удаление промежуточных движений выполняется не так как при "нормальном" расчете
		НачатьТранзакцию();
		Прочитать();
		ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
		ВыборкаПоШапкеДокумента.Следующий();
		ВыборкаПоНачислениям = СформироватьЗапросПоНачисления(ВыборкаПоШапкеДокумента, Физлицо, Ложь).Выбрать();
		ВыборкаПоДопНачислениям = СформироватьЗапросПоДопНачисления(ВыборкаПоШапкеДокумента, Физлицо).Выбрать();
		ВыборкаПоУдержаниям = СформироватьЗапросПоУдержания(ВыборкаПоШапкеДокумента, Физлицо).Выбрать();
		
		НачисленияРассчитаны = РассчитатьНачисления(ВыборкаПоШапкеДокумента, ВыборкаПоНачислениям, ВыборкаПоДопНачислениям, Физлицо, КомментироватьРасчет);
		Если НачисленияРассчитаны Тогда
			Записать(); // для расчета НДФЛ нужно записать результаты расчета начислений
			РассчитатьПогашениеЗаймов(Физлицо);
			РассчитатьПенсионныйФонд(Физлицо, КомментироватьРасчет); 
			РассчитатьНДФЛ(Физлицо, КомментироватьРасчет);
			Записать(); // для расчета удержаний нужно записать результаты расчета НДФЛ
			РассчитатьУдержания(ВыборкаПоШапкеДокумента, ВыборкаПоУдержаниям, Физлицо, КомментироватьРасчет);
		КонецЕсли;
		
		// Удаляем движения по начислениям - ранее они не удалялисьь для комментирования 
		// расчета НДФЛ и удержаний
		Для Каждого Набор Из Движения Цикл
			Если ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.ОсновныеНачисленияРаботниковОрганизаций") 
				или ТипЗнч(Набор)=Тип("РегистрРасчетаНаборЗаписей.ДополнительныеНачисленияРаботниковОрганизаций") Тогда
				
				// Удаляем движения
				Набор.Очистить();
				Набор.Записать();
			КонецЕсли;
		КонецЦикла;
		ЗафиксироватьТранзакцию();
		
	Иначе
		НачатьТранзакцию();
		Прочитать();
		ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
		ВыборкаПоШапкеДокумента.Следующий();
		Если НЕ ТолькоВсеУдержания Тогда  //Аверсон 12.08.2021 КВВ СВФР-007868
			ВыборкаПоНачислениям = СформироватьЗапросПоНачисления(ВыборкаПоШапкеДокумента, Физлицо, Ложь).Выбрать();
			ВыборкаПоДопНачислениям = СформироватьЗапросПоДопНачисления(ВыборкаПоШапкеДокумента, Физлицо).Выбрать();
		КонецЕсли;
		ВыборкаПоУдержаниям = СформироватьЗапросПоУдержания(ВыборкаПоШапкеДокумента, Физлицо).Выбрать();
		ЗафиксироватьТранзакцию();
		
		Если НЕ ТолькоВсеУдержания Тогда   //Аверсон 12.08.2021 КВВ СВФР-007868
			НачисленияРассчитаны = РассчитатьНачисления(ВыборкаПоШапкеДокумента, ВыборкаПоНачислениям, ВыборкаПоДопНачислениям,Физлицо);
		КонецЕсли;
		
		//Аверсон 12.08.2021 КВВ СВФР-007868 (
		Если ТолькоВсеУдержания Тогда
			НачисленияРассчитаны = Истина;
		КонецЕсли;
		//Аверсон 12.08.2021 КВВ СВФР-007868 )
		
		Если НачисленияРассчитаны Тогда
			Записать(); // для расчета НДФЛ нужно записать результаты расчета начислений
			РассчитатьПогашениеЗаймов(Физлицо);
			РассчитатьПенсионныйФонд(Физлицо);
			РассчитатьНДФЛ(Физлицо);
			Записать(); // для расчета удержаний нужно записать результаты расчета НДФЛ
			РассчитатьУдержания(ВыборкаПоШапкеДокумента, ВыборкаПоУдержаниям, Физлицо);
		КонецЕсли;
	КонецЕсли;
	
	Если НЕ ТолькоВсеУдержания Тогда   //Аверсон 12.08.2021 КВВ СВФР-007868
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.РасчетОтОбратного
		|ИЗ
		|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
		|ГДЕ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
		
		Запрос.УстановитьПараметр("Организация", Организация);
		
		РезультатЗапроса = Запрос.Выполнить().Выбрать();
		Пока РезультатЗапроса.Следующий() Цикл
			Если РезультатЗапроса.РасчетОтОбратного Тогда 
				ПолучитьНачисленияРасчетногоЛистка(ТЧДоговора,Физлицо);
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;
	
	
КонецПроцедуры // Рассчитать()

Процедура ПолучитьНачисленияРасчетногоЛистка(ТЧДоговора = Ложь,Физлицо = Неопределено)
	ТаблицаФизЛица = Новый ТаблицаЗначений;
	ТаблицаФизЛица.Колонки.Добавить("ФизЛицо");
	Если Физлицо = Неопределено Тогда //О.Т. Аверсон 18.11.2016 № 41
		Для Каждого стрОсн из Начисления Цикл 
			Если ТаблицаФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.Физлицо)).Количество()=0 Тогда 
				СтрТаблицаФизЛица = ТаблицаФизЛица.Добавить();
				СтрТаблицаФизЛица.ФизЛицо = стрОсн.ФизЛицо;
			КонецЕсли; 		
		КонецЦикла;
		Для Каждого стрОсн из ДополнительныеНачисления Цикл 
			Если ТаблицаФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.Физлицо)).Количество()=0 Тогда 
				СтрТаблицаФизЛица = ТаблицаФизЛица.Добавить();
				СтрТаблицаФизЛица.ФизЛицо = стрОсн.ФизЛицо;
			КонецЕсли; 		
		КонецЦикла;
		Для Каждого стрОсн из НДФЛ Цикл 
			Если ТаблицаФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.Физлицо)).Количество()=0 Тогда 
				СтрТаблицаФизЛица = ТаблицаФизЛица.Добавить();
				СтрТаблицаФизЛица.ФизЛицо = стрОсн.ФизЛицо;
			КонецЕсли; 		
		КонецЦикла;
		Для Каждого стрОсн из ПенсионныйФонд Цикл 
			Если ТаблицаФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.Физлицо)).Количество()=0 Тогда 
				СтрТаблицаФизЛица = ТаблицаФизЛица.Добавить();
				СтрТаблицаФизЛица.ФизЛицо = стрОсн.ФизЛицо;
			КонецЕсли; 		
		КонецЦикла;
		Для Каждого стрОсн из ПогашениеЗаймов Цикл 
			Если ТаблицаФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.Физлицо)).Количество()=0 Тогда 
				СтрТаблицаФизЛица = ТаблицаФизЛица.Добавить();
				СтрТаблицаФизЛица.ФизЛицо = стрОсн.ФизЛицо;
			КонецЕсли; 		
		КонецЦикла;
		Для Каждого стрОсн из Удержания Цикл 
			Если ТаблицаФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.Физлицо)).Количество()=0 Тогда 
				СтрТаблицаФизЛица = ТаблицаФизЛица.Добавить();
				СтрТаблицаФизЛица.ФизЛицо = стрОсн.ФизЛицо;
			КонецЕсли; 		
		КонецЦикла;
		Для Каждого стрОсн из ДоговорыНаВыполнениеРабот Цикл 
			Если ТаблицаФизЛица.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.Физлицо)).Количество()=0 Тогда 
				СтрТаблицаФизЛица = ТаблицаФизЛица.Добавить();
				СтрТаблицаФизЛица.ФизЛицо = стрОсн.ФизЛицо;
			КонецЕсли; 		
		КонецЦикла;
	иначе
		СтрТаблицаФизЛица = ТаблицаФизЛица.Добавить();
		СтрТаблицаФизЛица.ФизЛицо = ФизЛицо;
		
	КонецЕсли;
	Для Каждого стрОсн из ТаблицаФизЛица Цикл 
		
		//О.Т. Аверсон 07.12.2016 № 78
		УчетнаяПолитикаЗапрос = Новый Запрос;
		УчетнаяПолитикаЗапрос.Текст = 
		"ВЫБРАТЬ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.РасчетОтОбратного,
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.ВалютныеОклады
		|ИЗ
		|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
		|ГДЕ
		|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
		УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",Организация);
		УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
		ВыборкаПоФлагуРублиЧ = Ложь;
		если УчетнаяПолитика.Количество()>0 Тогда 
			Если УчетнаяПолитика[0].РасчетОтОбратного или УчетнаяПолитика[0].ВалютныеОклады Тогда 
				ВыборкаПоФлагуРублиЧ = Истина;
			КонецЕсли;   		
		КонецЕсли;
		//О.Т. Аверсон 07.12.2016 № 78
		
		
		РезНачисления = 0;
		РезУдержания = 0;
		РезНачВходитФСЗН = 0;
		ВходитДляРублейЧ = Ложь;
		ЗапросНачУд = Новый Запрос;
		ЗапросНачУд.Текст = 
		"ВЫБРАТЬ
		|	ОсновныеНачисленияРаботниковОрганизации.Результат КАК Начисления,
		|	ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ДляРублейЧ как ДляРублейЧ,
		|	ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН как ВходитВБазуФСЗН,
		|	ОсновныеНачисленияРаботниковОрганизации.ВидРасчета как ВидРасчета,
		|	NULL КАК Удержания
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
		|ГДЕ
		|	ОсновныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	И ОсновныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение = &Организация
		|	И ОсновныеНачисленияРаботниковОрганизации.ФизЛицо = &Работник
		|	И ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ) = ЛОЖЬ
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДополнительныеНачисленияРаботниковОрганизации.Результат,
		|	ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ДляРублейЧ,
		|	ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН,
		|	ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета,
		|	NULL
		|ИЗ
		|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизации
		|ГДЕ
		|	ДополнительныеНачисленияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	И ДополнительныеНачисленияРаботниковОрганизации.ОбособленноеПодразделение = &Организация
		|	И ДополнительныеНачисленияРаботниковОрганизации.ФизЛицо = &Работник
		|	И ЕСТЬNULL(ДополнительныеНачисленияРаботниковОрганизации.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ) = ЛОЖЬ
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	СУММА(НДФЛСведенияОДоходах.СуммаДохода),
		|	Истина,
		|	Истина,
		|	NULL,
		|	NULL
		|ИЗ
		|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
		|ГДЕ
		|	НДФЛСведенияОДоходах.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	И НДФЛСведенияОДоходах.КодДохода В(&КодыМатвыгоды)
		|	И НДФЛСведенияОДоходах.ИсчисленоИзЗарплаты
		|	И НДФЛСведенияОДоходах.ОбособленноеПодразделение = &Организация
		|	И НДФЛСведенияОДоходах.ФизЛицо = &Работник
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	УдержанияРаботниковОрганизации.ВидРасчета.ДляРублейЧ,
		|	Истина,
		|	УдержанияРаботниковОрганизации.ВидРасчета,
		|	УдержанияРаботниковОрганизации.Результат
		|ИЗ
		|	РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
		|ГДЕ
		|	УдержанияРаботниковОрганизации.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	И УдержанияРаботниковОрганизации.ОбособленноеПодразделение = &Организация
		|	И УдержанияРаботниковОрганизации.ФизЛицо = &Работник
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	Истина,
		|	Истина,
		|	NULL,
		|	СУММА(ЕСНИсчисленный.ПенсионныйФонд)
		|ИЗ
		|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|ГДЕ
		|	ЕСНИсчисленный.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	И ЕСНИсчисленный.ОбособленноеПодразделение = &Организация
		|	И ЕСНИсчисленный.ФизЛицо = &Работник
		|	И ЕСНИсчисленный.ПенсионныйФонд <> 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	Истина,
		|	Истина,
		|	NULL,
		|	СУММА(НДФЛРасчетыСБюджетом.Налог)
		|ИЗ
		|	РегистрНакопления.НДФЛРасчетыСБюджетом КАК НДФЛРасчетыСБюджетом
		|ГДЕ
		|	НДФЛРасчетыСБюджетом.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.НДФЛРасчетыСБюджетомВидСтроки.Начисление)
		|	И НДФЛРасчетыСБюджетом.ИсчисленоИзЗарплаты
		|	И НДФЛРасчетыСБюджетом.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	И НДФЛРасчетыСБюджетом.ОбособленноеПодразделение = &Организация
		|	И НДФЛРасчетыСБюджетом.ФизЛицо = &Работник
		|
		|СГРУППИРОВАТЬ ПО
		|	НДФЛРасчетыСБюджетом.СтавкаНалогообложенияРезидента
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	Истина,
		|	Истина,
		|	NULL,
		|	СУММА(ПогашениеЗаймовРаботникамиОрганизаций.ОсновнойДолг + ПогашениеЗаймовРаботникамиОрганизаций.Проценты)
		|ИЗ
		|	РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОрганизаций
		|ГДЕ
		|	ПогашениеЗаймовРаботникамиОрганизаций.ВидДвижения = &Расход
		|	И ПогашениеЗаймовРаботникамиОрганизаций.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	И ПогашениеЗаймовРаботникамиОрганизаций.УдержаноИзЗарплаты
		|	И ПогашениеЗаймовРаботникамиОрганизаций.Организация = &Организация
		|	И ПогашениеЗаймовРаботникамиОрганизаций.ФизЛицо = &Работник
		|
		|СГРУППИРОВАТЬ ПО
		|	ПогашениеЗаймовРаботникамиОрганизаций.ДоговорЗайма
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	Истина,
		|	Истина,
		|	NULL,
		|	СУММА(Взаиморасчеты.СуммаВзаиморасчетов)
		|ИЗ
		|	РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		|ГДЕ
		|	Взаиморасчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		|	И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		|	И Взаиморасчеты.Организация = &Организация
		|	И Взаиморасчеты.Физлицо = &Работник
		|	И Взаиморасчеты.ХарактерВыплаты = Значение(Перечисление.ХарактерВыплатыЗарплаты.Отпускные)";
		//|
		//|ОБЪЕДИНИТЬ ВСЕ
		//|
		//|ВЫБРАТЬ
		//|	NULL,
		//|	СУММА(Взаиморасчеты.СуммаВзаиморасчетов)
		//|ИЗ
		//|	РегистрНакопления.ВзаиморасчетыСРаботникамиОрганизаций КАК Взаиморасчеты
		//|ГДЕ
		//|	Взаиморасчеты.ВидДвижения = &Расход
		//|	И Взаиморасчеты.СуммаВзаиморасчетов <> 0
		//|	И Взаиморасчеты.Период МЕЖДУ &ПериодРегистрации И &КонецПериодаРегистрации
		//|	И Взаиморасчеты.Организация = &Организация
		//|	И Взаиморасчеты.Физлицо = &Работник";
		МассивКодыМатвыгоды = Новый Массив;
		МассивКодыМатвыгоды.Добавить(Справочники.ДоходыНДФЛ.Код99998проценты);
		МассивКодыМатвыгоды.Добавить(Справочники.ДоходыНДФЛ.Код99999товары);
		ЗапросНачУд.УстановитьПараметр("КодыМатвыгоды", МассивКодыМатвыгоды);
		
		ЗапросНачУд.УстановитьПараметр("КонецПериодаРегистрации", КонецМесяца(ПериодРегистрации));
		ЗапросНачУд.УстановитьПараметр("Организация", Организация);
		ЗапросНачУд.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
		ЗапросНачУд.УстановитьПараметр("Работник", стрОсн.ФизЛицо);
		ЗапросНачУд.УстановитьПараметр("Расход", ВидДвиженияНакопления.Расход);
		
		РезультатНачУд = ЗапросНачУд.Выполнить().Выбрать();
		Пока РезультатНачУд.Следующий() Цикл 
			Если ВыборкаПоФлагуРублиЧ Тогда //О.Т. Аверсон 07.12.2016 № 78
				Если РезультатНачУд.ДляРублейЧ Тогда //О.Т. Аверсон 07.12.2016 № 78
					РезНачисления = РезНачисления + ?(ЗначениеЗаполнено(РезультатНачУд.Начисления),РезультатНачУд.Начисления,0);
					Если РезультатНачУд.ВидРасчета <> Null Тогда
						ВходитДляРублейЧ = Истина;
					КонецЕсли;
				КонецЕсли;
				
				//Аверсон ЕАЕ 28.08.2025 СВФР-016564
				//Если РезультатНачУд.ВходитВБазуФСЗН Тогда //О.Т. Аверсон 07.12.2016 № 78
				Если РезультатНачУд.ВходитВБазуФСЗН = Истина Тогда
				//Аверсон СВФР-016564
				
					РезНачВходитФСЗН = РезНачВходитФСЗН + ?(ЗначениеЗаполнено(РезультатНачУд.Начисления),РезультатНачУд.Начисления,0);
				КонецЕсли;
			иначе
				РезНачисления = РезНачисления + ?(ЗначениеЗаполнено(РезультатНачУд.Начисления),РезультатНачУд.Начисления,0);
				ВходитДляРублейЧ = Истина;
			КонецЕсли;
			
			Если ВыборкаПоФлагуРублиЧ Тогда //О.Т. Аверсон 07.12.2016 № 78
				Если РезультатНачУд.ДляРублейЧ Тогда //О.Т. Аверсон 07.12.2016 № 78
					РезУдержания = РезУдержания + ?(ЗначениеЗаполнено(РезультатНачУд.Удержания),РезультатНачУд.Удержания,0);
					Если РезультатНачУд.ВидРасчета <> Null Тогда 
						ВходитДляРублейЧ = Истина;
					КонецЕсли;
				КонецЕсли; 
			иначе
				РезУдержания = РезУдержания + ?(ЗначениеЗаполнено(РезультатНачУд.Удержания),РезультатНачУд.Удержания,0);
				ВходитДляРублейЧ = Истина;
			КонецЕсли;
			
		КонецЦикла;
		
		
		Запрос = Новый Запрос();
		Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		Запрос.УстановитьПараметр("парамФизЛицо", стрОсн.Физлицо);
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ОсновныеНачисления.Сотрудник,
		|	ОсновныеНачисления.ВидРасчета,
		//|	ОсновныеНачисления.ВидРасчета.ДляРублейЧ КАК ДляРублейЧ,
		|	ОсновныеНачисления.ДатаНачала,
		|	ОсновныеНачисления.ДатаОкончания,
		|	ОсновныеНачисления.Результат,
		|	ОсновныеНачисления.ОтработаноДней,
		|	ОсновныеНачисления.ОтработаноЧасов,
		|	ОсновныеНачисления.ОплаченоДнейЧасов
		|ПОМЕСТИТЬ ВТ_ОсновныеНачисления
		|ИЗ
		|	&ОсновныеНачисления КАК ОсновныеНачисления
		|ГДЕ
		|	ОсновныеНачисления.Физлицо = &парамФизЛицо";
		
		Запрос.УстановитьПараметр("ОсновныеНачисления", Начисления);
		Запрос.Текст = ТекстЗапроса;
		Запрос.Выполнить();
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ДополнительныеНачисления.Сотрудник,
		|	ДополнительныеНачисления.ВидРасчета,
		//|	ДополнительныеНачисления.ВидРасчета.ДляРублейЧ КАК ДляРублейЧ,
		|	ДополнительныеНачисления.ДатаНачала,
		|	ДополнительныеНачисления.ДатаОкончания,
		|	ДополнительныеНачисления.Результат,
		|	ДополнительныеНачисления.ОплаченоДнейЧасов
		|ПОМЕСТИТЬ ВТ_ДополнительныеНачисления
		|ИЗ
		|	&ДополнительныеНачисления КАК ДополнительныеНачисления
		|ГДЕ
		|	ДополнительныеНачисления.Физлицо = &парамФизЛицо";
		
		Запрос.УстановитьПараметр("ДополнительныеНачисления", ДополнительныеНачисления);
		Запрос.Текст = ТекстЗапроса;
		Запрос.Выполнить();
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ДоговорыНаВыполнениеРабот.Сотрудник,
		|	ДоговорыНаВыполнениеРабот.ВидРасчета,
		//	|	ДоговорыНаВыполнениеРабот.ВидРасчета.ДляРублейЧ КАК ДляРублейЧ,
		|	ДоговорыНаВыполнениеРабот.ДатаНачала,
		|	ДоговорыНаВыполнениеРабот.ДатаОкончания,
		|	ДоговорыНаВыполнениеРабот.Результат
		|ПОМЕСТИТЬ ВТ_ДоговорыНаВыполнениеРабот
		|ИЗ
		|	&ДоговорыНаВыполнениеРабот КАК ДоговорыНаВыполнениеРабот
		|ГДЕ
		|	ДоговорыНаВыполнениеРабот.Физлицо = &парамФизЛицо";
		
		Запрос.УстановитьПараметр("ДоговорыНаВыполнениеРабот", ДоговорыНаВыполнениеРабот);
		Запрос.Текст = ТекстЗапроса;
		Запрос.Выполнить();
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	Удержания.Физлицо,
		|	Удержания.ВидРасчета,
		//	|	Удержания.ВидРасчета.ДляРублейЧ КАК ДляРублейЧ,
		|	Удержания.ДатаНачала,
		|	Удержания.ДатаОкончания,
		|	Удержания.Результат
		|ПОМЕСТИТЬ ВТ_Удержания
		|ИЗ
		|	&Удержания КАК Удержания
		|ГДЕ
		|	Удержания.Физлицо = &парамФизЛицо";
		
		Запрос.УстановитьПараметр("Удержания", Удержания);
		Запрос.Текст = ТекстЗапроса;
		Запрос.Выполнить();
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ПенсионныйФонд.Физлицо,
		|	ПенсионныйФонд.Налог,
		|	ПенсионныйФонд.МесяцНалоговогоПериода
		|ПОМЕСТИТЬ ВТ_ПенсионныйФонд
		|ИЗ
		|	&ПенсионныйФонд КАК ПенсионныйФонд
		|ГДЕ
		|	ПенсионныйФонд.Физлицо = &парамФизЛицо";
		
		Запрос.УстановитьПараметр("ПенсионныйФонд", ПенсионныйФонд);
		Запрос.Текст = ТекстЗапроса;
		Запрос.Выполнить();
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	НДФЛ.Физлицо,
		|	НДФЛ.Налог + НДФЛ.НалогПоСтавке35 КАК Налог,
		|	НДФЛ.МесяцНалоговогоПериода
		|ПОМЕСТИТЬ ВТ_НДФЛ
		|ИЗ
		|	&НДФЛ КАК НДФЛ
		|ГДЕ
		|	НДФЛ.Физлицо = &парамФизЛицо";
		
		Запрос.УстановитьПараметр("НДФЛ", НДФЛ);
		Запрос.Текст = ТекстЗапроса;
		Запрос.Выполнить();
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ПогашениеЗаймов.Физлицо,
		|	ПогашениеЗаймов.ПогашеноЗайма,
		|	ПогашениеЗаймов.МатериальнаяВыгода,
		|	ПогашениеЗаймов.НалогНаМатериальнуюВыгоду,
		|	ПогашениеЗаймов.СтавкаНалогообложенияМатвыгоды
		|ПОМЕСТИТЬ ВТ_ПогашениеЗаймов
		|ИЗ
		|	&ПогашениеЗаймов КАК ПогашениеЗаймов
		|ГДЕ
		|	ПогашениеЗаймов.Физлицо = &парамФизЛицо";
		
		Запрос.УстановитьПараметр("ПогашениеЗаймов", ПогашениеЗаймов);
		Запрос.Текст = ТекстЗапроса;
		Запрос.Выполнить();
		
		
		ТекстЗапросаНачисления = 
		"ВЫБРАТЬ
		|	""Начисления"" КАК Таблица,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник КАК Сотрудник,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ДляРублейЧ как ДляРублейЧ,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН как ВходитВБазуФСЗН,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.Наименование, ""<не указано>"") КАК ВидРасчетаНаименование,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.Код, ""Я"") КАК ВидРасчетаКод,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ) КАК ЯвляетсяДоходомВНатуральнойФорме,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.СпособРасчета КАК ВидРасчетаСпособРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ВидВремени,
		|	ВЫБОР
		|		КОГДА НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|			ТОГДА "" (по внутр. совмест-ву)""
		|		ИНАЧЕ """"
		|	КОНЕЦ КАК ВидЗанятости,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаОкончания,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийНачисления.Результат) КАК Результат,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ОтработаноДней) КАК ОтработаноДней,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ОтработаноЧасов) КАК ОтработаноЧасов,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийНачисления.ОплаченоДнейЧасов) КАК ОплаченоДнейЧасов,
		|	NULL КАК МесяцНалоговогоПериода,
		|	NULL КАК ПогашеноЗайма,
		|	NULL КАК МатериальнаяВыгода,
		|	NULL КАК НалогНаМатериальнуюВыгоду,
		|	NULL КАК СтавкаНалогообложенияМатвыгоды
		|ИЗ
		|	ВТ_ОсновныеНачисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
		|ГДЕ
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ) = ЛОЖЬ
		|
		|СГРУППИРОВАТЬ ПО
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ДляРублейЧ,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаОкончания,
		|	ВЫБОР
		|		КОГДА НачислениеЗарплатыРаботникамОрганизацийНачисления.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|			ТОГДА "" (по внутр. совмест-ву)""
		|		ИНАЧЕ """"
		|	КОНЕЦ,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.СпособРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ВидВремени,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.Наименование, ""<не указано>""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.Код, ""Я""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""ДополнительныеНачисления"",
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.ДляРублейЧ,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.Наименование, ""<не указано>""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.Код, ""Я""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ),
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.СпособРасчета,
		|	NULL,
		|	ВЫБОР
		|		КОГДА НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|			ТОГДА "" (по внутр. совмест-ву)""
		|		ИНАЧЕ """"
		|	КОНЕЦ,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ДатаОкончания,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Результат),
		|	0,
		|	0,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ОплаченоДнейЧасов),
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL
		|ИЗ
		|	ВТ_ДополнительныеНачисления КАК НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления
		|ГДЕ
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ) = ЛОЖЬ
		|
		|СГРУППИРОВАТЬ ПО
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.ДляРублейЧ,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ДатаОкончания,
		|	НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.СпособРасчета,
		|	ВЫБОР
		|		КОГДА НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|			ТОГДА "" (по внутр. совмест-ву)""
		|		ИНАЧЕ """"
		|	КОНЕЦ,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.Наименование, ""<не указано>""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДополнительныеНачисления.ВидРасчета.Код, ""Я"")
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""ДоговорыНаВыполнениеРабот"",
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.ДляРублейЧ,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.Наименование, ""<не указано>""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.Код, ""Я""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ),
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.СпособРасчета,
		|	NULL,
		|	ВЫБОР
		|		КОГДА НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|			ТОГДА "" (по внутр. совмест-ву)""
		|		ИНАЧЕ """"
		|	КОНЕЦ,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ДатаОкончания,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Результат),
		|	0,
		|	0,
		|	0,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL
		|ИЗ
		|	ВТ_ДоговорыНаВыполнениеРабот КАК НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот
		|ГДЕ
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ) = ЛОЖЬ
		|
		|СГРУППИРОВАТЬ ПО
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ДатаОкончания,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.ДляРублейЧ,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.КодДоходаЕСН.ВходитВБазуФСЗН,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник,
		|	НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.СпособРасчета,
		|	ВЫБОР
		|		КОГДА НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|			ТОГДА "" (по внутр. совмест-ву)""
		|		ИНАЧЕ """"
		|	КОНЕЦ,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.Наименование, ""<не указано>""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме, ЛОЖЬ),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийДоговорыНаВыполнениеРабот.ВидРасчета.Код, ""Я"")
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""Удержания"",
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ФизЛицо,
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.ДляРублейЧ,
		|	ИСТИНА,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.Наименование, ""<не указано>""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.Код, ""Я""),
		|	ЛОЖЬ,
		|	NULL,
		|	NULL,
		|	NULL,
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ДатаОкончания,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийУдержания.Результат),
		|	0,
		|	0,
		|	0,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL
		|ИЗ
		|	ВТ_Удержания КАК НачислениеЗарплатыРаботникамОрганизацийУдержания
		|
		|СГРУППИРОВАТЬ ПО
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ФизЛицо,
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета,
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.ДляРублейЧ,
		|	ИСТИНА,
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ДатаНачала,
		|	НачислениеЗарплатыРаботникамОрганизацийУдержания.ДатаОкончания,
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.Наименование, ""<не указано>""),
		|	ЕСТЬNULL(НачислениеЗарплатыРаботникамОрганизацийУдержания.ВидРасчета.Код, ""Я"")
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""ПенсионныйФонд"",
		|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.ФизЛицо,
		|	NULL,
		|	Истина,
		|	Истина,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.Налог,
		|	NULL,
		|	NULL,
		|	NULL,
		|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.МесяцНалоговогоПериода,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL
		|ИЗ
		|	ВТ_ПенсионныйФонд КАК НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""НДФЛ"",
		|	НачислениеЗарплатыРаботникамОрганизацийНДФЛ.ФизЛицо,
		|	NULL,
		|	Истина,
		|	Истина,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	НачислениеЗарплатыРаботникамОрганизацийНДФЛ.Налог,
		|	NULL,
		|	NULL,
		|	NULL,
		|	НачислениеЗарплатыРаботникамОрганизацийНДФЛ.МесяцНалоговогоПериода,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL
		|ИЗ
		|	ВТ_НДФЛ КАК НачислениеЗарплатыРаботникамОрганизацийНДФЛ
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	""ПогашениеЗаймов"",
		|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ФизЛицо,
		|	NULL,
		|	Истина,
		|	Истина,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	NULL,
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ПогашеноЗайма),
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.МатериальнаяВыгода),
		|	СУММА(НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.НалогНаМатериальнуюВыгоду),
		|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.СтавкаНалогообложенияМатвыгоды
		|ИЗ
		|	ВТ_ПогашениеЗаймов КАК НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов
		|
		|СГРУППИРОВАТЬ ПО
		|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.СтавкаНалогообложенияМатвыгоды,
		|	НачислениеЗарплатыРаботникамОрганизацийПогашениеЗаймов.ФизЛицо
		|
		|УПОРЯДОЧИТЬ ПО
		|	Сотрудник,
		|	Таблица";
		
		Запрос.Текст = ТекстЗапросаНачисления;
		Запрос.УстановитьПараметр("Ссылка", Ссылка);
		Запрос.УстановитьПараметр("парамФизЛицо",стрОсн.Физлицо);
		
		РезультатНачУд = Запрос.Выполнить().Выбрать();
		Пока РезультатНачУд.Следующий() Цикл 
			Если РезультатНачУд.Таблица = "Начисления" или РезультатНачУд.Таблица = "ДополнительныеНачисления" или РезультатНачУд.Таблица = "ДоговорыНаВыполнениеРабот" Тогда
				Если ВыборкаПоФлагуРублиЧ Тогда //О.Т. Аверсон 07.12.2016 № 78
					Если РезультатНачУд.ДляРублейЧ Тогда //О.Т. Аверсон 07.12.2016 № 78
						РезНачисления = РезНачисления + ?(ЗначениеЗаполнено(РезультатНачУд.Результат),РезультатНачУд.Результат,0);
						Если РезультатНачУд.ВидРасчета <> Null Тогда
							ВходитДляРублейЧ = Истина;
						КонецЕсли;
					КонецЕсли; 
					
					//Аверсон ЕАЕ 28.08.2025 СВФР-016564
					//Если РезультатНачУд.ВходитВБазуФСЗН Тогда //О.Т. Аверсон 07.12.2016 № 78
					Если РезультатНачУд.ВходитВБазуФСЗН = Истина Тогда 
					//Аверсон СВФР-016564
					
						РезНачВходитФСЗН = РезНачВходитФСЗН + ?(ЗначениеЗаполнено(РезультатНачУд.Результат),РезультатНачУд.Результат,0);
					КонецЕсли;
				иначе
					РезНачисления = РезНачисления + ?(ЗначениеЗаполнено(РезультатНачУд.Результат),РезультатНачУд.Результат,0);
					ВходитДляРублейЧ = Истина;
				КонецЕсли;
			ИначеЕсли РезультатНачУд.Таблица = "ПогашениеЗаймов" Тогда 
				РезНачисления = РезНачисления + ?(ЗначениеЗаполнено(РезультатНачУд.МатериальнаяВыгода),РезультатНачУд.МатериальнаяВыгода,0);
				Если не ВыборкаПоФлагуРублиЧ Тогда
					ВходитДляРублейЧ = Истина;
				КонецЕсли;
			иначе
				Если ВыборкаПоФлагуРублиЧ Тогда //О.Т. Аверсон 07.12.2016 № 78
					Если РезультатНачУд.ДляРублейЧ Тогда //О.Т. Аверсон 07.12.2016 № 78
						РезУдержания = РезУдержания + ?(ЗначениеЗаполнено(РезультатНачУд.Результат),РезультатНачУд.Результат,0);
						Если РезультатНачУд.ВидРасчета <> Null Тогда
							ВходитДляРублейЧ = Истина;
						КонецЕсли;
					КонецЕсли;  
				иначе
					РезУдержания = РезУдержания + ?(ЗначениеЗаполнено(РезультатНачУд.Результат),РезультатНачУд.Результат,0);
					ВходитДляРублейЧ = Истина;
				КонецЕсли;
			КонецЕсли;
			
		КонецЦикла;
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	СуммыПоСотрудникамСрезПоследних.РублиЧ
		|ИЗ
		|	РегистрСведений.СуммыПоСотрудникам.СрезПоследних(&Период, ФизЛицо = &ФизЛицо) КАК СуммыПоСотрудникамСрезПоследних";
		
		Запрос.УстановитьПараметр("Период", ПериодРегистрации);
		Запрос.УстановитьПараметр("ФизЛицо", стрОсн.ФизЛицо);
		
		РезультатЗапроса = Запрос.Выполнить().Выбрать();
		РублиЧ = 0;
		Пока РезультатЗапроса.Следующий() Цикл
			РублиЧ = РезультатЗапроса.РублиЧ;
		КонецЦикла;
		Если ТЧДоговора Тогда 
			МассивДоговоры = ДоговорыНаВыполнениеРабот.НайтиСтроки(Новый Структура("ФизЛицо",СтрОсн.ФизЛицо));
			Если МассивДоговоры.Количество()>0 Тогда 
				РублиЧ = МассивДоговоры[0].Размер;
			иначе
				РублиЧ = 0;
			КонецЕсли;
		КонецЕсли;
		
		//О.Т. Аверсон 07.12.2016 № 78
		если ВыборкаПоФлагуРублиЧ Тогда 
			ВеличинаПрожиточногоМинимума = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),Новый Структура("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
			
			ЗапросГрафик = Новый Запрос; //О.Т. Аверсон 23.12.2016 № 129
			ЗапросГрафик.Текст = 
			"ВЫБРАТЬ
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= ПоследниеДаты.ДатаНачалаСобытия
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения
			|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы
			|	КОНЕЦ КАК ГрафикРаботы,
			|	РаботникиОрганизации.Период,
			|	ВложенныйЗапрос.ДатаКонец
			|ИЗ
			|	(ВЫБРАТЬ
			|		МАКСИМУМ(РаботникиОрганизации.Период) КАК МаксПериод,
			|		СтрокиНачисления.Сотрудник КАК Сотрудник,
			|		СтрокиНачисления.ДатаНачалаСобытия КАК ДатаНачалаСобытия
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиНачисления
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
			|			ПО СтрокиНачисления.ДатаНачалаСобытия >= РаботникиОрганизации.Период
			|				И СтрокиНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
			|	ГДЕ
			|		СтрокиНачисления.Физлицо = &Физлицо
			|		И СтрокиНачисления.Ссылка = &Ссылка
			|	
			|	СГРУППИРОВАТЬ ПО
			|		СтрокиНачисления.Сотрудник,
			|		СтрокиНачисления.ДатаНачалаСобытия) КАК ПоследниеДаты
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
			|		ПО ПоследниеДаты.МаксПериод = РаботникиОрганизации.Период
			|			И ПоследниеДаты.Сотрудник = РаботникиОрганизации.Сотрудник,
			|	(ВЫБРАТЬ
			|		РаботникиОрганизации.Период КАК ДатаКонец
			|	ИЗ
			|		(ВЫБРАТЬ
			|			МАКСИМУМ(РаботникиОрганизации.Период) КАК МаксПериод,
			|			СтрокиНачисления.Сотрудник КАК Сотрудник
			|		ИЗ
			|			Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиНачисления
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
			|				ПО СтрокиНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
			|					И СтрокиНачисления.ДатаОкончания <= РаботникиОрганизации.Период
			|		ГДЕ
			|			СтрокиНачисления.Физлицо = &Физлицо
			|		
			|		СГРУППИРОВАТЬ ПО
			|			СтрокиНачисления.Сотрудник) КАК ПоследниеДаты
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
			|			ПО ПоследниеДаты.МаксПериод = РаботникиОрганизации.Период
			|				И ПоследниеДаты.Сотрудник = РаботникиОрганизации.Сотрудник) КАК ВложенныйЗапрос";
			ЗапросГрафик.УстановитьПараметр("Физлицо", СтрОсн.Физлицо);
			ЗапросГрафик.УстановитьПараметр("Ссылка", Ссылка);
			РезультатГрафик = ЗапросГрафик.Выполнить().Выбрать();
			График = Справочники.ГрафикиРаботы.ПустаяСсылка();
			ПериодПроверкаНачало = НачалоМесяца(ПериодРегистрации);
			ПериодПроверкаКонец = КонецМесяца(ПериодРегистрации);
			Пока РезультатГрафик.Следующий() Цикл 
				График = РезультатГрафик.ГрафикРаботы;
				//Если РезультатГрафик.Период <> Null Тогда 
				//	Если РезультатГрафик.Период > ПериодРегистрации и НачалоМесяца(РезультатГрафик.Период) = НачалоМесяца(ПериодРегистрации) Тогда 
				//		ПериодПроверкаНачало = РезультатГрафик.Период;
				//	КонецЕсли;
				//КонецЕсли;
				//Если РезультатГрафик.ДатаКонец <> Null Тогда 
				//	Если РезультатГрафик.ДатаКонец < КонецМесяца(ПериодРегистрации) и НачалоМесяца(РезультатГрафик.ДатаКонец) = НачалоМесяца(ПериодРегистрации) Тогда 
				//		ПериодПроверкаКонец = РезультатГрафик.ДатаКонец;
				//	КонецЕсли;
				//КонецЕсли;
			КонецЦикла;
			//О.Т. Аверсон 23.12.2016 № 129
			
			
			ЗапросДаты = Новый Запрос;
			ЗапросДаты.Текст = 
			"ВЫБРАТЬ
			|	МИНИМУМ(НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаНачала) КАК ДатаНачала,
			|	МАКСИМУМ(НачислениеЗарплатыРаботникамОрганизацийНачисления.ДатаОкончания) КАК ДатаОкончания
			|ИЗ
			|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК НачислениеЗарплатыРаботникамОрганизацийНачисления
			|ГДЕ
			|	НачислениеЗарплатыРаботникамОрганизацийНачисления.СотрудниК.ФизЛицо = &ФизЛицо
			|	И НачислениеЗарплатыРаботникамОрганизацийНачисления.Ссылка = &Ссылка";
			
			ЗапросДаты.УстановитьПараметр("ФизЛицо", стрОсн.ФизЛицо);
			ЗапросДаты.УстановитьПараметр("Ссылка", Ссылка);
			
			РезультатДаты = ЗапросДаты.Выполнить().Выгрузить();
			Если РезультатДаты.Количество()>0 Тогда 
				ПериодПроверкаНачало = РезультатДаты[0].ДатаНачала;
				ПериодПроверкаКонец = РезультатДаты[0].ДатаОкончания;
			иначе
				ПериодПроверкаНачало = НачалоМесяца(ПериодРегистрации);
				ПериодПроверкаКонец = КонецМесяца(ПериодРегистрации);
			КонецЕсли;
			
			
			
			Норма = ПрочиеПроцедуры.ПолучитьНормуВремениПоГрафикуЗаИнтервалВремени(График,Перечисления.ВидыУчетаВремени.ПоДням,ПериодПроверкаНачало,ПериодПроверкаКонец,Организация);//О.Т. Аверсон 16.10.2017 № 1120
			НачисленияФиз = Начисления.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.ФизЛицо)); 
			ОтработанныеДни = 0;
			Для Каждого стрНач из НачисленияФиз Цикл 
				Если стрНач.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням или стрНач.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам
					или стрНач.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной или стрНач.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой Тогда 
					Если не стрНач.Сторно Тогда 
						ОтработанныеДни = ОтработанныеДни + стрНач.ОтработаноДней;
					КонецЕсли;
				КонецЕсли;				
			КонецЦикла;
			Если ОтработанныеДни = 0 Тогда 
				
				ЗапросРабДни = Новый Запрос;
				ЗапросРабДни.Текст =
				"ВЫБРАТЬ
				|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней
				|ИЗ
				|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
				|ГДЕ
				|	РабочееВремяРаботниковОрганизаций.Сотрудник.ФизЛицо = &ФизЛицо
				|	И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
				|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &Период И &Период1
				|	И ВЫБОР
				|			КОГДА &ФлагПоТабелю
				|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
				|			ИНАЧЕ ИСТИНА
				|		КОНЕЦ";
				
				УчетнаяПолитикаЗапрос = Новый Запрос;
				УчетнаяПолитикаЗапрос.Текст = 
				"ВЫБРАТЬ
				|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
				|ИЗ
				|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
				|ГДЕ
				|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
				УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",Организация);
				УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
				
				если УчетнаяПолитика.Количество()>0 Тогда 
					ЗапросРабДни.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
				иначе
					ЗапросРабДни.УстановитьПараметр("ФлагПоТабелю",Ложь);
				КонецЕсли;
				
				ЗапросРабДни.УстановитьПараметр("ФизЛицо", СтрОсн.Физлицо);
				ЗапросРабДни.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
				ЗапросРабДни.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
				ЗапросРабДни.УстановитьПараметр("Период1", КонецМесяца(ПериодРегистрации));
				РезРабДни = ЗапросРабДни.Выполнить().Выбрать();
				ОтработанныеДни = 0;
				Пока РезРабДни.Следующий() Цикл 
					ОтработанныеДни = ?(РезРабДни.Дней= null,0,РезРабДни.Дней);
				КонецЦикла;
				
			КонецЕсли;
			
			Если ОтработанныеДни <> Норма и Норма <> Null Тогда 
				ПроверкаРезНачисления = ?(ОтработанныеДни<>0,РезНачВходитФСЗН / ОтработанныеДни * Норма,0);
			иначе
				ПроверкаРезНачисления = РезНачВходитФСЗН;
			КонецЕсли;
			Если ПроверкаРезНачисления < ВеличинаПрожиточногоМинимума и ПроверкаРезНачисления <> 0 Тогда 
				Сообщить("ЗП сотрудника " +Строка(СтрОсн.Физлицо)+ "начислена меньше минимальной ЗП!");
			КонецЕсли;
			
			
		КонецЕсли;
		//О.Т. Аверсон 07.12.2016 № 78
		Если РублиЧ = 0 Тогда 
			Сообщить("РублиЧ равно 0 по сотруднику "+Строка(стрОсн.ФизЛицо));
		КонецЕсли;
		
		Если РезНачисления - РезУдержания <> РублиЧ и ВходитДляРублейЧ и РублиЧ <> 0 Тогда 
			Если не(РублиЧ -(РезНачисления - РезУдержания) >= -0.01 и РублиЧ - (РезНачисления - РезУдержания) <= 0.01) Тогда //О.Т. Аверсон 18.01.2017 № 169
				//О.Т. Аверсон 18.11.2016 № 41
				ДопСтрока = "";
				МассивНДФЛ = НДФЛ.НайтиСтроки(Новый Структура("ФизЛицо",стрОсн.ФизЛицо));
				Для Каждого стрНДФЛ из МассивНДФЛ Цикл 
					если стрНДФЛ.ПримененныйВычетИмущественныйРасход <> 0 или стрНДФЛ.ПримененныйВычетСоциальныйСПроцентами <> 0 Тогда 
						ДопСтрока = ". Существуют дополнительные вычеты, проверьте."
					КонецЕсли;
					
				КонецЦикла;
				//О.Т. Аверсон 18.11.2016 № 41
				Сообщить("ФизЛицо " + стрОсн.ФизЛицо.Наименование + " сумма РублиЧ = "+Строка(РублиЧ)+"; Сумма по начислениям = "+ Строка(РезНачисления - РезУдержания)+ДопСтрока);
			КонецЕсли;
		КонецЕсли;
		
	КонецЦикла;
	
	
	
КонецПроцедуры


// Выполняет перерасчет по заданному списку физлиц
// Если передан пустой список физлиц - перерасчет не проводится
// Если в качестве списка физлиц передан не массив, а Неопределено - перерасчет по всем физлицам 
// регистратора по которым требуется перерасчет
//
// Параметры
//     Физлица - список значений - ссылки на физлиц
// Возвращаемое значение
//  нет
//
Процедура Перерассчитать(Физлица = Неопределено) Экспорт
	
	// проверим можно ли что-то делать с документом
	ОписаниеПричиныОтказа = "";
	Если ПроведениеРасчетов.ДокументНельзяИзменятьЗаднимЧислом(Ссылка, ОписаниеПричиныОтказа) Тогда
		ВызватьИсключение(ОписаниеПричиныОтказа);
	КонецЕсли;
	
	Если Не ПроведениеРасчетов.НеобходимостьПерерасчета(Ссылка) Тогда
		Возврат 
	КонецЕсли;
	
	// получим список перерассчитываемых физлиц
	ФизлицаСписок = Новый СписокЗначений;
	Если Физлица = Неопределено Тогда
		
		// таблица ФизлицаДляПерерасчета
		// Список физлиц по которым необходимо выполнить перерасчет
		// Поля:
		//        ФизЛицо
		// Описание:
		// Получает список неповторяющихся физлиц по которым есть записи
		// перерасчета в одной из таблиц перерасчета - по основным или дополнительным начислениям
		//
		ФизлицаДляПерерасчетаТекст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Перерасчет.ФизЛицо
		|ИЗ
		|	(ВЫБРАТЬ
		|		Перерасчет.ФизЛицо
		|	ИЗ
		|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ПерерасчетОсновныхНачислений КАК Перерасчет
		|	ГДЕ
		|		Перерасчет.ОбъектПерерасчета = &парамРегистратор
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		Перерасчет.ФизЛицо
		|	ИЗ
		|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.ПерерасчетДополнительныхНачислений КАК Перерасчет
		|	ГДЕ
		|		Перерасчет.ОбъектПерерасчета = &парамРегистратор) КАК Перерасчет";
		
		Запрос = Новый Запрос(ФизлицаДляПерерасчетаТекст);
		Запрос.УстановитьПараметр("парамРегистратор", Ссылка);
		ФизлицаСписок.ЗагрузитьЗначения(Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("ФизЛицо"));
		
	Иначе
		
		ФизлицаСписок = Физлица;
		
	КонецЕсли;
	
	// если не перерассчитываем никого - возврат
	Если ФизлицаСписок.Количество()=0 Тогда
		Возврат 
	КонецЕсли;
	
	// текст выбора списка физлиц для перерасчета НДФЛ
	СписокФизЛицДляРасчетаНДФЛТекст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ФизическиеЛица.Ссылка КАК Физлицо
	|ИЗ
	|	Справочник.ФизическиеЛица КАК ФизическиеЛица
	|
	|ГДЕ
	|	ФизическиеЛица.Ссылка В(&парамФизлицаПерерасчета)";
	
	ДополнительныеПараметрыЗапросаНДФЛ  = Новый Структура;
	ДополнительныеПараметрыЗапросаНДФЛ.Вставить("парамФизлицаПерерасчета", ФизлицаСписок);
	
	_парамФизлицаПерерасчета_ = ФизлицаСписок; //СВЭЙ 10.04.2024 КВВ СВФР-012811
	
	// читаем все данные 
	НачатьТранзакцию();
	Прочитать();
	ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
	Движения.ОсновныеНачисленияРаботниковОрганизаций.Прочитать();
	Движения.ДополнительныеНачисленияРаботниковОрганизаций.Прочитать();
	Движения.УдержанияРаботниковОрганизаций.Прочитать();
	Движения.НДФЛСведенияОДоходах.Прочитать();
	Движения.ВзаиморасчетыСРаботникамиОрганизаций.Прочитать();
	Движения.НДФЛРасчетыСБюджетом.Прочитать();
	ЗафиксироватьТранзакцию();
	
	// позиционируем выборку
	ВыборкаПоШапкеДокумента.Следующий();
	
	// ведется ли учет задолженности в разрезе периодов возникновения задолженности
	УчетЗадолженностиПоМесяцам	= ПроцедурыУправленияПерсоналом.ЗначениеУчетнойПолитикиПоПерсоналуОрганизации(глЗначениеПеременной("глУчетнаяПолитикаПоПерсоналуОрганизации"), Организация, "УчетЗадолженностиПоМесяцам");
	
	////////////////////////////////////////////////////////////////////////
	// Основные, дополнительные начисления и сведения о доходах НДФЛ
	
	// сначала удалим сведения о доходах НДФЛ по перерассчитываемым физлицам
	НДФЛСведенияОДоходах = Движения.НДФЛСведенияОДоходах;
	ПоследнееДвижение = НДФЛСведенияОДоходах.Количество()-1;
	Для Сч = 0 По ПоследнееДвижение Цикл
		// удалим записи по всем физлицам полученного списка
		// обходим в обратном порядке
		Если ФизлицаСписок.НайтиПоЗначению(НДФЛСведенияОДоходах[ПоследнееДвижение - Сч].Физлицо) <> Неопределено Тогда
			НДФЛСведенияОДоходах.Удалить(ПоследнееДвижение - Сч);
		КонецЕсли;
	КонецЦикла;
	
	// перерассчитываем записи начислений
	// при этом передаем не только набор записей регистра расчета, но и набор записей регистра 
	// накопления со сведениями об отработанном времени
	// а также таблицу значений в которую будет заполнять движения для НДФЛСведенияОДоходах
	ДвиженияНДФЛСведенияОДоходах = 	Движения.НДФЛСведенияОДоходах.Выгрузить();// фактически - создаем структуру таблицы значений
	ПроведениеРасчетов.ПереРассчитатьЗаписиРегистраРасчета("ОсновныеНачисленияРаботниковОрганизаций", Движения.ОсновныеНачисленияРаботниковОрганизаций, Физлица, ДвиженияНДФЛСведенияОДоходах, Движения.РасчетСреднегоЗаработка, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение, Начисления);
	// запишем без выполнения пересчета фактического периода действия
	Движения.ОсновныеНачисленияРаботниковОрганизаций.Записать(Истина, Истина);
	
	ПроведениеРасчетов.ПереРассчитатьЗаписиРегистраРасчета("ДополнительныеНачисленияРаботниковОрганизаций", Движения.ДополнительныеНачисленияРаботниковОрганизаций, Физлица, ДвиженияНДФЛСведенияОДоходах, Движения.РасчетСреднегоЗаработка, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение);
	
	// запишем набор
	Движения.ДополнительныеНачисленияРаботниковОрганизаций.Записать(Истина, Истина);
	ДополнительныеНачисления.Очистить();
	Для каждого СтрокаДвижения Из Движения.ДополнительныеНачисленияРаботниковОрганизаций Цикл
		Если Не ЗначениеЗаполнено(СтрокаДвижения.ДокументОснование) Тогда
			
			СтрокаНачисления = ДополнительныеНачисления.Добавить();
			ЗаполнитьЗначенияСвойств(СтрокаНачисления,СтрокаДвижения);
			СтрокаНачисления.ДатаНачала = СтрокаДвижения.БазовыйПериодНачало;
			СтрокаНачисления.ДатаОкончания = СтрокаДвижения.БазовыйПериодКонец;
			
			мСведенияОВидахРасчета = Новый Соответствие;
			мСведенияОВидахРасчета.Вставить("ОкладПоДням",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
			мСведенияОВидахРасчета.Вставить("ОкладПоЧасам",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
			мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасы",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
			мСведенияОВидахРасчета.Вставить("ДоплатаЗаРазъезднойХарактерРаботы",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Доплата за разъездной характер работы"));
			мСведенияОВидахРасчета.Вставить("Месячная",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Месячная"));
			//О.Т. Аверсон 03.04.2016 № 981
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	ОсновныеНачисленияОрганизаций.Ссылка
			|ИЗ
			|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
			|ГДЕ
			|	ОсновныеНачисленияОрганизаций.СпособРасчета = &СпособРасчета";			
			Запрос.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);
			РезультатЗапроса = Запрос.Выполнить().Выбрать();
			Если РезультатЗапроса.Следующий() Тогда 
				мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТариф",РезультатЗапроса.Ссылка);
			КонецЕсли;
			Запрос.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);
			РезультатЗапроса = Запрос.Выполнить().Выбрать();
			Если РезультатЗапроса.Следующий() Тогда 
				мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТарифИнстр",РезультатЗапроса.Ссылка);
			КонецЕсли;
			//О.Т. Аверсон 03.04.2016 № 981
			
			СведенияОВидеРасчета = ПроведениеРасчетов.ПолучитьСведенияОВидеРасчета(мСведенияОВидахРасчета, СтрокаДвижения.ВидРасчета);
			КодВычета = СведенияОВидеРасчета.КодДоходаНДФЛ.КодВычета;
			Если КодВычета = Неопределено или КодВычета.Наименование = "" Тогда
				
				СтрокаНачисления.КодВычета = "";
			Иначе
				СтрокаНачисления.КодВычета = КодВычета;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла; 
	
	// добавим матвыгоду по заемным средствам
	СформироватьДоходыПоМатвыгодеПоЗаймам(ВыборкаПоШапкеДокумента, ДвиженияНДФЛСведенияОДоходах, ФизлицаСписок);
	
	// запишем движения по доходам НДФЛ, которые формируются при ПереРассчитатьЗаписиРегистраРасчета
	ПроведениеРасчетов.СвернутьДвиженияНДФЛСведенияОДоходах(ДвиженияНДФЛСведенияОДоходах);
	Движения.НДФЛСведенияОДоходах.Загрузить(ДвиженияНДФЛСведенияОДоходах);
	Движения.НДФЛСведенияОДоходах.Записать();
	
	////////////////////////////////////////////////////////////////////////
	// НДФЛ Расчеты с бюджетом
	
	// перезаполним данные по исчисленному НДФЛ 
	// сначала удалим сведения об исчисленном НДФЛ по перерассчитываемым физлицам
	ДвиженияНДФЛРасчетыСБюджетом = Движения.НДФЛРасчетыСБюджетом;
	ПоследнееДвижение = ДвиженияНДФЛРасчетыСБюджетом.Количество()-1;
	Для Сч = 0 По ПоследнееДвижение Цикл
		// удалим записи по всем физлицам полученного списка
		// обходим в обратном порядке
		Если ФизлицаСписок.НайтиПоЗначению(ДвиженияНДФЛРасчетыСБюджетом[ПоследнееДвижение - Сч].Физлицо) <> Неопределено Тогда
			ДвиженияНДФЛРасчетыСБюджетом.Удалить(ПоследнееДвижение - Сч);
		КонецЕсли;
	КонецЦикла;
	
	// перезаполним данные по исчисленному НДФЛ в табличной части
	// сначала удалим сведения об исчисленном НДФЛ по перерассчитываемым физлицам
	// удаляем строки после получения данных для расчета НДФЛ!!
	ПоследнееДвижение = НДФЛ.Количество()-1;
	Для Сч = 0 По ПоследнееДвижение Цикл
		// удалим записи по всем физлицам полученного списка
		// обходим в обратном порядке
		Если ФизлицаСписок.НайтиПоЗначению(НДФЛ[ПоследнееДвижение - Сч].Физлицо) <> Неопределено Тогда
			НДФЛ.Удалить(ПоследнееДвижение - Сч);
		КонецЕсли;
	КонецЦикла;
	
	// получение результата НДФЛ по ставке 13 процентов
	// для него передается Организация, период, ссылка на регистратор и список физлиц
	ВыборкаПодразделений = "";
	ДанныеНДФЛ = ПроведениеРасчетов.ПолучитьДанныеНДФЛПоРегистратору(Неопределено, Неопределено, ПериодРегистрации, Организация, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, Ссылка, СписокФизЛицДляРасчетаНДФЛТекст, ДополнительныеПараметрыЗапросаНДФЛ, Истина, , ВыборкаПодразделений,,,,,_парамФизлицаПерерасчета_ ); //СВЭЙ 10.04.2024 КВВ СВФР-012811 (_парамФизлицаПерерасчета_)
	
	Если ДанныеНДФЛ <> Неопределено Тогда
		ЗаполнитьНаборЗаписейПоДаннымНДФЛ(Движения.НДФЛРасчетыСБюджетом, ДанныеНДФЛ, ВыборкаПоШапкеДокумента, Истина, ФизлицаСписок, , ВыборкаПодразделений);
	КонецЕсли;
	Движения.НДФЛРасчетыСБюджетом.Записать();
	
	////////////////////////////////////////////////////////////////////////
	// удержания работников
	
	// в конце - перерасчет удержаний, так как им могут понадобиться данные расчета НДФЛ
	ПроведениеРасчетов.ПереРассчитатьЗаписиРегистраРасчета("УдержанияРаботниковОрганизаций", Движения.УдержанияРаботниковОрганизаций, Физлица, , , ВыборкаПоШапкеДокумента.ГоловнаяОрганизация, ВыборкаПоШапкеДокумента.ОбособленноеПодразделение, Удержания);
	// запишем
	Движения.УдержанияРаботниковОрганизаций.Записать(Истина, Истина);
	
	// записываем документ перед вызовом СформироватьВзаиморасчетыСРаботниками
	Записать();
	
	////////////////////////////////////////////////////////////////////////
	// взаиморасчеты с работниками
	
	// сначала удалим сведения о взаиморасчетах с работниками
	ВзаиморасчетыСРаботникамиОрганизаций = Движения.ВзаиморасчетыСРаботникамиОрганизаций;
	ПоследнееДвижение = ВзаиморасчетыСРаботникамиОрганизаций.Количество()-1;
	Для Сч = 0 По ПоследнееДвижение Цикл
		// удалим записи по всем физлицам полученного списка
		// обходим в обратном порядке
		Если ФизлицаСписок.НайтиПоЗначению(ВзаиморасчетыСРаботникамиОрганизаций[ПоследнееДвижение - Сч].Физлицо) <> Неопределено Тогда
			ВзаиморасчетыСРаботникамиОрганизаций.Удалить(ПоследнееДвижение - Сч);
		КонецЕсли;
	КонецЦикла;
	
	// теперь сформируем начисления к выплате по начислениям документа для перерассчитываемых работников
	СформироватьВзаиморасчетыСРаботниками(ВыборкаПоШапкеДокумента, Движения.ВзаиморасчетыСРаботникамиОрганизаций, УчетЗадолженностиПоМесяцам, Истина, Физлица);
	Движения.ВзаиморасчетыСРаботникамиОрганизаций.Записать();
	
	////////////////////////////////////////////////////////////////////////
	// Удалим записи перерасчета по которым выполнен перерасчет
	ПроведениеРасчетов.УдалитьСведенияОПерерасчетеДокумента(Ссылка);
	
КонецПроцедуры // Перерассчитать()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ

//+ СВЭЙ КДЯ 29.11.19 СВФР-004909
Функция СоздатьТаблицуПериодовНачислений() 
	
	ТЗ_ПериодыНачислений = Новый ТаблицаЗначений;
	ТЗ_ПериодыНачислений.Колонки.Добавить( "ФизЛицо" );
	ТЗ_ПериодыНачислений.Колонки.Добавить( "Период" );
	ТЗ_ПериодыНачислений.Колонки.Добавить( "ВидРасчета" );
	ТЗ_ПериодыНачислений.Колонки.Добавить( "Запись" );
	ТЗ_ПериодыНачислений.Колонки.Добавить( "ЕстьЗапись" );
	Возврат ТЗ_ПериодыНачислений;
	
КонецФункции // СоздатьТаблицуПериодовНачислений()

Функция ПолучитьФлагРазбиватьУдержанияПоПериодам()
	
	ЗапросУП = Новый Запрос;
	ЗапросУП.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.НеРазбиватьУдержанияПоПериодам
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
	
	ЗапросУП.УстановитьПараметр("Организация", Организация);
	
	РезультатЗапросаУП = ЗапросУП.Выполнить().Выбрать();
	НеРазбиватьУдержанияПоПериодам = Ложь;
	Пока РезультатЗапросаУП.Следующий() Цикл
		НеРазбиватьУдержанияПоПериодам = РезультатЗапросаУП.НеРазбиватьУдержанияПоПериодам;
	КонецЦикла;
	ФлагРазбиватьУдержанияПоПериодам = НЕ НеРазбиватьУдержанияПоПериодам;
	
	Возврат ФлагРазбиватьУдержанияПоПериодам;
	
КонецФункции // ПолучитьФлагРазбивкиПоПериодам()


Процедура ДобавитьПериодНачисления( ТЗ_ПериодыНачислений, ВыборкаПоНачислениям )
	//Аверсон 29.04.2020 КВВ СВФР-005913 ( Закомментировано
	//Если НЕ ФлагРазбиватьУдержанияПоПериодам Тогда
	//	Возврат;	
	//КонецЕсли;
	//Аверсон 29.04.2020 КВВ СВФР-005913 )
	
	ФизЛицо =  ВыборкаПоНачислениям.Сотрудник.ФизЛицо;
	Если ТипЗнч( ВыборкаПоНачислениям.ВидРасчета ) = Тип( "ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций" ) Тогда
		Период =  НачалоМесяца( ВыборкаПоНачислениям.ПериодДействияНачало );
	ИначеЕсли ТипЗнч( ВыборкаПоНачислениям.ВидРасчета ) = Тип( "ПланВидовРасчетаСсылка.ДополнительныеНачисленияОрганизаций" ) Тогда	
		Период =  НачалоМесяца( ВыборкаПоНачислениям.БазовыйПериодНачало );
	Иначе
		Период = Неопределено;
	КонецЕсли; 
	
	Отбор = Новый Структура( "ФизЛицо, Период, ВидРасчета", ФизЛицо, Период );
	Если Период <> Неопределено И ТЗ_ПериодыНачислений.НайтиСтроки( Отбор ).Количество() = 0  Тогда
		НовСтр = ТЗ_ПериодыНачислений.Добавить();
		НовСтр.ФизЛицо = ФизЛицо;
		НовСтр.Период = Период;
	КонецЕсли; 
	
КонецПроцедуры


Процедура ЗаполнитьПериодыУдержаний( ТЗ_ПериодыНачислений, НаборУдержания, МассивИндексыСтрокУдержания, Физлицо )
	
	// доформируем движения удержаний по данным табличной части без записи (запись делается процедурой РассчитатьЗаписиРегистраРасчета)
	Отбор = Новый Структура( "ЕстьЗапись, ФизЛицо, Период" ); 
	ЗаписиКУдалению = Новый Массив;
	Для каждого Запись Из НаборУдержания Цикл
		
		//+ СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть: упрощение и оптимизация запросов
		Если (НЕ ФлагРазбиватьУдержанияПоПериодам 
			И НЕ Запись.ВидРасчета.УдержанияПоПериодамДействия)  //Аверсон 29.04.2020 КВВ СВФР-005913
			//Аверсон 13.05.2020 КВВ СВФР-005958 (
			ИЛИ(ФлагРазбиватьУдержанияПоПериодам И 
			(Запись.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ
			ИЛИ Запись.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела
			ИЛИ Запись.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой
			ИЛИ Запись.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой))
			//Аверсон 13.05.2020 КВВ СВФР-005958 )
			Тогда
			Если НачалоМесяца(Запись.БазовыйПериодНачало) <> НачалоМесяца(ПериодРегистрации) И НачалоМесяца(Запись.ПериодДействияНачало) <> НачалоМесяца(ПериодРегистрации) Тогда //Аверсон 12.05.2020 КВВ СВФР-005982 (НачалоМесяца)
				ЗаписиКУдалению.Добавить( Запись );
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		//- СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть
		
		
		Отбор.ФизЛицо = Запись.ФизЛицо;
		//+ СВЭЙ КДЯ 08.04.20 СВФР-005813
		//Отбор.Период = Запись.БазовыйПериодНачало;
		//- СВЭЙ КДЯ 08.04.20 СВФР-005813
		//+ СВЭЙ КДЯ 08.04.20 СВФР-005813
		Отбор.Период = НачалоМесяца( Запись.БазовыйПериодНачало );
		//- СВЭЙ КДЯ 08.04.20 СВФР-005813
		НайденныеСтроки = ТЗ_ПериодыНачислений.НайтиСтроки( Отбор );
		Если НайденныеСтроки.Количество() > 0  Тогда
			НайденнаяСтрока = НайденныеСтроки[0];
			//+ СВЭЙ КДЯ 08.04.20 СВФР-005813 //ищем по началу месяца, а записывам по фактич. началу периода
			НайденнаяСтрока.Период = Запись.БазовыйПериодНачало;
			//- СВЭЙ КДЯ 08.04.20 СВФР-005813
			НайденнаяСтрока.ВидРасчета = Запись.ВидРасчета;
			НайденнаяСтрока.Запись = Запись;
			НайденнаяСтрока.ЕстьЗапись = Истина;
		Иначе	
			НоваяСтрока = ТЗ_ПериодыНачислений.Добавить();
			НоваяСтрока.ФизЛицо = Запись.ФизЛицо;
			НоваяСтрока.Период = Запись.БазовыйПериодНачало;
			НоваяСтрока.ВидРасчета = Запись.ВидРасчета;
			НоваяСтрока.Запись = Запись;
			НоваяСтрока.ЕстьЗапись = Истина;
		КонецЕсли;
		
	КонецЦикла;
	
	Для каждого ЗаписьУдал Из ЗаписиКУдалению Цикл
		
		НаборУдержания.Удалить( ЗаписьУдал );
		НайдСтроки = Удержания.НайтиСтроки( 
		Новый Структура( "ФизЛицо, ВидРасчета, ДатаНачала",  
		ЗаписьУдал.ФизЛицо, ЗаписьУдал.ВидРасчета, 
		?( ЗначениеЗаполнено( ЗаписьУдал.ПериодДействияНачало ),
		ЗаписьУдал.ПериодДействияНачало , ЗаписьУдал.БазовыйПериодНачало )  ) );
		Для каждого НайдСтрока Из НайдСтроки Цикл
			
			Удержания.Удалить( НайдСтрока );	
			
		КонецЦикла; 
	КонецЦикла; 
	
	МодифицированаТЧ = Ложь;
	ОтборЗаписи = Новый Структура( "ЕстьЗапись, ФизЛицо", Истина ); 
	ОтборНезаполненныхПериодов = Новый Структура( "ЕстьЗапись" );
	Для каждого Стр Из ТЗ_ПериодыНачислений.НайтиСтроки( ОтборНезаполненныхПериодов ) Цикл
		
		ЗаполнитьЗначенияСвойств( ОтборЗаписи, Стр, "ФизЛицо" );
		НайденныеСтроки = ТЗ_ПериодыНачислений.НайтиСтроки( ОтборЗаписи );
		
		//Если НайденныеСтроки.Количество() > 0  Тогда
		//	НайденнаяСтрока = НайденныеСтроки[0];
		ОбработанныеВидыРасчета = Новый Массив;
		Для каждого НайденнаяСтрока Из НайденныеСтроки Цикл
			Если ОбработанныеВидыРасчета.Найти( НайденнаяСтрока.ВидРасчета ) <> Неопределено Тогда
				Продолжить;
			Иначе
				ОбработанныеВидыРасчета.Добавить( НайденнаяСтрока.ВидРасчета );
			КонецЕсли; 
			
			//Аверсон 04.05.2020 КВВ СВФР-005913 (
			Если НайденнаяСтрока.Период <> Стр.Период И НЕ НайденнаяСтрока.ВидРасчета.УдержанияПоПериодамДействия И ((НЕ ФлагРазбиватьУдержанияПоПериодам) 
				//Аверсон 13.05.2020 КВВ СВФР-005958 (
				ИЛИ (ФлагРазбиватьУдержанияПоПериодам И 
				(НайденнаяСтрока.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ
				ИЛИ НайденнаяСтрока.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела
				ИЛИ НайденнаяСтрока.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПределаФиксСуммой
				ИЛИ НайденнаяСтрока.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФФиксСуммой)))
				//Аверсон 13.05.2020 КВВ СВФР-005958 )
				Тогда
				Продолжить;
			КонецЕсли;
			//Аверсон 04.05.2020 КВВ СВФР-005913 )
			
			Запись = НайденнаяСтрока.Запись;
			НоваяЗапись = НаборУдержания.Добавить();
			ЗаполнитьЗначенияСвойств( НоваяЗапись, Запись, , "БазовыйПериодНачало, БазовыйПериодКонец" );
			НоваяЗапись.БазовыйПериодНачало = Стр.Период;
			НоваяЗапись.БазовыйПериодКонец = КонецМесяца( Стр.Период );
			//НайденнаяСтрокаТЧ = Удержания.Найти( Стр.ФизЛицо, "ФизЛицо" );
			НайденнаяСтрокаТЧ = Неопределено;
			НайденныеСтрокиТЧ = Удержания.НайтиСтроки( Новый Структура( "ФизЛицо, ВидРасчета", Стр.ФизЛицо, Запись.ВидРасчета  ) );
			Если НайденныеСтрокиТЧ.Количество() > 0 Тогда
				НайденнаяСтрокаТЧ = НайденныеСтрокиТЧ[ 0 ];	
			КонецЕсли; 
			Если НайденнаяСтрокаТЧ <> Неопределено Тогда
				НоваяСтрокаТЧ = Удержания.Добавить();
				ЗаполнитьЗначенияСвойств( НоваяСтрокаТЧ, НайденнаяСтрокаТЧ, , "ДатаНачала, ДатаОкончания" );
				НоваяСтрокаТЧ.ДатаНачала = Стр.Период;
				НоваяСтрокаТЧ.ДатаОкончания = КонецМесяца( Стр.Период );
				МодифицированаТЧ = Истина;
				
				Если НЕ Физлицо = Неопределено Тогда
					МассивИндексыСтрокУдержания.Добавить( НоваяСтрокаТЧ.НомерСтроки - 1 ); 
				КонецЕсли;
			КонецЕсли;
			
			//КонецЕсли; // Если НайденныеСтроки.Количество() > 0
		КонецЦикла; // НайденнаяСтрока Из НайденныеСтроки 
		
	КонецЦикла;   
	
	Если МодифицированаТЧ Тогда
		Записать();	
	КонецЕсли;
	
КонецПроцедуры
//- СВЭЙ КДЯ 29.11.19 СВФР-004909 

//+ СВЭЙ КДЯ 18.03.20 СВФР-005696
Функция ПолучитьДатуПеремещенияВДругоеПодразделение( ПослеДаты, Сотрудник, Подразделение )
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	|	РаботникиОрганизацийСрезПервых.Период КАК ДатаПеремещенияВДругоеПодразделение
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций.СрезПервых(
	|			&НачинаяСДаты,
	|			НЕ ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)
	|				И Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПервых";
	Сутки = 24 * 60 * 60;
	Запрос.УстановитьПараметр( "НачинаяСДаты", НачалоДня( ПослеДаты + Сутки ) );
	Запрос.УстановитьПараметр( "Сотрудник", Сотрудник );
	Запрос.УстановитьПараметр( "Подразделение", Подразделение );
	РезультатЗапроса = Запрос.Выполнить();
	Если РезультатЗапроса.Пустой() Тогда
		
		ДатаПеремещенияВДругоеПодразделение = Дата(1,1,1);
		
	Иначе	
		Выборка = РезультатЗапроса.Выбрать();
		Выборка.Следующий();
		ДатаПеремещенияВДругоеПодразделение = Выборка.ДатаПеремещенияВДругоеПодразделение;
		
	КонецЕсли; 
	
	Возврат ДатаПеремещенияВДругоеПодразделение;
	
КонецФункции // ПолучитьДатуПеремещенияВДругоеПодразделение()

Функция ПолучитьДатуОкончанияНачисления( Строка, Начисления )
	
	ДатаОкончанияНачисления = Строка.ДатаОкончания;
	Если НЕ ЗначениеЗаполнено( ДатаОкончанияНачисления ) Тогда
		ПослеДаты = ?( ЗначениеЗаполнено( Строка.ДатаНачала ), Строка.ДатаНачала,
		Начисления.ПериодНачисления );
		ДатаПеремещенияВДругоеПодразделение =
		ПолучитьДатуПеремещенияВДругоеПодразделение( ПослеДаты, 
		Начисления.Сотрудник, Начисления.ПодразделениеОрганизации );
		Если ЗначениеЗаполнено( ДатаПеремещенияВДругоеПодразделение ) Тогда
			
			Сутки = 24 * 60 * 60;				
			ДатаОкончанияНачисления = ДатаПеремещенияВДругоеПодразделение - Сутки;				
			
		КонецЕсли; 
	КонецЕсли; 
	Возврат ДатаОкончанияНачисления;
	
КонецФункции // ПолучитьДатуОкончанияНачисления()
//- СВЭЙ КДЯ 18.03.20 СВФР-005696

//+ СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть: упрощение и оптимизация запросов
// дополняет ТЗ_ПериодыНачислений периодами начислений других регистраторов за тот же период регистрации
Процедура ДополнитьПериодыНачислений( ВыборкаПоШапкеДокумента, ТЗ_ПериодыНачислений )
	
	//Аверсон 29.04.2020 КВВ СВФР-005913 ( Закомментировано  
	//Если НЕ ФлагРазбиватьУдержанияПоПериодам Тогда
	//	Возврат;	
	//КонецЕсли;
	//Аверсон 29.04.2020 КВВ СВФР-005913 )
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	Запрос.УстановитьПараметр("ГоловнаяОрганизация", ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("МасФизЛиц", ТЗ_ПериодыНачислений.ВыгрузитьКолонку( "Физлицо" ) );
	
	Запрос.Текст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ  
	|	База.Сотрудник,
	|	База.ВидРасчета,
	|	База.ПериодДействияНачало,
	|	Неопределено КАК БазовыйПериодНачало
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК База
	|ГДЕ	
	|	База.ФизЛицо В (&МасФизЛиц)
	|	И База.Организация = &ГоловнаяОрганизация
	|	И База.ПериодРегистрации = &ПериодРегистрации
	|	И База.Регистратор <> &ДокументСсылка
	|	И База.ПериодДействияНачало <> ДАТАВРЕМЯ(1,1,1)
	|	
	|	ОБЪЕДИНИТЬ			
	|	
	|ВЫБРАТЬ РАЗЛИЧНЫЕ      
	|	База.Сотрудник,
	|	База.ВидРасчета,
	|	Неопределено КАК ПериодДействияНачало,
	|	База.БазовыйПериодНачало
	|ИЗ
	|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК База
	|ГДЕ	
	|	База.ФизЛицо В (&МасФизЛиц)
	|	И База.Организация = &ГоловнаяОрганизация
	|	И НАЧАЛОПЕРИОДА( База.ПериодРегистрации, МЕСЯЦ ) = &ПериодРегистрации
	|	И База.Регистратор <> &ДокументСсылка
	|	И База.БазовыйПериодНачало <> ДАТАВРЕМЯ(1,1,1)
	|";
	
	ВыборкаПоНачислениям = Запрос.Выполнить().Выбрать();
	Пока ВыборкаПоНачислениям.Следующий() Цикл
		ДобавитьПериодНачисления( ТЗ_ПериодыНачислений, ВыборкаПоНачислениям );	
	КонецЦикла; 
	
КонецПроцедуры // ДополнитьПериодыНачислений
//- СВЭЙ КДЯ 26.03.20 СВФР-005738 3 часть

// Выполняет формирование таблицы значений для загрузки ее в табличную часть Начисления
// Параметры:
//        Начисления - выборка результатат запроса
//  ПериодЗаполнения - дата периода для которого выполняем заполнение документа
//
// Возвращаемое значение:
//  таблица значений
//
Функция СформироватьТаблицуНачислений(Начисления, ОкончаниеПериодаЗаполнения, ВремТЗНачисления,ДопНачисления=Ложь,ТЧРаботавшиеВПраздники = Неопределено)
	ОкончаниеПериодаЗаполнения2 = ОкончаниеПериодаЗаполнения;
	ТЗНачисления = Новый ТаблицаЗначений();
	ТЗНачисления.Колонки.Добавить("Сотрудник");
	ТЗНачисления.Колонки.Добавить("ТабНомер");//Островская Татьяна 22.01.2014 № 17057
	ТЗНачисления.Колонки.Добавить("Физлицо");
	ТЗНачисления.Колонки.Добавить("ВидРасчета");
	ТЗНачисления.Колонки.Добавить("КодВычета");
	ТЗНачисления.Колонки.Добавить("Основное");// Признак основного начисления
	ТЗНачисления.Колонки.Добавить("Показатель1");
	ТЗНачисления.Колонки.Добавить("Показатель2");
	ТЗНачисления.Колонки.Добавить("Показатель3");
	ТЗНачисления.Колонки.Добавить("Показатель4");	
	ТЗНачисления.Колонки.Добавить("Показатель5");
	ТЗНачисления.Колонки.Добавить("Показатель6");		
	ТЗНачисления.Колонки.Добавить("Размер");
	ТЗНачисления.Колонки.Добавить("ДатаНачала", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗНачисления.Колонки.Добавить("ДатаНачалаСобытия", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗНачисления.Колонки.Добавить("ДатаОкончания", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗНачисления.Колонки.Добавить("ПодразделениеОрганизации");
	//Аверсон 02.09.2022 КВВ СВФР-009482 (
	ТЗНачисления.Колонки.Добавить("ауМестоРаботы");
	//Аверсон 02.09.2022 КВВ СВФР-009482 )
	
	// для заполнения графика и вида учета времени
	ТЗНачисления.Колонки.Добавить("ГрафикРаботы");
	ТЗНачисления.Колонки.Добавить("СуммированныйУчетРабочегоВремени");
	ТЗНачисления.Колонки.Добавить("СпособРасчета");
	ТЗНачисления.Колонки.Добавить("ВидВремени");
	ТЗНачисления.Колонки.Добавить("ОтработаноЧасов");// О.Т. 02.12.2014
	ТЗНачисления.Колонки.Добавить("ОтработаноДней");//О.Т. 22.04.2015 № 422
	ТЗНачисления.Колонки.Добавить("ОплаченоДнейЧасов");// О.Т. 02.12.2014
	ТЗНачисления.Колонки.Добавить("ОплаченоДней");
	
	//Аверсон ЕАЕ 07.03.2022 СВФР-008825
	Если Организация.ИНН = "100071565" Тогда
		ТЗНачисления.Колонки.Добавить("СовмещаемаяПрофессия");
	КонецЕсли;
	//Аверсон СВФР-008825
	
	// Массив незакрытых строк таблицы значений, т.е. тех, которым не проставлена дата окончания
	НезакрытыеСтроки = Новый Массив;
	// Текущие значения полей выборки для отслеживания изменения работника и даты назначения 
	ТекущийСотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
	ТекущаяДатаНазначения = '00010101';
	ТекущаяЧасоваяСтавкаОсновногоНачисления = 0;
	СтрокиНачисленийТекущегоНазначения = Новый Массив;
	//Островская Татьяна 16.12.2013 № 16980
	ЕстьПовышениеВТО = Ложь;
	Сутки = 24 * 60 * 60; //+ СВЭЙ КДЯ 18.03.20 СВФР-005696
	
	
	//Островская Татьяна 16.12.2013 № 16980
	ТЗСотрудники = Новый СписокЗначений;
	СотрудникПрошл = "";
	Пока Начисления.Следующий() Цикл
		//ПСА 12.07.2021 СВФР-007849 +++
		ЗапросПроверка = Новый Запрос;
		ЗапросПроверка.Текст = 
		"ВЫБРАТЬ
		|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ДатаСреза, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних
		|ГДЕ
		|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = &ПодразделениеОрганизации";
		
		ЗапросПроверка.УстановитьПараметр("ДатаСреза", Начисления.Период);
		ЗапросПроверка.УстановитьПараметр("ПодразделениеОрганизации", Начисления.ПодразделениеОрганизации);
		ЗапросПроверка.УстановитьПараметр("Сотрудник", Начисления.Сотрудник);
		
		РезультатЗапросаПроверки = ЗапросПроверка.Выполнить();
		
		ВыборкаПроверка = РезультатЗапросаПроверки.Выбрать();
		
		Если ВыборкаПроверка.Следующий() Тогда
			
		Иначе
			Продолжить;
		КонецЕсли;
		//+++ПСА 12.07.2021 СВФР-007849
		
		Если ТЗСотрудники.НайтиПоЗначению(Начисления.Сотрудник) = Неопределено Тогда 
			ТЗСотрудники.Добавить(Начисления.Сотрудник);
		КонецЕсли;
		//О.Т. Аверсон 05.01.2018 № 1403
		Если Начисления.Подходит Тогда 
			Если не Начисления.ВидРасчета = Неопределено Тогда 
				Если Начисления.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредность или Начисления.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаВредностьОтОтработанногоВремени Тогда 
					//Аверсон 21.04.2020 КВВ СВФР-005899 ( (Закомментировано)
					//МассивПроверка = ТЗНачисления.НайтиСтроки(Новый Структура("Сотрудник,Показатель1,ВидРасчета,ПодразделениеОрганизации",Начисления.Сотрудник,Начисления.Показатель1,Начисления.ВидРасчета,Начисления.ПодразделениеОрганизации));
					//Если МассивПроверка.Количество() > 0 Тогда
					//	МассивПроверка[0].ДатаОкончания = Дата(1,1,1);
					//	НезакрытыеСтроки.Добавить(МассивПроверка[0]); 				
					//	Продолжить;				
					//КонецЕсли;     	
					//Аверсон 21.04.2020 КВВ СВФР-005899 )(Закомментировано)
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		//О.Т. Аверсон 05.01.2018 № 1403
		
		
		ОтборВидРасчета = Новый Структура;
		ОтборВидРасчета.Вставить("ВидРасчета", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Повышающий коэфф"));
		ОтборВидРасчета.Вставить("Сотрудник", Начисления.Сотрудник);
		РезПроверка = ВремТЗНачисления.НайтиСтроки(ОтборВидРасчета);
		если РезПроверка.Количество()>0 Тогда 
			если РезПроверка[0].Показатель1 > 40 Тогда 
				ЕстьПовышениеВТО = Истина;
			КонецЕсли;
			
		КонецЕсли;
		//Островская Татьяна 27.11.2012 № ??
		если ДопНачисления Тогда
			если не Строка(ТипЗнч(Начисления.ВидРасчета) )="Дополнительные начисления организаций" Тогда 
				Продолжить;
			КонецЕсли;
			
		КонецЕсли;
		//Островская Татьяна 27.11.2012 № ??
		//Островская Татьяна 16.12.2013 № 16980
		Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Надбавка") или 
			Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Категория") Тогда 
			
			если ЕстьПовышениеВТО Тогда 
				Продолжить;
			КонецЕсли;
			
		КонецЕсли;
		//Островская Татьяна 16.12.2013 № 16980
		ЕстьПовышениеВТО = Ложь;
		
		Если Начисления.Сотрудник <> ТекущийСотрудник Тогда
			
			//О.Т. Аверсон 03.04.2018  
			НезакрытыеСтроки1 = Новый Массив;
			Для Каждого стр из НезакрытыеСтроки Цикл 
				Попытка
					
					Проверка = стр.ФизЛицо;
					НезакрытыеСтроки1.Добавить(стр);
				Исключение
					
				КонецПопытки;
			КонецЦикла;
			
			НезакрытыеСтроки = НезакрытыеСтроки1;
			//О.Т. Аверсон 03.04.2018 Проверка, если строка удалена, чтоб не добавлять в массив
			// закрываем незакрытые строки начислений предыдущего работника концом месяца
			ЗакрытьСтроки(ТЗНачисления, НезакрытыеСтроки, ОкончаниеПериодаЗаполнения);
			
			// меняется текущий работник и дата его движения
			ТекущийСотрудник = Начисления.Сотрудник;
			Попытка
				ТекущаяДатаНазначения = Начисления.ПериодРаботники;
			Исключение
			КонецПопытки;
			ТекущаяЧасоваяСтавкаОсновногоНачисления = 0;
			СтрокиНачисленийТекущегоНазначения.Очистить();
			
		ИначеЕсли Начисления.ПериодРаботники <> ТекущаяДатаНазначения Тогда
			
			Для каждого СтрокаТекущегоНазначения Из СтрокиНачисленийТекущегоНазначения Цикл
				
				ИндексСтроки = 0;
				Для каждого СтрокаМассива Из НезакрытыеСтроки Цикл
					Если СтрокаМассива = СтрокаТекущегоНазначения Тогда    												
						НезакрытыеСтроки.Удалить(ИндексСтроки);
						Прервать;
					Иначе
						ИндексСтроки = ИндексСтроки + 1;
					КонецЕсли;
				КонецЦикла;
				
			КонецЦикла;
			//О.Т. Аверсон 03.04.2018  
			НезакрытыеСтроки1 = Новый Массив;
			Для Каждого стр из НезакрытыеСтроки Цикл 
				Попытка
					
					Проверка = стр.ФизЛицо;
					НезакрытыеСтроки1.Добавить(стр);
				Исключение
					
				КонецПопытки;
			КонецЦикла;
			
			НезакрытыеСтроки = НезакрытыеСтроки1;
			//О.Т. Аверсон 03.04.2018 Проверка, если строка удалена, чтоб не добавлять в массив
			// закрываем все строки предыдущего назначения датой предшествующей новому назначению
			ЗакрытьСтроки(ТЗНачисления, СтрокиНачисленийТекущегоНазначения, Начисления.ПериодРаботники - 1);
			
			// меняется текущая дата движения работника
			ТекущаяДатаНазначения = Начисления.ПериодРаботники;
			
		КонецЕсли;
		
		Если НЕ Начисления.Подходит ИЛИ Начисления.УжеПроведен Тогда
			// пропускаем такие записи: они уже введена другими документами или соответствуют окончанию назначения работника
			//толик 			Продолжить;
		КонецЕсли;
		//толик
		Если НЕ ЗначениеЗаполнено(Начисления.ВидРасчета) Или 
			Начисления.ВидРасчета.СпособИспользования = Перечисления.СпособИспользованияВидаРасчета.ИспользуетсяВСдельныхНарядах Тогда
			// пропускаем такие записи: с пустым видом расчете и сделкой
			Продолжить;
		КонецЕсли;
		//
		
		Если ЗначениеЗаполнено(Начисления.ИспользуетсяВНаряде) и Начисления.ИспользуетсяВНаряде = Истина Тогда
			// пропускаем такие записи: если расчитываются в сдельном табеле
			Продолжить;
		КонецЕсли;
		
		Если Начисления.Действие <> Перечисления.ВидыДействияСНачислением.Прекратить И НЕ Начисления.ТребуетВводаТарифногоРазряда И (Начисления.КурсВалюты = NULL ИЛИ Начисления.КурсВалюты = 0) Тогда
			ОбщегоНазначения.ОшибкаРасчета("Для расчетного периода не задан курс валюты " + Начисления.Валюта + "!");
			ТЗНачисления.Очистить();
			Возврат ТЗНачисления;
		КонецЕсли;
		
		// Расчет размера начисления
		// для вечерних и ночных часов размер в регистре плановых начислений сожержит процент оплаты от тарифа/оклада
		ДляПечати = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("Сотрудник",Начисления.Сотрудник)).ДляПечати; 
		Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы
			ИЛИ Начисления.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф ИЛИ Начисления.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр Тогда  //О.Т. Аверсон 04.04.2016 № 981
			
			Показатель1 = ОбщегоНазначения.ОкруглитьПоВалюте(Начисления.Показатель1 / 100 * ТекущаяЧасоваяСтавкаОсновногоНачисления, Константы.ВалютаРегламентированногоУчета.Получить());
			Показатель2 = 0; 
			Показатель3 = 0; 
			Показатель4 = 0; 			
			Показатель5 = 0; 
			Показатель6 = 0; 		
			
		Иначе
			
			// расчета не требуется
			Если ДляПечати и (Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням или Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам или
				Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной или Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой) Тогда 
				Показатель1 = Начисления.ПоказательВВалюте;
			иначе
				Показатель1 = Начисления.Показатель1;
			КонецЕсли;
			Показатель2 = Начисления.Показатель2; 
			Показатель3 = Начисления.Показатель3; 
			Показатель4 = Начисления.Показатель4; 			
			Показатель5 = Начисления.Показатель5; 
			Показатель6 = Начисления.Показатель6; 		
			
		КонецЕсли;
		
		// Сохраним размер основного начисления для расчета размера оплаты ночных и вечерних часов
		// (основное начисление в выборке должно идти раньше других видов расчета)
		Если Начисления.ОсновноеНачисление и Начисления.ВидРасчета <> Неопределено Тогда
			ТекущаяЧасоваяСтавкаОсновногоНачисления = Начисления.ЧасоваяТарифнаяСтавка;
		КонецЕсли;
		
		// Найдем такой же вид расчета среди незакрытых строк с целью завершения его действия
		Строки = Новый Массив;
		//О.Т. Аверсон 03.04.2018  
		НезакрытыеСтроки1 = Новый Массив;
		Для Каждого стр из НезакрытыеСтроки Цикл 
			Попытка
				
				Проверка = стр.ФизЛицо;
				НезакрытыеСтроки1.Добавить(стр);
			Исключение
				
			КонецПопытки;
		КонецЦикла;
		
		НезакрытыеСтроки = НезакрытыеСтроки1;
		//О.Т. Аверсон 03.04.2018 Проверка, если строка удалена, чтоб не добавлять в массив
		
		
		//Аверсон ЕАЕ 08.03.2022 СВФР-008825
		Если Организация.ИНН = "100071565" Тогда
			СовмещаемаяПрофессия = Начисления.СовмещаемаяПрофессия;
		Иначе
			СовмещаемаяПрофессия = Неопределено;
		КонецЕсли;
		//Аверсон СВФР-008825
		
		//Аверсон ЕАЕ 29.09.2021 СВФР-008092
		//НайтиСредиНезакрытых(НезакрытыеСтроки, Начисления.ОсновноеНачисление, Начисления.ВидРасчета, Строки);
		НайтиСредиНезакрытых(НезакрытыеСтроки, Начисления.ОсновноеНачисление, Начисления.ВидРасчета, Строки, Начисления.Период, СовмещаемаяПрофессия);//Аверсон ЕАЕ 08.03.2022 СВФР-008825 (СовмещаемаяПрофессия)
		//Аверсон ЕАЕ 29.09.2021
		ПрерватьОбход = Ложь;
		Если Строки.Количество() > 0 и Начисления.ВидРасчета <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаВторогоИПоследующихДо3Лет 
			и Начисления.ВидРасчета <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаСтарше3Лет 
			и Начисления.ВидРасчета <> ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаДетейОт3До18  //О.Т. Аверсон 23.06.2016 № 1267, 1771
			и Начисления.ВидРасчета.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей
			и Начисления.ВидРасчета.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид //О.Т. Аверсон 14.06.2018 № 
			и Начисления.ВидРасчета.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида Тогда //О.Т. Аверсон 19.07.2018 № 2252
			// нашли
			Для каждого Строка Из Строки Цикл
				Если Строка.ДатаНачала = Начисления.Период Тогда
					Если Начисления.Действие = Перечисления.ВидыДействияСНачислением.Прекратить Тогда
						ИндексСтроки = НезакрытыеСтроки.Найти(Строка);
						НезакрытыеСтроки.Удалить(ИндексСтроки);
						ИндексСтроки = 0;
						Для каждого СтрокаМассива Из СтрокиНачисленийТекущегоНазначения Цикл
							Если СтрокаМассива = Строка Тогда
								СтрокиНачисленийТекущегоНазначения.Удалить(ИндексСтроки);
								Прервать;
							Иначе
								ИндексСтроки = ИндексСтроки + 1;
							КонецЕсли;
						КонецЦикла;
						ТЗНачисления.Удалить(Строка);
					Иначе
						// если дата та же - новую строку в формируемую таблицу значений не вводим, а меняем данные 
						// и оставляем строку "незакрытой"
						Строка.ВидРасчета = Начисления.ВидРасчета;// вид расчета необходимо переопределять для основного начисления
						Строка.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
						Строка.ауМестоРаботы = Начисления.ауМестоРаботы; //Аверсон 02.09.2022 КВВ СВФР-009482
						Строка.СпособРасчета = Начисления.СпособРасчета;
						Строка.ГрафикРаботы = Начисления.ГрафикРаботы;
						Строка.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
						Строка.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
						//толик стаж не затирать процент 
						Если Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС и Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням и Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом Тогда
							Строка.Показатель1 = Показатель1;
						КонецЕсли;
						Строка.Показатель2 = Показатель2;
						Строка.Показатель3 = Показатель3;
						Строка.Показатель4 = Показатель4;						
						Строка.Показатель5 = Показатель5;
						Строка.Показатель6 = Показатель6;
						Строка.ДатаОкончания = ПолучитьДатуОкончанияНачисления( Строка, Начисления ); //+ СВЭЙ КДЯ 18.03.20 СВФР-005696
					КонецЕсли;
					ПрерватьОбход = Истина;
				ИначеЕсли Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой Тогда
					// "закрываем" строку и удаляем из массива незакрытых - кроме 
					// начислений фиксированной суммой (они принудительно не разбиваются на части)
					
					//Аверсон 06.11.2019 КВВ СВФР-005007 (
					Если Начисления.Период > Начисления.ПериодРаботники И Начисления.Период < ОкончаниеПериодаЗаполнения  И (КонецДня(Строка.ДатаОкончания) + 1 = Начисления.Период) Тогда //Аверсон ЕАЕ 13.09.2021 СВФР-008124
						ПрошлаПроверкаПодр = Ложь;
						Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
							ЗапросПодр = Новый Запрос;
							ЗапросПодр.Текст = 
							"ВЫБРАТЬ РаботникиОрганизаций.Сотрудник,
							|РаботникиОрганизаций.ПодразделениеОрганизации
							|ИЗ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ДатаО) КАК  РаботникиОрганизаций
							|ГДЕ РаботникиОрганизаций.Сотрудник = &Сотрудник";
							ЗапросПодр.УстановитьПараметр("Сотрудник",Начисления.Сотрудник);
							ЗапросПодр.УстановитьПараметр("ДатаО",Начисления.Период);
							Рез = ЗапросПодр.Выполнить().Выбрать();
							Пока Рез.Следующий() Цикл
								ПодрТек = Рез.ПодразделениеОрганизации;
							КонецЦикла;
							ПрошлаПроверкаПодр = ПодрТек.ПринадлежитЭлементу( ПодразделениеОрганизации )
							ИЛИ ПодрТек = ПодразделениеОрганизации //+ СВЭЙ КДЯ 28.11.19 СВФР-005137
							;
						Иначе
							ПрошлаПроверкаПодр = Истина;
						КонецЕсли;
						Если ПрошлаПроверкаПодр Тогда
							Строка.ДатаОкончания = Начисления.Период;
						Иначе
							ПрерватьОбход = Истина; 
						КонецЕсли;
					Иначе  
						//Аверсон 06.11.2019 КВВ СВФР-005007 )
						
						//Аверсон 03.09.2019 КВВ СВФР-004691 (
						
						//+ СВЭЙ КДЯ 28.11.19 СВФР-005137
						//Если Начисления.ПериодРаботники <> Начисления.Период Тогда
						//- СВЭЙ КДЯ 28.11.19 СВФР-005137
						
						//+ СВЭЙ КДЯ 28.11.19 СВФР-005137
						//Если начисления введены серединой месяца, то они тоже дожны попасть в расчет
						//Например:  Кичигин, ВидРасчета "Увелич-е оклада за специфику (п.28,30 по ЕТС)", Процент = 30%,
						//           Начисления.ПериодРаботники = 01.10.2019 ; Начисления.Период = 17.10.2019 
						Если Начисления.ПериодРаботники <> НачалоМесяца( Начисления.Период ) 
							
							//Аверсон ЕАЕ 12.04.2022 СВФР-008942
							И НЕ (Начисления.ПериодНачисления = Начисления.Период И Начисления.Действие = Перечисления.ВидыДействияСНачислением.Изменить) Тогда
							//Аверсон СВФР-008942
							
							//- СВЭЙ КДЯ 28.11.19 СВФР-005137
							ПрерватьОбход = Истина;  
							//	ОкончаниеПериодаЗаполнения2  = Начисления.Период-1;  //Аверсон 14.10.2019 КВВ СВФР-004914 Закомментировано
						КонецЕсли;  
					КонецЕсли;
					//Аверсон 03.09.2019 КВВ СВФР-004691 )
					
					Если Не ЗначениеЗаполнено(Строка.ДатаОкончания) Или Строка.ДатаОкончания > Начисления.Период-1 Тогда
						
						//Аверсон ЕАЕ 10.12.2021 СВФР-008482
						//Строка.ДатаОкончания = Начисления.Период-1;
						Строка.ДатаОкончания = Начисления.Период - 2;
						//Аверсон СВФР-008482
						
						//Строка.ДатаОкончания = КонецМесяца(Начисления.Период);							
					КонецЕсли;
					ИндексСтроки = НезакрытыеСтроки.Найти(Строка);
					НезакрытыеСтроки.Удалить(ИндексСтроки);
					
				ИначеЕсли Начисления.ПериодНачисления = Начисления.Период  Тогда 
					// для начислений фиксированной суммой рассматриваем строки, образовавшиеся из-за изменения данных о начислении, 
					// данные о перемещениях работника пропускаем
					
					// "закрываем" строку 
					Строка.ДатаОкончания = Начисления.Период-1;
					// и удаляем из массива незакрытых - если пользователем был изменен размер начисления
					Если Начисления.Действие = Перечисления.ВидыДействияСНачислением.Изменить Тогда
						ИндексСтроки = НезакрытыеСтроки.Найти(Строка);
						НезакрытыеСтроки.Удалить(ИндексСтроки);
					КонецЕсли;
				Иначе
					ПрерватьОбход = Истина;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		Если ПрерватьОбход Или Начисления.Действие = Перечисления.ВидыДействияСНачислением.Прекратить Тогда
			Продолжить;
		КонецЕсли;
		
		// Добавим новую строку начислений
		НоваяСтрока = ТЗНачисления.Добавить();
		НоваяСтрока.Сотрудник = Начисления.Сотрудник;
		НоваяСтрока.ТабНомер = Начисления.ТабНомер; //Островская Татьяна 22.01.2014 № 17057
		НоваяСтрока.Физлицо = Начисления.Физлицо;
		НоваяСтрока.ВидРасчета = Начисления.ВидРасчета;
		если не Строка(ТипЗнч(Начисления.ВидРасчета) )="Дополнительные начисления организаций" Тогда
			НоваяСтрока.КодВычета = Начисления.КодВычета;
		Иначе 
			НоваяСтрока.КодВычета = Начисления.ВидРасчета.КодДоходаНДФЛ.КодВычета;
		КонецЕсли;
		
		Если ПроведениеРасчетов.ЭтоРасчетСеверныхНадбавок(Начисления.СпособРасчета) И Начисления.ДатаРегистрацииСеверногоСтажа <> Null Тогда
			// получим массив процентов северных надбавок с датами их действия для нашего периода
			ПроцентыСевернойНадбавки = ПроведениеРасчетов.ПолучитьПроцентыСевернойНадбавкиЗаПериод(
			Начисления.ДатаРегистрацииСеверногоСтажа, 
			Начисления.ПорядокНачисленияСеверныхНадбавок, 
			Начисления.НачальныйПроцентСевернойНадбавки,
			Начисления.СеверныйСтажМесяцев,
			Начисления.СеверныйСтажДней,
			Начисления.Период,
			ОкончаниеПериодаЗаполнения);
			НоваяСтрока.Показатель1 = ПроцентыСевернойНадбавки[0].Процент;
		ИначеЕсли ПроведениеРасчетов.ЭтоРасчетОтСтажа(Начисления.СпособРасчета) Тогда
			//Если Начисления.КоэффициентСтажа = Null Тогда
			//	КоэффициентСтажа = 0;
			//	ОбщегоНазначения.ОшибкаРасчета("Для " + Начисления.Сотрудник.Наименование + ", вид расчета """ + Начисления.ВидРасчетаНаименование+ """ не подобран размер начисления в зависимости от стажа. Размер принят равным нулю.");
			//Иначе
			//	КоэффициентСтажа = Начисления.КоэффициентСтажа;
			//КонецЕсли;
			//НоваяСтрока.Показатель1 = КоэффициентСтажа;
			//толик			
			НачисленияДатаРег = Начисления.Период; // 3200 15.02.2019
			мПроцентСтажа = ПрочиеПроцедуры.ПолучитьПроцентОтСтажаПоСотруднику(Начисления.Сотрудник, Начисления.ВидРасчета, НачисленияДатаРег,Организация);
			//О.Т. Аверсон 05.04.2016 № 1027
			ПодразделениеУчилище = Ложь;
			Если Найти(ТРег(Начисления.ПодразделениеОрганизации), "Училище")>0 Тогда 
				ПодразделениеУчилище = Истина;
			КонецЕсли;
			Если ПодразделениеУчилище Тогда 
				мПроцентСтажа = 0;
			КонецЕсли; 
			//О.Т. Аверсон 05.04.2016 № 1027
			НайденнаяСтрока = Начисления.Сотрудник.Физлицо.Стажи.Найти(Начисления.ВидРасчета.ВидСтажа, "ВидСтажа");
			Если ТипЗнч(Начисления.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
				НоваяСтрока.Показатель1 = мПроцентСтажа;
			Иначе
				НоваяСтрока.Размер = мПроцентСтажа;
			КонецЕсли;
			//НайденнаяСтрока = Начисления.Сотрудник.Физлицо.Стажи.Найти(Начисления.ВидРасчета.ВидСтажа, "ВидСтажа");
			//Если НЕ (НайденнаяСтрока = Неопределено) Тогда
			//	мВыслуга = ((Начисления.Период+86400) - НайденнаяСтрока.ДатаОтсчета)/86400/365.2555;
			//	мВСтаж = РегистрыСведений.ШкалаКоэффициентовСтажа.Выбрать(Новый Структура("КоэффициентСтажа", Начисления.ВидРасчета.КоэффициентСтажа));
			//	Пока мВСтаж.Следующий() Цикл
			//		Если (мВыслуга >= мВСтаж.СтажС) И (мВыслуга < мВСтаж.СтажПо) Тогда
			//			Если ТипЗнч(Начисления.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
			//				НоваяСтрока.Показатель1 = мВСтаж.Величина;
			//			Иначе
			//				НоваяСтрока.Размер = мВСтаж.Величина;
			//			КонецЕсли;
			//		КонецЕсли;
			//	КонецЦикла;
			//КонецЕсли;
			//енд толик	
			
			//+ СВЭЙ КДЯ 18.03.20 СВФР-005414
		ИначеЕсли Начисления.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме Тогда
			НоваяСтрока.Показатель1 = ПроведениеРасчетов.ПолучитьПроцентПоШкалеСтажа( Начисления );
			//- СВЭЙ КДЯ 18.03.20 СВФР-005414
		Иначе			
			НоваяСтрока.Показатель1 = Показатель1;
			НоваяСтрока.Показатель2 = Показатель2;
			НоваяСтрока.Показатель3 = Показатель3;
			НоваяСтрока.Показатель4 = Показатель4;								
			НоваяСтрока.Показатель5 = Показатель5;
			НоваяСтрока.Показатель6 = Показатель6;
		КонецЕсли;
		//О.Т. Аверсон 22.05.2017 № 952
		Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ВоинскоеЗвание Тогда 
			ВоинскоеЗвание = РегистрыСведений.ВоинскийУчет.ПолучитьПоследнее(Начисления.Период,Новый Структура("ФизЛицо",Начисления.ФизЛицо)).Звание; 
			РегистрКоэф = РегистрыСведений.ВоинскиеЗвания.ПолучитьПоследнее(Начисления.Период, Новый Структура("ВоинскоеЗвание",ВоинскоеЗвание)).Коэффициент; 
			НоваяСтрока.Показатель1 = РегистрКоэф;
		КонецЕсли;
		//О.Т. Аверсон 22.05.2017 № 952
		
		НоваяСтрока.Основное = Начисления.ОсновноеНачисление;
		НоваяСтрока.ДатаНачала = Начисления.Период;
		НоваяСтрока.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
		НоваяСтрока.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
		НоваяСтрока.ауМестоРаботы = Начисления.ауМестоРаботы; //Аверсон 02.09.2022 КВВ СВФР-009482
		НоваяСтрока.СпособРасчета = Начисления.СпособРасчета;
		НоваяСтрока.ВидВремени = Начисления.ВидВремени;
		НоваяСтрока.ГрафикРаботы = Начисления.ГрафикРаботы;
		НоваяСтрока.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
		//О.Т. Аверсон 13.07.2016
		Если ЗначениеЗаполнено(Начисления.ПериодЗавершения) Тогда 
			НоваяСтрока.ДатаОкончания = Начисления.ПериодЗавершения;
		КонецЕсли;
		//О.Т. Аверсон 13.07.2016
		НоваяСтрока.ДатаОкончания = ПолучитьДатуОкончанияНачисления( НоваяСтрока, Начисления ); //+ СВЭЙ КДЯ 18.03.20 СВФР-005696
		
		//Аверсон ЕАЕ 07.03.2022 СВФР-008825
		Если Организация.ИНН = "100071565" Тогда
			НоваяСтрока.СовмещаемаяПрофессия = Начисления.СовмещаемаяПрофессия;
		КонецЕсли;
		//Аверсон СВФР-008825
		
		НезакрытыеСтроки.Добавить(НоваяСтрока);
		
		Если Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой Тогда
			СтрокиНачисленийТекущегоНазначения.Добавить(НоваяСтрока);
		КонецЕсли;
		
		Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы
			ИЛИ Начисления.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф ИЛИ Начисления.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр Тогда //О.Т. Аверсон 04.04.2016 № 981
			СтрокаДоплаты = НоваяСтрока;
			
			Отбор = Новый Структура();
			Отбор.Вставить("Сотрудник", Начисления.Сотрудник);
			Отбор.Вставить("Физлицо", Начисления.Физлицо);
			Отбор.Вставить("ОсновноеНачисление", Истина);
			Строки = ВремТЗНачисления.НайтиСтроки(Отбор);
			
			ОтборДоплаты = Новый Структура();
			ОтборДоплаты.Вставить("Сотрудник", Начисления.Сотрудник);
			ОтборДоплаты.Вставить("Физлицо", Начисления.Физлицо);
			ОтборДоплаты.Вставить("ВидРасчета", Начисления.ВидРасчета);
			СтрокиДоплаты = ВремТЗНачисления.НайтиСтроки(ОтборДоплаты);
			
			
			Если Строки.Количество() > 1 И СтрокиДоплаты.Количество() < 2 Тогда
				
				КоличествоСтрок = Строки.Количество();    		
				НомерСтр = 0;
				СтрокаДоплаты.ДатаОкончания = Строки[1].Период;					
				Для Каждого СтрокаТЗНачисления Из Строки Цикл												
					НомерСтр = НомерСтр + 1;						
					СтрокаДоплаты.ДатаОкончания = СтрокаТЗНачисления.Период;
					Если НомерСтр > 1  Тогда
						СтрокаДоплаты = ТЗНачисления.Добавить();
						СтрокаДоплаты.Сотрудник = СтрокаТЗНачисления.Сотрудник;
						СтрокаДоплаты.ТабНомер = СтрокаТЗНачисления.ТабНомер;//Островская Татьяна 22.01.2014 № 17057
						СтрокаДоплаты.Физлицо = СтрокаТЗНачисления.Физлицо;
						СтрокаДоплаты.ВидРасчета = Начисления.ВидРасчета;
						СтрокаДоплаты.КодВычета = Начисления.КодВычета;
						СтрокаДоплаты.Показатель1 =  ОбщегоНазначения.ОкруглитьПоВалюте(Начисления.Показатель1 / 100 * СтрокаТЗНачисления.ЧасоваяТарифнаяСтавка,Константы.ВалютаРегламентированногоУчета.Получить());
						СтрокаДоплаты.Основное = Начисления.ОсновноеНачисление;
						СтрокаДоплаты.ДатаНачала = СтрокаТЗНачисления.Период;
						СтрокаДоплаты.ДатаНачалаСобытия = СтрокаТЗНачисления.ДатаНачалаСобытия;
						СтрокаДоплаты.ПодразделениеОрганизации = СтрокаТЗНачисления.ПодразделениеОрганизации;
						СтрокаДоплаты.ауМестоРаботы = Начисления.ауМестоРаботы; //Аверсон 02.09.2022 КВВ СВФР-009482
						СтрокаДоплаты.СпособРасчета = Начисления.СпособРасчета;
						СтрокаДоплаты.ВидВремени = Начисления.ВидВремени;
						СтрокаДоплаты.ГрафикРаботы = Начисления.ГрафикРаботы;
						СтрокаДоплаты.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;						
					КонецЕсли;										
				КонецЦикла;
				СтрокаДоплаты.ДатаОкончания = ОкончаниеПериодаЗаполнения;    		
			ИначеЕсли  Строки.Количество() > 1 Тогда
				Для Каждого СтрокаТЗДопНачисления Из СтрокиДоплаты Цикл												
					Если СтрокаТЗДопНачисления.Период = НоваяСтрока.ДатаНачала Тогда
						Для Каждого СтрокаТЗНачисления Из Строки Цикл												
							Если СтрокаТЗНачисления.Период = НоваяСтрока.ДатаНачала Тогда
								НоваяСтрока.Показатель1 =  ОбщегоНазначения.ОкруглитьПоВалюте(Начисления.Показатель1 / 100 * СтрокаТЗНачисления.ЧасоваяТарифнаяСтавка,Константы.ВалютаРегламентированногоУчета.Получить());
							КонецЕсли;
						КонецЦикла;	
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;    		
		КонецЕсли;		
		
		Если ПроведениеРасчетов.ЭтоРасчетОтСтажа(Начисления.СпособРасчета) Тогда
			//толик			//// установим дату окончания предыдущего расчета от стажа
			//		Если ПроведениеРасчетов.ЭтоРасчетОтСтажа(Начисления.СпособРасчета) И Начисления.ДеньСменыКоэффициентаСтажа <> Null Тогда
			//Если День(КонецМесяца(Начисления.Период)) >= Начисления.ДеньСменыКоэффициентаСтажа Тогда
			//	ДатаСменыКоэффициентаСтажа = Дата(Год(Начисления.Период), Месяц(Начисления.Период), Начисления.ДеньСменыКоэффициентаСтажа) - 1;
			//	Если ДатаСменыКоэффициентаСтажа > НоваяСтрока.ДатаНачала Тогда
			//		НоваяСтрока.ДатаОкончания = ДатаСменыКоэффициентаСтажа;
			//		// ... и введем еще один
			//		ДопНоваяСтрока = ТЗНачисления.Добавить();
			//		ДопНоваяСтрока.Сотрудник = Начисления.Сотрудник;
			//		ДопНоваяСтрока.Физлицо = Начисления.Физлицо;
			//		ДопНоваяСтрока.ВидРасчета = Начисления.ВидРасчета;
			//		ДопНоваяСтрока.КодВычета = Начисления.КодВычета;
			//		ДопНоваяСтрока.Показатель1 = Начисления.СледКоэффициентСтажа;				
			//		ДопНоваяСтрока.Основное = Начисления.ОсновноеНачисление;
			//		ДопНоваяСтрока.ДатаНачала = ДатаСменыКоэффициентаСтажа + 1;
			//		ДопНоваяСтрока.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
			//		ДопНоваяСтрока.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
			//		ДопНоваяСтрока.СпособРасчета = Начисления.СпособРасчета;
			//		ДопНоваяСтрока.ГрафикРаботы = Начисления.ГрафикРаботы;
			//		ДопНоваяСтрока.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
			//		
			//		НезакрытыеСтроки.Добавить(ДопНоваяСтрока);
			//		СтрокиНачисленийТекущегоНазначения.Добавить(ДопНоваяСтрока);
			//	Иначе // период записи начиался после дня изменения коэффициента стажа - запишем в ту же запись новое значение
			//		НоваяСтрока.Показатель1 = Начисления.СледКоэффициентСтажа;				
			//	КонецЕсли;
			//КонецЕсли;
			Если НЕ (НайденнаяСтрока = Неопределено) Тогда
				Попытка
					мДатаОтсчета = Дата(Год(Начисления.Период), Месяц(НайденнаяСтрока.ДатаОтсчета), День(НайденнаяСтрока.ДатаОтсчета));
					Если мДатаОтсчета > Начисления.Период И мДатаОтсчета < КонецМесяца(Начисления.Период) Тогда
						мВеличина = ПрочиеПроцедуры.ПолучитьПроцентОтСтажаПоСотруднику(Начисления.Сотрудник, Начисления.ВидРасчета, мДатаОтсчета,Организация);//Островская Татьяна 24.07.2013 № 16643
						
						//Аверсон ЕАЕ 16.01.2025 СВФР-014566
						//Если процент не поменялся, строку датой изменения стажа разбивать не будем
						мВеличинаБыло = ПрочиеПроцедуры.ПолучитьПроцентОтСтажаПоСотруднику(Начисления.Сотрудник, Начисления.ВидРасчета, мДатаОтсчета - 1, Организация);
						//Аверсон СВФР-014566
						
						//О.Т. Аверсон 05.04.2016 № 1027
						ПодразделениеУчилище = Ложь;
						Если Найти(ТРег(Начисления.ПодразделениеОрганизации), "Училище")>0 Тогда 
							ПодразделениеУчилище = Истина;
						КонецЕсли;
						Если ПодразделениеУчилище Тогда 
							мВеличина = 0;
						КонецЕсли; 
						//О.Т. Аверсон 05.04.2016 № 1027
						
						//мВыслуга = (КонецМесяца(Начисления.Период) - НайденнаяСтрока.ДатаОтсчета)/86400/365.33;
						//мВСтаж = РегистрыСведений.ШкалаКоэффициентовСтажа.Выбрать(Новый Структура("КоэффициентСтажа", Начисления.ВидРасчета.КоэффициентСтажа));
						//Пока мВСтаж.Следующий() Цикл
						//	Если (мВыслуга >= мВСтаж.СтажС) И (мВыслуга < мВСтаж.СтажПо) Тогда
						//		мВеличина = мВСтаж.Величина;
						//	КонецЕсли;
						//КонецЦикла;
						НоваяСтрока.ДатаОкончания = мДатаОтсчета - 1;
						// ... и введем еще один
						//Проверка на прекращение Начисления
						МассивПрекратить = ВремТЗНачисления.НайтиСтроки(Новый Структура("Сотрудник,ВидРасчета,Действие",Начисления.Сотрудник,Начисления.ВидРасчета,Перечисления.ВидыДействияСНачислением.Прекратить));
						если МассивПрекратить.Количество() > 0  Тогда 
							если мДатаОтсчета > МассивПрекратить[0].Период-1 Тогда 
								ВводПрекращен = Истина;
							иначе
								ВводПрекращен = Ложь;
							КонецЕсли;
						иначе
							ВводПрекращен = Ложь;
						КонецЕсли;
						
						//Аверсон ЕАЕ 16.01.2025 СВФР-014566
						//Если процент не поменялся, строку датой изменения стажа разбивать не будем
						Если мВеличина = мВеличинаБыло Тогда
							ВводПрекращен = Истина;
							НоваяСтрока.ДатаОкончания = '00010101';
						КонецЕсли;
						//Аверсон СВФР-014566
						
						если не ВводПрекращен Тогда 
							//Аверсон 21.05.2020 КВВ СВФР-006029 (
							Если ПроведениеРасчетов.ЭтоРасчетОтСтажа(Начисления.ВидРасчета.СпособРасчета) И (Начисления.Период<>НачалоМесяца(Начисления.Период) И мДатаОтсчета <> Начисления.Период) Тогда
								Продолжить;
							КонецЕсли;
							//Аверсон 21.05.2020 КВВ СВФР-006029 )
							ДопНоваяСтрока = ТЗНачисления.Добавить();
							ДопНоваяСтрока.Сотрудник = Начисления.Сотрудник;
							ДопНоваяСтрока.ТабНомер = Начисления.ТабНомер;//Островская Татьяна 22.01.2014 № 17057
							ДопНоваяСтрока.Физлицо = Начисления.Физлицо;
							ДопНоваяСтрока.ВидРасчета = Начисления.ВидРасчета;
							ДопНоваяСтрока.КодВычета = Начисления.КодВычета;
							Если ТипЗнч(Начисления.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
								ДопНоваяСтрока.Показатель1 = мВеличина;				
							Иначе
								ДопНоваяСтрока.Размер = мВеличина;
							КонецЕсли;
							ДопНоваяСтрока.Основное = Начисления.ОсновноеНачисление;
							ДопНоваяСтрока.ДатаНачала = мДатаОтсчета;
							ДопНоваяСтрока.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
							ДопНоваяСтрока.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
							ДопНоваяСтрока.ауМестоРаботы = Начисления.ауМестоРаботы; //Аверсон 02.09.2022 КВВ СВФР-009482
							ДопНоваяСтрока.СпособРасчета = Начисления.СпособРасчета;
							ДопНоваяСтрока.ГрафикРаботы = Начисления.ГрафикРаботы;
							ДопНоваяСтрока.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
							
							НезакрытыеСтроки.Добавить(ДопНоваяСтрока);
							СтрокиНачисленийТекущегоНазначения.Добавить(ДопНоваяСтрока);
						КонецЕсли;
					КонецЕсли;
				Исключение
					
				КонецПопытки;
			КонецЕсли;
		ИначеЕсли ПроведениеРасчетов.ЭтоРасчетСеверныхНадбавок(Начисления.СпособРасчета) И Начисления.ДатаРегистрацииСеверногоСтажа <> Null Тогда
			Если ПроцентыСевернойНадбавки.Количество() > 1 Тогда
				Если ПроцентыСевернойНадбавки[0].Процент <= 0 Тогда
					
					НоваяСтрока.ДатаНачала = Дата(Год(Начисления.Период), Месяц(Начисления.Период), День(ПроцентыСевернойНадбавки[1].Период));
					НоваяСтрока.Показатель1 = ПроцентыСевернойНадбавки[1].Процент;
					
				Иначе
					
					// установим дату окончания предыдущего расчета от стажа
					НоваяСтрока.ДатаОкончания = Дата(Год(Начисления.Период), Месяц(Начисления.Период), День(ПроцентыСевернойНадбавки[1].Период)) - 1;
					
					// ... и введем дополнительную
					// предполагаем, что в течение одного расчетного периода (месяца) не может произойти несколько 
					// изменений процента северной надбавки
					ДопНоваяСтрока = ТЗНачисления.Добавить();
					ДопНоваяСтрока.Сотрудник = Начисления.Сотрудник;
					ДопНоваяСтрока.ТабНомер = Начисления.ТабНомер;//Островская Татьяна 22.01.2014 № 17057
					ДопНоваяСтрока.Физлицо = Начисления.Физлицо;
					ДопНоваяСтрока.ВидРасчета = Начисления.ВидРасчета;
					ДопНоваяСтрока.КодВычета = Начисления.КодВычета;					
					ДопНоваяСтрока.Показатель1 = ПроцентыСевернойНадбавки[1].Процент;
					ДопНоваяСтрока.Основное = Начисления.ОсновноеНачисление;
					ДопНоваяСтрока.ДатаНачала = Дата(Год(Начисления.Период), Месяц(Начисления.Период), День(ПроцентыСевернойНадбавки[1].Период));
					ДопНоваяСтрока.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
					ДопНоваяСтрока.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
					ДопНоваяСтрока.ауМестоРаботы = Начисления.ауМестоРаботы; //Аверсон 02.09.2022 КВВ СВФР-009482
					ДопНоваяСтрока.СпособРасчета = Начисления.СпособРасчета;
					ДопНоваяСтрока.ГрафикРаботы = Начисления.ГрафикРаботы;
					ДопНоваяСтрока.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
					
					НезакрытыеСтроки.Добавить(ДопНоваяСтрока);
					СтрокиНачисленийТекущегоНазначения.Добавить(ДопНоваяСтрока);
					
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		////О.Т. Аверсон 18.05.2017 № 952
		//Если Организация.ДенежноеДовольствие Тогда 
		//	Если Начисления.Сотрудник <> СотрудникПрошл Тогда 
		//		НоваяСтрока1 = ТЗНачисления.Добавить();
		//		НоваяСтрока1.Сотрудник = Начисления.Сотрудник;
		//		НоваяСтрока1.ТабНомер = Начисления.ТабНомер; //Островская Татьяна 22.01.2014 № 17057
		//		НоваяСтрока1.Физлицо = Начисления.Физлицо;
		//		НоваяСтрока1.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ВоинскоеЗвание;
		//		
		//		ВоинскоеЗвание = РегистрыСведений.ВоинскийУчет.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ФизЛицо",Начисления.ФизЛицо)).Звание; 
		//		РегистрКоэф = РегистрыСведений.ВоинскиеЗвания.ПолучитьПоследнее(ПериодРегистрации, Новый Структура("ВоинскоеЗвание",ВоинскоеЗвание)).Коэффициент; 
		//		НоваяСтрока1.Показатель1 = РегистрКоэф;
		//		
		//		НоваяСтрока1.ДатаНачала = Начисления.Период;
		//		НоваяСтрока1.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
		//		//НоваяСтрока.ДатаОкончания = Начисления.ПериодДействияКонец;
		//		НоваяСтрока1.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
		//		НоваяСтрока1.СпособРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ВоинскоеЗвание.СпособРасчета;
		//		НоваяСтрока1.ВидВремени = Начисления.ВидВремени;
		//		НоваяСтрока1.ГрафикРаботы = Начисления.ГрафикРаботы;
		//		
		//		НоваяСтрока1.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
		//		НоваяСтрока1.Основное = Ложь;  
		//		НезакрытыеСтроки.Добавить(НоваяСтрока1);
		//	КонецЕсли;
		//	
		//КонецЕсли;
		////О.Т. Аверсон 18.05.2017 № 952
		
		СотрудникПрошл = Начисления.Сотрудник;//О.Т. Аверсон 18.05.2017 № 952
		
		ОбработкаПрерыванияПользователя();
	КонецЦикла;
	//О.Т. Аверсон 03.04.2018  
	НезакрытыеСтроки1 = Новый Массив;
	Для Каждого стр из НезакрытыеСтроки Цикл 
		Попытка
			
			Проверка = стр.ФизЛицо;
			НезакрытыеСтроки1.Добавить(стр);
		Исключение
			
		КонецПопытки;
	КонецЦикла;
	
	НезакрытыеСтроки = НезакрытыеСтроки1;
	//О.Т. Аверсон 03.04.2018 Проверка, если строка удалена, чтоб не добавлять в массив
	
	// закрываем незакрытые строки по последнему работнику концом месяца
	ЗакрытьСтроки(ТЗНачисления, НезакрытыеСтроки, ОкончаниеПериодаЗаполнения2);  //Аверсон 03.09.2019 КВВ СВФР-004691 : Замена ОкончаниеПериодаЗаполнения на ОкончаниеПериодаЗаполнения2
	
	//Аверсон 07.08.2024 ПСА СВФР-013531 +++ 
	ТзВременная = ТЗНачисления.Скопировать(,"Сотрудник");
	ТзВременная.Свернуть("Сотрудник");
	МассивСотрудников = ТзВременная.ВыгрузитьКолонку("Сотрудник");
	
	Для Каждого ЭлементМассива Из МассивСотрудников Цикл 
		ПараметрыОтбора = Новый Структура();
		ПараметрыОтбора.Вставить("Сотрудник", ЭлементМассива);
		НайденныеСтроки = ТЗНачисления.НайтиСтроки(ПараметрыОтбора);
		
		ВРОтСтажаПоСумме = Неопределено; ДатаВРОтСтажаПоСумме = Дата(1,1,1);
		Для Каждого Начисления Из НайденныеСтроки Цикл
			Если Начисления.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме Тогда
				ВРОтСтажаПоСумме = Начисления.ВидРасчета;
				ДатаВРОтСтажаПоСумме = Начисления.ДатаНачала;
			КонецЕсли;
		КонецЦикла; 
		
		Если ВРОтСтажаПоСумме <> Неопределено Тогда
			ПродолжатьОтСтажаПоСумме = Истина;  ПроцентПоШкалеСтажаОтСтажаПоСумме = 0;
			Для АдляВР = 1 По 2 Цикл
				ЗВРОтСтажаПоСумме = Новый Запрос;
				ЗВРОтСтажаПоСумме.Текст = "ВЫБРАТЬ
				|ВЫРАЗИТЬ(
				|(((РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней), &ДатаСравнения, МЕСЯЦ) 
				|+ ВЫБОР
				|КОГДА МЕСЯЦ(&ДатаСравнения) = МЕСЯЦ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней))
				|ТОГДА (ДЕНЬ(&ДатаСравнения) - ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней))) / 30
				|ИНАЧЕ 0
				|КОНЕЦ)/12)-0.5) КАК ЧИСЛО(2,0)) КАК СтажМесяцевНА12 
				|ИЗ Справочник.ФизическиеЛица.Стажи КАК ФизическиеЛицаСтажи
				|ГДЕ
				|ФизическиеЛицаСтажи.Ссылка = &ФизЛицо
				|И ФизическиеЛицаСтажи.ВидСтажа = &ВидСтажа
				|И ФизическиеЛицаСтажи.ДатаОтсчета <> ДатаВремя(1,1,1)";
				ЗВРОтСтажаПоСумме.УстановитьПараметр("ФизЛицо",Начисления.Сотрудник.ФизЛицо);
				ЗВРОтСтажаПоСумме.УстановитьПараметр("ВидСтажа",ВРОтСтажаПоСумме.ВидСтажа);
				ЗВРОтСтажаПоСумме.УстановитьПараметр("ДатаСравнения",?(АдляВР=1,НачалоМесяца(ДатаВРОтСтажаПоСумме),КонецМесяца(ДатаВРОтСтажаПоСумме)));
				
				РезЗВРОтСтажаПоСумме = ЗВРОтСтажаПоСумме.Выполнить().Выгрузить();
				Если РезЗВРОтСтажаПоСумме.Количество() > 0 Тогда
					СтажМесяцевНА12 = РезЗВРОтСтажаПоСумме[0].СтажМесяцевНА12;
					
					ЗШкала = Новый Запрос;
					ЗШкала.Текст = "ВЫБРАТЬ ПЕРВЫЕ 1
					|ШкалаКоэффициентовСтажа.Величина КАК ПроцентПоШкалеСтажа
					|ИЗ РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаКоэффициентовСтажа
					|ГДЕ
					|ШкалаКоэффициентовСтажа.КоэффициентСтажа = &КоэффициентСтажа
					|И ШкалаКоэффициентовСтажа.СтажС <= &Стаж
					|И ШкалаКоэффициентовСтажа.СтажПо > &Стаж";
					ЗШкала.УстановитьПараметр("КоэффициентСтажа",ВРОтСтажаПоСумме.КоэффициентСтажа);
					ЗШкала.УстановитьПараметр("Стаж",СтажМесяцевНА12);
					РезЗШкала = ЗШкала.Выполнить().Выгрузить();
					Если РезЗШкала.Количество() > 0 Тогда
						Если АдляВР = 1 Тогда
							ПроцентПоШкалеСтажаОтСтажаПоСумме = РезЗШкала[0].ПроцентПоШкалеСтажа;
						Иначе
							Если ПроцентПоШкалеСтажаОтСтажаПоСумме <> РезЗШкала[0].ПроцентПоШкалеСтажа Тогда
								ПродолжатьОтСтажаПоСумме = Ложь;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
			
			Если НЕ ПродолжатьОтСтажаПоСумме Тогда
				МассивСтрокДляУдаления = Новый Массив();
				ИндексВР = НайденныеСтроки.Количество() - 1;       
				Пока ИндексВР >= 0 Цикл      
					Если НайденныеСтроки[ИндексВР].ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме Тогда      
						МассивСтрокДляУдаления.Добавить(НайденныеСтроки[ИндексВР]);
					КонецЕсли;       
					ИндексВР = ИндексВР - 1; 
				КонецЦикла;
				Для Каждого ЭлементУдаления Из МассивСтрокДляУдаления Цикл
					ТЗНачисления.Удалить(ЭлементУдаления);                       
				КонецЦикла	
			Иначе
				ВРОтСтажаПоСумме = Неопределено; ДатаВРОтСтажаПоСумме = Дата(1,1,1);
			КонецЕсли;
		КонецЕсли;
		
		ПараметрыОтбора = Новый Структура();
		ПараметрыОтбора.Вставить("Сотрудник", ЭлементМассива);
		НайденныеСтроки = ТЗНачисления.НайтиСтроки(ПараметрыОтбора);

		//толик
		Для Каждого Начисления Из НайденныеСтроки Цикл
			Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам
				ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням
				ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной
				ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой 
				ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СдельнаяОплата 
				ИЛИ Справочники.ГруппыРасчетов.ДопВидыНачисленийДляТабеля.Основные.Найти(Начисления.ВидРасчета,"ВидРасчета") <> Неопределено Тогда //Аверсон 12.07.2022 КВВ СВФР-009328
				//Аверсон-софт, Островская Татьяна 08.06.2012 № 15474
				мДопНачиления = Истина;
				ПрочиеПроцедуры.ЗаполнитьНачисленияДополнительнымиВидамиРасчета(Начисления, ТЗНачисления, мДопНачиления,Организация, ВРОтСтажаПоСумме);//Наркевич 27.03.2014 №17231 //Аверсон 24.01.2023 КВВ СВФР-010220 (ВРОтСтажаПоСумме)
				//Аверсон-софт, Островская Татьяна 08.06.2012 № 15474
			КонецЕсли;
		КонецЦикла;

	КонецЦикла;	
	//
	////Аверсон 24.01.2023 КВВ СВФР-010220 (
	//ВРОтСтажаПоСумме = Неопределено; ДатаВРОтСтажаПоСумме = Дата(1,1,1);
	//Для Каждого Начисления Из ТЗНачисления Цикл
	//	Если Начисления.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме Тогда
	//		ВРОтСтажаПоСумме = Начисления.ВидРасчета;
	//		ДатаВРОтСтажаПоСумме = Начисления.ДатаНачала;
	//	КонецЕсли;
	//КонецЦикла;
	//Если ВРОтСтажаПоСумме <> Неопределено Тогда
	//	ПродолжатьОтСтажаПоСумме = Истина;  ПроцентПоШкалеСтажаОтСтажаПоСумме = 0;
	//	Для АдляВР = 1 По 2 Цикл
	//		ЗВРОтСтажаПоСумме = Новый Запрос;
	//		ЗВРОтСтажаПоСумме.Текст = "ВЫБРАТЬ
	//		|ВЫРАЗИТЬ(
	//		|(((РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней), &ДатаСравнения, МЕСЯЦ) 
	//		|+ ВЫБОР
	//		|КОГДА МЕСЯЦ(&ДатаСравнения) = МЕСЯЦ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней))
	//		|ТОГДА (ДЕНЬ(&ДатаСравнения) - ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ФизическиеЛицаСтажи.ДатаОтсчета, МЕСЯЦ, -ФизическиеЛицаСтажи.РазмерМесяцев), ДЕНЬ, -ФизическиеЛицаСтажи.РазмерДней))) / 30
	//		|ИНАЧЕ 0
	//		|КОНЕЦ)/12)-0.5) КАК ЧИСЛО(2,0)) КАК СтажМесяцевНА12 
	//		|ИЗ Справочник.ФизическиеЛица.Стажи КАК ФизическиеЛицаСтажи
	//		|ГДЕ
	//		|ФизическиеЛицаСтажи.Ссылка = &ФизЛицо
	//		|И ФизическиеЛицаСтажи.ВидСтажа = &ВидСтажа";
	//		ЗВРОтСтажаПоСумме.УстановитьПараметр("ФизЛицо",Начисления.Сотрудник.ФизЛицо);
	//		ЗВРОтСтажаПоСумме.УстановитьПараметр("ВидСтажа",ВРОтСтажаПоСумме.ВидСтажа);
	//		ЗВРОтСтажаПоСумме.УстановитьПараметр("ДатаСравнения",?(АдляВР=1,НачалоМесяца(ДатаВРОтСтажаПоСумме),КонецМесяца(ДатаВРОтСтажаПоСумме)));
	//		
	//		РезЗВРОтСтажаПоСумме = ЗВРОтСтажаПоСумме.Выполнить().Выгрузить();
	//		Если РезЗВРОтСтажаПоСумме.Количество() > 0 Тогда
	//			СтажМесяцевНА12 = РезЗВРОтСтажаПоСумме[0].СтажМесяцевНА12;
	//			
	//			ЗШкала = Новый Запрос;
	//			ЗШкала.Текст = "ВЫБРАТЬ ПЕРВЫЕ 1
	//			|ШкалаКоэффициентовСтажа.Величина КАК ПроцентПоШкалеСтажа
	//			|ИЗ РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаКоэффициентовСтажа
	//			|ГДЕ
	//			|ШкалаКоэффициентовСтажа.КоэффициентСтажа = &КоэффициентСтажа
	//			|И ШкалаКоэффициентовСтажа.СтажС <= &Стаж
	//			|И ШкалаКоэффициентовСтажа.СтажПо > &Стаж";
	//			ЗШкала.УстановитьПараметр("КоэффициентСтажа",ВРОтСтажаПоСумме.КоэффициентСтажа);
	//			ЗШкала.УстановитьПараметр("Стаж",СтажМесяцевНА12);
	//			РезЗШкала = ЗШкала.Выполнить().Выгрузить();
	//			Если РезЗШкала.Количество() > 0 Тогда
	//				Если АдляВР = 1 Тогда
	//					ПроцентПоШкалеСтажаОтСтажаПоСумме = РезЗШкала[0].ПроцентПоШкалеСтажа;
	//				Иначе
	//					Если ПроцентПоШкалеСтажаОтСтажаПоСумме <> РезЗШкала[0].ПроцентПоШкалеСтажа Тогда
	//						ПродолжатьОтСтажаПоСумме = Ложь;
	//					КонецЕсли;
	//				КонецЕсли;
	//			КонецЕсли;
	//		КонецЕсли;
	//	КонецЦикла;
	//	
	//	Если НЕ ПродолжатьОтСтажаПоСумме Тогда
	//		СтаршийИндексКолонокВР = ТЗНачисления.Колонки.Количество() - 1;  
	//		ИндексВР = ТЗНачисления.Количество() - 1;       
	//		Пока ИндексВР >= 0 Цикл      
	//			Для Сч = 0 По СтаршийИндексКолонокВР Цикл       
	//				Если ТЗНачисления[ИндексВР].ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоСумме Тогда      
	//					ТЗНачисления.Удалить(ИндексВР);      
	//					Прервать;      
	//				КонецЕсли;       
	//			КонецЦикла;       
	//			ИндексВР = ИндексВР - 1; 
	//		КонецЦикла;
	//	Иначе
	//		ВРОтСтажаПоСумме = Неопределено; ДатаВРОтСтажаПоСумме = Дата(1,1,1);
	//	КонецЕсли;
	//КонецЕсли;
	////Аверсон 24.01.2023 КВВ СВФР-010220 )
	//
	////толик
	//Для Каждого Начисления Из ТЗНачисления Цикл
	//	Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам
	//		ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням
	//		ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной
	//		ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой 
	//		ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СдельнаяОплата 
	//		ИЛИ Справочники.ГруппыРасчетов.ДопВидыНачисленийДляТабеля.Основные.Найти(Начисления.ВидРасчета,"ВидРасчета") <> Неопределено Тогда //Аверсон 12.07.2022 КВВ СВФР-009328
	//		//Аверсон-софт, Островская Татьяна 08.06.2012 № 15474
	//		мДопНачиления = Истина;
	//		ПрочиеПроцедуры.ЗаполнитьНачисленияДополнительнымиВидамиРасчета(Начисления, ТЗНачисления, мДопНачиления,Организация, ВРОтСтажаПоСумме);//Наркевич 27.03.2014 №17231 //Аверсон 24.01.2023 КВВ СВФР-010220 (ВРОтСтажаПоСумме)
	//		//Аверсон-софт, Островская Татьяна 08.06.2012 № 15474
	//	КонецЕсли;
	//КонецЦикла; 
	//+++Аверсон 07.08.2024 ПСА СВФР-013531
	если не ТЧРаботавшиеВПраздники = Неопределено и не ДопНачисления и Организация.ИНН = "100765738" Тогда 
		для Каждого стрРаботавшиеВПраздники из ТЧРаботавшиеВПраздники Цикл 
			Если ?(ЗначениеЗаполнено(ПодразделениеОрганизации),ПодразделениеОрганизации = стрРаботавшиеВПраздники.ПодразделениеОрганизации,истина) Тогда //О.Т. Аверсон 27.02.2019 № 3184
				СтрРабПраздники = ТЗНачисления.Добавить();
				
				ЗаполнитьЗначенияСвойств(СтрРабПраздники,стрРаботавшиеВПраздники);
				
				СтрРабПраздники.ФизЛицо = стрРаботавшиеВПраздники.Сотрудник.ФизЛицо;
				СтрРабПраздники.СпособРасчета = Начисления.ВидРасчета.СпособРасчета;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	// ИндексацияЗП из разовых начислений
	//О.Т. Аверсон 05.12.2016 № 1501
	Если не ДопНачисления Тогда 
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
		|	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|	ОсновныеНачисленияРаботниковОрганизаций.Организация,
		|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
		|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,
		|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
		|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
		|	ОсновныеНачисленияРаботниковОрганизаций.Показатель1,
		|	ОсновныеНачисленияРаботниковОрганизаций.Результат,
		|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник.Код КАК ТабНомер,
		|	ОсновныеНачисленияРаботниковОрганизаций.Показатель2,
		|	ОсновныеНачисленияРаботниковОрганизаций.Показатель3,
		|	ОсновныеНачисленияРаботниковОрганизаций.Показатель4,
		|	ОсновныеНачисленияРаботниковОрганизаций.Показатель5,
		|	ОсновныеНачисленияРаботниковОрганизаций.Показатель6,
		|	ОсновныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации,
		|	ОсновныеНачисленияРаботниковОрганизаций.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
		|	ОсновныеНачисленияРаботниковОрганизаций.Должность,
		|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета КАК СпособРасчета,
		|	ОсновныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
		|	ОсновныеНачисленияРаботниковОрганизаций.ГрафикРаботы,
		|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ВидВремени КАК ВидВремени,
		|	ЕСТЬNULL(ОсновныеНачисленияРаботниковОрганизаций.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени
		|ИЗ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		|ГДЕ
		|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &СпособРасчета
		|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало МЕЖДУ &ПериодДействияНачало И &ПериодДействияКонец
		|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В(&Сотрудник)";
		
		Запрос.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП);
		Запрос.УстановитьПараметр("ПериодДействияКонец", КонецМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("ПериодДействияНачало", НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("Сотрудник", ТЗСотрудники);
		
		РезультатЗапроса = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Пока ВыборкаДетальныеЗаписи.Следующий() и ВыборкаДетальныеЗаписи.Результат = 0 Цикл  
			НоваяСтрока = ТЗНачисления.Добавить();
			НоваяСтрока.Сотрудник = ВыборкаДетальныеЗаписи.Сотрудник;
			НоваяСтрока.ТабНомер = ВыборкаДетальныеЗаписи.ТабНомер; //Островская Татьяна 22.01.2014 № 17057
			НоваяСтрока.Физлицо = ВыборкаДетальныеЗаписи.Физлицо;
			НоваяСтрока.ВидРасчета = ВыборкаДетальныеЗаписи.ВидРасчета;
			НоваяСтрока.Показатель1 = ВыборкаДетальныеЗаписи.Показатель1;
			НоваяСтрока.Показатель2 = ВыборкаДетальныеЗаписи.Показатель2;
			НоваяСтрока.Показатель3 = ВыборкаДетальныеЗаписи.Показатель3;
			НоваяСтрока.Показатель4 = ВыборкаДетальныеЗаписи.Показатель4;								
			НоваяСтрока.Показатель5 = ВыборкаДетальныеЗаписи.Показатель5;
			НоваяСтрока.Показатель6 = ВыборкаДетальныеЗаписи.Показатель6;
			НоваяСтрока.ДатаНачала = ВыборкаДетальныеЗаписи.ПериодДействияНачало;
			НоваяСтрока.ДатаНачалаСобытия = ВыборкаДетальныеЗаписи.ДатаНачалаСобытия;
			НоваяСтрока.ДатаОкончания = ВыборкаДетальныеЗаписи.ПериодДействияКонец;
			НоваяСтрока.ПодразделениеОрганизации = ВыборкаДетальныеЗаписи.ПодразделениеОрганизации;
			НоваяСтрока.ауМестоРаботы = ВыборкаДетальныеЗаписи.ауМестоРаботы; //Аверсон 02.09.2022 КВВ СВФР-009482
			НоваяСтрока.СпособРасчета = ВыборкаДетальныеЗаписи.СпособРасчета;
			НоваяСтрока.ВидВремени = ВыборкаДетальныеЗаписи.ВидВремени;
			НоваяСтрока.ГрафикРаботы = ВыборкаДетальныеЗаписи.ГрафикРаботы;
			НоваяСтрока.СуммированныйУчетРабочегоВремени = ВыборкаДетальныеЗаписи.СуммированныйУчетРабочегоВремени;
			НоваяСтрока.Основное = Ложь;
			
		КонецЦикла;
	КонецЕсли;
	//О.Т. Аверсон 05.12.2016 № 1501
	
	//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
	
	
	ТЗНачисления.Сортировать("ТабНомер Возр, Сотрудник Возр, ДатаНачала Возр"); //Островская Татьяна 22.01.2014 № 17057
	//ПСА 06.10.2021 СВФР-008235 +++
	ТЗНачисления.Колонки.Добавить("Должность"); 
	
	ДолжностьСтроки = "";
	ДатаНачалаДляДолжности = "";
	СотрудникДляДолжности = "";
	Для Каждого СтрокаТЗ Из ТЗНачисления Цикл
		Если ДатаНачалаДляДолжности <> СтрокаТЗ.ДатаНачала
			или СотрудникДляДолжности <> СтрокаТЗ.Сотрудник Тогда
			ЗапросДолжность = Новый Запрос;
			ЗапросДолжность.Текст = 
			"ВЫБРАТЬ
			|	РаботникиОрганизацийСрезПоследних.Должность
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ДатаСреза, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних
			|ГДЕ
			|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = &ПодразделениеОрганизации";
			
			ЗапросДолжность.УстановитьПараметр("ДатаСреза", СтрокаТЗ.ДатаНачала);
			ЗапросДолжность.УстановитьПараметр("ПодразделениеОрганизации", СтрокаТЗ.ПодразделениеОрганизации);
			ЗапросДолжность.УстановитьПараметр("Сотрудник", СтрокаТЗ.Сотрудник);
			
			РезультатЗапросаДолжности = ЗапросДолжность.Выполнить();
			
			ВыборкаДолжности = РезультатЗапросаДолжности.Выбрать();
			ДолжностьСтроки = "";
			ДатаНачалаДляДолжности = СтрокаТЗ.ДатаНачала;
			СотрудникДляДолжности = СтрокаТЗ.Сотрудник;
			
			Если ВыборкаДолжности.Следующий() Тогда
				ДолжностьСтроки = ВыборкаДолжности.Должность;
			КонецЕсли;
		КонецЕсли;
		СтрокаТЗ.Должность = ДолжностьСтроки;
	КонецЦикла;	
	//+++ПСА 06.10.2021 СВФР-008235
	
	//енд толик
	
	//Аверсон 02.09.2022 КВВ СВФР-009482 (
	ауМестоРаботыСтроки = "";
	ДатаНачалаДляМР = "";
	СотрудникДляМР = "";
	Для Каждого СтрокаТЗ Из ТЗНачисления Цикл
		Если ДатаНачалаДляМР <> СтрокаТЗ.ДатаНачала
			Или СотрудникДляМР <> СтрокаТЗ.Сотрудник Тогда
			ЗапросМР = Новый Запрос;
			ЗапросМР.Текст = 
			"ВЫБРАТЬ
			|	РаботникиОрганизацийСрезПоследних.ауМестоРаботы
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ДатаСреза, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних
			|ГДЕ
			|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации = &ПодразделениеОрганизации";
			
			ЗапросМР.УстановитьПараметр("ДатаСреза", СтрокаТЗ.ДатаНачала);
			ЗапросМР.УстановитьПараметр("ПодразделениеОрганизации", СтрокаТЗ.ПодразделениеОрганизации);
			ЗапросМР.УстановитьПараметр("Сотрудник", СтрокаТЗ.Сотрудник);
			
			РезультатЗапросаМР = ЗапросМР.Выполнить();
			
			ВыборкаМР = РезультатЗапросаМР.Выбрать();
			ауМестоРаботыСтроки = "";
			ДатаНачалаДляМР = СтрокаТЗ.ДатаНачала;
			СотрудникДляМР = СтрокаТЗ.Сотрудник;
			
			Если ВыборкаМР.Следующий() Тогда
				ауМестоРаботыСтроки = ВыборкаМР.ауМестоРаботы;
			КонецЕсли;
		КонецЕсли;
		СтрокаТЗ.ауМестоРаботы = ауМестоРаботыСтроки;
	КонецЦикла;	
	////Аверсон 02.09.2022 КВВ СВФР-009482 )
	
	Возврат ТЗНачисления;
	
КонецФункции

//Аверсон-софт, Островская Татьяна 13.03.2012
Функция СформироватьТаблицуДоговорыНаВыполнениеРабот(ДоговорыНаВыполнениеРабот, ОкончаниеПериодаЗаполнения, ВремТЗНачисления)
	
	ТЗДоговорыНаВыполнениеРабот = Новый ТаблицаЗначений();
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("Сотрудник");
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ДатаНачала", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ДатаОкончания", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ДокументОснование");
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("Размер");
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ВидРасчета");
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("Результат");
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ПодразделениеОрганизации");//О.Т. Аверсон 16.03.2018 № 1731
	
	// Массив незакрытых строк таблицы значений, т.е. тех, которым не проставлена дата окончания
	НезакрытыеСтроки = Новый Массив;
	// Текущие значения полей выборки для отслеживания изменения работника и даты назначения 
	ТекущийСотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
	ТекущаяДатаНазначения = '00010101';
	ТекущаяЧасоваяСтавкаОсновногоНачисления = 0;
	СтрокиНачисленийТекущегоНазначения = Новый Массив;
	
	Пока ДоговорыНаВыполнениеРабот.Следующий() Цикл
		
		Если ДоговорыНаВыполнениеРабот.Сотрудник <> ТекущийСотрудник Тогда
			
			// закрываем незакрытые строки начислений предыдущего работника концом месяца
			ЗакрытьСтроки(ТЗДоговорыНаВыполнениеРабот, НезакрытыеСтроки, ОкончаниеПериодаЗаполнения);
			
			// меняется текущий работник и дата его движения
			ТекущийСотрудник = ДоговорыНаВыполнениеРабот.Сотрудник;
			//ТекущаяДатаНазначения = Начисления.ПериодРаботники;
			ТекущаяЧасоваяСтавкаОсновногоНачисления = 0;
			СтрокиНачисленийТекущегоНазначения.Очистить();
			
			//ИначеЕсли Начисления.ПериодРаботники <> ТекущаяДатаНазначения Тогда
			//	
			//	Для каждого СтрокаТекущегоНазначения Из СтрокиНачисленийТекущегоНазначения Цикл
			//		
			//		ИндексСтроки = 0;
			//		Для каждого СтрокаМассива Из НезакрытыеСтроки Цикл
			//			Если СтрокаМассива = СтрокаТекущегоНазначения Тогда
			//				НезакрытыеСтроки.Удалить(ИндексСтроки);
			//				Прервать;
			//			Иначе
			//				ИндексСтроки = ИндексСтроки + 1;
			//			КонецЕсли;
			//		КонецЦикла;
			//		
			//	КонецЦикла;
			//	
			//	// закрываем все строки предыдущего назначения датой предшествующей новому назначению
			//	ЗакрытьСтроки(ТЗНачисления, СтрокиНачисленийТекущегоНазначения, Начисления.ПериодРаботники - 1);
			//	
			//	// меняется текущая дата движения работника
			//	ТекущаяДатаНазначения = Начисления.ПериодРаботники;
			
		КонецЕсли;
		
		
		//толик
		//Если НЕ ЗначениеЗаполнено(Начисления.ВидРасчета) Или 
		//	Начисления.ВидРасчета.СпособИспользования = Перечисления.СпособИспользованияВидаРасчета.ИспользуетсяВСдельныхНарядах Тогда
		//	// пропускаем такие записи: с пустым видом расчете и сделкой
		//	Продолжить;
		//КонецЕсли;
		//
		
		//Если ЗначениеЗаполнено(Начисления.ИспользуетсяВНаряде) и Начисления.ИспользуетсяВНаряде = Истина Тогда
		//	// пропускаем такие записи: если расчитываются в сдельном табеле
		//	Продолжить;
		//КонецЕсли;
		
		//Если Начисления.Действие <> Перечисления.ВидыДействияСНачислением.Прекратить И НЕ Начисления.ТребуетВводаТарифногоРазряда И (Начисления.КурсВалюты = NULL ИЛИ Начисления.КурсВалюты = 0) Тогда
		//	ОбщегоНазначения.ОшибкаРасчета("Для расчетного периода не задан курс валюты " + Начисления.Валюта + "!");
		//	ТЗНачисления.Очистить();
		//	Возврат ТЗНачисления;
		//КонецЕсли;
		
		// Расчет размера начисления
		// для вечерних и ночных часов размер в регистре плановых начислений сожержит процент оплаты от тарифа/оклада
		//Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы Тогда
		//	
		//	Показатель1 = ОбщегоНазначения.ОкруглитьПоВалюте(Начисления.Показатель1 / 100 * ТекущаяЧасоваяСтавкаОсновногоНачисления, Константы.ВалютаРегламентированногоУчета.Получить());
		//	Показатель2 = 0; 
		//	Показатель3 = 0; 
		//	Показатель4 = 0; 			
		//	Показатель5 = 0; 
		//	Показатель6 = 0; 		
		//	
		//Иначе
		//	
		//	// расчета не требуется
		//	Показатель1 = Начисления.Показатель1; 
		//	Показатель2 = Начисления.Показатель2; 
		//	Показатель3 = Начисления.Показатель3; 
		//	Показатель4 = Начисления.Показатель4; 			
		//	Показатель5 = Начисления.Показатель5; 
		//	Показатель6 = Начисления.Показатель6; 		
		//	
		//КонецЕсли;
		
		// Сохраним размер основного начисления для расчета размера оплаты ночных и вечерних часов
		// (основное начисление в выборке должно идти раньше других видов расчета)
		//Если Начисления.ОсновноеНачисление и Начисления.ВидРасчета <> Неопределено Тогда
		//	ТекущаяЧасоваяСтавкаОсновногоНачисления = Начисления.ЧасоваяТарифнаяСтавка;
		//КонецЕсли;
		
		// Найдем такой же вид расчета среди незакрытых строк с целью завершения его действия
		//Строки = Новый Массив;
		////НайтиСредиНезакрытых(НезакрытыеСтроки, Начисления.ОсновноеНачисление, Начисления.ВидРасчета, Строки);
		//ПрерватьОбход = Ложь;
		//Если Строки.Количество() > 0 Тогда
		//	// нашли
		//	Для каждого Строка Из Строки Цикл
		//		Если Строка.ДатаНачала = Начисления.Период Тогда
		//			Если Начисления.Действие = Перечисления.ВидыДействияСНачислением.Прекратить Тогда
		//				ИндексСтроки = НезакрытыеСтроки.Найти(Строка);
		//				НезакрытыеСтроки.Удалить(ИндексСтроки);
		//				ИндексСтроки = 0;
		//				Для каждого СтрокаМассива Из СтрокиНачисленийТекущегоНазначения Цикл
		//					Если СтрокаМассива = Строка Тогда
		//						СтрокиНачисленийТекущегоНазначения.Удалить(ИндексСтроки);
		//						Прервать;
		//					Иначе
		//						ИндексСтроки = ИндексСтроки + 1;
		//					КонецЕсли;
		//				КонецЦикла;
		//				ТЗНачисления.Удалить(Строка);
		//			Иначе
		//				// если дата та же - новую строку в формируемую таблицу значений не вводим, а меняем данные 
		//				// и оставляем строку "незакрытой"
		//				Строка.ВидРасчета = Начисления.ВидРасчета;// вид расчета необходимо переопределять для основного начисления
		//				Строка.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
		//				Строка.СпособРасчета = Начисления.СпособРасчета;
		//				Строка.ГрафикРаботы = Начисления.ГрафикРаботы;
		//				Строка.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
		//				Строка.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
		//				//толик стаж не затирать процент 
		//				Если Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентомОтТС и Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням и Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом Тогда
		//					Строка.Показатель1 = Показатель1;
		//				КонецЕсли;
		//				Строка.Показатель2 = Показатель2;
		//				Строка.Показатель3 = Показатель3;
		//				Строка.Показатель4 = Показатель4;						
		//				Строка.Показатель5 = Показатель5;
		//				Строка.Показатель6 = Показатель6;						
		//			КонецЕсли;
		//			ПрерватьОбход = Истина;
		//		ИначеЕсли Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой Тогда
		//			// "закрываем" строку и удаляем из массива незакрытых - кроме 
		//			// начислений фиксированной суммой (они принудительно не разбиваются на части)
		//			
		//			Если Не ЗначениеЗаполнено(Строка.ДатаОкончания) Или Строка.ДатаОкончания > Начисления.Период-1 Тогда
		//				Строка.ДатаОкончания = Начисления.Период-1;
		//				//Строка.ДатаОкончания = КонецМесяца(Начисления.Период);
		//			КонецЕсли;
		//			ИндексСтроки = НезакрытыеСтроки.Найти(Строка);
		//			НезакрытыеСтроки.Удалить(ИндексСтроки);
		//		ИначеЕсли Начисления.ПериодНачисления = Начисления.Период  Тогда 
		//			// для начислений фиксированной суммой рассматриваем строки, образовавшиеся из-за изменения данных о начислении, 
		//			// данные о перемещениях работника пропускаем
		//			
		//			// "закрываем" строку 
		//			Строка.ДатаОкончания = Начисления.Период-1;
		//			// и удаляем из массива незакрытых - если пользователем был изменен размер начисления
		//			Если Начисления.Действие = Перечисления.ВидыДействияСНачислением.Изменить Тогда
		//				ИндексСтроки = НезакрытыеСтроки.Найти(Строка);
		//				НезакрытыеСтроки.Удалить(ИндексСтроки);
		//			КонецЕсли;
		//		Иначе
		//			ПрерватьОбход = Истина;
		//		КонецЕсли;
		//	КонецЦикла;
		//КонецЕсли;
		//
		//Если ПрерватьОбход Или Начисления.Действие = Перечисления.ВидыДействияСНачислением.Прекратить Тогда
		//	Продолжить;
		//КонецЕсли;
		
		// Добавим новую строку начислений
		НоваяСтрока = ТЗДоговорыНаВыполнениеРабот.Добавить();
		НоваяСтрока.Сотрудник = ДоговорыНаВыполнениеРабот.Сотрудник;
		
		НоваяСтрока.ДатаНачала = Макс(ДоговорыНаВыполнениеРабот.ДокументОснование.ДатаНачала,НачалоМесяца(ПериодРегистрации)); //О.Т. 11.08.2014 
		НоваяСтрока.ДатаОкончания =Мин(ДоговорыНаВыполнениеРабот.ДокументОснование.ДатаОкончания,КонецМесяца(ПериодРегистрации));//О.Т. 11.08.2014 
		НоваяСтрока.ДокументОснование =ДоговорыНаВыполнениеРабот.ДокументОснование;
		НоваяСтрока.Размер =ДоговорыНаВыполнениеРабот.Размер;
		НоваяСтрока.ВидРасчета =ДоговорыНаВыполнениеРабот.ВидРасчета;
		НоваяСтрока.Результат =ДоговорыНаВыполнениеРабот.Размер;
		НоваяСтрока.ПодразделениеОрганизации = ДоговорыНаВыполнениеРабот.ПодразделениеОрганизации;//О.Т. Аверсон 16.03.2018 № 1731
		//НоваяСтрока.Физлицо = Начисления.Физлицо;
		//НоваяСтрока.ВидРасчета = Начисления.ВидРасчета;
		//НоваяСтрока.КодВычета = Начисления.КодВычета;
		//Если ПроведениеРасчетов.ЭтоРасчетСеверныхНадбавок(Начисления.СпособРасчета) И Начисления.ДатаРегистрацииСеверногоСтажа <> Null Тогда
		// получим массив процентов северных надбавок с датами их действия для нашего периода
		//ПроцентыСевернойНадбавки = ПроведениеРасчетов.ПолучитьПроцентыСевернойНадбавкиЗаПериод(
		//Начисления.ДатаРегистрацииСеверногоСтажа, 
		//Начисления.ПорядокНачисленияСеверныхНадбавок, 
		//Начисления.НачальныйПроцентСевернойНадбавки,
		//Начисления.СеверныйСтажМесяцев,
		//Начисления.СеверныйСтажДней,
		//Начисления.Период,
		//ОкончаниеПериодаЗаполнения);
		//НоваяСтрока.Показатель1 = ПроцентыСевернойНадбавки[0].Процент;
		//ИначеЕсли ПроведениеРасчетов.ЭтоРасчетОтСтажа(Начисления.СпособРасчета) Тогда
		//	//Если Начисления.КоэффициентСтажа = Null Тогда
		//	//	КоэффициентСтажа = 0;
		//	//	ОбщегоНазначения.ОшибкаРасчета("Для " + Начисления.Сотрудник.Наименование + ", вид расчета """ + Начисления.ВидРасчетаНаименование+ """ не подобран размер начисления в зависимости от стажа. Размер принят равным нулю.");
		//	//Иначе
		//	//	КоэффициентСтажа = Начисления.КоэффициентСтажа;
		//	//КонецЕсли;
		//	//НоваяСтрока.Показатель1 = КоэффициентСтажа;
		//	//толик			
		//	мПроцентСтажа = ПрочиеПроцедуры.ПолучитьПроцентОтСтажаПоСотруднику(Начисления.Сотрудник, Начисления.ВидРасчета, Начисления.Период);
		//	НайденнаяСтрока = Начисления.Сотрудник.Физлицо.Стажи.Найти(Начисления.ВидРасчета.ВидСтажа, "ВидСтажа");
		//	Если ТипЗнч(Начисления.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
		//		НоваяСтрока.Показатель1 = мПроцентСтажа;
		//	Иначе
		//		НоваяСтрока.Размер = мПроцентСтажа;
		//	КонецЕсли;
		//	//НайденнаяСтрока = Начисления.Сотрудник.Физлицо.Стажи.Найти(Начисления.ВидРасчета.ВидСтажа, "ВидСтажа");
		//	//Если НЕ (НайденнаяСтрока = Неопределено) Тогда
		//	//	мВыслуга = ((Начисления.Период+86400) - НайденнаяСтрока.ДатаОтсчета)/86400/365.2555;
		//	//	мВСтаж = РегистрыСведений.ШкалаКоэффициентовСтажа.Выбрать(Новый Структура("КоэффициентСтажа", Начисления.ВидРасчета.КоэффициентСтажа));
		//	//	Пока мВСтаж.Следующий() Цикл
		//	//		Если (мВыслуга >= мВСтаж.СтажС) И (мВыслуга < мВСтаж.СтажПо) Тогда
		//	//			Если ТипЗнч(Начисления.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
		//	//				НоваяСтрока.Показатель1 = мВСтаж.Величина;
		//	//			Иначе
		//	//				НоваяСтрока.Размер = мВСтаж.Величина;
		//	//			КонецЕсли;
		//	//		КонецЕсли;
		//	//	КонецЦикла;
		//	//КонецЕсли;
		//	//енд толик			
		//Иначе			
		//	НоваяСтрока.Показатель1 = Показатель1;
		//	НоваяСтрока.Показатель2 = Показатель2;
		//	НоваяСтрока.Показатель3 = Показатель3;
		//	НоваяСтрока.Показатель4 = Показатель4;								
		//	НоваяСтрока.Показатель5 = Показатель5;
		//	НоваяСтрока.Показатель6 = Показатель6;
		//КонецЕсли;
		//НоваяСтрока.Основное = Начисления.ОсновноеНачисление;
		//НоваяСтрока.ДатаНачала = Начисления.Период;
		//НоваяСтрока.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
		//НоваяСтрока.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
		//НоваяСтрока.СпособРасчета = Начисления.СпособРасчета;
		//НоваяСтрока.ВидВремени = Начисления.ВидВремени;
		//НоваяСтрока.ГрафикРаботы = Начисления.ГрафикРаботы;
		//НоваяСтрока.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
		
		//НезакрытыеСтроки.Добавить(НоваяСтрока);
		//Если Начисления.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой Тогда
		//	СтрокиНачисленийТекущегоНазначения.Добавить(НоваяСтрока);
		//КонецЕсли;
		//
		//Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы Тогда
		//	СтрокаДоплаты = НоваяСтрока;
		//	
		//	Отбор = Новый Структура();
		//	Отбор.Вставить("Сотрудник", Начисления.Сотрудник);
		//	Отбор.Вставить("Физлицо", Начисления.Физлицо);
		//	Отбор.Вставить("ОсновноеНачисление", Истина);
		//	Строки = ВремТЗНачисления.НайтиСтроки(Отбор);
		//	
		//	ОтборДоплаты = Новый Структура();
		//	ОтборДоплаты.Вставить("Сотрудник", Начисления.Сотрудник);
		//	ОтборДоплаты.Вставить("Физлицо", Начисления.Физлицо);
		//	ОтборДоплаты.Вставить("ВидРасчета", Начисления.ВидРасчета);
		//	СтрокиДоплаты = ВремТЗНачисления.НайтиСтроки(ОтборДоплаты);
		//	
		//	
		//	Если Строки.Количество() > 1 И СтрокиДоплаты.Количество() < 2 Тогда
		//		
		//		КоличествоСтрок = Строки.Количество();    		
		//		НомерСтр = 0;
		//		СтрокаДоплаты.ДатаОкончания = Строки[1].Период;					
		//		Для Каждого СтрокаТЗНачисления Из Строки Цикл												
		//			НомерСтр = НомерСтр + 1;						
		//			СтрокаДоплаты.ДатаОкончания = СтрокаТЗНачисления.Период;
		//			Если НомерСтр > 1  Тогда
		//				СтрокаДоплаты = ТЗНачисления.Добавить();
		//				СтрокаДоплаты.Сотрудник = СтрокаТЗНачисления.Сотрудник;
		//				СтрокаДоплаты.Физлицо = СтрокаТЗНачисления.Физлицо;
		//				СтрокаДоплаты.ВидРасчета = Начисления.ВидРасчета;
		//				СтрокаДоплаты.КодВычета = Начисления.КодВычета;
		//				СтрокаДоплаты.Показатель1 =  ОбщегоНазначения.ОкруглитьПоВалюте(Начисления.Показатель1 / 100 * СтрокаТЗНачисления.ЧасоваяТарифнаяСтавка,Константы.ВалютаРегламентированногоУчета.Получить());
		//				СтрокаДоплаты.Основное = Начисления.ОсновноеНачисление;
		//				СтрокаДоплаты.ДатаНачала = СтрокаТЗНачисления.Период;
		//				СтрокаДоплаты.ДатаНачалаСобытия = СтрокаТЗНачисления.ДатаНачалаСобытия;
		//				СтрокаДоплаты.ПодразделениеОрганизации = СтрокаТЗНачисления.ПодразделениеОрганизации;
		//				СтрокаДоплаты.СпособРасчета = Начисления.СпособРасчета;
		//				СтрокаДоплаты.ВидВремени = Начисления.ВидВремени;
		//				СтрокаДоплаты.ГрафикРаботы = Начисления.ГрафикРаботы;
		//				СтрокаДоплаты.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;						
		//			КонецЕсли;										
		//		КонецЦикла;
		//		СтрокаДоплаты.ДатаОкончания = ОкончаниеПериодаЗаполнения;    		
		//	ИначеЕсли  Строки.Количество() > 1 Тогда
		//		Для Каждого СтрокаТЗДопНачисления Из СтрокиДоплаты Цикл												
		//			Если СтрокаТЗДопНачисления.Период = НоваяСтрока.ДатаНачала Тогда
		//				Для Каждого СтрокаТЗНачисления Из Строки Цикл												
		//					Если СтрокаТЗНачисления.Период = НоваяСтрока.ДатаНачала Тогда
		//						НоваяСтрока.Показатель1 =  ОбщегоНазначения.ОкруглитьПоВалюте(Начисления.Показатель1 / 100 * СтрокаТЗНачисления.ЧасоваяТарифнаяСтавка,Константы.ВалютаРегламентированногоУчета.Получить());
		//					КонецЕсли;
		//				КонецЦикла;	
		//			КонецЕсли;
		//		КонецЦикла;
		//	КонецЕсли;    		
		//КонецЕсли;		
		
		//	Если ПроведениеРасчетов.ЭтоРасчетОтСтажа(Начисления.СпособРасчета) Тогда
		//		//толик			//// установим дату окончания предыдущего расчета от стажа
		//		//		Если ПроведениеРасчетов.ЭтоРасчетОтСтажа(Начисления.СпособРасчета) И Начисления.ДеньСменыКоэффициентаСтажа <> Null Тогда
		//		//Если День(КонецМесяца(Начисления.Период)) >= Начисления.ДеньСменыКоэффициентаСтажа Тогда
		//		//	ДатаСменыКоэффициентаСтажа = Дата(Год(Начисления.Период), Месяц(Начисления.Период), Начисления.ДеньСменыКоэффициентаСтажа) - 1;
		//		//	Если ДатаСменыКоэффициентаСтажа > НоваяСтрока.ДатаНачала Тогда
		//		//		НоваяСтрока.ДатаОкончания = ДатаСменыКоэффициентаСтажа;
		//		//		// ... и введем еще один
		//		//		ДопНоваяСтрока = ТЗНачисления.Добавить();
		//		//		ДопНоваяСтрока.Сотрудник = Начисления.Сотрудник;
		//		//		ДопНоваяСтрока.Физлицо = Начисления.Физлицо;
		//		//		ДопНоваяСтрока.ВидРасчета = Начисления.ВидРасчета;
		//		//		ДопНоваяСтрока.КодВычета = Начисления.КодВычета;
		//		//		ДопНоваяСтрока.Показатель1 = Начисления.СледКоэффициентСтажа;				
		//		//		ДопНоваяСтрока.Основное = Начисления.ОсновноеНачисление;
		//		//		ДопНоваяСтрока.ДатаНачала = ДатаСменыКоэффициентаСтажа + 1;
		//		//		ДопНоваяСтрока.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
		//		//		ДопНоваяСтрока.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
		//		//		ДопНоваяСтрока.СпособРасчета = Начисления.СпособРасчета;
		//		//		ДопНоваяСтрока.ГрафикРаботы = Начисления.ГрафикРаботы;
		//		//		ДопНоваяСтрока.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
		//		//		
		//		//		НезакрытыеСтроки.Добавить(ДопНоваяСтрока);
		//		//		СтрокиНачисленийТекущегоНазначения.Добавить(ДопНоваяСтрока);
		//		//	Иначе // период записи начиался после дня изменения коэффициента стажа - запишем в ту же запись новое значение
		//		//		НоваяСтрока.Показатель1 = Начисления.СледКоэффициентСтажа;				
		//		//	КонецЕсли;
		//		//КонецЕсли;
		//		Если НЕ (НайденнаяСтрока = Неопределено) Тогда
		//			Попытка
		//				мДатаОтсчета = Дата(Год(Начисления.Период), Месяц(НайденнаяСтрока.ДатаОтсчета), День(НайденнаяСтрока.ДатаОтсчета));
		//				Если мДатаОтсчета > Начисления.Период И мДатаОтсчета < КонецМесяца(Начисления.Период) Тогда
		//					мВеличина = ПрочиеПроцедуры.ПолучитьПроцентОтСтажаПоСотруднику(Начисления.Сотрудник, Начисления.ВидРасчета, КонецМесяца(Начисления.Период));
		//					//мВыслуга = (КонецМесяца(Начисления.Период) - НайденнаяСтрока.ДатаОтсчета)/86400/365.33;
		//					//мВСтаж = РегистрыСведений.ШкалаКоэффициентовСтажа.Выбрать(Новый Структура("КоэффициентСтажа", Начисления.ВидРасчета.КоэффициентСтажа));
		//					//Пока мВСтаж.Следующий() Цикл
		//					//	Если (мВыслуга >= мВСтаж.СтажС) И (мВыслуга < мВСтаж.СтажПо) Тогда
		//					//		мВеличина = мВСтаж.Величина;
		//					//	КонецЕсли;
		//					//КонецЦикла;
		//					НоваяСтрока.ДатаОкончания = мДатаОтсчета - 1;
		//					// ... и введем еще один
		//					ДопНоваяСтрока = ТЗНачисления.Добавить();
		//					ДопНоваяСтрока.Сотрудник = Начисления.Сотрудник;
		//					ДопНоваяСтрока.Физлицо = Начисления.Физлицо;
		//					ДопНоваяСтрока.ВидРасчета = Начисления.ВидРасчета;
		//					ДопНоваяСтрока.КодВычета = Начисления.КодВычета;
		//					Если ТипЗнч(Начисления.ВидРасчета) = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций") Тогда
		//						ДопНоваяСтрока.Показатель1 = мВеличина;				
		//					Иначе
		//						ДопНоваяСтрока.Размер = мВеличина;
		//					КонецЕсли;
		//					ДопНоваяСтрока.Основное = Начисления.ОсновноеНачисление;
		//					ДопНоваяСтрока.ДатаНачала = мДатаОтсчета;
		//					ДопНоваяСтрока.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
		//					ДопНоваяСтрока.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
		//					ДопНоваяСтрока.СпособРасчета = Начисления.СпособРасчета;
		//					ДопНоваяСтрока.ГрафикРаботы = Начисления.ГрафикРаботы;
		//					ДопНоваяСтрока.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
		//					
		//					НезакрытыеСтроки.Добавить(ДопНоваяСтрока);
		//					СтрокиНачисленийТекущегоНазначения.Добавить(ДопНоваяСтрока);
		//				КонецЕсли;
		//			Исключение
		//				
		//			КонецПопытки;
		//		КонецЕсли;
		//	ИначеЕсли ПроведениеРасчетов.ЭтоРасчетСеверныхНадбавок(Начисления.СпособРасчета) И Начисления.ДатаРегистрацииСеверногоСтажа <> Null Тогда
		//		Если ПроцентыСевернойНадбавки.Количество() > 1 Тогда
		//			Если ПроцентыСевернойНадбавки[0].Процент <= 0 Тогда
		//				
		//				НоваяСтрока.ДатаНачала = Дата(Год(Начисления.Период), Месяц(Начисления.Период), День(ПроцентыСевернойНадбавки[1].Период));
		//				НоваяСтрока.Показатель1 = ПроцентыСевернойНадбавки[1].Процент;
		//				
		//			Иначе
		//				
		//				// установим дату окончания предыдущего расчета от стажа
		//				НоваяСтрока.ДатаОкончания = Дата(Год(Начисления.Период), Месяц(Начисления.Период), День(ПроцентыСевернойНадбавки[1].Период)) - 1;
		//				
		//				// ... и введем дополнительную
		//				// предполагаем, что в течение одного расчетного периода (месяца) не может произойти несколько 
		//				// изменений процента северной надбавки
		//				ДопНоваяСтрока = ТЗНачисления.Добавить();
		//				ДопНоваяСтрока.Сотрудник = Начисления.Сотрудник;
		//				ДопНоваяСтрока.Физлицо = Начисления.Физлицо;
		//				ДопНоваяСтрока.ВидРасчета = Начисления.ВидРасчета;
		//				ДопНоваяСтрока.КодВычета = Начисления.КодВычета;					
		//				ДопНоваяСтрока.Показатель1 = ПроцентыСевернойНадбавки[1].Процент;
		//				ДопНоваяСтрока.Основное = Начисления.ОсновноеНачисление;
		//				ДопНоваяСтрока.ДатаНачала = Дата(Год(Начисления.Период), Месяц(Начисления.Период), День(ПроцентыСевернойНадбавки[1].Период));
		//				ДопНоваяСтрока.ДатаНачалаСобытия = Начисления.ДатаНачалаСобытия;
		//				ДопНоваяСтрока.ПодразделениеОрганизации = Начисления.ПодразделениеОрганизации;
		//				ДопНоваяСтрока.СпособРасчета = Начисления.СпособРасчета;
		//				ДопНоваяСтрока.ГрафикРаботы = Начисления.ГрафикРаботы;
		//				ДопНоваяСтрока.СуммированныйУчетРабочегоВремени = Начисления.СуммированныйУчетРабочегоВремени;
		//				
		//				НезакрытыеСтроки.Добавить(ДопНоваяСтрока);
		//				СтрокиНачисленийТекущегоНазначения.Добавить(ДопНоваяСтрока);
		//				
		//			КонецЕсли;
		//		КонецЕсли;
		//	КонецЕсли;
		//
		ОбработкаПрерыванияПользователя();
	КонецЦикла;
	//
	//// закрываем незакрытые строки по последнему работнику концом месяца
	//ЗакрытьСтроки(ТЗНачисления, НезакрытыеСтроки, ОкончаниеПериодаЗаполнения);
	////толик
	//Для Каждого Начисления Из ТЗНачисления Цикл
	//	Если Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам
	//		ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням
	//		ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной
	//		ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой 
	//		ИЛИ Начисления.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СдельнаяОплата Тогда
	//		ПрочиеПроцедуры.ЗаполнитьНачисленияДополнительнымиВидамиРасчета(Начисления, ТЗНачисления);
	//	КонецЕсли;
	//КонецЦикла;
	ТЗДоговорыНаВыполнениеРабот.Сортировать("Сотрудник Возр, ДатаНачала Возр");
	//енд толик
	
	Возврат ТЗДоговорыНаВыполнениеРабот;
	
	
КонецФункции
//Аверсон-софт, Островская Татьяна 13.03.2012

Функция СформироватьТаблицуДополнитНачисления(ДоговорыНаВыполнениеРабот, ОкончаниеПериодаЗаполнения, ТЗПериоды = Неопределено) //Аверсон ЕАЕ 04.06.2021 СВФР-007660 параметр ТЗПериоды
	
	ТЗДоговорыНаВыполнениеРабот = Новый ТаблицаЗначений();
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("Сотрудник");
	//Островская Татьяна 19.02.2013 № 16250
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ПодразделениеОрганизации");
	//Островская Татьяна 19.02.2013 № 16250
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ДатаНачала", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ДатаОкончания", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ДокументОснование");
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("Показатель1");
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("ВидРасчета");
	ТЗДоговорыНаВыполнениеРабот.Колонки.Добавить("Результат");
	
	// Массив незакрытых строк таблицы значений, т.е. тех, которым не проставлена дата окончания
	НезакрытыеСтроки = Новый Массив;
	// Текущие значения полей выборки для отслеживания изменения работника и даты назначения 
	ТекущийСотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
	ТекущаяДатаНазначения = '00010101';
	ТекущаяЧасоваяСтавкаОсновногоНачисления = 0;
	СтрокиНачисленийТекущегоНазначения = Новый Массив;
	
	Пока ДоговорыНаВыполнениеРабот.Следующий() Цикл
		
		Если ДоговорыНаВыполнениеРабот.Сотрудник <> ТекущийСотрудник Тогда
			
			// закрываем незакрытые строки начислений предыдущего работника концом месяца
			ЗакрытьСтроки(ТЗДоговорыНаВыполнениеРабот, НезакрытыеСтроки, ОкончаниеПериодаЗаполнения2);   //Аверсон 03.09.2019 КВВ СВФР-004691 : Замена ОкончаниеПериодаЗаполнения на ОкончаниеПериодаЗаполнения2
			
			// меняется текущий работник и дата его движения
			ТекущийСотрудник = ДоговорыНаВыполнениеРабот.Сотрудник;
			//ТекущаяДатаНазначения = Начисления.ПериодРаботники;
			ТекущаяЧасоваяСтавкаОсновногоНачисления = 0;
			СтрокиНачисленийТекущегоНазначения.Очистить();
			
			
			
		КонецЕсли;
		
		
		если Строка(ТипЗнч(ДоговорыНаВыполнениеРабот.ВидРасчета) )="Дополнительные начисления организаций" Тогда 
			Если Организация.ИНН = "806000046" 
				или (Организация.ИНН ="100010315" ИЛИ Организация.ИНН = "700176068" ИЛИ Организация.ИНН = "400230097" ИЛИ Организация.ИНН = "300000265" ИЛИ Организация.ИНН = "500158130" ИЛИ Организация.ИНН = "200400628") //Аверсон 07.08.2021 КВВ СВФР-008072 ( +5 УНП к Ортопедам)
				и ДоговорыНаВыполнениеРабот.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом
				//+ СВЭЙ КДЯ 02.03.20 СВФР-005593
				//и Найти( ДоговорыНаВыполнениеРабот.ВидРасчета, "Квартальная премия" ) = 0
				//- СВЭЙ КДЯ 02.03.20 СВФР-005593
				Тогда 
				Продолжить;
			КонецЕсли;
			
			//Аверсон 04.06.2020 КВВ СВФР-006102 (
			Если ДоговорыНаВыполнениеРабот.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом И ДоговорыНаВыполнениеРабот.Результат <> 0 Тогда
				Продолжить;
			КонецЕсли;
			//Аверсон 04.06.2020 КВВ СВФР-006102 )
			
			//Аверсон 18.02.2023 КВВ СВФР-010261 (
			Если ЗначениеЗаполнено(ПодразделениеОрганизации)
				И ЗначениеЗаполнено(ДоговорыНаВыполнениеРабот.ПодразделениеОрганизации)
				И (ДоговорыНаВыполнениеРабот.ПодразделениеОрганизации <> ПодразделениеОрганизации 
				И НЕ ДоговорыНаВыполнениеРабот.ПодразделениеОрганизации.ПринадлежитЭлементу(ПодразделениеОрганизации)) Тогда
				Продолжить;
			КонецЕсли;
			//Аверсон 18.02.2023 КВВ СВФР-010261 )
			
			// Добавим новую строку начислений
			НоваяСтрока = ТЗДоговорыНаВыполнениеРабот.Добавить();
			НоваяСтрока.Сотрудник = ДоговорыНаВыполнениеРабот.Сотрудник;
			//Островская Татьяна 19.02.2013 № 16250
			НоваяСтрока.ПодразделениеОрганизации = ДоговорыНаВыполнениеРабот.ПодразделениеОрганизации;
			//Островская Татьяна 19.02.2013 № 16250
			
			//Аверсон ЕАЕ 04.06.2021 СВФР-007660
			//НоваяСтрока.ДатаНачала = ДоговорыНаВыполнениеРабот.БазовыйПериодНачало;
			//НоваяСтрока.ДатаОкончания =ДоговорыНаВыполнениеРабот.БазовыйПериодКонец;
			
			//Аверсон ЕАЕ 12.07.2021 СВФР-007834
			//СтруктураПериоды = ПолучитьСтруктуруПериоды(НоваяСтрока.Сотрудник, НоваяСтрока.ПодразделениеОрганизации, ТЗПериоды);
			//Если СтруктураПериоды <> Неопределено И ЗначениеЗаполнено(СтруктураПериоды.ДатаНачала) Тогда
			//	НоваяСтрока.ДатаНачала = СтруктураПериоды.ДатаНачала;	
			//Иначе
			НоваяСтрока.ДатаНачала = ДоговорыНаВыполнениеРабот.БазовыйПериодНачало;
			//КонецЕсли;
			//Если СтруктураПериоды <> Неопределено И ЗначениеЗаполнено(СтруктураПериоды.ДатаОкончания) Тогда
			//	НоваяСтрока.ДатаОкончания = СтруктураПериоды.ДатаОкончания;
			//Иначе
			НоваяСтрока.ДатаОкончания = ДоговорыНаВыполнениеРабот.БазовыйПериодКонец;
			//КонецЕсли;
			//Аверсон СВФР-007660
			//Аверсон СВФР-007834
			
			
			Если не ЗначениеЗаполнено(НоваяСтрока.ДатаНачала) Тогда 
				НоваяСтрока.ДатаНачала =НачалоМесяца(ОкончаниеПериодаЗаполнения);				
				НоваяСтрока.ДатаОкончания =ОкончаниеПериодаЗаполнения;
			КонецЕсли;
			
			НоваяСтрока.Показатель1 = ДоговорыНаВыполнениеРабот.Показатель1;
			//НоваяСтрока.ДокументОснование =ДоговорыНаВыполнениеРабот.ДокументОснование;
			//НоваяСтрока.Размер =ДоговорыНаВыполнениеРабот.Размер;
			НоваяСтрока.ВидРасчета =ДоговорыНаВыполнениеРабот.ВидРасчета;
			НоваяСтрока.Результат =ДоговорыНаВыполнениеРабот.Результат;
		КонецЕсли;
		ОбработкаПрерыванияПользователя();
	КонецЦикла;
	ТЗДоговорыНаВыполнениеРабот.Сортировать("Сотрудник Возр, ДатаНачала Возр");
	
	
	Возврат ТЗДоговорыНаВыполнениеРабот;
	
	
КонецФункции
//Аверсон-софт, Островская Татьяна 11.06.2012 № 15477

//Аверсон ЕАЕ 14.06.2021 СВФР-007660
Функция ПолучитьСтруктуруПериоды(Сотр, Подр, ТЗПериоды)
	Если ТЗПериоды = Неопределено Тогда
		Возврат Неопределено;
	КонецЕсли;
	СтруктураПериоды = Новый Структура;
	СтруктураПериоды.Вставить("ДатаНачала");
	СтруктураПериоды.Вставить("ДатаОкончания");
	
	ТЗПериоды.Сортировать("ДатаНачала");
	
	СтруктураОтбора = Новый Структура;
	СтруктураОтбора.Вставить("Сотрудник", Сотр);
	//Аверсон ЕАЕ 07.07.2021 б/н
	//СтруктураОтбора.Вставить("ПодразделениеОрганизации", Подр);
	//Аверсон б/н
	
	НужныеСтроки = ТЗПериоды.НайтиСтроки(СтруктураОтбора);
	КоличествоСтрок = НужныеСтроки.Количество();
	Если КоличествоСтрок > 0 Тогда
		СтруктураПериоды.ДатаНачала = НужныеСтроки[0].ДатаНачала;
		СтруктураПериоды.ДатаОкончания = НужныеСтроки[КоличествоСтрок - 1].ДатаОкончания;
	КонецЕсли;
	
	Возврат СтруктураПериоды;
КонецФункции
//Аверсон СВФР-007660

// Выполняет формирование таблицы значений для загрузки ее в табличную часть Удержания
// Параметры:
// 	Удержания - выборка результатат запроса
//  ПериодЗаполнения - дата периода для которого выполняем заполнение документа
//
// Возвращаемое значение:
//  таблица значений
//
Функция СформироватьТаблицуУдержаний(Удержания, ОкончаниеПериодаЗаполнения,ТЗФизЛиц=Неопределено)  //Аверсон 14.08.2019 КВВ СВФР-004607
	
	ТЗУдержания = Новый ТаблицаЗначений();
	ТЗУдержания.Колонки.Добавить("Физлицо");
	ТЗУдержания.Колонки.Добавить("Сотрудник");//Островская Татьяна 04.06.2014 № 17395
	ТЗУдержания.Колонки.Добавить("ВидРасчета");
	ТЗУдержания.Колонки.Добавить("Показатель1");
	ТЗУдержания.Колонки.Добавить("Показатель2");
	ТЗУдержания.Колонки.Добавить("Показатель3");
	ТЗУдержания.Колонки.Добавить("Показатель4");
	ТЗУдержания.Колонки.Добавить("Показатель5");
	ТЗУдержания.Колонки.Добавить("Показатель6");	
	ТЗУдержания.Колонки.Добавить("ДатаНачала", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗУдержания.Колонки.Добавить("ДатаОкончания", ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ТЗУдержания.Колонки.Добавить("ДокументОснование");
	ТЗУдержания.Колонки.Добавить("Авторасчет");
	
	//О.Т. Аверсон 31.05.2017 № 685	
	ЗапросУП = Новый Запрос;
	ЗапросУП.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.НеРазбиватьУдержанияПоПериодам
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
	
	ЗапросУП.УстановитьПараметр("Организация", Организация);
	
	РезультатЗапросаУП = ЗапросУП.Выполнить().Выбрать();
	НеРазбиватьУдержанияПоПериодам = Ложь;
	Пока РезультатЗапросаУП.Следующий() Цикл
		НеРазбиватьУдержанияПоПериодам = РезультатЗапросаУП.НеРазбиватьУдержанияПоПериодам;
	КонецЦикла;
	
	//О.Т. Аверсон 31.05.2017 № 685
	
	// Массив незакрытых строк таблицы значений, т.е. тех, которым не проставлена дата окончания
	НезакрытыеСтроки = Новый Массив;
	ТекущееФизлицо = Справочники.ФизическиеЛица.ПустаяСсылка();
	ТекущийСотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
	Пока Удержания.Следующий() Цикл
		
		Если НЕ ЗначениеЗаполнено(Удержания.КурсВалюты) Тогда
			ОбщегоНазначения.ОшибкаРасчета("Для расчетного периода не задан курс валюты " + Удержания.Валюта + "!");
			ТЗУдержания.Очистить();
			Возврат ТЗУдержания;
		КонецЕсли;
		
		Если Удержания.Физлицо <> ТекущееФизлицо или ?(не НеРазбиватьУдержанияПоПериодам,Удержания.Сотрудник <> ТекущийСотрудник,истина) Тогда
			// закрываем строки концом месяца
			ОкончаниеПериодаЗаполнения1 = ОкончаниеПериодаЗаполнения;
			если не НеРазбиватьУдержанияПоПериодам Тогда  				
				Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
					Запрос = Новый Запрос;
					Запрос.Текст =
					"ВЫБРАТЬ
					|	РаботникиОрганизацийСрезПоследних.Период
					|ИЗ
					|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
					|			&Период,
					|			не ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)
					|				И Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних";
					запрос.УстановитьПараметр("Подразделение",ПодразделениеОрганизации);
					запрос.УстановитьПараметр("Сотрудник",Удержания.Сотрудник);
					запрос.УстановитьПараметр("Период",ОкончаниеПериодаЗаполнения);
					РезультатЗапроса = запрос.Выполнить().Выбрать();
					Если РезультатЗапроса.Следующий() Тогда 
						Если РезультатЗапроса.Период>=Удержания.Период и РезультатЗапроса.Период < ОкончаниеПериодаЗаполнения Тогда
							ОкончаниеПериодаЗаполнения1 = РезультатЗапроса.Период-1;
						КонецЕсли;
						
					КонецЕсли;
					
				КонецЕсли;
			КонецЕсли;
			
			//О.Т. Аверсон 20.02.2019 № 3207
			Запрос = Новый Запрос;
			Запрос.Текст =
			"ВЫБРАТЬ
			|	РаботникиОрганизаций.Период
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|ГДЕ
			|	РаботникиОрганизаций.Сотрудник = &Сотрудник
			|	И РаботникиОрганизаций.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций
			|	И РаботникиОрганизаций.Период МЕЖДУ &Период И &Период1";
			запрос.УстановитьПараметр("Сотрудник",Удержания.Сотрудник);
			запрос.УстановитьПараметр("Период",НачалоМесяца(ПериодРегистрации));
			запрос.УстановитьПараметр("Период1",КонецМесяца(ПериодРегистрации));
			РезультатЗапроса = запрос.Выполнить().Выбрать();
			Если РезультатЗапроса.Следующий() Тогда 
				ОкончаниеПериодаЗаполнения1 = РезультатЗапроса.Период-1;
			КонецЕсли;
			//О.Т. Аверсон 20.02.2019 № 3207
			
			
			ЗакрытьСтроки(ТЗУдержания, НезакрытыеСтроки, ОкончаниеПериодаЗаполнения1);
			ТекущееФизлицо = Удержания.Физлицо;
			Если не НеРазбиватьУдержанияПоПериодам Тогда 
				ТекущийСотрудник = Удержания.Сотрудник;
			КонецЕсли;
		Иначе
			// найдем такой же вид расчета по тому же основанию среди незакрытых строк
			Строка = Неопределено;
			ИндексСтроки = Неопределено;
			НайтиСредиНезакрытыхУдержаний(НезакрытыеСтроки, Удержания.ВидРасчета, Удержания.ДокументОснование, Строка, ИндексСтроки);
			Если Строка <> Неопределено Тогда
				// нашли
				Если Строка.ДатаНачала = Удержания.Период Тогда
					// если дата та же - меняем данные 
					// не вводим новую строку в формируемую таблицу значений
					// и оставляем "незакрытой"
					Строка.Показатель1 = Удержания.Показатель1;
					Строка.Показатель2 = Удержания.Показатель2;
					Строка.Показатель3 = Удержания.Показатель3;
					Строка.Показатель4 = Удержания.Показатель4;
					Строка.Показатель5 = Удержания.Показатель5;
					Строка.Показатель6 = Удержания.Показатель6;				
					Продолжить;
				Иначе
					// иначе - "закрываем" строку и удаляем из массива незакрытых
					Строка.ДатаОкончания = Удержания.Период-1;
					НезакрытыеСтроки.Удалить(ИндексСтроки);
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		Если Удержания.Действие = Перечисления.ВидыДействияСНачислением.Прекратить Тогда
			Продолжить;
		КонецЕсли;
		
		//Аверсон 14.08.2019 КВВ СВФР-004607 (
		Если ЗначениеЗаполнено(ТЗФизЛиц) Тогда
			НайденнаяСтрока = ТЗФизЛиц.Найти(Удержания.Физлицо, "Физлицо");
			Если НайденнаяСтрока = Неопределено Тогда
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		//Аверсон 14.08.2019 КВВ СВФР-004607 )
		
		//Аверсон 17.09.2019 КВВ СВФР-004691 (
		Если Удержания.Период > ОкончаниеПериодаЗаполнения1 Тогда
			Продолжить;
		КонецЕсли;
		//Аверсон 17.09.2019 КВВ СВФР-004691 )
		
		НоваяСтрока = ТЗУдержания.Добавить();
		НоваяСтрока.Физлицо = Удержания.Физлицо;
		НоваяСтрока.Сотрудник = Удержания.Сотрудник;//Островская Татьяна 04.06.2014 № 17395
		НоваяСтрока.ВидРасчета = Удержания.ВидРасчета;
		НоваяСтрока.Показатель1 = Удержания.Показатель1;
		НоваяСтрока.Показатель2 = Удержания.Показатель2;
		НоваяСтрока.Показатель3 = Удержания.Показатель3;
		НоваяСтрока.Показатель4 = Удержания.Показатель4;
		НоваяСтрока.Показатель5 = Удержания.Показатель5;
		НоваяСтрока.Показатель6 = Удержания.Показатель6;
		НоваяСтрока.ДатаНачала = Удержания.Период;
		НоваяСтрока.ДокументОснование = Удержания.ДокументОснование;
		НоваяСтрока.Авторасчет = Истина;
		Если (Удержания.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом или
			Удержания.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ или
			Удержания.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ) и ЗначениеЗаполнено(Удержания.ДокументОснование.ДатаРожденияРебенка) Тогда 
			
			ЗапросД = Новый Запрос;
			ЗапросД.Текст = 
			"ВЫБРАТЬ
			|	РАЗНОСТЬДАТ(&Дата1, &Дата2, месяц) КАК ДатаРасч";
			
			ЗапросД.УстановитьПараметр("Дата1", НачалоМесяца(Дата(Год(Удержания.ДокументОснование.ДатаРожденияРебенка)+18,Месяц(Удержания.ДокументОснование.ДатаРожденияРебенка),День(Удержания.ДокументОснование.ДатаРожденияРебенка))));
			ЗапросД.УстановитьПараметр("Дата2", ПериодРегистрации);   				
			РезультатЗапроса = ЗапросД.Выполнить();                                                      				
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			КолвоЛет = 0;
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				КолвоЛет = ВыборкаДетальныеЗаписи.ДатаРасч;				
			КонецЦикла;
			
			Если КолвоЛет =0 Тогда 
				НоваяСтрока.ДатаОкончания = КонецДня(Дата(Год(ПериодРегистрации),Месяц(Удержания.ДокументОснование.ДатаРожденияРебенка),День(Удержания.ДокументОснование.ДатаРожденияРебенка)));
				ДатаРасч = Дата(Год(Удержания.ДокументОснование.ДатаРожденияРебенка)+18,Месяц(Удержания.ДокументОснование.ДатаРожденияРебенка),День(Удержания.ДокументОснование.ДатаРожденияРебенка));
				
				//Аверсон ЕАЕ 05.08.2021 б/н
				//Сообщить("По работнику "+Удержания.Сотрудник.Наименование +" расчет алиментов будет произведен пропорционально календарным дням до "+Формат(ДатаРасч,"ДЛФ=Д")+" по причине достижения ребенком 18 лет");
				Сообщить("По работнику "+Удержания.ФизлицоНаименование +" расчет алиментов будет произведен пропорционально календарным дням до "+Формат(ДатаРасч,"ДЛФ=Д")+" по причине достижения ребенком 18 лет");
				//Аверсон б/н
				
			иначе
				НезакрытыеСтроки.Добавить(НоваяСтрока);
			КонецЕсли;    			
		иначе
			НезакрытыеСтроки.Добавить(НоваяСтрока);   
			ЗакрытьСтроки(ТЗУдержания, НезакрытыеСтроки, ОкончаниеПериодаЗаполнения1); //Аверсон 25.05.2020 КВВ СВФР-006041
		КонецЕсли;
		
		
		ОбработкаПрерыванияПользователя();
	КонецЦикла;
	// закрываем строки концом месяца
	ОкончаниеПериодаЗаполнения1 = ОкончаниеПериодаЗаполнения;
	Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
		Запрос = Новый Запрос;
		Запрос.Текст =
		"ВЫБРАТЬ
		|	РаботникиОрганизацийСрезПоследних.Период
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
		|			&Период,
		|			не ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)
		|				И Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних";
		запрос.УстановитьПараметр("Подразделение",ПодразделениеОрганизации);
		запрос.УстановитьПараметр("Сотрудник",Удержания.Сотрудник);
		запрос.УстановитьПараметр("Период",ОкончаниеПериодаЗаполнения);
		РезультатЗапроса = запрос.Выполнить().Выбрать();
		Если РезультатЗапроса.Следующий() Тогда 
			Если РезультатЗапроса.Период>=Удержания.Период и РезультатЗапроса.Период < ОкончаниеПериодаЗаполнения Тогда 
				ОкончаниеПериодаЗаполнения1 = РезультатЗапроса.Период-1;
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЕсли;
	
	//О.Т. Аверсон 20.02.2019 № 3207
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	РаботникиОрганизаций.Период
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|ГДЕ
	|	РаботникиОрганизаций.Сотрудник = &Сотрудник
	|	И РаботникиОрганизаций.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций
	|	И РаботникиОрганизаций.Период МЕЖДУ &Период И &Период1";
	запрос.УстановитьПараметр("Сотрудник",Удержания.Сотрудник);
	запрос.УстановитьПараметр("Период",НачалоМесяца(ПериодРегистрации));
	запрос.УстановитьПараметр("Период1",КонецМесяца(ПериодРегистрации));
	РезультатЗапроса = запрос.Выполнить().Выбрать();
	Если РезультатЗапроса.Следующий() Тогда 
		ОкончаниеПериодаЗаполнения1 = РезультатЗапроса.Период-1;
	КонецЕсли;
	//О.Т. Аверсон 20.02.2019 № 3207
	
	ЗакрытьСтроки(ТЗУдержания, НезакрытыеСтроки, ОкончаниеПериодаЗаполнения1);
	
	//Аверсон ЕАЕ 01.06.2025 СВФР-015873
	//Проверим прерывание удержаний
	ТЗУдержанияПрекратить = ПолучитьПериодыПрекращенияУдержаний(ТЗУдержания);
	Для Каждого Стр Из ТЗУдержания Цикл
		СтруктураОтбора = Новый Структура;
		СтруктураОтбора.Вставить("ФизЛицо", Стр.ФизЛицо);
		СтруктураОтбора.Вставить("ВидРасчета", Стр.ВидРасчета);
		СтруктураОтбора.Вставить("ДокументОснование", Стр.ДокументОснование);
		
		НужныеСтроки = ТЗУдержанияПрекратить.НайтиСтроки(СтруктураОтбора);
		Если НужныеСтроки.Количество() > 0 Тогда
			Стр.ДатаОкончания = НужныеСтроки[0].Период;
		КонецЕсли;
	КонецЦикла;
	//Аверсон СВФР-015873
	
	Возврат ТЗУдержания;
	
КонецФункции // СформироватьТаблицуУдержаний()

//Аверсон ЕАЕ 02.06.2025 СВФР-015873
Функция ПолучитьПериодыПрекращенияУдержаний(ТЗУдержания)
	
	ТЗУдержанияВЗапрос = Новый ТаблицаЗначений;
	ТЗУдержанияВЗапрос.Колонки.Добавить("ФизЛицо",Новый ОписаниеТипов("СправочникСсылка.ФизическиеЛица"));
	ТЗУдержанияВЗапрос.Колонки.Добавить("ВидРасчета",Новый ОписаниеТипов("ПланВидовРасчетаСсылка.УдержанияОрганизаций"));
	МассивТипов = Новый Массив;
	МассивТипов.Добавить(Тип("ДокументСсылка.ВводСведенийОПлановыхУдержанияхРаботниковОрганизаций"));
	МассивТипов.Добавить(Тип("ДокументСсылка.ИсполнительныйЛист"));
	МассивТипов.Добавить(Тип("ДокументСсылка.ПродажаТовараВКредит"));
	ТЗУдержанияВЗапрос.Колонки.Добавить("ДокументОснование",Новый ОписаниеТипов(МассивТипов));
	
	Для Каждого Стр Из ТЗУдержания Цикл
		НоваяСтр = ТЗУдержанияВЗапрос.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяСтр,Стр);
	КонецЦикла;
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	|	ТЗ.ФизЛицо КАК ФизЛицо,
	|	ТЗ.ВидРасчета КАК ВидРасчета,
	|	ТЗ.ДокументОснование КАК ДокументОснование
	|ПОМЕСТИТЬ ВТТЗ
	|ИЗ &ТЗ КАК ТЗ
	|;
	|/////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
	|	ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
	|	ПлановыеУдержанияРаботниковОрганизаций.ДокументОснование КАК ДокументОснование,
	|	ПлановыеУдержанияРаботниковОрганизаций.Период КАК Период
	|ИЗ РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК ПлановыеУдержанияРаботниковОрганизаций
	|ГДЕ (ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо,ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета,ПлановыеУдержанияРаботниковОрганизаций.ДокументОснование) 
	|	В (ВЫБРАТЬ ВТТЗ.ФизЛицо,ВТТЗ.ВидРасчета,ВТТЗ.ДокументОснование ИЗ ВТТЗ)
	|И ПлановыеУдержанияРаботниковОрганизаций.Период МЕЖДУ &НачалоМесяца И &КонецМесяца
	|И ПлановыеУдержанияРаботниковОрганизаций.Действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
	|	ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
	|	ПлановыеУдержанияРаботниковОрганизаций.ДокументОснование КАК ДокументОснование,
	|	НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения,СЕКУНДА,-1),ДЕНЬ) КАК Период
	|ИЗ РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК ПлановыеУдержанияРаботниковОрганизаций
	|ГДЕ (ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо,ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета,ПлановыеУдержанияРаботниковОрганизаций.ДокументОснование) 
	|	В (ВЫБРАТЬ ВТТЗ.ФизЛицо,ВТТЗ.ВидРасчета,ВТТЗ.ДокументОснование ИЗ ВТТЗ)
	|И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения МЕЖДУ &НачалоМесяца И &КонецМесяца
	|И ПлановыеУдержанияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
	|";
	
	Запрос.УстановитьПараметр("ТЗ", ТЗУдержанияВЗапрос);
	Запрос.УстановитьПараметр("НачалоМесяца", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("КонецМесяца", КонецМесяца(ПериодРегистрации));
	ТЗ = Запрос.Выполнить().Выгрузить();
	Возврат ТЗ;
КонецФункции
//Аверсон СВФР-015873

//Аверсон-софт, Плиско Ю.А. / 12.11.2014 / {Начало: 
// Заполняет документ работниками, работавшими в праздники
//
Процедура ЗаполнитьРаботавшимиВПраздники(Запрос = Неопределено, Реквизиты = Неопределено,ТЧРаботавшиеВПраздники = Неопределено) 
	
	СпособРасчетаВЧасах     = Ложь;
	
	Если Запрос = Неопределено Тогда // не передали необходимых для заполнения данных
		Возврат;
	КонецЕсли;
	
	Список = Новый СписокЗначений;
	Список.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
	Список.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни);
	
	//Начисления.Очистить();
	Если Организация.ИНН = "100765738" Тогда  //О.Т. Аверсон 14.12.2016 № 100
		Запрос.Текст =
		"ВЫБРАТЬ
		|	РабочееВремяРаботниковОрганизаций.Период КАК Период,
		|	РабочееВремяРаботниковОрганизаций.Сотрудник КАК Сотрудник,
		|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени КАК ВидИспользованияРабочегоВремени,
		|	РабочееВремяРаботниковОрганизаций.Часов КАК Часов,
		|	РабочееВремяРаботниковОрганизаций.Тариф КАК Тариф,
		|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|	РаботникиОрганизацийСрезПоследних.Организация КАК Организация,
		|	РабочееВремяРаботниковОрганизаций.Регистратор КАК Регистратор,
		|	РаботникиОрганизацийСрезПоследних.Сотрудник.Код КАК ТабНомер,
		|	РабочееВремяРаботниковОрганизаций.Дней,
		|	РабочееВремяРаботниковОрганизаций.ДатаНачала,
		|	РабочееВремяРаботниковОрганизаций.ДатаОкончания
		|ИЗ
		|	ВТСписокРаботников КАК ВТСписокРаботников
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|		ПО ВТСписокРаботников.Сотрудник = РабочееВремяРаботниковОрганизаций.Сотрудник
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ОкончаниеПериода, ) КАК РаботникиОрганизацийСрезПоследних
		|		ПО ВТСписокРаботников.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
		|ГДЕ
		|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&ВидИспользованияРабочегоВремени)
		|	И РабочееВремяРаботниковОрганизаций.Период >= &НачалоПериода
		|	И РабочееВремяРаботниковОрганизаций.Период <= &ОкончаниеПериода
		|	И РаботникиОрганизацийСрезПоследних.Организация = &Организация" ;
		Запрос.УстановитьПараметр("НачалоПериода",НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("ОкончаниеПериода",КонецМесяца(ПериодРегистрации));
	иначе
		Запрос.Текст =
		"ВЫБРАТЬ
		|	РабочееВремяРаботниковОрганизаций.Период КАК Период,
		|	РабочееВремяРаботниковОрганизаций.Сотрудник КАК Сотрудник,
		|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени КАК ВидИспользованияРабочегоВремени,
		|	РабочееВремяРаботниковОрганизаций.Часов КАК Часов,
		|	РабочееВремяРаботниковОрганизаций.Тариф КАК Тариф,
		|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|	РаботникиОрганизацийСрезПоследних.Организация КАК Организация,
		|	РабочееВремяРаботниковОрганизаций.Регистратор КАК Регистратор,
		|	РаботникиОрганизацийСрезПоследних.Сотрудник.Код КАК ТабНомер,
		|	РабочееВремяРаботниковОрганизаций.Дней
		|ИЗ
		|	ВТСписокРаботников КАК ВТСписокРаботников
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		|		ПО ВТСписокРаботников.Сотрудник = РабочееВремяРаботниковОрганизаций.Сотрудник
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ОкончаниеПериода, ) КАК РаботникиОрганизацийСрезПоследних
		|		ПО ВТСписокРаботников.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
		|ГДЕ
		|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&ВидИспользованияРабочегоВремени)
		|	И РабочееВремяРаботниковОрганизаций.Период >= &НачалоПериода
		|	И РабочееВремяРаботниковОрганизаций.Период <= &ОкончаниеПериода
		|	И РаботникиОрганизацийСрезПоследних.Организация = &Организация" ;
		Запрос.УстановитьПараметр("НачалоПериода",НачалоМесяца(ПериодРегистрации));
		Запрос.УстановитьПараметр("ОкончаниеПериода",КонецМесяца(ПериодРегистрации));
	КонецЕсли;
	Запрос.УстановитьПараметр("Организация",		Организация);
	Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Список);
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() цикл
		//начисления из нарядов не будем добавлять, все рассчеты идут из наряда
		Если ТипЗнч(Выборка.Регистратор) = Тип("ДокументСсылка.СдельныйНаряд") Тогда
			Продолжить;
		КонецЕсли;
		
		Если Выборка.Часов = 0 Тогда 
			Продолжить;
		КонецЕсли;
		Строка = ТЧРаботавшиеВПраздники.Добавить();
		Строка.Авторасчет    = Истина;
		Строка.ЧасыИзДокумента  = Истина;
		Строка.Сотрудник = Выборка.Сотрудник;
		//О.Т. Аверсон 27.02.2019 № 3184
		ЗапросПодр = Новый Запрос;
		ЗапросПодр.Текст = 
		"ВЫБРАТЬ
		|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних";
		
		ЗапросПодр.УстановитьПараметр("Период", Выборка.ДатаНачала);
		ЗапросПодр.УстановитьПараметр("Сотрудник", Выборка.Сотрудник);
		
		РезультатЗапросаПодр = ЗапросПодр.Выполнить();
		
		ВыборкаДетальныеЗаписиПодр = РезультатЗапросаПодр.Выбрать();
		
		Пока ВыборкаДетальныеЗаписиПодр.Следующий() Цикл
			Строка.ПодразделениеОрганизации = ВыборкаДетальныеЗаписиПодр.ПодразделениеОрганизации;
		КонецЦикла;
		//О.Т. Аверсон 27.02.2019 № 3184
		
		
		Если Организация.ИНН = "100765738" Тогда  //О.Т. Аверсон 14.12.2016 № 100
			Строка.ДатаНачалаСобытия = Выборка.ДатаНачала;
			Строка.ДатаНачала    = Выборка.ДатаНачала;
			Строка.ДатаОкончания  = Выборка.ДатаОкончания;
		иначе
			Строка.ДатаНачалаСобытия = Выборка.Период;
			Строка.ДатаНачала    = Выборка.Период;
			Строка.ДатаОкончания  = Выборка.Период;
		КонецЕсли;
		Строка.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные;
		Строка.ОплаченоДней = Выборка.Дней; //О.Т. 22.04.2015 № 422
		Строка.ОплаченоДнейЧасов = Выборка.Часов;
		Строка.ТабНомер = Выборка.ТабНомер;
	КонецЦикла;
	
КонецПроцедуры //ЗаполнитьРаботавшимиВПраздники()
//Аверсон-софт, Плиско Ю.А. / 12.11.2014 / Конец.}

//Аверсон-софт, Плиско Ю.А. / 12.11.2014 / {Начало: 
//Рассчитывает данные по работавшим в праздники
//
Процедура РассчитатьРаботавшихВПраздники(ТЗ_Начисления) 
	
	СпособРасчетаВЧасах     = Ложь;
	
	Если ТЗ_Начисления.Количество()=0 Тогда // не передали необходимых для заполнения данных
		Возврат;
	КонецЕсли;
	
	Для каждого Выборка Из ТЗ_Начисления Цикл
		Запрос1 = Новый Запрос;
		Запрос1.Текст =
		"ВЫБРАТЬ
		|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета
		|ИЗ
		|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
		|			&Период,
		|			Организация = &Организация
		|				И Сотрудник = &Сотрудник
		|				И (НЕ Временно)) КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
		|ГДЕ
		|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета В(&ВидРасчета)
		|
		|СГРУППИРОВАТЬ ПО
		|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета";
		Запрос1.УстановитьПараметр("Организация", Организация);
		Запрос1.УстановитьПараметр("Сотрудник", Выборка.Сотрудник);
		Запрос1.УстановитьПараметр("Период", Выборка.ДатаНачала);
		мСписокВидов = Новый СписокЗначений;
		мСписок = ПрочиеПроцедуры.СформироватьСписокОсновныхНачислений();
		Пока мСписок.Следующий() Цикл
			мСписокВидов.Добавить(мСписок.ВидРасчета);
		КонецЦикла;
		Запрос1.УстановитьПараметр("ВидРасчета", мСписокВидов);
		
		мРезультат = Запрос1.Выполнить().Выбрать();
		
		Если мРезультат.Количество() = 0 Тогда
		Иначе
			Пока мРезультат.Следующий() Цикл
				ВидРасчета = мРезультат.ВидРасчета;
			КонецЦикла;
		КонецЕсли;
		
		Строка = Начисления.Найти(Выборка.НомерСтроки,"НомерСтроки");
		//Строка.Авторасчет    = Ложь;//О.Т. 22.04.2015 № 422
		Строка.ЧасыИзДокумента  = Ложь;
		Строка.Сотрудник = Выборка.Сотрудник;
		Строка.ПодразделениеОрганизации = Выборка.ПодразделениеОрганизации;
		Строка.ДатаНачалаСобытия = Выборка.ДатаНачалаСобытия;
		Строка.ДатаНачала    = Выборка.ДатаНачала;
		Строка.ДатаОкончания  = Выборка.ДатаОкончания;
		Строка.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные;
		Если ПериодРегистрации < Дата(2016,07,1) Тогда //О.Т. Аверсон 15.03.2016 № 949
			Размер = Окр(ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(Организация, Выборка.Сотрудник, КонецМесяца(ПериодРегистрации), Выборка.Сотрудник, Истина, Истина,,,,,СпособРасчетаВЧасах), 1); //Островская Татьяна 28.04.2014 № 17310
		иначе
			Размер = ОбщегоНазначения.ОкруглитьЗначение2016(ПрочиеПроцедуры.ПолучитьЧасовуюТарифнуюСтавку(Организация, Выборка.Сотрудник, КонецМесяца(ПериодРегистрации), Выборка.Сотрудник, Истина, Истина,,,,,СпособРасчетаВЧасах),ПериодРегистрации); //Островская Татьяна 28.04.2014 № 17310
		КонецЕсли;
		//О.Т. Аверсон 28.03.2017 № 455
		Ставка = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(Выборка.ДатаНачалаСобытия,Новый Структура("Сотрудник",Выборка.Сотрудник)).ЗанимаемыхСтавок;
		
		Размер = ОбщегоНазначения.ОкруглитьЗначение2016(Размер / Ставка,ПериодРегистрации);
		//О.Т. Аверсон 28.03.2017 № 455
		
		Строка.ОплаченоДней = Выборка.ОплаченоДней; //О.Т. 22.04.2015 № 422 // = 1;
		Строка.ОплаченоДнейЧасов = Выборка.ОплаченоДнейЧасов;
		если ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням и не СпособРасчетаВЧасах Тогда //Островская Татьяна 24.04.2014 № 17310
			Строка.Результат = ОбщегоНазначения.ОкруглитьЗначение2016(Размер * Строка.ОплаченоДней, ПериодРегистрации, 1); //О.Т. Аверсон 15.03.2016 № 949
		иначе
			//Аверсон 18.03.2020 КВВ СВФР-005683 (Закомментировано) (
			//Если ПериодРегистрации >= Дата(2020,01,01) тогда    
			//	Строка.Результат = ОбщегоНазначения.ОкруглитьЗначение2016(Размер * Выборка.ОплаченоДнейЧасов*0.9, ПериодРегистрации, 1);
			//Иначе
			//Аверсон 18.03.2020 КВВ СВФР-005683 (Закомментировано) )
			Строка.Результат = ОбщегоНазначения.ОкруглитьЗначение2016(Размер * Выборка.ОплаченоДнейЧасов, ПериодРегистрации, 1); //О.Т. Аверсон 15.03.2016 № 949
			//КонецЕсли;
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры //РассчитатьРаботавшихВПраздники()
//Аверсон-софт, Плиско Ю.А. / 12.11.2014 / Конец.}

//+ СВЭЙ КДЯ 03.01.20 СВФР-005236
Процедура ОбъединитьПересекающиесяДиапазоныНачислений( ТЗНачисления )
	
	СтрокиКУдалению = Новый Массив;
	Сутки = 24 * 60 * 60;
	
	//Аверсон 11.02.2022 КВВ СВФР-008736 (
	ТЗНачисления.Колонки.Добавить("РазрядЕТС");
	
	//Аверсон ЕАЕ 23.03.2022 СВФР-008869
	ТЗНачисления.Колонки.Добавить("КоэффициентЕТС");
	//Аверсон СВФР-008869
	
	//Аверсон ЕАЕ 16.10.2025 СВФР-017031
	Если Организация.ИНН = "700103211" Тогда
		ТЗНачисления.Колонки.Добавить("ЧТС");
	КонецЕсли;
	//Аверсон СВФР-017031
	
	Для Каждого СтрТЗНачисления ИЗ ТЗНачисления Цикл
		
		//Аверсон ЕАЕ 23.03.2022 СВФР-008869
		//СтрТЗНачисления.РазрядЕТС = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрТЗНачисления.ДатаОкончания,Новый Структура("Сотрудник",СтрТЗНачисления.Сотрудник)).РазрядЕТС;
		РаботникиОрганизацийДанные = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(СтрТЗНачисления.ДатаОкончания,Новый Структура("Сотрудник",СтрТЗНачисления.Сотрудник));
		СтрТЗНачисления.РазрядЕТС      = РаботникиОрганизацийДанные.РазрядЕТС;
		СтрТЗНачисления.КоэффициентЕТС = РаботникиОрганизацийДанные.КоэффициентЕТС;
		//Аверсон СВФР-008869
		
		//Аверсон ЕАЕ 16.10.2025 СВФР-017031
		Если Организация.ИНН = "700103211" Тогда
			ЧТС = ПроведениеРасчетов.ПолучитьЧТС(Организация, СтрТЗНачисления.Сотрудник, СтрТЗНачисления.ДатаНачала);
			СтрТЗНачисления.ЧТС = ЧТС;
		КонецЕсли;
		//Аверсон СВФР-017031
		
	КонецЦикла;
	//Аверсон 11.02.2022 КВВ СВФР-008736 )
	
	//+ СВЭЙ КДЯ 16.03.20 СВФР-005662
	//Отбор = Новый Структура( "Сотрудник, ВидРасчета, Основное,
	//|Показатель1, Показатель2, Показатель3, Показатель4, Показатель5, Показатель6, Размер,
	//|ПодразделениеОрганизации, ГрафикРаботы, СуммированныйУчетРабочегоВремени, СпособРасчета, ВидВремени" );
	//- СВЭЙ КДЯ 16.03.20 СВФР-005662
	//+ СВЭЙ КДЯ 16.03.20 СВФР-005662
	ПереченьИменКолонокОтбора = "";
	Для каждого ТекКолонка Из ТЗНачисления.Колонки Цикл
		ИмяКолонки = ТекКолонка.Имя;
		Если ИмяКолонки = "ДатаНачала" ИЛИ ИмяКолонки = "ДатаОкончания" Тогда
			Продолжить;	
		КонецЕсли; 
		ПереченьИменКолонокОтбора = 
		ПереченьИменКолонокОтбора + ?( ПереченьИменКолонокОтбора = "", "", ", " )
		+ ИмяКолонки;
	КонецЦикла; 
	Отбор = Новый Структура( ПереченьИменКолонокОтбора );
	//- СВЭЙ КДЯ 16.03.20 СВФР-005662
	
	//+ СВЭЙ КДЯ 14.01.20 СВФР-005236
	СотрудникиБезДублей = Новый Массив;
	//- СВЭЙ КДЯ 14.01.20 СВФР-005236
	
	//ПСА 06.10.2021 СВФР-008235 +++
	СотрудникиСДублем = Новый Массив;
	//+++ПСА 06.10.2021 СВФР-008235
	//+ СВЭЙ КДЯ 03.02.20 СВФР-005236
	Для каждого Стр Из ТЗНачисления Цикл
		ЗаполнитьЗначенияСвойств( Отбор, Стр );
		НайдДубли = ТЗНачисления.НайтиСтроки( Отбор );
		Если НайдДубли.Количество() <= 1 Тогда
			Если СотрудникиБезДублей.Найти( Стр.Сотрудник ) = Неопределено Тогда
				СотрудникиБезДублей.Добавить( Стр.Сотрудник );
			КонецЕсли;
			//ПСА 06.10.2021 СВФР-008235 +++	
		Иначе
			Если СотрудникиСДублем.Найти( Стр.Сотрудник ) = Неопределено Тогда
				СотрудникиСДублем.Добавить( Стр.Сотрудник );
			КонецЕсли; 
			//+++ПСА 06.10.2021 СВФР-008235
		КонецЕсли;
	КонецЦикла;
	//- СВЭЙ КДЯ 03.02.20 СВФР-005236
	
	
	Для каждого Стр Из ТЗНачисления Цикл
		
		//Аверсон ЕАЕ 25.11.2025 СВФР-017330
		//Пособие на второго ребенка и последующих может быть назначено 2 раза
		Если Стр.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаВторогоИПоследующихДо3Лет Тогда
			Продолжить;
		КонецЕсли;
		//Аверсон СВФР-017330
		
		Если СтрокиКУдалению.Найти( Стр ) <> Неопределено Тогда
			Продолжить;
		КонецЕсли; 
		
		ЗаполнитьЗначенияСвойств( Отбор, Стр );
		НайдДубли = ТЗНачисления.НайтиСтроки( Отбор );
		Если НайдДубли.Количество() <= 1 Тогда
			//+ СВЭЙ КДЯ 03.02.20 СВФР-005236
			////+ СВЭЙ КДЯ 14.01.20 СВФР-005236
			//Если СотрудникиБезДублей.Найти( Стр.Сотрудник ) = Неопределено Тогда
			//	СотрудникиБезДублей.Добавить( Стр.Сотрудник );
			//КонецЕсли; 
			////- СВЭЙ КДЯ 14.01.20 СВФР-005236
			//- СВЭЙ КДЯ 03.02.20 СВФР-005236
			Продолжить;	
		КонецЕсли;
		
		//+ СВЭЙ КДЯ 03.02.20 СВФР-005236
		Если СотрудникиБезДублей.Найти( Стр.Сотрудник ) <> Неопределено Тогда
			//ПСА 06.10.2021 СВФР-008235 +++
			Если СотрудникиСДублем.Найти( Стр.Сотрудник ) <> Неопределено Тогда
			Иначе
				//+++ПСА 06.10.2021 СВФР-008235	
				Продолжить;	
			КонецЕсли;
		КонецЕсли; 
		//- СВЭЙ КДЯ 03.02.20 СВФР-005236
		
		Для каждого СтрДубль Из НайдДубли Цикл
			Если СтрокиКУдалению.Найти( СтрДубль ) <> Неопределено Тогда
				Продолжить;
			КонецЕсли; 
			
			Если ТЗНачисления.Индекс( СтрДубль ) <= ТЗНачисления.Индекс( Стр ) Тогда
				Продолжить;		
			КонецЕсли;
			
			Если УчетВремениСвэй.ПолучитьПересечениеДиапазонов( 
				СтрДубль.ДатаНачала, СтрДубль.ДатаОкончания + Сутки, 
				Стр.ДатаНачала, Стр.ДатаОкончания + Сутки, Истина ) <> Неопределено Тогда //добавлено ", Истина " + СВЭЙ КДЯ 18.03.20 СВФР-005696
				Стр.ДатаНачала = Мин( Стр.ДатаНачала, СтрДубль.ДатаНачала );	
				Стр.ДатаОкончания = Макс( Стр.ДатаОкончания, СтрДубль.ДатаОкончания );	
				СтрокиКУдалению.Добавить( СтрДубль );
			КонецЕсли;
			
		КонецЦикла; 
	КонецЦикла;
	
	Для каждого СтрУдал Из СтрокиКУдалению Цикл
		
		//+ СВЭЙ КДЯ 14.01.20 СВФР-005236
		Если СотрудникиБезДублей.Найти( СтрУдал.Сотрудник ) <> Неопределено Тогда
			//ПСА 06.10.2021 СВФР-008235 +++			
			
			//Аверсон ЕАЕ 11.01.2022 СВФР-008587
			//Если СотрудникиСДублем.Найти( Стр.Сотрудник ) <> Неопределено Тогда
			Если СотрудникиСДублем.Найти( СтрУдал.Сотрудник ) <> Неопределено Тогда
				//Аверсон СВФР-008587
				
			Иначе	
				//+++ПСА 06.10.2021 СВФР-008235
				Продолжить;	
			КонецЕсли;
		КонецЕсли; 
		//- СВЭЙ КДЯ 14.01.20 СВФР-005236
		ТЗНачисления.Удалить( СтрУдал );		
		
	КонецЦикла; 
КонецПроцедуры
//- СВЭЙ КДЯ 03.01.20 СВФР-005236

// Выполняет автоматическое заполнение документа по данным документа и переданным параметрам
// 
// Параметры: 
//  ПериодЗаполнения - период (дата - начало месяца) за который необходимо выполнить автозаполнение
//  ПостроительЗапроса - построитель запроса, который используется для ограничения состава физлиц
//                       по которым выполняется заполнение документа
//  ПерерассчитываемыйДокумент - перерассчитываемый документ для автозаполнения документа 
//                               по перерассчитываемому начислению зарплаты
//  Физлица - массив физлиц перерасчета
//
// Возвращаемое значение:
//  Логическое - удалось ли выполнить автоматическое заполнение документа
//
Функция ВыполнитьАвтозаполнение(НачалоПериодаЗаполнения, ОкончаниеПериодаЗаполнения, Запрос = Неопределено, ЭтоПерерасчет = Ложь, СписокФизЛиц = Неопределено, МассивСотрудники = Неопределено,ТЧДоговора=Ложь) Экспорт
	
	//Островская Татьяна 29.10.2013 № 16865
	если ТЧДоговора Тогда 
		ТЧДоговораРекв = Истина;
	иначе
		ТЧДоговораРекв = Ложь;
	КонецЕсли;
	//Островская Татьяна 29.10.2013 № 16865
	РасчетЗарплатыОрганизацииПоОтветственным = ПроцедурыУправленияПерсоналом.ЗначениеУчетнойПолитикиПоПерсоналуОрганизации(глЗначениеПеременной("глУчетнаяПолитикаПоПерсоналуОрганизации"), Организация, "РасчетЗарплатыОрганизацииПоОтветственным");
	ГоловнаяОрганизация = ОбщегоНазначения.ГоловнаяОрганизация(Организация);
	// О.Т. 02.12.2014 
	ТЧРаботавшиеВПраздники = Новый ТаблицаЗначений;
	ТЧРаботавшиеВПраздники.Колонки.Добавить("Авторасчет");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ЧасыИзДокумента");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("Сотрудник");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ПодразделениеОрганизации");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ДатаНачалаСобытия");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ДатаНачала");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ДатаОкончания");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ВидРасчета");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ОплаченоДней");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ОплаченоДнейЧасов");
	ТЧРаботавшиеВПраздники.Колонки.Добавить("ТабНомер");
	// О.Т. 02.12.2014 
	
	//О.Т. Аверсон 31.05.2017 № 685	
	ЗапросУП = Новый Запрос;
	ЗапросУП.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.НеРазбиватьУдержанияПоПериодам
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
	
	ЗапросУП.УстановитьПараметр("Организация", Организация);
	
	РезультатЗапросаУП = ЗапросУП.Выполнить().Выбрать();
	НеРазбиватьУдержанияПоПериодам = Ложь;
	Пока РезультатЗапросаУП.Следующий() Цикл
		НеРазбиватьУдержанияПоПериодам = РезультатЗапросаУП.НеРазбиватьУдержанияПоПериодам;
	КонецЦикла;  
	//О.Т. Аверсон 31.05.2017 № 685
	
	
	// готовим объект Запрос и 
	// определяем тексты условий ПоВсемПодразделениямОрганизации и УсловиеНаПодразделение.
	Если Запрос = Неопределено Тогда
		
		Запрос = Новый Запрос;
		Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		
		// подготовим временную таблицу с подразделениями
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005696
		//ПоВсемПодразделениямОрганизации = Истина;
		//ТекстЗапросаПоПодразделениям = 
		//"ВЫБРАТЬ
		//|	НЕОПРЕДЕЛЕНО КАК Подразделение
		//|ПОМЕСТИТЬ ВТПодразделенияОтбора
		//|";
		//- СВЭЙ КДЯ 18.03.20 СВФР-005696
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005696
		ПоВсемПодразделениямОрганизации = НЕ ЗначениеЗаполнено(ПодразделениеОрганизации);
		ТекстЗапросаПоПодразделениям = 
		"ВЫБРАТЬ
		|	ISNULL( Ссылка, Неопределено ) КАК Подразделение
		|ПОМЕСТИТЬ ВТПодразделенияОтбора
		|ИЗ
		|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
		|ГДЕ
		|	ПодразделенияОрганизаций.Ссылка В ИЕРАРХИИ(&парамПодразделение)
		|"; 
		Запрос.УстановитьПараметр( "парамПодразделение", ПодразделениеОрганизации );
		//- СВЭЙ КДЯ 18.03.20 СВФР-005696
		
		
		
		Если МассивСотрудники = Неопределено Тогда
			
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
				ПоВсемПодразделениямОрганизации = Ложь;
				Запрос.УстановитьПараметр("парамПодразделение", ПодразделениеОрганизации);
				Запрос.УстановитьПараметр("ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации));  //+ СВЭЙ КДЯ 28.02.20 СВФР-005496
				ТекстЗапросаПоПодразделениям = 
				"ВЫБРАТЬ
				|	ПодразделенияОрганизаций.Ссылка КАК Подразделение
				|ПОМЕСТИТЬ ВТПодразделенияОтбора
				|ИЗ
				|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
				|ГДЕ
				|	ПодразделенияОрганизаций.Ссылка В ИЕРАРХИИ(&парамПодразделение)
				//толик			
				//|	ПодразделенияОрганизаций.Ссылка = &парамПодразделение
				|
				|ИНДЕКСИРОВАТЬ ПО Подразделение";
			ИначеЕсли ЗначениеЗаполнено(Ответственный) И РасчетЗарплатыОрганизацииПоОтветственным Тогда
				ПоВсемПодразделениямОрганизации = Ложь;
				Запрос.УстановитьПараметр("парамПользователь", Ответственный);
				Запрос.УстановитьПараметр("парамНачало", НачалоПериодаЗаполнения);
				ТекстЗапросаПоПодразделениям = 
				"ВЫБРАТЬ
				|	ПодразделенияОрганизаций.Ссылка КАК Подразделение
				|ПОМЕСТИТЬ ВТПодразделенияОтбора
				|ИЗ
				|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
				|ГДЕ
				|	ПодразделенияОрганизаций.Ссылка В ИЕРАРХИИ
				|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
				|				Расчетчики.ПодразделениеОрганизации
				|			ИЗ
				|				РегистрСведений.РасчетчикиЗарплатыОрганизаций.СрезПоследних(&парамНачало) КАК Расчетчики
				|			ГДЕ
				|				Расчетчики.Пользователь = &парамПользователь)
				|
				|ИНДЕКСИРОВАТЬ ПО Подразделение";
			КонецЕсли;
			
			Если РасчетЗарплатыОрганизацииПоОтветственным И ЗначениеЗаполнено(Ответственный) Тогда
				// Проверим ответственного - является ли он расчетчиком вообще и для заданного 
				// подразделения (если оно задано)
				Запрос.УстановитьПараметр("парамПользователь" , Ответственный);
				Запрос.УстановитьПараметр("парамНачало" , НачалоПериодаЗаполнения);
				Если ПодразделениеОрганизации.Пустая() Тогда
					Запрос.Текст = 
					"ВЫБРАТЬ ПЕРВЫЕ 1
					|	Расчетчики.ПодразделениеОрганизации
					|ИЗ
					|	РегистрСведений.РасчетчикиЗарплатыОрганизаций.СрезПоследних(&парамНачало, ) КАК Расчетчики
					|ГДЕ
					|	Расчетчики.Пользователь = &парамПользователь";
					Если Запрос.Выполнить().Пустой() Тогда
						ОбщегоНазначения.ОшибкаРасчета("Ответственный за этот документ не является расчетчиком ни одного из подразделений организации");
						Возврат  Ложь;
					КонецЕсли;
				Иначе
					Запрос.Текст = 
					"ВЫБРАТЬ ПЕРВЫЕ 1
					|	Подразделения.Ссылка
					|ИЗ
					|	Справочник.ПодразделенияОрганизаций КАК Подразделения
					|ГДЕ
					|	Подразделения.Ссылка В ИЕРАРХИИ(&парамПодразделение)
					|	И Подразделения.Ссылка В ИЕРАРХИИ
					|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
					|				Расчетчики.ПодразделениеОрганизации
					|			ИЗ
					|				РегистрСведений.РасчетчикиЗарплатыОрганизаций.СрезПоследних(&парамНачало) КАК Расчетчики
					|			ГДЕ
					|				Расчетчики.Пользователь = &парамПользователь)";
					Запрос.УстановитьПараметр("парамПодразделение" , ПодразделениеОрганизации);
					Запрос.УстановитьПараметр("ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации));  //+ СВЭЙ КДЯ 28.02.20 СВФР-005496
					Если Запрос.Выполнить().Пустой() Тогда
						ОбщегоНазначения.ОшибкаРасчета("Ответственный за этот документ не является расчетчиком для выбранного подразделения");
						Возврат  Ложь;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			Запрос.УстановитьПараметр("ФизЛица",				СписокФизЛиц);
			Запрос.УстановитьПараметр("ПоВсемФизЛицам",			СписокФизЛиц = Неопределено);
			Запрос.УстановитьПараметр("парамОрганизация",		Организация);
			Запрос.УстановитьПараметр("парамГоловнаяОрганизация",ГоловнаяОрганизация);
			Запрос.УстановитьПараметр("парамНачало",			НачалоПериодаЗаполнения);
			Запрос.УстановитьПараметр("парамКонец",				КонецДня(ОкончаниеПериодаЗаполнения));
			Запрос.УстановитьПараметр("парамКонец1",				КонецДня(ОкончаниеПериодаЗаполнения+86400)); // О.Т.
			если  Организация.ИНН = "100765738" Тогда 
				
				ЗапросМассивФизЛиц = 
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
				|	РаботникиОрганизации.Сотрудник.Физлицо КАК Физлицо
				|ПОМЕСТИТЬ ВТСписокФизЛиц
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|			&парамНачало,
				|			Организация = &парамГоловнаяОрганизация
				|				И (&ПоВсемФизЛицам
				|					ИЛИ Сотрудник.ФизЛицо В (&ФизЛица))) КАК РаботникиОрганизации
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО РаботникиОрганизации.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	ВЫБОР
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ПричинаИзмененияСостоянияЗавершения
				|			ИНАЧЕ РаботникиОрганизации.ПричинаИзмененияСостояния
				|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|	И ВЫБОР
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ОбособленноеПодразделениеЗавершения
				|			ИНАЧЕ РаботникиОрганизации.ОбособленноеПодразделение
				|		КОНЕЦ = &парамОрганизация
				|	И ВЫБОР
				|			КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
				|				ТОГДА ВЫБОР
				|						КОГДА &ПоВсемПодразделениям
				|							ТОГДА ИСТИНА
				|						КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|								И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|							ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
				|									(ВЫБРАТЬ
				|										Подразделения.Подразделение
				|									ИЗ
				|										ВТПодразделенияОтбора КАК Подразделения)
				|						ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
				|								(ВЫБРАТЬ
				|									Подразделения.Подразделение
				|								ИЗ
				|									ВТПодразделенияОтбора КАК Подразделения)
				|					КОНЕЦ
				|			ИНАЧЕ ЛОЖЬ
				|		КОНЕЦ
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	РаботникиОрганизации.Сотрудник.Физлицо
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО РаботникиОрганизации.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	РаботникиОрганизации.Период > &парамНачало
				|	И РаботникиОрганизации.Период <= &парамКонец
				|	И РаботникиОрганизации.Организация = &парамГоловнаяОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ РаботникиОрганизации.Сотрудник.Физлицо В (&ФизЛица))
				|	И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
				|	И (&ПоВсемПодразделениям
				|			ИЛИ ВЫБОР
				|				КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
				|					ТОГДА РаботникиОрганизации.ПодразделениеОрганизации В
				|							(ВЫБРАТЬ
				|								Подразделения.Подразделение
				|							ИЗ
				|								ВТПодразделенияОтбора КАК Подразделения)
				|				ИНАЧЕ ЛОЖЬ
				|			КОНЕЦ)
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	Работники.Сотрудник.Физлицо
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК Работники
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
				|		ПО Работники.Сотрудник = ПериодыПерекрытия.Сотрудник
				|			И (ПериодыПерекрытия.Период <= Работники.ПериодЗавершения)
				|			И (ПериодыПерекрытия.Период > Работники.Период)
				|			И (ПериодыПерекрытия.Организация = &парамГоловнаяОрганизация)
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО Работники.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|	И Работники.ПериодЗавершения > &парамНачало
				|	И Работники.ПериодЗавершения <= &парамКонец
				|	И Работники.Организация = &парамГоловнаяОрганизация
				|	И Работники.ОбособленноеПодразделениеЗавершения = &парамОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ Работники.Сотрудник.Физлицо В (&ФизЛица))
				|	И (&ПоВсемПодразделениям
				|			ИЛИ ВЫБОР
				|				КОГДА Работники.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
				|					ТОГДА Работники.ПодразделениеОрганизацииЗавершения В
				|							(ВЫБРАТЬ
				|								Подразделения.Подразделение
				|							ИЗ
				|								ВТПодразделенияОтбора КАК Подразделения)
				|				ИНАЧЕ ЛОЖЬ
				|			КОНЕЦ)
				|	И ПериодыПерекрытия.Период ЕСТЬ NULL 
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.Физлицо
				|ИЗ
				|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала <= &парамКонец
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания >= &парамНачало
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Организация = &парамОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо В (&ФизЛица))
				|	И (&ПоВсемПодразделениям
				|			ИЛИ ВЫБОР
				|				КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
				|					ТОГДА ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В
				|							(ВЫБРАТЬ
				|								Подразделения.Подразделение
				|							ИЗ
				|								ВТПодразделенияОтбора КАК Подразделения)
				|				ИНАЧЕ ЛОЖЬ
				|			КОНЕЦ)
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1"; 
				
				
				
				
				
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
				Запрос.УстановитьПараметр( "ЭтоПерерасчет" , ЭтоПерерасчет ); 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				
				
				ТекстЗапросаПоСпискуРаботников = "
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 3
				|ВЫБРАТЬ
				|	Сотрудник
				|	ПОМЕСТИТЬ ВтРассчитанныеСотрудники
				|ИЗ
				|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
				|ГДЕ
				|	Начисления.Ссылка <> &ТекущийДокумент 
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
				|	И НЕ &ЭтоПерерасчет 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
				|	И ( &ВсеПодразделения 
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				//- СВЭЙ КДЯ 28.02.20 СВФР-005496
				|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
				|	И Начисления.Ссылка.Проведен	
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|	Сотрудник
				|ИЗ
				|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
				|ГДЕ
				|	Начисления.Ссылка <> &ТекущийДокумент	
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
				|	И НЕ &ЭтоПерерасчет 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
				|	И ( &ВсеПодразделения 
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				//- СВЭЙ КДЯ 28.02.20 СВФР-005496
				|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
				|	И Начисления.Ссылка.Проведен	
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|	Сотрудник
				|ИЗ
				|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Начисления
				|ГДЕ
				|	Начисления.Ссылка <> &ТекущийДокумент	
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
				|	И НЕ &ЭтоПерерасчет 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
				|	И ( &ВсеПодразделения 
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				//- СВЭЙ КДЯ 28.02.20 СВФР-005496
				|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
				|	И Начисления.Ссылка.Проведен	
				|;
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
				|	РаботникиОрганизации.Сотрудник КАК Сотрудник,
				|	РаботникиОрганизации.Сотрудник.Физлицо КАК Физлицо
				|ПОМЕСТИТЬ ВТСписокРаботников
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|			&парамНачало,
				|			Организация = &парамГоловнаяОрганизация
				|				И (&ПоВсемФизЛицам
				|					ИЛИ Сотрудник.ФизЛицо В (&ФизЛица))) КАК РаботникиОрганизации
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО РаботникиОрганизации.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	ВЫБОР
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ПричинаИзмененияСостоянияЗавершения
				|			ИНАЧЕ РаботникиОрганизации.ПричинаИзмененияСостояния
				|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|	И ВЫБОР
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ОбособленноеПодразделениеЗавершения
				|			ИНАЧЕ РаботникиОрганизации.ОбособленноеПодразделение
				|		КОНЕЦ = &парамОрганизация
				|	И ВЫБОР
				|			КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
				|				ТОГДА ВЫБОР
				|						КОГДА &ПоВсемПодразделениям
				|							ТОГДА ИСТИНА
				|						КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|								И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|							ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
				|									(ВЫБРАТЬ
				|										Подразделения.Подразделение
				|									ИЗ
				|										ВТПодразделенияОтбора КАК Подразделения)
				|						ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
				|								(ВЫБРАТЬ
				|									Подразделения.Подразделение
				|								ИЗ
				|									ВТПодразделенияОтбора КАК Подразделения)
				|					КОНЕЦ
				|			КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
				|				ТОГДА ВЫБОР
				|						КОГДА РаботникиОрганизации.Сотрудник.Физлицо В
				|								(ВЫБРАТЬ
				|									ФизЛицаМассив.ФизЛицо
				|								ИЗ
				|									ВТСписокФизЛиц КАК ФизЛицаМассив)
				|							ТОГДА ИСТИНА
				|						ИНАЧЕ ЛОЖЬ
				|					КОНЕЦ
				|			ИНАЧЕ ВЫБОР
				|					КОГДА &ПоВсемПодразделениям
				|						ТОГДА ИСТИНА
				|					КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|							И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
				|								(ВЫБРАТЬ
				|									Подразделения.Подразделение
				|								ИЗ
				|									ВТПодразделенияОтбора КАК Подразделения)
				|					ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
				|							(ВЫБРАТЬ
				|								Подразделения.Подразделение
				|							ИЗ
				|								ВТПодразделенияОтбора КАК Подразделения)
				|				КОНЕЦ
				|		КОНЕЦ
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 3
				|	И НЕ РаботникиОрганизации.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	РаботникиОрганизации.Сотрудник,
				|	РаботникиОрганизации.Сотрудник.Физлицо
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО РаботникиОрганизации.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	РаботникиОрганизации.Период > &парамНачало
				|	И РаботникиОрганизации.Период <= &парамКонец
				|	И РаботникиОрганизации.Организация = &парамГоловнаяОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ РаботникиОрганизации.Сотрудник.Физлицо В (&ФизЛица))
				|	И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
				|	И (&ПоВсемПодразделениям
				|			ИЛИ ВЫБОР
				|				КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
				|					ТОГДА РаботникиОрганизации.ПодразделениеОрганизации В
				|							(ВЫБРАТЬ
				|								Подразделения.Подразделение
				|							ИЗ
				|								ВТПодразделенияОтбора КАК Подразделения)
				|				КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
				|					ТОГДА ВЫБОР
				|							КОГДА РаботникиОрганизации.Сотрудник.Физлицо В
				|									(ВЫБРАТЬ
				|										ФизЛицаМассив.ФизЛицо
				|									ИЗ
				|										ВТСписокФизЛиц КАК ФизЛицаМассив)
				|								ТОГДА ИСТИНА
				|							ИНАЧЕ ЛОЖЬ
				|						КОНЕЦ
				|				ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
				|						(ВЫБРАТЬ
				|							Подразделения.Подразделение
				|						ИЗ
				|							ВТПодразделенияОтбора КАК Подразделения)
				|			КОНЕЦ)
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 3
				|	И НЕ РаботникиОрганизации.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	Работники.Сотрудник,
				|	Работники.Сотрудник.Физлицо
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК Работники
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
				|		ПО Работники.Сотрудник = ПериодыПерекрытия.Сотрудник
				|			И (ПериодыПерекрытия.Период <= Работники.ПериодЗавершения)
				|			И (ПериодыПерекрытия.Период > Работники.Период)
				|			И (ПериодыПерекрытия.Организация = &парамГоловнаяОрганизация)
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО Работники.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|	И Работники.ПериодЗавершения > &парамНачало
				|	И Работники.ПериодЗавершения <= &парамКонец
				|	И Работники.Организация = &парамГоловнаяОрганизация
				|	И Работники.ОбособленноеПодразделениеЗавершения = &парамОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ Работники.Сотрудник.Физлицо В (&ФизЛица))
				|	И (&ПоВсемПодразделениям
				|			ИЛИ ВЫБОР
				|				КОГДА Работники.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
				|					ТОГДА Работники.ПодразделениеОрганизацииЗавершения В
				|							(ВЫБРАТЬ
				|								Подразделения.Подразделение
				|							ИЗ
				|								ВТПодразделенияОтбора КАК Подразделения)
				|				КОГДА Работники.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.внутреннееСовместительство)
				|					ТОГДА ВЫБОР
				|							КОГДА Работники.Сотрудник.Физлицо В
				|									(ВЫБРАТЬ
				|										ФизЛицаМассив.ФизЛицо
				|									ИЗ
				|										ВТСписокФизЛиц КАК ФизЛицаМассив)
				|								ТОГДА ИСТИНА
				|							ИНАЧЕ ЛОЖЬ
				|						КОНЕЦ
				|				ИНАЧЕ Работники.ПодразделениеОрганизацииЗавершения В
				|						(ВЫБРАТЬ
				|							Подразделения.Подразделение
				|						ИЗ
				|							ВТПодразделенияОтбора КАК Подразделения)
				|			КОНЕЦ)
				|	И ПериодыПерекрытия.Период ЕСТЬ NULL 
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 3
				|	И НЕ Работники.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник,
				|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.Физлицо
				|ИЗ
				|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала <= &парамКонец
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания >= &парамНачало
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Организация = &парамОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо В (&ФизЛица))
				|	И (&ПоВсемПодразделениям
				|			ИЛИ ВЫБОР
				|				КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
				|					ТОГДА ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В
				|							(ВЫБРАТЬ
				|								Подразделения.Подразделение
				|							ИЗ
				|								ВТПодразделенияОтбора КАК Подразделения)
				|				КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.внутреннеесовместительство)
				|					ТОГДА ВЫБОР
				|							КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.Физлицо В
				|									(ВЫБРАТЬ
				|										ФизЛицаМассив.ФизЛицо
				|									ИЗ
				|										ВТСписокФизЛиц КАК ФизЛицаМассив)
				|								ТОГДА ИСТИНА
				|							ИНАЧЕ ЛОЖЬ
				|						КОНЕЦ
				|				ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В
				|						(ВЫБРАТЬ
				|							Подразделения.Подразделение
				|						ИЗ
				|							ВТПодразделенияОтбора КАК Подразделения)
				|			КОНЕЦ)
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 3
				|	И НЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник"; //О.Т. 18.09.2014 № 229		
			иначе
				
				
				
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
				Запрос.УстановитьПараметр( "ЭтоПерерасчет" , ЭтоПерерасчет ); 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				
				ТекстЗапросаПоСпискуРаботников = "
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 2
				|ВЫБРАТЬ //Заполнить по всем
				|	Сотрудник
				|	ПОМЕСТИТЬ ВтРассчитанныеСотрудники
				|ИЗ
				|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
				|ГДЕ
				|	Начисления.Ссылка <> &ТекущийДокумент 
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
				|	И НЕ &ЭтоПерерасчет 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
				|	И ( &ВсеПодразделения 
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				//- СВЭЙ КДЯ 28.02.20 СВФР-005496
				|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
				|	И Начисления.Ссылка.Проведен	
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|	Сотрудник
				|ИЗ
				|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
				|ГДЕ
				|	Начисления.Ссылка <> &ТекущийДокумент	
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
				|	И НЕ &ЭтоПерерасчет 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
				|	И ( &ВсеПодразделения 
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				//- СВЭЙ КДЯ 28.02.20 СВФР-005496
				|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
				|	И Начисления.Ссылка.Проведен	
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|	Сотрудник
				|ИЗ
				|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Начисления
				|ГДЕ
				|	Начисления.Ссылка <> &ТекущийДокумент	
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
				|	И НЕ &ЭтоПерерасчет 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
				|	И ( &ВсеПодразделения 
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				//- СВЭЙ КДЯ 18.03.20 СВФР-005682
				|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				//- СВЭЙ КДЯ 28.02.20 СВФР-005496
				|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
				|	И Начисления.Ссылка.Проведен	
				|;
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
				|	РаботникиОрганизации.Сотрудник КАК Сотрудник,
				|	РаботникиОрганизации.Сотрудник.Физлицо КАК Физлицо
				|ПОМЕСТИТЬ ВТСписокРаботников
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|			&парамНачало,
				|			Организация = &парамГоловнаяОрганизация
				|				И (&ПоВсемФизЛицам
				|					ИЛИ Сотрудник.ФизЛицо В (&ФизЛица))) КАК РаботникиОрганизации
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО РаботникиОрганизации.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	ВЫБОР
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ПричинаИзмененияСостоянияЗавершения
				|			ИНАЧЕ РаботникиОрганизации.ПричинаИзмененияСостояния
				|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|	И ВЫБОР
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ОбособленноеПодразделениеЗавершения
				|			ИНАЧЕ РаботникиОрганизации.ОбособленноеПодразделение
				|		КОНЕЦ = &парамОрганизация
				|	И ВЫБОР
				|			КОГДА &ПоВсемПодразделениям
				|				ТОГДА ИСТИНА
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
				|						(ВЫБРАТЬ
				|							Подразделения.Подразделение
				|						ИЗ
				|							ВТПодразделенияОтбора КАК Подразделения)
				|			ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
				|					(ВЫБРАТЬ
				|						Подразделения.Подразделение
				|					ИЗ
				|						ВТПодразделенияОтбора КАК Подразделения)
				|		КОНЕЦ
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 2
				|	И НЕ РаботникиОрганизации.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	РаботникиОрганизации.Сотрудник,
				|	РаботникиОрганизации.Сотрудник.Физлицо
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО РаботникиОрганизации.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	РаботникиОрганизации.Период > &парамНачало
				|	И РаботникиОрганизации.Период <= &парамКонец
				|	И РаботникиОрганизации.Организация = &парамГоловнаяОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ РаботникиОрганизации.Сотрудник.Физлицо В (&ФизЛица))
				|	И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
				|	И (&ПоВсемПодразделениям
				|			ИЛИ РаботникиОрганизации.ПодразделениеОрганизации В
				|				(ВЫБРАТЬ
				|					Подразделения.Подразделение
				|				ИЗ
				|					ВТПодразделенияОтбора КАК Подразделения))
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 2
				|	И НЕ РаботникиОрганизации.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	Работники.Сотрудник,
				|	Работники.Сотрудник.Физлицо
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК Работники
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
				|		ПО Работники.Сотрудник = ПериодыПерекрытия.Сотрудник
				|			И (ПериодыПерекрытия.Период <= Работники.ПериодЗавершения)
				|			И (ПериодыПерекрытия.Период > Работники.Период)
				|			И (ПериодыПерекрытия.Организация = &парамГоловнаяОрганизация)
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО Работники.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|	И Работники.ПериодЗавершения > &парамНачало
				|	И Работники.ПериодЗавершения <= &парамКонец
				|	И Работники.Организация = &парамГоловнаяОрганизация
				|	И Работники.ОбособленноеПодразделениеЗавершения = &парамОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ Работники.Сотрудник.Физлицо В (&ФизЛица))
				|	И (&ПоВсемПодразделениям
				|			ИЛИ Работники.ПодразделениеОрганизацииЗавершения В
				|				(ВЫБРАТЬ
				|					Подразделения.Подразделение
				|				ИЗ
				|					ВТПодразделенияОтбора КАК Подразделения))
				|	И ПериодыПерекрытия.Период ЕСТЬ NULL 
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 2
				|	И НЕ Работники.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник,
				|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.Физлицо
				|ИЗ
				|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|			РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
				|			УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамКонец1, НЕ Регистратор ССЫЛКА Документ.ПлановоеШтатноеРасписаниеОрганизаций) КАК РаботникиОрганизацийСрезПоследних
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				|				ПО РаботникиОрганизацийСрезПоследних.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				|		ГДЕ
				|			РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК Увольнение
				|		ПО ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = Увольнение.Сотрудник
				|ГДЕ
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала <= &парамКонец
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания >= &парамНачало
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Организация = &парамОрганизация
				|	И (&ПоВсемФизЛицам
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо В (&ФизЛица))
				|	И (&ПоВсемПодразделениям
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В
				|				(ВЫБРАТЬ
				|					Подразделения.Подразделение
				|				ИЗ
				|					ВТПодразделенияОтбора КАК Подразделения))
				|	И ЕСТЬNULL(Увольнение.ДатаУвольнения, 1) = 1
				//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 2
				|	И НЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
				//- СВЭЙ КДЯ 14.02.20 СВФР-005496
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник"; //О.Т. 18.09.2014 № 229		
			КонецЕсли;
			
		Иначе
			Если не НеРазбиватьУдержанияПоПериодам Тогда //О.Т. Аверсон 31.05.2017 № 685
				Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
					ПоВсемПодразделениямОрганизации = Ложь;
					Запрос.УстановитьПараметр("парамПодразделение", ПодразделениеОрганизации);
					Запрос.УстановитьПараметр("ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации));  //+ СВЭЙ КДЯ 28.02.20 СВФР-005496
					
					ТекстЗапросаПоПодразделениям = 
					"ВЫБРАТЬ
					|	ПодразделенияОрганизаций.Ссылка КАК Подразделение
					|ПОМЕСТИТЬ ВТПодразделенияОтбора
					|ИЗ
					|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
					|ГДЕ
					|	ПодразделенияОрганизаций.Ссылка В ИЕРАРХИИ(&парамПодразделение)
					//толик			
					//|	ПодразделенияОрганизаций.Ссылка = &парамПодразделение
					|
					|ИНДЕКСИРОВАТЬ ПО Подразделение";
				ИначеЕсли ЗначениеЗаполнено(Ответственный) И РасчетЗарплатыОрганизацииПоОтветственным Тогда
					ПоВсемПодразделениямОрганизации = Ложь;
					Запрос.УстановитьПараметр("парамПользователь", Ответственный);
					Запрос.УстановитьПараметр("парамНачало", НачалоПериодаЗаполнения);
					ТекстЗапросаПоПодразделениям = 
					"ВЫБРАТЬ
					|	ПодразделенияОрганизаций.Ссылка КАК Подразделение
					|ПОМЕСТИТЬ ВТПодразделенияОтбора
					|ИЗ
					|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
					|ГДЕ
					|	ПодразделенияОрганизаций.Ссылка В ИЕРАРХИИ
					|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
					|				Расчетчики.ПодразделениеОрганизации
					|			ИЗ
					|				РегистрСведений.РасчетчикиЗарплатыОрганизаций.СрезПоследних(&парамНачало) КАК Расчетчики
					|			ГДЕ
					|				Расчетчики.Пользователь = &парамПользователь)
					|
					|ИНДЕКСИРОВАТЬ ПО Подразделение";
				КонецЕсли;
			КонецЕсли;
			
			
			
			//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
			Запрос.УстановитьПараметр( "ЭтоПерерасчет" , ЭтоПерерасчет ); 
			//- СВЭЙ КДЯ 18.03.20 СВФР-005682
			
			Запрос.УстановитьПараметр("Сотрудники", МассивСотрудники);
			ТекстЗапросаПоСпискуРаботников = "
			//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 1
			|ВЫБРАТЬ  // + По всем работникам
			|	Сотрудник
			|	ПОМЕСТИТЬ ВтРассчитанныеСотрудники
			|ИЗ
			|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
			|ГДЕ
			|	Начисления.Ссылка <> &ТекущийДокумент 
			//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
			|	И НЕ &ЭтоПерерасчет 
			//- СВЭЙ КДЯ 18.03.20 СВФР-005682
			//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
			|	И ( &ВсеПодразделения 
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
			//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
			//- СВЭЙ КДЯ 18.03.20 СВФР-005682
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
			//- СВЭЙ КДЯ 28.02.20 СВФР-005496
			|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
			|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
			|	И Начисления.Ссылка.Проведен	
			|ОБЪЕДИНИТЬ ВСЕ
			|ВЫБРАТЬ
			|	Сотрудник
			|ИЗ
			|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
			|ГДЕ
			|	Начисления.Ссылка <> &ТекущийДокумент	
			//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
			|	И НЕ &ЭтоПерерасчет 
			//- СВЭЙ КДЯ 18.03.20 СВФР-005682
			//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
			|	И ( &ВсеПодразделения 
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
			//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
			//- СВЭЙ КДЯ 18.03.20 СВФР-005682
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
			//- СВЭЙ КДЯ 28.02.20 СВФР-005496
			|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
			|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
			|	И Начисления.Ссылка.Проведен	
			|ОБЪЕДИНИТЬ ВСЕ
			|ВЫБРАТЬ
			|	Сотрудник
			|ИЗ
			|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Начисления
			|ГДЕ
			|	Начисления.Ссылка <> &ТекущийДокумент	
			//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
			|	И НЕ &ЭтоПерерасчет 
			//- СВЭЙ КДЯ 18.03.20 СВФР-005682
			//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
			|	И ( &ВсеПодразделения 
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
			//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
			//- СВЭЙ КДЯ 18.03.20 СВФР-005682
			|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
			//- СВЭЙ КДЯ 28.02.20 СВФР-005496
			|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
			|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
			|	И Начисления.Ссылка.Проведен	
			|;
			|
			//- СВЭЙ КДЯ 14.02.20 СВФР-005496
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СотрудникиОрганизаций.Ссылка КАК Сотрудник,
			|	СотрудникиОрганизаций.Физлицо
			|ПОМЕСТИТЬ ВТСписокРаботников
			|ИЗ
			|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
			|ГДЕ
			|	СотрудникиОрганизаций.Ссылка В(&Сотрудники)
			//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 1
			|	И НЕ СотрудникиОрганизаций.Ссылка В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники КАК РассчитанныеСотрудники )
			//- СВЭЙ КДЯ 14.02.20 СВФР-005496
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
			
		КонецЕсли;
		
		// создаем временную таблицу с подразделениями
		Запрос.Текст = ТекстЗапросаПоПодразделениям;
		Запрос.УстановитьПараметр("ПоВсемПодразделениям", ПоВсемПодразделениямОрганизации);
		
		Запрос.Выполнить();
		
		// создаем временную таблицу ВТСписокРаботников с сотрудниками, отобранными по подразделению или из переданного списка 
		// 
		// Поля:
		//   Сотрудник
		//   Физлицо
		//
		
		если Организация.ИНН = "100765738" и МассивСотрудники = Неопределено Тогда 
			Запрос.Текст = ЗапросМассивФизЛиц;			
			Запрос.Выполнить();
		КонецЕсли;
		
		//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
		ТекстЗапросаПоСпискуРаботников =  ТекстЗапросаПоСпискуРаботников + "
		|;
		|
		|ВЫБРАТЬ
		|	ВТСписокРаботников.Физлицо КАК Физлицо,
		|	КОЛИЧЕСТВО( РАЗЛИЧНЫЕ ВТСписокРаботников.Сотрудник ) КАК КоличествоДублейФизЛиц,
		|	МАКСИМУМ( ВЫБОР КОГДА Сотрудники.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы) ТОГДА Истина ИНАЧЕ Ложь КОНЕЦ ) КАК ЕстьСотрудникОсновноеМестоРаботы,
		|	МИНИМУМ( ВЫБОР 
		|				КОГДА Сотрудники.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы) ТОГДА Сотрудники.Код 
		|				ИНАЧЕ 9999999999
		|			 КОНЕЦ ) КАК МинимальныйТабельныйНомерОсновной,
		|	МИНИМУМ( Сотрудники.Код ) КАК МинимальныйТабельныйНомерОбщий
		|	ПОМЕСТИТЬ ВТКритерииСверткиДублейФизЛиц	
		|ИЗ
		|	ВТСписокРаботников КАК ВТСписокРаботников
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СотрудникиОрганизаций КАК Сотрудники
		|		ПО ВТСписокРаботников.Сотрудник = Сотрудники.Ссылка
		|СГРУППИРОВАТЬ ПО
		|	ВТСписокРаботников.Физлицо
		|ИНДЕКСИРОВАТЬ ПО Физлицо			
		|;
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ВТСписокРаботников.Физлицо КАК Физлицо,
		|	ВТСписокРаботников.Сотрудник КАК Сотрудник
		|	ПОМЕСТИТЬ ВТБезДублейФизЛицСписокРаботников
		|ИЗ
		|	ВТСписокРаботников КАК ВТСписокРаботников
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СотрудникиОрганизаций КАК Сотрудники
		|		ПО ВТСписокРаботников.Сотрудник = Сотрудники.Ссылка
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТКритерииСверткиДублейФизЛиц КАК Критерии
		|		ПО ВТСписокРаботников.Физлицо = Критерии.Физлицо
		|			И ( Критерии.КоличествоДублейФизЛиц = 1
		|				ИЛИ Сотрудники.Код = ВЫБОР КОГДА Критерии.ЕстьСотрудникОсновноеМестоРаботы 
		|										ТОГДА Критерии.МинимальныйТабельныйНомерОсновной 
		|										ИНАЧЕ Критерии.МинимальныйТабельныйНомерОбщий
		|									 КОНЕЦ
		|			   )
		|
		|ИНДЕКСИРОВАТЬ ПО Сотрудник			
		|";
		//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
		
		
		Запрос.Текст = ТекстЗапросаПоСпискуРаботников;
		
		//+ СВЭЙ КДЯ 14.02.20 СВФР-005496
		Запрос.УстановитьПараметр( "ТекущийДокумент", Ссылка );
		Запрос.УстановитьПараметр( "ТекущийДокументДатаНачала", ПериодНачисленияДатаНачала );
		Запрос.УстановитьПараметр( "ТекущийДокументДатаОкончания", ПериодНачисленияДатаОкончания );
		Запрос.УстановитьПараметр( "парамПодразделение", ПодразделениеОрганизации );
		Запрос.УстановитьПараметр( "ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации));  //+ СВЭЙ КДЯ 28.02.20 СВФР-005496
		//- СВЭЙ КДЯ 14.02.20 СВФР-005496
		
		запр = Запрос.Выполнить();
		//Аверсон-софт, Островская Татьяна 13.03.2012
		ЗапросРаботников = Запр.Выбрать();
		
		//Аверсон-софт, Плиско Ю.А. / 12.11.2014 / {Начало:
		если Организация.ИНН = "100765738" Тогда 
			ЗаполнитьРаботавшимиВПраздники(Запрос,,ТЧРаботавшиеВПраздники);// О.Т. 02.12.2014 
		КонецЕсли;
		//Аверсон-софт, Плиско Ю.А. / 12.11.2014 / Конец.}
		
	Иначе // НЕ Запрос = Неопределено
		
		
		//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 4
		Запрос.УстановитьПараметр( "ТекущийДокумент", Ссылка );
		Запрос.УстановитьПараметр( "ТекущийДокументДатаНачала", ПериодНачисленияДатаНачала );
		Запрос.УстановитьПараметр( "ТекущийДокументДатаОкончания", ПериодНачисленияДатаОкончания );
		Запрос.УстановитьПараметр( "парамПодразделение", ПодразделениеОрганизации );
		Запрос.УстановитьПараметр( "ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации) );  //+ СВЭЙ КДЯ 28.02.20 СВФР-005496
		//- СВЭЙ КДЯ 14.02.20 СВФР-005496
		
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
		Запрос.УстановитьПараметр( "ЭтоПерерасчет" , ЭтоПерерасчет ); 
		//- СВЭЙ КДЯ 18.03.20 СВФР-005682
		
		//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
		Запрос.Текст =  Запрос.Текст + "
		|;
		//+ СВЭЙ КДЯ 14.02.20 СВФР-005496 + 4 + Для построителя
		|ВЫБРАТЬ
		|	Сотрудник
		|	ПОМЕСТИТЬ ВтРассчитанныеСотрудники_ДляПостроителя
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
		|ГДЕ
		|	Начисления.Ссылка <> &ТекущийДокумент
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
		|	И НЕ &ЭтоПерерасчет 
		//- СВЭЙ КДЯ 18.03.20 СВФР-005682
		//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
		|	И ( &ВсеПодразделения 
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
		//- СВЭЙ КДЯ 18.03.20 СВФР-005682
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
		//- СВЭЙ КДЯ 28.02.20 СВФР-005496
		|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
		|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
		|	И Начисления.Ссылка.Проведен	
		|ОБЪЕДИНИТЬ ВСЕ
		|ВЫБРАТЬ
		|	Сотрудник
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
		|ГДЕ
		|	Начисления.Ссылка <> &ТекущийДокумент	
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
		|	И НЕ &ЭтоПерерасчет 
		//- СВЭЙ КДЯ 18.03.20 СВФР-005682
		//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
		|	И ( &ВсеПодразделения 
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
		//- СВЭЙ КДЯ 18.03.20 СВФР-005682
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
		//- СВЭЙ КДЯ 28.02.20 СВФР-005496
		|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
		|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
		|	И Начисления.Ссылка.Проведен	
		|ОБЪЕДИНИТЬ ВСЕ
		|ВЫБРАТЬ
		|	Сотрудник
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Начисления
		|ГДЕ
		|	Начисления.Ссылка <> &ТекущийДокумент	
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005682 отключить контроль рассчитанных сотрудников, если это перерасчет
		|	И НЕ &ЭтоПерерасчет 
		//- СВЭЙ КДЯ 18.03.20 СВФР-005682
		//+ СВЭЙ КДЯ 28.02.20 СВФР-005496 *** отбор Подразделение
		|	И ( &ВсеПодразделения 
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка )
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005682
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
		//- СВЭЙ КДЯ 18.03.20 СВФР-005682
		|		ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
		//- СВЭЙ КДЯ 28.02.20 СВФР-005496
		|	И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
		|	И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания	
		|	И Начисления.Ссылка.Проведен	
		|;
		|ВЫБРАТЬ
		|	*
		|	ПОМЕСТИТЬ ВТСписокРаботников_Новый
		|ИЗ
		|	ВТСписокРаботников КАК СписокРаботников
		|ГДЕ
		|	НЕ СписокРаботников.Сотрудник В ( ВЫБРАТЬ Сотрудник ИЗ ВтРассчитанныеСотрудники_ДляПостроителя КАК РассчитанныеСотрудники )
		|;
		|УНИЧТОЖИТЬ ВТСписокРаботников;
		|ВЫБРАТЬ
		|	*
		|	ПОМЕСТИТЬ ВТСписокРаботников
		|ИЗ
		|	ВТСписокРаботников_Новый КАК СписокРаботников
		|;
		//- СВЭЙ КДЯ 14.02.20 СВФР-005496
		|
		|ВЫБРАТЬ
		|	ВТСписокРаботников.Физлицо КАК Физлицо,
		|	КОЛИЧЕСТВО( РАЗЛИЧНЫЕ ВТСписокРаботников.Сотрудник ) КАК КоличествоДублейФизЛиц,
		|	МАКСИМУМ( ВЫБОР КОГДА Сотрудники.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы) ТОГДА Истина ИНАЧЕ Ложь КОНЕЦ ) КАК ЕстьСотрудникОсновноеМестоРаботы,
		|	МИНИМУМ( ВЫБОР 
		|				КОГДА Сотрудники.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы) ТОГДА Сотрудники.Код 
		|				ИНАЧЕ 9999999999
		|			 КОНЕЦ ) КАК МинимальныйТабельныйНомерОсновной,
		|	МИНИМУМ( Сотрудники.Код ) КАК МинимальныйТабельныйНомерОбщий
		|	ПОМЕСТИТЬ ВТКритерииСверткиДублейФизЛиц	
		|ИЗ
		|	ВТСписокРаботников КАК ВТСписокРаботников
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СотрудникиОрганизаций КАК Сотрудники
		|		ПО ВТСписокРаботников.Сотрудник = Сотрудники.Ссылка
		|СГРУППИРОВАТЬ ПО
		|	ВТСписокРаботников.Физлицо
		|ИНДЕКСИРОВАТЬ ПО Физлицо //ИНДЕКСИРОВАТЬ// ПО Физлицо			
		|;
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ВТСписокРаботников.Физлицо КАК Физлицо,
		|	ВТСписокРаботников.Сотрудник КАК Сотрудник
		|	ПОМЕСТИТЬ ВТБезДублейФизЛицСписокРаботников
		|ИЗ
		|	ВТСписокРаботников КАК ВТСписокРаботников
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СотрудникиОрганизаций КАК Сотрудники
		|		ПО ВТСписокРаботников.Сотрудник = Сотрудники.Ссылка
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТКритерииСверткиДублейФизЛиц КАК Критерии
		|		ПО ВТСписокРаботников.Физлицо = Критерии.Физлицо
		|			И ( Критерии.КоличествоДублейФизЛиц = 1
		|				ИЛИ Сотрудники.Код = ВЫБОР КОГДА Критерии.ЕстьСотрудникОсновноеМестоРаботы 
		|										ТОГДА Критерии.МинимальныйТабельныйНомерОсновной 
		|										ИНАЧЕ Критерии.МинимальныйТабельныйНомерОбщий
		|									 КОНЕЦ
		|			   )
		|
		|ИНДЕКСИРОВАТЬ// ПО Сотрудник			
		|
		|";
		//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
		
		// создаем временную таблицу ВТСписокРаботников с сотрудниками, отобранными по критериям пользователя 
		// 
		// Поля:
		//   Сотрудник
		//   Физлицо
		//
		// О.Т.
		если Организация.ИНН = "100765738" Тогда  
			ЗапросДляПродолжения = Запрос.Текст; 
			ЗапросМассивФизЛиц = Запрос.Текст;
			ЗапросМассивФизЛиц = СтрЗаменить(ЗапросМассивФизЛиц,"ПОМЕСТИТЬ ВТБезДублейФизЛицСписокРаботников","");
			ЗапросМассивФизЛиц = СтрЗаменить(ЗапросМассивФизЛиц,"ИНДЕКСИРОВАТЬ// ПО Сотрудник","");
			
			Запрос.Текст = ЗапросМассивФизЛиц;
			РезФизЛица = Запрос.Выполнить().Выбрать();
			СписокФизЛицМассив = Новый СписокЗначений;
			Пока РезФизЛица.Следующий() Цикл 
				если РезФизЛица.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы Тогда 
					СписокФизЛицМассив.Добавить(РезФизЛица.ФизЛицо);
				КонецЕсли;
				
			КонецЦикла;
			
			Запрос.Текст = ЗапросДляПродолжения;
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"ИНДЕКСИРОВАТЬ// ПО Сотрудник","ИНДЕКСИРОВАТЬ ПО Сотрудник");
			
			Запрос.Текст = СтрЗаменить(Запрос.Текст,
			"	И ВЫБОР
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &ДатаАктуальности
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения
			|			ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
			|		КОНЕЦ В ИЕРАРХИИ (&Параметр5)","И ВЫБОР
			|КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
			|ТОГДА ВЫБОР
			|	КОГДА РаботникиОрганизации.ПериодЗавершения <= &ДатаАктуальности
			|			И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|		ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения
			|	ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
			|КОНЕЦ В ИЕРАРХИИ (&Параметр5) 
			|	КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство) тогда 
			|	выбор когда РаботникиОрганизации.Сотрудник.Физлицо В (&СписокФизЛицМассив) ТОГДА истина иначе ложь конец 
			|	
			
			|	иначе ВЫБОР
			|	КОГДА РаботникиОрганизации.ПериодЗавершения <= &ДатаАктуальности
			|			И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|		ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения
			|	ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
			|КОНЕЦ В ИЕРАРХИИ (&Параметр5) конец");
			Запрос.УстановитьПараметр("СписокФизЛицМассив",СписокФизЛицМассив);
		Иначе
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"ИНДЕКСИРОВАТЬ// ПО Сотрудник","ИНДЕКСИРОВАТЬ ПО Сотрудник");
			
		КонецЕсли;
		//О.Т.
		Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		
		Запрос.Выполнить();
		
		//Аверсон-софт, Плиско Ю.А. / 12.11.2014 / {Начало:
		если Организация.ИНН = "100765738" Тогда 
			ЗаполнитьРаботавшимиВПраздники(Запрос,,ТЧРаботавшиеВПраздники);
		КонецЕсли;
		//Аверсон-софт, Плиско Ю.А. / 12.11.2014 / Конец.}
		
		
		ТекстЗапросаПоСпискуРаботников = Запрос.Текст;//Островская Татьяна 03.04.2014 № 17
		// объявим временную таблицу - она должна присутствовать, но использоваться не будет
		
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005696
		//Запрос.Текст = 
		//"ВЫБРАТЬ
		//|	НЕОПРЕДЕЛЕНО КАК Подразделение
		//|ПОМЕСТИТЬ ВТПодразделенияОтбора
		//|";
		//Запрос.УстановитьПараметр("ПоВсемПодразделениям", Истина);
		//- СВЭЙ КДЯ 18.03.20 СВФР-005696
		
		//+ СВЭЙ КДЯ 18.03.20 СВФР-005696
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ISNULL( Ссылка, Неопределено ) КАК Подразделение
		|ПОМЕСТИТЬ ВТПодразделенияОтбора
		|ИЗ
		|	Справочник.ПодразделенияОрганизаций КАК ПодразделенияОрганизаций
		|ГДЕ
		|	ПодразделенияОрганизаций.Ссылка В ИЕРАРХИИ(&парамПодразделение)
		|";
		Запрос.УстановитьПараметр("ПоВсемПодразделениям", НЕ ЗначениеЗаполнено(ПодразделениеОрганизации) );
		//- СВЭЙ КДЯ 18.03.20 СВФР-005696
		
		Запрос.Выполнить();
	КонецЕсли;
	
	//Аверсон-софт, Островская Татьяна 13.03.2012	
	если МассивСотрудники = Неопределено или ТипЗнч(МассивСотрудники) = Тип("Массив") тогда
		// Установим параметры запроса
		Запрос.УстановитьПараметр("парамПериодРегистрации" , ПериодРегистрации);
		Запрос.УстановитьПараметр("парамНачало" , НачалоПериодаЗаполнения);
		Запрос.УстановитьПараметр("парамКонец" , КонецДня(ОкончаниеПериодаЗаполнения));
		Запрос.УстановитьПараметр("парамОрганизация" , Организация);
		Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ГоловнаяОрганизация);
		Запрос.УстановитьПараметр("парамПодразделение" , ПодразделениеОрганизации);
		Запрос.УстановитьПараметр("ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации));  //+ СВЭЙ КДЯ 28.02.20 СВФР-005496
		Запрос.УстановитьПараметр("парамРегистратор" , Ссылка);
		Запрос.УстановитьПараметр("парамНачалоМесяца" , НачалоМесяца(НачалоПериодаЗаполнения));
		Запрос.УстановитьПараметр("парамДатаВалютногоУчета" , НачалоМесяца(НачалоПериодаЗаполнения));
		Запрос.УстановитьПараметр("парамВалютаРегламентУчета" , Константы.ВалютаРегламентированногоУчета.Получить());
		Запрос.УстановитьПараметр("парамМассивСпособовРасчетовБезВалюты" , ПроведениеРасчетов.ПолучитьСписокСпособовРасчетаНеТребующихУказанияВалюты());
		Запрос.УстановитьПараметр("Год",Год(НачалоПериодаЗаполнения));
		Запрос.УстановитьПараметр("ЭтоПерерасчет", ЭтоПерерасчет);
		
		
		СпособыРасчетаОтСтажа = Новый Массив;
		СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам);
		СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням);
		СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке);
		СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке);
		СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
		СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка);
		Запрос.УстановитьПараметр("СпособыРасчетаОтСтажа", СпособыРасчетаОтСтажа);
		
		Если Ссылка.Пустая() Тогда
			СcылкаОбъекта = Документы.НачислениеЗарплатыРаботникамОрганизаций.ПолучитьСсылку();
			УстановитьСсылкуНового(СcылкаОбъекта);
		Иначе
			СcылкаОбъекта = Ссылка;
		КонецЕсли;
		Запрос.УстановитьПараметр("Ссылка", СcылкаОбъекта);
		//О.Т. Аверсон 11.06.2018 № 2060
		СписокДетскихПособийИскл = Новый СписокЗначений;
		для Каждого стр из Справочники.ГруппыРасчетов.ДетскиеПособия.Основные Цикл 
			СписокДетскихПособийИскл.Добавить(стр.ВидРасчета);
		КонецЦикла;         			
		Запрос.УстановитьПараметр("ДетскиеПособияИскл",СписокДетскихПособийИскл);
		//О.Т. Аверсон 11.06.2018 № 2060
		
		//ТаблицаДвиженийРаботниковТекст
		//Описание:
		//	Выбирает список работников, отвечающих условиям отбора, числящихся на начало месяца и их движения за месяц.
		
		//СВЭЙ 12.06.2024 КВВ СВФР-013243 (
		Запрос.Текст = "";
			Если РазбиватьПериодыПоНазначениюБригады Тогда
				
				Запрос.Текст = "
				|ВЫБРАТЬ
				|ИсторияИзмененияУровней.Сотрудник КАК Сотрудник,
				|ИсторияИзмененияУровней.Бригада,
				|ИсторияИзмененияУровней.Период КАК Период
				|ПОМЕСТИТЬ ВТУровни
				|ИЗ РегистрСведений.НазначениеСотрудниковПоБригадам КАК ИсторияИзмененияУровней
				|ГДЕ
				|ИсторияИзмененияУровней.Период <= &парамКонец
				|И ИсторияИзмененияУровней.Сотрудник В (ВЫБРАТЬ ВТСписокРаботников.Сотрудник ИЗ ВТСписокРаботников КАК ВТСписокРаботников)
				|;
				|
				|ВЫБРАТЬ
				|ВТУровни.Сотрудник КАК Сотрудник,
				|МАКСИМУМ(ВТУровни.Период) КАК Период
				|ПОМЕСТИТЬ ВтМаксимальныеПериод
				|ИЗ ВТУровни КАК ВТУровни
				|СГРУППИРОВАТЬ ПО
				|ВТУровни.Сотрудник
				|;
				|
				|ВЫБРАТЬ
				|ВТУровни.Сотрудник КАК Сотрудник,
				|ВТУровни1.Период КАК НачалоПериода,
				|МИНИМУМ(ДОБАВИТЬКДАТЕ(ВТУровни.Период, СЕКУНДА, -1)) КАК КонецПериода
				|ПОМЕСТИТЬ ВТПЕРИОДЫ
				|ИЗ ВТУровни КАК ВТУровни
				|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТУровни КАК ВТУровни1
				|ПО ВТУровни.Сотрудник = ВТУровни1.Сотрудник
				|И ВТУровни.Период > ВТУровни1.Период
				|СГРУППИРОВАТЬ ПО
				|ВТУровни.Сотрудник,
				|ВТУровни1.Период
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|ВтМаксимальныеПериод.Сотрудник,
				|ВтМаксимальныеПериод.Период,
				|ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				|ИЗ ВтМаксимальныеПериод КАК ВтМаксимальныеПериод
				|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТУровни КАК ВТУровни1
				|ПО ВтМаксимальныеПериод.Сотрудник = ВТУровни1.Сотрудник
				|И ВтМаксимальныеПериод.Период = ВТУровни1.Период
				|;
				|
				|ВЫБРАТЬ
				|ВТПЕРИОДЫ.Сотрудник КАК Сотрудник,
				|ВТПЕРИОДЫ.НачалоПериода КАК ДатаИзменения
				|ПОМЕСТИТЬ ВТПериодыНБ2
				|ИЗ ВТПЕРИОДЫ КАК ВТПЕРИОДЫ
				|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТУровни КАК ВТУровни
				|ПО ВТПЕРИОДЫ.Сотрудник = ВТУровни.Сотрудник
				|И ВТПЕРИОДЫ.НачалоПериода = ВТУровни.Период
				|ГДЕ ВТПЕРИОДЫ.НачалоПериода <= &парамКонец
				|И КОНЕЦПЕРИОДА(ВТПЕРИОДЫ.КонецПериода, ДЕНЬ) >= &парамНачало			
				|;				
				|
				|ВЫБРАТЬ
				|ВтТолькоДатыПоСотр.ДатаИзменения КАК ДатаИзменения,
				|ВтТолькоДатыПоСотр.Сотрудник КАК Сотрудник,      
				|МАКСИМУМ(РО.Период) КАК Период
				|ПОМЕСТИТЬ ВТПериодыНБ3
				|ИЗ ВТПериодыНБ2 КАК ВтТолькоДатыПоСотр
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РО
				|ПО ВтТолькоДатыПоСотр.Сотрудник = РО.Сотрудник
				|И ВтТолькоДатыПоСотр.ДатаИзменения >= РО.Период
				|СГРУППИРОВАТЬ ПО
				|ВтТолькоДатыПоСотр.ДатаИзменения,
				|ВтТолькоДатыПоСотр.Сотрудник
				|;";
			КонецЕсли;
		//СВЭЙ 12.06.2024 КВВ СВФР-013243 )
		
		//Островская Татьяна 22.01.2014 № 17057
		если Организация.ИНН = "100765738" Тогда 
			//Запрос.Текст = 
			Запрос.Текст = Запрос.Текст + //СВЭЙ 12.06.2024 КВВ СВФР-013243
			"ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	&парамНачало КАК Период,
			|	РаботникиОрганизации.Сотрудник КАК Сотрудник,
			|	ИСТИНА КАК Подходит,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения
			|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
			|	КОНЕЦ КАК ПодразделениеОрганизации,
			|	РаботникиОрганизации.ауМестоРаботы КАК ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения
			|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы
			|	КОНЕЦ КАК ГрафикРаботы,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ДолжностьЗавершения
			|		ИНАЧЕ РаботникиОрганизации.Должность
			|	КОНЕЦ КАК Должность,
			|	РаботникиОрганизации.Сотрудник.Код КАК ТабНомер
			|ПОМЕСТИТЬ ВТДвиженияРаботников
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
			|			&парамНачало,
			|			Сотрудник В
			|				(ВЫБРАТЬ
			|					ВТСписокРаботников.Сотрудник
			|				ИЗ
			|					ВТСписокРаботников КАК ВТСписокРаботников)) КАК РаботникиОрганизации
			|ГДЕ
			|	( ВЫБОР
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ПричинаИзмененияСостоянияЗавершения
			|			ИНАЧЕ РаботникиОрганизации.ПричинаИзмененияСостояния
			|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			//+ СВЭЙ КДЯ 02.03.20 СВФР-005593
			|		ИЛИ &ВключатьУволенных И РаботникиОрганизации.Период >= &ДатаУволенных
			//- СВЭЙ КДЯ 02.03.20 СВФР-005593
			|	) И ВЫБОР
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ОбособленноеПодразделениеЗавершения
			|			ИНАЧЕ РаботникиОрганизации.ОбособленноеПодразделение
			|		КОНЕЦ = &парамОрганизация
			|	И ВЫБОР
			|			КОГДА РаботникиОрганизации.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
			|				ТОГДА ВЫБОР
			|						КОГДА &ПоВсемПодразделениям
			|							ТОГДА ИСТИНА
			|						КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|								И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|							ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
			|									(ВЫБРАТЬ
			|										Подразделения.Подразделение
			|									ИЗ
			|										ВТПодразделенияОтбора КАК Подразделения)
			|						ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
			|								(ВЫБРАТЬ
			|									Подразделения.Подразделение
			|								ИЗ
			|									ВТПодразделенияОтбора КАК Подразделения)
			|					КОНЕЦ
			|			ИНАЧЕ ИСТИНА
			|		КОНЕЦ
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	РаботникиОрганизации.Период,
			|	РаботникиОрганизации.Сотрудник,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|				И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
			|				И (&ПоВсемПодразделениям
			|					ИЛИ РаботникиОрганизации.ПодразделениеОрганизации В
			|						(ВЫБРАТЬ
			|							Подразделения.Подразделение
			|						ИЗ
			|							ВТПодразделенияОтбора КАК Подразделения))
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ,
			|	РаботникиОрганизации.ПодразделениеОрганизации,
			|	РаботникиОрганизации.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	РаботникиОрганизации.ГрафикРаботы,
			|	РаботникиОрганизации.Должность,
			|	РаботникиОрганизации.Сотрудник.Код
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
			|		ПО СписокРаботников.Сотрудник = РаботникиОрганизации.Сотрудник
			|ГДЕ
			|	РаботникиОрганизации.Период > &парамНачало
			|	И РаботникиОрганизации.Период <= &парамКонец
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	Работники.ПериодЗавершения,
			|	Работники.Сотрудник,
			|	ВЫБОР
			|		КОГДА Работники.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|				И Работники.ОбособленноеПодразделениеЗавершения = &парамОрганизация
			|				И (&ПоВсемПодразделениям
			|					ИЛИ Работники.ПодразделениеОрганизацииЗавершения В
			|						(ВЫБРАТЬ
			|							Подразделения.Подразделение
			|						ИЗ
			|							ВТПодразделенияОтбора КАК Подразделения))
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ,
			|	Работники.ПодразделениеОрганизацииЗавершения,
			|	Работники.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	Работники.ГрафикРаботыЗавершения,
			|	Работники.ДолжностьЗавершения,
			|	Работники.Сотрудник.Код
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работники
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
			|			ПО (ПериодыПерекрытия.Период <= Работники.ПериодЗавершения)
			|				И (ПериодыПерекрытия.Период > Работники.Период)
			|				И (ПериодыПерекрытия.Сотрудник = Работники.Сотрудник)
			|		ПО СписокРаботников.Сотрудник = Работники.Сотрудник
			|ГДЕ
			|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|	И Работники.ПериодЗавершения > &парамНачало
			|	И Работники.ПериодЗавершения <= &парамКонец
			|	И ПериодыПерекрытия.Период ЕСТЬ NULL ";
			
			//СВЭЙ 12.06.2024 КВВ СВФР-013243 (
			Если РазбиватьПериодыПоНазначениюБригады Тогда
				Запрос.Текст = Запрос.Текст + "
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|ВТПериодыНБ3.ДатаИзменения, //КАК Период
				|ВТПериодыНБ3.Сотрудник,
				
				|ВЫБОР КОГДА
				|РО.ПодразделениеОрганизацииЗавершения.Ссылка ЕСТЬ NULL
				|ТОГДА
				|ВЫБОР
				|КОГДА РО.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|И РО.ОбособленноеПодразделение = &парамОрганизация
				|И (&ПоВсемПодразделениям
				|ИЛИ РО.ПодразделениеОрганизации В
				|(ВЫБРАТЬ
				|Подразделения.Подразделение
				|ИЗ
				|ВТПодразделенияОтбора КАК Подразделения))
				|ТОГДА ИСТИНА
				|ИНАЧЕ ЛОЖЬ
				|КОНЕЦ
				|ИНАЧЕ
				|ВЫБОР
				|КОГДА РО.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|И РО.ОбособленноеПодразделениеЗавершения = &парамОрганизация
				|И (&ПоВсемПодразделениям
				|ИЛИ РО.ПодразделениеОрганизацииЗавершения В
				|(ВЫБРАТЬ
				|Подразделения.Подразделение
				|ИЗ
				|ВТПодразделенияОтбора КАК Подразделения))
				|ТОГДА ИСТИНА
				|ИНАЧЕ ЛОЖЬ
				|КОНЕЦ
				|КОНЕЦ, //КАК Подходит				
				|РО.ПодразделениеОрганизации,
				|РО.ауМестоРаботы, //Аверсон 10.01.2023 КВВ СВФР-010142
				|РО.ГрафикРаботы,
				|РО.Должность,
				|ВТПериодыНБ3.Сотрудник.Код
				|ИЗ ВТПериодыНБ3 КАК ВТПериодыНБ3
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РО
				|ПО ВТПериодыНБ3.Сотрудник = РО.Сотрудник
				|И РО.Период = ВТПериодыНБ3.Период
				|";
			КонецЕсли;
			Запрос.Текст = Запрос.Текст + "
			//СВЭЙ 12.06.2024 КВВ СВФР-013243 )
			
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
			
		Иначе 
			
			//Запрос.Текст = 
			Запрос.Текст = Запрос.Текст + //СВЭЙ 12.06.2024 КВВ СВФР-013243
			"ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	&парамНачало КАК Период,
			|	РаботникиОрганизации.Сотрудник КАК Сотрудник,
			|	ИСТИНА КАК Подходит,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения
			|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
			|	КОНЕЦ КАК ПодразделениеОрганизации,
			|	РаботникиОрганизации.ауМестоРаботы КАК ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения
			|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы
			|	КОНЕЦ КАК ГрафикРаботы,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ДолжностьЗавершения
			|		ИНАЧЕ РаботникиОрганизации.Должность
			|	КОНЕЦ КАК Должность,
			|	РаботникиОрганизации.Сотрудник.Код КАК ТабНомер
			|ПОМЕСТИТЬ ВТДвиженияРаботников
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
			|			&парамНачало,
			|			Сотрудник В
			|				(ВЫБРАТЬ
			|					ВТСписокРаботников.Сотрудник
			|				ИЗ
			|					ВТСписокРаботников КАК ВТСписокРаботников)) КАК РаботникиОрганизации
			|ГДЕ
			|	( ВЫБОР
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ПричинаИзмененияСостоянияЗавершения
			|			ИНАЧЕ РаботникиОрганизации.ПричинаИзмененияСостояния
			|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			//+ СВЭЙ КДЯ 02.03.20 СВФР-005593
			|		ИЛИ &ВключатьУволенных И РаботникиОрганизации.Период >= &ДатаУволенных 
			//- СВЭЙ КДЯ 02.03.20 СВФР-005593
			|	) И  ВЫБОР
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ОбособленноеПодразделениеЗавершения
			|			ИНАЧЕ РаботникиОрганизации.ОбособленноеПодразделение
			|		КОНЕЦ = &парамОрганизация
			|	И   ВЫБОР
			|			КОГДА &ПоВсемПодразделениям
			|				ТОГДА ИСТИНА
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
			|						(ВЫБРАТЬ
			|							Подразделения.Подразделение
			|						ИЗ
			|							ВТПодразделенияОтбора КАК Подразделения)
			|			ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
			|					(ВЫБРАТЬ
			|						Подразделения.Подразделение
			|					ИЗ
			|						ВТПодразделенияОтбора КАК Подразделения) //ИЛИ Истина
			|		КОНЕЦ
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	РаботникиОрганизации.Период,
			|	РаботникиОрганизации.Сотрудник,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|				И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
			|				И (&ПоВсемПодразделениям
			|					ИЛИ РаботникиОрганизации.ПодразделениеОрганизации В
			|						(ВЫБРАТЬ
			|							Подразделения.Подразделение
			|						ИЗ
			|							ВТПодразделенияОтбора КАК Подразделения))
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ,
			|	РаботникиОрганизации.ПодразделениеОрганизации,
			|	РаботникиОрганизации.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	РаботникиОрганизации.ГрафикРаботы,
			|	РаботникиОрганизации.Должность,
			|	РаботникиОрганизации.Сотрудник.Код
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
			|		ПО СписокРаботников.Сотрудник = РаботникиОрганизации.Сотрудник
			|ГДЕ
			|	РаботникиОрганизации.Период > &парамНачало
			|	И РаботникиОрганизации.Период <= &парамКонец
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	Работники.ПериодЗавершения,
			|	Работники.Сотрудник,
			|	ВЫБОР
			|		КОГДА Работники.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|				И Работники.ОбособленноеПодразделениеЗавершения = &парамОрганизация
			|				И (&ПоВсемПодразделениям
			|					ИЛИ Работники.ПодразделениеОрганизацииЗавершения В
			|						(ВЫБРАТЬ
			|							Подразделения.Подразделение
			|						ИЗ
			|							ВТПодразделенияОтбора КАК Подразделения))
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ,
			|	Работники.ПодразделениеОрганизацииЗавершения,
			|	Работники.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	Работники.ГрафикРаботыЗавершения,
			|	Работники.ДолжностьЗавершения,
			|	Работники.Сотрудник.Код
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работники
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
			|			ПО (ПериодыПерекрытия.Период <= Работники.ПериодЗавершения)
			|				И (ПериодыПерекрытия.Период > Работники.Период)
			|				И (ПериодыПерекрытия.Сотрудник = Работники.Сотрудник)
			|		ПО СписокРаботников.Сотрудник = Работники.Сотрудник
			|ГДЕ
			|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|	И Работники.ПериодЗавершения > &парамНачало
			|	И Работники.ПериодЗавершения <= &парамКонец
			|	И ПериодыПерекрытия.Период ЕСТЬ NULL ";
			
			//СВЭЙ 12.06.2024 КВВ СВФР-013243 (
			Если РазбиватьПериодыПоНазначениюБригады Тогда
				Запрос.Текст = Запрос.Текст + "
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|ВТПериодыНБ3.ДатаИзменения, //КАК Период
				|ВТПериодыНБ3.Сотрудник,
				
				|ВЫБОР КОГДА
				|РО.ПодразделениеОрганизацииЗавершения.Ссылка ЕСТЬ NULL
				|ТОГДА
				|ВЫБОР
				|КОГДА РО.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|И РО.ОбособленноеПодразделение = &парамОрганизация
				|И (&ПоВсемПодразделениям
				|ИЛИ РО.ПодразделениеОрганизации В
				|(ВЫБРАТЬ
				|Подразделения.Подразделение
				|ИЗ
				|ВТПодразделенияОтбора КАК Подразделения))
				|ТОГДА ИСТИНА
				|ИНАЧЕ ЛОЖЬ
				|КОНЕЦ
				|ИНАЧЕ
				|ВЫБОР
				|КОГДА РО.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|И РО.ОбособленноеПодразделениеЗавершения = &парамОрганизация
				|И (&ПоВсемПодразделениям
				|ИЛИ РО.ПодразделениеОрганизацииЗавершения В
				|(ВЫБРАТЬ
				|Подразделения.Подразделение
				|ИЗ
				|ВТПодразделенияОтбора КАК Подразделения))
				|ТОГДА ИСТИНА
				|ИНАЧЕ ЛОЖЬ
				|КОНЕЦ
				|КОНЕЦ, //КАК Подходит				
				|РО.ПодразделениеОрганизации,
				|РО.ауМестоРаботы, //Аверсон 10.01.2023 КВВ СВФР-010142
				|РО.ГрафикРаботы,
				|РО.Должность,
				|ВТПериодыНБ3.Сотрудник.Код
				|ИЗ ВТПериодыНБ3 КАК ВТПериодыНБ3
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РО
				|ПО ВТПериодыНБ3.Сотрудник = РО.Сотрудник
				|И РО.Период = ВТПериодыНБ3.Период
				|";
			КонецЕсли;
			Запрос.Текст = Запрос.Текст + "
			//СВЭЙ 12.06.2024 КВВ СВФР-013243 )
			
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
		КонецЕсли;
		
		//+ СВЭЙ КДЯ 04.03.20 СВФР-005593
		Если НЕ Запрос.Параметры.Свойство( "ВключатьУволенных" ) Тогда
			Запрос.УстановитьПараметр( "ВключатьУволенных", Ложь );		
		КонецЕсли; 
		Если НЕ Запрос.Параметры.Свойство( "ДатаУволенных" ) Тогда
			Запрос.УстановитьПараметр( "ДатаУволенных", Дата(1,1,1) );		
		КонецЕсли; 
		//- СВЭЙ КДЯ 04.03.20 СВФР-005593
		Запрос.Выполнить();
		//Островская Татьяна 22.01.2014 № 17057
		// таблица ВТЗначенияПоказателей
		// 
		// Поля:
		//   Сотрудник
		//   Показатель - введенный пользователем показатель
		//   Значение - значение показателя
		//   Валюта
		//
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	Работники.Сотрудник КАК Сотрудник,
		|	Работники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|	Работники.ауМестоРаботы КАК ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
		|	ЗначенияПоказателейСхемМотивации.Показатель КАК Показатель,
		|	ЗначенияПоказателейСхемМотивации.Валюта,
		|	ВЫБОР
		|		КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
		|				И (НЕ ЗначенияПоказателейСхемМотивации.Валюта В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)))
		|			ТОГДА ЗначенияПоказателейСхемМотивации.Значение * ЕСТЬNULL(Валюты.Курс / Валюты.Кратность, 0)
		|		ИНАЧЕ ЗначенияПоказателейСхемМотивации.Значение
		|	КОНЕЦ КАК Значение
		|ПОМЕСТИТЬ ВТЗначенияПоказателей
		|ИЗ
		|	ВТДвиженияРаботников КАК Работники
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			Ежемесячно.Подразделение КАК Подразделение,
		|			Ежемесячно.Показатель КАК Показатель,
		|			Ежемесячно.Валюта КАК Валюта,
		|			Ежемесячно.Значение КАК Значение,
		|			Ежемесячно.Сотрудник КАК Сотрудник
		|		ИЗ
		|			РегистрСведений.ЗначенияПоказателейСхемМотивации КАК Ежемесячно
		|		ГДЕ
		|			Ежемесячно.Значение ЕСТЬ НЕ NULL 
		|			И Ежемесячно.Организация = &парамОрганизация
		|			И Ежемесячно.ПериодДействия >= &парамНачало
		|			И Ежемесячно.ПериодДействия <= &парамКонец
		|		
		|		ОБЪЕДИНИТЬ
		|		
		|		ВЫБРАТЬ
		|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Подразделение,
		|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Показатель,
		|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Валюта,
		|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Значение,
		|			NULL
		|		ИЗ
		|			РегистрСведений.ПериодическиеЗначенияПоказателейСхемМотивации.СрезПоследних(&парамКонец, Организация = &парамОрганизация) КАК ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних) КАК ЗначенияПоказателейСхемМотивации
		|		ПО (ВЫБОР
		|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
		|						ИЛИ ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя ЕСТЬ NULL 
		|					ТОГДА Работники.Сотрудник = ЗначенияПоказателейСхемМотивации.Сотрудник
		|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
		|					ТОГДА Работники.ПодразделениеОрганизации = ЗначенияПоказателейСхемМотивации.Подразделение
		|				ИНАЧЕ ИСТИНА
		|			КОНЕЦ)
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты
		|		ПО (Валюты.Период = &парамДатаВалютногоУчета)
		|			И (ЗначенияПоказателейСхемМотивации.Валюта = Валюты.Валюта)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Показатель
		|";
		
		Запрос.Выполнить();
		
		
		// создание временных таблиц для последующего использования:
		//	ЗначенияПоказателей
		//	НеЗапрашиваемыеПриКадровыхПеремещениях
		//	ВводимыеВПлановыхНачисленияхПоказатели
		//	РаботникиИНачисления
		
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНачислений 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетУдержаний 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
			
			// таблица НеЗапрашиваемыеПриКадровыхПеремещениях
			// 	выбираем показатели, которые не спрашиваем у пользователя в кадровых документах, а также все "тарифные ставки" и их в.р.;
			//  значения этих показателей будем искать в данных о плановых начислениях, но, возможно, при других видах расчета
			// 
			//	Поля:
			//		Ссылка - вид расчета
			//		Показатель
			//		НомерСтроки - номер строки показателя
			//		ЭтоТарифнаяСтавка - признак того. что Показатель является тарифной ставкой
			// 
			
			Запрос.Текст =
			"ВЫБРАТЬ
			|	ОсновныеНачисленияОрганизацийПоказатели.Показатель КАК Показатель,
			|	ОсновныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
			|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки КАК НомерСтроки,
			|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка КАК Ссылка,
			|	ВЫБОР
			|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
			|			ТОГДА ИСТИНА
			|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
			|			ТОГДА ИСТИНА
			|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
			|			ТОГДА ИСТИНА
			|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ КАК ЭтоТарифнаяСтавка
			|ПОМЕСТИТЬ ВТНеЗапрашиваемыеПриКадровыхПеремещениях
			|ИЗ
			|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
			|ГДЕ
			|	((НЕ ОсновныеНачисленияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
			|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
			|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
			|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
			|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
			|	И ОсновныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ
			|	ДополнительныеНачисленияОрганизацийПоказатели.Показатель,
			|	ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
			|	ДополнительныеНачисленияОрганизацийПоказатели.НомерСтроки,
			|	ДополнительныеНачисленияОрганизацийПоказатели.Ссылка,
			|	ВЫБОР
			|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
			|			ТОГДА ИСТИНА
			|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
			|			ТОГДА ИСТИНА
			|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
			|			ТОГДА ИСТИНА
			|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ
			|ИЗ
			|	ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК ДополнительныеНачисленияОрганизацийПоказатели
			|ГДЕ
			|	((НЕ ДополнительныеНачисленияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
			|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
			|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
			|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
			|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
			|	И ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ
			|	УдержанияОрганизацийПоказатели.Показатель,
			|	УдержанияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
			|	УдержанияОрганизацийПоказатели.НомерСтроки,
			|	УдержанияОрганизацийПоказатели.Ссылка,
			|	ВЫБОР
			|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
			|			ТОГДА ИСТИНА
			|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
			|			ТОГДА ИСТИНА
			|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
			|			ТОГДА ИСТИНА
			|		КОГДА УдержанияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ
			|ИЗ
			|	ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК УдержанияОрганизацийПоказатели
			|ГДЕ
			|	((НЕ УдержанияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
			|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
			|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
			|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
			|			ИЛИ УдержанияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
			|	И УдержанияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Показатель";
			Запрос.Выполнить();
			
			// таблица ВводимыеВПлановыхНачисленияхПоказатели
			//  виды расчета и показатели, значения которых находятся при этих в.р. в данных о плановых начислениях
			// 
			//	Поля:
			//		Ссылка - вид расчета
			//		Показатель
			//		НомерСтроки - номер строки показателя
			// 
			Запрос.Текст =
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ОсновныеНачисленияОрганизаций.Ссылка КАК Ссылка,
			|	ВЫБОР
			|		КОГДА ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам))
			|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
			|		КОГДА ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок))
			|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
			|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
			|	КОНЕЦ КАК Показатель,
			|	1 КАК НомерСтроки,
			|	ИСТИНА КАК ЭтоТарифнаяСтавка
			|ПОМЕСТИТЬ ВТВводимыеВПлановыхНачисленияхПоказатели
			|ИЗ
			|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
			|ГДЕ
			|	(ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке))
			|	 ИЛИ ОсновныеНачисленияОрганизаций.Ссылка = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)) //О.Т. Аверсон 11.04.2017 № 513
			|	И выбор когда ОсновныеНачисленияОрганизаций.Ссылка = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты) тогда истина иначе ОсновныеНачисленияОрганизаций.ЗачетОтработанногоВремени конец //О.Т. Аверсон 11.03.2019 № 4039 условие на вид расчета
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка,
			|	ОсновныеНачисленияОрганизацийПоказатели.Показатель,
			|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки,
			|	ИСТИНА
			|ИЗ
			|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
			|ГДЕ
			|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка.ЗачетОтработанногоВремени
			|	И ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
			|	И (НЕ ОсновныеНачисленияОрганизацийПоказатели.Показатель.Предопределенный)
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка,
			|	ОсновныеНачисленияОрганизацийПоказатели.Показатель,
			|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки,
			|	ЛОЖЬ
			|ИЗ
			|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
			|ГДЕ
			|	ОсновныеНачисленияОрганизацийПоказатели.Показатель В
			|			(ВЫБРАТЬ
			|				ВТНеЗапрашиваемыеПриКадровыхПеремещениях.Показатель
			|			ИЗ
			|				ВТНеЗапрашиваемыеПриКадровыхПеремещениях)
			|	И (НЕ ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Ссылка";
			
			Запрос.Выполнить();
			
			// РаботникиИНачисления
			//		Таблица движений работников с добавленными сведениями об их плановых начислениях
			// 
			//	Поля:
			//		Сотрудник 
			//		ВидРасчета - плановое начисление 
			//		Показатель1,...,6 - размеры показателей 
			//		СпособРасчета - способ расчета начисления 
			//		ГрафикРаботы - график сотрудника  
			//		ВидГрафика, СуммированныйУчетРабочегоВремени, ДлительностьРабочейНедели - реквизиты графика сотрудника 
			// 
			// Описание:
			//
			//	1. 
			//  2. 
			//
			//Островская Татьяна 22.01.2014 № 17057
			ПособиеСписок = Новый СписокЗначений; //О.Т. Аверсон 23.06.2016 № 1267
			ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаВторогоИПоследующихДо3Лет);
			ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаСтарше3Лет);
			ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаДетейОт3До18); //О.Т. Аверсон 27.03.2018 № 1771
			//О.Т. Аверсон 14.06.2018 № 
			СпособыРасчетаСписок = Новый СписокЗначений;			
			СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей);
			СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид);
			СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида);
			//О.Т. Аверсон 14.06.2018 № 
			
			Запрос.УстановитьПараметр("ВидРасчетаПособие", ПособиеСписок);
			Запрос.УстановитьПараметр("СпособыРасчетаПособие", СпособыРасчетаСписок);
			Запрос.Текст =
			"ВЫБРАТЬ
			|	Работники.Сотрудник КАК Сотрудник,
			|	Работники.Сотрудник.Наименование КАК СотрудникНаименование,
			|	Работники.Сотрудник.Физлицо КАК Физлицо,
			|	ВЫБОР
			|		КОГДА Работники.Период >= НачисленияРаботниковОрганизации.Период
			|				ИЛИ НачисленияРаботниковОрганизации.Период ЕСТЬ NULL 
			|			ТОГДА Работники.Период
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Период
			|	КОНЕЦ КАК Период,
			|	Работники.Подходит,
			|	Работники.Период КАК ПериодРаботники,
			|	НачисленияРаботниковОрганизации.Период КАК ПериодНачисления,
			|	НачисленияРаботниковОрганизации.ОсновноеНачисление,
			|	НачисленияРаботниковОрганизации.ВидРасчета,
			|	НачисленияРаботниковОрганизации.ВидРасчета.Наименование,
			|	НачисленияРаботниковОрганизации.ВидРасчета.ВидСтажа,
			|	НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда,
			|	НачисленияРаботниковОрганизации.ВидРасчета.КоэффициентСтажа,
			|	НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета КАК СпособРасчета,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
			|			ТОГДА НачисленияРаботниковОрганизации.ВидРасчета.ВидВремени
			|		ИНАЧЕ NULL
			|	КОНЕЦ КАК ВидВремени,
			|	НачисленияРаботниковОрганизации.Действие КАК Действие,
			|	ЕСТЬNULL(НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ.КодВычета, ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)) КАК КодВычета,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
			|				ИЛИ НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
			|					И (НачисленияРаботниковОрганизации.ТарифныйРазряд1 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
			|						И НачисленияРаботниковОрганизации.ТарифныйРазряд1 ЕСТЬ НЕ NULL )
			|			ТОГДА ТарифныеСтавки1.Размер
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
			|	КОНЕЦ КАК Показатель1,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд2 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд2 ЕСТЬ НЕ NULL 
			|			ТОГДА ТарифныеСтавки2.Размер
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель2
			|	КОНЕЦ КАК Показатель2,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд3 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд3 ЕСТЬ НЕ NULL 
			|			ТОГДА ТарифныеСтавки3.Размер
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель3
			|	КОНЕЦ КАК Показатель3,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд4 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд4 ЕСТЬ НЕ NULL 
			|			ТОГДА ТарифныеСтавки4.Размер
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель4
			|	КОНЕЦ КАК Показатель4,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд5 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд5 ЕСТЬ НЕ NULL 
			|			ТОГДА ТарифныеСтавки5.Размер
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель5
			|	КОНЕЦ КАК Показатель5,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд6 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
			|				И НачисленияРаботниковОрганизации.ТарифныйРазряд6 ЕСТЬ НЕ NULL 
			|			ТОГДА ТарифныеСтавки6.Размер
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель6
			|	КОНЕЦ КАК Показатель6,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
			|			ТОГДА ТарифныеСтавки1.Валюта
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
			|	КОНЕЦ КАК Валюта1,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
			|			ТОГДА ТарифныеСтавки2.Валюта
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта2
			|	КОНЕЦ КАК Валюта2,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
			|			ТОГДА ТарифныеСтавки3.Валюта
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта3
			|	КОНЕЦ КАК Валюта3,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
			|			ТОГДА ТарифныеСтавки4.Валюта
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта4
			|	КОНЕЦ КАК Валюта4,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
			|			ТОГДА ТарифныеСтавки5.Валюта
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта5
			|	КОНЕЦ КАК Валюта5,
			|	ВЫБОР
			|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
			|			ТОГДА ТарифныеСтавки6.Валюта
			|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта6
			|	КОНЕЦ КАК Валюта6,
			|	НачисленияРаботниковОрганизации.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
			|	Работники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			|	Работники.ауМестоРаботы КАК ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	Работники.ГрафикРаботы КАК ГрафикРаботы,
			|	ЕСТЬNULL(Работники.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени,
			|	ЕСТЬNULL(ВЫБОР
			|			КОГДА Работники.ГрафикРаботы.СокращенноеРабочееВремя
			|					И Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
			|				ТОГДА Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели
			|			ИНАЧЕ Работники.ГрафикРаботы.ДлительностьРабочейНедели
			|		КОНЕЦ, 0) КАК ДлительностьРабочейНедели,
			|	Работники.ГрафикРаботы.ВидГрафика КАК ВидГрафика,
			|	Работники.Должность КАК Должность,
			|	НачисленияРаботниковОрганизации.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
			|	Работники.ТабНомер,
			|	НачисленияРаботниковОрганизации.ПериодЗавершения,
			|	НачисленияРаботниковОрганизации.Показатель1ВВалюте"
			
			//Аверсон ЕАЕ 07.03.2022 СВФР-008825
			+ ?(Организация.ИНН = "100071565", ",
			|   НачисленияРаботниковОрганизации.СовмещаемаяПрофессия", "") + "
			//Аверсон СВФР-008825
			
			|ПОМЕСТИТЬ ВТРаботникиИНачисления
			|ИЗ
			|	ВТДвиженияРаботников КАК Работники
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			&парамНачало КАК Период,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
			|					ТОГДА ИСТИНА
			|				ИНАЧЕ ЛОЖЬ
			|			КОНЕЦ КАК ОсновноеНачисление,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ВЫБОР
			|							КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|								ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
			|							ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
			|						КОНЕЦ
			|				ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
			|			КОНЕЦ КАК ВидРасчета,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Действие
			|			КОНЕЦ КАК Действие,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Показатель1Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
			|			КОНЕЦ КАК Показатель1,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Показатель2Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель2
			|			КОНЕЦ КАК Показатель2,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Показатель3Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель3
			|			КОНЕЦ КАК Показатель3,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Показатель4Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель4
			|			КОНЕЦ КАК Показатель4,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Показатель5Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель5
			|			КОНЕЦ КАК Показатель5,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Показатель6Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель6
			|			КОНЕЦ КАК Показатель6,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Валюта1Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
			|			КОНЕЦ КАК Валюта1,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Валюта2Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта2
			|			КОНЕЦ КАК Валюта2,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Валюта3Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта3
			|			КОНЕЦ КАК Валюта3,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Валюта4Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта4
			|			КОНЕЦ КАК Валюта4,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Валюта5Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта5
			|			КОНЕЦ КАК Валюта5,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Валюта6Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта6
			|			КОНЕЦ КАК Валюта6,
			|			НачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник,
			|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд1Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд1
			|			КОНЕЦ КАК ТарифныйРазряд1,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд2Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд2
			|			КОНЕЦ КАК ТарифныйРазряд2,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд3Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд3
			|			КОНЕЦ КАК ТарифныйРазряд3,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд4Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд4
			|			КОНЕЦ КАК ТарифныйРазряд4,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд5Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд5
			|			КОНЕЦ КАК ТарифныйРазряд5,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд6Завершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд6
			|			КОНЕЦ КАК ТарифныйРазряд6,
			|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
			|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ПериодЗавершения,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА НачисленияРаботниковОрганизации.Показатель1ВВалютеЗавершения
			|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1ВВалюте
			|			КОНЕЦ КАК Показатель1ВВалюте"
			
			//Аверсон ЕАЕ 07.03.2022 СВФР-008825
			+ ?(Организация.ИНН = "100071565", ",
			|			НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
			//Аверсон СВФР-008825
			
			|		ИЗ
			|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
			|					&парамНачало,
			|					ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|						И Сотрудник В
			|							(ВЫБРАТЬ
			|								Работники.Сотрудник
			|							ИЗ
			|								ВТСписокРаботников КАК Работники)) КАК НачисленияРаботниковОрганизации
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|						ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
			|					ИНАЧЕ НачисленияРаботниковОрганизации.Действие
			|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|			И НЕ ВЫБОР
			|						КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|								И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|							ТОГДА ВЫБОР
			|									КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|										ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
			|									ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
			|								КОНЕЦ
			|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
			|					КОНЕЦ В (&ВидРасчетаПособие)
			//О.Т. Аверсон 14.06.2018 № 
			|			И НЕ ВЫБОР
			|						КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|								И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|							ТОГДА ВЫБОР
			|									КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|										ТОГДА НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета
			|									ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения.СпособРасчета
			|								КОНЕЦ
			|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета
			|					КОНЕЦ В (&СпособыРасчетаПособие)
			//О.Т. Аверсон 14.06.2018 № 
			
			|		
			|		ОБЪЕДИНИТЬ ВСЕ
			|		
			|		ВЫБРАТЬ
			|			НачисленияРаботниковОрганизации.Период,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
			|					ТОГДА ИСТИНА
			|				ИНАЧЕ ЛОЖЬ
			|			КОНЕЦ,
			|			НачисленияРаботниковОрганизации.ВидРасчета,
			|			НачисленияРаботниковОрганизации.Действие,
			|			НачисленияРаботниковОрганизации.Показатель1,
			|			НачисленияРаботниковОрганизации.Показатель2,
			|			НачисленияРаботниковОрганизации.Показатель3,
			|			НачисленияРаботниковОрганизации.Показатель4,
			|			НачисленияРаботниковОрганизации.Показатель5,
			|			НачисленияРаботниковОрганизации.Показатель6,
			|			НачисленияРаботниковОрганизации.Валюта1,
			|			НачисленияРаботниковОрганизации.Валюта2,
			|			НачисленияРаботниковОрганизации.Валюта3,
			|			НачисленияРаботниковОрганизации.Валюта4,
			|			НачисленияРаботниковОрганизации.Валюта5,
			|			НачисленияРаботниковОрганизации.Валюта6,
			|			НачисленияРаботниковОрганизации.Сотрудник,
			|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд1,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд2,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд3,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд4,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд5,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд6,
			|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде,
			|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
			|			НачисленияРаботниковОрганизации.Показатель1ВВалюте"
			
			//Аверсон ЕАЕ 07.03.2022 СВФР-008825
			+ ?(Организация.ИНН = "100071565", ",
			|			НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
			//Аверсон СВФР-008825
			
			|		ИЗ
			|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
			|				ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
			|		ГДЕ
			|			НачисленияРаботниковОрганизации.Период > &парамНачало
			|			И НачисленияРаботниковОрганизации.Период <= &парамКонец
			|			И НачисленияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
			|			И НачисленияРаботниковОрганизации.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|			И НачисленияРаботниковОрганизации.ИспользуетсяВНаряде = ЛОЖЬ
			|		
			|		ОБЪЕДИНИТЬ ВСЕ
			|		
			|		ВЫБРАТЬ
			|			НачисленияРаботниковОрганизации.ПериодЗавершения,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
			|					ТОГДА ИСТИНА
			|				ИНАЧЕ ЛОЖЬ
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|					ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
			|				ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
			|			КОНЕЦ,
			|			НачисленияРаботниковОрганизации.ДействиеЗавершения,
			|			НачисленияРаботниковОрганизации.Показатель1Завершения,
			|			НачисленияРаботниковОрганизации.Показатель2Завершения,
			|			НачисленияРаботниковОрганизации.Показатель3Завершения,
			|			НачисленияРаботниковОрганизации.Показатель4Завершения,
			|			НачисленияРаботниковОрганизации.Показатель5Завершения,
			|			НачисленияРаботниковОрганизации.Показатель6Завершения,
			|			НачисленияРаботниковОрганизации.Валюта1Завершения,
			|			НачисленияРаботниковОрганизации.Валюта2Завершения,
			|			НачисленияРаботниковОрганизации.Валюта3Завершения,
			|			НачисленияРаботниковОрганизации.Валюта4Завершения,
			|			НачисленияРаботниковОрганизации.Валюта5Завершения,
			|			НачисленияРаботниковОрганизации.Валюта6Завершения,
			|			НачисленияРаботниковОрганизации.Сотрудник,
			|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд1Завершения,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд2Завершения,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд3Завершения,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд4Завершения,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд5Завершения,
			|			НачисленияРаботниковОрганизации.ТарифныйРазряд6Завершения,
			|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде,
			|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
			|			НачисленияРаботниковОрганизации.Показатель1ВВалютеЗавершения"
			
			//Аверсон ЕАЕ 07.03.2022 СВФР-008825
			+ ?(Организация.ИНН = "100071565", ",
			|			НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
			//Аверсон СВФР-008825
			
			|		ИЗ
			|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
			|				ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковПроверка
			|				ПО НачисленияРаботниковОрганизации.Сотрудник = НачисленияРаботниковПроверка.Сотрудник
			|					И НачисленияРаботниковОрганизации.ВидРасчетаИзмерение = НачисленияРаботниковПроверка.ВидРасчетаИзмерение
			|					И НачисленияРаботниковОрганизации.ДокументОснование = НачисленияРаботниковПроверка.ДокументОснование
			|					И (НачисленияРаботниковПроверка.Период > НачисленияРаботниковОрганизации.Период)
			|					И (НачисленияРаботниковПроверка.Период <= НачисленияРаботниковОрганизации.ПериодЗавершения)
			|		ГДЕ
			|			НачисленияРаботниковОрганизации.ПериодЗавершения >= &парамНачало
			|			И НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамКонец
			|			И НачисленияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
			|			И НачисленияРаботниковОрганизации.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|			И НачисленияРаботниковОрганизации.ИспользуетсяВНаряде = ЛОЖЬ
			|			И НачисленияРаботниковПроверка.Сотрудник ЕСТЬ NULL 
			|		
			|		ОБЪЕДИНИТЬ ВСЕ
			|		
			|		ВЫБРАТЬ
			|			&парамНачало,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
			|					ТОГДА ИСТИНА
			|				ИНАЧЕ ЛОЖЬ
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ВЫБОР
			|							КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|								ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
			|							ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения
			|						КОНЕЦ
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Действие
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель1Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель1
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель2Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель2
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель3Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель3
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель4Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель4
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель5Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель5
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель6Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель6
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта1Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта1
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта2Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта2
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта3Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта3
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта4Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта4
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта5Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта5
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта6Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта6
			|			КОНЕЦ,
			|			ПлановыеНачисленияРаботниковОрганизаций.Сотрудник,
			|			ПлановыеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд1Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд1
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд2Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд2
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд3Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд3
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд4Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд4
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд5Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд5
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд6Завершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд6
			|			КОНЕЦ,
			|			ПлановыеНачисленияРаботниковОрганизаций.ИспользуетсяВНаряде,
			|			ВЫБОР
			|				КОГДА НАЧАЛОПЕРИОДА(ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения, МЕСЯЦ) = &парамНачало
			|					ТОГДА ДОБАВИТЬКДАТЕ(ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения, ДЕНЬ, -1)
			|				ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			КОНЕЦ,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель1ВВалютеЗавершения
			|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель1ВВалюте
			|			КОНЕЦ"
			
			//Аверсон ЕАЕ 07.03.2022 СВФР-008825
			+ ?(Организация.ИНН = "100071565", ",
			|			ПлановыеНачисленияРаботниковОрганизаций.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
			//Аверсон СВФР-008825
			
			|		ИЗ
			|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
			|		ГДЕ
			|			ВЫБОР
			|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|						ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения
			|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Действие
			|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|			И (ВЫБОР
			|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|						ТОГДА ВЫБОР
			|								КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|									ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
			|								ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения
			|							КОНЕЦ
			|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
			|				КОНЕЦ В (&ВидРасчетаПособие)
			//О.Т. Аверсон 14.06.2018 № 
			|			Или ВЫБОР
			|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
			|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|						ТОГДА ВЫБОР
			|								КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|									ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета
			|								ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения.СпособРасчета
			|							КОНЕЦ
			|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета
			|				КОНЕЦ В (&СпособыРасчетаПособие))
			//О.Т. Аверсон 14.06.2018 № 
			|			И ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|			И ПлановыеНачисленияРаботниковОрганизаций.Сотрудник В
			|					(ВЫБРАТЬ
			|						Работники.Сотрудник
			|					ИЗ
			|						ВТСписокРаботников КАК Работники)
			//+ СВЭЙ КДЯ 28.11.19 СВФР-005137
			//|			И НЕ ПлановыеНачисленияРаботниковОрганизаций.Период > &парамНачало
			//- СВЭЙ КДЯ 28.11.19 СВФР-005137
			//+ СВЭЙ КДЯ 28.11.19 СВФР-005137
			//|			И НЕ НАЧАЛОПЕРИОДА( ПлановыеНачисленияРаботниковОрганизаций.Период, МЕСЯЦ ) > &парамНачало //Аверсон 23.04.2020 КВВ СВФР-005915 Закомментировала
			//- СВЭЙ КДЯ 28.11.19 СВФР-005137
			
			//Аверсон 23.04.2020 КВВ СВФР-005915 (
			|			И НЕ(ВЫБОР
			|			КОГДА НАЧАЛОПЕРИОДА(ПлановыеНачисленияРаботниковОрганизаций.Период, МЕСЯЦ) = НАЧАЛОПЕРИОДА(&парамНачало, МЕСЯЦ)
			|			ТОГДА
			|			(ПлановыеНачисленияРаботниковОрганизаций.Период > &парамНачало
			|			И ПлановыеНачисленияРаботниковОрганизаций.Период <= &парамКонец )
			|			ИНАЧЕ
			|			НАЧАЛОПЕРИОДА(ПлановыеНачисленияРаботниковОрганизаций.Период, МЕСЯЦ) > &парамНачало
			|			КОНЕЦ)
			//Аверсон 23.04.2020 КВВ СВФР-005915 )
			
			|			) КАК НачисленияРаботниковОрганизации
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки1
			|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд1 = ТарифныеСтавки1.ТарифныйРазряд
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки2
			|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд2 = ТарифныеСтавки2.ТарифныйРазряд
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки3
			|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд3 = ТарифныеСтавки3.ТарифныйРазряд
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки4
			|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд4 = ТарифныеСтавки4.ТарифныйРазряд
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки5
			|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд5 = ТарифныеСтавки5.ТарифныйРазряд
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки6
			|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд6 = ТарифныеСтавки6.ТарифныйРазряд
			|		ПО (Работники.Подходит)
			|			И Работники.Сотрудник = НачисленияРаботниковОрганизации.Сотрудник
			
			//Аверсон ЕАЕ 21.03.2022 СВФР-008825
			//|			И Работники.Период = НачисленияРаботниковОрганизации.Период
			//Аверсон СВФР-008825
			
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";	
			//Островская Татьяна 22.01.2014 № 17057
			//|
			//|ОБЪЕДИНИТЬ ВСЕ
			//|
			//|ВЫБРАТЬ
			//|	Работники.Сотрудник,
			//|	Работники.Сотрудник.Наименование,
			//|	Работники.Сотрудник.Физлицо,
			//|	ВЫБОР
			//|		КОГДА Работники.Период >= ШтатноеРасписание.Период
			//|				ИЛИ ШтатноеРасписание.Период ЕСТЬ NULL 
			//|			ТОГДА Работники.Период
			//|		ИНАЧЕ ШтатноеРасписание.Период
			//|	КОНЕЦ,
			//|	Работники.Подходит,
			//|	Работники.Период,
			//|	ШтатноеРасписание.Период,
			//|	ЛОЖЬ,
			//|	ШтатноеРасписание.ВидНадбавки,
			//|	ШтатноеРасписание.ВидНадбавки.Наименование,
			//|	ШтатноеРасписание.ВидНадбавки.ВидСтажа,
			//|	ШтатноеРасписание.ВидНадбавки.ТребуетВводаТарифногоРазряда,
			//|	ШтатноеРасписание.ВидНадбавки.КоэффициентСтажа,
			//|	ШтатноеРасписание.ВидНадбавки.СпособРасчета,
			//|	ВЫБОР
			//|		КОГДА ШтатноеРасписание.ВидНадбавки ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
			//|			ТОГДА ШтатноеРасписание.ВидНадбавки.ВидВремени
			//|		ИНАЧЕ NULL
			//|	КОНЕЦ,
			//|	ШтатноеРасписание.Действие,
			//|	ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка),
			//|	ШтатноеРасписание.Показатель1,
			//|	ШтатноеРасписание.Показатель2,
			//|	ШтатноеРасписание.Показатель3,
			//|	ШтатноеРасписание.Показатель4,
			//|	ШтатноеРасписание.Показатель5,
			//|	ШтатноеРасписание.Показатель6,
			//|	ШтатноеРасписание.Валюта1,
			//|	ШтатноеРасписание.Валюта2,
			//|	ШтатноеРасписание.Валюта3,
			//|	ШтатноеРасписание.Валюта4,
			//|	ШтатноеРасписание.Валюта5,
			//|	ШтатноеРасписание.Валюта6,
			//|	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
			//|	Работники.ПодразделениеОрганизации,
			//|	Работники.ГрафикРаботы,
			//|	ЕСТЬNULL(Работники.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ),
			//|	ЕСТЬNULL(ВЫБОР
			//|			КОГДА Работники.ГрафикРаботы.СокращенноеРабочееВремя
			//|					И Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
			//|				ТОГДА Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели
			//|			ИНАЧЕ Работники.ГрафикРаботы.ДлительностьРабочейНедели
			//|		КОНЕЦ, 0),
			//|	Работники.ГрафикРаботы.ВидГрафика,
			//|	Работники.Должность
			//|ИЗ
			//|	ВТДвиженияРаботников КАК Работники
			//|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			//|			&парамНачало КАК Период,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.ВидНадбавки КАК ВидНадбавки,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель1 КАК Показатель1,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель2 КАК Показатель2,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель3 КАК Показатель3,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель4 КАК Показатель4,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель5 КАК Показатель5,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель6 КАК Показатель6,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта1 КАК Валюта1,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта2 КАК Валюта2,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта3 КАК Валюта3,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта4 КАК Валюта4,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта5 КАК Валюта5,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта6 КАК Валюта6,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Должность КАК Должность,
			//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			//|			ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Изменить) КАК Действие
			//|		ИЗ
			//|			РегистрСведений.НадбавкиПоШтатномуРасписаниюОрганизаций.СрезПоследних(
			//|					&парамНачало,
			//|					ПодразделениеОрганизации В
			//|						(ВЫБРАТЬ
			//|							ДвиженияРаботников.ПодразделениеОрганизации
			//|						ИЗ
			//|							ВТДвиженияРаботников КАК ДвиженияРаботников)) КАК НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних
			//|		ГДЕ
			//|			(НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель1 > 0
			//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель2 > 0
			//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель3 > 0
			//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель4 > 0
			//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель5 > 0
			//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель6 > 0)
			//|		
			//|		ОБЪЕДИНИТЬ ВСЕ
			//|		
			//|		ВЫБРАТЬ
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Период,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.ВидНадбавки,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель1,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель2,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель3,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель4,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель5,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель6,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта1,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта2,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта3,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта4,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта5,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта6,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Должность,
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.ПодразделениеОрганизации,
			//|			ВЫБОР
			//|				КОГДА НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель1 = 0
			//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель2 = 0
			//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель3 = 0
			//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель4 = 0
			//|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			//|				ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Изменить)
			//|			КОНЕЦ
			//|		ИЗ
			//|			РегистрСведений.НадбавкиПоШтатномуРасписаниюОрганизаций КАК НадбавкиПоШтатномуРасписаниюОрганизаций
			//|		ГДЕ
			//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Период > &парамНачало
			//|			И НадбавкиПоШтатномуРасписаниюОрганизаций.Период <= &парамКонец
			//|			И НадбавкиПоШтатномуРасписаниюОрганизаций.ПодразделениеОрганизации В
			//|					(ВЫБРАТЬ
			//|						ДвиженияРаботников.ПодразделениеОрганизации
			//|					ИЗ
			//|						ВТДвиженияРаботников КАК ДвиженияРаботников)) КАК ШтатноеРасписание
			//|		ПО Работники.ПодразделениеОрганизации = ШтатноеРасписание.ПодразделениеОрганизации
			//|			И Работники.Должность = ШтатноеРасписание.Должность
			
			
			Запрос.Выполнить();
			
			//получим все невводимые показатели
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	СписокНачислений.Сотрудник КАК Сотрудник,
			|	СписокНачислений.Период,
			|	СписокНачислений.ПериодРаботники КАК ПериодРаботники,
			|	СписокНачислений.ПериодНачисления КАК ПериодНачисления,
			|	ВводимыеПоказатели.Показатель КАК Показатель,
			|	ВЫБОР
			//О.Т. Аверсон 11.03.2019 № 4039
			|	КОГДА СписокНачислений.ВидРасчета = ЗНАЧЕНИЕ(Планвидоврасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)
			|	ТОГДА 1
			//О.Т. Аверсон 11.03.2019 № 4039 
			|		КОГДА ВводимыеПоказатели.НомерСтроки = 1
			|			ТОГДА СписокНачислений.Показатель1
			|		КОГДА ВводимыеПоказатели.НомерСтроки = 2
			|			ТОГДА СписокНачислений.Показатель2
			|		КОГДА ВводимыеПоказатели.НомерСтроки = 3
			|			ТОГДА СписокНачислений.Показатель3
			|		КОГДА ВводимыеПоказатели.НомерСтроки = 4
			|			ТОГДА СписокНачислений.Показатель4
			|		КОГДА ВводимыеПоказатели.НомерСтроки = 5
			|			ТОГДА СписокНачислений.Показатель5
			|		КОГДА ВводимыеПоказатели.НомерСтроки = 6
			|			ТОГДА СписокНачислений.Показатель6
			|	КОНЕЦ КАК ЗначениеПоказателя
			|ПОМЕСТИТЬ ВТЗначенияВводимыхКадровыхПоказателей
			|ИЗ
			|	ВТРаботникиИНачисления КАК СписокНачислений
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВводимыеВПлановыхНачисленияхПоказатели КАК ВводимыеПоказатели
			|		ПО СписокНачислений.ВидРасчета = ВводимыеПоказатели.Ссылка
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Показатель
			|";
			Запрос.Выполнить();
			
		КонецЕсли;
		
		// таблица Показатели
		//   видам начислений приписываются введенные пользователями для каждого сотрудника значения показателей 
		// 
		// Поля:
		//   ВидРасчета
		//   Сотрудник
		//   Показатель1,2,...,6 - значения соответствующих показателей
		//   Валюта
		//
		
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет Тогда 
			Запрос.Текст = 
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ПоказателиВидовРасчета.Ссылка КАК ВидРасчета,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей1.Сотрудник
			|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей2.Сотрудник
			|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей3.Сотрудник
			|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей4.Сотрудник		
			|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей5.Сотрудник		
			|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей6.Сотрудник
			|	КОНЕЦ КАК Сотрудник,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей1.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей2.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей3.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей4.ПодразделениеОрганизации		
			|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей5.ПодразделениеОрганизации		
			|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей6.ПодразделениеОрганизации
			|	КОНЕЦ КАК ПодразделениеОрганизации,		
			|	ПоказателиВидовРасчета.Показатель1.ТипПоказателя КАК ТипПоказателя1,
			|	ПоказателиВидовРасчета.Показатель2.ТипПоказателя КАК ТипПоказателя2,
			|	ПоказателиВидовРасчета.Показатель3.ТипПоказателя КАК ТипПоказателя3,
			|	ПоказателиВидовРасчета.Показатель4.ТипПоказателя КАК ТипПоказателя4,
			|	ПоказателиВидовРасчета.Показатель5.ТипПоказателя КАК ТипПоказателя5,
			|	ПоказателиВидовРасчета.Показатель6.ТипПоказателя КАК ТипПоказателя6,
			|	ПоказателиВидовРасчета.Показатель1.ВозможностьИзменения КАК ВозможностьИзменения1,
			|	ПоказателиВидовРасчета.Показатель2.ВозможностьИзменения КАК ВозможностьИзменения2,
			|	ПоказателиВидовРасчета.Показатель3.ВозможностьИзменения КАК ВозможностьИзменения3,
			|	ПоказателиВидовРасчета.Показатель4.ВозможностьИзменения КАК ВозможностьИзменения4,
			|	ПоказателиВидовРасчета.Показатель5.ВозможностьИзменения КАК ВозможностьИзменения5,
			|	ПоказателиВидовРасчета.Показатель6.ВозможностьИзменения КАК ВозможностьИзменения6,
			|	ЗначенияПоказателей1.Значение КАК Показатель1,
			|	ЗначенияПоказателей2.Значение КАК Показатель2,
			|	ЗначенияПоказателей3.Значение КАК Показатель3,
			|	ЗначенияПоказателей4.Значение КАК Показатель4,
			|	ЗначенияПоказателей5.Значение КАК Показатель5,
			|	ЗначенияПоказателей6.Значение КАК Показатель6,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей1.Валюта
			|		КОГДА ЗначенияПоказателей2.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей2.Валюта
			|		КОГДА ЗначенияПоказателей3.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей3.Валюта
			|		КОГДА ЗначенияПоказателей4.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей4.Валюта		
			|		КОГДА ЗначенияПоказателей5.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей5.Валюта		
			|		КОГДА ЗначенияПоказателей6.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей6.Валюта
			|	КОНЕЦ КАК Валюта			
			|ПОМЕСТИТЬ ВТПоказатели
			|ИЗ
			|	(ВЫБРАТЬ
			|		Показатели.Ссылка КАК Ссылка,
			|		Показатели1.Показатель КАК Показатель1,
			|		Показатели2.Показатель КАК Показатель2,
			|		Показатели3.Показатель КАК Показатель3,
			|		Показатели4.Показатель КАК Показатель4,
			|		Показатели5.Показатель КАК Показатель5,
			|		Показатели6.Показатель КАК Показатель6
			|	ИЗ
			|		ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели1
			|			ПО Показатели.Ссылка = Показатели1.Ссылка
			|				И (Показатели1.НомерСтроки = 1)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели2
			|			ПО Показатели.Ссылка = Показатели2.Ссылка
			|				И (Показатели2.НомерСтроки = 2)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели3
			|			ПО Показатели.Ссылка = Показатели3.Ссылка
			|				И (Показатели3.НомерСтроки = 3)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели4
			|			ПО Показатели.Ссылка = Показатели4.Ссылка
			|				И (Показатели4.НомерСтроки = 4)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели5
			|			ПО Показатели.Ссылка = Показатели5.Ссылка
			|				И (Показатели5.НомерСтроки = 5)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели6
			|			ПО Показатели.Ссылка = Показатели6.Ссылка
			|				И (Показатели6.НомерСтроки = 6)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		Показатели.Ссылка,
			|		Показатели1.Показатель,
			|		Показатели2.Показатель,
			|		Показатели3.Показатель,
			|		Показатели4.Показатель,
			|		Показатели5.Показатель,
			|		Показатели6.Показатель
			|	ИЗ
			|		ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели1
			|			ПО Показатели.Ссылка = Показатели1.Ссылка
			|				И (Показатели1.НомерСтроки = 1)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели2
			|			ПО Показатели.Ссылка = Показатели2.Ссылка
			|				И (Показатели2.НомерСтроки = 2)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели3
			|			ПО Показатели.Ссылка = Показатели3.Ссылка
			|				И (Показатели3.НомерСтроки = 3)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели4
			|			ПО Показатели.Ссылка = Показатели4.Ссылка
			|				И (Показатели4.НомерСтроки = 4)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели5
			|			ПО Показатели.Ссылка = Показатели5.Ссылка
			|				И (Показатели5.НомерСтроки = 5)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели6
			|			ПО Показатели.Ссылка = Показатели6.Ссылка
			|				И (Показатели6.НомерСтроки = 6)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		Показатели.Ссылка,
			|		Показатели1.Показатель,
			|		Показатели2.Показатель,
			|		Показатели3.Показатель,
			|		Показатели4.Показатель,
			|		Показатели5.Показатель,
			|		Показатели6.Показатель
			|	ИЗ
			|		ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели1
			|			ПО Показатели.Ссылка = Показатели1.Ссылка
			|				И (Показатели1.НомерСтроки = 1)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели2
			|			ПО Показатели.Ссылка = Показатели2.Ссылка
			|				И (Показатели2.НомерСтроки = 2)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели3
			|			ПО Показатели.Ссылка = Показатели3.Ссылка
			|				И (Показатели3.НомерСтроки = 3)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели4
			|			ПО Показатели.Ссылка = Показатели4.Ссылка
			|				И (Показатели4.НомерСтроки = 4)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели5
			|			ПО Показатели.Ссылка = Показатели5.Ссылка
			|				И (Показатели5.НомерСтроки = 5)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели6
			|			ПО Показатели.Ссылка = Показатели6.Ссылка
			|				И (Показатели6.НомерСтроки = 6)) КАК ПоказателиВидовРасчета
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей1
			|		ПО ПоказателиВидовРасчета.Показатель1 = ЗначенияПоказателей1.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей2
			|		ПО ПоказателиВидовРасчета.Показатель2 = ЗначенияПоказателей2.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей3
			|		ПО ПоказателиВидовРасчета.Показатель3 = ЗначенияПоказателей3.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей4
			|		ПО ПоказателиВидовРасчета.Показатель4 = ЗначенияПоказателей4.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей5
			|		ПО ПоказателиВидовРасчета.Показатель5 = ЗначенияПоказателей5.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей6
			|		ПО ПоказателиВидовРасчета.Показатель6 = ЗначенияПоказателей6.Показатель
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	ВидРасчета
			|";
			Запрос.Выполнить();
			
		ИначеЕсли ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНачислений Тогда
			Запрос.Текст = 
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ПоказателиВидовРасчета.Ссылка КАК ВидРасчета,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей1.Сотрудник
			|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей2.Сотрудник
			|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей3.Сотрудник
			|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей4.Сотрудник		
			|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей5.Сотрудник		
			|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей6.Сотрудник
			|	КОНЕЦ КАК Сотрудник,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей1.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей2.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей3.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей4.ПодразделениеОрганизации		
			|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей5.ПодразделениеОрганизации		
			|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей6.ПодразделениеОрганизации
			|	КОНЕЦ КАК ПодразделениеОрганизации,			
			|	ПоказателиВидовРасчета.Показатель1.ТипПоказателя КАК ТипПоказателя1,
			|	ПоказателиВидовРасчета.Показатель2.ТипПоказателя КАК ТипПоказателя2,
			|	ПоказателиВидовРасчета.Показатель3.ТипПоказателя КАК ТипПоказателя3,
			|	ПоказателиВидовРасчета.Показатель4.ТипПоказателя КАК ТипПоказателя4,
			|	ПоказателиВидовРасчета.Показатель5.ТипПоказателя КАК ТипПоказателя5,
			|	ПоказателиВидовРасчета.Показатель6.ТипПоказателя КАК ТипПоказателя6,
			|	ПоказателиВидовРасчета.Показатель1.ВозможностьИзменения КАК ВозможностьИзменения1,
			|	ПоказателиВидовРасчета.Показатель2.ВозможностьИзменения КАК ВозможностьИзменения2,
			|	ПоказателиВидовРасчета.Показатель3.ВозможностьИзменения КАК ВозможностьИзменения3,
			|	ПоказателиВидовРасчета.Показатель4.ВозможностьИзменения КАК ВозможностьИзменения4,
			|	ПоказателиВидовРасчета.Показатель5.ВозможностьИзменения КАК ВозможностьИзменения5,
			|	ПоказателиВидовРасчета.Показатель6.ВозможностьИзменения КАК ВозможностьИзменения6,
			
			|	ЗначенияПоказателей1.Значение КАК Показатель1,
			|	ЗначенияПоказателей2.Значение КАК Показатель2,
			|	ЗначенияПоказателей3.Значение КАК Показатель3,
			|	ЗначенияПоказателей4.Значение КАК Показатель4,
			|	ЗначенияПоказателей5.Значение КАК Показатель5,
			|	ЗначенияПоказателей6.Значение КАК Показатель6,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей1.Валюта
			|		КОГДА ЗначенияПоказателей2.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей2.Валюта
			|		КОГДА ЗначенияПоказателей3.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей3.Валюта
			|		КОГДА ЗначенияПоказателей4.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей4.Валюта		
			|		КОГДА ЗначенияПоказателей5.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей5.Валюта		
			|		КОГДА ЗначенияПоказателей6.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей6.Валюта
			|	КОНЕЦ КАК Валюта		
			|ПОМЕСТИТЬ ВТПоказатели
			|ИЗ
			|	(ВЫБРАТЬ
			|		Показатели.Ссылка КАК Ссылка,
			|		Показатели1.Показатель КАК Показатель1,
			|		Показатели2.Показатель КАК Показатель2,
			|		Показатели3.Показатель КАК Показатель3,
			|		Показатели4.Показатель КАК Показатель4,
			|		Показатели5.Показатель КАК Показатель5,
			|		Показатели6.Показатель КАК Показатель6
			|	ИЗ
			|		ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели1
			|			ПО Показатели.Ссылка = Показатели1.Ссылка
			|				И (Показатели1.НомерСтроки = 1)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели2
			|			ПО Показатели.Ссылка = Показатели2.Ссылка
			|				И (Показатели2.НомерСтроки = 2)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели3
			|			ПО Показатели.Ссылка = Показатели3.Ссылка
			|				И (Показатели3.НомерСтроки = 3)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели4
			|			ПО Показатели.Ссылка = Показатели4.Ссылка
			|				И (Показатели4.НомерСтроки = 4)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели5
			|			ПО Показатели.Ссылка = Показатели5.Ссылка
			|				И (Показатели5.НомерСтроки = 5)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели6
			|			ПО Показатели.Ссылка = Показатели6.Ссылка
			|				И (Показатели6.НомерСтроки = 6)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		Показатели.Ссылка,
			|		Показатели1.Показатель,
			|		Показатели2.Показатель,
			|		Показатели3.Показатель,
			|		Показатели4.Показатель,
			|		Показатели5.Показатель,
			|		Показатели6.Показатель
			|	ИЗ
			|		ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели1
			|			ПО Показатели.Ссылка = Показатели1.Ссылка
			|				И (Показатели1.НомерСтроки = 1)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели2
			|			ПО Показатели.Ссылка = Показатели2.Ссылка
			|				И (Показатели2.НомерСтроки = 2)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели3
			|			ПО Показатели.Ссылка = Показатели3.Ссылка
			|				И (Показатели3.НомерСтроки = 3)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели4
			|			ПО Показатели.Ссылка = Показатели4.Ссылка
			|				И (Показатели4.НомерСтроки = 4)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели5
			|			ПО Показатели.Ссылка = Показатели5.Ссылка
			|				И (Показатели5.НомерСтроки = 5)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели6
			|			ПО Показатели.Ссылка = Показатели6.Ссылка
			|				И (Показатели6.НомерСтроки = 6)) КАК ПоказателиВидовРасчета
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей1
			|		ПО ПоказателиВидовРасчета.Показатель1 = ЗначенияПоказателей1.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей2
			|		ПО ПоказателиВидовРасчета.Показатель2 = ЗначенияПоказателей2.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей3
			|		ПО ПоказателиВидовРасчета.Показатель3 = ЗначенияПоказателей3.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей4
			|		ПО ПоказателиВидовРасчета.Показатель4 = ЗначенияПоказателей4.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей5
			|		ПО ПоказателиВидовРасчета.Показатель5 = ЗначенияПоказателей5.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей6
			|		ПО ПоказателиВидовРасчета.Показатель6 = ЗначенияПоказателей6.Показатель
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	ВидРасчета";
			Запрос.Выполнить();
		Иначе
			Запрос.Текст = 
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ПоказателиВидовРасчета.Ссылка КАК ВидРасчета,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей1.Сотрудник
			|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей2.Сотрудник
			|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей3.Сотрудник
			|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей4.Сотрудник		
			|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей5.Сотрудник		
			|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|			ТОГДА ЗначенияПоказателей6.Сотрудник
			|		ИНАЧЕ NULL
			|	КОНЕЦ КАК Сотрудник,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей1.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей2.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей3.ПодразделениеОрганизации
			|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей4.ПодразделениеОрганизации		
			|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей5.ПодразделениеОрганизации		
			|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|			ТОГДА ЗначенияПоказателей6.ПодразделениеОрганизации
			|	КОНЕЦ КАК ПодразделениеОрганизации,			
			|	ПоказателиВидовРасчета.Показатель1.ВозможностьИзменения КАК ВозможностьИзменения1,
			|	ПоказателиВидовРасчета.Показатель2.ВозможностьИзменения КАК ВозможностьИзменения2,
			|	ПоказателиВидовРасчета.Показатель3.ВозможностьИзменения КАК ВозможностьИзменения3,
			|	ПоказателиВидовРасчета.Показатель4.ВозможностьИзменения КАК ВозможностьИзменения4,
			|	ПоказателиВидовРасчета.Показатель5.ВозможностьИзменения КАК ВозможностьИзменения5,
			|	ПоказателиВидовРасчета.Показатель6.ВозможностьИзменения КАК ВозможностьИзменения6,
			
			|	ПоказателиВидовРасчета.Показатель1.ТипПоказателя КАК ТипПоказателя1,
			|	ПоказателиВидовРасчета.Показатель2.ТипПоказателя КАК ТипПоказателя2,
			|	ПоказателиВидовРасчета.Показатель3.ТипПоказателя КАК ТипПоказателя3,
			|	ПоказателиВидовРасчета.Показатель4.ТипПоказателя КАК ТипПоказателя4,
			|	ПоказателиВидовРасчета.Показатель5.ТипПоказателя КАК ТипПоказателя5,
			|	ПоказателиВидовРасчета.Показатель6.ТипПоказателя КАК ТипПоказателя6,
			|	ЗначенияПоказателей1.Значение КАК Показатель1,
			|	ЗначенияПоказателей2.Значение КАК Показатель2,
			|	ЗначенияПоказателей3.Значение КАК Показатель3,
			|	ЗначенияПоказателей4.Значение КАК Показатель4,
			|	ЗначенияПоказателей5.Значение КАК Показатель5,
			|	ЗначенияПоказателей6.Значение КАК Показатель6,
			|	ВЫБОР 
			|		КОГДА ЗначенияПоказателей1.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей1.Валюта
			|		КОГДА ЗначенияПоказателей2.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей2.Валюта
			|		КОГДА ЗначенияПоказателей3.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей3.Валюта
			|		КОГДА ЗначенияПоказателей4.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей4.Валюта		
			|		КОГДА ЗначенияПоказателей5.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей5.Валюта		
			|		КОГДА ЗначенияПоказателей6.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|			ТОГДА ЗначенияПоказателей6.Валюта
			|	КОНЕЦ КАК Валюта		
			|ПОМЕСТИТЬ ВТПоказатели
			|ИЗ
			|	(ВЫБРАТЬ 
			|		Показатели.Ссылка КАК Ссылка,
			|		Показатели1.Показатель КАК Показатель1,
			|		Показатели2.Показатель КАК Показатель2,
			|		Показатели3.Показатель КАК Показатель3,
			|		Показатели4.Показатель КАК Показатель4,
			|		Показатели5.Показатель КАК Показатель5,
			|		Показатели6.Показатель КАК Показатель6
			|	ИЗ
			|		ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели1
			|			ПО Показатели.Ссылка = Показатели1.Ссылка
			|				И (Показатели1.НомерСтроки = 1)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели2
			|			ПО Показатели.Ссылка = Показатели2.Ссылка
			|				И (Показатели2.НомерСтроки = 2)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели3
			|			ПО Показатели.Ссылка = Показатели3.Ссылка
			|				И (Показатели3.НомерСтроки = 3)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели4
			|			ПО Показатели.Ссылка = Показатели4.Ссылка
			|				И (Показатели4.НомерСтроки = 4)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели5
			|			ПО Показатели.Ссылка = Показатели5.Ссылка
			|				И (Показатели5.НомерСтроки = 5)
			|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели6
			|			ПО Показатели.Ссылка = Показатели6.Ссылка
			|				И (Показатели6.НомерСтроки = 6)) КАК ПоказателиВидовРасчета
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей1
			|		ПО ПоказателиВидовРасчета.Показатель1 = ЗначенияПоказателей1.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей2
			|		ПО ПоказателиВидовРасчета.Показатель2 = ЗначенияПоказателей2.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей3
			|		ПО ПоказателиВидовРасчета.Показатель3 = ЗначенияПоказателей3.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей4
			|		ПО ПоказателиВидовРасчета.Показатель4 = ЗначенияПоказателей4.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей5
			|		ПО ПоказателиВидовРасчета.Показатель5 = ЗначенияПоказателей5.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей6
			|		ПО ПоказателиВидовРасчета.Показатель6 = ЗначенияПоказателей6.Показатель
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	ВидРасчета";
			Запрос.Выполнить();
		КонецЕсли;
		
		// АВТОЗАПОЛНЕНИЕ ТЧ "Начисления", "ДополнительныеНачисления" и "ДоговорыНаВыполнениеРабот"
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНачислений 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
			
			// таблица ОсновныеНачисления  
			//	    выборка сведений об уже выполненных начислениях за отработанное время - для выбрасывания 
			// 		ранее "обслуженных" работников
			//	Поля:
			//		Сотрудник,
			//		ПодразделениеОрганизации
			//
			
			Если ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца Тогда
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	РасчетПервойПоловиныМесяца.Сотрудник КАК Сотрудник,
				|	ТаблицаДвиженийРаботников.ПодразделениеОрганизации
				|ПОМЕСТИТЬ ВТОсновныеНачисления
				|ИЗ
				|	РегистрНакопления.РасчетПервойПоловиныМесяца КАК РасчетПервойПоловиныМесяца
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ТаблицаДвиженийРаботников
				|		ПО РасчетПервойПоловиныМесяца.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|ГДЕ
				|	РасчетПервойПоловиныМесяца.Организация = &парамОрганизация
				|	И РасчетПервойПоловиныМесяца.Регистратор <> &парамРегистратор
				|	И НАЧАЛОПЕРИОДА(РасчетПервойПоловиныМесяца.Период, МЕСЯЦ) = &парамНачалоМесяца
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";		
				Запрос.Выполнить();
				
			Иначе
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
				|	ОсновныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации
				|ПОМЕСТИТЬ ВТОсновныеНачисления
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ТаблицаДвиженийРаботников
				|		ПО ОсновныеНачисления.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|ГДЕ
				|	ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
				|	И ОсновныеНачисления.ПериодДействияКонец <= &парамКонец
				|	И ОсновныеНачисления.ПериодДействияНачало >= &парамНачало
				|	И ОсновныеНачисления.Организация = &парамГоловнаяОрганизация
				|	И (ОсновныеНачисления.ВидРасчета.ЗачетОтработанногоВремени
				|				И ОсновныеНачисления.ВидРасчета.ЗачетНормыВремени
				|			ИЛИ ОсновныеНачисления.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты))
				|	И (НЕ ОсновныеНачисления.Сторно)
				|	И ОсновныеНачисления.Регистратор <> &парамРегистратор
				|	И ОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";		
				Запрос.Выполнить();
			КонецЕсли;
			
			// НормаВремениПоСводнымИндивидуальнымГрафикам
			//		Сотрудники, для которых введены сводные данные об их графике
			// 
			//	Поля:
			//		Сотрудник
			//		ЧасовЗаМесяц - указанное пользователем значение
			// 
			
			Запрос.Текст =
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СписокРаботников.Сотрудник КАК Сотрудник,
			|	СводныеИндивидуальныеГрафики.Часов КАК ЧасовЗаМесяц
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
			|		ПО СписокРаботников.Сотрудник = СводныеИндивидуальныеГрафики.Сотрудник
			|			И (СводныеИндивидуальныеГрафики.Месяц = &парамПериодРегистрации)
			|ГДЕ
			|	СводныеИндивидуальныеГрафики.Сотрудник ЕСТЬ НЕ NULL";
			
			Запрос.Выполнить();
			
			Запрос.Текст =
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СписокРаботников.Сотрудник КАК Сотрудник,
			|	СводныеИндивидуальныеГрафики.Часов КАК ЧасовЗаМесяц
			|ПОМЕСТИТЬ ВТНормаВремениПоСводнымИндивидуальнымГрафикам
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
			|		ПО СписокРаботников.Сотрудник = СводныеИндивидуальныеГрафики.Сотрудник
			|			И (СводныеИндивидуальныеГрафики.Месяц = &парамПериодРегистрации)
			|ГДЕ
			|	СводныеИндивидуальныеГрафики.Сотрудник ЕСТЬ НЕ NULL 
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
			Запрос.Выполнить();
			
			// НормаВремениПоЕжедневнымИндивидуальнымГрафикам
			//		Таблица сотрудников и нормы времени в часах, введенной индивидуальными графиками
			// 
			//	Поля:
			//		Сотрудник,
			//		ЧасовЗаМесяц - суммируем все часы рабочего времени
			// 
			// Описание:
			//
			//	выбираем данные из рег-ра ГрафикиРаботыПоВидамВремени,	
			//	введенные доками ВводИндивидуальныхГрафиков, т.е. по строкам с выставленным флажком План
			
			Запрос.Текст =
			"ВЫБРАТЬ
			|	СписокРаботников.Сотрудник КАК Сотрудник,
			|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
			|		ПО СписокРаботников.Сотрудник = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
			|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
			|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
			|			И (ГрафикиРаботыПоВидамВремени.План)
			|ГДЕ
			|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL
			|
			|СГРУППИРОВАТЬ ПО
			|	СписокРаботников.Сотрудник";
			
			Запрос.Выполнить();
			
			Запрос.Текст =
			"ВЫБРАТЬ
			|	СписокРаботников.Сотрудник КАК Сотрудник,
			|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
			|ПОМЕСТИТЬ ВТНормаВремениПоЕжедневнымИндивидуальнымГрафикам
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
			|		ПО СписокРаботников.Сотрудник = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
			|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
			|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
			|			И (ГрафикиРаботыПоВидамВремени.План)
			|ГДЕ
			|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
			|
			|СГРУППИРОВАТЬ ПО
			|	СписокРаботников.Сотрудник
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
			Запрос.Выполнить();
			
			// НормаВремениПоОбщимГрафикам
			//		Таблица сотрудников и нормы времени в часах по общим графикам
			// 
			//	Поля:
			//		Сотрудник,
			//		ЧасовЗаМесяц - суммируем все часы рабочего времени
			// 
			// Описание:
			//
			//	выбираем данные из рег-ра ГрафикиРаботыПоВидамВремени для общих графиков
			
			Запрос.Текст =
			"ВЫБРАТЬ
			|	СписокРаботников.Сотрудник КАК Сотрудник,
			|	СписокРаботников.ГрафикРаботы,
			|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
			|ИЗ
			|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
			|		СписокРаботников.Сотрудник КАК Сотрудник,
			|		ВЫБОР
			|			КОГДА СписокРаботников.ГрафикРаботы.СокращенноеРабочееВремя
			|					И СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
			|				ТОГДА СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени
			|			ИНАЧЕ СписокРаботников.ГрафикРаботы
			|		КОНЕЦ КАК ГрафикРаботы
			|	ИЗ
			|		ВТДвиженияРаботников КАК СписокРаботников) КАК СписокРаботников
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
			|		ПО СписокРаботников.ГрафикРаботы = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
			|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
			|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
			|			И (ГрафикиРаботыПоВидамВремени.План)
			|ГДЕ
			|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
			|
			|СГРУППИРОВАТЬ ПО
			|	СписокРаботников.Сотрудник,
			|	СписокРаботников.ГрафикРаботы";
			Запрос.Выполнить();
			
			Запрос.Текст =
			"ВЫБРАТЬ
			|	СписокРаботников.Сотрудник КАК Сотрудник,
			|	СписокРаботников.ГрафикРаботы,
			|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц,
			|	СписокРаботников.ПодразделениеОрганизации
			|ПОМЕСТИТЬ ВТНормаВремениПоОбщимГрафикам
			|ИЗ
			|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
			|		СписокРаботников.Сотрудник КАК Сотрудник,
			|		ВЫБОР
			|			КОГДА СписокРаботников.ГрафикРаботы.СокращенноеРабочееВремя
			|					И СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
			|				ТОГДА СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени
			|			ИНАЧЕ СписокРаботников.ГрафикРаботы
			|		КОНЕЦ КАК ГрафикРаботы,
			|		СписокРаботников.ПодразделениеОрганизации КАК ПодразделениеОрганизации //О.Т. Аверсон 14.06.2018 № 
			|	ИЗ
			|		ВТДвиженияРаботников КАК СписокРаботников) КАК СписокРаботников
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
			|		ПО СписокРаботников.ГрафикРаботы = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
			|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
			|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
			|			И (ГрафикиРаботыПоВидамВремени.План)
			|ГДЕ
			|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
			|
			|СГРУППИРОВАТЬ ПО
			|	СписокРаботников.Сотрудник,
			|	СписокРаботников.ГрафикРаботы,
			|	СписокРаботников.ПодразделениеОрганизации
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
			Запрос.Выполнить();
			
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	ДатыСтажа.Сотрудник КАК Сотрудник,
			|	ДатыСтажа.Физлицо,
			|	ДатыСтажа.ПериодРаботники,
			|	ДатыСтажа.ПериодСеверногоСтажа КАК ДатаРегистрацииСеверногоСтажа,
			|	СведенияОСтажеРаботыНаСевере.ПорядокНачисленияСеверныхНадбавок,
			|	СведенияОСтажеРаботыНаСевере.НачальныйПроцентСевернойНадбавки,
			|	СведенияОСтажеРаботыНаСевере.СеверныйСтажМесяцев,
			|	СведенияОСтажеРаботыНаСевере.СеверныйСтажДней
			|ПОМЕСТИТЬ ВТДанныеОСеверномСтаже
			|ИЗ
			|	(ВЫБРАТЬ
			|		СписокНачислений.Сотрудник КАК Сотрудник,
			|		СписокНачислений.Физлицо КАК Физлицо,
			|		СписокНачислений.ПериодРаботники КАК ПериодРаботники,
			|		МАКСИМУМ(СведенияОСтажеРаботыНаСевере.Период) КАК ПериодСеверногоСтажа
			|	ИЗ
			|		ВТРаботникиИНачисления КАК СписокНачислений
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОСтажеРаботыНаСевере КАК СведенияОСтажеРаботыНаСевере
			|			ПО СписокНачислений.Физлицо = СведенияОСтажеРаботыНаСевере.ФизЛицо
			|				И СписокНачислений.ПериодРаботники >= СведенияОСтажеРаботыНаСевере.Период
			|	
			|	СГРУППИРОВАТЬ ПО
			|		СписокНачислений.Сотрудник,
			|		СписокНачислений.Физлицо,
			|		СписокНачислений.ПериодРаботники) КАК ДатыСтажа
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОСтажеРаботыНаСевере КАК СведенияОСтажеРаботыНаСевере
			|		ПО ДатыСтажа.Физлицо = СведенияОСтажеРаботыНаСевере.ФизЛицо
			|			И ДатыСтажа.ПериодСеверногоСтажа = СведенияОСтажеРаботыНаСевере.Период
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
			Запрос.Выполнить();
			
			// РаботникиИНачисленияПоСхемамМотивации
			//		Таблица движений работников и сведениями об их плановых начислениях
			//      с добавленными значениями показателей, как введенными пользователями для расчета, так и 
			//      выбранными из строк плановых начислений, содержащих тарифные ставки по "основным" начислениям работника
			// 
			//	Поля:
			//		Сотрудник 
			//		ВидРасчета - плановое начисление 
			//		Показатель1,...,6 - размеры показателей 
			//		СпособРасчета - способ расчета начисления 
			//		ОкладТариф - размер трифной ставки, если начисление ее содержит  
			//		ГрафикРаботы - график сотрудника  
			//		ВидГрафика, СуммированныйУчетРабочегоВремени, ДлительностьРабочейНедели - реквизиты графика сотрудника 
			// 
			// Описание:
			//
			//	1. 
			//  2. 
			//
			//Островская Татьяна 22.01.2014 № 17057
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	СписокНачислений.Сотрудник КАК Сотрудник,
			|	СписокНачислений.СотрудникНаименование,
			|	СписокНачислений.Физлицо,
			|	СписокНачислений.ПодразделениеОрганизации,
			|   СписокНачислений.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	СписокНачислений.Подходит,
			|	СписокНачислений.Период,
			|	СписокНачислений.ПериодРаботники,
			|	СписокНачислений.ПериодНачисления,
			|	СписокНачислений.ОсновноеНачисление,
			|	СписокНачислений.ВидРасчета,
			|	СписокНачислений.ВидРасчетаНаименование,
			|	СписокНачислений.ВидРасчетаКоэффициентСтажа,
			|	СписокНачислений.ВидРасчетаВидСтажа,
			|	СписокНачислений.ВидРасчетаТребуетВводаТарифногоРазряда,
			|	СписокНачислений.СпособРасчета,
			|	СписокНачислений.ВидВремени,
			|	СписокНачислений.Действие,
			|	СписокНачислений.КодВычета,
			|	СписокНачислений.ДатаНачалаСобытия,
			|	СписокНачислений.ГрафикРаботы,
			|	СписокНачислений.СуммированныйУчетРабочегоВремени,
			|	СписокНачислений.ДлительностьРабочейНедели,
			|	СписокНачислений.ВидГрафика,
			|	СписокНачислений.Валюта1 КАК Валюта,
			|	СписокНачислений.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА 1
			|		ИНАЧЕ Валюты1.Курс
			|	КОНЕЦ КАК КурсВалюты,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
			|				И ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ НЕ NULL 
			|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
			|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель1
			|		КОГДА (СписокНачислений.Показатель1 = 0
			|				ИЛИ СписокНачислений.Показатель1 ЕСТЬ NULL )
			|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1)
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|			ТОГДА СписокНачислений.Показатель1
			|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель1
			|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
			|	КОНЕЦ КАК Показатель1,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
			|				И ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 2)
			|			ТОГДА 0
			|		КОГДА ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
			|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
			|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель2
			|		КОГДА (СписокНачислений.Показатель2 = 0
			|				ИЛИ СписокНачислений.Показатель2 ЕСТЬ NULL )
			|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2)
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|			ТОГДА СписокНачислений.Показатель2
			|		КОГДА СписокНачислений.Валюта2 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель2
			|		ИНАЧЕ СписокНачислений.Показатель2 * ЕСТЬNULL(Валюты2.Курс / Валюты2.Кратность, 0)
			|	КОНЕЦ КАК Показатель2,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
			|				И ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 3)
			|			ТОГДА 0
			|		КОГДА ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
			|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
			|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель3
			|		КОГДА СписокНачислений.Показатель3 = 0
			|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3)
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|			ТОГДА СписокНачислений.Показатель3
			|		КОГДА СписокНачислений.Валюта3 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель3
			|		ИНАЧЕ СписокНачислений.Показатель3 * ЕСТЬNULL(Валюты3.Курс / Валюты3.Кратность, 0)
			|	КОНЕЦ КАК Показатель3,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
			|				И ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 4)
			|			ТОГДА 0
			|		КОГДА ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
			|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
			|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель4
			|		КОГДА СписокНачислений.Показатель4 = 0
			|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4)
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|			ТОГДА СписокНачислений.Показатель4
			|		КОГДА СписокНачислений.Валюта4 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель4
			|		ИНАЧЕ СписокНачислений.Показатель4 * ЕСТЬNULL(Валюты4.Курс / Валюты4.Кратность, 0)
			|	КОНЕЦ КАК Показатель4,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
			|				И ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 5)
			|			ТОГДА 0
			|		КОГДА ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
			|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
			|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель5
			|		КОГДА СписокНачислений.Показатель5 = 0
			|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5)
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|			ТОГДА СписокНачислений.Показатель5
			|		КОГДА СписокНачислений.Валюта5 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель5
			|		ИНАЧЕ СписокНачислений.Показатель5 * ЕСТЬNULL(Валюты5.Курс / Валюты5.Кратность, 0)
			|	КОНЕЦ КАК Показатель5,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
			|				И ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 6)
			|			ТОГДА 0
			|		КОГДА ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
			|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
			|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель6
			|		КОГДА СписокНачислений.Показатель6 = 0
			|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
			|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
			|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6)
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|			ТОГДА СписокНачислений.Показатель6
			|		КОГДА СписокНачислений.Валюта6 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель6
			|		ИНАЧЕ СписокНачислений.Показатель6 * ЕСТЬNULL(Валюты6.Курс / Валюты6.Кратность, 0)
			|	КОНЕЦ КАК Показатель6,
			|	ПоказательТарифнойСтавки.Показатель КАК ВидТарифнойСтавки,
			|	ВЫБОР
			|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 1
			|			ТОГДА ВЫБОР
			|					КОГДА ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ НЕ NULL 
			|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель1
			|					КОГДА СписокНачислений.Показатель1 = 0
			|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
			|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
			|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|					КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
			|						ТОГДА 0
			|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ТОГДА СписокНачислений.Показатель1
			|					КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|						ТОГДА СписокНачислений.Показатель1
			|					ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
			|				КОНЕЦ
			|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 2
			|			ТОГДА ВЫБОР
			|					КОГДА ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
			|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель2
			|					КОГДА СписокНачислений.Показатель2 = 0
			|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
			|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
			|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|					КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
			|						ТОГДА 0
			|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ТОГДА СписокНачислений.Показатель2
			|					КОГДА СписокНачислений.Валюта2 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|						ТОГДА СписокНачислений.Показатель2
			|					ИНАЧЕ СписокНачислений.Показатель2 * ЕСТЬNULL(Валюты2.Курс / Валюты2.Кратность, 0)
			|				КОНЕЦ
			|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 3
			|			ТОГДА ВЫБОР
			|					КОГДА ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
			|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель3
			|					КОГДА СписокНачислений.Показатель3 = 0
			|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
			|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
			|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|					КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
			|						ТОГДА 0
			|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ТОГДА СписокНачислений.Показатель3
			|					КОГДА СписокНачислений.Валюта3 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|						ТОГДА СписокНачислений.Показатель3
			|					ИНАЧЕ СписокНачислений.Показатель3 * ЕСТЬNULL(Валюты3.Курс / Валюты3.Кратность, 0)
			|				КОНЕЦ
			|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 4
			|			ТОГДА ВЫБОР
			|					КОГДА ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
			|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель4
			|					КОГДА СписокНачислений.Показатель4 = 0
			|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
			|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
			|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|					КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
			|						ТОГДА 0
			|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ТОГДА СписокНачислений.Показатель4
			|					КОГДА СписокНачислений.Валюта4 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|						ТОГДА СписокНачислений.Показатель4
			|					ИНАЧЕ СписокНачислений.Показатель4 * ЕСТЬNULL(Валюты4.Курс / Валюты4.Кратность, 0)
			|				КОНЕЦ
			|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 5
			|			ТОГДА ВЫБОР
			|					КОГДА ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
			|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель5
			|					КОГДА СписокНачислений.Показатель5 = 0
			|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
			|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
			|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|					КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
			|						ТОГДА 0
			|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ТОГДА СписокНачислений.Показатель5
			|					КОГДА СписокНачислений.Валюта5 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|						ТОГДА СписокНачислений.Показатель5
			|					ИНАЧЕ СписокНачислений.Показатель5 * ЕСТЬNULL(Валюты5.Курс / Валюты5.Кратность, 0)
			|				КОНЕЦ
			|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 6
			|			ТОГДА ВЫБОР
			|					КОГДА ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
			|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель6
			|					КОГДА СписокНачислений.Показатель6 = 0
			|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
			|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
			|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|					КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
			|						ТОГДА 0
			|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ТОГДА СписокНачислений.Показатель6
			|					КОГДА СписокНачислений.Валюта6 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|						ТОГДА СписокНачислений.Показатель6
			|					ИНАЧЕ СписокНачислений.Показатель6 * ЕСТЬNULL(Валюты6.Курс / Валюты6.Кратность, 0)
			|				КОНЕЦ
			|		ИНАЧЕ 0
			|	КОНЕЦ КАК ОкладТариф,
			|	СписокНачислений.ТабНомер,
			|	СписокНачислений.ПериодЗавершения,
			|	СписокНачислений.Показатель1ВВалюте"
			
			//Аверсон ЕАЕ 07.03.2022 СВФР-008825
			+ ?(Организация.ИНН = "100071565", ",
			|   СписокНачислений.СовмещаемаяПрофессия", "") + "
			//Аверсон СВФР-008825
			
			|ПОМЕСТИТЬ ВТРаботникиИНачисленияПоСхемамМотивации
			|ИЗ
			|	ВТРаботникиИНачисления КАК СписокНачислений
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказатели КАК ПоказателиВведенныеПриРасчете
			|		ПО СписокНачислений.ВидРасчета = ПоказателиВведенныеПриРасчете.ВидРасчета
			|			И (СписокНачислений.Сотрудник = ПоказателиВведенныеПриРасчете.Сотрудник
			|				ИЛИ СписокНачислений.ПодразделениеОрганизации = ПоказателиВведенныеПриРасчете.ПодразделениеОрганизации)
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
			|			НеВводимыеПоказатели.Ссылка КАК Ссылка,
			|			НеВводимыеПоказатели.НомерСтроки КАК НомерСтроки,
			|			НеВводимыеПоказатели.Показатель КАК Показатель,
			|			НеВводимыеПоказатели.ПоказательВозможностьИзменения КАК ПоказательВозможностьИзменения,
			|			НеВводимыеПоказатели.ЭтоТарифнаяСтавка КАК ЭтоТарифнаяСтавка,
			|			СУММА(ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя) КАК ЗначениеПоказателя,
			|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник КАК Сотрудник,
			|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период,
			|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники КАК ПериодРаботники
			|		ИЗ
			|			ВТНеЗапрашиваемыеПриКадровыхПеремещениях КАК НеВводимыеПоказатели
			|				ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
			|				ПО НеВводимыеПоказатели.Показатель = ЗначенияВводимыхКадровыхПоказателей.Показатель
			|		ГДЕ
			|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
			|		
			|		СГРУППИРОВАТЬ ПО
			|			НеВводимыеПоказатели.Ссылка,
			|			НеВводимыеПоказатели.НомерСтроки,
			|			НеВводимыеПоказатели.Показатель,
			|			НеВводимыеПоказатели.ПоказательВозможностьИзменения,
			|			НеВводимыеПоказатели.ЭтоТарифнаяСтавка,
			|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник,
			|			ЗначенияВводимыхКадровыхПоказателей.Период,
			|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники) КАК ЗначенияВводимыхКадровыхПоказателей
			|		ПО СписокНачислений.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
			|			И (КОНЕЦПЕРИОДА(СписокНачислений.Период, МЕСЯЦ) = КОНЕЦПЕРИОДА(ЗначенияВводимыхКадровыхПоказателей.Период, МЕСЯЦ))
			|			И СписокНачислений.ПериодРаботники = ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники
			|			И СписокНачислений.ВидРасчета = ЗначенияВводимыхКадровыхПоказателей.Ссылка
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты1
			|		ПО (Валюты1.Период = &парамДатаВалютногоУчета)
			|			И СписокНачислений.Валюта1 = Валюты1.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты2
			|		ПО (Валюты2.Период = &парамДатаВалютногоУчета)
			|			И СписокНачислений.Валюта2 = Валюты2.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты3
			|		ПО (Валюты3.Период = &парамДатаВалютногоУчета)
			|			И СписокНачислений.Валюта3 = Валюты3.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты4
			|		ПО (Валюты4.Период = &парамДатаВалютногоУчета)
			|			И СписокНачислений.Валюта4 = Валюты4.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты5
			|		ПО (Валюты5.Период = &парамДатаВалютногоУчета)
			|			И СписокНачислений.Валюта5 = Валюты5.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты6
			|		ПО (Валюты6.Период = &парамДатаВалютногоУчета)
			|			И СписокНачислений.Валюта6 = Валюты6.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТВводимыеВПлановыхНачисленияхПоказатели КАК ПоказательТарифнойСтавки
			|		ПО СписокНачислений.ВидРасчета = ПоказательТарифнойСтавки.Ссылка
			|			И (ПоказательТарифнойСтавки.Показатель В (ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная), ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая), ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)))
			|ГДЕ
			|	ВЫБОР
			|			КОГДА СписокНачислений.Подходит
			|				ТОГДА НЕ СписокНачислений.ВидРасчета ЕСТЬ NULL 
			|			ИНАЧЕ ИСТИНА
			|		КОНЕЦ
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
			Запрос.Выполнить();
			//Островская Татьяна 22.01.2014 № 17057
			//Основной текст запроса
			//Островская Татьяна 24.07.2013 № 16643(*12)
			//Островская Татьяна 22.01.2014 № 17057
			ОсновнойТекстЗапроса = 
			"ВЫБРАТЬ
			|	СписокНачислений.Сотрудник КАК Сотрудник,
			|	СписокНачислений.СотрудникНаименование КАК СотрудникНаименование,
			|	СписокНачислений.Физлицо КАК Физлицо,
			|	СписокНачислений.ПодразделениеОрганизации,
			|   СписокНачислений.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	СписокНачислений.Подходит,
			|	СписокНачислений.Период,
			|	СписокНачислений.ПериодРаботники КАК ПериодРаботники,
			|	СписокНачислений.ПериодНачисления КАК ПериодНачисления,
			|	СписокНачислений.ОсновноеНачисление КАК ОсновноеНачисление,
			|	СписокНачислений.ВидРасчета КАК ВидРасчета,
			|	СписокНачислений.ВидРасчетаНаименование,
			|	ЕСТЬNULL(СписокНачислений.ВидРасчетаТребуетВводаТарифногоРазряда, ЛОЖЬ) КАК ТребуетВводаТарифногоРазряда,
			|	СписокНачислений.СпособРасчета,
			|	СписокНачислений.ВидВремени,
			|	СписокНачислений.Действие,
			|	СписокНачислений.КодВычета,
			|	СписокНачислений.ДатаНачалаСобытия,
			|	СписокНачислений.ГрафикРаботы,
			|	СписокНачислений.СуммированныйУчетРабочегоВремени,
			|	СписокНачислений.Валюта,
			|	СписокНачислений.КурсВалюты,
			|	СписокНачислений.ВидТарифнойСтавки,
			|	СписокНачислений.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
			|	ВЫБОР
			|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
			|			ТОГДА СписокНачислений.ОкладТариф
			|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
			|			ТОГДА ВЫРАЗИТЬ(ВЫБОР
			|						КОГДА ЕСТЬNULL(ВариантыВстроенныхАлгоритмовРасчетаЗарплаты.ПорядокПересчетаМесячнойСтавкиВЧасовую, ЗНАЧЕНИЕ(Перечисление.ПорядкиПересчетаМесячнойСтавкиВЧасовую.ПоСреднемуКоличествуЧасовВМесяце)) = ЗНАЧЕНИЕ(Перечисление.ПорядкиПересчетаМесячнойСтавкиВЧасовую.ПоСреднемуКоличествуЧасовВМесяце)
			|							ТОГДА ВЫБОР
			|									КОГДА ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоРабочихДней, 0) = 0
			|										ТОГДА 0
			|									КОГДА СписокНачислений.ДлительностьРабочейНедели = 0
			|										ТОГДА 0
			|									ИНАЧЕ СписокНачислений.ОкладТариф / (СписокНачислений.ДлительностьРабочейНедели / 5 * (ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоРабочихДней, 0) + ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоПредпраздничныхДней, 0)) - ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоПредпраздничныхДней, 0)) * 12
			|								КОНЕЦ
			|						КОГДА ВЫБОР
			|								КОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
			|									ТОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц
			|								КОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
			|									ТОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц
			|								ИНАЧЕ ЕСТЬNULL(НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц, 0)
			|							КОНЕЦ = 0
			|							ТОГДА 0
			|						ИНАЧЕ СписокНачислений.ОкладТариф / ВЫБОР
			|								КОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
			|									ТОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц
			|								КОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
			|									ТОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц
			|								ИНАЧЕ ЕСТЬNULL(НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц, 0)
			|							КОНЕЦ
			|					КОНЕЦ КАК ЧИСЛО(15, 3))
			|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
			|			ТОГДА ВЫРАЗИТЬ(ВЫБОР
			|						КОГДА СписокНачислений.ДлительностьРабочейНедели = 0
			|							ТОГДА 0
			|						ИНАЧЕ СписокНачислений.ОкладТариф / СписокНачислений.ДлительностьРабочейНедели * ВЫБОР
			|								КОГДА СписокНачислений.ВидГрафика = ЗНАЧЕНИЕ(Перечисление.ВидыРабочихГрафиков.Шестидневка)
			|									ТОГДА 6
			|								ИНАЧЕ 5
			|							КОНЕЦ
			|					КОНЕЦ КАК ЧИСЛО(15, 3))
			|		ИНАЧЕ 0
			|	КОНЕЦ КАК ЧасоваяТарифнаяСтавка,
			|	СписокНачислений.Показатель1,
			|	СписокНачислений.Показатель2,
			|	СписокНачислений.Показатель3,
			|	СписокНачислений.Показатель4,
			|	СписокНачислений.Показатель5,
			|	СписокНачислений.Показатель6,
			|	СведенияОСтажеРаботыНаСевере.ДатаРегистрацииСеверногоСтажа,
			|	СведенияОСтажеРаботыНаСевере.ПорядокНачисленияСеверныхНадбавок,
			|	СведенияОСтажеРаботыНаСевере.НачальныйПроцентСевернойНадбавки,
			|	СведенияОСтажеРаботыНаСевере.СеверныйСтажМесяцев,
			|	СведенияОСтажеРаботыНаСевере.СеверныйСтажДней,
			|	ШкалаКоэффициентовСтажа.Величина КАК КоэффициентСтажа,
			|	ШкалаСледКоэффициентовСтажа.Величина КАК СледКоэффициентСтажа,
			|	ВЫБОР
			|		КОГДА НЕ ШкалаСледКоэффициентовСтажа.Величина ЕСТЬ NULL 
			|			ТОГДА ВЫБОР
			|					КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > Стажи.РазмерДней
			|						ТОГДА ДЕНЬ(Стажи.ДатаОтсчета) - Стажи.РазмерДней
			|					ИНАЧЕ ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, -1)) - (Стажи.РазмерДней - ДЕНЬ(Стажи.ДатаОтсчета))
			|				КОНЕЦ
			|	КОНЕЦ КАК ДеньСменыКоэффициентаСтажа,
			|	ВЫБОР
			|		КОГДА &ЭтоПерерасчет
			|			ТОГДА ЛОЖЬ
			|		КОГДА ОсновныеНачисления.Сотрудник ЕСТЬ NULL 
			|			ТОГДА ЛОЖЬ
			|		ИНАЧЕ ИСТИНА
			|	КОНЕЦ КАК УжеПроведен,
			|	НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник КАК Сотрудник1,
			|	НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц,
			|	НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник КАК Сотрудник2,
			|	НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц КАК ЧасовЗаМесяц1,
			|	НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц КАК ЧасовЗаМесяц2,
			|	СписокНачислений.ТабНомер КАК ТабНомер,
			|	СписокНачислений.ПериодЗавершения,
			|	СписокНачислений.Показатель1ВВалюте как ПоказательВВалюте"
			
			//Аверсон ЕАЕ 07.03.2022 СВФР-008825
			+ ?(Организация.ИНН = "100071565", ",
			|   СписокНачислений.СовмещаемаяПрофессия", "") + "
			//Аверсон СВФР-008825
			
			|ИЗ
			|	ВТРаботникиИНачисленияПоСхемамМотивации КАК СписокНачислений
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОСеверномСтаже КАК СведенияОСтажеРаботыНаСевере
			|		ПО СписокНачислений.Сотрудник = СведенияОСтажеРаботыНаСевере.Сотрудник
			|			И СписокНачислений.ПериодРаботники = СведенияОСтажеРаботыНаСевере.ПериодРаботники
			|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ФизическиеЛица.Стажи КАК Стажи
			|		ПО СписокНачислений.ВидРасчетаВидСтажа = Стажи.ВидСтажа
			|			И СписокНачислений.Физлицо = Стажи.Ссылка
			|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаКоэффициентовСтажа
			|		ПО СписокНачислений.ВидРасчетаКоэффициентСтажа = ШкалаКоэффициентовСтажа.КоэффициентСтажа
			|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
			|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
			|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ >= ШкалаКоэффициентовСтажа.СтажС * &Месяцы)
			|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
			|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ < ВЫБОР
			|				КОГДА ШкалаКоэффициентовСтажа.СтажПо = 0
			|					ТОГДА 999999
			|				ИНАЧЕ ШкалаКоэффициентовСтажа.СтажПо * &Месяцы
			|			КОНЕЦ)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаСледКоэффициентовСтажа
			|		ПО СписокНачислений.ВидРасчетаКоэффициентСтажа = ШкалаСледКоэффициентовСтажа.КоэффициентСтажа
			|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
			|			И (ШкалаСледКоэффициентовСтажа.НомерСтрокиШкалы = ШкалаКоэффициентовСтажа.НомерСтрокиШкалы + 1)
			|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
			|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) >= ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
			|					ТОГДА 1
			|				ИНАЧЕ 0
			|			КОНЕЦ = ШкалаКоэффициентовСтажа.СтажПо * &Месяцы - 1)
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			СУММА(ВЫБОР
			|					КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Рабочий)
			|						ТОГДА 1
			|					ИНАЧЕ 0
			|				КОНЕЦ) КАК ЧислоРабочихДней,
			|			СУММА(ВЫБОР
			|					КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Предпраздничный)
			|						ТОГДА 1
			|					ИНАЧЕ 0
			|				КОНЕЦ) КАК ЧислоПредпраздничныхДней
			|		ИЗ
			|			РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
			|		ГДЕ
			|			РегламентированныйПроизводственныйКалендарь.Год = &Год) КАК ДанныеПроизводственногоКалендаря
			|		ПО (ИСТИНА)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоСводнымИндивидуальнымГрафикам КАК НормаВремениПоСводнымИндивидуальнымГрафикам
			|		ПО СписокНачислений.Сотрудник = НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоЕжедневнымИндивидуальнымГрафикам КАК НормаВремениПоЕжедневнымИндивидуальнымГрафикам
			|		ПО СписокНачислений.Сотрудник = НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоОбщимГрафикам КАК НормаВремениПоОбщимГрафикам
			|		ПО СписокНачислений.Сотрудник = НормаВремениПоОбщимГрафикам.Сотрудник
			|		И СписокНачислений.ПодразделениеОрганизации = НормаВремениПоОбщимГрафикам.ПодразделениеОрганизации //О.Т. Аверсон 14.06.2018 № 
			
			//Аверсон ЕАЕ 21.03.2022 СВФР-008825
			//|		И СписокНачислений.ГрафикРаботы = НормаВремениПоОбщимГрафикам.ГрафикРаботы
			//Аверсон СВФР-008825
			
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ВариантыВстроенныхАлгоритмовРасчетаЗарплаты КАК ВариантыВстроенныхАлгоритмовРасчетаЗарплаты
			|		ПО (ИСТИНА)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОсновныеНачисления КАК ОсновныеНачисления
			|		ПО СписокНачислений.Сотрудник = ОсновныеНачисления.Сотрудник
			|			И СписокНачислений.ПодразделениеОрганизации = ОсновныеНачисления.ПодразделениеОрганизации";
			//О.Т. Аверсон 11.06.2018 № 2060
			Если Организация.НачислениеЕжемесячныхПособийОтдельнымДок Тогда 
				ОсновнойТекстЗапроса = ОсновнойТекстЗапроса +"
				|		ГДЕ
				|		НЕ СписокНачислений.ВидРасчета В (&ДетскиеПособияИскл)";
			КонецЕсли;
			ОсновнойТекстЗапроса = ОсновнойТекстЗапроса +"
			//О.Т. Аверсон 11.06.2018 № 2060			
			|
			|УПОРЯДОЧИТЬ ПО
			|	ТабНомер,
			|	СотрудникНаименование,
			|	Сотрудник,
			|	ПериодРаботники,
			|	ПериодНачисления,
			|	ОсновноеНачисление УБЫВ,
			|	ВидРасчета";
			//Островская Татьяна 22.01.2014 № 17057
			Запрос.УстановитьПараметр("Месяцы",?(Организация.ИНН = "100765738",12,1));
			//Островская Татьяна 24.07.2013 № 16(*12)
			Запрос.Текст = ОсновнойТекстЗапроса;
			РезультатЗапроса = Запрос.Выполнить(); 
			НачисленияВыборка = РезультатЗапроса.Выбрать();
			
			Если не ТЧДоговора Тогда 			
				ТЗНачисления = СформироватьТаблицуНачислений(НачисленияВыборка, ОкончаниеПериодаЗаполнения, РезультатЗапроса.Выгрузить(),,ТЧРаботавшиеВПраздники);
				
				Если НЕ Организация.ИНН = "100074549"  //Аверсон 11.06.2021 КВВ СВФР-007690 (Элема)
					
					И НЕ РазбиватьПериодыПоНазначениюБригады Тогда //СВЭЙ 12.06.2024 КВВ СВФР-013243
					
					//+ СВЭЙ КДЯ 03.01.20 СВФР-005236
					ОбъединитьПересекающиесяДиапазоныНачислений( ТЗНачисления );
					//- СВЭЙ КДЯ 03.01.20 СВФР-005236
				КонецЕсли;
			иначе
				ТЗНачисления = Новый ТаблицаЗначений;//О.Т. Аверсон 16.03.2018 № 1731
			КонецЕсли;
			
			
			//Аверсон-софт, Островская Татьяна 11.06.2012 № 15477
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			//+ СВЭЙ КДЯ 03.03.20 СВФР-005593
			|	ДополнительныеНачисленияРаботниковОрганизаций.Физлицо,
			//- СВЭЙ КДЯ 03.03.20 СВФР-005593
			|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
			|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
			|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
			|	ДополнительныеНачисленияРаботниковОрганизаций.Показатель1,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации
			|ИЗ
			|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|ГДЕ
			|	ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации2
			|	И ТИПЗНАЧЕНИЯ(ДополнительныеНачисленияРаботниковОрганизаций.Регистратор) <> &ДокНачисление
			|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник В
			|			(ВЫБРАТЬ
			|				ВТСписокРаботников.Сотрудник
			|			ИЗ
			|				ВТСписокРаботников КАК ВТСписокРаботников)
			//|	//И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации
			|
			|СГРУППИРОВАТЬ ПО
			|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			//+ СВЭЙ КДЯ 03.03.20 СВФР-005593
			|	ДополнительныеНачисленияРаботниковОрганизаций.Физлицо,
			//- СВЭЙ КДЯ 03.03.20 СВФР-005593
			|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
			|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
			|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
			|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
			|	ДополнительныеНачисленияРаботниковОрганизаций.Показатель1,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации";
			Запрос.УстановитьПараметр("ПериодРегистрации", НачалоПериодаЗаполнения);
			Запрос.УстановитьПараметр("ПериодРегистрации2", ОкончаниеПериодаЗаполнения);
			Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
			Запрос.УстановитьПараметр("ДокНачисление", ТипЗнч(ЭтотОбъект.Ссылка));
			//О.Т. 01.07.2014
			//если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			//	Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации",
			//	"И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации");
			//иначе
			//	Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации",
			//	"");				
			//КонецЕсли;
			//О.Т. 01.07.2014
			
			ДопРезультат = Запрос.Выполнить().Выбрать();
			
			//Аверсон ЕАЕ 04.06.2021 СВФР-007660
			//СтруктураПериоды = Новый Структура;
			//СтруктураПериоды.Вставить("ДатаНачала");
			//СтруктураПериоды.Вставить("ДатаОкончания");
			//Если ТЗНачисления.Количество() > 0 Тогда
			//	СтруктураПериоды.ДатаНачала = ТЗНачисления[0].ДатаНачала;
			//	СтруктураПериоды.ДатаОкончания = ТЗНачисления[0].ДатаОкончания;
			//КонецЕсли;
			
			Если Не ТЧДоговора Тогда
				//Аверсон ЕАЕ 07.07.2021 б/н
				//КолонкиСтр = "Сотрудник,ПодразделениеОрганизации,ДатаНачала,ДатаОкончания";
				КолонкиСтр = "Сотрудник,ДатаНачала,ДатаОкончания";
				//Аверсон б/н
				ТЗНачисленияПериоды = ТЗНачисления.Скопировать(, КолонкиСтр);
				ТЗНачисленияПериоды.Свернуть(КолонкиСтр);
				//Аверсон ЕАЕ 01.07.2021 СВФР-007796
			Иначе
				ТЗНачисленияПериоды = Неопределено;
			КонецЕсли;
			//Аверсон СВФР-007796
			
			//ТЗДопНачисления = СформироватьТаблицуДополнитНачисления(ДопРезультат, ОкончаниеПериодаЗаполнения);
			ТЗДопНачисления = СформироватьТаблицуДополнитНачисления(ДопРезультат, ОкончаниеПериодаЗаполнения, ТЗНачисленияПериоды);				
			//Аверсон СВФР-007660
			
			РаботникиДляРасчетаНДФЛ = Новый Соответствие;
			РаботникиДляРасчетаПенсионного = Новый Соответствие;
			
			//+ СВЭЙ КДЯ 03.03.20 СВФР-005593
			ДопРезультат.Сбросить();
			Пока ДопРезультат.Следующий() Цикл
				РаботникиДляРасчетаНДФЛ.Вставить(ДопРезультат.Физлицо, 0);
				РаботникиДляРасчетаПенсионного.Вставить(ДопРезультат.Физлицо, 0);
			КонецЦикла;
			//- СВЭЙ КДЯ 03.03.20 СВФР-005593
			//ПСА 28.01.2021 СВФР-007124 +++
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	ОсновныеНачисленияРаботниковОрганизаций.Физлицо
			|ИЗ
			|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			|ГДЕ
			|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации2
			|	И ТИПЗНАЧЕНИЯ(ОсновныеНачисленияРаботниковОрганизаций.Регистратор) <> &ДокНачисление
			|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В
			|			(ВЫБРАТЬ
			|				ВТСписокРаботников.Сотрудник
			|			ИЗ
			|				ВТСписокРаботников КАК ВТСписокРаботников)
			|
			|СГРУППИРОВАТЬ ПО
			|	ОсновныеНачисленияРаботниковОрганизаций.Физлицо";
			Запрос.УстановитьПараметр("ПериодРегистрации", НачалоПериодаЗаполнения);
			Запрос.УстановитьПараметр("ПериодРегистрации2", ОкончаниеПериодаЗаполнения);
			Запрос.УстановитьПараметр("ДокНачисление", ТипЗнч(ЭтотОбъект.Ссылка));
			ОснРезультат = Запрос.Выполнить().Выбрать();
			Пока ОснРезультат.Следующий() Цикл
				РаботникиДляРасчетаНДФЛ.Вставить(ОснРезультат.Физлицо, 0);
				РаботникиДляРасчетаПенсионного.Вставить(ОснРезультат.Физлицо, 0);
			КонецЦикла;
			//+++ПСА 28.01.2021 СВФР-007124 
			СтрокаПолейДополнительныхНачислений = Неопределено;
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			Если не ТЧДоговора Тогда 
				Для Каждого НачислениеИзТаблицыЗначений Из ТЗДопНачисления Цикл
					//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
					если НачислениеИзТаблицыЗначений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом Тогда 
						//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
						
						НоваяСтрока	=	ДополнительныеНачисления.Добавить();
						НоваяСтрока.Авторасчет		= Истина;
						ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейДополнительныхНачислений); //Сотрудник,ВидРасчета,Размер,КодВычета,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
						НоваяСтрока.ДатаНачалаСобытия = НачислениеИзТаблицыЗначений.ДатаНачала;
						НоваяСтрока.ПериодРасчетаСреднегоЗаработкаНачало = НачислениеИзТаблицыЗначений.ДатаНачала;
						НоваяСтрока.ПериодРасчетаСреднегоЗаработкаОкончание = НачислениеИзТаблицыЗначений.ДатаОкончания;
						
						мСведенияОВидахРасчета = Новый Соответствие;
						мСведенияОВидахРасчета.Вставить("ОкладПоДням",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
						мСведенияОВидахРасчета.Вставить("ОкладПоЧасам",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
						мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасы",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
						мСведенияОВидахРасчета.Вставить("ДоплатаЗаРазъезднойХарактерРаботы",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Доплата за разъездной характер работы"));
						мСведенияОВидахРасчета.Вставить("Месячная",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Месячная"));
						//О.Т. Аверсон 03.04.2016 № 981
						Запрос1 = Новый Запрос;
						Запрос1.Текст = 
						"ВЫБРАТЬ
						|	ОсновныеНачисленияОрганизаций.Ссылка
						|ИЗ
						|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
						|ГДЕ
						|	ОсновныеНачисленияОрганизаций.СпособРасчета = &СпособРасчета";			
						Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);
						РезультатЗапроса = Запрос1.Выполнить().Выбрать();
						Если РезультатЗапроса.Следующий() Тогда 
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТариф",РезультатЗапроса.Ссылка);
						КонецЕсли;
						Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);
						РезультатЗапроса = Запрос1.Выполнить().Выбрать();
						Если РезультатЗапроса.Следующий() Тогда 
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТарифИнстр",РезультатЗапроса.Ссылка);
						КонецЕсли;
						//О.Т. Аверсон 03.04.2016 № 981
						
						СведенияОВидеРасчета = ПроведениеРасчетов.ПолучитьСведенияОВидеРасчета(мСведенияОВидахРасчета, НачислениеИзТаблицыЗначений.ВидРасчета);
						КодВычета = СведенияОВидеРасчета.КодДоходаНДФЛ.КодВычета;
						Если КодВычета = Неопределено или КодВычета.Наименование = "" Тогда
							
							НоваяСтрока.КодВычета = "";
						Иначе
							НоваяСтрока.КодВычета = КодВычета;
						КонецЕсли;
					КонецЕсли;
					ОбработкаПрерыванияПользователя();
				КонецЦикла;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 11.06.2012 № 15477
			
			
			// для заполнения табличной части НДФЛ
			
			//+ СВЭЙ КДЯ 03.03.20 СВФР-005593
			//РаботникиДляРасчетаНДФЛ = Новый Соответствие;
			//РаботникиДляРасчетаПенсионного = Новый Соответствие;
			//- СВЭЙ КДЯ 03.03.20 СВФР-005593
			
			
			ТипОсновныхНачислений = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций");
			
			НаборЗаписейДляПроверки = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.СоздатьНаборЗаписей();
			
			НаборЗаписейДляПроверки.Отбор.Регистратор.Значение = СcылкаОбъекта;
			
			СтрокаПолейОсновныхНачислений = "Сотрудник,Физлицо,ВидРасчета,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации,ОтработаноЧасов,ОтработаноДней,ОплаченоДней,ОплаченоДнейЧасов";//О.Т. 22.04.2015 № 422
			СтрокаПолейДополнительныхНачислений = "Сотрудник,Физлицо,ВидРасчета,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,,КодВычета,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации";
			Для Каждого НачислениеИзТаблицыЗначений Из ТЗНачисления Цикл
				
				РаботникиДляРасчетаНДФЛ.Вставить(НачислениеИзТаблицыЗначений.Физлицо, 0);
				РаботникиДляРасчетаПенсионного.Вставить(НачислениеИзТаблицыЗначений.Физлицо, 0);
				
				
				Если ВидОперации <> Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ 
					ИЛИ ВидОперации <> Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
					
					Если ТипЗнч(НачислениеИзТаблицыЗначений.ВидРасчета)	= ТипОсновныхНачислений Тогда
						
						//О.Т. Аверсон 14.08.2017 № 926
						Если НачислениеИзТаблицыЗначений.ДатаОкончания < НачислениеИзТаблицыЗначений.ДатаНачала  Тогда 
							Сообщить("Проверьте плановые начисления по сотруднику "+НачислениеИзТаблицыЗначений.Сотрудник.Наименование);
							Продолжить;
						КонецЕсли;
						//О.Т. Аверсон 14.08.2017 № 926
						
						НоваяСтрока	=	Начисления.Добавить();
						ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейОсновныхНачислений); //Сотрудник,ВидРасчета,Размер,Показатель2,Показатель3,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
						
						//заявка №1604 (база заявок Кристалла) Дмитрук О.Г.
						ВыборкаКорректировки = СформироватьЗапросПоКорректировкеПремии(НачислениеИзТаблицыЗначений.Сотрудник, НачислениеИзТаблицыЗначений.ВидРасчета, НачислениеИзТаблицыЗначений.ДатаНачала, НачислениеИзТаблицыЗначений.ДатаОкончания).Выбрать();
						Если ВыборкаКорректировки.Следующий() Тогда
							НоваяСтрока.Показатель1 = ВыборкаКорректировки.Процент;
						КонецЕсли;
						
						//заявка №1604
						
						НоваяСтрока.Авторасчет			= Истина;
						НоваяСтрока.ДатаНачалаСобытия	= ?(ЗначениеЗаполнено(НачислениеИзТаблицыЗначений.ДатаНачалаСобытия),НачислениеИзТаблицыЗначений.ДатаНачалаСобытия,НачислениеИзТаблицыЗначений.ДатаНачала);
						//Если НоваяСтрока.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеПоУходуЗаРебенкомДо1_5Лет Тогда
						//	НоваяСтрока.ПериодРасчетаСреднегоЗаработкаНачало = ДобавитьМесяц(НачалоМесяца(НоваяСтрока.ДатаНачалаСобытия), -12);	
						//	НоваяСтрока.ПериодРасчетаСреднегоЗаработкаОкончание = НачалоМесяца(НоваяСтрока.ДатаНачалаСобытия) - 1;	
						//КонецЕсли;
						
						Движение = НаборЗаписейДляПроверки.Добавить();
						
						// свойства
						Движение.ПериодРегистрации		= ПериодРегистрации;
						Движение.ВидРасчета				= НачислениеИзТаблицыЗначений.ВидРасчета;
						Движение.ПериодДействияНачало	= НачислениеИзТаблицыЗначений.ДатаНачала;
						Движение.ПериодДействияКонец	= НачислениеИзТаблицыЗначений.ДатаОкончания;
						
						// измерения
						Движение.Сотрудник				= НачислениеИзТаблицыЗначений.Сотрудник;
						Движение.Физлицо				= НачислениеИзТаблицыЗначений.Физлицо;
						Движение.Организация			= ГоловнаяОрганизация;
						
						// реквизиты поддержки графика
						Движение.ГрафикРаботы			= НачислениеИзТаблицыЗначений.ГрафикРаботы;
						Движение.ВидУчетаВремени		= ПроведениеРасчетов.ПолучитьВидУчетаВремени(НачислениеИзТаблицыЗначений.СпособРасчета, НачислениеИзТаблицыЗначений.ВидВремени, НачислениеИзТаблицыЗначений.СуммированныйУчетРабочегоВремени);
						Движение.ДатаНачалаСобытия		= НачислениеИзТаблицыЗначений.ДатаНачала;
						Движение.Авторасчет				= Истина;
						
					Иначе
						
						//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
						если НачислениеИзТаблицыЗначений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом Тогда 
							//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
							
							НоваяСтрока	=	ДополнительныеНачисления.Добавить();
							НоваяСтрока.Авторасчет		= Истина;
							ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейДополнительныхНачислений); //Сотрудник,ВидРасчета,Размер,КодВычета,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
							мСведенияОВидахРасчета = Новый Соответствие;
							мСведенияОВидахРасчета.Вставить("ОкладПоДням",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
							мСведенияОВидахРасчета.Вставить("ОкладПоЧасам",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасы",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаРазъезднойХарактерРаботы",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Доплата за разъездной характер работы"));
							мСведенияОВидахРасчета.Вставить("Месячная",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Месячная"));
							//О.Т. Аверсон 03.04.2016 № 981
							Запрос1 = Новый Запрос;
							Запрос1.Текст = 
							"ВЫБРАТЬ
							|	ОсновныеНачисленияОрганизаций.Ссылка
							|ИЗ
							|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
							|ГДЕ
							|	ОсновныеНачисленияОрганизаций.СпособРасчета = &СпособРасчета";			
							Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);
							РезультатЗапроса = Запрос1.Выполнить().Выбрать();
							Если РезультатЗапроса.Следующий() Тогда 
								мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТариф",РезультатЗапроса.Ссылка);
							КонецЕсли;
							Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);
							РезультатЗапроса = Запрос1.Выполнить().Выбрать();
							Если РезультатЗапроса.Следующий() Тогда 
								мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТарифИнстр",РезультатЗапроса.Ссылка);
							КонецЕсли;
							
							//О.Т. Аверсон 03.04.2016 № 981
							
							СведенияОВидеРасчета = ПроведениеРасчетов.ПолучитьСведенияОВидеРасчета(мСведенияОВидахРасчета, НачислениеИзТаблицыЗначений.ВидРасчета);
							КодВычета = СведенияОВидеРасчета.КодДоходаНДФЛ.КодВычета;
							Если КодВычета = Неопределено или КодВычета.Наименование = "" Тогда
								
								НоваяСтрока.КодВычета = "";
							Иначе
								НоваяСтрока.КодВычета = КодВычета;
							КонецЕсли;
							//Аверсон 26.02.2020 КВВ СВФР-005589 (
						ИначеЕсли НачислениеИзТаблицыЗначений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой Тогда
							НоваяСтрока	= ДополнительныеНачисления.Добавить();
							НоваяСтрока.Авторасчет = Истина;
							ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейДополнительныхНачислений);
							мСведенияОВидахРасчета = Новый Соответствие;
							мСведенияОВидахРасчета.Вставить("ОкладПоДням",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
							мСведенияОВидахРасчета.Вставить("ОкладПоЧасам",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасы",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаРазъезднойХарактерРаботы",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Доплата за разъездной характер работы"));
							мСведенияОВидахРасчета.Вставить("Месячная",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Месячная"));
							
							СведенияОВидеРасчета = ПроведениеРасчетов.ПолучитьСведенияОВидеРасчета(мСведенияОВидахРасчета, НачислениеИзТаблицыЗначений.ВидРасчета);
							КодВычета = СведенияОВидеРасчета.КодДоходаНДФЛ.КодВычета;
							Если КодВычета = Неопределено или КодВычета.Наименование = "" Тогда
								НоваяСтрока.КодВычета = "";
							Иначе
								НоваяСтрока.КодВычета = КодВычета;
							КонецЕсли;
							//Аверсон 26.02.2020 КВВ СВФР-005589 )
						КонецЕсли;
					КонецЕсли;
					
				КонецЕсли;
				ОбработкаПрерыванияПользователя();
			КонецЦикла;
			// выполним удаление строк табличной части, которые соответствуют полностью вытесняемым видам расчета
			// проверку выполним через фактический период действия
			Если ВидОперации <> Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ 
				ИЛИ ВидОперации <> Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
				
				НачатьТранзакцию();
				
				НаборЗаписейДляПроверки.Записать();
				
				ЗапросПроверки = Новый Запрос(
				"ВЫБРАТЬ
				|	ОсновныеНачисленияРаботниковОрганизации.НомерСтроки КАК НомерСтроки
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(Регистратор = &парамСсылка) КАК ОсновныеНачисленияРаботниковОрганизацииФактическийПериодДействия
				|		ПО ОсновныеНачисленияРаботниковОрганизации.НомерСтроки = ОсновныеНачисленияРаботниковОрганизацииФактическийПериодДействия.НомерСтроки
				|			И ОсновныеНачисленияРаботниковОрганизации.Регистратор = ОсновныеНачисленияРаботниковОрганизацииФактическийПериодДействия.Регистратор
				|ГДЕ
				|	ОсновныеНачисленияРаботниковОрганизации.Регистратор = &парамСсылка
				|	И ОсновныеНачисленияРаботниковОрганизацииФактическийПериодДействия.Регистратор ЕСТЬ NULL 
				|
				|УПОРЯДОЧИТЬ ПО
				|	НомерСтроки УБЫВ");
				
				ЗапросПроверки.УстановитьПараметр("парамСсылка", СcылкаОбъекта);
				СтрокиКУдалению = ЗапросПроверки.Выполнить().Выгрузить();
				// удалим проверочный набор записей
				НаборЗаписейДляПроверки.Очистить();
				НаборЗаписейДляПроверки.Записать();
				
				ЗафиксироватьТранзакцию();
				
				Для Каждого СтрокаТЗ Из СтрокиКУдалению Цикл
					Начисления.Удалить(СтрокаТЗ.НомерСтроки - 1);
				КонецЦикла;
				
			КонецЕсли;
			// конец удаления строк табличной части, которые соответствуют полностью вытесняемым видам расчета
			
			// работающие по договорам подряда
			ОсновнойТекстЗапроса =
			"ВЫБРАТЬ
			|	СписокНачислений.Сотрудник КАК Сотрудник,
			|	СписокНачислений.СотрудникФизлицо КАК Физлицо,
			|	СписокНачислений.СотрудникНаименование КАК СотрудникНаименование,
			|	СписокНачислений.ВидРасчета КАК ВидРасчета,
			|	СписокНачислений.ПериодНачисления КАК ДатаНачала,
			|	ЕСТЬNULL(СписокНачислений.ДатаОкончания, &парамКонец) КАК ДатаОкончания,
			|	СписокНачислений.ДокументОснование КАК ДокументОснование,
			|	СписокНачислений.Подходит,
			|	СписокНачислений.ВидРасчета.Наименование КАК ВидРасчетаНаименование,
			|	СписокНачислений.ДокументОснование.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			|	СписокНачислений.ДокументОснование.КодВычета КАК КодВычета,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель1
			|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
			|	КОНЕЦ КАК Размер,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель1
			|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
			|	КОНЕЦ КАК Результат,
			|	ВЫБОР
			|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
			|			ТОГДА 0
			|		КОГДА СписокНачислений.ДокументОснование.КодВычета <> ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код405)
			|			ТОГДА 0
			|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА СписокНачислений.Показатель1 * ЕСТЬNULL(СведенияОСкидках.НормативЗатрат, 0) / 100
			|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0) * ЕСТЬNULL(СведенияОСкидках.НормативЗатрат, 0) / 100
			|	КОНЕЦ КАК СуммаВычета
			|ИЗ
			|	(ВЫБРАТЬ
			|		Работники.Сотрудник КАК Сотрудник,
			|		Работники.Сотрудник.Физлицо КАК СотрудникФизлицо,
			|		Работники.Сотрудник.Наименование КАК СотрудникНаименование,
			|		НачисленияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
			|		НачисленияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
			|		Работники.Подходит КАК Подходит,
			|		НачисленияРаботниковОрганизации.Период КАК ПериодНачисления,
			|		МИНИМУМ(ДатыОкончанияНачисленияРаботниковОрганизации.ДатаОкончания) КАК ДатаОкончания,
			|		НачисленияРаботниковОрганизации.Показатель1 КАК Показатель1,
			|		НачисленияРаботниковОрганизации.Валюта1 КАК Валюта1
			|	ИЗ
			|		ВТДвиженияРаботников КАК Работники
			|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|				&парамНачало КАК Период,
			|				НачисленияРаботниковОрганизации.ВидРасчетаИзмерение КАК ВидРасчета,
			|				ВЫБОР
			|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|						ТОГДА НачисленияРаботниковОрганизации.Показатель1Завершения
			|					ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
			|				КОНЕЦ КАК Показатель1,
			|				ВЫБОР
			|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|						ТОГДА НачисленияРаботниковОрганизации.Валюта1Завершения
			|					ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
			|				КОНЕЦ КАК Валюта1,
			|				НачисленияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
			|				НачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник
			|			ИЗ
			|				РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
			|						&парамНачало,
			|						ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|							И Сотрудник В
			|								(ВЫБРАТЬ РАЗЛИЧНЫЕ
			|									ДвиженияРаботников.Сотрудник
			|								ИЗ
			|									ВТСписокРаботников КАК ДвиженияРаботников)) КАК НачисленияРаботниковОрганизации
			|			ГДЕ
			|				ВЫБОР
			|						КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|								И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|							ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
			|						ИНАЧЕ НачисленияРаботниковОрганизации.Действие
			|					КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|			
			|			ОБЪЕДИНИТЬ ВСЕ
			|			
			|			ВЫБРАТЬ
			|				НачисленияРаботниковОрганизации.Период,
			|				НачисленияРаботниковОрганизации.ВидРасчетаИзмерение,
			|				НачисленияРаботниковОрганизации.Показатель1,
			|				НачисленияРаботниковОрганизации.Валюта1,
			|				НачисленияРаботниковОрганизации.ДокументОснование,
			|				НачисленияРаботниковОрганизации.Сотрудник
			|			ИЗ
			|				РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
			|					ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
			|					ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
			|			ГДЕ
			|				НачисленияРаботниковОрганизации.Период > &парамНачало
			|				И НачисленияРаботниковОрганизации.Период <= &парамКонец
			|				И НачисленияРаботниковОрганизации.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|				И НачисленияРаботниковОрганизации.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|			
			|			ОБЪЕДИНИТЬ ВСЕ
			|			
			|			ВЫБРАТЬ
			|				НачисленияРаботниковОрганизации.ПериодЗавершения,
			|				НачисленияРаботниковОрганизации.ВидРасчетаИзмерение,
			|				НачисленияРаботниковОрганизации.Показатель1Завершения,
			|				НачисленияРаботниковОрганизации.Валюта1Завершения,
			|				НачисленияРаботниковОрганизации.ДокументОснование,
			|				НачисленияРаботниковОрганизации.Сотрудник
			|			ИЗ
			|				РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
			|					ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
			|					ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
			|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковПроверка
			|					ПО НачисленияРаботниковОрганизации.Сотрудник = НачисленияРаботниковПроверка.Сотрудник
			|						И НачисленияРаботниковОрганизации.ВидРасчетаИзмерение = НачисленияРаботниковПроверка.ВидРасчетаИзмерение
			|						И НачисленияРаботниковОрганизации.ДокументОснование = НачисленияРаботниковПроверка.ДокументОснование
			|						И (НачисленияРаботниковПроверка.Период > НачисленияРаботниковОрганизации.Период)
			|						И (НачисленияРаботниковПроверка.Период <= НачисленияРаботниковОрганизации.ПериодЗавершения)
			|			ГДЕ
			|				НачисленияРаботниковОрганизации.ПериодЗавершения МЕЖДУ &парамНачало И &парамКонец
			|				И НачисленияРаботниковОрганизации.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|				И НачисленияРаботниковОрганизации.ДействиеЗавершения <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|				И НачисленияРаботниковПроверка.Сотрудник ЕСТЬ NULL ) КАК НачисленияРаботниковОрганизации
			|				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					ДОБАВИТЬКДАТЕ(НачисленияРаботниковОрганизации.Период, ДЕНЬ, -1) КАК ДатаОкончания,
			|					НачисленияРаботниковОрганизации.ВидРасчетаИзмерение КАК ВидРасчетаИзмерение,
			|					НачисленияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
			|					НачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник
			|				ИЗ
			|					РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
			|						ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
			|						ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
			|				ГДЕ
			|					НачисленияРаботниковОрганизации.Период >= &парамНачало
			|					И НачисленияРаботниковОрганизации.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|					И НачисленияРаботниковОрганизации.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать)
			|				
			|				ОБЪЕДИНИТЬ ВСЕ
			|				
			|				ВЫБРАТЬ
			|					ВЫБОР
			|						КОГДА ДОБАВИТЬКДАТЕ(НачисленияРаботниковОрганизации.ПериодЗавершения, ДЕНЬ, -1) > &парамКонец
			|							ТОГДА &парамКонец
			|						ИНАЧЕ ДОБАВИТЬКДАТЕ(НачисленияРаботниковОрганизации.ПериодЗавершения, ДЕНЬ, -1)
			|					КОНЕЦ,
			|					НачисленияРаботниковОрганизации.ВидРасчетаИзмерение,
			|					НачисленияРаботниковОрганизации.ДокументОснование,
			|					НачисленияРаботниковОрганизации.Сотрудник
			|				ИЗ
			|					РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
			|						ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ТаблицаДвиженийРаботников
			|						ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
			|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковПроверка
			|						ПО НачисленияРаботниковОрганизации.Сотрудник = НачисленияРаботниковПроверка.Сотрудник
			|							И НачисленияРаботниковОрганизации.ВидРасчетаИзмерение = НачисленияРаботниковПроверка.ВидРасчетаИзмерение
			|							И НачисленияРаботниковОрганизации.ДокументОснование = НачисленияРаботниковПроверка.ДокументОснование
			|							И (НачисленияРаботниковПроверка.Период > НачисленияРаботниковОрганизации.Период)
			|							И (НачисленияРаботниковПроверка.Период <= НачисленияРаботниковОрганизации.ПериодЗавершения)
			|				ГДЕ
			|					НачисленияРаботниковОрганизации.ПериодЗавершения >= &парамНачало
			|					И НачисленияРаботниковОрганизации.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|					И НачисленияРаботниковОрганизации.ДействиеЗавершения <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать)
			|					И НачисленияРаботниковПроверка.Сотрудник ЕСТЬ NULL ) КАК ДатыОкончанияНачисленияРаботниковОрганизации
			|				ПО НачисленияРаботниковОрганизации.Сотрудник = ДатыОкончанияНачисленияРаботниковОрганизации.Сотрудник
			|					И НачисленияРаботниковОрганизации.ВидРасчета = ДатыОкончанияНачисленияРаботниковОрганизации.ВидРасчетаИзмерение
			|					И НачисленияРаботниковОрганизации.ДокументОснование = ДатыОкончанияНачисленияРаботниковОрганизации.ДокументОснование
			|					И НачисленияРаботниковОрганизации.Период <= ДатыОкончанияНачисленияРаботниковОрганизации.ДатаОкончания
			|			ПО (Работники.Подходит)
			|				И Работники.Сотрудник = НачисленияРаботниковОрганизации.Сотрудник
			|	
			|	СГРУППИРОВАТЬ ПО
			|		Работники.Сотрудник,
			|		Работники.Сотрудник.Физлицо,
			|		Работники.Сотрудник.Наименование,
			|		Работники.Подходит,
			|		НачисленияРаботниковОрганизации.ДокументОснование,
			|		НачисленияРаботниковОрганизации.ВидРасчета,
			|		НачисленияРаботниковОрганизации.Период,
			|		НачисленияРаботниковОрганизации.Показатель1,
			|		НачисленияРаботниковОрганизации.Валюта1) КАК СписокНачислений
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты1
			|		ПО (Валюты1.Период = &парамДатаВалютногоУчета)
			|			И СписокНачислений.Валюта1 = Валюты1.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
			|			ОсновныеНачисления.Сотрудник КАК Сотрудник,
			|			ОсновныеНачисления.ДокументОснование КАК ДокументОснование
			|		ИЗ
			|			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
			|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
			|				ПО ОсновныеНачисления.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
			|		ГДЕ
			|			ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
			|			И ОсновныеНачисления.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
			|			И ОсновныеНачисления.Регистратор <> &парамРегистратор
			|			И (НЕ ОсновныеНачисления.Сторно)
			|			И ОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация) КАК ОсновныеНачисления
			|		ПО СписокНачислений.Сотрудник = ОсновныеНачисления.Сотрудник
			|			И СписокНачислений.ДокументОснование = ОсновныеНачисления.ДокументОснование
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛВычетыПоДоходам.СрезПоследних(&парамНачало, ) КАК СведенияОСкидках
			|		ПО СписокНачислений.ВидРасчета.КодДоходаНДФЛ = СведенияОСкидках.КодДохода
			|ГДЕ
			|	СписокНачислений.Подходит
			|	И ВЫБОР
			|			КОГДА СписокНачислений.ДокументОснование ЕСТЬ NULL 
			|				ТОГДА ЛОЖЬ
			|			КОГДА СписокНачислений.ДокументОснование.Организация = &парамОрганизация
			|				ТОГДА ИСТИНА
			|			ИНАЧЕ ЛОЖЬ
			|		КОНЕЦ
			|	И ВЫБОР
			|			КОГДА &ЭтоПерерасчет
			|				ТОГДА ИСТИНА
			|			КОГДА ОсновныеНачисления.Сотрудник ЕСТЬ NULL 
			|				ТОГДА ИСТИНА
			|			ИНАЧЕ ЛОЖЬ
			|		КОНЕЦ
			|
			|УПОРЯДОЧИТЬ ПО
			|	СотрудникНаименование,
			|	ДокументОснование,
			|	ДатаНачала";
			
			Запрос.Текст = ОсновнойТекстЗапроса;
			РезультатЗапроса = Запрос.Выполнить();
			
			Если МассивСотрудники = Неопределено Тогда
				ДоговорыНаВыполнениеРабот.Загрузить(РезультатЗапроса.Выгрузить());
				Для каждого СтрокаТЧ Из ДоговорыНаВыполнениеРабот Цикл
					РаботникиДляРасчетаНДФЛ.Вставить(СтрокаТЧ.Физлицо, 0);
					РаботникиДляРасчетаПенсионного.Вставить(СтрокаТЧ.Физлицо, 0);
				КонецЦикла;
			Иначе
				Выборка = РезультатЗапроса.Выбрать();
				Пока Выборка.Следующий() Цикл
					НоваяСтрока = ДоговорыНаВыполнениеРабот.Добавить();
					ЗаполнитьЗначенияСвойств(НоваяСтрока,Выборка);
					РаботникиДляРасчетаНДФЛ.Вставить(НоваяСтрока.Физлицо, 0);
					РаботникиДляРасчетаПенсионного.Вставить(НоваяСтрока.Физлицо, 0);
				КонецЦикла;
			КонецЕсли;	
			
			// Очистим необходимость перезаполнения по заполненным работникам
			Запрос.Текст =
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СписокРаботников.Сотрудник
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников";
			ПроведениеРасчетов.УдалитьСведенияОПерезаполненииДокумента(Ссылка,Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Сотрудник"));
			
		КонецЕсли;
		
		
		// АВТОЗАПОЛНЕНИЕ ТЧ "НДФЛ"
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ Тогда
			Запрос.Текст = 
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	НДФЛСведенияОДоходах.ФизЛицо
			|ИЗ
			|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|ГДЕ
			|	НДФЛСведенияОДоходах.ФизЛицо В
			|			(ВЫБРАТЬ
			|				СписокРаботников.Физлицо
			|			ИЗ
			|				ВТСписокРаботников КАК СписокРаботников)
			|	И НДФЛСведенияОДоходах.ПериодРегистрации = &парамПериодРегистрации
			|	И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	И НДФЛСведенияОДоходах.Регистратор <> &Ссылка";
			
			Выборка = Запрос.Выполнить().Выбрать(); 
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			если ТЧДоговора = Истина Тогда
				
				если ТЧДоговора = Истина Тогда
					
					НДФЛ.Очистить();
				КонецЕсли;
				Пока Выборка.Следующий() Цикл
					РаботникиДляРасчетаНДФЛ.Вставить(Выборка.Физлицо, 0);
				КонецЦикла;
			КонецЕсли;
			
			// заполним НДФЛ
			СтруктураПоиска = Новый Структура("ФизЛицо,МесяцНалоговогоПериода");
			Для Каждого Элемент Из РаботникиДляРасчетаНДФЛ Цикл
				СтруктураПоиска.ФизЛицо = Элемент.Ключ;
				СтруктураПоиска.МесяцНалоговогоПериода = НачалоМесяца(ПериодРегистрации);
				Если НДФЛ.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
					ЗаполнитьЗначенияСвойств(НДФЛ.Добавить(),СтруктураПоиска)	
				КонецЕсли;
			КонецЦикла;
			
			
		КонецЕсли;
		
		// АВТОЗАПОЛНЕНИЕ ТЧ "ПенсионныйФонд"
		
		//Аверсон ЕАЕ 22.11.2021 СВФР-008398
		Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|*
		|ИЗ ВТСписокРаботников КАК СписокРаботников
		|";
		ТЗСотрудники = Запрос.Выполнить().Выгрузить();
		//Аверсон СВФР-008398
		
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
			ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
			Запрос.Текст = 
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	НДФЛСведенияОДоходах.ФизЛицо
			|ИЗ
			|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|ГДЕ
			|	НДФЛСведенияОДоходах.ФизЛицо В
			|			(ВЫБРАТЬ
			|				СписокРаботников.Физлицо
			|			ИЗ
			|				ВТСписокРаботников КАК СписокРаботников)
			|	И НДФЛСведенияОДоходах.ПериодРегистрации = &парамПериодРегистрации
			|	И НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	И НДФЛСведенияОДоходах.Регистратор <> &Ссылка";
			
			Выборка = Запрос.Выполнить().Выбрать();
			если ТЧДоговора = Истина Тогда
				
				ПенсионныйФонд.Очистить();
				ДополнительнаяПенсия.Очистить(); //Аверсон 01.07.2022 КВВ СВФР-009250
				Пока Выборка.Следующий() Цикл
					РаботникиДляРасчетаПенсионного.Вставить(Выборка.Физлицо, 0);
				КонецЦикла;
			КонецЕсли;
			
			// заполним ПенсионныйФонд
			СтруктураПоиска = Новый Структура("ФизЛицо,МесяцНалоговогоПериода");
			Для Каждого Элемент Из РаботникиДляРасчетаПенсионного Цикл
				СтруктураПоиска.ФизЛицо = Элемент.Ключ;
				СтруктураПоиска.МесяцНалоговогоПериода = НачалоМесяца(ПериодРегистрации);
				
				//Аверсон ЕАЕ 22.11.2021 СВФР-008398
				СтрСотрудник = ТЗСотрудники.Найти(Элемент.Ключ, "ФизЛицо");
				Если СтрСотрудник <> Неопределено Тогда
					Если ЗначениеЗаполнено(СтрСотрудник.Сотрудник) Тогда
						СтруктураПоиска.Вставить("Сотрудник", СтрСотрудник.Сотрудник);
					КонецЕсли;
				КонецЕсли;
				//Аверсон СВФР-008398
				
				Если ПенсионныйФонд.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
					ЗаполнитьЗначенияСвойств(ПенсионныйФонд.Добавить(),СтруктураПоиска);
					
					//Аверсон 01.07.2022 КВВ СВФР-009250 (
					//Если Организация.УчетДополнительнойПенсии Тогда
					ПроцентДопПенсии = РегистрыСведений.ДополнительнаяПенсияРаботодательРаботник.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации),Новый Структура("Сотрудник",СтрСотрудник.Сотрудник)).ПроцентРаботника;
					Если ПроцентДопПенсии > 0 Тогда
						СтрДП = ДополнительнаяПенсия.Добавить();
						СтрДП.ФизЛицо =  СтруктураПоиска.ФизЛицо;
						СтрДП.Сотрудник =  СтрСотрудник.Сотрудник;
						СтрДП.МесяцДП =  НачалоМесяца(ПериодРегистрации);
						СтрДП.ПроцентДП = ПроцентДопПенсии;
					КонецЕсли;
					//КонецЕсли;
					//Аверсон 01.07.2022 КВВ СВФР-009250 )
					
				КонецЕсли;
			КонецЦикла;
			
			
		КонецЕсли;
		
		//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
		если ТЧДоговора = Истина Тогда 
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			Начисления.Очистить();
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			ОсновнойТекстЗапроса1 = Новый Запрос;
			ОсновнойТекстЗапроса1.УстановитьПараметр("ДатаНачала", НачалоПериодаЗаполнения);
			ОсновнойТекстЗапроса1.УстановитьПараметр("ДатаОкончания", ОкончаниеПериодаЗаполнения);
			ОсновнойТекстЗапроса1.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
			
			
			ОсновнойТекстЗапроса1.Текст = 
			//Островская Татьяна 07.04.2014 № 17239
			"ВЫБРАТЬ
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Организация,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка КАК ДокументОснование,
			|	ДоговорНаВыполнениеРаботСФизЛицом.СуммаЗаРаботу КАК Размер,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ВидРасчета,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации
			|ИЗ
			|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ПО ПлановыеНачисленияРаботниковОрганизаций.Регистратор = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|			И ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ГДЕ
			|	(ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала МЕЖДУ &ДатаНачала И &ДатаОкончания
			|			ИЛИ &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)
			|	И ПлановыеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом"; //О.Т. 27.06.2014 № 80
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ОсновнойТекстЗапроса1.Текст = ОсновнойТекстЗапроса1.Текст + "
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)"; 				
			КонецЕсли;
			
			
			//Островская Татьяна 07.04.2014 № 17239
			//Наркевич 27.03.2014 № возмем все договора которые попадают в текущий месяц
			
			
			
			РезультатЗапроса = ОсновнойТекстЗапроса1.Выполнить();
			
			НачисленияВыборка = РезультатЗапроса.Выбрать();
			//Аверсон-софт, Островская Татьяна 13.03.2012
			
			ТЗНачисления = СформироватьТаблицуДоговорыНаВыполнениеРабот(НачисленияВыборка, ОкончаниеПериодаЗаполнения, РезультатЗапроса.Выгрузить());
			
			
			СтрокаПолейОсновныхНачислений = "Сотрудник,ДатаНачала,ДатаОкончания,ДокументОснование,Размер,ВидРасчета,Результат,ПодразделениеОрганизации";
			
			Для Каждого НачислениеИзТаблицыЗначений Из ТЗНачисления Цикл
				
				НоваяСтрока	=	ДоговорыНаВыполнениеРабот.Добавить();
				ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейОсновныхНачислений); //Сотрудник,ВидРасчета,Размер,Показатель2,Показатель3,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
			КонецЦикла;
			//Аверсон-софт, Островская Татьяна 13.03.2012
		КонецЕсли;
		
		
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
			ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ Тогда
			
			
			ОсновнойТекст = Новый Запрос;
			ОсновнойТекст.УстановитьПараметр("ДатаНачала", НачалоПериодаЗаполнения);
			ОсновнойТекст.УстановитьПараметр("ДатаОкончания", ОкончаниеПериодаЗаполнения);
			ОсновнойТекст.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
			
			ОсновнойТекст.Текст =
			//Островская Татьяна 07.04.2014 № 17239
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо КАК Физлицо,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
			|ИЗ
			|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ПО ПлановыеНачисленияРаботниковОрганизаций.Регистратор = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|			И ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ГДЕ
			|	(ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала МЕЖДУ &ДатаНачала И &ДатаОкончания
			|			ИЛИ &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)
			|	И ПлановыеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ОсновнойТекст.Текст = ОсновнойТекст.Текст + "
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)"; 				
			КонецЕсли;
			
			//Островская Татьяна 07.04.2014 № 17239
			
			НачислениеНДФЛ = ОсновнойТекст.Выполнить().Выбрать();
			
			если ТЧДоговора = Истина Тогда
				РаботникиДляРасчетаНДФЛ = Новый Соответствие;
				
				НДФЛ.Очистить();
				Пока НачислениеНДФЛ.Следующий() Цикл
					РаботникиДляРасчетаНДФЛ.Вставить(НачислениеНДФЛ.Физлицо, 0);
				КонецЦикла;
			КонецЕсли;
			// заполним НДФЛ
			////Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			//если ТЧДоговора = Истина Тогда 
			////Аверсон-софт, Островская Татьяна 14.08.2012 № 15681 
			СтруктураПоиска = Новый Структура("ФизЛицо,МесяцНалоговогоПериода");
			
			//Аверсон 21.07.2022 КВВ СВФР-007954 (
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ Тогда //И РаботникиДляРасчетаНДФЛ.Количество() = 0
				
				ЗНДФЛ = Новый Запрос;
				ЗНДФЛ.Текст = "ВЫБРАТЬ //Заполнить по всем
				|Сотрудник
				|ПОМЕСТИТЬ ВтРассчитанныеСотрудники
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокумент 
				|И НЕ &ЭтоПерерасчет 
				|И ( &ВсеПодразделения 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания   
				|И Начисления.Ссылка.Проведен    
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|Сотрудник
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокумент   
				|И НЕ &ЭтоПерерасчет 
				|И ( &ВсеПодразделения 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания   
				|И Начисления.Ссылка.Проведен    
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|Сотрудник
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокумент   
				|И НЕ &ЭтоПерерасчет 
				|И ( &ВсеПодразделения 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания   
				|И Начисления.Ссылка.Проведен  
				|;
				|ВЫБРАТЬ //Заполнить по всем
				|ФизЛицо
				|ПОМЕСТИТЬ ВтРассчитанныеСотрудникиНДФЛ
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК НДФЛ
				|ГДЕ
				|НДФЛ.Ссылка <> &ТекущийДокумент 
				|И НЕ &ЭтоПерерасчет 
				|И ( &ВсеПодразделения 
				|ИЛИ НДФЛ.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ НДФЛ.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ НДФЛ.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				|И НДФЛ.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|И НДФЛ.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания   
				|И НДФЛ.Ссылка.Проведен
				|;
				|ВЫБРАТЬ 
				|ВтРассчитанныеСотрудники.Сотрудник
				|ИЗ ВтРассчитанныеСотрудники КАК ВтРассчитанныеСотрудники
				|ГДЕ НЕ ВтРассчитанныеСотрудники.Сотрудник.ФизЛицо В ( ВЫБРАТЬ ФизЛицо ИЗ ВтРассчитанныеСотрудникиНДФЛ КАК ВтРассчитанныеСотрудникиНДФЛ )
				|СГРУППИРОВАТЬ ПО
				|ВтРассчитанныеСотрудники.Сотрудник";
				ЗНДФЛ.УстановитьПараметр( "ТекущийДокумент", Ссылка );
				ЗНДФЛ.УстановитьПараметр( "ТекущийДокументДатаНачала", ПериодНачисленияДатаНачала );
				ЗНДФЛ.УстановитьПараметр( "ТекущийДокументДатаОкончания", ПериодНачисленияДатаОкончания );
				ЗНДФЛ.УстановитьПараметр( "парамПодразделение", ПодразделениеОрганизации );
				ЗНДФЛ.УстановитьПараметр( "ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации) );  
				ЗНДФЛ.УстановитьПараметр( "ЭтоПерерасчет" , ЭтоПерерасчет ); 
				РезЗНДФЛ = ЗНДФЛ.Выполнить().Выгрузить();
				
				Для Каждого СтрРезЗНДФЛ ИЗ РезЗНДФЛ Цикл
					РаботникиДляРасчетаНДФЛ.Вставить(СтрРезЗНДФЛ.Сотрудник.Физлицо, 0);
				КонецЦикла;
			КонецЕсли;
			//Аверсон 21.07.2022 КВВ СВФР-007954 )
			
			Для Каждого Элемент Из РаботникиДляРасчетаНДФЛ Цикл
				СтруктураПоиска.ФизЛицо = Элемент.Ключ;
				СтруктураПоиска.МесяцНалоговогоПериода = НачалоМесяца(НачалоПериодаЗаполнения);
				Если НДФЛ.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
					ЗаполнитьЗначенияСвойств(НДФЛ.Добавить(),СтруктураПоиска)	
				КонецЕсли;
			КонецЦикла;
			
			//Аверсон-софт, Островская Татьяна 14.03.2012	
			
		КонецЕсли;
		
		// АВТОЗАПОЛНЕНИЕ ТЧ "ПенсионныйФонд"
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
			ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
			////Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			//если ТЧДоговора = Истина Тогда 
			//	//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			ОсновнойТекст = Новый Запрос;
			ОсновнойТекст.УстановитьПараметр("ДатаНачала", НачалоПериодаЗаполнения);
			ОсновнойТекст.УстановитьПараметр("ДатаОкончания", ОкончаниеПериодаЗаполнения);
			ОсновнойТекст.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
			ОсновнойТекст.Текст = 
			//Островская Татьяна 07.04.2014 № 17239
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо КАК Физлицо,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
			|ИЗ
			|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ПО ПлановыеНачисленияРаботниковОрганизаций.Регистратор = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|			И ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ГДЕ
			|	(ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала МЕЖДУ &ДатаНачала И &ДатаОкончания
			|			ИЛИ &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)
			|	И ПлановыеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ОсновнойТекст.Текст = ОсновнойТекст.Текст + "
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)"; 				
			КонецЕсли;
			//Островская Татьяна 07.04.2014 № 17239
			
			НачислениеНДФЛ = ОсновнойТекст.Выполнить().Выбрать();
			если ТЧДоговора = Истина Тогда
				РаботникиДляРасчетаПенсионного = Новый Соответствие;
				ПенсионныйФонд.Очистить();
				ДополнительнаяПенсия.Очистить(); //Аверсон 01.07.2022 КВВ СВФР-009250
				Пока НачислениеНДФЛ.Следующий() Цикл
					РаботникиДляРасчетаПенсионного.Вставить(НачислениеНДФЛ.Физлицо, 0);
				КонецЦикла;
			КонецЕсли;	
			// заполним ПенсионныйФонд
			СтруктураПоиска = Новый Структура("ФизЛицо,МесяцНалоговогоПериода");
			
			//Аверсон 21.07.2022 КВВ СВФР-007954 (
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда //И РаботникиДляРасчетаПенсионного.Количество() = 0
				
				ЗПФ = Новый Запрос;
				ЗПФ.Текст = "ВЫБРАТЬ //Заполнить по всем
				|Сотрудник
				|ПОМЕСТИТЬ ВтРассчитанныеСотрудники
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокумент 
				|И НЕ &ЭтоПерерасчет 
				|И ( &ВсеПодразделения 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания   
				|И Начисления.Ссылка.Проведен    
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|Сотрудник
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокумент   
				|И НЕ &ЭтоПерерасчет 
				|И ( &ВсеПодразделения 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания   
				|И Начисления.Ссылка.Проведен    
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|Сотрудник
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокумент   
				|И НЕ &ЭтоПерерасчет 
				|И ( &ВсеПодразделения 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания   
				|И Начисления.Ссылка.Проведен  
				|;
				|ВЫБРАТЬ //Заполнить по всем
				|ФизЛицо
				|ПОМЕСТИТЬ ВтРассчитанныеСотрудникиПФ
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК ПФ
				|ГДЕ
				|ПФ.Ссылка <> &ТекущийДокумент 
				|И НЕ &ЭтоПерерасчет 
				|И ( &ВсеПодразделения 
				|ИЛИ ПФ.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ ПФ.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ ПФ.Ссылка.ПодразделениеОрганизации = &парамПодразделение ) 
				|И ПФ.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачала 
				|И ПФ.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончания   
				|И ПФ.Ссылка.Проведен
				|;
				|ВЫБРАТЬ 
				|ВтРассчитанныеСотрудники.Сотрудник
				|ИЗ ВтРассчитанныеСотрудники КАК ВтРассчитанныеСотрудники
				|ГДЕ НЕ ВтРассчитанныеСотрудники.Сотрудник.ФизЛицо В ( ВЫБРАТЬ ФизЛицо ИЗ ВтРассчитанныеСотрудникиПФ КАК ВтРассчитанныеСотрудникиПФ )
				|СГРУППИРОВАТЬ ПО
				|ВтРассчитанныеСотрудники.Сотрудник";
				ЗПФ.УстановитьПараметр( "ТекущийДокумент", Ссылка );
				ЗПФ.УстановитьПараметр( "ТекущийДокументДатаНачала", ПериодНачисленияДатаНачала );
				ЗПФ.УстановитьПараметр( "ТекущийДокументДатаОкончания", ПериодНачисленияДатаОкончания );
				ЗПФ.УстановитьПараметр( "парамПодразделение", ПодразделениеОрганизации );
				ЗПФ.УстановитьПараметр( "ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации) );  
				ЗПФ.УстановитьПараметр( "ЭтоПерерасчет" , ЭтоПерерасчет ); 
				РезЗПФ = ЗПФ.Выполнить().Выгрузить();
				
				Для Каждого СтрРезЗПФ ИЗ РезЗПФ Цикл
					РаботникиДляРасчетаПенсионного.Вставить(СтрРезЗПФ.Сотрудник.Физлицо, 0);
				КонецЦикла;
			КонецЕсли;
			//Аверсон 21.07.2022 КВВ СВФР-007954 )
			
			Для Каждого Элемент Из РаботникиДляРасчетаПенсионного Цикл
				СтруктураПоиска.ФизЛицо = Элемент.Ключ;
				СтруктураПоиска.МесяцНалоговогоПериода = НачалоМесяца(ПериодРегистрации);
				
				//Аверсон ЕАЕ 22.11.2021 СВФР-008398
				СтрСотрудник = ТЗСотрудники.Найти(Элемент.Ключ, "ФизЛицо");
				Если СтрСотрудник <> Неопределено Тогда
					Если ЗначениеЗаполнено(СтрСотрудник.Сотрудник) Тогда
						СтруктураПоиска.Вставить("Сотрудник", СтрСотрудник.Сотрудник);
					КонецЕсли;
				КонецЕсли;
				//Аверсон СВФР-008398
				
				Если ПенсионныйФонд.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
					ЗаполнитьЗначенияСвойств(ПенсионныйФонд.Добавить(),СтруктураПоиска);
					
					//Аверсон 01.07.2022 КВВ СВФР-009250 (
					//Если Организация.УчетДополнительнойПенсии Тогда
					ПроцентДопПенсии = РегистрыСведений.ДополнительнаяПенсияРаботодательРаботник.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации),Новый Структура("Сотрудник",СтрСотрудник.Сотрудник)).ПроцентРаботника;
					Если ПроцентДопПенсии > 0 Тогда
						СтрДП = ДополнительнаяПенсия.Добавить();
						СтрДП.ФизЛицо =  СтруктураПоиска.ФизЛицо;
						СтрДП.Сотрудник =  СтрСотрудник.Сотрудник;
						СтрДП.МесяцДП =  НачалоМесяца(ПериодРегистрации);
						СтрДП.ПроцентДП = ПроцентДопПенсии;
					КонецЕсли;
					//КонецЕсли;
					//Аверсон 01.07.2022 КВВ СВФР-009250 )
				КонецЕсли;
			КонецЦикла;
			
			
		КонецЕсли;
		// АВТОЗАПОЛНЕНИЕ ТЧ "Удержания"
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
			ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетУдержаний Тогда
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			сотр = "";
			СписокСотрудников = Новый СписокЗначений;
			Для Каждого стр из ДоговорыНаВыполнениеРабот Цикл 
				если стр.Сотрудник.Физлицо <> сотр Тогда 
					СписокСотрудников.Добавить(стр.Сотрудник.Физлицо);
					Сотр = стр.Сотрудник.Физлицо;
				КонецЕсли;
			КонецЦикла;
			
			ПоказателиУдержанийТекстЗапроса = 
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ЗначенияПоказателей.Физлицо КАК Физлицо,
			|	ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка КАК ВидРасчета,
			|	ВЫБОР
			|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 1
			|			ТОГДА ВЫБОР
			|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
			|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
			|						ТОГДА ЗначенияПоказателей.Значение
			|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
			|				КОНЕЦ
			|	КОНЕЦ КАК Показатель1,
			|	ВЫБОР
			|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 2
			|			ТОГДА ВЫБОР
			|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
			|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
			|						ТОГДА ЗначенияПоказателей.Значение
			|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
			|				КОНЕЦ
			|	КОНЕЦ КАК Показатель2,
			|	ВЫБОР
			|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 3
			|			ТОГДА ВЫБОР
			|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
			|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
			|						ТОГДА ЗначенияПоказателей.Значение
			|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
			|				КОНЕЦ
			|	КОНЕЦ КАК Показатель3,
			|	ВЫБОР
			|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 4
			|			ТОГДА ВЫБОР
			|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
			|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
			|						ТОГДА ЗначенияПоказателей.Значение
			|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
			|				КОНЕЦ
			|	КОНЕЦ КАК Показатель4,
			|	ВЫБОР
			|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 5
			|			ТОГДА ВЫБОР
			|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
			|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
			|						ТОГДА ЗначенияПоказателей.Значение
			|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
			|				КОНЕЦ
			|	КОНЕЦ КАК Показатель5,
			|	ВЫБОР
			|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 6
			|			ТОГДА ВЫБОР
			|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
			|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
			|						ТОГДА ЗначенияПоказателей.Значение
			|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
			|				КОНЕЦ
			|	КОНЕЦ КАК Показатель6
			|ПОМЕСТИТЬ ВТПоказателиУдержаний
			|ИЗ
			|	(ВЫБРАТЬ
			|		Работники.Сотрудник.Физлицо КАК Физлицо,
			|		ЗначенияПоказателейСхемМотивации.Показатель КАК Показатель,
			|		ЗначенияПоказателейСхемМотивации.Валюта КАК Валюта,
			|		ЗначенияПоказателейСхемМотивации.Значение КАК Значение
			|	ИЗ
			|		ВТДвиженияРаботников КАК Работники
			
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателейСхемМотивации
			|		ПО  
			|			(ВЫБОР
			|					КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|							ИЛИ ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя ЕСТЬ NULL 
			|						ТОГДА Работники.Сотрудник = ЗначенияПоказателейСхемМотивации.Сотрудник
			|					КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|						ТОГДА Работники.ПодразделениеОрганизации = ЗначенияПоказателейСхемМотивации.ПодразделениеОрганизации
			|					ИНАЧЕ ИСТИНА		
			|				КОНЕЦ)) КАК ЗначенияПоказателей
			
			
			|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК ПланВидовРасчетаУдержанияОрганизацийПоказатели
			|		ПО ЗначенияПоказателей.Показатель = ПланВидовРасчетаУдержанияОрганизацийПоказатели.Показатель
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК ВалютыПоказателя
			|		ПО (ВалютыПоказателя.Период = &парамДатаВалютногоУчета)
			|			И ЗначенияПоказателей.Валюта = ВалютыПоказателя.Валюта
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	ВидРасчета,
			|	Физлицо";		  				
			
			
			Запрос.Текст = ПоказателиУдержанийТекстЗапроса;
			Запрос.Выполнить();	
			
			//Аверсон 21.07.2022 КВВ СВФР-007954 (
			ТекстЗапросаУдержаний = "";
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетУдержаний Тогда 				 
				ТекстЗапросаУдержаний = "ВЫБРАТЬ //Заполнить по всем
				|Сотрудник
				|ПОМЕСТИТЬ ВтРассчитанныеСотрудники2
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокументНов
				|И НЕ &ЭтоПерерасчетНов 
				|И ( &ВсеПодразделенияНов 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделениеНов) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделениеНов ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачалаНов 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончанияНов   
				|И Начисления.Ссылка.Проведен    
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|Сотрудник
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокументНов   
				|И НЕ &ЭтоПерерасчетНов 
				|И ( &ВсеПодразделенияНов 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделениеНов ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачалаНов 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончанияНов   
				|И Начисления.Ссылка.Проведен    
				|ОБЪЕДИНИТЬ ВСЕ
				|ВЫБРАТЬ
				|Сотрудник
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК Начисления
				|ГДЕ
				|Начисления.Ссылка <> &ТекущийДокументНов   
				|И НЕ &ЭтоПерерасчетНов 
				|И ( &ВсеПодразделенияНов 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделениеНов) 
				|ИЛИ Начисления.Ссылка.ПодразделениеОрганизации = &парамПодразделениеНов ) 
				|И Начисления.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачалаНов 
				|И Начисления.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончанияНов   
				|И Начисления.Ссылка.Проведен  
				|;
				|ВЫБРАТЬ //Заполнить по всем
				|ФизЛицо
				|ПОМЕСТИТЬ ВтРассчитанныеСотрудникиУд
				|ИЗ
				|Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК Уд
				|ГДЕ
				|Уд.Ссылка <> &ТекущийДокументНов 
				|И НЕ &ЭтоПерерасчетНов 
				|И ( &ВсеПодразделенияНов 
				|ИЛИ Уд.Ссылка.ПодразделениеОрганизации = ЗНАЧЕНИЕ( Справочник.ПодразделенияОрганизаций.ПустаяСсылка ) 
				|ИЛИ Уд.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделениеНов) 
				|ИЛИ Уд.Ссылка.ПодразделениеОрганизации = &парамПодразделениеНов ) 
				|И Уд.Ссылка.ПериодНачисленияДатаНачала = &ТекущийДокументДатаНачалаНов 
				|И Уд.Ссылка.ПериодНачисленияДатаОкончания = &ТекущийДокументДатаОкончанияНов   
				|И Уд.Ссылка.Проведен
				|;
				|ВЫБРАТЬ
				|ВтРассчитанныеСотрудники2.Сотрудник.ФизЛицо КАК ФизЛицо,
				|ВтРассчитанныеСотрудники2.Сотрудник
				|ПОМЕСТИТЬ ВТБезДублейФизЛицСписокРаботниковНовая
				|ИЗ ВтРассчитанныеСотрудники2 КАК ВтРассчитанныеСотрудники2
				|ГДЕ НЕ ВтРассчитанныеСотрудники2.Сотрудник.ФизЛицо В ( ВЫБРАТЬ ФизЛицо ИЗ ВтРассчитанныеСотрудникиУд КАК ВтРассчитанныеСотрудникиУд )
				|СГРУППИРОВАТЬ ПО
				|ВтРассчитанныеСотрудники2.Сотрудник.ФизЛицо,
				|ВтРассчитанныеСотрудники2.Сотрудник
				|;
				|";
				Запрос.УстановитьПараметр( "ТекущийДокументНов", Ссылка );
				Запрос.УстановитьПараметр( "ТекущийДокументДатаНачалаНов", ПериодНачисленияДатаНачала );
				Запрос.УстановитьПараметр( "ТекущийДокументДатаОкончанияНов", ПериодНачисленияДатаОкончания );
				Запрос.УстановитьПараметр( "парамПодразделениеНов", ПодразделениеОрганизации );
				Запрос.УстановитьПараметр( "ВсеПодразделенияНов" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации) );  
				Запрос.УстановитьПараметр( "ЭтоПерерасчетНов" , ЭтоПерерасчет ); 
			КонецЕсли;
			//Аверсон 21.07.2022 КВВ СВФР-007954 )
			
			//Островская Татьяна 04.06.2014 № 17395
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			|ВЫБРАТЬ
			|	УдержанияРаботниковОрганизации.Физлицо КАК Физлицо,";
			//О.Т. Аверсон 31.05.2017 № 685
			Если не НеРазбиватьУдержанияПоПериодам Тогда 
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|	Выбор когда ЕстьNULL(УдержанияРаботниковОрганизации.ПериодНачала,1) = 1 тогда УдержанияРаботниковОрганизации.Период иначе УдержанияРаботниковОрганизации.ПериодНачала конец КАК Период,";//О.Т. Аверсон 15.08.2017 № 912
			иначе
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|	УдержанияРаботниковОрганизации.Период КАК Период,";
			КонецЕсли;
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			//О.Т. Аверсон 31.05.2017 № 685
			|	УдержанияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
			|	УдержанияРаботниковОрганизации.Действие КАК Действие,
			|	УдержанияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
			|	УдержанияРаботниковОрганизации.Валюта1 КАК Валюта,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|			ТОГДА 1
			|		ИНАЧЕ Валюты1.Курс
			|	КОНЕЦ КАК КурсВалюты,
			|	ВЫБОР
			|		КОГДА Показатели.Показатель1 ЕСТЬ НЕ NULL 
			|					И Показатели.Показатель1 <> 0
			|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|			ТОГДА Показатели.Показатель1
			|		КОГДА УдержанияРаботниковОрганизации.Показатель1 ЕСТЬ NULL 
			|				ИЛИ УдержанияРаботниковОрганизации.Показатель1 = 0
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		ИНАЧЕ ВЫБОР
			|				КОГДА УдержанияРаботниковОрганизации.Показатель1 ЕСТЬ NULL 
			|					ТОГДА 0
			|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ИЛИ УдержанияРаботниковОрганизации.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|					ТОГДА УдержанияРаботниковОрганизации.Показатель1
			|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
			|			КОНЕЦ
			|	КОНЕЦ КАК Показатель1,
			|	ВЫБОР
			|		КОГДА Показатели.Показатель2 ЕСТЬ НЕ NULL 
			|					И Показатели.Показатель2 <> 0
			|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|			ТОГДА Показатели.Показатель2
			|		КОГДА УдержанияРаботниковОрганизации.Показатель2 ЕСТЬ NULL 
			|				ИЛИ УдержанияРаботниковОрганизации.Показатель2 = 0
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		ИНАЧЕ ВЫБОР
			|				КОГДА УдержанияРаботниковОрганизации.Показатель2 ЕСТЬ NULL 
			|					ТОГДА 0
			|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ИЛИ УдержанияРаботниковОрганизации.Валюта2 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|					ТОГДА УдержанияРаботниковОрганизации.Показатель2
			|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель2 * ЕСТЬNULL(Валюты2.Курс / Валюты2.Кратность, 0)
			|			КОНЕЦ
			|	КОНЕЦ КАК Показатель2,
			|	ВЫБОР
			|		КОГДА Показатели.Показатель3 ЕСТЬ НЕ NULL 
			|					И Показатели.Показатель3 <> 0
			|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|			ТОГДА Показатели.Показатель3
			|		КОГДА УдержанияРаботниковОрганизации.Показатель3 ЕСТЬ NULL 
			|				ИЛИ УдержанияРаботниковОрганизации.Показатель3 = 0
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		ИНАЧЕ ВЫБОР
			|				КОГДА УдержанияРаботниковОрганизации.Показатель3 ЕСТЬ NULL 
			|					ТОГДА 0
			|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ИЛИ УдержанияРаботниковОрганизации.Валюта3 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|					ТОГДА УдержанияРаботниковОрганизации.Показатель3
			|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель3 * ЕСТЬNULL(Валюты3.Курс / Валюты3.Кратность, 0)
			|			КОНЕЦ
			|	КОНЕЦ КАК Показатель3,
			|	ВЫБОР
			|		КОГДА Показатели.Показатель4 ЕСТЬ НЕ NULL 
			|					И Показатели.Показатель4 <> 0
			|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|			ТОГДА Показатели.Показатель4
			|		КОГДА УдержанияРаботниковОрганизации.Показатель4 ЕСТЬ NULL 
			|				ИЛИ УдержанияРаботниковОрганизации.Показатель4 = 0
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		ИНАЧЕ ВЫБОР
			|				КОГДА УдержанияРаботниковОрганизации.Показатель4 ЕСТЬ NULL 
			|					ТОГДА 0
			|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ИЛИ УдержанияРаботниковОрганизации.Валюта4 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|					ТОГДА УдержанияРаботниковОрганизации.Показатель4
			|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель4 * ЕСТЬNULL(Валюты4.Курс / Валюты4.Кратность, 0)
			|			КОНЕЦ
			|	КОНЕЦ КАК Показатель4,
			|	ВЫБОР
			|		КОГДА Показатели.Показатель5 ЕСТЬ НЕ NULL 
			|					И Показатели.Показатель5 <> 0
			|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|			ТОГДА Показатели.Показатель5
			|		КОГДА УдержанияРаботниковОрганизации.Показатель5 ЕСТЬ NULL 
			|				ИЛИ УдержанияРаботниковОрганизации.Показатель5 = 0
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		ИНАЧЕ ВЫБОР
			|				КОГДА УдержанияРаботниковОрганизации.Показатель5 ЕСТЬ NULL 
			|					ТОГДА 0
			|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ИЛИ УдержанияРаботниковОрганизации.Валюта5 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|					ТОГДА УдержанияРаботниковОрганизации.Показатель5
			|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель5 * ЕСТЬNULL(Валюты5.Курс / Валюты5.Кратность, 0)
			|			КОНЕЦ
			|	КОНЕЦ КАК Показатель5,
			|	ВЫБОР
			|		КОГДА Показатели.Показатель6 ЕСТЬ НЕ NULL 
			|					И Показатели.Показатель6 <> 0
			|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
			|			ТОГДА Показатели.Показатель6
			|		КОГДА УдержанияРаботниковОрганизации.Показатель6 ЕСТЬ NULL 
			|				ИЛИ УдержанияРаботниковОрганизации.Показатель6 = 0
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
			|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
			|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
			|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
			|		ИНАЧЕ ВЫБОР
			|				КОГДА УдержанияРаботниковОрганизации.Показатель6 ЕСТЬ NULL 
			|					ТОГДА 0
			|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
			|						ИЛИ УдержанияРаботниковОрганизации.Валюта6 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
			|					ТОГДА УдержанияРаботниковОрганизации.Показатель6
			|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель6 * ЕСТЬNULL(Валюты6.Курс / Валюты6.Кратность, 0)
			|			КОНЕЦ
			|	КОНЕЦ КАК Показатель6,
			|	УдержанияРаботниковОрганизации.Физлицо.Наименование КАК ФизлицоНаименование,
			|	УдержанияРаботниковОрганизации.Сотрудник
			|ИЗ
			|	(ВЫБРАТЬ
			|	&парамНачало КАК Период,
			|	УдержанияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.ДействиеЗавершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Действие
			|	КОНЕЦ КАК Действие,
			|	УдержанияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Показатель1Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель1
			|	КОНЕЦ КАК Показатель1,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Показатель2Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель2
			|	КОНЕЦ КАК Показатель2,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Показатель3Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель3
			|	КОНЕЦ КАК Показатель3,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Показатель4Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель4
			|	КОНЕЦ КАК Показатель4,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Показатель5Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель5
			|	КОНЕЦ КАК Показатель5,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Показатель6Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель6
			|	КОНЕЦ КАК Показатель6,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Валюта1Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта1
			|	КОНЕЦ КАК Валюта1,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Валюта2Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта2
			|	КОНЕЦ КАК Валюта2,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Валюта3Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта3
			|	КОНЕЦ КАК Валюта3,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Валюта4Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта4
			|	КОНЕЦ КАК Валюта4,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Валюта5Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта5
			|	КОНЕЦ КАК Валюта5,
			|	ВЫБОР
			|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
			|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА УдержанияРаботниковОрганизации.Валюта6Завершения
			|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта6
			|	КОНЕЦ КАК Валюта6,
			|	УдержанияРаботниковОрганизации.ФизЛицо КАК Физлицо,";
			//О.Т. Аверсон 31.05.2017 № 685
			Если не НеРазбиватьУдержанияПоПериодам Тогда 
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|	КадровыеПоказатели.Сотрудник КАК Сотрудник,
				|	КадровыеПоказатели.Период КАК ПериодНачала";
			иначе
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|	ВТСписокРаботников.Сотрудник КАК Сотрудник";
			КонецЕсли;
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			//О.Т. Аверсон 31.05.2017 № 685
			|ИЗ
			|	РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций.СрезПоследних(
			|			&парамНачало,
			|			Организация = &парамГоловнаяОрганизация
			|				И ФизЛицо В
			|					(ВЫБРАТЬ
			|						СписокРаботников.ФизЛицо
			|					ИЗ
			|						ВТСписокРаботников КАК СписокРаботников)) КАК УдержанияРаботниковОрганизации";
			//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ВТСписокРаботников
			//|		ПО УдержанияРаботниковОрганизации.ФизЛицо = ВТСписокРаботников.ФизЛицо";
			//О.Т. Аверсон 31.05.2017 № 685
			Если не НеРазбиватьУдержанияПоПериодам Тогда 
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ // Внутренее убрала и поставила Левое № 912
				|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо КАК ФизЛицо,
				|			СписокРаботников.Сотрудник,
				|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период
				|		ИЗ
				//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//|			ВТСписокРаботников КАК СписокРаботников
				//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|			ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
				//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
				|			ПО СписокРаботников.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
				
				|		ГДЕ
				|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
				|			И НАЧАЛОПЕРИОДА(ЗначенияВводимыхКадровыхПоказателей.Период, МЕСЯЦ) = &парамПериодРегистрации
				|		
				|		СГРУППИРОВАТЬ ПО
				|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо,
				|			СписокРаботников.Сотрудник,
				|			ЗначенияВводимыхКадровыхПоказателей.Период) КАК КадровыеПоказатели
				//	|		ПО КонецПериода(УдержанияРаботниковОрганизации.Период,месяц) = КонецПериода(КадровыеПоказатели.Период,Месяц)
				|		ПО УдержанияРаботниковОрганизации.ФизЛицо = КадровыеПоказатели.ФизЛицо";
			КонецЕсли;
			Если не НеРазбиватьУдержанияПоПериодам Тогда
			иначе
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ВТСписокРаботников
				//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТБезДублейФизЛицСписокРаботников КАК ВТСписокРаботников
				//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|		ПО УдержанияРаботниковОрганизации.ФизЛицо = ВТСписокРаботников.Физлицо";
			КонецЕсли;
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			//О.Т. Аверсон 31.05.2017 № 685
			
			
			|ГДЕ
			|	УдержанияРаботниковОрганизации.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			
			//Аверсон 09.03.2023 КВВ СВФР-010486 (
			|
			|ИЛИ
			|(УдержанияРаботниковОрганизации.Действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|И УдержанияРаботниковОрганизации.ПериодЗавершения < &парамНачало
			|И УдержанияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать))
			|
			//Аверсон 09.03.2023 КВВ СВФР-010486 )
			
			|ОБЪЕДИНИТЬ ВСЕ
			
			|ВЫБРАТЬ
			|	УдержанияРаботниковОрганизации.Период,
			|	УдержанияРаботниковОрганизации.ВидРасчета,
			|	УдержанияРаботниковОрганизации.Действие,
			|	УдержанияРаботниковОрганизации.ДокументОснование,
			|	УдержанияРаботниковОрганизации.Показатель1,
			|	УдержанияРаботниковОрганизации.Показатель2,
			|	УдержанияРаботниковОрганизации.Показатель3,
			|	УдержанияРаботниковОрганизации.Показатель4,
			|	УдержанияРаботниковОрганизации.Показатель5,
			|	УдержанияРаботниковОрганизации.Показатель6,
			|	УдержанияРаботниковОрганизации.Валюта1,
			|	УдержанияРаботниковОрганизации.Валюта2,
			|	УдержанияРаботниковОрганизации.Валюта3,
			|	УдержанияРаботниковОрганизации.Валюта4,
			|	УдержанияРаботниковОрганизации.Валюта5,
			|	УдержанияРаботниковОрганизации.Валюта6,
			|	УдержанияРаботниковОрганизации.ФизЛицо,";
			//О.Т. Аверсон 31.05.2017 № 685
			Если не НеРазбиватьУдержанияПоПериодам Тогда 
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|	КадровыеПоказатели.Сотрудник,
				|	УдержанияРаботниковОрганизации.Период";
			иначе
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|	СписокРаботников.Сотрудник";
			КонецЕсли;
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			//О.Т. Аверсон 31.05.2017 № 685
			|ИЗ
			|	РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации";
			//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК СписокРаботников
			//|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокРаботников.Физлицо";
			//О.Т. Аверсон 31.05.2017 № 685
			Если не НеРазбиватьУдержанияПоПериодам Тогда 
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ  // Внутренее убрала и поставила Левое № 912
				|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо КАК ФизЛицо,
				|			СписокРаботников.Сотрудник,
				|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период
				|		ИЗ
				//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//|			ВТСписокРаботников КАК СписокРаботников
				//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|			ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
				//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
				|			ПО СписокРаботников.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
				|		ГДЕ
				|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
				|			И ЗначенияВводимыхКадровыхПоказателей.Период МЕЖДУ &ПарамНачало И &ПарамКонец
				|		
				|		СГРУППИРОВАТЬ ПО
				|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо,
				|			СписокРаботников.Сотрудник,
				|			ЗначенияВводимыхКадровыхПоказателей.Период) КАК КадровыеПоказатели
				|		ПО КонецПериода(УдержанияРаботниковОрганизации.Период,месяц) = КонецПериода(КадровыеПоказатели.Период,Месяц)"; //О.Т. Аверсон 20.01.2017 конец период доб
			КонецЕсли;
			Если не НеРазбиватьУдержанияПоПериодам Тогда
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|		и  УдержанияРаботниковОрганизации.ФизЛицо = КадровыеПоказатели.Физлицо";
			иначе
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК СписокРаботников
				//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
				//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокРаботников.Физлицо";
			КонецЕсли;
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			//О.Т. Аверсон 31.05.2017 № 685
			
			|ГДЕ
			|	УдержанияРаботниковОрганизации.Период > &парамНачало
			|	И УдержанияРаботниковОрганизации.Период <= &парамКонец
			|	И УдержанияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
			
			|ОБЪЕДИНИТЬ ВСЕ
			
			|ВЫБРАТЬ
			|	УдержанияРаботниковОрганизации.ПериодЗавершения,
			|	УдержанияРаботниковОрганизации.ВидРасчета,
			|	УдержанияРаботниковОрганизации.ДействиеЗавершения,
			|	УдержанияРаботниковОрганизации.ДокументОснование,
			|	УдержанияРаботниковОрганизации.Показатель1Завершения,
			|	УдержанияРаботниковОрганизации.Показатель2Завершения,
			|	УдержанияРаботниковОрганизации.Показатель3Завершения,
			|	УдержанияРаботниковОрганизации.Показатель4Завершения,
			|	УдержанияРаботниковОрганизации.Показатель5Завершения,
			|	УдержанияРаботниковОрганизации.Показатель6Завершения,
			|	УдержанияРаботниковОрганизации.Валюта1Завершения,
			|	УдержанияРаботниковОрганизации.Валюта2Завершения,
			|	УдержанияРаботниковОрганизации.Валюта3Завершения,
			|	УдержанияРаботниковОрганизации.Валюта4Завершения,
			|	УдержанияРаботниковОрганизации.Валюта5Завершения,
			|	УдержанияРаботниковОрганизации.Валюта6Завершения,
			|	УдержанияРаботниковОрганизации.ФизЛицо,";
			//О.Т. Аверсон 31.05.2017 № 685
			Если не НеРазбиватьУдержанияПоПериодам Тогда 
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|	КадровыеПоказатели.Сотрудник,
				|	КадровыеПоказатели.Период";
			иначе
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|	СписокРаботников.Сотрудник";
			КонецЕсли;
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			//О.Т. Аверсон 31.05.2017 № 685
			|ИЗ
			|	РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
			
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизацииПроверка
			|		ПО (УдержанияРаботниковОрганизацииПроверка.Организация = УдержанияРаботниковОрганизации.Организация)
			|			И (УдержанияРаботниковОрганизацииПроверка.ФизЛицо = УдержанияРаботниковОрганизации.ФизЛицо)
			|			И (УдержанияРаботниковОрганизацииПроверка.ВидРасчета = УдержанияРаботниковОрганизации.ВидРасчета)
			|			И (УдержанияРаботниковОрганизацииПроверка.ДокументОснование = УдержанияРаботниковОрганизации.ДокументОснование)
			|			И (УдержанияРаботниковОрганизацииПроверка.Период > УдержанияРаботниковОрганизации.Период)
			|			И (УдержанияРаботниковОрганизацииПроверка.Период <= УдержанияРаботниковОрганизации.ПериодЗавершения)
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
			|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо КАК ФизЛицо,
			|			СписокРаботников.Сотрудник,
			|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период
			|		ИЗ
			//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
			//|			ВТСписокРаботников КАК СписокРаботников
			//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
			//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
			|			ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
			//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
			|			ПО СписокРаботников.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
			
			|		ГДЕ
			|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
			|			И ЗначенияВводимыхКадровыхПоказателей.Период МЕЖДУ &ПарамНачало И &ПарамКонец
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо,
			|			СписокРаботников.Сотрудник,
			|			ЗначенияВводимыхКадровыхПоказателей.Период) КАК КадровыеПоказатели
			|		ПО КонецПериода(УдержанияРаботниковОрганизации.ПериодЗавершения,месяц) = КонецПериода(КадровыеПоказатели.Период,Месяц)"; //О.Т. Аверсон 20.01.2017 конец период доб
			Если не НеРазбиватьУдержанияПоПериодам Тогда
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|		и  УдержанияРаботниковОрганизации.ФизЛицо = КадровыеПоказатели.Физлицо";
			иначе
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК СписокРаботников
				//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
				//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокРаботников.Физлицо";
			КонецЕсли;
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			
			|ГДЕ
			|	УдержанияРаботниковОрганизации.ПериодЗавершения >= &парамНачало
			|	И УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамКонец
			|	И УдержанияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
			|	И УдержанияРаботниковОрганизацииПроверка.ФизЛицо ЕСТЬ NULL ) КАК УдержанияРаботниковОрганизации
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты1
			|		ПО (Валюты1.Период = &парамДатаВалютногоУчета)
			|			И УдержанияРаботниковОрганизации.Валюта1 = Валюты1.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты2
			|		ПО (Валюты2.Период = &парамДатаВалютногоУчета)
			|			И УдержанияРаботниковОрганизации.Валюта2 = Валюты2.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты3
			|		ПО (Валюты3.Период = &парамДатаВалютногоУчета)
			|			И УдержанияРаботниковОрганизации.Валюта3 = Валюты3.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты4
			|		ПО (Валюты4.Период = &парамДатаВалютногоУчета)
			|			И УдержанияРаботниковОрганизации.Валюта4 = Валюты4.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты5
			|		ПО (Валюты5.Период = &парамДатаВалютногоУчета)
			|			И УдержанияРаботниковОрганизации.Валюта5 = Валюты5.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты6
			|		ПО (Валюты6.Период = &парамДатаВалютногоУчета)
			|			И УдержанияРаботниковОрганизации.Валюта6 = Валюты6.Валюта
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказателиУдержаний КАК Показатели
			|		ПО УдержанияРаботниковОрганизации.ВидРасчета = Показатели.ВидРасчета
			|			И УдержанияРаботниковОрганизации.Физлицо = Показатели.Физлицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
			|			НеВводимыеПоказатели.Ссылка КАК Ссылка,
			|			НеВводимыеПоказатели.НомерСтроки КАК НомерСтроки,
			|			НеВводимыеПоказатели.Показатель КАК Показатель,
			|			НеВводимыеПоказатели.Показатель.ВозможностьИзменения КАК ПоказательВозможностьИзменения,
			|			СУММА(ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя) КАК ЗначениеПоказателя,
			|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо КАК ФизЛицо,
			|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период,
			|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники КАК ПериодРаботники
			|		ИЗ
			|			ВТНеЗапрашиваемыеПриКадровыхПеремещениях КАК НеВводимыеПоказатели
			|				ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
			|				ПО НеВводимыеПоказатели.Показатель = ЗначенияВводимыхКадровыхПоказателей.Показатель
			|		ГДЕ
			|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
			
			|		
			|		СГРУППИРОВАТЬ ПО
			|			НеВводимыеПоказатели.Ссылка,
			|			НеВводимыеПоказатели.НомерСтроки,
			|			НеВводимыеПоказатели.Показатель,
			|			НеВводимыеПоказатели.Показатель.ВозможностьИзменения,
			|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо,
			|			ЗначенияВводимыхКадровыхПоказателей.Период,
			|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники) КАК ЗначенияВводимыхКадровыхПоказателей
			|		ПО УдержанияРаботниковОрганизации.Физлицо = ЗначенияВводимыхКадровыхПоказателей.ФизЛицо
			|			И (КОНЕЦПЕРИОДА(УдержанияРаботниковОрганизации.Период, МЕСЯЦ) = КОНЕЦПЕРИОДА(ЗначенияВводимыхКадровыхПоказателей.Период, МЕСЯЦ))
			|			И УдержанияРаботниковОрганизации.ВидРасчета = ЗначенияВводимыхКадровыхПоказателей.Ссылка";
			//Островская Татьяна 04.06.2014 № 17395
			// если не перерасчет - проверяем проведенность в расчетном периоде
			Если Не ЭтоПерерасчет Тогда
				//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
				если ТЧДоговора тогда
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
					|			УдержанияРаботников.ФизЛицо КАК ФизЛицо,
					|			УдержанияРаботников.ВидРасчета КАК ВидРасчета,";
					//О.Т. Аверсон 31.05.2017 № 685
					Если не НеРазбиватьУдержанияПоПериодам Тогда 
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|			УдержанияРаботников.ДокументОснование КАК ДокументОснование,
						|			УдержанияРаботников.БазовыйПериодНачало";
					иначе
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|			УдержанияРаботников.ДокументОснование КАК ДокументОснование";
					КонецЕсли;
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					//О.Т. Аверсон 31.05.2017 № 685
					|		ИЗ
					|			РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботников
					|		ГДЕ
					|			УдержанияРаботников.ПериодРегистрации = &парамПериодРегистрации
					|			И УдержанияРаботников.ФизЛицо В
					|					(ВЫБРАТЬ
					|						СписокРаботников.Физлицо
					|					ИЗ
					|						ВТСписокРаботников КАК СписокРаботников)
					|			И УдержанияРаботников.ОбособленноеПодразделение = &парамОрганизация
					|			И УдержанияРаботников.Регистратор <> &парамРегистратор
					|			И НАЧАЛОПЕРИОДА(УдержанияРаботников.БазовыйПериодНачало, МЕСЯЦ) = &парамПериодРегистрации
					//(начало) закомментировано Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
					//|			И УдержанияРаботников.ВидРасчета.СпособРасчета <> ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.Процентом)
					//(конец) закомментировано Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
					//(начало) добавлено Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
					|			И НЕ УдержанияРаботников.ВидРасчета.СпособРасчета В ( ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.Процентом),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПределаСНДФЛ),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПочтовыйСбор),  //Аверсон 07.07.2022 КВВ СВФР-008761
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела) )
					//(конец) добавлено Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
					|								) КАК ЗарегистрированныеУдержанияРаботников //О.Т. Аверсон 21.06.2017 № 754
					|		ПО УдержанияРаботниковОрганизации.Физлицо = ЗарегистрированныеУдержанияРаботников.ФизЛицо
					|			И УдержанияРаботниковОрганизации.ВидРасчета = ЗарегистрированныеУдержанияРаботников.ВидРасчета
					|			И (ЗарегистрированныеУдержанияРаботников.ДокументОснование = ВЫБОР
					|				КОГДА УдержанияРаботниковОрганизации.ДокументОснование ССЫЛКА Документ.ИсполнительныйЛист
					|					ТОГДА УдержанияРаботниковОрганизации.ДокументОснование
					|				ИНАЧЕ ЗНАЧЕНИЕ(Документ.ИсполнительныйЛист.ПустаяСсылка)
					|			КОНЕЦ)";
					//О.Т. Аверсон 31.05.2017 № 685
					Если не НеРазбиватьУдержанияПоПериодам Тогда 
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|			И УдержанияРаботниковОрганизации.ПериодНачала = ЗарегистрированныеУдержанияРаботников.БазовыйПериодНачало"; 						
					КонецЕсли;
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					//О.Т. Аверсон 31.05.2017 № 685
					
					|ГДЕ
					|	ЗарегистрированныеУдержанияРаботников.ФизЛицо ЕСТЬ NULL 
					|	И УдержанияРаботниковОрганизации.Физлицо В(&ФизлицоСписок)";
					
				иначе
					//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
					|			УдержанияРаботников.ФизЛицо КАК ФизЛицо,
					|			УдержанияРаботников.ВидРасчета КАК ВидРасчета,";
					//О.Т. Аверсон 31.05.2017 № 685
					Если не НеРазбиватьУдержанияПоПериодам Тогда 
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|			УдержанияРаботников.ДокументОснование КАК ДокументОснование,
						|			УдержанияРаботников.БазовыйПериодНачало";
					иначе
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|			УдержанияРаботников.ДокументОснование КАК ДокументОснование";
					КонецЕсли;
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					//О.Т. Аверсон 31.05.2017 № 685
					|		ИЗ
					|			РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботников
					|		ГДЕ
					|			УдержанияРаботников.ПериодРегистрации = &парамПериодРегистрации
					|			И УдержанияРаботников.ФизЛицо В
					|					(ВЫБРАТЬ
					|						СписокРаботников.Физлицо
					|					ИЗ
					|						ВТСписокРаботников КАК СписокРаботников)
					|			И УдержанияРаботников.ОбособленноеПодразделение = &парамОрганизация
					|			И УдержанияРаботников.Регистратор <> &парамРегистратор
					|			И НАЧАЛОПЕРИОДА(УдержанияРаботников.БазовыйПериодНачало, МЕСЯЦ) = &парамПериодРегистрации
					//(начало) закомментировано Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
					//|			И УдержанияРаботников.ВидРасчета.СпособРасчета <> ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.Процентом)
					//(конец) закомментировано Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
					//(начало) добавлено Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
					|			И НЕ УдержанияРаботников.ВидРасчета.СпособРасчета В ( ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.Процентом),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПределаСНДФЛ),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПочтовыйСбор),  //Аверсон 07.07.2022 КВВ СВФР-008761
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ),
					|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела) )
					//(конец) добавлено Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
					|								) КАК ЗарегистрированныеУдержанияРаботников //О.Т. Аверсон 21.06.2017 № 754
					|		ПО УдержанияРаботниковОрганизации.Физлицо = ЗарегистрированныеУдержанияРаботников.ФизЛицо
					|			И УдержанияРаботниковОрганизации.ВидРасчета = ЗарегистрированныеУдержанияРаботников.ВидРасчета
					|			И (ЗарегистрированныеУдержанияРаботников.ДокументОснование = ВЫБОР
					|				КОГДА УдержанияРаботниковОрганизации.ДокументОснование ССЫЛКА Документ.ИсполнительныйЛист
					|					ТОГДА УдержанияРаботниковОрганизации.ДокументОснование
					|				ИНАЧЕ ЗНАЧЕНИЕ(Документ.ИсполнительныйЛист.ПустаяСсылка)
					|			КОНЕЦ)";
					//О.Т. Аверсон 31.05.2017 № 685
					Если не НеРазбиватьУдержанияПоПериодам Тогда 
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|			И УдержанияРаботниковОрганизации.ПериодНачала = ЗарегистрированныеУдержанияРаботников.БазовыйПериодНачало"; 						
					КонецЕсли;
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					//О.Т. Аверсон 31.05.2017 № 685
					
					|ГДЕ
					|	ЗарегистрированныеУдержанияРаботников.ФизЛицо ЕСТЬ NULL";
				КонецЕсли;
				Если не НеРазбиватьУдержанияПоПериодам Тогда
					если не ТЧДоговора тогда //О.Т. Аверсон 27.03.2019 № 4149
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|			И ЕстьNull(УдержанияРаботниковОрганизации.Сотрудник,0)<> 0 ";
					КонецЕсли;
				КонецЕсли;
				
				
				
			КонецЕсли;
			
			ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
			|
			|УПОРЯДОЧИТЬ ПО
			|    ВидРасчета,
			|    УдержанияРаботниковОрганизации.Период,
			|    ФизлицоНаименование,
			|    Физлицо,
			|    ДокументОснование";
			
			//Аверсон 21.07.2022 КВВ СВФР-007954 (
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетУдержаний Тогда
				ТекстЗапросаУдержаний = СтрЗаменить(ТекстЗапросаУдержаний,"ВТБезДублейФизЛицСписокРаботников КАК","ВТБезДублейФизЛицСписокРаботниковНовая КАК");
				ТекстЗапросаУдержаний = СтрЗаменить(ТекстЗапросаУдержаний,"ВТСписокРаботников КАК","ВТБезДублейФизЛицСписокРаботниковНовая КАК");				
			КонецЕсли;
			//Аверсон 21.07.2022 КВВ СВФР-007954 )
			
			Запрос.Текст = ТекстЗапросаУдержаний;
			Запрос.УстановитьПараметр("ФизлицоСписок",СписокСотрудников);
			УдержанияВыборка = Запрос.Выполнить().Выбрать();
			
			//Аверсон 14.08.2019 КВВ СВФР-004607 (
			ТЗФизЛиц = Новый ТаблицаЗначений;
			Если НЕ МассивСотрудники = Неопределено Тогда
				ТЗФизЛиц.Колонки.Добавить("Физлицо");
				Для Каждого ЭлементМассива из МассивСотрудники Цикл
					СтрТЗ = ТЗФизЛиц.Добавить();
					СтрТЗ.Физлицо = ЭлементМассива.Физлицо;
				КонецЦикла;
			КонецЕсли;
			//Аверсон 14.08.2019 КВВ СВФР-004607 )
			
			ТЗУдержания = СформироватьТаблицуУдержаний(УдержанияВыборка, ОкончаниеПериодаЗаполнения,ТЗФизЛиц); //Аверсон 14.08.2019 КВВ СВФР-004607
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			СтруктураПоиска = Новый Структура("Сторно,ФизЛицо,ВидРасчета,ДокументОснование,ДатаНачала", Ложь);
			Для каждого СтрокаУдержания Из ТЗУдержания Цикл
				ЗаполнитьЗначенияСвойств(СтруктураПоиска,СтрокаУдержания);	
				Если Удержания.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
					ЗаполнитьЗначенияСвойств(Удержания.Добавить(),СтрокаУдержания)	
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		// заполняем погашение займов 
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
			ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов Тогда
			// погашение займов
			//толик изменил .ПроцентЗаПользованиеЗаймом > 0 на .ПроцентЗаПользованиеЗаймом >= 0
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			
			если ТЧДоговора или СписокСотрудников.количество() = 0 Тогда 
				ТекстЗапросаУдержаний = 
				"ВЫБРАТЬ
				|	ПогашениеЗаймовРаботникамиОстатки.ФизЛицо,
				|	ПогашениеЗаймовРаботникамиОстатки.ФизЛицо.Наименование КАК ФизЛицоНаименование,
				|	ПогашениеЗаймовРаботникамиОстатки.СтавкаНалогообложенияМатвыгоды,
				|	ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма,
				|	РаботникиОрганизаций.ПодразделениеОрганизации
				|ИЗ
				|	(ВЫБРАТЬ
				|		ПогашениеЗаймовРаботникамиОстатки.ФизЛицо КАК ФизЛицо,
				|		ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма КАК ДоговорЗайма,
				|		ВЫБОР
				|			КОГДА ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.НачислятьМатериальнуюВыгоду
				|				ТОГДА ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.СтавкаНалогообложенияРезидента
				|			ИНАЧЕ НЕОПРЕДЕЛЕНО
				|		КОНЕЦ КАК СтавкаНалогообложенияМатвыгоды
				|	ИЗ
				|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций.Остатки(
				|				&парамНачало,
				|				Организация = &парамОрганизация
				|					И (ДоговорЗайма.НачалоПогашения <= &парамНачало
				|						ИЛИ ДоговорЗайма.ПроцентЗаПользованиеЗаймом >= 0
				|						ИЛИ ДоговорЗайма.НачислятьМатериальнуюВыгоду)
				|					И Физлицо В
				|						(ВЫБРАТЬ
				|							СписокРаботников.Физлицо
				|						ИЗ
				|							ВТСписокРаботников КАК СписокРаботников
				|						ГДЕ
				|							СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))) КАК ПогашениеЗаймовРаботникамиОстатки
				|	
				|	ОБЪЕДИНИТЬ
				|	
				|	ВЫБРАТЬ РАЗЛИЧНЫЕ
				|		ПогашениеЗаймовРаботникамиОбороты.ФизЛицо,
				|		ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма,
				|		ВЫБОР
				|			КОГДА ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачислятьМатериальнуюВыгоду
				|				ТОГДА ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.СтавкаНалогообложенияРезидента
				|			ИНАЧЕ НЕОПРЕДЕЛЕНО
				|		КОНЕЦ
				|	ИЗ
				|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОбороты
				|	ГДЕ
				|		(ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачалоПогашения <= &парамНачало
				|				ИЛИ ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.ПроцентЗаПользованиеЗаймом >= 0
				|				ИЛИ ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачислятьМатериальнуюВыгоду)
				|		И ПогашениеЗаймовРаботникамиОбороты.Организация = &парамОрганизация
				|		И ПогашениеЗаймовРаботникамиОбороты.ФизЛицо В
				|				(ВЫБРАТЬ
				|					СписокРаботников.Физлицо
				|				ИЗ
				|					ВТСписокРаботников КАК СписокРаботников
				|				ГДЕ
				|					СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
				|		И ПогашениеЗаймовРаботникамиОбороты.Период МЕЖДУ &парамНачало И &парамКонец
				|		И ПогашениеЗаймовРаботникамиОбороты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)) КАК ПогашениеЗаймовРаботникамиОстатки
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК Физлицо,
				|			ВЫБОР
				|				КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &парамКонец
				|						И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизацииЗавершения
				|				ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
				|			КОНЕЦ КАК ПодразделениеОрганизации
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|					&парамКонец,
				|					Организация = &парамГоловнаяОрганизация
				|						И Сотрудник В
				|							(ВЫБРАТЬ
				|								СписокРаботников.Сотрудник
				|							ИЗ
				|								ВТСписокРаботников КАК СписокРаботников
				|							ГДЕ
				|								СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
				|						И Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)) КАК РаботникиОрганизацийСрезПоследних
				|		ГДЕ
				|			ВЫБОР
				|					КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &парамКонец
				|							И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостоянияЗавершения
				|					ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния
				|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) КАК РаботникиОрганизаций
				|		ПО ПогашениеЗаймовРаботникамиОстатки.ФизЛицо = РаботникиОрганизаций.Физлицо
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОбороты
				|		ПО ПогашениеЗаймовРаботникамиОстатки.ФизЛицо = ПогашениеЗаймовРаботникамиОбороты.ФизЛицо
				|			И ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма = ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма
				|			И (ПогашениеЗаймовРаботникамиОбороты.Период МЕЖДУ &парамНачало И &парамКонец)
				|			И (ПогашениеЗаймовРаботникамиОбороты.Регистратор ССЫЛКА Документ.НачислениеЗарплатыРаботникамОрганизаций)
				|			И (ВЫРАЗИТЬ(ПогашениеЗаймовРаботникамиОбороты.Регистратор КАК Документ.НачислениеЗарплатыРаботникамОрганизаций).ПериодРегистрации = &парамПериодРегистрации)
				|ГДЕ
				|	ПогашениеЗаймовРаботникамиОбороты.ФизЛицо ЕСТЬ NULL 
				|	И ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.Проведен";
				Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
					ТекстЗапросаУдержаний= ТекстЗапросаУдержаний + "
					|	И РаботникиОрганизаций.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)";  //Аверсон 06.12.2019 КВВ СВФР-005185
				КонецЕсли;
				ТекстЗапросаУдержаний= ТекстЗапросаУдержаний + "
				|	//И ПогашениеЗаймовРаботникамиОстатки.ФизЛицо В(&ФизЛицоСписок)
				|
				|УПОРЯДОЧИТЬ ПО
				|	ФизЛицоНаименование";
			Иначе
				ТекстЗапросаУдержаний = 
				"ВЫБРАТЬ
				|	ПогашениеЗаймовРаботникамиОстатки.ФизЛицо,
				|	ПогашениеЗаймовРаботникамиОстатки.ФизЛицо.Наименование КАК ФизЛицоНаименование,
				|	ПогашениеЗаймовРаботникамиОстатки.СтавкаНалогообложенияМатвыгоды,
				|	ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма,
				|	РаботникиОрганизаций.ПодразделениеОрганизации
				|ИЗ
				|	(ВЫБРАТЬ
				|		ПогашениеЗаймовРаботникамиОстатки.ФизЛицо КАК ФизЛицо,
				|		ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма КАК ДоговорЗайма,
				|		ВЫБОР
				|			КОГДА ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.НачислятьМатериальнуюВыгоду
				|				ТОГДА ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.СтавкаНалогообложенияРезидента
				|			ИНАЧЕ НЕОПРЕДЕЛЕНО
				|		КОНЕЦ КАК СтавкаНалогообложенияМатвыгоды
				|	ИЗ
				|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций.Остатки(
				|				&парамНачало,
				|				Организация = &парамОрганизация
				|					И (ДоговорЗайма.НачалоПогашения <= &парамНачало
				|						ИЛИ ДоговорЗайма.ПроцентЗаПользованиеЗаймом >= 0
				|						ИЛИ ДоговорЗайма.НачислятьМатериальнуюВыгоду)
				|					И Физлицо В
				|						(ВЫБРАТЬ
				|							СписокРаботников.Физлицо
				|						ИЗ
				|							ВТСписокРаботников КАК СписокРаботников
				|						ГДЕ
				|							СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))) КАК ПогашениеЗаймовРаботникамиОстатки
				|	
				|	ОБЪЕДИНИТЬ
				|	
				|	ВЫБРАТЬ РАЗЛИЧНЫЕ
				|		ПогашениеЗаймовРаботникамиОбороты.ФизЛицо,
				|		ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма,
				|		ВЫБОР
				|			КОГДА ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачислятьМатериальнуюВыгоду
				|				ТОГДА ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.СтавкаНалогообложенияРезидента
				|			ИНАЧЕ НЕОПРЕДЕЛЕНО
				|		КОНЕЦ
				|	ИЗ
				|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОбороты
				|	ГДЕ
				|		(ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачалоПогашения <= &парамНачало
				|				ИЛИ ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.ПроцентЗаПользованиеЗаймом >= 0
				|				ИЛИ ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачислятьМатериальнуюВыгоду)
				|		И ПогашениеЗаймовРаботникамиОбороты.Организация = &парамОрганизация
				|		И ПогашениеЗаймовРаботникамиОбороты.ФизЛицо В
				|				(ВЫБРАТЬ
				|					СписокРаботников.Физлицо
				|				ИЗ
				|					ВТСписокРаботников КАК СписокРаботников
				|				ГДЕ
				|					СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
				|		И ПогашениеЗаймовРаботникамиОбороты.Период МЕЖДУ &парамНачало И &парамКонец
				|		И ПогашениеЗаймовРаботникамиОбороты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)) КАК ПогашениеЗаймовРаботникамиОстатки
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК Физлицо,
				|			ВЫБОР
				|				КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &парамКонец
				|						И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизацииЗавершения
				|				ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
				|			КОНЕЦ КАК ПодразделениеОрганизации
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|					&парамКонец,
				|					Организация = &парамГоловнаяОрганизация
				|						И Сотрудник В
				|							(ВЫБРАТЬ
				|								СписокРаботников.Сотрудник
				|							ИЗ
				|								ВТСписокРаботников КАК СписокРаботников
				|							ГДЕ
				|								СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
				|						И Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)) КАК РаботникиОрганизацийСрезПоследних
				|		ГДЕ
				|			ВЫБОР
				|					КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &парамКонец
				|							И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостоянияЗавершения
				|					ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния
				|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) КАК РаботникиОрганизаций
				|		ПО ПогашениеЗаймовРаботникамиОстатки.ФизЛицо = РаботникиОрганизаций.Физлицо
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОбороты
				|		ПО ПогашениеЗаймовРаботникамиОстатки.ФизЛицо = ПогашениеЗаймовРаботникамиОбороты.ФизЛицо
				|			И ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма = ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма
				|			И (ПогашениеЗаймовРаботникамиОбороты.Период МЕЖДУ &парамНачало И &парамКонец)
				|			И (ПогашениеЗаймовРаботникамиОбороты.Регистратор ССЫЛКА Документ.НачислениеЗарплатыРаботникамОрганизаций)
				|			И (ВЫРАЗИТЬ(ПогашениеЗаймовРаботникамиОбороты.Регистратор КАК Документ.НачислениеЗарплатыРаботникамОрганизаций).ПериодРегистрации = &парамПериодРегистрации)
				|ГДЕ
				|	ПогашениеЗаймовРаботникамиОбороты.ФизЛицо ЕСТЬ NULL 
				|	И ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.Проведен
				|
				|УПОРЯДОЧИТЬ ПО
				|	ФизЛицоНаименование";
				
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			//Островская Татьяна 07.05.2013 № 16472
			если СписокСотрудников.Количество() = 0 Тогда 
				ТекстЗапросаУдержаний = СтрЗаменить(ТекстЗапросаУдержаний,"//И ПогашениеЗаймовРаботникамиОстатки.ФизЛицо В(&ФизЛицоСписок)","");
			иначе
				ТекстЗапросаУдержаний = СтрЗаменить(ТекстЗапросаУдержаний,"//И ПогашениеЗаймовРаботникамиОстатки.ФизЛицо В(&ФизЛицоСписок)","И ПогашениеЗаймовРаботникамиОстатки.ФизЛицо В(&ФизЛицоСписок)");
			КонецЕсли;
			//Островская Татьяна 07.05.2013 № 16472
			Запрос.Текст = ТекстЗапросаУдержаний;
			СтруктураПоиска = Новый Структура("ФизЛицо,ДоговорЗайма,Сторно",Неопределено, Неопределено, Ложь);
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681 
			Для каждого СтрокаУдержания Из Запрос.Выполнить().Выгрузить() Цикл
				ЗаполнитьЗначенияСвойств(СтруктураПоиска,СтрокаУдержания);	
				Если ПогашениеЗаймов.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
					ЗаполнитьЗначенияСвойств(ПогашениеЗаймов.Добавить(),СтрокаУдержания)	
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
	Иначе
		
		//Аверсон-софт, Островская Татьяна 13.03.2012
		если МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
			ИЛИ  МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский тогда //Аверсон 10.02.2022 КВВ СВФР-008723
			//Островская Татьяна 07.04.2014 № 17239
			ОсновнойТекстЗапроса =
			"ВЫБРАТЬ
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Организация,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка КАК ДокументОснование,
			|	ДоговорНаВыполнениеРаботСФизЛицом.СуммаЗаРаботу КАК Размер,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ВидРасчета,
			|	ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации
			|ИЗ
			|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|		ПО ПлановыеНачисленияРаботниковОрганизаций.Регистратор = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|			И ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
			|ГДЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
			|	И (ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала МЕЖДУ &ДатаНачала И &ДатаОкончания
			|			ИЛИ &ДатаНачала МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания)
			|	И ПлановыеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ОсновнойТекстЗапроса= ОсновнойТекстЗапроса + "    				
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)";
			КонецЕсли;
			
			
			//Островская Татьяна 07.04.2014 № 17239
			Запрос.УстановитьПараметр("ДатаНачала", НачалоПериодаЗаполнения);
			Запрос.УстановитьПараметр("ДатаОкончания", ОкончаниеПериодаЗаполнения);
			Запрос.УстановитьПараметр("Сотрудник", МассивСотрудники);
			Запрос.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
			//Аверсон-софт, Островская Татьяна 13.03.2012
			
			если ТЧДоговора тогда
				
				// Установим параметры запроса
				Запрос.УстановитьПараметр("парамПериодРегистрации" , ПериодРегистрации);
				Запрос.УстановитьПараметр("парамНачало" , НачалоПериодаЗаполнения);
				Запрос.УстановитьПараметр("парамКонец" , КонецДня(ОкончаниеПериодаЗаполнения));
				Запрос.УстановитьПараметр("парамОрганизация" , Организация);
				Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ГоловнаяОрганизация);
				Запрос.УстановитьПараметр("парамПодразделение" , ПодразделениеОрганизации);
				Запрос.УстановитьПараметр("ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации));  //+ СВЭЙ КДЯ 28.02.20 СВФР-005496
				Запрос.УстановитьПараметр("парамРегистратор" , Ссылка);
				Запрос.УстановитьПараметр("парамНачалоМесяца" , НачалоМесяца(НачалоПериодаЗаполнения));
				Запрос.УстановитьПараметр("парамДатаВалютногоУчета" , НачалоМесяца(НачалоПериодаЗаполнения));
				Запрос.УстановитьПараметр("парамВалютаРегламентУчета" , Константы.ВалютаРегламентированногоУчета.Получить());
				Запрос.УстановитьПараметр("парамМассивСпособовРасчетовБезВалюты" , ПроведениеРасчетов.ПолучитьСписокСпособовРасчетаНеТребующихУказанияВалюты());
				Запрос.УстановитьПараметр("Год",Год(НачалоПериодаЗаполнения));
				Запрос.УстановитьПараметр("ЭтоПерерасчет", ЭтоПерерасчет);
				
				
				СпособыРасчетаОтСтажа = Новый Массив;
				СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам);
				СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням);
				СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке);
				СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке);
				СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
				СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка);
				Запрос.УстановитьПараметр("СпособыРасчетаОтСтажа", СпособыРасчетаОтСтажа);
				
				Если Ссылка.Пустая() Тогда
					СcылкаОбъекта = Документы.НачислениеЗарплатыРаботникамОрганизаций.ПолучитьСсылку();
					УстановитьСсылкуНового(СcылкаОбъекта);
				Иначе
					СcылкаОбъекта = Ссылка;
				КонецЕсли;
				Запрос.УстановитьПараметр("Ссылка", СcылкаОбъекта);
				//О.Т. Аверсон 11.06.2018 № 2060
				СписокДетскихПособийИскл = Новый СписокЗначений;
				для Каждого стр из Справочники.ГруппыРасчетов.ДетскиеПособия.Основные Цикл 
					СписокДетскихПособийИскл.Добавить(стр.ВидРасчета);
				КонецЦикла;         			
				Запрос.УстановитьПараметр("ДетскиеПособияИскл",СписокДетскихПособийИскл);
				Запрос.УстановитьПараметр("Подразделение",ПодразделениеОрганизации);
				
				//О.Т. Аверсон 11.06.2018 № 2060
				
				//ТаблицаДвиженийРаботниковТекст
				//Описание:
				//	Выбирает список работников, отвечающих условиям отбора, числящихся на начало месяца и их движения за месяц.
				
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ
				|	&парамНачало КАК Период,
				|	РаботникиОрганизации.Сотрудник КАК Сотрудник,
				|	ИСТИНА КАК Подходит,
				|	ВЫБОР
				|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения
				|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
				|	КОНЕЦ КАК ПодразделениеОрганизации,
				|	РаботникиОрганизации.ауМестоРаботы КАК ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
				|	ВЫБОР
				|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения
				|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы
				|	КОНЕЦ КАК ГрафикРаботы,
				|	ВЫБОР
				|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА РаботникиОрганизации.ДолжностьЗавершения
				|		ИНАЧЕ РаботникиОрганизации.Должность
				|	КОНЕЦ КАК Должность
				|ПОМЕСТИТЬ ВТДвиженияРаботников
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|			&парамНачало,
				|			Сотрудник В
				|				(ВЫБРАТЬ
				|					ВТСписокРаботников.Сотрудник
				|				ИЗ
				|					ВТСписокРаботников КАК ВТСписокРаботников)) КАК РаботникиОрганизации
				|ГДЕ
				|	ВЫБОР
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ПричинаИзмененияСостоянияЗавершения
				|			ИНАЧЕ РаботникиОрганизации.ПричинаИзмененияСостояния
				|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|	И ВЫБОР
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ОбособленноеПодразделениеЗавершения
				|			ИНАЧЕ РаботникиОрганизации.ОбособленноеПодразделение
				|		КОНЕЦ = &парамОрганизация
				|	И ВЫБОР
				|			КОГДА &ПоВсемПодразделениям
				|				ТОГДА ИСТИНА
				|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
				|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
				|						(ВЫБРАТЬ
				|							Подразделения.Подразделение
				|						ИЗ
				|							ВТПодразделенияОтбора КАК Подразделения)
				|			ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
				|					(ВЫБРАТЬ
				|						Подразделения.Подразделение
				|					ИЗ
				|						ВТПодразделенияОтбора КАК Подразделения)
				|		КОНЕЦ
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|	РаботникиОрганизации.Период,
				|	РаботникиОрганизации.Сотрудник,
				|	ВЫБОР
				|		КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|				И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
				|				И (&ПоВсемПодразделениям
				|					ИЛИ РаботникиОрганизации.ПодразделениеОрганизации В
				|						(ВЫБРАТЬ
				|							Подразделения.Подразделение
				|						ИЗ
				|							ВТПодразделенияОтбора КАК Подразделения))
				|			ТОГДА ИСТИНА
				|		ИНАЧЕ ЛОЖЬ
				|	КОНЕЦ,
				|	РаботникиОрганизации.ПодразделениеОрганизации,
				|	РаботникиОрганизации.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
				|	РаботникиОрганизации.ГрафикРаботы,
				|	РаботникиОрганизации.Должность
				|ИЗ
				|	ВТСписокРаботников КАК СписокРаботников
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
				|		ПО СписокРаботников.Сотрудник = РаботникиОрганизации.Сотрудник
				|ГДЕ
				|	РаботникиОрганизации.Период > &парамНачало
				|	И РаботникиОрганизации.Период <= &парамКонец
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|	Работники.ПериодЗавершения,
				|	Работники.Сотрудник,
				|	ВЫБОР
				|		КОГДА Работники.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|				И Работники.ОбособленноеПодразделениеЗавершения = &парамОрганизация
				|				И (&ПоВсемПодразделениям
				|					ИЛИ Работники.ПодразделениеОрганизацииЗавершения В
				|						(ВЫБРАТЬ
				|							Подразделения.Подразделение
				|						ИЗ
				|							ВТПодразделенияОтбора КАК Подразделения))
				|			ТОГДА ИСТИНА
				|		ИНАЧЕ ЛОЖЬ
				|	КОНЕЦ,
				|	Работники.ПодразделениеОрганизацииЗавершения,
				|	Работники.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
				|	Работники.ГрафикРаботыЗавершения,
				|	Работники.ДолжностьЗавершения
				|ИЗ
				|	ВТСписокРаботников КАК СписокРаботников
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работники
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
				|			ПО (ПериодыПерекрытия.Период <= Работники.ПериодЗавершения)
				|				И (ПериодыПерекрытия.Период > Работники.Период)
				|				И (ПериодыПерекрытия.Сотрудник = Работники.Сотрудник)
				|		ПО СписокРаботников.Сотрудник = Работники.Сотрудник
				|ГДЕ
				|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|	И Работники.ПериодЗавершения > &парамНачало
				|	И Работники.ПериодЗавершения <= &парамКонец
				|	И ПериодыПерекрытия.Период ЕСТЬ NULL 
				|
				//|ОБЪЕДИНИТЬ ВСЕ
				//|
				//|ВЫБРАТЬ
				//|	&парамНачало,
				//|	ДоговорникиОрганизаций.Ссылка,
				//|	ИСТИНА,
				//|	NULL,
				//|	NULL,
				//|	NULL
				//|ИЗ
				//|	ВТСписокРаботников КАК СписокРаботников
				//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СотрудникиОрганизаций КАК ДоговорникиОрганизаций
				//|		ПО СписокРаботников.Сотрудник = ДоговорникиОрганизаций.Ссылка
				//|ГДЕ
				//|	ДоговорникиОрганизаций.ВидДоговора <> ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.ТрудовойДоговор)
				
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";
				Запрос.Выполнить();
				
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	Работники.Сотрудник КАК Сотрудник,
				|	Работники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
				|	ЗначенияПоказателейСхемМотивации.Показатель КАК Показатель,
				|	ЗначенияПоказателейСхемМотивации.Валюта,
				|	ВЫБОР
				|		КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|				И (НЕ ЗначенияПоказателейСхемМотивации.Валюта В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)))
				|			ТОГДА ЗначенияПоказателейСхемМотивации.Значение * ЕСТЬNULL(Валюты.Курс / Валюты.Кратность, 0)
				|		ИНАЧЕ ЗначенияПоказателейСхемМотивации.Значение
				|	КОНЕЦ КАК Значение
				|ПОМЕСТИТЬ ВТЗначенияПоказателей
				|ИЗ
				|	ВТДвиженияРаботников КАК Работники
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			Ежемесячно.Подразделение КАК Подразделение,
				|			Ежемесячно.Показатель КАК Показатель,
				|			Ежемесячно.Валюта КАК Валюта,
				|			Ежемесячно.Значение КАК Значение,
				|			Ежемесячно.Сотрудник КАК Сотрудник
				|		ИЗ
				|			РегистрСведений.ЗначенияПоказателейСхемМотивации КАК Ежемесячно
				|		ГДЕ
				|			Ежемесячно.Значение ЕСТЬ НЕ NULL 
				|			И Ежемесячно.Организация = &парамОрганизация
				|			И Ежемесячно.ПериодДействия >= &парамНачало
				|			И Ежемесячно.ПериодДействия <= &парамКонец
				|		
				|		ОБЪЕДИНИТЬ
				|		
				|		ВЫБРАТЬ
				|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Подразделение,
				|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Показатель,
				|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Валюта,
				|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Значение,
				|			NULL
				|		ИЗ
				|			РегистрСведений.ПериодическиеЗначенияПоказателейСхемМотивации.СрезПоследних(&парамКонец, Организация = &парамОрганизация) КАК ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних) КАК ЗначенияПоказателейСхемМотивации
				|		ПО (ВЫБОР
				|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|						ИЛИ ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя ЕСТЬ NULL 
				|					ТОГДА Работники.Сотрудник = ЗначенияПоказателейСхемМотивации.Сотрудник
				|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|					ТОГДА Работники.ПодразделениеОрганизации = ЗначенияПоказателейСхемМотивации.Подразделение
				|				ИНАЧЕ ИСТИНА
				|			КОНЕЦ)
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты
				|		ПО (Валюты.Период = &парамДатаВалютногоУчета)
				|			И (ЗначенияПоказателейСхемМотивации.Валюта = Валюты.Валюта)";
				Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
					Запрос.Текст = Запрос.Текст + "    				
					|	ГДЕ Работники.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)";
				КонецЕсли;
				Запрос.Текст = Запрос.Текст + "  
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Показатель
				|";
				
				Запрос.Выполнить();
				
				Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет 
					ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНачислений 
					ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетУдержаний 
					ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ
					ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
					
					// таблица НеЗапрашиваемыеПриКадровыхПеремещениях
					// 	выбираем показатели, которые не спрашиваем у пользователя в кадровых документах, а также все "тарифные ставки" и их в.р.;
					//  значения этих показателей будем искать в данных о плановых начислениях, но, возможно, при других видах расчета
					// 
					//	Поля:
					//		Ссылка - вид расчета
					//		Показатель
					//		НомерСтроки - номер строки показателя
					//		ЭтоТарифнаяСтавка - признак того. что Показатель является тарифной ставкой
					// 
					
					Запрос.Текст =
					"ВЫБРАТЬ
					|	ОсновныеНачисленияОрганизацийПоказатели.Показатель КАК Показатель,
					|	ОсновныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
					|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки КАК НомерСтроки,
					|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка КАК Ссылка,
					|	ВЫБОР
					|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
					|			ТОГДА ИСТИНА
					|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
					|			ТОГДА ИСТИНА
					|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
					|			ТОГДА ИСТИНА
					|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
					|			ТОГДА ИСТИНА
					|		ИНАЧЕ ЛОЖЬ
					|	КОНЕЦ КАК ЭтоТарифнаяСтавка
					|ПОМЕСТИТЬ ВТНеЗапрашиваемыеПриКадровыхПеремещениях
					|ИЗ
					|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
					|ГДЕ
					|	((НЕ ОсновныеНачисленияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
					|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
					|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
					|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
					|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
					|	И ОсновныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
					|
					|ОБЪЕДИНИТЬ
					|
					|ВЫБРАТЬ
					|	ДополнительныеНачисленияОрганизацийПоказатели.Показатель,
					|	ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
					|	ДополнительныеНачисленияОрганизацийПоказатели.НомерСтроки,
					|	ДополнительныеНачисленияОрганизацийПоказатели.Ссылка,
					|	ВЫБОР
					|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
					|			ТОГДА ИСТИНА
					|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
					|			ТОГДА ИСТИНА
					|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
					|			ТОГДА ИСТИНА
					|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
					|			ТОГДА ИСТИНА
					|		ИНАЧЕ ЛОЖЬ
					|	КОНЕЦ
					|ИЗ
					|	ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК ДополнительныеНачисленияОрганизацийПоказатели
					|ГДЕ
					|	((НЕ ДополнительныеНачисленияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
					|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
					|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
					|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
					|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
					|	И ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
					|
					|ОБЪЕДИНИТЬ
					|
					|ВЫБРАТЬ
					|	УдержанияОрганизацийПоказатели.Показатель,
					|	УдержанияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
					|	УдержанияОрганизацийПоказатели.НомерСтроки,
					|	УдержанияОрганизацийПоказатели.Ссылка,
					|	ВЫБОР
					|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
					|			ТОГДА ИСТИНА
					|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
					|			ТОГДА ИСТИНА
					|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
					|			ТОГДА ИСТИНА
					|		КОГДА УдержанияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
					|			ТОГДА ИСТИНА
					|		ИНАЧЕ ЛОЖЬ
					|	КОНЕЦ
					|ИЗ
					|	ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК УдержанияОрганизацийПоказатели
					|ГДЕ
					|	((НЕ УдержанияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
					|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
					|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
					|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
					|			ИЛИ УдержанияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
					|	И УдержанияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
					|
					|ИНДЕКСИРОВАТЬ ПО
					|	Показатель";
					Запрос.Выполнить();
					
					// таблица ВводимыеВПлановыхНачисленияхПоказатели
					//  виды расчета и показатели, значения которых находятся при этих в.р. в данных о плановых начислениях
					// 
					//	Поля:
					//		Ссылка - вид расчета
					//		Показатель
					//		НомерСтроки - номер строки показателя
					// 
					Запрос.Текст =
					"ВЫБРАТЬ РАЗЛИЧНЫЕ
					|	ОсновныеНачисленияОрганизаций.Ссылка КАК Ссылка,
					|	ВЫБОР
					|		КОГДА ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам))
					|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
					|		КОГДА ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок))
					|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
					|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
					|	КОНЕЦ КАК Показатель,
					|	1 КАК НомерСтроки,
					|	ИСТИНА КАК ЭтоТарифнаяСтавка
					|ПОМЕСТИТЬ ВТВводимыеВПлановыхНачисленияхПоказатели
					|ИЗ
					|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
					|ГДЕ
					|	(ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке))
					|	 ИЛИ ОсновныеНачисленияОрганизаций.Ссылка = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)) //О.Т. Аверсон 11.04.2017 № 513
					|	И выбор когда ОсновныеНачисленияОрганизаций.Ссылка = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты) тогда истина иначе ОсновныеНачисленияОрганизаций.ЗачетОтработанногоВремени конец //О.Т. Аверсон 11.03.2019 № 4039 условие на вид расчета
					|
					|ОБЪЕДИНИТЬ
					|
					|ВЫБРАТЬ РАЗЛИЧНЫЕ
					|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка,
					|	ОсновныеНачисленияОрганизацийПоказатели.Показатель,
					|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки,
					|	ИСТИНА
					|ИЗ
					|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
					|ГДЕ
					|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка.ЗачетОтработанногоВремени
					|	И ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
					|	И (НЕ ОсновныеНачисленияОрганизацийПоказатели.Показатель.Предопределенный)
					|
					|ОБЪЕДИНИТЬ
					|
					|ВЫБРАТЬ РАЗЛИЧНЫЕ
					|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка,
					|	ОсновныеНачисленияОрганизацийПоказатели.Показатель,
					|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки,
					|	ЛОЖЬ
					|ИЗ
					|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
					|ГДЕ
					|	ОсновныеНачисленияОрганизацийПоказатели.Показатель В
					|			(ВЫБРАТЬ
					|				ВТНеЗапрашиваемыеПриКадровыхПеремещениях.Показатель
					|			ИЗ
					|				ВТНеЗапрашиваемыеПриКадровыхПеремещениях)
					|	И (НЕ ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
					|
					|ИНДЕКСИРОВАТЬ ПО
					|	Ссылка";
					
					Запрос.Выполнить();
					
					// РаботникиИНачисления
					//		Таблица движений работников с добавленными сведениями об их плановых начислениях
					// 
					//	Поля:
					//		Сотрудник 
					//		ВидРасчета - плановое начисление 
					//		Показатель1,...,6 - размеры показателей 
					//		СпособРасчета - способ расчета начисления 
					//		ГрафикРаботы - график сотрудника  
					//		ВидГрафика, СуммированныйУчетРабочегоВремени, ДлительностьРабочейНедели - реквизиты графика сотрудника 
					// 
					// Описание:
					//
					//	1. 
					//  2. 
					//
					ПособиеСписок = Новый СписокЗначений; //О.Т. Аверсон 23.06.2016 № 1267
					ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаВторогоИПоследующихДо3Лет);
					ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаСтарше3Лет);
					ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаДетейОт3До18);//О.Т. Аверсон 27.03.2018 № 1771
					
					//О.Т. Аверсон 14.06.2018 № 
					СпособыРасчетаСписок = Новый СписокЗначений;			
					СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей);
					СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид);
					СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида);
					//О.Т. Аверсон 14.06.2018 № 
					
					Запрос.УстановитьПараметр("ВидРасчетаПособие", ПособиеСписок);
					Запрос.УстановитьПараметр("СпособыРасчетаПособие", СпособыРасчетаСписок);
					Запрос.Текст =
					"ВЫБРАТЬ
					|	Работники.Сотрудник КАК Сотрудник,
					|	Работники.Сотрудник.Наименование КАК СотрудникНаименование,
					|	Работники.Сотрудник.Физлицо КАК Физлицо,
					|	ВЫБОР
					|		КОГДА Работники.Период >= НачисленияРаботниковОрганизации.Период
					|				ИЛИ НачисленияРаботниковОрганизации.Период ЕСТЬ NULL 
					|			ТОГДА Работники.Период
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Период
					|	КОНЕЦ КАК Период,
					|	Работники.Подходит,
					|	Работники.Период КАК ПериодРаботники,
					|	НачисленияРаботниковОрганизации.Период КАК ПериодНачисления,
					|	НачисленияРаботниковОрганизации.ОсновноеНачисление,
					|	НачисленияРаботниковОрганизации.ВидРасчета,
					|	НачисленияРаботниковОрганизации.ВидРасчета.Наименование,
					|	НачисленияРаботниковОрганизации.ВидРасчета.ВидСтажа,
					|	НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда,
					|	НачисленияРаботниковОрганизации.ВидРасчета.КоэффициентСтажа,
					|	НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета КАК СпособРасчета,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
					|			ТОГДА НачисленияРаботниковОрганизации.ВидРасчета.ВидВремени
					|		ИНАЧЕ NULL
					|	КОНЕЦ КАК ВидВремени,
					|	НачисленияРаботниковОрганизации.Действие КАК Действие,
					|	ЕСТЬNULL(НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ.КодВычета, ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)) КАК КодВычета,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
					|				ИЛИ НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
					|					И (НачисленияРаботниковОрганизации.ТарифныйРазряд1 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
					|						И НачисленияРаботниковОрганизации.ТарифныйРазряд1 ЕСТЬ НЕ NULL )
					|			ТОГДА ТарифныеСтавки1.Размер
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
					|	КОНЕЦ КАК Показатель1,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд2 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд2 ЕСТЬ НЕ NULL 
					|			ТОГДА ТарифныеСтавки2.Размер
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель2
					|	КОНЕЦ КАК Показатель2,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд3 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд3 ЕСТЬ НЕ NULL 
					|			ТОГДА ТарифныеСтавки3.Размер
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель3
					|	КОНЕЦ КАК Показатель3,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд4 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд4 ЕСТЬ НЕ NULL 
					|			ТОГДА ТарифныеСтавки4.Размер
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель4
					|	КОНЕЦ КАК Показатель4,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд5 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд5 ЕСТЬ НЕ NULL 
					|			ТОГДА ТарифныеСтавки5.Размер
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель5
					|	КОНЕЦ КАК Показатель5,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд6 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
					|				И НачисленияРаботниковОрганизации.ТарифныйРазряд6 ЕСТЬ НЕ NULL 
					|			ТОГДА ТарифныеСтавки6.Размер
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель6
					|	КОНЕЦ КАК Показатель6,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
					|			ТОГДА ТарифныеСтавки1.Валюта
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
					|	КОНЕЦ КАК Валюта1,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
					|			ТОГДА ТарифныеСтавки2.Валюта
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта2
					|	КОНЕЦ КАК Валюта2,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
					|			ТОГДА ТарифныеСтавки3.Валюта
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта3
					|	КОНЕЦ КАК Валюта3,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
					|			ТОГДА ТарифныеСтавки4.Валюта
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта4
					|	КОНЕЦ КАК Валюта4,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
					|			ТОГДА ТарифныеСтавки5.Валюта
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта5
					|	КОНЕЦ КАК Валюта5,
					|	ВЫБОР
					|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
					|			ТОГДА ТарифныеСтавки6.Валюта
					|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта6
					|	КОНЕЦ КАК Валюта6,
					|	НачисленияРаботниковОрганизации.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
					|	Работники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
					|	Работники.ауМестоРаботы КАК ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
					|	Работники.ГрафикРаботы КАК ГрафикРаботы,
					|	ЕСТЬNULL(Работники.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени,
					|	ЕСТЬNULL(ВЫБОР
					|			КОГДА Работники.ГрафикРаботы.СокращенноеРабочееВремя
					|					И Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
					|				ТОГДА Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели
					|			ИНАЧЕ Работники.ГрафикРаботы.ДлительностьРабочейНедели
					|		КОНЕЦ, 0) КАК ДлительностьРабочейНедели,
					|	Работники.ГрафикРаботы.ВидГрафика КАК ВидГрафика,
					|	Работники.Должность КАК Должность,
					|	НачисленияРаботниковОрганизации.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
					|	НачисленияРаботниковОрганизации.ПериодЗавершения КАК ПериодЗавершения"
					
					//Аверсон ЕАЕ 09.03.2022 СВФР-008825
					+ ?(Организация.ИНН = "100071565", ",
					|   НачисленияРаботниковОрганизации.СовмещаемаяПрофессия", "") + "
					//Аверсон СВФР-008825
					
					|ПОМЕСТИТЬ ВТРаботникиИНачисления
					|ИЗ
					|	ВТДвиженияРаботников КАК Работники
					|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					|			&парамНачало КАК Период,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
					|					ТОГДА ИСТИНА
					|				ИНАЧЕ ЛОЖЬ
					|			КОНЕЦ КАК ОсновноеНачисление,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ВЫБОР
					|							КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|								ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
					|							ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
					|						КОНЕЦ
					|				ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
					|			КОНЕЦ КАК ВидРасчета,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Действие
					|			КОНЕЦ КАК Действие,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Показатель1Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
					|			КОНЕЦ КАК Показатель1,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Показатель2Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель2
					|			КОНЕЦ КАК Показатель2,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Показатель3Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель3
					|			КОНЕЦ КАК Показатель3,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Показатель4Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель4
					|			КОНЕЦ КАК Показатель4,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Показатель5Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель5
					|			КОНЕЦ КАК Показатель5,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Показатель6Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель6
					|			КОНЕЦ КАК Показатель6,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Валюта1Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
					|			КОНЕЦ КАК Валюта1,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Валюта2Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта2
					|			КОНЕЦ КАК Валюта2,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Валюта3Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта3
					|			КОНЕЦ КАК Валюта3,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Валюта4Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта4
					|			КОНЕЦ КАК Валюта4,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Валюта5Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта5
					|			КОНЕЦ КАК Валюта5,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.Валюта6Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта6
					|			КОНЕЦ КАК Валюта6,
					|			НачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник,
					|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд1Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд1
					|			КОНЕЦ КАК ТарифныйРазряд1,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд2Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд2
					|			КОНЕЦ КАК ТарифныйРазряд2,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд3Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд3
					|			КОНЕЦ КАК ТарифныйРазряд3,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд4Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд4
					|			КОНЕЦ КАК ТарифныйРазряд4,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд5Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд5
					|			КОНЕЦ КАК ТарифныйРазряд5,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд6Завершения
					|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд6
					|			КОНЕЦ КАК ТарифныйРазряд6,
					|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
					|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ПериодЗавершения"
					
					//Аверсон ЕАЕ 09.03.2022 СВФР-008825
					+ ?(Организация.ИНН = "100071565", ",
					|   		НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
					//Аверсон СВФР-008825
					
					|		ИЗ
					|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
					|					&парамНачало,
					|					ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
					|						И Сотрудник В
					|							(ВЫБРАТЬ
					|								Работники.Сотрудник
					|							ИЗ
					|								ВТСписокРаботников КАК Работники)) КАК НачисленияРаботниковОрганизации
					|		ГДЕ
					|			ВЫБОР
					|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|						ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
					|					ИНАЧЕ НачисленияРаботниковОрганизации.Действие
					|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|			И Не (ВЫБОР
					|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|						ТОГДА ВЫБОР
					|								КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|									ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
					|								ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
					|							КОНЕЦ
					|					ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
					|				КОНЕЦ) В (&ВидРасчетаПособие)
					//О.Т. Аверсон 14.06.2018 № 
					|			И Не (ВЫБОР
					|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
					|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|						ТОГДА ВЫБОР
					|								КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|									ТОГДА НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета
					|								ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения.СпособРасчета
					|							КОНЕЦ
					|					ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета
					|				КОНЕЦ) В (&СпособыРасчетаПособие)
					//О.Т. Аверсон 14.06.2018 № 
					|		
					|		ОБЪЕДИНИТЬ ВСЕ
					|		
					|		ВЫБРАТЬ
					|			НачисленияРаботниковОрганизации.Период,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
					|					ТОГДА ИСТИНА
					|				ИНАЧЕ ЛОЖЬ
					|			КОНЕЦ,
					|			НачисленияРаботниковОрганизации.ВидРасчета,
					|			НачисленияРаботниковОрганизации.Действие,
					|			НачисленияРаботниковОрганизации.Показатель1,
					|			НачисленияРаботниковОрганизации.Показатель2,
					|			НачисленияРаботниковОрганизации.Показатель3,
					|			НачисленияРаботниковОрганизации.Показатель4,
					|			НачисленияРаботниковОрганизации.Показатель5,
					|			НачисленияРаботниковОрганизации.Показатель6,
					|			НачисленияРаботниковОрганизации.Валюта1,
					|			НачисленияРаботниковОрганизации.Валюта2,
					|			НачисленияРаботниковОрганизации.Валюта3,
					|			НачисленияРаботниковОрганизации.Валюта4,
					|			НачисленияРаботниковОрганизации.Валюта5,
					|			НачисленияРаботниковОрганизации.Валюта6,
					|			НачисленияРаботниковОрганизации.Сотрудник,
					|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд1,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд2,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд3,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд4,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд5,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд6,
					|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде,
					|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)"
					
					//Аверсон ЕАЕ 09.03.2022 СВФР-008825
					+ ?(Организация.ИНН = "100071565", ",
					|   		НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
					//Аверсон СВФР-008825
					
					|		ИЗ
					|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
					|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
					|				ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
					|		ГДЕ
					|			НачисленияРаботниковОрганизации.Период > &парамНачало
					|			И НачисленияРаботниковОрганизации.Период <= &парамКонец
					|			И НачисленияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
					|			И НачисленияРаботниковОрганизации.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
					|			И НачисленияРаботниковОрганизации.ИспользуетсяВНаряде = ЛОЖЬ
					|		
					|		ОБЪЕДИНИТЬ ВСЕ
					|		
					|		ВЫБРАТЬ
					|			НачисленияРаботниковОрганизации.ПериодЗавершения,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
					|					ТОГДА ИСТИНА
					|				ИНАЧЕ ЛОЖЬ
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|					ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
					|				ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
					|			КОНЕЦ,
					|			НачисленияРаботниковОрганизации.ДействиеЗавершения,
					|			НачисленияРаботниковОрганизации.Показатель1Завершения,
					|			НачисленияРаботниковОрганизации.Показатель2Завершения,
					|			НачисленияРаботниковОрганизации.Показатель3Завершения,
					|			НачисленияРаботниковОрганизации.Показатель4Завершения,
					|			НачисленияРаботниковОрганизации.Показатель5Завершения,
					|			НачисленияРаботниковОрганизации.Показатель6Завершения,
					|			НачисленияРаботниковОрганизации.Валюта1Завершения,
					|			НачисленияРаботниковОрганизации.Валюта2Завершения,
					|			НачисленияРаботниковОрганизации.Валюта3Завершения,
					|			НачисленияРаботниковОрганизации.Валюта4Завершения,
					|			НачисленияРаботниковОрганизации.Валюта5Завершения,
					|			НачисленияРаботниковОрганизации.Валюта6Завершения,
					|			НачисленияРаботниковОрганизации.Сотрудник,
					|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд1Завершения,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд2Завершения,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд3Завершения,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд4Завершения,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд5Завершения,
					|			НачисленияРаботниковОрганизации.ТарифныйРазряд6Завершения,
					|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде,
					|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)"
					
					//Аверсон ЕАЕ 09.03.2022 СВФР-008825
					+ ?(Организация.ИНН = "100071565", ",
					|   		НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
					//Аверсон СВФР-008825
					
					|		ИЗ
					|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
					|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
					|				ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
					|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковПроверка
					|				ПО НачисленияРаботниковОрганизации.Сотрудник = НачисленияРаботниковПроверка.Сотрудник
					|					И НачисленияРаботниковОрганизации.ВидРасчетаИзмерение = НачисленияРаботниковПроверка.ВидРасчетаИзмерение
					|					И НачисленияРаботниковОрганизации.ДокументОснование = НачисленияРаботниковПроверка.ДокументОснование
					|					И (НачисленияРаботниковПроверка.Период > НачисленияРаботниковОрганизации.Период)
					|					И (НачисленияРаботниковПроверка.Период <= НачисленияРаботниковОрганизации.ПериодЗавершения)
					|		ГДЕ
					|			НачисленияРаботниковОрганизации.ПериодЗавершения >= &парамНачало
					|			И НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамКонец
					|			И НачисленияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
					|			И НачисленияРаботниковОрганизации.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
					|			И НачисленияРаботниковОрганизации.ИспользуетсяВНаряде = ЛОЖЬ
					|			И НачисленияРаботниковПроверка.Сотрудник ЕСТЬ NULL 
					|		
					|		ОБЪЕДИНИТЬ ВСЕ
					|		
					|		ВЫБРАТЬ
					|			&парамНачало,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
					|					ТОГДА ИСТИНА
					|				ИНАЧЕ ЛОЖЬ
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ВЫБОР
					|							КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|								ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
					|							ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения
					|						КОНЕЦ
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Действие
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель1Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель1
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель2Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель2
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель3Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель3
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель4Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель4
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель5Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель5
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель6Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель6
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта1Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта1
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта2Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта2
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта3Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта3
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта4Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта4
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта5Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта5
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта6Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта6
					|			КОНЕЦ,
					|			ПлановыеНачисленияРаботниковОрганизаций.Сотрудник,
					|			ПлановыеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд1Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд1
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд2Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд2
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд3Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд3
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд4Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд4
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд5Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд5
					|			КОНЕЦ,
					|			ВЫБОР
					|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд6Завершения
					|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд6
					|			КОНЕЦ,
					|			ПлановыеНачисленияРаботниковОрганизаций.ИспользуетсяВНаряде,
					|			ВЫБОР
					|			КОГДА НАЧАЛОПЕРИОДА(ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения, МЕСЯЦ) = &парамНачало
					|			ТОГДА ДОБАВИТЬКДАТЕ(ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения, ДЕНЬ, -1)
					|			ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|			КОНЕЦ"
					
					//Аверсон ЕАЕ 09.03.2022 СВФР-008825
					+ ?(Организация.ИНН = "100071565", ",
					|   		ПлановыеНачисленияРаботниковОрганизаций.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
					//Аверсон СВФР-008825
					
					|		ИЗ
					|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
					|		ГДЕ
					|			ВЫБОР
					|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|						ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения
					|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Действие
					|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|			И (ВЫБОР
					|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|						ТОГДА ВЫБОР
					|								КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|									ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
					|								ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения
					|							КОНЕЦ
					|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
					|				КОНЕЦ В (&ВидРасчетаПособие) или ВЫБОР
					|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
					|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					|						ТОГДА ВЫБОР
					|								КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					|									ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета
					|								ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения.СпособРасчета
					|							КОНЕЦ
					|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета
					|				КОНЕЦ В (&СпособыРасчетаПособие) )
					
					|			И ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
					|			И ПлановыеНачисленияРаботниковОрганизаций.Сотрудник В
					|					(ВЫБРАТЬ
					|						Работники.Сотрудник
					|					ИЗ
					|						ВТСписокРаботников КАК Работники)) КАК НачисленияРаботниковОрганизации
					|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки1
					|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд1 = ТарифныеСтавки1.ТарифныйРазряд
					|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки2
					|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд2 = ТарифныеСтавки2.ТарифныйРазряд
					|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки3
					|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд3 = ТарифныеСтавки3.ТарифныйРазряд
					|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки4
					|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд4 = ТарифныеСтавки4.ТарифныйРазряд
					|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки5
					|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд5 = ТарифныеСтавки5.ТарифныйРазряд
					|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки6
					|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд6 = ТарифныеСтавки6.ТарифныйРазряд
					|		ПО (Работники.Подходит)
					|			И Работники.Сотрудник = НачисленияРаботниковОрганизации.Сотрудник
					
					//Аверсон ЕАЕ 21.03.2022 СВФР-008825
					//|			И Работники.Период = НачисленияРаботниковОрганизации.Период
					//Аверсон СВФР-008825
					
					|";
					Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
						Запрос.Текст = Запрос.Текст + "    				
						|	ГДЕ Работники.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)";
					КонецЕсли;
					Запрос.Текст = Запрос.Текст + "
					|
					|ИНДЕКСИРОВАТЬ ПО
					|	Сотрудник";	
					//|
					//|ОБЪЕДИНИТЬ ВСЕ
					//|
					//|ВЫБРАТЬ
					//|	Работники.Сотрудник,
					//|	Работники.Сотрудник.Наименование,
					//|	Работники.Сотрудник.Физлицо,
					//|	ВЫБОР
					//|		КОГДА Работники.Период >= ШтатноеРасписание.Период
					//|				ИЛИ ШтатноеРасписание.Период ЕСТЬ NULL 
					//|			ТОГДА Работники.Период
					//|		ИНАЧЕ ШтатноеРасписание.Период
					//|	КОНЕЦ,
					//|	Работники.Подходит,
					//|	Работники.Период,
					//|	ШтатноеРасписание.Период,
					//|	ЛОЖЬ,
					//|	ШтатноеРасписание.ВидНадбавки,
					//|	ШтатноеРасписание.ВидНадбавки.Наименование,
					//|	ШтатноеРасписание.ВидНадбавки.ВидСтажа,
					//|	ШтатноеРасписание.ВидНадбавки.ТребуетВводаТарифногоРазряда,
					//|	ШтатноеРасписание.ВидНадбавки.КоэффициентСтажа,
					//|	ШтатноеРасписание.ВидНадбавки.СпособРасчета,
					//|	ВЫБОР
					//|		КОГДА ШтатноеРасписание.ВидНадбавки ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
					//|			ТОГДА ШтатноеРасписание.ВидНадбавки.ВидВремени
					//|		ИНАЧЕ NULL
					//|	КОНЕЦ,
					//|	ШтатноеРасписание.Действие,
					//|	ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка),
					//|	ШтатноеРасписание.Показатель1,
					//|	ШтатноеРасписание.Показатель2,
					//|	ШтатноеРасписание.Показатель3,
					//|	ШтатноеРасписание.Показатель4,
					//|	ШтатноеРасписание.Показатель5,
					//|	ШтатноеРасписание.Показатель6,
					//|	ШтатноеРасписание.Валюта1,
					//|	ШтатноеРасписание.Валюта2,
					//|	ШтатноеРасписание.Валюта3,
					//|	ШтатноеРасписание.Валюта4,
					//|	ШтатноеРасписание.Валюта5,
					//|	ШтатноеРасписание.Валюта6,
					//|	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
					//|	Работники.ПодразделениеОрганизации,
					//|	Работники.ГрафикРаботы,
					//|	ЕСТЬNULL(Работники.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ),
					//|	ЕСТЬNULL(ВЫБОР
					//|			КОГДА Работники.ГрафикРаботы.СокращенноеРабочееВремя
					//|					И Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
					//|				ТОГДА Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели
					//|			ИНАЧЕ Работники.ГрафикРаботы.ДлительностьРабочейНедели
					//|		КОНЕЦ, 0),
					//|	Работники.ГрафикРаботы.ВидГрафика,
					//|	Работники.Должность
					//|ИЗ
					//|	ВТДвиженияРаботников КАК Работники
					//|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					//|			&парамНачало КАК Период,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.ВидНадбавки КАК ВидНадбавки,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель1 КАК Показатель1,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель2 КАК Показатель2,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель3 КАК Показатель3,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель4 КАК Показатель4,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель5 КАК Показатель5,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель6 КАК Показатель6,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта1 КАК Валюта1,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта2 КАК Валюта2,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта3 КАК Валюта3,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта4 КАК Валюта4,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта5 КАК Валюта5,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта6 КАК Валюта6,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Должность КАК Должность,
					//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
					//|			ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Изменить) КАК Действие
					//|		ИЗ
					//|			РегистрСведений.НадбавкиПоШтатномуРасписаниюОрганизаций.СрезПоследних(
					//|					&парамНачало,
					//|					ПодразделениеОрганизации В
					//|						(ВЫБРАТЬ
					//|							ДвиженияРаботников.ПодразделениеОрганизации
					//|						ИЗ
					//|							ВТДвиженияРаботников КАК ДвиженияРаботников)) КАК НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних
					//|		ГДЕ
					//|			(НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель1 > 0
					//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель2 > 0
					//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель3 > 0
					//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель4 > 0
					//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель5 > 0
					//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель6 > 0)
					//|		
					//|		ОБЪЕДИНИТЬ ВСЕ
					//|		
					//|		ВЫБРАТЬ
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Период,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.ВидНадбавки,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель1,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель2,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель3,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель4,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель5,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель6,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта1,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта2,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта3,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта4,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта5,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта6,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Должность,
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.ПодразделениеОрганизации,
					//|			ВЫБОР
					//|				КОГДА НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель1 = 0
					//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель2 = 0
					//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель3 = 0
					//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель4 = 0
					//|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
					//|				ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Изменить)
					//|			КОНЕЦ
					//|		ИЗ
					//|			РегистрСведений.НадбавкиПоШтатномуРасписаниюОрганизаций КАК НадбавкиПоШтатномуРасписаниюОрганизаций
					//|		ГДЕ
					//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Период > &парамНачало
					//|			И НадбавкиПоШтатномуРасписаниюОрганизаций.Период <= &парамКонец
					//|			И НадбавкиПоШтатномуРасписаниюОрганизаций.ПодразделениеОрганизации В
					//|					(ВЫБРАТЬ
					//|						ДвиженияРаботников.ПодразделениеОрганизации
					//|					ИЗ
					//|						ВТДвиженияРаботников КАК ДвиженияРаботников)) КАК ШтатноеРасписание
					//|		ПО Работники.ПодразделениеОрганизации = ШтатноеРасписание.ПодразделениеОрганизации
					//|			И Работники.Должность = ШтатноеРасписание.Должность
					
					
					Запрос.Выполнить();
					
					//получим все невводимые показатели
					Запрос.Текст = 
					"ВЫБРАТЬ
					|	СписокНачислений.Сотрудник КАК Сотрудник,
					|	СписокНачислений.Период,
					|	СписокНачислений.ПериодРаботники КАК ПериодРаботники,
					|	СписокНачислений.ПериодНачисления КАК ПериодНачисления,
					|	ВводимыеПоказатели.Показатель КАК Показатель,
					|	ВЫБОР
					//О.Т. Аверсон 11.03.2019 № 4039
					|	КОГДА СписокНачислений.ВидРасчета = ЗНАЧЕНИЕ(Планвидоврасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)
					|	ТОГДА 1
					//О.Т. Аверсон 11.03.2019 № 4039 
					|		КОГДА ВводимыеПоказатели.НомерСтроки = 1
					|			ТОГДА СписокНачислений.Показатель1
					|		КОГДА ВводимыеПоказатели.НомерСтроки = 2
					|			ТОГДА СписокНачислений.Показатель2
					|		КОГДА ВводимыеПоказатели.НомерСтроки = 3
					|			ТОГДА СписокНачислений.Показатель3
					|		КОГДА ВводимыеПоказатели.НомерСтроки = 4
					|			ТОГДА СписокНачислений.Показатель4
					|		КОГДА ВводимыеПоказатели.НомерСтроки = 5
					|			ТОГДА СписокНачислений.Показатель5
					|		КОГДА ВводимыеПоказатели.НомерСтроки = 6
					|			ТОГДА СписокНачислений.Показатель6
					|	КОНЕЦ КАК ЗначениеПоказателя
					|ПОМЕСТИТЬ ВТЗначенияВводимыхКадровыхПоказателей
					|ИЗ
					|	ВТРаботникиИНачисления КАК СписокНачислений
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВводимыеВПлановыхНачисленияхПоказатели КАК ВводимыеПоказатели
					|		ПО СписокНачислений.ВидРасчета = ВводимыеПоказатели.Ссылка
					|
					|ИНДЕКСИРОВАТЬ ПО
					|	Показатель
					|";
					Запрос.Выполнить();
					
				КонецЕсли;
			КонецЕсли;
			
			
			
		иначе
			
			// Установим параметры запроса
			Запрос.УстановитьПараметр("парамПериодРегистрации" , ПериодРегистрации);
			Запрос.УстановитьПараметр("парамНачало" , НачалоПериодаЗаполнения);
			Запрос.УстановитьПараметр("парамКонец" , КонецДня(ОкончаниеПериодаЗаполнения));
			Запрос.УстановитьПараметр("парамОрганизация" , Организация);
			Запрос.УстановитьПараметр("парамГоловнаяОрганизация", ГоловнаяОрганизация);
			Запрос.УстановитьПараметр("парамПодразделение" , ПодразделениеОрганизации);
			Запрос.УстановитьПараметр("ВсеПодразделения" , НЕ ЗначениеЗаполнено(ПодразделениеОрганизации));  //+ СВЭЙ КДЯ 28.02.20 СВФР-005496
			Запрос.УстановитьПараметр("парамРегистратор" , Ссылка);
			Запрос.УстановитьПараметр("парамНачалоМесяца" , НачалоМесяца(НачалоПериодаЗаполнения));
			Запрос.УстановитьПараметр("парамДатаВалютногоУчета" , НачалоМесяца(НачалоПериодаЗаполнения));
			Запрос.УстановитьПараметр("парамВалютаРегламентУчета" , Константы.ВалютаРегламентированногоУчета.Получить());
			Запрос.УстановитьПараметр("парамМассивСпособовРасчетовБезВалюты" , ПроведениеРасчетов.ПолучитьСписокСпособовРасчетаНеТребующихУказанияВалюты());
			Запрос.УстановитьПараметр("Год",Год(НачалоПериодаЗаполнения));
			Запрос.УстановитьПараметр("ЭтоПерерасчет", ЭтоПерерасчет);
			
			
			СпособыРасчетаОтСтажа = Новый Массив;
			СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоЧасам);
			СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоМесячнойТарифнойСтавкеПоДням);
			СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоДневнойТарифнойСтавке);
			СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПоЧасовойТарифнойСтавке);
			СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом);
			СпособыРасчетаОтСтажа.Добавить(Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка);
			Запрос.УстановитьПараметр("СпособыРасчетаОтСтажа", СпособыРасчетаОтСтажа);
			
			Если Ссылка.Пустая() Тогда
				СcылкаОбъекта = Документы.НачислениеЗарплатыРаботникамОрганизаций.ПолучитьСсылку();
				УстановитьСсылкуНового(СcылкаОбъекта);
			Иначе
				СcылкаОбъекта = Ссылка;
			КонецЕсли;
			Запрос.УстановитьПараметр("Ссылка", СcылкаОбъекта);
			
			//О.Т. Аверсон 11.06.2018 № 2060
			СписокДетскихПособийИскл = Новый СписокЗначений;
			для Каждого стр из Справочники.ГруппыРасчетов.ДетскиеПособия.Основные Цикл 
				СписокДетскихПособийИскл.Добавить(стр.ВидРасчета);
			КонецЦикла;         			
			Запрос.УстановитьПараметр("ДетскиеПособияИскл",СписокДетскихПособийИскл);
			//О.Т. Аверсон 11.06.2018 № 2060
			
			//ТаблицаДвиженийРаботниковТекст
			//Описание:
			//	Выбирает список работников, отвечающих условиям отбора, числящихся на начало месяца и их движения за месяц.
			
			//Аверсон 25.05.2022 КВВ СВФР-009084 (
			Запрос.Текст = "";
			Если РазбиватьПериодыПоНазначениюБригады Тогда
				
				//Аверсон 16.01.2023 КВВ СВФР-010142 (
				
				//Запрос.Текст = "
				//|ВЫБРАТЬ РАЗРЕШЕННЫЕ
				//|&парамНачало КАК Период,
				//|НазначениеСотрудниковПоБригадамСрезПоследних.Сотрудник,
				//|РОНач.Период КАК ДатаИзменения
				//|ПОМЕСТИТЬ ВТПериодыНБ1
				//|ИЗ                                                                                          
				//|РегистрСведений.НазначениеСотрудниковПоБригадам.СрезПоследних(&парамНачало, Сотрудник В (ВЫБРАТЬ ВТСписокРаботников.Сотрудник ИЗ ВТСписокРаботников КАК ВТСписокРаботников)) КАК НазначениеСотрудниковПоБригадамСрезПоследних
				//|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамНачало) КАК РОНач
				//|ПО НазначениеСотрудниковПоБригадамСрезПоследних.Сотрудник = РОНач.Сотрудник		
				//|
				//|ОБЪЕДИНИТЬ 
				//|
				//|ВЫБРАТЬ
				//|НазначениеСотрудниковПоБригадам.Период,
				//|НазначениеСотрудниковПоБригадам.Сотрудник,
				//|МАКСИМУМ(РО.Период) КАК ДатаИзменения//,
				//|ИЗ
				//|РегистрСведений.НазначениеСотрудниковПоБригадам КАК НазначениеСотрудниковПоБригадам
				//|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РО
				//|ПО НазначениеСотрудниковПоБригадам.Сотрудник = РО.Сотрудник
				//|И РО.Период <= НазначениеСотрудниковПоБригадам.Период
				//|ГДЕ
				//|НазначениеСотрудниковПоБригадам.Период МЕЖДУ &парамНачало И &парамКонец
				//|И НазначениеСотрудниковПоБригадам.Сотрудник В (ВЫБРАТЬ ВТСписокРаботников.Сотрудник ИЗ ВТСписокРаботников КАК ВТСписокРаботников)
				//|СГРУППИРОВАТЬ ПО
				//|НазначениеСотрудниковПоБригадам.Период,
				//|НазначениеСотрудниковПоБригадам.Сотрудник
				//|;
				//|
				//|ВЫБРАТЬ 
				//|ВТПериодыНБ1.Сотрудник,    
				//|МАКСИМУМ(ВТПериодыНБ1.Период) КАК ДатаИзменения 
				//|ПОМЕСТИТЬ ВТПериодыНБ2
				//|ИЗ ВТПериодыНБ1 КАК ВТПериодыНБ1
				//|СГРУППИРОВАТЬ ПО
				//|ВТПериодыНБ1.Сотрудник
				//|;
				//|
				//|ВЫБРАТЬ
				//|ВТПериодыНБ2.Сотрудник,
				//|ВТПериодыНБ2.ДатаИзменения,
				//|МАКСИМУМ(РО.Период) КАК Период
				//|ПОМЕСТИТЬ ВТПериодыНБ3			
				//|ИЗ ВТПериодыНБ2 КАК ВТПериодыНБ2
				//|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РО
				//|ПО ВТПериодыНБ2.Сотрудник = РО.Сотрудник
				//|И РО.Период <= ВТПериодыНБ2.ДатаИзменения
				//|СГРУППИРОВАТЬ ПО		
				//|ВТПериодыНБ2.Сотрудник,
				//|ВТПериодыНБ2.ДатаИзменения
				//|;";
				Запрос.Текст = "
				|ВЫБРАТЬ
				|ИсторияИзмененияУровней.Сотрудник КАК Сотрудник,
				|ИсторияИзмененияУровней.Бригада,
				|ИсторияИзмененияУровней.Период КАК Период
				|ПОМЕСТИТЬ ВТУровни
				|ИЗ РегистрСведений.НазначениеСотрудниковПоБригадам КАК ИсторияИзмененияУровней
				|ГДЕ
				|ИсторияИзмененияУровней.Период <= &парамКонец
				|И ИсторияИзмененияУровней.Сотрудник В (ВЫБРАТЬ ВТСписокРаботников.Сотрудник ИЗ ВТСписокРаботников КАК ВТСписокРаботников)
				|;
				|
				|ВЫБРАТЬ
				|ВТУровни.Сотрудник КАК Сотрудник,
				|МАКСИМУМ(ВТУровни.Период) КАК Период
				|ПОМЕСТИТЬ ВтМаксимальныеПериод
				|ИЗ ВТУровни КАК ВТУровни
				|СГРУППИРОВАТЬ ПО
				|ВТУровни.Сотрудник
				|;
				|
				|ВЫБРАТЬ
				|ВТУровни.Сотрудник КАК Сотрудник,
				|ВТУровни1.Период КАК НачалоПериода,
				|МИНИМУМ(ДОБАВИТЬКДАТЕ(ВТУровни.Период, СЕКУНДА, -1)) КАК КонецПериода
				|ПОМЕСТИТЬ ВТПЕРИОДЫ
				|ИЗ ВТУровни КАК ВТУровни
				|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТУровни КАК ВТУровни1
				|ПО ВТУровни.Сотрудник = ВТУровни1.Сотрудник
				|И ВТУровни.Период > ВТУровни1.Период
				|СГРУППИРОВАТЬ ПО
				|ВТУровни.Сотрудник,
				|ВТУровни1.Период
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|ВтМаксимальныеПериод.Сотрудник,
				|ВтМаксимальныеПериод.Период,
				|ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59)
				|ИЗ ВтМаксимальныеПериод КАК ВтМаксимальныеПериод
				|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТУровни КАК ВТУровни1
				|ПО ВтМаксимальныеПериод.Сотрудник = ВТУровни1.Сотрудник
				|И ВтМаксимальныеПериод.Период = ВТУровни1.Период
				|;
				|
				|ВЫБРАТЬ
				|ВТПЕРИОДЫ.Сотрудник КАК Сотрудник,
				|ВТПЕРИОДЫ.НачалоПериода КАК ДатаИзменения
				|ПОМЕСТИТЬ ВТПериодыНБ2
				|ИЗ ВТПЕРИОДЫ КАК ВТПЕРИОДЫ
				|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТУровни КАК ВТУровни
				|ПО ВТПЕРИОДЫ.Сотрудник = ВТУровни.Сотрудник
				|И ВТПЕРИОДЫ.НачалоПериода = ВТУровни.Период
				|ГДЕ ВТПЕРИОДЫ.НачалоПериода <= &парамКонец
				|И КОНЕЦПЕРИОДА(ВТПЕРИОДЫ.КонецПериода, ДЕНЬ) >= &парамНачало			
				|;				
				|
				|ВЫБРАТЬ
				|ВтТолькоДатыПоСотр.ДатаИзменения КАК ДатаИзменения,
				|ВтТолькоДатыПоСотр.Сотрудник КАК Сотрудник,      
				|МАКСИМУМ(РО.Период) КАК Период
				|ПОМЕСТИТЬ ВТПериодыНБ3
				|ИЗ ВТПериодыНБ2 КАК ВтТолькоДатыПоСотр
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РО
				|ПО ВтТолькоДатыПоСотр.Сотрудник = РО.Сотрудник
				|И ВтТолькоДатыПоСотр.ДатаИзменения >= РО.Период
				|СГРУППИРОВАТЬ ПО
				|ВтТолькоДатыПоСотр.ДатаИзменения,
				|ВтТолькоДатыПоСотр.Сотрудник
				|;";
				//Аверсон 16.01.2023 КВВ СВФР-010142 )
			КонецЕсли;
			Запрос.Текст = Запрос.Текст + "
			//Аверсон 25.05.2022 КВВ СВФР-009084 )
			
			|ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	&парамНачало КАК Период,
			|	РаботникиОрганизации.Сотрудник КАК Сотрудник,
			|	ИСТИНА КАК Подходит,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения
			|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
			|	КОНЕЦ КАК ПодразделениеОрганизации,
			|	РаботникиОрганизации.ауМестоРаботы КАК ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения
			|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы
			|	КОНЕЦ КАК ГрафикРаботы,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|			ТОГДА РаботникиОрганизации.ДолжностьЗавершения
			|		ИНАЧЕ РаботникиОрганизации.Должность
			|	КОНЕЦ КАК Должность,
			|	РаботникиОрганизации.Сотрудник.Код КАК ТабНомер
			|ПОМЕСТИТЬ ВТДвиженияРаботников
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
			|			&парамНачало,
			|			Сотрудник В
			|				(ВЫБРАТЬ
			|					ВТСписокРаботников.Сотрудник
			|				ИЗ
			|					ВТСписокРаботников КАК ВТСписокРаботников)) КАК РаботникиОрганизации
			|ГДЕ
			|	ВЫБОР
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ПричинаИзмененияСостоянияЗавершения
			|			ИНАЧЕ РаботникиОрганизации.ПричинаИзмененияСостояния
			|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|	И ВЫБОР
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ОбособленноеПодразделениеЗавершения
			|			ИНАЧЕ РаботникиОрганизации.ОбособленноеПодразделение
			|		КОНЕЦ = &парамОрганизация
			|	И ВЫБОР
			|			КОГДА &ПоВсемПодразделениям
			|				ТОГДА ИСТИНА
			|			КОГДА РаботникиОрганизации.ПериодЗавершения <= &парамНачало
			|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизации.ПодразделениеОрганизацииЗавершения В
			|						(ВЫБРАТЬ
			|							Подразделения.Подразделение
			|						ИЗ
			|							ВТПодразделенияОтбора КАК Подразделения)
			|			ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации В
			|					(ВЫБРАТЬ
			|						Подразделения.Подразделение
			|					ИЗ
			|						ВТПодразделенияОтбора КАК Подразделения)
			|		КОНЕЦ
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	РаботникиОрганизации.Период,
			|	РаботникиОрганизации.Сотрудник,
			|	ВЫБОР
			|		КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|				И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
			|				И (&ПоВсемПодразделениям
			|					ИЛИ РаботникиОрганизации.ПодразделениеОрганизации В
			|						(ВЫБРАТЬ
			|							Подразделения.Подразделение
			|						ИЗ
			|							ВТПодразделенияОтбора КАК Подразделения))
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ,
			|	РаботникиОрганизации.ПодразделениеОрганизации,
			|	РаботникиОрганизации.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	РаботникиОрганизации.ГрафикРаботы,
			|	РаботникиОрганизации.Должность,
			|	РаботникиОрганизации.Сотрудник.Код
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
			|		ПО СписокРаботников.Сотрудник = РаботникиОрганизации.Сотрудник
			|ГДЕ
			|	РаботникиОрганизации.Период > &парамНачало
			|	И РаботникиОрганизации.Период <= &парамКонец
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	Работники.ПериодЗавершения,
			|	Работники.Сотрудник,
			|	ВЫБОР
			|		КОГДА Работники.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|				И Работники.ОбособленноеПодразделениеЗавершения = &парамОрганизация
			|				И (&ПоВсемПодразделениям
			|					ИЛИ Работники.ПодразделениеОрганизацииЗавершения В
			|						(ВЫБРАТЬ
			|							Подразделения.Подразделение
			|						ИЗ
			|							ВТПодразделенияОтбора КАК Подразделения))
			|			ТОГДА ИСТИНА
			|		ИНАЧЕ ЛОЖЬ
			|	КОНЕЦ,
			|	Работники.ПодразделениеОрганизацииЗавершения,
			|	Работники.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
			|	Работники.ГрафикРаботыЗавершения,
			|	Работники.ДолжностьЗавершения,
			|	Работники.Сотрудник.Код
			|ИЗ
			|	ВТСписокРаботников КАК СписокРаботников
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работники
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
			|			ПО (ПериодыПерекрытия.Период <= Работники.ПериодЗавершения)
			|				И (ПериодыПерекрытия.Период > Работники.Период)
			|				И (ПериодыПерекрытия.Сотрудник = Работники.Сотрудник)
			|		ПО СписокРаботников.Сотрудник = Работники.Сотрудник
			|ГДЕ
			|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|	И Работники.ПериодЗавершения > &парамНачало
			|	И Работники.ПериодЗавершения <= &парамКонец
			|	И ПериодыПерекрытия.Период ЕСТЬ NULL 
			|";
			
			//Аверсон 25.05.2022 КВВ СВФР-009084 (
			Если РазбиватьПериодыПоНазначениюБригады Тогда
				Запрос.Текст = Запрос.Текст + "
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|ВТПериодыНБ3.ДатаИзменения, //КАК Период
				|ВТПериодыНБ3.Сотрудник,
				
				//Аверсон 16.01.2023 КВВ СВФР-010142 (
				////Аверсон 13.01.2023 КВВ СВФР-010142 (
				////|ИСТИНА, //КАК Подходит
				//|	ВЫБОР
				//|		КОГДА РО.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				//|				И РО.ОбособленноеПодразделениеЗавершения = &парамОрганизация
				//|				И (&ПоВсемПодразделениям
				//|					ИЛИ РО.ПодразделениеОрганизацииЗавершения В
				//|						(ВЫБРАТЬ
				//|							Подразделения.Подразделение
				//|						ИЗ
				//|							ВТПодразделенияОтбора КАК Подразделения))
				//|			ТОГДА ИСТИНА
				//|		ИНАЧЕ ЛОЖЬ
				//|	КОНЕЦ, //КАК Подходит
				////Аверсон 13.01.2023 КВВ СВФР-010142 )
				|ВЫБОР КОГДА
				|РО.ПодразделениеОрганизацииЗавершения.Ссылка ЕСТЬ NULL
				|ТОГДА
				|ВЫБОР
				|КОГДА РО.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|И РО.ОбособленноеПодразделение = &парамОрганизация
				|И (&ПоВсемПодразделениям
				|ИЛИ РО.ПодразделениеОрганизации В
				|(ВЫБРАТЬ
				|Подразделения.Подразделение
				|ИЗ
				|ВТПодразделенияОтбора КАК Подразделения))
				|ТОГДА ИСТИНА
				|ИНАЧЕ ЛОЖЬ
				|КОНЕЦ
				|ИНАЧЕ
				|ВЫБОР
				|КОГДА РО.ПричинаИзмененияСостоянияЗавершения <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|И РО.ОбособленноеПодразделениеЗавершения = &парамОрганизация
				|И (&ПоВсемПодразделениям
				|ИЛИ РО.ПодразделениеОрганизацииЗавершения В
				|(ВЫБРАТЬ
				|Подразделения.Подразделение
				|ИЗ
				|ВТПодразделенияОтбора КАК Подразделения))
				|ТОГДА ИСТИНА
				|ИНАЧЕ ЛОЖЬ
				|КОНЕЦ
				|КОНЕЦ, //КАК Подходит
				//Аверсон 16.01.2023 КВВ СВФР-010142 )
				
				|РО.ПодразделениеОрганизации,
				|РО.ауМестоРаботы, //Аверсон 10.01.2023 КВВ СВФР-010142
				|РО.ГрафикРаботы,
				|РО.Должность,
				//|РО.Период,
				|ВТПериодыНБ3.Сотрудник.Код
				|ИЗ ВТПериодыНБ3 КАК ВТПериодыНБ3
				|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РО
				|ПО ВТПериодыНБ3.Сотрудник = РО.Сотрудник
				|И РО.Период = ВТПериодыНБ3.Период
				|";
			КонецЕсли;
			Запрос.Текст = Запрос.Текст + "
			//Аверсон 25.05.2022 КВВ СВФР-009084 )	
			
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник";
			Запрос.Выполнить();
			
			// таблица ВТЗначенияПоказателей
			// 
			// Поля:
			//   Сотрудник
			//   Показатель - введенный пользователем показатель
			//   Значение - значение показателя
			//   Валюта
			//
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	Работники.Сотрудник КАК Сотрудник,
			|	Работники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
			|	ЗначенияПоказателейСхемМотивации.Показатель КАК Показатель,
			|	ЗначенияПоказателейСхемМотивации.Валюта,
			|	ВЫБОР
			|		КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
			|				И (НЕ ЗначенияПоказателейСхемМотивации.Валюта В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)))
			|			ТОГДА ЗначенияПоказателейСхемМотивации.Значение * ЕСТЬNULL(Валюты.Курс / Валюты.Кратность, 0)
			|		ИНАЧЕ ЗначенияПоказателейСхемМотивации.Значение
			|	КОНЕЦ КАК Значение
			|ПОМЕСТИТЬ ВТЗначенияПоказателей
			|ИЗ
			|	ВТДвиженияРаботников КАК Работники
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			Ежемесячно.Подразделение КАК Подразделение,
			|			Ежемесячно.Показатель КАК Показатель,
			|			Ежемесячно.Валюта КАК Валюта,
			|			Ежемесячно.Значение КАК Значение,
			|			Ежемесячно.Сотрудник КАК Сотрудник
			|		ИЗ
			|			РегистрСведений.ЗначенияПоказателейСхемМотивации КАК Ежемесячно
			|		ГДЕ
			|			Ежемесячно.Значение ЕСТЬ НЕ NULL 
			|			И Ежемесячно.Организация = &парамОрганизация
			|			И Ежемесячно.ПериодДействия >= &парамНачало
			|			И Ежемесячно.ПериодДействия <= &парамКонец
			|		
			|		ОБЪЕДИНИТЬ
			|		
			|		ВЫБРАТЬ
			|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Подразделение,
			|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Показатель,
			|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Валюта,
			|			ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Значение,
			|			NULL
			|		ИЗ
			|			РегистрСведений.ПериодическиеЗначенияПоказателейСхемМотивации.СрезПоследних(&парамКонец, Организация = &парамОрганизация) КАК ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних) КАК ЗначенияПоказателейСхемМотивации
			|		ПО (ВЫБОР
			|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
			|						ИЛИ ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя ЕСТЬ NULL 
			|					ТОГДА Работники.Сотрудник = ЗначенияПоказателейСхемМотивации.Сотрудник
			|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
			|					ТОГДА Работники.ПодразделениеОрганизации = ЗначенияПоказателейСхемМотивации.Подразделение
			|				ИНАЧЕ ИСТИНА
			|			КОНЕЦ)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты
			|		ПО (Валюты.Период = &парамДатаВалютногоУчета)
			|			И (ЗначенияПоказателейСхемМотивации.Валюта = Валюты.Валюта)
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Показатель
			|";
			
			Запрос.Выполнить();
			
			
			// создание временных таблиц для последующего использования:
			//	ЗначенияПоказателей
			//	НеЗапрашиваемыеПриКадровыхПеремещениях
			//	ВводимыеВПлановыхНачисленияхПоказатели
			//	РаботникиИНачисления
			
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет 
				ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНачислений 
				ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетУдержаний 
				ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ
				ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
				
				// таблица НеЗапрашиваемыеПриКадровыхПеремещениях
				// 	выбираем показатели, которые не спрашиваем у пользователя в кадровых документах, а также все "тарифные ставки" и их в.р.;
				//  значения этих показателей будем искать в данных о плановых начислениях, но, возможно, при других видах расчета
				// 
				//	Поля:
				//		Ссылка - вид расчета
				//		Показатель
				//		НомерСтроки - номер строки показателя
				//		ЭтоТарифнаяСтавка - признак того. что Показатель является тарифной ставкой
				// 
				
				Запрос.Текст =
				"ВЫБРАТЬ
				|	ОсновныеНачисленияОрганизацийПоказатели.Показатель КАК Показатель,
				|	ОсновныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
				|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки КАК НомерСтроки,
				|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка КАК Ссылка,
				|	ВЫБОР
				|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
				|			ТОГДА ИСТИНА
				|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
				|			ТОГДА ИСТИНА
				|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
				|			ТОГДА ИСТИНА
				|		КОГДА ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
				|			ТОГДА ИСТИНА
				|		ИНАЧЕ ЛОЖЬ
				|	КОНЕЦ КАК ЭтоТарифнаяСтавка
				|ПОМЕСТИТЬ ВТНеЗапрашиваемыеПриКадровыхПеремещениях
				|ИЗ
				|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
				|ГДЕ
				|	((НЕ ОсновныеНачисленияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
				|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
				|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
				|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
				|			ИЛИ ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
				|	И ОсновныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ
				|	ДополнительныеНачисленияОрганизацийПоказатели.Показатель,
				|	ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
				|	ДополнительныеНачисленияОрганизацийПоказатели.НомерСтроки,
				|	ДополнительныеНачисленияОрганизацийПоказатели.Ссылка,
				|	ВЫБОР
				|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
				|			ТОГДА ИСТИНА
				|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
				|			ТОГДА ИСТИНА
				|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
				|			ТОГДА ИСТИНА
				|		КОГДА ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
				|			ТОГДА ИСТИНА
				|		ИНАЧЕ ЛОЖЬ
				|	КОНЕЦ
				|ИЗ
				|	ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК ДополнительныеНачисленияОрганизацийПоказатели
				|ГДЕ
				|	((НЕ ДополнительныеНачисленияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
				|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
				|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
				|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
				|			ИЛИ ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
				|	И ДополнительныеНачисленияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ
				|	УдержанияОрганизацийПоказатели.Показатель,
				|	УдержанияОрганизацийПоказатели.Показатель.ВозможностьИзменения,
				|	УдержанияОрганизацийПоказатели.НомерСтроки,
				|	УдержанияОрганизацийПоказатели.Ссылка,
				|	ВЫБОР
				|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
				|			ТОГДА ИСТИНА
				|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
				|			ТОГДА ИСТИНА
				|		КОГДА УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
				|			ТОГДА ИСТИНА
				|		КОГДА УдержанияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
				|			ТОГДА ИСТИНА
				|		ИНАЧЕ ЛОЖЬ
				|	КОНЕЦ
				|ИЗ
				|	ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК УдержанияОрганизацийПоказатели
				|ГДЕ
				|	((НЕ УдержанияОрганизацийПоказатели.ЗапрашиватьПриКадровыхПеремещениях)
				|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
				|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
				|			ИЛИ УдержанияОрганизацийПоказатели.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
				|			ИЛИ УдержанияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
				|	И УдержанияОрганизацийПоказатели.Показатель.ВозможностьИзменения <> ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Показатель";
				Запрос.Выполнить();
				
				// таблица ВводимыеВПлановыхНачисленияхПоказатели
				//  виды расчета и показатели, значения которых находятся при этих в.р. в данных о плановых начислениях
				// 
				//	Поля:
				//		Ссылка - вид расчета
				//		Показатель
				//		НомерСтроки - номер строки показателя
				// 
				Запрос.Текст =
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ОсновныеНачисленияОрганизаций.Ссылка КАК Ссылка,
				|	ВЫБОР
				|		КОГДА ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам))
				|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
				|		КОГДА ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок))
				|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
				|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
				|	КОНЕЦ КАК Показатель,
				|	1 КАК НомерСтроки,
				|	ИСТИНА КАК ЭтоТарифнаяСтавка
				|ПОМЕСТИТЬ ВТВводимыеВПлановыхНачисленияхПоказатели
				|ИЗ
				|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
				|ГДЕ
				|	(ОсновныеНачисленияОрганизаций.СпособРасчета В (ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоДням), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоМесячнойТарифнойСтавкеПоЧасам), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоЧасовойТарифнойСтавке), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.СдельныйЗаработок), ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПоДневнойТарифнойСтавке))
				|	 ИЛИ ОсновныеНачисленияОрганизаций.Ссылка = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)) //О.Т. Аверсон 11.04.2017 № 513
				|	И выбор когда ОсновныеНачисленияОрганизаций.Ссылка = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты) тогда истина иначе ОсновныеНачисленияОрганизаций.ЗачетОтработанногоВремени конец //О.Т. Аверсон 11.03.2019 № 4039 условие на вид расчета
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка,
				|	ОсновныеНачисленияОрганизацийПоказатели.Показатель,
				|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки,
				|	ИСТИНА
				|ИЗ
				|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
				|ГДЕ
				|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка.ЗачетОтработанногоВремени
				|	И ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка
				|	И (НЕ ОсновныеНачисленияОрганизацийПоказатели.Показатель.Предопределенный)
				|
				|ОБЪЕДИНИТЬ
				|
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ОсновныеНачисленияОрганизацийПоказатели.Ссылка,
				|	ОсновныеНачисленияОрганизацийПоказатели.Показатель,
				|	ОсновныеНачисленияОрганизацийПоказатели.НомерСтроки,
				|	ЛОЖЬ
				|ИЗ
				|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК ОсновныеНачисленияОрганизацийПоказатели
				|ГДЕ
				|	ОсновныеНачисленияОрганизацийПоказатели.Показатель В
				|			(ВЫБРАТЬ
				|				ВТНеЗапрашиваемыеПриКадровыхПеремещениях.Показатель
				|			ИЗ
				|				ВТНеЗапрашиваемыеПриКадровыхПеремещениях)
				|	И (НЕ ОсновныеНачисленияОрганизацийПоказатели.Показатель.ТарифнаяСтавка)
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Ссылка";
				
				Запрос.Выполнить();
				
				// РаботникиИНачисления
				//		Таблица движений работников с добавленными сведениями об их плановых начислениях
				// 
				//	Поля:
				//		Сотрудник 
				//		ВидРасчета - плановое начисление 
				//		Показатель1,...,6 - размеры показателей 
				//		СпособРасчета - способ расчета начисления 
				//		ГрафикРаботы - график сотрудника  
				//		ВидГрафика, СуммированныйУчетРабочегоВремени, ДлительностьРабочейНедели - реквизиты графика сотрудника 
				// 
				// Описание:
				//
				//	1. 
				//  2. 
				//
				ПособиеСписок = Новый СписокЗначений; //О.Т. Аверсон 23.06.2016 № 1267
				ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаВторогоИПоследующихДо3Лет);
				ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаСтарше3Лет);
				ПособиеСписок.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаДетейОт3До18);//О.Т. Аверсон 27.03.2018 № 1771
				
				//О.Т. Аверсон 14.06.2018 № 
				СпособыРасчетаСписок = Новый СписокЗначений;			
				СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемей);
				СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеСтарше3ЛетИзОтдельныхКатегорийСемейИнвалид);
				СпособыРасчетаСписок.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаИнвалида);
				//О.Т. Аверсон 14.06.2018 № 
				
				Запрос.УстановитьПараметр("ВидРасчетаПособие", ПособиеСписок);
				Запрос.УстановитьПараметр("СпособыРасчетаПособие", СпособыРасчетаСписок);
				Запрос.Текст =
				"ВЫБРАТЬ
				|	Работники.Сотрудник КАК Сотрудник,
				|	Работники.Сотрудник.Наименование КАК СотрудникНаименование,
				|	Работники.Сотрудник.Физлицо КАК Физлицо,
				|	ВЫБОР
				|		КОГДА Работники.Период >= НачисленияРаботниковОрганизации.Период
				|				ИЛИ НачисленияРаботниковОрганизации.Период ЕСТЬ NULL 
				|			ТОГДА Работники.Период
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Период
				|	КОНЕЦ КАК Период,
				|	Работники.Подходит,
				|	Работники.Период КАК ПериодРаботники,
				|	НачисленияРаботниковОрганизации.Период КАК ПериодНачисления,
				|	НачисленияРаботниковОрганизации.ОсновноеНачисление,
				|	НачисленияРаботниковОрганизации.ВидРасчета,
				|	НачисленияРаботниковОрганизации.ВидРасчета.Наименование,
				|	НачисленияРаботниковОрганизации.ВидРасчета.ВидСтажа,
				|	НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда,
				|	НачисленияРаботниковОрганизации.ВидРасчета.КоэффициентСтажа,
				|	НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета КАК СпособРасчета,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
				|			ТОГДА НачисленияРаботниковОрганизации.ВидРасчета.ВидВремени
				|		ИНАЧЕ NULL
				|	КОНЕЦ КАК ВидВремени,
				|	НачисленияРаботниковОрганизации.Действие КАК Действие,
				|	ЕСТЬNULL(НачисленияРаботниковОрганизации.ВидРасчета.КодДоходаНДФЛ.КодВычета, ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка)) КАК КодВычета,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
				|				ИЛИ НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
				|					И (НачисленияРаботниковОрганизации.ТарифныйРазряд1 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
				|						И НачисленияРаботниковОрганизации.ТарифныйРазряд1 ЕСТЬ НЕ NULL )
				|			ТОГДА ТарифныеСтавки1.Размер
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
				|	КОНЕЦ КАК Показатель1,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд2 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд2 ЕСТЬ НЕ NULL 
				|			ТОГДА ТарифныеСтавки2.Размер
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель2
				|	КОНЕЦ КАК Показатель2,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд3 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд3 ЕСТЬ НЕ NULL 
				|			ТОГДА ТарифныеСтавки3.Размер
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель3
				|	КОНЕЦ КАК Показатель3,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд4 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд4 ЕСТЬ НЕ NULL 
				|			ТОГДА ТарифныеСтавки4.Размер
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель4
				|	КОНЕЦ КАК Показатель4,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд5 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд5 ЕСТЬ НЕ NULL 
				|			ТОГДА ТарифныеСтавки5.Размер
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель5
				|	КОНЕЦ КАК Показатель5,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ПроизвольнаяФормулаРасчета
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд6 <> ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
				|				И НачисленияРаботниковОрганизации.ТарифныйРазряд6 ЕСТЬ НЕ NULL 
				|			ТОГДА ТарифныеСтавки6.Размер
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Показатель6
				|	КОНЕЦ КАК Показатель6,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
				|			ТОГДА ТарифныеСтавки1.Валюта
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
				|	КОНЕЦ КАК Валюта1,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
				|			ТОГДА ТарифныеСтавки2.Валюта
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта2
				|	КОНЕЦ КАК Валюта2,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
				|			ТОГДА ТарифныеСтавки3.Валюта
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта3
				|	КОНЕЦ КАК Валюта3,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
				|			ТОГДА ТарифныеСтавки4.Валюта
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта4
				|	КОНЕЦ КАК Валюта4,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
				|			ТОГДА ТарифныеСтавки5.Валюта
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта5
				|	КОНЕЦ КАК Валюта5,
				|	ВЫБОР
				|		КОГДА НачисленияРаботниковОрганизации.ВидРасчета.ТребуетВводаТарифногоРазряда
				|			ТОГДА ТарифныеСтавки6.Валюта
				|		ИНАЧЕ НачисленияРаботниковОрганизации.Валюта6
				|	КОНЕЦ КАК Валюта6,
				|	НачисленияРаботниковОрганизации.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
				|	Работники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
				|	Работники.ауМестоРаботы КАК ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
				|	Работники.ГрафикРаботы КАК ГрафикРаботы,
				|	ЕСТЬNULL(Работники.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени,
				|	ЕСТЬNULL(ВЫБОР
				|			КОГДА Работники.ГрафикРаботы.СокращенноеРабочееВремя
				|					И Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
				|				ТОГДА Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели
				|			ИНАЧЕ Работники.ГрафикРаботы.ДлительностьРабочейНедели
				|		КОНЕЦ, 0) КАК ДлительностьРабочейНедели,
				|	Работники.ГрафикРаботы.ВидГрафика КАК ВидГрафика,
				|	Работники.Должность КАК Должность,
				|	НачисленияРаботниковОрганизации.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
				|	Работники.ТабНомер,
				|	НачисленияРаботниковОрганизации.ПериодЗавершения КАК ПериодЗавершения,
				|	НачисленияРаботниковОрганизации.ПоказательВВалюте"
				
				//Аверсон ЕАЕ 09.03.2022 СВФР-008825
				+ ?(Организация.ИНН = "100071565", ",
				|   		НачисленияРаботниковОрганизации.СовмещаемаяПрофессия КАК СовмещаемаяПрофессия", "") + "
				//Аверсон СВФР-008825
				
				|ПОМЕСТИТЬ ВТРаботникиИНачисления
				|ИЗ
				|	ВТДвиженияРаботников КАК Работники
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			&парамНачало КАК Период,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
				|					ТОГДА ИСТИНА
				|				ИНАЧЕ ЛОЖЬ
				|			КОНЕЦ КАК ОсновноеНачисление,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ВЫБОР
				|							КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|								ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
				|							ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
				|						КОНЕЦ
				|				ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
				|			КОНЕЦ КАК ВидРасчета,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Действие
				|			КОНЕЦ КАК Действие,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Показатель1Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
				|			КОНЕЦ КАК Показатель1,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Показатель2Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель2
				|			КОНЕЦ КАК Показатель2,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Показатель3Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель3
				|			КОНЕЦ КАК Показатель3,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Показатель4Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель4
				|			КОНЕЦ КАК Показатель4,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Показатель5Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель5
				|			КОНЕЦ КАК Показатель5,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Показатель6Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель6
				|			КОНЕЦ КАК Показатель6,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Валюта1Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
				|			КОНЕЦ КАК Валюта1,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Валюта2Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта2
				|			КОНЕЦ КАК Валюта2,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Валюта3Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта3
				|			КОНЕЦ КАК Валюта3,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Валюта4Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта4
				|			КОНЕЦ КАК Валюта4,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Валюта5Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта5
				|			КОНЕЦ КАК Валюта5,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Валюта6Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Валюта6
				|			КОНЕЦ КАК Валюта6,
				|			НачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник,
				|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд1Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд1
				|			КОНЕЦ КАК ТарифныйРазряд1,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд2Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд2
				|			КОНЕЦ КАК ТарифныйРазряд2,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд3Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд3
				|			КОНЕЦ КАК ТарифныйРазряд3,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд4Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд4
				|			КОНЕЦ КАК ТарифныйРазряд4,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд5Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд5
				|			КОНЕЦ КАК ТарифныйРазряд5,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.ТарифныйРазряд6Завершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.ТарифныйРазряд6
				|			КОНЕЦ КАК ТарифныйРазряд6,
				|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
				|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ПериодЗавершения,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|						И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА НачисленияРаботниковОрганизации.Показатель1ВВалютеЗавершения
				|				ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1ВВалюте
				|			КОНЕЦ КАК ПоказательВВалюте"
				
				//Аверсон ЕАЕ 09.03.2022 СВФР-008825
				+ ?(Организация.ИНН = "100071565", ",
				|   		НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
				//Аверсон СВФР-008825
				
				|		ИЗ
				|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
				|					&парамНачало,
				|					ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|						И Сотрудник В
				|							(ВЫБРАТЬ
				|								Работники.Сотрудник
				|							ИЗ
				|								ВТСписокРаботников КАК Работники)) КАК НачисленияРаботниковОрганизации
				|		ГДЕ
				|			ВЫБОР
				|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
				|					ИНАЧЕ НачисленияРаботниковОрганизации.Действие
				|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|			И НЕ ВЫБОР
				|						КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|								И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|							ТОГДА ВЫБОР
				|									КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|										ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
				|									ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
				|								КОНЕЦ
				|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета
				|					КОНЕЦ В (&ВидРасчетаПособие)
				//О.Т. Аверсон 14.06.2018 № 
				|			И НЕ ВЫБОР
				|						КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|								И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|							ТОГДА ВЫБОР
				|									КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|										ТОГДА НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета
				|									ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения.СпособРасчета
				|								КОНЕЦ
				|						ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчета.СпособРасчета
				|					КОНЕЦ В (&СпособыРасчетаПособие)
				
				//О.Т. Аверсон 14.06.2018 № 
				|			И НЕ(НачисленияРаботниковОрганизации.Период > &парамНачало
				|						И НачисленияРаботниковОрганизации.Период <= &парамКонец)
				|		
				|		ОБЪЕДИНИТЬ ВСЕ
				|		
				|		ВЫБРАТЬ
				|			НачисленияРаботниковОрганизации.Период,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
				|					ТОГДА ИСТИНА
				|				ИНАЧЕ ЛОЖЬ
				|			КОНЕЦ,
				|			НачисленияРаботниковОрганизации.ВидРасчета,
				|			НачисленияРаботниковОрганизации.Действие,
				|			НачисленияРаботниковОрганизации.Показатель1,
				|			НачисленияРаботниковОрганизации.Показатель2,
				|			НачисленияРаботниковОрганизации.Показатель3,
				|			НачисленияРаботниковОрганизации.Показатель4,
				|			НачисленияРаботниковОрганизации.Показатель5,
				|			НачисленияРаботниковОрганизации.Показатель6,
				|			НачисленияРаботниковОрганизации.Валюта1,
				|			НачисленияРаботниковОрганизации.Валюта2,
				|			НачисленияРаботниковОрганизации.Валюта3,
				|			НачисленияРаботниковОрганизации.Валюта4,
				|			НачисленияРаботниковОрганизации.Валюта5,
				|			НачисленияРаботниковОрганизации.Валюта6,
				|			НачисленияРаботниковОрганизации.Сотрудник,
				|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд1,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд2,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд3,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд4,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд5,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд6,
				|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде,
				|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
				|			НачисленияРаботниковОрганизации.Показатель1ВВалюте"
				
				//Аверсон ЕАЕ 09.03.2022 СВФР-008825
				+ ?(Организация.ИНН = "100071565", ",
				|   		НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
				//Аверсон СВФР-008825
				
				|		ИЗ
				|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
				|				ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|		ГДЕ
				|			НачисленияРаботниковОрганизации.Период > &парамНачало
				|			И НачисленияРаботниковОрганизации.Период <= &парамКонец
				|			И НачисленияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
				|			И НачисленияРаботниковОрганизации.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|			И НачисленияРаботниковОрганизации.ИспользуетсяВНаряде = ЛОЖЬ
				|		
				|		ОБЪЕДИНИТЬ ВСЕ
				|		
				|		ВЫБРАТЬ
				|			НачисленияРаботниковОрганизации.ПериодЗавершения,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
				|					ТОГДА ИСТИНА
				|				ИНАЧЕ ЛОЖЬ
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|					ТОГДА НачисленияРаботниковОрганизации.ВидРасчета
				|				ИНАЧЕ НачисленияРаботниковОрганизации.ВидРасчетаЗавершения
				|			КОНЕЦ,
				|			НачисленияРаботниковОрганизации.ДействиеЗавершения,
				|			НачисленияРаботниковОрганизации.Показатель1Завершения,
				|			НачисленияРаботниковОрганизации.Показатель2Завершения,
				|			НачисленияРаботниковОрганизации.Показатель3Завершения,
				|			НачисленияРаботниковОрганизации.Показатель4Завершения,
				|			НачисленияРаботниковОрганизации.Показатель5Завершения,
				|			НачисленияРаботниковОрганизации.Показатель6Завершения,
				|			НачисленияРаботниковОрганизации.Валюта1Завершения,
				|			НачисленияРаботниковОрганизации.Валюта2Завершения,
				|			НачисленияРаботниковОрганизации.Валюта3Завершения,
				|			НачисленияРаботниковОрганизации.Валюта4Завершения,
				|			НачисленияРаботниковОрганизации.Валюта5Завершения,
				|			НачисленияРаботниковОрганизации.Валюта6Завершения,
				|			НачисленияРаботниковОрганизации.Сотрудник,
				|			НачисленияРаботниковОрганизации.ДатаНачалаСобытия,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд1Завершения,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд2Завершения,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд3Завершения,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд4Завершения,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд5Завершения,
				|			НачисленияРаботниковОрганизации.ТарифныйРазряд6Завершения,
				|			НачисленияРаботниковОрганизации.ИспользуетсяВНаряде,
				|			ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
				|			НачисленияРаботниковОрганизации.Показатель1ВВалютеЗавершения"
				
				//Аверсон ЕАЕ 09.03.2022 СВФР-008825
				+ ?(Организация.ИНН = "100071565", ",
				|   		НачисленияРаботниковОрганизации.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
				//Аверсон СВФР-008825
				
				|		ИЗ
				|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
				|				ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковПроверка
				|				ПО НачисленияРаботниковОрганизации.Сотрудник = НачисленияРаботниковПроверка.Сотрудник
				|					И НачисленияРаботниковОрганизации.ВидРасчетаИзмерение = НачисленияРаботниковПроверка.ВидРасчетаИзмерение
				|					И НачисленияРаботниковОрганизации.ДокументОснование = НачисленияРаботниковПроверка.ДокументОснование
				|					И (НачисленияРаботниковПроверка.Период > НачисленияРаботниковОрганизации.Период)
				|					И (НачисленияРаботниковПроверка.Период <= НачисленияРаботниковОрганизации.ПериодЗавершения)
				|		ГДЕ
				|			НачисленияРаботниковОрганизации.ПериодЗавершения >= &парамНачало
				|			И НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамКонец
				|			И НачисленияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
				|			И НачисленияРаботниковОрганизации.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|			И НачисленияРаботниковОрганизации.ИспользуетсяВНаряде = ЛОЖЬ
				|			И НачисленияРаботниковПроверка.Сотрудник ЕСТЬ NULL 
				|		
				|		ОБЪЕДИНИТЬ ВСЕ
				|		
				|		ВЫБРАТЬ
				|			&парамНачало,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
				|					ТОГДА ИСТИНА
				|				ИНАЧЕ ЛОЖЬ
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ВЫБОР
				|							КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|								ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
				|							ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения
				|						КОНЕЦ
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Действие
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель1Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель1
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель2Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель2
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель3Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель3
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель4Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель4
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель5Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель5
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель6Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель6
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта1Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта1
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта2Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта2
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта3Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта3
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта4Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта4
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта5Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта5
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Валюта6Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Валюта6
				|			КОНЕЦ,
				|			ПлановыеНачисленияРаботниковОрганизаций.Сотрудник,
				|			ПлановыеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд1Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд1
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд2Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд2
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд3Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд3
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд4Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд4
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд5Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд5
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд6Завершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ТарифныйРазряд6
				|			КОНЕЦ,
				|			ПлановыеНачисленияРаботниковОрганизаций.ИспользуетсяВНаряде,
				|			ВЫБОР
				|				КОГДА НАЧАЛОПЕРИОДА(ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения, МЕСЯЦ) = &парамНачало
				|					ТОГДА ДОБАВИТЬКДАТЕ(ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения, ДЕНЬ, -1)
				|				ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			КОНЕЦ,
				|			ВЫБОР
				|				КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|						И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Показатель1ВВалютеЗавершения
				|				ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Показатель1ВВалюте
				|			КОНЕЦ"
				
				//Аверсон ЕАЕ 09.03.2022 СВФР-008825
				+ ?(Организация.ИНН = "100071565", ",
				|   		ПлановыеНачисленияРаботниковОрганизаций.СовмещаемаяПрофессияИзмерение КАК СовмещаемаяПрофессия", "") + "
				//Аверсон СВФР-008825
				
				|		ИЗ
				|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
				|		ГДЕ
				|			ВЫБОР
				|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения
				|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Действие
				|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|			И (ВЫБОР
				|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА ВЫБОР
				|								КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|									ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
				|								ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения
				|							КОНЕЦ
				|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
				|				КОНЕЦ В (&ВидРасчетаПособие)
				//О.Т. Аверсон 14.06.2018 № 
				|			Или ВЫБОР
				|					КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &парамНачало
				|							И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА ВЫБОР
				|								КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|									ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета
				|								ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения.СпособРасчета
				|							КОНЕЦ
				|					ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета
				|				КОНЕЦ В (&СпособыРасчетаПособие))
				
				//О.Т. Аверсон 14.06.2018 № 
				|			И ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|			И ПлановыеНачисленияРаботниковОрганизаций.Сотрудник В
				|					(ВЫБРАТЬ
				|						Работники.Сотрудник
				|					ИЗ
				|						ВТСписокРаботников КАК Работники)
				
				//|			И НЕ(ПлановыеНачисленияРаботниковОрганизаций.Период > &парамНачало  //Аверсон 03.03.2020 КВВ СВФР-005609 Закомментировала
				//|						И ПлановыеНачисленияРаботниковОрганизаций.Период <= &парамКонец)  //Аверсон 03.03.2020 КВВ СВФР-005609 Закомментировала
				
				//|			И НЕ НАЧАЛОПЕРИОДА(ПлановыеНачисленияРаботниковОрганизаций.Период, МЕСЯЦ) > &парамНачало  //Аверсон 03.03.2020 КВВ СВФР-005609 //Аверсон 23.04.2020 КВВ СВФР-005915 Закомментировала
				
				//Аверсон 23.04.2020 КВВ СВФР-005915 (
				|			И НЕ(ВЫБОР
				|			КОГДА НАЧАЛОПЕРИОДА(ПлановыеНачисленияРаботниковОрганизаций.Период, МЕСЯЦ) = НАЧАЛОПЕРИОДА(&парамНачало, МЕСЯЦ)
				|			ТОГДА
				|			(ПлановыеНачисленияРаботниковОрганизаций.Период > &парамНачало
				|			И ПлановыеНачисленияРаботниковОрганизаций.Период <= &парамКонец )
				|			ИНАЧЕ
				|			НАЧАЛОПЕРИОДА(ПлановыеНачисленияРаботниковОрганизаций.Период, МЕСЯЦ) > &парамНачало
				|			КОНЕЦ)
				//Аверсон 23.04.2020 КВВ СВФР-005915 )
				
				|		) КАК НачисленияРаботниковОрганизации
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки1
				|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд1 = ТарифныеСтавки1.ТарифныйРазряд
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки2
				|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд2 = ТарифныеСтавки2.ТарифныйРазряд
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки3
				|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд3 = ТарифныеСтавки3.ТарифныйРазряд
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки4
				|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд4 = ТарифныеСтавки4.ТарифныйРазряд
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки5
				|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд5 = ТарифныеСтавки5.ТарифныйРазряд
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамКонец, ) КАК ТарифныеСтавки6
				|			ПО НачисленияРаботниковОрганизации.ТарифныйРазряд6 = ТарифныеСтавки6.ТарифныйРазряд
				|		ПО (Работники.Подходит)
				|			И Работники.Сотрудник = НачисленияРаботниковОрганизации.Сотрудник
				
				//Аверсон ЕАЕ 21.03.2022 СВФР-008825
				//|			И Работники.Период = НачисленияРаботниковОрганизации.Период
				//Аверсон СВФР-008825
				
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";	
				//|
				//|ОБЪЕДИНИТЬ ВСЕ
				//|
				//|ВЫБРАТЬ
				//|	Работники.Сотрудник,
				//|	Работники.Сотрудник.Наименование,
				//|	Работники.Сотрудник.Физлицо,
				//|	ВЫБОР
				//|		КОГДА Работники.Период >= ШтатноеРасписание.Период
				//|				ИЛИ ШтатноеРасписание.Период ЕСТЬ NULL 
				//|			ТОГДА Работники.Период
				//|		ИНАЧЕ ШтатноеРасписание.Период
				//|	КОНЕЦ,
				//|	Работники.Подходит,
				//|	Работники.Период,
				//|	ШтатноеРасписание.Период,
				//|	ЛОЖЬ,
				//|	ШтатноеРасписание.ВидНадбавки,
				//|	ШтатноеРасписание.ВидНадбавки.Наименование,
				//|	ШтатноеРасписание.ВидНадбавки.ВидСтажа,
				//|	ШтатноеРасписание.ВидНадбавки.ТребуетВводаТарифногоРазряда,
				//|	ШтатноеРасписание.ВидНадбавки.КоэффициентСтажа,
				//|	ШтатноеРасписание.ВидНадбавки.СпособРасчета,
				//|	ВЫБОР
				//|		КОГДА ШтатноеРасписание.ВидНадбавки ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
				//|			ТОГДА ШтатноеРасписание.ВидНадбавки.ВидВремени
				//|		ИНАЧЕ NULL
				//|	КОНЕЦ,
				//|	ШтатноеРасписание.Действие,
				//|	ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.ПустаяСсылка),
				//|	ШтатноеРасписание.Показатель1,
				//|	ШтатноеРасписание.Показатель2,
				//|	ШтатноеРасписание.Показатель3,
				//|	ШтатноеРасписание.Показатель4,
				//|	ШтатноеРасписание.Показатель5,
				//|	ШтатноеРасписание.Показатель6,
				//|	ШтатноеРасписание.Валюта1,
				//|	ШтатноеРасписание.Валюта2,
				//|	ШтатноеРасписание.Валюта3,
				//|	ШтатноеРасписание.Валюта4,
				//|	ШтатноеРасписание.Валюта5,
				//|	ШтатноеРасписание.Валюта6,
				//|	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
				//|	Работники.ПодразделениеОрганизации,
				//|	Работники.ГрафикРаботы,
				//|	ЕСТЬNULL(Работники.ГрафикРаботы.СуммированныйУчетРабочегоВремени, ЛОЖЬ),
				//|	ЕСТЬNULL(ВЫБОР
				//|			КОГДА Работники.ГрафикРаботы.СокращенноеРабочееВремя
				//|					И Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
				//|				ТОГДА Работники.ГрафикРаботы.ГрафикПолногоРабочегоВремени.ДлительностьРабочейНедели
				//|			ИНАЧЕ Работники.ГрафикРаботы.ДлительностьРабочейНедели
				//|		КОНЕЦ, 0),
				//|	Работники.ГрафикРаботы.ВидГрафика,
				//|	Работники.Должность
				//|ИЗ
				//|	ВТДвиженияРаботников КАК Работники
				//|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				//|			&парамНачало КАК Период,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.ВидНадбавки КАК ВидНадбавки,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель1 КАК Показатель1,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель2 КАК Показатель2,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель3 КАК Показатель3,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель4 КАК Показатель4,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель5 КАК Показатель5,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель6 КАК Показатель6,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта1 КАК Валюта1,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта2 КАК Валюта2,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта3 КАК Валюта3,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта4 КАК Валюта4,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта5 КАК Валюта5,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Валюта6 КАК Валюта6,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Должность КАК Должность,
				//|			НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
				//|			ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Изменить) КАК Действие
				//|		ИЗ
				//|			РегистрСведений.НадбавкиПоШтатномуРасписаниюОрганизаций.СрезПоследних(
				//|					&парамНачало,
				//|					ПодразделениеОрганизации В
				//|						(ВЫБРАТЬ
				//|							ДвиженияРаботников.ПодразделениеОрганизации
				//|						ИЗ
				//|							ВТДвиженияРаботников КАК ДвиженияРаботников)) КАК НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних
				//|		ГДЕ
				//|			(НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель1 > 0
				//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель2 > 0
				//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель3 > 0
				//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель4 > 0
				//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель5 > 0
				//|					ИЛИ НадбавкиПоШтатномуРасписаниюОрганизацииСрезПоследних.Показатель6 > 0)
				//|		
				//|		ОБЪЕДИНИТЬ ВСЕ
				//|		
				//|		ВЫБРАТЬ
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Период,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.ВидНадбавки,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель1,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель2,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель3,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель4,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель5,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель6,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта1,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта2,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта3,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта4,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта5,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Валюта6,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Должность,
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.ПодразделениеОрганизации,
				//|			ВЫБОР
				//|				КОГДА НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель1 = 0
				//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель2 = 0
				//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель3 = 0
				//|						И НадбавкиПоШтатномуРасписаниюОрганизаций.Показатель4 = 0
				//|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				//|				ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Изменить)
				//|			КОНЕЦ
				//|		ИЗ
				//|			РегистрСведений.НадбавкиПоШтатномуРасписаниюОрганизаций КАК НадбавкиПоШтатномуРасписаниюОрганизаций
				//|		ГДЕ
				//|			НадбавкиПоШтатномуРасписаниюОрганизаций.Период > &парамНачало
				//|			И НадбавкиПоШтатномуРасписаниюОрганизаций.Период <= &парамКонец
				//|			И НадбавкиПоШтатномуРасписаниюОрганизаций.ПодразделениеОрганизации В
				//|					(ВЫБРАТЬ
				//|						ДвиженияРаботников.ПодразделениеОрганизации
				//|					ИЗ
				//|						ВТДвиженияРаботников КАК ДвиженияРаботников)) КАК ШтатноеРасписание
				//|		ПО Работники.ПодразделениеОрганизации = ШтатноеРасписание.ПодразделениеОрганизации
				//|			И Работники.Должность = ШтатноеРасписание.Должность
				
				
				Запрос.Выполнить();
				
				//получим все невводимые показатели
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	СписокНачислений.Сотрудник КАК Сотрудник,
				|	СписокНачислений.Период,
				|	СписокНачислений.ПериодРаботники КАК ПериодРаботники,
				|	СписокНачислений.ПериодНачисления КАК ПериодНачисления,
				|	ВводимыеПоказатели.Показатель КАК Показатель,
				|	ВЫБОР
				//О.Т. Аверсон 11.03.2019 № 4039
				|	КОГДА СписокНачислений.ВидРасчета = ЗНАЧЕНИЕ(Планвидоврасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)
				|	ТОГДА 1
				//О.Т. Аверсон 11.03.2019 № 4039 
				|		КОГДА ВводимыеПоказатели.НомерСтроки = 1
				|			ТОГДА СписокНачислений.Показатель1
				|		КОГДА ВводимыеПоказатели.НомерСтроки = 2
				|			ТОГДА СписокНачислений.Показатель2
				|		КОГДА ВводимыеПоказатели.НомерСтроки = 3
				|			ТОГДА СписокНачислений.Показатель3
				|		КОГДА ВводимыеПоказатели.НомерСтроки = 4
				|			ТОГДА СписокНачислений.Показатель4
				|		КОГДА ВводимыеПоказатели.НомерСтроки = 5
				|			ТОГДА СписокНачислений.Показатель5
				|		КОГДА ВводимыеПоказатели.НомерСтроки = 6
				|			ТОГДА СписокНачислений.Показатель6
				|	КОНЕЦ КАК ЗначениеПоказателя
				|ПОМЕСТИТЬ ВТЗначенияВводимыхКадровыхПоказателей
				|ИЗ
				|	ВТРаботникиИНачисления КАК СписокНачислений
				|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВводимыеВПлановыхНачисленияхПоказатели КАК ВводимыеПоказатели
				|		ПО СписокНачислений.ВидРасчета = ВводимыеПоказатели.Ссылка
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Показатель
				|";
				Запрос.Выполнить();
				
			КонецЕсли;
			
			// таблица Показатели
			//   видам начислений приписываются введенные пользователями для каждого сотрудника значения показателей 
			// 
			// Поля:
			//   ВидРасчета
			//   Сотрудник
			//   Показатель1,2,...,6 - значения соответствующих показателей
			//   Валюта
			//
			
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет Тогда 
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ПоказателиВидовРасчета.Ссылка КАК ВидРасчета,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей1.Сотрудник
				|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей2.Сотрудник
				|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей3.Сотрудник
				|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей4.Сотрудник		
				|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей5.Сотрудник		
				|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей6.Сотрудник
				|	КОНЕЦ КАК Сотрудник,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей1.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей2.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей3.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей4.ПодразделениеОрганизации		
				|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей5.ПодразделениеОрганизации		
				|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей6.ПодразделениеОрганизации
				|	КОНЕЦ КАК ПодразделениеОрганизации,		
				|	ПоказателиВидовРасчета.Показатель1.ТипПоказателя КАК ТипПоказателя1,
				|	ПоказателиВидовРасчета.Показатель2.ТипПоказателя КАК ТипПоказателя2,
				|	ПоказателиВидовРасчета.Показатель3.ТипПоказателя КАК ТипПоказателя3,
				|	ПоказателиВидовРасчета.Показатель4.ТипПоказателя КАК ТипПоказателя4,
				|	ПоказателиВидовРасчета.Показатель5.ТипПоказателя КАК ТипПоказателя5,
				|	ПоказателиВидовРасчета.Показатель6.ТипПоказателя КАК ТипПоказателя6,
				|	ПоказателиВидовРасчета.Показатель1.ВозможностьИзменения КАК ВозможностьИзменения1,
				|	ПоказателиВидовРасчета.Показатель2.ВозможностьИзменения КАК ВозможностьИзменения2,
				|	ПоказателиВидовРасчета.Показатель3.ВозможностьИзменения КАК ВозможностьИзменения3,
				|	ПоказателиВидовРасчета.Показатель4.ВозможностьИзменения КАК ВозможностьИзменения4,
				|	ПоказателиВидовРасчета.Показатель5.ВозможностьИзменения КАК ВозможностьИзменения5,
				|	ПоказателиВидовРасчета.Показатель6.ВозможностьИзменения КАК ВозможностьИзменения6,
				|	ЗначенияПоказателей1.Значение КАК Показатель1,
				|	ЗначенияПоказателей2.Значение КАК Показатель2,
				|	ЗначенияПоказателей3.Значение КАК Показатель3,
				|	ЗначенияПоказателей4.Значение КАК Показатель4,
				|	ЗначенияПоказателей5.Значение КАК Показатель5,
				|	ЗначенияПоказателей6.Значение КАК Показатель6,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей1.Валюта
				|		КОГДА ЗначенияПоказателей2.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей2.Валюта
				|		КОГДА ЗначенияПоказателей3.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей3.Валюта
				|		КОГДА ЗначенияПоказателей4.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей4.Валюта		
				|		КОГДА ЗначенияПоказателей5.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей5.Валюта		
				|		КОГДА ЗначенияПоказателей6.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей6.Валюта
				|	КОНЕЦ КАК Валюта			
				|ПОМЕСТИТЬ ВТПоказатели
				|ИЗ
				|	(ВЫБРАТЬ
				|		Показатели.Ссылка КАК Ссылка,
				|		Показатели1.Показатель КАК Показатель1,
				|		Показатели2.Показатель КАК Показатель2,
				|		Показатели3.Показатель КАК Показатель3,
				|		Показатели4.Показатель КАК Показатель4,
				|		Показатели5.Показатель КАК Показатель5,
				|		Показатели6.Показатель КАК Показатель6
				|	ИЗ
				|		ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели1
				|			ПО Показатели.Ссылка = Показатели1.Ссылка
				|				И (Показатели1.НомерСтроки = 1)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели2
				|			ПО Показатели.Ссылка = Показатели2.Ссылка
				|				И (Показатели2.НомерСтроки = 2)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели3
				|			ПО Показатели.Ссылка = Показатели3.Ссылка
				|				И (Показатели3.НомерСтроки = 3)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели4
				|			ПО Показатели.Ссылка = Показатели4.Ссылка
				|				И (Показатели4.НомерСтроки = 4)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели5
				|			ПО Показатели.Ссылка = Показатели5.Ссылка
				|				И (Показатели5.НомерСтроки = 5)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели6
				|			ПО Показатели.Ссылка = Показатели6.Ссылка
				|				И (Показатели6.НомерСтроки = 6)
				|	
				|	ОБЪЕДИНИТЬ ВСЕ
				|	
				|	ВЫБРАТЬ
				|		Показатели.Ссылка,
				|		Показатели1.Показатель,
				|		Показатели2.Показатель,
				|		Показатели3.Показатель,
				|		Показатели4.Показатель,
				|		Показатели5.Показатель,
				|		Показатели6.Показатель
				|	ИЗ
				|		ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели1
				|			ПО Показатели.Ссылка = Показатели1.Ссылка
				|				И (Показатели1.НомерСтроки = 1)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели2
				|			ПО Показатели.Ссылка = Показатели2.Ссылка
				|				И (Показатели2.НомерСтроки = 2)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели3
				|			ПО Показатели.Ссылка = Показатели3.Ссылка
				|				И (Показатели3.НомерСтроки = 3)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели4
				|			ПО Показатели.Ссылка = Показатели4.Ссылка
				|				И (Показатели4.НомерСтроки = 4)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели5
				|			ПО Показатели.Ссылка = Показатели5.Ссылка
				|				И (Показатели5.НомерСтроки = 5)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели6
				|			ПО Показатели.Ссылка = Показатели6.Ссылка
				|				И (Показатели6.НомерСтроки = 6)
				|	
				|	ОБЪЕДИНИТЬ ВСЕ
				|	
				|	ВЫБРАТЬ
				|		Показатели.Ссылка,
				|		Показатели1.Показатель,
				|		Показатели2.Показатель,
				|		Показатели3.Показатель,
				|		Показатели4.Показатель,
				|		Показатели5.Показатель,
				|		Показатели6.Показатель
				|	ИЗ
				|		ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели1
				|			ПО Показатели.Ссылка = Показатели1.Ссылка
				|				И (Показатели1.НомерСтроки = 1)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели2
				|			ПО Показатели.Ссылка = Показатели2.Ссылка
				|				И (Показатели2.НомерСтроки = 2)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели3
				|			ПО Показатели.Ссылка = Показатели3.Ссылка
				|				И (Показатели3.НомерСтроки = 3)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели4
				|			ПО Показатели.Ссылка = Показатели4.Ссылка
				|				И (Показатели4.НомерСтроки = 4)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели5
				|			ПО Показатели.Ссылка = Показатели5.Ссылка
				|				И (Показатели5.НомерСтроки = 5)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели6
				|			ПО Показатели.Ссылка = Показатели6.Ссылка
				|				И (Показатели6.НомерСтроки = 6)) КАК ПоказателиВидовРасчета
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей1
				|		ПО ПоказателиВидовРасчета.Показатель1 = ЗначенияПоказателей1.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей2
				|		ПО ПоказателиВидовРасчета.Показатель2 = ЗначенияПоказателей2.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей3
				|		ПО ПоказателиВидовРасчета.Показатель3 = ЗначенияПоказателей3.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей4
				|		ПО ПоказателиВидовРасчета.Показатель4 = ЗначенияПоказателей4.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей5
				|		ПО ПоказателиВидовРасчета.Показатель5 = ЗначенияПоказателей5.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей6
				|		ПО ПоказателиВидовРасчета.Показатель6 = ЗначенияПоказателей6.Показатель
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	ВидРасчета
				|";
				Запрос.Выполнить();
				
			ИначеЕсли ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНачислений Тогда
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ПоказателиВидовРасчета.Ссылка КАК ВидРасчета,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей1.Сотрудник
				|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей2.Сотрудник
				|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей3.Сотрудник
				|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей4.Сотрудник		
				|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей5.Сотрудник		
				|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей6.Сотрудник
				|	КОНЕЦ КАК Сотрудник,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей1.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей2.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей3.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей4.ПодразделениеОрганизации		
				|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей5.ПодразделениеОрганизации		
				|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей6.ПодразделениеОрганизации
				|	КОНЕЦ КАК ПодразделениеОрганизации,			
				|	ПоказателиВидовРасчета.Показатель1.ТипПоказателя КАК ТипПоказателя1,
				|	ПоказателиВидовРасчета.Показатель2.ТипПоказателя КАК ТипПоказателя2,
				|	ПоказателиВидовРасчета.Показатель3.ТипПоказателя КАК ТипПоказателя3,
				|	ПоказателиВидовРасчета.Показатель4.ТипПоказателя КАК ТипПоказателя4,
				|	ПоказателиВидовРасчета.Показатель5.ТипПоказателя КАК ТипПоказателя5,
				|	ПоказателиВидовРасчета.Показатель6.ТипПоказателя КАК ТипПоказателя6,
				|	ПоказателиВидовРасчета.Показатель1.ВозможностьИзменения КАК ВозможностьИзменения1,
				|	ПоказателиВидовРасчета.Показатель2.ВозможностьИзменения КАК ВозможностьИзменения2,
				|	ПоказателиВидовРасчета.Показатель3.ВозможностьИзменения КАК ВозможностьИзменения3,
				|	ПоказателиВидовРасчета.Показатель4.ВозможностьИзменения КАК ВозможностьИзменения4,
				|	ПоказателиВидовРасчета.Показатель5.ВозможностьИзменения КАК ВозможностьИзменения5,
				|	ПоказателиВидовРасчета.Показатель6.ВозможностьИзменения КАК ВозможностьИзменения6,
				
				|	ЗначенияПоказателей1.Значение КАК Показатель1,
				|	ЗначенияПоказателей2.Значение КАК Показатель2,
				|	ЗначенияПоказателей3.Значение КАК Показатель3,
				|	ЗначенияПоказателей4.Значение КАК Показатель4,
				|	ЗначенияПоказателей5.Значение КАК Показатель5,
				|	ЗначенияПоказателей6.Значение КАК Показатель6,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей1.Валюта
				|		КОГДА ЗначенияПоказателей2.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей2.Валюта
				|		КОГДА ЗначенияПоказателей3.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей3.Валюта
				|		КОГДА ЗначенияПоказателей4.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей4.Валюта		
				|		КОГДА ЗначенияПоказателей5.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей5.Валюта		
				|		КОГДА ЗначенияПоказателей6.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей6.Валюта
				|	КОНЕЦ КАК Валюта		
				|ПОМЕСТИТЬ ВТПоказатели
				|ИЗ
				|	(ВЫБРАТЬ
				|		Показатели.Ссылка КАК Ссылка,
				|		Показатели1.Показатель КАК Показатель1,
				|		Показатели2.Показатель КАК Показатель2,
				|		Показатели3.Показатель КАК Показатель3,
				|		Показатели4.Показатель КАК Показатель4,
				|		Показатели5.Показатель КАК Показатель5,
				|		Показатели6.Показатель КАК Показатель6
				|	ИЗ
				|		ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели1
				|			ПО Показатели.Ссылка = Показатели1.Ссылка
				|				И (Показатели1.НомерСтроки = 1)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели2
				|			ПО Показатели.Ссылка = Показатели2.Ссылка
				|				И (Показатели2.НомерСтроки = 2)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели3
				|			ПО Показатели.Ссылка = Показатели3.Ссылка
				|				И (Показатели3.НомерСтроки = 3)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели4
				|			ПО Показатели.Ссылка = Показатели4.Ссылка
				|				И (Показатели4.НомерСтроки = 4)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели5
				|			ПО Показатели.Ссылка = Показатели5.Ссылка
				|				И (Показатели5.НомерСтроки = 5)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ОсновныеНачисленияОрганизаций.Показатели КАК Показатели6
				|			ПО Показатели.Ссылка = Показатели6.Ссылка
				|				И (Показатели6.НомерСтроки = 6)
				|	
				|	ОБЪЕДИНИТЬ ВСЕ
				|	
				|	ВЫБРАТЬ
				|		Показатели.Ссылка,
				|		Показатели1.Показатель,
				|		Показатели2.Показатель,
				|		Показатели3.Показатель,
				|		Показатели4.Показатель,
				|		Показатели5.Показатель,
				|		Показатели6.Показатель
				|	ИЗ
				|		ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели1
				|			ПО Показатели.Ссылка = Показатели1.Ссылка
				|				И (Показатели1.НомерСтроки = 1)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели2
				|			ПО Показатели.Ссылка = Показатели2.Ссылка
				|				И (Показатели2.НомерСтроки = 2)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели3
				|			ПО Показатели.Ссылка = Показатели3.Ссылка
				|				И (Показатели3.НомерСтроки = 3)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели4
				|			ПО Показатели.Ссылка = Показатели4.Ссылка
				|				И (Показатели4.НомерСтроки = 4)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели5
				|			ПО Показатели.Ссылка = Показатели5.Ссылка
				|				И (Показатели5.НомерСтроки = 5)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.Показатели КАК Показатели6
				|			ПО Показатели.Ссылка = Показатели6.Ссылка
				|				И (Показатели6.НомерСтроки = 6)) КАК ПоказателиВидовРасчета
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей1
				|		ПО ПоказателиВидовРасчета.Показатель1 = ЗначенияПоказателей1.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей2
				|		ПО ПоказателиВидовРасчета.Показатель2 = ЗначенияПоказателей2.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей3
				|		ПО ПоказателиВидовРасчета.Показатель3 = ЗначенияПоказателей3.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей4
				|		ПО ПоказателиВидовРасчета.Показатель4 = ЗначенияПоказателей4.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей5
				|		ПО ПоказателиВидовРасчета.Показатель5 = ЗначенияПоказателей5.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей6
				|		ПО ПоказателиВидовРасчета.Показатель6 = ЗначенияПоказателей6.Показатель
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	ВидРасчета";
				Запрос.Выполнить();
			Иначе
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ПоказателиВидовРасчета.Ссылка КАК ВидРасчета,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей1.Сотрудник
				|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей2.Сотрудник
				|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей3.Сотрудник
				|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей4.Сотрудник		
				|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей5.Сотрудник		
				|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|			ТОГДА ЗначенияПоказателей6.Сотрудник
				|		ИНАЧЕ NULL
				|	КОНЕЦ КАК Сотрудник,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей1.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей2.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей2.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей3.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей3.ПодразделениеОрганизации
				|		КОГДА ЗначенияПоказателей4.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей4.ПодразделениеОрганизации		
				|		КОГДА ЗначенияПоказателей5.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей5.ПодразделениеОрганизации		
				|		КОГДА ЗначенияПоказателей6.Показатель.ВидПоказателя = Значение(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|			ТОГДА ЗначенияПоказателей6.ПодразделениеОрганизации
				|	КОНЕЦ КАК ПодразделениеОрганизации,			
				|	ПоказателиВидовРасчета.Показатель1.ВозможностьИзменения КАК ВозможностьИзменения1,
				|	ПоказателиВидовРасчета.Показатель2.ВозможностьИзменения КАК ВозможностьИзменения2,
				|	ПоказателиВидовРасчета.Показатель3.ВозможностьИзменения КАК ВозможностьИзменения3,
				|	ПоказателиВидовРасчета.Показатель4.ВозможностьИзменения КАК ВозможностьИзменения4,
				|	ПоказателиВидовРасчета.Показатель5.ВозможностьИзменения КАК ВозможностьИзменения5,
				|	ПоказателиВидовРасчета.Показатель6.ВозможностьИзменения КАК ВозможностьИзменения6,
				
				|	ПоказателиВидовРасчета.Показатель1.ТипПоказателя КАК ТипПоказателя1,
				|	ПоказателиВидовРасчета.Показатель2.ТипПоказателя КАК ТипПоказателя2,
				|	ПоказателиВидовРасчета.Показатель3.ТипПоказателя КАК ТипПоказателя3,
				|	ПоказателиВидовРасчета.Показатель4.ТипПоказателя КАК ТипПоказателя4,
				|	ПоказателиВидовРасчета.Показатель5.ТипПоказателя КАК ТипПоказателя5,
				|	ПоказателиВидовРасчета.Показатель6.ТипПоказателя КАК ТипПоказателя6,
				|	ЗначенияПоказателей1.Значение КАК Показатель1,
				|	ЗначенияПоказателей2.Значение КАК Показатель2,
				|	ЗначенияПоказателей3.Значение КАК Показатель3,
				|	ЗначенияПоказателей4.Значение КАК Показатель4,
				|	ЗначенияПоказателей5.Значение КАК Показатель5,
				|	ЗначенияПоказателей6.Значение КАК Показатель6,
				|	ВЫБОР 
				|		КОГДА ЗначенияПоказателей1.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей1.Валюта
				|		КОГДА ЗначенияПоказателей2.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей2.Валюта
				|		КОГДА ЗначенияПоказателей3.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей3.Валюта
				|		КОГДА ЗначенияПоказателей4.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей4.Валюта		
				|		КОГДА ЗначенияПоказателей5.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей5.Валюта		
				|		КОГДА ЗначенияПоказателей6.Показатель.ТипПоказателя = Значение(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
				|			ТОГДА ЗначенияПоказателей6.Валюта
				|	КОНЕЦ КАК Валюта		
				|ПОМЕСТИТЬ ВТПоказатели
				|ИЗ
				|	(ВЫБРАТЬ 
				|		Показатели.Ссылка КАК Ссылка,
				|		Показатели1.Показатель КАК Показатель1,
				|		Показатели2.Показатель КАК Показатель2,
				|		Показатели3.Показатель КАК Показатель3,
				|		Показатели4.Показатель КАК Показатель4,
				|		Показатели5.Показатель КАК Показатель5,
				|		Показатели6.Показатель КАК Показатель6
				|	ИЗ
				|		ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели1
				|			ПО Показатели.Ссылка = Показатели1.Ссылка
				|				И (Показатели1.НомерСтроки = 1)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели2
				|			ПО Показатели.Ссылка = Показатели2.Ссылка
				|				И (Показатели2.НомерСтроки = 2)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели3
				|			ПО Показатели.Ссылка = Показатели3.Ссылка
				|				И (Показатели3.НомерСтроки = 3)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели4
				|			ПО Показатели.Ссылка = Показатели4.Ссылка
				|				И (Показатели4.НомерСтроки = 4)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели5
				|			ПО Показатели.Ссылка = Показатели5.Ссылка
				|				И (Показатели5.НомерСтроки = 5)
				|			ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК Показатели6
				|			ПО Показатели.Ссылка = Показатели6.Ссылка
				|				И (Показатели6.НомерСтроки = 6)) КАК ПоказателиВидовРасчета
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей1
				|		ПО ПоказателиВидовРасчета.Показатель1 = ЗначенияПоказателей1.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей2
				|		ПО ПоказателиВидовРасчета.Показатель2 = ЗначенияПоказателей2.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей3
				|		ПО ПоказателиВидовРасчета.Показатель3 = ЗначенияПоказателей3.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей4
				|		ПО ПоказателиВидовРасчета.Показатель4 = ЗначенияПоказателей4.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей5
				|		ПО ПоказателиВидовРасчета.Показатель5 = ЗначенияПоказателей5.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателей6
				|		ПО ПоказателиВидовРасчета.Показатель6 = ЗначенияПоказателей6.Показатель
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	ВидРасчета";
				Запрос.Выполнить();
			КонецЕсли;
		КонецЕсли;
		// АВТОЗАПОЛНЕНИЕ ТЧ "Начисления", "ДополнительныеНачисления" и "ДоговорыНаВыполнениеРабот"
		Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНачислений 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ 
			ИЛИ ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
			
			// таблица ОсновныеНачисления  
			//	    выборка сведений об уже выполненных начислениях за отработанное время - для выбрасывания 
			// 		ранее "обслуженных" работников
			//	Поля:
			//		Сотрудник,
			//		ПодразделениеОрганизации
			//
			Если не МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
				И НЕ МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский тогда //Аверсон 10.02.2022 КВВ СВФР-008723
				//Аверсон-софт, Островская Татьяна 13.03.2012
				Если ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца Тогда
					Запрос.Текст = 
					"ВЫБРАТЬ РАЗЛИЧНЫЕ
					|	РасчетПервойПоловиныМесяца.Сотрудник КАК Сотрудник,
					|	ТаблицаДвиженийРаботников.ПодразделениеОрганизации
					|ПОМЕСТИТЬ ВТОсновныеНачисления
					|ИЗ
					|	РегистрНакопления.РасчетПервойПоловиныМесяца КАК РасчетПервойПоловиныМесяца
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ТаблицаДвиженийРаботников
					|		ПО РасчетПервойПоловиныМесяца.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
					|ГДЕ
					|	РасчетПервойПоловиныМесяца.Организация = &парамОрганизация
					|	И РасчетПервойПоловиныМесяца.Регистратор <> &парамРегистратор
					|	И НАЧАЛОПЕРИОДА(РасчетПервойПоловиныМесяца.Период, МЕСЯЦ) = &парамНачалоМесяца
					|
					|ИНДЕКСИРОВАТЬ ПО
					|	Сотрудник";		
					Запрос.Выполнить();
					
				Иначе
					Запрос.Текст = 
					"ВЫБРАТЬ РАЗЛИЧНЫЕ
					|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
					|	ОсновныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации
					|ПОМЕСТИТЬ ВТОсновныеНачисления
					|ИЗ
					|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ТаблицаДвиженийРаботников
					|		ПО ОсновныеНачисления.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
					|ГДЕ
					|	ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
					|	И ОсновныеНачисления.ПериодДействияКонец <= &парамКонец
					|	И ОсновныеНачисления.ПериодДействияНачало >= &парамНачало
					|	И ОсновныеНачисления.Организация = &парамГоловнаяОрганизация
					|	И (ОсновныеНачисления.ВидРасчета.ЗачетОтработанногоВремени
					|				И ОсновныеНачисления.ВидРасчета.ЗачетНормыВремени
					|			ИЛИ ОсновныеНачисления.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты))
					|	И (НЕ ОсновныеНачисления.Сторно)
					|	И ОсновныеНачисления.Регистратор <> &парамРегистратор
					|	И ОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация
					|
					|ИНДЕКСИРОВАТЬ ПО
					|	Сотрудник";		
					Запрос.Выполнить();
				КонецЕсли;
			КонецЕсли;
			// НормаВремениПоСводнымИндивидуальнымГрафикам
			//		Сотрудники, для которых введены сводные данные об их графике
			// 
			//	Поля:
			//		Сотрудник
			//		ЧасовЗаМесяц - указанное пользователем значение
			// 
			Если не МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
				И НЕ МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский тогда //Аверсон 10.02.2022 КВВ СВФР-008723
				
				Запрос.Текст =
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	СписокРаботников.Сотрудник КАК Сотрудник,
				|	СводныеИндивидуальныеГрафики.Часов КАК ЧасовЗаМесяц
				|ИЗ
				|	ВТСписокРаботников КАК СписокРаботников
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
				|		ПО СписокРаботников.Сотрудник = СводныеИндивидуальныеГрафики.Сотрудник
				|			И (СводныеИндивидуальныеГрафики.Месяц = &парамПериодРегистрации)
				|ГДЕ
				|	СводныеИндивидуальныеГрафики.Сотрудник ЕСТЬ НЕ NULL";
				
				Запрос.Выполнить();
				
				Запрос.Текст =
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	СписокРаботников.Сотрудник КАК Сотрудник,
				|	СводныеИндивидуальныеГрафики.Часов КАК ЧасовЗаМесяц
				|ПОМЕСТИТЬ ВТНормаВремениПоСводнымИндивидуальнымГрафикам
				|ИЗ
				|	ВТСписокРаботников КАК СписокРаботников
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
				|		ПО СписокРаботников.Сотрудник = СводныеИндивидуальныеГрафики.Сотрудник
				|			И (СводныеИндивидуальныеГрафики.Месяц = &парамПериодРегистрации)
				|ГДЕ
				|	СводныеИндивидуальныеГрафики.Сотрудник ЕСТЬ НЕ NULL 
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";
				Запрос.Выполнить();
				
				// НормаВремениПоЕжедневнымИндивидуальнымГрафикам
				//		Таблица сотрудников и нормы времени в часах, введенной индивидуальными графиками
				// 
				//	Поля:
				//		Сотрудник,
				//		ЧасовЗаМесяц - суммируем все часы рабочего времени
				// 
				// Описание:
				//
				//	выбираем данные из рег-ра ГрафикиРаботыПоВидамВремени,	
				//	введенные доками ВводИндивидуальныхГрафиков, т.е. по строкам с выставленным флажком План
				
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СписокРаботников.Сотрудник КАК Сотрудник,
				|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
				|ИЗ
				|	ВТСписокРаботников КАК СписокРаботников
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
				|		ПО СписокРаботников.Сотрудник = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
				|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
				|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
				|			И (ГрафикиРаботыПоВидамВремени.План)
				|ГДЕ
				|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL
				|
				|СГРУППИРОВАТЬ ПО
				|	СписокРаботников.Сотрудник";
				
				Запрос.Выполнить();
				
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СписокРаботников.Сотрудник КАК Сотрудник,
				|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
				|ПОМЕСТИТЬ ВТНормаВремениПоЕжедневнымИндивидуальнымГрафикам
				|ИЗ
				|	ВТСписокРаботников КАК СписокРаботников
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
				|		ПО СписокРаботников.Сотрудник = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
				|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
				|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
				|			И (ГрафикиРаботыПоВидамВремени.План)
				|ГДЕ
				|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
				|
				|СГРУППИРОВАТЬ ПО
				|	СписокРаботников.Сотрудник
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";
				Запрос.Выполнить();
				
				// НормаВремениПоОбщимГрафикам
				//		Таблица сотрудников и нормы времени в часах по общим графикам
				// 
				//	Поля:
				//		Сотрудник,
				//		ЧасовЗаМесяц - суммируем все часы рабочего времени
				// 
				// Описание:
				//
				//	выбираем данные из рег-ра ГрафикиРаботыПоВидамВремени для общих графиков
				
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СписокРаботников.Сотрудник КАК Сотрудник,
				|	СписокРаботников.ГрафикРаботы,
				|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц
				|ИЗ
				|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
				|		СписокРаботников.Сотрудник КАК Сотрудник,
				|		ВЫБОР
				|			КОГДА СписокРаботников.ГрафикРаботы.СокращенноеРабочееВремя
				|					И СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
				|				ТОГДА СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени
				|			ИНАЧЕ СписокРаботников.ГрафикРаботы
				|		КОНЕЦ КАК ГрафикРаботы
				|	ИЗ
				|		ВТДвиженияРаботников КАК СписокРаботников) КАК СписокРаботников
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
				|		ПО СписокРаботников.ГрафикРаботы = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
				|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
				|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
				|			И (ГрафикиРаботыПоВидамВремени.План)
				|ГДЕ
				|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
				|
				|СГРУППИРОВАТЬ ПО
				|	СписокРаботников.Сотрудник,
				|	СписокРаботников.ГрафикРаботы";
				Запрос.Выполнить();
				
				Запрос.Текст =
				"ВЫБРАТЬ
				|	СписокРаботников.Сотрудник КАК Сотрудник,
				|	СписокРаботников.ГрафикРаботы,
				|	СУММА(ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение) КАК ЧасовЗаМесяц,
				|	СписокРаботников.ПодразделениеОрганизации
				|ПОМЕСТИТЬ ВТНормаВремениПоОбщимГрафикам
				|ИЗ
				|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
				|		СписокРаботников.Сотрудник КАК Сотрудник,
				|		ВЫБОР
				|			КОГДА СписокРаботников.ГрафикРаботы.СокращенноеРабочееВремя
				|					И СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
				|				ТОГДА СписокРаботников.ГрафикРаботы.ГрафикПолногоРабочегоВремени
				|			ИНАЧЕ СписокРаботников.ГрафикРаботы
				|		КОНЕЦ КАК ГрафикРаботы,
				|		СписокРаботников.ПодразделениеОрганизации КАК ПодразделениеОрганизации
				|	ИЗ
				|		ВТДвиженияРаботников КАК СписокРаботников) КАК СписокРаботников
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
				|		ПО СписокРаботников.ГрафикРаботы = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
				|			И (ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням))
				|			И (ГрафикиРаботыПоВидамВремени.Месяц = &парамПериодРегистрации)
				|			И (ГрафикиРаботыПоВидамВремени.План)
				|ГДЕ
				|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
				|
				|СГРУППИРОВАТЬ ПО
				|	СписокРаботников.Сотрудник,
				|	СписокРаботников.ГрафикРаботы,
				|	СписокРаботников.ПодразделениеОрганизации
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";
				Запрос.Выполнить();
				
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	ДатыСтажа.Сотрудник КАК Сотрудник,
				|	ДатыСтажа.Физлицо,
				|	ДатыСтажа.ПериодРаботники,
				|	ДатыСтажа.ПериодСеверногоСтажа КАК ДатаРегистрацииСеверногоСтажа,
				|	СведенияОСтажеРаботыНаСевере.ПорядокНачисленияСеверныхНадбавок,
				|	СведенияОСтажеРаботыНаСевере.НачальныйПроцентСевернойНадбавки,
				|	СведенияОСтажеРаботыНаСевере.СеверныйСтажМесяцев,
				|	СведенияОСтажеРаботыНаСевере.СеверныйСтажДней
				|ПОМЕСТИТЬ ВТДанныеОСеверномСтаже
				|ИЗ
				|	(ВЫБРАТЬ
				|		СписокНачислений.Сотрудник КАК Сотрудник,
				|		СписокНачислений.Физлицо КАК Физлицо,
				|		СписокНачислений.ПериодРаботники КАК ПериодРаботники,
				|		МАКСИМУМ(СведенияОСтажеРаботыНаСевере.Период) КАК ПериодСеверногоСтажа
				|	ИЗ
				|		ВТРаботникиИНачисления КАК СписокНачислений
				|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОСтажеРаботыНаСевере КАК СведенияОСтажеРаботыНаСевере
				|			ПО СписокНачислений.Физлицо = СведенияОСтажеРаботыНаСевере.ФизЛицо
				|				И СписокНачислений.ПериодРаботники >= СведенияОСтажеРаботыНаСевере.Период
				|	
				|	СГРУППИРОВАТЬ ПО
				|		СписокНачислений.Сотрудник,
				|		СписокНачислений.Физлицо,
				|		СписокНачислений.ПериодРаботники) КАК ДатыСтажа
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОСтажеРаботыНаСевере КАК СведенияОСтажеРаботыНаСевере
				|		ПО ДатыСтажа.Физлицо = СведенияОСтажеРаботыНаСевере.ФизЛицо
				|			И ДатыСтажа.ПериодСеверногоСтажа = СведенияОСтажеРаботыНаСевере.Период
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";
				Запрос.Выполнить();
				
				// РаботникиИНачисленияПоСхемамМотивации
				//		Таблица движений работников и сведениями об их плановых начислениях
				//      с добавленными значениями показателей, как введенными пользователями для расчета, так и 
				//      выбранными из строк плановых начислений, содержащих тарифные ставки по "основным" начислениям работника
				// 
				//	Поля:
				//		Сотрудник 
				//		ВидРасчета - плановое начисление 
				//		Показатель1,...,6 - размеры показателей 
				//		СпособРасчета - способ расчета начисления 
				//		ОкладТариф - размер трифной ставки, если начисление ее содержит  
				//		ГрафикРаботы - график сотрудника  
				//		ВидГрафика, СуммированныйУчетРабочегоВремени, ДлительностьРабочейНедели - реквизиты графика сотрудника 
				// 
				// Описание:
				//
				//	1. 
				//  2. 
				//
				
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	СписокНачислений.Сотрудник КАК Сотрудник,
				|	СписокНачислений.СотрудникНаименование,
				|	СписокНачислений.Физлицо,
				|	СписокНачислений.ПодразделениеОрганизации,
				|   СписокНачислений.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
				|	СписокНачислений.Подходит,
				|	СписокНачислений.Период,
				|	СписокНачислений.ПериодРаботники,
				|	СписокНачислений.ПериодНачисления,
				|	СписокНачислений.ОсновноеНачисление,
				|	СписокНачислений.ВидРасчета,
				|	СписокНачислений.ВидРасчетаНаименование,
				|	СписокНачислений.ВидРасчетаКоэффициентСтажа,
				|	СписокНачислений.ВидРасчетаВидСтажа,
				|	СписокНачислений.ВидРасчетаТребуетВводаТарифногоРазряда,
				|	СписокНачислений.СпособРасчета,
				|	СписокНачислений.ВидВремени,
				|	СписокНачислений.Действие,
				|	СписокНачислений.КодВычета,
				|	СписокНачислений.ДатаНачалаСобытия,
				|	СписокНачислений.ГрафикРаботы,
				|	СписокНачислений.СуммированныйУчетРабочегоВремени,
				|	СписокНачислений.ДлительностьРабочейНедели,
				|	СписокНачислений.ВидГрафика,
				|	СписокНачислений.Валюта1 КАК Валюта,
				|	СписокНачислений.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА 1
				|		ИНАЧЕ Валюты1.Курс
				|	КОНЕЦ КАК КурсВалюты,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
				|				И ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ НЕ NULL 
				|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
				|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель1
				|		КОГДА (СписокНачислений.Показатель1 = 0
				|				ИЛИ СписокНачислений.Показатель1 ЕСТЬ NULL )
				|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1)
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|			ТОГДА СписокНачислений.Показатель1
				|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель1
				|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
				|	КОНЕЦ КАК Показатель1,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
				|				И ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 2)
				|			ТОГДА 0
				|		КОГДА ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
				|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
				|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель2
				|		КОГДА (СписокНачислений.Показатель2 = 0
				|				ИЛИ СписокНачислений.Показатель2 ЕСТЬ NULL )
				|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2)
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|			ТОГДА СписокНачислений.Показатель2
				|		КОГДА СписокНачислений.Валюта2 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель2
				|		ИНАЧЕ СписокНачислений.Показатель2 * ЕСТЬNULL(Валюты2.Курс / Валюты2.Кратность, 0)
				|	КОНЕЦ КАК Показатель2,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
				|				И ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 3)
				|			ТОГДА 0
				|		КОГДА ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
				|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
				|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель3
				|		КОГДА СписокНачислений.Показатель3 = 0
				|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3)
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|			ТОГДА СписокНачислений.Показатель3
				|		КОГДА СписокНачислений.Валюта3 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель3
				|		ИНАЧЕ СписокНачислений.Показатель3 * ЕСТЬNULL(Валюты3.Курс / Валюты3.Кратность, 0)
				|	КОНЕЦ КАК Показатель3,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
				|				И ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 4)
				|			ТОГДА 0
				|		КОГДА ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
				|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
				|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель4
				|		КОГДА СписокНачислений.Показатель4 = 0
				|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4)
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|			ТОГДА СписокНачислений.Показатель4
				|		КОГДА СписокНачислений.Валюта4 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель4
				|		ИНАЧЕ СписокНачислений.Показатель4 * ЕСТЬNULL(Валюты4.Курс / Валюты4.Кратность, 0)
				|	КОНЕЦ КАК Показатель4,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
				|				И ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 5)
				|			ТОГДА 0
				|		КОГДА ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
				|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
				|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель5
				|		КОГДА СписокНачислений.Показатель5 = 0
				|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5)
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|			ТОГДА СписокНачислений.Показатель5
				|		КОГДА СписокНачислений.Валюта5 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель5
				|		ИНАЧЕ СписокНачислений.Показатель5 * ЕСТЬNULL(Валюты5.Курс / Валюты5.Кратность, 0)
				|	КОНЕЦ КАК Показатель5,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
				|				И ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ NULL 
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.НомерСтроки <> 6)
				|			ТОГДА 0
				|		КОГДА ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
				|				ИЛИ (ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.Периодически))
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
				|			ТОГДА ПоказателиВведенныеПриРасчете.Показатель6
				|		КОГДА СписокНачислений.Показатель6 = 0
				|				И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|				И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
				|					ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка
				|						И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6)
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|			ТОГДА СписокНачислений.Показатель6
				|		КОГДА СписокНачислений.Валюта6 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель6
				|		ИНАЧЕ СписокНачислений.Показатель6 * ЕСТЬNULL(Валюты6.Курс / Валюты6.Кратность, 0)
				|	КОНЕЦ КАК Показатель6,
				|	ПоказательТарифнойСтавки.Показатель КАК ВидТарифнойСтавки,
				|	ВЫБОР
				|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 1
				|			ТОГДА ВЫБОР
				|					КОГДА ПоказателиВведенныеПриРасчете.Показатель1 ЕСТЬ НЕ NULL 
				|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель1
				|					КОГДА СписокНачислений.Показатель1 = 0
				|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
				|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
				|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|					КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
				|						ТОГДА 0
				|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ТОГДА СписокНачислений.Показатель1
				|					КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|						ТОГДА СписокНачислений.Показатель1
				|					ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
				|				КОНЕЦ
				|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 2
				|			ТОГДА ВЫБОР
				|					КОГДА ПоказателиВведенныеПриРасчете.Показатель2 ЕСТЬ НЕ NULL 
				|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель2
				|					КОГДА СписокНачислений.Показатель2 = 0
				|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
				|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
				|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|					КОГДА СписокНачислений.Показатель2 ЕСТЬ NULL 
				|						ТОГДА 0
				|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ТОГДА СписокНачислений.Показатель2
				|					КОГДА СписокНачислений.Валюта2 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|						ТОГДА СписокНачислений.Показатель2
				|					ИНАЧЕ СписокНачислений.Показатель2 * ЕСТЬNULL(Валюты2.Курс / Валюты2.Кратность, 0)
				|				КОНЕЦ
				|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 3
				|			ТОГДА ВЫБОР
				|					КОГДА ПоказателиВведенныеПриРасчете.Показатель3 ЕСТЬ НЕ NULL 
				|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель3
				|					КОГДА СписокНачислений.Показатель3 = 0
				|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
				|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
				|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|					КОГДА СписокНачислений.Показатель3 ЕСТЬ NULL 
				|						ТОГДА 0
				|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ТОГДА СписокНачислений.Показатель3
				|					КОГДА СписокНачислений.Валюта3 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|						ТОГДА СписокНачислений.Показатель3
				|					ИНАЧЕ СписокНачислений.Показатель3 * ЕСТЬNULL(Валюты3.Курс / Валюты3.Кратность, 0)
				|				КОНЕЦ
				|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 4
				|			ТОГДА ВЫБОР
				|					КОГДА ПоказателиВведенныеПриРасчете.Показатель4 ЕСТЬ НЕ NULL 
				|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель4
				|					КОГДА СписокНачислений.Показатель4 = 0
				|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
				|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
				|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|					КОГДА СписокНачислений.Показатель4 ЕСТЬ NULL 
				|						ТОГДА 0
				|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ТОГДА СписокНачислений.Показатель4
				|					КОГДА СписокНачислений.Валюта4 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|						ТОГДА СписокНачислений.Показатель4
				|					ИНАЧЕ СписокНачислений.Показатель4 * ЕСТЬNULL(Валюты4.Курс / Валюты4.Кратность, 0)
				|				КОНЕЦ
				|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 5
				|			ТОГДА ВЫБОР
				|					КОГДА ПоказателиВведенныеПриРасчете.Показатель5 ЕСТЬ НЕ NULL 
				|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель5
				|					КОГДА СписокНачислений.Показатель5 = 0
				|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
				|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
				|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|					КОГДА СписокНачислений.Показатель5 ЕСТЬ NULL 
				|						ТОГДА 0
				|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ТОГДА СписокНачислений.Показатель5
				|					КОГДА СписокНачислений.Валюта5 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|						ТОГДА СписокНачислений.Показатель5
				|					ИНАЧЕ СписокНачислений.Показатель5 * ЕСТЬNULL(Валюты5.Курс / Валюты5.Кратность, 0)
				|				КОНЕЦ
				|		КОГДА ПоказательТарифнойСтавки.НомерСтроки = 6
				|			ТОГДА ВЫБОР
				|					КОГДА ПоказателиВведенныеПриРасчете.Показатель6 ЕСТЬ НЕ NULL 
				|						ТОГДА ПоказателиВведенныеПриРасчете.Показатель6
				|					КОГДА СписокНачислений.Показатель6 = 0
				|							И (ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|									И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
				|								ИЛИ ЗначенияВводимыхКадровыхПоказателей.ЭтоТарифнаяСтавка)
				|						ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|					КОГДА СписокНачислений.Показатель6 ЕСТЬ NULL 
				|						ТОГДА 0
				|					КОГДА СписокНачислений.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ТОГДА СписокНачислений.Показатель6
				|					КОГДА СписокНачислений.Валюта6 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|						ТОГДА СписокНачислений.Показатель6
				|					ИНАЧЕ СписокНачислений.Показатель6 * ЕСТЬNULL(Валюты6.Курс / Валюты6.Кратность, 0)
				|				КОНЕЦ
				|		ИНАЧЕ 0
				|	КОНЕЦ КАК ОкладТариф,
				|	СписокНачислений.ТабНомер,
				|	СписокНачислений.ПериодЗавершения,
				|	СписокНачислений.ПоказательВВалюте"
				
				//Аверсон ЕАЕ 09.03.2022 СВФР-008825
				+ ?(Организация.ИНН = "100071565", ",
				|   СписокНачислений.СовмещаемаяПрофессия КАК СовмещаемаяПрофессия", "") + "
				//Аверсон СВФР-008825
				
				|ПОМЕСТИТЬ ВТРаботникиИНачисленияПоСхемамМотивации
				|ИЗ
				|	ВТРаботникиИНачисления КАК СписокНачислений
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказатели КАК ПоказателиВведенныеПриРасчете
				|		ПО СписокНачислений.ВидРасчета = ПоказателиВведенныеПриРасчете.ВидРасчета
				|			И (СписокНачислений.Сотрудник = ПоказателиВведенныеПриРасчете.Сотрудник
				|				ИЛИ СписокНачислений.ПодразделениеОрганизации = ПоказателиВведенныеПриРасчете.ПодразделениеОрганизации)
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
				|			НеВводимыеПоказатели.Ссылка КАК Ссылка,
				|			НеВводимыеПоказатели.НомерСтроки КАК НомерСтроки,
				|			НеВводимыеПоказатели.Показатель КАК Показатель,
				|			НеВводимыеПоказатели.ПоказательВозможностьИзменения КАК ПоказательВозможностьИзменения,
				|			НеВводимыеПоказатели.ЭтоТарифнаяСтавка КАК ЭтоТарифнаяСтавка,
				|			СУММА(ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя) КАК ЗначениеПоказателя,
				|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник КАК Сотрудник,
				|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период,
				|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники КАК ПериодРаботники
				|		ИЗ
				|			ВТНеЗапрашиваемыеПриКадровыхПеремещениях КАК НеВводимыеПоказатели
				|				ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
				|				ПО НеВводимыеПоказатели.Показатель = ЗначенияВводимыхКадровыхПоказателей.Показатель
				|		ГДЕ
				|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
				|		
				|		СГРУППИРОВАТЬ ПО
				|			НеВводимыеПоказатели.Ссылка,
				|			НеВводимыеПоказатели.НомерСтроки,
				|			НеВводимыеПоказатели.Показатель,
				|			НеВводимыеПоказатели.ПоказательВозможностьИзменения,
				|			НеВводимыеПоказатели.ЭтоТарифнаяСтавка,
				|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник,
				|			ЗначенияВводимыхКадровыхПоказателей.Период,
				|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники) КАК ЗначенияВводимыхКадровыхПоказателей
				|		ПО СписокНачислений.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
				|			И (КОНЕЦПЕРИОДА(СписокНачислений.Период, МЕСЯЦ) = КОНЕЦПЕРИОДА(ЗначенияВводимыхКадровыхПоказателей.Период, МЕСЯЦ))
				|			И СписокНачислений.ПериодРаботники = ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники
				|			И СписокНачислений.ВидРасчета = ЗначенияВводимыхКадровыхПоказателей.Ссылка
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты1
				|		ПО (Валюты1.Период = &парамДатаВалютногоУчета)
				|			И СписокНачислений.Валюта1 = Валюты1.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты2
				|		ПО (Валюты2.Период = &парамДатаВалютногоУчета)
				|			И СписокНачислений.Валюта2 = Валюты2.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты3
				|		ПО (Валюты3.Период = &парамДатаВалютногоУчета)
				|			И СписокНачислений.Валюта3 = Валюты3.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты4
				|		ПО (Валюты4.Период = &парамДатаВалютногоУчета)
				|			И СписокНачислений.Валюта4 = Валюты4.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты5
				|		ПО (Валюты5.Период = &парамДатаВалютногоУчета)
				|			И СписокНачислений.Валюта5 = Валюты5.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты6
				|		ПО (Валюты6.Период = &парамДатаВалютногоУчета)
				|			И СписокНачислений.Валюта6 = Валюты6.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТВводимыеВПлановыхНачисленияхПоказатели КАК ПоказательТарифнойСтавки
				|		ПО СписокНачислений.ВидРасчета = ПоказательТарифнойСтавки.Ссылка
				|			И (ПоказательТарифнойСтавки.Показатель В (ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная), ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая), ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)))
				|ГДЕ
				|	ВЫБОР
				|			КОГДА СписокНачислений.Подходит
				|				ТОГДА НЕ СписокНачислений.ВидРасчета ЕСТЬ NULL 
				|			ИНАЧЕ ИСТИНА
				|		КОНЕЦ
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	Сотрудник";
				Запрос.Выполнить();
				
				//Основной текст запроса
				//Островская Татьяна 24.07.2013 № 16643(стаж*12)
				ОсновнойТекстЗапроса = 
				"ВЫБРАТЬ
				|	СписокНачислений.Сотрудник КАК Сотрудник,
				|	СписокНачислений.СотрудникНаименование КАК СотрудникНаименование,
				|	СписокНачислений.Физлицо КАК Физлицо,
				|	СписокНачислений.ПодразделениеОрганизации,
				|   СписокНачислений.ауМестоРаботы, //Аверсон 02.09.2022 КВВ СВФР-009482
				|	СписокНачислений.Подходит,
				|	СписокНачислений.Период,
				|	СписокНачислений.ПериодРаботники КАК ПериодРаботники,
				|	СписокНачислений.ПериодНачисления КАК ПериодНачисления,
				|	СписокНачислений.ОсновноеНачисление КАК ОсновноеНачисление,
				|	СписокНачислений.ВидРасчета КАК ВидРасчета,
				|	СписокНачислений.ВидРасчетаНаименование,
				|	ЕСТЬNULL(СписокНачислений.ВидРасчетаТребуетВводаТарифногоРазряда, ЛОЖЬ) КАК ТребуетВводаТарифногоРазряда,
				|	СписокНачислений.СпособРасчета,
				|	СписокНачислений.ВидВремени,
				|	СписокНачислений.Действие,
				|	СписокНачислений.КодВычета,
				|	СписокНачислений.ДатаНачалаСобытия,
				|	СписокНачислений.ГрафикРаботы,
				|	СписокНачислений.СуммированныйУчетРабочегоВремени,
				|	СписокНачислений.Валюта,
				|	СписокНачислений.КурсВалюты,
				|	СписокНачислений.ВидТарифнойСтавки,
				|	СписокНачислений.ИспользуетсяВНаряде КАК ИспользуетсяВНаряде,
				|	ВЫБОР
				|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаЧасовая)
				|			ТОГДА СписокНачислений.ОкладТариф
				|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаМесячная)
				|			ТОГДА ВЫРАЗИТЬ(ВЫБОР
				|						КОГДА ЕСТЬNULL(ВариантыВстроенныхАлгоритмовРасчетаЗарплаты.ПорядокПересчетаМесячнойСтавкиВЧасовую, ЗНАЧЕНИЕ(Перечисление.ПорядкиПересчетаМесячнойСтавкиВЧасовую.ПоСреднемуКоличествуЧасовВМесяце)) = ЗНАЧЕНИЕ(Перечисление.ПорядкиПересчетаМесячнойСтавкиВЧасовую.ПоСреднемуКоличествуЧасовВМесяце)
				|							ТОГДА ВЫБОР
				|									КОГДА ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоРабочихДней, 0) = 0
				|										ТОГДА 0
				|									КОГДА СписокНачислений.ДлительностьРабочейНедели = 0
				|										ТОГДА 0
				|									ИНАЧЕ СписокНачислений.ОкладТариф / (СписокНачислений.ДлительностьРабочейНедели / 5 * (ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоРабочихДней, 0) + ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоПредпраздничныхДней, 0)) - ЕСТЬNULL(ДанныеПроизводственногоКалендаря.ЧислоПредпраздничныхДней, 0)) * 12
				|								КОНЕЦ
				|						КОГДА ВЫБОР
				|								КОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
				|									ТОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц
				|								КОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
				|									ТОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц
				|								ИНАЧЕ ЕСТЬNULL(НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц, 0)
				|							КОНЕЦ = 0
				|							ТОГДА 0
				|						ИНАЧЕ СписокНачислений.ОкладТариф / ВЫБОР
				|								КОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
				|									ТОГДА НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц
				|								КОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник ЕСТЬ НЕ NULL 
				|									ТОГДА НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц
				|								ИНАЧЕ ЕСТЬNULL(НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц, 0)
				|							КОНЕЦ
				|					КОНЕЦ КАК ЧИСЛО(15, 3))
				|		КОГДА СписокНачислений.ВидТарифнойСтавки = ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ТарифнаяСтавкаДневная)
				|			ТОГДА ВЫРАЗИТЬ(ВЫБОР
				|						КОГДА СписокНачислений.ДлительностьРабочейНедели = 0
				|							ТОГДА 0
				|						ИНАЧЕ СписокНачислений.ОкладТариф / СписокНачислений.ДлительностьРабочейНедели * ВЫБОР
				|								КОГДА СписокНачислений.ВидГрафика = ЗНАЧЕНИЕ(Перечисление.ВидыРабочихГрафиков.Шестидневка)
				|									ТОГДА 6
				|								ИНАЧЕ 5
				|							КОНЕЦ
				|					КОНЕЦ КАК ЧИСЛО(15, 3))
				|		ИНАЧЕ 0
				|	КОНЕЦ КАК ЧасоваяТарифнаяСтавка,
				|	СписокНачислений.Показатель1,
				|	СписокНачислений.Показатель2,
				|	СписокНачислений.Показатель3,
				|	СписокНачислений.Показатель4,
				|	СписокНачислений.Показатель5,
				|	СписокНачислений.Показатель6,
				|	СведенияОСтажеРаботыНаСевере.ДатаРегистрацииСеверногоСтажа,
				|	СведенияОСтажеРаботыНаСевере.ПорядокНачисленияСеверныхНадбавок,
				|	СведенияОСтажеРаботыНаСевере.НачальныйПроцентСевернойНадбавки,
				|	СведенияОСтажеРаботыНаСевере.СеверныйСтажМесяцев,
				|	СведенияОСтажеРаботыНаСевере.СеверныйСтажДней,
				|	ШкалаКоэффициентовСтажа.Величина КАК КоэффициентСтажа,
				|	ШкалаСледКоэффициентовСтажа.Величина КАК СледКоэффициентСтажа,
				|	ВЫБОР
				|		КОГДА НЕ ШкалаСледКоэффициентовСтажа.Величина ЕСТЬ NULL 
				|			ТОГДА ВЫБОР
				|					КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > Стажи.РазмерДней
				|						ТОГДА ДЕНЬ(Стажи.ДатаОтсчета) - Стажи.РазмерДней
				|					ИНАЧЕ ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, -1)) - (Стажи.РазмерДней - ДЕНЬ(Стажи.ДатаОтсчета))
				|				КОНЕЦ
				|	КОНЕЦ КАК ДеньСменыКоэффициентаСтажа,
				|	ВЫБОР
				|		КОГДА &ЭтоПерерасчет
				|			ТОГДА ЛОЖЬ
				|		КОГДА ОсновныеНачисления.Сотрудник ЕСТЬ NULL 
				|			ТОГДА ЛОЖЬ
				|		ИНАЧЕ ИСТИНА
				|	КОНЕЦ КАК УжеПроведен,
				|	НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник КАК Сотрудник1,
				|	НормаВремениПоСводнымИндивидуальнымГрафикам.ЧасовЗаМесяц,
				|	НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник КАК Сотрудник2,
				|	НормаВремениПоЕжедневнымИндивидуальнымГрафикам.ЧасовЗаМесяц КАК ЧасовЗаМесяц1,
				|	НормаВремениПоОбщимГрафикам.ЧасовЗаМесяц КАК ЧасовЗаМесяц2,
				|	СписокНачислений.ТабНомер,
				|	СписокНачислений.ПериодЗавершения,
				|	СписокНачислений.ПоказательВВалюте"
				
				//Аверсон ЕАЕ 09.03.2022 СВФР-008825
				+ ?(Организация.ИНН = "100071565", ",
				|   СписокНачислений.СовмещаемаяПрофессия КАК СовмещаемаяПрофессия", "") + "
				//Аверсон СВФР-008825
				
				|ИЗ
				|	ВТРаботникиИНачисленияПоСхемамМотивации КАК СписокНачислений
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОСеверномСтаже КАК СведенияОСтажеРаботыНаСевере
				|		ПО СписокНачислений.Сотрудник = СведенияОСтажеРаботыНаСевере.Сотрудник
				|			И СписокНачислений.ПериодРаботники = СведенияОСтажеРаботыНаСевере.ПериодРаботники
				|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ФизическиеЛица.Стажи КАК Стажи
				|		ПО СписокНачислений.ВидРасчетаВидСтажа = Стажи.ВидСтажа
				|			И СписокНачислений.Физлицо = Стажи.Ссылка
				|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаКоэффициентовСтажа
				|		ПО СписокНачислений.ВидРасчетаКоэффициентСтажа = ШкалаКоэффициентовСтажа.КоэффициентСтажа
				|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
				|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
				|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
				|					ТОГДА 1
				|				ИНАЧЕ 0
				|			КОНЕЦ >= ШкалаКоэффициентовСтажа.СтажС * &Месяцы)
				|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
				|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) > ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
				|					ТОГДА 1
				|				ИНАЧЕ 0
				|			КОНЕЦ < ВЫБОР
				|				КОГДА ШкалаКоэффициентовСтажа.СтажПо = 0
				|					ТОГДА 999999
				|				ИНАЧЕ ШкалаКоэффициентовСтажа.СтажПо * &Месяцы
				|			КОНЕЦ)
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШкалаКоэффициентовСтажа КАК ШкалаСледКоэффициентовСтажа
				|		ПО СписокНачислений.ВидРасчетаКоэффициентСтажа = ШкалаСледКоэффициентовСтажа.КоэффициентСтажа
				|			И (СписокНачислений.СпособРасчета В (&СпособыРасчетаОтСтажа))
				|			И (ШкалаСледКоэффициентовСтажа.НомерСтрокиШкалы = ШкалаКоэффициентовСтажа.НомерСтрокиШкалы + 1)
				|			И (Стажи.РазмерМесяцев + РАЗНОСТЬДАТ(Стажи.ДатаОтсчета, ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней), МЕСЯЦ) - ВЫБОР
				|				КОГДА ДЕНЬ(Стажи.ДатаОтсчета) >= ДЕНЬ(ДОБАВИТЬКДАТЕ(&парамНачало, ДЕНЬ, Стажи.РазмерДней))
				|					ТОГДА 1
				|				ИНАЧЕ 0
				|			КОНЕЦ = ШкалаКоэффициентовСтажа.СтажПо * &Месяцы - 1)
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			СУММА(ВЫБОР
				|					КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Рабочий)
				|						ТОГДА 1
				|					ИНАЧЕ 0
				|				КОНЕЦ) КАК ЧислоРабочихДней,
				|			СУММА(ВЫБОР
				|					КОГДА РегламентированныйПроизводственныйКалендарь.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Предпраздничный)
				|						ТОГДА 1
				|					ИНАЧЕ 0
				|				КОНЕЦ) КАК ЧислоПредпраздничныхДней
				|		ИЗ
				|			РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
				|		ГДЕ
				|			РегламентированныйПроизводственныйКалендарь.Год = &Год) КАК ДанныеПроизводственногоКалендаря
				|		ПО (ИСТИНА)
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоСводнымИндивидуальнымГрафикам КАК НормаВремениПоСводнымИндивидуальнымГрафикам
				|		ПО СписокНачислений.Сотрудник = НормаВремениПоСводнымИндивидуальнымГрафикам.Сотрудник
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоЕжедневнымИндивидуальнымГрафикам КАК НормаВремениПоЕжедневнымИндивидуальнымГрафикам
				|		ПО СписокНачислений.Сотрудник = НормаВремениПоЕжедневнымИндивидуальнымГрафикам.Сотрудник
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНормаВремениПоОбщимГрафикам КАК НормаВремениПоОбщимГрафикам
				|		ПО СписокНачислений.Сотрудник = НормаВремениПоОбщимГрафикам.Сотрудник
				|		И СписокНачислений.ПодразделениеОрганизации = НормаВремениПоОбщимГрафикам.ПодразделениеОрганизации //О.Т. Аверсон 14.06.2018 №
				
				//Аверсон ЕАЕ 21.02.2022 СВФР-008825
				//|		И СписокНачислений.ГрафикРаботы = НормаВремениПоОбщимГрафикам.ГрафикРаботы
				//Аверсон СВФР-008825
				
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ВариантыВстроенныхАлгоритмовРасчетаЗарплаты КАК ВариантыВстроенныхАлгоритмовРасчетаЗарплаты
				|		ПО (ИСТИНА)
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОсновныеНачисления КАК ОсновныеНачисления
				|		ПО СписокНачислений.Сотрудник = ОсновныеНачисления.Сотрудник
				|			И СписокНачислений.ПодразделениеОрганизации = ОсновныеНачисления.ПодразделениеОрганизации";
				//О.Т. Аверсон 11.06.2018 № 2060
				Если Организация.НачислениеЕжемесячныхПособийОтдельнымДок Тогда 
					ОсновнойТекстЗапроса = ОсновнойТекстЗапроса +"
					|		ГДЕ
					|		НЕ СписокНачислений.ВидРасчета В (&ДетскиеПособияИскл)";
				КонецЕсли;
				ОсновнойТекстЗапроса = ОсновнойТекстЗапроса +"
				//О.Т. Аверсон 11.06.2018 № 3060
				|
				|УПОРЯДОЧИТЬ ПО
				|	СотрудникНаименование,
				|	Сотрудник,
				|	ПериодРаботники, 
				|	ПериодНачисления, 
				|	ОсновноеНачисление УБЫВ,
				|	Видрасчета"; 
				Запрос.УстановитьПараметр("Месяцы",?(Организация.ИНН = "100765738",12,1));
			КонецЕсли; //Островская Татьяна 24.07.2013 № 16643(*12)
			
			Запрос.Текст = ОсновнойТекстЗапроса;
			РезультатЗапроса = Запрос.Выполнить();
			
			НачисленияВыборка = РезультатЗапроса.Выбрать();
			//Аверсон-софт, Островская Татьяна 13.03.2012
			Если  МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
				ИЛИ МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский тогда //Аверсон 10.02.2022 КВВ СВФР-008723
				ТЗНачисления = СформироватьТаблицуДоговорыНаВыполнениеРабот(НачисленияВыборка, ОкончаниеПериодаЗаполнения, РезультатЗапроса.Выгрузить());
			иначе
				
				
				ТЗНачисления = СформироватьТаблицуНачислений(НачисленияВыборка, ОкончаниеПериодаЗаполнения, РезультатЗапроса.Выгрузить(),,ТЧРаботавшиеВПраздники); // О.Т. 02.12.2014 
				//Островская Татьяна 27.11.2012 № ??
				РезультатЗапроса = Запрос.Выполнить();
				ДопНачисленияВыборка = РезультатЗапроса.Выбрать();
				ДопНачисления = Истина;
				ДопНачисления = СформироватьТаблицуНачислений(ДопНачисленияВыборка, ОкончаниеПериодаЗаполнения, РезультатЗапроса.Выгрузить(),ДопНачисления,ТЧРаботавшиеВПраздники); // О.Т. 02.12.2014 
				
				Для Каждого ДопНачислениеИзТаблицыЗначений Из ДопНачисления Цикл
					//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
					//если ДопНачислениеИзТаблицыЗначений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом Тогда 
					//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
					если Не ДопНачислениеИзТаблицыЗначений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом Тогда 
						НоваяСтрока	=	ДополнительныеНачисления.Добавить();
						НоваяСтрока.Авторасчет		= Истина;
						ЗаполнитьЗначенияСвойств(НоваяСтрока,ДопНачислениеИзТаблицыЗначений,СтрокаПолейДополнительныхНачислений); //Сотрудник,ВидРасчета,Размер,КодВычета,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
						НоваяСтрока.ДатаНачалаСобытия = ДопНачислениеИзТаблицыЗначений.ДатаНачала;
						НоваяСтрока.ПериодРасчетаСреднегоЗаработкаНачало = ДопНачислениеИзТаблицыЗначений.ДатаНачала;
						НоваяСтрока.ПериодРасчетаСреднегоЗаработкаОкончание = ДопНачислениеИзТаблицыЗначений.ДатаОкончания;
						
						мСведенияОВидахРасчета = Новый Соответствие;
						мСведенияОВидахРасчета.Вставить("ОкладПоДням",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
						мСведенияОВидахРасчета.Вставить("ОкладПоЧасам",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
						мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасы",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
						мСведенияОВидахРасчета.Вставить("ДоплатаЗаРазъезднойХарактерРаботы",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Доплата за разъездной характер работы"));
						мСведенияОВидахРасчета.Вставить("Месячная",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Месячная"));
						//О.Т. Аверсон 03.04.2016 № 981
						Запрос1 = Новый Запрос;
						Запрос1.Текст = 
						"ВЫБРАТЬ
						|	ОсновныеНачисленияОрганизаций.Ссылка
						|ИЗ
						|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
						|ГДЕ
						|	ОсновныеНачисленияОрганизаций.СпособРасчета = &СпособРасчета";			
						Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);
						РезультатЗапроса = Запрос1.Выполнить().Выбрать();
						Если РезультатЗапроса.Следующий() Тогда 
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТариф",РезультатЗапроса.Ссылка);
						КонецЕсли;
						Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);
						РезультатЗапроса = Запрос1.Выполнить().Выбрать();
						Если РезультатЗапроса.Следующий() Тогда 
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТарифИнстр",РезультатЗапроса.Ссылка);
						КонецЕсли;
						
						//О.Т. Аверсон 03.04.2016 № 981
						
						СведенияОВидеРасчета = ПроведениеРасчетов.ПолучитьСведенияОВидеРасчета(мСведенияОВидахРасчета, ДопНачислениеИзТаблицыЗначений.ВидРасчета);
						КодВычета = СведенияОВидеРасчета.КодДоходаНДФЛ.КодВычета;
						Если КодВычета = Неопределено или КодВычета.Наименование = "" Тогда
							
							НоваяСтрока.КодВычета = "";
						Иначе
							НоваяСтрока.КодВычета = КодВычета;
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
				
				//Островская Татьяна 27.11.2012 № ??
			КонецЕсли;
			
			//Аверсон-софт, Островская Татьяна 11.06.2012 № 15477
			ДопЗапрос = Новый Запрос;
			//Островская Татьяна 19.02.2013 № 16250
			ДопЗапрос.Текст = 
			"ВЫБРАТЬ
			|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			//+ СВЭЙ КДЯ 03.03.20 СВФР-005593
			|	ДополнительныеНачисленияРаботниковОрганизаций.Физлицо,
			//- СВЭЙ КДЯ 03.03.20 СВФР-005593
			|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
			|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
			|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
			|	ДополнительныеНачисленияРаботниковОрганизаций.Показатель1,
			|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации
			|ИЗ
			|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|ГДЕ
			|	ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодРегистрации И &ПериодРегистрации2
			|	И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
			//|	//И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации
			|	И ТИПЗНАЧЕНИЯ(ДополнительныеНачисленияРаботниковОрганизаций.Регистратор) <> &ДокНачисление";
			
			//Аверсон 12.11.2022 КВВ СВФР-009833 (
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ДопЗапрос.Текст = ДопЗапрос.Текст + "
				|	И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации)";
			КонецЕсли;
			ДопЗапрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
			//Аверсон 12.11.2022 КВВ СВФР-009833 )
			
			ДопЗапрос.УстановитьПараметр("ПериодРегистрации", НачалоПериодаЗаполнения);
			ДопЗапрос.УстановитьПараметр("ПериодРегистрации2", ОкончаниеПериодаЗаполнения);
			ДопЗапрос.УстановитьПараметр("Сотрудник", МассивСотрудники);
			ДопЗапрос.УстановитьПараметр("ДокНачисление", ТипЗнч(ЭтотОбъект.Ссылка)); 
			//О.Т. 01.07.2014
			//ДопЗапрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
			//если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			//	ДопЗапрос.Текст = СтрЗаменить(ДопЗапрос.Текст,"//И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации",
			//	"И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации");
			//иначе
			//	ДопЗапрос.Текст = СтрЗаменить(ДопЗапрос.Текст,"//И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации = &ПодразделениеОрганизации",
			//	"");				
			//КонецЕсли;
			//О.Т. 01.07.2014
			
			ДопРезультат = ДопЗапрос.Выполнить().Выбрать();
			
			//Аверсон ЕАЕ 04.06.2021 СВФР-007660
			//СтруктураПериоды = Новый Структура;
			//СтруктураПериоды.Вставить("ДатаНачала");
			//СтруктураПериоды.Вставить("ДатаОкончания");
			//Если ТЗНачисления.Количество() > 0 Тогда
			//	СтруктураПериоды.ДатаНачала = ТЗНачисления[0].ДатаНачала;
			//	СтруктураПериоды.ДатаОкончания = ТЗНачисления[0].ДатаОкончания;
			//КонецЕсли;
			
			КолонкиСтр = "Сотрудник,ПодразделениеОрганизации,ДатаНачала,ДатаОкончания";
			ТЗНачисленияПериоды = ТЗНачисления.Скопировать(, КолонкиСтр);
			ТЗНачисленияПериоды.Свернуть(КолонкиСтр);
			
			//ТЗДопНачисления = СформироватьТаблицуДополнитНачисления(ДопРезультат, ОкончаниеПериодаЗаполнения);
			ТЗДопНачисления = СформироватьТаблицуДополнитНачисления(ДопРезультат, ОкончаниеПериодаЗаполнения, ТЗНачисленияПериоды);
			//Аверсон СВФР-007660
			
			РаботникиДляРасчетаНДФЛ = Новый Соответствие;
			РаботникиДляРасчетаПенсионного = Новый Соответствие;
			
			//+ СВЭЙ КДЯ 03.03.20 СВФР-005593
			ДопРезультат.Сбросить();
			Пока ДопРезультат.Следующий() Цикл
				РаботникиДляРасчетаНДФЛ.Вставить(ДопРезультат.Физлицо, 0);
				РаботникиДляРасчетаПенсионного.Вставить(ДопРезультат.Физлицо, 0);
			КонецЦикла;
			//- СВЭЙ КДЯ 03.03.20 СВФР-005593
			
			//СтрокаПолейДополнительныхНачислений = "Сотрудник,ДатаНачала,ДатаОкончания,ДокументОснование,Размер,ВидРасчета,Результат";
			//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
			если не ТЧДоговора Тогда 
				
				//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
				Для Каждого НачислениеИзТаблицыЗначений Из ТЗДопНачисления Цикл
					//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
					если НачислениеИзТаблицыЗначений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом Тогда 
						//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
						
						НоваяСтрока	=	ДополнительныеНачисления.Добавить();
						НоваяСтрока.Авторасчет		= Истина;
						ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейДополнительныхНачислений); //Сотрудник,ВидРасчета,Размер,КодВычета,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
						НоваяСтрока.ДатаНачалаСобытия = НачислениеИзТаблицыЗначений.ДатаНачала;
						НоваяСтрока.ПериодРасчетаСреднегоЗаработкаНачало = НачислениеИзТаблицыЗначений.ДатаНачала;
						НоваяСтрока.ПериодРасчетаСреднегоЗаработкаОкончание = НачислениеИзТаблицыЗначений.ДатаОкончания;
						
						мСведенияОВидахРасчета = Новый Соответствие;
						мСведенияОВидахРасчета.Вставить("ОкладПоДням",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
						мСведенияОВидахРасчета.Вставить("ОкладПоЧасам",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
						мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасы",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
						мСведенияОВидахРасчета.Вставить("ДоплатаЗаРазъезднойХарактерРаботы",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Доплата за разъездной характер работы"));
						мСведенияОВидахРасчета.Вставить("Месячная",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Месячная"));
						//О.Т. Аверсон 03.04.2016 № 981
						Запрос1 = Новый Запрос;
						Запрос1.Текст = 
						"ВЫБРАТЬ
						|	ОсновныеНачисленияОрганизаций.Ссылка
						|ИЗ
						|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
						|ГДЕ
						|	ОсновныеНачисленияОрганизаций.СпособРасчета = &СпособРасчета";			
						Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);
						РезультатЗапроса = Запрос1.Выполнить().Выбрать();
						Если РезультатЗапроса.Следующий() Тогда 
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТариф",РезультатЗапроса.Ссылка);
						КонецЕсли;
						Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);
						РезультатЗапроса = Запрос1.Выполнить().Выбрать();
						Если РезультатЗапроса.Следующий() Тогда 
							мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТарифИнстр",РезультатЗапроса.Ссылка);
						КонецЕсли;
						//О.Т. Аверсон 03.04.2016 № 981
						
						СведенияОВидеРасчета = ПроведениеРасчетов.ПолучитьСведенияОВидеРасчета(мСведенияОВидахРасчета, НачислениеИзТаблицыЗначений.ВидРасчета);
						КодВычета = СведенияОВидеРасчета.КодДоходаНДФЛ.КодВычета;
						Если КодВычета = Неопределено или КодВычета.Наименование = "" Тогда
							
							НоваяСтрока.КодВычета = "";
						Иначе
							НоваяСтрока.КодВычета = КодВычета;
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 11.06.2012 № 15477
			
			Если НЕ Организация.ИНН = "100074549" //Аверсон 11.06.2021 КВВ СВФР-007690 (Элема)
				И НЕ РазбиватьПериодыПоНазначениюБригады Тогда //Аверсон 25.05.2022 КВВ СВФР-009084
				//+ СВЭЙ КДЯ 03.01.20 СВФР-005236
				ОбъединитьПересекающиесяДиапазоныНачислений( ТЗНачисления );
				//- СВЭЙ КДЯ 03.01.20 СВФР-005236
			КонецЕсли;
			
			Если  МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
				ИЛИ МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский тогда //Аверсон 10.02.2022 КВВ СВФР-008723
				//+ СВЭЙ КДЯ 03.03.20 СВФР-005593
				//РаботникиДляРасчетаНДФЛ = Новый Соответствие;
				//РаботникиДляРасчетаПенсионного = Новый Соответствие;
				//- СВЭЙ КДЯ 03.03.20 СВФР-005593
				СтрокаПолейДополнительныхНачислений = "Сотрудник,Физлицо,ВидРасчета,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,,КодВычета,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации";
				//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
				Если ТЧДоговора Тогда 
					//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
					Для Каждого НачислениеИзТаблицыЗначений Из ТЗНачисления Цикл
						
						НоваяСтрока	=	ДоговорыНаВыполнениеРабот.Добавить();
						ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейОсновныхНачислений); //Сотрудник,ВидРасчета,Размер,Показатель2,Показатель3,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
					КонецЦикла;
				КонецЕсли;
				//Аверсон-софт, Островская Татьяна 13.03.2012
			иначе
				
				// для заполнения табличной части НДФЛ
				//+ СВЭЙ КДЯ 03.03.20 СВФР-005593
				//РаботникиДляРасчетаНДФЛ = Новый Соответствие;
				//РаботникиДляРасчетаПенсионного = Новый Соответствие;
				//- СВЭЙ КДЯ 03.03.20 СВФР-005593
				
				ТипОсновныхНачислений = Тип("ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций");
				
				НаборЗаписейДляПроверки = РегистрыРасчета.ОсновныеНачисленияРаботниковОрганизаций.СоздатьНаборЗаписей();
				
				НаборЗаписейДляПроверки.Отбор.Регистратор.Значение = СcылкаОбъекта;
				
				СтрокаПолейОсновныхНачислений = "Сотрудник,Физлицо,ВидРасчета,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации,,ОтработаноЧасов,ОтработаноДней,ОплаченоДней,ОплаченоДнейЧасов";//О.Т. 22.04.2015 № 422 
				СтрокаПолейДополнительныхНачислений = "Сотрудник,Физлицо,ВидРасчета,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,,КодВычета,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации";
				//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
				если не ТЧДоговора Тогда
					//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
					Для Каждого НачислениеИзТаблицыЗначений Из ТЗНачисления Цикл
						
						РаботникиДляРасчетаНДФЛ.Вставить(НачислениеИзТаблицыЗначений.Физлицо, 0);
						РаботникиДляРасчетаПенсионного.Вставить(НачислениеИзТаблицыЗначений.Физлицо, 0);
						
						
						Если ВидОперации <> Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ 
							ИЛИ ВидОперации <> Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
							Если ТипЗнч(НачислениеИзТаблицыЗначений.ВидРасчета)	= ТипОсновныхНачислений Тогда
								
								//О.Т. Аверсон 14.08.2017 № 926
								Если НачислениеИзТаблицыЗначений.ДатаОкончания < НачислениеИзТаблицыЗначений.ДатаНачала  Тогда 
									Сообщить("Проверьте плановые начисления по сотруднику "+НачислениеИзТаблицыЗначений.Сотрудник.Наименование);
									Продолжить;
								КонецЕсли;
								//О.Т. Аверсон 14.08.2017 № 926
								
								НоваяСтрока	=	Начисления.Добавить();
								ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейОсновныхНачислений); //Сотрудник,ВидРасчета,Размер,Показатель2,Показатель3,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
								
								//заявка №1604 (база заявок Кристалла) Дмитрук О.Г.
								ВыборкаКорректировки = СформироватьЗапросПоКорректировкеПремии(НачислениеИзТаблицыЗначений.Сотрудник, НачислениеИзТаблицыЗначений.ВидРасчета, НачислениеИзТаблицыЗначений.ДатаНачала, НачислениеИзТаблицыЗначений.ДатаОкончания).Выбрать();
								Если ВыборкаКорректировки.Следующий() Тогда
									НоваяСтрока.Показатель1 = ВыборкаКорректировки.Процент;
								КонецЕсли;
								
								//заявка №1604
								
								НоваяСтрока.Авторасчет			= Истина;
								НоваяСтрока.ДатаНачалаСобытия	= ?(ЗначениеЗаполнено(НачислениеИзТаблицыЗначений.ДатаНачалаСобытия),НачислениеИзТаблицыЗначений.ДатаНачалаСобытия,НачислениеИзТаблицыЗначений.ДатаНачала);
								//Если НоваяСтрока.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеПоУходуЗаРебенкомДо1_5Лет Тогда
								//	НоваяСтрока.ПериодРасчетаСреднегоЗаработкаНачало = ДобавитьМесяц(НачалоМесяца(НоваяСтрока.ДатаНачалаСобытия), -12);	
								//	НоваяСтрока.ПериодРасчетаСреднегоЗаработкаОкончание = НачалоМесяца(НоваяСтрока.ДатаНачалаСобытия) - 1;	
								//КонецЕсли;
								
								Движение = НаборЗаписейДляПроверки.Добавить();
								
								// свойства
								Движение.ПериодРегистрации		= ПериодРегистрации;
								Движение.ВидРасчета				= НачислениеИзТаблицыЗначений.ВидРасчета;
								Движение.ПериодДействияНачало	= НачислениеИзТаблицыЗначений.ДатаНачала;
								Движение.ПериодДействияКонец	= НачислениеИзТаблицыЗначений.ДатаОкончания;
								
								// измерения
								Движение.Сотрудник				= НачислениеИзТаблицыЗначений.Сотрудник;
								Движение.Физлицо				= НачислениеИзТаблицыЗначений.Физлицо;
								Движение.Организация			= ГоловнаяОрганизация;
								
								// реквизиты поддержки графика
								Движение.ГрафикРаботы			= НачислениеИзТаблицыЗначений.ГрафикРаботы;
								Движение.ВидУчетаВремени		= ПроведениеРасчетов.ПолучитьВидУчетаВремени(НачислениеИзТаблицыЗначений.СпособРасчета, НачислениеИзТаблицыЗначений.ВидВремени, НачислениеИзТаблицыЗначений.СуммированныйУчетРабочегоВремени);
								Движение.ДатаНачалаСобытия		= НачислениеИзТаблицыЗначений.ДатаНачала;
								Движение.Авторасчет				= Истина;
								
							Иначе
								//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
								если НачислениеИзТаблицыЗначений.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом Тогда 
									//Аверсон-софт, Островская Татьяна 22.08.2012 № 15738
									
									НоваяСтрока	=	ДополнительныеНачисления.Добавить();
									НоваяСтрока.Авторасчет		= Истина;
									ЗаполнитьЗначенияСвойств(НоваяСтрока,НачислениеИзТаблицыЗначений,СтрокаПолейДополнительныхНачислений); //Сотрудник,ВидРасчета,Размер,КодВычета,ДатаНачала,ДатаОкончания,ПодразделениеОрганизации
									
									мСведенияОВидахРасчета = Новый Соответствие;
									мСведенияОВидахРасчета.Вставить("ОкладПоДням",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
									мСведенияОВидахРасчета.Вставить("ОкладПоЧасам",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
									мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасы",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы);
									мСведенияОВидахРасчета.Вставить("ДоплатаЗаРазъезднойХарактерРаботы",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Доплата за разъездной характер работы"));
									мСведенияОВидахРасчета.Вставить("Месячная",ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.НайтиПоНаименованию("Месячная"));
									//О.Т. Аверсон 03.04.2016 № 981
									Запрос1 = Новый Запрос;
									Запрос1.Текст = 
									"ВЫБРАТЬ
									|	ОсновныеНачисленияОрганизаций.Ссылка
									|ИЗ
									|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
									|ГДЕ
									|	ОсновныеНачисленияОрганизаций.СпособРасчета = &СпособРасчета";			
									Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТариф);
									РезультатЗапроса = Запрос1.Выполнить().Выбрать();
									Если РезультатЗапроса.Следующий() Тогда 
										мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТариф",РезультатЗапроса.Ссылка);
									КонецЕсли;
									Запрос1.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.ДоплатаЗаНочныеЧасыТарифИнстр);
									РезультатЗапроса = Запрос1.Выполнить().Выбрать();
									Если РезультатЗапроса.Следующий() Тогда 
										мСведенияОВидахРасчета.Вставить("ДоплатаЗаНочныеЧасыТарифИнстр",РезультатЗапроса.Ссылка);
									КонецЕсли;
									//О.Т. Аверсон 03.04.2016 № 981
									
									СведенияОВидеРасчета = ПроведениеРасчетов.ПолучитьСведенияОВидеРасчета(мСведенияОВидахРасчета, НачислениеИзТаблицыЗначений.ВидРасчета);
									КодВычета = СведенияОВидеРасчета.КодДоходаНДФЛ.КодВычета;
									Если КодВычета = Неопределено или КодВычета.Наименование = "" Тогда
										
										НоваяСтрока.КодВычета = "";
									Иначе
										НоваяСтрока.КодВычета = КодВычета;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							
							
						КонецЕсли;
						
					КонецЦикла;
				КонецЕсли;
				
				// выполним удаление строк табличной части, которые соответствуют полностью вытесняемым видам расчета
				// проверку выполним через фактический период действия
				Если ВидОперации <> Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ 
					ИЛИ ВидОперации <> Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
					
					НачатьТранзакцию();
					
					НаборЗаписейДляПроверки.Записать();
					
					ЗапросПроверки = Новый Запрос(
					"ВЫБРАТЬ
					|	ОсновныеНачисленияРаботниковОрганизации.НомерСтроки КАК НомерСтроки
					|ИЗ
					|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизации
					|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(Регистратор = &парамСсылка) КАК ОсновныеНачисленияРаботниковОрганизацииФактическийПериодДействия
					|		ПО ОсновныеНачисленияРаботниковОрганизации.НомерСтроки = ОсновныеНачисленияРаботниковОрганизацииФактическийПериодДействия.НомерСтроки
					|			И ОсновныеНачисленияРаботниковОрганизации.Регистратор = ОсновныеНачисленияРаботниковОрганизацииФактическийПериодДействия.Регистратор
					|ГДЕ
					|	ОсновныеНачисленияРаботниковОрганизации.Регистратор = &парамСсылка
					|	И ОсновныеНачисленияРаботниковОрганизацииФактическийПериодДействия.Регистратор ЕСТЬ NULL 
					|
					|УПОРЯДОЧИТЬ ПО
					|	НомерСтроки УБЫВ");
					
					ЗапросПроверки.УстановитьПараметр("парамСсылка", СcылкаОбъекта);
					СтрокиКУдалению = ЗапросПроверки.Выполнить().Выгрузить();
					// удалим проверочный набор записей
					НаборЗаписейДляПроверки.Очистить();
					НаборЗаписейДляПроверки.Записать();
					
					ЗафиксироватьТранзакцию();
					
					Для Каждого СтрокаТЗ Из СтрокиКУдалению Цикл
						Начисления.Удалить(СтрокаТЗ.НомерСтроки - 1);
					КонецЦикла;
					
				КонецЕсли;
				// конец удаления строк табличной части, которые соответствуют полностью вытесняемым видам расчета
				
				// работающие по договорам подряда
				ОсновнойТекстЗапроса =
				"ВЫБРАТЬ
				|	СписокНачислений.Сотрудник КАК Сотрудник,
				|	СписокНачислений.СотрудникФизлицо КАК Физлицо,
				|	СписокНачислений.СотрудникНаименование КАК СотрудникНаименование,
				|	СписокНачислений.ВидРасчета КАК ВидРасчета,
				|	СписокНачислений.ПериодНачисления КАК ДатаНачала,
				|	ЕСТЬNULL(СписокНачислений.ДатаОкончания, &парамКонец) КАК ДатаОкончания,
				|	СписокНачислений.ДокументОснование КАК ДокументОснование,
				|	СписокНачислений.Подходит,
				|	СписокНачислений.ВидРасчета.Наименование КАК ВидРасчетаНаименование,
				|	СписокНачислений.ДокументОснование.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
				|	СписокНачислений.ДокументОснование.КодВычета КАК КодВычета,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель1
				|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
				|	КОНЕЦ КАК Размер,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель1
				|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
				|	КОНЕЦ КАК Результат,
				|	ВЫБОР
				|		КОГДА СписокНачислений.Показатель1 ЕСТЬ NULL 
				|			ТОГДА 0
				|		КОГДА СписокНачислений.ДокументОснование.КодВычета <> ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код405)
				|			ТОГДА 0
				|		КОГДА СписокНачислений.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА СписокНачислений.Показатель1 * ЕСТЬNULL(СведенияОСкидках.НормативЗатрат, 0) / 100
				|		ИНАЧЕ СписокНачислений.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0) * ЕСТЬNULL(СведенияОСкидках.НормативЗатрат, 0) / 100
				|	КОНЕЦ КАК СуммаВычета
				|ИЗ
				|	(ВЫБРАТЬ
				|		Работники.Сотрудник КАК Сотрудник,
				|		Работники.Сотрудник.Физлицо КАК СотрудникФизлицо,
				|		Работники.Сотрудник.Наименование КАК СотрудникНаименование,
				|		НачисленияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
				|		НачисленияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
				|		Работники.Подходит КАК Подходит,
				|		НачисленияРаботниковОрганизации.Период КАК ПериодНачисления,
				|		МИНИМУМ(ДатыОкончанияНачисленияРаботниковОрганизации.ДатаОкончания) КАК ДатаОкончания,
				|		НачисленияРаботниковОрганизации.Показатель1 КАК Показатель1,
				|		НачисленияРаботниковОрганизации.Валюта1 КАК Валюта1
				|	ИЗ
				|		ВТДвиженияРаботников КАК Работники
				|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|				&парамНачало КАК Период,
				|				НачисленияРаботниковОрганизации.ВидРасчетаИзмерение КАК ВидРасчета,
				|				ВЫБОР
				|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА НачисленияРаботниковОрганизации.Показатель1Завершения
				|					ИНАЧЕ НачисленияРаботниковОрганизации.Показатель1
				|				КОНЕЦ КАК Показатель1,
				|				ВЫБОР
				|					КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|							И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА НачисленияРаботниковОрганизации.Валюта1Завершения
				|					ИНАЧЕ НачисленияРаботниковОрганизации.Валюта1
				|				КОНЕЦ КАК Валюта1,
				|				НачисленияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
				|				НачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник
				|			ИЗ
				|				РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
				|						&парамНачало,
				|						ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|							И Сотрудник В
				|								(ВЫБРАТЬ РАЗЛИЧНЫЕ
				|									ДвиженияРаботников.Сотрудник
				|								ИЗ
				|									ВТСписокРаботников КАК ДвиженияРаботников)) КАК НачисленияРаботниковОрганизации
				|			ГДЕ
				|				ВЫБОР
				|						КОГДА НачисленияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|								И НачисленияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|							ТОГДА НачисленияРаботниковОрганизации.ДействиеЗавершения
				|						ИНАЧЕ НачисленияРаботниковОрганизации.Действие
				|					КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|			
				|			ОБЪЕДИНИТЬ ВСЕ
				|			
				|			ВЫБРАТЬ
				|				НачисленияРаботниковОрганизации.Период,
				|				НачисленияРаботниковОрганизации.ВидРасчетаИзмерение,
				|				НачисленияРаботниковОрганизации.Показатель1,
				|				НачисленияРаботниковОрганизации.Валюта1,
				|				НачисленияРаботниковОрганизации.ДокументОснование,
				|				НачисленияРаботниковОрганизации.Сотрудник
				|			ИЗ
				|				РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
				|					ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
				|					ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|			ГДЕ
				|				НачисленияРаботниковОрганизации.Период > &парамНачало
				|				И НачисленияРаботниковОрганизации.Период <= &парамКонец
				|				И НачисленияРаботниковОрганизации.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|				И НачисленияРаботниковОрганизации.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|			
				|			ОБЪЕДИНИТЬ ВСЕ
				|			
				|			ВЫБРАТЬ
				|				НачисленияРаботниковОрганизации.ПериодЗавершения,
				|				НачисленияРаботниковОрганизации.ВидРасчетаИзмерение,
				|				НачисленияРаботниковОрганизации.Показатель1Завершения,
				|				НачисленияРаботниковОрганизации.Валюта1Завершения,
				|				НачисленияРаботниковОрганизации.ДокументОснование,
				|				НачисленияРаботниковОрганизации.Сотрудник
				|			ИЗ
				|				РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
				|					ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
				|					ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковПроверка
				|					ПО НачисленияРаботниковОрганизации.Сотрудник = НачисленияРаботниковПроверка.Сотрудник
				|						И НачисленияРаботниковОрганизации.ВидРасчетаИзмерение = НачисленияРаботниковПроверка.ВидРасчетаИзмерение
				|						И НачисленияРаботниковОрганизации.ДокументОснование = НачисленияРаботниковПроверка.ДокументОснование
				|						И (НачисленияРаботниковПроверка.Период > НачисленияРаботниковОрганизации.Период)
				|						И (НачисленияРаботниковПроверка.Период <= НачисленияРаботниковОрганизации.ПериодЗавершения)
				|			ГДЕ
				|				НачисленияРаботниковОрганизации.ПериодЗавершения МЕЖДУ &парамНачало И &парамКонец
				|				И НачисленияРаботниковОрганизации.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|				И НачисленияРаботниковОрганизации.ДействиеЗавершения <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				|				И НачисленияРаботниковПроверка.Сотрудник ЕСТЬ NULL ) КАК НачисленияРаботниковОрганизации
				|				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|					ДОБАВИТЬКДАТЕ(НачисленияРаботниковОрганизации.Период, ДЕНЬ, -1) КАК ДатаОкончания,
				|					НачисленияРаботниковОрганизации.ВидРасчетаИзмерение КАК ВидРасчетаИзмерение,
				|					НачисленияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
				|					НачисленияРаботниковОрганизации.Сотрудник КАК Сотрудник
				|				ИЗ
				|					РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
				|						ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
				|						ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|				ГДЕ
				|					НачисленияРаботниковОрганизации.Период >= &парамНачало
				|					И НачисленияРаботниковОрганизации.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|					И НачисленияРаботниковОрганизации.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать)
				|				
				|				ОБЪЕДИНИТЬ ВСЕ
				|				
				|				ВЫБРАТЬ
				|					ВЫБОР
				|						КОГДА ДОБАВИТЬКДАТЕ(НачисленияРаботниковОрганизации.ПериодЗавершения, ДЕНЬ, -1) > &парамКонец
				|							ТОГДА &парамКонец
				|						ИНАЧЕ ДОБАВИТЬКДАТЕ(НачисленияРаботниковОрганизации.ПериодЗавершения, ДЕНЬ, -1)
				|					КОНЕЦ,
				|					НачисленияРаботниковОрганизации.ВидРасчетаИзмерение,
				|					НачисленияРаботниковОрганизации.ДокументОснование,
				|					НачисленияРаботниковОрганизации.Сотрудник
				|				ИЗ
				|					РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковОрганизации
				|						ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ТаблицаДвиженийРаботников
				|						ПО НачисленияРаботниковОрганизации.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК НачисленияРаботниковПроверка
				|						ПО НачисленияРаботниковОрганизации.Сотрудник = НачисленияРаботниковПроверка.Сотрудник
				|							И НачисленияРаботниковОрганизации.ВидРасчетаИзмерение = НачисленияРаботниковПроверка.ВидРасчетаИзмерение
				|							И НачисленияРаботниковОрганизации.ДокументОснование = НачисленияРаботниковПроверка.ДокументОснование
				|							И (НачисленияРаботниковПроверка.Период > НачисленияРаботниковОрганизации.Период)
				|							И (НачисленияРаботниковПроверка.Период <= НачисленияРаботниковОрганизации.ПериодЗавершения)
				|				ГДЕ
				|					НачисленияРаботниковОрганизации.ПериодЗавершения >= &парамНачало
				|					И НачисленияРаботниковОрганизации.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|					И НачисленияРаботниковОрганизации.ДействиеЗавершения <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать)
				|					И НачисленияРаботниковПроверка.Сотрудник ЕСТЬ NULL ) КАК ДатыОкончанияНачисленияРаботниковОрганизации
				|				ПО НачисленияРаботниковОрганизации.Сотрудник = ДатыОкончанияНачисленияРаботниковОрганизации.Сотрудник
				|					И НачисленияРаботниковОрганизации.ВидРасчета = ДатыОкончанияНачисленияРаботниковОрганизации.ВидРасчетаИзмерение
				|					И НачисленияРаботниковОрганизации.ДокументОснование = ДатыОкончанияНачисленияРаботниковОрганизации.ДокументОснование
				|					И НачисленияРаботниковОрганизации.Период <= ДатыОкончанияНачисленияРаботниковОрганизации.ДатаОкончания
				|			ПО (Работники.Подходит)
				|				И Работники.Сотрудник = НачисленияРаботниковОрганизации.Сотрудник
				|	
				|	СГРУППИРОВАТЬ ПО
				|		Работники.Сотрудник,
				|		Работники.Сотрудник.Физлицо,
				|		Работники.Сотрудник.Наименование,
				|		Работники.Подходит,
				|		НачисленияРаботниковОрганизации.ДокументОснование,
				|		НачисленияРаботниковОрганизации.ВидРасчета,
				|		НачисленияРаботниковОрганизации.Период,
				|		НачисленияРаботниковОрганизации.Показатель1,
				|		НачисленияРаботниковОрганизации.Валюта1) КАК СписокНачислений
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты1
				|		ПО (Валюты1.Период = &парамДатаВалютногоУчета)
				|			И СписокНачислений.Валюта1 = Валюты1.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
				|			ОсновныеНачисления.Сотрудник КАК Сотрудник,
				|			ОсновныеНачисления.ДокументОснование КАК ДокументОснование
				|		ИЗ
				|			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
				|				ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ТаблицаДвиженийРаботников
				|				ПО ОсновныеНачисления.Сотрудник = ТаблицаДвиженийРаботников.Сотрудник
				|		ГДЕ
				|			ОсновныеНачисления.ПериодРегистрации = &парамПериодРегистрации
				|			И ОсновныеНачисления.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
				|			И ОсновныеНачисления.Регистратор <> &парамРегистратор
				|			И (НЕ ОсновныеНачисления.Сторно)
				|			И ОсновныеНачисления.ОбособленноеПодразделение = &парамОрганизация) КАК ОсновныеНачисления
				|		ПО СписокНачислений.Сотрудник = ОсновныеНачисления.Сотрудник
				|			И СписокНачислений.ДокументОснование = ОсновныеНачисления.ДокументОснование
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛВычетыПоДоходам.СрезПоследних(&парамНачало, ) КАК СведенияОСкидках
				|		ПО СписокНачислений.ВидРасчета.КодДоходаНДФЛ = СведенияОСкидках.КодДохода
				|ГДЕ
				|	СписокНачислений.Подходит
				|	И ВЫБОР
				|			КОГДА СписокНачислений.ДокументОснование ЕСТЬ NULL 
				|				ТОГДА ЛОЖЬ
				|			КОГДА СписокНачислений.ДокументОснование.Организация = &парамОрганизация
				|				ТОГДА ИСТИНА
				|			ИНАЧЕ ЛОЖЬ
				|		КОНЕЦ
				|	И ВЫБОР
				|			КОГДА &ЭтоПерерасчет
				|				ТОГДА ИСТИНА
				|			КОГДА ОсновныеНачисления.Сотрудник ЕСТЬ NULL 
				|				ТОГДА ИСТИНА
				|			ИНАЧЕ ЛОЖЬ
				|		КОНЕЦ
				|
				|УПОРЯДОЧИТЬ ПО
				|	СотрудникНаименование,
				|	ДокументОснование,
				|	ДатаНачала";
				
				Запрос.Текст = ОсновнойТекстЗапроса;
				РезультатЗапроса = Запрос.Выполнить();
				//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
				//Если ТЧДоговора Тогда 
				//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681	
				Если МассивСотрудники = Неопределено Тогда
					ДоговорыНаВыполнениеРабот.Загрузить(РезультатЗапроса.Выгрузить());
					Для каждого СтрокаТЧ Из ДоговорыНаВыполнениеРабот Цикл
						РаботникиДляРасчетаНДФЛ.Вставить(СтрокаТЧ.Физлицо, 0);
						РаботникиДляРасчетаПенсионного.Вставить(СтрокаТЧ.Физлицо, 0);
					КонецЦикла;
				Иначе
					Выборка = РезультатЗапроса.Выбрать();
					Пока Выборка.Следующий() Цикл
						НоваяСтрока = ДоговорыНаВыполнениеРабот.Добавить();
						ЗаполнитьЗначенияСвойств(НоваяСтрока,Выборка);
						РаботникиДляРасчетаНДФЛ.Вставить(НоваяСтрока.Физлицо, 0);
						РаботникиДляРасчетаПенсионного.Вставить(НоваяСтрока.Физлицо, 0);
					КонецЦикла;
				КонецЕсли;	
				//КонецЕсли;
				// Очистим необходимость перезаполнения по заполненным работникам
				Запрос.Текст =
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	СписокРаботников.Сотрудник
				|ИЗ
				|	ВТСписокРаботников КАК СписокРаботников";
				ПроведениеРасчетов.УдалитьСведенияОПерезаполненииДокумента(Ссылка,Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Сотрудник"));
			КонецЕсли;	
		КонецЕсли;
		ОбработкаПрерыванияПользователя();
		//Аверсон-софт, Островская Татьяна 13.03.2012
		Если (не МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
			И НЕ МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский) //Аверсон 10.02.2022 КВВ СВФР-008723 
			или ТЧДоговора тогда
			// АВТОЗАПОЛНЕНИЕ ТЧ "Удержания"
			//Аверсон-софт, Островская Татьяна 14.08.2012 № 15681
			сотр = "";
			СписокСотрудников = Новый СписокЗначений;
			Для Каждого стр из ДоговорыНаВыполнениеРабот Цикл 
				если стр.Сотрудник.Физлицо <> сотр Тогда 
					СписокСотрудников.Добавить(стр.Сотрудник.Физлицо);
					Сотр = стр.Сотрудник.Физлицо;
				КонецЕсли;
			КонецЦикла;
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
				ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетУдержаний Тогда
				
				ПоказателиУдержанийТекстЗапроса = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ЗначенияПоказателей.Физлицо КАК Физлицо,
				|	ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка КАК ВидРасчета,
				|	ВЫБОР
				|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 1
				|			ТОГДА ВЫБОР
				|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
				|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
				|						ТОГДА ЗначенияПоказателей.Значение
				|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
				|				КОНЕЦ
				|	КОНЕЦ КАК Показатель1,
				|	ВЫБОР
				|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 2
				|			ТОГДА ВЫБОР
				|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
				|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
				|						ТОГДА ЗначенияПоказателей.Значение
				|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
				|				КОНЕЦ
				|	КОНЕЦ КАК Показатель2,
				|	ВЫБОР
				|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 3
				|			ТОГДА ВЫБОР
				|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
				|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
				|						ТОГДА ЗначенияПоказателей.Значение
				|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
				|				КОНЕЦ
				|	КОНЕЦ КАК Показатель3,
				|	ВЫБОР
				|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 4
				|			ТОГДА ВЫБОР
				|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
				|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
				|						ТОГДА ЗначенияПоказателей.Значение
				|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
				|				КОНЕЦ
				|	КОНЕЦ КАК Показатель4,
				|	ВЫБОР
				|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 5
				|			ТОГДА ВЫБОР
				|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
				|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
				|						ТОГДА ЗначенияПоказателей.Значение
				|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
				|				КОНЕЦ
				|	КОНЕЦ КАК Показатель5,
				|	ВЫБОР
				|		КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.НомерСтроки = 6
				|			ТОГДА ВЫБОР
				|					КОГДА ПланВидовРасчетаУдержанияОрганизацийПоказатели.Ссылка.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|							ИЛИ ЗначенияПоказателей.Валюта = &парамВалютаРегламентУчета
				|							ИЛИ ЗначенияПоказателей.Валюта = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
				|						ТОГДА ЗначенияПоказателей.Значение
				|					ИНАЧЕ ЗначенияПоказателей.Значение * ЕСТЬNULL(ВалютыПоказателя.Курс / ВалютыПоказателя.Кратность, 0)
				|				КОНЕЦ
				|	КОНЕЦ КАК Показатель6
				|ПОМЕСТИТЬ ВТПоказателиУдержаний
				|ИЗ
				|	(ВЫБРАТЬ
				|		Работники.Сотрудник.Физлицо КАК Физлицо,
				|		ЗначенияПоказателейСхемМотивации.Показатель КАК Показатель,
				|		ЗначенияПоказателейСхемМотивации.Валюта КАК Валюта,
				|		ЗначенияПоказателейСхемМотивации.Значение КАК Значение
				|	ИЗ
				|		ВТДвиженияРаботников КАК Работники
				
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияПоказателей КАК ЗначенияПоказателейСхемМотивации
				|		ПО  
				|			(ВЫБОР
				|					КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
				|							ИЛИ ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя ЕСТЬ NULL 
				|						ТОГДА Работники.Сотрудник = ЗначенияПоказателейСхемМотивации.Сотрудник
				|					КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
				|						ТОГДА Работники.ПодразделениеОрганизации = ЗначенияПоказателейСхемМотивации.ПодразделениеОрганизации
				|					ИНАЧЕ ИСТИНА		
				|				КОНЕЦ)) КАК ЗначенияПоказателей
				
				
				|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.УдержанияОрганизаций.Показатели КАК ПланВидовРасчетаУдержанияОрганизацийПоказатели
				|		ПО ЗначенияПоказателей.Показатель = ПланВидовРасчетаУдержанияОрганизацийПоказатели.Показатель
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК ВалютыПоказателя
				|		ПО (ВалютыПоказателя.Период = &парамДатаВалютногоУчета)
				|			И ЗначенияПоказателей.Валюта = ВалютыПоказателя.Валюта
				|
				|ИНДЕКСИРОВАТЬ ПО
				|	ВидРасчета,
				|	Физлицо";		  				
				
				
				Запрос.Текст = ПоказателиУдержанийТекстЗапроса;
				Запрос.Выполнить();	
				//Островская Татьяна 04.06.2014 № 17395
				ТекстЗапросаУдержаний = 
				"ВЫБРАТЬ
				|	УдержанияРаботниковОрганизации.Физлицо КАК Физлицо,";
				//О.Т. Аверсон 31.05.2017 № 685
				Если не НеРазбиватьУдержанияПоПериодам Тогда 
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|	Выбор когда ЕстьNULL(УдержанияРаботниковОрганизации.ПериодНачала,1) = 1 тогда УдержанияРаботниковОрганизации.Период иначе УдержанияРаботниковОрганизации.ПериодНачала конец КАК Период,"; //О.Т. Аверсон 15.08.2017 № 912
				иначе
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|	УдержанияРаботниковОрганизации.Период КАК Период,";
				КонецЕсли;
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//О.Т. Аверсон 31.05.2017 № 685
				
				|	УдержанияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
				|	УдержанияРаботниковОрганизации.Действие КАК Действие,
				|	УдержанияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
				|	УдержанияРаботниковОрганизации.Валюта1 КАК Валюта,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|			ТОГДА 1
				|		ИНАЧЕ Валюты1.Курс
				|	КОНЕЦ КАК КурсВалюты,
				|	ВЫБОР
				|		КОГДА Показатели.Показатель1 ЕСТЬ НЕ NULL 
				|					И Показатели.Показатель1 <> 0
				|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|			ТОГДА Показатели.Показатель1
				|		КОГДА УдержанияРаботниковОрганизации.Показатель1 ЕСТЬ NULL 
				|				ИЛИ УдержанияРаботниковОрганизации.Показатель1 = 0
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 1
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		ИНАЧЕ ВЫБОР
				|				КОГДА УдержанияРаботниковОрганизации.Показатель1 ЕСТЬ NULL 
				|					ТОГДА 0
				|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ИЛИ УдержанияРаботниковОрганизации.Валюта1 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|					ТОГДА УдержанияРаботниковОрганизации.Показатель1
				|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель1 * ЕСТЬNULL(Валюты1.Курс / Валюты1.Кратность, 0)
				|			КОНЕЦ
				|	КОНЕЦ КАК Показатель1,
				|	ВЫБОР
				|		КОГДА Показатели.Показатель2 ЕСТЬ НЕ NULL 
				|					И Показатели.Показатель2 <> 0
				|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|			ТОГДА Показатели.Показатель2
				|		КОГДА УдержанияРаботниковОрганизации.Показатель2 ЕСТЬ NULL 
				|				ИЛИ УдержанияРаботниковОрганизации.Показатель2 = 0
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 2
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		ИНАЧЕ ВЫБОР
				|				КОГДА УдержанияРаботниковОрганизации.Показатель2 ЕСТЬ NULL 
				|					ТОГДА 0
				|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ИЛИ УдержанияРаботниковОрганизации.Валюта2 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|					ТОГДА УдержанияРаботниковОрганизации.Показатель2
				|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель2 * ЕСТЬNULL(Валюты2.Курс / Валюты2.Кратность, 0)
				|			КОНЕЦ
				|	КОНЕЦ КАК Показатель2,
				|	ВЫБОР
				|		КОГДА Показатели.Показатель3 ЕСТЬ НЕ NULL 
				|					И Показатели.Показатель3 <> 0
				|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|			ТОГДА Показатели.Показатель3
				|		КОГДА УдержанияРаботниковОрганизации.Показатель3 ЕСТЬ NULL 
				|				ИЛИ УдержанияРаботниковОрганизации.Показатель3 = 0
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 3
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		ИНАЧЕ ВЫБОР
				|				КОГДА УдержанияРаботниковОрганизации.Показатель3 ЕСТЬ NULL 
				|					ТОГДА 0
				|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ИЛИ УдержанияРаботниковОрганизации.Валюта3 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|					ТОГДА УдержанияРаботниковОрганизации.Показатель3
				|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель3 * ЕСТЬNULL(Валюты3.Курс / Валюты3.Кратность, 0)
				|			КОНЕЦ
				|	КОНЕЦ КАК Показатель3,
				|	ВЫБОР
				|		КОГДА Показатели.Показатель4 ЕСТЬ НЕ NULL 
				|					И Показатели.Показатель4 <> 0
				|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|			ТОГДА Показатели.Показатель4
				|		КОГДА УдержанияРаботниковОрганизации.Показатель4 ЕСТЬ NULL 
				|				ИЛИ УдержанияРаботниковОрганизации.Показатель4 = 0
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 4
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		ИНАЧЕ ВЫБОР
				|				КОГДА УдержанияРаботниковОрганизации.Показатель4 ЕСТЬ NULL 
				|					ТОГДА 0
				|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ИЛИ УдержанияРаботниковОрганизации.Валюта4 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|					ТОГДА УдержанияРаботниковОрганизации.Показатель4
				|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель4 * ЕСТЬNULL(Валюты4.Курс / Валюты4.Кратность, 0)
				|			КОНЕЦ
				|	КОНЕЦ КАК Показатель4,
				|	ВЫБОР
				|		КОГДА Показатели.Показатель5 ЕСТЬ НЕ NULL 
				|					И Показатели.Показатель5 <> 0
				|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|			ТОГДА Показатели.Показатель5
				|		КОГДА УдержанияРаботниковОрганизации.Показатель5 ЕСТЬ NULL 
				|				ИЛИ УдержанияРаботниковОрганизации.Показатель5 = 0
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 5
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		ИНАЧЕ ВЫБОР
				|				КОГДА УдержанияРаботниковОрганизации.Показатель5 ЕСТЬ NULL 
				|					ТОГДА 0
				|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ИЛИ УдержанияРаботниковОрганизации.Валюта5 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|					ТОГДА УдержанияРаботниковОрганизации.Показатель5
				|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель5 * ЕСТЬNULL(Валюты5.Курс / Валюты5.Кратность, 0)
				|			КОНЕЦ
				|	КОНЕЦ КАК Показатель5,
				|	ВЫБОР
				|		КОГДА Показатели.Показатель6 ЕСТЬ НЕ NULL 
				|					И Показатели.Показатель6 <> 0
				|				ИЛИ ЗначенияВводимыхКадровыхПоказателей.ПоказательВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.ВиденНоНеРедактируетсяПриРасчете)
				|			ТОГДА Показатели.Показатель6
				|		КОГДА УдержанияРаботниковОрганизации.Показатель6 ЕСТЬ NULL 
				|				ИЛИ УдержанияРаботниковОрганизации.Показатель6 = 0
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель <> ЗНАЧЕНИЕ(Справочник.ПоказателиСхемМотивации.ПустаяСсылка)
				|					И ЗначенияВводимыхКадровыхПоказателей.Показатель ЕСТЬ НЕ NULL 
				|					И ЗначенияВводимыхКадровыхПоказателей.НомерСтроки = 6
				|			ТОГДА ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя
				|		ИНАЧЕ ВЫБОР
				|				КОГДА УдержанияРаботниковОрганизации.Показатель6 ЕСТЬ NULL 
				|					ТОГДА 0
				|				КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособРасчета В (&парамМассивСпособовРасчетовБезВалюты)
				|						ИЛИ УдержанияРаботниковОрганизации.Валюта6 В (&парамВалютаРегламентУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка))
				|					ТОГДА УдержанияРаботниковОрганизации.Показатель6
				|				ИНАЧЕ УдержанияРаботниковОрганизации.Показатель6 * ЕСТЬNULL(Валюты6.Курс / Валюты6.Кратность, 0)
				|			КОНЕЦ
				|	КОНЕЦ КАК Показатель6,
				|	УдержанияРаботниковОрганизации.Физлицо.Наименование КАК ФизлицоНаименование,
				|	УдержанияРаботниковОрганизации.Сотрудник
				|ИЗ
				|	(ВЫБРАТЬ
				|	&парамНачало КАК Период,
				|	УдержанияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.ДействиеЗавершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Действие
				|	КОНЕЦ КАК Действие,
				|	УдержанияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Показатель1Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель1
				|	КОНЕЦ КАК Показатель1,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Показатель2Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель2
				|	КОНЕЦ КАК Показатель2,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Показатель3Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель3
				|	КОНЕЦ КАК Показатель3,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Показатель4Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель4
				|	КОНЕЦ КАК Показатель4,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Показатель5Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель5
				|	КОНЕЦ КАК Показатель5,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Показатель6Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Показатель6
				|	КОНЕЦ КАК Показатель6,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Валюта1Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта1
				|	КОНЕЦ КАК Валюта1,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Валюта2Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта2
				|	КОНЕЦ КАК Валюта2,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Валюта3Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта3
				|	КОНЕЦ КАК Валюта3,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Валюта4Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта4
				|	КОНЕЦ КАК Валюта4,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Валюта5Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта5
				|	КОНЕЦ КАК Валюта5,
				|	ВЫБОР
				|		КОГДА УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамНачало
				|				И УдержанияРаботниковОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|			ТОГДА УдержанияРаботниковОрганизации.Валюта6Завершения
				|		ИНАЧЕ УдержанияРаботниковОрганизации.Валюта6
				|	КОНЕЦ КАК Валюта6,
				|	УдержанияРаботниковОрганизации.ФизЛицо КАК Физлицо,";
				//О.Т. Аверсон 31.05.2017 № 685
				Если не НеРазбиватьУдержанияПоПериодам Тогда 
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|	КадровыеПоказатели.Сотрудник КАК Сотрудник,
					|	КадровыеПоказатели.Период КАК ПериодНачала";
				иначе
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|	ВТСписокРаботников.Сотрудник КАК Сотрудник";
				КонецЕсли;
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//О.Т. Аверсон 31.05.2017 № 685
				|ИЗ
				|	РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций.СрезПоследних(
				|			&парамНачало,
				|			Организация = &парамГоловнаяОрганизация
				|				И ФизЛицо В
				|					(ВЫБРАТЬ
				|						СписокРаботников.ФизЛицо
				|					ИЗ
				|						ВТСписокРаботников КАК СписокРаботников)) КАК УдержанияРаботниковОрганизации";
				//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ВТСписокРаботников
				//|		ПО УдержанияРаботниковОрганизации.ФизЛицо = ВТСписокРаботников.ФизЛицо";
				
				//О.Т. Аверсон 31.05.2017 № 685
				Если не НеРазбиватьУдержанияПоПериодам Тогда 
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ    // Внутренее убрала и поставила Левое № 912
					|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо КАК ФизЛицо,
					|			СписокРаботников.Сотрудник,
					|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период
					|		ИЗ
					//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					//|			ВТСписокРаботников КАК СписокРаботников
					//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					|			ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
					//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
					|			ПО СписокРаботников.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
					
					|		ГДЕ
					|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
					|			И НАЧАЛОПЕРИОДА(ЗначенияВводимыхКадровыхПоказателей.Период, МЕСЯЦ) = &парамПериодРегистрации
					|		
					|		СГРУППИРОВАТЬ ПО
					|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо,
					|			СписокРаботников.Сотрудник,
					|			ЗначенияВводимыхКадровыхПоказателей.Период) КАК КадровыеПоказатели
					//|		ПО КонецПериода(УдержанияРаботниковОрганизации.Период,месяц) = КонецПериода(КадровыеПоказатели.Период,Месяц)
					|		ПО УдержанияРаботниковОрганизации.ФизЛицо = КадровыеПоказатели.ФизЛицо";
				КонецЕсли;
				Если не НеРазбиватьУдержанияПоПериодам Тогда
				иначе
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК ВТСписокРаботников
					//(конец)  закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТБезДублейФизЛицСписокРаботников КАК ВТСписокРаботников
					//(конец)  добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					|		ПО УдержанияРаботниковОрганизации.ФизЛицо = ВТСписокРаботников.Физлицо
					|";
				КонецЕсли;
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//О.Т. Аверсон 31.05.2017 № 685
				
				//Аверсон ЕАЕ 18.10.2021 СВФР-008241
				//|ГДЕ
				//|	УдержанияРаботниковОрганизации.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
				//Аверсон СВФР-008241
				
				|ОБЪЕДИНИТЬ ВСЕ
				
				|ВЫБРАТЬ
				|	УдержанияРаботниковОрганизации.Период,
				|	УдержанияРаботниковОрганизации.ВидРасчета,
				|	УдержанияРаботниковОрганизации.Действие,
				|	УдержанияРаботниковОрганизации.ДокументОснование,
				|	УдержанияРаботниковОрганизации.Показатель1,
				|	УдержанияРаботниковОрганизации.Показатель2,
				|	УдержанияРаботниковОрганизации.Показатель3,
				|	УдержанияРаботниковОрганизации.Показатель4,
				|	УдержанияРаботниковОрганизации.Показатель5,
				|	УдержанияРаботниковОрганизации.Показатель6,
				|	УдержанияРаботниковОрганизации.Валюта1,
				|	УдержанияРаботниковОрганизации.Валюта2,
				|	УдержанияРаботниковОрганизации.Валюта3,
				|	УдержанияРаботниковОрганизации.Валюта4,
				|	УдержанияРаботниковОрганизации.Валюта5,
				|	УдержанияРаботниковОрганизации.Валюта6,
				|	УдержанияРаботниковОрганизации.ФизЛицо,";
				//О.Т. Аверсон 31.05.2017 № 685
				Если не НеРазбиватьУдержанияПоПериодам Тогда 
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|	КадровыеПоказатели.Сотрудник,
					|	УдержанияРаботниковОрганизации.Период";
				иначе
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|	СписокРаботников.Сотрудник";
				КонецЕсли;
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//О.Т. Аверсон 31.05.2017 № 685
				|ИЗ
				|	РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации";
				//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК СписокРаботников
				//|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокРаботников.Физлицо";
				//О.Т. Аверсон 31.05.2017 № 685
				Если не НеРазбиватьУдержанияПоПериодам Тогда 
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ   // Внутренее убрала и поставила Левое № 912
					|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо КАК ФизЛицо,
					|			СписокРаботников.Сотрудник,
					|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период
					|		ИЗ
					//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					//|			ВТСписокРаботников КАК СписокРаботников
					//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					|			ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
					//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
					|			ПО СписокРаботников.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
					
					|		ГДЕ
					|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
					|			И ЗначенияВводимыхКадровыхПоказателей.Период МЕЖДУ &ПарамНачало И &ПарамКонец
					|		
					|		СГРУППИРОВАТЬ ПО
					|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо,
					|			СписокРаботников.Сотрудник,
					|			ЗначенияВводимыхКадровыхПоказателей.Период) КАК КадровыеПоказатели
					|		ПО КонецПериода(УдержанияРаботниковОрганизации.Период,месяц) = КонецПериода(КадровыеПоказатели.Период,Месяц) //О.Т. Аверсон 20.01.2017 конец период доб";
				КонецЕсли;
				Если не НеРазбиватьУдержанияПоПериодам Тогда
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|		и  УдержанияРаботниковОрганизации.ФизЛицо = КадровыеПоказатели.Физлицо";
				иначе
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК СписокРаботников
					//(конец)  закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
					//(конец)  добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокРаботников.Физлицо";
				КонецЕсли;
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//О.Т. Аверсон 31.05.2017 № 685
				
				|ГДЕ
				|	УдержанияРаботниковОрганизации.Период > &парамНачало
				|	И УдержанияРаботниковОрганизации.Период <= &парамКонец
				|	И УдержанияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
				
				|ОБЪЕДИНИТЬ ВСЕ
				
				|ВЫБРАТЬ
				|	УдержанияРаботниковОрганизации.ПериодЗавершения,
				|	УдержанияРаботниковОрганизации.ВидРасчета,
				|	УдержанияРаботниковОрганизации.ДействиеЗавершения,
				|	УдержанияРаботниковОрганизации.ДокументОснование,
				|	УдержанияРаботниковОрганизации.Показатель1Завершения,
				|	УдержанияРаботниковОрганизации.Показатель2Завершения,
				|	УдержанияРаботниковОрганизации.Показатель3Завершения,
				|	УдержанияРаботниковОрганизации.Показатель4Завершения,
				|	УдержанияРаботниковОрганизации.Показатель5Завершения,
				|	УдержанияРаботниковОрганизации.Показатель6Завершения,
				|	УдержанияРаботниковОрганизации.Валюта1Завершения,
				|	УдержанияРаботниковОрганизации.Валюта2Завершения,
				|	УдержанияРаботниковОрганизации.Валюта3Завершения,
				|	УдержанияРаботниковОрганизации.Валюта4Завершения,
				|	УдержанияРаботниковОрганизации.Валюта5Завершения,
				|	УдержанияРаботниковОрганизации.Валюта6Завершения,
				|	УдержанияРаботниковОрганизации.ФизЛицо,";
				//О.Т. Аверсон 31.05.2017 № 685
				Если не НеРазбиватьУдержанияПоПериодам Тогда 
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|	КадровыеПоказатели.Сотрудник,
					|	КадровыеПоказатели.Период";
				иначе
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|	СписокРаботников.Сотрудник";
				КонецЕсли;
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				//О.Т. Аверсон 31.05.2017 № 685
				|ИЗ
				|	РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
				//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК СписокРаботников
				//|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокРаботников.Физлицо
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизацииПроверка
				|		ПО (УдержанияРаботниковОрганизацииПроверка.Организация = УдержанияРаботниковОрганизации.Организация)
				|			И (УдержанияРаботниковОрганизацииПроверка.ФизЛицо = УдержанияРаботниковОрганизации.ФизЛицо)
				|			И (УдержанияРаботниковОрганизацииПроверка.ВидРасчета = УдержанияРаботниковОрганизации.ВидРасчета)
				|			И (УдержанияРаботниковОрганизацииПроверка.ДокументОснование = УдержанияРаботниковОрганизации.ДокументОснование)
				|			И (УдержанияРаботниковОрганизацииПроверка.Период > УдержанияРаботниковОрганизации.Период)
				|			И (УдержанияРаботниковОрганизацииПроверка.Период <= УдержанияРаботниковОрганизации.ПериодЗавершения)
				//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				|";
				Если не НеРазбиватьУдержанияПоПериодам Тогда
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
					|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо КАК ФизЛицо,
					|			СписокРаботников.Сотрудник,
					|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период
					|		ИЗ
					//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					//|			ВТСписокРаботников КАК СписокРаботников
					//(конец) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					|			ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
					//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
					|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
					|			ПО СписокРаботников.Сотрудник = ЗначенияВводимыхКадровыхПоказателей.Сотрудник
					
					|		ГДЕ
					|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
					|			И ЗначенияВводимыхКадровыхПоказателей.Период МЕЖДУ &ПарамНачало И &ПарамКонец
					|		
					|		СГРУППИРОВАТЬ ПО
					|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо,
					|			СписокРаботников.Сотрудник,
					|			ЗначенияВводимыхКадровыхПоказателей.Период) КАК КадровыеПоказатели
					|		ПО КонецПериода(УдержанияРаботниковОрганизации.ПериодЗавершения,месяц) = КонецПериода(КадровыеПоказатели.Период,Месяц)";  //О.Т. Аверсон 20.01.2017 конец период доб
					//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				КонецЕсли; // не НеРазбиватьУдержанияПоПериодам
				//(конец) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931, Аверсон-Софт
				
				Если не НеРазбиватьУдержанияПоПериодам Тогда
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					|		и  УдержанияРаботниковОрганизации.ФизЛицо = КадровыеПоказатели.Физлицо";
				иначе
					ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
					//(начало) закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокРаботников КАК СписокРаботников
					//(конец)  закомментировано Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					//(начало) добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТБезДублейФизЛицСписокРаботников КАК СписокРаботников
					//(конец)  добавлено Кухарчуком Д.Я. 13.12.18, Задача СВФР-002931
					|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокРаботников.Физлицо";
				КонецЕсли;
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|ГДЕ
				|	УдержанияРаботниковОрганизации.ПериодЗавершения >= &парамНачало
				|	И УдержанияРаботниковОрганизации.ПериодЗавершения <= &парамКонец
				|	И УдержанияРаботниковОрганизации.Организация = &парамГоловнаяОрганизация
				|	И УдержанияРаботниковОрганизацииПроверка.ФизЛицо ЕСТЬ NULL ) КАК УдержанияРаботниковОрганизации
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты1
				|		ПО (Валюты1.Период = &парамДатаВалютногоУчета)
				|			И УдержанияРаботниковОрганизации.Валюта1 = Валюты1.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты2
				|		ПО (Валюты2.Период = &парамДатаВалютногоУчета)
				|			И УдержанияРаботниковОрганизации.Валюта2 = Валюты2.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты3
				|		ПО (Валюты3.Период = &парамДатаВалютногоУчета)
				|			И УдержанияРаботниковОрганизации.Валюта3 = Валюты3.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты4
				|		ПО (Валюты4.Период = &парамДатаВалютногоУчета)
				|			И УдержанияРаботниковОрганизации.Валюта4 = Валюты4.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты5
				|		ПО (Валюты5.Период = &парамДатаВалютногоУчета)
				|			И УдержанияРаботниковОрганизации.Валюта5 = Валюты5.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК Валюты6
				|		ПО (Валюты6.Период = &парамДатаВалютногоУчета)
				|			И УдержанияРаботниковОрганизации.Валюта6 = Валюты6.Валюта
				|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПоказателиУдержаний КАК Показатели
				|		ПО УдержанияРаботниковОрганизации.ВидРасчета = Показатели.ВидРасчета
				|			И УдержанияРаботниковОрганизации.Физлицо = Показатели.Физлицо
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
				|			НеВводимыеПоказатели.Ссылка КАК Ссылка,
				|			НеВводимыеПоказатели.НомерСтроки КАК НомерСтроки,
				|			НеВводимыеПоказатели.Показатель КАК Показатель,
				|			НеВводимыеПоказатели.Показатель.ВозможностьИзменения КАК ПоказательВозможностьИзменения,
				|			СУММА(ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя) КАК ЗначениеПоказателя,
				|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо КАК ФизЛицо,
				|			ЗначенияВводимыхКадровыхПоказателей.Период КАК Период,
				|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники КАК ПериодРаботники
				|		ИЗ
				|			ВТНеЗапрашиваемыеПриКадровыхПеремещениях КАК НеВводимыеПоказатели
				|				ЛЕВОЕ СОЕДИНЕНИЕ ВТЗначенияВводимыхКадровыхПоказателей КАК ЗначенияВводимыхКадровыхПоказателей
				|				ПО НеВводимыеПоказатели.Показатель = ЗначенияВводимыхКадровыхПоказателей.Показатель
				|		ГДЕ
				|			ЗначенияВводимыхКадровыхПоказателей.ЗначениеПоказателя <> 0
				|		
				|		СГРУППИРОВАТЬ ПО
				|			НеВводимыеПоказатели.Ссылка,
				|			НеВводимыеПоказатели.НомерСтроки,
				|			НеВводимыеПоказатели.Показатель,
				|			НеВводимыеПоказатели.Показатель.ВозможностьИзменения,
				|			ЗначенияВводимыхКадровыхПоказателей.Сотрудник.ФизЛицо,
				|			ЗначенияВводимыхКадровыхПоказателей.Период,
				|			ЗначенияВводимыхКадровыхПоказателей.ПериодРаботники) КАК ЗначенияВводимыхКадровыхПоказателей
				|		ПО УдержанияРаботниковОрганизации.Физлицо = ЗначенияВводимыхКадровыхПоказателей.ФизЛицо
				|			И (КОНЕЦПЕРИОДА(УдержанияРаботниковОрганизации.Период, МЕСЯЦ) = КОНЕЦПЕРИОДА(ЗначенияВводимыхКадровыхПоказателей.Период, МЕСЯЦ))
				|			И УдержанияРаботниковОрганизации.ВидРасчета = ЗначенияВводимыхКадровыхПоказателей.Ссылка";
				//Островская Татьяна 04.06.2014 № 17395
				// если не перерасчет - проверяем проведенность в расчетном периоде
				Если Не ЭтоПерерасчет Тогда
					если ТЧДоговора тогда
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
						|			УдержанияРаботников.ФизЛицо КАК ФизЛицо,
						|			УдержанияРаботников.ВидРасчета КАК ВидРасчета,";
						//О.Т. Аверсон 31.05.2017 № 685
						Если не НеРазбиватьУдержанияПоПериодам Тогда 
							ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
							|			УдержанияРаботников.ДокументОснование КАК ДокументОснование,
							|			УдержанияРаботников.БазовыйПериодНачало";
						иначе
							ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
							|			УдержанияРаботников.ДокументОснование КАК ДокументОснование";
						КонецЕсли;
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						//О.Т. Аверсон 31.05.2017 № 685
						|		ИЗ
						|			РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботников
						|		ГДЕ
						|			УдержанияРаботников.ПериодРегистрации = &парамПериодРегистрации
						|			И УдержанияРаботников.ФизЛицо В
						|					(ВЫБРАТЬ
						|						СписокРаботников.Физлицо
						|					ИЗ
						|						ВТСписокРаботников КАК СписокРаботников)
						|			И УдержанияРаботников.ОбособленноеПодразделение = &парамОрганизация
						|			И УдержанияРаботников.Регистратор <> &парамРегистратор
						|			И НАЧАЛОПЕРИОДА(УдержанияРаботников.БазовыйПериодНачало, МЕСЯЦ) = &парамПериодРегистрации
						//(начало) закомментировано Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
						//|			И УдержанияРаботников.ВидРасчета.СпособРасчета <> ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.Процентом)
						//(конец) закомментировано Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
						//(начало) добавлено Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
						|			И НЕ УдержанияРаботников.ВидРасчета.СпособРасчета В ( ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.Процентом),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПределаСНДФЛ),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПочтовыйСбор),  //Аверсон 07.07.2022 КВВ СВФР-008761
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела) )
						//(конец) добавлено Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
						|								) КАК ЗарегистрированныеУдержанияРаботников //О.Т. Аверсон 21.06.2017 № 754
						|		ПО УдержанияРаботниковОрганизации.Физлицо = ЗарегистрированныеУдержанияРаботников.ФизЛицо
						|			И УдержанияРаботниковОрганизации.ВидРасчета = ЗарегистрированныеУдержанияРаботников.ВидРасчета
						|			И (ЗарегистрированныеУдержанияРаботников.ДокументОснование = ВЫБОР
						|				КОГДА УдержанияРаботниковОрганизации.ДокументОснование ССЫЛКА Документ.ИсполнительныйЛист
						|					ТОГДА УдержанияРаботниковОрганизации.ДокументОснование
						|				ИНАЧЕ ЗНАЧЕНИЕ(Документ.ИсполнительныйЛист.ПустаяСсылка)
						|			КОНЕЦ)";
						//О.Т. Аверсон 31.05.2017 № 685
						Если не НеРазбиватьУдержанияПоПериодам Тогда 
							ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
							|			И УдержанияРаботниковОрганизации.ПериодНачала = ЗарегистрированныеУдержанияРаботников.БазовыйПериодНачало"; 						
						КонецЕсли;
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						//О.Т. Аверсон 31.05.2017 № 685
						
						|ГДЕ
						|	ЗарегистрированныеУдержанияРаботников.ФизЛицо ЕСТЬ NULL 
						|	И УдержанияРаботниковОрганизации.Физлицо В(&ФизлицоСписок)";
					иначе
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
						|			УдержанияРаботников.ФизЛицо КАК ФизЛицо,
						|			УдержанияРаботников.ВидРасчета КАК ВидРасчета,";
						//О.Т. Аверсон 31.05.2017 № 685
						Если не НеРазбиватьУдержанияПоПериодам Тогда 
							ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
							|			УдержанияРаботников.ДокументОснование КАК ДокументОснование,
							|			УдержанияРаботников.БазовыйПериодНачало";
						иначе
							ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
							|			УдержанияРаботников.ДокументОснование КАК ДокументОснование";
						КонецЕсли;
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						//О.Т. Аверсон 31.05.2017 № 685
						
						|		ИЗ
						|			РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботников
						|		ГДЕ
						|			УдержанияРаботников.ПериодРегистрации = &парамПериодРегистрации
						|			И УдержанияРаботников.ФизЛицо В
						|					(ВЫБРАТЬ
						|						СписокРаботников.Физлицо
						|					ИЗ
						|						ВТСписокРаботников КАК СписокРаботников)
						|			И УдержанияРаботников.ОбособленноеПодразделение = &парамОрганизация
						|			И УдержанияРаботников.Регистратор <> &парамРегистратор
						|			И НАЧАЛОПЕРИОДА(УдержанияРаботников.БазовыйПериодНачало, МЕСЯЦ) = &парамПериодРегистрации
						//(начало) закомментировано Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
						//|			И УдержанияРаботников.ВидРасчета.СпособРасчета <> ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.Процентом)
						//(конец) закомментировано Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
						//(начало) добавлено Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
						|			И НЕ УдержанияРаботников.ВидРасчета.СпособРасчета В ( ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.Процентом),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентом),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПредела),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомДоПределаСНДФЛ),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ИсполнительныйЛистПроцентомСНДФЛ),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.ПочтовыйСбор),  //Аверсон 07.07.2022 КВВ СВФР-008761
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФ),
						|				ЗНАЧЕНИЕ(Перечисление.СпособыРасчетаОплатыТруда.УдержаниеПоИсполнительномуЛистуБезПНИПФДоПредела) )
						//(конец) добавлено Кухарчуком Д.Я. 14.09.18, Задача СВФР-002460, Аверсон-Софт
						|								) КАК ЗарегистрированныеУдержанияРаботников //О.Т. Аверсон 21.06.2017 № 754
						|		ПО УдержанияРаботниковОрганизации.Физлицо = ЗарегистрированныеУдержанияРаботников.ФизЛицо
						|			И УдержанияРаботниковОрганизации.ВидРасчета = ЗарегистрированныеУдержанияРаботников.ВидРасчета
						|			И (ЗарегистрированныеУдержанияРаботников.ДокументОснование = ВЫБОР
						|				КОГДА УдержанияРаботниковОрганизации.ДокументОснование ССЫЛКА Документ.ИсполнительныйЛист
						|					ТОГДА УдержанияРаботниковОрганизации.ДокументОснование
						|				ИНАЧЕ ЗНАЧЕНИЕ(Документ.ИсполнительныйЛист.ПустаяСсылка)
						|			КОНЕЦ)";
						//О.Т. Аверсон 31.05.2017 № 685
						Если не НеРазбиватьУдержанияПоПериодам Тогда 
							ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
							|			И УдержанияРаботниковОрганизации.ПериодНачала = ЗарегистрированныеУдержанияРаботников.БазовыйПериодНачало"; 						
						КонецЕсли;
						ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
						//О.Т. Аверсон 31.05.2017 № 685
						|ГДЕ
						|	ЗарегистрированныеУдержанияРаботников.ФизЛицо ЕСТЬ NULL";
						
					КонецЕсли;
					Если не НеРазбиватьУдержанияПоПериодам Тогда
						если не ТЧДоговора тогда  //О.Т. Аверсон 27.03.2019 № 4149
							ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
							|			И ЕстьNull(УдержанияРаботниковОрганизации.Сотрудник,0)<> 0 ";
						КонецЕсли;
					КонецЕсли;
					
				КонецЕсли;
				
				ТекстЗапросаУдержаний = ТекстЗапросаУдержаний + "
				|
				|УПОРЯДОЧИТЬ ПО
				|    ВидРасчета,
				|    УдержанияРаботниковОрганизации.Период,
				|    ФизлицоНаименование,
				|    Физлицо,
				|    ДокументОснование";
				
				Запрос.Текст = ТекстЗапросаУдержаний;
				Запрос.УстановитьПараметр("ФизлицоСписок",СписокСотрудников);
				УдержанияВыборка = Запрос.Выполнить().Выбрать();
				
				ТЗУдержания = СформироватьТаблицуУдержаний(УдержанияВыборка, ОкончаниеПериодаЗаполнения);
				
				СтруктураПоиска = Новый Структура("Сторно,ФизЛицо,ВидРасчета,ДокументОснование,ДатаНачала,Сотрудник", Ложь); //Аверсон 20.11.2019 КВВ СВФР-005036 (добавлено ",Сотрудник")
				Для каждого СтрокаУдержания Из ТЗУдержания Цикл
					ЗаполнитьЗначенияСвойств(СтруктураПоиска,СтрокаУдержания);	
					Если Удержания.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
						ЗаполнитьЗначенияСвойств(Удержания.Добавить(),СтрокаУдержания)	
					КонецЕсли;
				КонецЦикла;
				
			КонецЕсли;
		КонецЕсли;
		ОбработкаПрерыванияПользователя();
		//Аверсон-софт, Островская Татьяна 13.03.2012
		Если не МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
			И НЕ МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский тогда //Аверсон 10.02.2022 КВВ СВФР-008723
			// АВТОЗАПОЛНЕНИЕ ТЧ "НДФЛ"
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
				ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ Тогда
				
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	НДФЛСведенияОДоходах.ФизЛицо
				|ИЗ
				|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
				|ГДЕ
				|	НДФЛСведенияОДоходах.ФизЛицо В
				|			(ВЫБРАТЬ
				|				СписокРаботников.Физлицо
				|			ИЗ
				|				ВТСписокРаботников КАК СписокРаботников)
				|	И НДФЛСведенияОДоходах.ПериодРегистрации = &парамПериодРегистрации
				|	И НДФЛСведенияОДоходах.Организация = &парамОрганизация
				|	И НДФЛСведенияОДоходах.Регистратор <> &Ссылка";
				
				Выборка = Запрос.Выполнить().Выбрать();
				Пока Выборка.Следующий() Цикл
					РаботникиДляРасчетаНДФЛ.Вставить(Выборка.Физлицо, 0);
				КонецЦикла;
				
				// заполним НДФЛ
				СтруктураПоиска = Новый Структура("ФизЛицо,МесяцНалоговогоПериода");
				Для Каждого Элемент Из РаботникиДляРасчетаНДФЛ Цикл
					СтруктураПоиска.ФизЛицо = Элемент.Ключ;
					СтруктураПоиска.МесяцНалоговогоПериода = НачалоМесяца(ПериодРегистрации);
					Если НДФЛ.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
						ЗаполнитьЗначенияСвойств(НДФЛ.Добавить(),СтруктураПоиска)	
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			
			//Аверсон-софт, Островская Татьяна 14.03.2012	
		иначе
			
			
			ОсновнойТекст = Новый Запрос;
			ОсновнойТекст.Текст = 
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо КАК Физлицо,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
			|ИЗ
			|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|ГДЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ОсновнойТекст.Текст = ОсновнойТекст.Текст +"
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)";
			КонецЕсли;
			
			
			
			ОсновнойТекст.УстановитьПараметр("Сотрудник", МассивСотрудники);
			ОсновнойТекст.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
			НачислениеНДФЛ = ОсновнойТекст.Выполнить().Выбрать();
			//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
			если ТЧДоговора тогда
				Пока НачислениеНДФЛ.Следующий() Цикл
					РаботникиДляРасчетаНДФЛ.Вставить(НачислениеНДФЛ.Физлицо, 0);
				КонецЦикла;
				
				// заполним НДФЛ
				СтруктураПоиска = Новый Структура("ФизЛицо,МесяцНалоговогоПериода");
				Для Каждого Элемент Из РаботникиДляРасчетаНДФЛ Цикл
					СтруктураПоиска.ФизЛицо = Элемент.Ключ;
					СтруктураПоиска.МесяцНалоговогоПериода = НачалоМесяца(НачалоПериодаЗаполнения);
					Если НДФЛ.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
						ЗаполнитьЗначенияСвойств(НДФЛ.Добавить(),СтруктураПоиска)	
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 14.03.2012	
			
			
			
		КонецЕсли;
		
		//Аверсон-софт, Островская Татьяна 13.03.2012
		Если не МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
			И НЕ МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский тогда //Аверсон 10.02.2022 КВВ СВФР-008723
			// АВТОЗАПОЛНЕНИЕ ТЧ "ПенсионныйФонд"
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
				ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетПенсионногоФонда Тогда
				
				Запрос.Текст = 
				"ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	НДФЛСведенияОДоходах.ФизЛицо
				|ИЗ
				|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
				|ГДЕ
				|	НДФЛСведенияОДоходах.ФизЛицо В
				|			(ВЫБРАТЬ
				|				СписокРаботников.Физлицо
				|			ИЗ
				|				ВТСписокРаботников КАК СписокРаботников)
				|	И НДФЛСведенияОДоходах.ПериодРегистрации = &парамПериодРегистрации
				|	И НДФЛСведенияОДоходах.Организация = &парамОрганизация
				|	И НДФЛСведенияОДоходах.Регистратор <> &Ссылка";
				
				Выборка = Запрос.Выполнить().Выбрать();
				Пока Выборка.Следующий() Цикл
					РаботникиДляРасчетаПенсионного.Вставить(Выборка.Физлицо, 0);
				КонецЦикла;
				
				// заполним ПенсионныйФонд
				СтруктураПоиска = Новый Структура("ФизЛицо,МесяцНалоговогоПериода");
				
				//Аверсон ЕАЕ 22.11.2021 СВФР-008398
				СтруктураПоиска.Вставить("Сотрудник");
				//Аверсон СВФР-008398
				
				Для Каждого Элемент Из РаботникиДляРасчетаПенсионного Цикл
					СтруктураПоиска.ФизЛицо = Элемент.Ключ;
					СтруктураПоиска.МесяцНалоговогоПериода = НачалоМесяца(ПериодРегистрации);
					
					//Аверсон ЕАЕ 22.11.2021 СВФР-008398
					СтруктураПоиска.Сотрудник = МассивСотрудники;
					//Аверсон СВФР-008398
					
					Если ПенсионныйФонд.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
						ЗаполнитьЗначенияСвойств(ПенсионныйФонд.Добавить(),СтруктураПоиска);
						
						//Аверсон 01.07.2022 КВВ СВФР-009250 (
						//Если Организация.УчетДополнительнойПенсии Тогда
						ПроцентДопПенсии = РегистрыСведений.ДополнительнаяПенсияРаботодательРаботник.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации),Новый Структура("Сотрудник",МассивСотрудники)).ПроцентРаботника;
						Если ПроцентДопПенсии > 0 Тогда
							СтрДП = ДополнительнаяПенсия.Добавить();
							СтрДП.ФизЛицо =  Выборка.Физлицо;
							СтрДП.Сотрудник =  МассивСотрудники;
							СтрДП.МесяцДП =  НачалоМесяца(ПериодРегистрации);
							СтрДП.ПроцентДП = ПроцентДопПенсии;
						КонецЕсли;
						//КонецЕсли;
						//Аверсон 01.07.2022 КВВ СВФР-009250 )
					КонецЕсли;
				КонецЦикла;
				
			КонецЕсли;
		иначе
			ОсновнойТекст = Новый Запрос;
			ОсновнойТекст.Текст = 
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо КАК Физлицо,
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
			|ИЗ
			|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|ГДЕ
			|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ОсновнойТекст.Текст = ОсновнойТекст.Текст +"
				|	И ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)";
			КонецЕсли;       
			
			ОсновнойТекст.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
			ОсновнойТекст.УстановитьПараметр("Сотрудник", МассивСотрудники);
			НачислениеНДФЛ = ОсновнойТекст.Выполнить().Выбрать();
			//Аверсон-софт, Островская Татьяна 15.08.2012 № 15681
			если ТЧДоговора Тогда 
				Пока НачислениеНДФЛ.Следующий() Цикл
					РаботникиДляРасчетаПенсионного.Вставить(НачислениеНДФЛ.Физлицо, 0);
				КонецЦикла;
				
				// заполним ПенсионныйФонд
				СтруктураПоиска = Новый Структура("ФизЛицо,МесяцНалоговогоПериода");
				Для Каждого Элемент Из РаботникиДляРасчетаПенсионного Цикл
					СтруктураПоиска.ФизЛицо = Элемент.Ключ;
					СтруктураПоиска.МесяцНалоговогоПериода = НачалоМесяца(ПериодРегистрации);
					Если ПенсионныйФонд.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
						ЗаполнитьЗначенияСвойств(ПенсионныйФонд.Добавить(),СтруктураПоиска);
						
						//Аверсон 01.07.2022 КВВ СВФР-009250 (
						//Если Организация.УчетДополнительнойПенсии Тогда
						ПроцентДопПенсии = РегистрыСведений.ДополнительнаяПенсияРаботодательРаботник.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации),Новый Структура("Сотрудник",МассивСотрудники)).ПроцентРаботника;
						Если ПроцентДопПенсии > 0 Тогда
							СтрДП = ДополнительнаяПенсия.Добавить();
							СтрДП.ФизЛицо =  СтруктураПоиска.ФизЛицо;
							СтрДП.Сотрудник =  МассивСотрудники;
							СтрДП.МесяцДП =  НачалоМесяца(ПериодРегистрации);
							СтрДП.ПроцентДП = ПроцентДопПенсии;
						КонецЕсли;
						//КонецЕсли;
						//Аверсон 01.07.2022 КВВ СВФР-009250 )
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			
		КонецЕсли;
		//Аверсон-софт, Островская Татьяна 14.03.2012
		Если не МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда 
			И НЕ МассивСотрудники.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Авторский тогда //Аверсон 10.02.2022 КВВ СВФР-008723
			
			// заполняем погашение займов 
			Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет ИЛИ
				ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов Тогда
				
				// погашение займов
				//толик изменил .ПроцентЗаПользованиеЗаймом > 0 на .ПроцентЗаПользованиеЗаймом >= 0
				ТекстЗапросаУдержаний = 
				"ВЫБРАТЬ
				|	ПогашениеЗаймовРаботникамиОстатки.ФизЛицо,
				|	ПогашениеЗаймовРаботникамиОстатки.ФизЛицо.Наименование КАК ФизЛицоНаименование,
				|	ПогашениеЗаймовРаботникамиОстатки.СтавкаНалогообложенияМатвыгоды,
				|	ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма,
				|	РаботникиОрганизаций.ПодразделениеОрганизации
				|ИЗ
				|	(ВЫБРАТЬ
				|		ПогашениеЗаймовРаботникамиОстатки.ФизЛицо КАК ФизЛицо,
				|		ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма КАК ДоговорЗайма,
				|		ВЫБОР
				|			КОГДА ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.НачислятьМатериальнуюВыгоду
				|				ТОГДА ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.СтавкаНалогообложенияРезидента
				|			ИНАЧЕ НЕОПРЕДЕЛЕНО
				|		КОНЕЦ КАК СтавкаНалогообложенияМатвыгоды
				|	ИЗ
				|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций.Остатки(
				|				&парамНачало,
				|				Организация = &парамОрганизация
				|					И (ДоговорЗайма.НачалоПогашения <= &парамНачало
				|						ИЛИ ДоговорЗайма.ПроцентЗаПользованиеЗаймом >= 0
				|						ИЛИ ДоговорЗайма.НачислятьМатериальнуюВыгоду)
				|					И Физлицо В
				|						(ВЫБРАТЬ
				|							СписокРаботников.Физлицо
				|						ИЗ
				|							ВТСписокРаботников КАК СписокРаботников
				|						ГДЕ
				|							СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))) КАК ПогашениеЗаймовРаботникамиОстатки
				|	
				|	ОБЪЕДИНИТЬ
				|	
				|	ВЫБРАТЬ РАЗЛИЧНЫЕ
				|		ПогашениеЗаймовРаботникамиОбороты.ФизЛицо,
				|		ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма,
				|		ВЫБОР
				|			КОГДА ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачислятьМатериальнуюВыгоду
				|				ТОГДА ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.СтавкаНалогообложенияРезидента
				|			ИНАЧЕ НЕОПРЕДЕЛЕНО
				|		КОНЕЦ
				|	ИЗ
				|		РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОбороты
				|	ГДЕ
				|		(ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачалоПогашения <= &парамНачало
				|				ИЛИ ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.ПроцентЗаПользованиеЗаймом >= 0
				|				ИЛИ ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма.НачислятьМатериальнуюВыгоду)
				|		И ПогашениеЗаймовРаботникамиОбороты.Организация = &парамОрганизация
				|		И ПогашениеЗаймовРаботникамиОбороты.ФизЛицо В
				|				(ВЫБРАТЬ
				|					СписокРаботников.Физлицо
				|				ИЗ
				|					ВТСписокРаботников КАК СписокРаботников
				|				ГДЕ
				|					СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
				|		И ПогашениеЗаймовРаботникамиОбороты.Период МЕЖДУ &парамНачало И &парамКонец
				|		И ПогашениеЗаймовРаботникамиОбороты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)) КАК ПогашениеЗаймовРаботникамиОстатки
				|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				|			РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК Физлицо,
				|			ВЫБОР
				|				КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &парамКонец
				|						И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизацииЗавершения
				|				ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
				|			КОНЕЦ КАК ПодразделениеОрганизации
				|		ИЗ
				|			РегистрСведений.РаботникиОрганизаций.СрезПоследних(
				|					&парамКонец,
				|					Организация = &парамГоловнаяОрганизация
				|						И Сотрудник В
				|							(ВЫБРАТЬ
				|								СписокРаботников.Сотрудник
				|							ИЗ
				|								ВТСписокРаботников КАК СписокРаботников
				|							ГДЕ
				|								СписокРаботников.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
				|						И Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)) КАК РаботникиОрганизацийСрезПоследних
				|		ГДЕ
				|			ВЫБОР
				|					КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &парамКонец
				|							И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|						ТОГДА РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостоянияЗавершения
				|					ИНАЧЕ РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния
				|				КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) КАК РаботникиОрганизаций
				|		ПО ПогашениеЗаймовРаботникамиОстатки.ФизЛицо = РаботникиОрганизаций.Физлицо
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ПогашениеЗаймовРаботникамиОрганизаций КАК ПогашениеЗаймовРаботникамиОбороты
				|		ПО ПогашениеЗаймовРаботникамиОстатки.ФизЛицо = ПогашениеЗаймовРаботникамиОбороты.ФизЛицо
				|			И ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма = ПогашениеЗаймовРаботникамиОбороты.ДоговорЗайма
				|			И (ПогашениеЗаймовРаботникамиОбороты.Период МЕЖДУ &парамНачало И &парамКонец)
				|			И (ПогашениеЗаймовРаботникамиОбороты.Регистратор ССЫЛКА Документ.НачислениеЗарплатыРаботникамОрганизаций)
				|			И (ВЫРАЗИТЬ(ПогашениеЗаймовРаботникамиОбороты.Регистратор КАК Документ.НачислениеЗарплатыРаботникамОрганизаций).ПериодРегистрации = &парамПериодРегистрации)
				|ГДЕ
				|	ПогашениеЗаймовРаботникамиОбороты.ФизЛицо ЕСТЬ NULL 
				|	И ПогашениеЗаймовРаботникамиОстатки.ДоговорЗайма.Проведен
				|
				|УПОРЯДОЧИТЬ ПО
				|	ФизЛицоНаименование";
				
				Запрос.Текст = ТекстЗапросаУдержаний;
				СтруктураПоиска = Новый Структура("ФизЛицо,ДоговорЗайма,Сторно",Неопределено, Неопределено, Ложь);
				Для каждого СтрокаУдержания Из Запрос.Выполнить().Выгрузить() Цикл
					ЗаполнитьЗначенияСвойств(СтруктураПоиска,СтрокаУдержания);	
					Если ПогашениеЗаймов.НайтиСтроки(СтруктураПоиска).Количество() = 0 Тогда
						
						//Аверсон 11.08.2023 КВВ СВФР-011240 (
						//ЗаполнитьЗначенияСвойств(ПогашениеЗаймов.Добавить(),СтрокаУдержания)	
						СтрПЗ = ПогашениеЗаймов.Добавить();
						ЗаполнитьЗначенияСвойств(СтрПЗ,СтрокаУдержания);
						
						Если НЕ ЗначениеЗаполнено(СтрокаУдержания.ПодразделениеОрганизации) Тогда
							Если ЗначениеЗаполнено(СтрокаУдержания.ДоговорЗайма)
								И ТипЗнч(СтрокаУдержания.ДоговорЗайма) = Тип("ДокументСсылка.ДоговорЗаймаСработником") 
								И ЗначениеЗаполнено(СтрокаУдержания.ДоговорЗайма.ПодразделениеОрганизации) Тогда
								СтрПЗ.ПодразделениеОрганизации = СтрокаУдержания.ДоговорЗайма.ПодразделениеОрганизации;
							Иначе
								Если ТипЗнч(МассивСотрудники) = Тип("СправочникСсылка.СотрудникиОрганизаций") Тогда
									СтрПЗ.ПодразделениеОрганизации = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации),Новый Структура("Сотрудник",МассивСотрудники)).ПодразделениеОрганизации;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Аверсон 11.08.2023 КВВ СВФР-011240 )
						
					КонецЕсли;
				КонецЦикла;
				
			КонецЕсли;
		КонецЕсли;
		//если ТЧДоговора Тогда 
		//	
		//КонецЕсли;
		
	КонецЕсли;
	
	
	Возврат Истина;
	
	
	
	
КонецФункции

// процедура дописывать строки в таблицуИсточник из таблицы Приемник.
// Обе таблицы должны иметь одинаковую структуру колонок, иначе возникнет ошибка.
Процедура ДописатьСтрокиИзТаблицыВТаблицу(ТаблицаИсточник, ТаблицаПриемник)
	
	Для Каждого СтрокаТаблицыИсточника Из ТаблицаИсточник Цикл
		ЗаполнитьЗначенияСвойств(ТаблицаПриемник.Добавить(), СтрокаТаблицыИсточника);
	КонецЦикла;
	
КонецПроцедуры // ДописатьСтрокиИзТаблицыВТаблицу()

// Заполняет набор записей по переданным данным расчета НДФЛ
//
// Параметры: 
//  НаборЗаписей - набор записей регистра НДФЛРасчетыСБюджетом
//    ДанныеНДФЛ - таблица значений - данные расчета НДФЛ
//
// Возвращаемое значение:
//  Нет
//
Процедура ЗаполнитьНаборЗаписейПоДаннымНДФЛ(НаборЗаписей, ДанныеНДФЛ, ВыборкаПоШапкеДокумента, Перерасчет = Ложь, ФизлицаСписок = Неопределено, КомментироватьРасчет = Ложь, ВыборкаПодразделений)
	ЗаписьГода = Истина;
	УжеИсчислили = 0;
	УжеПрименилиЛичный = 0;
	УжеПрименилиДетский = 0;
	УжеПрименилиДетскийИнвалидов = 0;
	ТекущееФизлицо = Справочники.ФизическиеЛица.ПустаяСсылка();
	ТекущийГод = 0;
	СтруктураПоиска = Новый Структура("Физлицо, МесяцНалоговогоПериода");
	
	// строим соответствие физлиц, по  которым считается НДФЛ и индексов их строк табличной части НДФЛ
	РаботникиДляРасчетаНДФЛ = Новый Соответствие;
	РасчетПоФизлицу = Ложь;
	Если НЕ (ФизлицаСписок = НеОпределено) И Перерасчет = Ложь Тогда
		// расчет по одному физлицу
		РасчетПоФизлицу = Истина;
		РаботникиДляРасчетаНДФЛ.Вставить(ФизлицаСписок[0].Значение);
		СтруктураПоиска = Новый Структура("ФизЛицо", ФизлицаСписок[0].Значение);
		// запоминаем позицию физлица в табличной части
		ИндексСтрокиТаблицыНДФЛ = НеОпределено;
		МассивСтрок = НДФЛ.НайтиСтроки(СтруктураПоиска);
		Для Каждого СтрокаТабличнойЧасти Из МассивСтрок Цикл
			Если ИндексСтрокиТаблицыНДФЛ = НеОпределено Тогда
				ИндексСтрокиТаблицыНДФЛ = СтрокаТабличнойЧасти.НомерСтроки - 1;
			КонецЕсли;
			НДФЛ.Удалить(СтрокаТабличнойЧасти);
		КонецЦикла;
		Если ИндексСтрокиТаблицыНДФЛ = НеОпределено Тогда
			ИндексСтрокиТаблицыНДФЛ = 0;
		КонецЕсли;
		
	ИначеЕсли НЕ (ФизлицаСписок = Неопределено) Тогда
		// это перерасчет
		Для Каждого ЭлементСписка Из ФизлицаСписок Цикл
			РаботникиДляРасчетаНДФЛ.Вставить(ЭлементСписка.Значение);
		КонецЦикла;
	Иначе //расчет всего документа
		Для Каждого Строка Из НДФЛ Цикл
			РаботникиДляРасчетаНДФЛ.Вставить(Строка.Физлицо);
		КонецЦикла;
		// очистим результаты расчета НДФЛ, которые находятся в табличной части документа
		НДФЛ.Очистить();
		
	КонецЕсли;
	
	//ЗапросШкала = Новый Запрос;
	//ЗапросШкала.Текст = "ВЫБРАТЬ
	//|	ШкалаПодоходногоНалогаСрезПоследних.Налог
	//|ИЗ
	//|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(&КонецПериода, ) КАК ШкалаПодоходногоНалогаСрезПоследних
	//|
	//|УПОРЯДОЧИТЬ ПО
	//|	НижнийПредел";
	//ЗапросШкала.УстановитьПараметр("КонецПериода", ПериодРегистрации);
	//Шкала = ЗапросШкала.Выполнить().Выгрузить();
	
	Если КомментироватьРасчет Тогда
		КомментарийНДФЛ = ОбщегоНазначения.КомментарийРасчета("Расчет подоходного налога");
	КонецЕсли;
	
	СтруктураПоискаПодразделения = Новый Структура("Физлицо,Период");
	Если ГОД(ПериодРегистрации) < 2009 тогда
		Пока ДанныеНДФЛ.Следующий() Цикл
			//О.Т. Аверсон 25.03.2016 № 950
			МассивОсновные = Начисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
			Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
			Для Каждого стрОстновные из МассивОсновные Цикл 
				Сотрудник = стрОстновные.Сотрудник;
			КонецЦикла;
			Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
				МассивДополнительные = ДополнительныеНачисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
				Для Каждого стрДополнительные из МассивДополнительные Цикл 
					Сотрудник = стрДополнительные.Сотрудник;
				КонецЦикла;  			
			КонецЕсли;
			//О.Т. Аверсон 28.06.2017 № 772
			Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
				МассивДоговора = ДоговорыНаВыполнениеРабот.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
				Для Каждого стрДоговора из МассивДоговора Цикл 
					Сотрудник = стрДоговора.Сотрудник;
				КонецЦикла;  			
			КонецЕсли;
			//О.Т. Аверсон 28.06.2017 № 772
			
			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
			Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
				ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
			иначе
				ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
			КонецЕсли;
			
			ЗапросШкала = Новый Запрос;
			ЗапросШкала.Текст = "ВЫБРАТЬ
			|	ШкалаПодоходногоНалогаСрезПоследних.Налог
			|ИЗ
			|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(&КонецПериода, ) КАК ШкалаПодоходногоНалогаСрезПоследних
			|ГДЕ
			|	ШкалаПодоходногоНалогаСрезПоследних.Организация = &Организация
			|	И ШкалаПодоходногоНалогаСрезПоследних.ВидНалогообложения = &ВидНалогообложения
			|
			|УПОРЯДОЧИТЬ ПО
			|	ШкалаПодоходногоНалогаСрезПоследних.НижнийПредел";
			ЗапросШкала.УстановитьПараметр("КонецПериода", ДанныеНДФЛ.Период);
			ЗапросШкала.УстановитьПараметр("Организация", Организация);
			ЗапросШкала.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
			Шкала = ЗапросШкала.Выполнить().Выгрузить();
			
			Если ТекущееФизлицо <> ДанныеНДФЛ.ФизЛицо ИЛИ ТекущийГод <> Год(ДанныеНДФЛ.Период) Тогда
				УжеИсчислили = 0;
				УжеПрименилиЛичный = 0;
				УжеПрименилиДетский = 0;
				УжеПрименилиДетскийЛьгота = 0;
				УжеПрименилиДополнительный = 0;
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				УжеПрименилиМолодыеСпециалисты = 0; 
				//Аверсон СВФР-012095
				
				НалогИсчисленный = 0;
				НалогИсчисленныйЗаГод = 0;
				ВычетыПримененныеЛичный = 0;
				ВычетыПримененныеДетский = 0;
				ВычетыПримененныеДетскийЛьгота = 0;
				ВычетыПримененныеДополнительный = 0;
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				ВычетыПримененныеМолодыеСпециалисты = 0; 
				//Аверсон СВФР-012095
				
				ВычетыПримененные312Пред = 0;
				ВычетыПримененные311Пред = 0;
				ВычетыПримененные312 = 0;
				ВычетыПримененные311 = 0;
				ОблагаемыйДоходЗаГод = 0;
				УжеПрименили312 = 0;
				УжеПрименили311 = 0;
				// текущие физлицо и год периода
				ТекущееФизлицо = ДанныеНДФЛ.ФизЛицо;
				ТекущийГод = Год(ДанныеНДФЛ.Период);
			КонецЕсли;
			
			//Минск н
			Если   ТекущийГод < Год(ПериодРегистрации) тогда   //Перерасчеты за предидущие налоговые периоды
				Если Месяц(ДанныеНДФЛ.Период) = 12 тогда
					Если (Год(ПериодРегистрации) - ТекущийГод) > 3 тогда
						Сообщить("Перерасчет подоходного налога возможен только за три года");
						Продолжить;
					КонецЕсли;
					//Рассчитать по прогрессивной шкале
					ВычетыПримененныеЛичный = ДанныеНДФЛ.ПримененныеВычетыЛичные;
					ВычетыПримененныеДетский = ДанныеНДФЛ.ПримененныеВычетыДетские;
					ВычетыПримененныеДетскийЛьгота = ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьгота;
					ВычетыПримененныеДополнительный = ДанныеНДФЛ.ПримененныеВычетыДополнительные; 
					
					//Аверсон ЕАЕ 12.01.2024 СВФР-012095
					ВычетыПримененныеМолодыеСпециалисты = ДанныеНДФЛ.ПримененныеВычетыМолодыеСпециалисты;
					//Аверсон СВФР-012095
					
					ВычетыПримененные312 = ДанныеНДФЛ.ПримененныеВычеты312;
					ВычетыПримененные311 = ДанныеНДФЛ.ПримененныеВычеты311;
					ОблагаемыйДоходЗаГод = ДанныеНДФЛ.ДоходЗаГод;
					если ДанныеНДФЛ.Резидент тогда
						//О.Т. Аверсон 25.03.2016 № 950
						МассивОсновные = Начисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
						Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
						Для Каждого стрОстновные из МассивОсновные Цикл 
							Сотрудник = стрОстновные.Сотрудник;
						КонецЦикла;
						Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
							МассивДополнительные = ДополнительныеНачисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
							Для Каждого стрДополнительные из МассивДополнительные Цикл 
								Сотрудник = стрДополнительные.Сотрудник;
							КонецЦикла;  			
						КонецЕсли;
						//О.Т. Аверсон 28.06.2017 № 772
						Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
							МассивДоговора = ДоговорыНаВыполнениеРабот.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
							Для Каждого стрДоговора из МассивДоговора Цикл 
								Сотрудник = стрДоговора.Сотрудник;
							КонецЦикла;  			
						КонецЕсли;
						//О.Т. Аверсон 28.06.2017 № 772
						ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
						Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
							ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
						иначе
							ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
						КонецЕсли;
						//О.Т. Аверсон 27.03.2016 № 950
						
						НалогИсчисленный = ОбщегоНазначения.ОкруглитьПоВалюте(ПроведениеРасчетов.РассчитатьПрогрессивнуюШкалу(ТекущийГод, ДанныеНДФЛ.период,  ДанныеНДФЛ.НалогРанееИсчисленный,
						ОблагаемыйДоходЗаГод, 
						ВычетыПримененныеЛичный,
						ВычетыПримененныеДетский,
						ВычетыПримененныеДетскийЛьгота,
						ВычетыПримененныеДополнительный,
						
						//Аверсон ЕАЕ 12.01.2024 СВФР-012095
						ВычетыПримененныеМолодыеСпециалисты,
						//Аверсон СВФР-012095
						
						ВычетыПримененные312,
						ВычетыПримененные311,ВидНалогообложения,Организация,Сотрудник) - ДанныеНДФЛ.НалогРанееИсчисленный, Константы.ВалютаРегламентированногоУчета.Получить());
					Иначе
						НалогИсчисленный = ОбщегоНазначения.ОкруглитьПоВалюте(ДанныеНДФЛ.НалогНерезидентаЗаГод - ДанныеНДФЛ.НалогРанееИсчисленный, Константы.ВалютаРегламентированногоУчета.Получить());											
						НалогИсчисленныйЗаГод = ДанныеНДФЛ.НалогНерезидентаЗаГод;
					КонецЕсли;												
				КонецЕсли;
				
				Если НалогИсчисленный <> 0 тогда
					//Сообщить("Работник "+ ДанныеНДФЛ.ФизЛицо+ " период "+ДанныеНДФЛ.Период);
					//Сообщить("Перерасчет налога за предыдущие налоговые периоды. Заполните документ Перерасчет подоходного налога");
					//		НалогИсчисленный =0;
				КонецЕсли;
				
			ИначеЕсли ТекущийГод >= Год(ПериодРегистрации) тогда
				Если ((Месяц(ДанныеНДФЛ.период) >= Месяц(ПериодРегистрации)) И ТекущийГод = Год(ПериодРегистрации)) ИЛИ
					(ТекущийГод > Год(ПериодРегистрации)) тогда
					ВычетыПримененныеЛичный = ДанныеНДФЛ.ПримененныеВычетыЛичные;
					ВычетыПримененныеДетский = ДанныеНДФЛ.ПримененныеВычетыДетские;
					ВычетыПримененныеДетскийЛьгота = ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьгота;
					ВычетыПримененныеДополнительный = ДанныеНДФЛ.ПримененныеВычетыДополнительные;
					
					//Аверсон ЕАЕ 12.01.2024 СВФР-012095
					ВычетыПримененныеМолодыеСпециалисты = ДанныеНДФЛ.ПримененныеВычетыМолодыеСпециалисты;
					//Аверсон СВФР-012095
					
					ВычетыПримененные312 = ДанныеНДФЛ.ПримененныеВычеты312;
					ВычетыПримененные311 = ДанныеНДФЛ.ПримененныеВычеты311;
					ОблагаемыйДоходЗаГод = ДанныеНДФЛ.ДоходЗаГод;
					Если ДанныеНДФЛ.Резидент тогда
						//О.Т. Аверсон 25.03.2016 № 950
						МассивОсновные = Начисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
						Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
						Для Каждого стрОстновные из МассивОсновные Цикл 
							Сотрудник = стрОстновные.Сотрудник;
						КонецЦикла;
						Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
							МассивДополнительные = ДополнительныеНачисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
							Для Каждого стрДополнительные из МассивДополнительные Цикл 
								Сотрудник = стрДополнительные.Сотрудник;
							КонецЦикла;  			
						КонецЕсли;
						//О.Т. Аверсон 28.06.2017 № 772
						Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
							МассивДоговора = ДоговорыНаВыполнениеРабот.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
							Для Каждого стрДоговора из МассивДоговора Цикл 
								Сотрудник = стрДоговора.Сотрудник;
							КонецЦикла;  			
						КонецЕсли;
						//О.Т. Аверсон 28.06.2017 № 772
						ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
						Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
							ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
						иначе
							ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
						КонецЕсли;
						//О.Т. Аверсон 27.03.2016 № 950
						НалогИсчисленныйЗаГод = ПроведениеРасчетов.РассчитатьПрогрессивнуюШкалу(ТекущийГод, ДанныеНДФЛ.период, ДанныеНДФЛ.НалогРанееИсчисленный,
						ОблагаемыйДоходЗаГод, 
						ВычетыПримененныеЛичный,
						ВычетыПримененныеДетский,
						ВычетыПримененныеДетскийЛьгота,
						ВычетыПримененныеДополнительный,
						
						//Аверсон ЕАЕ 12.01.2024 СВФР-012095
						ВычетыПримененныеМолодыеСпециалисты,
						//Аверсон СВФР-012095
						
						ВычетыПримененные312,
						ВычетыПримененные311,ВидНалогообложения,Организация,Сотрудник) - ДанныеНДФЛ.НалогРанееИсчисленный;
						НалогИсчисленный = ОбщегоНазначения.ОкруглитьПоВалюте(НалогИсчисленныйЗаГод - УжеИсчислили, Константы.ВалютаРегламентированногоУчета.Получить());
					Иначе
						НалогИсчисленный = ОбщегоНазначения.ОкруглитьПоВалюте(ДанныеНДФЛ.НалогНерезидентаЗаГод - ДанныеНДФЛ.НалогРанееИсчисленный, Константы.ВалютаРегламентированногоУчета.Получить());	
						НалогИсчисленныйЗаГод = ДанныеНДФЛ.НалогНерезидентаЗаГод;
					КонецЕсли;
				Иначе
					ВычетыПримененные312Пред = ДанныеНДФЛ.ПримененныеВычеты312;// + ДанныеНДФЛ.ПримененныеРанееВычеты312;
					ВычетыПримененные311Пред = ДанныеНДФЛ.ПримененныеВычеты311;// + ДанныеНДФЛ.ПримененныеранееВычеты311;
				КонецЕсли;
			КонецЕсли;
			
			Если 	НалогИсчисленный = 0 и НалогИсчисленныйЗаГод >= 0 и 
				ОблагаемыйДоходЗаГод = 0 и 
				ВычетыПримененныеЛичный = 0 и 
				ВычетыПримененныеДетский = 0 и 
				ВычетыПримененныеДополнительный = 0 и
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				ВычетыПримененныеМолодыеСпециалисты = 0 и
				//Аверсон СВФР-012095
				
				ВычетыПримененные312 = 0 и 
				ВычетыПримененные311 = 0 Тогда
				Продолжить;
			КонецЕсли;
			
			Если КомментироватьРасчет Тогда
				КомментарийМесяца = ОбщегоНазначения.КомментарийРасчета("Результат расчета за " + Формат(ДанныеНДФЛ.Период, "ДФ=ММММ") + ": " + НалогИсчисленный, КомментарийНДФЛ);
				Если ДанныеНДФЛ.Резидент Тогда
					ОбщегоНазначения.КомментарийРасчета("Статус: резидент РБ", КомментарийМесяца);
				Иначе
					ОбщегоНазначения.КомментарийРасчета("Статус: не является резидентом РБ", КомментарийМесяца,,, Перечисления.ВидыСообщений.ВажнаяИнформация);
				КонецЕсли;
				КомментарийДохода = ОбщегоНазначения.КомментарийРасчета("Доход за налоговый период, всего: " + ОблагаемыйДоходЗаГод, КомментарийМесяца,,,, Ложь);
				
				ДоходыПоВидамРасчетов = ДанныеНДФЛ.Выбрать();
				Пока ДоходыПоВидамРасчетов.Следующий() Цикл
					ОбщегоНазначения.КомментарийРасчета("По виду расчета " + ДоходыПоВидамРасчетов.ВидРасчетаНаименование + " " + ДоходыПоВидамРасчетов.ДоходЗаМесяцПоВидамРасчета, КомментарийДохода);
				КонецЦикла;
				КомментарийВычетовСтанд = ОбщегоНазначения.КомментарийРасчета("Примененные стандартные вычеты, всего: " + (ВычетыПримененныеЛичный + ВычетыПримененныеДетский + ВычетыПримененныеДетскийЛьгота + ВычетыПримененныеДополнительный + ВычетыПримененныеМолодыеСпециалисты), КомментарийМесяца); //Аверсон ЕАЕ 12.01.2024 СВФР-012095
				КомментарийВычетов = ОбщегоНазначения.КомментарийРасчета("Примененные имущественный/социальный вычеты, всего: " + (ВычетыПримененные312 + ВычетыПримененные311), КомментарийМесяца);
				Если ВычетыПримененныеЛичный <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный личный вычет: " + ВычетыПримененныеЛичный, КомментарийВычетов);
				КонецЕсли;
				Если ВычетыПримененныеДетский <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный вычет на детей: " + ВычетыПримененныеДетский, КомментарийВычетов);
				КонецЕсли;
				Если ВычетыПримененныеДетскийЛьгота <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный вычет на детей-инвалидов: " + ВычетыПримененныеДетскийЛьгота, КомментарийВычетов);
				КонецЕсли;
				Если ВычетыПримененныеДополнительный <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный вычет на детей-инвалидов: " + ВычетыПримененныеДополнительный, КомментарийВычетов);
				КонецЕсли;
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				Если ВычетыПримененныеМолодыеСпециалисты <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный вычет молодым специалистам: " + ВычетыПримененныеМолодыеСпециалисты, КомментарийВычетов);
				КонецЕсли;
				//Аверсон СВФР-012095
				
				Если ВычетыПримененные312 <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Вычет имущественный: " + ВычетыПримененные312, КомментарийВычетов);
				КонецЕсли;
				Если ВычетыПримененные311 <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Вычет социальный: " + ВычетыПримененные311, КомментарийВычетов);
				КонецЕсли;
				КомментарийДохода = ОбщегоНазначения.КомментарийРасчета("Облагаемый доход за налоговый период, всего: " + ОблагаемыйДоходЗаГод, КомментарийМесяца,,,, Ложь);
				Если ДанныеНДФЛ.РанееНалогИсчисленный <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Исчисленный налог нарастающим итогом за год: " + ДанныеНДФЛ.РанееНалогИсчисленный, КомментарийМесяца);
				КонецЕсли;
				Если ДанныеНДФЛ.ВычетЗаМесяц <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Льготы по доходам: " + ДанныеНДФЛ.ВычетЗаМесяц, КомментарийМесяца);
				КонецЕсли;
			КонецЕсли;
			
			// Если передан набор записей - заполняем и его
			Если НаборЗаписей <> Неопределено Тогда
				// зарегистрируем в регистре
				Движение = НаборЗаписей.Добавить();
				
				// Свойства
				Движение.ВидДвижения				= ВидДвиженияНакопления.Приход;
				Движение.Период						= КонецМесяца(ПериодРегистрации);
				
				// Измерения
				Движение.Организация	 	   		= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
				Движение.ФизЛицо	 	 	  		= ДанныеНДФЛ.ФизЛицо;
				Движение.МесяцНалоговогоПериода			= ДанныеНДФЛ.Период;
				Движение.СтавкаНалогообложенияРезидента	= Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13;
				
				// Ресурсы
				Движение.Налог						= НалогИсчисленный;
				Движение.ПримененныйВычетЛичный		= ВычетыПримененныеЛичный;
				Движение.ПримененныйВычетНаДетей	= ВычетыПримененныеДетский;
				Движение.ПримененныйВычетНаДетейЛьгота = ВычетыПримененныеДетскийЛьгота;
				Движение.ПримененныйДополнительныйВычет = ВычетыПримененныеДополнительный;
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				Движение.ПримененныйВычетМолодыеСпециалисты = ВычетыПримененныеМолодыеСпециалисты;
				//Аверсон СВФР-012095
				
				// Реквизиты 
				Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
				Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
				Движение.ИсчисленоИзЗарплаты	= Истина;	
			КонецЕсли;
			
			// Ниже - заполняем табличную часть документа
			Если Перерасчет Тогда
				СтруктураПоиска.Физлицо = ДанныеНДФЛ.ФизЛицо;
				СтруктураПоиска.МесяцНалоговогоПериода = ДанныеНДФЛ.Период;
				Строки = НДФЛ.НайтиСтроки(СтруктураПоиска);
				Если Строки.Количество() > 0 Тогда
					Строка = Строки[0];
				Иначе
					Строка = НДФЛ.Добавить();
				КонецЕсли;
			Иначе
				Если РасчетПоФизлицу Тогда
					Строка = НДФЛ.Вставить(ИндексСтрокиТаблицыНДФЛ);
					ИндексСтрокиТаблицыНДФЛ = ИндексСтрокиТаблицыНДФЛ+1;
				Иначе
					Строка = НДФЛ.Добавить();
				КонецЕсли;
			КонецЕсли;
			РаботникиДляРасчетаНДФЛ.Удалить(ДанныеНДФЛ.ФизЛицо);
			
			ЗаполнитьЗначенияСвойств(СтруктураПоискаПодразделения,ДанныеНДФЛ);
			ВыборкаПодразделений.Сбросить();
			Если ВыборкаПодразделений.НайтиСледующий(СтруктураПоискаПодразделения) Тогда
				Строка.ПодразделениеОрганизации	= ВыборкаПодразделений.ПодразделениеОрганизации;
			КонецЕсли;
			
			Строка.ФизЛицо 						= ДанныеНДФЛ.ФизЛицо;
			Строка.Налог   						= НалогИсчисленный;
			Строка.ПримененныйВычетЛичный		= ВычетыПримененныеЛичный;
			Строка.ПримененныйВычетНаДетей		= ВычетыПримененныеДетский;
			Строка.ПримененныйВычетНаДетейЛьгота		= ВычетыПримененныеДетскийЛьгота;
			Строка.ПримененныйВычетДополнительный	= ВычетыПримененныеДополнительный;
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			Строка.ПримененныйВычетМолодыеСпециалисты	= ВычетыПримененныеМолодыеСпециалисты;
			//Аверсон СВФР-012095
			
			Строка.ПримененныйВычетИмущественныйРасход		= ВычетыПримененные311-ВычетыПримененные311Пред;
			Строка.ПримененныйВычетСоциальныйСПроцентами		= ВычетыПримененные312-ВычетыПримененные312пред;
			Строка.МесяцНалоговогоПериода 		= ДанныеНДФЛ.Период;
			
			// Запомним суммы для следующей итерации
			УжеИсчислили = УжеИсчислили + НалогИсчисленный;
			УжеПрименилиЛичный = УжеПрименилиЛичный + ВычетыПримененныеЛичный;
			УжеПрименилиДетский = УжеПрименилиДетский + ВычетыПримененныеДетский;
			УжеПрименилиДетскийЛьгота = УжеПрименилиДетскийЛьгота + ВычетыПримененныеДетскийЛьгота;
			УжеПрименилиДополнительный = УжеПрименилиДополнительный + ВычетыПримененныеДополнительный;
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			УжеПрименилиМолодыеСпециалисты = УжеПрименилиМолодыеСпециалисты + ВычетыПримененныеМолодыеСпециалисты;
			//Аверсон СВФР-012095
			
			УжеПрименили312 = УжеПрименили312 + ВычетыПримененные312;
			УжеПрименили311 = УжеПрименили311 + ВычетыПримененные311;
		КонецЦикла;
		
	Иначе  // т.е. если ГОД(ПериодРегистрации) >= 2009		
		Пока ДанныеНДФЛ.Следующий() Цикл
			ОбработкаПрерыванияПользователя();
			//О.Т. Аверсон 25.03.2016 № 950
			МассивОсновные = Начисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
			Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка();
			Для Каждого стрОстновные из МассивОсновные Цикл 
				Сотрудник = стрОстновные.Сотрудник;
			КонецЦикла;
			Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
				МассивДополнительные = ДополнительныеНачисления.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
				Для Каждого стрДополнительные из МассивДополнительные Цикл 
					Сотрудник = стрДополнительные.Сотрудник;
				КонецЦикла;  			
			КонецЕсли;
			//О.Т. Аверсон 28.06.2017 № 772
			Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
				МассивДоговора = ДоговорыНаВыполнениеРабот.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
				Для Каждого стрДоговора из МассивДоговора Цикл 
					Сотрудник = стрДоговора.Сотрудник;
				КонецЦикла;  			
			КонецЕсли;
			//О.Т. Аверсон 28.06.2017 № 772
			//+ СВЭЙ КДЯ 25.11.19 СВФР-005103
			Если Сотрудник = Справочники.СотрудникиОрганизаций.ПустаяСсылка() Тогда
				МассивУдержания = Удержания.НайтиСтроки(Новый Структура("ФизЛицо",ДанныеНДФЛ.ФизЛицо));        
				Для Каждого стрУдержания из МассивУдержания Цикл 
					Сотрудник = стрУдержания.Сотрудник;
				КонецЦикла;  			
			КонецЕсли;
			//- СВЭЙ КДЯ 25.11.19 СВФР-005103
			ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
			Если Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
				ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
			иначе
				ВидНалогообложения = Сотрудник.ВидНалогообложенияОсновной;
			КонецЕсли;
			
			ЗапросШкала = Новый Запрос;
			ЗапросШкала.Текст = "ВЫБРАТЬ
			|	ШкалаПодоходногоНалогаСрезПоследних.Налог
			|ИЗ
			|	РегистрСведений.ШкалаПодоходногоНалога.СрезПоследних(&КонецПериода, ) КАК ШкалаПодоходногоНалогаСрезПоследних
			|ГДЕ
			|	ШкалаПодоходногоНалогаСрезПоследних.Организация = &Организация
			|	И ШкалаПодоходногоНалогаСрезПоследних.ВидНалогообложения = &ВидНалогообложения
			|
			|УПОРЯДОЧИТЬ ПО
			|	ШкалаПодоходногоНалогаСрезПоследних.НижнийПредел";
			ЗапросШкала.УстановитьПараметр( "КонецПериода", ДанныеНДФЛ.Период );//О.Т. 09.01.2015 № 
			ЗапросШкала.УстановитьПараметр("Организация", Организация);
			ЗапросШкала.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
			Шкала = ЗапросШкала.Выполнить().Выгрузить();
			если ЗаписьГода Тогда 
				ГодПредыдущий = ДанныеНДФЛ.период;
				ЗаписьГода = Ложь;
			КонецЕсли;
			//О.Т. Аверсон 31.03.2016 № 950
			ЗапросИндСтавкаНалогообл = Новый Запрос;
			ЗапросИндСтавкаНалогообл.Текст = 
			"ВЫБРАТЬ
			|	ИноеНалогообложениеПоСотрудникамСрезПоследних.НДФЛ
			|ИЗ
			|	РегистрСведений.ИноеНалогообложениеПоСотрудникам.СрезПоследних(
			|			&Период,
			|			Организация = &Организация
			|				И ВидНалогообложения = &ВидНалогообложения
			//+ СВЭЙ КДЯ 25.11.19 СВФР-005103
			//|				И Сотрудник = &Сотрудник
			//- СВЭЙ КДЯ 25.11.19 СВФР-005103
			//+ СВЭЙ КДЯ 25.11.19 СВФР-005103
			|				И ( 
			|					&СотрудникЗаполнен И Сотрудник = &Сотрудник
			|                   ИЛИ НЕ &СотрудникЗаполнен И ФизЛицо = &ФизЛицо
			|				  ) 
			//- СВЭЙ КДЯ 25.11.19 СВФР-005103
			|	) КАК ИноеНалогообложениеПоСотрудникамСрезПоследних";
			
			ЗапросИндСтавкаНалогообл.УстановитьПараметр("ВидНалогообложения", ВидНалогообложения);
			ЗапросИндСтавкаНалогообл.УстановитьПараметр("Организация", Организация);
			ЗапросИндСтавкаНалогообл.УстановитьПараметр("Сотрудник", Сотрудник);
			ЗапросИндСтавкаНалогообл.УстановитьПараметр( "Период", ДанныеНДФЛ.Период );
			//+ СВЭЙ КДЯ 25.11.19 СВФР-005103
			ЗапросИндСтавкаНалогообл.УстановитьПараметр( "СотрудникЗаполнен", ЗначениеЗаполнено( Сотрудник ) );
			ЗапросИндСтавкаНалогообл.УстановитьПараметр( "ФизЛицо", ДанныеНДФЛ.ФизЛицо );
			//- СВЭЙ КДЯ 25.11.19 СВФР-005103
			РезИндСтавкаНалогообл = ЗапросИндСтавкаНалогообл.Выполнить().Выгрузить();
			ЕстьИндивидСтавка = Ложь;
			СтавкаНДФЛИнд = 0;
			Если РезИндСтавкаНалогообл.Количество()>0 Тогда 
				ЕстьИндивидСтавка = Истина;
				СтавкаНДФЛИнд = РезИндСтавкаНалогообл[0].НДФЛ;
			КонецЕсли;
			//О.Т. Аверсон 31.03.2016 № 950
			
			
			Если ТекущееФизлицо <> ДанныеНДФЛ.ФизЛицо ИЛИ ТекущийГод <> Год(ДанныеНДФЛ.Период) Тогда
				УжеИсчислили = 0;
				// уже примененные вычеты
				УжеПрименилиЛичный = 0;
				УжеПрименилиДетский = 0;
				УжеПрименилиДетскийЛьгота = 0;
				УжеПрименилиДополнительный = 0;
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				УжеПрименилиМолодыеСпециалисты = 0; 
				//Аверсон СВФР-012095
				
				//толик необходимо обнулять вычеты за каждый месяц иначе если дохода на вычет нет остается старое значение !!!				
				//ВычетыПримененные312ЗаМесяц = 0;
				//ВычетыПримененные311ЗаМесяц = 0;
				//ВычетыПримененные640СтрахЗаМесяц = 0;
				УжеПрименили312 = 0;
				УжеПрименили311 = 0;
				УжеПрименили640Страх = 0;
				УжеПрименили641Страх = 0;  //Аверсон 03.08.2023 КВВ СВФР-011182
				// текущие физлицо и год периода
				ТекущееФизлицо = ДанныеНДФЛ.ФизЛицо;
				ТекущийГод = Год(ДанныеНДФЛ.Период);
			КонецЕсли;
			ВычетыПримененные312ЗаМесяц = 0;
			ВычетыПримененные311ЗаМесяц = 0;
			ВычетыПримененные640СтрахЗаМесяц = 0;
			//енд		
			ВычетыПримененные641СтрахЗаМесяц = 0;//Аверсон 03.08.2023 КВВ СВФР-011182
			
			//Если ДанныеНДФЛ.Резидент Тогда
			//	НалогИсчисленный = ДанныеНДФЛ.НалогИсчисленный  - УжеИсчислили;
			//	НалогИсчисленный = ?(НалогИсчисленный < 0,0,НалогИсчисленный);
			//Иначе
			//	НалогИсчисленный = ДанныеНДФЛ.НалогИсчисленный;
			//КонецЕсли;
			// ранее примененные вычеты текущего месяца
			//РанееПримененныеЛичныеТМ = ДанныеНДФЛ.РанееПримененныеВычетыЛичныеЗаМесяц;
			//РанееПримененныеДетскиеТМ = ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЗаМесяц;
			//РанееПримененныеДетскиеЛьготаТМ = ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЛьготаЗаМесяц;
			//РанееПримененныеДополнительныеТМ = ДанныеНДФЛ.РанееПримененныеВычетыДополнительные;
			//РанееПримененные312ТМ = ДанныеНДФЛ.РанееПримененныеВычеты312ЗаМесяц;
			//РанееПримененные311ТМ = ДанныеНДФЛ.РанееПримененныеВычеты311ЗаМесяц;
			//
			//// отрицательный, примененный за месяц вычет, который нужно перераспределить
			//КПерераспределению = 0;
			//
			// первый проход
			
			//Островская Татьяна 18.09.2013 № 16727
			//ЗапросДети = Новый Запрос;
			//ЗапросДети.Текст = 
			//"ВЫБРАТЬ
			//|	КОЛИЧЕСТВО(ВложенныйЗапрос.Имя) КАК Имя,
			//|	РазмерВычета.РазмерВРублях
			//|ИЗ
			//|	(ВЫБРАТЬ
			//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя КАК Имя,
			//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет КАК ПрименятьВычет,
			//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета КАК КодВычета,
			//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка КАК Ссылка
			//|	ИЗ
			//|		Документ.НДФЛСтандартныеВычетыФизлиц.СоставСемьи КАК НДФЛСтандартныеВычетыФизлицСоставСемьи
			//|	ГДЕ
			//|		РАЗНОСТЬДАТ(НДФЛСтандартныеВычетыФизлицСоставСемьи.ДатаРождения, &ДатаВычета, месяц) < 218
			//|		И НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка.Физлицо = &Физлицо
			//|	
			//|	СГРУППИРОВАТЬ ПО
			//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Ссылка,
			//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.КодВычета,
			//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.ПрименятьВычет,
			//|		НДФЛСтандартныеВычетыФизлицСоставСемьи.Имя) КАК ВложенныйЗапрос
			//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			//|			ВЫБОР
			//|				КОГДА НДФЛРазмерВычетовСрезПоследних.КодВычета ЕСТЬ NULL 
			//|					ТОГДА 0
			//|				ИНАЧЕ НДФЛРазмерВычетовСрезПоследних.КодВычета
			//|			КОНЕЦ КАК Поле1,
			//|			НДФЛРазмерВычетовСрезПоследних.ОграничениеПоДоходам КАК ОграничениеПоДоходам,
			//|			НДФЛРазмерВычетовСрезПоследних.РазмерВРублях КАК РазмерВРублях
			//|		ИЗ
			//|			РегистрСведений.НДФЛРазмерВычетов.СрезПоследних(&ДатаВычета, ) КАК НДФЛРазмерВычетовСрезПоследних) КАК РазмерВычета
			//|		ПО ВложенныйЗапрос.КодВычета = РазмерВычета.Поле1
			//|
			//|СГРУППИРОВАТЬ ПО
			//|	РазмерВычета.РазмерВРублях";
			//ЗапросДети.УстановитьПараметр("ДатаВычета",ДанныеНДФЛ.Период);
			//ЗапросДети.УстановитьПараметр("Физлицо",ДанныеНДФЛ.ФизЛицо);
			//РезДети = ЗапросДети.Выполнить().Выбрать();
			//
			ВычетыПримененныеДетский = (ДанныеНДФЛ.ПримененныеВычетыДетские - ДанныеНДФЛ.РанееПримененныеВычетыДетские - УжеПрименилиДетский);
			//если РезДети.Следующий() Тогда 
			//	если РезДети.Имя >= 2 Тогда
			//		если ВычетыПримененныеДетский>0 Тогда 
			//			ВычетыПримененныеДетский = ВычетыПримененныеДетский+(РезДети.РазмерВРублях*РезДети.Имя);
			//		КонецЕсли;
			//	КонецЕсли;
			//	
			//КонецЕсли;
			//Островская Татьяна 18.09.2013 № 16727
			
			ВычетыПримененныеЛичный = ДанныеНДФЛ.ПримененныеВычетыЛичные - ДанныеНДФЛ.РанееПримененныеВычетыЛичные - УжеПрименилиЛичный;
			ВычетыПримененныеДетскийЛьгота = ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьгота  - ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЛьгота  - УжеПрименилиДетскийЛьгота;
			ВычетыПримененныеДополнительный =  ДанныеНДФЛ.ПримененныеВычетыДополнительные - ДанныеНДФЛ.РанееПримененныеВычетыДополнительные - УжеПрименилиДополнительный;
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			ВычетыПримененныеМолодыеСпециалисты =  ДанныеНДФЛ.ПримененныеВычетыМолодыеСпециалисты - ДанныеНДФЛ.РанееПримененныеВычетыМолодыеСпециалисты - УжеПрименилиМолодыеСпециалисты;
			//Аверсон СВФР-012095
			
			ДоходЗаПериодДляВычета = ДанныеНДФЛ.ДоходЗаПериод - (ДанныеНДФЛ.ПримененныеВычетыЛичныеЗаПериод + ДанныеНДФЛ.ПримененныеВычетыДетскиеЗаПериод  + ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьготаЗаПериод + ДанныеНДФЛ.ПримененныеВычетыДополнительныеЗаПериод + ДанныеНДФЛ.ПримененныеВычетыМолодыеСпециалистыЗаПериод); //Аверсон ЕАЕ 12.01.2024 СВФР-012095
			//ВычетыПримененные312 = ДанныеНДФЛ.ПримененныеВычеты312;
			//ВычетыПримененные311 = ДанныеНДФЛ.ПримененныеВычеты311;
			
			//ВычетыПримененные312 = ДанныеНДФЛ.ПримененныеВычеты312 - ДанныеНДФЛ.РанееПримененныеВычеты312 - УжеПрименили312;
			//ВычетыПримененные311 = ДанныеНДФЛ.ПримененныеВычеты311 - ДанныеНДФЛ.РанееПримененныеВычеты311 - УжеПрименили311;
			
			//Островская Татьяна 09.03.2014 № 17170
			ОграничениеНДФЛ = РегистрыСведений.НДФЛРазмерВычетов.ПолучитьПоследнее(ДанныеНДФЛ.Период, Новый Структура("КодВычета",Справочники.ВычетыНДФЛ.Код640страх)).ОграничениеПоДоходам;
			
			//БазоваяВеличина = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(КонецМесяца(ДанныеНДФЛ.Период),Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.БазоваяВеличина)).Размер;
			//Если БазоваяВеличина = 0 тогда 
			//	Сообщить("Не заданна базовая величина");
			//Иначе
			
			//О.Т. Аверсон 23.01.2018 № 1467
			ЗапросДата = Новый запрос;
			ЗапросДата.Текст = 
			"ВЫБРАТЬ
			| РазмерыПараметровДляРасчетаРБСрезПоследних.Период,
			| РазмерыПараметровДляРасчетаРБСрезПоследних.ВидПараметра,
			| РазмерыПараметровДляРасчетаРБСрезПоследних.Размер
			|ИЗ
			| РегистрСведений.РазмерыПараметровДляРасчетаРБ.СрезПоследних(&ПериодРегистрации) КАК РазмерыПараметровДляРасчетаРБСрезПоследних
			|ГДЕ
			| РазмерыПараметровДляРасчетаРБСрезПоследних.ВидПараметра = &ВидПараметра";
			ЗапросДата.УстановитьПараметр("ВидПараметра", Перечисления.ВидыПараметровДляРасчетаЗарплаты.ДатаНачалаПодоходного);
			ЗапросДата.УстановитьПараметр("ПериодРегистрации",КонецМесяца(ПериодРегистрации));
			Результат = ЗапросДата.Выполнить().Выбрать();
			ДатаПодоходного = НачалоГода(ПериодРегистрации);
			Пока Результат.Следующий() цикл
				
				ДатаПодоходного = Результат.Период;
				
			КонецЦикла;
			
			//СВЭЙ 05.12.2023 КВВ СВФР-011932 (
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	СУММА(НДФЛСведенияОДоходах.СуммаВычета) КАК СуммаВычетаОборот
			|ИЗ
			|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|ГДЕ
			|	НДФЛСведенияОДоходах.КодВычета = &КодДохода
			|	И НДФЛСведенияОДоходах.Организация = &Организация
			|	И НДФЛСведенияОДоходах.ФизЛицо = &ФизЛицо
			|	И НДФЛСведенияОДоходах.Период МЕЖДУ &НачалоГода И &парамКонецМесяцаНалоговогоПериода";
			
			Запрос.УстановитьПараметр("КодДохода", Справочники.ВычетыНДФЛ.Код641страх);
			Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ДанныеНДФЛ.Период)); 
			Если ДатаПодоходного >  НачалоГода(ПериодРегистрации) Тогда
				Запрос.УстановитьПараметр("НачалоГода", ДатаПодоходного);
			иначе
				Запрос.УстановитьПараметр("НачалоГода", НачалоГода(ПериодРегистрации));
			КонецЕсли;
			Запрос.УстановитьПараметр("Организация", Организация);
			Запрос.УстановитьПараметр("ФизЛицо", ДанныеНДФЛ.ФизЛицо);
			
			РезультатЗапроса = Запрос.Выполнить();
			
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			Сумма641ПоНДФЛДоходы = 0;
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				Сумма641ПоНДФЛДоходы = ?(ВыборкаДетальныеЗаписи.СуммаВычетаОборот = Null,0,ВыборкаДетальныеЗаписи.СуммаВычетаОборот);
			КонецЦикла;
			
			Вычеты641СтрахОстаток = ДанныеНДФЛ.Вычет641СтрахОстаток - УжеПрименили641Страх;
			Если ДоходЗаПериодДляВычета > 0 тогда
				Если  Вычеты641СтрахОстаток > ДоходЗаПериодДляВычета тогда
					ВычетыПримененные641СтрахЗаМесяц = ДоходЗаПериодДляВычета;
				Иначе
					ВычетыПримененные641СтрахЗаМесяц = Вычеты641СтрахОстаток;
				КонецЕсли;
			КонецЕсли;
			
			ДоходЗаПериодДляВычета = ДоходЗаПериодДляВычета - ВычетыПримененные641СтрахЗаМесяц;
			Если ДоходЗаПериодДляВычета < 0 Тогда
				ДоходЗаПериодДляВычета = 0;
			КонецЕсли;
			//СВЭЙ 05.12.2023 КВВ СВФР-011932 )
			
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	СУММА(НДФЛСведенияОДоходах.СуммаВычета) КАК СуммаВычетаОборот
			|ИЗ
			|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|ГДЕ
			|	НДФЛСведенияОДоходах.КодВычета = &КодДохода
			|	И НДФЛСведенияОДоходах.Организация = &Организация
			|	И НДФЛСведенияОДоходах.ФизЛицо = &ФизЛицо
			|	И НДФЛСведенияОДоходах.Период МЕЖДУ &НачалоГода И &парамКонецМесяцаНалоговогоПериода";
			
			Запрос.УстановитьПараметр("КодДохода", Справочники.ВычетыНДФЛ.Код640страх);
			Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ДанныеНДФЛ.Период)); 
			Если ДатаПодоходного >  НачалоГода(ПериодРегистрации) Тогда
				Запрос.УстановитьПараметр("НачалоГода", ДатаПодоходного);
			иначе
				Запрос.УстановитьПараметр("НачалоГода", НачалоГода(ПериодРегистрации));
			КонецЕсли;
			Запрос.УстановитьПараметр("Организация", Организация);
			Запрос.УстановитьПараметр("ФизЛицо", ДанныеНДФЛ.ФизЛицо);
			
			РезультатЗапроса = Запрос.Выполнить();
			
			ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			Сумма640ПоНДФЛДоходы = 0;
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
				Сумма640ПоНДФЛДоходы = ?(ВыборкаДетальныеЗаписи.СуммаВычетаОборот = Null,0,ВыборкаДетальныеЗаписи.СуммаВычетаОборот);
			КонецЦикла;
			//О.Т. Аверсон 23.01.2018 № 1467
			
			ОстатокПослеПрименения640 = ОграничениеНДФЛ-УжеПрименили640Страх-сумма640ПоНДФЛДоходы;
			
			Вычеты640СтрахОстаток = ДанныеНДФЛ.Вычет640СтрахОстаток - УжеПрименили640Страх;
			Если Вычеты640СтрахОстаток > ОстатокПослеПрименения640 Тогда
				Вычеты640СтрахОстаток = ОстатокПослеПрименения640;
			КонецЕсли;
			Если ДоходЗаПериодДляВычета > 0 тогда
				Если  Вычеты640СтрахОстаток > ДоходЗаПериодДляВычета тогда
					Если ДоходЗаПериодДляВычета > ОграничениеНДФЛ тогда
						ВычетыПримененные640СтрахЗаМесяц = ОграничениеНДФЛ;
					Иначе
						ВычетыПримененные640СтрахЗаМесяц = ДоходЗаПериодДляВычета;
					КонецЕсли;
				Иначе
					Если Вычеты640СтрахОстаток > ОграничениеНДФЛ тогда
						ВычетыПримененные640СтрахЗаМесяц = ОграничениеНДФЛ;
					Иначе
						ВычетыПримененные640СтрахЗаМесяц = Вычеты640СтрахОстаток;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
			//СВЭЙ 05.12.2023 КВВ СВФР-011932 (
			ДоходЗаПериодДляВычета = ДоходЗаПериодДляВычета - ВычетыПримененные640СтрахЗаМесяц; 
			Если ДоходЗаПериодДляВычета < 0 Тогда
				ДоходЗаПериодДляВычета = 0;
			КонецЕсли;
			//СВЭЙ 05.12.2023 КВВ СВФР-011932 )
			
			//КонецЕсли;
			//Островская Татьяна 09.03.2014 № 17170
			
			//СВЭЙ 05.12.2023 КВВ СВФР-011932 (перенесено выше) (
			////Аверсон 03.08.2023 КВВ СВФР-011182 (
			//Запрос = Новый Запрос;
			//Запрос.Текст = 
			//"ВЫБРАТЬ
			//|	СУММА(НДФЛСведенияОДоходах.СуммаВычета) КАК СуммаВычетаОборот
			//|ИЗ
			//|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			//|ГДЕ
			//|	НДФЛСведенияОДоходах.КодВычета = &КодДохода
			//|	И НДФЛСведенияОДоходах.Организация = &Организация
			//|	И НДФЛСведенияОДоходах.ФизЛицо = &ФизЛицо
			//|	И НДФЛСведенияОДоходах.Период МЕЖДУ &НачалоГода И &парамКонецМесяцаНалоговогоПериода";
			//
			//Запрос.УстановитьПараметр("КодДохода", Справочники.ВычетыНДФЛ.Код641страх);
			//Запрос.УстановитьПараметр("парамКонецМесяцаНалоговогоПериода", КонецМесяца(ДанныеНДФЛ.Период)); 
			//Если ДатаПодоходного >  НачалоГода(ПериодРегистрации) Тогда
			//	Запрос.УстановитьПараметр("НачалоГода", ДатаПодоходного);
			//иначе
			//	Запрос.УстановитьПараметр("НачалоГода", НачалоГода(ПериодРегистрации));
			//КонецЕсли;
			//Запрос.УстановитьПараметр("Организация", Организация);
			//Запрос.УстановитьПараметр("ФизЛицо", ДанныеНДФЛ.ФизЛицо);
			//
			//РезультатЗапроса = Запрос.Выполнить();
			//
			//ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
			//Сумма641ПоНДФЛДоходы = 0;
			//Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			//	Сумма641ПоНДФЛДоходы = ?(ВыборкаДетальныеЗаписи.СуммаВычетаОборот = Null,0,ВыборкаДетальныеЗаписи.СуммаВычетаОборот);
			//КонецЦикла;
			//
			////ОстатокПослеПрименения641 = ОграничениеНДФЛ-УжеПрименили641Страх-сумма641ПоНДФЛДоходы;
			//
			//Вычеты641СтрахОстаток = ДанныеНДФЛ.Вычет641СтрахОстаток - УжеПрименили641Страх;
			////Если Вычеты641СтрахОстаток > ОстатокПослеПрименения641 Тогда
			////	Вычеты641СтрахОстаток = ОстатокПослеПрименения641;
			////КонецЕсли;
			//Если ДоходЗаПериодДляВычета > 0 тогда
			//	Если  Вычеты641СтрахОстаток > ДоходЗаПериодДляВычета тогда
			//	//	Если ДоходЗаПериодДляВычета > ОграничениеНДФЛ тогда
			//	//		ВычетыПримененные641СтрахЗаМесяц = ОграничениеНДФЛ;
			//	//	Иначе
			//			ВычетыПримененные641СтрахЗаМесяц = ДоходЗаПериодДляВычета;
			//	//	КонецЕсли;
			//	Иначе
			//	//	Если Вычеты641СтрахОстаток > ОграничениеНДФЛ тогда
			//	//		ВычетыПримененные641СтрахЗаМесяц = ОграничениеНДФЛ;
			//	//	Иначе
			//			ВычетыПримененные641СтрахЗаМесяц = Вычеты641СтрахОстаток;
			//	//	КонецЕсли;
			//	КонецЕсли;
			//КонецЕсли;
			////Аверсон 03.08.2023 КВВ СВФР-011182 )
			//СВЭЙ 05.12.2023 КВВ СВФР-011932 (перенесено выше) )
			
			Вычеты312Остаток = ДанныеНДФЛ.Вычет312Остаток - УжеПрименили312;
			Если ДоходЗаПериодДляВычета > 0 тогда
				//Если  Вычеты312Остаток > ДоходЗаПериодДляВычета - ВычетыПримененные640СтрахЗаМесяц - ВычетыПримененные641СтрахЗаМесяц тогда  //Аверсон 03.08.2023 КВВ СВФР-011182
				
				//СВЭЙ 05.12.2023 КВВ СВФР-011932 (
				//Если Вычеты312Остаток <> 0 И Вычеты312Остаток > ДоходЗаПериодДляВычета - ВычетыПримененные640СтрахЗаМесяц - ВычетыПримененные641СтрахЗаМесяц тогда //СВЭЙ 05.12.2023 КВВ СВФР-011932
				//ВычетыПримененные312ЗаМесяц = ДоходЗаПериодДляВычета - ВычетыПримененные640СтрахЗаМесяц - ВычетыПримененные641СтрахЗаМесяц ; //Аверсон 03.08.2023 КВВ СВФР-011182
				
				Если Вычеты312Остаток <> 0 И Вычеты312Остаток > ДоходЗаПериодДляВычета тогда //СВЭЙ 05.12.2023 КВВ СВФР-011932
					ВычетыПримененные312ЗаМесяц = ДоходЗаПериодДляВычета ;
					//СВЭЙ 05.12.2023 КВВ СВФР-011932 )
				Иначе
					ВычетыПримененные312ЗаМесяц = Вычеты312Остаток;
				КонецЕсли;
			КонецЕсли;
			
			//СВЭЙ 05.12.2023 КВВ СВФР-011932 (
			ДоходЗаПериодДляВычета = ДоходЗаПериодДляВычета - ВычетыПримененные312ЗаМесяц; 
			Если ДоходЗаПериодДляВычета < 0 Тогда
				ДоходЗаПериодДляВычета = 0;
			КонецЕсли;
			//СВЭЙ 05.12.2023 КВВ СВФР-011932 )
			
			//О.Т. Аверсон 23.08.2016 № 
			Если ДанныеНДФЛ.Период = Дата(2016,07,01) Тогда 
				УжеПрименили311 = ОбщегоНазначения.ОкруглитьЗначение2016(УжеПрименили311/10000,ПериодРегистрации);
			КонецЕсли;
			
			
			Вычеты311Остаток = ДанныеНДФЛ.Вычет311Остаток - УжеПрименили311;
			Если ДоходЗаПериодДляВычета > 0 тогда
				//Если  Вычеты311Остаток > ДоходЗаПериодДляВычета - ВычетыПримененные312ЗаМесяц - ВычетыПримененные640СтрахЗаМесяц - ВычетыПримененные641СтрахЗаМесяц тогда //Аверсон 03.08.2023 КВВ СВФР-011182
				
				//СВЭЙ 05.12.2023 КВВ СВФР-011932 (
				//Если Вычеты311Остаток <> 0 И Вычеты311Остаток > ДоходЗаПериодДляВычета - ВычетыПримененные312ЗаМесяц - ВычетыПримененные640СтрахЗаМесяц - ВычетыПримененные641СтрахЗаМесяц тогда //СВЭЙ 05.12.2023 КВВ СВФР-011932
				//	ВычетыПримененные311ЗаМесяц = ДоходЗаПериодДляВычета - ВычетыПримененные312ЗаМесяц - ВычетыПримененные640СтрахЗаМесяц - ВычетыПримененные641СтрахЗаМесяц; //Аверсон 03.08.2023 КВВ СВФР-011182
				Если Вычеты311Остаток <> 0 И Вычеты311Остаток > ДоходЗаПериодДляВычета  тогда 
					ВычетыПримененные311ЗаМесяц = ДоходЗаПериодДляВычета ; 
					//СВЭЙ 05.12.2023 КВВ СВФР-011932 )
					
				Иначе
					//если  Вычеты311Остаток = 0 Тогда 
					//	если Год(ДанныеНДФЛ.Период) <>  Год(ГодПредыдущий) Тогда 
					//		ВычетыПримененные311ЗаМесяц = ДоходЗаПериодДляВычета - ВычетыПримененные312ЗаМесяц - ВычетыПримененные640СтрахЗаМесяц;
					//	иначе
					//		
					//		ВычетыПримененные311ЗаМесяц = Вычеты311Остаток;
					//	КонецЕсли;
					//иначе
					ВычетыПримененные311ЗаМесяц = Вычеты311Остаток;
					//КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			ГодПредыдущий = ДанныеНДФЛ.Период;
			//если ДанныеНДФЛ.Период = ПериодРегистрации Тогда //О.Т. 08.04.2015 убрано условие, не срабатывало. Не попадала сумма, сформированная в прошл.мес за тек.период
			//	ВычетыПримененные311Мес = ВычетыПримененные311ЗаМесяц -  ДанныеНДФЛ.РанееПримененныеВычеты311ЗаМесяц;
			//Иначе 
			ВычетыПримененные311Мес = ВычетыПримененные311ЗаМесяц;
			//КонецЕсли;
			
			Если ДанныеНДФЛ.Резидент Тогда
				//О.Т. Аверсон 19.05.2016 № 1173 Подохдный считать по периодам, а не с накоплением за год
				//НалогИсчисленный = ((ДанныеНДФЛ.ДоходЗаГод - ДанныеНДФЛ.ПримененныеВычетыЛичные - ДанныеНДФЛ.ПримененныеВычетыДетские - ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьгота - ДанныеНДФЛ.ПримененныеВычетыДополнительные - (ВычетыПримененные640СтрахЗаМесяц + УжеПрименили640Страх) - (ВычетыПримененные312ЗаМесяц + УжеПрименили312) - (ВычетыПримененные311Мес + УжеПрименили311))*?(ПериодРегистрации<Дата(2016,07,1),ОКР(?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,Шкала[0].Налог)/100,2,0),ОбщегоНазначения.ОкруглитьЗначение2016(?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,Шкала[0].Налог)/100,ПериодРегистрации,0)) - ДанныеНДФЛ.НалогРанееИсчисленный) - УжеИсчислили;//О.Т. Аверсон 15.03.2016 № 949
				НалогИсчисленный = (ОбщегоНазначения.ОкруглитьПоВалюте((ДанныеНДФЛ.ДоходЗаПериод - ДанныеНДФЛ.ПримененныеВычетыЛичныеЗаПериод - ДанныеНДФЛ.ПримененныеВычетыДетскиеЗаПериод - ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьготаЗаПериод - ДанныеНДФЛ.ПримененныеВычетыДополнительныеЗаПериод  - ДанныеНДФЛ.ПримененныеВычетыМолодыеСпециалистыЗаПериод - ВычетыПримененные640СтрахЗаМесяц - ВычетыПримененные641СтрахЗаМесяц - ВычетыПримененные312ЗаМесяц - ВычетыПримененные311Мес)*?(ПериодРегистрации<Дата(2016,07,1),ОКР(?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,Шкала[0].Налог)/100,2,0),?(ЕстьИндивидСтавка,СтавкаНДФЛИнд,Шкала[0].Налог)/100),Константы.ВалютаРегламентированногоУчета.Получить()) - ДанныеНДФЛ.НалогРанееИсчисленный); //Аверсон 03.08.2023 КВВ СВФР-011182 //Аверсон ЕАЕ 12.01.2024 СВФР-012095
				//О.Т. Аверсон 19.05.2016 № 1173
				
				Если ДанныеНДФЛ.ДоходЗаПериод = ДанныеНДФЛ.ПримененныеВычетыЛичныеЗаПериод и ДанныеНДФЛ.ДоходЗаПериод <> 0 Тогда 
					Сообщить(СокрЛП(ДанныеНДФЛ.Физлицо.Наименование) + ": проверьте расчет подоходного налога, вычеты = доходу! Сумма подоходного налога 0 руб.");
				КонецЕсли;
				
				//О.Т. Аверсон 25.05.2016 № 1187
				если ПериодРегистрации >= Дата(2016,07,01) Тогда 
					если ДанныеНДФЛ.Период < Дата(2016,07,01) и ДанныеНДФЛ.ПримененныеВычетыЛичныеЗаПериод = 0 и ДанныеНДФЛ.ПримененныеВычетыДетскиеЗаПериод = 0 и 
						ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьготаЗаПериод = 0 и  ДанныеНДФЛ.ПримененныеВычетыДополнительныеЗаПериод = 0 и  ДанныеНДФЛ.ПримененныеВычетыМолодыеСпециалистыЗаПериод = 0 и  ВычетыПримененные640СтрахЗаМесяц = 0 и ВычетыПримененные641СтрахЗаМесяц = 0 и //Аверсон 03.08.2023 КВВ СВФР-011182 //Аверсон ЕАЕ 12.01.2024 СВФР-012095
						ВычетыПримененные312ЗаМесяц = 0 и  ВычетыПримененные311Мес = 0 Тогда
						НалогИсчисленный = 0;
					КонецЕсли;  					
				КонецЕсли;
				//О.Т. Аверсон 25.05.2016 № 1187
				
				//УжеИсчислили = УжеИсчислили + НалогИсчисленный;//О.Т. 07.07.2014 № 108 по периоду не отнимается предыдущие месяца
				НалогИсчисленный = ОбщегоНазначения.ОкруглитьПоВалюте(ОбщегоНазначения.ОкруглитьЗначение2016(НалогИсчисленный,ДанныеНДФЛ.Период),Константы.ВалютаРегламентированногоУчета.Получить());
				//заявка №1735 (база заявок Кристалла) Дмитрук О.Г.			
				//НалогИсчисленный = ?(НалогИсчисленный < 0,0,НалогИсчисленный);
				НалогИсчисленный = НалогИсчисленный;
				//заявка №1735						
			Иначе
				НалогИсчисленный = ДанныеНДФЛ.НалогИсчисленный;
				//О.Т. Аверсон 25.05.2016 № 1187
				если ПериодРегистрации >= Дата(2016,07,01) Тогда 
					если ДанныеНДФЛ.Период < Дата(2016,07,01) Тогда
						НалогИсчисленный = 0;
					КонецЕсли;  					
				КонецЕсли;
				//О.Т. Аверсон 25.05.2016 № 1187
				УжеИсчислили = УжеИсчислили + НалогИсчисленный;//О.Т. 07.07.2014 № 108
			КонецЕсли;
			
			ВычетыПримененные640Страх = Мин(ВычетыПримененные640СтрахЗаМесяц - ДанныеНДФЛ.РанееПримененныеВычеты640СтрахЗаМесяц,ОграничениеНДФЛ-ДанныеНДФЛ.РанееПримененныеВычеты640СтрахЗаМесяц); //Островская Татьяна 11.03.2014 № 17170
			
			Если ДанныеНДФЛ.Период = Дата(2016,07,01) Тогда //О.Т.20160817
				если ОбщегоНазначения.ОкруглитьЗначение2016(УжеПрименили640Страх / 10000,ПериодРегистрации) >= ОграничениеНДФЛ Тогда 
					ВычетыПримененные640Страх = 0;
				КонецЕсли;
			иначе
				если УжеПрименили640Страх >= ОграничениеНДФЛ Тогда 
					ВычетыПримененные640Страх = 0;
				КонецЕсли;
			КонецЕсли;
			
			//Аверсон 03.08.2023 КВВ СВФР-011182 (
			ВычетыПримененные641Страх = Мин(ВычетыПримененные641СтрахЗаМесяц - ДанныеНДФЛ.РанееПримененныеВычеты641СтрахЗаМесяц,ОграничениеНДФЛ-ДанныеНДФЛ.РанееПримененныеВычеты641СтрахЗаМесяц); 
			//Если УжеПрименили641Страх >= ОграничениеНДФЛ Тогда 
			//	ВычетыПримененные641Страх = 0;
			//КонецЕсли;
			//Аверсон 03.08.2023 КВВ СВФР-011182 )
			
			//Островская Татьяна 27.03.2014 № 17170
			ВычетыПримененные312 = ВычетыПримененные312ЗаМесяц - ДанныеНДФЛ.РанееПримененныеВычеты312ЗаМесяц;
			ВычетыПримененные311 = ВычетыПримененные311ЗаМесяц - ДанныеНДФЛ.РанееПримененныеВычеты311ЗаМесяц;
			
			// Запомним суммы для следующей итерации
			//УжеИсчислили = УжеИсчислили + НалогИсчисленный;
			УжеПрименилиЛичный = УжеПрименилиЛичный + ВычетыПримененныеЛичный;
			УжеПрименилиДетский = УжеПрименилиДетский + ВычетыПримененныеДетский;
			УжеПрименилиДетскийЛьгота = УжеПрименилиДетскийЛьгота + ВычетыПримененныеДетскийЛьгота;
			УжеПрименилиДополнительный = УжеПрименилиДополнительный + ВычетыПримененныеДополнительный;
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			УжеПрименилиМолодыеСпециалисты = УжеПрименилиМолодыеСпециалисты + ВычетыПримененныеМолодыеСпециалисты;
			//Аверсон СВФР-012095
			
			УжеПрименили312 = УжеПрименили312 + ВычетыПримененные312ЗаМесяц;
			
			//О.Т. Аверсон 21.09.2016 № 1454
			Запрос = Новый Запрос;
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	НДФЛСведенияОДоходах.СуммаДохода КАК СуммаДоходаОборот,
			|	НДФЛСведенияОДоходах.СуммаВычета КАК СуммаВычетаОборот
			|ИЗ
			|	РегистрНакопления.НДФЛСведенияОДоходах КАК НДФЛСведенияОДоходах
			|ГДЕ
			|	НДФЛСведенияОДоходах.Организация = &парамОрганизация
			|	И НДФЛСведенияОДоходах.КодДохода.СтавкаНалогообложенияРезидента = &парамСтавка13
			|	И НДФЛСведенияОДоходах.Период < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|	И НДФЛСведенияОДоходах.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0)
			|	И НДФЛСведенияОДоходах.ФизЛицо = &ФизЛицо
			|	И НДФЛСведенияОДоходах.Период МЕЖДУ &Период И &Период1";
			
			Запрос.УстановитьПараметр("парамОрганизация", Организация);
			Запрос.УстановитьПараметр("ФизЛицо", ДанныеНДФЛ.ФизЛицо); 
			Запрос.УстановитьПараметр("Период", НачалоМесяца(ДанныеНДФЛ.Период)); 
			Запрос.УстановитьПараметр("Период1", КонецМесяца(ДанныеНДФЛ.Период));
			Запрос.УстановитьПараметр("парамСтавка13", Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13);  			
			РезультатЗапроса = Запрос.Выполнить().Выбрать();
			
			Пока РезультатЗапроса.Следующий() Цикл
				//ВычетыПримененные311ЗаМесяц = ВычетыПримененные311ЗаМесяц - РезультатЗапроса.СуммаДоходаОборот + (РезультатЗапроса.СуммаДоходаОборот*10000);
				ВычетыПримененные311ЗаМесяц = ВычетыПримененные311ЗаМесяц + РезультатЗапроса.СуммаВычетаОборот - (РезультатЗапроса.СуммаВычетаОборот*10000);
			КонецЦикла;
			//О.Т. Аверсон 21.09.2016 № 1454
			
			УжеПрименили311 = УжеПрименили311 + ВычетыПримененные311ЗаМесяц;
			УжеПрименили640Страх = УжеПрименили640Страх + ВычетыПримененные640СтрахЗаМесяц;
			
			УжеПрименили641Страх = УжеПрименили641Страх + ВычетыПримененные641СтрахЗаМесяц; //Аверсон 03.08.2023 КВВ СВФР-011182
			
			// рассчитаем сумму вычетов, которую нужно перераспеределить во избежание применения 
			// отрицательных вычетов за месяц
			//	КПерераспределению = Мин(ВычетыПримененныеЛичный + ДанныеНДФЛ.РанееПримененныеВычетыЛичныеЗаМесяц, 0) +
			//						 Мин(ВычетыПримененныеДетский  + ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЗаМесяц, 0) +
			//						 Мин(ВычетыПримененныеДетскийЛьгота  + ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЛьготаЗаМесяц, 0) +
			//						 Мин(ВычетыПримененныеДополнительный + ДанныеНДФЛ.РанееПримененныеВычетыДополнительныеЗаМесяц, 0) +
			//						 Мин(ВычетыПримененные312 + ДанныеНДФЛ.РанееПримененныеВычеты312ЗаМесяц, 0) +
			//						 Мин(ВычетыПримененные311 + ДанныеНДФЛ.РанееПримененныеВычеты311ЗаМесяц, 0);
			//
			// если нужно - второй проход для перераспеределения примененных вычетов
			//Если КПерераспределению < 0 Тогда
			//	
			//	ВычетыПримененныеЛичный = Макс(ДанныеНДФЛ.ПримененныеВычетыЛичные - ДанныеНДФЛ.РанееПримененныеВычетыЛичные - УжеПрименилиЛичный + КПерераспределению, -ДанныеНДФЛ.РанееПримененныеВычетыЛичныеЗаМесяц);
			//	Перераспределено = ВычетыПримененныеЛичный - (ДанныеНДФЛ.ПримененныеВычетыЛичные - ДанныеНДФЛ.РанееПримененныеВычетыЛичные - УжеПрименилиЛичный);
			//	КПерераспределению = КПерераспределению - Перераспределено;
			//  				
			//	ВычетыПримененныеДетский = Макс(ДанныеНДФЛ.ПримененныеВычетыДетские - ДанныеНДФЛ.РанееПримененныеВычетыДетские - УжеПрименилиДетский + КПерераспределению, -ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЗаМесяц);
			//	Перераспределено = ВычетыПримененныеДетский - (ДанныеНДФЛ.ПримененныеВычетыДетские - ДанныеНДФЛ.РанееПримененныеВычетыДетские - УжеПрименилиДетский);
			//	КПерераспределению = КПерераспределению - Перераспределено;
			//	
			//	ВычетыПримененныеДетскийЛьгота = Макс(ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьгота - ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЛьгота - УжеПрименилиДетскийЛьгота + КПерераспределению, -ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЛьготаЗаМесяц);
			//	Перераспределено = ВычетыПримененныеДетскийЛьгота - (ДанныеНДФЛ.ПримененныеВычетыДетскиеЛьгота - ДанныеНДФЛ.РанееПримененныеВычетыДетскиеЛьгота - УжеПрименилиДетскийЛьгота);
			//	КПерераспределению = КПерераспределению - Перераспределено;
			//	
			//	ВычетыПримененныеДополнительный = Макс(ДанныеНДФЛ.ПримененныеВычетыДополнительные - ДанныеНДФЛ.РанееПримененныеВычетыДополнительные - УжеПрименилиДополнительный + КПерераспределению, -ДанныеНДФЛ.РанееПримененныеВычетыДополнительныеЗаМесяц);
			//	Перераспределено = ВычетыПримененныеДополнительный - (ДанныеНДФЛ.ПримененныеВычетыДополнительные - ДанныеНДФЛ.РанееПримененныеВычетыДополнительные - УжеПрименилиДополнительный);
			//	КПерераспределению = КПерераспределению - Перераспределено;
			//	
			//	ВычетыПримененные312 = Макс(ДанныеНДФЛ.ПримененныеВычеты312 - ДанныеНДФЛ.РанееПримененныеВычеты312 - УжеПрименили312 + КПерераспределению, -ДанныеНДФЛ.РанееПримененныеВычеты312ЗаМесяц);
			//	Перераспределено = ВычетыПримененные312 - (ДанныеНДФЛ.ПримененныеВычеты312 - ДанныеНДФЛ.РанееПримененныеВычеты312 - УжеПрименили312);
			//	КПерераспределению = КПерераспределению - Перераспределено;
			//	
			//	ВычетыПримененные311 = Макс(ДанныеНДФЛ.ПримененныеВычеты311 - ДанныеНДФЛ.РанееПримененныеВычеты311 - УжеПрименили311 + КПерераспределению, -ДанныеНДФЛ.РанееПримененныеВычеты311ЗаМесяц);
			//	Перераспределено = ВычетыПримененные311 - (ДанныеНДФЛ.ПримененныеВычеты311 - ДанныеНДФЛ.РанееПримененныеВычеты311 - УжеПрименили311);
			//	КПерераспределению = КПерераспределению - Перераспределено;
			//КонецЕсли;
			
			Если	НалогИсчисленный = 0 и 
				ВычетыПримененныеЛичный = 0 и 
				ВычетыПримененныеДетский = 0 и 
				ВычетыПримененныеДетскийЛьгота = 0 и
				ВычетыПримененныеДополнительный = 0 и
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				ВычетыПримененныеМолодыеСпециалисты = 0 и
				//Аверсон СВФР-012095
				
				ВычетыПримененные640Страх = 0 и
				ВычетыПримененные641Страх = 0 и  //Аверсон 03.08.2023 КВВ СВФР-011182
				ВычетыПримененные312 = 0 и 
				ВычетыПримененные311 = 0 Тогда
				Продолжить;
			КонецЕсли;
			
			
			// Если передан набор записей - заполняем и его
			Если НаборЗаписей <> Неопределено Тогда
				// зарегистрируем в регистре
				Движение = НаборЗаписей.Добавить();
				
				// Свойства
				Движение.ВидДвижения				= ВидДвиженияНакопления.Приход;
				Движение.Период						= КонецМесяца(ПериодРегистрации);
				
				// Измерения
				Движение.Организация	 	   		= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
				Движение.ФизЛицо	 	 	  		= ДанныеНДФЛ.ФизЛицо;
				Движение.МесяцНалоговогоПериода			= ДанныеНДФЛ.Период;
				Движение.СтавкаНалогообложенияРезидента	= Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13;
				
				// Ресурсы
				Движение.Налог						= ОбщегоНазначения.ОкруглитьПоВалюте(НалогИсчисленный,Константы.ВалютаРегламентированногоУчета.Получить());
				Движение.ПримененныйВычетЛичный		= ВычетыПримененныеЛичный;
				Движение.ПримененныйВычетНаДетей	= ВычетыПримененныеДетский;
				Движение.ПримененныйВычетНаДетейЛьгота = ВычетыПримененныеДетскийЛьгота;
				Движение.ПримененныйВычетДополнительный		= ВычетыПримененныеДополнительный;
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				Движение.ПримененныйВычетМолодыеСпециалисты		= ВычетыПримененныеМолодыеСпециалисты;
				//Аверсон СВФР-012095
				
				// Реквизиты 
				Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
				Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
				Движение.ИсчисленоИзЗарплаты	= Истина;	
			КонецЕсли;
			
			// Ниже - заполняем табличную часть документа
			Если Перерасчет Тогда
				СтруктураПоиска.Физлицо = ДанныеНДФЛ.ФизЛицо;
				СтруктураПоиска.МесяцНалоговогоПериода = ДанныеНДФЛ.Период;
				Строки = НДФЛ.НайтиСтроки(СтруктураПоиска);
				Если Строки.Количество() > 0 Тогда
					Строка = Строки[0];
				Иначе
					Строка = НДФЛ.Добавить();
				КонецЕсли;
			Иначе
				Если РасчетПоФизлицу Тогда
					Строка = НДФЛ.Вставить(ИндексСтрокиТаблицыНДФЛ);
					ИндексСтрокиТаблицыНДФЛ = ИндексСтрокиТаблицыНДФЛ+1;
				Иначе
					Строка = НДФЛ.Добавить();
				КонецЕсли;
			КонецЕсли;
			РаботникиДляРасчетаНДФЛ.Удалить(ДанныеНДФЛ.ФизЛицо);
			
			ЗаполнитьЗначенияСвойств(СтруктураПоискаПодразделения,ДанныеНДФЛ);
			
			//Аверсон 18.03.2023 КВВ СВФР-010532 (
			Если ДоговорыНаВыполнениеРабот.Количество() > 0 И Начисления.Количество() = 0 И ДополнительныеНачисления.Количество() = 0 Тогда
				Строка.ПодразделениеОрганизации	= Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
				ОтборДП = Новый Структура("Физлицо",ДанныеНДФЛ.ФизЛицо);    
				НайденноеЗначениеДП = ДоговорыНаВыполнениеРабот.НайтиСтроки(ОтборДП);
				Если НайденноеЗначениеДП.Количество() > 0 Тогда
					Строка.ПодразделениеОрганизации	= НайденноеЗначениеДП[0].ПодразделениеОрганизации; 
				КонецЕсли;
			Иначе
				//Аверсон 18.03.2023 КВВ СВФР-010532 )
				
				ВыборкаПодразделений.Сбросить();
				Если ВыборкаПодразделений.НайтиСледующий(СтруктураПоискаПодразделения) Тогда
					Строка.ПодразделениеОрганизации	= ВыборкаПодразделений.ПодразделениеОрганизации;
				КонецЕсли;
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
			//	Запрос = Новый Запрос;
			//	Запрос.Текст =
			//	"ВЫБРАТЬ
			//	|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
			//	|	СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней,
			//	|	РабочееВремяРаботниковОрганизаций.Сотрудник
			//	|ИЗ
			//	|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
			//	|ГДЕ
			//	|	(РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени
			//	|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &ВидИспользованияРабочегоВремени2)
			//	|	И РабочееВремяРаботниковОрганизаций.Период >= &Период
			//	|	И РабочееВремяРаботниковОрганизаций.Период <= &Период2
			//	|	И РабочееВремяРаботниковОрганизаций.Сотрудник.Физлицо = &Сотрудник
			//	|
			//	|СГРУППИРОВАТЬ ПО
			//	|	РабочееВремяРаботниковОрганизаций.Сотрудник";
			//	Запрос.УстановитьПараметр("Сотрудник", ДанныеНДФЛ.ФизЛицо);
			//	Запрос.УстановитьПараметр("Период", ПериодРегистрации);
			//	Запрос.УстановитьПараметр("Период2", КонецМесяца(ПериодРегистрации));
			//	Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
			//	Запрос.УстановитьПараметр("ВидИспользованияРабочегоВремени2", Справочники.КлассификаторИспользованияРабочегоВремени.НеоплачиваемыйОтпускПоРазрешениюРаботодателя);
			//
			//	Выборка = Запрос.Выполнить().Выбрать();
			//	Пока Выборка.Следующий() цикл
			//		мОтработаноЧас = Выборка.Часов;
			//		мОтработаноЧасов = Выборка.Дней;
			//	КонецЦикла;
			
			Строка.ФизЛицо 						= ДанныеНДФЛ.ФизЛицо;
			//если (не ЗначениеЗаполнено(мОтработаноЧас) и не ЗначениеЗаполнено(мОтработаноЧасов)) и ТипЗнч(ВыборкаПоШапкеДокумента.Ссылка) = Тип("ДокументСсылка.НачислениеЗарплатыРаботникамОрганизаций") тогда
			//	Строка.Налог   						= 0;
			//	Строка.ПримененныйВычетЛичный		= 0;
			//	Строка.ПримененныйВычетНаДетей		= 0;
			//	Строка.ПримененныйВычетНаДетейЛьгота	= 0;
			//	Строка.ПримененныйВычетДополнительный   = 0;
			//	Строка.ПримененныйВычетИмущественныйРасход		= 0;
			//	Строка.ПримененныйВычетСоциальныйСПроцентами		= 0;
			//	Строка.ПримененныйВычетСтраховойРасход		= 0;
			//иначе
			//Аверсон-софт, Островская Татьяна 28.03.2012 № 15113
			Строка.Налог   						= ОбщегоНазначения.ОкруглитьПоВалюте(НалогИсчисленный,Константы.ВалютаРегламентированногоУчета.Получить());
			Строка.ПримененныйВычетЛичный		= ВычетыПримененныеЛичный;
			Строка.ПримененныйВычетНаДетей		= ВычетыПримененныеДетский;
			Строка.ПримененныйВычетНаДетейЛьгота	= ВычетыПримененныеДетскийЛьгота;
			Строка.ПримененныйВычетДополнительный   = ВычетыПримененныеДополнительный;
			
			//Аверсон ЕАЕ 12.01.2024 СВФР-012095
			Строка.ПримененныйВычетМолодыеСпециалисты   = ВычетыПримененныеМолодыеСпециалисты;
			//Аверсон СВФР-012095
			
			Строка.ПримененныйВычетИмущественныйРасход		= ВычетыПримененные311;
			Строка.ПримененныйВычетСоциальныйСПроцентами		= ВычетыПримененные312;
			Строка.ПримененныйВычетСтраховойРасход		= ВычетыПримененные640Страх;
			//КонецЕсли;
			Строка.ПримененныйВычетСтраховойРасход641 = ВычетыПримененные641Страх;//Аверсон 03.08.2023 КВВ СВФР-011182
			Строка.МесяцНалоговогоПериода 		= ДанныеНДФЛ.Период;
			
			Если КомментироватьРасчет Тогда //О.Т. Аверсон 11.05.2018 № 1949 было изначально закоменчено.
				
				КомментарийМесяца = ОбщегоНазначения.КомментарийРасчета("Результат расчета за " + Формат(ДанныеНДФЛ.Период, "ДФ=ММММ") + ": " + НалогИсчисленный, КомментарийНДФЛ);
				Если ДанныеНДФЛ.Резидент Тогда
					ОбщегоНазначения.КомментарийРасчета("Статус: резидент РБ", КомментарийМесяца);
				Иначе
					ОбщегоНазначения.КомментарийРасчета("Статус: не является резидентом РБ", КомментарийМесяца,,, Перечисления.ВидыСообщений.ВажнаяИнформация);
				КонецЕсли;
				КомментарийДохода = ОбщегоНазначения.КомментарийРасчета("Доход за месяц, всего: " + ДанныеНДФЛ.ДоходЗаПериод, КомментарийМесяца,,,, Ложь);
				
				ДоходыПоВидамРасчетов = ДанныеНДФЛ.Выбрать();
				Пока ДоходыПоВидамРасчетов.Следующий() Цикл
					ОбщегоНазначения.КомментарийРасчета("По виду расчета " + ДоходыПоВидамРасчетов.ВидРасчетаНаименование + " " + ДоходыПоВидамРасчетов.ДоходЗаМесяцПоВидамРасчета, КомментарийДохода);
				КонецЦикла;
				КомментарийВычетовСтанд = ОбщегоНазначения.КомментарийРасчета("Примененные стандартные вычеты, всего: " + (ВычетыПримененныеЛичный +ВычетыПримененныеДетский + ВычетыПримененныеДетскийЛьгота + ВычетыПримененныеДополнительный + ВычетыПримененныеМолодыеСпециалисты), КомментарийМесяца); //Аверсон ЕАЕ 12.01.2024 СВФР-012095
				КомментарийВычетов = ОбщегоНазначения.КомментарийРасчета("Примененные имущественный/социальный вычеты, всего: " + (ВычетыПримененные312 + ВычетыПримененные311), КомментарийМесяца);
				Если ВычетыПримененныеЛичный <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный личный вычет: " + ВычетыПримененныеЛичный, КомментарийВычетов);
				КонецЕсли;
				Если ВычетыПримененныеДетский <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный вычет на детей: " + ВычетыПримененныеДетский, КомментарийВычетов);
				КонецЕсли;
				Если ВычетыПримененныеДетскийЛьгота <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный вычет на детей-инвалидов: " + ВычетыПримененныеДетскийЛьгота, КомментарийВычетов);
				КонецЕсли;
				Если ВычетыПримененныеДополнительный <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный вычет на детей-инвалидов: " + ВычетыПримененныеДополнительный, КомментарийВычетов);
				КонецЕсли;
				
				//Аверсон ЕАЕ 12.01.2024 СВФР-012095
				Если ВычетыПримененныеМолодыеСпециалисты <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Примененный вычет молодым специалистам: " + ВычетыПримененныеМолодыеСпециалисты, КомментарийВычетов);
				КонецЕсли;
				//Аверсон СВФР-012095
				
				Если ВычетыПримененные312 <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Вычет имущественный: " + ВычетыПримененные312, КомментарийВычетов);
				КонецЕсли;
				Если ВычетыПримененные311 <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Вычет социальный: " + ВычетыПримененные311, КомментарийВычетов);
				КонецЕсли;
				//КомментарийДохода = ОбщегоНазначения.КомментарийРасчета("Облагаемый доход за налоговый период, всего: " + ОблагаемыйДоходЗаГод, КомментарийМесяца,,,, Ложь);
				//Если ДанныеНДФЛ.РанееНалогИсчисленный <> 0 Тогда
				//	ОбщегоНазначения.КомментарийРасчета("Исчисленный налог нарастающим итогом за год: " + ДанныеНДФЛ.РанееНалогИсчисленный, КомментарийМесяца);
				//КонецЕсли;
				Если ДанныеНДФЛ.ВычетЗаМесяц <> 0 Тогда
					ОбщегоНазначения.КомментарийРасчета("Льготы по доходам: " + ДанныеНДФЛ.ВычетЗаМесяц, КомментарийМесяца);
				КонецЕсли;
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;
	
	// заполним НДФЛ
	Для Каждого Элемент Из РаботникиДляРасчетаНДФЛ Цикл
		НоваяСтрока = НДФЛ.Добавить();
		НоваяСтрока.ФизЛицо = Элемент.Ключ;
		НоваяСтрока.МесяцНалоговогоПериода = НачалоМесяца(ПериодРегистрации);
	КонецЦикла;
	
КонецПроцедуры // ЗаполнитьНаборЗаписейПоДаннымНДФЛ()

// Закрытие строк - ввод значения ДатаОкончания для тех строк у которых не нулевое 
// значение Размер и удаление тех, у кого ВидРасчета - неопределено или ДатаНачала > даты закрытия
// Параметры:
//  ТЗ - таблица значений
//  НезакрытыеСтроки - массив незакрытых строк таблицы значений ТЗ
//  ДатаОкончания - дата, которую нужно проставить в качестве "закрывающей"
//
// Возвращаемое зеначение:
//  нет
//
Процедура ЗакрытьСтроки(ТЗ, НезакрытыеСтроки, ДатаОкончания)
	
	Для Каждого Строка Из НезакрытыеСтроки Цикл
		Если Строка.ВидРасчета = Неопределено ИЛИ Строка.ДатаНачала > ДатаОкончания Тогда
			ТЗ.Удалить(Строка);
			Продолжить; //+ СВЭЙ КДЯ 06.03.20 СВФР-005643
		Иначе	
			//Аверсон 21.05.2020 КВВ СВФР-006029 (
			Если ПроведениеРасчетов.ЭтоРасчетОтСтажа(Строка.ВидРасчета.СпособРасчета) И Строка.ДатаОкончания <> '00010101'	И Строка.ДатаОкончания < НачалоМесяца(Строка.ДатаНачала) Тогда 
				Если Строка.ДатаНачала <> НачалоМесяца(Строка.ДатаНачала) Тогда
					Строка.ДатаОкончания = '00010101';
				Иначе
					ТЗ.Удалить(Строка);
					Продолжить;
				КонецЕсли;
			КонецЕсли;
			//Аверсон 21.05.2020 КВВ СВФР-006029 )
			
			//+ СВЭЙ КДЯ 04.03.20 СВФР-005622
			Если Строка.ДатаОкончания = '00010101' 
				и ТипЗнч( Строка.ВидРасчета ) 
				= Тип( "ПланВидовРасчетаСсылка.ОсновныеНачисленияОрганизаций" ) 
				И НЕ (Строка.ВидРасчета.КатегорияНачисления = Справочники.КатегорииРасчетов.Первичное)Тогда  //Аверсон 24.04.2020 КВВ СВФР-005915
				
				СтрокиОсн = ТЗ.НайтиСтроки( Новый Структура( "Сотрудник, Основное, ДатаНачала",
				Строка.Сотрудник, Истина, Строка.ДатаНачала ) );
				МинДатаОкончания = Макс( ДатаОкончания, Строка.ДатаНачала );
				Для каждого СтрОсн Из СтрокиОсн Цикл
					Если НЕ ЗначениеЗаполнено( СтрОсн.ДатаОкончания ) Тогда
						Продолжить;
					КонецЕсли; 
					МинДатаОкончания = Мин( СтрОсн.ДатаОкончания, МинДатаОкончания );
				КонецЦикла; 
				Строка.ДатаОкончания = МинДатаОкончания;
				//- СВЭЙ КДЯ 04.03.20 СВФР-005622
				
				//+ СВЭЙ КДЯ 04.03.20 СВФР-005622
				//ИначеЕсли Строка.ДатаОкончания = '00010101' или Строка.ДатаОкончания > ДатаОкончания Тогда
				//	Строка.ДатаОкончания = ДатаОкончания;
				//- СВЭЙ КДЯ 04.03.20 СВФР-005622
			КонецЕсли;
		КонецЕсли;
		//+ СВЭЙ КДЯ 04.03.20 СВФР-005622
		Если Строка.ДатаОкончания = '00010101' или Строка.ДатаОкончания > ДатаОкончания Тогда
			Строка.ДатаОкончания = ДатаОкончания;
		КонецЕсли;
		//- СВЭЙ КДЯ 04.03.20 СВФР-005622
	КонецЦикла;
	НезакрытыеСтроки.Очистить();
	
КонецПроцедуры // ЗакрытьСтроки()

// Найти строку в массиве строк по переданному виду расчета или по признаку "Основное"
// Найденная строка и ее индекс возвращаются через переданные параметры Строка и ИндексСтроки
// Параметры:
//  НезакрытыеСтроки - массив строк таблицы значений
//	ПоискОсновного - признак поиска основного начисления
//  ВидРасчета - вид расчета ссылка
//  Строка - в этот параметр будет возвращена строка, начальное значение - Неопределено
//  ИндексСтроки - в этот параметр будет возвращен индекс строки, начальное значение - Неопределено
//
// Возвращаемое зеначение:
//  нет
//
Процедура НайтиСредиНезакрытых(НезакрытыеСтроки, ПоискОсновного, ВидРасчета, Строки, ДатаНачала = Неопределено, СовмещаемаяПрофессия = Неопределено) //Аверсон ЕАЕ 29.09.2021 СВФР-008092 параметр ДатаНачала  //Аверсон ЕАЕ 07.03.2022 СВФР-008825 (СовмещаемаяПрофессия)
	Количество = НезакрытыеСтроки.Количество();
	Для Сч = 1 По Количество Цикл
		Индекс = Количество - Сч;
		
		//Аверсон ЕАЕ 08.03.2022 СВФР-008825
		Если Организация.ИНН = "100071565" Тогда
			Если ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСовмещениеПрофессий Тогда
				Если (ПоискОсновного И НезакрытыеСтроки[Индекс].Основное) 
					ИЛИ (НЕ ПоискОсновного И НезакрытыеСтроки[Индекс].ВидРасчета = ВидРасчета И НезакрытыеСтроки[Индекс].СовмещаемаяПрофессия = СовмещаемаяПрофессия) Тогда
					Строки.Добавить(НезакрытыеСтроки[Индекс]);
				КонецЕсли;
			Иначе
				Если (ПоискОсновного И НезакрытыеСтроки[Индекс].Основное) 
					ИЛИ (НЕ ПоискОсновного И НезакрытыеСтроки[Индекс].ВидРасчета = ВидРасчета) Тогда
					Строки.Добавить(НезакрытыеСтроки[Индекс]);
				КонецЕсли;
			КонецЕсли;
		Иначе
			//Аверсон СВФР-008825
			
			//Аверсон ЕАЕ 29.09.2021 СВФР-008092 (если периоды идут не подряд - не трогаем такие строки)
			Если (ПоискОсновного И НезакрытыеСтроки[Индекс].Основное) 
				ИЛИ (НЕ ПоискОсновного И НезакрытыеСтроки[Индекс].ВидРасчета = ВидРасчета) Тогда
				//Если (ПоискОсновного И НезакрытыеСтроки[Индекс].Основное И ДатаНачала = КонецДня(НезакрытыеСтроки[Индекс].ДатаОкончания) + 1) 
				//	ИЛИ (НЕ ПоискОсновного И НезакрытыеСтроки[Индекс].ВидРасчета = ВидРасчета И ДатаНачала = КонецДня(НезакрытыеСтроки[Индекс].ДатаОкончания) + 1) Тогда
				//Аверсон СВФР-008092
				
				Строки.Добавить(НезакрытыеСтроки[Индекс]);
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры // НайтиСредиНезакрытых()

// Нйти строку в массиве строк по переданному виду расчета и основанию (ссылка на документ)
// Найденная строка и ее индекс возвращаются через переданные параметры Строка и ИндексСтроки
// Параметры:
//  НезакрытыеСтроки - массив строк таблицы значений
//  ВидРасчета - вид расчета ссылка
//  ДокументОснование - документ ссылка
//  Строка - в этот параметр будет возвращена строка, начальное значение - Неопределено
//  ИндексСтроки - в этот параметр будет возвращен индекс строки, начальное значение - Неопределено
//
// Возвращаемое зеначение:
//  нет
//
Процедура НайтиСредиНезакрытыхУдержаний(НезакрытыеСтроки, ВидРасчета, ДокументОснование, Строка, ИндексСтроки)
	Для Индекс = 0 По НезакрытыеСтроки.ВГраница() Цикл
		Если НезакрытыеСтроки[Индекс].ВидРасчета = ВидРасчета И НезакрытыеСтроки[Индекс].ДокументОснование = ДокументОснование Тогда
			ИндексСтроки = Индекс;
			Строка = НезакрытыеСтроки[Индекс];
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры // НайтиСредиНезакрытыхУдержаний()

// Добавляет строку сторно начислений в движения и табличную часть документа
Процедура ДобавитьСтрокуСторно(Движения, ТабличнаяЧасть, Строка)
	
	СтрокаСохраняемыхРеквизитов = "Сотрудник,ФизЛицо,Организация,ВидРасчета,ДатаНачалаСобытия,ВариантОбработкиЗаписиПриОтраженииВРеглУчете," 
	+ "ОбособленноеПодразделение,ПодразделениеОрганизации,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,ВидУчетаВремени,ГрафикРаботы,ГрафикРаботыНорма,"
	+ "ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание,СторнируемыйДокумент";
	// новая запись движений
	Движение = Движения.Добавить();
	
	ЗаполнитьЗначенияСвойств(Движение,Строка,СтрокаСохраняемыхРеквизитов);
	
	// Свойства
	Движение.ПериодРегистрации				= Строка.ПериодРегистрацииСторно;
	Движение.ПериодДействияНачало			= Строка.ПериодДействияНачалоСторно;
	Движение.ПериодДействияКонец			= Строка.ПериодДействияКонецСторно;
	Движение.БазовыйПериодНачало			= Строка.БазовыйПериодНачало;
	Движение.БазовыйПериодКонец				= Строка.БазовыйПериодКонец;
	Движение.Сторно							= Истина;
	Движение.Авторасчет						= Истина;
	
	СтрокаСохраняемыхРеквизитов = "Сотрудник,ФизЛицо,ВидРасчета,ДатаНачалаСобытия," 
	+ "ПодразделениеОрганизации,Показатель1,Показатель2,Показатель3,Показатель4,Показатель5,Показатель6,"
	+ "ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание,СторнируемыйДокумент";
	// новая строка табличной части
	СтрокаТабличнойЧасти = ТабличнаяЧасть.Добавить();
	
	ЗаполнитьЗначенияСвойств(СтрокаТабличнойЧасти,Строка,СтрокаСохраняемыхРеквизитов);
	
	СтрокаТабличнойЧасти.ДатаНачала					= Строка.ПериодДействияНачалоСторно;
	СтрокаТабличнойЧасти.ДатаОкончания				= Строка.ПериодДействияКонецСторно;
	
	СтрокаТабличнойЧасти.Сторно						= Истина;
	СтрокаТабличнойЧасти.Авторасчет					= Истина; 
	
КонецПроцедуры

#Если Клиент Тогда
	
	// Расчерчивает разделы расчетного листка линиями
	//
	// Параметры
	//  ВременныйТабличныйДокумент - Табличный документ с уже выведенными строками расчетного листка
	//  СтрокПропустить - целое число уже обработанных ранее строк т.д.
	//  СтрокРасчертить - целое число строк т.д., которым требуется указать границы
	//
	Процедура РасчертитьРасчетныйЛисток(ВременныйТабличныйДокумент,СтрокПропустить,СтрокРасчертить)
		
		Линия = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		
		Для Сч = 0 По СтрокРасчертить - 1 Цикл
			
			НомерСтроки = СтрокПропустить + Сч;
			
			Для Ссч = 2 По 17 Цикл
				
				Если Ссч = 4 ИЛИ Ссч = 10 ИЛИ Ссч = 13 ИЛИ Ссч = 15 Тогда
					Продолжить
				КонецЕсли; 
				
				ВременныйТабличныйДокумент.Область(НомерСтроки, Ссч).ГраницаСлева = Линия;
				
			КонецЦикла;
			
			ВременныйТабличныйДокумент.Область(НомерСтроки, 15).ГраницаСправа = Линия;
			ВременныйТабличныйДокумент.Область(НомерСтроки, 2, НомерСтроки, 15).ГраницаСнизу = Линия;
			
		КонецЦикла;
		
	КонецПроцедуры // РасчертитьРасчетныйЛисток()
	
#КонецЕсли

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ДЛЯ ОБЕСПЕЧЕНИЯ ПРОВЕДЕНИЯ ДОКУМЕНТА

// Формирует запрос по шапке документа
//
// Параметры: 
//  нет
//
// Возвращаемое значение:
//  Результат запроса
//
Функция СформироватьЗапросПоШапке()
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка" , Ссылка);
	Запрос.УстановитьПараметр("ПерваяПоловинаТекущегоМесяца" , Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	НачислениеЗарплатыРаботникамОрганизаций.Дата,
	|	НачислениеЗарплатыРаботникамОрганизаций.ПериодРегистрации,
	|	ВЫБОР
	|		КОГДА НачислениеЗарплатыРаботникамОрганизаций.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА НачислениеЗарплатыРаботникамОрганизаций.Организация
	|		ИНАЧЕ НачислениеЗарплатыРаботникамОрганизаций.Организация.ГоловнаяОрганизация
	|	КОНЕЦ КАК ГоловнаяОрганизация,
	|	НачислениеЗарплатыРаботникамОрганизаций.Организация КАК ОбособленноеПодразделение,
	|	НачислениеЗарплатыРаботникамОрганизаций.ПерерассчитываемыйДокумент КАК ПерерассчитываемыйДокумент,
	|	НачислениеЗарплатыРаботникамОрганизаций.ПерерассчитываемыйДокумент.ПериодРегистрации КАК ПериодПерерасчета,
	|	НачислениеЗарплатыРаботникамОрганизаций.ПерерассчитываемыйДокумент.Организация КАК ОрганизацияПерерасчета,
	|	НачислениеЗарплатыРаботникамОрганизаций.Ссылка,
	|	ВЫБОР
	|		КОГДА НачислениеЗарплатыРаботникамОрганизаций.ПериодНачисления = &ПерваяПоловинаТекущегоМесяца
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ЭтоРасчетПервойПоловиныМесяца,
	|	СписокНачисления.КоличествоСтрок КАК НачисленияКоличествоСтрок
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций КАК НачислениеЗарплатыРаботникамОрганизаций,
	|	(ВЫБРАТЬ
	|		КОЛИЧЕСТВО(Начисления.НомерСтроки) КАК КоличествоСтрок
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Начисления
	|	ГДЕ
	|		Начисления.Ссылка = &ДокументСсылка) КАК СписокНачисления
	|ГДЕ
	|	НачислениеЗарплатыРаботникамОрганизаций.Ссылка = &ДокументСсылка";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоШапке()

// Формирует запрос по таблице "Начисления" документа
//
// Параметры: 
//	ВыборкаПоШапкеДокумента
//
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоНачисления(ВыборкаПоШапкеДокумента, Физлицо = Неопределено, Удержание)
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("ГоловнаяОрганизация", ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	
	Запрос.УстановитьПараметр("парамФизлицо", Физлицо);
	Запрос.УстановитьПараметр("парамНеОтбиратьФизлицо", Физлицо = Неопределено);
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СтрокиДокумента.Ссылка,
	|	СтрокиДокумента.НомерСтроки,
	|	СтрокиДокумента.Сотрудник КАК Сотрудник,
	|	СтрокиДокумента.Физлицо,
	|	СтрокиДокумента.ВидРасчета,
	|	НАЧАЛОПЕРИОДА(СтрокиДокумента.ДатаНачала, МЕСЯЦ) КАК ПериодДействия,
	|	СтрокиДокумента.ДатаНачала,
	|	СтрокиДокумента.ДатаОкончания,
	|	СтрокиДокумента.Показатель1,
	|	СтрокиДокумента.Показатель2,
	|	СтрокиДокумента.Показатель3,
	|	СтрокиДокумента.Показатель4,
	|	СтрокиДокумента.Показатель5,
	|	СтрокиДокумента.Показатель6,
	|	СтрокиДокумента.Результат,
	|	СтрокиДокумента.ПодразделениеОрганизации,
	|	СтрокиДокумента.ОтработаноДней,
	|	СтрокиДокумента.ОтработаноЧасов,
	|	СтрокиДокумента.ОтработаноДнейПоПятидневке,
	|	СтрокиДокумента.НормаДней,
	|	СтрокиДокумента.НормаЧасов,
	|	СтрокиДокумента.НормаДнейПоПятидневке,
	|	СтрокиДокумента.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиДокумента.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиДокумента.ДатаНачалаСобытия,
	|	СтрокиДокумента.Сторно,
	|	СтрокиДокумента.Авторасчет,
	//толик
	|	СтрокиДокумента.ЧасыИзДокумента,
	|	СтрокиДокумента.ОплаченоДней,
	//
	|	СтрокиДокумента.ОплачиватьЧасов,
	|	СтрокиДокумента.ОплаченоДнейЧасов,
	|	СтрокиДокумента.ОтработаноЧасовПоПятидневке,
	|	СтрокиДокумента.НормаЧасовПоПятидневке,
	|	СтрокиДокумента.СторнируемыйДокумент
	|ПОМЕСТИТЬ ВТСтрокиНачислений
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиДокумента
	|ГДЕ
	|	СтрокиДокумента.Ссылка = &ДокументСсылка
	|	И (&парамНеОтбиратьФизлицо
	|			ИЛИ СтрокиДокумента.Сотрудник.Физлицо = &парамФизлицо)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	Запрос.Выполнить();
	
	// ВТГрафикиСотрудников
	//		таблица содержит номера строк документа с данными о графике указанного
	//		в этой строке сотрудника из рег-ра сведений РаботникиОрганизации
	// 
	//	Поля:
	//		НомерСтроки
	//      ГрафикРаботы
	//      ГрафикПолногоРабочегоВремени
	//      СуммированныйУчетРабочегоВремени
	// 
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ПоследниеДаты.НомерСтроки КАК НомерСтроки,
	|	ВЫБОР
	|		КОГДА РаботникиОрганизации.ПериодЗавершения <= ПоследниеДаты.ДатаНачалаСобытия
	|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения
	|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы
	|	КОНЕЦ КАК ГрафикРаботы,
	|	ВЫБОР
	|		КОГДА РаботникиОрганизации.ПериодЗавершения <= ПоследниеДаты.ДатаНачалаСобытия
	|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения.ГрафикПолногоРабочегоВремени
	|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы.ГрафикПолногоРабочегоВремени
	|	КОНЕЦ КАК ГрафикПолногоРабочегоВремени,
	|	ВЫБОР
	|		КОГДА РаботникиОрганизации.ПериодЗавершения <= ПоследниеДаты.ДатаНачалаСобытия
	|				И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения.СуммированныйУчетРабочегоВремени
	|		ИНАЧЕ РаботникиОрганизации.ГрафикРаботы.СуммированныйУчетРабочегоВремени
	|	КОНЕЦ КАК СуммированныйУчетРабочегоВремени
	|ПОМЕСТИТЬ ВТГрафикиСотрудников
	|ИЗ
	|	(ВЫБРАТЬ
	|		МАКСИМУМ(РаботникиОрганизации.Период) КАК МаксПериод,
	|		СтрокиНачисления.НомерСтроки КАК НомерСтроки,
	|		СтрокиНачисления.Сотрудник КАК Сотрудник,
	|		СтрокиНачисления.ДатаНачалаСобытия КАК ДатаНачалаСобытия
	|	ИЗ
	|		ВТСтрокиНачислений КАК СтрокиНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	|			ПО СтрокиНачисления.ДатаНачалаСобытия >= РаботникиОрганизации.Период
	|				И СтрокиНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СтрокиНачисления.НомерСтроки,
	|		СтрокиНачисления.Сотрудник,
	|		СтрокиНачисления.ДатаНачалаСобытия) КАК ПоследниеДаты
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	|		ПО ПоследниеДаты.МаксПериод = РаботникиОрганизации.Период
	|			И ПоследниеДаты.Сотрудник = РаботникиОрганизации.Сотрудник
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НомерСтроки";
	Запрос.Выполнить();
	
	// ВТДанныеИндивидуальныхГрафиковИТабелей
	//		таблица содержит номера строк документа с сотрудниками, для которых введены 
	//		подробные документы использования времени: инд.графики и/или табели
	// 
	//	Поля:
	//		НомерСтроки
	//      План
	// 
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СтрокиНачисления.НомерСтроки КАК НомерСтроки,
	|	ГрафикиРаботыПоВидамВремени.План КАК План
	|ПОМЕСТИТЬ ВТДанныеИндивидуальныхГрафиковИТабелей
	|ИЗ
	|	ВТСтрокиНачислений КАК СтрокиНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|		ПО СтрокиНачисления.Сотрудник = ГрафикиРаботыПоВидамВремени.ГрафикРаботы
	|			И СтрокиНачисления.ПериодДействия = ГрафикиРаботыПоВидамВремени.Месяц
	|ГДЕ
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ НЕ NULL 
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	План";
	Запрос.Выполнить();
	
	// СводныеИндивидуальныеГрафикиРаботы
	//		таблица содержит номера строк документа с сотрудниками, для которых введены сводные 
	//		данные об их графике
	// 
	//	Поля:
	//		НомерСтроки
	// 
	
	Запрос.Текст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СписокРаботников.НомерСтроки КАК НомерСтроки
	|ПОМЕСТИТЬ ВТСводныеИндивидуальныеГрафикиРаботы
	|ИЗ
	|	ВТСтрокиНачислений КАК СписокРаботников
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
	|		ПО СписокРаботников.Сотрудник = СводныеИндивидуальныеГрафики.Сотрудник
	|			И СписокРаботников.ПериодДействия = СводныеИндивидуальныеГрафики.Месяц
	|ГДЕ
	|	СводныеИндивидуальныеГрафики.Сотрудник ЕСТЬ НЕ NULL 
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НомерСтроки";
	Запрос.Выполнить();
	
	// Основной запрос
	//		Сотрудники, для которых введены сводные данные об их графике
	// 
	//	Поля:
	//		НомерСтроки
	//
	//Аверсон-софт, Островская Татьяна 20.04.2012 
	если Удержание = Истина тогда
		//Аверсон-софт, Островская Татьяна 20.04.2012
		Запрос.Текст =
		"ВЫБРАТЬ
		|	СтрокиНачисления.Сотрудник КАК Сотрудник,
		|	СтрокиНачисления.Сотрудник.Физлицо КАК Физлицо,
		|	СтрокиНачисления.ВидРасчета КАК ВидРасчета,
		|	СтрокиНачисления.ВидРасчета.ЗачетОтработанногоВремени КАК ЗачетОтработанногоВремени,
		|	СтрокиНачисления.ВидРасчета.ЗачетНормыВремени КАК ЗачетНормыВремени,
		|	СтрокиНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
		|	СтрокиНачисления.ВидРасчета.ВидВремени КАК ВидВремени,
		|	СтрокиНачисления.ДатаНачала КАК ПериодДействияНачало,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		ИНАЧЕ КОНЕЦПЕРИОДА(СтрокиНачисления.ДатаОкончания, ДЕНЬ)
		|	КОНЕЦ КАК ПериодДействияКонец,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.ВидРасчета.ПериодДействияБазовый
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		КОГДА СтрокиНачисления.ДатаНачала = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(СтрокиНачисления.ДатаНачала, МЕСЯЦ, -1), МЕСЯЦ)
		|	КОНЕЦ КАК БазовыйПериодНачало,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.ВидРасчета.ПериодДействияБазовый
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		КОГДА СтрокиНачисления.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		ИНАЧЕ КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(СтрокиНачисления.ДатаОкончания, МЕСЯЦ, -1), МЕСЯЦ)
		|	КОНЕЦ КАК БазовыйПериодКонец,
		|	СтрокиНачисления.НомерСтроки КАК НомерСтроки,
		|	СтрокиНачисления.Показатель1 КАК Показатель1,
		|	СтрокиНачисления.Показатель2 КАК Показатель2,
		|	СтрокиНачисления.Показатель3 КАК Показатель3,
		|	СтрокиНачисления.Показатель4 КАК Показатель4,
		|	СтрокиНачисления.Показатель5 КАК Показатель5,
		|	СтрокиНачисления.Показатель6 КАК Показатель6,
		|	СтрокиНачисления.Результат КАК Результат,
		|	СтрокиНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|	СтрокиНачисления.Сторно КАК Сторно,
		|	СтрокиНачисления.ОтработаноДней КАК ОтработаноДней,
		|	СтрокиНачисления.ОтработаноЧасов КАК ОтработаноЧасов,
		|	СтрокиНачисления.ОтработаноДнейПоПятидневке КАК ОтработаноДнейПоПятидневке,
		|	СтрокиНачисления.ОтработаноЧасовПоПятидневке КАК ОтработаноЧасовПоПятидневке,
		|	СтрокиНачисления.НормаДней КАК НормаДней,
		|	СтрокиНачисления.НормаЧасов КАК НормаЧасов,
		|	СтрокиНачисления.НормаДнейПоПятидневке КАК НормаДнейПоПятидневке,
		|	СтрокиНачисления.НормаЧасовПоПятидневке КАК НормаЧасовПоПятидневке,
		//толик
		|	СтрокиНачисления.ЧасыИзДокумента КАК ЧасыИзДокумента,
		|	СтрокиНачисления.ОплаченоДней КАК ОплаченоДней,
		//
		|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаНачало КАК ПериодРасчетаСреднегоЗаработкаНачало,
		|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаОкончание КАК ПериодРасчетаСреднегоЗаработкаОкончание,
		|	СтрокиНачисления.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
		|	СтрокиНачисления.Авторасчет КАК Авторасчет,
		|	СтрокиНачисления.ОплаченоДнейЧасов КАК ОплаченоДнейЧасов,
		|	ВЫБОР
		//Аверсон-софт, Островская Татьяна 27.03.2012 № 15113
		|		КОГДА ГрафикРаботыПоСотруднику.НомерСтроки ЕСТЬ NULL 
		|			ТОГДА РаботникиОрганизации.ГрафикРаботы
		|       КОГДА ТабелиУчетаВремениПоСотруднику.НомерСтроки ЕСТЬ НЕ NULL 
		|				И ИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ NULL 
		|				И СводныеИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ NULL 
		|			ТОГДА РаботникиОрганизации.ГрафикРаботы
		// если у работника сокращенное рабочее время, а норма времени определяется по полному графику
		// и введен индивидуальный график, то норму времени надо считать по-прежнему по данным ""общего графика""
		|		КОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
		|				И (ИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL 
		|					ИЛИ СводныеИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL )
		|			ТОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени
		//О.Т. Аверсон 17.07.2018 № 2218
		// если у работника не сокращенное рабочее время и введен индивидуальный график
		|		КОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени = ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
		|				И (ИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL 
		|					ИЛИ СводныеИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL )
		|			ТОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени
		//О.Т. Аверсон 17.07.2018 № 2218
		|       ИНАЧЕ РаботникиОрганизации.ГрафикРаботы //О.Т. Аверсон 01.11.2017 № 1189
		|	КОНЕЦ КАК ГрафикРаботы,
		//Аверсон-софт, Островская Татьяна 27.03.2012 № 15113
		|	ВЫБОР
		//Аверсон-софт, Островская Татьяна 27.03.2012 № 15113
		// если введен табель, но нет индивидуального графика, то норму времени надо считать по данным ""общего графика""
		// если у работника сокращенное рабочее время, а норма времени определяется по полному графику
		// и введен индивидуальный график, то норму времени надо считать по-прежнему по данным ""общего графика""
		|		КОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
		|				И (ИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL 
		|					ИЛИ СводныеИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL )
		|			ТОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени
		|       ИНАЧЕ РаботникиОрганизации.ГрафикРаботы //О.Т. Аверсон 01.11.2017 № 1189
		|	КОНЕЦ КАК ГрафикРаботыНорма,
		//Аверсон-софт, Островская Татьяна 27.03.2012 № 15113
		|	ЕСТЬNULL(РаботникиОрганизации.СуммированныйУчетРабочегоВремени, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени,
		|	СтрокиНачисления.ОплачиватьЧасов,
		|	СтрокиНачисления.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени КАК ВидИспользованияРабочегоВремени,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.ВидРасчета.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеНеотработанное))
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК ЯвляетсяПочасовымОтклонением,
		|	ЗНАЧЕНИЕ(Перечисление.ВариантыОбработкиЗаписиПриОтраженииВРеглУчете.ПустаяСсылка) КАК ВариантОбработкиЗаписиПриОтраженииВРеглУчете,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.Сотрудник.Организация = &ГоловнаяОрганизация
		|			ТОГДА ЛОЖЬ
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ КАК ОшибкаНеСоответствиеСотрудникаИОрганизации,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.Сторно
		|			ТОГДА СтрокиНачисления.СторнируемыйДокумент
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СторнируемыйДокумент
		|ИЗ
		|	ВТСтрокиНачислений КАК СтрокиНачисления
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиСотрудников КАК РаботникиОрганизации
		|		ПО СтрокиНачисления.НомерСтроки = РаботникиОрганизации.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
		|			СтрокиНачисления.НомерСтроки КАК НомерСтроки
		|		ИЗ
		|			ВТДанныеИндивидуальныхГрафиковИТабелей КАК СтрокиНачисления) КАК ГрафикРаботыПоСотруднику
		|		ПО СтрокиНачисления.НомерСтроки = ГрафикРаботыПоСотруднику.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
		|			СтрокиНачисления.НомерСтроки КАК НомерСтроки
		|		ИЗ
		|			ВТДанныеИндивидуальныхГрафиковИТабелей КАК СтрокиНачисления
		|		ГДЕ
		|			(НЕ СтрокиНачисления.План)) КАК ТабелиУчетаВремениПоСотруднику
		|		ПО СтрокиНачисления.НомерСтроки = ТабелиУчетаВремениПоСотруднику.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
		|			СтрокиНачисления.НомерСтроки КАК НомерСтроки
		|		ИЗ
		|			ВТДанныеИндивидуальныхГрафиковИТабелей КАК СтрокиНачисления
		|		ГДЕ
		|			СтрокиНачисления.План) КАК ИндивидуальныеГрафикиРаботы
		|		ПО СтрокиНачисления.НомерСтроки = ИндивидуальныеГрафикиРаботы.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТСводныеИндивидуальныеГрафикиРаботы КАК СводныеИндивидуальныеГрафикиРаботы
		|		ПО СтрокиНачисления.НомерСтроки = СводныеИндивидуальныеГрафикиРаботы.НомерСтроки
		|
		|УПОРЯДОЧИТЬ ПО
		|	НомерСтроки";
		//Аверсон-софт, Островская Татьяна 20.04.2012	
	иначе
		Запрос.Текст =
		"ВЫБРАТЬ
		|	СтрокиНачисления.Сотрудник КАК Сотрудник,
		|	СтрокиНачисления.Сотрудник.Физлицо КАК Физлицо,
		|	СтрокиНачисления.ВидРасчета КАК ВидРасчета,
		|	СтрокиНачисления.ВидРасчета.ЗачетОтработанногоВремени КАК ЗачетОтработанногоВремени,
		|	СтрокиНачисления.ВидРасчета.ЗачетНормыВремени КАК ЗачетНормыВремени,
		|	СтрокиНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
		|	СтрокиНачисления.ВидРасчета.ВидВремени КАК ВидВремени,
		|	СтрокиНачисления.ДатаНачала КАК ПериодДействияНачало,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		ИНАЧЕ КОНЕЦПЕРИОДА(СтрокиНачисления.ДатаОкончания, ДЕНЬ)
		|	КОНЕЦ КАК ПериодДействияКонец,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.ВидРасчета.ПериодДействияБазовый
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		КОГДА СтрокиНачисления.ДатаНачала = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(СтрокиНачисления.ДатаНачала, МЕСЯЦ, -1), МЕСЯЦ)
		|	КОНЕЦ КАК БазовыйПериодНачало,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.ВидРасчета.ПериодДействияБазовый
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		КОГДА СтрокиНачисления.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		ИНАЧЕ КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(СтрокиНачисления.ДатаОкончания, МЕСЯЦ, -1), МЕСЯЦ)
		|	КОНЕЦ КАК БазовыйПериодКонец,
		|	СтрокиНачисления.НомерСтроки КАК НомерСтроки,
		|	СтрокиНачисления.Показатель1 КАК Показатель1,
		|	СтрокиНачисления.Показатель2 КАК Показатель2,
		|	СтрокиНачисления.Показатель3 КАК Показатель3,
		|	СтрокиНачисления.Показатель4 КАК Показатель4,
		|	СтрокиНачисления.Показатель5 КАК Показатель5,
		|	СтрокиНачисления.Показатель6 КАК Показатель6,
		|	СтрокиНачисления.Результат КАК Результат,
		|	СтрокиНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|	СтрокиНачисления.Сторно КАК Сторно,
		|	СтрокиНачисления.ОтработаноДней КАК ОтработаноДней,
		|	СтрокиНачисления.ОтработаноЧасов КАК ОтработаноЧасов,
		|	СтрокиНачисления.ОтработаноДнейПоПятидневке КАК ОтработаноДнейПоПятидневке,
		|	СтрокиНачисления.ОтработаноЧасовПоПятидневке КАК ОтработаноЧасовПоПятидневке,
		|	СтрокиНачисления.НормаДней КАК НормаДней,
		|	СтрокиНачисления.НормаЧасов КАК НормаЧасов,
		|	СтрокиНачисления.НормаДнейПоПятидневке КАК НормаДнейПоПятидневке,
		|	СтрокиНачисления.НормаЧасовПоПятидневке КАК НормаЧасовПоПятидневке,
		//толик
		|	СтрокиНачисления.ЧасыИзДокумента КАК ЧасыИзДокумента,
		|	СтрокиНачисления.ОплаченоДней КАК ОплаченоДней,
		//
		|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаНачало КАК ПериодРасчетаСреднегоЗаработкаНачало,
		|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаОкончание КАК ПериодРасчетаСреднегоЗаработкаОкончание,
		|	СтрокиНачисления.ДатаНачалаСобытия КАК ДатаНачалаСобытия,
		|	СтрокиНачисления.Авторасчет КАК Авторасчет,
		|	СтрокиНачисления.ОплаченоДнейЧасов КАК ОплаченоДнейЧасов,
		|	ВЫБОР
		|		КОГДА ГрафикРаботыПоСотруднику.НомерСтроки ЕСТЬ NULL 
		|			ТОГДА РаботникиОрганизации.ГрафикРаботы
		|		ИНАЧЕ СтрокиНачисления.Сотрудник
		|	КОНЕЦ КАК ГрафикРаботы,
		|	ВЫБОР
		// если введен табель, но нет индивидуального графика, то норму времени надо считать по данным ""общего графика""
		|		КОГДА ТабелиУчетаВремениПоСотруднику.НомерСтроки ЕСТЬ НЕ NULL 
		|				И ИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ NULL 
		|				И СводныеИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ NULL 
		|			ТОГДА РаботникиОрганизации.ГрафикРаботы
		// если у работника сокращенное рабочее время, а норма времени определяется по полному графику
		// и введен индивидуальный график, то норму времени надо считать по-прежнему по данным ""общего графика""
		|		КОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
		|				И (ИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL 
		|					ИЛИ СводныеИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL )
		|			ТОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени
		//О.Т. Аверсон 17.07.2018 № 2218
		// если у работника не сокращенное рабочее время и введен индивидуальный график
		|		КОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени = ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
		|				И (ИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL 
		|					ИЛИ СводныеИндивидуальныеГрафикиРаботы.НомерСтроки ЕСТЬ НЕ NULL )
		|			ТОГДА РаботникиОрганизации.ГрафикПолногоРабочегоВремени
		//О.Т. Аверсон 17.07.2018 № 2218
		
		|			ИНАЧЕ РаботникиОрганизации.ГрафикРаботы //О.Т. Аверсон 01.11.2017 № 1189
		|	КОНЕЦ КАК ГрафикРаботыНорма,
		|	ЕСТЬNULL(РаботникиОрганизации.СуммированныйУчетРабочегоВремени, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени,
		|	СтрокиНачисления.ОплачиватьЧасов,
		|	СтрокиНачисления.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени КАК ВидИспользованияРабочегоВремени,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.ВидРасчета.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеНеотработанное))
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК ЯвляетсяПочасовымОтклонением,
		|	ЗНАЧЕНИЕ(Перечисление.ВариантыОбработкиЗаписиПриОтраженииВРеглУчете.ПустаяСсылка) КАК ВариантОбработкиЗаписиПриОтраженииВРеглУчете,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.Сотрудник.Организация = &ГоловнаяОрганизация
		|			ТОГДА ЛОЖЬ
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ КАК ОшибкаНеСоответствиеСотрудникаИОрганизации,
		|	ВЫБОР
		|		КОГДА СтрокиНачисления.Сторно
		|			ТОГДА СтрокиНачисления.СторнируемыйДокумент
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СторнируемыйДокумент
		|ИЗ
		|	ВТСтрокиНачислений КАК СтрокиНачисления
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиСотрудников КАК РаботникиОрганизации
		|		ПО СтрокиНачисления.НомерСтроки = РаботникиОрганизации.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
		|			СтрокиНачисления.НомерСтроки КАК НомерСтроки
		|		ИЗ
		|			ВТДанныеИндивидуальныхГрафиковИТабелей КАК СтрокиНачисления) КАК ГрафикРаботыПоСотруднику
		|		ПО СтрокиНачисления.НомерСтроки = ГрафикРаботыПоСотруднику.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
		|			СтрокиНачисления.НомерСтроки КАК НомерСтроки
		|		ИЗ
		|			ВТДанныеИндивидуальныхГрафиковИТабелей КАК СтрокиНачисления
		|		ГДЕ
		|			(НЕ СтрокиНачисления.План)) КАК ТабелиУчетаВремениПоСотруднику
		|		ПО СтрокиНачисления.НомерСтроки = ТабелиУчетаВремениПоСотруднику.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
		|			СтрокиНачисления.НомерСтроки КАК НомерСтроки
		|		ИЗ
		|			ВТДанныеИндивидуальныхГрафиковИТабелей КАК СтрокиНачисления
		|		ГДЕ
		|			СтрокиНачисления.План) КАК ИндивидуальныеГрафикиРаботы
		|		ПО СтрокиНачисления.НомерСтроки = ИндивидуальныеГрафикиРаботы.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТСводныеИндивидуальныеГрафикиРаботы КАК СводныеИндивидуальныеГрафикиРаботы
		|		ПО СтрокиНачисления.НомерСтроки = СводныеИндивидуальныеГрафикиРаботы.НомерСтроки
		|
		|УПОРЯДОЧИТЬ ПО
		|	НомерСтроки";
		
	КонецЕсли;
	//Аверсон-софт, Островская Татьяна 20.04.2012
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоНачисления()

// Формирует запрос по таблице "ДополнительныеНачисления" документа
//
// Параметры: 
//	ВыборкаПоШапкеДокумента
//
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоДопНачисления(ВыборкаПоШапкеДокумента, Физлицо = Неопределено)
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("ГоловнаяОрганизация", ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("ДатаНалоговогоПериода", КонецГода(ПериодРегистрации));
	Запрос.УстановитьПараметр("НеОтбиратьФизлиц", Физлицо = Неопределено);
	Запрос.УстановитьПараметр("Физлицо", Физлицо);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	НЕОПРЕДЕЛЕНО КАК ДокументОснование,
	|	СтрокиНачисления.ВидРасчета,
	|	СтрокиНачисления.КодВычета КАК КодВычета,
	|	СтрокиНачисления.ВидРасчета.КодДоходаНДФЛ КАК КодДоходаНДФЛ,
	|	СтрокиНачисления.СуммаВычета,
	//|	ВЫБОР
	//|		КОГДА СтрокиНачисления.КодВычета = ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.МатпомощьПриРожденииРебенка)
	//|			ТОГДА ВЫБОР
	//|					КОГДА СтрокиНачисления.Результат < СтрокиНачисления.СуммаВычета * ВычетПоМатпомощиПриРождении.НормативЗатрат
	//|						ТОГДА СтрокиНачисления.Результат
	//|					ИНАЧЕ СтрокиНачисления.СуммаВычета * ВычетПоМатпомощиПриРождении.НормативЗатрат
	//|				КОНЕЦ
	//|		КОГДА СтрокиНачисления.КодВычета = ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код404)
	//|			ТОГДА СтрокиНачисления.СуммаВычета
	//|		КОГДА СтрокиНачисления.КодВычета = ЗНАЧЕНИЕ(Справочник.ВычетыНДФЛ.Код405)
	//|			ТОГДА СтрокиНачисления.СуммаВычета
	//|		ИНАЧЕ 0
	//|	КОНЕЦ КАК СкидкаПриНалогообложении,
	|	СтрокиНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
	|	СтрокиНачисления.НомерСтроки КАК НомерСтроки,
	|	СтрокиНачисления.Показатель1,
	|	СтрокиНачисления.Показатель2,
	|	СтрокиНачисления.Показатель3,
	|	СтрокиНачисления.Показатель4,
	|	СтрокиНачисления.Показатель5,
	|	СтрокиНачисления.Показатель6,
	|	СтрокиНачисления.Результат,
	|	СтрокиНачисления.ПодразделениеОрганизации,
	|	СтрокиНачисления.Сторно,
	|	СтрокиНачисления.Сотрудник,
	|	СтрокиНачисления.Сотрудник.Физлицо КАК Физлицо,
	|	СтрокиНачисления.ДатаНачала КАК БазовыйПериодНачало,
	|	СтрокиНачисления.ДатаОкончания КАК БазовыйПериодКонец,
	|	СтрокиНачисления.ВидРасчета.ЧислоМесяцев КАК ЧислоМесяцев,
	|	СтрокиНачисления.Авторасчет,
	|	СтрокиНачисления.ОплаченоДнейЧасов КАК ОплаченоДнейЧасов,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиНачисления.ДатаНачалаСобытия,
	|	ЕСТЬNULL(ВЫБОР
	|			КОГДА РаботникиОрганизации.ПериодЗавершения <= СтрокиНачисления.ДатаНачалаСобытия
	|					И РаботникиОрганизации.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|				ТОГДА РаботникиОрганизации.ГрафикРаботыЗавершения.СуммированныйУчетРабочегоВремени
	|			ИНАЧЕ РаботникиОрганизации.ГрафикРаботы.СуммированныйУчетРабочегоВремени
	|		КОНЕЦ, ЛОЖЬ) КАК СуммированныйУчетРабочегоВремени,
	|	ВЫБОР
	|		КОГДА СтрокиНачисления.Сотрудник.Организация = &ГоловнаяОрганизация
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ОшибкаНеСоответствиеСотрудникаИОрганизации,
	|	ВЫБОР
	|		КОГДА СтрокиНачисления.Сторно
	|			ТОГДА СтрокиНачисления.СторнируемыйДокумент
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СторнируемыйДокумент
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК СтрокиНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			МАКСИМУМ(РаботникиОрганизации.Период) КАК МаксПериод,
	|			СтрокиНачисления.НомерСтроки КАК НомерСтроки
	|		ИЗ
	|			Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК СтрокиНачисления
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	|				ПО (РаботникиОрганизации.Период <= СтрокиНачисления.ДатаНачалаСобытия)
	|					И СтрокиНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
	|		ГДЕ
	|			СтрокиНачисления.Ссылка = &ДокументСсылка
	|			И (&НеОтбиратьФизлиц
	|					ИЛИ СтрокиНачисления.Сотрудник.Физлицо = &Физлицо)
	|		
	|		СГРУППИРОВАТЬ ПО
	|			СтрокиНачисления.НомерСтроки) КАК ПоследниеДаты
	|		ПО СтрокиНачисления.НомерСтроки = ПоследниеДаты.НомерСтроки
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	|		ПО (РаботникиОрганизации.Период = ПоследниеДаты.МаксПериод)
	|			И СтрокиНачисления.Сотрудник = РаботникиОрганизации.Сотрудник
	//|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НДФЛВычетыПоДоходам.СрезПоследних(&ДатаНалоговогоПериода, КодДохода = ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.МатпомощьПриРожденииРебенка)) КАК ВычетПоМатпомощиПриРождении
	//|		ПО СтрокиНачисления.ВидРасчета.КодДоходаНДФЛ = ВычетПоМатпомощиПриРождении.КодДохода
	|ГДЕ
	|	СтрокиНачисления.Ссылка = &ДокументСсылка
	|	И (&НеОтбиратьФизлиц
	|			ИЛИ СтрокиНачисления.Сотрудник.Физлицо = &Физлицо)
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоДопНачисления()

// Формирует запрос по таблице "ДополнительныеНачисления" документа
//
// Параметры: 
//	ВыборкаПоШапкеДокумента
//
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоДоговорам(ВыборкаПоШапкеДокумента, Физлицо = Неопределено)
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("ГоловнаяОрганизация", ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("ДатаОкончания", КонецМесяца(ПериодРегистрации));
	Если НЕ (Физлицо = Неопределено) Тогда
		Запрос.УстановитьПараметр("Физлицо", Физлицо);
		УсловиеНаФизлицоТекст = " И СтрокиНачисления.Сотрудник.Физлицо = &Физлицо ";
	Иначе
		УсловиеНаФизлицоТекст="";
	КонецЕсли;
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СтрокиНачисления.ДокументОснование,
	|	СтрокиНачисления.ВидРасчета,
	|	СтрокиНачисления.КодВычета КАК КодВычета,
	|	СтрокиНачисления.СуммаВычета КАК СкидкаПриНалогообложении,
	|	СтрокиНачисления.ВидРасчета.СпособРасчета КАК СпособРасчета,
	|	СтрокиНачисления.ВидРасчета.КодДоходаНДФЛ КАК КодДоходаНДФЛ,
	|	СтрокиНачисления.НомерСтроки КАК НомерСтроки,
	|	СтрокиНачисления.Размер,
	|	СтрокиНачисления.Результат КАК Результат,
	|	СтрокиНачисления.ПодразделениеОрганизации,
	|	СтрокиНачисления.Сторно,
	|	СтрокиНачисления.Сотрудник,
	|	СтрокиНачисления.Сотрудник.Физлицо КАК Физлицо,
	|	СтрокиНачисления.ДатаНачала КАК БазовыйПериодНачало,
	|	СтрокиНачисления.ДатаОкончания КАК БазовыйПериодКонец,
	|	0 КАК ЧислоМесяцев,
	|	ЛОЖЬ КАК Авторасчет,
	|	ВЫБОР
	|		КОГДА СтрокиНачисления.Сотрудник.Организация = &ГоловнаяОрганизация
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ОшибкаНеСоответствиеСотрудникаИОрганизации,
	|	ВЫБОР
	|		КОГДА СтрокиНачисления.Сторно
	|			ТОГДА СтрокиНачисления.СторнируемыйДокумент
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СторнируемыйДокумент
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК СтрокиНачисления
	|ГДЕ
	|	СтрокиНачисления.Ссылка = &ДокументСсылка" + УсловиеНаФизлицоТекст + "
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоДоговорам()

// Формирует запрос по таблице "Удержания" документа
//
// Параметры: 
//	нет
//
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоУдержания(ВыборкаПоШапкеДокумента, Физлицо = Неопределено)
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка",				Ссылка);
	Запрос.УстановитьПараметр("ПериодРегистрации",			ПериодРегистрации);
	Запрос.УстановитьПараметр("КонецПериодаРегистрации",	КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("ГоловнаяОрганизация",		ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("ПриемНаРаботу",				Перечисления.ПричиныИзмененияСостояния.ПриемНаРаботу);
	Запрос.УстановитьПараметр("ЗаВесьПериод",				Перечисления.ПорядокРасчетаБазы.ЗаВесьПериод);
	Запрос.УстановитьПараметр("ПриПриемеНаРаботу",			Перечисления.ПорядокРасчетаБазы.ПриПриемеНаРаботу);
	Запрос.УстановитьПараметр("ПриУвольнении",				Перечисления.ПорядокРасчетаБазы.ПриУвольнении);
	
	УсловиеНаФизлицоТекст="";
	Если Физлицо <> Неопределено Тогда
		Запрос.УстановитьПараметр("парамФизлицо", Физлицо);
		УсловиеНаФизлицоТекст = Символы.ПС + " И СтрокиУдержания.Физлицо = &парамФизлицо ";	
	КонецЕсли;
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	&ГоловнаяОрганизация КАК Организация,
	|	СтрокиУдержания.ФизЛицо,
	|	СтрокиУдержания.Сотрудник,//Островская Татьяна 04.06.2014 № 17395
	|	СтрокиУдержания.ВидРасчета,
	|	СтрокиУдержания.ДатаНачала,
	|	СтрокиУдержания.ДатаОкончания,
	|	СтрокиУдержания.ДатаНачала КАК БазовыйПериодНачало,
	|	ВЫБОР
	|		КОГДА СтрокиУдержания.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА СтрокиУдержания.ДатаОкончания
	|		ИНАЧЕ КОНЕЦПЕРИОДА(СтрокиУдержания.ДатаОкончания, ДЕНЬ)
	|	КОНЕЦ КАК БазовыйПериодКонец,
	|	СтрокиУдержания.НомерСтроки КАК НомерСтроки,
	|	СтрокиУдержания.ДокументОснование,
	|	СтрокиУдержания.Показатель1,
	|	СтрокиУдержания.Показатель2,
	|	СтрокиУдержания.Показатель3,
	|	СтрокиУдержания.Показатель4,
	|	СтрокиУдержания.Показатель5,
	|	СтрокиУдержания.Показатель6,
	|	СтрокиУдержания.Результат,
	|	СтрокиУдержания.Сторно,
	|	СтрокиУдержания.ВидРасчета.СпособРасчета КАК СпособРасчета,
	|	СтрокиУдержания.Авторасчет КАК Авторасчет,
	|	СтрокиУдержания.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиУдержания.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиУдержания.ДатаНачалаСобытия";
	Если ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца Тогда
		Запрос.Текст = Запрос.Текст + ",
		|	&ПриУвольнении КАК ПорядокРасчетаБазы";
	ИначеЕсли ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ВтораяПоловинаТекущегоМесяца Тогда	
		Запрос.Текст = Запрос.Текст + ",
		|	&ПриПриемеНаРаботу КАК ПорядокРасчетаБазы";
	Иначе	
		Запрос.Текст = Запрос.Текст + ",
		|	ВЫБОР
		|		КОГДА СтрокиУдержания.ДатаНачала > &ПериодРегистрации
		|				И ПринятыеВТекущемМесяце.Период ЕСТЬ НЕ NULL 
		|			ТОГДА &ПриПриемеНаРаботу
		|		КОГДА СтрокиУдержания.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА &ЗаВесьПериод
		|		КОГДА КОНЕЦПЕРИОДА(СтрокиУдержания.ДатаОкончания, ДЕНЬ) < &КонецПериодаРегистрации
		|				И УволенныеВТекущемМесяце.Период ЕСТЬ НЕ NULL 
		|			ТОГДА &ПриУвольнении
		|		ИНАЧЕ &ЗаВесьПериод
		|	КОНЕЦ КАК ПорядокРасчетаБазы";
	КонецЕсли;
	Запрос.Текст = Запрос.Текст + "
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК СтрокиУдержания";
	Если ПериодНачисления <> Перечисления.ПериодНачисленияЗарплаты.ПерваяПоловинаТекущегоМесяца 
		И ПериодНачисления <> Перечисления.ПериодНачисленияЗарплаты.ВтораяПоловинаТекущегоМесяца Тогда	
		Запрос.Текст = Запрос.Текст + "
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			СтрокиУдержания.НомерСтроки КАК НомерСтроки,
		|			МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период
		|		ИЗ
		|			Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК СтрокиУдержания
		|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|				ПО СтрокиУдержания.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
		|		ГДЕ
		|			СтрокиУдержания.Ссылка = &ДокументСсылка " + УсловиеНаФизлицоТекст + "
		|			И СтрокиУдержания.ДатаНачала > &ПериодРегистрации
		|			И РаботникиОрганизаций.Организация = &ГоловнаяОрганизация
		|			И РаботникиОрганизаций.Период > &ПериодРегистрации
		|			И РаботникиОрганизаций.Период <= &КонецПериодаРегистрации
		|			И РаботникиОрганизаций.ПричинаИзмененияСостояния = &ПриемНаРаботу
		|			И (РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
		|		
		|		СГРУППИРОВАТЬ ПО
		|			СтрокиУдержания.НомерСтроки) КАК ПринятыеВТекущемМесяце
		|		ПО СтрокиУдержания.НомерСтроки = ПринятыеВТекущемМесяце.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ (
		|		ВЫБРАТЬ
		|			УволенныеВТекущемМесяцеОбъединение.НомерСтроки КАК НомерСтроки,
		|			МИНИМУМ(УволенныеВТекущемМесяцеОбъединение.Период) КАК Период
		|       ИЗ (ВЫБРАТЬ
		|			СтрокиУдержания.НомерСтроки КАК НомерСтроки,
		|			МИНИМУМ(РаботникиОрганизаций.Период) КАК Период
		|		ИЗ
		|			Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК СтрокиУдержания
		|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|				ПО СтрокиУдержания.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
		|		ГДЕ
		|			СтрокиУдержания.Ссылка = &ДокументСсылка " + УсловиеНаФизлицоТекст + "
		|			И СтрокиУдержания.ДатаОкончания <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			И СтрокиУдержания.ДатаОкончания < &КонецПериодаРегистрации
		|			И РаботникиОрганизаций.Организация = &ГоловнаяОрганизация
		|			И РаботникиОрганизаций.Период >= &ПериодРегистрации
		|			И РаботникиОрганизаций.Период < &КонецПериодаРегистрации
		|			И РаботникиОрганизаций.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|			И (РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
		|		
		|		СГРУППИРОВАТЬ ПО
		|			СтрокиУдержания.НомерСтроки	
		|
		|			ОБЪЕДИНИТЬ
		|			
		|		ВЫБРАТЬ
		|			СтрокиУдержания.НомерСтроки КАК НомерСтроки,
		|			МИНИМУМ(Работники.Период) КАК Период 
		|		ИЗ
		|			Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК СтрокиУдержания
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работники
		|              ПО СтрокиУдержания.ФизЛицо = Работники.Сотрудник.Физлицо
		|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
		|				  			ПО ПериодыПерекрытия.Период <= Работники.ПериодЗавершения
		|				   			И ПериодыПерекрытия.Период > Работники.Период
		|							И ПериодыПерекрытия.Сотрудник = Работники.Сотрудник
		|							И ПериодыПерекрытия.Организация = &ГоловнаяОрганизация
		|							И (ПериодыПерекрытия.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
		|			ГДЕ  
		|		  		Работники.ПериодЗавершения<>ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) 
		|				И Работники.Организация = &ГоловнаяОрганизация
		|				И Работники.ПериодЗавершения >= &ПериодРегистрации
		|				И Работники.ПериодЗавершения < &КонецПериодаРегистрации
		|               И Работники.ПричинаИзмененияСостоянияЗавершения = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|				И (Работники.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
		|				И ПериодыПерекрытия.Период ЕСТЬ NULL  
		|				И СтрокиУдержания.Ссылка = &ДокументСсылка " + УсловиеНаФизлицоТекст + " 
		|				И СтрокиУдержания.ДатаОкончания <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				И СтрокиУдержания.ДатаОкончания < &КонецПериодаРегистрации
		|		
		|			СГРУППИРОВАТЬ ПО
		|				СтрокиУдержания.НомерСтроки) КАК УволенныеВТекущемМесяцеОбъединение
		|	 	СГРУППИРОВАТЬ ПО 
		|			УволенныеВТекущемМесяцеОбъединение.НомерСтроки) КАК УволенныеВТекущемМесяце
		|		ПО СтрокиУдержания.НомерСтроки = УволенныеВТекущемМесяце.НомерСтроки";
	КонецЕсли;
	Запрос.Текст = Запрос.Текст + "
	|ГДЕ
	|	СтрокиУдержания.Ссылка = &ДокументСсылка " + УсловиеНаФизлицоТекст + "
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	РезультатЗапроса = Запрос.Выполнить();
	Возврат РезультатЗапроса;
	
КонецФункции // СформироватьЗапросПоУдержания()

Функция СформироватьЗапросПоДопПенсии(ВыборкаПоШапкеДокумента, Физлицо = Неопределено)
	//Аверсон 01.07.2022 КВВ СВФР-009250 (
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("ДокументСсылка",				Ссылка);
	Запрос.УстановитьПараметр("ПериодРегистрации",			ПериодРегистрации);
	Запрос.УстановитьПараметр("КонецПериодаРегистрации",	КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("ГоловнаяОрганизация",		ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("ЗаВесьПериод",				Перечисления.ПорядокРасчетаБазы.ЗаВесьПериод);
	Запрос.УстановитьПараметр("ВидРасчета",	ПланыВидовРасчета.УдержанияОрганизаций.ДополнительнаяПенсия);
	
	
	УсловиеНаФизлицоТекст="";
	Если Физлицо <> Неопределено Тогда
		Запрос.УстановитьПараметр("парамФизлицо", Физлицо);
		УсловиеНаФизлицоТекст = Символы.ПС + " И СтрокиУдержания.Физлицо = &парамФизлицо ";	
	КонецЕсли;
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	&ГоловнаяОрганизация КАК Организация,
	|	СтрокиУдержания.ФизЛицо,
	|	СтрокиУдержания.Сотрудник,
	|	&ВидРасчета КАК ВидРасчета,
	|	СтрокиУдержания.МесяцДП КАК ДатаНачала,
	|	КОНЕЦПЕРИОДА(СтрокиУдержания.МесяцДП,МЕСЯЦ) КАК ДатаОкончания,
	|	СтрокиУдержания.МесяцДП КАК БазовыйПериодНачало,
	|	КОНЕЦПЕРИОДА(СтрокиУдержания.МесяцДП,МЕСЯЦ) КАК БазовыйПериодКонец,	
	|	СтрокиУдержания.НомерСтроки КАК НомерСтроки,
	|	NULL КАК ДокументОснование,
	|	СтрокиУдержания.ПроцентДП КАК Показатель1,
	|	0 КАК Показатель2,
	|	0 КАК Показатель3,
	|	0 КАК Показатель4,
	|	0 КАК Показатель5,
	|	0 КАК Показатель6,
	|	СтрокиУдержания.НалогДП КАК Результат,
	|	ЛОЖЬ КАК Сторно,
	//|	&ВидРасчета.СпособРасчета КАК СпособРасчета,
	|	ИСТИНА КАК Авторасчет,
	|	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ПериодРасчетаСреднегоЗаработкаНачало,
	|	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ДатаНачалаСобытия,
	|	&ЗаВесьПериод КАК ПорядокРасчетаБазы	
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительнаяПенсия КАК СтрокиУдержания
	|ГДЕ
	|	СтрокиУдержания.Ссылка = &ДокументСсылка " + УсловиеНаФизлицоТекст + "
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	РезультатЗапроса = Запрос.Выполнить();
	Возврат РезультатЗапроса;
	//Аверсон 01.07.2022 КВВ СВФР-009250 )
КонецФункции 

// Формирует запрос по таблице "НДФЛ" документа
//
// Параметры: 
//	нет
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоНДФЛ(Физлицо = Неопределено)
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	Если НЕ (Физлицо = Неопределено) Тогда
		Запрос.УстановитьПараметр("парамФизлицо", Физлицо);
		УсловиеНаФизлицоТекст = " И СтрокиНДФЛ.Физлицо = &парамФизлицо ";	
	Иначе
		УсловиеНаФизлицоТекст="";
	КонецЕсли;
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СтрокиНДФЛ.НомерСтроки,
	|	СтрокиНДФЛ.МесяцНалоговогоПериода КАК МесяцНалоговогоПериода,
	|	СтрокиНДФЛ.Налог,
	|	СтрокиНДФЛ.ПримененныйВычетЛичный,
	|	СтрокиНДФЛ.ПримененныйВычетНаДетей,
	|	СтрокиНДФЛ.ПримененныйВычетНаДетейЛьгота,
	|	СтрокиНДФЛ.ПримененныйвычетДополнительный,
	
	//Аверсон ЕАЕ 12.01.2024 СВФР-012095
	|	СтрокиНДФЛ.ПримененныйВычетМолодыеСпециалисты,
	//Аверсон СВФР-012095
	
	|	СтрокиНДФЛ.ФизЛицо КАК ФизЛицо,
	|	СтрокиНДФЛ.ПримененныйВычетИмущественныйРасход,
	|	СтрокиНДФЛ.ПримененныйВычетСоциальныйСПроцентами,
	|	СтрокиНДФЛ.ПримененныйВычетСтраховойРасход,
	|	СтрокиНДФЛ.ПримененныйВычетСтраховойРасход641, //Аверсон 03.08.2023 КВВ СВФР-011182
	|	СтрокиНДФЛ.ПодразделениеОрганизации,
	|	СтрокиНДФЛ.НалогПоСтавке09,
	|	СтрокиНДФЛ.НалогПоСтавке9,
	|	СтрокиНДФЛ.НалогПоСтавке35,
	|	СтрокиНДФЛ.НалогПоСтавке40
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК СтрокиНДФЛ
	|
	|ГДЕ
	|	СтрокиНДФЛ.Ссылка = &ДокументСсылка" + УсловиеНаФизлицоТекст + "
	|
	|УПОРЯДОЧИТЬ ПО
	|	ФизЛицо,
	|	МесяцНалоговогоПериода";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоНДФЛ()

// Формирует запрос по таблице "НДФЛ" документа
//
// Параметры: 
//	нет
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоНДФЛудержанный()
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СУММА(СтрокиНДФЛ.Налог) КАК Налог,
	|	СтрокиНДФЛ.ФизЛицо КАК ФизЛицо
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК СтрокиНДФЛ
	|ГДЕ
	|	СтрокиНДФЛ.Ссылка = &ДокументСсылка
	|
	|СГРУППИРОВАТЬ ПО
	|	СтрокиНДФЛ.ФизЛицо
	|
	|ИМЕЮЩИЕ
	|	СУММА(СтрокиНДФЛ.Налог) > 0
	|
	|УПОРЯДОЧИТЬ ПО
	|	ФизЛицо";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоНДФЛудержанный()

// Формирует запрос по таблице "НДФЛ" документа для расчета сумм НДФЛ к зачету
//
// Параметры: 
//	нет
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоНДФЛКЗачету()
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("ПериодРегистрации", КонецМесяца(ПериодРегистрации)+1);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СУММА(СтрокиНДФЛ.Налог) КАК Налог,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток, 0) + ЕСТЬNULL(СуммыУчтенныеДокументом.СуммаНДФЛКЗачету, 0) > ВЫБОР
	|				КОГДА СУММА(СтрокиНДФЛ.Налог) > 0
	|					ТОГДА СУММА(СтрокиНДФЛ.Налог)
	|				ИНАЧЕ 0
	|			КОНЕЦ
	|			ТОГДА СУММА(СтрокиНДФЛ.Налог)
	|		ИНАЧЕ ЕСТЬNULL(НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток, 0) + ЕСТЬNULL(СуммыУчтенныеДокументом.СуммаНДФЛКЗачету, 0)
	|	КОНЕЦ КАК НДФЛКЗачетуУчтено,
	|	СтрокиНДФЛ.ФизЛицо,
	|	ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13) КАК СтавкаНалогообложенияРезидента
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК СтрокиНДФЛ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.НДФЛКЗачету.Остатки(
	|				&ПериодРегистрации,
	|				Физлицо В
	|						(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|							Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ.ФизЛицо
	|						ИЗ
	|							Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ
	|						ГДЕ
	|							Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ.Ссылка = &ДокументСсылка)
	|					И Организация = &Организация
	|					И СтавкаНалогообложенияРезидента = ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13)) КАК НДФЛКЗачету
	|		ПО (НДФЛКЗачету.ФизЛицо = СтрокиНДФЛ.ФизЛицо)
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			НДФЛКЗачету.ФизЛицо КАК ФизЛицо,
	|			СУММА(НДФЛКЗачету.СуммаНДФЛКЗачету) КАК СуммаНДФЛКЗачету
	|		ИЗ
	|			РегистрНакопления.НДФЛКЗачету КАК НДФЛКЗачету
	|		ГДЕ
	|			НДФЛКЗачету.ФизЛицо В
	|					(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|						Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ.ФизЛицо
	|					ИЗ
	|						Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ
	|					ГДЕ
	|						Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ.Ссылка = &ДокументСсылка)
	|			И НДФЛКЗачету.Организация = &Организация
	|			И НДФЛКЗачету.СтавкаНалогообложенияРезидента = ЗНАЧЕНИЕ(Перечисление.НДФЛСтавкиНалогообложенияРезидента.Ставка13)
	|			И НДФЛКЗачету.Регистратор = &ДокументСсылка
	|			И НДФЛКЗачету.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		
	|		СГРУППИРОВАТЬ ПО
	|			НДФЛКЗачету.ФизЛицо) КАК СуммыУчтенныеДокументом
	|		ПО СтрокиНДФЛ.ФизЛицо = СуммыУчтенныеДокументом.ФизЛицо
	|ГДЕ
	|	СтрокиНДФЛ.Ссылка = &ДокументСсылка
	|
	|СГРУППИРОВАТЬ ПО
	|	СтрокиНДФЛ.ФизЛицо,
	|	НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток,
	|	СуммыУчтенныеДокументом.СуммаНДФЛКЗачету
	|
	|ИМЕЮЩИЕ
	|	(СУММА(СтрокиНДФЛ.Налог) < 0
	|		ИЛИ ВЫБОР
	|			КОГДА ЕСТЬNULL(НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток, 0) + ЕСТЬNULL(СуммыУчтенныеДокументом.СуммаНДФЛКЗачету, 0) > ВЫБОР
	|					КОГДА СУММА(СтрокиНДФЛ.Налог) > 0
	|						ТОГДА СУММА(СтрокиНДФЛ.Налог)
	|					ИНАЧЕ 0
	|				КОНЕЦ
	|				ТОГДА СУММА(СтрокиНДФЛ.Налог)
	|			ИНАЧЕ ЕСТЬNULL(НДФЛКЗачету.СуммаНДФЛКЗачетуОстаток, 0) + ЕСТЬNULL(СуммыУчтенныеДокументом.СуммаНДФЛКЗачету, 0)
	|		КОНЕЦ <> 0)";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоНДФЛКЗачету

// Формирует запрос по таблице "ПенсионныйФонд" документа
//
// Параметры: 
//	нет
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоПенсионномуФонду(Физлицо = Неопределено)
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("ПериодРегистрации", ПериодРегистрации);
	Если НЕ (Физлицо = Неопределено) Тогда
		Запрос.УстановитьПараметр("парамФизлицо", Физлицо);
		УсловиеНаФизлицоТекст = " И НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.Физлицо = &парамФизлицо ";	
	Иначе
		УсловиеНаФизлицоТекст="";
	КонецЕсли;
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.НомерСтроки,
	|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.ФизЛицо КАК ФизЛицо,
	|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.Налог,
	|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.МесяцНалоговогоПериода КАК МесяцНалоговогоПериода,
	|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.ПроцентФСЗН КАК ПроцентФСЗН
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд
	|ГДЕ
	|	НачислениеЗарплатыРаботникамОрганизацийПенсионныйФонд.Ссылка = &ДокументСсылка" + УсловиеНаФизлицоТекст + "
	|
	|УПОРЯДОЧИТЬ ПО
	|	ФизЛицо,
	|	МесяцНалоговогоПериода";
	
	Возврат Запрос.Выполнить();
КонецФункции

// Формирует запрос по таблице "ПогашениеЗайма" документа
//
// Параметры: 
//	нет
// Возвращаемое значение:
//  Результат запроса.
//
Функция СформироватьЗапросПоПогашениеЗайма()
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("Ставка13", Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13);
	//Рф Мат. выгода
	//Запрос.УстановитьПараметр("Код13", Справочники.ДоходыНДФЛ.Код2610ПоСтавке13);
	//Запрос.УстановитьПараметр("Код35", Справочники.ДоходыНДФЛ.Код2610ПоСтавке35);
	////////////////////////////////////////////////////////////////////////////////
	Запрос.УстановитьПараметр("Код13", Справочники.ДоходыНДФЛ.Код99998проценты);
	Запрос.УстановитьПараметр("Код35", Справочники.ДоходыНДФЛ.Код99999товары);
	
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СтрокиПогашениеЗайма.НомерСтроки,
	|	СтрокиПогашениеЗайма.ФизЛицо,
	|	СтрокиПогашениеЗайма.ДоговорЗайма,
	|	СтрокиПогашениеЗайма.НачисленоПроцентов,
	|	СтрокиПогашениеЗайма.ПогашеноПроцентов,
	|	СтрокиПогашениеЗайма.ПогашеноЗайма,
	|	СтрокиПогашениеЗайма.МатериальнаяВыгода,
	|	СтрокиПогашениеЗайма.НалогНаМатериальнуюВыгоду,
	|	ВЫБОР
	|		КОГДА СтрокиПогашениеЗайма.СтавкаНалогообложенияМатвыгоды = &Ставка13
	|			ТОГДА &Код13
	|		ИНАЧЕ &Код35
	|	КОНЕЦ КАК КодДохода,
	|	СтрокиПогашениеЗайма.СтавкаНалогообложенияМатвыгоды,
	|	СтрокиПогашениеЗайма.ПодразделениеОрганизации,
	|	ЕСТЬNULL(СтрокиПогашениеЗайма.ДоговорЗайма.НачислятьМатериальнуюВыгоду, ЛОЖЬ) КАК ПроверятьМатериальнуюВыгоду
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов КАК СтрокиПогашениеЗайма
	|ГДЕ
	|	СтрокиПогашениеЗайма.Ссылка = &ДокументСсылка";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоПогашениеЗайма

// Проверяет правильность заполнения шапки документа.
// Если какой-то из реквизтов шапки, влияющий на проведение, не заполнен или
// заполнен некорректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса по шапке,
// все проверяемые реквизиты должны быть включены в выборку по шапке.
//
// Параметры: 
//  ВыборкаПоШапкеДокумента	- выборка из результата запроса по шапке документа,
//  Отказ 					- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеШапки(ВыборкаПоШапкеДокумента, Отказ, Заголовок = "")
	
	//  Организация
	Если НЕ ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.ГоловнаяОрганизация) Тогда
		ОбщегоНазначения.СообщитьОбОшибке("Не указана организация, по которой начисляется зарплата!", Отказ, Заголовок);
	КонецЕсли;
	// соответствие периодов документа и перерассчитываемого документа
	Если ВыборкаПоШапкеДокумента.ПериодПерерасчета <> null 
		и ВыборкаПоШапкеДокумента.ПериодРегистрации <= ВыборкаПоШапкеДокумента.ПериодПерерасчета Тогда
		ОбщегоНазначения.СообщитьОбОшибке("Период документа должен быть больше периода перерассчитываемого документа!", Отказ, Заголовок);
	КонецЕсли;
	// соответствие организаций документа и перерассчитываемого документа
	Если ВыборкаПоШапкеДокумента.ОрганизацияПерерасчета <> null 
		и ВыборкаПоШапкеДокумента.ОбособленноеПодразделение <> ВыборкаПоШапкеДокумента.ОрганизацияПерерасчета Тогда
		ОбщегоНазначения.СообщитьОбОшибке("Организация, заданная для документа, должна совпадать с организацией перерассчитываемого документа!", Отказ, Заголовок);
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеШапки()

// Проверяет правильность заполнения реквизитов в строке ТЧ "Начисления" документа.
// Если какой-то из реквизтов, влияющий на проведение, не заполнен или
// заполнен некорректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса к ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//  							  из результата запроса к ТЧ документа, 
//  Отказ 						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиНачисления(ВыборкаПоСтрокамДокумента, Отказ, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Начисления"": ";
	
	// Сотрудник
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.Сотрудник) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбран сотрудник!", Отказ, Заголовок);
	КонецЕсли;
	
	// Организация сотрудника должна совпадать с организацией документа
	Если ВыборкаПоСтрокамДокумента.ОшибкаНеСоответствиеСотрудникаИОрганизации Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "указанный сотрудник оформлен на другую организацию!", Отказ, Заголовок);
	КонецЕсли;
	
	// ВидРасчета
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ВидРасчета) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан вид расчета!", Отказ, Заголовок);
	КонецЕсли;
	
	// Дата начала
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПериодДействияНачало) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала начисления!", Отказ, Заголовок);
	КонецЕсли;
	
	// Дата окончания
	Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПериодДействияКонец) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата окончания начисления!", Отказ, Заголовок);
	КонецЕсли;
	
	// Проверка соответствия Даты начала и Даты окончания
	Если ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПериодДействияКонец) и ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПериодДействияНачало) Тогда
		Если ВыборкаПоСтрокамДокумента.ПериодДействияКонец < ВыборкаПоСтрокамДокумента.ПериодДействияНачало Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "дата окончания начисления не должна быть меньше даты начала!", Отказ, Заголовок);
		ИначеЕсли НачалоМесяца(ВыборкаПоСтрокамДокумента.ПериодДействияКонец) <> НачалоМесяца(ВыборкаПоСтрокамДокумента.ПериодДействияНачало) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "даты начала и окончания начисления должны принадлежать одному месяцу!", Отказ, Заголовок);
		КонецЕсли;
	КонецЕсли;	
	
	// Дата начала события
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДатаНачалаСобытия) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала события!", Отказ, Заголовок);
	КонецЕсли;
	
	Если ВыборкаПоСтрокамДокумента.ЯвляетсяПочасовымОтклонением Тогда
		// ВидИспользованияРабочегоВремени
		Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ВидИспользованияРабочегоВремени) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан учет времени для вида расчета!", Отказ, Заголовок);
		КонецЕсли;
		
		// ОплачиватьЧасов
		Если ВыборкаПоСтрокамДокумента.ОплачиватьЧасов <= 0 Или ВыборкаПоСтрокамДокумента.ОплачиватьЧасов > 24 Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "количество оплачиваемых часов должно быть положительным и не превышать 24!", Отказ, Заголовок);
		КонецЕсли;
	КонецЕсли;
	
	//Аверсон 16.10.2019 КВВ СВФР-004925 (
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации) Тогда
		СтрокаНачалаСообщенияОбОшибке_ = СтрЗаменить(СтрокаНачалаСообщенияОбОшибке,": "," (" + ВыборкаПоСтрокамДокумента.Сотрудник.Наименование + "): ");
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке_ + "не указано подразделение!", Ложь, Заголовок);
	КонецЕсли;
	//Аверсон 16.10.2019 КВВ СВФР-004925 )
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиНачисления()

// Проверяет правильность заполнения реквизитов в строке ТЧ "ДополнительныеНачисления" документа.
// Если какой-то из реквизтов, влияющий на проведение, не заполнен или
// заполнен некорректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса к ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//  							  из результата запроса к ТЧ документа, 
//  Отказ 						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиДопНачисления(ВыборкаПоСтрокамДокумента, Отказ, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Доп. начисления"": ";
	
	// Сотрудник
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.Сотрудник) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбран сотрудник!", Отказ, Заголовок);
	КонецЕсли;
	
	// Организация сотрудника должна совпадать с организацией документа
	Если ВыборкаПоСтрокамДокумента.ОшибкаНеСоответствиеСотрудникаИОрганизации Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "указанный сотрудник оформлен на другую организацию!", Отказ, Заголовок);
	КонецЕсли;
	
	// ВидРасчета
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ВидРасчета) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан вид расчета!", Отказ, Заголовок);
	ИначеЕсли ВыборкаПоСтрокамДокумента.Авторасчет  Тогда
		//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
		Если ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом
			или ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы
			или ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП //О.Т. Аверсон 04.11.2016 № 1501
			Или ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.СевернаяНадбавка
			Или ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ОтСтажаПроцентом Тогда
			
			// Дата начала
			Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.БазовыйПериодНачало) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала базового периода начисления!", Отказ, Заголовок);
			КонецЕсли;
			// Дата окончания
			Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.БазовыйПериодКонец) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата окончания базового периода начисления!", Отказ, Заголовок);
			КонецЕсли;
			
		ИначеЕсли ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработку
			Или ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням
			Или ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоШестидневке	Тогда
			
			// Дата начала события
			Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДатаНачалаСобытия) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала события!", Отказ, Заголовок);
			КонецЕсли;
			// Дата начала
			Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПериодРасчетаСреднегоЗаработкаНачало) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала расчетного периода для исчисления среднего заработка!", Отказ, Заголовок);
			КонецЕсли;
			// Дата окончания
			Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПериодРасчетаСреднегоЗаработкаОкончание) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата окончания расчетного периода для исчисления среднего заработка!", Отказ, Заголовок);
			КонецЕсли;
			
		КонецЕсли;
	КонецЕсли;
	
	// Проверка на сумму вычета
	Если ВыборкаПоСтрокамДокумента.СуммаВычета <> 0 И Не ПроведениеРасчетов.ВычетСоответствуетДоходу(ВыборкаПоСтрокамДокумента.КодДоходаНДФЛ, ВыборкаПоСтрокамДокумента.КодВычета, мСоответствиеДоходовИВычетов) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "указанный код вычета не предусмотрен для кода дохода (" + ?(ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.КодДоходаНДФЛ), СокрЛП(ВыборкаПоСтрокамДокумента.КодДоходаНДФЛ), "не указан") + "), с которым будет зарегистрировано в учете по Подоходному налогу начисление """ + ?(ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ВидРасчета), ВыборкаПоСтрокамДокумента.ВидРасчета, "<не указано>") + """!", Отказ, Заголовок);
	КонецЕсли;
	//Аверсон 16.10.2019 КВВ СВФР-004925 (
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации) Тогда
		СтрокаНачалаСообщенияОбОшибке_ = СтрЗаменить(СтрокаНачалаСообщенияОбОшибке,": "," (" + ВыборкаПоСтрокамДокумента.Сотрудник.Наименование + "): ");
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке_ + "не указано подразделение!", Ложь, Заголовок);
	КонецЕсли;
	//Аверсон 16.10.2019 КВВ СВФР-004925 )
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиДопНачисления()

// Проверяет правильность заполнения реквизитов в строке ТЧ "ДоговорыНаВыполнениеРабот" документа.
// Если какой-то из реквизтов, влияющий на проведение, не заполнен или
// заполнен некорректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса к ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//  							  из результата запроса к ТЧ документа, 
//  Отказ 						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиДоговора(ВыборкаПоСтрокамДокумента, Отказ, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Договора"": ";
	
	// Сотрудник
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.Сотрудник) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбран сотрудник!", Отказ, Заголовок);
	КонецЕсли;
	
	// Организация сотрудника должна совпадать с организацией документа
	Если ВыборкаПоСтрокамДокумента.ОшибкаНеСоответствиеСотрудникаИОрганизации Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "указанный сотрудник оформлен на другую организацию!", Отказ, Заголовок);
	КонецЕсли;
	
	// ВидРасчета
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ВидРасчета) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан вид расчета!", Отказ, Заголовок);
		//Аверсон-софт, Островская Татьяна 21.03.2012 №15092
	ИначеЕсли ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.Процентом
		или ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПроцентомОтТарифаИБазы
		или ВыборкаПоСтрокамДокумента.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ИндексацияЗП Тогда  //О.Т. Аверсон 04.11.2016 № 1501
		// Дата начала
		Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.БазовыйПериодНачало) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала базового периода начисления!", Отказ, Заголовок);
		КонецЕсли;
		// Дата окончания
		Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.БазовыйПериодКонец) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата окончания базового периода начисления!", Отказ, Заголовок);
		КонецЕсли;
		
	КонецЕсли;
	
	// ДокументОснование
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДокументОснование) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан договор-основание!", Отказ, Заголовок);
	КонецЕсли;
	
	// Проверка на сумму вычета
	Если ВыборкаПоСтрокамДокумента.СкидкаПриНалогообложении <> 0 И Не ПроведениеРасчетов.ВычетСоответствуетДоходу(ВыборкаПоСтрокамДокумента.КодДоходаНДФЛ, ВыборкаПоСтрокамДокумента.КодВычета, мСоответствиеДоходовИВычетов) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "указанный код вычета не предусмотрен для кода дохода (" + ?(ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.КодДоходаНДФЛ), СокрЛП(ВыборкаПоСтрокамДокумента.КодДоходаНДФЛ), "не указан") + "), с которым будет зарегистрировано в учете по НДФЛ начисление """ + ?(ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ВидРасчета), ВыборкаПоСтрокамДокумента.ВидРасчета, "<не указано>") + """!", Отказ, Заголовок);
	КонецЕсли;
	
	//Аверсон 16.10.2019 КВВ СВФР-004925 (
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации) Тогда
		СтрокаНачалаСообщенияОбОшибке_ = СтрЗаменить(СтрокаНачалаСообщенияОбОшибке,": "," (" + ВыборкаПоСтрокамДокумента.Сотрудник.Наименование + "): ");
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке_ + "не указано подразделение!", Ложь, Заголовок);
	КонецЕсли;
	//Аверсон 16.10.2019 КВВ СВФР-004925 )
КонецПроцедуры // ПроверитьЗаполнениеСтрокиДоговора()

// Проверяет правильность заполнения реквизитов в строке ТЧ "Удержания" документа.
// Если какой-то из реквизтов, влияющий на проведение, не заполнен или
// заполнен некорректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса к ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//  							  из результата запроса к ТЧ документа, 
//  Отказ 						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиУдержания(ВыборкаПоСтрокамДокумента, Отказ, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Удержания"": ";
	
	// ФизЛицо
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ФизЛицо) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбрано физическое лицо!", Отказ, Заголовок);
	КонецЕсли;
	
	// ВидРасчета
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ВидРасчета) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан вид расчета!", Отказ, Заголовок);
	ИначеЕсли ВыборкаПоСтрокамДокумента.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.УдержаниеФиксированнойСуммой и 
		ВыборкаПоСтрокамДокумента.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.ИсполнительныйЛистФиксСуммойДоПредела Тогда
		
		// Дата начала
		Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДатаНачала) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала удержания!", Отказ, Заголовок);
		КонецЕсли;
		
		// Дата окончания
		Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДатаОкончания) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата окончания удержания!", Отказ, Заголовок);
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиУдержания()

Процедура ПроверитьЗаполнениеСтрокиДопПенсии(ВыборкаПоСтрокамДокумента, Отказ, Заголовок = "")
	//Аверсон 01.07.2022 КВВ СВФР-009250 (
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Доп.пенсия"": ";
	
	// ФизЛицо
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ФизЛицо) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбрано физическое лицо!", Отказ, Заголовок);
	КонецЕсли;
	
	// Дата начала
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДатаНачала) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана дата начала удержания!", Отказ, Заголовок);
	КонецЕсли;
	//Аверсон 01.07.2022 КВВ СВФР-009250 )			
КонецПроцедуры


// Проверяет правильность заполнения реквизитов в строке ТЧ "НДФЛ" документа.
// Если какой-то из реквизтов, влияющий на проведение, не заполнен или
// заполнен некорректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса к ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//  							  из результата запроса к ТЧ документа, 
//  Отказ 						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиНДФЛ(ВыборкаПоСтрокамДокумента, Отказ, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Подоходный налог"": ";
	
	// ФизЛицо
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ФизЛицо) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбрано физическое лицо!", Отказ, Заголовок);
	КонецЕсли;
	
	// месяц налогового периода
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не задан месяц налогового периода!", Отказ, Заголовок);
	КонецЕсли;
	//Аверсон 16.10.2019 КВВ СВФР-004925 (
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации) И ВыборкаПоСтрокамДокумента.Налог <> 0 Тогда
		СтрокаНачалаСообщенияОбОшибке_ = СтрЗаменить(СтрокаНачалаСообщенияОбОшибке,": "," (" + ВыборкаПоСтрокамДокумента.ФизЛицо.Наименование + "): ");
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке_ + "не указано подразделение!", Ложь, Заголовок);
	КонецЕсли;
	//Аверсон 16.10.2019 КВВ СВФР-004925 )
КонецПроцедуры // ПроверитьЗаполнениеСтрокиНДФЛ()

// Проверяет правильность заполнения реквизитов в строке ТЧ "ПенсионныйФонд" документа.
// Если какой-то из реквизтов, влияющий на проведение, не заполнен или
// заполнен некорректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса к ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//  							  из результата запроса к ТЧ документа, 
//  Отказ 						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиПенсонныйФонд(ВыборкаПоСтрокамДокумента, Отказ, Заголовок = "")
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""ПенсионныйФонд"": ";
	
	// ФизЛицо
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ФизЛицо) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбрано физическое лицо!", Отказ, Заголовок);
	КонецЕсли;
	
	// месяц налогового периода
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не задан месяц налогового периода!", Отказ, Заголовок);
	КонецЕсли;
	
КонецПроцедуры //

// Проверяет правильность заполнения реквизитов в строке ТЧ "ПогашениеЗайма" документа.
// Если какой-то из реквизтов, влияющий на проведение, не заполнен или
// заполнен некорректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса к ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//  							  из результата запроса к ТЧ документа, 
//  Отказ 						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиПогашениеЗайма(ВыборкаПоСтрокамДокумента, Отказ, Заголовок)
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Погашение займов"": ";
	
	// ФизЛицо
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ФизЛицо) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбрано физическое лицо!", Отказ, Заголовок);
	КонецЕсли;
	// ДоговорЗайма
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДоговорЗайма) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не задан договор займа погашение которого выполняется!", Отказ, Заголовок);
	КонецЕсли;
	// СтавкаНалогообложенияМатвыгоды
	Если ВыборкаПоСтрокамДокумента.ПроверятьМатериальнуюВыгоду И НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.СтавкаНалогообложенияМатвыгоды) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана ставка налогообложения матвыгоды!", Отказ, Заголовок);
	КонецЕсли;
	//Аверсон 16.10.2019 КВВ СВФР-004925 (
	Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации) Тогда
		//СтрокаНачалаСообщенияОбОшибке_ = СтрЗаменить(СтрокаНачалаСообщенияОбОшибке,": "," (" + ВыборкаПоСтрокамДокумента.Сотрудник.Наименование + "): ");
		СтрокаНачалаСообщенияОбОшибке_ = СтрЗаменить(СтрокаНачалаСообщенияОбОшибке,": "," (" + ВыборкаПоСтрокамДокумента.ФизЛицо.Наименование + "): "); //Аверсон 11.08.2023 КВВ СВФР-011240
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке_ + "не указано подразделение!", Ложь, Заголовок);
	КонецЕсли;
	//Аверсон 16.10.2019 КВВ СВФР-004925 )
КонецПроцедуры // ПроверитьЗаполнениеСтрокиНДФЛ()

// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента				- спозиционированная на определеной строке выборка 
//				  							  из результата запроса к ТЧ документа, 
//	НаборЗаписей							- набор записей для УдержанияРаботниковОрганизации 
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуУдержаний(ВыборкаПоСтрокамДокумента, ВыборкаПоШапкеДокумента, НаборЗаписей, ПроводитьЗадолженность=Ложь)
	
	Движение = НаборЗаписей.Добавить();
	
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоШапкеДокумента);		// ПериодРегистрации, ОбособленноеПодразделение
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоСтрокамДокумента);	// БазовыйПериодНачало, БазовыйПериодКонец, ВидРасчета, Сторно
	// ФизЛицо, Организация,
	// Результат, Размер, ДокументОснование, Авторасчет, ПорядокРасчетаБазы
	// ДатаНачалаСобытия,ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание,
	//толик исполнительные
	Если ПроводитьЗадолженность Тогда
		Если ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДокументОснование) И ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.Показатель2) Тогда
			ДвижениеИЛ = Движения.ЗадолженностьПоИсполнительнымЛистам.Добавить();
			ДвижениеИЛ.ВидДвижения = ВидДвиженияНакопления.Приход;
			ДвижениеИЛ.Период = ВыборкаПоШапкеДокумента.ПериодРегистрации;
			ДвижениеИЛ.ИсполнительныйЛист = ВыборкаПоСтрокамДокумента.ДокументОснование;
			ДвижениеИЛ.Сумма = ВыборкаПоСтрокамДокумента.Показатель2;
		КонецЕсли;
		Если ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДокументОснование) И ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.Показатель3) Тогда
			ДвижениеИЛ = Движения.ЗадолженностьПоИсполнительнымЛистам.Добавить();
			ДвижениеИЛ.ВидДвижения = ВидДвиженияНакопления.Расход;
			ДвижениеИЛ.Период = ВыборкаПоШапкеДокумента.ПериодРегистрации;
			ДвижениеИЛ.ИсполнительныйЛист = ВыборкаПоСтрокамДокумента.ДокументОснование;
			ДвижениеИЛ.Сумма = ВыборкаПоСтрокамДокумента.Показатель3;
		КонецЕсли;
	Иначе
		//обнулим значения
		Если ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДокументОснование) И ВыборкаПоСтрокамДокумента.Авторасчет Тогда
			Движение.Результат = 0;
			Движение.Показатель2 = 0;
			Движение.Показатель3 = 0;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры // ДобавитьСтрокуУдержаний

// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//				  				  из результата запроса к ТЧ документа, 
//  ВыборкаПоШапкеДокумента		- выборка по данным шапки документа
//	НаборЗаписей				- набор записей для НДФЛРасчетыСБюджетом
//
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуПенсионныйФонд(ВыборкаПоСтрокамДокумента, ВыборкаПоШапкеДокумента, НаборЗаписей, НаборЗаписейУдержания)
	
	Если  ВыборкаПоСтрокамДокумента.Налог <> 0 тогда
		Движение = НаборЗаписей.Добавить();
		
		// Свойства
		Движение.Период						= НачалоМесяца(ПериодРегистрации);
		
		// Измерения
		Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.ПериодВзаиморасчетов    		= ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
		Движение.ПроцентФСЗН                    = ВыборкаПоСтрокамДокумента.ПроцентФСЗН;
		// Ресурсы
		Движение.ПенсионныйФонд						= ВыборкаПоСтрокамДокумента.Налог;
		
		// Реквизиты 
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		//
		//  Движение = НаборЗаписейУдержания.Добавить();
		//  
		//   //Свойства
		//  Движение.ПериодРегистрации          = ПериодРегистрации;
		//  Движение.БазовыйПериодНачало        = НачалоМесяца(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		//  Движение.БазовыйПериодКонец		    = КонецМесяца(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		//  Движение.ВидРасчета				    = ПланыВидовРасчета.УдержанияОрганизаций.ПенсионныйФонд;
		//  Движение.Сторно				    	= ?(ВыборкаПоСтрокамДокумента.Налог >= 0, Ложь, Истина);
		
		//  // Измерения
		//  Движение.ФизЛицо                    = ВыборкаПоСтрокамДокумента.ФизЛицо;
		//  Движение.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		
		//  // Ресурсы
		//  Движение.Результат					= ВыборкаПоСтрокамДокумента.Налог;
		
		//  // Реквизиты
		//Движение.ОбособленноеПодразделение = ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		//  //Движение.Размер  	                = 1;
		//  Движение.ДокументОснование          =  ЭтотОбъект;
		//О.Т. Аверсон 17.04.2019 № 4243
		//+ СВЭЙ КДЯ 14.02.20 СВФР-005514
		СотрудникОсн = Неопределено;
		//- СВЭЙ КДЯ 14.02.20 СВФР-005514
		ПараметрыОтбора = Новый Структура;
		ПараметрыОтбора.Вставить("ФизЛицо", ВыборкаПоСтрокамДокумента.ФизЛицо);
		СотрудникИзТЧОсн = Начисления.НайтиСтроки(ПараметрыОтбора);
		если СотрудникИзТЧОсн.Количество() > 0 Тогда 
			СотрудникОсн = СотрудникИзТЧОсн[0].Сотрудник;
		КонецЕсли;	
		если не ЗначениеЗаполнено(СотрудникОсн) Тогда 
			СотрудникИзТЧДоп = ДополнительныеНачисления.НайтиСтроки(ПараметрыОтбора);
			если СотрудникИзТЧДоп.Количество() > 0 Тогда 
				СотрудникОсн = СотрудникИзТЧДоп[0].Сотрудник;
			КонецЕсли;
		КонецЕсли;
		если не ЗначениеЗаполнено(СотрудникОсн) Тогда 
			СотрудникИзТЧДоп = ДоговорыНаВыполнениеРабот.НайтиСтроки(ПараметрыОтбора);
			если СотрудникИзТЧДоп.Количество() > 0 Тогда 
				СотрудникОсн = СотрудникИзТЧДоп[0].Сотрудник;
			КонецЕсли;
		КонецЕсли;
		если не ЗначениеЗаполнено(СотрудникОсн) Тогда 
			СотрудникОсн = Справочники.СотрудникиОрганизаций.НайтиПоНаименованию(ВыборкаПоСтрокамДокумента.ФизЛицо.Наименование);
		КонецЕсли;
		СтрокаНабора = Движения.ЕСНИсчисленныйПоСотрудникам.Добавить();
		// Свойства
		СтрокаНабора.Период						= НачалоМесяца(ПериодРегистрации);
		
		// Измерения
		СтрокаНабора.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
		СтрокаНабора.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		СтрокаНабора.ПериодВзаиморасчетов    		= ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
		СтрокаНабора.ПроцентФСЗН                    = ВыборкаПоСтрокамДокумента.ПроцентФСЗН;
		// Ресурсы
		СтрокаНабора.ПенсионныйФонд						= ВыборкаПоСтрокамДокумента.Налог;
		
		// Реквизиты 
		СтрокаНабора.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение; 
		СтрокаНабора.Сотрудник = СотрудникОсн;
		//О.Т. Аверсон 17.04.2019 № 4243 
		
		
		//Аверсон 04.10.2022 КВВ СВФР-009604 (
		Если КонецМесяца(ПериодРегистрации) > КонецДня(Дата(2022, 09, 30)) 
			И КонецМесяца(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода) > КонецДня(Дата(2022, 09, 30)) Тогда
			СтрокаНабораДДДПУ3 = Движения.ДопДанныеДляПУ3.Добавить();
			СтрокаНабораДДДПУ3.Период = НачалоМесяца(ПериодРегистрации);
			СтрокаНабораДДДПУ3.Сотрудник = СотрудникОсн;
			СтрокаНабораДДДПУ3.Организация = ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
			СтрокаНабораДДДПУ3.ПериодВзаиморасчетов = ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
			СтрокаНабораДДДПУ3.ПенсионныйФонд	 = ВыборкаПоСтрокамДокумента.Налог;
		КонецЕсли;
		//Аверсон 04.10.2022 КВВ СВФР-009604 )
		
	КонецЕсли;
	
КонецПроцедуры // ДобавитьСтрокуДобавитьСтрокуПенсионныйФонд


// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//				  				  из результата запроса к ТЧ документа, 
//  ВыборкаПоШапкеДокумента		- выборка по данным шапки документа
//	НаборЗаписей				- набор записей для НДФЛРасчетыСБюджетом
//
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуНДФЛ(ВыборкаПоСтрокамДокумента, ВыборкаПоШапкеДокумента, НаборЗаписей, НаборИмущественныеВычеты)
	
	Если  ВыборкаПоСтрокамДокумента.Налог <> 0 
		ИЛИ ВыборкаПоСтрокамДокумента.ПримененныйВычетЛичный <> 0 
		ИЛИ ВыборкаПоСтрокамДокумента.ПримененныйВычетНаДетей <> 0
		ИЛИ ВыборкаПоСтрокамДокумента.ПримененныйВычетНаДетейЛьгота <> 0 
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		ИЛИ ВыборкаПоСтрокамДокумента.ПримененныйВычетМолодыеСпециалисты <> 0
		//Аверсон СВФР-012095
		
		ИЛИ ВыборкаПоСтрокамДокумента.ПримененныйВычетДополнительный <> 0 тогда
		Движение = НаборЗаписей.Добавить();
		
		// Свойства
		Движение.Период						= КонецМесяца(ПериодРегистрации);
		Движение.ВидДвижения				= ВидДвиженияНакопления.Приход;
		
		// Измерения
		Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.МесяцНалоговогоПериода     	= ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
		Движение.СтавкаНалогообложенияРезидента	= Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13;
		
		// Ресурсы
		Движение.Налог						= ВыборкаПоСтрокамДокумента.Налог;
		Движение.ПримененныйВычетЛичный		= ВыборкаПоСтрокамДокумента.ПримененныйВычетЛичный;
		Движение.ПримененныйВычетНаДетей	= ВыборкаПоСтрокамДокумента.ПримененныйВычетНаДетей;
		Движение.ПримененныйВычетНаДетейЛьгота	= ВыборкаПоСтрокамДокумента.ПримененныйВычетНаДетейЛьгота;
		Движение.ПримененныйДополнительныйВычет	= ВыборкаПоСтрокамДокумента.ПримененныйВычетДополнительный;
		
		//Аверсон ЕАЕ 12.01.2024 СВФР-012095
		Движение.ПримененныйВычетМолодыеСпециалисты	= ВыборкаПоСтрокамДокумента.ПримененныйВычетМолодыеСпециалисты;
		//Аверсон СВФР-012095
		
		// Реквизиты 
		Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ИсчисленоИзЗарплаты		= Истина;	
		
		//Аверсон 16.06.2020 КВВ СВФР-006138 (	
		ФлВыбораПодр = Организация.УчетПНПоПодразделениюИзШапкиДок;
		Если ФлВыбораПодр И ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.Ссылка.ПодразделениеОрганизации) Тогда
			Движение.ПодразделениеОрганизации	= ВыборкаПоШапкеДокумента.Ссылка.ПодразделениеОрганизации;
		Иначе
			//Аверсон 16.06.2020 КВВ СВФР-006138 )
			Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации;
		КонецЕсли;
	КонецЕсли;
	
	Если  ВыборкаПоСтрокамДокумента.НалогПоСтавке9 <> 0 тогда
		Движение = НаборЗаписей.Добавить();
		// Свойства
		Движение.Период						= КонецМесяца(ПериодРегистрации);
		
		// Измерения
		Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.МесяцНалоговогоПериода     	= ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
		Движение.СтавкаНалогообложенияРезидента	= Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка9;
		
		// Ресурсы
		Движение.Налог						= ВыборкаПоСтрокамДокумента.НалогПоСтавке9;
		
		// Реквизиты 
		Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ИсчисленоИзЗарплаты		= Истина;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
	КонецЕсли;
	
	Если  ВыборкаПоСтрокамДокумента.НалогПоСтавке09 <> 0 тогда
		Движение = НаборЗаписей.Добавить();
		// Свойства
		Движение.Период						= КонецМесяца(ПериодРегистрации);
		
		// Измерения
		Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.МесяцНалоговогоПериода     	= ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
		Движение.СтавкаНалогообложенияРезидента	= Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка09;
		
		// Ресурсы
		Движение.Налог						= ВыборкаПоСтрокамДокумента.НалогПоСтавке09;
		
		// Реквизиты 
		Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ИсчисленоИзЗарплаты		= Истина;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
	КонецЕсли;
	
	Если  ВыборкаПоСтрокамДокумента.НалогПоСтавке35 <> 0 тогда
		Движение = НаборЗаписей.Добавить();
		// Свойства
		Движение.Период						= КонецМесяца(ПериодРегистрации);
		
		// Измерения
		Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.МесяцНалоговогоПериода     	= ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
		Движение.СтавкаНалогообложенияРезидента	= Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка35;
		
		// Ресурсы
		Движение.Налог						= ВыборкаПоСтрокамДокумента.НалогПоСтавке35;
		
		// Реквизиты 
		Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ИсчисленоИзЗарплаты		= Истина;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
	КонецЕсли;
	
	Если  ВыборкаПоСтрокамДокумента.НалогПоСтавке40 <> 0 тогда
		Движение = НаборЗаписей.Добавить();
		// Свойства
		Движение.Период						= КонецМесяца(ПериодРегистрации);
		
		// Измерения
		Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.МесяцНалоговогоПериода     	= ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
		Движение.СтавкаНалогообложенияРезидента	= Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка40;
		
		// Ресурсы
		Движение.Налог						= ВыборкаПоСтрокамДокумента.НалогПоСтавке40;
		
		// Реквизиты 
		Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ИсчисленоИзЗарплаты		= Истина;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
	КонецЕсли;
	
	Если (ВыборкаПоСтрокамДокумента.ПримененныйВычетИмущественныйРасход <> 0) Тогда 
		Движение = НаборИмущественныеВычеты.Добавить();
		
		// Свойства
		Движение.Период						= КонецМесяца(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		Движение.ВидДвижения				= ВидДвиженияНакопления.Расход;
		
		// Измерения
		Движение.ФизЛицо                    = ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.Год					    = Год(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		Движение.КодВычетаИмущественный     = Справочники.ВычетыНДФЛ.Код650;
		
		// Ресурсы
		Движение.Размер						= ВыборкаПоСтрокамДокумента.ПримененныйВычетИмущественныйРасход; 
		
		// Реквизиты 
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
		
	КонецЕсли;
	
	Если (ВыборкаПоСтрокамДокумента.ПримененныйВычетСтраховойРасход <> 0) Тогда 
		Движение = НаборИмущественныеВычеты.Добавить();
		
		// Свойства
		Движение.Период						= КонецМесяца(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		Движение.ВидДвижения				= ВидДвиженияНакопления.Расход;
		
		// Измерения
		Движение.ФизЛицо                    = ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.Год					    = Год(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		Движение.КодВычетаИмущественный     = Справочники.ВычетыНДФЛ.Код640Страх;
		
		// Ресурсы
		Движение.Размер						= ВыборкаПоСтрокамДокумента.ПримененныйВычетСтраховойРасход; 
		
		// Реквизиты 
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
		
	КонецЕсли;
	
	//Аверсон 03.08.2023 КВВ СВФР-011182 (
	Если (ВыборкаПоСтрокамДокумента.ПримененныйВычетСтраховойРасход641 <> 0) Тогда 
		Движение = НаборИмущественныеВычеты.Добавить();
		
		// Свойства
		Движение.Период						= КонецМесяца(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		Движение.ВидДвижения				= ВидДвиженияНакопления.Расход;
		
		// Измерения
		Движение.ФизЛицо                    = ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.Год					    = Год(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		Движение.КодВычетаИмущественный     = Справочники.ВычетыНДФЛ.Код641Страх;
		
		// Ресурсы
		Движение.Размер						= ВыборкаПоСтрокамДокумента.ПримененныйВычетСтраховойРасход641; 
		
		// Реквизиты 
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
		
	КонецЕсли;
	//Аверсон 03.08.2023 КВВ СВФР-011182 )
	
	Если (ВыборкаПоСтрокамДокумента.ПримененныйВычетСоциальныйСПроцентами <> 0) Тогда
		
		Движение = НаборИмущественныеВычеты.Добавить();
		
		// Свойства
		Движение.Период						= КонецМесяца(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		Движение.ВидДвижения				= ВидДвиженияНакопления.Расход;
		
		// Измерения
		Движение.ФизЛицо                    = ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.Год					    = Год(ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода);
		Движение.КодВычетаИмущественный     = Справочники.ВычетыНДФЛ.Код640;
		
		// Ресурсы
		Движение.Размер						= ВыборкаПоСтрокамДокумента.ПримененныйВычетСоциальныйСПроцентами; 
		
		// Реквизиты 
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
		
	КонецЕсли;
	
КонецПроцедуры // ДобавитьСтрокуНДФЛ

// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//				  				  из результата запроса к ТЧ документа, 
//  ВыборкаПоШапкеДокумента		- выборка по данным шапки документа
//	НаборЗаписей				- набор записей для НДФЛРасчетыСБюджетом
//
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуНДФЛудержанный(ВыборкаСуммКУдержанию, ВыборкаПоСтрокамДокумента, ВыборкаПоНДФЛКЗачету, ВыборкаПоШапкеДокумента, НаборЗаписей)
	
	ОсталосьРаспределить = ВыборкаСуммКУдержанию.Налог; // положительная сумма исчисленного налога
	
	// учтем возможный зачет образовавшейся ранее переплаты налога
	ВыборкаПоНДФЛКЗачету.Сбросить();
	Если ВыборкаПоНДФЛКЗачету.НайтиСледующий(ВыборкаСуммКУдержанию.ФизЛицо,"ФизЛицо") Тогда
		ОсталосьРаспределить = ОсталосьРаспределить - ВыборкаПоНДФЛКЗачету.НДФЛКЗачетуУчтено;
	КонецЕсли;
	
	// распределим получившуюся сумму налога к удержанию по месяцам налогового периода 
	ВыборкаПоСтрокамДокумента.Сбросить();
	Пока ВыборкаПоСтрокамДокумента.НайтиСледующий(ВыборкаСуммКУдержанию.ФизЛицо,"ФизЛицо") Цикл
		
		Если ОсталосьРаспределить > 0 И ВыборкаПоСтрокамДокумента.Налог > 0 Тогда
			
			// расчет суммы удерживаемого налога
			ПогашаемаяСумма = Мин(ВыборкаПоСтрокамДокумента.Налог, ОсталосьРаспределить);
			ОсталосьРаспределить = ОсталосьРаспределить - ПогашаемаяСумма;
			
			Движение = НаборЗаписей.Добавить();
			
			// Свойства
			Движение.Период							= КонецМесяца(ПериодРегистрации);
			Движение.ВидДвижения					= ВидДвиженияНакопления.Расход;
			
			// Измерения
			Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
			Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
			Движение.МесяцНалоговогоПериода     	= ВыборкаПоСтрокамДокумента.МесяцНалоговогоПериода;
			Движение.СтавкаНалогообложенияРезидента	= Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13;
			
			// Ресурсы
			Движение.Налог						= ПогашаемаяСумма;
			
			// Реквизиты 
			Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Удержание;
			Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;				
			Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации; 
			
		КонецЕсли;  
		
	КонецЦикла;
	
КонецПроцедуры // ДобавитьСтрокуНДФЛудержанный

// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//				  				  из результата запроса к ТЧ документа, 
//  ВыборкаПоШапкеДокумента		- выборка по данным шапки документа
//	НаборЗаписей				- набор записей для НДФЛРасчетыСБюджетом
//
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуНДФЛКЗачету(ВыборкаПоСтрокамДокумента, ВыборкаПоШапкеДокумента)
	
	// НДФЛ к зачету
	Если ВыборкаПоСтрокамДокумента.Налог < 0 Тогда
		Движение = Движения.НДФЛКЗачету.Добавить();
		
		// Свойства
		Движение.Период						= КонецМесяца(ПериодРегистрации);
		Движение.ВидДвижения				= ВидДвиженияНакопления.Приход;
		
		// Измерения
		Движение.ФизЛицо	 	 	 	        = ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация				    = ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.СтавкаНалогообложенияРезидента	= ВыборкаПоСтрокамДокумента.СтавкаНалогообложенияРезидента;
		
		// Ресурсы
		Движение.СуммаНДФЛКЗачету			= - ВыборкаПоСтрокамДокумента.Налог;
		
	ИначеЕсли ВыборкаПоСтрокамДокумента.НДФЛКЗачетуУчтено <> 0 Тогда
		
		Движение = Движения.НДФЛКЗачету.Добавить();
		
		// Свойства
		Движение.Период						= КонецМесяца(ПериодРегистрации);
		Движение.ВидДвижения				= ВидДвиженияНакопления.Расход;
		
		// Измерения
		Движение.ФизЛицо	 	 	 	        = ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация				    = ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.СтавкаНалогообложенияРезидента	= ВыборкаПоСтрокамДокумента.СтавкаНалогообложенияРезидента;
		
		// Ресурсы
		Движение.СуммаНДФЛКЗачету			= ВыборкаПоСтрокамДокумента.НДФЛКЗачетуУчтено;
		
	КонецЕсли;
	
КонецПроцедуры // ДобавитьСтрокуНДФЛКЗачету

// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//				  				  из результата запроса к ТЧ документа, 
//  ВыборкаПоШапкеДокумента		- выборка по данным шапки документа
//	НаборЗаписей				- набор записей для НДФЛРасчетыСБюджетом
//
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуПогашениеЗайма(ВыборкаПоСтрокамДокумента, ВыборкаПоШапкеДокумента, НаборЗаписей, НаборЗаписейНДФЛСведенияОДоходах, НаборЗаписейНДФЛРасчетыСБюджетом, ФормироватьНДФЛудержанный)
	
	КонецМесяца = КонецМесяца(ПериодРегистрации);
	
	// начислено процентов
	Если ВыборкаПоСтрокамДокумента.НачисленоПроцентов <> 0 Тогда
		Движение = НаборЗаписей.Добавить();
		
		// Свойства
		Движение.Период						= КонецМесяца;
		Движение.ВидДвижения				= ВидДвиженияНакопления.Приход;
		
		// Измерения
		Движение.ФизЛицо                    = ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация				= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ДоговорЗайма				= ВыборкаПоСтрокамДокумента.ДоговорЗайма;
		
		// Ресурсы
		Движение.Проценты					= ВыборкаПоСтрокамДокумента.НачисленоПроцентов;
		Движение.УдержаноИзЗарплаты			= Истина;
	КонецЕсли;
	
	// пошашено процентов и основного долга
	Движение = НаборЗаписей.Добавить(); 
	// запись в регистр складываем всегда, даже если реально погашения не было
	// запись служит признаком того, что с займом уже работали
	
	// Свойства
	Движение.Период						= КонецМесяца;
	Движение.ВидДвижения				= ВидДвиженияНакопления.Расход;
	
	// Измерения
	Движение.ФизЛицо                    = ВыборкаПоСтрокамДокумента.ФизЛицо;
	Движение.Организация				= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
	Движение.ДоговорЗайма				= ВыборкаПоСтрокамДокумента.ДоговорЗайма;
	
	// Ресурсы
	Движение.Проценты					= ВыборкаПоСтрокамДокумента.ПогашеноПроцентов;
	// даже если начисленные проценты не погашены не увеличиваем основной долг - ограничиваем снизу 
	// размер погашения основного долга нулем
	Движение.ОсновнойДолг				= Макс(0, ВыборкаПоСтрокамДокумента.ПогашеноЗайма - ВыборкаПоСтрокамДокумента.ПогашеноПроцентов);
	
	// Реквизиты
	Движение.УдержаноИзЗарплаты			= Истина;
	Если Организация.ИНН = "790016243" Тогда  
		Если ВыборкаПоСтрокамДокумента.ДоговорЗайма<> Константы.ВалютаРегламентированногоУчета.Получить() Тогда
			КурсВыдачи =  ВыборкаПоСтрокамДокумента.ДоговорЗайма.КурсДокумента; 
			Курс = ОбщегоНазначения.ПолучитьКурсВалюты(ВыборкаПоСтрокамДокумента.ДоговорЗайма.ВалютаДокумента, КонецМесяца(ПериодРегистрации)).Курс;   
			СуммаВВалюте =  ВыборкаПоСтрокамДокумента.ДоговорЗайма.СуммаЗайма /ВыборкаПоСтрокамДокумента.ДоговорЗайма.СрокПогашения;
			Движение = НаборЗаписей.Добавить(); 
			
			Движение.Период						= КонецМесяца;
			// Измерения
			Движение.ФизЛицо                    = ВыборкаПоСтрокамДокумента.ФизЛицо;
			Движение.Организация				= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
			Движение.ДоговорЗайма				= ВыборкаПоСтрокамДокумента.ДоговорЗайма; 
			Движение.ВидДвижения				= ВидДвиженияНакопления.Расход;  
			Если КурсВыдачи > Курс Тогда			 
				Движение.ОсновнойДолг				= (КурсВыдачи - Курс )*СуммаВВалюте;
			Иначе
				Движение.ОсновнойДолг				=(КурсВыдачи - Курс )*СуммаВВалюте;
			КонецЕсли;	
			Движение.УдержаноИзЗарплаты			= Ложь;//Истина;
		КонецЕсли;
	КонецЕсли;

	
	// доходы - материальная выгода по заемным средствам
	Если ВыборкаПоСтрокамДокумента.МатериальнаяВыгода <> 0 Тогда
		
		Движение = НаборЗаписейНДФЛСведенияОДоходах.Добавить();
		
		// свойства
		Движение.Период 				= КонецМесяца;
		
		// измерения 
		Движение.Организация 			= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.Физлицо 				= ВыборкаПоСтрокамДокумента.Физлицо;
		Движение.КодДохода 				= ВыборкаПоСтрокамДокумента.КодДохода;
		Движение.ПериодРегистрации 		= ПериодРегистрации;
		
		// ресурсы
		Движение.СуммаДохода 			= ВыборкаПоСтрокамДокумента.МатериальнаяВыгода;
		
		// реквизиты
		Движение.ОбособленноеПодразделение = ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ПодразделениеОрганизации = ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации;
		Движение.ИсчисленоИзЗарплаты	= Истина;	
		
	КонецЕсли;
	
	// налог с материальной выгоды по заемным средствам
	Если ВыборкаПоСтрокамДокумента.НалогНаМатериальнуюВыгоду <> 0 Тогда
		Движение = НаборЗаписейНДФЛРасчетыСБюджетом.Добавить();
		
		// Свойства
		Движение.Период							= КонецМесяца;
		Движение.ВидДвижения					= ВидДвиженияНакопления.Приход;
		
		// Измерения
		Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.МесяцНалоговогоПериода     	= КонецМесяца;
		Движение.СтавкаНалогообложенияРезидента	= ВыборкаПоСтрокамДокумента.СтавкаНалогообложенияМатвыгоды;
		
		// Ресурсы
		Движение.Налог							= ВыборкаПоСтрокамДокумента.НалогНаМатериальнуюВыгоду;
		
		// Реквизиты 
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации;
		Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Начисление;
		Движение.ИсчисленоИзЗарплаты		= Истина;
		Движение.КодДохода 					= ВыборкаПоСтрокамДокумента.КодДохода;
		
		Если ФормироватьНДФЛудержанный Тогда // сразу же, не дожидаясь выплаты, регистрируем факт удержания налога
			
			Движение = НаборЗаписейНДФЛРасчетыСБюджетом.Добавить();
			
			// Свойства
			Движение.Период							= КонецМесяца;
			Движение.ВидДвижения					= ВидДвиженияНакопления.Расход;
			
			// Измерения
			Движение.ФизЛицо                    	= ВыборкаПоСтрокамДокумента.ФизЛицо;
			Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
			Движение.МесяцНалоговогоПериода     	= КонецМесяца;
			Движение.СтавкаНалогообложенияРезидента	= ВыборкаПоСтрокамДокумента.СтавкаНалогообложенияМатвыгоды;
			
			// Ресурсы
			Движение.Налог						= ВыборкаПоСтрокамДокумента.НалогНаМатериальнуюВыгоду;
			
			// Реквизиты 
			Движение.ВидСтроки					= Перечисления.НДФЛРасчетыСБюджетомВидСтроки.Удержание;
			Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;				
			Движение.ПодразделениеОрганизации	= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации;
			Движение.КодДохода 					= ВыборкаПоСтрокамДокумента.КодДохода;
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры // ДобавитьСтрокуПогашениеЗайма

// По строке выборок из результатов запроса по документу формируем движения по регистру
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента				- спозиционированная на определеной строке выборка 
//				  							  из результата запроса к ТЧ документа, 
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуОсновныхНачислений(ВыборкаПоСтрокамДокумента, ВыборкаПоШапкеДокумента, НаборЗаписей, ИдетПроведениеДока=Ложь) //Аверсон 24.10.2019 КВВ СВФР-004925 (последний параметр)
	
	//Аверсон 16.10.2019 КВВ СВФР-004925 (
	ПродолжатьДвижения = Истина;
	//+ Аверсон СМА 22.05.2020 СВФР-005987
	Если  ВыборкаПоСтрокамДокумента.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням 
		или  ВыборкаПоСтрокамДокумента.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам 
		или  ВыборкаПоСтрокамДокумента.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой Тогда	
		//-Аверсон СМА 22.05.2020 СВФР-005987
	ИначеЕсли ИдетПроведениеДока И ВыборкаПоСтрокамДокумента.ВидРасчета.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.НулеваяСумма И   //Аверсон 24.10.2019 КВВ СВФР-004925
		ВыборкаПоСтрокамДокумента.Результат = 0 И ВыборкаПоСтрокамДокумента.ОтработаноДней = 0 И ВыборкаПоСтрокамДокумента.ОтработаноЧасов = 0 И 
		ВыборкаПоСтрокамДокумента.НормаДней = 0 И ВыборкаПоСтрокамДокумента.НормаЧасов = 0 И ВыборкаПоСтрокамДокумента.ОплаченоДней = 0 И ВыборкаПоСтрокамДокумента.ОплачиватьЧасов = 0 И
		ВыборкаПоСтрокамДокумента.НормаДнейПоПятидневке = 0 И ВыборкаПоСтрокамДокумента.НормаЧасовПоПятидневке = 0  Тогда
		ПродолжатьДвижения = Ложь;
		Сообщить("В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) + """ табл. части ""Основные начисления"" (" + 
		ПроцедурыУправленияПерсоналом.ФамилияИнициалыФизЛица(ВыборкаПоСтрокамДокумента.Сотрудник.ФизЛицо) + ", " + СокрЛП(ВыборкаПоСтрокамДокумента.ВидРасчета.Наименование)+ 
		"): нет данных, движения в регистр не идут.");
	КонецЕсли;  
	Если ПродолжатьДвижения Тогда
		//Аверсон 16.10.2019 КВВ СВФР-004925 )
		
		Движение = НаборЗаписей.Добавить();
		
		// Свойства
		Движение.ПериодРегистрации				= ПериодРегистрации;
		Движение.ПериодДействияНачало			= ВыборкаПоСтрокамДокумента.ПериодДействияНачало;
		Движение.ПериодДействияКонец			= ВыборкаПоСтрокамДокумента.ПериодДействияКонец;
		Движение.БазовыйПериодНачало			= ВыборкаПоСтрокамДокумента.БазовыйПериодНачало;
		Движение.БазовыйПериодКонец				= ВыборкаПоСтрокамДокумента.БазовыйПериодКонец;
		Движение.ВидРасчета						= ВыборкаПоСтрокамДокумента.ВидРасчета;
		Движение.Сторно							= ВыборкаПоСтрокамДокумента.Сторно;
		
		// Измерения
		Движение.Сотрудник						= ВыборкаПоСтрокамДокумента.Сотрудник;
		Движение.ФизЛицо						= ВыборкаПоСтрокамДокумента.ФизЛицо;
		Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		
		// Ресурсы
		Движение.Результат						= ВыборкаПоСтрокамДокумента.Результат;
		// ресурсы по отработанному времени
		//Если ВыборкаПоСтрокамДокумента.ЗачетОтработанногоВремени Тогда
		//	Движение.ОтработаноДней				= ВыборкаПоСтрокамДокумента.ОтработаноДней;
		//	Движение.ОтработаноЧасов			= ВыборкаПоСтрокамДокумента.ОтработаноЧасов;
		//	Движение.ОтработаноДнейПоПятидневке	= ВыборкаПоСтрокамДокумента.ОтработаноДнейПоПятидневке;
		//	Движение.ОтработаноЧасовПоПятидневке= ВыборкаПоСтрокамДокумента.ОтработаноЧасовПоПятидневке;
		//КонецЕсли;
		Если ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ВидРасчета.СпособРасчета) Тогда
			Если Не ВыборкаПоСтрокамДокумента.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС и
				Не ВыборкаПоСтрокамДокумента.ВидРасчета.СпособРасчета = Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням Тогда
				Движение.ОтработаноДней				= ВыборкаПоСтрокамДокумента.ОтработаноДней;
				Движение.ОтработаноЧасов			= ВыборкаПоСтрокамДокумента.ОтработаноЧасов;
				Движение.ОтработаноДнейПоПятидневке	= ВыборкаПоСтрокамДокумента.ОтработаноДнейПоПятидневке;
				Движение.ОтработаноЧасовПоПятидневке= ВыборкаПоСтрокамДокумента.ОтработаноЧасовПоПятидневке;
			Иначе
				Движение.ПериодДействияНачало            = НачалоМесяца(ВыборкаПоСтрокамДокумента.ПериодДействияНачало);
				Движение.ПериодДействияКонец            = НачалоМесяца(ВыборкаПоСтрокамДокумента.ПериодДействияКонец);
				Движение.БазовыйПериодНачало            = НачалоМесяца(ВыборкаПоСтрокамДокумента.БазовыйПериодНачало);
				Движение.БазовыйПериодКонец                = НачалоМесяца(ВыборкаПоСтрокамДокумента.БазовыйПериодКонец);			
			КонецЕсли;
		Иначе
			Движение.ОтработаноДней				= ВыборкаПоСтрокамДокумента.ОтработаноДней;
			Движение.ОтработаноЧасов			= ВыборкаПоСтрокамДокумента.ОтработаноЧасов;
			Движение.ОтработаноДнейПоПятидневке	= ВыборкаПоСтрокамДокумента.ОтработаноДнейПоПятидневке;
			Движение.ОтработаноЧасовПоПятидневке= ВыборкаПоСтрокамДокумента.ОтработаноЧасовПоПятидневке;		
		КонецЕсли;
		
		// ресурсы по норме времени
		Если ВыборкаПоСтрокамДокумента.ЗачетНормыВремени Тогда
			Движение.НормаДней					= ВыборкаПоСтрокамДокумента.НормаДней;
			Движение.НормаЧасов					= ВыборкаПоСтрокамДокумента.НормаЧасов;
			Движение.НормаДнейПоПятидневке		= ВыборкаПоСтрокамДокумента.НормаДнейПоПятидневке;
			Движение.НормаЧасовПоПятидневке		= ВыборкаПоСтрокамДокумента.НормаЧасовПоПятидневке;
		КонецЕсли;
		Движение.ОплаченоДнейЧасов				= ВыборкаПоСтрокамДокумента.ОплаченоДнейЧасов;
		//толик
		Движение.ОплаченоДней					= ВыборкаПоСтрокамДокумента.ОплаченоДней;
		
		// Реквизиты
		Движение.ГрафикРаботы					= ВыборкаПоСтрокамДокумента.ГрафикРаботы;
		Движение.ГрафикРаботыНорма				= ВыборкаПоСтрокамДокумента.ГрафикРаботыНорма;
		Для Сч = 1 По 6 Цикл
			Движение["Показатель"+Сч]			= ВыборкаПоСтрокамДокумента["Показатель"+Сч];
		КонецЦикла;
		
		//О.Т. Аверсон 19.12.2017 № 1369
		Запрос1 = Новый Запрос;
		Запрос1.Текст =
		
		"ВЫБРАТЬ
		|	СтрокиДокумента.Ссылка,
		|	СтрокиДокумента.НомерСтроки,
		|	СтрокиДокумента.Сотрудник КАК Сотрудник,
		|	СтрокиДокумента.Физлицо,
		|	СтрокиДокумента.ВидРасчета,
		|	НАЧАЛОПЕРИОДА(СтрокиДокумента.ДатаНачала, МЕСЯЦ) КАК ПериодДействия
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК СтрокиДокумента
		|ГДЕ
		|	СтрокиДокумента.ВидРасчета = &ВидРасчета
		|	И СтрокиДокумента.Ссылка = &ДокументСсылка
		|	И СтрокиДокумента.Сотрудник = &парамФизлицо
		|	И &ДатаНачала МЕЖДУ СтрокиДокумента.ДатаНачала И СтрокиДокумента.ДатаОкончания";
		Запрос1.УстановитьПараметр("ДокументСсылка", Ссылка);
		Запрос1.УстановитьПараметр("ДатаНачала", ВыборкаПоСтрокамДокумента.ПериодДействияНачало);
		
		Запрос1.УстановитьПараметр("парамФизлицо", ВыборкаПоСтрокамДокумента.Сотрудник);
		Запрос1.УстановитьПараметр("ВидРасчета",  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
		Выборка = Запрос1.Выполнить().Выбрать();
		Пока Выборка.Следующий() цикл
			ВидРасчета1 = Выборка.ВидРасчета;
		КонецЦикла;
		//О.Т. Аверсон 19.12.2017 № 1369
		
		
		Движение.ВидУчетаВремени				= ПроведениеРасчетов.ПолучитьВидУчетаВремени(ВыборкаПоСтрокамДокумента.СпособРасчета, ВыборкаПоСтрокамДокумента.ВидВремени, ВыборкаПоСтрокамДокумента.СуммированныйУчетРабочегоВремени, ВыборкаПоСтрокамДокумента.ВидИспользованияРабочегоВремени,ВидРасчета1);
		Движение.ПодразделениеОрганизации		= ВыборкаПоСтрокамДокумента.ПодразделениеОрганизации;
		Движение.ОбособленноеПодразделение		= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ПериодРасчетаСреднегоЗаработкаНачало		= ВыборкаПоСтрокамДокумента.ПериодРасчетаСреднегоЗаработкаНачало;
		Движение.ПериодРасчетаСреднегоЗаработкаОкончание	= ВыборкаПоСтрокамДокумента.ПериодРасчетаСреднегоЗаработкаОкончание;
		Движение.ДатаНачалаСобытия				= ВыборкаПоСтрокамДокумента.ДатаНачалаСобытия;
		Движение.Авторасчет						= ВыборкаПоСтрокамДокумента.Авторасчет;
		Движение.ВариантОбработкиЗаписиПриОтраженииВРеглУчете = ВыборкаПоСтрокамДокумента.ВариантОбработкиЗаписиПриОтраженииВРеглУчете;	
		//толик
		Движение.ЧасыИзДокумента				= ВыборкаПоСтрокамДокумента.ЧасыИзДокумента;
		Движение.СторнируемыйДокумент = ВыборкаПоСтрокамДокумента.СторнируемыйДокумент;
	КонецЕсли;
КонецПроцедуры // ДобавитьСтрокуОсновныхНачислений()

// По строке выборок из результатов запроса по документу формируем движения по регистру
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента				- спозиционированная на определеной строке выборка 
//				  							  из результата запроса к ТЧ документа, 
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуДопНачислений(ВыборкаПоСтрокамДокумента, ВыборкаПоШапкеДокумента, НаборЗаписей, ИдетПроведениеДока=Ложь) //Аверсон 24.10.2019 КВВ СВФР-004925 (последний параметр)
	ПродолжатьДвижения = Истина;
	Если ИдетПроведениеДока И ВыборкаПоСтрокамДокумента.Результат = 0 И ВыборкаПоСтрокамДокумента.ВидРасчета.СпособРасчета <> Перечисления.СпособыРасчетаОплатыТруда.НулеваяСумма Тогда
		ПродолжатьДвижения = Ложь;
	КонецЕсли;	 
	
	Если ПродолжатьДвижения Тогда
		//Аверсон 16.10.2019 КВВ СВФР-004925 
		Движение = НаборЗаписей.Добавить();
		
		ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоСтрокамДокумента);	// БазовыйПериодНачало, БазовыйПериодКонец, ВидРасчета, Сторно
		// Сотрудник, ФизЛицо, Результат, СкидкаПриНалогообложении
		// Размер,ЧислоМесяцев,ПодразделениеОрганизации,
		// Авторасчет,ДокументОснование,ДатаНачалаСобытия,
		// ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание,СторнируемыйДокумент
		
		Движение.ВидУчетаВремени			= ПроведениеРасчетов.ПолучитьВидУчетаВремени(ВыборкаПоСтрокамДокумента.СпособРасчета, Неопределено, ВыборкаПоСтрокамДокумента.СуммированныйУчетРабочегоВремени);
		Движение.ПериодРегистрации			= ?(ВыборкаПоСтрокамДокумента.БазовыйПериодНачало > КонецМесяца(ПериодРегистрации), ПериодРегистрации, Макс(ПериодРегистрации, ВыборкаПоСтрокамДокумента.БазовыйПериодНачало));
		Движение.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ДатаНачалаСобытия 			= ПериодРегистрации;
	КонецЕсли;
КонецПроцедуры // ДобавитьСтрокуДопНачислений

// По строке выборок из результатов запроса по документу формируем движения по регистру
//
// Параметры: 
//  ВыборкаПоСтрокамДокумента				- спозиционированная на определеной строке выборка 
//				  							  из результата запроса к ТЧ документа, 
// Возвращаемое значение:
//  Нет.
//
Процедура ДобавитьСтрокуДоговора(ВыборкаПоСтрокамДокумента, ВыборкаПоШапкеДокумента, НаборЗаписей)
	
	Движение = НаборЗаписей.Добавить();
	
	ЗаполнитьЗначенияСвойств(Движение,ВыборкаПоСтрокамДокумента);	// БазовыйПериодНачало, БазовыйПериодКонец, ВидРасчета, Сторно
	// Сотрудник, ФизЛицо, Результат, СкидкаПриНалогообложении
	// Размер,ЧислоМесяцев,ПодразделениеОрганизации,
	// Авторасчет,ДокументОснование,ДатаНачалаСобытия,
	// ПериодРасчетаСреднегоЗаработкаНачало,ПериодРасчетаСреднегоЗаработкаОкончание,СторнируемыйДокумент
	
	Движение.ПериодРегистрации			= ?(ВыборкаПоСтрокамДокумента.БазовыйПериодНачало > КонецМесяца(ПериодРегистрации), ПериодРегистрации, Макс(ПериодРегистрации, ВыборкаПоСтрокамДокумента.БазовыйПериодНачало));
	Движение.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
	Движение.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
	Движение.ДатаНачалаСобытия 			= ПериодРегистрации;
	
КонецПроцедуры // ДобавитьСтрокуДоговора

// По выборке из результатов запроса по документу формируем движения по регистру
//
// Параметры: 
//	ВыборкаПоШапкеДокумента	- спозиционированная на определеной строке выборка 
//							  из результата запроса к документу 
// Возвращаемое значение:
//	Нет.
//
Процедура ДобавитьСтрокуРабочегоВремени(ВыборкаПоНачислениям, ВыборкаПоШапкеДокумента, НаборЗаписей)
	
	Если ВыборкаПоНачислениям.ЯвляетсяПочасовымОтклонением Тогда
		Движение = НаборЗаписей.Добавить();
		//О.Т. Аверсон 15.12.2016 № 100
		если ТипЗнч(Движение) = Тип("РегистрНакопленияЗапись.РабочееВремяРаботниковОрганизаций") Тогда 
			Движение.ДатаНачала = НачалоДня(Движение.Период);
			Движение.ДатаОкончания = КонецДня(Движение.Период);			
		КонецЕсли;
		//О.Т. Аверсон 15.12.2016 № 100		
		
		// Свойства
		Движение.Период = ВыборкаПоНачислениям.ПериодДействияНачало;
		
		// Измерения
		Движение.Сотрудник							= ВыборкаПоНачислениям.Сотрудник;
		Движение.Организация 						= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.ВидИспользованияРабочегоВремени 	= ВыборкаПоНачислениям.ВидИспользованияРабочегоВремени;
		
		// Ресурсы
		
		Движение.Часов			= ВыборкаПоНачислениям.ОплачиватьЧасов;
		
	КонецЕсли;
	
КонецПроцедуры // ДобавитьСтрокуРабочегоВремени()

// получает доходы НДФЛ по табличным частям с доходами
// Параметры:
//		ВыборкаПоШапкеДокумента - спозиционированная выборка по шапке документа
//		НаборЗаписей - таблица значений или набор записей рег-ра - "приемник" сведений о доходах
//		
Процедура СформироватьДоходыПоКодамНДФЛ(ВыборкаПоШапкеДокумента, НаборЗаписей)
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("парамСсылка" , Ссылка);
	Запрос.УстановитьПараметр("ДатаНалоговогоПериода", КонецГода(ПериодРегистрации));
	КодОплатыТрудаПоНДФЛ = Новый Массив;
	КодОплатыТрудаПоНДФЛ.Добавить(Справочники.ДоходыНДФЛ.КодДоходаПоУмолчанию);
	//КодОплатыТрудаПоНДФЛ.Добавить(Справочники.ДоходыНДФЛ.Код2012);
	Запрос.УстановитьПараметр("КодОплатыТрудаПоНДФЛ", КодОплатыТрудаПоНДФЛ);
	
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) (
	////СВЭЙ 19.12.2023 КВВ СВФР-012003 (
	//ВыборкаДоходыНДФЛ = Справочники.ДоходыНДФЛ.Выбрать();
	//Пока ВыборкаДоходыНДФЛ.Следующий() Цикл
	//	КодЭл = СокрЛП(ВыборкаДоходыНДФЛ.Код);
	//	Если КодЭл = "203" ИЛИ КодЭл = "204" ИЛИ КодЭл = "205" ИЛИ КодЭл = "206" ИЛИ КодЭл = "207" ИЛИ КодЭл = "208" ИЛИ КодЭл = "209" ИЛИ КодЭл = "210" ИЛИ 
	//		КодЭл = "211" ИЛИ КодЭл = "212" ИЛИ КодЭл = "213" ИЛИ КодЭл = "214" ИЛИ КодЭл = "215" ИЛИ КодЭл = "216" ИЛИ КодЭл = "217" ИЛИ КодЭл = "218" ИЛИ КодЭл = "219" Тогда
	//		СсылкаНаЭл = ВыборкаДоходыНДФЛ.Ссылка;
	//		Если КодЭл = "203" Тогда 	  Запрос.УстановитьПараметр("Код203",СсылкаНаЭл);	
	//		ИначеЕсли КодЭл = "204" Тогда Запрос.УстановитьПараметр("Код204",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "205" Тогда Запрос.УстановитьПараметр("Код205",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "206" Тогда Запрос.УстановитьПараметр("Код206",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "207" Тогда Запрос.УстановитьПараметр("Код207",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "208" Тогда Запрос.УстановитьПараметр("Код208",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "209" Тогда Запрос.УстановитьПараметр("Код209",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "210" Тогда Запрос.УстановитьПараметр("Код210",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "211" Тогда Запрос.УстановитьПараметр("Код211",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "212" Тогда Запрос.УстановитьПараметр("Код212",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "213" Тогда Запрос.УстановитьПараметр("Код213",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "214" Тогда Запрос.УстановитьПараметр("Код214",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "215" Тогда Запрос.УстановитьПараметр("Код215",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "216" Тогда Запрос.УстановитьПараметр("Код216",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "217" Тогда Запрос.УстановитьПараметр("Код217",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "218" Тогда Запрос.УстановитьПараметр("Код218",СсылкаНаЭл);
	//		ИначеЕсли КодЭл = "219" Тогда Запрос.УстановитьПараметр("Код219",СсылкаНаЭл);
	//		КонецЕсли;
	//	КонецЕсли;
	//	
	//КонецЦикла;
	////СВЭЙ 19.12.2023 КВВ СВФР-012003 )
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) )
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Доходы.Физлицо,
	|	Доходы.КодДохода,
	|	Доходы.КодВычета,
	|	Доходы.Период,
	|	СУММА(Доходы.СуммаДохода) КАК СуммаДохода,
	|	СУММА(Доходы.СуммаВычета) КАК СуммаВычета,
	|	Доходы.ПодразделениеОрганизации
	|ИЗ
	|	(ВЫБРАТЬ
	|		Основные.Сотрудник.Физлицо КАК Физлицо,
	
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) (
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 (
	|		Основные.ВидРасчета.КодДоходаНДФЛ КАК КодДохода,
	|		ВЫБОР
	|			КОГДА Основные.ВидРасчета.КодДоходаНДФЛ В (&КодОплатыТрудаПоНДФЛ)
	|				ТОГДА Основные.ДатаНачала
	|			ИНАЧЕ Основные.Ссылка.ПериодРегистрации
	|		КОНЕЦ КАК Период,
	
	//|ВЫБОР КОГДА
	//|Основные.ВидРасчета.Подоходный2023 <> ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.ПустаяСсылка)
	//|ТОГДА
	//|ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код203) ТОГДА &Код203
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код204) ТОГДА &Код204
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код205) ТОГДА &Код205
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код206) ТОГДА &Код206
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код207) ТОГДА &Код207
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код208) ТОГДА &Код208
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код209) ТОГДА &Код209
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код210) ТОГДА &Код210
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код211) ТОГДА &Код211
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код212) ТОГДА &Код212
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код213) ТОГДА &Код213
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код214) ТОГДА &Код214
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код215) ТОГДА &Код215
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код216) ТОГДА &Код216
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код217) ТОГДА &Код217
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код218) ТОГДА &Код218
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код219) ТОГДА &Код219
	//|КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ
	//|КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ 
	//|ИНАЧЕ
	//|Основные.ВидРасчета.КодДоходаНДФЛ 
	//|КОНЕЦ КАК КодДохода,
	//|
	//|ВЫБОР КОГДА
	//|Основные.ВидРасчета.Подоходный2023 <> ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.ПустаяСсылка)
	//|ТОГДА
	//|ВЫБОР
	//|	КОГДА ( 
	//|	ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код203) ТОГДА &Код203
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код204) ТОГДА &Код204
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код205) ТОГДА &Код205
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код206) ТОГДА &Код206
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код207) ТОГДА &Код207
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код208) ТОГДА &Код208
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код209) ТОГДА &Код209
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код210) ТОГДА &Код210
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код211) ТОГДА &Код211
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код212) ТОГДА &Код212
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код213) ТОГДА &Код213
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код214) ТОГДА &Код214
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код215) ТОГДА &Код215
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код216) ТОГДА &Код216
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код217) ТОГДА &Код217
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код218) ТОГДА &Код218
	//|ИНАЧЕ ВЫБОР КОГДА Основные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код219) ТОГДА &Код219
	//|КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ
	//|КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ
	//|	) В (&КодОплатыТрудаПоНДФЛ)
	//|		ТОГДА Основные.ДатаНачала
	//|	ИНАЧЕ Основные.Ссылка.ПериодРегистрации
	//|КОНЕЦ
	//|ИНАЧЕ
	//|ВЫБОР
	//|	КОГДА Основные.ВидРасчета.КодДоходаНДФЛ В (&КодОплатыТрудаПоНДФЛ)
	//|		ТОГДА Основные.ДатаНачала
	//|	ИНАЧЕ Основные.Ссылка.ПериодРегистрации
	//|КОНЕЦ 
	//|КОНЕЦ
	//|КАК Период,
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 )
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) )	
	
	|		Основные.Результат КАК СуммаДохода,
	|		0 КАК СуммаВычета,
	|		NULL КАК КодВычета,
	|		Основные.ПодразделениеОрганизации КАК ПодразделениеОрганизации
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Основные
	|	ГДЕ
	|		Основные.Ссылка = &парамСсылка
	
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) (
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 (
	|		И Основные.ВидРасчета.КодДоходаНДФЛ <> ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.ПустаяСсылка)
	//|И (Основные.ВидРасчета.КодДоходаНДФЛ <> ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.ПустаяСсылка)
	//|ИЛИ 
	//|Основные.ВидРасчета.Подоходный2023 <> ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.ПустаяСсылка))
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 )
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) )
	
	|		И Основные.Результат <> 0
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Дополнительные.Сотрудник.Физлицо,
	
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) (
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 (
	|		Дополнительные.ВидРасчета.КодДоходаНДФЛ,
	//|ВЫБОР КОГДА
	//|Дополнительные.ВидРасчета.Подоходный2023 <> ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.ПустаяСсылка)
	//|ТОГДА
	//|ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код203) ТОГДА &Код203
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код204) ТОГДА &Код204
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код205) ТОГДА &Код205
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код206) ТОГДА &Код206
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код207) ТОГДА &Код207
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код208) ТОГДА &Код208
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код209) ТОГДА &Код209
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код210) ТОГДА &Код210
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код211) ТОГДА &Код211
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код212) ТОГДА &Код212
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код213) ТОГДА &Код213
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код214) ТОГДА &Код214
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код215) ТОГДА &Код215
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код216) ТОГДА &Код216
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код217) ТОГДА &Код217
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код218) ТОГДА &Код218
	//|ИНАЧЕ ВЫБОР КОГДА Дополнительные.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код219) ТОГДА &Код219
	//|КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ
	//|КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ 
	//|ИНАЧЕ
	//|Дополнительные.ВидРасчета.КодДоходаНДФЛ 
	//|КОНЕЦ,// КАК КодДохода
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 )
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) )

	
	|		Дополнительные.ДатаНачала, //Островская Татьяна 21.04.2014 № 17292
	|		Дополнительные.Результат,
	|		Дополнительные.СуммаВычета,
	|		Дополнительные.КодВычета,
	|		Дополнительные.ПодразделениеОрганизации
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Дополнительные
	|	ГДЕ
	|		Дополнительные.Ссылка = &парамСсылка
	
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) (
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 (
	|		И Дополнительные.ВидРасчета.КодДоходаНДФЛ <> ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.ПустаяСсылка)
	//|И (Дополнительные.ВидРасчета.КодДоходаНДФЛ <> ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.ПустаяСсылка)
	//|ИЛИ
	//|Дополнительные.ВидРасчета.Подоходный2023 <> ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.ПустаяСсылка))
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 )
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) )
	
	|		И Дополнительные.Результат <> 0
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ДоговорыНаВыполнениеРабот.Сотрудник.Физлицо,
	
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) (
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 (
	|		ДоговорыНаВыполнениеРабот.ВидРасчета.КодДоходаНДФЛ,
	//|ВЫБОР КОГДА
	//|ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 <> ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.ПустаяСсылка)
	//|ТОГДА
	//|ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код203) ТОГДА &Код203
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код204) ТОГДА &Код204
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код205) ТОГДА &Код205
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код206) ТОГДА &Код206
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код207) ТОГДА &Код207
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код208) ТОГДА &Код208
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код209) ТОГДА &Код209
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код210) ТОГДА &Код210
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код211) ТОГДА &Код211
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код212) ТОГДА &Код212
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код213) ТОГДА &Код213
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код214) ТОГДА &Код214
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код215) ТОГДА &Код215
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код216) ТОГДА &Код216
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код217) ТОГДА &Код217
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код218) ТОГДА &Код218
	//|ИНАЧЕ ВЫБОР КОГДА ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 = ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.Код219) ТОГДА &Код219
	//|КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ
	//|КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ КОНЕЦ
	//|ИНАЧЕ
	//|ДоговорыНаВыполнениеРабот.ВидРасчета.КодДоходаНДФЛ 
	//|КОНЕЦ,// КАК КодДохода
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 )
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) )
	
	|		НачалоПериода(ДоговорыНаВыполнениеРабот.ДатаНачала,Месяц),//О.Т. Аверсон 26.06.2017 № 766 (замена периода регистрации)
	|		ДоговорыНаВыполнениеРабот.Результат,
	|		ДоговорыНаВыполнениеРабот.СуммаВычета,
	|		ДоговорыНаВыполнениеРабот.КодВычета,
	|		ДоговорыНаВыполнениеРабот.ПодразделениеОрганизации
	|	ИЗ
	|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК ДоговорыНаВыполнениеРабот
	|	ГДЕ
	|		ДоговорыНаВыполнениеРабот.Ссылка = &парамСсылка
	
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) (
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 (
	|		И ДоговорыНаВыполнениеРабот.ВидРасчета.КодДоходаНДФЛ <> ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.ПустаяСсылка)
	//|И (ДоговорыНаВыполнениеРабот.ВидРасчета.КодДоходаНДФЛ <> ЗНАЧЕНИЕ(Справочник.ДоходыНДФЛ.ПустаяСсылка)
	//|ИЛИ
	//|ДоговорыНаВыполнениеРабот.ВидРасчета.Подоходный2023 <> ЗНАЧЕНИЕ(Справочник.КодДоходаПодоходный2023.ПустаяСсылка))
	//СВЭЙ 19.12.2023 КВВ СВФР-012003 )
	//закомментировано 04.01.2024 КВВ (на серверной не должно быть больше 10 вложенных условий) )
	
	|		И ДоговорыНаВыполнениеРабот.Результат <> 0) КАК Доходы
	|
	|СГРУППИРОВАТЬ ПО
	|	Доходы.Физлицо,
	|	Доходы.КодДохода,
	|	Доходы.Период,
	|	Доходы.КодВычета,
	|	Доходы.ПодразделениеОрганизации";
	
	ДоходыПоКодам = Запрос.Выполнить().Выбрать();
	
	// сформируем движения НДФЛСведенияОДоходах
	Пока ДоходыПоКодам.Следующий() Цикл
		Движение = НаборЗаписей.Добавить();
		
		// свойства
		Движение.Период 				= ДоходыПоКодам.Период;
		
		// измерения 
		Движение.Организация 			= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		Движение.Физлицо 				= ДоходыПоКодам.Физлицо;
		Движение.КодДохода 				= ДоходыПоКодам.КодДохода;
		Движение.ПериодРегистрации 		= ПериодРегистрации;
		
		// ресурсы
		Движение.СуммаДохода 			= ДоходыПоКодам.СуммаДохода;
		Движение.СуммаВычета 			= ДоходыПоКодам.СуммаВычета;
		Если  ЗначениеЗаполнено(ДоходыПоКодам.КодДохода) Тогда
			Попытка 
				Если (Число(СокрЛП(ДоходыПоКодам.КодДохода))>501 и Число(СокрЛП(ДоходыПоКодам.КодДохода))< 900) Тогда  
					Движение.КодВычета 	            = Справочники.ВычетыНДФЛ.НайтиПоКоду(ДоходыПоКодам.КодДохода);
					Движение.СуммаВычета			= ДоходыПоКодам.СуммаДохода;   
				КонецЕсли;
			Исключение
			КонецПопытки;
		Иначе   
			Движение.КодВычета	 	 		= ДоходыПоКодам.КодВычета; 
		КонецЕсли;
		// реквизиты
		Движение.ОбособленноеПодразделение = ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
		Движение.ИсчисленоИзЗарплаты	= Истина;	
		Движение.ПодразделениеОрганизации = ДоходыПоКодам.ПодразделениеОрганизации; 
		//Движение.КоличествоДетей		= ДоходыПоКодам.КоличествоДетей;	
		
	КонецЦикла;
	
КонецПроцедуры // СформироватьДоходыПоКодамНДФЛ()

// получает доходы НДФЛ по табличной части с погашением займов
// Параметры:
//		ВыборкаПоШапкеДокумента - спозиционированная выборка по шапке документа
//		НаборЗаписей - таблица значений или набор записей рег-ра - "приемник" сведений о доходах
//		ФизлицаСписок - список физлиц, по которым нужно обработать строки т.ч., если для всех - то не указывается 
//		
Процедура СформироватьДоходыПоМатвыгодеПоЗаймам(ВыборкаПоШапкеДокумента,НаборЗаписей, ФизлицаСписок = Неопределено)
	
	Для каждого СтрокаТЧ Из ПогашениеЗаймов Цикл
		
		Если ФизлицаСписок <> Неопределено и ФизлицаСписок.НайтиПоЗначению(СтрокаТЧ.Физлицо) = Неопределено Тогда
			Продолжить;
		КонецЕсли;
		
		Если СтрокаТЧ.МатериальнаяВыгода <> 0 Тогда
			
			Движение = НаборЗаписей.Добавить();
			
			// свойства
			Движение.Период 				= КонецМесяца(ПериодРегистрации);
			
			// измерения 
			Движение.Организация 			= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
			Движение.Физлицо 				= СтрокаТЧ.Физлицо;
			//РФ Мат. выгода
			//Движение.КодДохода 				= ?(СтрокаТЧ.СтавкаНалогообложенияМатвыгоды = Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13,
			//									Справочники.ДоходыНДФЛ.Код2610ПоСтавке13,Справочники.ДоходыНДФЛ.Код2610ПоСтавке35);
			Движение.КодДохода 				= ?(СтрокаТЧ.СтавкаНалогообложенияМатвыгоды = Перечисления.НДФЛСтавкиНалогообложенияРезидента.Ставка13,
			Справочники.ДоходыНДФЛ.Код99998проценты,Справочники.ДоходыНДФЛ.Код99999товары);
			Движение.ПериодРегистрации 		= ПериодРегистрации;
			
			// ресурсы
			Движение.СуммаДохода 			= СтрокаТЧ.МатериальнаяВыгода;
			
			// реквизиты
			Движение.ОбособленноеПодразделение = ВыборкаПоШапкеДокумента.ОбособленноеПодразделение;
			Движение.ИсчисленоИзЗарплаты	= Истина;	
			Движение.ПодразделениеОрганизации = СтрокаТЧ.ПодразделениеОрганизации; 
			
		КонецЕсли;
		
	КонецЦикла;
	
КонецПроцедуры // СформироватьДоходыПоМатвыгодеПоЗаймам()

// Вычисляет разницу между начислениями и удержаниями работника и формирует
// движения по взаиморасчетам с работниками
//
// Параметры:
//		ВыборкаПоШапкеДокумента - спозиционированная выборка по шапке документа
//		НаборЗаписей - набор записей 
//		Перерасчет - признак проведения перерасчетов, по умолчанию - Ложь
//		Физлица - список физлиц, по которым производится расчет, по умолчанию - отсутствует
//
// Возвращаемое значение:
//	Нет
//		
Процедура СформироватьВзаиморасчетыСРаботниками(ВыборкаПоШапкеДокумента, НаборЗаписей, УчетЗадолженностиПоМесяцам, Перерасчет = Ложь, Физлица = Неопределено)
	ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ПериодРегистрации,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер;
	Если ВыборкаПоШапкеДокумента.ЭтоРасчетПервойПоловиныМесяца Тогда
		НачисленияРаботниковТекст =
		"ВЫБРАТЬ
		|	Доходы.Физлицо,
		|	Доходы.Сотрудник,
		|	СУММА(Доходы.СуммаДохода) КАК СуммаДохода
		|ИЗ
		|	(ВЫБРАТЬ
		|		Основные.Сотрудник.Физлицо КАК Физлицо,
		|		Основные.Результат КАК СуммаДохода,
		|		Основные.Сотрудник КАК Сотрудник
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Основные
		|	ГДЕ
		|		Основные.Ссылка = &парамСсылка
		|		И Основные.Результат <> 0
		|		И НЕ Основные.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		Дополнительные.Сотрудник.Физлицо,
		|		Дополнительные.Результат,
		|		Дополнительные.Сотрудник
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Дополнительные
		|	ГДЕ
		|		Дополнительные.Ссылка = &парамСсылка
		|		И Дополнительные.Результат <> 0
		|		И НЕ Дополнительные.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДоговорыНаВыполнениеРабот.Сотрудник.Физлицо,
		|		ДоговорыНаВыполнениеРабот.Результат,
		|		ДоговорыНаВыполнениеРабот.Сотрудник
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК ДоговорыНаВыполнениеРабот
		|	ГДЕ
		|		ДоговорыНаВыполнениеРабот.Ссылка = &парамСсылка
		|		И НЕ ДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ЗплУдержания.ФизЛицо,
		|		-ЗплУдержания.Результат,
		|		NULL
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК ЗплУдержания
		|	ГДЕ
		|		ЗплУдержания.Ссылка = &парамСсылка
		|		И ЗплУдержания.Результат <> 0
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ПенсионныйФонд.ФизЛицо,
		|		-ПенсионныйФонд.Налог,
		|		NULL
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК ПенсионныйФонд
		|	ГДЕ
		|		ПенсионныйФонд.Ссылка = &парамСсылка
		|		И ПенсионныйФонд.Налог <> 0  
		
		//Аверсон 01.07.2022 КВВ СВФР-009250 (
		|
		|   ОБЪЕДИНИТЬ ВСЕ
		|	ВЫБРАТЬ
		|		ДополнительнаяПенсия.ФизЛицо,
		|		-ДополнительнаяПенсия.НалогДП,
		|		NULL
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительнаяПенсия КАК ДополнительнаяПенсия
		|	ГДЕ
		|		ДополнительнаяПенсия.Ссылка = &парамСсылка
		|		И ДополнительнаяПенсия.НалогДП <> 0
		|
		//Аверсон 01.07.2022 КВВ СВФР-009250 )
		
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ЗплНДФЛ.ФизЛицо,
		|		ВЫБОР
		|			КОГДА ЗплНДФЛ.МесяцНалоговогоПериода < ЗплНДФЛ.Ссылка.ПериодРегистрации и ЗплНДФЛ.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) и ЗплНДФЛ.Ссылка.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) //О.Т. Аверсон 28.06.2017 Добавлено последнее условие
		|				ТОГДА ВЫРАЗИТЬ((-СУММА(ЗплНДФЛ.Налог) - СУММА(ЗплНДФЛ.НалогПоСтавке09) - СУММА(ЗплНДФЛ.НалогПоСтавке9) - СУММА(ЗплНДФЛ.НалогПоСтавке35) - СУММА(ЗплНДФЛ.НалогПоСтавке40)) / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
		|			ИНАЧЕ -СУММА(ЗплНДФЛ.Налог) - СУММА(ЗплНДФЛ.НалогПоСтавке09) - СУММА(ЗплНДФЛ.НалогПоСтавке9) - СУММА(ЗплНДФЛ.НалогПоСтавке35) - СУММА(ЗплНДФЛ.НалогПоСтавке40)
		|		КОНЕЦ,
		|		NULL
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК ЗплНДФЛ
		|	ГДЕ
		|		ЗплНДФЛ.Ссылка = &парамСсылка
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЗплНДФЛ.ФизЛицо,
		|		ЗплНДФЛ.МесяцНалоговогоПериода,
		|		ЗплНДФЛ.Ссылка.ПериодРегистрации
		|	
		|	ИМЕЮЩИЕ
		|		(СУММА(ЗплНДФЛ.Налог) > 0
		|			ИЛИ СУММА(ЗплНДФЛ.НалогПоСтавке09) > 0
		|			ИЛИ СУММА(ЗплНДФЛ.НалогПоСтавке9) > 0
		|			ИЛИ СУММА(ЗплНДФЛ.НалогПоСтавке35) > 0
		|			ИЛИ СУММА(ЗплНДФЛ.НалогПоСтавке40) > 0)
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ЗплЗаймы.ФизЛицо,
		|		-ЗплЗаймы.ПогашеноЗайма - ЗплЗаймы.НалогНаМатериальнуюВыгоду,
		|		NULL
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов КАК ЗплЗаймы
		|	ГДЕ
		|		ЗплЗаймы.Ссылка = &парамСсылка
		|		И (ЗплЗаймы.ПогашеноЗайма <> 0
		|				ИЛИ ЗплЗаймы.НалогНаМатериальнуюВыгоду > 0)) КАК Доходы
		|
		|СГРУППИРОВАТЬ ПО
		|	Доходы.Физлицо,
		|	Доходы.Сотрудник";
		Запрос = Новый Запрос(НачисленияРаботниковТекст);
	ИначеЕсли Перерасчет Тогда
		Если Физлица = Неопределено Тогда
			// таблица ФизлицаДляПерерасчета
			// Список физлиц по которым необходимо выполнить перерасчет
			// Поля:
			//		ФизЛицо
			// Описание:
			// Получает список неповторяющихся физлиц по которым есть записи
			// перерасчета в одной из таблиц перерасчета - по основным или дополнительным начислениям
			//
			ФизлицаДляПерерасчетаТекст =
			"ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	Перерасчет.Физлицо
			|ИЗ
			|	(ВЫБРАТЬ
			|		Перерасчет.Физлицо
			|	ИЗ
			|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ПерерасчетОсновныхНачислений КАК Перерасчет
			|	
			|	ГДЕ
			|		Перерасчет.ОбъектПерерасчета = &парамСсылка
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		Перерасчет.Физлицо
			|	ИЗ
			|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций.ПерерасчетДополнительныхНачислений КАК Перерасчет
			|	
			|	ГДЕ
			|		Перерасчет.ОбъектПерерасчета = &парамСсылка) КАК Перерасчет";
			
			// НачисленияРаботников
			//	Поля:
			//		Физлицо
			//		СуммаДохода - сумма "к выплате" - увличение состояния взаиморасчета с работником
			//
			
			НачисленияРаботниковТекст = 
			"ВЫБРАТЬ
			|	Доходы.Физлицо КАК Физлицо,
			|	СУММА(Доходы.СуммаДохода) КАК СуммаДохода
			|ИЗ
			|	(ВЫБРАТЬ
			|		Основные.Сотрудник.Физлицо КАК Физлицо,
			|		Основные.Результат КАК СуммаДохода
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Основные
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляПерерасчетаТекст + ") КАК ФизлицаДляПерерасчета
			|			ПО ФизлицаДляПерерасчета.Физлицо = Основные.Сотрудник.Физлицо
			|	
			|	ГДЕ
			|		Основные.Ссылка = &парамСсылка 
			|		И (Основные.Результат <> 0)
			|		И (НЕ Основные.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		Дополнительные.Сотрудник.Физлицо,
			|		Дополнительные.Результат
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Дополнительные
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляПерерасчетаТекст + ") КАК ФизлицаДляПерерасчета
			|			ПО ФизлицаДляПерерасчета.Физлицо = Дополнительные.Сотрудник.Физлицо
			|	
			|	ГДЕ
			|		Дополнительные.Ссылка = &парамСсылка
			|		И (Дополнительные.Результат <> 0)
			|		И (НЕ Дополнительные.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ДоговорыНаВыполнениеРабот.Сотрудник.Физлицо,
			|		ДоговорыНаВыполнениеРабот.Результат
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК ДоговорыНаВыполнениеРабот
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляПерерасчетаТекст + ") КАК ФизлицаДляПерерасчета
			|			ПО ФизлицаДляПерерасчета.Физлицо = ДоговорыНаВыполнениеРабот.Сотрудник.Физлицо
			|	ГДЕ
			|		ДоговорыНаВыполнениеРабот.Ссылка = &парамСсылка
			|		И (НЕ ДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
			|
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ЗплУдержания.ФизЛицо,
			|		-(ЗплУдержания.Результат)
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК ЗплУдержания
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляПерерасчетаТекст + ") КАК ФизлицаДляПерерасчета
			|			ПО ФизлицаДляПерерасчета.Физлицо = ЗплУдержания.Физлицо
			|	
			|	ГДЕ
			|		ЗплУдержания.Ссылка = &парамСсылка И
			|		(ЗплУдержания.Результат <> 0)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ПенсионныйФонд.ФизЛицо,
			|		-ПенсионныйФонд.Налог,
			|		NULL
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК ПенсионныйФонд
			|	ГДЕ
			|		ПенсионныйФонд.Ссылка = &парамСсылка
			|		И ПенсионныйФонд.Налог <> 0
			
			//Аверсон 01.07.2022 КВВ СВФР-009250 (
			|
			|   ОБЪЕДИНИТЬ ВСЕ
			|	ВЫБРАТЬ
			|		ДополнительнаяПенсия.ФизЛицо,
			|		-ДополнительнаяПенсия.НалогДП,
			|		NULL
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительнаяПенсия КАК ДополнительнаяПенсия
			|	ГДЕ
			|		ДополнительнаяПенсия.Ссылка = &парамСсылка
			|		И ДополнительнаяПенсия.НалогДП <> 0
			|
			//Аверсон 01.07.2022 КВВ СВФР-009250 )
			
			|
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ЗплНДФЛ.ФизЛицо,
			|		ВЫБОР
			|			КОГДА ЗплНДФЛ.МесяцНалоговогоПериода < ЗплНДФЛ.Ссылка.ПериодРегистрации и ЗплНДФЛ.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) и ЗплНДФЛ.Ссылка.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) //О.Т. Аверсон 28.06.2017 Добавлено последнее условие
			|				ТОГДА ВЫРАЗИТЬ((-СУММА(ЗплНДФЛ.Налог)-СУММА(ЗплНДФЛ.НалогПоСтавке09)-СУММА(ЗплНДФЛ.НалогПоСтавке9)-СУММА(ЗплНДФЛ.НалогПоСтавке35)-СУММА(ЗплНДФЛ.НалогПоСтавке40)) / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
			|			ИНАЧЕ -СУММА(ЗплНДФЛ.Налог) - СУММА(ЗплНДФЛ.НалогПоСтавке09) - СУММА(ЗплНДФЛ.НалогПоСтавке9) - СУММА(ЗплНДФЛ.НалогПоСтавке35) - СУММА(ЗплНДФЛ.НалогПоСтавке40)
			|		КОНЕЦ,
			|		NULL
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК ЗплНДФЛ
			|		
			|	ГДЕ
			|		ЗплНДФЛ.Ссылка = &парамСсылка
			|	
			|	СГРУППИРОВАТЬ ПО
			|		ЗплНДФЛ.ФизЛицо,
			|		ЗплНДФЛ.МесяцНалоговогоПериода,
			|		ЗплНДФЛ.Ссылка.ПериодРегистрации
			|	
			|   ИМЕЮЩИЕ
			//|       СУММА(ЗплНДФЛ.Налог) > 0 ИЛИ
			//заявка №1735 (база заявок Кристалла) Дмитрук О.Г.
			|       СУММА(ЗплНДФЛ.Налог) > 0 ИЛИ СУММА(ЗплНДФЛ.Налог) < 0 ИЛИ
			//заявка №1735
			|       СУММА(ЗплНДФЛ.НалогПоСтавке09) > 0 ИЛИ 
			|       СУММА(ЗплНДФЛ.НалогПоСтавке9)  > 0 ИЛИ
			|       СУММА(ЗплНДФЛ.НалогПоСтавке35) > 0 ИЛИ 
			|       СУММА(ЗплНДФЛ.НалогПоСтавке40) > 0
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ЗплЗаймы.ФизЛицо,
			|		- ЗплЗаймы.ПогашеноЗайма - ЗплЗаймы.НалогНаМатериальнуюВыгоду
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов КАК ЗплЗаймы
			|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (" + ФизлицаДляПерерасчетаТекст + ") КАК ФизлицаДляПерерасчета
			|			ПО ФизлицаДляПерерасчета.ФизЛицо = ЗплЗаймы.Физлицо
			|	
			|	ГДЕ
			|		ЗплЗаймы.Ссылка = &парамСсылка И
			|		(ЗплЗаймы.ПогашеноЗайма <> 0 или ЗплЗаймы.НалогНаМатериальнуюВыгоду > 0)) КАК Доходы
			
			|СГРУППИРОВАТЬ ПО
			|	Доходы.Физлицо";
			
			Запрос = Новый Запрос(НачисленияРаботниковТекст);
		Иначе
			
			НачисленияРаботниковТекст = 
			"ВЫБРАТЬ
			|	Доходы.Физлицо КАК Физлицо,
			|	СУММА(Доходы.СуммаДохода) КАК СуммаДохода
			|ИЗ
			|	(ВЫБРАТЬ
			|		Основные.Сотрудник.Физлицо КАК Физлицо,
			|		Основные.Результат КАК СуммаДохода
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Основные
			|	ГДЕ
			|		Основные.Сотрудник.Физлицо В(&парамФизлица)
			|		И Основные.Ссылка = &парамСсылка
			|		И Основные.Результат <> 0
			|		И (НЕ Основные.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		Дополнительные.Сотрудник.Физлицо,
			|		Дополнительные.Результат
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Дополнительные
			|	ГДЕ
			|		Дополнительные.Сотрудник.Физлицо В(&парамФизлица)
			|		И Дополнительные.Ссылка = &парамСсылка
			|		И Дополнительные.Результат <> 0
			|		И (НЕ Дополнительные.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ДоговорыНаВыполнениеРабот.Сотрудник.Физлицо,
			|		ДоговорыНаВыполнениеРабот.Результат
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК ДоговорыНаВыполнениеРабот
			|	ГДЕ
			|		ДоговорыНаВыполнениеРабот.Сотрудник.Физлицо В(&парамФизлица)
			|		И ДоговорыНаВыполнениеРабот.Ссылка = &парамСсылка
			|		И (НЕ ДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ЗплУдержания.ФизЛицо,
			|		-ЗплУдержания.Результат
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК ЗплУдержания
			|	ГДЕ
			|		ЗплУдержания.ФизЛицо В(&парамФизлица)
			|		И ЗплУдержания.Ссылка = &парамСсылка
			|		И ЗплУдержания.Результат <> 0
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ПенсионныйФонд.ФизЛицо,
			|		-ПенсионныйФонд.Налог,
			|		NULL
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК ПенсионныйФонд
			|	ГДЕ
			|		ПенсионныйФонд.Ссылка = &парамСсылка
			|		И ПенсионныйФонд.Налог <> 0
			
			//Аверсон 01.07.2022 КВВ СВФР-009250 (
			|
			|   ОБЪЕДИНИТЬ ВСЕ
			|	ВЫБРАТЬ
			|		ДополнительнаяПенсия.ФизЛицо,
			|		-ДополнительнаяПенсия.НалогДП,
			|		NULL
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительнаяПенсия КАК ДополнительнаяПенсия
			|	ГДЕ
			|		ДополнительнаяПенсия.Ссылка = &парамСсылка
			|		И ДополнительнаяПенсия.НалогДП <> 0
			|
			//Аверсон 01.07.2022 КВВ СВФР-009250 )
			
			|
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ЗплНДФЛ.ФизЛицо,
			|		ВЫБОР
			|			КОГДА ЗплНДФЛ.МесяцНалоговогоПериода < ЗплНДФЛ.Ссылка.ПериодРегистрации и ЗплНДФЛ.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) и ЗплНДФЛ.Ссылка.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) //О.Т. Аверсон 28.06.2017 Добавлено последнее условие
			|				ТОГДА ВЫРАЗИТЬ((-СУММА(ЗплНДФЛ.Налог)-СУММА(ЗплНДФЛ.НалогПоСтавке09)-СУММА(ЗплНДФЛ.НалогПоСтавке9)-СУММА(ЗплНДФЛ.НалогПоСтавке35)-СУММА(ЗплНДФЛ.НалогПоСтавке40)) / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
			|			ИНАЧЕ -СУММА(ЗплНДФЛ.Налог) - СУММА(ЗплНДФЛ.НалогПоСтавке09) - СУММА(ЗплНДФЛ.НалогПоСтавке9) - СУММА(ЗплНДФЛ.НалогПоСтавке35) - СУММА(ЗплНДФЛ.НалогПоСтавке40)
			|		КОНЕЦ,
			|		NULL
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК ЗплНДФЛ
			|		
			|	ГДЕ
			|		ЗплНДФЛ.Ссылка = &парамСсылка
			|	
			|	СГРУППИРОВАТЬ ПО
			|		ЗплНДФЛ.ФизЛицо,
			|		ЗплНДФЛ.МесяцНалоговогоПериода,
			|		ЗплНДФЛ.Ссылка.ПериодРегистрации
			|	
			|   ИМЕЮЩИЕ
			//|       СУММА(ЗплНДФЛ.Налог) > 0 ИЛИ
			//заявка №1735 (база заявок Кристалла) Дмитрук О.Г.
			|       СУММА(ЗплНДФЛ.Налог) > 0 ИЛИ СУММА(ЗплНДФЛ.Налог) < 0 ИЛИ
			//заявка №1735
			|       СУММА(ЗплНДФЛ.НалогПоСтавке09) > 0 ИЛИ 
			|       СУММА(ЗплНДФЛ.НалогПоСтавке9)  > 0 ИЛИ
			|       СУММА(ЗплНДФЛ.НалогПоСтавке35) > 0 ИЛИ 
			|       СУММА(ЗплНДФЛ.НалогПоСтавке40) > 0
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		ЗплЗаймы.ФизЛицо,
			|		-ЗплЗаймы.ПогашеноЗайма - ЗплЗаймы.НалогНаМатериальнуюВыгоду
			|	ИЗ
			|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов КАК ЗплЗаймы
			|	ГДЕ
			|		ЗплЗаймы.ФизЛицо В(&парамФизлица)
			|		И ЗплЗаймы.Ссылка = &парамСсылка
			|		И (ЗплЗаймы.ПогашеноЗайма <> 0
			|				ИЛИ ЗплЗаймы.НалогНаМатериальнуюВыгоду > 0)) КАК Доходы
			|
			|СГРУППИРОВАТЬ ПО
			|	Доходы.Физлицо";
			
			Запрос = Новый Запрос(НачисленияРаботниковТекст);
			Запрос.УстановитьПараметр("парамФизлица", Физлица);
			
		КонецЕсли;
	Иначе
		НачисленияРаботниковТекст =
		"ВЫБРАТЬ
		|	Доходы.Физлицо КАК Физлицо,
		|	СУММА(Доходы.СуммаДохода) КАК СуммаДохода
		|ИЗ
		|	(ВЫБРАТЬ
		|		Основные.Сотрудник.Физлицо КАК Физлицо,
		|		Основные.Результат КАК СуммаДохода
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК Основные
		|	ГДЕ
		|		Основные.Ссылка = &парамСсылка
		|		И Основные.Результат <> 0
		|		И (НЕ Основные.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		Дополнительные.Сотрудник.Физлицо,
		|		Дополнительные.Результат
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК Дополнительные
		|	ГДЕ
		|		Дополнительные.Ссылка = &парамСсылка
		|		И Дополнительные.Результат <> 0
		|		И (НЕ Дополнительные.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ДоговорыНаВыполнениеРабот.Сотрудник.Физлицо,
		|		ДоговорыНаВыполнениеРабот.Результат
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК ДоговорыНаВыполнениеРабот
		|	ГДЕ
		|		ДоговорыНаВыполнениеРабот.Ссылка = &парамСсылка
		|		И (НЕ ДоговорыНаВыполнениеРабот.ВидРасчета.ЯвляетсяДоходомВНатуральнойФорме)
		|
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ЗплУдержания.ФизЛицо,
		|		-ЗплУдержания.Результат
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК ЗплУдержания
		|	ГДЕ
		|		ЗплУдержания.Ссылка = &парамСсылка
		|		И ЗплУдержания.Результат <> 0
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ПенсионныйФонд.ФизЛицо,
		|		-ПенсионныйФонд.Налог
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ПенсионныйФонд КАК ПенсионныйФонд
		|	ГДЕ
		|		ПенсионныйФонд.Ссылка = &парамСсылка
		|		И ПенсионныйФонд.Налог <> 0
		
		//Аверсон 01.07.2022 КВВ СВФР-009250 (
		|
		|   ОБЪЕДИНИТЬ ВСЕ
		|	ВЫБРАТЬ
		|		ДополнительнаяПенсия.ФизЛицо,
		|		-ДополнительнаяПенсия.НалогДП
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительнаяПенсия КАК ДополнительнаяПенсия
		|	ГДЕ
		|		ДополнительнаяПенсия.Ссылка = &парамСсылка
		|		И ДополнительнаяПенсия.НалогДП <> 0
		|
		//Аверсон 01.07.2022 КВВ СВФР-009250 )
		
		|
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ЗплНДФЛ.ФизЛицо,
		|		ВЫБОР
		|			КОГДА ЗплНДФЛ.МесяцНалоговогоПериода < ЗплНДФЛ.Ссылка.ПериодРегистрации и ЗплНДФЛ.МесяцНалоговогоПериода < ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) и ЗплНДФЛ.Ссылка.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1, 0, 0, 0) //О.Т. Аверсон 28.06.2017 Добавлено последнее условие
		|				ТОГДА ВЫРАЗИТЬ((-СУММА(ЗплНДФЛ.Налог)-СУММА(ЗплНДФЛ.НалогПоСтавке09)-СУММА(ЗплНДФЛ.НалогПоСтавке9)-СУММА(ЗплНДФЛ.НалогПоСтавке35)-СУММА(ЗплНДФЛ.НалогПоСтавке40)) / 10000 КАК ЧИСЛО(15, "+ЗначениеОкругления+"))
		|			ИНАЧЕ -СУММА(ЗплНДФЛ.Налог) - СУММА(ЗплНДФЛ.НалогПоСтавке09) - СУММА(ЗплНДФЛ.НалогПоСтавке9) - СУММА(ЗплНДФЛ.НалогПоСтавке35) - СУММА(ЗплНДФЛ.НалогПоСтавке40)
		|		КОНЕЦ
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.НДФЛ КАК ЗплНДФЛ
		|		
		|	ГДЕ
		|		ЗплНДФЛ.Ссылка = &парамСсылка
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЗплНДФЛ.ФизЛицо,
		|		ЗплНДФЛ.МесяцНалоговогоПериода,
		|		ЗплНДФЛ.Ссылка.ПериодРегистрации
		|	
		|   ИМЕЮЩИЕ
		//|       СУММА(ЗплНДФЛ.Налог) > 0 ИЛИ
		//заявка №1735 (база заявок Кристалла) Дмитрук О.Г.
		|       СУММА(ЗплНДФЛ.Налог) > 0 ИЛИ СУММА(ЗплНДФЛ.Налог) < 0 ИЛИ
		//заявка №1735
		|       СУММА(ЗплНДФЛ.НалогПоСтавке09) > 0 ИЛИ 
		|       СУММА(ЗплНДФЛ.НалогПоСтавке9)  > 0 ИЛИ
		|       СУММА(ЗплНДФЛ.НалогПоСтавке35) > 0 ИЛИ 
		|       СУММА(ЗплНДФЛ.НалогПоСтавке40) > 0
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ЗплЗаймы.ФизЛицо,
		|		-ЗплЗаймы.ПогашеноЗайма - ЗплЗаймы.НалогНаМатериальнуюВыгоду
		|	ИЗ
		|		Документ.НачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов КАК ЗплЗаймы
		|	ГДЕ
		|		ЗплЗаймы.Ссылка = &парамСсылка
		|		И (ЗплЗаймы.ПогашеноЗайма <> 0
		|				ИЛИ ЗплЗаймы.НалогНаМатериальнуюВыгоду > 0)) КАК Доходы
		|	
		|СГРУППИРОВАТЬ ПО
		|	Доходы.Физлицо";
		
		Запрос = Новый Запрос(НачисленияРаботниковТекст);
		
	КонецЕсли;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("парамСсылка",		Ссылка);
	Запрос.УстановитьПараметр("Организация",		Организация);
	Запрос.УстановитьПараметр("ПериодРегистрации",	КонецМесяца(ПериодРегистрации));
	
	Доходы = Запрос.Выполнить().Выбрать();
	// сформируем движения по суммам к выплате
	//Аверсон-софт, Островская Татьяна 17.05.2012 Перенос
	если ЗапретЗаписиВзаиморасчета = Ложь тогда
		//Аверсон-софт, Островская Татьяна 17.05.2012 Перенос
		Пока Доходы.Следующий() Цикл
			Движение = НаборЗаписей.Добавить();
			
			// свойства
			Движение.Период					= КонецМесяца(ПериодРегистрации);
			Если ВыборкаПоШапкеДокумента.ЭтоРасчетПервойПоловиныМесяца Тогда
				Движение.Сотрудник			= Доходы.Сотрудник;
			Иначе 	
				Движение.ВидДвижения		= ВидДвиженияНакопления.Приход;
			КонецЕсли;
			
			// измерения
			Движение.Физлицо				= Доходы.Физлицо;
			Движение.Организация			= Организация;
			Если УчетЗадолженностиПоМесяцам Тогда
				Движение.ПериодВзаиморасчетов	= ПериодРегистрации;
			КонецЕсли;
			
			// ресурсы
			Движение.СуммаВзаиморасчетов	= Доходы.СуммаДохода;
			
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры // СформироватьВзаиморасчетыСРаботниками()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ

Процедура ПриКопировании(ОбъектКопирования)
	ПерерассчитываемыйДокумент = Неопределено
КонецПроцедуры

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	Если ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет
		Или ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНачислений Тогда
		КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(Начисления, ДополнительныеНачисления);
		Если ПустаяСтрока(КраткийСоставДокумента) Тогда
			КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(ДоговорыНаВыполнениеРабот);
		КонецЕсли;
	ИначеЕсли ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетНДФЛ Тогда
		КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(НДФЛ,, "Физлицо");
		
	ИначеЕсли ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПогашениеЗаймов Тогда
		КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(ПогашениеЗаймов,, "Физлицо");
		
	ИначеЕсли ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.РасчетУдержаний Тогда
		КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(Удержания,, "Физлицо");
		
	КонецЕсли;
	
КонецПроцедуры // ПередЗаписью()

Процедура ПриЗаписи(Отказ)
	
	Если ПометкаУдаления Тогда
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("Ссылка",	Ссылка);
		Запрос.Текст =
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	1
		|ИЗ
		|	РегистрСведений.ЗаполнениеПлановыхНачислений КАК ЗаполнениеПлановыхНачислений
		|ГДЕ
		|	ЗаполнениеПлановыхНачислений.ОбъектЗаполнения = &Ссылка";
		
		Если Не Запрос.Выполнить().Пустой() Тогда
			// удаляем запись о перезаполнении из регистра
			НаборЗаписей = РегистрыСведений.ЗаполнениеПлановыхНачислений.СоздатьНаборЗаписей();
			НаборЗаписей.Отбор.ОбъектЗаполнения.Установить(Ссылка);
			НаборЗаписей.Записать();
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, Режим)
	////Аверсон 16.06.2020 КВВ СВФР-006138 (	
	//ФлВыбораПодр = Организация.УчетПНПоПодразделениюИзШапкиДок;
	//Если ФлВыбораПодр И НЕ ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
	//	ТекстП = "У выбранной организации включен флаг ""Учет ПН по подразделению из шапки документа""." + Символы.ПС + Символы.ПС + 
	//	"В данном документе подразделение в шапке НЕ заполнено! Будете заполнять данный реквизит?" + Символы.ПС + Символы.ПС + 
	//	"""Да"" - возврат в документ для редактирования." + Символы.ПС + """Нет"" - проведение документа, подразделение будет взято из табличной части документа (закладка ""Подоходный налог"")."; 
	//	ОтветП = Вопрос(ТекстП, РежимДиалогаВопрос.ДаНет, , КодВозвратаДиалога.Да, );
	//	Если ОтветП = КодВозвратаДиалога.Да Тогда
	//		Отказ = Истина;
	//	КонецЕсли;
	//КонецЕсли;
	////Аверсон 16.06.2020 КВВ СВФР-006138 )
	
	Для Каждого Набор Из Движения Цикл
		Набор.Очистить();
	КонецЦикла;
	
	// Получим реквизиты шапки из запроса
	ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
	
	// Заголовок для сообщений об ошибках проведения.
	Заголовок = ОбщегоНазначения.ПредставлениеДокументаПриПроведении(Ссылка);
	
	Если ВыборкаПоШапкеДокумента.Следующий() Тогда
		
		//Надо позвать проверку заполнения реквизитов шапки
		ПроверитьЗаполнениеШапки(ВыборкаПоШапкеДокумента, Отказ, Заголовок);
		
		// Движения стоит добавлять, если в проведении еще не отказано (отказ =ложь)
		Если НЕ Отказ Тогда
			
			Движения.ОсновныеНачисленияРаботниковОрганизаций.мВыполнятьВспомогательныеРасчеты = Истина;
			
			Если ВыборкаПоШапкеДокумента.ЭтоРасчетПервойПоловиныМесяца Тогда
				// движения запишем в специальный регистр
				
				// сформируем суммы к выплате по начислениям документа
				СформироватьВзаиморасчетыСРаботниками(ВыборкаПоШапкеДокумента, Движения.РасчетПервойПоловиныМесяца, Ложь);
				
			Иначе
				
				// ведется ли учет задолженности в разрезе периодов возникновения задолженности
				УчетЗадолженностиПоМесяцам	= ПроцедурыУправленияПерсоналом.ЗначениеУчетнойПолитикиПоПерсоналуОрганизации(глЗначениеПеременной("глУчетнаяПолитикаПоПерсоналуОрганизации"), Организация, "УчетЗадолженностиПоМесяцам");
				
				////////////////////////////////////////////////////////////////////////
				// основные Начисления
				
				// получим реквизиты табличной части
				ВыборкаПоНачислениям = СформироватьЗапросПоНачисления(ВыборкаПоШапкеДокумента,,Ложь).Выбрать();
				
				Пока ВыборкаПоНачислениям.Следующий() Цикл 
					
					// проверим очередную строку табличной части
					ПроверитьЗаполнениеСтрокиНачисления(ВыборкаПоНачислениям, Отказ, Заголовок);
					Если НЕ Отказ Тогда
						// Заполним записи в наборах записей регистров
						ДобавитьСтрокуОсновныхНачислений(ВыборкаПоНачислениям, ВыборкаПоШапкеДокумента, Движения.ОсновныеНачисленияРаботниковОрганизаций,Истина); //Аверсон 24.10.2019 КВВ СВФР-004925 (последний параметр)
						ДобавитьСтрокуРабочегоВремени(ВыборкаПоНачислениям, ВыборкаПоШапкеДокумента, Движения.ВнутрисменноеВремяРаботниковОрганизаций);
					КонецЕсли;
				КонецЦикла;
				
				//мСоответствиеДоходовИВычетов = ПроведениеРасчетов.ПолучитьСоответствиеДоходовИВычетов();
				
				////////////////////////////////////////////////////////////////////////
				// дополнительные Начисления
				
				// получим реквизиты табличной части
				ВыборкаПоДопНачислениям = СформироватьЗапросПоДопНачисления(ВыборкаПоШапкеДокумента).Выбрать();
				
				Пока ВыборкаПоДопНачислениям.Следующий() Цикл 
					
					// проверим очередную строку табличной части
					ПроверитьЗаполнениеСтрокиДопНачисления(ВыборкаПоДопНачислениям, Отказ, Заголовок);
					Если НЕ Отказ Тогда
						// Заполним записи в наборах записей регистров
						ДобавитьСтрокуДопНачислений(ВыборкаПоДопНачислениям, ВыборкаПоШапкеДокумента, Движения.ДополнительныеНачисленияРаботниковОрганизаций,Истина); //Аверсон 24.10.2019 КВВ СВФР-004925 (последний параметр)
					КонецЕсли;
				КонецЦикла;
				
				////////////////////////////////////////////////////////////////////////
				// ДоговорыНаВыполнениеРабот
				
				// получим реквизиты табличной части
				ВыборкаПоДоговорам = СформироватьЗапросПоДоговорам(ВыборкаПоШапкеДокумента).Выбрать();
				
				Пока ВыборкаПоДоговорам.Следующий() Цикл 
					
					// проверим очередную строку табличной части
					ПроверитьЗаполнениеСтрокиДоговора(ВыборкаПоДоговорам, Отказ, Заголовок);
					Если НЕ Отказ Тогда
						// Заполним записи в наборах записей регистров
						ДобавитьСтрокуДоговора(ВыборкаПоДоговорам, ВыборкаПоШапкеДокумента, Движения.ДополнительныеНачисленияРаботниковОрганизаций);
					КонецЕсли;
				КонецЦикла;
				
				////////////////////////////////////////////////////////////////////////
				// удержания
				
				// получим реквизиты табличной части
				ВыборкаПоУдержаниям = СформироватьЗапросПоУдержания(ВыборкаПоШапкеДокумента).Выбрать();
				
				Пока ВыборкаПоУдержаниям.Следующий() Цикл 
					
					// проверим очередную строку табличной части
					ПроверитьЗаполнениеСтрокиУдержания(ВыборкаПоУдержаниям, Отказ, Заголовок);
					Если НЕ Отказ Тогда
						// Заполним записи в наборах записей регистров
						ДобавитьСтрокуУдержаний(ВыборкаПоУдержаниям, ВыборкаПоШапкеДокумента, Движения.УдержанияРаботниковОрганизаций, Истина);
					КонецЕсли;
				КонецЦикла;
				
				ВыборкаПоПенсионномуФонду = СформироватьЗапросПоПенсионномуФонду().Выбрать();
				
				Пока ВыборкаПоПенсионномуФонду.Следующий() Цикл
					
					ПроверитьЗаполнениеСтрокиПенсонныйФонд(ВыборкаПоПенсионномуФонду, Отказ, Заголовок);
					
					Если НЕ Отказ Тогда
						// Заполним записи в наборах записей регистров
						ДобавитьСтрокуПенсионныйФонд(ВыборкаПоПенсионномуФонду, ВыборкаПоШапкеДокумента, Движения.ЕСНИсчисленный, Движения.УдержанияРаботниковОрганизаций);
					КонецЕсли;
					
				КонецЦикла;
				
				//Аверсон 01.07.2022 КВВ СВФР-009250 (
				Если ДополнительнаяПенсия.Количество() > 0 Тогда
					ВыборкаПоДопПенсии = СформироватьЗапросПоДопПенсии(ВыборкаПоШапкеДокумента).Выбрать();
					
					Пока ВыборкаПоДопПенсии.Следующий() Цикл 
						
						// проверим очередную строку табличной части
						ПроверитьЗаполнениеСтрокиДопПенсии(ВыборкаПоДопПенсии, Отказ, Заголовок);
						Если НЕ Отказ Тогда
							// Заполним записи в наборах записей регистров
							ДобавитьСтрокуУдержаний(ВыборкаПоДопПенсии, ВыборкаПоШапкеДокумента, Движения.УдержанияРаботниковОрганизаций, Истина);
						КонецЕсли;
					КонецЦикла;
					
				КонецЕсли;
				//Аверсон 01.07.2022 КВВ СВФР-009250 )
				
				
				////////////////////////////////////////////////////////////////////////
				// исчисленный НДФЛ
				
				// получим реквизиты табличной части
				ВыборкаПоНДФЛ = СформироватьЗапросПоНДФЛ().Выбрать();
				
				Пока ВыборкаПоНДФЛ.Следующий() Цикл 
					
					// проверим очередную строку табличной части
					ПроверитьЗаполнениеСтрокиНДФЛ(ВыборкаПоНДФЛ, Отказ, Заголовок);
					Если НЕ Отказ Тогда
						// Заполним записи в наборах записей регистров
						ДобавитьСтрокуНДФЛ(ВыборкаПоНДФЛ, ВыборкаПоШапкеДокумента, Движения.НДФЛРасчетыСБюджетом, Движения.НДФЛИмущественныеВычетыФизлиц);
					КонецЕсли;
				КонецЦикла;
				
				//// НДФЛ к зачету
				//// получим реквизиты табличной части
				//ВыборкаПоНДФЛКЗачету = СформироватьЗапросПоНДФЛКЗачету().Выбрать();
				//Пока ВыборкаПоНДФЛКЗачету.Следующий() Цикл 
				//	Если НЕ Отказ Тогда
				//		// Заполним записи в наборах записей регистров
				//		ДобавитьСтрокуНДФЛКЗачету(ВыборкаПоНДФЛКЗачету, ВыборкаПоШапкеДокумента);
				//	КонецЕсли;
				//КонецЦикла;
				
				////////////////////////////////////////////////////////////////////////
				// удержанный НДФЛ
				
				// посмотрим в учетную политику
				УпрощенныйУчетНДФЛ = ПроцедурыУправленияПерсоналом.ЗначениеУчетнойПолитикиПоПерсоналуОрганизации(глЗначениеПеременной("глУчетнаяПолитикаПоПерсоналуОрганизации"), Организация, "УпрощенныйУчетНДФЛ");
				//Если НЕ Отказ И УпрощенныйУчетНДФЛ Тогда
				//	
				//	ВыборкаПоНДФЛуд = СформироватьЗапросПоНДФЛудержанный().Выбрать();
				//	Пока ВыборкаПоНДФЛуд.Следующий() Цикл 
				//		
				//		// Заполним записи в наборах записей регистров
				//		ДобавитьСтрокуНДФЛудержанный(ВыборкаПоНДФЛуд, ВыборкаПоНДФЛ, ВыборкаПоНДФЛКЗачету, ВыборкаПоШапкеДокумента, Движения.НДФЛРасчетыСБюджетом);
				//		
				//	КонецЦикла;
				//	
				//КонецЕсли;
				
				////////////////////////////////////////////////////////////////////////
				// доходы НДФЛ
				
				// сформируем доходы НДФЛ по начислениям документа
				СформироватьДоходыПоКодамНДФЛ(ВыборкаПоШапкеДокумента, Движения.НДФЛСведенияОДоходах);
				
				////////////////////////////////////////////////////////////////////////
				// погашение займов
				
				// получим реквизиты табличной части
				ВыборкаПоПогашениеЗаймов = СформироватьЗапросПоПогашениеЗайма().Выбрать();
				
				Пока ВыборкаПоПогашениеЗаймов.Следующий() Цикл 
					
					// проверим очередную строку табличной части
					ПроверитьЗаполнениеСтрокиПогашениеЗайма(ВыборкаПоПогашениеЗаймов, Отказ, Заголовок);
					Если НЕ Отказ Тогда
						// Заполним записи в наборах записей регистров
						ДобавитьСтрокуПогашениеЗайма(ВыборкаПоПогашениеЗаймов, ВыборкаПоШапкеДокумента, Движения.ПогашениеЗаймовРаботникамиОрганизаций, Движения.НДФЛСведенияОДоходах, Движения.НДФЛРасчетыСБюджетом, УпрощенныйУчетНДФЛ);
					КонецЕсли;
				КонецЦикла;
				
				////////////////////////////////////////////////////////////////////////
				// взаиморасчеты с работниками
				
				// сформируем начисления к выплате по начислениям документа
				СформироватьВзаиморасчетыСРаботниками(ВыборкаПоШапкеДокумента, Движения.ВзаиморасчетыСРаботникамиОрганизаций, УчетЗадолженностиПоМесяцам);
				
				// выполним удаление перерасчетов и перезаполнений исправленного документа
				Если Не Отказ И ЗначениеЗаполнено(ПерерассчитываемыйДокумент) Тогда
					
					ПроведениеРасчетов.УдалитьСведенияОПерерасчетеДокумента(Ссылка, Истина); // Только по исправленным документам
					ПроведениеРасчетов.УдалитьСведенияОПерезаполненииДокумента(Ссылка, Неопределено, Истина); // Только по исправленным документам и только сотрудников нашего документа
					
				КонецЕсли;
				
			КонецЕсли;
		КонецЕсли;
		
	КонецЕсли;
	Если ЗначениеЗаполнено(ДокВычет) Тогда
		ДокСтандВычеты=ДокВычет.Ссылка.ПолучитьОбъект();
		ДокСтандВычеты.Записать(РежимЗаписиДокумента.Запись);
	КонецЕсли;
КонецПроцедуры

Процедура ОбработкаУдаленияПроведения(Отказ)
	
	Движения.ОсновныеНачисленияРаботниковОрганизаций.мВыполнятьВспомогательныеРасчеты = Истина;
	
	Для Каждого Набор Из Движения Цикл
		Набор.Очистить();
		Набор.Записать();
	КонецЦикла;
	Если ЗначениеЗаполнено(ДокВычет) Тогда
		ДокСтандВычеты=ДокВычет.Ссылка.ПолучитьОбъект();
		ДокСтандВычеты.Записать(РежимЗаписиДокумента.ОтменаПроведения);	
	КонецЕсли;
КонецПроцедуры // ОбработкаУдаленияПроведения()

////////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ

Функция ПолучитьДеноминированную(СуммаДляДен)	
	СуммаДен = Окр(СуммаДляДен / 10000,2);
	
	Если СуммаДляДен > 0 Тогда
		НовоеЗначение = Max(СуммаДен, 0.01);
		
	ИначеЕсли СуммаДляДен < 0 Тогда
		НовоеЗначение = Min(СуммаДен, -0.01);
	ИНаче
		НовоеЗначение = 0; 
	КонецЕсли;	 
	
	Возврат НовоеЗначение;
КонецФункции

////////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ
