////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ

// Предопределенные значения справочника "КлассификаторИспользованияРабочегоВремени"
Перем КлассификаторНочноеВремя, КлассификаторВечернееВремя;

// Значения справочника Классификатор использования рабочего времени. 
Перем КлассификаторЯвка;
Перем КлассификаторНочныеЧасы;
Перем КлассификаторВечерниеЧасы;
Перем КлассификаторПустаяСсылка;

// Строки, хранят реквизиты имеющие смысл только для бух. учета и упр. соответственно
// в случае если документ не отражается в каком-то виде учета, делаются невидимыми
Перем мСтрокаРеквизитыБухУчета Экспорт; // (Регл)
Перем мСтрокаРеквизитыУпрУчета Экспорт; // (Упр)
Перем мСтрокаРеквизитыНалУчета Экспорт; // (Регл)

Перем мВалютаРегламентированногоУчета Экспорт;
Перем мВалютаУпрУчета Экспорт;
Перем мПрежнееОтражатьВУправленческомУчете;
Перем мУдалятьДвижения;

Перем мУчетнаяПолитикаУСН;

// Значение  "ПоДням" перечисления ВидыУчетаВремени
Перем ВидУчетаВремениПоДням;
// Значение  "ПоЧасам" перечисления ВидыУчетаВремени
Перем ВидУчетаВремениПоЧасам;
Перем ВидУчетаВремениПоВечернимЧасам;
Перем ВидУчетаВремениПоНочнымЧасам;

// Индекс записи в наборе записей регистра сведений Графика
Перем ИндексЗаписиЯвка;
// Дата на которую происходит получение записи регистра.
Перем ДатаИндексаЗаписиЯвка;
// Количество часов работы которое проставляется для вида времени ПоДням
Перем ВремяЯвки;
// Массив строк "Первый", "Второй", "Третий" - приставки элементов табличной части документа.

Перем МассивПриставок;

//Перем ПериодРегистрации;
Перем СтруктураПоиска;

Перем РабочееВремяЗаполнено;

////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ ДОКУМЕНТА
Функция ПолучитьКодСтроки() Экспорт
	
	мКод = 0;
	
	Для Каждого мСтрокаТЧ Из Исполнители Цикл
		мКод = Макс(мКод, мСтрокаТЧ.КодСтроки);
	КонецЦикла;
	
	Возврат мКод + 1;
	
КонецФункции

Процедура ДобавитьСтроку(мФорма) Экспорт
	
	СтрокаТабЧасти = Исполнители.Добавить();
	СтрокаТабЧасти.КодСтроки = ПолучитьКодСтроки();
	мФорма.ЭлементыФормы.Исполнители.ТекущаяСтрока = СтрокаТабЧасти;
	
КонецПроцедуры

// Процедура осуществляет печать документа. Можно направить печать на 
// экран или принтер, а также распечатать необходмое количество копий.
//
//  Название макета печати передается в качестве параметра,
// по переданному названию находим имя макета в соответствии.
//
// Параметры:
//  НазваниеМакета - строка, название макета.
//
Функция Печать(ИмяМакета, КоличествоЭкземпляров = 1, НаПринтер = Ложь) Экспорт
	
	Если Не ИмяМакета = "НарядБригады"      //ПСА 15.02.2021+++
		И НЕ ИмяМакета = "ВыполненныеРаботы" //Аверсон 01.02.2023 КВВ СВФР-010173 
		И НЕ ИмяМакета = "ТабельБригады" И НЕ ИмяМакета = "НарядПоВП" Тогда //Аверсон 21.04.2023 КВВ СВФР-010670
		Если Не Проведен Тогда
			Предупреждение("Документ можно распечатать только после его проведения!");
			Возврат Неопределено;
		КонецЕсли;
	КонецЕсли; //ПСА 15.02.2021+++
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	// Получить экземпляр документа на печать
	Если ИмяМакета = "МакетВедомостьРасчета" Тогда
		ТабДокумент = ПечатьВедомостьРасчета(ИмяМакета);
		
		ФормаПечати = ПолучитьОбщуюФорму("ПечатьДокументовЛандшафт",, ТабДокумент);
		ФормаПечати.ПечатныйДокумент = ТабДокумент;
		ФормаПечати.Открыть();
		
		Возврат ФормаПечати;
		
		//Возврат РаботаСДиалогами.НапечататьДокумент(ТабДокумент, КоличествоЭкземпляров, НаПринтер, РаботаСДиалогами.СформироватьЗаголовокДокумента(ЭтотОбъект,"Ведомость расчета з/п "));
		
	ИначеЕсли ИмяМакета = "Табель" или ИмяМакета = "ТабельРасшифровка" Тогда
		ФильтрСоответствия = Новый Соответствие;
		
		ФильтрСоответствия.Вставить("Организация", Организация);
		ФильтрСоответствия.Вставить("Подразделение", ПодразделениеОрганизации);
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//ФильтрСоответствия.Вставить("ДатаАктуальности", ПериодРегистрации);
		ФильтрСоответствия.Вставить("ДатаАктуальности", ПериодРегистрации1);
		//Аверсон СВФР-007772
		
		ФильтрСоответствия.Вставить("ДокументТабель", Ссылка);
		Если ИмяМакета = "ТабельРасшифровка" Тогда
			ФильтрСоответствия.Вставить("ПечатьНеявок", Истина);
		КонецЕсли;
		
		
		ТабДокумент = Новый ТабличныйДокумент;	
		
		Отчет = Отчеты.ТабельУчетаРабочегоВремени.Создать();
		Отчет.УстановитьФильтр(ФильтрСоответствия);
		Отчет.СформироватьОтчет(ТабДокумент);
		
		ФормаПечати = ПолучитьОбщуюФорму("ПечатьДокументовЛандшафт",, ТабДокумент);
		ФормаПечати.ПечатныйДокумент = ТабДокумент;
		ФормаПечати.Открыть();
		
		Возврат ФормаПечати;
	//ПСА 11.02.2021 СВФР-007191+++
	ИначеЕсли ИмяМакета = "НарядБригады" Тогда
		ТабДокумент = ПечатьНарядБригады(ИмяМакета);
		
		ФормаПечати = ПолучитьОбщуюФорму("ПечатьДокументов",, ТабДокумент);
		ФормаПечати.ПечатныйДокумент = ТабДокумент;
		ФормаПечати.Открыть();
		
		Возврат ФормаПечати;
	//+++ПСА 11.02.2021 СВФР-007191
	
	//Аверсон 01.02.2023 КВВ СВФР-010173 (
ИначеЕсли ИмяМакета = "ВыполненныеРаботы" Тогда
	ПолеТабличногоДокумента1 = Новый ТабличныйДокумент;	
	ТД = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("МакетВыполненныеРаботы");
	Область1 = Макет.ПолучитьОбласть("Область1");		
	Область2 = Макет.ПолучитьОбласть("Область2");
	Область3 = Макет.ПолучитьОбласть("Область3");
	
	Область1.Параметры.Текст1 = "Выполненные работы";
	Область1.Параметры.Текст2 = "№ " + сокрлп(Номер) + " от " + Формат(Дата,"ДЛФ=Д");	
	Область1.Параметры.Текст3 = ?(ЗначениеЗаполнено(Бригада),"Бригада " + СокрЛП(Бригада),"");
	ИсполнителиТ = "";  СчИсп = 0;
	
	Для Каждого СтрИсп ИЗ Исполнители Цикл
		ИсполнителиТ = ИсполнителиТ + ?(ЗначениеЗаполнено(ИсполнителиТ),", ","") + ПроцедурыУправленияПерсоналом.ФамилияИнициалыФизЛица(СтрИсп.ФизЛицо);
	КонецЦикла;
	
	Область1.Параметры.Текст4 = ?(Исполнители.Количество()>0,?(Исполнители.Количество()=1,"Исполнитель: ","Исполнители: ") + ИсполнителиТ,"");
	
	Область1.Параметры.Организация = Организация;
	ТД.Вывести(Область1);
	
	Для Каждого Стр из Выработка Цикл
		Область2.Параметры.НомерСтроки = стр.НомерСтроки;
		Область2.Параметры.Изделие = стр.Изделие;
		Область2.Параметры.ДатаРаботы = Формат(Стр.ДатаРаботы,"ДЛФ=Д");
		Область2.Параметры.ТехнологическаяОперация = СокрЛП(стр.ТехнологическаяОперация.НазваниеОперации);
		Область2.Параметры.ТехническоеВремя = стр.ТехническоеВремя;
		Область2.Параметры.СтатьяЗатрат = стр.СтатьяЗатрат;
		Область2.Параметры.Расценка = стр.Расценка;
		Область2.Параметры.Количество = стр.Количество;
		
		//СВЭЙ 25.08.2023 КВВ СВФР-011329 (
		//Область2.Параметры.СуммаРегл = стр.СуммаРегл;
		Область2.Параметры.СуммаРегл = Окр(стр.Расценка * стр.Количество,4);
		//СВЭЙ 25.08.2023 КВВ СВФР-011329 )
		
		Область2.Параметры.НормоЧасы = стр.НормоЧасы;
		ТД.Вывести(Область2);
	КонецЦикла;
	
	Область3.Параметры.СуммаРеглИт = Выработка.Итог("СуммаРегл");
	Область3.Параметры.НормоЧасыИт = Выработка.Итог("НормоЧасы");
	ТД.Вывести(Область3);
	
	ПолеТабличногоДокумента1.Очистить();
	ПолеТабличногоДокумента1.Вывести(ТД);
	ПолеТабличногоДокумента1.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	ПолеТабличногоДокумента1.ЧерноБелаяПечать = Истина;
	РаботаСДиалогами.НапечататьДокумент(ТД, 1, Ложь,"Выполненные работы");
	//Аверсон 01.02.2023 КВВ СВФР-010173 )
	
	//Аверсон 21.04.2023 КВВ СВФР-010670 (
ИначеЕсли ИмяМакета = "НарядПоВП" Тогда
	ПолеТабличногоДокумента1 = Новый ТабличныйДокумент;	
	ТД = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("НарядПоВыполненнымРаботам");
	Область1 = Макет.ПолучитьОбласть("Область1");		
	Область2 = Макет.ПолучитьОбласть("Область2");
	Область3 = Макет.ПолучитьОбласть("Область3");
	Область4 = Макет.ПолучитьОбласть("Область4");
	
	Область1.Параметры.Организация = СокрЛП(Организация);
	Область1.Параметры.Период = "за " + нрег(Формат(ПериодРегистрации,"ДФ=ММММ")) + " " + СтрЗаменить(СокрЛП(Год(ПериодРегистрации)),Символ(160),"") + "г.";	
	Область1.Параметры.Бригада = СокрЛП(Бригада);
	Область1.Параметры.НомНаряда = СокрЛП(Номер);
	Область1.Параметры.НаимНаряда = ?(СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень,"Дополнительный наряд №","Наряд №");
	ТД.Вывести(Область1);
	
	ВсегоИтВып = 0;			ВсегоИтС1 = 0;		ВсегоИтС2 = 0;
	ТЗ = Выработка.Выгрузить();  
	ТЗ.Колонки.Добавить("ВидОпл");
	Для Каждого Стр ИЗ ТЗ Цикл
		Стр.ВидОпл = СокрЛП(Стр.ТехнологическаяОперация.КодНачисления);
	КонецЦикла;
	КопияТЗ = ТЗ.Скопировать();
	КопияТЗ.Свернуть("ВидОпл","Количество,ВсегоНормаЧасов");
	КопияТЗ.Сортировать("ВидОпл");
	ТЗ.Сортировать("ВидОпл,ТехнологическаяОперация,КодЛома");
	ИтС2Сум = 0;
	Для Каждого Стр1 ИЗ КопияТЗ Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("ВидОпл", Стр1.ВидОпл);
		СтрокиТЗ = ТЗ.НайтиСтроки(Отбор);
		С2Сум = 0;
		Для Каждого Стр2 Из СтрокиТЗ Цикл
			Область2.Параметры.ВО = Стр2.ВидОпл;
			Область2.Параметры.КЛ = Стр2.КодЛома;
			Область2.Параметры.ОР = Стр2.ТехнологическаяОперация;	
			Область2.Параметры.ЕИ = Стр2.ЕдиницаИзмерения;
			Область2.Параметры.Вып = Стр2.Количество;
			Область2.Параметры.Н1 = Стр2.НормаВремени;	
			Область2.Параметры.Н2 = Стр2.Расценка;	
			Область2.Параметры.С1 = Стр2.ВсегоНормаЧасов;	
			//С2Сум = С2Сум + Окр(Стр2.Количество * Стр2.Расценка,2);
			//Область2.Параметры.С2 = Окр(Стр2.Количество * Стр2.Расценка,2);
			С2Сум = С2Сум + Стр2.СуммаРегл;
			Область2.Параметры.С2 = Стр2.СуммаРегл;
			ТД.Вывести(Область2);
		КонецЦикла;
		Область3.Параметры.ИтВып = Стр1.Количество;
		Область3.Параметры.ИтС1	= Стр1.ВсегоНормаЧасов;	
		Область3.Параметры.ИтС2 = С2Сум;
		ТД.Вывести(Область3);
		ИтС2Сум = ИтС2Сум + С2Сум;
	КонецЦикла;
	   Область4.Параметры.ВсегоИтВып = ТЗ.Итог("Количество");
		Область4.Параметры.ВсегоИтС1 = ТЗ.Итог("ВсегоНормаЧасов");	
		Область4.Параметры.ВсегоИтС2 = ИтС2Сум;
	ТД.Вывести(Область4);
	
	ПолеТабличногоДокумента1.Очистить();
	ПолеТабличногоДокумента1.Вывести(ТД);
	ПолеТабличногоДокумента1.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	ПолеТабличногоДокумента1.ЧерноБелаяПечать = Истина;
	РаботаСДиалогами.НапечататьДокумент(ТД, 1, Ложь,"Наряд на сдельную работу");

ИначеЕсли ИмяМакета = "ТабельБригады" Тогда
	ПолеТабличногоДокумента1 = Новый ТабличныйДокумент;	
	ТД = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("ТабельДляБригадногоРасчета");
	Область1 = Макет.ПолучитьОбласть("Область1");		
	Область2 = Макет.ПолучитьОбласть("Область2");
	Область3 = Макет.ПолучитьОбласть("Область3");
	
	Область1.Параметры.Организация = СокрЛП(Организация);
	Область1.Параметры.Период = "за " + нрег(Формат(ПериодРегистрации,"ДФ=ММММ")) + " " + СтрЗаменить(СокрЛП(Год(ПериодРегистрации)),Символ(160),"") + "г.";	
	Область1.Параметры.Бригада = СокрЛП(Бригада);
	ТД.Вывести(Область1);
	
	ВсегоИтЧас = 0;
	Для Каждого Стр из Исполнители Цикл
		СчЧасов = 0;
		Область2.Параметры.ПП = Стр.НомерСтроки;
		Область2.Параметры.ТН = Стр.Сотрудник.Код;
		Область2.Параметры.ФИО = ПроцедурыУправленияПерсоналом.ФамилияИнициалыФизЛица(Стр.Сотрудник.Физлицо);
		Область2.Параметры.КТУ = Стр.КТУ;
		ПерваяЯвка = 0;
		Для ИндексДня = 1 По 31 Цикл
			Если ЗначениеЗаполнено(Стр["ПервыйЧасов" + Строка(ИндексДня)]) Тогда
				СчЧасов = СчЧасов + Стр["ПервыйЧасов" + Строка(ИндексДня)];
				Если ПерваяЯвка = 0 Тогда
					ПерваяЯвка = ИндексДня;
				КонецЕсли;
				Область2.Параметры["Зн"+Строка(ИндексДня)] = Стр["ПервыйЧасов" + Строка(ИндексДня)];
			Иначе
				Область2.Параметры["Зн"+Строка(ИндексДня)] = "";
			КонецЕсли;
		КонецЦикла;
		ДолжРазряд = "";
		Если ПерваяЯвка <> 0 Тогда
			НаДату_ = Дата(Год(ПериодРегистрации),Месяц(ПериодРегистрации), ПерваяЯвка);
			Д = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(НаДату_,Новый Структура("Сотрудник",Стр.Сотрудник)).Должность;
			Р = СокрЛП(РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(НаДату_,Новый Структура("Сотрудник",Стр.Сотрудник)).РазрядЕТС);
			ДолжРазряд = СокрЛП(Д) + ?(ЗначениеЗаполнено(Р),", разряд " + СокрЛП(Р),"");
		КонецЕсли;
		Область2.Параметры.ДолжРазряд = ДолжРазряд;
		Область2.Параметры.ИтЧас = СчЧасов;
		ТД.Вывести(Область2);
		ВсегоИтЧас = ВсегоИтЧас + СчЧасов;
	КонецЦикла;
	
	Область3.Параметры.ВсегоИтЧас = ВсегоИтЧас;
	ТД.Вывести(Область3);
	
	ПолеТабличногоДокумента1.Очистить();
	ПолеТабличногоДокумента1.Вывести(ТД);
	ПолеТабличногоДокумента1.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	ПолеТабличногоДокумента1.ЧерноБелаяПечать = Истина;
	РаботаСДиалогами.НапечататьДокумент(ТД, 1, Ложь,"Табель для бригадного расчета");
	//Аверсон 21.04.2023 КВВ СВФР-010670 )

КонецЕсли;

КонецФункции // Печать()

Процедура УдалитьПрочиеДоплатыПоРаботнику(Сотрудник, КодСтроки) Экспорт
	
	СтруктураПоиска = Новый Структура("Сотрудник, КодСтроки", Сотрудник, КодСтроки);
	
	Строки = ПрочиеДоплаты.НайтиСтроки(СтруктураПоиска);
	
	Для Каждого СтрокаТабличнойЧасти из Строки Цикл
		ПрочиеДоплаты.Удалить(СтрокаТабличнойЧасти);
	КонецЦикла;
КонецПроцедуры // УдалитьПрочиеДоплатыПоРаботнику()

Функция СформироватьЗапросПоПрочимДоплатам(Сотрудник, ТарифнаяСтавка)
	СтруктураПоиска = Новый Структура("Сотрудник, ТарифнаяСтавка", Сотрудник, ТарифнаяСтавка);
	
	Строки = ПрочиеДоплаты.НайтиСтроки(СтруктураПоиска);
	
	Возврат Строки;
КонецФункции

Функция СформироватьЗапросПрочиеДоплатыПоСотруднику(ВыбСотрудник) Экспорт
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Запрос = Новый Запрос;
	
	СотрудникиТекст = 
	"ВЫБРАТЬ
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель1,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ИспользуетсяВНаряде,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Действие,
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Период
	|ИЗ
	|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(&Период, ) КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
	|ГДЕ
	|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник = &Сотрудник
	|	И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ИспользуетсяВНаряде = &ИспользуетсяВНаряде
	|И ВЫБОР
	|	 КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ПериодЗавершения <= &парамНачало
	|		И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ДействиеЗавершения
	|		ИНАЧЕ ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Действие
	|		КОНЕЦ <> &Действие";
	//заявка №1687 (база заявок Кристалла) Дмитрук О.Г.
	//|	И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Действие <> &Действие"; 
	//заявка №1687
	
	Запрос.Текст = СотрудникиТекст;
	
	//Запрос.УстановитьПараметр("Период", НачалоМесяца(ПериодРегистрации));
	//заявка №1682 (база заявок Кристалла) Дмитрук О.Г.
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Запрос.УстановитьПараметр("Период", КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("Период", КонецМесяца(ПериодРегистрации1));
	//Аверсон СВФР-007772
	
	//заявка №1682
	Запрос.УстановитьПараметр("Сотрудник", ВыбСотрудник);
	Запрос.УстановитьПараметр("ИспользуетсяВНаряде", Истина);
	Запрос.УстановитьПараметр("Действие", Перечисления.ВидыДействияСНачислением.Прекратить);
	//заявка №1687 (база заявок Кристалла) Дмитрук О.Г.
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Запрос.УстановитьПараметр("парамНачало", НачалоМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("парамНачало", НачалоМесяца(ПериодРегистрации1));
	//Аверсон СВФР-007772
	
	//заявка №1687
	
	Результат = Запрос.Выполнить();
	Возврат Результат;
КонецФункции

Процедура ЗаполнимПрочиеДоплатыПоРаботнику(Сотрудник, ТарифнаяСтавка, КодСтроки, Флаг, ТекСтрокаДоплаты) Экспорт
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Если Флаг = 1 Тогда
		УдалитьПрочиеДоплатыПоРаботнику(Сотрудник, КодСтроки);
	КонецЕсли;
	
	ВыборкаПрочиеДоплаты = СформироватьЗапросПрочиеДоплатыПоСотруднику(Сотрудник).Выбрать();
	
	Если ВыборкаПрочиеДоплаты.Количество() > 0 Тогда
		Если Флаг = 1 Тогда
			ТекСтрокаДоплаты = ПрочиеДоплаты.Добавить();
		КонецЕсли;
		
		Пока ВыборкаПрочиеДоплаты.Следующий() Цикл
			Если Флаг = 1 Тогда
				ТекСтрокаДоплаты.Сотрудник = Сотрудник;
				ТекСтрокаДоплаты.ФизЛицо = Сотрудник.ФизЛицо;
				
				//СВЭЙ 08.02.2024 КВВ СВФР-012344 (
				////Аверсон ЕАЕ 23.07.2021 СВФР-007772
				////ТекСтрокаДоплаты.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Сотрудник.ссылка, КонецМесяца(ПериодРегистрации), ПериодРегистрации, мВалютаРегламентированногоУчета);
				//ТекСтрокаДоплаты.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Сотрудник.ссылка, КонецМесяца(ПериодРегистрации1), ПериодРегистрации1, мВалютаРегламентированногоУчета);
				////Аверсон СВФР-007772     
				
				ДатаДляЧТС = ОпределитьДатуДляЧТС("", Ложь, Сотрудник.Ссылка); 
				ТекСтрокаДоплаты.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Сотрудник.ссылка, ДатаДляЧТС, ПериодРегистрации1, мВалютаРегламентированногоУчета);
				//СВЭЙ 08.02.2024 КВВ СВФР-012344 )

				ТекСтрокаДоплаты.Доплата = ВыборкаПрочиеДоплаты.ВидРасчета;
			КонецЕсли;
			
			Если ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРуководствоБригадой Тогда
				ТекСтрокаДоплаты.ПроцентЗаРуководствоБригадой = ВыборкаПрочиеДоплаты.Показатель1;
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаКлассность Тогда
				ТекСтрокаДоплаты.ПроцентЗаКлассность = ВыборкаПрочиеДоплаты.Показатель1;
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСовмещениеПрофессий Тогда
				ТекСтрокаДоплаты.ПроцентЗаСовмещение = ВыборкаПрочиеДоплаты.Показатель1;
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаПрофмастерство Тогда
				ТекСтрокаДоплаты.ПроцентЗаПрофмастерство = ВыборкаПрочиеДоплаты.Показатель1;
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаЭкспедированиеГрузов Тогда
				ТекСтрокаДоплаты.ПроцентЗаЭкспедированиеГрузов = ВыборкаПрочиеДоплаты.Показатель1;
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда Тогда
				ТекСтрокаДоплаты.ПроцентВредныеУсловияТруда = ВыборкаПрочиеДоплаты.Показатель1;
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаУвеличениеОбъемовРабот Тогда
				ТекСтрокаДоплаты.ПроцентЗаУчеличенныйОбъем = ВыборкаПрочиеДоплаты.Показатель1;
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаСтажРаботыРабочие Тогда
				
				//Аверсон ЕАЕ 23.07.2021 СВФР-007772
				//ТекСтрокаДоплаты.ПроцентЗаСтаж = ПрочиеПроцедуры.ПолучитьПроцентОтСтажаПоСотруднику(Сотрудник, ВыборкаПрочиеДоплаты.ВидРасчета, КонецМесяца(ПериодРегистрации),Организация);//Островская Татьяна 24.07.2013 № 16643
				ТекСтрокаДоплаты.ПроцентЗаСтаж = ПрочиеПроцедуры.ПолучитьПроцентОтСтажаПоСотруднику(Сотрудник, ВыборкаПрочиеДоплаты.ВидРасчета, КонецМесяца(ПериодРегистрации1),Организация);//Островская Татьяна 24.07.2013 № 16643
				//Аверсон СВФР-007772
				
				//О.Т. Аверсон 05.04.2016 № 1027
				ПодразделениеУчилище = Ложь;
				
				//Аверсон ЕАЕ 23.07.2021 СВФР-007772
				//ПодразделениеОрг = ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Сотрудник, КонецМесяца(ПериодРегистрации));
				ПодразделениеОрг = ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Сотрудник, КонецМесяца(ПериодРегистрации1));
				//Аверсон СВФР-007772
				
				Если Найти(ТРег(ПодразделениеОрг), "Училище")>0 Тогда 
					ПодразделениеУчилище = Истина;
				КонецЕсли;
				Если ПодразделениеУчилище Тогда 
					ТекСтрокаДоплаты.ПроцентЗаСтаж = 0;
				КонецЕсли; 
				//О.Т. Аверсон 05.04.2016 № 1027
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРаботуВЗимнееВремя Тогда
				ТекСтрокаДоплаты.ПроцентЗаРаботуВЗимнееВремя = ВыборкаПрочиеДоплаты.Показатель1;
			ИначеЕсли ВыборкаПрочиеДоплаты.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПремияРабочимИзФОТ Тогда
				ТекСтрокаДоплаты.ПроцентПремии = ВыборкаПрочиеДоплаты.Показатель1;
			КонецЕсли;	
			
			Если Флаг = 1 Тогда
				ТекСтрокаДоплаты.КодСтроки = КодСтроки;
			КонецЕсли;
		КонецЦикла;
	Иначе 
		Если Флаг = 1 Тогда
			ТекСтрокаДоплаты = ПрочиеДоплаты.Добавить();
			ТекСтрокаДоплаты.Сотрудник = Сотрудник;
			ТекСтрокаДоплаты.ФизЛицо = Сотрудник.ФизЛицо;
			
			//СВЭЙ 08.02.2024 КВВ СВФР-012344 (
			////Аверсон ЕАЕ 23.07.2021 СВФР-007772
			////ТекСтрокаДоплаты.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Сотрудник.ссылка, КонецМесяца(ПериодРегистрации), ПериодРегистрации, мВалютаРегламентированногоУчета);
			//ТекСтрокаДоплаты.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Сотрудник.ссылка, КонецМесяца(ПериодРегистрации1), ПериодРегистрации1, мВалютаРегламентированногоУчета);
			////Аверсон СВФР-007772
			
			ДатаДляЧТС = ОпределитьДатуДляЧТС("", Ложь, Сотрудник.Ссылка);
			ТекСтрокаДоплаты.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Сотрудник.ссылка, ДатаДляЧТС, ПериодРегистрации1, мВалютаРегламентированногоУчета);
			//СВЭЙ 08.02.2024 КВВ СВФР-012344 )
			
			ТекСтрокаДоплаты.КодСтроки = КодСтроки;
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры


// Возвращает доступные варианты печати документа
//
// Вовращаемое значение:
//  Струткура, каждая строка которой соответствует одному из вариантов печати
//  
Функция ПолучитьСтруктуруПечатныхФорм() Экспорт
	
	СтруктураПечатныхФорм = Новый Структура;
	
	Если НЕ РольДоступна("СдельныеНаряды") Тогда  //Аверсон 26.02.2023 КВВ СВФР-010173
		Если СтатусДокумента = Перечисления.СтатусДокумента.Рассчитан Тогда
			СтруктураПечатныхФорм.Вставить("Табель",	"Табель");
			СтруктураПечатныхФорм.Вставить("ТабельРасшифровка",	"Табель (неявок)");
			СтруктураПечатныхФорм.Вставить("МакетВедомостьРасчета",	"Ведомость расчета");
		ИначеЕсли СтатусДокумента = Перечисления.СтатусДокумента.Проверен Тогда
			СтруктураПечатныхФорм.Вставить("Табель",	"Табель");
			СтруктураПечатныхФорм.Вставить("ТабельРасшифровка",	"Табель (неявок)");
		КонецЕсли;
		//Аверсон 26.02.2023 КВВ СВФР-010173 (
	Иначе
		Если СтатусДокумента = Перечисления.СтатусДокумента.Рассчитан Тогда
			СтруктураПечатныхФорм.Вставить("МакетВедомостьРасчета",	"Ведомость расчета");
		КонецЕсли;
	КонецЕсли;
	//Аверсон 26.02.2023 КВВ СВФР-010173 )
	
	//ПСА 11.02.2021 СВФР-007191+++
	СтруктураПечатныхФорм.Вставить("НарядБригады",	"Наряд бригады");
	
	//Аверсон 01.02.2023 КВВ СВФР-010173 (
	Если Организация.ИНН = "790056159" ИЛИ Организация.ИНН = "690305814" Тогда 
		СтруктураПечатныхФорм.Вставить("ВыполненныеРаботы",	"Выполненные работы");
	КонецЕсли;
	//Аверсон 01.02.2023 КВВ СВФР-010173 )
	
	//Аверсон 21.04.2023 КВВ СВФР-010670 (
	Если Организация.ИНН = "100071565" Тогда
		СтруктураПечатныхФорм.Вставить("ТабельБригады",	"Табель для бригадного расчета");
		СтруктураПечатныхФорм.Вставить("НарядПоВП",	"Наряд на сдельную работу");
	КонецЕсли;
	//Аверсон 21.04.2023 КВВ СВФР-010670 )
	
	Возврат СтруктураПечатныхФорм;
	
КонецФункции // ПолучитьСтруктуруПечатныхФорм()
// Функция формирует табличный документ с печатной формой "Т-1",
//
// Возвращаемое значение:
//  Табличный документ - печатная форма
//
Функция ПечатьВедомостьРасчета(ИмяМакета)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
		ДатаНачалаПериода1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
		ДатаНачалаПериода1 = ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ВедомостьРасчета";
	
	// запоминаем области макета
	Макет = ПолучитьМакет(ИмяМакета);
	ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка"); // Шапка документа
	ПовторятьПриПечатиСтроки = Макет.ПолучитьОбласть("ПовторятьПриПечати");
	
	ОбластьМакетаШапка.Параметры.Организация = Организация.Наименование;
	ОбластьМакетаШапка.Параметры.РабочаяДата = Формат(РабочаяДата,"ДФ=dd.MM.yy");
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//ОбластьМакетаШапка.Параметры.Период = ПредставлениеПериода(НачалоМесяца(ДатаНачалаПериода), КонецМесяца(ДатаНачалаПериода), "ДФ=""ММММ.гггг""");
	ОбластьМакетаШапка.Параметры.Период = ПредставлениеПериода(НачалоМесяца(ДатаНачалаПериода1), КонецМесяца(ДатаНачалаПериода1), "ДФ=""ММММ.гггг""");
	//Аверсон СВФР-007772
	
	ОбластьМакетаШапка.Параметры.Подразделение = "" + СокрЛП(ПодразделениеОрганизации.Код) + " " + СокрЛП(ПодразделениеОрганизации.Наименование);
	ОбластьМакетаШапка.Параметры.НомерНаряда = Номер;
	ВидОплаты = ""; ТекстСуммаЗарплаты = ""; ТекстСуммаПриработка = "";
	СуммаЗарплаты = 0; СуммаПриработка = 0; ТекстКоэффициент = "";
	
	ТарифнаяЧасть = 0; ИтогОтработанныхЧасов = 0; Коэффициент = 0;
	ОтработаноЧасов  = 0;
	
	Если ТипНаряда = 0 Тогда
		Для Каждого ТекСтрокаИсполнители Из Исполнители Цикл
			Если УчитыватьОтработанноеВремя Тогда
				Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
					
					Для сч = 1 По 5 Цикл
						
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа ИЛИ
							ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники ИЛИ
							ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные ИЛИ
							ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы ИЛИ
							ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы Тогда
							
							ОтработаноЧасов = ОтработаноЧасов + ТекСтрокаИсполнители ["Часов" + Сч]
							
						КонецЕсли;
						
					КонецЦикла;
					
				ИначеЕсли СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//ОтработаноЧасов = ВычислитьКоличествоЧасовВЯчейке(ТекСтрокаИсполнители, День(ДатаНачалаПериода));
					ОтработаноЧасов = ВычислитьКоличествоЧасовВЯчейке(ТекСтрокаИсполнители, День(ДатаНачалаПериода1));
					//Аверсон СВФР-007772
					
				Иначе	
					ОтработаноЧасов = ТекСтрокаИсполнители.ОтработаноЧасов
				КонецЕсли;
				ИтогОтработанныхЧасов = ИтогОтработанныхЧасов + ОтработаноЧасов;
				
				Если РаспределениеПриработка = Истина Тогда
					ТарифнаяЧасть = ТарифнаяЧасть + ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ТарифнаяСтавка * ОтработаноЧасов, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
				КонецЕсли;
				
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Если ТипНаряда = 0 Тогда
		Если ОтражатьВБухгалтерскомУчете = Истина Тогда
			СуммаЗарплаты = Выработка.Итог("СуммаРегл");
		Иначе
			СуммаЗарплаты = Выработка.Итог("Сумма");
		КонецЕСли;
		
		Если РаспределениеПриработка = Истина Тогда
			СуммаПриработка = СуммаЗарплаты - ТарифнаяЧасть;
			ТекстСуммаПриработка = "сумма приработка: ";
			ТекстКоэффициент = "Коэффициент распределения приработка: ";
			//О.Т. 18.12.2014 № 17744
			если ЗначениеЗаполнено(ТарифнаяЧасть) Тогда  
				Коэффициент = Окр(СуммаПриработка / ТарифнаяЧасть, 5 , 1);
			иначе
				Коэффициент = 0;
			КонецЕсли;
			//О.Т. 18.12.2014 № 17744
		Иначе
			ТекстКоэффициент = "Коэффициент з/п на 1 ч/час: ";
			Коэффициент = Окр(СуммаЗарплаты / ИтогОтработанныхЧасов, 5, 1);
		КонецЕсли;
		ТекстСуммаЗарплаты = "сумма з/п бригады по сдельным расценкам: ";
		
		Если Исполнители.Количество() = 1 Тогда
			ВидОплаты = "сдельщик - индивидуальщик";
		Иначе
			Если РаспределениеПриработка = Истина Тогда
				ВидОплаты = "сдельщик в бригаде (распределение приработка)";
			Иначе 
				ВидОплаты = "сдельщик в бригаде (пропорционально отработанному времени)";
			КонецЕсли;
		КонецЕсли;
	ИначеЕсли ТипНаряда = 1 Тогда
		Если Исполнители.Количество() = 1 Тогда
			Если УчитыватьКТУ = Ложь Тогда
				ВидОплаты = "повременщик - индивидуальщик";
			Иначе
				ВидОплаты = "повременщик - индивидуальщик с учетом выполнения норм выработки";
			КонецЕсли;
		Иначе
			Если УчитыватьКТУ = Истина Тогда
				ВидОплаты = "повременщик в бригаде с учетом выполнения норм выработки";
			Иначе
				ВидОплаты = "повременщик в бригаде";
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	ОбластьМакетаШапка.Параметры.ВидОплаты = ВидОплаты;
	ОбластьМакетаШапка.Параметры.ТекстСуммаЗарплаты = ТекстСуммаЗарплаты;
	ОбластьМакетаШапка.Параметры.СуммаЗарплаты = ?(НЕ СуммаЗарплаты = 0, СуммаЗарплаты, "");
	ОбластьМакетаШапка.Параметры.ТекстСуммаПриработка = ТекстСуммаПриработка;
	ОбластьМакетаШапка.Параметры.СуммаПриработка = ?(НЕ СуммаПриработка = 0, СуммаПриработка, "");
	Если ТипНаряда = 0 Тогда
		ОбластьМакетаШапка.Параметры.Коэффициент = ТекстКоэффициент + Коэффициент;
	Иначе
		ОбластьМакетаШапка.Параметры.Коэффициент = "";
	КонецЕСли;
	ТабДокумент.Вывести(ОбластьМакетаШапка);
	
	// Строка документа
	ИтогТариф = 0; ИтогЗП = 0; ИтогСуммаВечерние = 0; ИтогСуммаНочные = 0; ИтогСуммаСверхурочные = 0;
	ИтогПрочиеСумма = 0; ИтогНачислено = 0; ИтогСуммаПремии = 0; ИтогИтогоНачислено = 0; ИтогСуммаПраздничные = 0;
	ИтогЧасы = 0; ИтогСуммаВыходные = 0;
	
	ОбластьМакетаСтрока = Макет.ПолучитьОбласть("Строка"); 
	
	мСтрока = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(
	Новый Структура("Организация", Организация));
	
	Для Каждого ТекСтрокаИсполнители Из Исполнители Цикл
		ОтработаноЧасов = 0; ЧасыВечерние = 0; ЧасыНочные = 0; ЧасыСверхурочные = 0; ЧасыПраздничные = 0; ЧасыВыходные = 0; ЧасыРемонт = 0;
		СуммаВечерние = 0; СуммаНочные = 0; СуммаСверхурочные = 0; ПроцентПремия = 0; ПрочиеДоплата = ""; СуммаВыходные = 0;
		Тариф = 0; ЗП = 0; Начислено = 0; ИтогоНачислено = 0; ПрочиеСумма = 0; СуммаПремии = 0; СуммаПраздничные = 0;
		
		ТЗ = Новый  ТаблицаЗначений;
		ТЗ.Колонки.Добавить("Сотрудник");
		ТЗ.Колонки.Добавить("Доплата");
		ТЗ.Колонки.Добавить("Сумма");
		
		Если УчитыватьОтработанноеВремя Тогда
			Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
				
				Для сч = 1 По 5 Цикл
					
					Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа ИЛИ
						ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники ИЛИ
						ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные ИЛИ
						ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы ИЛИ
						ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы ИЛИ
						//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
						ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт ИЛИ
						//заявка №1664 
						ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни Тогда
						
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
							ОтработаноЧасов = ОтработаноЧасов + ТекСтрокаИсполнители ["Часов" + Сч];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы Тогда
							ЧасыВечерние = ЧасыВечерние + ТекСтрокаИсполнители ["Часов" + Сч];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы Тогда
							ЧасыНочные = ЧасыНочные + ТекСтрокаИсполнители ["Часов" + Сч];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные Тогда
							ЧасыСверхурочные = ЧасыСверхурочные + ТекСтрокаИсполнители ["Часов" + Сч];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники Тогда
							ЧасыПраздничные = ЧасыПраздничные + ТекСтрокаИсполнители ["Часов" + Сч];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни Тогда
							ЧасыВыходные = ЧасыВыходные + ТекСтрокаИсполнители ["Часов" + Сч];
						КонецЕсли;
						
						//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда
							ЧасыРемонт = ЧасыРемонт + ТекСтрокаИсполнители ["Часов" + Сч];
						КонецЕсли;
						//заявка №1664 
						
					КонецЕсли;
					
				КонецЦикла;
				
			ИначеЕсли СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
				
				//Аверсон ЕАЕ 23.07.2021 СВФР-007772
				//СтрокаИндексДня = День(ДатаНачалаПериода);
				СтрокаИндексДня = День(ДатаНачалаПериода1);
				//Аверсон СВФР-007772
				
				// цикл по значениям внутри дня
				Для ИндексМассиваПриставок = 0 По 2 Цикл
					Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа ИЛИ
						ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники ИЛИ
						ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные ИЛИ
						ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы ИЛИ
						ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы ИЛИ 
						//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
						ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт ИЛИ 
						//заявка №1664
						ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни Тогда
						
						Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
							ОтработаноЧасов	= ОтработаноЧасов + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы Тогда
							ЧасыВечерние = ЧасыВечерние + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы Тогда
							ЧасыНочные = ЧасыНочные + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные Тогда
							ЧасыСверхурочные = ЧасыСверхурочные + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники Тогда
							ЧасыПраздничные = ЧасыПраздничные + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
						КонецЕсли;
						
						Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни Тогда
							ЧасыВыходные = ЧасыВыходные + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
						КонецЕсли;
						
						//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
						Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда
							ЧасыРемонт = ЧасыРемонт + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
						КонецЕсли;
						//заявка №1664
						
					КонецЕсли;
				КонецЦикла;
			Иначе	
				Для СтрокаИндексДня = 1 по 31 Цикл
					// цикл по значениям внутри дня
					Для ИндексМассиваПриставок = 0 По 2 Цикл
						Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа ИЛИ
							ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники ИЛИ
							ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные ИЛИ
							ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы ИЛИ
							ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы ИЛИ
							//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
							ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт ИЛИ
							//заявка №1664
							ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни Тогда
							
							Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								ОтработаноЧасов	= ОтработаноЧасов + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
							КонецЕсли;
							
							Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы Тогда
								ЧасыВечерние = ЧасыВечерние + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
							КонецЕсли;
							
							Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы Тогда
								ЧасыНочные = ЧасыНочные + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
							КонецЕсли;
							
							Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные Тогда
								ЧасыСверхурочные = ЧасыСверхурочные + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
							КонецЕсли;
							
							Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники Тогда
								ЧасыПраздничные = ЧасыПраздничные + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
							КонецЕсли;
							
							Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни Тогда
								ЧасыВыходные = ЧасыВыходные + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
							КонецЕсли;
							
							//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
							Если ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда
								ЧасыРемонт = ЧасыРемонт + ТекСтрокаИсполнители[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
							КонецЕсли;
							//заявка №1664
							
						КонецЕсли;
					КонецЦикла;
					
				КонецЦикла;
				
			КонецЕсли;
			
			ОбластьМакетаСтрока.Параметры.ТН = Формат(ТекСтрокаИсполнители.Сотрудник.Код, "ЧГ=0");
			ОбластьМакетаСтрока.Параметры.ФИО = ТекСтрокаИсполнители.Сотрудник.Наименование;
			ОбластьМакетаСтрока.Параметры.ЧТС = ТекСтрокаИсполнители.ТарифнаяСтавка;
			ОбластьМакетаСтрока.Параметры.Часы = ОтработаноЧасов + ЧасыРемонт;
			
			Если ТипНаряда = 0 Тогда
				ОбластьМакетаСтрока.Параметры.КТУ = "";
			ИначеЕсли ТипНаряда = 1 Тогда
				Если УчитыватьКТУ = Истина Тогда
					ОбластьМакетаСтрока.Параметры.КТУ = ТекСтрокаИсполнители.КТУ;
				Иначе
					ОбластьМакетаСтрока.Параметры.КТУ = "";
				КонецЕсли;
			КонецЕсли;
			
			//Тариф = Окр(ТекСтрокаИсполнители.ТарифнаяСтавка * ОтработаноЧасов, 0, 1);
			//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
			Тариф = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ТарифнаяСтавка * (ОтработаноЧасов + ЧасыРемонт), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
			//заявка №1664
			
			ОбластьМакетаСтрока.Параметры.Тариф = Тариф;
			Если ОтражатьВБухгалтерскомУчете = Истина Тогда
				ЗП = ТекСтрокаИсполнители.СуммаКНачислениюРегл;
			Иначе
				ЗП = ТекСтрокаИсполнители.СуммаКНачислению;
			КонецЕСли;
			ОбластьМакетаСтрока.Параметры.ЗП = ЗП;
			
			СуммаВечерние = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ТарифнаяСтавка * ЧасыВечерние * ?(мСтрока.ПроцентОплатыВечерних <> 0, мСтрока.ПроцентОплатыВечерних / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
			ОбластьМакетаСтрока.Параметры.СуммаВечерние = СуммаВечерние;	
			СуммаНочные = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ТарифнаяСтавка * ЧасыНочные * ?(мСтрока.ПроцентОплатыНочных <> 0, мСтрока.ПроцентОплатыНочных / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
			ОбластьМакетаСтрока.Параметры.СуммаНочные = СуммаНочные;
			СуммаСверхурочные = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ТарифнаяСтавка * ЧасыСверхурочные, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
			ОбластьМакетаСтрока.Параметры.СуммаСверхурочные = СуммаСверхурочные;
			СуммаПраздничные = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ТарифнаяСтавка * ЧасыПраздничные * ?(ТекСтрокаИсполнители.КТУ <> 0, ТекСтрокаИсполнители.КТУ / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
			ОбластьМакетаСтрока.Параметры.СуммаПраздничные = СуммаПраздничные;
			СуммаВыходные = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ТарифнаяСтавка * ЧасыВыходные * ?(ТекСтрокаИсполнители.КТУ <> 0, ТекСтрокаИсполнители.КТУ / 100, 1), Дата, 1); //О.Т. Аверсон 17.03.2016 № 949
			ОбластьМакетаСтрока.Параметры.СуммаВыходные = СуммаВыходные;
			
			ПрочиеСумма = 0; СуммаПремии = 0; СуммаПремииРемонт = 0;
			
			Строки = СформироватьЗапросПоПрочимДоплатам(ТекСтрокаИсполнители.Сотрудник, ТекСтрокаИсполнители.ТарифнаяСтавка);
			
			Для Каждого СтрокаТабличнойЧасти из Строки Цикл
				//расчет Премии рабочим из ФЗП
				Если СтрокаТабличнойЧасти.ПроцентПремии <> 0 Тогда
					Если ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПремияРабочимИзФОТ.СпособРасчета =  Перечисления.СпособыРасчетаОплатыТруда.ПроцентОтТарифнойСтавки Тогда
						ПроцентПремия = СтрокаТабличнойЧасти.ПроцентПремии;
						СуммаПремии = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентПремии / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						//заявка №2049 (база заявок Кристалла) Дмитрук О.Г.
						СуммаПремииРемонт = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ЧасыРемонт * 20 / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949						
						//заявка №2049
					КонецЕСли;
				КонецЕСли;
				
				ПрочиеСумма = 0;  ПроцентСтажа = 0;
				
				Если СтрокаТабличнойЧасти.ПроцентЗаСтаж <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаСтажРаботыРабочие.Код;
					//ПрочиеСумма = Окр(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентЗаСтаж / 100, 0, 1);
					//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
					ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * (ОтработаноЧасов + ЧасыРемонт) * СтрокаТабличнойЧасти.ПроцентЗаСтаж / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					//заявка №1664 
					
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
				Если СтрокаТабличнойЧасти.ПроцентВредныеУсловияТруда <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда.Код;
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации),
					мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации1),
					//Аверсон СВФР-007772
					
					Новый Структура("Организация,ТарифнаяСтавка",Организация,Справочники.ТарифныеСтавкиПервогоРазряда.Основная)).Размер;
					Если Дата < Дата(2016,07,1) Тогда //О.Т. Аверсон 16.03.2016 № 949
						ПрочиеСумма = Окр(Окр(мТС1Разряда * СтрокаТабличнойЧасти.ПроцентВредныеУсловияТруда / 100, 2) * ОтработаноЧасов, 0, 1);
					иначе
						ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(ОбщегоНазначения.ОкруглитьЗначение2016(мТС1Разряда * СтрокаТабличнойЧасти.ПроцентВредныеУсловияТруда / 100, Дата) * ОтработаноЧасов, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					КонецЕсли;

										
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
				Если СтрокаТабличнойЧасти.ПроцентЗаРуководствоБригадой <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРуководствоБригадой.Код;
					
					ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентЗаРуководствоБригадой / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
				Если СтрокаТабличнойЧасти.ПроцентЗаКлассность <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаКлассность.Код;
					
					ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентЗаКлассность / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
				Если СтрокаТабличнойЧасти.ПроцентЗаПрофмастерство <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаПрофмастерство.Код;
					
					ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентЗаПрофмастерство / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
				Если СтрокаТабличнойЧасти.ПроцентЗаУчеличенныйОбъем <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаУвеличениеОбъемовРабот.Код;
					
					ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентЗаУчеличенныйОбъем / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
				Если СтрокаТабличнойЧасти.ПроцентЗаЭкспедированиеГрузов <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаЭкспедированиеГрузов.Код;
					
					ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентЗаЭкспедированиеГрузов / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
				Если СтрокаТабличнойЧасти.ПроцентЗаРаботуВЗимнееВремя <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРаботуВЗимнееВремя.Код;
					
					ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентЗаРаботуВЗимнееВремя / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
				Если СтрокаТабличнойЧасти.ПроцентЗаСовмещение <> 0 Тогда
					ПрочиеДоплата = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСовмещениеПрофессий.Код;
					
					ПрочиеСумма = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаТабличнойЧасти.ТарифнаяСтавка * ОтработаноЧасов * СтрокаТабличнойЧасти.ПроцентЗаСовмещение / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
					
					Если ПрочиеСумма <> 0 Тогда
						НоваяСтрока = ТЗ.Добавить();
						НоваяСтрока.Сотрудник = ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Доплата = ПрочиеДоплата;
						НоваяСтрока.Сумма = ПрочиеСумма;
					КонецЕсли;
					
				КонецЕСли;
				
			КонецЦикла;
			
			//ОбластьМакетаСтрока.Параметры.ПрочиеСумма = ПрочиеСумма;
			ОбластьМакетаСтрока.Параметры.ПроцентПремия = ПроцентПремия;
			ОбластьМакетаСтрока.Параметры.СуммаПремии = СуммаПремии + СуммаПремииРемонт;
			
			Начислено = ЗП + СуммаВечерние + СуммаНочные + СуммаСверхурочные + СуммаПраздничные + СуммаВыходные + ТЗ.Итог("Сумма");
			ОбластьМакетаСтрока.Параметры.Начислено = Начислено;
			
			ИтогоНачислено = Начислено + СуммаПремии + СуммаПремииРемонт;
			ОбластьМакетаСтрока.Параметры.ИтогоНачислено = ИтогоНачислено;
			
			//расчет итогов
			ИтогТариф = ИтогТариф + Тариф;
			ИтогЗП = ИтогЗП + ЗП;
			ИтогСуммаВечерние = ИтогСуммаВечерние + СуммаВечерние;
			ИтогСуммаНочные = ИтогСуммаНочные + СуммаНочные;
			ИтогСуммаСверхурочные = ИтогСуммаСверхурочные + СуммаСверхурочные;
			ИтогСуммаВыходные = ИтогСуммаВыходные + СуммаВыходные;
			ИтогСуммаПраздничные = ИтогСуммаПраздничные + СуммаПраздничные;
			ИтогПрочиеСумма = ИтогПрочиеСумма + ТЗ.Итог("Сумма");
			ИтогНачислено = ИтогНачислено + Начислено;
			ИтогСуммаПремии = ИтогСуммаПремии + СуммаПремии + СуммаПремииРемонт;
			ИтогИтогоНачислено = ИтогИтогоНачислено + ИтогоНачислено;
			ИтогЧасы = ИтогЧасы + ОтработаноЧасов + ЧасыРемонт;
		КонецЕсли;
		
		ТабДокумент.Вывести(ОбластьМакетаСтрока);
		
		Если ТЗ.Количество() > 0 Тогда
			ОбластьМакетаСтрокаПрочиеДоплаты = Макет.ПолучитьОбласть("ПрочиеДоплаты");
			
			Для Каждого ТекСтр Из ТЗ Цикл
				ОбластьМакетаСтрокаПрочиеДоплаты.Параметры.ПрочиеКод = ТекСтр.Доплата;
				ОбластьМакетаСтрокаПрочиеДоплаты.Параметры.ПрочиеСумма = ТекСтр.Сумма;
				ТабДокумент.Вывести(ОбластьМакетаСтрокаПрочиеДоплаты);
				
			КонецЦикла;
		КонецЕСли;
		
	КонецЦикла;	
	
	// Подвал документа
	ОбластьМакетаПодвал = Макет.ПолучитьОбласть("Подвал"); 
	ОбластьМакетаПодвал.Параметры.ИтогЧасы = ИтогЧасы;
	ОбластьМакетаПодвал.Параметры.ИтогТариф = ИтогТариф;
	ОбластьМакетаПодвал.Параметры.ИтогЗП = ИтогЗП;
	ОбластьМакетаПодвал.Параметры.ИтогСуммаВечерние = ИтогСуммаВечерние;
	ОбластьМакетаПодвал.Параметры.ИтогСуммаНочные = ИтогСуммаНочные;
	ОбластьМакетаПодвал.Параметры.ИтогСуммаСверхурочные = ИтогСуммаСверхурочные;
	ОбластьМакетаПодвал.Параметры.ИтогСуммаПраздничные = ИтогСуммаПраздничные;
	ОбластьМакетаПодвал.Параметры.ИтогСуммаВыходные = ИтогСуммаВыходные;
	ОбластьМакетаПодвал.Параметры.ИтогПрочиеСумма = ИтогПрочиеСумма;
	ОбластьМакетаПодвал.Параметры.ИтогНачислено = ИтогНачислено;
	ОбластьМакетаПодвал.Параметры.ИтогСуммаПремии = ИтогСуммаПремии;
	ОбластьМакетаПодвал.Параметры.ИтогИтогоНачислено = ИтогИтогоНачислено;
	ТабДокумент.Вывести(ОбластьМакетаПодвал);
	
	Возврат ТабДокумент;
	
КонецФункции // ПечатьТ1()

Функция СформироватьЗапросПоКатегорииОбъекта(Сотрудник) Экспорт
	Запрос = Новый Запрос;
	КатегорииТекст =" 
	|ВЫБРАТЬ
	|	КатегорииОбъектов.Объект
	|ИЗ
	|	РегистрСведений.КатегорииОбъектов КАК КатегорииОбъектов
	|ГДЕ
	|	КатегорииОбъектов.Объект = &Объект
	|	И КатегорииОбъектов.Категория = &Категория";
	
	Запрос.Текст = КатегорииТекст;
	Запрос.УстановитьПараметр("Объект", Сотрудник);
	Запрос.УстановитьПараметр("Категория", ПризнакФормированияТабеля);
	
	Результат = Запрос.Выполнить().Выбрать();
	
	Возврат Результат;
КонецФункции

// Процедура предназначена для автозаполнения документа
// Если заполнен параметр сотрудники, то в табличную часть будут добавлены 
// строки по указаным сотрудникам.
Процедура Автозаполнение(ПостроительЗапроса = Неопределено, Сотрудники = Неопределено, ТекущаяСтрокаТабличнойЧасти = Неопределено) Экспорт
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
		ДатаНачалаПериода1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
		ДатаНачалаПериода1 = ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	СписокКатегорий = Новый СписокЗначений;
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//РезультатВыбора = ПрочиеПроцедуры.СформироватьМассивДоступныхКатегорийСотрудника(НачалоМесяца(ПериодРегистрации), ПодразделениеОрганизации).Выбрать();
	РезультатВыбора = ПрочиеПроцедуры.СформироватьМассивДоступныхКатегорийСотрудника(НачалоМесяца(ПериодРегистрации1), ПодразделениеОрганизации).Выбрать();
	//Аверсон СВФР-007772
	
	Пока РезультатВыбора.Следующий() Цикл
		
		Если РезультатВыбора.Категория.ТипДокумента = 2 Тогда
			СписокКатегорий.Добавить(РезультатВыбора.Категория);
		КонецЕсли;
		
	КонецЦикла;
	
	ЗапросАвтоЗаполнения = Новый Запрос;
	
	ЗапросАвтоЗаполнения.УстановитьПараметр("ГоловнаяОрганизация", ОбщегоНазначения.ГоловнаяОрганизация(Организация));
	ЗапросАвтоЗаполнения.УстановитьПараметр("ОбособленноеПодразделение", Организация);
	//ЗапросАвтоЗаполнения.УстановитьПараметр("ТрудовойДоговор", Перечисления.ВидыДоговоровСФизЛицами.ТрудовойДоговор);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ТрудовойДоговор", Перечисления.ВидыДоговоровСФизЛицами.Контракт);
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//ЗапросАвтоЗаполнения.УстановитьПараметр("НачалоМесяца", ПериодРегистрации);
	//ЗапросАвтоЗаполнения.УстановитьПараметр("КонецМесяца", КонецМесяца(ПериодРегистрации));
	ЗапросАвтоЗаполнения.УстановитьПараметр("НачалоМесяца", ПериодРегистрации1);
	ЗапросАвтоЗаполнения.УстановитьПараметр("КонецМесяца", КонецМесяца(ПериодРегистрации1));
	//Аверсон СВФР-007772
	
	Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//ЗапросАвтоЗаполнения.УстановитьПараметр("ДатаНачалаПериода", ДатаНачалаПериода);
		//ДатаОкончанияПериода = ДатаНачалаПериода;
		ЗапросАвтоЗаполнения.УстановитьПараметр("ДатаНачалаПериода", ДатаНачалаПериода1);
		ДатаОкончанияПериода = ДатаНачалаПериода1;
		//Аверсон СВФР-007772
		
		ЗапросАвтоЗаполнения.УстановитьПараметр("ДатаОкончанияПериода", ДатаОкончанияПериода);
	Иначе
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//ЗапросАвтоЗаполнения.УстановитьПараметр("ДатаНачалаПериода", ПериодРегистрации);
		//ДатаОкончанияПериода = КонецМесяца(ПериодРегистрации);
		ЗапросАвтоЗаполнения.УстановитьПараметр("ДатаНачалаПериода", ПериодРегистрации1);
		ДатаОкончанияПериода = КонецМесяца(ПериодРегистрации1);
		//Аверсон СВФР-007772
		
		ЗапросАвтоЗаполнения.УстановитьПараметр("ДатаОкончанияПериода", ДатаОкончанияПериода);
	КонецЕсли;
	ЗапросАвтоЗаполнения.УстановитьПараметр("УчитыватьОтработанноеВремя", УчитыватьОтработанноеВремя);
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//ЗапросАвтоЗаполнения.УстановитьПараметр("Месяц", ПериодРегистрации);
	ЗапросАвтоЗаполнения.УстановитьПараметр("Месяц", ПериодРегистрации1);
	//Аверсон СВФР-007772
	
	ЗапросАвтоЗаполнения.УстановитьПараметр("ВидУчетаВремениПоДням", ВидУчетаВремениПоДням);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ВидУчетаВремениПоЧасам", ВидУчетаВремениПоЧасам);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ВидУчетаВремениПоВечернимЧасам", Перечисления.ВидыУчетаВремени.ПоВечернимЧасам);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ВидУчетаВремениПоНочнымЧасам", Перечисления.ВидыУчетаВремени.ПоНочнымЧасам);
	
	ЗапросАвтоЗаполнения.УстановитьПараметр("КлассификаторЯ", Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
	ЗапросАвтоЗаполнения.УстановитьПараметр("КлассификаторВЧ", КлассификаторВечернееВремя);
	ЗапросАвтоЗаполнения.УстановитьПараметр("КлассификаторНЧ", КлассификаторНочноеВремя);
	
	ЗапросАвтоЗаполнения.УстановитьПараметр("ДокументСсылка", Ссылка);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ПустоеПодразделение", Справочники.ПодразделенияОрганизаций.ПустаяСсылка());
	ЗапросАвтоЗаполнения.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
	
	ЗапросАвтоЗаполнения.УстановитьПараметр("ДокументСсылка", Ссылка);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ПустойДокумент", Документы.ТабельУчетаРабочегоВремениОрганизации.ПустаяСсылка());
	
	ЗапросАвтоЗаполнения.УстановитьПараметр("СверхНормы", Перечисления.ВидыВремени.ОтработанноеСверхНормы);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ПустойКлассификатор", Справочники.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка());
	
	ЗапросАвтоЗаполнения.УстановитьПараметр("ПоЧасам", Перечисления.ВидыУчетаВремени.ПоЧасам);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ПоВечерним", Перечисления.ВидыУчетаВремени.ПоВечернимЧасам);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ПоНочным", Перечисления.ВидыУчетаВремени.ПоНочнымЧасам); 
	
	ВидыВремениУчитываемыеВВыходные = Новый Массив(2);
	ВидыВремениУчитываемыеВВыходные[0] = Перечисления.ВидыВремени.ОтработанноеСверхНормы;
	ВидыВремениУчитываемыеВВыходные[1] = Перечисления.ВидыВремени.ЦелодневноеНеотработанное;
	ЗапросАвтоЗаполнения.УстановитьПараметр("ВидыВремениУчитываемыеВВыходные", ВидыВремениУчитываемыеВВыходные);
	ЗапросАвтоЗаполнения.УстановитьПараметр("ПустойГрафик", Справочники.ГрафикиРаботы.ПустаяСсылка());
	
	
	ЗаполнениеПоБригаде = Ложь; //ПСА 08.02.2021 СВФР-007149+++
	Если ПостроительЗапроса = Неопределено Тогда 
		
		Если Сотрудники = Неопределено Тогда
			//ПСА 08.02.2021 СВФР-007149+++
			Если ЗначениеЗаполнено(Бригада) и (Организация.ИНН = "700067572" ИЛИ Организация.ИНН = "100071565" ИЛИ Организация.ИНН = "790056159" ИЛИ Организация.ИНН = "690305814") Тогда //Аверсон ЕАЕ 20.10.2021 СВФР-008068 //Аверсон 19.01.2023 КВВ СВФР-009950  //Аверсон 01.02.2023 КВВ СВФР-010173
				ЗаполнениеПоБригаде = Истина;
			КонецЕсли; 
			Если ЗаполнениеПоБригаде Тогда
				Запрос = Новый Запрос;
				Запрос.Текст = 
				"ВЫБРАТЬ
				|	НазначениеСотрудниковПоБригадамСрезПоследних.Сотрудник
				|ПОМЕСТИТЬ ВтСотрудники
				|ИЗ
				|	РегистрСведений.НазначениеСотрудниковПоБригадам.СрезПоследних(
				|			&ДатаОкончания,
				|			Организация = &Организация
				//ПСА 15.06.2021 СВФР-007706 +++
				//|				И Бригада = &Бригада) КАК НазначениеСотрудниковПоБригадамСрезПоследних
				|				) КАК НазначениеСотрудниковПоБригадамСрезПоследних
				|ГДЕ
				|	НазначениеСотрудниковПоБригадамСрезПоследних.Бригада = &Бригада
				//+++ПСА 15.06.2021 СВФР-007706
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|	НазначениеСотрудниковПоБригадамСрезПоследних.Сотрудник
				|ИЗ
				|	РегистрСведений.НазначениеСотрудниковПоБригадам.СрезПоследних(
				|			&ДатаНачала,
				|			Организация = &Организация
				//ПСА 15.06.2021 СВФР-007706 +++
				//|				И Бригада = &Бригада) КАК НазначениеСотрудниковПоБригадамСрезПоследних
				|				) КАК НазначениеСотрудниковПоБригадамСрезПоследних
				|ГДЕ
				|	НазначениеСотрудниковПоБригадамСрезПоследних.Бригада = &Бригада
				//+++ПСА 15.06.2021 СВФР-007706
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|	НазначениеСотрудниковПоБригадам.Сотрудник
				|ИЗ
				|	РегистрСведений.НазначениеСотрудниковПоБригадам КАК НазначениеСотрудниковПоБригадам
				|ГДЕ
				|	НазначениеСотрудниковПоБригадам.Организация = &Организация
				|	И НазначениеСотрудниковПоБригадам.Бригада = &Бригада
				|	И НазначениеСотрудниковПоБригадам.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
				|;
				|
				|////////////////////////////////////////////////////////////////////////////////
				|ВЫБРАТЬ РАЗЛИЧНЫЕ
				|	ВтСотрудники.Сотрудник
				|ИЗ
				|	ВтСотрудники КАК ВтСотрудники";
				
				Запрос.УстановитьПараметр("Бригада", Бригада);
				Запрос.УстановитьПараметр("ДатаНачала", ЗапросАвтоЗаполнения.Параметры.ДатаНачалаПериода);
				Запрос.УстановитьПараметр("ДатаОкончания", ЗапросАвтоЗаполнения.Параметры.ДатаОкончанияПериода);
				Запрос.УстановитьПараметр("Организация", Организация);
				СписокСотрудников = Запрос.Выполнить().Выгрузить();
				//+++ПСА 08.02.2021 СВФР-007149
			Иначе	
				СотрудникиТекст = 
				"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
				|	РаботникиОрганизаций.Сотрудник КАК Ссылка,
				|	РаботникиОрганизаций.Сотрудник.Код КАК СотрудникКод
				|ИЗ
				
				//Аверсон ЕАЕ 06.06.2025 СВФР-015580
				//|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&КонецМесяца, Организация = &ГоловнаяОрганизация) КАК РаботникиОрганизаций
				|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоМесяца, Организация = &ГоловнаяОрганизация) КАК РаботникиОрганизаций
				//Аверсон СВФР-015580
				
				|ГДЕ
				|	ВЫБОР
				|			КОГДА РаботникиОрганизаций.ПериодЗавершения <= &НачалоМесяца
				|					И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизаций.ПричинаИзмененияСостоянияЗавершения
				|			ИНАЧЕ РаботникиОрганизаций.ПричинаИзмененияСостояния
				|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|	И ВЫБОР
				|			КОГДА РаботникиОрганизаций.ПериодЗавершения <= &НачалоМесяца
				|					И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|				ТОГДА РаботникиОрганизаций.ОбособленноеПодразделениеЗавершения
				|			ИНАЧЕ РаботникиОрганизаций.ОбособленноеПодразделение
				|		КОНЕЦ = &ОбособленноеПодразделение
				|	И (ВЫБОР
				|				КОГДА РаботникиОрганизаций.ПериодЗавершения <= &НачалоМесяца
				|						И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|					ТОГДА РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
				|				ИНАЧЕ РаботникиОрганизаций.ПодразделениеОрганизации
				|			КОНЕЦ В ИЕРАРХИИ (&Подразделение)
				|			ИЛИ &Подразделение = &ПустоеПодразделение)
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|	РаботникиОрганизаций.Сотрудник,
				|	РаботникиОрганизаций.Сотрудник.Код
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
				|ГДЕ
				|	РаботникиОрганизаций.Период > &НачалоМесяца
				|	И РаботникиОрганизаций.Период <= &КонецМесяца
				|	И РаботникиОрганизаций.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|	И РаботникиОрганизаций.Организация = &ГоловнаяОрганизация
				|	И РаботникиОрганизаций.ОбособленноеПодразделение = &ОбособленноеПодразделение
				|	И (РаботникиОрганизаций.ПодразделениеОрганизации В ИЕРАРХИИ (&Подразделение)
				|			ИЛИ &Подразделение = &ПустоеПодразделение)
				|
				|ОБЪЕДИНИТЬ ВСЕ
				|
				|ВЫБРАТЬ
				|	Работники.Сотрудник,
				|	Работники.Сотрудник.Код
				|ИЗ
				|	РегистрСведений.РаботникиОрганизаций КАК Работники
				|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
				|		ПО ПериодыПерекрытия.Период <= Работники.ПериодЗавершения
				|			И ПериодыПерекрытия.Период > Работники.Период
				|			И ПериодыПерекрытия.Сотрудник.Физлицо = Работники.Сотрудник.Физлицо
				|			И (ПериодыПерекрытия.Организация = &ГоловнаяОрганизация)
				|ГДЕ
				|	Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
				|	И Работники.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
				|	И Работники.ПериодЗавершения > &НачалоМесяца
				|	И Работники.ПериодЗавершения <= &КонецМесяца
				|	И Работники.Организация = &ГоловнаяОрганизация
				|	И Работники.ОбособленноеПодразделениеЗавершения = &ОбособленноеПодразделение
				|	И (Работники.ПодразделениеОрганизацииЗавершения В ИЕРАРХИИ (&Подразделение)
				|			ИЛИ &Подразделение = &ПустоеПодразделение)
				|	И ПериодыПерекрытия.Период ЕСТЬ NULL 
				|УПОРЯДОЧИТЬ ПО
				|	СотрудникКод"; 
				
				ЗапросАвтоЗаполнения.Текст = СотрудникиТекст;
				СписокСотрудников = ЗапросАвтоЗаполнения.Выполнить().Выгрузить();
				ЗапросАвтоЗаполнения.УстановитьПараметр("ВключатьВРезультатПустыеЗаписи", ?(УчитыватьОтработанноеВремя,Ложь, Истина));
			КонецЕсли;
		Иначе
			СписокСотрудников = Сотрудники;
			ЗапросАвтоЗаполнения.УстановитьПараметр("ВключатьВРезультатПустыеЗаписи", Истина);
		КонецЕсли;
	Иначе
		
		ИсходныйТекстПостроителя = ПостроительЗапроса.Текст;
		ТекстЗапросаПоСпискуРаботников = СтрЗаменить(ИсходныйТекстПостроителя,"РАЗРЕШЕННЫЕ","");
		ТекстЗапросаПоСпискуРаботников = Лев(ТекстЗапросаПоСпискуРаботников, Найти(ТекстЗапросаПоСпискуРаботников,"УПОРЯДОЧИТЬ") - 1);
		
		СотрудникиТекст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СписокРаботников.Сотрудник КАК Ссылка
		|ИЗ
		|	(" + ТекстЗапросаПоСпискуРаботников + ") КАК СписокРаботников ";
		ПостроительЗапроса.Текст = СотрудникиТекст;
		ПостроительЗапроса.Выполнить();
		СписокСотрудников = ПостроительЗапроса.Результат.Выгрузить();
		ЗапросАвтоЗаполнения.УстановитьПараметр("ВключатьВРезультатПустыеЗаписи", ?(УчитыватьОтработанноеВремя,Ложь, Истина));
	КонецЕсли;
	
	//ПСА 08.02.2021 СВФР-007149+++
	Если ЗаполнениеПоБригаде Тогда
		АвтоЗаполнениеПоБригаде(СписокСотрудников, ЗапросАвтоЗаполнения.Параметры.ДатаНачалаПериода, ЗапросАвтоЗаполнения.Параметры.ДатаОкончанияПериода);
		
	//Аверсон ЕАЕ 20.05.2024 СВФР-012937
	//Праздничные, сверхурочные
	//Бобруйсксельмаш
	ИначеЕсли (Праздники = Истина ИЛИ Сверхурочно = Истина) И Организация.ИНН = "790056159" Тогда
	    АвтозаполнениеПраздничныхСверхурочных(СписокСотрудников, ЗапросАвтоЗаполнения.Параметры.ДатаНачалаПериода, ЗапросАвтоЗаполнения.Параметры.ДатаОкончанияПериода);
	//Аверсон СВФР-012937	
		
	Иначе
	//+++ПСА 08.02.2021 СВФР-007149
		ЗапросАвтоЗаполнения.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
		ЗапросАвтоЗаполнения.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//ГодПериода = Формат(Год(ПериодРегистрации), "ЧГ=4");
		//МесяцПериода = Месяц(ПериодРегистрации);
		ГодПериода = Формат(Год(ПериодРегистрации1), "ЧГ=4");
		МесяцПериода = Месяц(ПериодРегистрации1);
		//Аверсон СВФР-007772
		
		ТекстЗапроса = "ВЫБРАТЬ
		|	ДатаТабеля
		|	
		|ПОМЕСТИТЬ ВТДатыТабеля 
		|	ИЗ (
		|	ВЫБРАТЬ
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//|	ДАТАВРЕМЯ(" + ГодПериода + ", " + МесяцПериода + " , " + День(ДатаНачалаПериода) + ") КАК ДатаТабеля
		|	ДАТАВРЕМЯ(" + ГодПериода + ", " + МесяцПериода + " , " + День(ДатаНачалаПериода1) + ") КАК ДатаТабеля
		//Аверсон СВФР-007772
		
		|	";
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//Для НомерДня = День(ДатаНачалаПериода) + 1 По День(ДатаОкончанияПериода) Цикл
		Для НомерДня = День(ДатаНачалаПериода1) + 1 По День(ДатаОкончанияПериода) Цикл
		//Аверсон СВФР-007772
		
			ТекстЗапроса = ТекстЗапроса + 
			"ОБЪЕДИНИТЬ ВСЕ
			|ВЫБРАТЬ
			|  ДАТАВРЕМЯ(" + ГодПериода + ", " + МесяцПериода + " ," + НомерДня + ")
			|	";
		КонецЦикла;
		ТекстЗапроса = ТекстЗапроса + ") КАК ДатыТабеля";
		ЗапросАвтоЗаполнения.Текст = ТекстЗапроса;
		ЗапросАвтоЗаполнения.Выполнить();
		
		ЗапросАвтоЗаполнения.Текст = "ВЫБРАТЬ
		|	ДатыТабеля.ДатаТабеля,
		|	ВЫБОР КОГДА Начисления.ВидРасчета ЕСТЬ NULL 
		|		ТОГДА ПлановыеНачисления.Сотрудник
		|		ИНАЧЕ Начисления.Сотрудник
		|		КОНЕЦ КАК Сотрудник,
		|		
		|	ВЫБОР КОГДА Начисления.ВидРасчета ЕСТЬ NULL 
		|		ТОГДА 
		|			NULL
		|		ИНАЧЕ Начисления.ГрафикРаботы
		|		КОНЕЦ КАК ГрафикРаботы,
		|		
		|	ВЫБОР КОГДА Начисления.ВидРасчета ЕСТЬ NULL 
		|		ТОГДА ПлановыеНачисления.ВидРасчета
		|		ИНАЧЕ Начисления.ВидРасчета
		|		КОНЕЦ КАК ВидРасчета,
		|		
		|	ВЫБОР КОГДА Начисления.ВидРасчета ЕСТЬ NULL 
		|		ТОГДА ВЫБОР КОГДА ПлановыеНачисления.ВидРасчетаИзмерение ЕСТЬ NULL 
		|				ТОГДА NULL
		|				ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоДням)
		|			КОНЕЦ
		|		ИНАЧЕ Начисления.ВидУчетаВремени
		|		КОНЕЦ КАК ВидУчетаВремени,
		|		
		|	ВЫБОР КОГДА Начисления.ВидРасчета ЕСТЬ NULL 
		|		ТОГДА ПлановыеНачисления.ВидРасчетаИзмерение.ВидВремени
		|		ИНАЧЕ Начисления.ВидРасчета.ВидВремени
		|		КОНЕЦ КАК ВидВремени,
		|		
		|	ВЫБОР КОГДА Начисления.ВидРасчета ЕСТЬ NULL 
		|		ТОГДА 
		|			ВЫБОР КОГДА ПлановыеНачисления.ВидРасчетаИзмерение ЕСТЬ NULL
		|				ТОГДА NULL
		|			ИНАЧЕ &НачалоМесяца
		|			КОНЕЦ
		|		ИНАЧЕ Начисления.ПериодДействияНачало
		|		КОНЕЦ КАК ПериодДействияНачало,
		|		
		|	ВЫБОР КОГДА Начисления.ВидРасчета ЕСТЬ NULL 
		|		ТОГДА 
		|			ВЫБОР КОГДА ПлановыеНачисления.ВидРасчетаИзмерение ЕСТЬ NULL 
		|				ТОГДА NULL
		|			ИНАЧЕ &КонецМесяца
		|			КОНЕЦ
		|		ИНАЧЕ  Начисления.ПериодДействияКонец
		|		КОНЕЦ КАК ПериодДействияКонец,
		|			
		|	ВЫБОР КОГДА (Начисления.ВидРасчета.ВидВремени = ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеСверхНормы)) ТОГДА
		|		ВЫБОР КОГДА ДатыТабеля.ДатаТабеля = Начисления.ПериодДействияНачало ТОГДА
		|			Начисления.ОтработаноЧасов
		|		ИНАЧЕ
		|			0
		|		КОНЕЦ
		|	ИНАЧЕ
		|		ВЫБОР КОГДА ПлановыеНачисления.ВидРасчетаИзмерение ЕСТЬ NULL ТОГДА
		|			NULL
		|		ИНАЧЕ 
		|			0
		|		КОНЕЦ
		|	КОНЕЦ КАК ВремяЗаДень
		|ПОМЕСТИТЬ ВТОсновныеНачисления
		|ИЗ 
		|	ВТДатыТабеля КАК ДатыТабеля
		|ЛЕВОЕ СОЕДИНЕНИЕ
		|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций Как ПлановыеНачисления
		
		|ПО	
		|	ПлановыеНачисления.Сотрудник В (&СписокСотрудников)
		|	И ДатыТабеля.ДатаТабеля МЕЖДУ ПлановыеНачисления.Период И ПлановыеНачисления.ПериодЗавершения
		|	И ПлановыеНачисления.ВидРасчетаИзмерение = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)
		|	
		|ЛЕВОЕ СОЕДИНЕНИЕ
		|	(ВЫБРАТЬ
		|		Начисления.Сотрудник,
		|		Начисления.Сотрудник.Код КАК СотрудникКод,
		|		Начисления.ГрафикРаботы,
		|		Начисления.ВидРасчета,
		|		Начисления.ВидУчетаВремени,
		|		Начисления.ПериодДействияНачало,
		|		Начисления.ПериодДействияКонец,
		|		Начисления.ОтработаноЧасов
		|ИЗ	
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(Сотрудник В (&СписокСотрудников)) КАК Начисления
		|	
		|ЛЕВОЕ СОЕДИНЕНИЕ
		|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(Сотрудник В (&СписокСотрудников)) КАК СторноНачисления
		|ПО
		|	СторноНачисления.Сторно
		|	И НЕ Начисления.Сторно
		|	И СторноНачисления.Сотрудник = Начисления.Сотрудник
		|	И СторноНачисления.ВидРасчета = Начисления.ВидРасчета
		|	И СторноНачисления.ПериодРегистрации > Начисления.ПериодРегистрации
		|	И СторноНачисления.ПериодДействия = &Месяц
		|	И СторноНачисления.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени <> &ПустойКлассификатор
		|	И НЕ СторноНачисления.ВидРасчета.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))
		|ГДЕ
		|	СторноНачисления.Сотрудник Есть NULL
		|	И НЕ Начисления.Сторно
		|	И Начисления.ПериодДействия = &Месяц
		|	И Начисления.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени <> &ПустойКлассификатор
		|	И НЕ Начисления.ВидРасчета.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы))	
		|	) КАК Начисления
		|ПО	
		|	ДатыТабеля.ДатаТабеля МЕЖДУ Начисления.ПериодДействияНачало И Начисления.ПериодДействияКонец
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник,
		|	ДатыТабеля.ДатаТабеля,
		|	ВидРасчета";
		
		ЗапросАвтоЗаполнения.Выполнить();
		
		
		ЗапросАвтоЗаполнения.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы,
		|	ГрафикиРаботыПоВидамВремени.Месяц,
		|	ГрафикиРаботыПоВидамВремени.Дата,
		|	ГрафикиРаботыПоВидамВремени.План,
		|	ГрафикиРаботыПоВидамВремени.ВидУчетаВремени,
		|	ГрафикиРаботыПоВидамВремени.ОсновноеЗначение,
		|	ГрафикиРаботыПоВидамВремени.ДополнительноеЗначение,
		|	ГрафикиРаботыПоВидамВремени.Документ
		|ПОМЕСТИТЬ ВТГрафикиРаботыПоВидамВремени
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫБОР
		|			КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &НачалоМесяца
		|					И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА РаботникиОрганизацийСрезПоследних.ГрафикРаботыЗавершения
		|			ИНАЧЕ РаботникиОрганизацийСрезПоследних.ГрафикРаботы
		|		КОНЕЦ КАК ГрафикРаботы
		|	ИЗ
		|		РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоМесяца, Сотрудник В (&СписокСотрудников)) КАК РаботникиОрганизацийСрезПоследних
		|	ГДЕ
		|		ВЫБОР
		|				КОГДА РаботникиОрганизацийСрезПоследних.ПериодЗавершения <= &НачалоМесяца
		|						И РаботникиОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА РаботникиОрганизацийСрезПоследних.ГрафикРаботыЗавершения
		|				ИНАЧЕ РаботникиОрганизацийСрезПоследних.ГрафикРаботы
		|			КОНЕЦ <> &ПустойГрафик
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		РаботникиОрганизаций.ГрафикРаботы
		|	ИЗ
		|		РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|	ГДЕ
		|		РаботникиОрганизаций.Сотрудник В(&СписокСотрудников)
		|		И РаботникиОрганизаций.Период > &НачалоМесяца
		|		И РаботникиОрганизаций.Период <= &КонецМесяца
		|		И РаботникиОрганизаций.ГрафикРаботы <> &ПустойГрафик
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		Работники.ГрафикРаботыЗавершения
		|	ИЗ
		|		РегистрСведений.РаботникиОрганизаций КАК Работники
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПериодыПерекрытия
		|			ПО ПериодыПерекрытия.Период <= Работники.ПериодЗавершения
		|				И ПериодыПерекрытия.Период > Работники.Период
		|				И ПериодыПерекрытия.Сотрудник = Работники.Сотрудник
		|	ГДЕ
		|		Работники.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|		И Работники.ПериодЗавершения > &НачалоМесяца
		|		И Работники.ПериодЗавершения <= &КонецМесяца
		|		И Работники.ГрафикРаботыЗавершения <> &ПустойГрафик
		|		И ПериодыПерекрытия.Период ЕСТЬ NULL 
		|		И Работники.Сотрудник В(&СписокСотрудников)
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		ВыбранныеСотрудники.Ссылка
		|	ИЗ
		|		Справочник.СотрудникиОрганизаций КАК ВыбранныеСотрудники
		|	ГДЕ
		|		ВыбранныеСотрудники.Ссылка В(&СписокСотрудников)) КАК ГрафикиРаботы
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
		|		ПО ГрафикиРаботыПоВидамВремени.ГрафикРаботы = ГрафикиРаботы.ГрафикРаботы
		|			И (ГрафикиРаботыПоВидамВремени.Документ <> &ДокументСсылка)
		|			И (ГрафикиРаботыПоВидамВремени.Документ <> &ПустойДокумент)
		|			И (ГрафикиРаботыПоВидамВремени.Месяц = &Месяц)
		|			И (ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &НачалоМесяца И &КонецМесяца)
		|			И ((НЕ ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ NULL ))
		|ГДЕ
		|	(НЕ ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ NULL )
		|ИНДЕКСИРОВАТЬ ПО
		|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы,
		|	ГрафикиРаботыПоВидамВремени.Месяц,
		|	ГрафикиРаботыПоВидамВремени.Дата,
		|	ГрафикиРаботыПоВидамВремени.План,
		|	ГрафикиРаботыПоВидамВремени.ВидУчетаВремени";
		ЗапросАвтоЗаполнения.Выполнить();
		
		Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
			
			
			ЗапросАвтоЗаполнения.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	ВТОсновныеНачисления.ДатаТабеля,
			|	ВТОсновныеНачисления.Сотрудник,
			|	ВТОсновныеНачисления.ГрафикРаботы,
			|	ВТОсновныеНачисления.ВидРасчета,
			|	ВТОсновныеНачисления.ВидВремени,
			|	ВТОсновныеНачисления.ПериодДействияНачало,
			|	ВТОсновныеНачисления.ПериодДействияКонец,
			|	ВТОсновныеНачисления.ВремяЗаДень
			|ПОМЕСТИТЬ ВТОтредактированныеНачисления
			|ИЗ
			|	ВТОсновныеНачисления
			|	
			|ОБЪЕДИНИТЬ 
			|
			|
			|ВЫБРАТЬ
			|	ВТОсновныеНачисления.ДатаТабеля,
			|	ВТОсновныеНачисления.Сотрудник,
			|	ВТОсновныеНачисления.ГрафикРаботы,
			|	""ПланируемаяЯвка"", 
			|	NULL,
			|	ВТОсновныеНачисления.ПериодДействияНачало,
			|	ВТОсновныеНачисления.ПериодДействияКонец,
			|	ВТОсновныеНачисления.ВремяЗаДень
			|ИЗ
			|	ВТОсновныеНачисления
			|ЛЕВОЕ СОЕДИНЕНИЕ
			|	ВТОсновныеНачисления КАК Явки
			|ПО
			|	Явки.ДатаТабеля = ВТОсновныеНачисления.ДатаТабеля
			|	И Явки.Сотрудник = ВТОсновныеНачисления.Сотрудник
			|	И Явки.ГрафикРаботы = ВТОсновныеНачисления.ГрафикРаботы
			|	И Явки.ВидВремени = ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеВПределахНормы)
			|ЛЕВОЕ СОЕДИНЕНИЕ
			|	ВТГрафикиРаботыПоВидамВремени КАК ГрафикиРаботы
			|ПО
			|	ГрафикиРаботы.ГрафикРаботы = ВТОсновныеНачисления.ГрафикРаботы
			|	И ГрафикиРаботы.Дата = ВТОсновныеНачисления.ДатаТабеля
			|	И ГрафикиРаботы.ВидУчетаВремени = ВТОсновныеНачисления.ВидУчетаВремени
			|ГДЕ
			|	Явки.Сотрудник ЕСТЬ NULL
			|	И ГрафикиРаботы.ОсновноеЗначение > 0 
			|	И ВТОсновныеНачисления.ВидВремени = ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеСверхНормы)";
			
			ЗапросАвтоЗаполнения.Выполнить();
			
			// Заполнение за целый период.
			ЗапросАвтоЗаполненияТекст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	СотрудникиОрганизаций.Ссылка КАК Сотрудник,
			|	СотрудникиОрганизаций.Код Как СотрудникКод,
			|	ЕСТЬNULL(ПосчитанноеВремя.Дней, 0) КАК Дней,
			|	ЕСТЬNULL(ПосчитанноеВремя.Часов, 0) КАК Часов,
			|	ЕСТЬNULL(ПосчитанноеВремя.ЧасовВечерних, 0) КАК ЧасовВечерних,
			|	ЕСТЬNULL(ПосчитанноеВремя.ЧасовНочных, 0) КАК ЧасовНочных,
			|	ПосчитанноеВремя.ВидВремени КАК ВидВремени
			|ИЗ
			|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			СотрудникиОрганизаций.Ссылка КАК Сотрудник,
			|			ЕСТЬNULL(СводныеИндивидуальныеГрафики.Дней, ПосчитаннаяНормаВремени.ОсновноеЗначениеПоДням) КАК Дней,
			|			ЕСТЬNULL(СводныеИндивидуальныеГрафики.Часов, ПосчитаннаяНормаВремени.ОсновноеЗначениеПоЧасам) КАК Часов,
			|			ЕСТЬNULL(СводныеИндивидуальныеГрафики.ЧасовВечерних, ПосчитаннаяНормаВремени.ОсновноеЗначениеПоВечерним) КАК ЧасовВечерних,
			|			ЕСТЬNULL(СводныеИндивидуальныеГрафики.ЧасовНочных, ПосчитаннаяНормаВремени.ОсновноеЗначениеПоНочным) КАК ЧасовНочных,
			|			ПосчитаннаяНормаВремени.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени КАК ВидВремени
			|		ИЗ
			|			Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
			|				ЛЕВОЕ СОЕДИНЕНИЕ (
			|				ВЫБРАТЬ
			|					ДниСотрудников.Сотрудник КАК Сотрудник,
			|					СУММА(ВЫБОР
			|							
			|							КОГДА ДневныеНеявки.ВидВремени = 1
			|								ТОГДА 0
			|							КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоЧасам
			|								ТОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ДополнительноеЗначение, ОбщиеГрафики.ДополнительноеЗначение)
			|						КОНЕЦ) КАК ОсновноеЗначениеПоДням,
			|					СУММА(ВЫБОР
			|							КОГДА НЕ ДневныеНеявки.ВремяЗаДень ЕСТЬ NULL И ДневныеНеявки.ВидРасчета <> ""ПланируемаяЯвка"" И ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоЧасам 
			|								И ДневныеНеявки.ВремяЗаДень > 0
			|								ТОГДА ДневныеНеявки.ВремяЗаДень 
			|					        КОГДА ДневныеНеявки.ВидРасчета = ""ПланируемаяЯвка"" И ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоЧасам 
			|					        	ТОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение)
			|							КОГДА ДневныеНеявки.ВидВремени = 1 И ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоЧасам 
			|								ТОГДА ЕСТЬNULL(ДневныеНеявки.ВремяЗаДень, 0)
			|							КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоЧасам
			|								ТОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение) - ЕСТЬNULL(ДневныеНеявки.ВремяЗаДень, 0)
			|						КОНЕЦ) КАК ОсновноеЗначениеПоЧасам,
			|					СУММА(ВЫБОР
			|							КОГДА (НЕ ДневныеНеявки.Сотрудник ЕСТЬ NULL И ДневныеНеявки.ВидРасчета <> ""ПланируемаяЯвка"")
			|								ТОГДА 0
			|								
			|							КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоВечерним
			|								ТОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение)
			|						КОНЕЦ) КАК ОсновноеЗначениеПоВечерним,
			|					СУММА(ВЫБОР
			|							КОГДА (НЕ ДневныеНеявки.Сотрудник ЕСТЬ NULL И ДневныеНеявки.ВидРасчета <> ""ПланируемаяЯвка"")
			|								ТОГДА 0
			|							КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоНочным
			|								ТОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение)
			|						КОНЕЦ) КАК ОсновноеЗначениеПоНочным,
			|					КОЛИЧЕСТВО(ВведенныеТабеля.ГрафикРаботы) КАК ВведенныеТабеля,
			|					ВЫБОР 
			|						КОГДА ДневныеНеявки.ВидРасчета = ""ПланируемаяЯвка"" 
			|							ТОГДА NULL
			|						ИНАЧЕ ДневныеНеявки.ВидРасчета
			|					КОНЕЦ КАК ВидРасчета,
			|					ЕСТЬNULL(ЛОЖЬ, ИСТИНА) КАК ДействуетВесьПериод
			|				ИЗ
			|					(ВЫБРАТЬ
			|						ДатыПериода.ДатаТабеля КАК Дата,
			|						РаботникиОрганизаций.Сотрудник КАК Сотрудник,
			|						МАКСИМУМ(РаботникиОрганизаций.Период) КАК ДатаИзменения
			|					ИЗ
			|						ВТДатыТабеля КАК ДатыПериода
			|							ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|							ПО (РаботникиОрганизаций.Сотрудник В (&СписокСотрудников))
			|								И РаботникиОрганизаций.Период <= ДатыПериода.ДатаТабеля
			|					
			|					СГРУППИРОВАТЬ ПО
			|						РаботникиОрганизаций.Сотрудник,
			|						ДатыПериода.ДатаТабеля) КАК ДниСотрудников
			|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|						ПО РаботникиОрганизаций.Сотрудник = ДниСотрудников.Сотрудник
			|							И РаботникиОрганизаций.Период = ДниСотрудников.ДатаИзменения
			|						ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиРаботыПоВидамВремени КАК ВведенныеТабеля
			|						ПО ВведенныеТабеля.ГрафикРаботы = ДниСотрудников.Сотрудник
			|							И ((НЕ ВведенныеТабеля.План))
			|							И (ВведенныеТабеля.Документ <> &ДокументСсылка)
			|							И (ВведенныеТабеля.Документ <> &ПустойДокумент)
			|							И ВведенныеТабеля.Дата = ДниСотрудников.Дата
			|							И (ВведенныеТабеля.ВидУчетаВремени = &ПоЧасам)
			|							И (ВведенныеТабеля.Документ ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации)
			|						ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиРаботыПоВидамВремени КАК ИндивидуальныеГрафики
			|						ПО ИндивидуальныеГрафики.ГрафикРаботы = ДниСотрудников.Сотрудник
			|							И (ИндивидуальныеГрафики.План)
			|							И ИндивидуальныеГрафики.Дата = ДниСотрудников.Дата
			|							И (ИндивидуальныеГрафики.ВидУчетаВремени В (&ПоЧасам, &ПоВечерним, &ПоНочным))
			|							И (ИндивидуальныеГрафики.Документ ССЫЛКА Документ.ВводИндивидуальныхГрафиковРаботыОрганизации)
			|						ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиРаботыПоВидамВремени КАК ОбщиеГрафики
			|						ПО (ОбщиеГрафики.ГрафикРаботы = ВЫБОР
			|								КОГДА РаботникиОрганизаций.ПериодЗавершения <= ДниСотрудников.Дата
			|										И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|									ТОГДА РаботникиОрганизаций.ГрафикРаботыЗавершения
			|								ИНАЧЕ РаботникиОрганизаций.ГрафикРаботы
			|							КОНЕЦ)
			|							И (ОбщиеГрафики.План)
			|							И ОбщиеГрафики.Дата = ДниСотрудников.Дата
			|							И (ОбщиеГрафики.ВидУчетаВремени В (&ПоЧасам, &ПоВечерним, &ПоНочным))
			|							И (ИндивидуальныеГрафики.ГрафикРаботы ЕСТЬ NULL)
			|						ЛЕВОЕ СОЕДИНЕНИЕ ВТОтредактированныеНачисления КАК ДневныеНеявки
			|						ПО ДневныеНеявки.Сотрудник = ДниСотрудников.Сотрудник
			|							И (ДниСотрудников.Дата = ДневныеНеявки.ДатаТабеля)
			|				
			|						ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийУвольнения
			|						ПО
			|							РаботникиОрганизацийУвольнения.Сотрудник = ДниСотрудников.Сотрудник
			|							И РаботникиОрганизацийУвольнения.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)	
			|						ГДЕ
			|							(РаботникиОрганизацийУвольнения.Период ЕСТЬ NULL
			|							ИЛИ РаботникиОрганизацийУвольнения.Период > ДниСотрудников.Дата)	
			|				СГРУППИРОВАТЬ ПО
			|					ДниСотрудников.Сотрудник,
			|					ВЫБОР 
			|						КОГДА ДневныеНеявки.ВидРасчета = ""ПланируемаяЯвка"" 
			|							ТОГДА NULL
			|						ИНАЧЕ ДневныеНеявки.ВидРасчета
			|					КОНЕЦ
			|					) КАК ПосчитаннаяНормаВремени
			|					
			|				ПО ПосчитаннаяНормаВремени.Сотрудник = СотрудникиОрганизаций.Ссылка
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
			|				ПО СводныеИндивидуальныеГрафики.Сотрудник = СотрудникиОрганизаций.Ссылка
			|					И (СводныеИндивидуальныеГрафики.Месяц = &Месяц)
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК СводныеТабеля
			|				ПО СводныеТабеля.Сотрудник = СотрудникиОрганизаций.Ссылка
			|					И (СводныеТабеля.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации)
			|					И (СводныеТабеля.Регистратор <> &ДокументСсылка)
			|					И (СводныеТабеля.Период = &Месяц)
			|		ГДЕ
			|			СотрудникиОрганизаций.Ссылка В(&СписокСотрудников)
			|			И ПосчитаннаяНормаВремени.ВведенныеТабеля = 0
			|			И СводныеТабеля.Сотрудник ЕСТЬ NULL 
			|			И (СводныеИндивидуальныеГрафики.Сотрудник ЕСТЬ NULL 
			|					ИЛИ ПосчитаннаяНормаВремени.ДействуетВесьПериод)
			|					) КАК ПосчитанноеВремя
			|		ПО ПосчитанноеВремя.Сотрудник = СотрудникиОрганизаций.Ссылка
			|ГДЕ
			|	СотрудникиОрганизаций.Ссылка В(&СписокСотрудников)
			|	И (&ВключатьВРезультатПустыеЗаписи
			|			ИЛИ (НЕ ПосчитанноеВремя.Часов ЕСТЬ NULL ))
			|
			|УПОРЯДОЧИТЬ ПО
			|	СотрудникКод ВОЗР,
			|	Сотрудник,
			|	ВидВремени";
			
		Иначе
			// Заполнение с разбивкой по дням.
			
			ЗапросАвтоЗаполнения.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	ВТОсновныеНачисления.ДатаТабеля,
			|	ВТОсновныеНачисления.Сотрудник,
			|	ВТОсновныеНачисления.ГрафикРаботы,
			|	ВТОсновныеНачисления.ВидРасчета,
			|	ВТОсновныеНачисления.ВидВремени,
			|	ВТОсновныеНачисления.ПериодДействияНачало,
			|	ВТОсновныеНачисления.ПериодДействияКонец,
			|	ВТОсновныеНачисления.ВремяЗаДень
			|ПОМЕСТИТЬ ВТОтредактированныеНачисления
			|ИЗ
			|	ВТОсновныеНачисления
			|	
			|ОБЪЕДИНИТЬ 
			|
			|
			|ВЫБРАТЬ
			|	ВТОсновныеНачисления.ДатаТабеля,
			|	ВТОсновныеНачисления.Сотрудник,
			|	ВТОсновныеНачисления.ГрафикРаботы,
			|	""ПланируемаяЯвка"", 
			|	NULL,
			|	ВТОсновныеНачисления.ПериодДействияНачало,
			|	ВТОсновныеНачисления.ПериодДействияКонец,
			|	ВТОсновныеНачисления.ВремяЗаДень
			|ИЗ
			|	ВТОсновныеНачисления
			|ЛЕВОЕ СОЕДИНЕНИЕ
			|	ВТОсновныеНачисления КАК Явки
			|ПО
			|	Явки.ДатаТабеля = ВТОсновныеНачисления.ДатаТабеля
			|	И Явки.Сотрудник = ВТОсновныеНачисления.Сотрудник
			|	И (Явки.ГрафикРаботы = ВТОсновныеНачисления.ГрафикРаботы 
			|		ИЛИ Явки.ГрафикРаботы = ВТОсновныеНачисления.Сотрудник)
			|	И Явки.ВидВремени = ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеВПределахНормы)
			|ЛЕВОЕ СОЕДИНЕНИЕ
			|	ВТГрафикиРаботыПоВидамВремени КАК ГрафикиРаботы
			|ПО
			|	ГрафикиРаботы.ГрафикРаботы = ВТОсновныеНачисления.ГрафикРаботы
			|	И ГрафикиРаботы.Дата = ВТОсновныеНачисления.ДатаТабеля
			|	И ГрафикиРаботы.ВидУчетаВремени = ВТОсновныеНачисления.ВидУчетаВремени
			|ГДЕ
			|	Явки.Сотрудник ЕСТЬ NULL
			|	И ГрафикиРаботы.ОсновноеЗначение > 0 
			|	И ВТОсновныеНачисления.ВидВремени = ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ОтработанноеСверхНормы)";
			ЗапросАвтоЗаполнения.Выполнить();
			
			
			ЗапросАвтоЗаполненияТекст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	Сотрудники.Ссылка Как Сотрудник,
			|	Сотрудники.Код Как СотрудникКод,
			|	ДниСотрудников.Дата,
			|	День(ДниСотрудников.Дата) Как День,
			|	ДниСотрудников.ВидВремени Как БукваВидаВремени,
			|	ДниСотрудников.ОсновноеЗначение,
			|	ВЫБОР 
			|		КОГДА ДниСотрудников.ВидВремени = &КлассификаторЯ Тогда 1
			|		КОГДА ДниСотрудников.ВидВремени = &КлассификаторВЧ Тогда 2
			|		КОГДА ДниСотрудников.ВидВремени = &КлассификаторНЧ Тогда 3
			|	ИНАЧЕ 4
			|	КОНЕЦ КАК ПорядокСортировки
			|	
			|	ИЗ
			|		Справочник.СотрудникиОрганизаций Как Сотрудники
			|	ЛЕВОЕ СОЕДИНЕНИЕ
			|	(ВЫБРАТЬ
			|	ДниСотрудников.Сотрудник,
			|	ДниСотрудников.Дата,
			|	ВЫБОР
			|		КОГДА (НЕ ДневныеНеявки.ВидРасчета ЕСТЬ NULL И ДневныеНеявки.ВидРасчета <> ""ПланируемаяЯвка"")
			|				И (ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение) > 0
			|					ИЛИ ДневныеНеявки.ВидРасчета.ВидВремени В (&ВидыВремениУчитываемыеВВыходные))
			|			ТОГДА ДневныеНеявки.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени
			|		КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение) > 0
			|			ТОГДА ВЫБОР
			|					КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоЧасам
			|						ТОГДА &КлассификаторЯ
			|					КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоВечерним
			|						ТОГДА &КлассификаторВЧ
			|					КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ВидУчетаВремени, ОбщиеГрафики.ВидУчетаВремени) = &ПоНочным
			|						ТОГДА &КлассификаторНЧ
			|				КОНЕЦ
			|	КОНЕЦ КАК ВидВремени,
			|	ВЫБОР
			|		КОГДА НЕ ДневныеНеявки.ВремяЗаДень ЕСТЬ NULL И ДневныеНеявки.ВидРасчета <> ""ПланируемаяЯвка""
			|			И 
			|			(ДневныеНеявки.ВремяЗаДень > 0 ИЛИ 
			|			ДневныеНеявки.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты))
			|			ТОГДА ДневныеНеявки.ВремяЗаДень
			|		КОГДА (НЕ ДневныеНеявки.ВидРасчета ЕСТЬ NULL И ДневныеНеявки.ВидРасчета <> ""ПланируемаяЯвка"")
			|				И (ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение) > 0
			|					ИЛИ ДневныеНеявки.ВидРасчета.ВидВремени В (&ВидыВремениУчитываемыеВВыходные))
			|			ТОГДА 
			|				ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ЕСТЬNULL(ОбщиеГрафики.ОсновноеЗначение, 0))
			|		КОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение) > 0
			|			ТОГДА ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение)
			|	КОНЕЦ КАК ОсновноеЗначение
			|ИЗ
			|	(ВЫБРАТЬ
			|		ДатыПериода.ДатаТабеля КАК Дата,
			|		РаботникиОрганизаций.Сотрудник КАК Сотрудник,
			|		МАКСИМУМ(РаботникиОрганизаций.Период) КАК ДатаИзменения
			|	ИЗ
			|		ВТДатыТабеля КАК ДатыПериода
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|			ПО (РаботникиОрганизаций.Сотрудник В (&СписокСотрудников))
			|				И РаботникиОрганизаций.Период <= ДатыПериода.ДатаТабеля
			|	
			|	СГРУППИРОВАТЬ ПО
			|		РаботникиОрганизаций.Сотрудник,
			|		ДатыПериода.ДатаТабеля) КАК ДниСотрудников
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|		ПО РаботникиОрганизаций.Сотрудник = ДниСотрудников.Сотрудник
			|			И РаботникиОрганизаций.Период = ДниСотрудников.ДатаИзменения
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиРаботыПоВидамВремени КАК ВведенныеТабеля
			|		ПО ВведенныеТабеля.ГрафикРаботы = ДниСотрудников.Сотрудник
			|			И ((НЕ ВведенныеТабеля.План))
			|			И ВведенныеТабеля.Дата = ДниСотрудников.Дата
			|			И (ВведенныеТабеля.ВидУчетаВремени = &ПоЧасам)
			|			И (ВведенныеТабеля.Документ ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СводныеИндивидуальныеГрафики КАК СводныеИндивидуальныеГрафики
			|		ПО СводныеИндивидуальныеГрафики.Сотрудник = ДниСотрудников.Сотрудник
			|			И (СводныеИндивидуальныеГрафики.Месяц = &Месяц)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК СводныеТабеля
			|		ПО СводныеТабеля.Сотрудник = ДниСотрудников.Сотрудник
			|			И (СводныеТабеля.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации)
			|			И (СводныеТабеля.Регистратор <> &ДокументСсылка)
			|			И (СводныеТабеля.Период = &Месяц)
			|		ЛЕВОЕ СОЕДИНЕНИЕ 
			|			ВТОтредактированныеНачисления КАК ДневныеНеявки
			|		ПО ДневныеНеявки.Сотрудник = ДниСотрудников.Сотрудник
			|			И (ДниСотрудников.Дата = ДневныеНеявки.ДатаТабеля)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиРаботыПоВидамВремени КАК ИндивидуальныеГрафики
			|		ПО ИндивидуальныеГрафики.ГрафикРаботы = ДниСотрудников.Сотрудник
			|			И (ИндивидуальныеГрафики.План)
			|			И ИндивидуальныеГрафики.Дата = ДниСотрудников.Дата
			|			И (ИндивидуальныеГрафики.ВидУчетаВремени = &ПоЧасам
			|				ИЛИ ИндивидуальныеГрафики.ВидУчетаВремени В (&ПоВечерним, &ПоНочным)
			|					И ИндивидуальныеГрафики.ОсновноеЗначение > 0)
			|			И (ИндивидуальныеГрафики.Документ ССЫЛКА Документ.ВводИндивидуальныхГрафиковРаботыОрганизации)
			|			И (ДневныеНеявки.ВидРасчета ЕСТЬ NULL ИЛИ ДневныеНеявки.ВидРасчета = ""ПланируемаяЯвка""
			|				ИЛИ ИндивидуальныеГрафики.ВидУчетаВремени = &ПоЧасам)
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТГрафикиРаботыПоВидамВремени КАК ОбщиеГрафики
			|		ПО ОбщиеГрафики.ГрафикРаботы = ВЫБОР
			|			КОГДА  РаботникиОрганизаций.ПериодЗавершения <= ДниСотрудников.Дата 
			|				И РаботникиОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА РаботникиОрганизаций.ГрафикРаботыЗавершения
			|			ИНАЧЕ РаботникиОрганизаций.ГрафикРаботы
			|			КОНЕЦ
			|			И (ОбщиеГрафики.План)
			|			И ОбщиеГрафики.Дата = ДниСотрудников.Дата
			|			И (ОбщиеГрафики.ВидУчетаВремени = &ПоЧасам
			|				ИЛИ ОбщиеГрафики.ВидУчетаВремени В (&ПоВечерним, &ПоНочным)
			|					И ОбщиеГрафики.ОсновноеЗначение > 0)
			|			И (ИндивидуальныеГрафики.ГрафикРаботы ЕСТЬ NULL )
			|			И (ДневныеНеявки.ВидРасчета ЕСТЬ NULL ИЛИ ДневныеНеявки.ВидРасчета = ""ПланируемаяЯвка""	
			|				ИЛИ ОбщиеГрафики.ВидУчетаВремени = &ПоЧасам)
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийУвольнения
			|			ПО
			|				РаботникиОрганизацийУвольнения.Сотрудник = ДниСотрудников.Сотрудник
			|				И РаботникиОрганизацийУвольнения.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|ГДЕ
			|	(РаботникиОрганизацийУвольнения.Период ЕСТЬ NULL
			|	ИЛИ РаботникиОрганизацийУвольнения.Период > ДниСотрудников.Дата)
			|	И РаботникиОрганизаций.ГрафикРаботы <> &ПустойГрафик";
			
			//Аверсон 17.12.2022 КВВ СВФР-010038 (пункт 1) (
			Если НЕ ВремяИзТабеля Тогда
				ЗапросАвтоЗаполненияТекст = ЗапросАвтоЗаполненияТекст + "
			|	И СводныеТабеля.НомерСтроки ЕСТЬ NULL
			|	И ВведенныеТабеля.ГрафикРаботы ЕСТЬ NULL ";
			КонецЕсли;
			
			ЗапросАвтоЗаполненияТекст = ЗапросАвтоЗаполненияТекст + "
			//Аверсон 17.12.2022 КВВ СВФР-010038 (пункт 1) )
			
			|	И СводныеИндивидуальныеГрафики.НомерСтроки ЕСТЬ NULL 
			|	И ((НЕ ДневныеНеявки.ВидРасчета ЕСТЬ NULL )
			|			ИЛИ ДневныеНеявки.ВидРасчета ЕСТЬ NULL 
			|				И ЕСТЬNULL(ИндивидуальныеГрафики.ОсновноеЗначение, ОбщиеГрафики.ОсновноеЗначение) > 0)
			|	) КАК ДниСотрудников
			|	ПО НЕ ДниСотрудников.ВидВремени Есть NULL
			|		И ДниСотрудников.Сотрудник = Сотрудники.Ссылка
			|	ГДЕ
			|		Сотрудники.Ссылка В(&СписокСотрудников)		
			|		И (&ВключатьВРезультатПустыеЗаписи ИЛИ НЕ (ДниСотрудников.ВидВремени Есть NULL))
			|	УПОРЯДОЧИТЬ ПО
			|		СотрудникКод ВОЗР, Сотрудник, День, ПорядокСортировки";
			
		КонецЕсли;
		
		ЗапросАвтоЗаполнения.Текст = ЗапросАвтоЗаполненияТекст;
		РезультатЗапроса = ЗапросАвтоЗаполнения.Выполнить();
		
		Если Сотрудники = Неопределено Тогда
			Исполнители.Очистить();
		КонецЕсли;
		ПрочиеДоплаты.Очистить();
		
		//Аверсон 17.12.2022 КВВ СВФР-010038 (пункт 1) (
		Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням И ВремяИзТабеля = Истина Тогда
			ТЗПеречняСотрудников = РезультатЗапроса.Выгрузить();
			ТЗПеречняСотрудников.Свернуть("Сотрудник");
			Если ТЗПеречняСотрудников.Количество() > 0 Тогда
				ТЗПеречняСотрудников.Сортировать("Сотрудник");
				
				//Аверсон ЕАЕ 02.05.2025 СВФР-015580
				//Получим периоды работы сотрудников
				Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
					МассивСотрудников = ТЗПеречняСотрудников.ВыгрузитьКолонку("Сотрудник");
					
					Запрос = Новый Запрос;
					Запрос.Текст = 
					"ВЫБРАТЬ РАЗРЕШЕННЫЕ
					|	&НачалоПериода КАК Период,
					|	РаботникиОрганизацийСрез.Сотрудник КАК Сотрудник,
					|	РаботникиОрганизацийСрез.ПодразделениеОрганизации КАК ПодразделениеОрганизации
					|ПОМЕСТИТЬ ВТДанныеРегистра
					|ИЗ
					|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Сотрудник В (&СписокСотрудников)) КАК РаботникиОрганизацийСрез
					|
					|ОБЪЕДИНИТЬ
					|
					|ВЫБРАТЬ
					|	РаботникиОрганизаций.Период,
					|	РаботникиОрганизаций.Сотрудник,
					|	РаботникиОрганизаций.ПодразделениеОрганизации
					|ИЗ
					|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
					|ГДЕ
					|	РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода
					|	И РаботникиОрганизаций.Сотрудник В(&СписокСотрудников)
					|;
					|
					|////////////////////////////////////////////////////////////////////////////////
					|ВЫБРАТЬ
					|	ВТДанныеРегистра.Сотрудник,
					|	ВТДанныеРегистра.ПодразделениеОрганизации,
					|	ВТДанныеРегистра.Период КАК ДатаНачала,
					|	МИНИМУМ(ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ВТДанныеРегистраБольше.Период, СЕКУНДА, -1), &КонецПериода)) КАК ДатаОкончания
					|ИЗ
					|	ВТДанныеРегистра КАК ВТДанныеРегистра
					|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеРегистра КАК ВТДанныеРегистраБольше
					|		ПО ВТДанныеРегистра.Сотрудник = ВТДанныеРегистраБольше.Сотрудник
					|			И ВТДанныеРегистра.Период < ВТДанныеРегистраБольше.Период
					|ГДЕ
					|	ВТДанныеРегистра.ПодразделениеОрганизации В ИЕРАРХИИ(&ПодразделениеОрганизации)
					|
					|СГРУППИРОВАТЬ ПО
					|	ВТДанныеРегистра.Сотрудник,
					|	ВТДанныеРегистра.ПодразделениеОрганизации,
					|	ВТДанныеРегистра.Период";
					
					Запрос.УстановитьПараметр("КонецПериода", КонецМесяца(ПериодРегистрации1));
					Запрос.УстановитьПараметр("НачалоПериода", НачалоМесяца(ПериодРегистрации1));
					Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
					Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
					
					ТЗПериоды = Запрос.Выполнить().Выгрузить();
					
				КонецЕсли;
				//Аверсон СВФР-015580
				
				Для Каждого Выборка ИЗ ТЗПеречняСотрудников Цикл
					
					мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации1),Новый Структура("Сотрудник, Организация", Выборка.Сотрудник, Организация));
					мСтрокаНач = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации1),Новый Структура("Сотрудник, Организация", Выборка.Сотрудник, Организация));
					
					Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
						
						//Аверсон ЕАЕ 02.05.2025 СВФР-015580
						//Если мСтрока.ПодразделениеОрганизации <> ПодразделениеОрганизации 
						//	И НЕ мСтрока.ПодразделениеОрганизации.ПринадлежитЭлементу(ПодразделениеОрганизации) Тогда
						//	Если мСтрокаНач.ПодразделениеОрганизации <> ПодразделениеОрганизации 
						//		И НЕ мСтрокаНач.ПодразделениеОрганизации.ПринадлежитЭлементу(ПодразделениеОрганизации) Тогда								
						//		Продолжить;
						//	КонецЕсли;
						//КонецЕсли;
						
						СтруктураОтбора = Новый Структура;
						СтруктураОтбора.Вставить("Сотрудник", Выборка.Сотрудник);
						НужныеСтрокиПериоды = ТЗПериоды.НайтиСтроки(СтруктураОтбора);
						Если НужныеСтрокиПериоды.Количество() = 0 Тогда
							Продолжить;
						КонецЕсли;
						//Аверсон СВФР-015580
						
					КонецЕсли;
										
					ВведенныеТабеляПоДнямПоСотруднику = Новый Соответствие;
					Если НЕ Организация.ИНН = "100074549" Тогда 
						Если ЗначениеЗаполнено(ПризнакФормированияТабеля) Тогда
							ВыборкаПризнака = СформироватьЗапросПоКатегорииОбъекта(Выборка.Сотрудник.Ссылка);
							Если ВыборкаПризнака.Следующий() = Ложь Тогда
								Продолжить;
							КонецЕсли;
						Иначе
							ВыборкаРезультат = ПрочиеПроцедуры.ПолучитьКатегориюПоСотруднику(Выборка.Сотрудник).Выбрать();
							Если Не ВыборкаРезультат.Следующий() Тогда
								Продолжить;
							Иначе
								Если СписокКатегорий.НайтиПоЗначению(ВыборкаРезультат.Категория) = Неопределено Тогда
									Продолжить;
								КонецЕсли;
							КонецЕсли;		
						КонецЕсли;
					КонецЕсли;
					
					ВведенныеТабеляПоДнямПоСотруднику.Очистить();
					Если ТекущаяСтрокаТабличнойЧасти = Неопределено Тогда
						СтрокаРасшифровкиПоДням = Исполнители.Добавить();
					Иначе
						СтрокаРасшифровкиПоДням = ТекущаяСтрокаТабличнойЧасти;
						Для ИндексДня = 1 По 31 Цикл
							ТекущаяСтрокаТабличнойЧасти["ПервыйВидВремени" + Строка(ИндексДня)] = КлассификаторПустаяСсылка;
							ТекущаяСтрокаТабличнойЧасти["ВторойВидВремени" + Строка(ИндексДня)] = КлассификаторПустаяСсылка;
							ТекущаяСтрокаТабличнойЧасти["ТретийВидВремени" + Строка(ИндексДня)] = КлассификаторПустаяСсылка;
							ТекущаяСтрокаТабличнойЧасти["ПервыйЧасов" + Строка(ИндексДня)] = 0;
							ТекущаяСтрокаТабличнойЧасти["ВторойЧасов" + Строка(ИндексДня)] = 0;
							ТекущаяСтрокаТабличнойЧасти["ТретийЧасов" + Строка(ИндексДня)] = 0;
						КонецЦикла;
					КонецЕсли;
					СтрокаРасшифровкиПоДням.Сотрудник = Выборка.Сотрудник;
					СтрокаРасшифровкиПоДням.ФизЛицо = Выборка.Сотрудник.ФизЛицо;
					
					СтрокаРасшифровкиПоДням.Должность = мСтрока.Должность;
					СтрокаРасшифровкиПоДням.ОтработаноЧасов = 0;
					СтрокаРасшифровкиПоДням.ОтработаноДней = 0;
					СтрокаРасшифровкиПоДням.ОтработаноЧасовВредность = 0;
					
					З = Новый Запрос;
					З.Текст = "ВЫБРАТЬ 
					|РабочееВремяРаботниковОрганизаций.Сотрудник,
					|РабочееВремяРаботниковОрганизаций.Период,
					|РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени,
					|РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени.БуквенныйКод КАК БуквенныйКод,
					|День(РабочееВремяРаботниковОрганизаций.Период) КАК День,
					|РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени.РабочееВремя КАК РабочееВремя,
					|СУММА(РабочееВремяРаботниковОрганизаций.Дней) КАК Дней,
					|СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов
					|ИЗ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
					|ГДЕ
					|РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Период1 И &Период2
					|И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
					|И РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
					|СГРУППИРОВАТЬ ПО
					|РабочееВремяРаботниковОрганизаций.Сотрудник,
					|РабочееВремяРаботниковОрганизаций.Период,
					|День(РабочееВремяРаботниковОрганизаций.Период),
					|РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени.БуквенныйКод,
					|РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени.РабочееВремя,
					|РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени
					|УПОРЯДОЧИТЬ ПО
					|РабочееВремяРаботниковОрганизаций.Период";
					З.УстановитьПараметр("Сотрудник",Выборка.Сотрудник);
					З.УстановитьПараметр("Период1",НачалоМесяца(ПериодРегистрации));
					З.УстановитьПараметр("Период2",КонецМесяца(ПериодРегистрации));
					РезЗ = З.Выполнить().Выгрузить();
					ТТекДень = Дата(1,1,1);  
					Для Каждого Стр2 ИЗ РезЗ Цикл
						ИндексЯчейкиВТаблице = Стр2.День;
						
						//Аверсон ЕАЕ 02.05.2025 СВФР-015580
						//Проверяем, работал ли сотрудник в подразделении в этот день
						Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
							ПроверяемаяДата = Дата(Год(ПериодРегистрации1),Месяц(ПериодРегистрации1),ИндексЯчейкиВТаблице);
							Работал = Ложь;
							Для Каждого СтрПериод Из НужныеСтрокиПериоды Цикл
								Если ПроверяемаяДата >= СтрПериод.ДатаНачала И ПроверяемаяДата <= СтрПериод.ДатаОкончания Тогда
									Работал = Истина;
									Прервать;
								КонецЕсли;
							КонецЦикла;
							Если Не Работал Тогда
								Продолжить;
							КонецЕсли;
						КонецЕсли;
						//Аверсон СВФР-015580
						
						Если ТТекДень <> Стр2.Период Тогда
							 ИндексМассиваПриставок = 0;
						КонецЕсли;
						ТТекДень = Стр2.Период;
						
						НазваниеЯчейкиВБазе = МассивПриставок[ИндексМассиваПриставок]+"ВидВремени"+Строка(ИндексЯчейкиВТаблице);
						СтрокаРасшифровкиПоДням[НазваниеЯчейкиВБазе] = Стр2.ВидИспользованияРабочегоВремени;
						НазваниеЯчейкиВБазе = МассивПриставок[ИндексМассиваПриставок]+"Часов"+Строка(ИндексЯчейкиВТаблице);
						СтрокаРасшифровкиПоДням[НазваниеЯчейкиВБазе] = Стр2.Часов;

						 Если Стр2.РабочееВремя Тогда
									Если Стр2.ВидИспользованияРабочегоВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Работа или
										Стр2.ВидИспользованияРабочегоВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда 
										СтрокаРасшифровкиПоДням.ОтработаноЧасов = СтрокаРасшифровкиПоДням.ОтработаноЧасов + Стр2.Часов;
										СтрокаРасшифровкиПоДням.ОтработаноДней = СтрокаРасшифровкиПоДням.ОтработаноДней + ?(Стр2.Дней > 0, 1, 0);
										СтрокаРасшифровкиПоДням.ОтработаноЧасовВредность = СтрокаРасшифровкиПоДням.ОтработаноЧасовВредность + Стр2.Часов;
									КонецЕсли;
								КонецЕсли;					
						ИндексМассиваПриставок = ИндексМассиваПриставок + 1;								
					КонецЦикла;
					
					//СВЭЙ 08.02.2024 КВВ СВФР-012344 (
					//СтрокаРасшифровкиПоДням.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Выборка.Сотрудник, Дата, ПериодРегистрации1, мВалютаРегламентированногоУчета);
					
					ДатаДляЧТС = ОпределитьДатуДляЧТС(СтрокаРасшифровкиПоДням, Истина, Выборка.Сотрудник);
					СтрокаРасшифровкиПоДням.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Выборка.Сотрудник, ДатаДляЧТС, ПериодРегистрации1, мВалютаРегламентированногоУчета);
					//СВЭЙ 08.02.2024 КВВ СВФР-012344 )
					
					СтрокаРасшифровкиПоДням.КодСтроки = ПолучитьКодСтроки();
					ЗаполнимПрочиеДоплатыПоРаботнику(Выборка.Сотрудник, СтрокаРасшифровкиПоДням.ТарифнаяСтавка, СтрокаРасшифровкиПоДням.КодСтроки, 1, );
					Если Сотрудники <> Неопределено Тогда 
						Сум = "";
						Сумма = ВвестиЧисло(Сум, "Введите сумму",15,2);
						Если ЗначениеЗаполнено(Сум) Тогда 
							СтрокаРасшифровкиПоДням.СуммаКНачислениюРегл = Число(Сум);
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;				
			КонецЕсли;
		Иначе	
		//Аверсон 17.12.2022 КВВ СВФР-010038 (пункт 1) )
		
		Выборка = РезультатЗапроса.Выбрать();
		
		Если Выборка.Количество() > 0 Тогда
			
			Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням 
				ИЛИ СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
				// по дням.
				
				ВведенныеТабеляПоДнямПоСотруднику = Новый Соответствие;
				Пока Выборка.СледующийПоЗначениюПоля("Сотрудник") Цикл
					
					//Аверсон ЕАЕ 06.06.2024 СВФР-012937
					//Бобруйсксельмаш
					Если Организация.ИНН = "790056159" Тогда
						Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
							//Получим периоды работы в этом подразделении
							ТЗПериоды = ПолучитьПериодыРаботыВПодразделении(Выборка.Сотрудник, ПериодРегистрации1, КонецМесяца(ПериодРегистрации1));
						КонецЕсли;
					КонецЕсли;
					//Аверсон СВФР-012937
					
					если не Организация.ИНН = "100074549" Тогда //О.Т. Аверсон 27.01.2016 № 836
						Если ЗначениеЗаполнено(ПризнакФормированияТабеля) Тогда
							ВыборкаПризнака = СформироватьЗапросПоКатегорииОбъекта(Выборка.Сотрудник.Ссылка);
							Если ВыборкаПризнака.Следующий() = Ложь Тогда
								Продолжить;
							КонецЕсли;
						Иначе
							ВыборкаРезультат = ПрочиеПроцедуры.ПолучитьКатегориюПоСотруднику(Выборка.Сотрудник).Выбрать();
							Если Не ВыборкаРезультат.Следующий() Тогда
								Продолжить;
							Иначе
								Если СписокКатегорий.НайтиПоЗначению(ВыборкаРезультат.Категория) = Неопределено Тогда
									Продолжить;
								КонецЕсли;
							КонецЕсли;
							
						КонецЕсли;
					КонецЕсли;
					
					ВведенныеТабеляПоДнямПоСотруднику.Очистить();
					Если ТекущаяСтрокаТабличнойЧасти = Неопределено Тогда
						СтрокаРасшифровкиПоДням = Исполнители.Добавить();
					Иначе
						СтрокаРасшифровкиПоДням = ТекущаяСтрокаТабличнойЧасти;
						Для ИндексДня = 1 По 31 Цикл
							
							ТекущаяСтрокаТабличнойЧасти["ПервыйВидВремени" + Строка(ИндексДня)] = КлассификаторПустаяСсылка;
							ТекущаяСтрокаТабличнойЧасти["ВторойВидВремени" + Строка(ИндексДня)] = КлассификаторПустаяСсылка;
							ТекущаяСтрокаТабличнойЧасти["ТретийВидВремени" + Строка(ИндексДня)] = КлассификаторПустаяСсылка;
							ТекущаяСтрокаТабличнойЧасти["ПервыйЧасов" + Строка(ИндексДня)] = 0;
							ТекущаяСтрокаТабличнойЧасти["ВторойЧасов" + Строка(ИндексДня)] = 0;
							ТекущаяСтрокаТабличнойЧасти["ТретийЧасов" + Строка(ИндексДня)] = 0;
							
						КонецЦикла;
					КонецЕсли;
					СтрокаРасшифровкиПоДням.Сотрудник = Выборка.Сотрудник;
					СтрокаРасшифровкиПоДням.ФизЛицо = Выборка.Сотрудник.ФизЛицо;
					//мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации,
					//Новый Структура("Сотрудник, Организация", Выборка.Сотрудник, Организация));
					//заявка №1682 (база заявок Кристалла) Дмитрук О.Г.
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации),
					мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(КонецМесяца(ПериодРегистрации1),
					//Аверсон СВФР-007772
					
					Новый Структура("Сотрудник, Организация", Выборка.Сотрудник, Организация));
					//заявка №1682
					СтрокаРасшифровкиПоДням.Должность = мСтрока.Должность;
					СтрокаРасшифровкиПоДням.ОтработаноЧасов = 0;
					СтрокаРасшифровкиПоДням.ОтработаноДней = 0;
					//Островская Татьяна 21.02.2013 № 16221
					СтрокаРасшифровкиПоДням.ОтработаноЧасовВредность = 0;
					//Островская Татьяна 21.02.2013 № 16221
					
					Если Выборка.День <> NULL Тогда
						
						Пока Выборка.СледующийПоЗначениюПоля("День") Цикл
							
							//Аверсон ЕАЕ 06.06.2024 СВФР-012937
							//Бобруйсксельмаш
							Если Организация.ИНН = "790056159" Тогда
								Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
									Если Не СотрудникРаботалВПодразделении(Выборка.Дата, ТЗПериоды) Тогда
										Продолжить;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							//Аверсон СВФР-012937
							
							ИндексЯчейкиВТаблице = Выборка.День;
							ИндексМассиваПриставок = 0;
							Пока Выборка.Следующий() Цикл 
								
								Если ИндексМассиваПриставок > 2 Тогда
									// На данный момент мы можем вводить только 3 вида времени в один день
									Прервать;
								КонецЕсли;
								НазваниеЯчейкиВБазе = МассивПриставок[ИндексМассиваПриставок]+"ВидВремени"+Строка(ИндексЯчейкиВТаблице);
								СтрокаРасшифровкиПоДням[НазваниеЯчейкиВБазе] = Выборка.БукваВидаВремени;
								НазваниеЯчейкиВБазе = МассивПриставок[ИндексМассиваПриставок]+"Часов"+Строка(ИндексЯчейкиВТаблице);
								СтрокаРасшифровкиПоДням[НазваниеЯчейкиВБазе] = Выборка.ОсновноеЗначение;
								
								Если Выборка.БукваВидаВремени.РабочееВремя Тогда
									//Островская Татьяна 10.11.2012 № 15987
									если Выборка.БукваВидаВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Работа или
										Выборка.БукваВидаВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда 
										СтрокаРасшифровкиПоДням.ОтработаноЧасов = СтрокаРасшифровкиПоДням.ОтработаноЧасов + Выборка.ОсновноеЗначение;
										СтрокаРасшифровкиПоДням.ОтработаноДней = СтрокаРасшифровкиПоДням.ОтработаноДней + ?(Выборка.ОсновноеЗначение > 0, 1, 0);
										//Островская Татьяна 21.02.2013 № 16221
										СтрокаРасшифровкиПоДням.ОтработаноЧасовВредность = СтрокаРасшифровкиПоДням.ОтработаноЧасовВредность + Выборка.ОсновноеЗначение;
										//Островская Татьяна 21.02.2013 № 16221
									КонецЕсли;
									//Островская Татьяна 10.11.2012 № 15987
								КонецЕсли;
								
								ИндексМассиваПриставок = ИндексМассиваПриставок + 1;
								
								//Толик
								
								//Аверсон ЕАЕ 23.07.2021 СВФР-007772
								//Если ПрочиеПроцедуры.ПроверкаНаДействиеВидаНачисления(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("085"), Выборка.Сотрудник, Организация, ДатаНачалаПериода, ДатаОкончанияПериода) И Выборка.БукваВидаВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								Если ПрочиеПроцедуры.ПроверкаНаДействиеВидаНачисления(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("085"), Выборка.Сотрудник, Организация, ДатаНачалаПериода1, ДатаОкончанияПериода) И Выборка.БукваВидаВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								//Аверсон СВФР-007772
								
									Если ИндексМассиваПриставок > 2 Тогда
										// На данный момент мы можем вводить только 3 вида времени в один день
										Прервать;
									КонецЕсли;
									НазваниеЯчейкиВБазе = МассивПриставок[ИндексМассиваПриставок]+"ВидВремени"+Строка(ИндексЯчейкиВТаблице);
									СтрокаРасшифровкиПоДням[НазваниеЯчейкиВБазе] = Справочники.КлассификаторИспользованияРабочегоВремени.Вредность;
									НазваниеЯчейкиВБазе = МассивПриставок[ИндексМассиваПриставок]+"Часов"+Строка(ИндексЯчейкиВТаблице);
									СтрокаРасшифровкиПоДням[НазваниеЯчейкиВБазе] = Выборка.ОсновноеЗначение;
									
									Если Выборка.БукваВидаВремени.РабочееВремя Тогда
										СтрокаРасшифровкиПоДням.ОтработаноЧасов = СтрокаРасшифровкиПоДням.ОтработаноЧасов + Выборка.ОсновноеЗначение;
										СтрокаРасшифровкиПоДням.ОтработаноДней = СтрокаРасшифровкиПоДням.ОтработаноДней + ?(Выборка.ОсновноеЗначение > 0, 1, 0);
										//Островская Татьяна 21.02.2013 № 16221
										СтрокаРасшифровкиПоДням.ОтработаноЧасовВредность = СтрокаРасшифровкиПоДням.ОтработаноЧасовВредность + Выборка.ОсновноеЗначение;
										//Островская Татьяна 21.02.2013 № 16221
										
									КонецЕсли;
									
									ИндексМассиваПриставок = ИндексМассиваПриставок + 1;
								КонецЕсли;
								
							КонецЦикла;
							//енд
						КонецЦикла;
					КонецЕсли;
					
					//СВЭЙ 08.02.2024 КВВ СВФР-012344 (
					////Аверсон ЕАЕ 23.07.2021 СВФР-007772
					////СтрокаРасшифровкиПоДням.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Выборка.Сотрудник, Дата, ПериодРегистрации, мВалютаРегламентированногоУчета);
					//СтрокаРасшифровкиПоДням.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Выборка.Сотрудник, Дата, ПериодРегистрации1, мВалютаРегламентированногоУчета);
					////Аверсон СВФР-007772
					
					ДатаДляЧТС = ОпределитьДатуДляЧТС(СтрокаРасшифровкиПоДням, Истина, Выборка.Сотрудник); 
					СтрокаРасшифровкиПоДням.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Выборка.Сотрудник, ДатаДляЧТС, ПериодРегистрации1, мВалютаРегламентированногоУчета);
					//СВЭЙ 08.02.2024 КВВ СВФР-012344 )
					
					СтрокаРасшифровкиПоДням.КодСтроки = ПолучитьКодСтроки();
					
					ЗаполнимПрочиеДоплатыПоРаботнику(Выборка.Сотрудник, СтрокаРасшифровкиПоДням.ТарифнаяСтавка, СтрокаРасшифровкиПоДням.КодСтроки, 1, );
					
					//О.Т. Аверсон 27.01.2016 № 836
					Если Сотрудники <> Неопределено Тогда 
						Сум = "";
						Сумма = ВвестиЧисло(Сум, "Введите сумму",15,2);
						Если ЗначениеЗаполнено(Сум) Тогда 
							СтрокаРасшифровкиПоДням.СуммаКНачислениюРегл = Число(Сум);
						КонецЕсли;
					КонецЕсли;
					//О.Т. Аверсон 27.01.2016 № 836
				КонецЦикла;
			Иначе
				// в целом за период
				
				Пока Выборка.СледующийПоЗначениюПоля("Сотрудник") Цикл
					
					если не Организация.ИНН = "100074549" Тогда //О.Т. Аверсон 27.01.2016 № 836
						Если ЗначениеЗаполнено(ПризнакФормированияТабеля) Тогда
							ВыборкаПризнака = СформироватьЗапросПоКатегорииОбъекта(Выборка.Сотрудник.Ссылка);
							Если ВыборкаПризнака.Следующий() = Ложь Тогда
								Продолжить;
							КонецЕсли;
						Иначе
							ВыборкаРезультат = ПрочиеПроцедуры.ПолучитьКатегориюПоСотруднику(Выборка.Сотрудник).Выбрать();
							Если Не ВыборкаРезультат.Следующий() Тогда
								Продолжить;
							Иначе
								Если СписокКатегорий.НайтиПоЗначению(ВыборкаРезультат.Категория) = Неопределено Тогда
									Продолжить;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					
					КоличествоЗаписей = 1;
					Если ТекущаяСтрокаТабличнойЧасти = Неопределено Тогда
						СтрокаТабличнойЧасти = Исполнители.Добавить();
					Иначе
						СтрокаТабличнойЧасти = ТекущаяСтрокаТабличнойЧасти;
					КонецЕсли;
					СтрокаТабличнойЧасти.Сотрудник = Выборка.Сотрудник;
					СтрокаТабличнойЧасти.ФизЛицо = Выборка.Сотрудник.ФизЛицо;
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации,
					мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации1,
					//Аверсон СВФР-007772
					
					Новый Структура("Сотрудник, Организация", Выборка.Сотрудник, Организация));
					СтрокаТабличнойЧасти.Должность = мСтрока.Должность;
					
					
					Пока Выборка.Следующий() Цикл
						Если Выборка.ВидВремени = NULL Тогда
							
							Если КоличествоЗаписей < 6 Тогда
								СтрокаТабличнойЧасти["ВидВремени" + Строка(КоличествоЗаписей)] = КлассификаторЯвка;
								СтрокаТабличнойЧасти["Дней" + Строка(КоличествоЗаписей)] = Выборка.Дней;
								СтрокаТабличнойЧасти["Часов" + Строка(КоличествоЗаписей)] = Выборка.Часов;
								КоличествоЗаписей = КоличествоЗаписей + 1;
							КонецЕсли;
							//толик	
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//Если КоличествоЗаписей < 6 И ПрочиеПроцедуры.ПроверкаНаДействиеВидаНачисления(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("085"), Выборка.Сотрудник, Организация, ДатаНачалаПериода, ДатаОкончанияПериода) Тогда
							Если КоличествоЗаписей < 6 И ПрочиеПроцедуры.ПроверкаНаДействиеВидаНачисления(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("085"), Выборка.Сотрудник, Организация, ДатаНачалаПериода1, ДатаОкончанияПериода) Тогда
							//Аверсон СВФР-007772	
								
								СтрокаТабличнойЧасти["ВидВремени" + Строка(КоличествоЗаписей)] = Справочники.КлассификаторИспользованияРабочегоВремени.Вредность;
								СтрокаТабличнойЧасти["Дней" + Строка(КоличествоЗаписей)] = Выборка.Дней;
								СтрокаТабличнойЧасти["Часов" + Строка(КоличествоЗаписей)] = Выборка.Часов;
								КоличествоЗаписей = КоличествоЗаписей + 1;
							КонецЕсли;
							//енд						
							Если КоличествоЗаписей < 6  И Выборка.ЧасовВечерних > 0 Тогда
								СтрокаТабличнойЧасти["ВидВремени"+Строка(КоличествоЗаписей)] = КлассификаторВечерниеЧасы;
								СтрокаТабличнойЧасти["Часов" + Строка(КоличествоЗаписей)] = Выборка.ЧасовВечерних;
								КоличествоЗаписей = КоличествоЗаписей + 1;
							КонецЕсли;
							
							Если КоличествоЗаписей < 6  И Выборка.ЧасовНочных > 0 Тогда
								СтрокаТабличнойЧасти["ВидВремени"+Строка(КоличествоЗаписей)] = КлассификаторНочныеЧасы;
								СтрокаТабличнойЧасти["Часов" + Строка(КоличествоЗаписей)] = Выборка.ЧасовНочных;
								КоличествоЗаписей = КоличествоЗаписей + 1;
							КонецЕсли;
						Иначе
							Если КоличествоЗаписей < 6 Тогда
								СтрокаТабличнойЧасти["ВидВремени"+Строка(КоличествоЗаписей)] = Выборка.ВидВремени;
								СтрокаТабличнойЧасти["Дней" + Строка(КоличествоЗаписей)] = Выборка.Дней;
								СтрокаТабличнойЧасти["Часов" + Строка(КоличествоЗаписей)] = Выборка.Часов;
								//Островская Татьяна 21.02.2013 № 16221
								если Выборка.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда 
									СтрокаТабличнойЧасти.ОтработаноЧасовВредность = Выборка.Часов;
								КонецЕсли;
								//Островская Татьяна 21.02.2013 № 16221
								КоличествоЗаписей = КоличествоЗаписей + 1;
							КонецЕсли;
						КонецЕсли;
					КонецЦикла;       
					
					//СВЭЙ 08.02.2024 КВВ СВФР-012344 (
					////Аверсон ЕАЕ 23.07.2021 СВФР-007772
					////СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Выборка.Сотрудник, Дата, ПериодРегистрации, мВалютаРегламентированногоУчета);
					//СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Выборка.Сотрудник, Дата, ПериодРегистрации1, мВалютаРегламентированногоУчета);
					////Аверсон СВФР-007772
					
					ДатаДляЧТС = ОпределитьДатуДляЧТС(СтрокаТабличнойЧасти, Истина, Выборка.Сотрудник); 
					СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(Выборка.Сотрудник, ДатаДляЧТС, ПериодРегистрации1, мВалютаРегламентированногоУчета);
					//СВЭЙ 08.02.2024 КВВ СВФР-012344 )
					
					СтрокаТабличнойЧасти.КодСтроки = ПолучитьКодСтроки();
					
					ЗаполнимПрочиеДоплатыПоРаботнику(Выборка.Сотрудник, СтрокаТабличнойЧасти.ТарифнаяСтавка, СтрокаТабличнойЧасти.КодСтроки, 1, );
					//О.Т. Аверсон 27.01.2016 № 836
					Если Сотрудники <> Неопределено Тогда 
						Сум = "";
						Сумма = ВвестиЧисло(Сум, "Введите сумму",15,2);
						Если ЗначениеЗаполнено(Сум) Тогда 
							СтрокаТабличнойЧасти.СуммаКНачислениюРегл = Число(Сум);
						КонецЕсли;
					КонецЕсли;
					//О.Т. Аверсон 27.01.2016 № 836
				КонецЦикла;
			КонецЕсли;	
		КонецЕсли;	
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры // Автозаполнение()

//Аверсон ЕАЕ 06.06.2024 СВФР-012937
Функция ПолучитьПериодыРаботыВПодразделении(Сотр, Нач,Кон)
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	РаботникиОрганизацийСрезПоследних.Сотрудник,
		|	&НачалоПериода КАК Период,
		|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
		|ПОМЕСТИТЬ ВТПериоды
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоПериода, Сотрудник = &Сотр) КАК РаботникиОрганизацийСрезПоследних
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	РаботникиОрганизаций.Сотрудник,
		|	РаботникиОрганизаций.Период,
		|	РаботникиОрганизаций.ПодразделениеОрганизации
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|ГДЕ
		|	РаботникиОрганизаций.Сотрудник = &Сотр
		|	И РаботникиОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТПериоды.Сотрудник,
		|	ВТПериоды.Период КАК НачалоПериода,
		|	ВТПериоды.ПодразделениеОрганизации,
		|	МИНИМУМ(ЕСТЬNULL(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ВТПериодыБольше.Период, ДЕНЬ), СЕКУНДА, -1), &КонецПериода)) КАК КонецПериода
		|ПОМЕСТИТЬ ВТПериодыРаботы
		|ИЗ
		|	ВТПериоды КАК ВТПериоды
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПериоды КАК ВТПериодыБольше
		|		ПО ВТПериоды.Сотрудник = ВТПериодыБольше.Сотрудник
		|			И ВТПериоды.Период < ВТПериодыБольше.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ВТПериоды.Сотрудник,
		|	ВТПериоды.Период,
		|	ВТПериоды.ПодразделениеОрганизации
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТПериодыРаботы.Сотрудник,
		|	ВТПериодыРаботы.НачалоПериода,
		|	ВТПериодыРаботы.ПодразделениеОрганизации,
		|	ВТПериодыРаботы.КонецПериода
		|ИЗ
		|	ВТПериодыРаботы КАК ВТПериодыРаботы
		|ГДЕ
		|	ВТПериодыРаботы.ПодразделениеОрганизации = &ПодразделениеОрганизации";
	
	Запрос.УстановитьПараметр("КонецПериода", Кон);
	Запрос.УстановитьПараметр("НачалоПериода", Нач);
	Запрос.УстановитьПараметр("ПодразделениеОрганизации", ПодразделениеОрганизации);
	Запрос.УстановитьПараметр("Сотр", Сотр);
	
	ТЗ = Запрос.Выполнить().Выгрузить();
	
	Возврат ТЗ;
	
КонецФункции

Функция СотрудникРаботалВПодразделении(Дат, ТЗПериоды)
	Работал = Ложь;
	Для Каждого Стр Из ТЗПериоды Цикл
		Если Дат <= Стр.КонецПериода И Дат >= Стр.НачалоПериода Тогда
			Работал = Истина;
			Прервать;
		КонецЕсли;
	КонецЦикла;
	Возврат Работал;
КонецФункции
//Аверсон СВФР-012937

//ПСА 08.02.2021 СВФР-007149+++
Процедура АвтоЗаполнениеПоБригаде(СписокСотрудников, ДатаНачалаПериодаЗаполнения, ДатаОкончанияПериодаЗаполнения)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Исполнители.Очистить();
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник КАК Сотрудник,
	|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник.Физлицо КАК ФизЛицо,
	|	РабочееВремяРаботниковОрганизацийОбороты.ВидИспользованияРабочегоВремени,
	|	РабочееВремяРаботниковОрганизацийОбороты.ЧасовОборот КАК Часов,
	//ПСА 07.10.2021 СВФР-008240 +++
	|	ВЫБОР
	|		КОГДА РабочееВремяРаботниковОрганизацийОбороты.ВидИспользованияРабочегоВремени = Значение(Справочник.КлассификаторИспользованияРабочегоВремени.КомандировкаВВыходной)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Порядок,
	//+++ПСА 07.10.2021 СВФР-008240
	|	РабочееВремяРаботниковОрганизацийОбороты.Период КАК Период
	|ИЗ
	|	РегистрНакопления.РабочееВремяРаботниковОрганизаций.Обороты(
	|			&ДатаНачалаПериода,
	|			&ДатаОкончанияПериода,
	|			День,
	|			Организация = &Организация
	|				И Сотрудник В (&МассивСотрудников)
	|				И ВидИспользованияРабочегоВремени В (&МассивВидовРабочегоВремени)) КАК РабочееВремяРаботниковОрганизацийОбороты
	|
	|УПОРЯДОЧИТЬ ПО
	//Аверсон ЕАЕ 21.10.2021 СВФР-008068
	|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник.Код,
	//Аверсон СВФР-008068
	|	Период,
	|	Порядок
	|ИТОГИ ПО
	|	Сотрудник,
	|	Период";
	
	Запрос.УстановитьПараметр("ДатаНачалаПериода", ДатаНачалаПериодаЗаполнения);
	Запрос.УстановитьПараметр("ДатаОкончанияПериода", ДатаОкончанияПериодаЗаполнения);
	Запрос.УстановитьПараметр("МассивСотрудников", СписокСотрудников.ВыгрузитьКолонку("Сотрудник"));
	Запрос.УстановитьПараметр("Организация", Организация);
	МассивВидовРабочегоВремени = Новый Массив();
	//ПСА 11.02.2021 СВФР-007191+++
	//МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
	Если Не Сверхурочно и Не Праздники Тогда		
		МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
	Иначе
		Если Сверхурочно Тогда
			МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные);		
		КонецЕсли;	
		Если Праздники Тогда
			МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);		
		КонецЕсли;			
	КонецЕсли;
	//+++ПСА 11.02.2021 СВФР-007191
	
	//ПСА 07.10.2021 СВФР-008240 +++
	Если ОтражатьЧасыКоммандировок Тогда 
		
		Если Праздники Тогда
			МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.КомандировкаВВыходной);
		Иначе
			МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Командировка);	
		КонецЕсли;
	КонецЕсли;
	//+++ПСА 07.10.2021 СВФР-008240
	Запрос.УстановитьПараметр("МассивВидовРабочегоВремени", МассивВидовРабочегоВремени);
	
	
	РезультатЗапроса = Запрос.Выполнить();
	
	//ПСА 06.09.2021 СВФР-008078 +++
	ТЗ_Коммандировки = Новый ТаблицаЗначений();
	Если НЕ (Сверхурочно или Доплатной или Прочее или Запчасть) 
		и Не ОтражатьЧасыКоммандировок Тогда //ПСА 07.10.2021 СВФР-008240 +++
		ЗапросКВ = Новый Запрос;
		ЗапросКВ.Текст = 
		"ВЫБРАТЬ
		|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник КАК Сотрудник,
		|	РабочееВремяРаботниковОрганизацийОбороты.Сотрудник.Физлицо КАК ФизЛицо,
		|	РабочееВремяРаботниковОрганизацийОбороты.ВидИспользованияРабочегоВремени,
		//|	РабочееВремяРаботниковОрганизацийОбороты.ЧасовОборот КАК Часов,
		|	РабочееВремяРаботниковОрганизацийОбороты.Период КАК Период
		|ИЗ
		|	РегистрНакопления.РабочееВремяРаботниковОрганизаций.Обороты(
		|			&ДатаНачалаПериода,
		|			&ДатаОкончанияПериода,
		|			День,
		|			Организация = &Организация
		|				И Сотрудник В (&МассивСотрудников)
		|				И ВидИспользованияРабочегоВремени В (&МассивВидовРабочегоВремени)) КАК РабочееВремяРаботниковОрганизацийОбороты
		|
		|";
		
		ЗапросКВ.УстановитьПараметр("ДатаНачалаПериода", ДатаНачалаПериодаЗаполнения);
		ЗапросКВ.УстановитьПараметр("ДатаОкончанияПериода", ДатаОкончанияПериодаЗаполнения);
		ЗапросКВ.УстановитьПараметр("МассивСотрудников", СписокСотрудников.ВыгрузитьКолонку("Сотрудник"));
		ЗапросКВ.УстановитьПараметр("Организация", Организация);
		МассивВидовРабочегоВремениКВ = Новый Массив();
		МассивВидовРабочегоВремениКВ.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Командировка);
		МассивВидовРабочегоВремениКВ.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.КомандировкаВВыходной);
		ЗапросКВ.УстановитьПараметр("МассивВидовРабочегоВремени", МассивВидовРабочегоВремениКВ);
		ТЗ_Коммандировки = ЗапросКВ.Выполнить().Выгрузить();
	КонецЕсли;	
	//+++ПСА 06.09.2021 СВФР-008078
	
	ВыборкаСотрудник = РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	//ПСА 10.11.2021 СВФР-008342 +++
	НужнаПроверкаСверхурочноВКоммандировках = Ложь;
	Если Сверхурочно и ОтражатьЧасыКоммандировок Тогда
		НужнаПроверкаСверхурочноВКоммандировках = Истина;
	КонецЕсли;	
	//+++ПСА 10.11.2021 СВФР-008342
	Пока ВыборкаСотрудник.Следующий() Цикл
		СтрокаТабличнойЧасти = Исполнители.Добавить();
		СтрокаТабличнойЧасти.Сотрудник = ВыборкаСотрудник.Сотрудник;
		СтрокаТабличнойЧасти.ФизЛицо = ВыборкаСотрудник.ФизЛицо;
		СтруктураОтбора = Новый Структура("Сотрудник, Организация", ВыборкаСотрудник.Сотрудник, Организация);
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации,СтруктураОтбора);
		мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации1,СтруктураОтбора);
		//Аверсон СВФР-007772
		
		СтрокаТабличнойЧасти.Должность = мСтрока.Должность;
		ВыборкаПериод = ВыборкаСотрудник.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПериод.Следующий() Цикл
			НужныйПериод = Ложь;
			ПоследняяБригада = РегистрыСведений.НазначениеСотрудниковПоБригадам.ПолучитьПоследнее(ВыборкаПериод.Период, СтруктураОтбора);
			Если ПоследняяБригада.Бригада = Бригада Тогда
				НужныйПериод = Истина;
			КонецЕсли;	
			Если НужныйПериод Тогда
				//ПСА 06.09.2021 СВФР-008078 +++
				Если ТЗ_Коммандировки.Количество() > 0 
					и не ОтражатьЧасыКоммандировок Тогда
					ОтборТЗ = Новый Структура();
					ОтборТЗ.Вставить("Сотрудник", ВыборкаСотрудник.Сотрудник);
					ОтборТЗ.Вставить("ФизЛицо", ВыборкаСотрудник.ФизЛицо);
					ОтборТЗ.Вставить("Период", ВыборкаПериод.Период);
					НайденныеСтрокиТЗ = ТЗ_Коммандировки.НайтиСтроки(ОтборТЗ);
					Если НайденныеСтрокиТЗ.Количество() > 0 Тогда
						Продолжить;
					КонецЕсли;	
				КонецЕсли;
				//+++ПСА 06.09.2021 СВФР-008078
				Выборка = ВыборкаПериод.Выбрать();
				ИндексДня = Лев(Строка(ВыборкаПериод.Период),2);
				Если Лев(ИндексДня,1) = "0" Тогда
					ИндексДня = Прав(ИндексДня,1);
				КонецЕсли;
				СчетчикВидВремени = 1;
				Пока Выборка.Следующий() Цикл
					//ПСА 07.10.2021 СВФР-008240 +++
					Если СчетчикВидВремени >1 и Выборка.Порядок = 1 Тогда
						Продолжить;
					КонецЕсли;
					//+++ПСА 07.10.2021 СВФР-008240
					Если СчетчикВидВремени = 1 Тогда
						СтрокаТабличнойЧасти["ПервыйВидВремени" + ИндексДня] = Выборка.ВидИспользованияРабочегоВремени;
						СтрокаТабличнойЧасти["ПервыйЧасов" + ИндексДня]      = Выборка.Часов;
					ИначеЕсли СчетчикВидВремени = 2 Тогда
						СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = Выборка.ВидИспользованияРабочегоВремени;
						СтрокаТабличнойЧасти["ВторойЧасов" + ИндексДня]      = Выборка.Часов;
					ИначеЕсли СчетчикВидВремени = 3 Тогда
						СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] =  Выборка.ВидИспользованияРабочегоВремени;
						СтрокаТабличнойЧасти["ТретийЧасов" + ИндексДня]      =  Выборка.Часов;
					Иначе
						Продолжить;
					КонецЕсли;	
					Если Выборка.Часов > 0 Тогда
						СтрокаТабличнойЧасти.ОтработаноЧасов = СтрокаТабличнойЧасти.ОтработаноЧасов + Выборка.Часов;
						СтрокаТабличнойЧасти.ОтработаноДней = СтрокаТабличнойЧасти.ОтработаноДней + 1;
					КонецЕсли;	
					СчетчикВидВремени = СчетчикВидВремени+1;
				КонецЦикла;
			КонецЕсли;
		КонецЦикла;
		//ПСА 10.11.2021 СВФР-008342 +++
		Если НужнаПроверкаСверхурочноВКоммандировках Тогда
			КлассификаторСвехурочные = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные;
			КлассификаторКомандировка = Справочники.КлассификаторИспользованияРабочегоВремени.Командировка;
			
			Для Каждого СтрокаИсполнители Из Исполнители Цикл
				Для ИндексДня = 1 По 31 Цикл
					ЕстьСверхурочные = Ложь;
					ЧасовСверхурочные = 0;
					Если СтрокаТабличнойЧасти["ПервыйВидВремени" + ИндексДня] = КлассификаторСвехурочные Тогда
						ЕстьСверхурочные = Истина;
						ЧасовСверхурочные = СтрокаТабличнойЧасти["ПервыйЧасов" + ИндексДня];
					КонецЕсли;	
					Если СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = КлассификаторСвехурочные Тогда
						ЕстьСверхурочные = Истина;
						ЧасовСверхурочные = СтрокаТабличнойЧасти["ВторойЧасов" + ИндексДня];
					КонецЕсли;	
					Если СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] = КлассификаторСвехурочные Тогда
						ЕстьСверхурочные = Истина;
						ЧасовСверхурочные = СтрокаТабличнойЧасти["ТретийЧасов" + ИндексДня];
					КонецЕсли;	
					
					Если ЕстьСверхурочные Тогда
						ЕстьКомандировка = Ложь;
						Если СтрокаТабличнойЧасти["ПервыйВидВремени" + ИндексДня] = КлассификаторКомандировка 
							или СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = КлассификаторКомандировка 
							или СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] = КлассификаторКомандировка Тогда
							ЕстьКомандировка = Истина;
						КонецЕсли;
						
						Если ЕстьКомандировка Тогда
							СтрокаТабличнойЧасти["ПервыйВидВремени" + ИндексДня] = КлассификаторСвехурочные;
							СтрокаТабличнойЧасти["ПервыйЧасов" + ИндексДня]  = ЧасовСверхурочные;
							СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = "";
							СтрокаТабличнойЧасти["ВторойЧасов" + ИндексДня]  = 0;
							СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] = "";
							СтрокаТабличнойЧасти["ТретийЧасов" + ИндексДня]  = 0;
						КонецЕсли;	
					КонецЕсли;	
				КонецЦикла;		
				
			КонецЦикла;	
		КонецЕсли;	
		//+++ПСА 10.11.2021 СВФР-008342 
		
		//СВЭЙ 08.02.2024 КВВ СВФР-012344 (
		////Аверсон ЕАЕ 23.07.2021 СВФР-007772
		////СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(ВыборкаСотрудник.Сотрудник, Дата, ПериодРегистрации, мВалютаРегламентированногоУчета);
		//СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(ВыборкаСотрудник.Сотрудник, Дата, ПериодРегистрации1, мВалютаРегламентированногоУчета);
		////Аверсон СВФР-007772
		
		ДатаДляЧТС = ОпределитьДатуДляЧТС(СтрокаТабличнойЧасти, Истина, ВыборкаСотрудник.Сотрудник);
		СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(ВыборкаСотрудник.Сотрудник, ДатаДляЧТС, ПериодРегистрации1, мВалютаРегламентированногоУчета);
		//СВЭЙ 08.02.2024 КВВ СВФР-012344 )
		
		СтрокаТабличнойЧасти.КодСтроки = ПолучитьКодСтроки();
		ЗаполнимПрочиеДоплатыПоРаботнику(ВыборкаСотрудник.Сотрудник, СтрокаТабличнойЧасти.ТарифнаяСтавка, СтрокаТабличнойЧасти.КодСтроки, 1, );
		//ПСА 11.02.2021 СВФР-007191+++
		СтрокаТабличнойЧасти.КТУ = 1; 
		Если Организация.ИНН = "100071565" Тогда
			СтрокаТабличнойЧасти.ТарифнаяСтавкаДляРасчета = 1;
		КонецЕсли;

	КонецЦикла;
	
	
	Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
		МаксимальныйНомерЯчейки = 0;
		СоответствиеВидаВремениИЯчейки = Новый Соответствие;
		
		Для Каждого СтрокаОтработанногоВремени Из Исполнители Цикл
			// Очистить значения для заполнения сводных данных
			Для Сч = 1 По 5 Цикл
				СтрокаОтработанногоВремени["ВидВремени" + Сч]	= Справочники.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка();
				СтрокаОтработанногоВремени["Часов" + Сч]		= 0;
				СтрокаОтработанногоВремени["Дней" + Сч]			= 0;
			КонецЦикла;
			СоответствиеВидаВремениИЯчейки.Очистить();
			МаксимальныйНомерЯчейки = 0;
			Для ИндексЯчейки = 1 По 31 Цикл
				Для Каждого ТекущаяПриставка Из МассивПриставок Цикл
					Часов = СтрокаОтработанногоВремени[ТекущаяПриставка+"Часов"+ИндексЯчейки];
					Если Часов > 0 Тогда
						ВидВремени = СтрокаОтработанногоВремени[ТекущаяПриставка+"ВидВремени"+ИндексЯчейки];
						НомерЯчейки = СоответствиеВидаВремениИЯчейки.Получить(ВидВремени);
						Если НомерЯчейки = Неопределено Тогда
							МаксимальныйНомерЯчейки = МаксимальныйНомерЯчейки + 1;
							Если МаксимальныйНомерЯчейки > 5 Тогда
								Продолжить;
							КонецЕсли;
							СоответствиеВидаВремениИЯчейки.Вставить(ВидВремени, Строка(МаксимальныйНомерЯчейки));
							НомерЯчейки = МаксимальныйНомерЯчейки;
							СтрокаОтработанногоВремени["ВидВремени" + НомерЯчейки] = ВидВремени;
						КонецЕсли;
						СтрокаОтработанногоВремени["Часов" + НомерЯчейки] = СтрокаОтработанногоВремени["Часов" + НомерЯчейки] + Часов;
						СтрокаОтработанногоВремени["Дней" + НомерЯчейки] = СтрокаОтработанногоВремени["Дней" + НомерЯчейки] + 1;
					КонецЕсли;
				КонецЦикла;
			КонецЦикла;
		КонецЦикла;
	КонецЕсли; 
КонецПроцедуры	

// Процедура заполняет структуры именами реквизитов, которые имеют смысл
// только для определенного вида учета
//
Процедура ЗаполнитьСписокРеквизитовЗависимыхОтТиповУчета() Экспорт
	
	ЗаполнитьСписокРеквизитовЗависимыхОтТиповУчетаУпр();
	ЗаполнитьСписокРеквизитовЗависимыхОтТиповУчетаРегл();
	
КонецПроцедуры // ЗаполнитьСписокРеквизитовЗависимыхОтТиповУчета()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ

// Процедура удаляет из регистра сведений ГрафикиРаботыПоВидамВремени записи,
// введенные данным документом.
Процедура УдалитьЗаписиГрафика()
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Документ", Ссылка);
	Запрос.Текст = "ВЫБРАТЬ
	|	ГрафикиРаботыПоВидамВремени.ГрафикРаботы,
	|	ГрафикиРаботыПоВидамВремени.Дата,
	|	ГрафикиРаботыПоВидамВремени.Месяц КАК Месяц
	|ИЗ
	|	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|ГДЕ
	|	ГрафикиРаботыПоВидамВремени.Документ = &Документ
	|
	|УПОРЯДОЧИТЬ ПО
	|	Месяц, ГрафикРаботы, Дата";
	
	НаборЗаписей = РегистрыСведений.ГрафикиРаботыПоВидамВремени.СоздатьНаборЗаписей();
	ВыборкаЗапроса = Запрос.Выполнить().Выбрать();
	Пока ВыборкаЗапроса.СледующийПоЗначениюПоля("Месяц") Цикл
		НаборЗаписей.Отбор.Месяц.Установить(ВыборкаЗапроса.Месяц);
		Пока ВыборкаЗапроса.СледующийПоЗначениюПоля("ГрафикРаботы") Цикл
			НаборЗаписей.Отбор.ГрафикРаботы.Установить(ВыборкаЗапроса.ГрафикРаботы);
			НаборЗаписей.Отбор.План.Установить(Ложь);
			НаборЗаписей.Прочитать();
			Для Каждого Запись Из НаборЗаписей Цикл
				Если Запись.Документ = Ссылка Тогда
					Запись.ОсновноеЗначениеПолное = 0;
					Запись.ДополнительноеЗначениеПолное = 0;
					Запись.Документ = Документы.СдельныйНаряд.ПустаяСсылка();
				КонецЕсли;
			КонецЦикла;
			НаборЗаписей.Записать();
		КонецЦикла;
	КонецЦикла;
	
КонецПроцедуры // УдалитьЗаписиГрафика()

// Процедура определяет дату первого и последнего дня, в котром у работника
// было введено начисление.
//
Процедура ВычислитьДатуНачалаИОкончания(ПериодДействияНачало, ПериодДействияКонец, ВыборкаПоНачислениям, Сотрудник)
	
	ВыборкаПоНачислениям.Сбросить();
	Если ВыборкаПоНачислениям.НайтиСледующий(Сотрудник,"Сотрудник") Тогда
		ПериодДействияНачало = ВыборкаПоНачислениям.ПериодДействияНачало;
		ПериодДействияКонец = ВыборкаПоНачислениям.ПериодДействияКонец;
	КонецЕсли;
	
КонецПроцедуры //ВычислитьДатуНачалаИОкончания()

// Функция возвращает значение перечислеиня ВидыУчетаВремени, соответствующее 
// справочнику КлассификаторИспользованияРабочегоВремени.
Функция ПолучитьВидУчетаВремениПоКлассификатору(ВидВремени)
	
	Если ВидВремени.Пустая() Тогда
		Возврат ВидУчетаВремениПоЧасам;
	ИначеЕсли ВидВремени = КлассификаторВечернееВремя Тогда
		Возврат Перечисления.ВидыУчетаВремени.ПоВечернимЧасам;
	ИначеЕсли ВидВремени = КлассификаторНочноеВремя Тогда
		Возврат Перечисления.ВидыУчетаВремени.ПоНочнымЧасам;
	Иначе
		Возврат ВидУчетаВремениПоЧасам;
	КонецЕсли;
	
КонецФункции

// <Описание функции>
//
// Параметры
//  <Параметр1>  – <Тип.Вид> – <описание параметра>
//                 <продолжение описания параметра>
//  <Параметр2>  – <Тип.Вид> – <описание параметра>
//                 <продолжение описания параметра>
//
// Возвращаемое значение:
//   <Тип.Вид>   – <описание возвращаемого значения>
//
Функция ВычислитьКоличествоЧасовЗаДень(ВыборкаПоРаботники)
	
	ВсегоЧасовЗаДень	= 0;
	
	Пока ВыборкаПоРаботники.Следующий() Цикл
		
		//толик отсекаем ненужные виды времени 
		Если ВыборкаПоРаботники.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Работа или ВыборкаПоРаботники.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда
			Если ВыборкаПоРаботники.Часов <> 0 Тогда
				ВсегоЧасовЗаДень	= ВсегоЧасовЗаДень + ВыборкаПоРаботники["Часов"];
			КонецЕсли;	
		КонецЕсли;	
		
	КонецЦикла; 
	
	Возврат ВсегоЧасовЗаДень
	
КонецФункции // ВычислитьКоличествоЧасовЗаДень()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ДЛЯ ОБЕСПЕЧЕНИЯ ПРОВЕДЕНИЯ ДОКУМЕНТА

// Процедура заполняет структуры именами реквизитов, которые имеют смысл
// только для упр. учета
//
Процедура ЗаполнитьСписокРеквизитовЗависимыхОтТиповУчетаУпр()
	
	мСтрокаРеквизитыУпрУчета = "Выработка.Сумма, Исполнители.СуммаКНачислению";
	
КонецПроцедуры // ЗаполнитьСписокРеквизитовЗависимыхОтТиповУчетаУпр()

// Процедура заполняет структуры именами реквизитов, которые имеют смысл
// только для регл. учета
//
Процедура ЗаполнитьСписокРеквизитовЗависимыхОтТиповУчетаРегл()
	
	мСтрокаРеквизитыБухУчета = "Выработка.СчетУчетаБУ, Выработка.СчетУчетаНУ, Выработка.СуммаРегл, Исполнители.СуммаКНачислениюРегл";
	
	мСтрокаРеквизитыНалУчета = "";
	
КонецПроцедуры // ЗаполнитьСписокРеквизитовЗависимыхОтТиповУчетаРегл()

// Процедура дополняет список реквизитов шапки упр. реквизитами
//
Процедура ДополнитьРеквизитыШапкиУпр(Реквизиты)
	
	Реквизиты = Реквизиты + ?(ПустаяСтрока(Реквизиты),"",", ") + "Подразделение";
	
КонецПроцедуры // ДополнитьРеквизитыШапкиУпр()

// Процедура дополняет список реквизитов шапки регл. реквизитами
//
Процедура ДополнитьРеквизитыШапкиРегл(Реквизиты)
	
	Реквизиты = Реквизиты + ?(ПустаяСтрока(Реквизиты),"",", ") + ?(ЭтоДоговораПодряда=Истина,"Организация","Организация, ПодразделениеОрганизации"); //Аверсон 07.02.2023 КВВ СВФР-010173 (ЭтоДоговораПодряда)
	
КонецПроцедуры // ДополнитьРеквизитыШапкиРегл()

// Формирует запрос по таблице "Исполнители" документа
//
// Параметры:
//	Режим	- режим проведения
//
// Возвращаемое значение:
//	Результат запроса. В запросе данные документа дополняются значениями
//	проверяемых параметров из связанного с
//
Функция СформироватьЗапросПоИсполнители(Режим, ВыборкаПоШапкеДокумента)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.МесяцНачислений) Тогда
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
		ДатаНачалаПериода1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.ПериодРегистрации;
		ДатаНачалаПериода1 = ВыборкаПоШапкеДокумента.ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка",		Ссылка);
	
	Если ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням Тогда
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//ИндексНачальногоДня	= День(НачалоМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
		//ИндексКонечногоДня	= День(КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
		ИндексНачальногоДня	= День(НачалоМесяца(ПериодРегистрации1));
		ИндексКонечногоДня	= День(КонецМесяца(ПериодРегистрации1));
		//Аверсон СВФР-007772
		
	Иначе
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//ИндексНачальногоДня	= День(ВыборкаПоШапкеДокумента.ДатаНачалаПериода);
		//ИндексКонечногоДня	= День(ВыборкаПоШапкеДокумента.ДатаНачалаПериода);
		ИндексНачальногоДня	= День(ДатаНачалаПериода1);
		ИндексКонечногоДня	= День(ДатаНачалаПериода1);
		//Аверсон СВФР-007772
		
	КонецЕсли; 
	
	ПервыйПроход = Истина;
	Для ИндексДня = ИндексНачальногоДня По ИндексКонечногоДня Цикл
		
		СтрИндексДня = Строка(ИндексДня);
		
		Если ПервыйПроход Тогда
			Запрос.Текст = "";
			//Аверсон ЕАЕ 16.09.2021 СВФР-008068
			//ПервыйПроход = Ложь
			//Аверсон СВФР-008068
		Иначе
			Запрос.Текст = Запрос.Текст +
			"
			|	ОБЪЕДИНИТЬ"
		КонецЕсли; 
		
				//Аверсон ЕАЕ 16.09.2021 СВФР-008068
		Если РаспределениеИтогом Тогда
			Запрос.Текст = Запрос.Текст +
			"
			|	ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СдельныйНарядИсполнители.НомерСтроки,
			|	СдельныйНарядИсполнители.Сотрудник,
			|	СдельныйНарядИсполнители.Сотрудник.Физлицо КАК Физлицо,
			|	СдельныйНарядИсполнители.ТарифнаяСтавка КАК Тариф,
			|	СдельныйНарядИсполнители.КТУ КАК КТУ,
			|	СдельныйНарядИсполнителиНВР.СуммаКНачислению,
			|	СдельныйНарядИсполнители.ОтработаноЧасов,
			|	СдельныйНарядИсполнители.ОтработаноДней,
			|	СдельныйНарядИсполнители.ПервыйЧасов"+СтрИндексДня+" КАК Часов,
			|	СдельныйНарядИсполнители.ПервыйВидВремени"+СтрИндексДня+" КАК ВидВремени,
			|	"+СтрИндексДня+" КАК ИндексДня,
			|	СдельныйНарядИсполнители.ВидВремени1 КАК ВидВремени1Сводно,
			|	СдельныйНарядИсполнители.ВидВремени2 КАК ВидВремени2Сводно,
			|	СдельныйНарядИсполнители.ВидВремени3 КАК ВидВремени3Сводно,
			|	СдельныйНарядИсполнители.ВидВремени4 КАК ВидВремени4Сводно,
			|	СдельныйНарядИсполнители.ВидВремени5 КАК ВидВремени5Сводно,
			|	СдельныйНарядИсполнители.Дней1 КАК Дней1Сводно,
			|	СдельныйНарядИсполнители.Дней2 КАК Дней2Сводно,
			|	СдельныйНарядИсполнители.Дней3 КАК Дней3Сводно,
			|	СдельныйНарядИсполнители.Дней4 КАК Дней4Сводно,
			|	СдельныйНарядИсполнители.Дней5 КАК Дней5Сводно,
			|	СдельныйНарядИсполнители.Часов1 КАК Часов1Сводно,
			|	СдельныйНарядИсполнители.Часов2 КАК Часов2Сводно,
			|	СдельныйНарядИсполнители.Часов3 КАК Часов3Сводно,
			|	СдельныйНарядИсполнители.Часов4 КАК Часов4Сводно,
			|	СдельныйНарядИсполнители.Часов5 КАК Часов5Сводно,
			|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
			|" + ?(ПервыйПроход, "ПОМЕСТИТЬ ВТДанные", "") + "
			|ИЗ
			|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
			|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
			|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
			|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
			|ГДЕ
			|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СдельныйНарядИсполнители.НомерСтроки,
			|	СдельныйНарядИсполнители.Сотрудник,
			|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
			|	СдельныйНарядИсполнители.ТарифнаяСтавка,	
			|	СдельныйНарядИсполнители.КТУ КАК КТУ,
			|	СдельныйНарядИсполнителиНВР.СуммаКНачислению,
			|	СдельныйНарядИсполнители.ОтработаноЧасов,
			|	СдельныйНарядИсполнители.ОтработаноДней,
			|	СдельныйНарядИсполнители.ВторойЧасов"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+",
			|	"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ВидВремени1,
			|	СдельныйНарядИсполнители.ВидВремени2,
			|	СдельныйНарядИсполнители.ВидВремени3,
			|	СдельныйНарядИсполнители.ВидВремени4,
			|	СдельныйНарядИсполнители.ВидВремени5,
			|	СдельныйНарядИсполнители.Дней1,
			|	СдельныйНарядИсполнители.Дней2,
			|	СдельныйНарядИсполнители.Дней3,
			|	СдельныйНарядИсполнители.Дней4,
			|	СдельныйНарядИсполнители.Дней5,
			|	СдельныйНарядИсполнители.Часов1,
			|	СдельныйНарядИсполнители.Часов2,
			|	СдельныйНарядИсполнители.Часов3,
			|	СдельныйНарядИсполнители.Часов4,
			|	СдельныйНарядИсполнители.Часов5,
			|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
			|ИЗ
			|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
			|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
			|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
			|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
			|ГДЕ
			|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
			|	И СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СдельныйНарядИсполнители.НомерСтроки,
			|	СдельныйНарядИсполнители.Сотрудник,
			|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
			|	СдельныйНарядИсполнители.ТарифнаяСтавка,
			|	СдельныйНарядИсполнители.КТУ КАК КТУ,
			|	СдельныйНарядИсполнителиНВР.СуммаКНачислению,
			|	СдельныйНарядИсполнители.ОтработаноЧасов,
			|	СдельныйНарядИсполнители.ОтработаноДней,
			|	СдельныйНарядИсполнители.ТретийЧасов"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+",
			|	"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ВидВремени1,
			|	СдельныйНарядИсполнители.ВидВремени2,
			|	СдельныйНарядИсполнители.ВидВремени3,
			|	СдельныйНарядИсполнители.ВидВремени4,
			|	СдельныйНарядИсполнители.ВидВремени5,
			|	СдельныйНарядИсполнители.Дней1,
			|	СдельныйНарядИсполнители.Дней2,
			|	СдельныйНарядИсполнители.Дней3,
			|	СдельныйНарядИсполнители.Дней4,
			|	СдельныйНарядИсполнители.Дней5,
			|	СдельныйНарядИсполнители.Часов1,
			|	СдельныйНарядИсполнители.Часов2,
			|	СдельныйНарядИсполнители.Часов3,
			|	СдельныйНарядИсполнители.Часов4,
			|	СдельныйНарядИсполнители.Часов5,
			|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
			|ИЗ
			|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
			|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
			|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
			|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
			|ГДЕ
			|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
			|	И СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)";
		Иначе
			//Аверсон СВФР-008068
		Запрос.Текст = Запрос.Текст +
		"
		|	ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо КАК Физлицо,
		|	СдельныйНарядИсполнители.ТарифнаяСтавка КАК Тариф,
		|	СдельныйНарядИсполнители.КТУ КАК КТУ,
		|	СдельныйНарядИсполнители.СуммаКНачислению,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ПервыйЧасов"+СтрИндексДня+" КАК Часов,
		|	СдельныйНарядИсполнители.ПервыйВидВремени"+СтрИндексДня+" КАК ВидВремени,
		|	"+СтрИндексДня+" КАК ИндексДня,
		|	СдельныйНарядИсполнители.ВидВремени1 КАК ВидВремени1Сводно,
		|	СдельныйНарядИсполнители.ВидВремени2 КАК ВидВремени2Сводно,
		|	СдельныйНарядИсполнители.ВидВремени3 КАК ВидВремени3Сводно,
		|	СдельныйНарядИсполнители.ВидВремени4 КАК ВидВремени4Сводно,
		|	СдельныйНарядИсполнители.ВидВремени5 КАК ВидВремени5Сводно,
		|	СдельныйНарядИсполнители.Дней1 КАК Дней1Сводно,
		|	СдельныйНарядИсполнители.Дней2 КАК Дней2Сводно,
		|	СдельныйНарядИсполнители.Дней3 КАК Дней3Сводно,
		|	СдельныйНарядИсполнители.Дней4 КАК Дней4Сводно,
		|	СдельныйНарядИсполнители.Дней5 КАК Дней5Сводно,
		|	СдельныйНарядИсполнители.Часов1 КАК Часов1Сводно,
		|	СдельныйНарядИсполнители.Часов2 КАК Часов2Сводно,
		|	СдельныйНарядИсполнители.Часов3 КАК Часов3Сводно,
		|	СдельныйНарядИсполнители.Часов4 КАК Часов4Сводно,
		|	СдельныйНарядИсполнители.Часов5 КАК Часов5Сводно,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ИЗ
		|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ГДЕ
		|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
		|	СдельныйНарядИсполнители.ТарифнаяСтавка,	
		|	СдельныйНарядИсполнители.КТУ КАК КТУ,
		|	СдельныйНарядИсполнители.СуммаКНачислению,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ВторойЧасов"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+",
		|	"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВидВремени1,
		|	СдельныйНарядИсполнители.ВидВремени2,
		|	СдельныйНарядИсполнители.ВидВремени3,
		|	СдельныйНарядИсполнители.ВидВремени4,
		|	СдельныйНарядИсполнители.ВидВремени5,
		|	СдельныйНарядИсполнители.Дней1,
		|	СдельныйНарядИсполнители.Дней2,
		|	СдельныйНарядИсполнители.Дней3,
		|	СдельныйНарядИсполнители.Дней4,
		|	СдельныйНарядИсполнители.Дней5,
		|	СдельныйНарядИсполнители.Часов1,
		|	СдельныйНарядИсполнители.Часов2,
		|	СдельныйНарядИсполнители.Часов3,
		|	СдельныйНарядИсполнители.Часов4,
		|	СдельныйНарядИсполнители.Часов5,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ИЗ
		|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ГДЕ
		|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|	И СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
		|	СдельныйНарядИсполнители.ТарифнаяСтавка,
		|	СдельныйНарядИсполнители.КТУ КАК КТУ,
		|	СдельныйНарядИсполнители.СуммаКНачислению,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ТретийЧасов"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+",
		|	"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВидВремени1,
		|	СдельныйНарядИсполнители.ВидВремени2,
		|	СдельныйНарядИсполнители.ВидВремени3,
		|	СдельныйНарядИсполнители.ВидВремени4,
		|	СдельныйНарядИсполнители.ВидВремени5,
		|	СдельныйНарядИсполнители.Дней1,
		|	СдельныйНарядИсполнители.Дней2,
		|	СдельныйНарядИсполнители.Дней3,
		|	СдельныйНарядИсполнители.Дней4,
		|	СдельныйНарядИсполнители.Дней5,
		|	СдельныйНарядИсполнители.Часов1,
		|	СдельныйНарядИсполнители.Часов2,
		|	СдельныйНарядИсполнители.Часов3,
		|	СдельныйНарядИсполнители.Часов4,
		|	СдельныйНарядИсполнители.Часов5,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ИЗ
		|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ГДЕ
		|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|	И СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)";
		
	КонецЕсли;
	
			//Аверсон ЕАЕ 16.09.2021 СВФР-008068
		ПервыйПроход = Ложь
		//Аверсон СВФР-008068

	КонецЦикла;
	
	//Аверсон ЕАЕ 17.09.2021 СВФР-008068
	Если РаспределениеИтогом Тогда
		Запрос.Текст = Запрос.Текст + "
		|;
		|//////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТДанные.НомерСтроки,
		|	ВТДанные.Сотрудник,
		|	ВТДанные.Физлицо,
		|	ВТДанные.Тариф,
		|	ВТДанные.КТУ,
		|	СУММА(ВТДанные.СуммаКНачислению) КАК СуммаКНачислению,
		|	ВТДанные.ОтработаноЧасов,
		|	ВТДанные.ОтработаноДней,
		|	ВТДанные.Часов,
		|	ВТДанные.ВидВремени,
		|	ВТДанные.ИндексДня,
		|	ВТДанные.ВидВремени1Сводно,
		|	ВТДанные.ВидВремени2Сводно,
		|	ВТДанные.ВидВремени3Сводно,
		|	ВТДанные.ВидВремени4Сводно,
		|	ВТДанные.ВидВремени5Сводно,
		|	ВТДанные.Дней1Сводно,
		|	ВТДанные.Дней2Сводно,
		|	ВТДанные.Дней3Сводно,
		|	ВТДанные.Дней4Сводно,
		|	ВТДанные.Дней5Сводно,
		|	ВТДанные.Часов1Сводно,
		|	ВТДанные.Часов2Сводно,
		|	ВТДанные.Часов3Сводно,
		|	ВТДанные.Часов4Сводно,
		|	ВТДанные.Часов5Сводно,
		|	ВТДанные.ИтогоВредность
		|ИЗ ВТДанные
		|СГРУППИРОВАТЬ ПО
		|	ВТДанные.НомерСтроки,
		|	ВТДанные.Сотрудник,
		|	ВТДанные.Физлицо,
		|	ВТДанные.Тариф,
		|	ВТДанные.КТУ,
		|	ВТДанные.ОтработаноЧасов,
		|	ВТДанные.ОтработаноДней,
		|	ВТДанные.Часов,
		|	ВТДанные.ВидВремени,
		|	ВТДанные.ИндексДня,
		|	ВТДанные.ВидВремени1Сводно,
		|	ВТДанные.ВидВремени2Сводно,
		|	ВТДанные.ВидВремени3Сводно,
		|	ВТДанные.ВидВремени4Сводно,
		|	ВТДанные.ВидВремени5Сводно,
		|	ВТДанные.Дней1Сводно,
		|	ВТДанные.Дней2Сводно,
		|	ВТДанные.Дней3Сводно,
		|	ВТДанные.Дней4Сводно,
		|	ВТДанные.Дней5Сводно,
		|	ВТДанные.Часов1Сводно,
		|	ВТДанные.Часов2Сводно,
		|	ВТДанные.Часов3Сводно,
		|	ВТДанные.Часов4Сводно,
		|	ВТДанные.Часов5Сводно,
		|	ВТДанные.ИтогоВредность";
	КонецЕсли;
	//Аверсон СВФР-008068
	
	Запрос.Текст = Запрос.Текст + "
	|УПОРЯДОЧИТЬ ПО
	|	Сотрудник, ИндексДня";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоИсполнители()

// Формирует запрос по регистру "РабочееВремяРаботниковОрганизаций" документа
//
// Параметры:
//	Режим	- режим проведения
//
// Возвращаемое значение:
//	Результат запроса. В запросе данные документа дополняются значениями
//	проверяемых параметров из связанного с
//
Функция СформироватьЗапросРабочееВремяРаботниковОрганизаций()
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Запрос = Новый Запрос;//Островская Татьяна 01.04.2013 № 16
	ТекстЗапроса = "ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВЫБОР
	|		КОГДА РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &Вредность
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
	|		ИНАЧЕ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени
	|	КОНЕЦ КАК ВидВремени,
	|	РабочееВремяРаботниковОрганизаций.Тариф КАК Тариф,
	|	СУММА(РабочееВремяРаботниковОрганизаций.Часов) КАК Часов,
	|	РабочееВремяРаботниковОрганизаций.Сотрудник,
	|	РабочееВремяРаботниковОрганизаций.КТУ КАК КТУ,
	|	СУММА(РабочееВремяРаботниковОрганизаций.ЧасовВредность) КАК ИтогоВредность,
	|	РабочееВремяРаботниковОрганизаций.Период
	|ИЗ
	|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
	|ГДЕ
	|	НЕ РабочееВремяРаботниковОрганизаций.ВЦеломЗаПериод
	|	И РабочееВремяРаботниковОрганизаций.Период МЕЖДУ &НачДата И &КонДата
	|	И РабочееВремяРаботниковОрганизаций.Регистратор = &Регистратор
	|	И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени.РабочееВремя
	|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &Выходные
	|			ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &Вредность)
	|	И ВЫБОР
	|			КОГДА &ФлагПоТабелю
	|				ТОГДА РабочееВремяРаботниковОрганизаций.Регистратор ССЫЛКА Документ.ТабельУчетаРабочегоВремениОрганизации
	|			ИНАЧЕ ИСТИНА
	|		КОНЕЦ
	|
	|СГРУППИРОВАТЬ ПО
	|	РабочееВремяРаботниковОрганизаций.Тариф,
	|	РабочееВремяРаботниковОрганизаций.Сотрудник,
	|	РабочееВремяРаботниковОрганизаций.КТУ,
	|	ВЫБОР
	|		КОГДА РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = &Вредность
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
	|		ИНАЧЕ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени
	|	КОНЕЦ,
	|	РабочееВремяРаботниковОрганизаций.Период
	|
	|УПОРЯДОЧИТЬ ПО
	|	РабочееВремяРаботниковОрганизаций.Сотрудник";
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("Регистратор",		Ссылка);
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Запрос.УстановитьПараметр("НачДата",		НачалоМесяца(ПериодРегистрации));
	//Запрос.УстановитьПараметр("КонДата",		КонецМесяца(ПериодРегистрации));
	Запрос.УстановитьПараметр("НачДата",		НачалоМесяца(ПериодРегистрации1));
	Запрос.УстановитьПараметр("КонДата",		КонецМесяца(ПериодРегистрации1));
	//Аверсон СВФР-007772
	
	Запрос.УстановитьПараметр("Выходные",		Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни);
	Запрос.УстановитьПараметр("Вредность",		Справочники.КлассификаторИспользованияРабочегоВремени.Вредность);
	
	УчетнаяПолитикаЗапрос = Новый Запрос; //О.Т. 23.12.2014 № 
	УчетнаяПолитикаЗапрос.Текст = 
	"ВЫБРАТЬ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.ОтработанноеВремяТолькоПоТабелю
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
	|ГДЕ
	|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
	УчетнаяПолитикаЗапрос.УстановитьПараметр("Организация",Организация);
	УчетнаяПолитика = УчетнаяПолитикаЗапрос.Выполнить().Выгрузить();
	если УчетнаяПолитика.Количество()>0 Тогда 
		Запрос.УстановитьПараметр("ФлагПоТабелю",УчетнаяПолитика[0].ОтработанноеВремяТолькоПоТабелю);
	иначе
		Запрос.УстановитьПараметр("ФлагПоТабелю",Ложь);
	КонецЕсли;

	
	Запрос.Текст = ТекстЗапроса;
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоИсполнители()

// Формирует запрос по таблице "Исполнители" документа
//
// Параметры: 
//	Режим	- режим проведения
//
// Возвращаемое значение:
//	Результат запроса. В запросе данные документа дополняются значениями
//	проверяемых параметров из связанного с
//
Функция СформироватьЗапросПоИсполнителиРегл(ВыборкаПоШапкеДокумента)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.МесяцНачислений) Тогда
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
		ДатаНачалаПериода1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.ПериодРегистрации;
		ДатаНачалаПериода1 = ВыборкаПоШапкеДокумента.ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка",			Ссылка);
	Запрос.УстановитьПараметр("ГоловнаяОрганизация",	ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	Запрос.УстановитьПараметр("ВР",						ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СдельнаяОплата);
	Запрос.УстановитьПараметр("ДокументВведенЗаПериод", ВыборкаПоШапкеДокумента.СпособВводаДанных <> Перечисления.СпособыВводаДанныхОВремени.ЗаДень);
	Запрос.УстановитьПараметр("ВидНачисленияНУ",		Перечисления.ВидыНачисленийОплатыТрудаПоСт255НК.СдельноПремиальная);
	Запрос.УстановитьПараметр("КодДоходаЕСН",			Справочники.ДоходыЕСН.ОблагаетсяПолностью);
	Запрос.УстановитьПараметр("СпособРасчета",			Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок);
	Запрос.УстановитьПараметр("НачальнаяДата",			'00010101');
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Запрос.УстановитьПараметр("ДатаАктуальности", ?(СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень,ДатаНачалаПериода,ПериодРегистрации));
	Запрос.УстановитьПараметр("ДатаАктуальности", ?(СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень,ДатаНачалаПериода1,ПериодРегистрации1));
	//Аверсон СВФР-007772
	
	Если ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням Тогда
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//ИндексНачальногоДня	= День(НачалоМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
		//ИндексКонечногоДня	= День(КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
		ИндексНачальногоДня	= День(НачалоМесяца(ПериодРегистрации1));
		ИндексКонечногоДня	= День(КонецМесяца(ПериодРегистрации1));
		//Аверсон СВФР-007772
		
	Иначе
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//ИндексНачальногоДня	= День(ВыборкаПоШапкеДокумента.ДатаНачалаПериода);
		//ИндексКонечногоДня	= День(ВыборкаПоШапкеДокумента.ДатаНачалаПериода);
		ИндексНачальногоДня	= День(ДатаНачалаПериода1);
		ИндексКонечногоДня	= День(ДатаНачалаПериода1);
		//Аверсон СВФР-007772
		
	КонецЕсли; 
	СтрИндексДня = Строка(ИндексНачальногоДня);
	
	//Аверсон ЕАЕ 16.09.2021 СВФР-008068
	Если РаспределениеИтогом Тогда
		Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.Ссылка,
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник КАК Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Наименование,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо КАК Физлицо,
		|	СдельныйНарядИсполнители.ТарифнаяСтавка КАК Тариф,
		|	СдельныйНарядИсполнители.КТУ КАК КТУ,	
		|	СдельныйНарядИсполнителиНВР.СуммаКНачислениюРегл КАК СуммаКНачислению,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ПервыйЧасов"+СтрИндексДня+" КАК Часов,
		|	СдельныйНарядИсполнители.ПервыйВидВремени"+СтрИндексДня+" КАК ВидВремени,
		|	"+СтрИндексДня+" КАК ИндексДня,
		|	СдельныйНарядИсполнители.ВидВремени1 КАК ВидВремени1Сводно,
		|	СдельныйНарядИсполнители.ВидВремени2 КАК ВидВремени2Сводно,
		|	СдельныйНарядИсполнители.ВидВремени3 КАК ВидВремени3Сводно,
		|	СдельныйНарядИсполнители.ВидВремени4 КАК ВидВремени4Сводно,
		|	СдельныйНарядИсполнители.ВидВремени5 КАК ВидВремени5Сводно,
		|	СдельныйНарядИсполнители.Дней1 КАК Дней1Сводно,
		|	СдельныйНарядИсполнители.Дней2 КАК Дней2Сводно,
		|	СдельныйНарядИсполнители.Дней3 КАК Дней3Сводно,
		|	СдельныйНарядИсполнители.Дней4 КАК Дней4Сводно,
		|	СдельныйНарядИсполнители.Дней5 КАК Дней5Сводно,
		|	СдельныйНарядИсполнители.Часов1 КАК Часов1Сводно,
		|	СдельныйНарядИсполнители.Часов2 КАК Часов2Сводно,
		|	СдельныйНарядИсполнители.Часов3 КАК Часов3Сводно,
		|	СдельныйНарядИсполнители.Часов4 КАК Часов4Сводно,
		|	СдельныйНарядИсполнители.Часов5 КАК Часов5Сводно,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ПОМЕСТИТЬ ВТДанныеНарядаПоДням
		|ИЗ
		|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
		|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
		|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|ГДЕ
		|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
		|
		//Аверсон-софт, Островская Татьяна 04.04.2012 
		//Островская Татьяна 14.10.2013 № 16848
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.Ссылка,
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Наименование,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
		|	СдельныйНарядИсполнители.ТарифнаяСтавка,	
		|	СдельныйНарядИсполнители.КТУ,	
		|	СдельныйНарядИсполнителиНВР.СуммаКНачислениюРегл,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ВторойЧасов"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+",
		|	"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВидВремени1,
		|	СдельныйНарядИсполнители.ВидВремени2,
		|	СдельныйНарядИсполнители.ВидВремени3,
		|	СдельныйНарядИсполнители.ВидВремени4,
		|	СдельныйНарядИсполнители.ВидВремени5,
		|	СдельныйНарядИсполнители.Дней1,
		|	СдельныйНарядИсполнители.Дней2,
		|	СдельныйНарядИсполнители.Дней3,
		|	СдельныйНарядИсполнители.Дней4,
		|	СдельныйНарядИсполнители.Дней5,
		|	СдельныйНарядИсполнители.Часов1,
		|	СдельныйНарядИсполнители.Часов2,
		|	СдельныйНарядИсполнители.Часов3,
		|	СдельныйНарядИсполнители.Часов4,
		|	СдельныйНарядИсполнители.Часов5,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ИЗ
		|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
		|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
		|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|ГДЕ
		|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
		|	И СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)
		//Островская Татьяна 14.10.2013 № 16848 (коммент убран)
		//Аверсон-софт, Островская Татьяна 04.04.2012
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.Ссылка,
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Наименование,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
		|	СдельныйНарядИсполнители.ТарифнаяСтавка,	
		|	СдельныйНарядИсполнители.КТУ,	
		|	СдельныйНарядИсполнителиНВР.СуммаКНачислениюРегл,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ТретийЧасов"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+",
		|	"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВидВремени1,
		|	СдельныйНарядИсполнители.ВидВремени2,
		|	СдельныйНарядИсполнители.ВидВремени3,
		|	СдельныйНарядИсполнители.ВидВремени4,
		|	СдельныйНарядИсполнители.ВидВремени5,
		|	СдельныйНарядИсполнители.Дней1,
		|	СдельныйНарядИсполнители.Дней2,
		|	СдельныйНарядИсполнители.Дней3,
		|	СдельныйНарядИсполнители.Дней4,
		|	СдельныйНарядИсполнители.Дней5,
		|	СдельныйНарядИсполнители.Часов1,
		|	СдельныйНарядИсполнители.Часов2,
		|	СдельныйНарядИсполнители.Часов3,
		|	СдельныйНарядИсполнители.Часов4,
		|	СдельныйНарядИсполнители.Часов5,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ИЗ
		|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
		|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
		|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|ГДЕ
		|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
		|	И СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)";
	Иначе
		//Аверсон СВФР-008068
		Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СдельныйНарядИсполнители.Ссылка,
	|	СдельныйНарядИсполнители.НомерСтроки,
	|	СдельныйНарядИсполнители.Сотрудник КАК Сотрудник,
	|	СдельныйНарядИсполнители.Сотрудник.Наименование,
	|	СдельныйНарядИсполнители.Сотрудник.Физлицо КАК Физлицо,
	|	СдельныйНарядИсполнители.ТарифнаяСтавка КАК Тариф,
	|	СдельныйНарядИсполнители.КТУ КАК КТУ,	
	|	СдельныйНарядИсполнители.СуммаКНачислениюРегл КАК СуммаКНачислению,
	|	СдельныйНарядИсполнители.ОтработаноЧасов,
	|	СдельныйНарядИсполнители.ОтработаноДней,
	|	СдельныйНарядИсполнители.ПервыйЧасов"+СтрИндексДня+" КАК Часов,
	|	СдельныйНарядИсполнители.ПервыйВидВремени"+СтрИндексДня+" КАК ВидВремени,
	|	"+СтрИндексДня+" КАК ИндексДня,
	|	СдельныйНарядИсполнители.ВидВремени1 КАК ВидВремени1Сводно,
	|	СдельныйНарядИсполнители.ВидВремени2 КАК ВидВремени2Сводно,
	|	СдельныйНарядИсполнители.ВидВремени3 КАК ВидВремени3Сводно,
	|	СдельныйНарядИсполнители.ВидВремени4 КАК ВидВремени4Сводно,
	|	СдельныйНарядИсполнители.ВидВремени5 КАК ВидВремени5Сводно,
	|	СдельныйНарядИсполнители.Дней1 КАК Дней1Сводно,
	|	СдельныйНарядИсполнители.Дней2 КАК Дней2Сводно,
	|	СдельныйНарядИсполнители.Дней3 КАК Дней3Сводно,
	|	СдельныйНарядИсполнители.Дней4 КАК Дней4Сводно,
	|	СдельныйНарядИсполнители.Дней5 КАК Дней5Сводно,
	|	СдельныйНарядИсполнители.Часов1 КАК Часов1Сводно,
	|	СдельныйНарядИсполнители.Часов2 КАК Часов2Сводно,
	|	СдельныйНарядИсполнители.Часов3 КАК Часов3Сводно,
	|	СдельныйНарядИсполнители.Часов4 КАК Часов4Сводно,
	|	СдельныйНарядИсполнители.Часов5 КАК Часов5Сводно,
	|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
	|ПОМЕСТИТЬ ВТДанныеНарядаПоДням
	|ИЗ
	|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|ГДЕ
	|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
	|
	//Аверсон-софт, Островская Татьяна 04.04.2012 
	//Островская Татьяна 14.10.2013 № 16848
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СдельныйНарядИсполнители.Ссылка,
	|	СдельныйНарядИсполнители.НомерСтроки,
	|	СдельныйНарядИсполнители.Сотрудник,
	|	СдельныйНарядИсполнители.Сотрудник.Наименование,
	|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
	|	СдельныйНарядИсполнители.ТарифнаяСтавка,	
	|	СдельныйНарядИсполнители.КТУ,	
	|	СдельныйНарядИсполнители.СуммаКНачислениюРегл,
	|	СдельныйНарядИсполнители.ОтработаноЧасов,
	|	СдельныйНарядИсполнители.ОтработаноДней,
	|	СдельныйНарядИсполнители.ВторойЧасов"+СтрИндексДня+",
	|	СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+",
	|	"+СтрИндексДня+",
	|	СдельныйНарядИсполнители.ВидВремени1,
	|	СдельныйНарядИсполнители.ВидВремени2,
	|	СдельныйНарядИсполнители.ВидВремени3,
	|	СдельныйНарядИсполнители.ВидВремени4,
	|	СдельныйНарядИсполнители.ВидВремени5,
	|	СдельныйНарядИсполнители.Дней1,
	|	СдельныйНарядИсполнители.Дней2,
	|	СдельныйНарядИсполнители.Дней3,
	|	СдельныйНарядИсполнители.Дней4,
	|	СдельныйНарядИсполнители.Дней5,
	|	СдельныйНарядИсполнители.Часов1,
	|	СдельныйНарядИсполнители.Часов2,
	|	СдельныйНарядИсполнители.Часов3,
	|	СдельныйНарядИсполнители.Часов4,
	|	СдельныйНарядИсполнители.Часов5,
	|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
	|ИЗ
	|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|ГДЕ
	|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
	|	И СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)
	//Островская Татьяна 14.10.2013 № 16848 (коммент убран)
	//Аверсон-софт, Островская Татьяна 04.04.2012
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СдельныйНарядИсполнители.Ссылка,
	|	СдельныйНарядИсполнители.НомерСтроки,
	|	СдельныйНарядИсполнители.Сотрудник,
	|	СдельныйНарядИсполнители.Сотрудник.Наименование,
	|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
	|	СдельныйНарядИсполнители.ТарифнаяСтавка,	
	|	СдельныйНарядИсполнители.КТУ,	
	|	СдельныйНарядИсполнители.СуммаКНачислениюРегл,
	|	СдельныйНарядИсполнители.ОтработаноЧасов,
	|	СдельныйНарядИсполнители.ОтработаноДней,
	|	СдельныйНарядИсполнители.ТретийЧасов"+СтрИндексДня+",
	|	СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+",
	|	"+СтрИндексДня+",
	|	СдельныйНарядИсполнители.ВидВремени1,
	|	СдельныйНарядИсполнители.ВидВремени2,
	|	СдельныйНарядИсполнители.ВидВремени3,
	|	СдельныйНарядИсполнители.ВидВремени4,
	|	СдельныйНарядИсполнители.ВидВремени5,
	|	СдельныйНарядИсполнители.Дней1,
	|	СдельныйНарядИсполнители.Дней2,
	|	СдельныйНарядИсполнители.Дней3,
	|	СдельныйНарядИсполнители.Дней4,
	|	СдельныйНарядИсполнители.Дней5,
	|	СдельныйНарядИсполнители.Часов1,
	|	СдельныйНарядИсполнители.Часов2,
	|	СдельныйНарядИсполнители.Часов3,
	|	СдельныйНарядИсполнители.Часов4,
	|	СдельныйНарядИсполнители.Часов5,
	|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
	|ИЗ
	|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|ГДЕ
	|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
	|	И СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)";
КонецЕсли;

	Для ИндексДня = ИндексНачальногоДня + 1 По ИндексКонечногоДня Цикл
		СтрИндексДня = Строка(ИндексДня);
		
		//Аверсон ЕАЕ 16.09.2021 СВФР-008068
		Если РаспределениеИтогом Тогда
			Запрос.Текст = Запрос.Текст + 
			"	ОБЪЕДИНИТЬ
			|	
			|	ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СдельныйНарядИсполнители.Ссылка,
			|	СдельныйНарядИсполнители.НомерСтроки,
			|	СдельныйНарядИсполнители.Сотрудник,
			|	СдельныйНарядИсполнители.Сотрудник.Наименование,
			|	СдельныйНарядИсполнители.Сотрудник.Физлицо КАК Физлицо,
			|	СдельныйНарядИсполнители.ТарифнаяСтавка КАК Тариф,	
			|	СдельныйНарядИсполнители.КТУ КАК КТУ,	
			|	СдельныйНарядИсполнителиНВР.СуммаКНачислениюРегл КАК СуммаКНачислению,
			|	СдельныйНарядИсполнители.ОтработаноЧасов,
			|	СдельныйНарядИсполнители.ОтработаноДней,
			|	СдельныйНарядИсполнители.ПервыйЧасов"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ПервыйВидВремени"+СтрИндексДня+",
			|	"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ВидВремени1,
			|	СдельныйНарядИсполнители.ВидВремени2,
			|	СдельныйНарядИсполнители.ВидВремени3,
			|	СдельныйНарядИсполнители.ВидВремени4,
			|	СдельныйНарядИсполнители.ВидВремени5,
			|	СдельныйНарядИсполнители.Дней1,
			|	СдельныйНарядИсполнители.Дней2,
			|	СдельныйНарядИсполнители.Дней3,
			|	СдельныйНарядИсполнители.Дней4,
			|	СдельныйНарядИсполнители.Дней5,
			|	СдельныйНарядИсполнители.Часов1,
			|	СдельныйНарядИсполнители.Часов2,
			|	СдельныйНарядИсполнители.Часов3,
			|	СдельныйНарядИсполнители.Часов4,
			|	СдельныйНарядИсполнители.Часов5,
			|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
			|ИЗ
			|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
			|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
			|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
			|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
			|ГДЕ
			|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СдельныйНарядИсполнители.Ссылка,
			|	СдельныйНарядИсполнители.НомерСтроки,
			|	СдельныйНарядИсполнители.Сотрудник,
			|	СдельныйНарядИсполнители.Сотрудник.Наименование,
			|	СдельныйНарядИсполнители.Сотрудник.Физлицо, 
			|	СдельныйНарядИсполнители.ТарифнаяСтавка,
			|	СдельныйНарядИсполнители.КТУ,
			|	СдельныйНарядИсполнителиНВР.СуммаКНачислениюРегл,
			|	СдельныйНарядИсполнители.ОтработаноЧасов,
			|	СдельныйНарядИсполнители.ОтработаноДней,
			|	СдельныйНарядИсполнители.ВторойЧасов"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+",
			|	"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ВидВремени1,
			|	СдельныйНарядИсполнители.ВидВремени2,
			|	СдельныйНарядИсполнители.ВидВремени3,
			|	СдельныйНарядИсполнители.ВидВремени4,
			|	СдельныйНарядИсполнители.ВидВремени5,
			|	СдельныйНарядИсполнители.Дней1,
			|	СдельныйНарядИсполнители.Дней2,
			|	СдельныйНарядИсполнители.Дней3,
			|	СдельныйНарядИсполнители.Дней4,
			|	СдельныйНарядИсполнители.Дней5,
			|	СдельныйНарядИсполнители.Часов1,
			|	СдельныйНарядИсполнители.Часов2,
			|	СдельныйНарядИсполнители.Часов3,
			|	СдельныйНарядИсполнители.Часов4,
			|	СдельныйНарядИсполнители.Часов5,
			|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
			|ИЗ
			|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
			|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
			|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
			|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
			|ГДЕ
			|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
			|	И СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ РАЗЛИЧНЫЕ
			|	СдельныйНарядИсполнители.Ссылка,
			|	СдельныйНарядИсполнители.НомерСтроки,
			|	СдельныйНарядИсполнители.Сотрудник,
			|	СдельныйНарядИсполнители.Сотрудник.Наименование,
			|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
			|	СдельныйНарядИсполнители.ТарифнаяСтавка,	
			|	СдельныйНарядИсполнители.КТУ,
			|	СдельныйНарядИсполнителиНВР.СуммаКНачислениюРегл,
			|	СдельныйНарядИсполнители.ОтработаноЧасов,
			|	СдельныйНарядИсполнители.ОтработаноДней,
			|	СдельныйНарядИсполнители.ТретийЧасов"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+",
			|	"+СтрИндексДня+",
			|	СдельныйНарядИсполнители.ВидВремени1,
			|	СдельныйНарядИсполнители.ВидВремени2,
			|	СдельныйНарядИсполнители.ВидВремени3,
			|	СдельныйНарядИсполнители.ВидВремени4,
			|	СдельныйНарядИсполнители.ВидВремени5,
			|	СдельныйНарядИсполнители.Дней1,
			|	СдельныйНарядИсполнители.Дней2,
			|	СдельныйНарядИсполнители.Дней3,
			|	СдельныйНарядИсполнители.Дней4,
			|	СдельныйНарядИсполнители.Дней5,
			|	СдельныйНарядИсполнители.Часов1,
			|	СдельныйНарядИсполнители.Часов2,
			|	СдельныйНарядИсполнители.Часов3,
			|	СдельныйНарядИсполнители.Часов4,
			|	СдельныйНарядИсполнители.Часов5,
			|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
			|ИЗ
			|	Документ.СдельныйНаряд.ИсполнителиНесколькоВидовРабот КАК СдельныйНарядИсполнителиНВР
			|ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
			|ПО СдельныйНарядИсполнителиНВР.Сотрудник = СдельныйНарядИсполнители.Сотрудник
			|И СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
			|ГДЕ
			|	СдельныйНарядИсполнителиНВР.Ссылка = &ДокументСсылка
			|	И СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)";
		Иначе
		//Аверсон СВФР-008068
		Запрос.Текст = Запрос.Текст + 
		"	ОБЪЕДИНИТЬ
		|	
		|	ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.Ссылка,
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Наименование,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо КАК Физлицо,
		|	СдельныйНарядИсполнители.ТарифнаяСтавка КАК Тариф,	
		|	СдельныйНарядИсполнители.КТУ КАК КТУ,	
		|	СдельныйНарядИсполнители.СуммаКНачислениюРегл КАК СуммаКНачислению,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ПервыйЧасов"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ПервыйВидВремени"+СтрИндексДня+",
		|	"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВидВремени1,
		|	СдельныйНарядИсполнители.ВидВремени2,
		|	СдельныйНарядИсполнители.ВидВремени3,
		|	СдельныйНарядИсполнители.ВидВремени4,
		|	СдельныйНарядИсполнители.ВидВремени5,
		|	СдельныйНарядИсполнители.Дней1,
		|	СдельныйНарядИсполнители.Дней2,
		|	СдельныйНарядИсполнители.Дней3,
		|	СдельныйНарядИсполнители.Дней4,
		|	СдельныйНарядИсполнители.Дней5,
		|	СдельныйНарядИсполнители.Часов1,
		|	СдельныйНарядИсполнители.Часов2,
		|	СдельныйНарядИсполнители.Часов3,
		|	СдельныйНарядИсполнители.Часов4,
		|	СдельныйНарядИсполнители.Часов5,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ИЗ
		|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ГДЕ
		|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.Ссылка,
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Наименование,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо, 
		|	СдельныйНарядИсполнители.ТарифнаяСтавка,
		|	СдельныйНарядИсполнители.КТУ,
		|	СдельныйНарядИсполнители.СуммаКНачислениюРегл,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ВторойЧасов"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+",
		|	"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВидВремени1,
		|	СдельныйНарядИсполнители.ВидВремени2,
		|	СдельныйНарядИсполнители.ВидВремени3,
		|	СдельныйНарядИсполнители.ВидВремени4,
		|	СдельныйНарядИсполнители.ВидВремени5,
		|	СдельныйНарядИсполнители.Дней1,
		|	СдельныйНарядИсполнители.Дней2,
		|	СдельныйНарядИсполнители.Дней3,
		|	СдельныйНарядИсполнители.Дней4,
		|	СдельныйНарядИсполнители.Дней5,
		|	СдельныйНарядИсполнители.Часов1,
		|	СдельныйНарядИсполнители.Часов2,
		|	СдельныйНарядИсполнители.Часов3,
		|	СдельныйНарядИсполнители.Часов4,
		|	СдельныйНарядИсполнители.Часов5,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ИЗ
		|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ГДЕ
		|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|	И СдельныйНарядИсполнители.ВторойВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СдельныйНарядИсполнители.Ссылка,
		|	СдельныйНарядИсполнители.НомерСтроки,
		|	СдельныйНарядИсполнители.Сотрудник,
		|	СдельныйНарядИсполнители.Сотрудник.Наименование,
		|	СдельныйНарядИсполнители.Сотрудник.Физлицо,
		|	СдельныйНарядИсполнители.ТарифнаяСтавка,	
		|	СдельныйНарядИсполнители.КТУ,
		|	СдельныйНарядИсполнители.СуммаКНачислениюРегл,
		|	СдельныйНарядИсполнители.ОтработаноЧасов,
		|	СдельныйНарядИсполнители.ОтработаноДней,
		|	СдельныйНарядИсполнители.ТретийЧасов"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+",
		|	"+СтрИндексДня+",
		|	СдельныйНарядИсполнители.ВидВремени1,
		|	СдельныйНарядИсполнители.ВидВремени2,
		|	СдельныйНарядИсполнители.ВидВремени3,
		|	СдельныйНарядИсполнители.ВидВремени4,
		|	СдельныйНарядИсполнители.ВидВремени5,
		|	СдельныйНарядИсполнители.Дней1,
		|	СдельныйНарядИсполнители.Дней2,
		|	СдельныйНарядИсполнители.Дней3,
		|	СдельныйНарядИсполнители.Дней4,
		|	СдельныйНарядИсполнители.Дней5,
		|	СдельныйНарядИсполнители.Часов1,
		|	СдельныйНарядИсполнители.Часов2,
		|	СдельныйНарядИсполнители.Часов3,
		|	СдельныйНарядИсполнители.Часов4,
		|	СдельныйНарядИсполнители.Часов5,
		|	СдельныйНарядИсполнители.ОтработаноЧасовВредность КАК ИтогоВредность
		|ИЗ
		|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
		|ГДЕ
		|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
		|	И СдельныйНарядИсполнители.ТретийВидВремени"+СтрИндексДня+" <> ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка)";
	КонецЕсли;
	
	КонецЦикла;
	
	//Аверсон ЕАЕ 17.09.2021 СВФР-008068
	Если РаспределениеИтогом Тогда
		Запрос.Текст = Запрос.Текст + "
		|;
		|/////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТДанныеНарядаПоДням.Ссылка,
		|	ВТДанныеНарядаПоДням.НомерСтроки,
		|	ВТДанныеНарядаПоДням.Сотрудник,
		|	ВТДанныеНарядаПоДням.СотрудникНаименование,
		|	ВТДанныеНарядаПоДням.Физлицо,
		|	ВТДанныеНарядаПоДням.Тариф,
		|	ВТДанныеНарядаПоДням.КТУ,	
		|	СУММА(ВТДанныеНарядаПоДням.СуммаКНачислению) КАК СуммаКНачислению,
		|	ВТДанныеНарядаПоДням.ОтработаноЧасов,
		|	ВТДанныеНарядаПоДням.ОтработаноДней,
		|	ВТДанныеНарядаПоДням.Часов,
		|	ВТДанныеНарядаПоДням.ВидВремени,
		|	ВТДанныеНарядаПоДням.ИндексДня,
		|	ВТДанныеНарядаПоДням.ВидВремени1Сводно,
		|	ВТДанныеНарядаПоДням.ВидВремени2Сводно,
		|	ВТДанныеНарядаПоДням.ВидВремени3Сводно,
		|	ВТДанныеНарядаПоДням.ВидВремени4Сводно,
		|	ВТДанныеНарядаПоДням.ВидВремени5Сводно,
		|	ВТДанныеНарядаПоДням.Дней1Сводно,
		|	ВТДанныеНарядаПоДням.Дней2Сводно,
		|	ВТДанныеНарядаПоДням.Дней3Сводно,
		|	ВТДанныеНарядаПоДням.Дней4Сводно,
		|	ВТДанныеНарядаПоДням.Дней5Сводно,
		|	ВТДанныеНарядаПоДням.Часов1Сводно,
		|	ВТДанныеНарядаПоДням.Часов2Сводно,
		|	ВТДанныеНарядаПоДням.Часов3Сводно,
		|	ВТДанныеНарядаПоДням.Часов4Сводно,
		|	ВТДанныеНарядаПоДням.Часов5Сводно,
		|	ВТДанныеНарядаПоДням.ИтогоВредность
		|ПОМЕСТИТЬ ВТДанныеНарядаПоДнямСгруппированная
		|ИЗ ВТДанныеНарядаПоДням
		|СГРУППИРОВАТЬ ПО
		|	ВТДанныеНарядаПоДням.Ссылка,
		|	ВТДанныеНарядаПоДням.НомерСтроки,
		|	ВТДанныеНарядаПоДням.Сотрудник,
		|	ВТДанныеНарядаПоДням.СотрудникНаименование,
		|	ВТДанныеНарядаПоДням.Физлицо,
		|	ВТДанныеНарядаПоДням.Тариф,
		|	ВТДанныеНарядаПоДням.КТУ,
		|	ВТДанныеНарядаПоДням.ОтработаноЧасов,
		|	ВТДанныеНарядаПоДням.ОтработаноДней,
		|	ВТДанныеНарядаПоДням.Часов,
		|	ВТДанныеНарядаПоДням.ВидВремени,
		|	ВТДанныеНарядаПоДням.ИндексДня,
		|	ВТДанныеНарядаПоДням.ВидВремени1Сводно,
		|	ВТДанныеНарядаПоДням.ВидВремени2Сводно,
		|	ВТДанныеНарядаПоДням.ВидВремени3Сводно,
		|	ВТДанныеНарядаПоДням.ВидВремени4Сводно,
		|	ВТДанныеНарядаПоДням.ВидВремени5Сводно,
		|	ВТДанныеНарядаПоДням.Дней1Сводно,
		|	ВТДанныеНарядаПоДням.Дней2Сводно,
		|	ВТДанныеНарядаПоДням.Дней3Сводно,
		|	ВТДанныеНарядаПоДням.Дней4Сводно,
		|	ВТДанныеНарядаПоДням.Дней5Сводно,
		|	ВТДанныеНарядаПоДням.Часов1Сводно,
		|	ВТДанныеНарядаПоДням.Часов2Сводно,
		|	ВТДанныеНарядаПоДням.Часов3Сводно,
		|	ВТДанныеНарядаПоДням.Часов4Сводно,
		|	ВТДанныеНарядаПоДням.Часов5Сводно,
		|	ВТДанныеНарядаПоДням.ИтогоВредность
		|";
	КонецЕсли;
	//Аверсон СВФР-008068
	
	Запрос.Текст = Запрос.Текст + "
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник";
	
	Запрос.Выполнить();
	
	//Аверсон ЕАЕ 17.09.2021 СВФР-008068
	Если РаспределениеИтогом Тогда
		ДанныеНарядаПоДнямТекст = "ВТДанныеНарядаПоДнямСгруппированная";
	Иначе
		ДанныеНарядаПоДнямТекст = "ВТДанныеНарядаПоДням";
	КонецЕсли;
	//Аверсон СВФР-008068
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СдельныйНарядИсполнители.*,
	|	ВЫБОР
	|		КОГДА Работники.ПериодЗавершения <= &ДатаАктуальности
	|				И Работники.ПериодЗавершения <> &НачальнаяДата
	|			ТОГДА Работники.ГрафикРаботыЗавершения
	|		ИНАЧЕ Работники.ГрафикРаботы
	|	КОНЕЦ КАК ГрафикРаботы,
	|	ЕСТЬNULL(ВЫБОР
	|			КОГДА ПлановыеНачисления.ПериодЗавершения <= &ДатаАктуальности
	|					И ПлановыеНачисления.ПериодЗавершения <> &НачальнаяДата
	|				ТОГДА ПлановыеНачисления.ВидРасчетаЗавершения
	|			ИНАЧЕ ПлановыеНачисления.ВидРасчета
	|		КОНЕЦ, &ВР) КАК ВидРасчета,
	|	ЕСТЬNULL(ВЫБОР
	|			КОГДА ПлановыеНачисления.ПериодЗавершения <= &ДатаАктуальности
	|					И ПлановыеНачисления.ПериодЗавершения <> &НачальнаяДата
	|				ТОГДА ПлановыеНачисления.ВидРасчетаЗавершения.ВидНачисленияПоСт255НК
	|			ИНАЧЕ ПлановыеНачисления.ВидРасчета.ВидНачисленияПоСт255НК
	|		КОНЕЦ, &ВидНачисленияНУ) КАК ВидНачисленияНУ,
	|	ЕСТЬNULL(ВЫБОР
	|			КОГДА ПлановыеНачисления.ПериодЗавершения <= &ДатаАктуальности
	|					И ПлановыеНачисления.ПериодЗавершения <> &НачальнаяДата
	|				ТОГДА ПлановыеНачисления.ВидРасчетаЗавершения.КодДоходаЕСН
	|			ИНАЧЕ ПлановыеНачисления.ВидРасчета.КодДоходаЕСН
	|		КОНЕЦ, &КодДоходаЕСН) КАК КодПоЕСН,
	|	ВЫБОР
	|		КОГДА СостояниеСотрудников.Сотрудник ЕСТЬ NULL 
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК СотрудникЧислитсяВОрганизации,
	|	ВЫБОР
	|		КОГДА СдельныйНарядИсполнители.Сотрудник.Организация = &ГоловнаяОрганизация
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ОшибкаНеСоответствиеСотрудникаИОрганизации,
	
	//Аверсон ЕАЕ 24.04.2022 СВФР-008978
	|   РаботникиОрганизацийПрием.Период КАК ДатаПриема
	//Аверсон СВФР-008978
	
	|ИЗ
	|	"+ДанныеНарядаПоДнямТекст+" КАК СдельныйНарядИсполнители
	
	//Аверсон ЕАЕ 24.04.2022 СВФР-008978
	|       ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийПрием
	|       ПО СдельныйНарядИсполнители.Сотрудник = РаботникиОрганизацийПрием.Сотрудник
	|       	И РаботникиОрганизацийПрием.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)
	//Аверсон СВФР-008978
	
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(
	|		&ДатаАктуальности,
	|		Сотрудник В
	|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|				СдельныйНарядИсполнители.Сотрудник
	|			ИЗ
	|				Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|			ГДЕ
	|				СдельныйНарядИсполнители.Ссылка = &ДокументСсылка)) КАК Работники
	|		ПО СдельныйНарядИсполнители.Сотрудник = Работники.Сотрудник
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
	|		&ДатаАктуальности,
	|		Сотрудник В
	|				(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|					СдельныйНарядИсполнители.Сотрудник КАК Сотрудник
	|				ИЗ
	|					Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|				ГДЕ
	|					СдельныйНарядИсполнители.Ссылка = &ДокументСсылка)
	|			И ВидРасчетаИзмерение = НЕОПРЕДЕЛЕНО) КАК ПлановыеНачисления
	|		ПО (ВЫБОР
	|				КОГДА ПлановыеНачисления.ПериодЗавершения <= &ДатаАктуальности
	|						И ПлановыеНачисления.ПериодЗавершения <> &НачальнаяДата
	|					ТОГДА ПлановыеНачисления.ВидРасчетаЗавершения.СпособРасчета
	|				ИНАЧЕ ПлановыеНачисления.ВидРасчета.СпособРасчета
	|			КОНЕЦ = &СпособРасчета)
	|			И СдельныйНарядИсполнители.Сотрудник = ПлановыеНачисления.Сотрудник
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			СостоянияСотрудников.Сотрудник КАК Сотрудник
	|		ИЗ
	|			(ВЫБРАТЬ
	|				РаботникиОрганизаций.Сотрудник КАК Сотрудник
	|			ИЗ
	|				РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|			ГДЕ
	|				РаботникиОрганизаций.Период > &ДатаАктуальности
	|				И РаботникиОрганизаций.Период <= КОНЕЦПЕРИОДА(&ДатаАктуальности, МЕСЯЦ)
	|				И РаботникиОрганизаций.Сотрудник В
	|						(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|							СдельныйНарядИсполнители.Сотрудник
	|						ИЗ
	|							Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|						ГДЕ
	|							СдельныйНарядИсполнители.Ссылка = &ДокументСсылка)
	|				И РаботникиОрганизаций.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
	|				И &ДокументВведенЗаПериод
	|			
	|			ОБЪЕДИНИТЬ
	|			
	|			ВЫБРАТЬ
	|				РаботникиОрганизаций.Сотрудник
	|			ИЗ
	|				РегистрСведений.РаботникиОрганизаций.СрезПоследних(
	|					&ДатаАктуальности,
	|					Сотрудник В
	|						(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|							СдельныйНарядИсполнители.Сотрудник
	|						ИЗ
	|							Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|						ГДЕ
	|							СдельныйНарядИсполнители.Ссылка = &ДокументСсылка)) КАК РаботникиОрганизаций
	|			ГДЕ
	|				РаботникиОрганизаций.ПричинаИзмененияСостояния <> ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)) КАК СостоянияСотрудников
	|		
	|		СГРУППИРОВАТЬ ПО
	|			СостоянияСотрудников.Сотрудник) КАК СостояниеСотрудников
	|		ПО СостояниеСотрудников.Сотрудник = СдельныйНарядИсполнители.Сотрудник
	|ГДЕ
	|	СдельныйНарядИсполнители.Ссылка = &ДокументСсылка
	|
	|УПОРЯДОЧИТЬ ПО
	|	СдельныйНарядИсполнители.Сотрудник, СдельныйНарядИсполнители.ИндексДня";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоИсполнителиРегл()

Функция СформироватьЗапросПоВыработка(Режим)
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	
	// Описание текста запроса:
	// 
	// 1. Выборка "СдельныйНарядВыработка": 
	//		Выбираются строки документа.  
	//
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СдельныйНарядВыработка.НомерСтроки КАК НомерСтроки,
	|	СдельныйНарядВыработка.ТехнологическаяОперация,
	|	СдельныйНарядВыработка.НоменклатурнаяГруппа,
	|	СдельныйНарядВыработка.СтатьяЗатрат
	|ИЗ
	|	Документ.СдельныйНаряд.Выработка КАК СдельныйНарядВыработка
	|ГДЕ
	|	СдельныйНарядВыработка.Ссылка = &ДокументСсылка
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоВыработка()

// Формирует запрос по таблице "Выработка" документа
//
// Параметры: 
//	Режим - режим проведения
//
// Возвращаемое значение:
//	Результат запроса. В запросе данные документа дополняются значениями
//	проверяемых параметров из связанного с
//
Функция СформироватьЗапросПоВыработкаРегл(Режим)
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка",	Ссылка);
	Запрос.УстановитьПараметр("ЭтоЕНВД",		Перечисления.ОтнесениеРасходовКДеятельностиЕНВД.РасходыОтносятсяКЕНВД);
	
	// Описание текста запроса:
	// 
	// 1. Выборка "СдельныйНарядВыработка": 
	//		Выбираются строки документа.  
	// 2. Выборки "ВидСубконтоДт i": 
	//		По плану счетов Хозрасчетный определяем тип 
	//      значения субконто, требуемых счету бух. учета 
	//
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СдельныйНарядВыработка.НомерСтроки КАК НомерСтроки,
	|	СдельныйНарядВыработка.ТехнологическаяОперация,
	|	СдельныйНарядВыработка.НоменклатурнаяГруппа,
	|	СдельныйНарядВыработка.СтатьяЗатрат,
	|	СдельныйНарядВыработка.СуммаРегл КАК СуммаЗаРаботу,
	|	СдельныйНарядВыработка.СчетЗатрат,
	|	СдельныйНарядВыработка.СчетЗатратНУ,
	|	СдельныйНарядВыработка.ОбъектСтроительства,
	|	СдельныйНарядВыработка.Продукция,
	|	ВидСубконтоДт1.ВидСубконто КАК ВидСубконто1,
	|	ВидСубконтоДт2.ВидСубконто КАК ВидСубконто2,
	|	ВидСубконтоДт3.ВидСубконто КАК ВидСубконто3,
	|	ВидСубконтоДтНУ1.ВидСубконто КАК ВидСубконтоНУ1,
	|	ВидСубконтоДтНУ2.ВидСубконто КАК ВидСубконтоНУ2,
	|	ВидСубконтоДтНУ3.ВидСубконто КАК ВидСубконтоНУ3,
	|	ВЫБОР
	|		КОГДА СдельныйНарядВыработка.СтатьяЗатрат.ОтнесениеРасходовКДеятельностиЕНВД = &ЭтоЕНВД
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ОблагаетсяЕНВД,
	|	СдельныйНарядВыработка.ОтражениеВУСН
	|ИЗ
	|	Документ.СдельныйНаряд.Выработка КАК СдельныйНарядВыработка
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидСубконтоДт1
	|		ПО СдельныйНарядВыработка.СчетЗатрат = ВидСубконтоДт1.Ссылка
	|			И (ВидСубконтоДт1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидСубконтоДт2
	|		ПО СдельныйНарядВыработка.СчетЗатрат = ВидСубконтоДт2.Ссылка
	|			И (ВидСубконтоДт2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидСубконтоДт3
	|		ПО СдельныйНарядВыработка.СчетЗатрат = ВидСубконтоДт3.Ссылка
	|			И (ВидСубконтоДт3.НомерСтроки = 3)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоДтНУ1
	|		ПО СдельныйНарядВыработка.СчетЗатратНУ = ВидСубконтоДтНУ1.Ссылка
	|			И (ВидСубконтоДтНУ1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоДтНУ2
	|		ПО СдельныйНарядВыработка.СчетЗатратНУ = ВидСубконтоДтНУ2.Ссылка
	|			И (ВидСубконтоДтНУ2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоДтНУ3
	|		ПО СдельныйНарядВыработка.СчетЗатратНУ = ВидСубконтоДтНУ3.Ссылка
	|			И (ВидСубконтоДтНУ3.НомерСтроки = 3)
	|ГДЕ
	|	СдельныйНарядВыработка.Ссылка = &ДокументСсылка
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоВыработкаРегл()

// Проверяет правильность заполнения реквизитов в строке ТЧ "Исполнители" документа.
// Если какой-то из реквизтов, влияющий на проведение не заполнен или
// заполнен не корректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса по строке ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//	ВыборкаПоШапкеДокумента		- выборка из результата запроса по шапке документа,
//	ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//								  из результата запроса по работникам
//	Отказ						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиИсполнители(ВыборкаПоШапкеДокумента, ВыборкаПоСтрокамДокумента, ВыборкаПоРаботникиРегл, Отказ, Заголовок, УчетнаяПолитикаПоПерсоналуОрганизации)
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Исполнители"": ";
	
	// Сотрудник
	Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.Сотрудник) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан сотрудник!", Отказ, Заголовок);
	КонецЕсли;
	
	Если ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод 
		И  ВыборкаПоШапкеДокумента.УчитыватьОтработанноеВремя Тогда
		
		Для Сч = 1 По 5 Цикл
			
			Если ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента["ВидВремени"+Сч+"Сводно"]) Тогда
				
				Если НЕ ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента["Часов"+Сч+"Сводно"]) Тогда
					ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указано значение отработаных часов!", Отказ, Заголовок);
				КонецЕсли; 
				
			Иначе
				
				Если ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента["Часов"+Сч+"Сводно"]) ИЛИ
					ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента["Дней"+Сч+"Сводно"])Тогда
					ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указано значение вида времени!", Отказ, Заголовок);
				КонецЕсли; 
				
			КонецЕсли; 
			
		КонецЦикла;
		
	ИначеЕсли ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень 
		И  ВыборкаПоШапкеДокумента.УчитыватьОтработанноеВремя Тогда
		
		Если ВыборкаПоСтрокамДокумента["Часов"] = 0 Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указано значение отработаных часов для вводимого дня!", Отказ, Заголовок);
		КонецЕсли;
		
	ИначеЕсли ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням 
		И  ВыборкаПоШапкеДокумента.УчитыватьОтработанноеВремя Тогда
		
		Если НЕ ВыборкаПоСтрокамДокумента.ВидВремени.Пустая() Тогда
			РабочееВремяЗаполнено = Истина;
		КонецЕсли; 
		
	КонецЕсли; 
	
	ПроверитьЗаполнениеСтрокиИсполнителиРегл(ВыборкаПоШапкеДокумента, ВыборкаПоРаботникиРегл, Отказ, Заголовок, УчетнаяПолитикаПоПерсоналуОрганизации);
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиИсполнители()

Процедура ПроверитьЗаполнениеСтрокиИсполнителиРегл(ВыборкаПоШапкеДокумента, ВыборкаПоСтрокамДокумента, Отказ, Заголовок, УчетнаяПолитикаПоПерсоналуОрганизации)
	
	Если ВыборкаПоШапкеДокумента.ОтражатьВБухгалтерскомУчете Тогда
		
		СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
		""" табл. части ""Исполнители"": ";
		
		// Организация сотрудника должна совпадать с организацией документа
		Если ВыборкаПоСтрокамДокумента.ОшибкаНеСоответствиеСотрудникаИОрганизации Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "указанный сотрудник оформлен на другую организацию!", Отказ, Заголовок);
		КонецЕсли;
		
		// Проверка: ранее работник должен быть принят на работу
		Если НЕ ВыборкаПоСтрокамДокумента.СотрудникЧислитсяВОрганизации Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "указанный сотрудник не принят в организацию в данном периоде!", Отказ, Заголовок);
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиИсполнителиРегл()

// Проверяет правильность заполнения реквизитов в строке ТЧ "Выработка" документа.
// Если какой-то из реквизтов, влияющий на проведение не заполнен или
// заполнен не корректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса по строке ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//	ВыборкаПоШапкеДокумента		- выборка из результата запроса по шапке документа,
//	ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//								  из результата запроса по работникам
//	Отказ						- флаг отказа в проведении.
//
Процедура ПроверитьЗаполнениеСтрокиВыработка(ВыборкаПоШапкеДокумента, ВыборкаПоСтрокамДокумента, Отказ, Заголовок)
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Выработка"": ";
	
	// ТехнологическаяОперация
	Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ТехнологическаяОперация) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не выбрана технологическая операция!", Отказ, Заголовок);
	КонецЕсли;
	
	//Аверсон 27.04.2023 КВВ СВФР-010670 (закомментировано) (
	// СтатьяЗатрат
	//Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.СтатьяЗатрат) Тогда
	//	ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указана статья затрат!", Отказ, Заголовок);
	//КонецЕсли;
	//Аверсон 27.04.2023 КВВ СВФР-010670 (закомментировано) )
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиВыработка()

Процедура ПроверитьЗаполнениеСтрокиВыработкаРегл(ВыборкаПоШапкеДокумента, ВыборкаПоСтрокамДокумента, Отказ, Заголовок)
	
	СтрокаНачалаСообщенияОбОшибке = "В строке номер """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Выработка"": ";
	
	// счета учета
	Если ВыборкаПоШапкеДокумента.ОтражатьВБухгалтерскомУчете Тогда
		
		//Аверсон 27.04.2023 КВВ СВФР-010670 (закомментировано) (
		//Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.СчетЗатрат) Тогда
		//	ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан счет бухгалтерского учета!", Отказ, Заголовок);
		//КонецЕсли;
		//Аверсон 27.04.2023 КВВ СВФР-010670 (закомментировано) )
		
		//Аверсон 19.07.2021 КВВ СВФР-007870 ( (закомментировано)
		//Если Не мУчетнаяПолитикаУСН И Не ВыборкаПоСтрокамДокумента.ОблагаетсяЕНВД И Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.СчетЗатратНУ) Тогда
		//	ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "не указан счет налогового учета!", Отказ, Заголовок);
		//КонецЕсли;
		//Аверсон 19.07.2021 КВВ СВФР-007870 ) (закомментировано)
		
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиВыработкаРегл()

// Процедура формирования движения регистров
//
Процедура ДвиженияРегистров(ВыборкаПоШапкеДокумента, ВыборкаПоРаботникиУпр, ВыборкаПоРаботникиРегл, ТаблицаРаботРегл)
	
	// фактическая выработка работников
	ДвиженияФактическойВыработкиУпр(ВыборкаПоШапкеДокумента, ВыборкаПоРаботникиУпр);
	ДвиженияФактическойВыработкиРегл(ВыборкаПоШапкеДокумента, ВыборкаПоРаботникиРегл);
	ДвиженияРегистровБУиНУРегл(ВыборкаПоШапкеДокумента, ВыборкаПоРаботникиРегл, ТаблицаРаботРегл);
	
	//Аверсон ЕАЕ 17.09.2021 СВФР-008068
	Если РаспределениеИтогом Тогда
		ДвиженияРаспределениеИтогом(ВыборкаПоШапкеДокумента); //Аверсон ЕАЕ 06.02.2023 СВФР-010277 параметр ВыборкаПоШапкеДокумента
	КонецЕсли;
	//Аверсон СВФР-008068
	
КонецПроцедуры // ДвиженияРегистров()

//Аверсон ЕАЕ 17.09.2021 СВФР-008068
Процедура ДвиженияРаспределениеИтогом(ВыборкаПоШапкеДокумента) //Аверсон ЕАЕ 06.02.2023 СВФР-010277 параметр ВыборкаПоШапкеДокумента
	
	//Аверсон ЕАЕ 27.10.2021 СВФР-008312
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	СписокСотрудников = ИсполнителиНесколькоВидовРабот.ВыгрузитьКолонку("Сотрудник");
	ТЗПериодыВБригаде = ПолучитьПериодыРаботыСотрудниковВБригаде(СписокСотрудников, ПериодРегистрации1);
	//Аверсон СВФР-008312
	
	//Ускорение
	ТЗ = Новый ТаблицаЗначений;
	ТЗ.Колонки.Добавить("Сотрудник");
	ТЗ.Колонки.Добавить("ФизЛицо");
	ТЗ.Колонки.Добавить("ВидРасчета");
	ТЗ.Колонки.Добавить("КодДоходаНДФЛ");
	ТЗ.Колонки.Добавить("Сумма");
	ТЗ.Колонки.Добавить("ПодразделениеОрганизации");
	
	СписокСотрудников = ИсполнителиНесколькоВидовРабот.ВыгрузитьКолонку("Сотрудник");
	ТЗСотрудники = ПолучитьТЗСотрудники(СписокСотрудников, КонецМесяца(ПериодРегистрации1));
	
	НаборОсновныеНачисления = Движения.ОсновныеНачисленияРаботниковОрганизаций;
	//

	//Аверсон ЕАЕ 06.02.2023 СВФР-010277
	//Найдем периоды работы сотрудников
	ТЗПериодыРаботыСотрудников = ПолучитьПериодыРаботыСотрудников(СписокСотрудников, ПериодРегистрации1, ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
	
	//Аверсон ЕАЕ 16.07.2025 СВФР-016262
	//Белвторчермет
	//Посчитаем количество отработанных часов
	Если Организация.ИНН = "100071565" Тогда
		КоличествоДнейВПериодеРегистрации = День(КонецМесяца(ПериодРегистрации1));
		ТЗПериодыРаботыСотрудников.Колонки.Добавить("ОтработаноЧасовВПериоде", ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(5,2));
		Для Каждого Стр Из Исполнители Цикл
			Для н = 1 По КоличествоДнейВПериодеРегистрации Цикл
				ТекДата = Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), н);
				
				СтруктураСотрудник = Новый Структура;
				СтруктураСотрудник.Вставить("Сотрудник", Стр.Сотрудник);
				НужныеСтрокиПоСотруднику = ТЗПериодыРаботыСотрудников.НайтиСтроки(СтруктураСотрудник);
				Для Каждого Эл Из НужныеСтрокиПоСотруднику Цикл
					Если ТекДата >= Эл.НачПериода И ТекДата <= Эл.КонПериода Тогда
						НужнаяСтр = Эл;
						Прервать;
					КонецЕсли;
				КонецЦикла;
				
				Для НомерПриставки = 1 По 3 Цикл
					Если НомерПриставки = 1 Тогда
						Приставка = "Первый";
					ИначеЕсли НомерПриставки = 2 Тогда
						Приставка = "Второй";
					ИначеЕсли НомерПриставки = 3 Тогда
						Приставка = "Третий";
					КонецЕсли;
					ИмяКолонки = Приставка + "Часов" + СокрЛП(н);
					ЗначениеВКолонке = Стр[ИмяКолонки];
					Если ЗначениеЗаполнено(ЗначениеВКолонке) Тогда
						НужнаяСтр.ОтработаноЧасовВПериоде = НужнаяСтр.ОтработаноЧасовВПериоде + ЗначениеВКолонке;	
					КонецЕсли;
				КонецЦикла;
			КонецЦикла;
		КонецЦикла;
	КонецЕсли;
	//Аверсон СВФР-016262
	
	СтруктураОтбора = Новый Структура;
	СтруктураОтбора.Вставить("Сотрудник");
	//Аверсон СВФР-010277
	
	//Аверсон ЕАЕ 21.03.2024 СВФР-012655
	СотрудникиНеРаботающие = Новый Массив;
	//Аверсон СВФР-012655
	
	Для Каждого СтрокаТЧ Из ИсполнителиНесколькоВидовРабот Цикл
		
		Если СтрокаТЧ.СуммаКНачислениюРегл <> 0 Тогда
			
			//определяем вид расчета
			ТО = СтрокаТЧ.ТехнологическаяОперация; 
			Если ЗначениеЗаполнено(ТО) Тогда
				//КодТО = ТО.Код;
				КодТО = ?(Организация.ИНН = "100071565",ТО.КодНачисления,ТО.Код); //Аверсон 21.04.2023 КВВ СВФР-010670
			Иначе
				Продолжить;
			КонецЕсли;
			
			ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду(КодТО);
			Если ВидРасчета.Пустая() Тогда
				Попытка
					КодТОБезНулей = СокрЛП(Число(КодТО));
					ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду(КодТОБезНулей);
				Исключение
				КонецПопытки;
			КонецЕсли;
			
			Если ВидРасчета.Пустая() Тогда
				Продолжить;
			КонецЕсли;
			
			//Аверсон ЕАЕ 27.10.2021 СВФР-008312
			СтрПериоды = ТЗПериодыВБригаде.Найти(СтрокаТЧ.Сотрудник, "Сотрудник");
			//Аверсон СВФР-008312
			
			//Аверсон ЕАЕ 21.03.2024 СВФР-012655
			Если СтрПериоды = Неопределено Тогда
				Если СотрудникиНеРаботающие.Найти(СтрокаТЧ.Сотрудник) = Неопределено Тогда
					СотрудникиНеРаботающие.Добавить(СтрокаТЧ.Сотрудник);	
				КонецЕсли;
			КонецЕсли;
			//Аверсон СВФР-012655
			
			//Аверсон ЕАЕ 06.02.2023 СВФР-010277
			СтруктураОтбора.Сотрудник = СтрокаТЧ.Сотрудник;
			МассивПериодыРаботыСотрудника = ТЗПериодыРаботыСотрудников.НайтиСтроки(СтруктураОтбора);
			ТЗПериодыРаботыСотрудника = ТЗПериодыРаботыСотрудников.Скопировать(МассивПериодыРаботыСотрудника);
			//Аверсон СВФР-010277
			
			ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СтрокаТЧ.Сотрудник, ВидРасчета, СтрокаТЧ.СуммаКНачислениюРегл, 
																		СтрокаТЧ.ОтработаноЧасов, ,СтрПериоды, НаборОсновныеНачисления, 
																		Ложь, ТЗПериодыРаботыСотрудника); //Аверсон ЕАЕ 27.10.2021 СВФР-008312 параметр СтрПериоды 
																										  //Ускорение (последние 2 параметра) 
																										  //Аверсон ЕАЕ 06.02.2023 СВФР-010277 параметр ТЗПериодыРаботыСотрудника

			//Ускорение
			КодДоходаНДФЛ = ВидРасчета.КодДоходаНДФЛ;
			Если ЗначениеЗаполнено(КодДоходаНДФЛ) Тогда
				//ДобавитьДвижениеПоНДФЛСведенияОДоходах(СтрокаТЧ.Сотрудник, ВидРасчета, СтрокаТЧ.СуммаКНачислениюРегл);
				НоваяСтр = ТЗ.Добавить();
				НоваяСтр.Сотрудник = СтрокаТЧ.Сотрудник;
				
				СтрСотрудник = ТЗСотрудники.Найти(СтрокаТЧ.Сотрудник, "Сотрудник");
				
				НоваяСтр.ФизЛицо = СтрСотрудник.ФизЛицо;
				НоваяСтр.ВидРасчета = ВидРасчета;
				НоваяСтр.КодДоходаНДФЛ = КодДоходаНДФЛ;
				НоваяСтр.Сумма = СтрокаТЧ.СуммаКНачислениюРегл;
				НоваяСтр.ПодразделениеОрганизации = СтрСотрудник.ПодразделениеОрганизации;
			КонецЕсли;
			//
			
			Если СтрПериоды <> Неопределено Тогда //Аверсон ЕАЕ 21.03.2024 СВФР-012655
				ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(СтрокаТЧ.Сотрудник.ФизЛицо, СтрокаТЧ.СуммаКНачислениюРегл);
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	//Аверсон ЕАЕ 21.03.2024 СВФР-012655
	Если СотрудникиНеРаботающие.Количество() > 0 Тогда
		Для Каждого Эл Из СотрудникиНеРаботающие Цикл
			Сообщить("Сотрудник " + СокрЛП(Эл) + " не работает в бригаде.");
		КонецЦикла;
		Отказ = Истина;
	КонецЕсли;
	//Аверсон СВФР-012655
	
	//Ускорение
	НаборОсновныеНачисления.Записать();
	ДобавитьНесколькоДвиженийПоНДФЛСведенияОДоходах(ТЗ);
	//
КонецПроцедуры
//Аверсон СВФР-008068

//Аверсон ЕАЕ 27.10.2021 СВФР-008312
Функция ПолучитьПериодыРаботыСотрудниковВБригаде(СписокСотрудников, ЗаПериод)
	
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	&НачалоПериода КАК Период,
	|	НазначениеСотрудниковПоБригадамСрезПоследних.Сотрудник,
	|	НазначениеСотрудниковПоБригадамСрезПоследних.Бригада
	|ПОМЕСТИТЬ ВТПериоды
	|ИЗ
	|	РегистрСведений.НазначениеСотрудниковПоБригадам.СрезПоследних(&НачалоПериода, Сотрудник В (&СписокСотрудников)) КАК НазначениеСотрудниковПоБригадамСрезПоследних
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	НазначениеСотрудниковПоБригадам.Период,
	|	НазначениеСотрудниковПоБригадам.Сотрудник,
	|	НазначениеСотрудниковПоБригадам.Бригада
	|ИЗ
	|	РегистрСведений.НазначениеСотрудниковПоБригадам КАК НазначениеСотрудниковПоБригадам
	|ГДЕ
	|	НазначениеСотрудниковПоБригадам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|И НазначениеСотрудниковПоБригадам.Сотрудник В (&СписокСотрудников)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТПериоды.Сотрудник,
	|	ВТПериоды.Бригада,
	|	ВТПериоды.Период КАК НачалоПериода,
	|	МИНИМУМ(ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ВТПериодыБольше.Период, СЕКУНДА, -1), &КонецПериода)) КАК КонецПериода
	|ИЗ
	|	ВТПериоды КАК ВТПериоды
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПериоды КАК ВТПериодыБольше
	|		ПО ВТПериоды.Сотрудник = ВТПериодыБольше.Сотрудник
	|			И ВТПериоды.Период < ВТПериодыБольше.Период
	|%УсловиеПоБригаде%
	|СГРУППИРОВАТЬ ПО
	|	ВТПериоды.Сотрудник,
	|	ВТПериоды.Бригада,
	|	ВТПериоды.Период";
	
	Запрос = Новый Запрос;
	
	Если ЗначениеЗаполнено(Бригада) Тогда
		Текст = СтрЗаменить(Текст, "%УсловиеПоБригаде%", "ГДЕ ВТПериоды.Бригада = &Бригада");
		Запрос.УстановитьПараметр("Бригада", Бригада);
	Иначе
		Текст = СтрЗаменить(Текст, "%УсловиеПоБригаде%", "");
	КонецЕсли;
	
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("НачалоПериода", НачалоМесяца(ЗаПериод));
	Запрос.УстановитьПараметр("КонецПериода", КонецМесяца(ЗаПериод));
	Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
	
	ТЗ = Запрос.Выполнить().Выгрузить();
	ТЗ.Сортировать("НачалоПериода");
	
	ТЗРезультат = ТЗ.Скопировать();
	ТЗРезультат.Свернуть("Сотрудник");
	
	ТипДата = Новый ОписаниеТипов("Дата");
	ТЗРезультат.Колонки.Добавить("НачалоПериода", ТипДата);
	ТЗРезультат.Колонки.Добавить("КонецПериода", ТипДата);
	
	Для Каждого Стр Из ТЗРезультат Цикл
		НачалоПериода = '00010101';
		КонецПериода = '00010101';
		СтруктураСотрудник = Новый Структура;
		СтруктураСотрудник.Вставить("Сотрудник", Стр.Сотрудник);
		
		НужныеСтроки = ТЗ.НайтиСтроки(СтруктураСотрудник);
		Для Каждого Эл Из НужныеСтроки Цикл
			Если Не ЗначениеЗаполнено(НачалоПериода) Тогда
				НачалоПериода = Эл.НачалоПериода;	
			КонецЕсли;
			КонецПериода = Эл.КонецПериода;
		КонецЦикла;
		Стр.НачалоПериода = НачалоПериода;
		Стр.КонецПериода = КонецПериода;
	КонецЦикла;
	
	Возврат ТЗРезультат;
КонецФункции
//Аверсон СВФР-008312

Процедура ДвиженияФактическойВыработкиУпр(ВыборкаПоШапкеДокумента, ВыборкаПоРаботники)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.МесяцНачислений) Тогда
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
		ДатаНачалаПериода1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.ПериодРегистрации;
		ДатаНачалаПериода1 = ВыборкаПоШапкеДокумента.ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	//ПСА 11.02.2021 СВФР-007191+++
	//Если ВыборкаПоШапкеДокумента.ОтражатьВУправленческомУчете Тогда
	Если ВыборкаПоШапкеДокумента.ОтражатьВУправленческомУчете и НЕ (Сверхурочно или Праздники или Доплатной или Запчасть или Прочее)Тогда //Аверсон ЕАЕ 20.05.2021 СВФР-007544 "или Прочее"
	//ПСА 11.02.2021 СВФР-007191+++	

	    //Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//КоличествоДнейВПериодеРегистрации = День(КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
		КоличествоДнейВПериодеРегистрации = День(КонецМесяца(ПериодРегистрации1));
		//Аверсон СВФР-007772
		
		МассивКоэффициентов = Новый Массив(КоличествоДнейВПериодеРегистрации);
		МассивРаспределенияНачисленнойСуммыПоДням = Новый Массив(КоличествоДнейВПериодеРегистрации);
		НаборДвижений = Движения.ФактическаяВыработкаРаботников;
		
		//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
		//Пока ВыборкаПоРаботники.СледующийПоЗначениюПоля("Сотрудник") Цикл
		//- СВЭЙ КДЯ 08.10.19 СВФР-004843
		//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
		Пока ВыборкаПоРаботники.Следующий() Цикл
		//- СВЭЙ КДЯ 08.10.19 СВФР-004843
			
			Если ВыборкаПоРаботники.СуммаКНачислению <> 0 Тогда
				
				Если ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням 
					И ВыборкаПоШапкеДокумента.УчитыватьОтработанноеВремя Тогда
					
					Пока ВыборкаПоРаботники.СледующийПоЗначениюПоля("ИндексДня") Цикл
						МассивКоэффициентов[ВыборкаПоРаботники.ИндексДня - 1] = ВычислитьКоличествоЧасовЗаДень(ВыборкаПоРаботники);
					КонецЦикла;
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//МассивРаспределенияНачисленнойСуммыПоДням = ОбщегоНазначения.РаспределитьПропорционально(ВыборкаПоРаботники.СуммаКНачислению, МассивКоэффициентов,,ВыборкаПоШапкеДокумента.ПериодРегистрации);//О.Т. Аверсон 15.03.2016 № 949
					МассивРаспределенияНачисленнойСуммыПоДням = ОбщегоНазначения.РаспределитьПропорционально(ВыборкаПоРаботники.СуммаКНачислению, МассивКоэффициентов,,ПериодРегистрации1);//О.Т. Аверсон 15.03.2016 № 949
					//Аверсон СВФР-007772
					
					Для ИндексДня = 1 По КоличествоДнейВПериодеРегистрации Цикл
						Если МассивРаспределенияНачисленнойСуммыПоДням[ИндексДня-1] <> 0 Тогда
							НоваяСтрока = НаборДвижений.Добавить();
							НоваяСтрока.ФизЛицо				= ВыборкаПоРаботники.ФизЛицо;
							
							НоваяСтрока.СпособВводаДанных	= ВыборкаПоШапкеДокумента.СпособВводаДанных;
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//НоваяСтрока.Период				= Дата(Год(ВыборкаПоШапкеДокумента.ПериодРегистрации), Месяц(ВыборкаПоШапкеДокумента.ПериодРегистрации), ИндексДня);
							НоваяСтрока.Период				= Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), ИндексДня);
							//Аверсон СВФР-007772
							
							НоваяСтрока.Выработка			= МассивРаспределенияНачисленнойСуммыПоДням[ИндексДня-1];
						КонецЕсли;
					КонецЦикла;
					
				Иначе
					
					НоваяСтрока = НаборДвижений.Добавить();
					НоваяСтрока.ФизЛицо				= ВыборкаПоРаботники.ФизЛицо;
					НоваяСтрока.Выработка			= ВыборкаПоРаботники.СуммаКНачислению;
					
					Если ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
						
						//Аверсон ЕАЕ 23.07.2021 СВФР-007772
						//НоваяСтрока.Период			= ВыборкаПоШапкеДокумента.ДатаНачалаПериода;
						НоваяСтрока.Период			= ДатаНачалаПериода1;
						//Аверсон СВФР-007772
						
					Иначе
						
						//Аверсон ЕАЕ 23.07.2021 СВФР-007772
						//НоваяСтрока.Период			= ВыборкаПоШапкеДокумента.ПериодРегистрации;
						НоваяСтрока.Период			= ПериодРегистрации1;
						//Аверсон СВФР-007772
						
					КонецЕсли;
					
					Если НЕ ВыборкаПоШапкеДокумента.УчитыватьОтработанноеВремя 
						И ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням Тогда
						НоваяСтрока.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод	
					Иначе
						НоваяСтрока.СпособВводаДанных	= ВыборкаПоШапкеДокумента.СпособВводаДанных;
					КонецЕсли;
					
				КонецЕсли;
				
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры // ДвиженияФактическойВыработкиУпр()

Процедура ДвиженияФактическойВыработкиРегл(ВыборкаПоШапкеДокумента, ВыборкаПоРаботники)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.МесяцНачислений) Тогда
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
		ДатаНачалаПериода1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.ПериодРегистрации;
		ДатаНачалаПериода1 = ВыборкаПоШапкеДокумента.ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	//ПСА 11.02.2021 СВФР-007191+++
	//Если ВыборкаПоШапкеДокумента.ОтражатьВБухгалтерскомУчете Тогда
	Если ВыборкаПоШапкеДокумента.ОтражатьВБухгалтерскомУчете и НЕ (Сверхурочно или Праздники или Доплатной или запчасть или Прочее)Тогда //Аверсон ЕАЕ 20.05.2021 СВФР-007544 "или Прочее"
	//ПСА 11.02.2021 СВФР-007191+++
	
	    //Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//КоличествоДнейВПериодеРегистрации = День(КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации));
		КоличествоДнейВПериодеРегистрации = День(КонецМесяца(ПериодРегистрации1));
		//Аверсон СВФР-007772
		
		МассивКоэффициентов = Новый Массив(КоличествоДнейВПериодеРегистрации);
		МассивРаспределенияНачисленнойСуммыПоДням = Новый Массив(КоличествоДнейВПериодеРегистрации);
		НаборДвижений = Движения.ФактическаяВыработкаРаботниковОрганизаций;
		Если Организация.ИНН = "700067572"  или Организация.ИНН = "100071565" Тогда
			
			//Аверсон ЕАЕ 05.03.2022 СВФР-008818
			Если Организация.ИНН = "100071565" Тогда
				СписокСотрудников = Исполнители.ВыгрузитьКолонку("Сотрудник");
				
				Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
				|	&ДатаНачала КАК Период,
				|	РаботникиОрганизацийСрезПоследних.Сотрудник,
				//|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
				|	РаботникиОрганизацийСрезПоследних.Должность,
				|	РаботникиОрганизацийСрезПоследних.РазрядЕТС КАК Разряд,
				|	РаботникиОрганизацийСрезПоследних.Организация
				|ПОМЕСТИТЬ ВТПериодыРаботы
				|ИЗ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ДатаНачала, Сотрудник В (&СписокСотрудников) 
				//|И ПодразделениеОрганизации = &Подразделение 
				|И Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних
				|
				|ОБЪЕДИНИТЬ
				
				|ВЫБРАТЬ
				|	РаботникиОрганизаций.Период,
				|	РаботникиОрганизаций.Сотрудник,
				//|	РаботникиОрганизаций.ПодразделениеОрганизации,
				|	РаботникиОрганизаций.Должность,
				|	РаботникиОрганизаций.РазрядЕТС,
				|	РаботникиОрганизаций.Организация
				|ИЗ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
				|ГДЕ РаботникиОрганизаций.Сотрудник В (&СписокСотрудников)
				//|	И РаботникиОрганизаций.ПодразделениеОрганизации = &Подразделение
				|	И РаботникиОрганизаций.Организация = &Организация
				|	И РаботникиОрганизаций.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
				|;
				|//////////////////////////////////////////////////////////////////////
				|ВЫБРАТЬ РАЗРЕШЕННЫЕ
				|	ВТПериоды.Сотрудник,
				|	ВТПериоды.Организация,
				//|	ВТПериоды.ПодразделениеОрганизации,
				|	ВТПериоды.Должность,
				|	ВТПериоды.Разряд,
				|	ВТПериоды.Период КАК НачПериода,
				|	МИНИМУМ(ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ВТПериодыБольше.Период, СЕКУНДА, -1), &ДатаОкончания)) КАК КонПериода
				|ПОМЕСТИТЬ ВТРезультат
				|ИЗ ВТПериодыРаботы КАК ВТПериоды
				|ЛЕВОЕ СОЕДИНЕНИЕ ВТПериодыРаботы КАК ВТПериодыБольше
				|ПО ВТПериоды.Сотрудник = ВТПериодыБольше.Сотрудник
				|	И ВТПериоды.Организация = ВТПериодыБольше.Организация
				|	И ВТПериоды.Период < ВТПериодыБольше.Период
				|СГРУППИРОВАТЬ ПО
				|	ВТПериоды.Сотрудник,
				|	ВТПериоды.Организация,
				//|	ВТПериоды.ПодразделениеОрганизации,
				|	ВТПериоды.Должность,
				|	ВТПериоды.Разряд,
				|	ВТПериоды.Период
				|;
				|/////////////////////////////////////////////////////////////////////////
				|ВЫБРАТЬ РАЗРЕШЕННЫЕ
				|	ВТРезультат.Сотрудник,
				|	ВТРезультат.Организация,
				//|	ВТРезультат.ПодразделениеОрганизации,
				|	ВТРезультат.Должность,
				|	ВТРезультат.Разряд,
				|	ВТРезультат.НачПериода,
				|	ВТРезультат.КонПериода,
				|	РАЗНОСТЬДАТ(ВТРезультат.НачПериода, ВТРезультат.КонПериода, СЕКУНДА) / 86400 КАК ДнейВПериоде
				|ИЗ ВТРезультат
				|";
				
				Если Не ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда
					Текст = СтрЗаменить(Текст, "И ПодразделениеОрганизации = &Подразделение", "");
				КонецЕсли;
				Запрос = Новый Запрос;
				Запрос.Текст = Текст;
				Запрос.УстановитьПараметр("Организация", ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
				//Запрос.УстановитьПараметр("Подразделение", ПодразделениеОрганизации);
				Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
				Запрос.УстановитьПараметр("ДатаНачала", НачалоМесяца(ПериодРегистрации1));
				Запрос.УстановитьПараметр("ДатаОкончания", КонецМесяца(ПериодРегистрации1));
				ТЗПериоды = Запрос.Выполнить().Выгрузить();
				
				ТЗПериодыРаботы = ТЗПериоды;
				//============================================================
				//Находим периоды работы сотрудников в бригаде по РС НазначениеСотрудниковПоБригадам
				Если ЗначениеЗаполнено(Бригада) Тогда
					Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
					|	&ДатаНачала КАК Период,
					|	НазначениеСотрудниковПоБригадамСрезПоследних.Сотрудник,
					|	НазначениеСотрудниковПоБригадамСрезПоследних.Организация,
					|	НазначениеСотрудниковПоБригадамСрезПоследних.Бригада
					|ПОМЕСТИТЬ ВТПериодыРаботы
					|ИЗ РегистрСведений.НазначениеСотрудниковПоБригадам.СрезПоследних(&ДатаНачала, Сотрудник В (&СписокСотрудников) 
					//|И Бригада = &Бригада 
					|И Организация = &Организация) КАК НазначениеСотрудниковПоБригадамСрезПоследних
					|
					|ОБЪЕДИНИТЬ
					
					|ВЫБРАТЬ
					|	НазначениеСотрудниковПоБригадам.Период,
					|	НазначениеСотрудниковПоБригадам.Сотрудник,
					|	НазначениеСотрудниковПоБригадам.Организация,
					|	НазначениеСотрудниковПоБригадам.Бригада
					|ИЗ РегистрСведений.НазначениеСотрудниковПоБригадам КАК НазначениеСотрудниковПоБригадам
					|ГДЕ НазначениеСотрудниковПоБригадам.Сотрудник В (&СписокСотрудников)
					//|	И НазначениеСотрудниковПоБригадам.Бригада = &Бригада
					|	И НазначениеСотрудниковПоБригадам.Организация = &Организация
					|	И НазначениеСотрудниковПоБригадам.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
					|;
					|//////////////////////////////////////////////////////////////////////
					|ВЫБРАТЬ РАЗРЕШЕННЫЕ
					|	ВТПериоды.Сотрудник,
					|	ВТПериоды.Организация,
					|	ВТПериоды.Бригада,
					|	ВТПериоды.Период КАК НачПериода,
					|	МИНИМУМ(ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ВТПериодыБольше.Период, СЕКУНДА, -1), &ДатаОкончания)) КАК КонПериода
					|ПОМЕСТИТЬ ВТРезультат
					|ИЗ ВТПериодыРаботы КАК ВТПериоды
					|ЛЕВОЕ СОЕДИНЕНИЕ ВТПериодыРаботы КАК ВТПериодыБольше
					|ПО ВТПериоды.Сотрудник = ВТПериодыБольше.Сотрудник
					|	И ВТПериоды.Организация = ВТПериодыБольше.Организация
					|	И ВТПериоды.Период < ВТПериодыБольше.Период
					|СГРУППИРОВАТЬ ПО
					|	ВТПериоды.Сотрудник,
					|	ВТПериоды.Организация,
					|	ВТПериоды.Бригада,
					|	ВТПериоды.Период
					|;
					|/////////////////////////////////////////////////////////////////////////
					|ВЫБРАТЬ РАЗРЕШЕННЫЕ
					|	ВТРезультат.Сотрудник,
					|	ВТРезультат.Организация,
					|	ВТРезультат.НачПериода,
					|	ВТРезультат.КонПериода,
					|	РАЗНОСТЬДАТ(ВТРезультат.НачПериода, ВТРезультат.КонПериода, СЕКУНДА) / 86400 КАК ДнейВПериоде
					|ИЗ ВТРезультат
					|ГДЕ ВТРезультат.Бригада = &Бригада
					|";
					
					Если Не ЗначениеЗаполнено(Бригада) Тогда
						Текст = СтрЗаменить(Текст, "ГДЕ ВТРезультат.Бригада = &Бригада", "");
					КонецЕсли;
					
					Запрос = Новый Запрос;
					Запрос.Текст = Текст;
					Запрос.УстановитьПараметр("Организация", ВыборкаПоШапкеДокумента.ГоловнаяОрганизация);
					Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
					Запрос.УстановитьПараметр("ДатаНачала", НачалоМесяца(ПериодРегистрации1));
					Запрос.УстановитьПараметр("ДатаОкончания", КонецМесяца(ПериодРегистрации1));
					Запрос.УстановитьПараметр("Бригада", Бригада);
					ТЗПериодыВБригаде = Запрос.Выполнить().Выгрузить();	
					
					//===================================================
					//находим пересечения
					ТЗПериодыПересечения = ТЗПериоды.Скопировать();
					ТЗПериодыПересечения.Очистить();
					Для Каждого Стр Из ТЗПериоды Цикл
						СтруктураОтбора = Новый Структура;
						СтруктураОтбора.Вставить("Сотрудник", Стр.Сотрудник);
						СтруктураОтбора.Вставить("Организация", Стр.Организация);
						СтрокиПоСотруднику = ТЗПериодыВБригаде.НайтиСтроки(СтруктураОтбора);
						
						Для Каждого СтрБригада Из СтрокиПоСотруднику Цикл
							Если (СтрБригада.НачПериода >= Стр.НачПериода И СтрБригада.НачПериода <= Стр.КонПериода)
								ИЛИ (Стр.НачПериода >= СтрБригада.НачПериода И Стр.НачПериода <= СтрБригада.КонПериода) Тогда
								НовСтр = ТЗПериодыПересечения.Добавить();
								ЗаполнитьЗначенияСвойств(НовСтр, Стр);
								
								НовСтр.НачПериода = Макс(Стр.НачПериода, СтрБригада.НачПериода);
								НовСтр.КонПериода = Мин(Стр.КонПериода, СтрБригада.КонПериода);
								
								НовСтр.ДнейВПериоде = Окр((НовСтр.КонПериода - НовСтр.НачПериода) / 86400);
							КонецЕсли;
						КонецЦикла;
						
					КонецЦикла;
					ТЗПериодыРаботы = ТЗПериодыПересечения;
				КонецЕсли;
				
			КонецЕсли;
			//Аверсон СВФР-008818
			
			//Аверсон ЕАЕ 16.07.2025 СВФР-016262
			//Белвторчермет
			//Посчитаем количество отработанных часов
			Если Организация.ИНН = "100071565" Тогда
				ТЗПериодыРаботы.Колонки.Добавить("ОтработаноЧасовВПериоде", ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(5,2));
				Для Каждого Стр Из Исполнители Цикл
					Для н = 1 По КоличествоДнейВПериодеРегистрации Цикл
						ТекДата = Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), н);
						
						СтруктураСотрудник = Новый Структура;
						СтруктураСотрудник.Вставить("Сотрудник", Стр.Сотрудник);
						НужныеСтрокиПоСотруднику = ТЗПериодыРаботы.НайтиСтроки(СтруктураСотрудник);
						Для Каждого Эл Из НужныеСтрокиПоСотруднику Цикл
							Если ТекДата >= Эл.НачПериода И ТекДата <= Эл.КонПериода Тогда
								НужнаяСтр = Эл;
								Прервать;
							КонецЕсли;
						КонецЦикла;
						
						Для НомерПриставки = 1 По 3 Цикл
							Если НомерПриставки = 1 Тогда
								Приставка = "Первый";
							ИначеЕсли НомерПриставки = 2 Тогда
								Приставка = "Второй";
							ИначеЕсли НомерПриставки = 3 Тогда
								Приставка = "Третий";
							КонецЕсли;
							ИмяКолонки = Приставка + "Часов" + СокрЛП(н);
							ЗначениеВКолонке = Стр[ИмяКолонки];
							Если ЗначениеЗаполнено(ЗначениеВКолонке) Тогда
								НужнаяСтр.ОтработаноЧасовВПериоде = НужнаяСтр.ОтработаноЧасовВПериоде + ЗначениеВКолонке;	
							КонецЕсли;
						КонецЦикла;
					КонецЦикла;
				КонецЦикла;
			КонецЕсли;
			//Аверсон СВФР-016262
			
			Для Каждого ТекСтрокаИсполнители Из Исполнители  Цикл
				
				//Аверсон ЕАЕ 05.03.2022 СВФР-008818
				Если Организация.ИНН = "100071565" Тогда //Белвторчермет
					ОсталосьРаспределить = ТекСтрокаИсполнители.СуммаКНачислениюРегл;
					СтруктураОтбора = Новый Структура;
					СтруктураОтбора.Вставить("Сотрудник", ТекСтрокаИсполнители.Сотрудник);
					СтрокиПоСотруднику = ТЗПериодыРаботы.НайтиСтроки(СтруктураОтбора);
					ИтогДней = 0;
					
					//Аверсон ЕАЕ 16.07.2025 СВФР-016262
					ИтогЧасов = 0;
					//Аверсон СВФР-016262
					
					Для Каждого Стр Из СтрокиПоСотруднику Цикл
						ИтогДней = ИтогДней + Стр.ДнейВПериоде;
						
						//Аверсон ЕАЕ 16.07.2025 СВФР-016262
						ИтогЧасов = ИтогЧасов + Стр.ОтработаноЧасовВПериоде;
						//Аверсон СВФР-016262
						
					КонецЦикла;
					
					н = 0;
					Для Каждого Стр Из СтрокиПоСотруднику Цикл
						н = н + 1;
						НоваяСтрока = НаборДвижений.Добавить();
						НоваяСтрока.Сотрудник			= ТекСтрокаИсполнители.Сотрудник;
						НоваяСтрока.Организация			= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
						НоваяСтрока.Период              = Стр.НачПериода;
						НоваяСтрока.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод;
						
						Если н = СтрокиПоСотруднику.Количество() Тогда
							Распределяем = ОсталосьРаспределить;
						Иначе
							
							//Аверсон ЕАЕ 16.07.2025 СВФР-016262
							//Если ИтогДней = 0 Тогда
							//	Распределяем = 0;
							//Иначе
							//	Распределяем = Окр(ТекСтрокаИсполнители.СуммаКНачислениюРегл / ИтогДней * Стр.ДнейВПериоде, 2);
							//КонецЕсли;
							Если ИтогЧасов = 0 Тогда
								Распределяем = 0;
							Иначе
								Распределяем = Окр(ТекСтрокаИсполнители.СуммаКНачислениюРегл / ИтогЧасов * Стр.ОтработаноЧасовВПериоде, 2);
							КонецЕсли;
							//Аверсон СВФР-016262

						КонецЕсли;
						
						НоваяСтрока.Выработка			= Распределяем;
						
						ОсталосьРаспределить = ОсталосьРаспределить - Распределяем;
					КонецЦикла;
				Иначе
					//Аверсон СВФР-008818
					
					НоваяСтрока = НаборДвижений.Добавить();
					НоваяСтрока.Сотрудник			= ТекСтрокаИсполнители.Сотрудник;
					НоваяСтрока.Организация			= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
					НоваяСтрока.Выработка			= ТекСтрокаИсполнители.СуммаКНачислениюРегл;
					
					//Аверсон ЕАЕ 30.04.2021 СВФР-007529
					//НоваяСтрока.Период			= ВыборкаПоШапкеДокумента.ПериодРегистрации;
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//НоваяСтрока.Период              = ОпределитьПериод(ТекСтрокаИсполнители, ВыборкаПоШапкеДокумента.ПериодРегистрации);
					НоваяСтрока.Период              = ОпределитьПериод(ТекСтрокаИсполнители, ПериодРегистрации1);
					//Аверсон СВФР-007772
					
					//Аверсон СВФР-007529
					
					НоваяСтрока.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод
				КонецЕсли;
			КонецЦикла;
		Иначе
			
			//Аверсон 21.11.2022 КВВ СВФР-009875 (
			Если НЕ РаспределениеИтогом 
				И НЕ ВыборкаПоШапкеДокумента.ГоловнаяОрганизация.ИНН = "700067572"
				И ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням 
				И ВыборкаПоШапкеДокумента.УчитыватьОтработанноеВремя Тогда
				СтруктураШапкиДокумента_ = ОбщегоНазначения.СформироватьСтруктуруШапкиДокумента(ЭтотОбъект);
				ТЗЗ_ = СформироватьЗапросПоИсполнителиРегл(СтруктураШапкиДокумента_).Выгрузить();
				ТЗЗ_Коп = Новый ТаблицаЗначений;
				ТЗЗ_Коп = ТЗЗ_.Скопировать();
				ТЗЗ_.Свернуть("Сотрудник,СуммаКНачислению","");
				Для Каждого СтрТЗЗ_ ИЗ ТЗЗ_ Цикл
					Если СтрТЗЗ_.СуммаКНачислению <> 0 Тогда
						МассивКоэффициентов = Новый Массив(КоличествоДнейВПериодеРегистрации);
						Отбор_ = Новый Структура;
						Отбор_.Вставить("Сотрудник", СтрТЗЗ_.Сотрудник);
						Отбор_.Вставить("СуммаКНачислению", СтрТЗЗ_.СуммаКНачислению);
						Строки_ = ТЗЗ_Коп.НайтиСтроки(Отбор_);					
						Для Каждого Стр_ Из Строки_ Цикл
							Если МассивКоэффициентов[Стр_.ИндексДня - 1] = 0 ИЛИ МассивКоэффициентов[Стр_.ИндексДня - 1] = Неопределено Тогда //СВЭЙ 05.03.2024 КВВ СВФР-012564
								МассивКоэффициентов[Стр_.ИндексДня - 1] = ?(Стр_.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Работа ИЛИ Стр_.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт, Стр_.Часов, 0);
							КонецЕсли;
						КонецЦикла;
						
						мСумма = СтрТЗЗ_.СуммаКНачислению;
						МассивРаспределенияНачисленнойСуммыПоДням = ОбщегоНазначения.РаспределитьПропорционально(мСумма, МассивКоэффициентов,,ПериодРегистрации1);//О.Т. Аверсон 15.03.2016 № 949
						
						Для ИндексДня = 1 По КоличествоДнейВПериодеРегистрации Цикл
							Если МассивРаспределенияНачисленнойСуммыПоДням[ИндексДня-1] <> 0 Тогда
								НоваяСтрока = НаборДвижений.Добавить();
								НоваяСтрока.Сотрудник			= СтрТЗЗ_.Сотрудник;
								НоваяСтрока.Организация			= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
								НоваяСтрока.СпособВводаДанных	= ВыборкаПоШапкеДокумента.СпособВводаДанных;
								НоваяСтрока.Период				= Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), ИндексДня);
								НоваяСтрока.Выработка			= МассивРаспределенияНачисленнойСуммыПоДням[ИндексДня-1];
							КонецЕсли;
						КонецЦикла;	
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;	
			//Аверсон 21.11.2022 КВВ СВФР-009875 )
			
			
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
			//Пока ВыборкаПоРаботники.СледующийПоЗначениюПоля("Сотрудник") Цикл
			//- СВЭЙ КДЯ 08.10.19 СВФР-004843
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
			Пока ВыборкаПоРаботники.Следующий() Цикл
				//- СВЭЙ КДЯ 08.10.19 СВФР-004843
				
				Если ВыборкаПоРаботники.СуммаКНачислению <> 0 Тогда
					Если ВыборкаПоШапкеДокумента.ГоловнаяОрганизация.ИНН = "700067572" Тогда
					ИначеЕсли ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням 
						И ВыборкаПоШапкеДокумента.УчитыватьОтработанноеВремя Тогда
						
						Если РаспределениеИтогом Тогда //Аверсон 21.11.2022 КВВ СВФР-009875
							
							Пока ВыборкаПоРаботники.СледующийПоЗначениюПоля("ИндексДня") Цикл
								МассивКоэффициентов[ВыборкаПоРаботники.ИндексДня - 1] = ВычислитьКоличествоЧасовЗаДень(ВыборкаПоРаботники);
							КонецЦикла; 
							
							//толик сума за день по несеольким строкам при дублировании сотрудника
							мСумма = 0;
							
							//Аверсон ЕАЕ 16.09.2021 СВФР-008068
							Если РаспределениеИтогом Тогда
								ТЧИсполнители = ИсполнителиНесколькоВидовРабот;
							Иначе
								ТЧИсполнители = Исполнители;
							КонецЕсли;
							//Аверсон СВФР-008068
							
							//Аверсон ЕАЕ 16.09.2021 СВФР-008068
							//Для Каждого мСтрока Из Исполнители.НайтиСтроки(Новый Структура("Сотрудник", ВыборкаПоРаботники.Сотрудник)) Цикл
							Для Каждого мСтрока Из ТЧИсполнители.НайтиСтроки(Новый Структура("Сотрудник", ВыборкаПоРаботники.Сотрудник)) Цикл
								//Аверсон СВФР-008068
								мСумма = мСумма + мСтрока.СуммаКНачислениюРегл;
							КонецЦикла;
							//					МассивРаспределенияНачисленнойСуммыПоДням = ОбщегоНазначения.РаспределитьПропорционально(ВыборкаПоРаботники.СуммаКНачислению, МассивКоэффициентов);
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//МассивРаспределенияНачисленнойСуммыПоДням = ОбщегоНазначения.РаспределитьПропорционально(мСумма, МассивКоэффициентов,,ВыборкаПоШапкеДокумента.ПериодРегистрации);//О.Т. Аверсон 15.03.2016 № 949
							МассивРаспределенияНачисленнойСуммыПоДням = ОбщегоНазначения.РаспределитьПропорционально(мСумма, МассивКоэффициентов,,ПериодРегистрации1);//О.Т. Аверсон 15.03.2016 № 949
							//Аверсон СВФР-007772
							
							Для ИндексДня = 1 По КоличествоДнейВПериодеРегистрации Цикл
								Если МассивРаспределенияНачисленнойСуммыПоДням[ИндексДня-1] <> 0 Тогда
									НоваяСтрока = НаборДвижений.Добавить();
									НоваяСтрока.Сотрудник			= ВыборкаПоРаботники.Сотрудник;
									НоваяСтрока.Организация			= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
									НоваяСтрока.СпособВводаДанных	= ВыборкаПоШапкеДокумента.СпособВводаДанных;
									
									//Аверсон ЕАЕ 23.07.2021 СВФР-007772
									//НоваяСтрока.Период				= Дата(Год(ВыборкаПоШапкеДокумента.ПериодРегистрации), Месяц(ВыборкаПоШапкеДокумента.ПериодРегистрации), ИндексДня);
									НоваяСтрока.Период				= Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), ИндексДня);
									//Аверсон СВФР-007772
									
									НоваяСтрока.Выработка			= МассивРаспределенияНачисленнойСуммыПоДням[ИндексДня-1];
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
					Иначе
						
						НоваяСтрока = НаборДвижений.Добавить();
						НоваяСтрока.Сотрудник			= ВыборкаПоРаботники.Сотрудник;
						НоваяСтрока.Организация			= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
						НоваяСтрока.Выработка			= ВыборкаПоРаботники.СуммаКНачислению;
						
						Если ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//НоваяСтрока.Период			= ВыборкаПоШапкеДокумента.ДатаНачалаПериода;
							
							//Аверсон ЕАЕ 24.04.2022 СВФР-008978
							//НоваяСтрока.Период			= ДатаНачалаПериода1;
							НоваяСтрока.Период			= Макс(ДатаНачалаПериода1, ВыборкаПоРаботники.ДатаПриема);
							//Аверсон СВФР-008978
							
							//Аверсон СВФР-007772
							
						Иначе
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//НоваяСтрока.Период			= ВыборкаПоШапкеДокумента.ПериодРегистрации;
							
							//Аверсон ЕАЕ 24.04.2022 СВФР-008978
							//НоваяСтрока.Период			= ПериодРегистрации1;
							НоваяСтрока.Период			= Макс(ПериодРегистрации1, ВыборкаПоРаботники.ДатаПриема);
							//Аверсон СВФР-008978
							
							//Аверсон СВФР-007772
							
						КонецЕсли;
						
						Если НЕ ВыборкаПоШапкеДокумента.УчитыватьОтработанноеВремя 
							И ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням Тогда
							НоваяСтрока.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод	
						Иначе
							НоваяСтрока.СпособВводаДанных	= ВыборкаПоШапкеДокумента.СпособВводаДанных;
						КонецЕсли;  						
					КонецЕсли;      					
				КонецЕсли;          				
			КонецЦикла;
		КонецЕсли;
	КонецЕсли;                      	
КонецПроцедуры // ДвиженияФактическойВыработкиРегл()

//Аверсон ЕАЕ 30.04.2021 СВФР-007529
Функция ОпределитьПериод(Стр, ПериодРег)
	ПериодВРегистр = '00010101';
	
	МесяцПериода = Месяц(ПериодРег);
	ГодПериода = Год(ПериодРег);
	
	Для н = 1 по 31 Цикл
		ИмяКолонкиЧасов1 = "ПервыйЧасов" + СокрЛП(н);
		ИмяКолонкиЧасов2 = "ВторойЧасов" + СокрЛП(н);
		ИмяКолонкиЧасов3 = "ТретийЧасов" + СокрЛП(н);
		
		ЗначениеКолонкиЧасов1 = Стр[ИмяКолонкиЧасов1];
		ЗначениеКолонкиЧасов2 = Стр[ИмяКолонкиЧасов2];
		ЗначениеКолонкиЧасов3 = Стр[ИмяКолонкиЧасов3];
		
		ИмяКолонкиВидВремени1 = "ПервыйВидВремени" + СокрЛП(н);
		ИмяКолонкиВидВремени2 = "ВторойВидВремени" + СокрЛП(н);
		ИмяКолонкиВидВремени3 = "ТретийВидВремени" + СокрЛП(н);
		
		ЗначениеКолонкиВидВремени1 = Стр[ИмяКолонкиВидВремени1];
		ЗначениеКолонкиВидВремени2 = Стр[ИмяКолонкиВидВремени2];
		ЗначениеКолонкиВидВремени3 = Стр[ИмяКолонкиВидВремени3];
		
		Если (ЗначениеКолонкиЧасов1 > 0 И ЗначениеЗаполнено(ЗначениеКолонкиВидВремени1) И ЗначениеКолонкиВидВремени1.РабочееВремя = Истина) 
			ИЛИ (ЗначениеКолонкиЧасов2 > 0 И ЗначениеЗаполнено(ЗначениеКолонкиВидВремени2) И ЗначениеКолонкиВидВремени2.РабочееВремя = Истина)
			ИЛИ (ЗначениеКолонкиЧасов3 > 0 И ЗначениеЗаполнено(ЗначениеКолонкиВидВремени3) И ЗначениеКолонкиВидВремени3.РабочееВремя = Истина) Тогда
			ПериодВРегистр = Дата(ГодПериода, МесяцПериода, н);
			Прервать;
		КонецЕсли;
	КонецЦикла;
	
	Если Не ЗначениеЗаполнено(ПериодВРегистр) Тогда
		ПериодВРегистр = ПериодРег;	
	КонецЕсли;
	
	//Аверсон ЕАЕ 28.01.2022 СВФР-008670
	//определим дату назначения в бригаду
	ДатаНазначенияВБригаду = ПолучитьДатуНазначенияВБригаду(Стр.Сотрудник, ПериодВРегистр);
	Если ЗначениеЗаполнено(ДатаНазначенияВБригаду) И ДатаНазначенияВБригаду < ПериодВРегистр Тогда //Аверсон ЕАЕ 24.05.2024 СВФР-012937
		//если дата назначения в бригаду меньше начала месяца,
		//заполним начало месяца
		Если ДатаНазначенияВБригаду < ПериодРег Тогда
			ПериодВРегистр = ПериодРег;
		Иначе
			ПериодВРегистр = ДатаНазначенияВБригаду;
		КонецЕсли;
	КонецЕсли;
	//Аверсон СВФР-008670
	
	Возврат ПериодВРегистр;
КонецФункции
//Аверсон СВФР-007529

//Аверсон ЕАЕ 28.01.2022
Функция ПолучитьДатуНазначенияВБригаду(Сотр, Период)
	Дат = '00010101';
	Запрос = Новый Запрос;
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	НазначениеСотрудниковПоБригадамСрезПоследних.Период КАК Период
	|ИЗ
	|	РегистрСведений.НазначениеСотрудниковПоБригадам.СрезПоследних(&НаДату, Сотрудник = &Сотрудник %УсловиеПоБригаде%) КАК НазначениеСотрудниковПоБригадамСрезПоследних
	|";
	Если ЗначениеЗаполнено(Бригада) Тогда
		Текст = СтрЗаменить(Текст, "%УсловиеПоБригаде%", "И Бригада = &Бригада");
		Запрос.УстановитьПараметр("Бригада", Бригада);
	Иначе
		Текст = СтрЗаменить(Текст, "%УсловиеПоБригаде%", "");
	КонецЕсли;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("Сотрудник", Сотр);
	Запрос.УстановитьПараметр("НаДату", Период);
	Результат = Запрос.Выполнить();
	Если Не Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Если Выборка.Следующий() Тогда
			Дат = Выборка.Период;
		КонецЕсли;
	КонецЕсли;
	Возврат Дат;
КонецФункции	
//Аверсон 

Процедура ДвиженияРегистровБУиНУРегл(ВыборкаПоШапкеДокумента, ВыборкаПоРаботники, ТаблицаРабот)
	
	
	//толик убрал проведения по бу для сдельного наряда
	
	
	//	Если ВыборкаПоШапкеДокумента.ОтражатьВБухгалтерскомУчете Тогда
	//		
	//		ВыборкаПоНачислениям = СформироватьЗапросПоНачислениям();
	//		
	//		СчетУчетаРасчетовСРаботниками = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналомПоОплатеТруда;
	//		СчетУчетаРасчетовСРаботникамиНУ = ПланыСчетов.Налоговый.РасчетыСПерсоналомПоОплатеТруда;
	//		МассивСуммЗаРаботы = ТаблицаРабот.ВыгрузитьКолонку("СуммаЗаРаботу");
	//		ОстатокСуммЗаРаботы = ТаблицаРабот.ВыгрузитьКолонку("СуммаЗаРаботу");
	//		
	//		ВыборкаПоРаботники.Сбросить();
	//		Работников = ВыборкаПоРаботники.Количество();
	//		
	//		Сч = 0;
	//		Пока ВыборкаПоРаботники.СледующийПоЗначениюПоля("Сотрудник") Цикл
	//			Сч = Сч + 1;
	//			Если ВыборкаПоРаботники.СуммаКНачислению <> 0 Тогда
	//				
	//				МассивСуммКНачислению = ОбщегоНазначения.РаспределитьПропорционально(ВыборкаПоРаботники.СуммаКНачислению,МассивСуммЗаРаботы);
	//				
	//				Для каждого СтрокаТЗ Из ТаблицаРабот Цикл
	//					
	//					НомерУчета = ТаблицаРабот.Индекс(СтрокаТЗ);
	//					Если Сч = Работников Тогда
	//						Результат = ОстатокСуммЗаРаботы[НомерУчета];
	//					Иначе
	//						Результат = Мин(МассивСуммКНачислению[НомерУчета],ОстатокСуммЗаРаботы[НомерУчета]);
	//						ОстатокСуммЗаРаботы[НомерУчета] = ОстатокСуммЗаРаботы[НомерУчета] - Результат;
	//					КонецЕсли;
	//					
	//					СтрокаНабора = Движения.БУОсновныеНачисления.Добавить();
	//					
	//					// свойства
	//					СтрокаНабора.ПериодРегистрации			= ВыборкаПоШапкеДокумента.ПериодРегистрации;
	//					Если ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
	//						СтрокаНабора.ПериодДействияНачало	= ВыборкаПоШапкеДокумента.ДатаНачалаПериода;
	//						СтрокаНабора.ПериодДействияКонец	= КонецДня(ВыборкаПоШапкеДокумента.ДатаНачалаПериода);
	//					Иначе //За весь месяц - ВЦелом и ПоДням и без регистрации времени 
	//						ПериодДействияНачало = ВыборкаПоШапкеДокумента.ПериодРегистрации;
	//						ПериодДействияКонец  = КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации);
	//						ВычислитьДатуНачалаИОкончания(ПериодДействияНачало, ПериодДействияКонец, ВыборкаПоНачислениям, ВыборкаПоРаботники.Сотрудник);
	////толик проверка даты на корректность
	//						Если НЕ (ПериодДействияНачало <= КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации) И ПериодДействияНачало >= ВыборкаПоШапкеДокумента.ПериодРегистрации) Тогда
	//							Сообщить("Дата регистрации выходит за пределы период по сотруднику "+ВыборкаПоРаботники.Сотрудник + " " + Строка(ПериодДействияНачало));
	//						КонецЕсли;
	//						Если НЕ (ПериодДействияКонец <= КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации) И ПериодДействияКонец >= ВыборкаПоШапкеДокумента.ПериодРегистрации) Тогда
	//							Сообщить("Дата регистрации выходит за пределы период по сотруднику "+ВыборкаПоРаботники.Сотрудник + " " + Строка(ПериодДействияКонец));
	//						КонецЕсли;
	//						
	//						СтрокаНабора.ПериодДействияНачало	= ПериодДействияНачало;
	//						СтрокаНабора.ПериодДействияКонец	= ПериодДействияКонец;
	//					КонецЕсли;
	//					СтрокаНабора.ВидРасчета					= ВыборкаПоРаботники.ВидРасчета;
	//					
	//					// Измерения
	//					СтрокаНабора.Сотрудник					= ВыборкаПоРаботники.Сотрудник;
	//					СтрокаНабора.Физлицо					= ВыборкаПоРаботники.Физлицо;
	//					СтрокаНабора.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
	//					
	//					// ресурсы
	//					СтрокаНабора.Результат					= Результат;
	//					
	//					// реквизиты
	//					СтрокаНабора.ГрафикРаботы				= ПолучитьГрафикСотрудникаНаДату(ВыборкаПоРаботники.Сотрудник, СтрокаНабора.ПериодДействияНачало);
	//					СтрокаНабора.ВидУчетаВремени			= Перечисления.ВидыУчетаВремени.ПоЧасам;
	//					СтрокаНабора.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.Организация;
	//					
	//					// данные бухучета
	//					СтрокаНабора.СчетДт						= СтрокаТЗ.СчетЗатрат;
	//					СтрокаНабора.СчетКт						= СчетУчетаРасчетовСРаботниками;
	//					
	//					// субконто
	//					Для СчСк = 1 По 3 Цикл
	//						
	//						ВидыСубконтоСк = СтрокаТЗ["ВидСубконто" + СчСк];
	//						
	//						Если ВидыСубконтоСк = NULL Тогда
	//							
	//						ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Номенклатура Тогда
	//							СтрокаНабора["СубконтоДт" + СчСк] = СтрокаТЗ.Продукция;
	//						ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
	//							СтрокаНабора["СубконтоДт" + СчСк] = СтрокаТЗ.СтатьяЗатрат;
	//						ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
	//							СтрокаНабора["СубконтоДт" + СчСк] = СтрокаТЗ.НоменклатурнаяГруппа;
	//						ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
	//							СтрокаНабора["СубконтоДт" + СчСк] = ВыборкаПоШапкеДокумента.ПодразделениеОрганизации;
	////толик
	//						ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.РаботникиОрганизации Тогда
	//							СтрокаНабора["СубконтоДт" + СчСк] = ВыборкаПоРаботники.Физлицо;
	////
	//						ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбъектыСтроительства Тогда
	//							СтрокаНабора["СубконтоДт" + СчСк] = СтрокаТЗ.ОбъектСтроительства;
	//							СтрокаНабора["СубконтоДт" + (СчСк + 1)] = Перечисления.СпособыСтроительства.Хозспособ;
	//						КонецЕсли;
	//						
	//					КонецЦикла;
	//					
	//					СтрокаНабора.СубконтоКт1 = ВыборкаПоРаботники.Физлицо;
	//					
	//					// данные налоговых учетов (Налог на прибыль, УСН)
	//					Если мУчетнаяПолитикаУСН Тогда
	//						СтрокаНабора.ОтражениеВУСН = СтрокаТЗ.ОтражениеВУСН;
	//					ИначеЕсли Не СтрокаТЗ.ОблагаетсяЕНВД Тогда
	//						
	//						СтрокаНабора.СчетДтНУ = СтрокаТЗ.СчетЗатратНУ;
	//						СтрокаНабора.СчетКтНУ = СчетУчетаРасчетовСРаботникамиНУ;
	//						
	//						// субконто
	//						Для СчСк = 1 По 3 Цикл
	//							
	//							ВидыСубконтоСк = СтрокаТЗ["ВидСубконтоНУ" + СчСк];
	//							
	//							Если ВидыСубконтоСк = NULL Тогда
	//								
	//							ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Номенклатура Тогда
	//								СтрокаНабора["СубконтоДтНУ" + СчСк] = СтрокаТЗ.Продукция;
	//							ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
	//								СтрокаНабора["СубконтоДтНУ" + СчСк] = СтрокаТЗ.СтатьяЗатрат;
	//							ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы Тогда
	//								СтрокаНабора["СубконтоДтНУ" + СчСк] = СтрокаТЗ.НоменклатурнаяГруппа;
	//							ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Подразделения Тогда
	//								СтрокаНабора["СубконтоДтНУ" + СчСк] = ВыборкаПоШапкеДокумента.ПодразделениеОрганизации;
	//							ИначеЕсли ВидыСубконтоСк = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбъектыСтроительства Тогда
	//								СтрокаНабора["СубконтоДтНУ" + СчСк] = СтрокаТЗ.ОбъектСтроительства;
	//								СтрокаНабора["СубконтоДтНУ" + (СчСк + 1)] = Перечисления.СпособыСтроительства.Хозспособ;
	//							КонецЕсли;
	//							
	//						КонецЦикла;
	//						
	//						СтрокаНабора.СубконтоКтНУ1 = ВыборкаПоРаботники.Физлицо;
	//						СтрокаНабора.СубконтоКтНУ2 = ВыборкаПоРаботники.ВидНачисленияНУ;
	//						
	//					КонецЕсли;
	//					
	//					// данные учета для целей исчисления ЕСН
	//					
	//					//СтрокаНабора = Движения.ЕСНОсновныеНачисления.Добавить(); // будут использоваться при учете зависимых начислений
	//					//
	//					//// свойства
	//					//СтрокаНабора.ПериодРегистрации		= ВыборкаПоШапкеДокумента.ПериодРегистрации;
	//					//Если ВыборкаПоШапкеДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
	//					//	СтрокаНабора.ПериодДействияНачало	= ВыборкаПоШапкеДокумента.ДатаНачалаПериода;
	//					//	СтрокаНабора.ПериодДействияКонец	= КонецДня(ВыборкаПоШапкеДокумента.ДатаНачалаПериода);
	//					//Иначе //За весь месяц - ВЦелом и ПоДням и без регистрации времени 
	//					//	ПериодДействияНачало = ВыборкаПоШапкеДокумента.ПериодРегистрации;
	//					//	ПериодДействияКонец  = КонецМесяца(ВыборкаПоШапкеДокумента.ПериодРегистрации);
	//					//	ВычислитьДатуНачалаИОкончания(ПериодДействияНачало, ПериодДействияКонец, ВыборкаПоНачислениям, ВыборкаПоРаботники.Сотрудник);
	//					//	СтрокаНабора.ПериодДействияНачало	= ПериодДействияНачало;
	//					//	СтрокаНабора.ПериодДействияКонец	= ПериодДействияКонец;
	//					//КонецЕсли;
	//					//СтрокаНабора.ВидРасчета					= ВыборкаПоРаботники.ВидРасчета;
	//					//
	//					//// Измерения
	//					//СтрокаНабора.Сотрудник					= ВыборкаПоРаботники.Сотрудник;
	//					//СтрокаНабора.Физлицо					= ВыборкаПоРаботники.Физлицо;
	//					//СтрокаНабора.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
	//					//
	//					//// ресурсы
	//					//СтрокаНабора.Результат					= Результат;
	//					//
	//					//// реквизиты
	//					//СтрокаНабора.ГрафикРаботы				= ПолучитьГрафикСотрудникаНаДату(ВыборкаПоРаботники.Сотрудник, СтрокаНабора.ПериодДействияНачало);
	//					//СтрокаНабора.ВидУчетаВремени			= Перечисления.ВидыУчетаВремени.ПоЧасам;
	//					//СтрокаНабора.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.Организация;
	//					//СтрокаНабора.КодДоходаЕСН				= ВыборкаПоРаботники.КодПоЕСН;
	//					////СтрокаНабора.ОблагаетсяЕНВД				= СтрокаТЗ.ОблагаетсяЕНВД;
	//					//
	//					//// сведения о доходах для целей исчисления ЕСН
	//					//СтрокаНабора = Движения.ЕСНСведенияОДоходах.Добавить();
	//					//
	//					//// свойства
	//					//СтрокаНабора.Период						= ВыборкаПоШапкеДокумента.ПериодРегистрации;
	//					//
	//					//// Измерения
	//					//СтрокаНабора.Физлицо					= ВыборкаПоРаботники.Физлицо;
	//					//СтрокаНабора.Организация				= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
	//					//
	//					//// ресурсы
	//					//СтрокаНабора.Результат					= Результат;
	//					//
	//					//// реквизиты
	//					//СтрокаНабора.КодДоходаЕСН				= ВыборкаПоРаботники.КодПоЕСН;
	//					////СтрокаНабора.ОблагаетсяЕНВД				= СтрокаТЗ.ОблагаетсяЕНВД;
	//					//СтрокаНабора.ОбособленноеПодразделение	= ВыборкаПоШапкеДокумента.Организация;
	//					
	//				КонецЦикла;
	//				
	//			КонецЕсли;
	//		КонецЦикла;
	//	КонецЕсли;
	
КонецПроцедуры // ДвиженияРегистровБУиНУРегл()

// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры:
//	ВыборкаПоСтрокамДокумента				- спозиционированная на определеной строке выборка 
//											  из результата запроса к ТЧ документа, 
//	НаборЗаписей							- набор записей для РабочееВремяРаботниковОрганизаций 
//
// Возвращаемое значение:
//	Нет.
//
Процедура ДобавитьСтрокуРабочееВремяРаботниковОрганизацийПоДням(ВыборкаПоШапкеДокумента, ВыборкаПоОтработанноеВремя, НаборЗаписей)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.МесяцНачислений) Тогда
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ВыборкаПоШапкеДокумента.ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//ОбрабатываемаяДата = Дата(Год(ВыборкаПоШапкеДокумента.ПериодРегистрации), Месяц(ВыборкаПоШапкеДокумента.ПериодРегистрации), ВыборкаПоОтработанноеВремя.ИндексДня);
	ОбрабатываемаяДата = Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), ВыборкаПоОтработанноеВремя.ИндексДня);
	//Аверсон СВФР-007772
	
	СуммаВремениЗаВесьДень = ВыборкаПоОтработанноеВремя.Часов;
	
	Если ВыборкаПоОтработанноеВремя.ВидВремени  <> Справочники.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка() Тогда
		
		Движение = НаборЗаписей.Добавить();
		// Свойства
		Движение.Период								= ОбрабатываемаяДата;
		//О.Т. Аверсон 14.12.2016 № 100
		Движение.ДатаНачала = НачалоДня(Движение.Период);
		Движение.ДатаОкончания = КонецДня(Движение.Период);
		//О.Т. Аверсон 14.12.2016 № 100
		
		
		// Измерения
		Движение.Сотрудник							= ВыборкаПоОтработанноеВремя.Сотрудник;
		Если ОтражатьВБухгалтерскомУчете Тогда
			Движение.Организация					= ВыборкаПоШапкеДокумента.ГоловнаяОрганизация;
		КонецЕсли;
		Движение.ВидИспользованияРабочегоВремени	= ВыборкаПоОтработанноеВремя.ВидВремени;
		Движение.Тариф                              = ВыборкаПоОтработанноеВремя.Тариф;
		Движение.КТУ                                = ВыборкаПоОтработанноеВремя.КТУ;
		
		// Ресурсы
		Если ВыборкаПоОтработанноеВремя.ВидВремени.УчитыватьТолькоДни Тогда
			Движение.Дней = ?(ВыборкаПоОтработанноеВремя.Часов=0, 1, СуммаВремениЗаВесьДень);
		Иначе
			Движение.Дней								= ?(ВыборкаПоОтработанноеВремя.ВидВремени = КлассификаторЯвка, 1, 0);
			Движение.Часов								= СуммаВремениЗаВесьДень;
		КонецЕсли;
		
		//Аверсон ЕАЕ 07.06.2024 СВФР-012937
		//Бобруйсксельмаш
		Если Организация.ИНН = "790056159" Тогда
			Если Сверхурочно И Движение.ВидИспользованияРабочегоВремени = КлассификаторЯвка Тогда
				Движение.Дней = 0;		
			КонецЕсли;
		КонецЕсли;
		//Аверсон СВФР-012937
		
		// Реквизиты
		Движение.ВЦеломЗаПериод						= Ложь;
		
	КонецЕсли;
	
КонецПроцедуры // ДобавитьСтрокуРабочееВремяРаботниковОрганизацийПоДням()

// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры:
//	ВыборкаПоСтрокамДокумента				- спозиционированная на определеной строке выборка 
//											  из результата запроса к ТЧ документа, 
//	НаборЗаписей							- набор записей для РабочееВремяРаботниковОрганизаций 
//
// Возвращаемое значение:
//	Нет.
//
Процедура ДобавитьСтрокуГрафикиРаботыПоВидамВремениЧасы(ВыборкаПоОтработанноеВремя, НаборЗаписей)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//ОбрабатываемаяДата = Дата(Год(ПериодРегистрации), Месяц(ПериодРегистрации), ВыборкаПоОтработанноеВремя.ИндексДня);
	ОбрабатываемаяДата = Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), ВыборкаПоОтработанноеВремя.ИндексДня);
	//Аверсон СВФР-007772
	
	ВидУчетаВремени = ПолучитьВидУчетаВремениПоКлассификатору(ВыборкаПоОтработанноеВремя.ВидВремени);
	
	Если ВыборкаПоОтработанноеВремя.ВидВремени = КлассификаторВечерниеЧасы Тогда
		СтруктураПоиска.Вставить("ВидУчетаВремени", ВидУчетаВремениПоВечернимЧасам);
	ИначеЕсли ВыборкаПоОтработанноеВремя.ВидВремени = КлассификаторНочныеЧасы Тогда
		СтруктураПоиска.Вставить("ВидУчетаВремени", ВидУчетаВремениПоНочнымЧасам);
	Иначе
		СтруктураПоиска.Вставить("ВидУчетаВремени", ВидУчетаВремениПоЧасам);
	КонецЕсли;
	СтруктураПоиска.Вставить("Дата", ОбрабатываемаяДата);
	
	МассивСтрок = НаборЗаписей.НайтиСтроки(СтруктураПоиска);
	Если МассивСтрок.Количество() > 0 Тогда
		Движение = МассивСтрок[0];
	Иначе
		
		Движение = НаборЗаписей.Добавить();
		Движение.ГрафикРаботы = ?(ОтражатьВБухгалтерскомУчете,ВыборкаПоОтработанноеВремя.Сотрудник,ВыборкаПоОтработанноеВремя.Физлицо);
		Движение.ВидУчетаВремени = ВидУчетаВремени;
		Движение.Дата = ОбрабатываемаяДата;
		Движение.План = Ложь;
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//Движение.Месяц = ПериодРегистрации;
		Движение.Месяц = ПериодРегистрации1;
		//Аверсон СВФР-007772
		
	КонецЕсли;
	
	// Ресурсы
	Движение.ОсновноеЗначениеПолное = Движение.ОсновноеЗначениеПолное + ВыборкаПоОтработанноеВремя.Часов;
	Движение.ДополнительноеЗначениеПолное = ?((Движение.ДополнительноеЗначениеПолное > 0) ИЛИ (ВыборкаПоОтработанноеВремя.Часов > 0), 1, 0);
	
	// Реквизиты
	Движение.Документ				= Ссылка;
	
КонецПроцедуры // ДобавитьСтрокуГрафикиРаботыПоВидамВремениЧасы()

// По строке выборок из результатов запроса по документу формируем движения по регистрам
//
// Параметры:
//	ВыборкаПоСтрокамДокумента				- спозиционированная на определеной строке выборка 
//											  из результата запроса к ТЧ документа, 
//	НаборЗаписей							- набор записей для РабочееВремяРаботниковОрганизаций 
//
// Возвращаемое значение:
//	Нет.
//
Процедура ДобавитьСтрокуГрафикиРаботыПоВидамВремениДни(ВыборкаПоОтработанноеВремя, НаборЗаписей)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//ОбрабатываемаяДата = Дата(Год(ПериодРегистрации), Месяц(ПериодРегистрации), ВыборкаПоОтработанноеВремя.ИндексДня);
	ОбрабатываемаяДата = Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), ВыборкаПоОтработанноеВремя.ИндексДня);
	//Аверсон СВФР-007772
	
	СтруктураПоиска.Вставить("ВидУчетаВремени", Перечисления.ВидыУчетаВремени.ПоДням);
	СтруктураПоиска.Вставить("Дата", ОбрабатываемаяДата);
	
	МассивСтрок = НаборЗаписей.НайтиСтроки(СтруктураПоиска);
	Если МассивСтрок.Количество() > 0 Тогда
		Движение = МассивСтрок[0];
	Иначе
		
		Движение = НаборЗаписей.Добавить();
		Движение.ГрафикРаботы = ?(ОтражатьВБухгалтерскомУчете,ВыборкаПоОтработанноеВремя.Сотрудник,ВыборкаПоОтработанноеВремя.Физлицо);
		Движение.ВидУчетаВремени = Перечисления.ВидыУчетаВремени.ПоДням;
		Движение.Дата = ОбрабатываемаяДата;
		Движение.План = Ложь;
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//Движение.Месяц = ПериодРегистрации;
		Движение.Месяц = ПериодРегистрации1;
		//Аверсон СВФР-007772
		
	КонецЕсли;
	
	// Ресурсы
	Если ВремяЯвки > 0 Тогда
		Движение.ОсновноеЗначениеПолное = ?(ВремяЯвки = 0, 0, 1);
		Движение.ДополнительноеЗначениеПолное = ВремяЯвки;
	Иначе
		Движение.ОсновноеЗначениеПолное = ?(ВыборкаПоОтработанноеВремя.Часов = 0, 0, 1);
		Движение.ДополнительноеЗначениеПолное = ВыборкаПоОтработанноеВремя.Часов;
	КонецЕсли;
	
	// Реквизиты
	Движение.Документ 				= Ссылка;
	
	
КонецПроцедуры // ДобавитьСтрокуГрафикиРаботыПоВидамВремениДни()

// Функция возвращает график работы  сотрудника, на указанную дату, 
// если сотрудник еще не работал на указанную дату, тогда возвращается ближайший график (срез первых)
Функция ПолучитьГрафикСотрудникаНаДату(Сотрудник, ДатаПолученияГрафика)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
	Запрос.УстановитьПараметр("Месяц", ДатаПолученияГрафика);
	Запрос.Текст = "ВЫБРАТЬ
	|	РаботникиОрганизацийСрезПоследних.ГрафикРаботы
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Месяц, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних
	|ГДЕ
	|	РаботникиОрганизацийСрезПоследних.ГрафикРаботы <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	РаботникиОрганизацийСрезПервых.ГрафикРаботы
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций.СрезПервых(&Месяц, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПервых
	|ГДЕ
	|	РаботникиОрганизацийСрезПервых.ГрафикРаботы <> ЗНАЧЕНИЕ(Справочник.ГрафикиРаботы.ПустаяСсылка)";
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		Возврат Выборка.ГрафикРаботы;
	КонецЕсли;
	Возврат Неопределено;
КонецФункции // ПолучитьГрафикСотрудникаНаДату(Сотрудник, ДатаПолученияГрафика()

// Процедура создает пустые записи в регистре за ПериодРегистрации, в разрезе сотрудников
// если это первый (единственный) документ за этот период, в разрезе сотрудников
Функция ПолучитьМассивСотрудниковДляСозданияПустыхЗаписей(ВыборкаПоШапкеДокумента)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Запрос = Новый Запрос;
	
	Если ВыборкаПоШапкеДокумента.ОтражатьВБухгалтерскомУчете Тогда
		УсловиеСотрудника = "";
	Иначе
		УсловиеСотрудника = ".ФизЛицо";
	КонецЕсли;
	
	Запрос.Текст = "ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СдельныйНарядИсполнители.Сотрудник" + УсловиеСотрудника + " КАК Сотрудник
	|ИЗ
	|	Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|		ПО ГрафикиРаботыПоВидамВремени.ГрафикРаботы = СдельныйНарядИсполнители.Сотрудник" + УсловиеСотрудника + "
	|			И (ГрафикиРаботыПоВидамВремени.Месяц = &Месяц)
	|			И ((НЕ ГрафикиРаботыПоВидамВремени.План))
	|ГДЕ
	|	СдельныйНарядИсполнители.Ссылка = &Документ
	|	И ГрафикиРаботыПоВидамВремени.ГрафикРаботы ЕСТЬ NULL ";
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Запрос.УстановитьПараметр("Месяц", ПериодРегистрации);
	Запрос.УстановитьПараметр("Месяц", ПериодРегистрации1);
	//Аверсон СВФР-007772
	
	Запрос.УстановитьПараметр("Документ", Ссылка);
	Возврат Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Сотрудник")
	
	//ВыборкаЗапроса = Запрос.Выполнить().Выбрать();
	//
	//НаборЗаписей = РегистрыСведений.ГрафикиРаботыПоВидамВремени.СоздатьНаборЗаписей();
	//НаборЗаписей.Отбор.План.Установить(Ложь);
	//НаборЗаписей.Отбор.Месяц.Установить(ПериодРегистрации);
	//
	//ДеньОкончанияМесяца = День(КонецМесяца(ПериодРегистрации));
	//ВидУчетаВремениПоДням = Перечисления.ВидыУчетаВремени.ПоДням;
	//ВидУчетаВремениПоЧасам = Перечисления.ВидыУчетаВремени.ПоЧасам;
	//ПустойДокумент = Документы.СдельныйНаряд.ПустаяСсылка();
	//Пока ВыборкаЗапроса.Следующий() Цикл
	//	
	//	НаборЗаписей.Отбор.ГрафикРаботы.Установить(ВыборкаЗапроса.Сотрудник);
	//	НаборЗаписей.Отбор.План.Установить(Ложь);
	//	НаборЗаписей.Очистить();
	//	Для ИндексДняМесяца = 1 По ДеньОкончанияМесяца Цикл
	//		
	//		ДатаМесяца = Дата(Год(ПериодРегистрации), Месяц(ПериодРегистрации), ИндексДняМесяца);
	//		Движение = НаборЗаписей.Добавить();
	//		Движение.ГрафикРаботы = ВыборкаЗапроса.Сотрудник;
	//		Движение.ВидУчетаВремени = ВидУчетаВремениПоДням;
	//		Движение.Дата = ДатаМесяца;
	//		Движение.Месяц = ПериодРегистрации;
	//		Движение.План = Ложь;
	//		Движение.Документ = ПустойДокумент;
	//		
	//		Движение = НаборЗаписей.Добавить();
	//		Движение.ГрафикРаботы = ВыборкаЗапроса.Сотрудник;
	//		Движение.ВидУчетаВремени = ВидУчетаВремениПоЧасам;
	//		Движение.Дата = ДатаМесяца;
	//		Движение.Месяц = ПериодРегистрации;
	//		Движение.План = Ложь;
	//		Движение.Документ = ПустойДокумент;
	//		
	//	КонецЦикла;
	//	НаборЗаписей.Записать();
	//КонецЦикла;
	
КонецФункции // ПолучитьМассивСотрудниковДляСозданияПустыхЗаписей()

// Процедура удаляет все записи из регистра за ПериодРегистрации,
// если документ последний в этом периоде, в разрезе сотрудников
Процедура УдалитьЗаписиЗаПериодДокумента()
	
	Запрос = Новый Запрос;
	
	Если ОтражатьВБухгалтерскомУчете Тогда
		УсловиеСотрудника = "";
	Иначе
		УсловиеСотрудника = ".ФизЛицо";
	КонецЕсли;
	
	Запрос.Текст = "ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СдельныйНарядИсполнители.Сотрудник" + УсловиеСотрудника + " Как Сотрудник,
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//|	СдельныйНаряд.ПериодРегистрации КАК ПериодРегистрации
	|ВЫБОР
	|КОГДА СдельныйНаряд.МесяцНачислений = ДатаВремя(1,1,1)
	|ТОГДА СдельныйНаряд.ПериодРегистрации
	|ИНАЧЕ СдельныйНаряд.МесяцНачислений
	|КОНЕЦ КАК ПериодРегистрации
	//Аверсон СВФР-007772
	
	|ИЗ
	|	Документ.СдельныйНаряд КАК СдельныйНаряд
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|		ПО (СдельныйНарядИсполнители.Ссылка = &Документ)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
	|		ПО ГрафикиРаботыПоВидамВремени.ГрафикРаботы = СдельныйНарядИсполнители.Сотрудник" + УсловиеСотрудника + "
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//|			И (ГрафикиРаботыПоВидамВремени.Месяц = СдельныйНаряд.ПериодРегистрации)
	|           И ВЫБОР
	|             КОГДА СдельныйНаряд.МесяцНачислений = ДатаВремя(1,1,1)
	|             ТОГДА ГрафикиРаботыПоВидамВремени.Месяц = СдельныйНаряд.ПериодРегистрации
	|             ИНАЧЕ ГрафикиРаботыПоВидамВремени.Месяц = СдельныйНаряд.МесяцНачислений
	|             КОНЕЦ
	//Аверсон СВФР-007772
	
	|			И (ГрафикиРаботыПоВидамВремени.Документ <> &ПустойДокумент)				   
	|			И ((НЕ ГрафикиРаботыПоВидамВремени.План))
	|ГДЕ
	|	СдельныйНаряд.Ссылка = &Документ
	|	И ГрафикиРаботыПоВидамВремени.Документ ЕСТЬ NULL";
	Запрос.УстановитьПараметр("Документ", Ссылка);
	Запрос.УстановитьПараметр("ПустойДокумент", Документы.СдельныйНаряд.ПустаяСсылка());
	ВыборкаЗапроса = Запрос.Выполнить().Выбрать();
	
	НаборЗаписей = РегистрыСведений.ГрафикиРаботыПоВидамВремени.СоздатьНаборЗаписей();
	Пока ВыборкаЗапроса.Следующий() Цикл
		НаборЗаписей.Отбор.План.Установить(Ложь);
		НаборЗаписей.Отбор.ГрафикРаботы.Установить(ВыборкаЗапроса.Сотрудник);
		НаборЗаписей.Отбор.Месяц.Установить(ВыборкаЗапроса.ПериодРегистрации);
		
		НаборЗаписей.Записать();
		
	КонецЦикла;
	
КонецПроцедуры // УдалитьЗаписиЗаПериодДокумента()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ

// удаление движений - документ не удаляеи движения автоматически
Процедура УдалитьДвижения()
	
	Если НЕ мУдалятьДвижения Тогда
		Возврат;
	КонецЕсли;
	
	Если мПрежнееОтражатьВУправленческомУчете Тогда
		Движения.ФактическаяВыработкаРаботников.Очистить();
		Движения.ФактическаяВыработкаРаботников.Записать();
		
	Иначе
		Движения.ФактическаяВыработкаРаботниковОрганизаций.Очистить();
		Движения.ФактическаяВыработкаРаботниковОрганизаций.Записать();
		//Движения.ЕСНОсновныеНачисления.Очистить();
		//Движения.ЕСНОсновныеНачисления.Записать();
		//Движения.ЕСНСведенияОДоходах.Очистить();
		//Движения.ЕСНСведенияОДоходах.Записать();
		Движения.БУОсновныеНачисления.Очистить();
		Движения.БУОсновныеНачисления.Записать();
		
	КонецЕсли;
	
	Движения.РабочееВремяРаботниковОрганизаций.Очистить();
	Движения.РабочееВремяРаботниковОрганизаций.Записать();
	
	Движения.ВзаиморасчетыСРаботникамиОрганизаций.Очистить();
	Движения.ВзаиморасчетыСРаботникамиОрганизаций.Записать();
	
	Движения.ОсновныеНачисленияРаботниковОрганизаций.Очистить();
	Движения.ОсновныеНачисленияРаботниковОрганизаций.Записать(); 
	
	Движения.НДФЛСведенияОДоходах.Очистить();
	Движения.НДФЛСведенияОДоходах.Записать(); 
	
	Движения.РаботаАвтомобилей.Очистить();
	Движения.РаботаАвтомобилей.Записать(); 
	
	//Аверсон 07.02.2023 КВВ СВФР-010173 (
	Если ЭтоДоговораПодряда Тогда
		Движения.ПлановыеНачисленияРаботниковОрганизаций.Очистить();
		Движения.ПлановыеНачисленияРаботниковОрганизаций.Записать();	
	КонецЕсли;
	//Аверсон 07.02.2023 КВВ СВФР-010173 )
	
КонецПроцедуры // УдалитьДвижения()

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	//Отказ = Проведен И РежимЗаписи = РежимЗаписиДокумента.Проведение И СпособВводаДанных.Пустая();
	//Отказ = Проведен И РежимЗаписи = РежимЗаписиДокумента.Запись И СпособВводаДанных.Пустая();
	
	Если Отказ Тогда
		Сообщить("Документ был проведен в редакции 2.1 и перепроведению не подлежит!");
		Возврат
	КонецЕсли;
	
	КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(Исполнители);
	// Установим прежнее состояние ОтражатьВУправленческомУчете
	мПрежнееОтражатьВУправленческомУчете = Ссылка.ОтражатьВУправленческомУчете;
	
	мУдалятьДвижения = Не ЭтоНовый();
	
КонецПроцедуры // ПередЗаписью()

Функция СформироватьЗапросПрочиеДоплаты()
	
	Запрос = Новый Запрос;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	СдельныйНарядПрочиеДоплаты.Сотрудник,
	|	СдельныйНарядПрочиеДоплаты.ФизЛицо,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаСтаж,
	|	СдельныйНарядПрочиеДоплаты.ПроцентВредныеУсловияТруда,
	|	СдельныйНарядПрочиеДоплаты.ПроцентПремии,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаРуководствоБригадой,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаКлассность,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаПрофмастерство,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаУчеличенныйОбъем,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаЭкспедированиеГрузов,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаРаботуВЗимнееВремя,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаСовмещение,
	|	СдельныйНарядПрочиеДоплаты.ТарифнаяСтавка,
	|	СдельныйНарядПрочиеДоплаты.КодСтроки
	|ИЗ
	|	Документ.СдельныйНаряд.ПрочиеДоплаты КАК СдельныйНарядПрочиеДоплаты
	|ГДЕ
	|	СдельныйНарядПрочиеДоплаты.Ссылка = &Ссылка
	
	|СГРУППИРОВАТЬ ПО
	|	СдельныйНарядПрочиеДоплаты.Сотрудник,
	|	СдельныйНарядПрочиеДоплаты.ФизЛицо,
	|	СдельныйНарядПрочиеДоплаты.ТарифнаяСтавка,
	|	СдельныйНарядПрочиеДоплаты.КодСтроки,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаСтаж,
	|	СдельныйНарядПрочиеДоплаты.ПроцентВредныеУсловияТруда,
	|	СдельныйНарядПрочиеДоплаты.ПроцентПремии,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаРуководствоБригадой,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаКлассность,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаПрофмастерство,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаУчеличенныйОбъем,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаЭкспедированиеГрузов,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаРаботуВЗимнееВремя,
	|	СдельныйНарядПрочиеДоплаты.ПроцентЗаСовмещение";
	
	Запрос.УстановитьПараметр("Ссылка", Ссылка);
	
	Запрос.Текст = ТекстЗапроса;
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПрочиеДоплаты()

Процедура ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ФизЛицо, СуммаДоплаты)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	НаборДвижения = Движения.ВзаиморасчетыСРаботникамиОрганизаций;
	
	Движение = НаборДвижения.Добавить();
	// Свойства
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Движение.Период					= КонецМесяца(ПериодРегистрации);
	Движение.Период					= КонецМесяца(ПериодРегистрации1);
	//Аверсон СВФР-007772
	
	Движение.ВидДвижения			= ВидДвиженияНакопления.Приход;
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Движение.ПериодВзаиморасчетов	= ПериодРегистрации;
	Движение.ПериодВзаиморасчетов	= ПериодРегистрации1;
	//Аверсон СВФР-007772
	
	// Измерения
	Движение.Организация			= Организация;
	Движение.ФизЛицо				= ФизЛицо;
	
	// Ресурсы
	
	Движение.СуммаВзаиморасчетов	= СуммаДоплаты;
	НаборДвижения.Записать();
	
КонецПроцедуры

Процедура ДобавитьДвижениеПоНДФЛСведенияОДоходах(Сотрудник, ВидРасчета,СуммаДоплаты)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	НаборДвижения = Движения.НДФЛСведенияОДоходах;
	
	Движение = НаборДвижения.Добавить();
	
	// Свойства
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Движение.Период						= НачалоМесяца(ПериодРегистрации);
	Движение.Период						= НачалоМесяца(ПериодРегистрации1);
	//Аверсон СВФР-007772

	// Измерения
	Движение.Организация				= Организация;
	Движение.ФизЛицо					= Сотрудник.ФизЛицо;
	Движение.КодДохода					= ВидРасчета.КодДоходаНДФЛ;
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Движение.ПериодРегистрации			= НачалоМесяца(ПериодРегистрации);
	Движение.ПериодРегистрации			= НачалоМесяца(ПериодРегистрации1);
	//Аверсон СВФР-007772
	
	// Ресурсы
	Движение.СуммаДохода				= СуммаДоплаты; 
	
	// Реквизиты
	Движение.ОбособленноеПодразделение	= Организация;
	Движение.ИсчисленоИзЗарплаты		= Истина;
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Движение.ПодразделениеОрганизации   = ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Сотрудник, КонецМесяца(ПериодРегистрации)); 
	Движение.ПодразделениеОрганизации   = ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Сотрудник, КонецМесяца(ПериодРегистрации1)); 
	//Аверсон СВФР-007772
	
	НаборДвижения.Записать();
	
КонецПроцедуры

Процедура ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(Сотрудник, ВидРасчета, СуммаДоплаты, ОтработаноЧасов,Период = Неопределено, ПериодВБригаде = Неопределено, 
	                                                                НаборДвижения = Неопределено, ЗаписыватьНабор = Истина, ТЗПериодыРаботыСотрудника = Неопределено) 
																	//Аверсон ЕАЕ 27.10.2021 СВФР-008312 параметр ПериодВБригаде 
																	//Ускорение параметры НаборДвижения, ЗаписыватьНабор 
																	//Аверсон ЕАЕ 06.02.2023 СВФР-010277 ТЗПериодыРаботыСотрудника	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Если НаборДвижения = Неопределено Тогда //Ускорение
		НаборДвижения = Движения.ОсновныеНачисленияРаботниковОрганизаций;
	КонецЕсли;
	
	Если ТЗПериодыРаботыСотрудника = Неопределено Тогда //Аверсон ЕАЕ 06.02.2023 СВФР-010277
	
	Движение = НаборДвижения.Добавить();
	
	// Свойства
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Движение.ПериодРегистрации			= ПериодРегистрации;
	Движение.ПериодРегистрации			= ПериодРегистрации1;
	//Аверсон СВФР-007772
	
	//заявка №1980 (база заявко Кристалла) Дмитрук О.Г.
	//ПериодДействияНачисления = ПрочиеПроцедуры.ПолучитьПериодДействияПлановогоНачисленияПоРаботнику(Сотрудник, ВидРасчета.СпособРасчета, НачалоМесяца(ПериодРегистрации), Ссылка, НачалоМесяца(ПериодРегистрации), КонецМесяца(ПериодРегистрации));
	//
	//Если ПериодДействияНачисления.Количество() > 0 Тогда
	//	Движение.ПериодДействияНачало		= ПериодДействияНачисления[0].ПериодДействияНачало;
	//	Движение.ПериодДействияКонец		= ПериодДействияНачисления[0].ПериодДействияКонец;
	//Иначе
	если Период <> Неопределено Тогда
		Движение.ПериодДействияНачало		= Период;
		Движение.ПериодДействияКонец		= Период;
		
	//Аверсон ЕАЕ 27.10.2021 СВФР-008312
	ИначеЕсли ПериодВБригаде <> Неопределено Тогда
		Движение.ПериодДействияНачало		= ПериодВБригаде.НачалоПериода;
		Движение.ПериодДействияКонец		= ПериодВБригаде.КонецПериода;
	//Аверсон СВФР-008312
	
	иначе
		//О.Т. Аверсон 16.05.2018 № 1953
		Если ОтличаютсяВредныеЧасы Тогда 
			Запрос = Новый Запрос;
			
			СотрудникиТекст = 
			"ВЫБРАТЬ
			|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Период
			|ИЗ
			|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(&Период, ) КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
			|ГДЕ
			|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник = &Сотрудник
			|	И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ИспользуетсяВНаряде = &ИспользуетсяВНаряде
			|	И ВЫБОР
			|			КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ПериодЗавершения <= &парамНачало
			|					И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ДействиеЗавершения
			|			ИНАЧЕ ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Действие
			|		КОНЕЦ <> &Действие
			|	И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета = &ВидРасчета";
			
			Запрос.Текст = СотрудникиТекст;
			
			//Аверсон ЕАЕ 23.07.2021 СВФР-007772
			//Запрос.УстановитьПараметр("Период", КонецМесяца(ПериодРегистрации));
			Запрос.УстановитьПараметр("Период", КонецМесяца(ПериодРегистрации1));
			//Аверсон СВФР-007772
			
			Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
			Запрос.УстановитьПараметр("ИспользуетсяВНаряде", Истина);
			Запрос.УстановитьПараметр("Действие", Перечисления.ВидыДействияСНачислением.Прекратить);
			
			//Аверсон ЕАЕ 23.07.2021 СВФР-007772
			//Запрос.УстановитьПараметр("парамНачало", НачалоМесяца(ПериодРегистрации));
			Запрос.УстановитьПараметр("парамНачало", НачалоМесяца(ПериодРегистрации1));
			//Аверсон СВФР-007772
			
			Запрос.УстановитьПараметр("ВидРасчета", ВидРасчета);
			
			Результат = Запрос.Выполнить().Выбрать();
			ДатаОтсчетаВредности = Дата(1,1,1);
			Пока Результат.Следующий() Цикл 
				ДатаОтсчетаВредности = Результат.Период;
			КонецЦикла;
			
			//Аверсон ЕАЕ 23.07.2021 СВФР-007772
			//ДатаНачалаВр = Макс(ПериодРегистрации,ДатаОтсчетаВредности);
			ДатаНачалаВр = Макс(ПериодРегистрации1,ДатаОтсчетаВредности);
			//Аверсон СВФР-007772
			
			СотрудникиТекст = СтрЗаменить(СотрудникиТекст,"КОНЕЦ <> &Действие","КОНЕЦ = &Действие");
			Запрос.УстановитьПараметр("ИспользуетсяВНаряде", Ложь);
			Запрос.Текст = СотрудникиТекст;
			Результат = Запрос.Выполнить().Выбрать();
			
			//Аверсон ЕАЕ 23.07.2021 СВФР-007772
			//ДатаОкончанияВредности = КонецМесяца(ПериодРегистрации);
			ДатаОкончанияВредности = КонецМесяца(ПериодРегистрации1);
			//Аверсон СВФР-007772
			
			Пока Результат.Следующий() Цикл 
				Если ДатаОтсчетаВредности < КонецДня(Результат.Период) Тогда
					ДатаОкончанияВредности = КонецДня(Результат.Период);
				КонецЕсли;
			КонецЦикла;
			
			//Аверсон ЕАЕ 23.07.2021 СВФР-007772
			//ДатаОкончанияВр = Мин(ДатаОкончанияВредности,КонецМесяца(ПериодРегистрации));
			ДатаОкончанияВр = Мин(ДатаОкончанияВредности,КонецМесяца(ПериодРегистрации1));
			//Аверсон СВФР-007772
			
			Движение.ПериодДействияНачало		= ДатаНачалаВр;
			Движение.ПериодДействияКонец		= ДатаОкончанияВр;

		иначе
			
			//Аверсон ЕАЕ 23.07.2021 СВФР-007772
			//Движение.ПериодДействияНачало		= ПериодРегистрации;
			//Движение.ПериодДействияКонец		= КонецМесяца(ПериодРегистрации);
			Движение.ПериодДействияНачало		= ПериодРегистрации1;
			Движение.ПериодДействияКонец		= КонецМесяца(ПериодРегистрации1);
			//Аверсон СВФР-007772
			
		КонецЕсли;
		//О.Т. Аверсон 16.05.2018 № 1953
	КонецЕсли;
	//КонецЕсли;
	//заявка №1980 
	
	Движение.ВидРасчета					= ВидРасчета;
	//Движение.Сторно						= ВыборкаПоСтрокамДокумента.Сторно;
	
	// Измерения
	Движение.Сотрудник					= Сотрудник;
	Движение.ФизЛицо					= Сотрудник.ФизЛицо;
	Движение.Организация				= Организация;
	
	// Ресурсы
	Движение.Результат					= СуммаДоплаты;
	Если ЗначениеЗаполнено(ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени) Тогда
		Если ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени.РабочееВремя = Истина Тогда
			Движение.ОплаченоДнейЧасов			= ОтработаноЧасов;
			Если Организация.Инн = "700067572" и не ВидРасчета.ВидВремени = Перечисления.ВидыВремени.ДополнительноОплачиваемоеВПределахНормы Тогда
				Движение.ОтработаноЧасов = ОтработаноЧасов
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	// Реквизиты
	//Движение.Показатель1				= ВыборкаПоСтрокамДокумента.Размер;
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Движение.ПодразделениеОрганизации	= ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Сотрудник, КонецМесяца(ПериодРегистрации));
	
	//Аверсон ЕАЕ 14.02.2022 СВФР-008735
	//Движение.ПодразделениеОрганизации	= ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Сотрудник, ?( Период <> Неопределено,Период,КонецМесяца(ПериодРегистрации1)));
	Движение.ПодразделениеОрганизации	= ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Сотрудник, ?( Период <> Неопределено,Период,Движение.ПериодДействияНачало));
	//Аверсон СВФР-008735
	
	//Аверсон СВФР-007772
	
	Движение.ОбособленноеПодразделение	= Организация;
	Движение.ГрафикРаботы				= Сотрудник;
	Движение.ВидУчетаВремени			= Перечисления.ВидыУчетаВремени.ПоЧасам;
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Движение.ДатаНачалаСобытия			= ПериодРегистрации;
	Движение.ДатаНачалаСобытия			= ПериодРегистрации1;
	//Аверсон СВФР-007772
	
	Если ЗаписыватьНабор = Истина Тогда //Ускорение
		НаборДвижения.Записать();
	КонецЕсли;
	
		//Аверсон ЕАЕ 06.02.2023 СВФР-010277	
	Иначе
		ОсталосьРаспределить = СуммаДоплаты;
		ОсталосьРаспределитьЧасы = ОтработаноЧасов;
		КоличествоСтрок = ТЗПериодыРаботыСотрудника.Количество();
		
		ИтогДней = 0;
		
		//Аверсон ЕАЕ 16.07.2025 СВФР-016262
		ИтогЧасов = 0;
		//Аверсон СВФР-016262
		
		Для Каждого Стр Из ТЗПериодыРаботыСотрудника Цикл
			ИтогДней = ИтогДней + Стр.ДнейВПериоде;	
			
			//Аверсон ЕАЕ 16.07.2025 СВФР-016262
			ИтогЧасов = ИтогЧасов + Стр.ОтработаноЧасовВПериоде;
			//Аверсон СВФР-016262
			
		КонецЦикла;
		
		Для Каждого Стр Из ТЗПериодыРаботыСотрудника Цикл
			Движение = НаборДвижения.Добавить();
			
			Движение.ПериодРегистрации    = ПериодРегистрации1;
			Движение.ПериодДействияНачало = Стр.НачПериода;
			Движение.ПериодДействияКонец  = Стр.КонПериода;
			
			Движение.ВидРасчета					= ВидРасчета;
			Движение.Сотрудник					= Сотрудник;
			Движение.ФизЛицо					= Сотрудник.ФизЛицо;
			Движение.Организация				= Организация;
			
			Движение.ПодразделениеОрганизации	= ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Сотрудник, ?( Период <> Неопределено,Период,Движение.ПериодДействияНачало));
			Движение.ОбособленноеПодразделение	= Организация;
			Движение.ГрафикРаботы				= Сотрудник;
			Движение.ВидУчетаВремени			= Перечисления.ВидыУчетаВремени.ПоЧасам;
			Движение.ДатаНачалаСобытия			= ПериодРегистрации1;
			
			Если ТЗПериодыРаботыСотрудника.Индекс(Стр) = КоличествоСтрок - 1 Тогда //Это последняя строка
				Распределяем = ОсталосьРаспределить;
				РаспределяемЧасы = ОсталосьРаспределитьЧасы;
			Иначе
				
				//Аверсон ЕАЕ 16.07.2025 СВФР-016262
				//Если ИтогДней = 0 Тогда
				//	Распределяем = 0;
				//	РаспределяемЧасы = 0;
				//Иначе
				//	Распределяем = Окр(Стр.ДнейВПериоде / ИтогДней * СуммаДоплаты, 2);
				//	РаспределяемЧасы = Окр(Стр.ДнейВПериоде / ИтогДней * ОтработаноЧасов, 1);
				//КонецЕсли;
				Если ИтогЧасов = 0 Тогда
					Распределяем = 0;
					РаспределяемЧасы = 0;
				Иначе
					Распределяем = Окр(Стр.ОтработаноЧасовВПериоде / ИтогЧасов * СуммаДоплаты, 2);
					РаспределяемЧасы = Окр(Стр.ОтработаноЧасовВПериоде / ИтогЧасов * ОтработаноЧасов, 1);
				КонецЕсли;
				//Аверсон СВФР-016262

			КонецЕсли;
			Движение.Результат = Распределяем;
			
			Если ЗначениеЗаполнено(ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени) Тогда
				Если ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени.РабочееВремя = Истина Тогда
					Движение.ОплаченоДнейЧасов = РаспределяемЧасы;
				КонецЕсли;
			КонецЕсли;
			
			Если ЗаписыватьНабор = Истина Тогда //Ускорение
				НаборДвижения.Записать();
			КонецЕсли;
			
			ОсталосьРаспределить = ОсталосьРаспределить - Распределяем;
			
		КонецЦикла;
	КонецЕсли;
	//Аверсон СВФР-010277
	
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, Режим) 
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
		ДатаНачалаПериода1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
		ДатаНачалаПериода1 = ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	мСтрокаУП = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(
	Новый Структура("Организация", Организация));
	ВредностьЧасов = Неопределено;//Островская Татьяна 01.03.2013 № 16
	
	
	// удалим движения
	УдалитьДвижения();
	
	// Заголовок для сообщений об ошибках проведения.
	Заголовок = ОбщегоНазначения.ПредставлениеДокументаПриПроведении(Ссылка);
	
	// Сформируем структуру реквизитов шапки документа
	СтруктураШапкиДокумента = ОбщегоНазначения.СформироватьСтруктуруШапкиДокумента(ЭтотОбъект);
	
	// Документ должен принадлежать хотя бы к одному виду учета (управленческий, бухгалтерский, налоговый)
	ОбщегоНазначения.ПроверитьПринадлежностьКВидамУчета(СтруктураШапкиДокумента, Отказ, Заголовок);
	
	// Проверка заполнения шапки документа
	РеквизитыШапки = "СпособВводаДанных,СтатусДокумента";
	Если ОтражатьВУправленческомУчете Тогда
		ДополнитьРеквизитыШапкиУпр(РеквизитыШапки);
	КонецЕсли;
	Если ОтражатьВБухгалтерскомУчете Тогда
		ДополнитьРеквизитыШапкиРегл(РеквизитыШапки);
	КонецЕсли;
	ОбщегоНазначения.ПроверитьЗаполнениеШапкиДокумента(ЭтотОбъект, Новый Структура(РеквизитыШапки,"Не указан способ учета времени и выработки по наряду!"), Отказ, Заголовок);
	
	//Аверсон 07.02.2023 КВВ СВФР-010173 (
	Если НЕ Отказ И ЭтоДоговораПодряда И Исполнители.Количество() > 0 Тогда 
		СообщениеНаОтказ = Ложь;
		Для Каждого СтрИсполнители ИЗ Исполнители Цикл 
			Если СтрИсполнители.Сотрудник.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда Тогда
				Если ЗначениеЗаполнено(СтрИсполнители.ДоговорПодряда) Тогда  
					Если ЗначениеЗаполнено(СтрИсполнители.ДоговорПодрядаДатаНачала) И ЗначениеЗаполнено(СтрИсполнители.ДоговорПодрядаДатаОкончания) Тогда
						Если НачалоДня(СтрИсполнители.ДоговорПодрядаДатаОкончания) < НачалоДня(СтрИсполнители.ДоговорПодрядаДатаНачала) Тогда
							Сообщить("Документ проведен не будет! Строка № " + СокрЛП(СтрИсполнители.НомерСтроки) + " - " + СокрЛП(СтрИсполнители.Сотрудник) + " - дата окончания договора подряда меньше даты начала.");
							СообщениеНаОтказ = Истина;
						Иначе
							Если СтрИсполнители.СуммаКНачислениюРегл = 0 Тогда  
								Сообщить("Документ проведен не будет! Строка № " + СокрЛП(СтрИсполнители.НомерСтроки) + " - " + СокрЛП(СтрИсполнители.Сотрудник) + " - сумма = 0 в колонке ""Сумма к начислению"".");
								СообщениеНаОтказ = Истина;
							Иначе 
								// всё ок
							КонецЕсли;
						КонецЕсли;
					Иначе    
						Сообщить("Документ проведен не будет! Строка № " + СокрЛП(СтрИсполнители.НомерСтроки) + " - " + СокрЛП(СтрИсполнители.Сотрудник) + " - не заполнена дата начала/дата окончания договора подряда.");
						СообщениеНаОтказ = Истина;
					КонецЕсли;
				Иначе 
					Сообщить("Документ проведен не будет! Строка № " + СокрЛП(СтрИсполнители.НомерСтроки) + " - " + СокрЛП(СтрИсполнители.Сотрудник) + " - не выбран договор подряда.");
					СообщениеНаОтказ = Истина;
				КонецЕсли;
			Иначе
				Сообщить("Документ проведен не будет! Строка № " + СокрЛП(СтрИсполнители.НомерСтроки) + " - " + СокрЛП(СтрИсполнители.Сотрудник) + " - вид договора НЕ договор подряда.");
				СообщениеНаОтказ = Истина;
			КонецЕсли; 
		КонецЦикла;	
		Если СообщениеНаОтказ = Истина Тогда
			Отказ = Истина;
		Иначе
			Для Каждого СтрИсполнители ИЗ Исполнители Цикл 
				
				Движение = Движения.ПлановыеНачисленияРаботниковОрганизаций.Добавить();
				
				Движение.Период = СтрИсполнители.ДоговорПодрядаДатаНачала + 1;
				Движение.Сотрудник = СтрИсполнители.Сотрудник;
				Движение.Организация = ОбщегоНазначения.ГоловнаяОрганизация(Организация);
				//Движение.ДокументОснование = Ссылка;
				Движение.ДокументОснование = СтрИсполнители.ДоговорПодряда;
				Движение.ВидРасчетаИзмерение = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда;
				
				Движение.ВидРасчета = ПланыВидовРасчета.ДополнительныеНачисленияОрганизаций.ДоговорПодряда;
				Движение.Действие = Перечисления.ВидыДействияСНачислением.Начать;
				Движение.Показатель1 = СтрИсполнители.СуммаКНачислениюРегл;
				Движение.Валюта1 = Константы.ВалютаРегламентированногоУчета.Получить();
				
				Движение.ПериодЗавершения = КонецДня(СтрИсполнители.ДоговорПодрядаДатаОкончания) + 86400;
				Движение.ДействиеЗавершения	= Перечисления.ВидыДействияСНачислением.Прекратить;   
			КонецЦикла;
		КонецЕсли;
	КонецЕсли;
	//Аверсон 07.02.2023 КВВ СВФР-010173 )
	
	Если СтатусДокумента = Перечисления.СтатусДокумента.Проверен или СтатусДокумента = Перечисления.СтатусДокумента.Рассчитан Тогда
		// проверка совпадения сумм по т.ч. 
		
		Если Не (РольДоступна("ТабельныйУчет")) Тогда
			Если ТипНаряда = 0 Тогда
				Если ОтражатьВУправленческомУчете Тогда
					Если Выработка.Итог("Сумма") <> Исполнители.Итог("СуммаКНачислению") Тогда
						ОбщегоНазначения.СообщитьОбОшибке("Не совпадают итоговые суммы к начислению по управленческому учету по табличным частям!", Отказ, Заголовок);
					КонецЕсли;
				КонецЕсли;
				Если ОтражатьВБухгалтерскомУчете Тогда
					Если Окр(Выработка.Итог("СуммаРегл"),2) <> Исполнители.Итог("СуммаКНачислениюРегл") Тогда
						ОбщегоНазначения.СообщитьОбОшибке("Не совпадают итоговые суммы к начислению по регламентированному учету по табличным частям!", Отказ, Заголовок);
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		Если СтатусДокумента = Перечисления.СтатусДокумента.Проверен  или СтатусДокумента = Перечисления.СтатусДокумента.Рассчитан Тогда
			// получим реквизиты табличной части
			ВыборкаПоРаботники = СформироватьЗапросПоИсполнители(Режим,СтруктураШапкиДокумента).Выбрать();
			ВыборкаПоРаботникиРегл = Неопределено;
			
			Если ОтражатьВБухгалтерскомУчете Тогда
				ВыборкаПоРаботникиРегл = СформироватьЗапросПоИсполнителиРегл(СтруктураШапкиДокумента).Выбрать();
			КонецЕсли;
			
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
			//Пока ВыборкаПоРаботники.СледующийПоЗначениюПоля("Сотрудник") Цикл
			//- СВЭЙ КДЯ 08.10.19 СВФР-004843
			
			//Аверсон ЕАЕ 08.12.2021 СВФР-008480
			ВыборкаПоРаботникиСотр = ВыборкаПоРаботники;
			//Аверсон СВФР-008480
			
			//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
			
			//Аверсон ЕАЕ 08.12.2021 СВФР-008480
			//Пока ВыборкаПоРаботники.Следующий() Цикл
			Пока ВыборкаПоРаботники.СледующийПоЗначениюПоля("Сотрудник") Цикл
			//Аверсон СВФР-008480
			
			//- СВЭЙ КДЯ 08.10.19 СВФР-004843
				
				РабочееВремяЗаполнено = Ложь;
				
				//Аверсон ЕАЕ 08.12.2021 СВФР-008480
				//Пока ВыборкаПоРаботники.Следующий() Цикл
				Пока ВыборкаПоРаботникиСотр.НайтиСледующий(ВыборкаПоРаботники.Сотрудник, "Сотрудник") Цикл
				//Аверсон СВФР-008480
				
					Если ОтражатьВБухгалтерскомУчете Тогда
						
						//Аверсон ЕАЕ 08.12.2021 СВФР-008480
						//ВыборкаПоРаботникиРегл.Следующий();
						ВыборкаПоРаботникиРегл.НайтиСледующий(ВыборкаПоРаботники.Сотрудник, "Сотрудник");
						//Аверсон СВФР-008480
						
					КонецЕсли;
					// проверим очередную строку табличной части
					ПроверитьЗаполнениеСтрокиИсполнители(СтруктураШапкиДокумента, ВыборкаПоРаботники, ВыборкаПоРаботникиРегл, Отказ, Заголовок, глЗначениеПеременной("глУчетнаяПолитикаПоПерсоналуОрганизации"));
					
				КонецЦикла;
				
				// Дополнительная проверка на заполненость по отработаному времени при вводе за каждый день
				Если СтруктураШапкиДокумента.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням 
					И  СтруктураШапкиДокумента.УчитыватьОтработанноеВремя
					И НЕ РабочееВремяЗаполнено Тогда
					
					ОбщегоНазначения.СообщитьОбОшибке("В строке номер """+ СокрЛП(ВыборкаПоРаботники.НомерСтроки) +
					""" табл. части ""Исполнители"": " + "не указано значение отработаных часов!", Отказ, Заголовок);
					
				КонецЕсли;
				
			КонецЦикла; 
			
			// проверим общие реквизиты
			ВыборкаПоРаботы = СформироватьЗапросПоВыработка(Режим).Выбрать();
			Пока ВыборкаПоРаботы.Следующий() Цикл 
				// проверим очередную строку табличной части
				ПроверитьЗаполнениеСтрокиВыработка(СтруктураШапкиДокумента, ВыборкаПоРаботы, Отказ, Заголовок);
			КонецЦикла;
			
			// проверим реквизиты регл учета
			Если ОтражатьВБухгалтерскомУчете Тогда
				
				// определим налоговый режим
				БухгалтерскийИНалоговыйУчет.ОбновитьДанныеУчетнойПолитикиПоНалоговомуУчету(глЗначениеПеременной("глУчетнаяПолитикаПоНалоговомуУчету"), КонецМесяца(СтруктураШапкиДокумента.Дата), СтруктураШапкиДокумента.Организация);
				мУчетнаяПолитикаУСН = глЗначениеПеременной("глУчетнаяПолитикаПоНалоговомуУчету")[КонецМесяца(СтруктураШапкиДокумента.Дата)][СтруктураШапкиДокумента.Организация].УСН;
				
				
				РезультатЗапросаПоРаботыРегл = СформироватьЗапросПоВыработкаРегл(Режим);
				ТаблицаРаботРегл = РезультатЗапросаПоРаботыРегл.Выгрузить();
				ВыборкаПоРаботыРегл = РезультатЗапросаПоРаботыРегл.Выбрать();
				Пока ВыборкаПоРаботыРегл.Следующий() Цикл 
					// проверим очередную строку табличной части
					ПроверитьЗаполнениеСтрокиВыработкаРегл(СтруктураШапкиДокумента, ВыборкаПоРаботыРегл, Отказ, Заголовок);
				КонецЦикла;
				
			КонецЕсли;
			
			// Движения стоит добавлять, если в проведении еще не отказано (отказ =ложь)
			Если Отказ Тогда
				Возврат
			КонецЕсли;
			
			// Фактически отработанное время
			УдалитьЗаписиГрафика();
			УдалитьЗаписиЗаПериодДокумента();
			
			//ПСА 11.02.2021 СВФР-007191+++
			//Если УчитыватьОтработанноеВремя Тогда
			Если УчитыватьОтработанноеВремя и (Не ЗначениеЗаполнено(Бригада) ИЛИ Организация.ИНН = "790056159") Тогда //Аверсон ЕАЕ 29.05.2024 СВФР-012937
			//+++ПСА 11.02.2021 СВФР-007191	
				Если Истина Тогда
					
					Если ОтражатьВБухгалтерскомУчете Тогда
						ВыборкаПоРаботникиРегл.Сбросить();
						ВыборкаПоОтработанноеВремя = ВыборкаПоРаботникиРегл;
					КонецЕсли;
					Если ОтражатьВУправленческомУчете Тогда
						ВыборкаПоРаботники.Сбросить();
						ВыборкаПоОтработанноеВремя = ВыборкаПоРаботники;
					КонецЕсли;
					
					НаборДвижений = Движения.РабочееВремяРаботниковОрганизаций;
					
					Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
						// Данные введены в целом за период.
						//Островская Татьяна 01.03.2013 № 16797
						ТаблицаЗначенийДубли = Новый ТаблицаЗначений;
						ТаблицаЗначенийДубли.Колонки.Добавить("Сотрудник",,"Сотрудник");
						//Островская Татьяна 01.03.2013 № 16797
						
						Пока ВыборкаПоОтработанноеВремя.Следующий() Цикл
							
							Для Сч = 1 По 5 Цикл
								
								Если ЗначениеЗаполнено(ВыборкаПоОтработанноеВремя["ВидВремени" + Сч + "Сводно"]) Тогда
									
									Запись = НаборДвижений.Добавить();
									// Свойства
									
									//Аверсон ЕАЕ 23.07.2021 СВФР-007772
									//Запись.Период							= ПериодРегистрации;
									
									//Аверсон ЕАЕ 24.06.2022 СВФР-009242
									//Запись.Период							= ПериодРегистрации1;
									Запись.Период							= Макс(ПериодРегистрации1, ВыборкаПоОтработанноеВремя.ДатаПриема);
									//Аверсон СВФР-009242
									
									//Аверсон СВФР-007772
									
									//О.Т. Аверсон 14.12.2016 № 100
									Запись.ДатаНачала = НачалоМесяца(Запись.Период);
									Запись.ДатаОкончания = КонецМесяца(Запись.Период);
									//О.Т. Аверсон 14.12.2016 № 100

									
									// Измерения
									Запись.Сотрудник					= ВыборкаПоОтработанноеВремя.Сотрудник;
									Если ОтражатьВБухгалтерскомУчете Тогда
										Запись.Организация					= СтруктураШапкиДокумента.ГоловнаяОрганизация;
									КонецЕсли;
									
									Запись.ВидИспользованияРабочеговремени	= ВыборкаПоОтработанноеВремя["ВидВремени" + Сч + "Сводно"];
									Запись.Тариф = ВыборкаПоОтработанноеВремя.Тариф;
									
									// Ресурсы
									Запись.Дней								= ВыборкаПоОтработанноеВремя["Дней" + Сч + "Сводно"];
									Запись.Часов							= ВыборкаПоОтработанноеВремя["Часов" + Сч + "Сводно"];
									
									// Реквизиты
									Запись.ВЦеломЗаПериод					= Истина;
									
								КонецЕсли;
								//Островская Татьяна 13.02.2013 № 15797
								если не ЗначениеЗаполнено(ВредностьЧасов) Тогда 
									ВредностьЧасов = ВыборкаПоОтработанноеВремя.ИтогоВредность;
								КонецЕсли;
								//Островская Татьяна 13.02.2013 № 15797
								//Островская Татьяна 13.02.2013 № 15797
								если ЗначениеЗаполнено(ВредностьЧасов) Тогда
									ПараметрыОтбора = Новый Структура;
									ПараметрыОтбора.Вставить("Сотрудник", ВыборкаПоОтработанноеВремя.Сотрудник);
									
									Массив = ТаблицаЗначенийДубли.НайтиСтроки(ПараметрыОтбора);
									если Массив.Количество() = 0 Тогда 
										НаборЗаписей1 = Движения.РабочееВремяРаботниковОрганизаций;
										Движение = НаборЗаписей1.Добавить();
										
										// Свойства
										
										//Аверсон ЕАЕ 23.07.2021 СВФР-007772
										//Движение.Период								= ПериодРегистрации;
										Движение.Период								= ПериодРегистрации1;
										//Аверсон СВФР-007772
										
										//О.Т. Аверсон 14.12.2016 № 100
										Движение.ДатаНачала = НачалоМесяца(Движение.Период);
										Движение.ДатаОкончания = КонецМесяца(Движение.Период);
										//О.Т. Аверсон 14.12.2016 № 100

										
										// Измерения
										Движение.Сотрудник						= ВыборкаПоОтработанноеВремя.Сотрудник;
										Если ОтражатьВБухгалтерскомУчете Тогда
											Движение.Организация					= СтруктураШапкиДокумента.ГоловнаяОрганизация;
										КонецЕсли;
										Движение.ВидИспользованияРабочегоВремени	= Справочники.КлассификаторИспользованияРабочегоВремени.Вредность;
										Движение.ЧасовВредность = ВредностьЧасов;
										Движение.ВЦеломЗаПериод						= Ложь;
										Движение.Тариф = ВыборкаПоОтработанноеВремя.Тариф;
										ТЗДубли = ТаблицаЗначенийДубли.Добавить();
										ТЗДубли.Сотрудник = ВыборкаПоОтработанноеВремя.Сотрудник;
									КонецЕсли;
								КонецЕсли;
								//Островская Татьяна 13.02.2013 № 15797
								
								
							КонецЦикла;
							
							ВредностьЧасов=0;	
						КонецЦикла;
						
					ИначеЕсли СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням Тогда
						
						// Данные введены с разбивкой по дням.
						//Островская Татьяна 01.03.2013 № 16797
						ТаблицаЗначенийДубли = Новый ТаблицаЗначений;
						ТаблицаЗначенийДубли.Колонки.Добавить("Сотрудник",,"Сотрудник");
						//Островская Татьяна 01.03.2013 № 16797
						
						Запрос = Новый Запрос;
						
						//Аверсон ЕАЕ 23.07.2021 СВФР-007772
						//Запрос.УстановитьПараметр("Месяц", ПериодРегистрации);
						Запрос.УстановитьПараметр("Месяц", ПериодРегистрации1);
						
						//КоличествоДней = День(КонецМесяца(ПериодРегистрации));
						КоличествоДней = День(КонецМесяца(ПериодРегистрации1));
						//Аверсон СВФР-007772
						
						//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
						//Пока ВыборкаПоОтработанноеВремя.СледующийПоЗначениюПоля("Сотрудник") Цикл
						//- СВЭЙ КДЯ 08.10.19 СВФР-004843
						//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
						Пока ВыборкаПоОтработанноеВремя.Следующий() Цикл
						//- СВЭЙ КДЯ 08.10.19 СВФР-004843
							
							Пока ВыборкаПоОтработанноеВремя.СледующийПоЗначениюПоля("ИндексДня") Цикл
								
								ВремяЯвки = 0;
								Пока ВыборкаПоОтработанноеВремя.Следующий() Цикл
									
									Если ВыборкаПоОтработанноеВремя.ВидВремени = КлассификаторЯвка Тогда
										ВремяЯвки = ВыборкаПоОтработанноеВремя.Часов;
									КонецЕсли;
									
									// По регистру накоплений "РабочееВремяРаботниковОрганизаций"
									ДобавитьСтрокуРабочееВремяРаботниковОрганизацийПоДням(СтруктураШапкиДокумента, ВыборкаПоОтработанноеВремя, НаборДвижений);
									
								КонецЦикла;
								//Островская Татьяна 13.02.2013 № 15797
								//если не ЗначениеЗаполнено(ВредностьЧасов) Тогда //  14110
								//	ВредностьЧасов = ВыборкаПоОтработанноеВремя.ИтогоВредность;
								//КонецЕсли;
								//Островская Татьяна 13.02.2013 № 15797
								
								
							КонецЦикла;
							//Островская Татьяна 13.02.2013 № 15797
							//если ЗначениеЗаполнено(ВредностьЧасов) Тогда   14110
							//	ПараметрыОтбора = Новый Структура;
							//	ПараметрыОтбора.Вставить("Сотрудник", ВыборкаПоОтработанноеВремя.Сотрудник);
							//	
							//	Массив = ТаблицаЗначенийДубли.НайтиСтроки(ПараметрыОтбора);
							//	если Массив.Количество() = 0 Тогда 
							//		НаборЗаписей1 = Движения.РабочееВремяРаботниковОрганизаций;
							//		Движение = НаборЗаписей1.Добавить();
							//		
							//		// Свойства
							//		
							//		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//		//Движение.Период								= Дата(Год(СтруктураШапкиДокумента.ПериодРегистрации), Месяц(СтруктураШапкиДокумента.ПериодРегистрации), День(КонецМесяца(СтруктураШапкиДокумента.ПериодРегистрации)));
							//		Движение.Период								= Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), День(КонецМесяца(ПериодРегистрации1)));
							//		//Аверсон СВФР-007772
							//		
							//		//О.Т. Аверсон 14.12.2016 № 100
							//		Движение.ДатаНачала = НачалоДня(Движение.Период);
							//		Движение.ДатаОкончания = КонецДня(Движение.Период);
							//		//О.Т. Аверсон 14.12.2016 № 100
							//		// Измерения
							//		Движение.Сотрудник						= ВыборкаПоОтработанноеВремя.Сотрудник;
							//		Движение.Организация					= СтруктураШапкиДокумента.ГоловнаяОрганизация;
							//		
							//		Движение.ВидИспользованияРабочегоВремени	= Справочники.КлассификаторИспользованияРабочегоВремени.Вредность;
							//		Движение.ЧасовВредность = ВредностьЧасов;
							//		Движение.ВЦеломЗаПериод						= Ложь;
							//		Движение.Тариф                              = ВыборкаПоОтработанноеВремя.Тариф;
							//		ТЗДубли = ТаблицаЗначенийДубли.Добавить();
							//		ТЗДубли.Сотрудник = ВыборкаПоОтработанноеВремя.Сотрудник;
							//	КонецЕсли;
							//КонецЕсли;
							//Островская Татьяна 13.02.2013 № 15797
							
							ВредностьЧасов = 0;	
						КонецЦикла;
						
					Иначе
						
						// Данные введены за день.
						////////////////////////////////////////////////////////////////////////
						// Отработанное время
						
						МассивСотрудниковДляСозданияПустыхЗаписей = ПолучитьМассивСотрудниковДляСозданияПустыхЗаписей(СтруктураШапкиДокумента);
						
						//Аверсон ЕАЕ 23.07.2021 СВФР-007772
						//ДеньОкончанияМесяца = День(КонецМесяца(ПериодРегистрации));
						ДеньОкончанияМесяца = День(КонецМесяца(ПериодРегистрации1));
						//Аверсон СВФР-007772
						
						ПустойДокумент = Документы.СдельныйНаряд.ПустаяСсылка();
						
						//Аверсон ЕАЕ 23.07.2021 СВФР-007772
						//НомерДня = День(ДатаНачалаПериода);
						НомерДня = День(ДатаНачалаПериода1);
						//Аверсон СВФР-007772
						
						//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
						//Пока ВыборкаПоОтработанноеВремя.СледующийПоЗначениюПоля("Сотрудник") Цикл
						//- СВЭЙ КДЯ 08.10.19 СВФР-004843
						//+ СВЭЙ КДЯ 08.10.19 СВФР-004843
						Пока ВыборкаПоОтработанноеВремя.Следующий() Цикл
						//- СВЭЙ КДЯ 08.10.19 СВФР-004843
							
							Пока ВыборкаПоОтработанноеВремя.СледующийПоЗначениюПоля("ИндексДня") Цикл
								
								//Аверсон ЕАЕ 23.07.2021 СВФР-007772
								//ОбрабатываемаяДата = Дата(Год(ПериодРегистрации), Месяц(ПериодРегистрации), ВыборкаПоОтработанноеВремя.ИндексДня);
								ОбрабатываемаяДата = Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), ВыборкаПоОтработанноеВремя.ИндексДня);
								//Аверсон СВФР-007772
								
								Если Истина Тогда
									
									Пока ВыборкаПоОтработанноеВремя.Следующий() Цикл
										//толик								
										ДобавитьСтрокуРабочееВремяРаботниковОрганизацийПоДням(СтруктураШапкиДокумента, ВыборкаПоОтработанноеВремя, НаборДвижений);
										
										Если ВыборкаПоОтработанноеВремя.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.НайтиПоНаименованию("Вредность") Тогда
											Продолжить;
										КонецЕсли;
										// по часам
										ВидУчетаВремени = ПолучитьВидУчетаВремениПоКлассификатору(ВыборкаПоОтработанноеВремя.ВидВремени);
										
									КонецЦикла;
								Иначе
								КонецЕсли;
								
							КонецЦикла;
							
							//					НаборГрафикиРаботыПоВидамВремени.Записать();
							НаборДвижений.Записать();
							
						КонецЦикла;
						
					КонецЕсли;
					
				Иначе
					
					ОбщегоНазначения.СообщитьОбОшибке("На следующих работников данные об отработанном времени уже введены: "); 
					//+ СтрокаСотрудников, Отказ, Заголовок);
					
				КонецЕсли;
				НаборДвижений.Записать();
			КонецЕсли;
			//толик
			
			//Аверсон ЕАЕ 16.09.2021 СВФР-008068
			Если РаспределениеИтогом Тогда
				ТЧИсполнители = ЭтотОбъект.ИсполнителиНесколькоВидовРабот;
			Иначе
				ТЧИсполнители = ЭтотОбъект.Исполнители;
			КонецЕсли;
			//Аверсон СВФР-008068
			
			Если ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
				
				//Аверсон ЕАЕ 16.09.2021 СВФР-008068
				//Для Каждого мСтрока Из ЭтотОбъект.Исполнители Цикл
				Для Каждого мСтрока Из ТЧИсполнители Цикл
				//Аверсон СВФР-008068
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//ПрочиеПроцедуры.ДобавитьГрафикиРаботыПоВидамВремени(ЭтотОбъект.ДатаНачалаПериода, ЭтотОбъект.ДатаНачалаПериода, мСтрока.Сотрудник, ЭтотОбъект, Истина);
					ПрочиеПроцедуры.ДобавитьГрафикиРаботыПоВидамВремени(ДатаНачалаПериода1, ДатаНачалаПериода1, мСтрока.Сотрудник, ЭтотОбъект, Истина);
					//Аверсон СВФР-007772
					
				КонецЦикла;
			ИначеЕсли ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням Тогда
				
				//Аверсон ЕАЕ 16.09.2021 СВФР-008068
				//Для Каждого мСтрока Из ЭтотОбъект.Исполнители Цикл
				Для Каждого мСтрока Из ТЧИсполнители Цикл
				//Аверсон СВФР-008068
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//ПрочиеПроцедуры.ДобавитьГрафикиРаботыПоВидамВремени(НачалоМесяца(ЭтотОбъект.ПериодРегистрации), КонецМесяца(ЭтотОбъект.ПериодРегистрации), мСтрока.Сотрудник, ЭтотОбъект, Ложь);
					ПрочиеПроцедуры.ДобавитьГрафикиРаботыПоВидамВремени(НачалоМесяца(ПериодРегистрации1), КонецМесяца(ПериодРегистрации1), мСтрока.Сотрудник, ЭтотОбъект, Ложь);
					//Аверсон СВФР-007772
					Если ОтличаютсяВредныеЧасы Тогда //неверно пишет в регистр вредность 14110					
						если мСтрока.ОтработаноЧасовВредность <> 0 Тогда 
							НаборЗаписей1 = Движения.РабочееВремяРаботниковОрганизаций;
							Движение = НаборЗаписей1.Добавить();
							
							//Движение.Период								= Дата(Год(СтруктураШапкиДокумента.ПериодРегистрации), Месяц(СтруктураШапкиДокумента.ПериодРегистрации), День(КонецМесяца(СтруктураШапкиДокумента.ПериодРегистрации)));
							Движение.Период	= Дата(Год(ПериодРегистрации1), Месяц(ПериодРегистрации1), День(КонецМесяца(ПериодРегистрации1)));
							
							Движение.ДатаНачала = НачалоМесяца(Движение.Период);
							Движение.ДатаОкончания = КонецМесяца(Движение.Период);
							Движение.Сотрудник						= мСтрока.Сотрудник;
							Движение.Организация					= СтруктураШапкиДокумента.ГоловнаяОрганизация;
							
							Движение.ВидИспользованияРабочегоВремени	= Справочники.КлассификаторИспользованияРабочегоВремени.Вредность;
							Движение.ЧасовВредность = мСтрока.ОтработаноЧасовВредность;
							Движение.ВЦеломЗаПериод						= Ложь;
							Движение.Тариф                              = мСтрока.ТарифнаяСтавка;
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			//енд	
			
			// Движения стоит добавлять, если в проведении еще не отказано (отказ =ложь)
			Если Отказ Тогда
				Возврат
			КонецЕсли;
			
			// Фактическая выработка
			
			Если ОтражатьВБухгалтерскомУчете Тогда
				ВыборкаПоРаботникиРегл.Сбросить();
			КонецЕсли;
			Если ОтражатьВУправленческомУчете Тогда
				ВыборкаПоРаботники.Сбросить();
			КонецЕсли;
			
			ДвиженияРегистров(СтруктураШапкиДокумента, ВыборкаПоРаботники, ВыборкаПоРаботникиРегл, ТаблицаРаботРегл);
			//Островская Татьяна 08.05.2013 № Транспорт
			Движения.РаботаАвтомобилей.Очистить();
			НаборДвижений = Движения.РаботаАвтомобилей;
			СуммаСовмещ = 0; 
			СотрСовм = "";
			Для Каждого ТекСтрока из Транспорт Цикл 
				Запись = НаборДвижений.Добавить();
				// Свойства
				
				//Аверсон ЕАЕ 23.07.2021 СВФР-007772
				//Запись.Период = ПериодРегистрации;
				Запись.Период = ПериодРегистрации1;
				//Аверсон СВФР-007772
				
				ЗаполнитьЗначенияСвойств(Запись,ТекСтрока);
				Запись.Регистратор = Ссылка;
				Запись.Куб = ТекСтрока.КубМ;
				если Исполнители.Количество() > 0 Тогда
					Запись.Сотрудник = Исполнители[0].Сотрудник;
					если Стажировщик Тогда 
						Запись.Должность = Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("Стажировщик");
					ИначеЕсли Водитель Тогда 
						Запись.Должность = Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("Водитель автомобиля");
					иначе
						Запись.Должность = Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("Грузчик");
					КонецЕсли;
				КонецЕсли;
				Запись.ДокументОснование = Ссылка;
				
				
				
				Запись.СуммаОплаты = ТекСтрока.СуммаРегл;
				//КонецЕсли;
				Если Отказ Тогда
					Возврат;
				КонецЕсли;
				НаборДвижений.Записать();  
				Если ТекСтрока.СуммаСовм <> 0 Тогда   
					Запись = НаборДвижений.Добавить();
					Запись.Период = ПериодРегистрации1;					
					ЗаполнитьЗначенияСвойств(Запись,ТекСтрока);
					Запись.Регистратор = Ссылка;
					Запись.Куб = ТекСтрока.КубМ;
					Запись.Сотрудник = Исполнители[0].Сотрудник;
					//если Стажировщик Тогда 
					//	Запись.Должность = Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("Стажировщик");
					//ИначеЕсли Водитель Тогда 
					//	Запись.Должность = Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("Водитель автомобиля");
					//иначе
					//	Запись.Должность = Справочники.ДолжностиОрганизаций.НайтиПоНаименованию("Грузчик");
					//КонецЕсли;
					Запись.ДокументОснование = Ссылка;  				
					Запись.СуммаОплаты = ТекСтрока.СуммаСовм; 
					СуммаСовмещ = 	СуммаСовмещ + ТекСтрока.СуммаСовм;
					СотрСовм = Исполнители[0].Сотрудник;
					Если Отказ Тогда
						Возврат;
					КонецЕсли;
					НаборДвижений.Записать();	
				КонецЕсли;
			КонецЦикла;   
			Если СуммаСовмещ <> 0 Тогда 
				//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
				ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(СотрСовм.ФизЛицо, СуммаСовмещ);
				
				//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
				Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду(СокрЛП("Р0111"))) Тогда
					ДобавитьДвижениеПоНДФЛСведенияОДоходах(СотрСовм, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду(СокрЛП("Р0111")),СуммаСовмещ);
				КонецЕсли;
				
				ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СотрСовм, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду(СокрЛП("Р0111")), СуммаСовмещ, ,ПериодРегистрации1);			
			КонецЕсли;
			
			ЗапросВредныеУсл = Новый Запрос;
			ЗапросВредныеУсл.Текст = 
			"ВЫБРАТЬ
			|	СУММА(СдельныйНарядТранспорт.СуммаРегл) КАК СуммаРегл,
			|	СдельныйНарядИсполнители.Сотрудник
			|ИЗ
			|	Документ.СдельныйНаряд.Транспорт КАК СдельныйНарядТранспорт
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
			|		ПО СдельныйНарядТранспорт.Ссылка = СдельныйНарядИсполнители.Ссылка
			|ГДЕ
			|	СдельныйНарядТранспорт.Ссылка = &Ссылка
			|	И СдельныйНарядТранспорт.ВидОплаты = &ВидОплаты
			|
			|СГРУППИРОВАТЬ ПО
			|	СдельныйНарядИсполнители.Сотрудник";
			ЗапросВредныеУсл.УстановитьПараметр("Ссылка",Ссылка);
			ЗапросВредныеУсл.УстановитьПараметр("ВидОплаты",Справочники.ТехнологическиеОперации.НайтиПоНаименованию("Вредность"));
			
			//Аверсон ЕАЕ 14.12.2021 СВФР-008489
			//РезВредныеУсл = ЗапросВредныеУсл.Выполнить().Выбрать();
			ТЗРезВредныеУсл = ЗапросВредныеУсл.Выполнить().Выгрузить();
			
			Если Организация.ИНН = "700067572" Тогда
				СписокСотрудников = ТЗРезВредныеУсл.ВыгрузитьКолонку("Сотрудник");
				ТЗПериодыВБригаде = ПолучитьПериодыРаботыСотрудниковВБригаде(СписокСотрудников, ПериодРегистрации1);
			КонецЕсли;
			
			//пока РезВредныеУсл.Следующий() Цикл
			Для Каждого РезВредныеУсл Из ТЗРезВредныеУсл Цикл
				
				Если Организация.ИНН = "700067572" Тогда
					СтрПериоды = ТЗПериодыВБригаде.Найти(РезВредныеУсл.Сотрудник, "Сотрудник");
				Иначе
					СтрПериоды = Неопределено;	
				КонецЕсли;
			//Аверсон СВФР-008489
				
				ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(РезВредныеУсл.Сотрудник.ФизЛицо, РезВредныеУсл.СуммаРегл);
				
				Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда.КодДоходаНДФЛ) Тогда
					ДобавитьДвижениеПоНДФЛСведенияОДоходах(РезВредныеУсл.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда,РезВредныеУсл.СуммаРегл);
				КонецЕсли;
				
				//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
				ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(РезВредныеУсл.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда, РезВредныеУсл.СуммаРегл, 0,,СтрПериоды);//ОтработаноЧасов); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
				
			КонецЦикла;
			Если Организация.ИНН = "600124787" Тогда 
				ДвиженияТЧ = Новый ТаблицаЗначений;
				ДвиженияТЧ.Колонки.Добавить("ВидРасчета");
				ДвиженияТЧ.Колонки.Добавить("Результат");
				СтрДвиженияТЧ = ДвиженияТЧ.Добавить();
				СтрДвиженияТЧ.ВидРасчета = ВидРасчетаКлассность;
				СтрДвиженияТЧ.Результат = КлассностьСумма;
				
				СтрДвиженияТЧ = ДвиженияТЧ.Добавить();
				СтрДвиженияТЧ.ВидРасчета = ВидРасчетаЭкспедирования;
				СтрДвиженияТЧ.Результат = ЭкспедированиеСумма;
				
				СтрДвиженияТЧ = ДвиженияТЧ.Добавить();
				СтрДвиженияТЧ.ВидРасчета = ВидРасчетаПогрузка;
				СтрДвиженияТЧ.Результат = ПогрузкаВыгрузкаСумма;
				
				СтрДвиженияТЧ = ДвиженияТЧ.Добавить();
				СтрДвиженияТЧ.ВидРасчета = ВидРасчетаРазъездной;
				СтрДвиженияТЧ.Результат = РазъезднойХарактерСумма;
				
				СтрДвиженияТЧ = ДвиженияТЧ.Добавить();
				СтрДвиженияТЧ.ВидРасчета = ВидРасчетаЗаРейсы;
				СтрДвиженияТЧ.Результат = РейсСумма;
				Если Исполнители.Количество()>0 Тогда 
					Для Каждого стрДвижения из ДвиженияТЧ Цикл 
						
						Если Не ЗначениеЗаполнено(стрДвижения.ВидРасчета) Тогда
							ОбщегоНазначения.СообщитьОбОшибке("На закладке ДопДанные не заполнен вид расчета!", Отказ, Заголовок);
						КонецЕсли;
						если не Отказ Тогда 
							если стрДвижения.Результат <> 0 Тогда 
								ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(Исполнители[0].Сотрудник.ФизЛицо, стрДвижения.Результат);
								
								Если ЗначениеЗаполнено(стрДвижения.ВидРасчета.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(Исполнители[0].Сотрудник, стрДвижения.ВидРасчета,стрДвижения.Результат);
								КонецЕсли;
								
								//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(Исполнители[0].Сотрудник, стрДвижения.ВидРасчета, стрДвижения.Результат, 0);//ОтработаноЧасов);
							КонецЕсли;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЕсли;
			//Островская Татьяна 08.05.2013 № Транспорт
			
			//ПСА 12.02.2021 СВФР-007191+++
			Если Праздники или Сверхурочно  или Доплатной или Запчасть или Прочее Тогда //Аверсон ЕАЕ 20.05.2021 СВФР-007544 "или Прочее"
				ВидРасчета_133 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("133");
				ВидРасчета_138 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("138");
				ВидРасчета_139 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("139");
				ВидРасчета_142 = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("142");
				ВидРасчета_21  = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("21"); //ПСА 19.02.2021 СВФР-007228+++
				ВидРасчета_17  = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоКоду("17"); 
				
				//Аверсон ЕАЕ 16.09.2021 СВФР-008068
				Если РаспределениеИтогом Тогда
					ТЧИсполнители = ИсполнителиНесколькоВидовРабот;
				Иначе
					ТЧИсполнители = Исполнители;
				КонецЕсли;
				//Аверсон СВФР-008068
				
				//Аверсон ЕАЕ 14.12.2021 СВФР-008489
				Если Организация.ИНН = "700067572" Тогда
					СписокСотрудников = ТЧИсполнители.ВыгрузитьКолонку("Сотрудник");
					ТЗПериодыВБригаде = ПолучитьПериодыРаботыСотрудниковВБригаде(СписокСотрудников, ПериодРегистрации1);
				КонецЕсли;
				//Аверсон СВФР-008489
				
				//Аверсон ЕАЕ 16.09.2021 СВФР-008068
				//Для Каждого СтрокаТЧ Из Исполнители Цикл
				Для Каждого СтрокаТЧ Из ТЧИсполнители Цикл
				//Аверсон СВФР-008068
				
				Если СтрокаТЧ.СуммаКНачислениюРегл <> 0 Тогда
					
					//Аверсон ЕАЕ 14.12.2021 СВФР-008489
					Если Организация.ИНН = "700067572" Тогда
						СтрПериоды = ТЗПериодыВБригаде.Найти(СтрокаТЧ.Сотрудник, "Сотрудник");
					Иначе
						СтрПериоды = Неопределено;
					КонецЕсли;	
					//Аверсон СВФР-008489
					
						Если Праздники Тогда
							период              = ОпределитьПериод(СтрокаТЧ, ПериодРегистрации1);
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СтрокаТЧ.Сотрудник, ВидРасчета_133, СтрокаТЧ.СуммаКНачислениюРегл, СтрокаТЧ.ОтработаноЧасов,период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СтрокаТЧ.Сотрудник, ВидРасчета_138, СтрокаТЧ.СуммаКНачислениюРегл, 0,период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							Если ЗначениеЗаполнено(ВидРасчета_133.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(СтрокаТЧ.Сотрудник, ВидРасчета_133,СтрокаТЧ.СуммаКНачислениюРегл);
							КонецЕсли;
							Если ЗначениеЗаполнено(ВидРасчета_138.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(СтрокаТЧ.Сотрудник, ВидРасчета_138,СтрокаТЧ.СуммаКНачислениюРегл);
							КонецЕсли;
						КонецЕсли;
						
						//Аверсон ЕАЕ 20.05.2021 СВФР-007544
						Если Прочее Тогда
							период              = ОпределитьПериод(СтрокаТЧ, ПериодРегистрации1);
							Если ЗначениеЗаполнено(ВидРасчетаПрочее) Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СтрокаТЧ.Сотрудник, ВидРасчетаПрочее, СтрокаТЧ.СуммаКНачислениюРегл, СтрокаТЧ.ОтработаноЧасов,период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
								Если ЗначениеЗаполнено(ВидРасчетаПрочее.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(СтрокаТЧ.Сотрудник, ВидРасчетаПрочее,СтрокаТЧ.СуммаКНачислениюРегл);
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//Аверсон СВФР-007544
						
						Если Сверхурочно Тогда
							период              = ОпределитьПериод(СтрокаТЧ, ПериодРегистрации1);
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СтрокаТЧ.Сотрудник, ВидРасчета_139, СтрокаТЧ.СуммаКНачислениюРегл, СтрокаТЧ.ОтработаноЧасов,период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СтрокаТЧ.Сотрудник, ВидРасчета_142, СтрокаТЧ.СуммаКНачислениюРегл, 0, период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							Если ЗначениеЗаполнено(ВидРасчета_139.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(СтрокаТЧ.Сотрудник, ВидРасчета_139,СтрокаТЧ.СуммаКНачислениюРегл);
							КонецЕсли;
							Если ЗначениеЗаполнено(ВидРасчета_142.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(СтрокаТЧ.Сотрудник, ВидРасчета_142,СтрокаТЧ.СуммаКНачислениюРегл);
							КонецЕсли;

						КонецЕсли;
						//ПСА 19.02.2021 СВФР-007228+++
						Если Доплатной Тогда
							период              = ОпределитьПериод(СтрокаТЧ, ПериодРегистрации1);
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СтрокаТЧ.Сотрудник, ВидРасчета_21, СтрокаТЧ.СуммаКНачислениюРегл, 0,период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							Если ЗначениеЗаполнено(ВидРасчета_21.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(СтрокаТЧ.Сотрудник, ВидРасчета_21,СтрокаТЧ.СуммаКНачислениюРегл);
							КонецЕсли;
						КонецЕсли;
						Если Запчасть Тогда
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//период              = ОпределитьПериод(СтрокаТЧ, ПериодРегистрации); 
							период              = ОпределитьПериод(СтрокаТЧ, ПериодРегистрации1);
							//Аверсон СВФР-007772
							
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(СтрокаТЧ.Сотрудник, ВидРасчета_17, СтрокаТЧ.СуммаКНачислениюРегл, 0,период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							Если ЗначениеЗаполнено(ВидРасчета_17.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(СтрокаТЧ.Сотрудник, ВидРасчета_17,СтрокаТЧ.СуммаКНачислениюРегл);
							КонецЕсли;
						КонецЕсли;

						
						ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(СтрокаТЧ.Сотрудник.ФизЛицо, СтрокаТЧ.СуммаКНачислениюРегл);
						
						//Аверсон ЕАЕ 20.05.2021 СВФР-007544
						//Если Праздники или Сверхурочно Тогда
						Если Праздники или Сверхурочно Тогда
						//Аверсон СВФР-007544	
							
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(СтрокаТЧ.Сотрудник.ФизЛицо, СтрокаТЧ.СуммаКНачислениюРегл);
						КонецЕсли;
						//ПСА 19.02.2021 СВФР-007228+++
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;	
			//+++ПСА 12.02.2021 СВФР-007191
		КонецЕсли;
		
		//Сделаем движение по табличной части Прочие доплаты
		Если СтатусДокумента = Перечисления.СтатусДокумента.Рассчитан Тогда
			
			//произведем рассчет вечерних, ночных, выходных , праздничных
			
			//Аверсон-софт, Островская Татьяна 16.03.2012
			Если ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням или ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
				ТаблицаОтрабВремя = СформироватьЗапросРабочееВремяРаботниковОрганизаций().Выгрузить();
			иначе
				ТаблицаОтрабВремя = СформироватьЗапросПоИсполнителиРегл(СтруктураШапкиДокумента).Выгрузить();
			КонецЕсли;
			//Аверсон-софт, Островская Татьяна 16.03.2012
			
			//Аверсон ЕАЕ 14.12.2021 СВФР-008489
			Если Организация.ИНН = "700067572" Тогда
				СписокСотрудников = ТаблицаОтрабВремя.ВыгрузитьКолонку("Сотрудник");
				ТЗПериодыВБригаде = ПолучитьПериодыРаботыСотрудниковВБригаде(СписокСотрудников, ПериодРегистрации1);
			КонецЕсли;
			//Аверсон СВФР-008489
			
			сотрудник = "";
			Для Каждого ТекСтрока Из ТаблицаОтрабВремя Цикл
				
				//Аверсон ЕАЕ 14.12.2021 СВФР-008489
				Если Организация.ИНН = "700067572" Тогда
					СтрПериоды = ТЗПериодыВБригаде.Найти(ТекСтрока.Сотрудник, "Сотрудник");
				Иначе
					СтрПериоды = Неопределено;
				КонецЕсли;	
				//Аверсон СВФР-008489
				
				//Аверсон-софт, Островская Татьяна 16.03.2012
				Если ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням или ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
					//вечерние
					Если ТекСтрока.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы Тогда
						//Аверсон-софт, Островская Татьяна 26.03.2012 
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * ТекСтрока.Часов * ?(мСтрокаУП.ПроцентОплатыВечерних <> 0, мСтрокаУП.ПроцентОплатыВечерних / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						//Аверсон-софт, Островская Татьяна 26.03.2012
						//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
						ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
						
						//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
						Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы.КодДоходаНДФЛ) Тогда
							ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы,СуммаДоплаты);
						КонецЕсли;
						
						//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
						//О.Т. 20.01.2015 № 17786
						//если Организация.ИНН = "191307958" Тогда 
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы, СуммаДоплаты, ТекСтрока.Часов,ТекСтрока.Период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
						//иначе
						//	ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы, СуммаДоплаты, ТекСтрока.Часов);
						//КонецЕсли;
						//О.Т. 20.01.2015 № 17786
					КонецЕсли;
					
					//ночные
					Если ТекСтрока.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы Тогда
						//Аверсон-софт, Островская Татьяна 26.03.2012 
						//Аверсон-софт, Островская Татьяна 08.06.2012 № 15474
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15480
						Оклад = 0;
						ЗапросОкл = Новый Запрос;
						ЗапросОкл.Текст = 
						"ВЫБРАТЬ
						|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник,
						|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Ставка
						|ИЗ
						|	РегистрСведений.ТарифныеСтавкиРаботниковОрганизации.СрезПоследних(&парамДата, ) КАК ТарифныеСтавкиРаботниковОрганизацииСрезПоследних
						|ГДЕ
						|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник = &Сотрудник" ;
						
						//Аверсон ЕАЕ 23.07.2021 СВФР-007772
						//ЗапросОкл.УстановитьПараметр("парамДата",КонецМесяца(ЭтотОбъект.ПериодРегистрации));
						ЗапросОкл.УстановитьПараметр("парамДата",КонецМесяца(ПериодРегистрации1));
						//Аверсон СВФР-007772
						
						ЗапросОкл.УстановитьПараметр("Сотрудник", ТекСтрока.Сотрудник);
						РезОклад = ЗапросОкл.Выполнить().Выбрать();
						пока РезОклад.Следующий() цикл
							Оклад = РезОклад.Ставка; 
						КонецЦикла;
						
						Запрос = Новый Запрос;
						Запрос.Текст = 
						"ВЫБРАТЬ
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Физлицо,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов1,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов2,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов3,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов4,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов5,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов6,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов7,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов8,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов9,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов10,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов11,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов12,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов13,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов14,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов15,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов16,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов17,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов18,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов19,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов20,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов21,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов22,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов23,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов24,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов25,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов26,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов27,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов28,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов29,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов30,
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов31
						|ИЗ
						|	Документ.ВводИндивидуальныхГрафиковРаботыОрганизации.ГрафикРаботы КАК ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы
						|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВводИндивидуальныхГрафиковРаботыОрганизации КАК ВводИндивидуальныхГрафиковРаботыОрганизации
						|		ПО ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка = ВводИндивидуальныхГрафиковРаботыОрганизации.Ссылка
						|ГДЕ
						|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Физлицо = &Физлицо
						|	И ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка.ПериодРегистрации МЕЖДУ &ПериодРегистрации1 И &ПериодРегистрации2
						|	И ВводИндивидуальныхГрафиковРаботыОрганизации.Проведен = ИСТИНА";
						Запрос.УстановитьПараметр("Физлицо",ТекСтрока.Сотрудник.Физлицо);
						
						//Аверсон ЕАЕ 23.07.2021 СВФР-007772
						//Запрос.УстановитьПараметр("ПериодРегистрации1",НачалоМесяца(ЭтотОбъект.ПериодРегистрации));
						//Запрос.УстановитьПараметр("ПериодРегистрации2",КонецМесяца(ЭтотОбъект.ПериодРегистрации));
						Запрос.УстановитьПараметр("ПериодРегистрации1",НачалоМесяца(ПериодРегистрации1));
						Запрос.УстановитьПараметр("ПериодРегистрации2",КонецМесяца(ПериодРегистрации1));
						//Аверсон СВФР-007772
						
						График = Запрос.Выполнить().Выгрузить();
						КоличествоЧасов = 0;
						КоличествоДней = 0;
						Для Каждого СтрокаГрафикаРаботы Из График Цикл
							КоличествоЧасов = 0;
							КоличествоЧасовВечерних = 0;
							КоличествоЧасовНочных = 0;
							КоличествоДней = 0;
							Для ИндексДня = 1 по 31 Цикл
								
								Час = СтрокаГрафикаРаботы["Часов"+Строка(ИндексДня)];
								
								КоличествоЧасов = КоличествоЧасов + Час;
								
								Если Час > 0 Тогда
									КоличествоДней = КоличествоДней + 1;
								КонецЕсли;
								
							КонецЦикла;
						КонецЦикла;
						если не КоличествоДней = 0 тогда
							
							СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад/КоличествоЧасов * ТекСтрока.Часов * ?(мСтрокаУП.ПроцентОплатыНочных <> 0, мСтрокаУП.ПроцентОплатыНочных / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						иначе
							СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * ТекСтрока.Часов * ?(мСтрокаУП.ПроцентОплатыНочных <> 0, мСтрокаУП.ПроцентОплатыНочных / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						КонецЕсли;
						//Аверсон-софт, Островская Татьяна 13.06.2012 № 15480
						//Аверсон-софт, Островская Татьяна 26.03.2012
						//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
						ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
						
						//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
						Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы.КодДоходаНДФЛ) Тогда
							ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы,СуммаДоплаты);
						КонецЕсли;
						
						//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
						//О.Т. 20.01.2015 № 17786
						//если Организация.ИНН = "191307958" Тогда 
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы, СуммаДоплаты, ТекСтрока.Часов,ТекСтрока.Период, СтрПериоды);//Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
						//иначе
						//	ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы, СуммаДоплаты, ТекСтрока.Часов);
						//КонецЕсли; 
						//О.Т. 20.01.2015 № 17786
					КонецЕсли;
					
					//сверхурочные
					Если ТекСтрока.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные Тогда
						//Аверсон-софт, Островская Татьяна 26.03.2012
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * ТекСтрока.Часов, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						//Аверсон-софт, Островская Татьяна 26.03.2012
						
						//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
						ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
						
						//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
						Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСверхурочные.КодДоходаНДФЛ) Тогда
							ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСверхурочные,СуммаДоплаты);
						КонецЕсли;
						
						//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
						//О.Т. 20.01.2015 № 17786
						//если Организация.ИНН = "191307958" Тогда 
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСверхурочные, СуммаДоплаты, ТекСтрока.Часов,ТекСтрока.Период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
						//иначе
						//	ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСверхурочные, СуммаДоплаты, ТекСтрока.Часов);
						//КонецЕсли; 	
						//О.Т. 20.01.2015 № 17786
					КонецЕсли;
					
					//праздники
					Если ТекСтрока.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники Тогда
						//Аверсон-софт, Островская Татьяна 26.03.2012 
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * ТекСтрока.Часов * ?(ТекСтрока.КТУ = 0, 1, ТекСтрока.КТУ / 100), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						//Аверсон-софт, Островская Татьяна 26.03.2012 
						//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций" 
						ВидРасчетаПраздники = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные;
						если Организация.ИНН = "191307958" ИЛИ Организация.ИНН = "701485041" ИЛИ Организация.ИНН = "401166406" ИЛИ Организация.ИНН = "191124885" Тогда //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
							СтрокиТранспорт = Транспорт.НайтиСтроки(Новый Структура("ДатаПл",ТекСтрока.Период));
							СуммаДоплаты = 0;
							Для Каждого стрТранспорт из СтрокиТранспорт Цикл 
								СуммаДоплаты = СуммаДоплаты + стрТранспорт.СуммаРегл;
							КонецЦикла;
							ВидРасчетаПраздники =  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходныеПоГрафику;
						КонецЕсли;
						ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты); 						
						//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
						Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные.КодДоходаНДФЛ) Тогда
							ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные,СуммаДоплаты);
						КонецЕсли;  						
						//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
						//О.Т. 318 						
						//О.Т. 20.01.2015 № 17786
						//если Организация.ИНН = "191307958" Тогда 
						ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ВидРасчетаПраздники, СуммаДоплаты, ТекСтрока.Часов,ТекСтрока.Период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
						//иначе
						//	ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ВидРасчетаПраздники, СуммаДоплаты, ТекСтрока.Часов);
						//КонецЕсли; 	
						//О.Т. 20.01.2015 № 17786 						
						//О.Т. 318
						//СВФР-015204
						если Организация.ИНН = "191307958" ИЛИ Организация.ИНН = "701485041" ИЛИ Организация.ИНН = "401166406" ИЛИ Организация.ИНН = "191124885" Тогда //Аверсон 23.09.2021 КВВ СВФР-008182 ( + 3 УНП к Ремондису)
							СтрокиТранспорт = Транспорт.НайтиСтроки(Новый Структура("ДатаПл",ТекСтрока.Период));
							СуммаДоплаты = 0;
							Для Каждого стрТранспорт из СтрокиТранспорт Цикл 
								СуммаДоплаты = СуммаДоплаты + стрТранспорт.СуммаСовм;
							КонецЦикла;
							ВидРасчетаПраздники =  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходныеПоГрафику;   
							Если СуммаДоплаты <> 0 тогда
								ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
								Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные,СуммаДоплаты);
								КонецЕсли; 	
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ВидРасчетаПраздники, СуммаДоплаты, ТекСтрока.Часов,ТекСтрока.Период, СтрПериоды);						   
							КонецЕсли;
						КонецЕсли;
						//СВФР-015204
					КонецЕсли;
					
					//выходные
					Если ТекСтрока.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни Тогда
						//Аверсон-софт, Островская Татьяна 26.03.2012 
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * ТекСтрока.Часов * ?(ТекСтрока.КТУ = 0, 1, ТекСтрока.КТУ / 100), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						//Аверсон-софт, Островская Татьяна 26.03.2012
						//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"     
						ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);						
						//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
						Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные.КодДоходаНДФЛ) Тогда
							ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные,СуммаДоплаты);
						КонецЕсли;                                                                                        						
						//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
						//О.Т. 20.01.2015 № 17786
						//если Организация.ИНН = "191307958" Тогда 
							ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные, СуммаДоплаты, ТекСтрока.Часов,ТекСтрока.Период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
						//иначе
						//	ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные, СуммаДоплаты, ТекСтрока.Часов);
						//КонецЕсли; 	    
						//О.Т. 20.01.2015 № 17786    						
					КонецЕсли;
				иначе     					
					
					//Аверсон-софт, Островская Татьяна 16.03.2012
					сч = 1;      					
					если не ТекСтрока.Сотрудник = сотрудник тогда 						
						//вечерние
						Пока не сч = 6 цикл
							если сч = 1 тогда
								ВидВремени = ТекСтрока.ВидВремени1Сводно;
								Часов = ТекСтрока.Часов1Сводно;
							ИначеЕсли сч = 2 тогда
								ВидВремени = ТекСтрока.ВидВремени2Сводно;
								Часов = ТекСтрока.Часов2Сводно;
							ИначеЕсли сч = 3 тогда
								ВидВремени = ТекСтрока.ВидВремени3Сводно;
								Часов = ТекСтрока.Часов3Сводно;
							ИначеЕсли сч = 4  тогда
								ВидВремени = ТекСтрока.ВидВремени4Сводно;
								Часов = ТекСтрока.Часов4Сводно;
							ИначеЕсли сч = 5  тогда
								ВидВремени = ТекСтрока.ВидВремени5Сводно;
								Часов = ТекСтрока.Часов5Сводно;
							КонецЕсли;
							
							
							
							
							Если ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы Тогда
								СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * Часов * ?(мСтрокаУП.ПроцентОплатыВечерних <> 0, мСтрокаУП.ПроцентОплатыВечерних / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
								
								//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
								ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
								
								//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
								Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы,СуммаДоплаты);
								КонецЕсли;
								
								//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВечерниеЧасы, СуммаДоплаты, Часов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
								
							КонецЕсли;
							
							//ночные
							Если ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы Тогда
								//Аверсон-софт, Островская Татьяна 08.06.2012 № 15474
								Оклад = 0;
								ЗапросОкл = Новый Запрос;
								ЗапросОкл.Текст = 
								"ВЫБРАТЬ
								|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник,
								|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Ставка
								|ИЗ
								|	РегистрСведений.ТарифныеСтавкиРаботниковОрганизации.СрезПоследних(&парамДата, ) КАК ТарифныеСтавкиРаботниковОрганизацииСрезПоследних
								|ГДЕ
								|	ТарифныеСтавкиРаботниковОрганизацииСрезПоследних.Сотрудник = &Сотрудник" ;
								
								//Аверсон ЕАЕ 23.07.2021 СВФР-007772
								//ЗапросОкл.УстановитьПараметр("парамДата",КонецМесяца(ЭтотОбъект.ПериодРегистрации));
								ЗапросОкл.УстановитьПараметр("парамДата",КонецМесяца(ПериодРегистрации1));
								//Аверсон СВФР-007772
								
								ЗапросОкл.УстановитьПараметр("Сотрудник", ТекСтрока.Сотрудник);
								РезОклад = ЗапросОкл.Выполнить().Выбрать();
								пока РезОклад.Следующий() цикл
									Оклад = РезОклад.Ставка; 
								КонецЦикла;
								Запрос = Новый Запрос;
								Запрос.Текст = 
								"ВЫБРАТЬ
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Физлицо,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов1,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов2,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов3,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов4,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов5,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов6,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов7,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов8,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов9,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов10,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов11,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов12,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов13,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов14,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов15,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов16,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов17,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов18,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов19,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов20,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов21,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов22,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов23,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов24,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов25,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов26,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов27,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов28,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов29,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов30,
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Часов31
								|ИЗ
								|	Документ.ВводИндивидуальныхГрафиковРаботыОрганизации.ГрафикРаботы КАК ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы
								|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВводИндивидуальныхГрафиковРаботыОрганизации КАК ВводИндивидуальныхГрафиковРаботыОрганизации
								|		ПО ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка = ВводИндивидуальныхГрафиковРаботыОрганизации.Ссылка
								|ГДЕ
								|	ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Физлицо = &Физлицо
								|	И ВводИндивидуальныхГрафиковРаботыОрганизацииГрафикРаботы.Ссылка.ПериодРегистрации МЕЖДУ &ПериодРегистрации1 И &ПериодРегистрации2
								|	И ВводИндивидуальныхГрафиковРаботыОрганизации.Проведен = ИСТИНА";
								Запрос.УстановитьПараметр("Физлицо",ТекСтрока.Сотрудник.Физлицо);
								
								//Аверсон ЕАЕ 23.07.2021 СВФР-007772
								//Запрос.УстановитьПараметр("ПериодРегистрации1",НачалоМесяца(ЭтотОбъект.ПериодРегистрации));
								//Запрос.УстановитьПараметр("ПериодРегистрации2",КонецМесяца(ЭтотОбъект.ПериодРегистрации));
								Запрос.УстановитьПараметр("ПериодРегистрации1",НачалоМесяца(ПериодРегистрации1));
								Запрос.УстановитьПараметр("ПериодРегистрации2",КонецМесяца(ПериодРегистрации1));
								//Аверсон СВФР-007772
								
								График = Запрос.Выполнить().Выгрузить();
								КоличествоЧасов = 0;
								КоличествоДней = 0;
								Для Каждого СтрокаГрафикаРаботы Из График Цикл
									КоличествоЧасов = 0;
									КоличествоЧасовВечерних = 0;
									КоличествоЧасовНочных = 0;
									КоличествоДней = 0;
									Для ИндексДня = 1 по 31 Цикл
										
										Час = СтрокаГрафикаРаботы["Часов"+Строка(ИндексДня)];
										
										КоличествоЧасов = КоличествоЧасов + Час;
										
										Если Час > 0 Тогда
											КоличествоДней = КоличествоДней + 1;
										КонецЕсли;
										
									КонецЦикла;
								КонецЦикла;
								если не КоличествоДней = 0 тогда
									
									СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(Оклад/КоличествоЧасов * Часов * ?(мСтрокаУП.ПроцентОплатыНочных <> 0, мСтрокаУП.ПроцентОплатыНочных / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
								иначе
									
									СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * Часов * ?(мСтрокаУП.ПроцентОплатыНочных <> 0, мСтрокаУП.ПроцентОплатыНочных / 100, 1), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
								КонецЕсли; 
								//Аверсон-софт, Островская Татьяна 08.06.2012 № 15474
								
								//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
								ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
								
								//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
								Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы,СуммаДоплаты);
								КонецЕсли;
								
								//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаНочныеЧасы, СуммаДоплаты, Часов,,СтрПериоды);//Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
							
							//сверхурочные
							Если ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные Тогда
								СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * Часов, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
								
								//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
								ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
								
								//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
								Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСверхурочные.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСверхурочные,СуммаДоплаты);
								КонецЕсли;
								
								//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСверхурочные, СуммаДоплаты, Часов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
							
							//праздники
							Если ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники Тогда
								СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * Часов * ?(ТекСтрока.КТУ = 0, 1, ТекСтрока.КТУ / 100), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
								
								//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
								ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
								
								//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
								Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные,СуммаДоплаты);
								КонецЕсли;
								
								//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные, СуммаДоплаты, Часов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
							
							//выходные
							Если ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.ВыходныеДни Тогда
								СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрока.Тариф * Часов * ?(ТекСтрока.КТУ = 0, 1, ТекСтрока.КТУ / 100), Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
								
								//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
								ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ТекСтрока.Сотрудник.ФизЛицо, СуммаДоплаты);
								
								//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
								Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные,СуммаДоплаты);
								КонецЕсли;
								
								//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ТекСтрока.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаПраздничныеИВыходные, СуммаДоплаты, Часов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
							сч = сч + 1;
						КонецЦикла;
					КонецЕсли;
					
					
					//Аверсон-софт, Островская Татьяна 16.03.2012
				КонецЕсли; 		 
				сотрудник = ТекСтрока.Сотрудник;
				
				
				
				//произведем рассчет прочих доплат
				ВыборкаПрочиеДоплаты = СформироватьЗапросПрочиеДоплаты().Выбрать();
				
				//Аверсон ЕАЕ 23.07.2021 СВФР-007772
				//мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации),
				мТС1Разряда = РегистрыСведений.ТарифныеСтавкиПервогоРазрядаОрганизаций.ПолучитьПоследнее(НачалоМесяца(ПериодРегистрации1),
				//Аверсон СВФР-007772
				
				Новый Структура("Организация,ТарифнаяСтавка",Организация,Справочники.ТарифныеСтавкиПервогоРазряда.Основная)).Размер;
				
				Строки = СформироватьЗапросПоПрочимДоплатам(ТекСтрока.Сотрудник, ТекСтрока.Тариф);
				
				Пока ВыборкаПрочиеДоплаты.Следующий() Цикл
					
					// произведем расчет доплат
					СуммаДоплаты = 0;
					Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
						СтруктураПоиска = Новый Структура("Сотрудник, Тариф", ВыборкаПрочиеДоплаты.Сотрудник, ВыборкаПрочиеДоплаты.ТарифнаяСтавка);
					иначе
						СтруктураПоиска = Новый Структура("Сотрудник, Тариф,Период", ВыборкаПрочиеДоплаты.Сотрудник, ВыборкаПрочиеДоплаты.ТарифнаяСтавка,ТекСтрока.Период);
					КонецЕсли;
					
					//Строки = Исполнители.НайтиСтроки(СтруктураПоиска);
					//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
					Строки = ТаблицаОтрабВремя.НайтиСтроки(СтруктураПоиска);
					//заявка №1664
					
					ОтработаноЧасов = 0;  ЧасыРемонт = 0;
					Если ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням или ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
						
						Для Каждого СтрокаТабличнойЧасти из Строки Цикл
							//ОтработаноЧасов = СтрокаТабличнойЧасти.ОтработаноЧасов;
							
							//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
							//Аверсон-софт, Островская Татьяна 26.03.2012 
							Если СтрокаТабличнойЧасти.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда
								ЧасыРемонт = СтрокаТабличнойЧасти.Часов;
							КонецЕсли;
							
							Если СтрокаТабличнойЧасти.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								ОтработаноЧасов = ОтработаноЧасов+СтрокаТабличнойЧасти.Часов;
							КонецЕсли;
							//заявка №1664
							//Аверсон-софт, Островская Татьяна 26.03.2012 
						КонецЦикла;
						//Аверсон-софт, Островская Татьяна 16.03.2012
					иначе
						Для Каждого СтрокаТабличнойЧасти из Строки Цикл
							//ОтработаноЧасов = СтрокаТабличнойЧасти.ОтработаноЧасов;
							
							//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
							Если СтрокаТабличнойЧасти.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда
								ЧасыРемонт = СтрокаТабличнойЧасти.Часов;
							КонецЕсли;
							
							Если СтрокаТабличнойЧасти.ВидВремени1Сводно = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								ОтработаноЧасов = СтрокаТабличнойЧасти.Часов1Сводно;
							ИначеЕсли  СтрокаТабличнойЧасти.ВидВремени2Сводно = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								ОтработаноЧасов = СтрокаТабличнойЧасти.Часов2Сводно;
							ИначеЕсли  СтрокаТабличнойЧасти.ВидВремени3Сводно = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								ОтработаноЧасов = СтрокаТабличнойЧасти.Часов3Сводно;
							ИначеЕсли  СтрокаТабличнойЧасти.ВидВремени4Сводно = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								ОтработаноЧасов = СтрокаТабличнойЧасти.Часов4Сводно;
							ИначеЕсли  СтрокаТабличнойЧасти.ВидВремени5Сводно = Справочники.КлассификаторИспользованияРабочегоВремени.Работа Тогда
								ОтработаноЧасов = СтрокаТабличнойЧасти.Часов5Сводно;
							КонецЕсли;
							//заявка №1664
							
						КонецЦикла;
					КонецЕсли;
					
					//Аверсон-софт, Островская Татьяна 16.03.2012
					
					Если ВыборкаПрочиеДоплаты.ПроцентЗаСтаж <> 0 Тогда
						//СуммаДоплаты = Окр(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентЗаСтаж / 100, 0, 1);
						//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * (ОтработаноЧасов + ЧасыРемонт) * ВыборкаПрочиеДоплаты.ПроцентЗаСтаж / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						//заявка №1664
						если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаСтажРаботыРабочие.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаСтажРаботыРабочие,СуммаДоплаты);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаСтажРаботыРабочие, СуммаДоплаты, ОтработаноЧасов + ЧасыРемонт,,СтрПериоды);//Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаСтажРаботыРабочие, СуммаДоплаты, ОтработаноЧасов + ЧасыРемонт,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентВредныеУсловияТруда <> 0 Тогда
						//Движения.ОсновныеНачисленияРаботниковОрганизаций
						ПоДням =  ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням или ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень;
						Если ?(ПоДням, не ТекСтрока.ВидВремени = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы,истина) Тогда
							//О.Т. Аверсон 16.05.2018 № 1953
							Запрос = Новый Запрос;
							
							СотрудникиТекст = 
							"ВЫБРАТЬ
							|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Период
							|ИЗ
							|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(&Период, ) КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
							|ГДЕ
							|	ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник = &Сотрудник
							|	И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ИспользуетсяВНаряде = &ИспользуетсяВНаряде
							|	И ВЫБОР
							|			КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ПериодЗавершения <= &парамНачало
							|					И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
							|				ТОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ДействиеЗавершения
							|			ИНАЧЕ ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Действие
							|		КОНЕЦ <> &Действие
							|	И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета = &ВидРасчета";
							
							Запрос.Текст = СотрудникиТекст;
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//Запрос.УстановитьПараметр("Период", КонецМесяца(ПериодРегистрации));
							Запрос.УстановитьПараметр("Период", КонецМесяца(ПериодРегистрации1));
							//Аверсон СВФР-007772
							
							Запрос.УстановитьПараметр("Сотрудник", ВыборкаПрочиеДоплаты.Сотрудник);
							Запрос.УстановитьПараметр("ИспользуетсяВНаряде", Истина);
							Запрос.УстановитьПараметр("Действие", Перечисления.ВидыДействияСНачислением.Прекратить);
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//Запрос.УстановитьПараметр("парамНачало", НачалоМесяца(ПериодРегистрации));
							Запрос.УстановитьПараметр("парамНачало", НачалоМесяца(ПериодРегистрации1));
							//Аверсон СВФР-007772
							
							Запрос.УстановитьПараметр("ВидРасчета",  ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда);
							
							Результат = Запрос.Выполнить().Выбрать();
							ДатаОтсчетаВредности = Дата(1,1,1);
							Пока Результат.Следующий() Цикл 
								ДатаОтсчетаВредности = Результат.Период;
							КонецЦикла;
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//ДатаНачалаВр = Макс(ПериодРегистрации,ДатаОтсчетаВредности);
							ДатаНачалаВр = Макс(ПериодРегистрации1,ДатаОтсчетаВредности);
							//Аверсон СВФР-007772
							
							СотрудникиТекст = СтрЗаменить(СотрудникиТекст,"КОНЕЦ <> &Действие","КОНЕЦ = &Действие");
							Запрос.УстановитьПараметр("ИспользуетсяВНаряде", Ложь);
							Запрос.Текст = СотрудникиТекст;
							Результат = Запрос.Выполнить().Выбрать();
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//ДатаОкончанияВредности = КонецМесяца(ПериодРегистрации);
							ДатаОкончанияВредности = КонецМесяца(ПериодРегистрации1);
							//Аверсон СВФР-007772
							
							Пока Результат.Следующий() Цикл 
								Если ДатаОтсчетаВредности < КонецДня(Результат.Период) Тогда 
									ДатаОкончанияВредности = КонецДня(Результат.Период);
								КонецЕсли;
							КонецЦикла;
							
							//Аверсон ЕАЕ 23.07.2021 СВФР-007772
							//ДатаОкончанияВр = Мин(ДатаОкончанияВредности,КонецМесяца(ПериодРегистрации));
							ДатаОкончанияВр = Мин(ДатаОкончанияВредности,КонецМесяца(ПериодРегистрации1));
							//Аверсон СВФР-007772
							
							//О.Т. Аверсон 16.05.2018 № 1953
							
							Если ?(ПоДням, ДатаОтсчетаВредности <= ТекСтрока.Период и ДатаОкончанияВр > ТекСтрока.Период, истина) Тогда   
								если ОтличаютсяВредныеЧасы  Тогда
									Если ЗначениеЗаполнено(СтрокаТабличнойЧасти.ИтогоВредность) Тогда 
										Если Дата < Дата(2016,07,01) Тогда //О.Т. Аверсон 17.03.2016 № 949
											СуммаДоплаты = Окр(Окр(мТС1Разряда * ВыборкаПрочиеДоплаты.ПроцентВредныеУсловияТруда / 100, 2) * СтрокаТабличнойЧасти.ИтогоВредность, 0, 1);
										иначе
											СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ОбщегоНазначения.ОкруглитьЗначение2016(мТС1Разряда * ВыборкаПрочиеДоплаты.ПроцентВредныеУсловияТруда / 100, Дата) * СтрокаТабличнойЧасти.ИтогоВредность, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
										КонецЕсли;
									иначе
										СуммаДоплаты = 0;
									КонецЕсли;
								Иначе
									Если Дата < Дата(2016,07,01) Тогда //О.Т. Аверсон 17.03.2016 № 949
										СуммаДоплаты = Окр(Окр(мТС1Разряда * ВыборкаПрочиеДоплаты.ПроцентВредныеУсловияТруда / 100, 2) * ОтработаноЧасов, 0, 1);
									иначе
										СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ОбщегоНазначения.ОкруглитьЗначение2016(мТС1Разряда * ВыборкаПрочиеДоплаты.ПроцентВредныеУсловияТруда / 100, Дата) * ОтработаноЧасов, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
									КонецЕсли;	
								КонецЕсли;
							иначе
								СуммаДоплаты = 0;
							КонецЕсли;
							если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
								//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
								ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
								
								//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
								Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда.КодДоходаНДФЛ) Тогда
									ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда,СуммаДоплаты);
								КонецЕсли;
								
								//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
								Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод или ОтличаютсяВредныеЧасы Тогда
									ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда, СуммаДоплаты, ОтработаноЧасов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
								иначе
									ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаВредныеУсловияТруда, СуммаДоплаты, ОтработаноЧасов,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентПремии <> 0 Тогда
						СуммаДоплатРемонт = 0;
						
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентПремии / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						
						//заявка №2049 (база заявок Кристалла) Дмитрук О.Г.
						СуммаДоплатРемонт = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ЧасыРемонт * 20 / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						//заявка №2049
						если СуммаДоплаты + СуммаДоплатРемонт <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты + СуммаДоплатРемонт);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПремияРабочимИзФОТ.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПремияРабочимИзФОТ,СуммаДоплаты + СуммаДоплатРемонт);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПремияРабочимИзФОТ, СуммаДоплаты + СуммаДоплатРемонт, ОтработаноЧасов + ЧасыРемонт,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПремияРабочимИзФОТ, СуммаДоплаты + СуммаДоплатРемонт, ОтработаноЧасов + ЧасыРемонт,ТекСтрока.Период, СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентЗаРуководствоБригадой <> 0 Тогда
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентЗаРуководствоБригадой / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРуководствоБригадой.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРуководствоБригадой,СуммаДоплаты);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРуководствоБригадой, СуммаДоплаты, ОтработаноЧасов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРуководствоБригадой, СуммаДоплаты, ОтработаноЧасов,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
						КонецЕсли;
												
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентЗаКлассность <> 0 Тогда
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентЗаКлассность / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаКлассность.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаКлассность,СуммаДоплаты);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаКлассность, СуммаДоплаты, ОтработаноЧасов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаКлассность, СуммаДоплаты, ОтработаноЧасов,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентЗаПрофмастерство <> 0 Тогда
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентЗаПрофмастерство / 100, Дата, 1); //О.Т. Аверсон 17.03.2016 № 949
						если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаПрофмастерство.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаПрофмастерство,СуммаДоплаты);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаПрофмастерство, СуммаДоплаты, ОтработаноЧасов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НадбавкаЗаПрофмастерство, СуммаДоплаты, ОтработаноЧасов,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентЗаУчеличенныйОбъем <> 0 Тогда
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентЗаУчеличенныйОбъем / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаУвеличениеОбъемовРабот.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаУвеличениеОбъемовРабот,СуммаДоплаты);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаУвеличениеОбъемовРабот, СуммаДоплаты, ОтработаноЧасов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаУвеличениеОбъемовРабот, СуммаДоплаты, ОтработаноЧасов,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентЗаЭкспедированиеГрузов <> 0 Тогда
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентЗаЭкспедированиеГрузов / 100, Дата, 1); //О.Т. Аверсон 17.03.2016 № 949
						если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаЭкспедированиеГрузов.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаЭкспедированиеГрузов,СуммаДоплаты);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаЭкспедированиеГрузов, СуммаДоплаты, ОтработаноЧасов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаЭкспедированиеГрузов, СуммаДоплаты, ОтработаноЧасов,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентЗаРаботуВЗимнееВремя <> 0 Тогда
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентЗаРаботуВЗимнееВремя / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРаботуВЗимнееВремя.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРаботуВЗимнееВремя,СуммаДоплаты);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРаботуВЗимнееВремя, СуммаДоплаты, ОтработаноЧасов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаРаботуВЗимнееВремя, СуммаДоплаты, ОтработаноЧасов,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
					Если ВыборкаПрочиеДоплаты.ПроцентЗаСовмещение <> 0 Тогда
						СуммаДоплаты = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПрочиеДоплаты.ТарифнаяСтавка * ОтработаноЧасов * ВыборкаПрочиеДоплаты.ПроцентЗаСовмещение / 100, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
						если СуммаДоплаты <> 0 Тогда //О.Т.(К) 16.02.2015
							//добавить движение по регистру накопления "ВзаиморасчетыСРаботникамиОрганизаций"
							ДобавитьДвижениеПоВзаиморасчетыСРаботникамиОрганизаций(ВыборкаПрочиеДоплаты.ФизЛицо, СуммаДоплаты);
							
							//добавить движение по регистру накопления "НДФЛСведенияОДоходах"
							Если ЗначениеЗаполнено(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСовмещениеПрофессий.КодДоходаНДФЛ) Тогда
								ДобавитьДвижениеПоНДФЛСведенияОДоходах(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСовмещениеПрофессий,СуммаДоплаты);
							КонецЕсли;
							
							//добавить движение по регистру расчета "ОсновныеНачисленияРаботниковОрганизаций"
							Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСовмещениеПрофессий, СуммаДоплаты, ОтработаноЧасов,,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							иначе
								ДобавитьДвижениеПоОсновныеНачисленияРаботниковОрганизаций(ВыборкаПрочиеДоплаты.Сотрудник, ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ДоплатаЗаСовмещениеПрофессий, СуммаДоплаты, ОтработаноЧасов,ТекСтрока.Период,СтрПериоды); //Аверсон ЕАЕ 14.12.2021 СВФР-008489 параметр СтрПериоды
							КонецЕсли;	
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;	
			КонецЦикла;
		КонецЕсли;
	КонецЕсли;
	
	//Аверсон ЕАЕ 02.04.2025 СВФР-014085
	//Бобруйскводоканал
	Если Организация.ИНН = "790041382" Тогда
		СформироватьДвиженияДанныеДляСвода();
	КонецЕсли;
	//Аверсон 790041382
	
КонецПроцедуры // ОбработкаПроведения()

Функция СформироватьЗапросПоНачислениям()
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
		ДатаНачалаПериода1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
		ДатаНачалаПериода1 = ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Запрос = Новый Запрос;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	НачалоПериода.Сотрудник,
	|	НачалоПериода.ВидРасчета,
	|	НачалоПериода.ПериодДействияНачало,
	|	ЕСТЬNULL(КонецПериода.ПериодДействияКонец, &ДатаОкончанияСобытия) КАК ПериодДействияКонец
	|ИЗ
	|	(ВЫБРАТЬ
	|		СрезПервых.Сотрудник КАК Сотрудник,
	|		СрезПервых.Период КАК ПериодДействияНачало,
	|		СрезПервых.ВидРасчета КАК ВидРасчета
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ПлановыеНачисления.Сотрудник КАК Сотрудник,
	|			ПлановыеНачисления.Период КАК Период,
	|			ПлановыеНачисления.ВидРасчета КАК ВидРасчета,
	|			ПлановыеНачисления.ПериодЗавершения КАК ПериодЗавершения,
	|			ПлановыеНачисления.ВидРасчетаЗавершения КАК ВидРасчетаЗавершения
	|		ИЗ
	|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПервых(
	|				&ДатаНачалаСобытия,
	|				Сотрудник В
	|					(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|						СдельныйНарядИсполнители.Сотрудник
	|					ИЗ
	|						Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|					ГДЕ
	|						СдельныйНарядИсполнители.Ссылка = &ДокументСсылка)) КАК ПлановыеНачисления
	|		ГДЕ
	|			ПлановыеНачисления.ВидРасчета.СпособРасчета = &СпособРасчета
	|			И ПлановыеНачисления.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)) КАК СрезПервых
	|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|				ПлановыеНачисления.Сотрудник КАК Сотрудник
	|			ИЗ
	|				РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
	|					&ДатаНачалаСобытия,
	|					Сотрудник В
	|						(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|							СдельныйНарядИсполнители.Сотрудник
	|						ИЗ
	|							Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|						ГДЕ
	|							СдельныйНарядИсполнители.Ссылка = &ДокументСсылка)) КАК ПлановыеНачисления
	|			ГДЕ
	|				ПлановыеНачисления.ВидРасчета.СпособРасчета = &СпособРасчета
	|				И ПлановыеНачисления.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)) КАК СрезПоследних
	|			ПО СрезПервых.Сотрудник = СрезПоследних.Сотрудник
	|	ГДЕ
	|		СрезПоследних.Сотрудник ЕСТЬ NULL 
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ПлановыеНачисления.Сотрудник,
	|		ВЫБОР
	|			КОГДА ПлановыеНачисления.Период >= &ДатаНачалаСобытия
	|				ТОГДА ПлановыеНачисления.Период
	|			ИНАЧЕ &ДатаНачалаСобытия
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА ПлановыеНачисления.ПериодЗавершения <> &НачальнаяДата
	|					И ПлановыеНачисления.ПериодЗавершения < &ДатаОкончанияСобытия
	|				ТОГДА ПлановыеНачисления.ВидРасчетаЗавершения
	|			ИНАЧЕ ПлановыеНачисления.ВидРасчета
	|		КОНЕЦ
	|	ИЗ
	|		РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
	|			&ДатаНачалаСобытия,
	|			Сотрудник В
	|				(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|					СдельныйНарядИсполнители.Сотрудник
	|				ИЗ
	|					Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|				ГДЕ
	|					СдельныйНарядИсполнители.Ссылка = &ДокументСсылка)) КАК ПлановыеНачисления
	|	ГДЕ
	|		ПлановыеНачисления.ВидРасчета.СпособРасчета = &СпособРасчета) КАК НачалоПериода
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			ПлановыеНачисления.Сотрудник КАК Сотрудник,
	|			ПлановыеНачисления.Период КАК ПериодДействияКонец
	|		ИЗ
	|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
	|				&ДатаОкончанияСобытия,
	|				Сотрудник В
	|					(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|						СдельныйНарядИсполнители.Сотрудник
	|					ИЗ
	|						Документ.СдельныйНаряд.Исполнители КАК СдельныйНарядИсполнители
	|					ГДЕ
	|						СдельныйНарядИсполнители.Ссылка = &ДокументСсылка)) КАК ПлановыеНачисления
	|		ГДЕ
	|			ПлановыеНачисления.ВидРасчета.СпособРасчета = &СпособРасчета
	|			И ПлановыеНачисления.Действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)) КАК КонецПериода
	|		ПО НачалоПериода.Сотрудник = КонецПериода.Сотрудник";
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Запрос.УстановитьПараметр("ДатаНачалаСобытия", ?(СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень,ДатаНачалаПериода,ПериодРегистрации));
	//Запрос.УстановитьПараметр("ДатаОкончанияСобытия", ?(СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень,ДатаНачалаПериода,КонецМесяца(ПериодРегистрации)));
	Запрос.УстановитьПараметр("ДатаНачалаСобытия", ?(СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень,ДатаНачалаПериода1,ПериодРегистрации1));
	Запрос.УстановитьПараметр("ДатаОкончанияСобытия", ?(СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень,ДатаНачалаПериода1,КонецМесяца(ПериодРегистрации1)));
	//Аверсон СВФР-007772
	
	Запрос.УстановитьПараметр("ДокументСсылка", Ссылка);
	Запрос.УстановитьПараметр("НачальнаяДата", '00010101');
	Запрос.УстановитьПараметр("СпособРасчета", Перечисления.СпособыРасчетаОплатыТруда.СдельныйЗаработок);
	Запрос.Текст = ТекстЗапроса;
	
	Возврат Запрос.Выполнить().Выбрать();
	
КонецФункции // СформироватьЗапросПрочинеДоплаты()

Процедура ОбработкаУдаленияПроведения(Отказ)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(ЭтотОбъект.МесяцНачислений) Тогда
		ПериодРегистрации1 = ЭтотОбъект.МесяцНачислений;
		ДатаНачалаПериода1 = ЭтотОбъект.МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ЭтотОбъект.ПериодРегистрации;
		ДатаНачалаПериода1 = ЭтотОбъект.ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	// удалим движения
	УдалитьДвижения();
	
	//толик
	//	УдалитьЗаписиГрафика();	
	//	УдалитьЗаписиЗаПериодДокумента();
	
	Если ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
		Для Каждого мСтрока Из ЭтотОбъект.Исполнители Цикл
			//ПрочиеПроцедуры.ДобавитьГрафикиРаботыПоВидамВремени(ЭтотОбъект.ДатаНачалаПериода, ЭтотОбъект.ДатаНачалаПериода, мСтрока.Сотрудник, ЭтотОбъект, Истина);
			ПрочиеПроцедуры.ДобавитьГрафикиРаботыПоВидамВремени(ДатаНачалаПериода1, ДатаНачалаПериода1, мСтрока.Сотрудник, ЭтотОбъект, Истина);
			
		КонецЦикла;
	ИначеЕсли ЭтотОбъект.СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням Тогда
		Для Каждого мСтрока Из ЭтотОбъект.Исполнители Цикл
			
			//Аверсон ЕАЕ 23.07.2021 СВФР-007772
			//ПрочиеПроцедуры.ДобавитьГрафикиРаботыПоВидамВремени(НачалоМесяца(ЭтотОбъект.ПериодРегистрации), КонецМесяца(ЭтотОбъект.ПериодРегистрации), мСтрока.Сотрудник, ЭтотОбъект, Ложь);
			ПрочиеПроцедуры.ДобавитьГрафикиРаботыПоВидамВремени(НачалоМесяца(ПериодРегистрации1), КонецМесяца(ПериодРегистрации1), мСтрока.Сотрудник, ЭтотОбъект, Ложь);
			//Аверсон СВФР-007772
			
		КонецЦикла;
	КонецЕсли;
	//енд	
	
	Если Не ЗначениеЗаполнено(СпособВводаДанных) Тогда
		СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод
	КонецЕсли;
	
КонецПроцедуры // ОбработкаУдаленияПроведения()

///толик
// добавил процедуры для автоматического перерасчета нарядов и удалил их из формы

Процедура РаботникиРассчитать() Экспорт
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ДатаНачалаПериода1 = МесяцНачислений;
	Иначе
		ДатаНачалаПериода1 = ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Если Исполнители.Количество() = 0 Тогда
		Возврат
	КонецЕсли;
	
	ОбновитьСуммуОтработанныхДнейИЧасовДляВсехСтрок();
	
	// получим массив коэффициентов распределения
	МассивКТУ	= Новый Массив;
	ПоТарифу	= 0;
	ТарифнаяЧасть = 0; ИтогОтработанныхЧасов = 0;
	//+ СВЭЙ КДЯ 07.10.19 СВФР-004860
	ТарифнаяЧастьСКТУ = 0;
	ЧастьСКТУ = 0;
	Если РасчетСделкиСКТУиЧасами Тогда
		ТарифнаяЧастьСКТУ = 0;
	КонецЕсли; 
	//- СВЭЙ КДЯ 07.10.19 СВФР-004860

	
	//Очищение колонки "Сумма к начислению"
	Для Каждого ТекСтрокаИсполнители Из Исполнители Цикл
		Если ОтражатьВБухгалтерскомУчете Тогда
			ТекСтрокаИсполнители.СуммаКНачислениюРегл	= 0;
		Иначе
			ТекСтрокаИсполнители.СуммаКНачислению		= 0;
		КонецЕсли;
	КонецЦикла;
	ОтработаноЧасов  = 0;
	
	Для Каждого ТекСтрокаИсполнители Из Исполнители Цикл
		Если ТипНаряда = 0 Тогда
			Если РаспределениеПриработка = Истина и ПропорциональноОтработанномуВремени = Истина Тогда
				Предупреждение("Порядок расчета должен быть установлен один!");
				Возврат;
			КонецЕСли;			
			
			Если УчитыватьОтработанноеВремя Тогда
				Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
					
					ОтработаноЧасов  = 0;
					
					Для сч = 1 По 5 Цикл
						
						Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа ИЛИ
							ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники ИЛИ
							ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные ИЛИ
							ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы ИЛИ
							ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы Тогда
							
							ОтработаноЧасов = ОтработаноЧасов + ТекСтрокаИсполнители ["Часов" + Сч]
							
						КонецЕсли;
						
					КонецЦикла;
					
					//+ СВЭЙ КДЯ 07.10.19 СВФР-004860
					ТекСтрокаИсполнители.ОтработаноЧасов = ОтработаноЧасов;
					//- СВЭЙ КДЯ 07.10.19 СВФР-004860
					
					
				ИначеЕсли СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
					
					//Аверсон ЕАЕ 23.07.2021 СВФР-007772
					//ОтработаноЧасов = ВычислитьКоличествоЧасовВЯчейке( ТекСтрокаИсполнители, День( ДатаНачалаПериода ) );
					ОтработаноЧасов = ВычислитьКоличествоЧасовВЯчейке( ТекСтрокаИсполнители, День( ДатаНачалаПериода1 ) );
					//Аверсон СВФР-007772
					
				Иначе	
					ОтработаноЧасов = ТекСтрокаИсполнители.ОтработаноЧасов
				КонецЕсли;
				ИтогОтработанныхЧасов = ИтогОтработанныхЧасов + ОтработаноЧасов;
				
				Если РаспределениеПриработка = Истина Тогда
					ТарифнаяЧасть = ТарифнаяЧасть + ОбщегоНазначения.ОкруглитьЗначение2016(    // - Сумма Графы В
								ТекСтрокаИсполнители.ТарифнаяСтавка * ОтработаноЧасов, Дата, 1 ); //О.Т. Аверсон 17.03.2016 № 949
					//+ СВЭЙ КДЯ 07.10.19 СВФР-004860
					Если РасчетСделкиСКТУиЧасами Тогда
						ТарифнаяЧастьСКТУ = ТарифнаяЧастьСКТУ + ОбщегоНазначения.ОкруглитьЗначение2016(   // - Сумма Графы Д
									ТекСтрокаИсполнители.ТарифнаяСтавка * ОтработаноЧасов * ТекСтрокаИсполнители.КТУ, Дата, 1 ); //О.Т. Аверсон 17.03.2016 № 949
					КонецЕсли; 
					//- СВЭЙ КДЯ 07.10.19 СВФР-004860
					Если РасчетЧасовсКТУ ТОгда
						ЧастьСКТУ = ЧастьСКТУ + Окр(ОтработаноЧасов * ТекСтрокаИсполнители.КТУ,2); 
					КОнецЕсли;
				КонецЕсли;
				Если Организация.ИНН = "400080082" 
						//+ СВЭЙ КДЯ 07.10.19 СВФР-004860
						ИЛИ РасчетСделкиСКТУиЧасами 
						//- СВЭЙ КДЯ 07.10.19 СВФР-004860
					Тогда //О.Т. Аверсон 02.11.2017 № 1183
					ТекСтрокаИсполнители.ОплатаЗаОтработанноеВремя = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ТарифнаяСтавка * ОтработаноЧасов,Дата);
				КонецЕсли;
				
			КонецЕсли;
			
		ИначеЕсли ТипНаряда = 1 Тогда
			Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
				
				ОтработаноЧасов  = 0;
				
				Для сч = 1 По 5 Цикл
					
					Если ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа ИЛИ
						ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники ИЛИ
						ТекСтрокаИсполнители["ВидВремени" + Сч] = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные Тогда
						
						ОтработаноЧасов = ОтработаноЧасов + ТекСтрокаИсполнители ["Часов" + Сч]
						
					КонецЕсли;
					
				КонецЦикла;
				
			ИначеЕсли СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
				
				//Аверсон ЕАЕ 23.07.2021 СВФР-007772
				//ОтработаноЧасов = ВычислитьКоличествоЧасовВЯчейке(ТекСтрокаИсполнители, День(ДатаНачалаПериода));
				ОтработаноЧасов = ВычислитьКоличествоЧасовВЯчейке(ТекСтрокаИсполнители, День(ДатаНачалаПериода1));
				//Аверсон СВФР-007772
				
			Иначе	
				ОтработаноЧасов = ТекСтрокаИсполнители.ОтработаноЧасов
			КонецЕсли;
			
			ЧасовойТариф = ТекСтрокаИсполнители.ТарифнаяСтавка;
			Если Дата < Дата(2016,07,01) Тогда 
				ТекСтрокаИсполнители.СуммаКНачислениюРегл = Окр(ЧасовойТариф * ?(УчитыватьКТУ, ?(ТекСтрокаИсполнители.КТУ = 0 или ТекСтрокаИсполнители.КТУ = 1, 1, ТекСтрокаИсполнители.КТУ / 100) , 1) * ОтработаноЧасов,0,1);
			иначе
				ТекСтрокаИсполнители.СуммаКНачислениюРегл = ОбщегоНазначения.ОкруглитьЗначение2016(ЧасовойТариф * ?(УчитыватьКТУ, ?(ТекСтрокаИсполнители.КТУ = 0 или ТекСтрокаИсполнители.КТУ = 1, 1, ТекСтрокаИсполнители.КТУ / 100) , 1) * ОтработаноЧасов,Дата);//О.Т. Аверсон 17.03.2016 № 949
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	Если ТипНаряда = 0 Тогда
		
		КРП = 0; СуммаРаспределения = 0;
		
		//подсчитаем КРП
		Если РаспределениеПриработка = Истина Тогда
			СуммаПриработка = 0; 
			Если ОтражатьВБухгалтерскомУчете = Истина Тогда
				СуммаПриработка = Выработка.Итог("СуммаРегл") - ТарифнаяЧасть; // - Сумма Графы Ж
			Иначе
				СуммаПриработка = Выработка.Итог("Сумма") - ТарифнаяЧасть;     // - Сумма Графы Ж
			КонецЕСли;
			Если РасчетЧасовсКТУ = 1 Тогда
				СуммаПриработка = Выработка.Итог("СуммаРегл");
			КонецЕсли;
			
			//+ СВЭЙ КДЯ 07.10.19 СВФР-004860
			Если РасчетСделкиСКТУиЧасами Тогда
				
				Если Не ТарифнаяЧастьСКТУ = 0 Тогда
					КРП = Окр( СуммаПриработка / ТарифнаяЧастьСКТУ, 5, 1 );  // - Значение Графы Е
				КонецЕСли;
				
			Иначе	
			//- СВЭЙ КДЯ 07.10.19 СВФР-004860
				
				Если Не ТарифнаяЧасть = 0 Тогда
					КРП = Окр(СуммаПриработка / ТарифнаяЧасть, 5, 1);
				КонецЕСли;
				
			//+ СВЭЙ КДЯ 07.10.19 СВФР-004860
			КонецЕсли; // РасчетСделкиСКТУиЧасами
			//- СВЭЙ КДЯ 07.10.19 СВФР-004860
			
		ИначеЕсли ПропорциональноОтработанномуВремени = Истина Тогда
			СуммаСделки = 0;
			Если ОтражатьВБухгалтерскомУчете = Истина Тогда
				СуммаСделки = Выработка.Итог("СуммаРегл");
			Иначе
				СуммаСделки = Выработка.Итог("Сумма");
			КонецЕСли;
			Если Не ИтогОтработанныхЧасов = 0 Тогда
				КРП = Окр(СуммаСделки / ИтогОтработанныхЧасов, 5, 1);
			КонецЕСли;
		КонецЕСли;
		//О.Т. Аверсон 02.11.2017 № 1183
		Если Организация.ИНН = "400080082" Тогда 
			Если ОтражатьВБухгалтерскомУчете Тогда 
				Коэффициент = Окр(Выработка.Итог("СуммаРегл") / Исполнители.Итог("ОплатаЗаОтработанноеВремя"),4);
			Иначе 
				Коэффициент = Окр(Выработка.Итог("Сумма") / Исполнители.Итог("ОплатаЗаОтработанноеВремя"),4);
			КонецЕсли;
		КонецЕсли;
		//О.Т. Аверсон 02.11.2017 № 1183
		
		//распределение сдельной зарплаты по сотрудникам
		Для Каждого ТекСтрокаИсполнители Из Исполнители Цикл
			ЗП = 0;
			Если РаспределениеПриработка = Истина Тогда 
				Если не УчитыватьОтработанноеВремя и УчитыватьКТУ Тогда
					Если ОтражатьВБухгалтерскомУчете = Истина Тогда
						
						ЗП = Выработка.Итог("СуммаРегл")*?(ТекСтрокаИсполнители.КТУ=0,1,ТекСтрокаИсполнители.КТУ)/100;
					Иначе 
						ЗП = Выработка.Итог("Сумма")*?(ТекСтрокаИсполнители.КТУ=0,1,ТекСтрокаИсполнители.КТУ)/100;
						
					КонецЕсли;
				ИначеЕсли РасчетЧасовсКТУ = 1 Тогда
					ЗП = ОбщегоНазначения.ОкруглитьЗначение2016(Окр(ТекСтрокаИсполнители.ОтработаноЧасов *ТекСтрокаИсполнители.КТУ,2)/ЧастьСКТУ*СуммаПриработка, Дата, 1); 
				Иначе

					ЗП = ОбщегоНазначения.ОкруглитьЗначение2016( ТекСтрокаИсполнители.ТарифнаяСтавка * ТекСтрокаИсполнители.ОтработаноЧасов * КРП
														* ?( РасчетСделкиСКТУиЧасами, ТекСтрокаИсполнители.КТУ, 1 ) // СВЭЙ КДЯ 07.10.19 СВФР-004860
														, Дата, 1) 
					+ ОбщегоНазначения.ОкруглитьЗначение2016( ТекСтрокаИсполнители.ТарифнаяСтавка * ТекСтрокаИсполнители.ОтработаноЧасов, Дата, 1 ); //О.Т. Аверсон 17.03.2016 № 949
				КонецЕсли;
				Если ОтражатьВБухгалтерскомУчете = Истина Тогда
					Если Дата < Дата(2016,07,01) Тогда 
						ТекСтрокаИсполнители.СуммаКНачислениюРегл = Окр(ЗП);
					иначе
						ТекСтрокаИсполнители.СуммаКНачислениюРегл = ОбщегоНазначения.ОкруглитьЗначение2016(ЗП,Дата);//О.Т. Аверсон 17.03.2016 № 949
					КонецЕсли;
				Иначе
					ТекСтрокаИсполнители.СуммаКНачислению = ЗП;
				КонецЕСли;
				
			ИначеЕсли ПропорциональноОтработанномуВремени = Истина Тогда
				ЗП = ОбщегоНазначения.ОкруглитьЗначение2016(ТекСтрокаИсполнители.ОтработаноЧасов * КРП, Дата, 1);//О.Т. Аверсон 17.03.2016 № 949
				
				Если ОтражатьВБухгалтерскомУчете = Истина Тогда
					Если Дата < Дата(2016,07,01) Тогда 
						ТекСтрокаИсполнители.СуммаКНачислениюРегл = Окр(ЗП);
					иначе
						ТекСтрокаИсполнители.СуммаКНачислениюРегл = ОбщегоНазначения.ОкруглитьЗначение2016(ЗП,Дата); //О.Т. Аверсон 17.03.2016 № 949
					КонецЕсли;
				Иначе
					ТекСтрокаИсполнители.СуммаКНачислению = ЗП;
				КонецЕСли;
			КонецЕсли;  
			//Островская Татьяна 14.02.2013 № 16148
			если ПропорциональноОтработанномуВремени = Истина Тогда		
				если ТекСтрокаИсполнители.КТУ = 0 Тогда 
					ТекСтрокаИсполнители.КТУ = 1;
				КонецЕсли;
			КонецЕсли;
			//Островская Татьяна 14.02.2013 № 16148
			
			СуммаРаспределения = СуммаРаспределения + ЗП;
			
			//проверим ли сумма распределения = сумме сдельной зарплаты
			Если ТекСтрокаИсполнители.НомерСтроки = Исполнители.Количество() Тогда
				//Островская Татьяна 14.02.2013 № 16148
				
				//+ СВЭЙ КДЯ 07.10.19 СВФР-004860
				//Если ОтражатьВБухгалтерскомУчете = Истина Тогда
				//	если УчитыватьКТУ Тогда 
				//		Сумма = Выработка.Итог("СуммаРегл")/?(Исполнители.Итог("ОтработаноЧасов")=0,1,Исполнители.Итог("ОтработаноЧасов"))*?(ОтработаноЧасов=0,1,ОтработаноЧасов)*?(ТекСтрокаИсполнители.КТУ=0,1,ТекСтрокаИсполнители.КТУ)/100;
				//	иначе
				//		Сумма = Выработка.Итог("СуммаРегл");
				//	КонецЕсли;
				//Иначе
				//	если УчитыватьКТУ Тогда 
				//		Сумма = Выработка.Итог("Сумма")/?(Исполнители.Итог("ОтработаноЧасов")=0,1,Исполнители.Итог("ОтработаноЧасов"))*?(ОтработаноЧасов=0,1,ОтработаноЧасов)*?(ТекСтрокаИсполнители.КТУ=0,1,ТекСтрокаИсполнители.КТУ)/100;
				//	иначе
				//		Сумма = Выработка.Итог("Сумма");
				//	КонецЕсли;
				//КонецЕСли;
				//- СВЭЙ КДЯ 07.10.19 СВФР-004860
				
				//Островская Татьяна 14.02.2013 № 16148
				Если ОтражатьВБухгалтерскомУчете = Истина Тогда
					ОбщСумма = Выработка.Итог("СуммаРегл");
				Иначе	
					ОбщСумма = Выработка.Итог("Сумма");
				КонецЕСли;
				
				Если Не ОбщСумма = СуммаРаспределения Тогда
					Если ОтражатьВБухгалтерскомУчете = Истина Тогда
						Если Дата < Дата(2016,07,01) Тогда 
							ТекСтрокаИсполнители.СуммаКНачислениюРегл =  Окр( ТекСтрокаИсполнители.СуммаКНачислениюРегл + ОбщСумма - СуммаРаспределения );
						иначе
							ТекСтрокаИсполнители.СуммаКНачислениюРегл =  ОбщегоНазначения.ОкруглитьЗначение2016(
									ТекСтрокаИсполнители.СуммаКНачислениюРегл + ОбщСумма - СуммаРаспределения, Дата ); //О.Т. Аверсон 17.03.2016 № 949
						КонецЕсли;
					Иначе
						ТекСтрокаИсполнители.СуммаКНачислению = ТекСтрокаИсполнители.СуммаКНачислению + ОбщСумма - СуммаРаспределения;
					КонецЕСли;	
				КонецЕсли;	
			КонецЕсли; // ТекСтрокаИсполнители.НомерСтроки = Исполнители.Количество()
			//О.Т. Аверсон 02.11.2017 № 1183
			Если Организация.ИНН = "400080082" Тогда //О.Т. Аверсон 02.11.2017 № 1183
				Если ОтражатьВБухгалтерскомУчете = Истина Тогда
					ТекСтрокаИсполнители.СуммаКНачислениюРегл =  ОбщегоНазначения.ОкруглитьЗначение2016(Коэффициент * ТекСтрокаИсполнители.ОплатаЗаОтработанноеВремя, Дата);
				иначе
					ТекСтрокаИсполнители.СуммаКНачислению = ОбщегоНазначения.ОкруглитьЗначение2016(Коэффициент * ТекСтрокаИсполнители.ОплатаЗаОтработанноеВремя, Дата);
				КонецЕсли;
			КонецЕсли;          			
			//О.Т. Аверсон 02.11.2017 № 1183
		КонецЦикла;
		
		//О.Т. Аверсон 14.11.2017 № 1183
		Если ОтражатьВБухгалтерскомУчете = Истина Тогда
			Если Выработка.Итог( "СуммаРегл" ) <> Исполнители.Итог( "СуммаКНачислениюРегл" ) и Исполнители.Итог( "СуммаКНачислениюРегл" ) <> 0 Тогда 
				Исполнители[ Исполнители.Количество() - 1 ].СуммаКНачислениюРегл = Исполнители[ Исполнители.Количество() - 1 ].СуммаКНачислениюРегл 
					+ ( Выработка.Итог( "СуммаРегл" ) - Исполнители.Итог( "СуммаКНачислениюРегл" ) );
			КонецЕсли;			
		Иначе
			Если Выработка.Итог( "СуммаРегл" ) <> Исполнители.Итог( "СуммаКНачислениюРегл" ) и Исполнители.Итог( "СуммаКНачислениюРегл" ) <> 0 Тогда 
				Исполнители[ Исполнители.Количество() - 1 ].СуммаКНачислению = Исполнители[ Исполнители.Количество() - 1 ].СуммаКНачислению 
					+ ( Выработка.Итог( "СуммаРегл" ) - Исполнители.Итог( "СуммаКНачислению" ) );
			КонецЕсли;
		КонецЕСли;
		//О.Т. Аверсон 14.11.2017 № 1183
		
		Если РаспределениеПриработка = Ложь и ПропорциональноОтработанномуВремени = Ложь и не Организация.ИНН = "400080082" Тогда
			Для Каждого ТекСтрокаИсполнители Из Исполнители Цикл
				Если ОтражатьВБухгалтерскомУчете = Истина Тогда
					ТекСтрокаИсполнители.СуммаКНачислениюРегл = Выработка.Итог("СуммаРегл");
				Иначе
					ТекСтрокаИсполнители.СуммаКНачислению = Выработка.Итог("Сумма");
				КонецЕСли;
			КонецЦикла;
		КонецЕсли;
		
	КонецЕсли; // ТипНаряда = 0
	
КонецПроцедуры

Процедура ОбновитьСуммуОтработанныхДнейИЧасовДляВсехСтрок() Экспорт
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ДатаНачалаПериода1 = МесяцНачислений;
	Иначе
		ДатаНачалаПериода1 = ДатаНачалаПериода;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ПоДням Тогда
		Для Каждого СтрокаТабличнойЧасти Из Исполнители Цикл
			СуммаЧасов	= 0;
			СуммаДней	= 0;
			Для ИндексДня = 1 По 31 Цикл
				
				ЧасовПоСтроке	= ВычислитьКоличествоЧасовВЯчейке(СтрокаТабличнойЧасти, ИндексДня);
				СуммаЧасов		= СуммаЧасов + ЧасовПоСтроке;
				Если ЧасовПоСтроке > 0 Тогда
					СуммаДней = СуммаДней + 1
				КонецЕсли;
			КонецЦикла;
			СтрокаТабличнойЧасти.ОтработаноЧасов	= СуммаЧасов;
			СтрокаТабличнойЧасти.ОтработаноДней		= СуммаДней;
		КонецЦикла;
		
	ИначеЕсли СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
		Для Каждого СтрокаТабличнойЧасти Из Исполнители Цикл
			
			//Аверсон ЕАЕ 23.07.2021 СВФР-007772
			//СуммаЧасов = ВычислитьКоличествоЧасовВЯчейке(СтрокаТабличнойЧасти, День(ДатаНачалаПериода));
			СуммаЧасов = ВычислитьКоличествоЧасовВЯчейке(СтрокаТабличнойЧасти, День(ДатаНачалаПериода1));
			//Аверсон СВФР-007772
			
			СтрокаТабличнойЧасти.ОтработаноЧасов = СуммаЧасов;
			СтрокаТабличнойЧасти.ОтработаноДней = ?(СуммаЧасов > 0, 1, 0);
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры // ОбновитьСуммуОтработанныхДнейИЧасовДляВсехСтрок()

Функция ВычислитьКоличествоЧасовВЯчейке(ТекущаяСтрока, ИндексДня) Экспорт
	
	СтрокаИндексДня = Строка(ИндексДня);
	ЧасовВЯчейке		= 0;
	ЧасыОсновныеУчтены	= Ложь;
	ЧасыНочныеУчтены	= Ложь;
	// цикл по значениям внутри дня
	Для ИндексМассиваПриставок = 0 По 2 Цикл
		
		Часов			= ТекущаяСтрока[МассивПриставок[ИндексМассиваПриставок] + "Часов" + СтрокаИндексДня];
		Классификатор	= ТекущаяСтрока[МассивПриставок[ИндексМассиваПриставок] + "ВидВремени" + СтрокаИндексДня];
		
		Если Организация.ИНН = "700067572" Тогда
			ЧасовВЯчейке			= ЧасовВЯчейке + Часов;
			ЧасыОсновныеУчтены		= Истина;
		ИначеЕсли Классификатор = Справочники.КлассификаторИспользованияРабочегоВремени.Работа
			//заявка №1664 (база заявок Кристалла) Дмитрук О.Г.
			или Классификатор = Справочники.КлассификаторИспользованияРабочегоВремени.Ремонт Тогда
			//заявка №1664 
			
			//Классификатор = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные ИЛИ
			//Классификатор = Справочники.КлассификаторИспользованияРабочегоВремени.Праздники Тогда
			
			ЧасовВЯчейке			= ЧасовВЯчейке + Часов;
			ЧасыОсновныеУчтены		= Истина;
		КонецЕсли;		
	КонецЦикла;
	
	Возврат ЧасовВЯчейке
	
КонецФункции // ВычислитьКоличествоЧасовВЯчейке()

Процедура ПриКопировании(ОбъектКопирования)
	если не ОбъектКопирования = Неопределено Тогда  
		ТипНаряда = ОбъектКопирования.ТипНаряда;
		ПериодНаряда = ОбъектКопирования.ПолучитьФорму("ФормаДокумента");
		ПериодНаряда.КопированиеДока(ПериодНаряда);
		
		//ПериодНаряда.НарядСдельщикаПриИзменении(ПериодНаряда.);
	КонецЕсли;
КонецПроцедуры

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	// Вставить содержимое обработчика.
КонецПроцедуры
///енд толик


//+ СВЭЙ КДЯ 07.10.19 СВФР-004860
Процедура ПечатьРасчетаЗПБригады() Экспорт
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	ТабДок = Новый ТабличныйДокумент;
	Макет = Документы.СдельныйНаряд.ПолучитьМакет("Расчет_ЗП_Бригады");
	Итоги = Новый Структура( "ИтогоТарифнаяЧасть, ИтогоТарифнаяЧастьСКТУ, 
		|ИтогоСдельныйПриработок, ИтогоСдельныйЗаработок", 0, 0, 0, 0 );
	// Заголовок
	Область = Макет.ПолучитьОбласть("Заголовок");
	Область.Параметры.Заполнить(ЭтотОбъект);
	ТабДок.Вывести(Область);
	// Шапка
	Шапка = Макет.ПолучитьОбласть("Шапка");
	Шапка.Параметры.Заполнить(ЭтотОбъект);
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Шапка.Параметры.ПериодРасчета = Формат( ПериодРегистрации, "ДФ=""ММММ гггг""" );
	Шапка.Параметры.ПериодРасчета = Формат( ПериодРегистрации1, "ДФ=""ММММ гггг""" );
	//Аверсон СВФР-007772
	
	ТабДок.Вывести(Шапка);
	// Исполнители
	Область = Макет.ПолучитьОбласть("ИсполнителиШапка");
	ТабДок.Вывести(Область);
	ОбластьИсполнители = Макет.ПолучитьОбласть("Исполнители");
	
	//расчет коэффициента	
	ИтогоСдельныйПриработок = 0;			
	ИтогоТарифнаяЧастьСКТУ = 0;			
	Для Каждого ТекСтрокаИсполнители Из Исполнители Цикл
		
		ТарифнаяЧасть =  ОбщегоНазначения.ОкруглитьЗначение2016(    // - Сумма Графы В
					ТекСтрокаИсполнители.ТарифнаяСтавка * ТекСтрокаИсполнители.ОтработаноЧасов, Дата, 1 );
		ТарифнаяЧастьСКТУ = ОбщегоНазначения.ОкруглитьЗначение2016(   // - Сумма Графы Д
					ТарифнаяЧасть * ТекСтрокаИсполнители.КТУ, Дата, 1 );
		СдельныйЗаработок = ?( ОтражатьВБухгалтерскомУчете,
				ТекСтрокаИсполнители.СуммаКНачислениюРегл, ТекСтрокаИсполнители.СуммаКНачислению );
		СдельныйПриработок = СдельныйЗаработок - ТарифнаяЧасть;
		
		ИтогоСдельныйПриработок = ИтогоСдельныйПриработок + СдельныйПриработок;			
		ИтогоТарифнаяЧастьСКТУ = ИтогоТарифнаяЧастьСКТУ + ТарифнаяЧастьСКТУ;			
		 
	КонецЦикла;
	
	КРП = Окр( ИтогоСдельныйПриработок / ИтогоТарифнаяЧастьСКТУ, 5, 1 );	
	
	Для Каждого ТекСтрокаИсполнители Из Исполнители Цикл
		
		ОбластьИсполнители.Параметры.Заполнить(ТекСтрокаИсполнители);
		ОбластьИсполнители.Параметры.ТабельныйНомер = ТекСтрокаИсполнители.Сотрудник.Код;
		
		ТарифнаяЧасть =  ОбщегоНазначения.ОкруглитьЗначение2016(    // - Сумма Графы В
					ТекСтрокаИсполнители.ТарифнаяСтавка * ТекСтрокаИсполнители.ОтработаноЧасов, Дата, 1 );
		ТарифнаяЧастьСКТУ = ОбщегоНазначения.ОкруглитьЗначение2016(   // - Сумма Графы Д
					ТарифнаяЧасть * ТекСтрокаИсполнители.КТУ, Дата, 1 );
		ОбластьИсполнители.Параметры.ТарифнаяЧасть = ТарифнаяЧасть;
		ОбластьИсполнители.Параметры.ТарифнаяЧастьСКТУ = ТарифнаяЧастьСКТУ;
		СдельныйЗаработок = ?( ОтражатьВБухгалтерскомУчете,
				ТекСтрокаИсполнители.СуммаКНачислениюРегл, ТекСтрокаИсполнители.СуммаКНачислению );
		ОбластьИсполнители.Параметры.СдельныйЗаработок = СдельныйЗаработок;
		СдельныйПриработок = СдельныйЗаработок - ТарифнаяЧасть;			
		ОбластьИсполнители.Параметры.СдельныйПриработок = СдельныйПриработок;
		ОбластьИсполнители.Параметры.КРП = КРП;
					
		ТабДок.Вывести( ОбластьИсполнители );

		Итоги.ИтогоТарифнаяЧасть = Итоги.ИтогоТарифнаяЧасть + ТарифнаяЧасть;
		Итоги.ИтогоТарифнаяЧастьСКТУ = Итоги.ИтогоТарифнаяЧастьСКТУ + ТарифнаяЧастьСКТУ;
		Итоги.ИтогоСдельныйПриработок = Итоги.ИтогоСдельныйПриработок + СдельныйПриработок;
		Итоги.ИтогоСдельныйЗаработок = Итоги.ИтогоСдельныйЗаработок + СдельныйЗаработок;
		 
	КонецЦикла;
	// Подвал
	Подвал = Макет.ПолучитьОбласть( "Всего" );
	Подвал.Параметры.Заполнить( Итоги );
	ТабДок.Вывести( Подвал );
	ТабДок.АвтоМасштаб = Истина;
	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.ТолькоПросмотр = Истина;
	ТабДок.ОтображатьЗаголовки = Ложь;
	ТабДок.Показать( "Расчет З/П бригады " + ЭтотОбъект.ПодразделениеОрганизации );
КонецПроцедуры
//- СВЭЙ КДЯ 07.10.19 СВФР-004860

//ПСА 11.02.2021 СВФР-007191+++
Функция ПечатьНарядБригады(ИмяМакета)
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	//Аверсон СВФР-007772
	
	ТабДок = Новый ТабличныйДокумент;
	Макет = ПолучитьМакет("Наряд_Бригады");
	// Шапка
	Шапка = Макет.ПолучитьОбласть("Шапка");
	Шапка.Параметры.Заполнить(ЭтотОбъект);
	ТекстНаряд ="";
	
	//Аверсон ЕАЕ 20.05.2021 СВФР-007544
	//Если Не (Праздники или Сверхурочно или Доплатной или Запчасть) Тогда
	Если Не (Праздники или Сверхурочно или Доплатной или Запчасть или Прочее) Тогда
	//Аверсон СВФР-007544	
		
		ТекстНаряд = "на сдельные работы";
	Иначе
		Если Сверхурочно Тогда
			ТекстНаряд ="на работу сверхурочно";
		КонецЕсли;
		Если Праздники Тогда
			Если ЗначениеЗаполнено(ТекстНаряд) Тогда
				ТекстНаряд = ТекстНаряд + ", ";
			КонецЕсли;	
			ТекстНаряд = ТекстНаряд  + "на работу в выходные и праздничные дни";
		КонецЕсли;
		//ПСА 19.02.2021 СВФР-007228+++
		Если Доплатной Тогда
			Если ЗначениеЗаполнено(ТекстНаряд) Тогда
				ТекстНаряд = ТекстНаряд + ", ";
			КонецЕсли;	
			ТекстНаряд = ТекстНаряд  + "доплатной";
		КонецЕсли;
		//+++ПСА 19.02.2021 СВФР-007228
		Если Запчасть Тогда
			Если ЗначениеЗаполнено(ТекстНаряд) Тогда
				ТекстНаряд = ТекстНаряд + ", ";
			КонецЕсли;	
			ТекстНаряд = ТекстНаряд  + "Сдельно запчасть";
		КонецЕсли;

		//Аверсон ЕАЕ 20.05.2021 СВФР-007544
		Если Прочее Тогда
			Если ЗначениеЗаполнено(ТекстНаряд) Тогда
				ТекстНаряд = ТекстНаряд + ", ";
			КонецЕсли;	
			ТекстНаряд = ТекстНаряд  + "Прочее";
		КонецЕсли;
		//Аверсон СВФР-007544
	КонецЕсли;	
	Шапка.Параметры.ТекстНаряд = ТекстНаряд;
	
	//Аверсон ЕАЕ 23.07.2021 СВФР-007772
	//Шапка.Параметры.ПериодРасчета = Формат( ПериодРегистрации, "ДФ=""ММММ гггг""" );
	Шапка.Параметры.ПериодРасчета = Формат( ПериодРегистрации1, "ДФ=""ММММ гггг""" );
	//Аверсон СВФР-007772
	
	ИтСуммаСделки = Исполнители.Итог("СуммаКНачислениюРегл");
	Шапка.Параметры.ИтСуммаСделки = ИтСуммаСделки;
	ТабДок.Вывести(Шапка);
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	Для Каждого СтрокаТЧ Из Исполнители Цикл
		ОбластьСтрока.Параметры.ТабельныйНомер  = СтрокаТЧ.Сотрудник.Код;
		ОбластьСтрока.Параметры.Сотрудник       = СтрокаТЧ.Сотрудник.Наименование;
		ОбластьСтрока.Параметры.ОтработаноЧасов = СтрокаТЧ.ОтработаноЧасов;
		ОбластьСтрока.Параметры.КТУ             = СтрокаТЧ.КТУ;
		ОбластьСтрока.Параметры.СуммаСделки     = СтрокаТЧ.СуммаКНачислениюРегл;
		ТабДок.Вывести(ОбластьСтрока);
	КонецЦикла;	
	
	ТабДок.АвтоМасштаб = Истина;
	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.ТолькоПросмотр = Истина;
	ТабДок.ОтображатьЗаголовки = Ложь;
	Возврат ТабДок;	
КонецФункции		

//Ускорение
Процедура ДобавитьНесколькоДвиженийПоНДФЛСведенияОДоходах(ТЗ)
	
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	
	НаборДвижения = Движения.НДФЛСведенияОДоходах;
	Для Каждого Стр Из ТЗ Цикл
		Движение = НаборДвижения.Добавить();
		
		// Свойства
		
		Движение.Период						= НачалоМесяца(ПериодРегистрации1);
		
		// Измерения
		Движение.Организация				= Организация;
		Движение.ФизЛицо					= Стр.ФизЛицо;
		Движение.КодДохода					= Стр.КодДоходаНДФЛ;
		
		Движение.ПериодРегистрации			= НачалоМесяца(ПериодРегистрации1);
		
		// Ресурсы
		Движение.СуммаДохода				= Стр.Сумма; 
		
		// Реквизиты
		Движение.ОбособленноеПодразделение	= Организация;
		Движение.ИсчисленоИзЗарплаты		= Истина;
		
		Движение.ПодразделениеОрганизации   = ПрочиеПроцедуры.ПолучитьПодразделениеСотрудникаНаДату(Стр.Сотрудник, КонецМесяца(ПериодРегистрации1)); //здесь можно
	КонецЦикла;

	НаборДвижения.Записать();
	
КонецПроцедуры

Функция ПолучитьТЗСотрудники(СписокСотрудников, НаДату)
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СотрудникиОрганизаций.Ссылка КАК Сотрудник,
		|	СотрудникиОрганизаций.Физлицо
		|ПОМЕСТИТЬ ВТСотрудники
		|ИЗ
		|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
		|ГДЕ
		|	СотрудникиОрганизаций.Ссылка В(&СписокСотрудников)
		|;
		|////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТСОтрудники.Сотрудник,
		|	ВТСотрудники.ФизЛицо,
		|	Срез.ПодразделениеОрганизации
		|ИЗ ВТСотрудники 
		|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НаДату, Сотрудник В (ВЫБРАТЬ ВТСотрудники.Сотрудник ИЗ ВТСотрудники)) КАК Срез
		|ПО ВТСотрудники.Сотрудник = Срез.Сотрудник";
	
	Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
	Запрос.УстановитьПараметр("НаДату", НаДату);
	
	ТЗ = Запрос.Выполнить().Выгрузить();
	
	Возврат ТЗ;
КонецФункции
//

//Аверсон ЕАЕ 06.02.2023 СВФР-010277
Функция ПолучитьПериодыРаботыСотрудников(СписокСотрудников, Дат, Орг)
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	&ДатаНачала КАК Период,
	|	РаботникиОрганизацийСрезПоследних.Сотрудник,
	|	РаботникиОрганизацийСрезПоследних.Должность,
	|	РаботникиОрганизацийСрезПоследних.РазрядЕТС КАК Разряд,
	|	РаботникиОрганизацийСрезПоследних.Организация
	|ПОМЕСТИТЬ ВТПериодыРаботы
	|ИЗ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ДатаНачала, Сотрудник В (&СписокСотрудников) 
	|И Организация = &Организация) КАК РаботникиОрганизацийСрезПоследних
	|
	|ОБЪЕДИНИТЬ
	
	|ВЫБРАТЬ
	|	РаботникиОрганизаций.Период,
	|	РаботникиОрганизаций.Сотрудник,
	|	РаботникиОрганизаций.Должность,
	|	РаботникиОрганизаций.РазрядЕТС,
	|	РаботникиОрганизаций.Организация
	|ИЗ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|ГДЕ РаботникиОрганизаций.Сотрудник В (&СписокСотрудников)
	|	И РаботникиОрганизаций.Организация = &Организация
	|	И РаботникиОрганизаций.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
	|;
	|//////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТПериоды.Сотрудник,
	|	ВТПериоды.Организация,
	|	ВТПериоды.Должность,
	|	ВТПериоды.Разряд,
	|	ВТПериоды.Период КАК НачПериода,
	|	МИНИМУМ(ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ВТПериодыБольше.Период, СЕКУНДА, -1), &ДатаОкончания)) КАК КонПериода
	|ПОМЕСТИТЬ ВТРезультат
	|ИЗ ВТПериодыРаботы КАК ВТПериоды
	|ЛЕВОЕ СОЕДИНЕНИЕ ВТПериодыРаботы КАК ВТПериодыБольше
	|ПО ВТПериоды.Сотрудник = ВТПериодыБольше.Сотрудник
	|	И ВТПериоды.Организация = ВТПериодыБольше.Организация
	|	И ВТПериоды.Период < ВТПериодыБольше.Период
	|СГРУППИРОВАТЬ ПО
	|	ВТПериоды.Сотрудник,
	|	ВТПериоды.Организация,
	|	ВТПериоды.Должность,
	|	ВТПериоды.Разряд,
	|	ВТПериоды.Период
	|;
	|/////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТРезультат.Сотрудник,
	|	ВТРезультат.Организация,
	|	ВТРезультат.Должность,
	|	ВТРезультат.Разряд,
	|	ВТРезультат.НачПериода,
	|	ВТРезультат.КонПериода,
	|	РАЗНОСТЬДАТ(ВТРезультат.НачПериода, ВТРезультат.КонПериода, СЕКУНДА) / 86400 КАК ДнейВПериоде
	|ИЗ ВТРезультат
	|";
	
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("Организация", Орг);
	Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
	Запрос.УстановитьПараметр("ДатаНачала", НачалоМесяца(Дат));
	Запрос.УстановитьПараметр("ДатаОкончания", КонецМесяца(Дат));
	ТЗПериоды = Запрос.Выполнить().Выгрузить();
	
	ТЗПериодыРаботы = ТЗПериоды;
	//============================================================
	//Находим периоды работы сотрудников в бригаде по РС НазначениеСотрудниковПоБригадам
	Если ЗначениеЗаполнено(Бригада) Тогда
		Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	&ДатаНачала КАК Период,
		|	НазначениеСотрудниковПоБригадамСрезПоследних.Сотрудник,
		|	НазначениеСотрудниковПоБригадамСрезПоследних.Организация,
		|	НазначениеСотрудниковПоБригадамСрезПоследних.Бригада
		|ПОМЕСТИТЬ ВТПериодыРаботы
		|ИЗ РегистрСведений.НазначениеСотрудниковПоБригадам.СрезПоследних(&ДатаНачала, Сотрудник В (&СписокСотрудников) 
		//|И Бригада = &Бригада 
		|И Организация = &Организация) КАК НазначениеСотрудниковПоБригадамСрезПоследних
		|
		|ОБЪЕДИНИТЬ
		
		|ВЫБРАТЬ
		|	НазначениеСотрудниковПоБригадам.Период,
		|	НазначениеСотрудниковПоБригадам.Сотрудник,
		|	НазначениеСотрудниковПоБригадам.Организация,
		|	НазначениеСотрудниковПоБригадам.Бригада
		|ИЗ РегистрСведений.НазначениеСотрудниковПоБригадам КАК НазначениеСотрудниковПоБригадам
		|ГДЕ НазначениеСотрудниковПоБригадам.Сотрудник В (&СписокСотрудников)
		//|	И НазначениеСотрудниковПоБригадам.Бригада = &Бригада
		|	И НазначениеСотрудниковПоБригадам.Организация = &Организация
		|	И НазначениеСотрудниковПоБригадам.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
		|;
		|//////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТПериоды.Сотрудник,
		|	ВТПериоды.Организация,
		|	ВТПериоды.Бригада,
		|	ВТПериоды.Период КАК НачПериода,
		|	МИНИМУМ(ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ВТПериодыБольше.Период, СЕКУНДА, -1), &ДатаОкончания)) КАК КонПериода
		|ПОМЕСТИТЬ ВТРезультат
		|ИЗ ВТПериодыРаботы КАК ВТПериоды
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТПериодыРаботы КАК ВТПериодыБольше
		|ПО ВТПериоды.Сотрудник = ВТПериодыБольше.Сотрудник
		|	И ВТПериоды.Организация = ВТПериодыБольше.Организация
		|	И ВТПериоды.Период < ВТПериодыБольше.Период
		|СГРУППИРОВАТЬ ПО
		|	ВТПериоды.Сотрудник,
		|	ВТПериоды.Организация,
		|	ВТПериоды.Бригада,
		|	ВТПериоды.Период
		|;
		|/////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТРезультат.Сотрудник,
		|	ВТРезультат.Организация,
		|	ВТРезультат.НачПериода,
		|	ВТРезультат.КонПериода,
		|	РАЗНОСТЬДАТ(ВТРезультат.НачПериода, ВТРезультат.КонПериода, СЕКУНДА) / 86400 КАК ДнейВПериоде
		|ИЗ ВТРезультат
		|ГДЕ ВТРезультат.Бригада = &Бригада
		|";
		
		Если Не ЗначениеЗаполнено(Бригада) Тогда
			Текст = СтрЗаменить(Текст, "ГДЕ ВТРезультат.Бригада = &Бригада", "");
		КонецЕсли;
		
		Запрос = Новый Запрос;
		Запрос.Текст = Текст;
		Запрос.УстановитьПараметр("Организация", Орг);
		Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
		Запрос.УстановитьПараметр("ДатаНачала", НачалоМесяца(Дат));
		Запрос.УстановитьПараметр("ДатаОкончания", КонецМесяца(Дат));
		Запрос.УстановитьПараметр("Бригада", Бригада);
		ТЗПериодыВБригаде = Запрос.Выполнить().Выгрузить();	
		
		//===================================================
		//находим пересечения
		ТЗПериодыПересечения = ТЗПериоды.Скопировать();
		ТЗПериодыПересечения.Очистить();
		Для Каждого Стр Из ТЗПериоды Цикл
			СтруктураОтбора = Новый Структура;
			СтруктураОтбора.Вставить("Сотрудник", Стр.Сотрудник);
			СтруктураОтбора.Вставить("Организация", Стр.Организация);
			СтрокиПоСотруднику = ТЗПериодыВБригаде.НайтиСтроки(СтруктураОтбора);
			
			Для Каждого СтрБригада Из СтрокиПоСотруднику Цикл
				Если (СтрБригада.НачПериода >= Стр.НачПериода И СтрБригада.НачПериода <= Стр.КонПериода)
					ИЛИ (Стр.НачПериода >= СтрБригада.НачПериода И Стр.НачПериода <= СтрБригада.КонПериода) Тогда
					НовСтр = ТЗПериодыПересечения.Добавить();
					ЗаполнитьЗначенияСвойств(НовСтр, Стр);
					
					НовСтр.НачПериода = Макс(Стр.НачПериода, СтрБригада.НачПериода);
					НовСтр.КонПериода = Мин(Стр.КонПериода, СтрБригада.КонПериода);
					
					НовСтр.ДнейВПериоде = Окр((НовСтр.КонПериода - НовСтр.НачПериода) / 86400);
				КонецЕсли;
			КонецЦикла;
			
		КонецЦикла;
		ТЗПериодыРаботы = ТЗПериодыПересечения;
	КонецЕсли;
	Возврат ТЗПериодыРаботы;
	
КонецФункции
//Аверсон СВФР-010277

Функция ОпределитьДатуДляЧТС(стрТЧ, ТЧ_Исполнители, Сотрудник)
	//СВЭЙ 08.02.2024 КВВ СВФР-012344 (
	ДатаВозврат = КонецМесяца(ПериодРегистрации);  
	
	Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень И ЗначениеЗаполнено(ДатаНачалаПериода) Тогда    
		ДатаВозврат = КонецДня(ДатаНачалаПериода);
	Иначе 
		
		КрайнийИндекс = 0;
		КлассификаторПустаяСсылка = Справочники.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка();  
		Если НЕ ТЧ_Исполнители Тогда  
			Отбор = Новый Структура();
			Отбор.Вставить("Сотрудник", Сотрудник);
			НайденноеЗн = Исполнители.НайтиСтроки(Отбор);
			Если НайденноеЗн.Количество() <> 0 Тогда  
				стрТЧ = НайденноеЗн[0];	
			КонецЕсли;
		КонецЕсли;
		
		Если стрТЧ <> "" Тогда
			Для ИндексДня = 1 По 31 Цикл			
				Если стрТЧ["ПервыйВидВремени" + Строка(ИндексДня)] <> КлассификаторПустаяСсылка
					ИЛИ стрТЧ["ВторойВидВремени" + Строка(ИндексДня)] <> КлассификаторПустаяСсылка
					ИЛИ стрТЧ["ТретийВидВремени" + Строка(ИндексДня)] <> КлассификаторПустаяСсылка
					ИЛИ стрТЧ["ПервыйЧасов" + Строка(ИндексДня)] <> 0
					ИЛИ стрТЧ["ВторойЧасов" + Строка(ИндексДня)] <> 0
					ИЛИ стрТЧ["ТретийЧасов" + Строка(ИндексДня)] <> 0 Тогда
					КрайнийИндекс = ИндексДня;
				КонецЕсли;	
			КонецЦикла;   
		КонецЕсли;	
			
		Если КрайнийИндекс = 0 Тогда
			ДатаВозврат = КонецМесяца(ПериодРегистрации);
		Иначе
			ДатаВозврат = КонецДня(Дата(Год(ПериодРегистрации),Месяц(ПериодРегистрации),КрайнийИндекс));
		КонецЕсли;
	КонецЕсли;
	
	Возврат ДатаВозврат;   
	//СВЭЙ 08.02.2024 КВВ СВФР-012344 )
КонецФункции

//Аверсон ЕАЕ 20.05.2024 СВФР-012937
Процедура АвтоЗаполнениеПраздничныхСверхурочных(СписокСотрудников, ДатаНачалаПериодаЗаполнения, ДатаОкончанияПериодаЗаполнения)
	
	Если ЗначениеЗаполнено(МесяцНачислений) Тогда
		ПериодРегистрации1 = МесяцНачислений;
	Иначе
		ПериодРегистрации1 = ПериодРегистрации;
	КонецЕсли;
	
	Исполнители.Очистить();
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|  СостояниеРаботниковОрганизаций.Сотрудник,
	|  СостояниеРаботниковОрганизаций.Период
	|ПОМЕСТИТЬ ВТСостояния
	|ИЗ РегистрСведений.СостояниеРаботниковОрганизаций КАК СостояниеРаботниковОрганизаций
	|ГДЕ СостояниеРаботниковОрганизаций.Сотрудник В(&МассивСотрудников)
	|И СостояниеРаботниковОрганизаций.Организация = &Организация
	|И СостояниеРаботниковОрганизаций.Период МЕЖДУ &Нач И &Кон
	|И (ВЫБОР
	|  КОГДА &Праздники
	|  ТОГДА СостояниеРаботниковОрганизаций.Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияРаботникаОрганизации.РаботаВПраздничныеИВыходныеДни)
	|  ИНАЧЕ ЛОЖЬ
	|  КОНЕЦ
	|ИЛИ
	|  ВЫБОР
	|  КОГДА &Сверхурочно
	|  ТОГДА СостояниеРаботниковОрганизаций.Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияРаботникаОрганизации.ДополнительныеСверхурочныеДни)
	|  ИНАЧЕ ЛОЖЬ
	|  КОНЕЦ)
	|;
	|/////////////////////////////////////////////
	|ВЫБРАТЬ
	|	РабочееВремяРаботниковОрганизаций.Сотрудник КАК Сотрудник,
	|	РабочееВремяРаботниковОрганизаций.Сотрудник.Физлицо КАК ФизЛицо,
	|	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени,
	|	РабочееВремяРаботниковОрганизаций.Часов КАК Часов,
	|   0 КАК Порядок,
	|	РабочееВремяРаботниковОрганизаций.Период КАК Период
	|ИЗ
	|	РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
	|ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСостояния
	|ПО РабочееВремяРаботниковОрганизаций.Сотрудник = ВТСостояния.Сотрудник
	|	И НАЧАЛОПЕРИОДА(РабочееВремяРаботниковОрганизаций.Период,ДЕНЬ) = НАЧАЛОПЕРИОДА(ВТСостояния.Период,ДЕНЬ)
	|   И РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В(&МассивВидовРабочегоВремени)
	|УПОРЯДОЧИТЬ ПО
	|	РабочееВремяРаботниковОрганизаций.Сотрудник.Код,
	|	Период
	|ИТОГИ ПО
	|	Сотрудник,
	|	Период";
	
	Запрос.УстановитьПараметр("Нач", ДатаНачалаПериодаЗаполнения);
	Запрос.УстановитьПараметр("Кон", ДатаОкончанияПериодаЗаполнения);
	Запрос.УстановитьПараметр("МассивСотрудников", СписокСотрудников);
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("Праздники", Праздники);
	Запрос.УстановитьПараметр("Сверхурочно", Сверхурочно);
	
	МассивВидовРабочегоВремени = Новый Массив();
	//МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Работа);
	Если Праздники Тогда
		МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Праздники);
	КонецЕсли;
	Если Сверхурочно Тогда
		МассивВидовРабочегоВремени.Добавить(Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные);
	КонецЕсли;
	Запрос.УстановитьПараметр("МассивВидовРабочегоВремени", МассивВидовРабочегоВремени);
	
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаСотрудник = РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	Пока ВыборкаСотрудник.Следующий() Цикл
		СтрокаТабличнойЧасти = Исполнители.Добавить();
		СтрокаТабличнойЧасти.Сотрудник = ВыборкаСотрудник.Сотрудник;
		СтрокаТабличнойЧасти.ФизЛицо = ВыборкаСотрудник.ФизЛицо;
		СтруктураОтбора = Новый Структура("Сотрудник, Организация", ВыборкаСотрудник.Сотрудник, Организация);
		
		//Аверсон ЕАЕ 23.07.2021 СВФР-007772
		//мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации,СтруктураОтбора);
		мСтрока = РегистрыСведений.РаботникиОрганизаций.ПолучитьПоследнее(ПериодРегистрации1,СтруктураОтбора);
		//Аверсон СВФР-007772
		
		СтрокаТабличнойЧасти.Должность = мСтрока.Должность;
		ВыборкаПериод = ВыборкаСотрудник.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПериод.Следующий() Цикл
			//НужныйПериод = Ложь;
			//ПоследняяБригада = РегистрыСведений.НазначениеСотрудниковПоБригадам.ПолучитьПоследнее(ВыборкаПериод.Период, СтруктураОтбора);
			//Если ПоследняяБригада.Бригада = Бригада Тогда
			//	НужныйПериод = Истина;
			//КонецЕсли;	
			//Если НужныйПериод Тогда
				//ПСА 06.09.2021 СВФР-008078 +++
				//Если ТЗ_Коммандировки.Количество() > 0 
				//	и не ОтражатьЧасыКоммандировок Тогда
				//	ОтборТЗ = Новый Структура();
				//	ОтборТЗ.Вставить("Сотрудник", ВыборкаСотрудник.Сотрудник);
				//	ОтборТЗ.Вставить("ФизЛицо", ВыборкаСотрудник.ФизЛицо);
				//	ОтборТЗ.Вставить("Период", ВыборкаПериод.Период);
				//	НайденныеСтрокиТЗ = ТЗ_Коммандировки.НайтиСтроки(ОтборТЗ);
				//	Если НайденныеСтрокиТЗ.Количество() > 0 Тогда
				//		Продолжить;
				//	КонецЕсли;	
				//КонецЕсли;
				//+++ПСА 06.09.2021 СВФР-008078
				Выборка = ВыборкаПериод.Выбрать();
				ИндексДня = Лев(Строка(ВыборкаПериод.Период),2);
				Если Лев(ИндексДня,1) = "0" Тогда
					ИндексДня = Прав(ИндексДня,1);
				КонецЕсли;
				СчетчикВидВремени = 1;
				Пока Выборка.Следующий() Цикл
					//ПСА 07.10.2021 СВФР-008240 +++
					Если СчетчикВидВремени >1 и Выборка.Порядок = 1 Тогда
						Продолжить;
					КонецЕсли;
					//+++ПСА 07.10.2021 СВФР-008240
					Если СчетчикВидВремени = 1 Тогда
						СтрокаТабличнойЧасти["ПервыйВидВремени" + ИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа;
						СтрокаТабличнойЧасти["ПервыйЧасов" + ИндексДня]      = Выборка.Часов;
						
						//
						СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = Выборка.ВидИспользованияРабочегоВремени;
						СтрокаТабличнойЧасти["ВторойЧасов" + ИндексДня]      = Выборка.Часов;
						//
					ИначеЕсли СчетчикВидВремени = 2 Тогда
						СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = Справочники.КлассификаторИспользованияРабочегоВремени.Работа;
						СтрокаТабличнойЧасти["ВторойЧасов" + ИндексДня]      = Выборка.Часов;
						
						//
						СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] = Выборка.ВидИспользованияРабочегоВремени;
						СтрокаТабличнойЧасти["ТретийЧасов" + ИндексДня]      = Выборка.Часов;
						//
					ИначеЕсли СчетчикВидВремени = 3 Тогда
						СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] =  Выборка.ВидИспользованияРабочегоВремени;
						СтрокаТабличнойЧасти["ТретийЧасов" + ИндексДня]      =  Выборка.Часов;
					Иначе
						Продолжить;
					КонецЕсли;	
					Если Выборка.Часов > 0 Тогда
						СтрокаТабличнойЧасти.ОтработаноЧасов = СтрокаТабличнойЧасти.ОтработаноЧасов + Выборка.Часов;
						СтрокаТабличнойЧасти.ОтработаноДней = СтрокаТабличнойЧасти.ОтработаноДней + 1;
					КонецЕсли;	
					СчетчикВидВремени = СчетчикВидВремени+1;
				КонецЦикла;
			//КонецЕсли;
		КонецЦикла;
		//ПСА 10.11.2021 СВФР-008342 +++
		//Если НужнаПроверкаСверхурочноВКоммандировках Тогда
		//	КлассификаторСвехурочные = Справочники.КлассификаторИспользованияРабочегоВремени.Сверхурочные;
		//	КлассификаторКомандировка = Справочники.КлассификаторИспользованияРабочегоВремени.Командировка;
		//	
		//	Для Каждого СтрокаИсполнители Из Исполнители Цикл
		//		Для ИндексДня = 1 По 31 Цикл
		//			ЕстьСверхурочные = Ложь;
		//			ЧасовСверхурочные = 0;
		//			Если СтрокаТабличнойЧасти["ПервыйВидВремени" + ИндексДня] = КлассификаторСвехурочные Тогда
		//				ЕстьСверхурочные = Истина;
		//				ЧасовСверхурочные = СтрокаТабличнойЧасти["ПервыйЧасов" + ИндексДня];
		//			КонецЕсли;	
		//			Если СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = КлассификаторСвехурочные Тогда
		//				ЕстьСверхурочные = Истина;
		//				ЧасовСверхурочные = СтрокаТабличнойЧасти["ВторойЧасов" + ИндексДня];
		//			КонецЕсли;	
		//			Если СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] = КлассификаторСвехурочные Тогда
		//				ЕстьСверхурочные = Истина;
		//				ЧасовСверхурочные = СтрокаТабличнойЧасти["ТретийЧасов" + ИндексДня];
		//			КонецЕсли;	
		//			
		//			Если ЕстьСверхурочные Тогда
		//				ЕстьКомандировка = Ложь;
		//				Если СтрокаТабличнойЧасти["ПервыйВидВремени" + ИндексДня] = КлассификаторКомандировка 
		//					или СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = КлассификаторКомандировка 
		//					или СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] = КлассификаторКомандировка Тогда
		//					ЕстьКомандировка = Истина;
		//				КонецЕсли;
		//				
		//				Если ЕстьКомандировка Тогда
		//					СтрокаТабличнойЧасти["ПервыйВидВремени" + ИндексДня] = КлассификаторСвехурочные;
		//					СтрокаТабличнойЧасти["ПервыйЧасов" + ИндексДня]  = ЧасовСверхурочные;
		//					СтрокаТабличнойЧасти["ВторойВидВремени" + ИндексДня] = "";
		//					СтрокаТабличнойЧасти["ВторойЧасов" + ИндексДня]  = 0;
		//					СтрокаТабличнойЧасти["ТретийВидВремени" + ИндексДня] = "";
		//					СтрокаТабличнойЧасти["ТретийЧасов" + ИндексДня]  = 0;
		//				КонецЕсли;	
		//			КонецЕсли;	
		//		КонецЦикла;		
		//		
		//	КонецЦикла;	
		//КонецЕсли;	
		//+++ПСА 10.11.2021 СВФР-008342 
		
		//СВЭЙ 08.02.2024 КВВ СВФР-012344 (
		////Аверсон ЕАЕ 23.07.2021 СВФР-007772
		////СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(ВыборкаСотрудник.Сотрудник, Дата, ПериодРегистрации, мВалютаРегламентированногоУчета);
		//СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(ВыборкаСотрудник.Сотрудник, Дата, ПериодРегистрации1, мВалютаРегламентированногоУчета);
		////Аверсон СВФР-007772
		
		ДатаДляЧТС = ОпределитьДатуДляЧТС(СтрокаТабличнойЧасти, Истина, ВыборкаСотрудник.Сотрудник);
		СтрокаТабличнойЧасти.ТарифнаяСтавка = ПроцедурыУправленияПерсоналом.ЧасоваяТарифнаяСтавкаРаботникаОрг(ВыборкаСотрудник.Сотрудник, ДатаДляЧТС, ПериодРегистрации1, мВалютаРегламентированногоУчета);
		//СВЭЙ 08.02.2024 КВВ СВФР-012344 )
		
		СтрокаТабличнойЧасти.КодСтроки = ПолучитьКодСтроки();
		ЗаполнимПрочиеДоплатыПоРаботнику(ВыборкаСотрудник.Сотрудник, СтрокаТабличнойЧасти.ТарифнаяСтавка, СтрокаТабличнойЧасти.КодСтроки, 1, );
		//ПСА 11.02.2021 СВФР-007191+++
		СтрокаТабличнойЧасти.КТУ = 1; 
		Если Организация.ИНН = "100071565" Тогда
			СтрокаТабличнойЧасти.ТарифнаяСтавкаДляРасчета = 1;
		КонецЕсли;

	КонецЦикла;
	
	
	Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ВЦеломЗаПериод Тогда
		МаксимальныйНомерЯчейки = 0;
		СоответствиеВидаВремениИЯчейки = Новый Соответствие;
		
		Для Каждого СтрокаОтработанногоВремени Из Исполнители Цикл
			// Очистить значения для заполнения сводных данных
			Для Сч = 1 По 5 Цикл
				СтрокаОтработанногоВремени["ВидВремени" + Сч]	= Справочники.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка();
				СтрокаОтработанногоВремени["Часов" + Сч]		= 0;
				СтрокаОтработанногоВремени["Дней" + Сч]			= 0;
			КонецЦикла;
			СоответствиеВидаВремениИЯчейки.Очистить();
			МаксимальныйНомерЯчейки = 0;
			Для ИндексЯчейки = 1 По 31 Цикл
				Для Каждого ТекущаяПриставка Из МассивПриставок Цикл
					Часов = СтрокаОтработанногоВремени[ТекущаяПриставка+"Часов"+ИндексЯчейки];
					Если Часов > 0 Тогда
						ВидВремени = СтрокаОтработанногоВремени[ТекущаяПриставка+"ВидВремени"+ИндексЯчейки];
						НомерЯчейки = СоответствиеВидаВремениИЯчейки.Получить(ВидВремени);
						Если НомерЯчейки = Неопределено Тогда
							МаксимальныйНомерЯчейки = МаксимальныйНомерЯчейки + 1;
							Если МаксимальныйНомерЯчейки > 5 Тогда
								Продолжить;
							КонецЕсли;
							СоответствиеВидаВремениИЯчейки.Вставить(ВидВремени, Строка(МаксимальныйНомерЯчейки));
							НомерЯчейки = МаксимальныйНомерЯчейки;
							СтрокаОтработанногоВремени["ВидВремени" + НомерЯчейки] = ВидВремени;
						КонецЕсли;
						СтрокаОтработанногоВремени["Часов" + НомерЯчейки] = СтрокаОтработанногоВремени["Часов" + НомерЯчейки] + Часов;
						СтрокаОтработанногоВремени["Дней" + НомерЯчейки] = СтрокаОтработанногоВремени["Дней" + НомерЯчейки] + 1;
					КонецЕсли;
				КонецЦикла;
			КонецЦикла;
		КонецЦикла;
	КонецЕсли; 
КонецПроцедуры	
//Аверсон СВФР-012937

//Аверсон ЕАЕ 03.04.2025 СВФР-014085
Процедура СформироватьДвиженияДанныеДляСвода()
	ДвиженияДанныеДляСвода = Движения.ДанныеДляСвода;
	ДвиженияДанныеДляСвода.Записывать = Истина;
	
	Если Выработка.Количество() > 0 Тогда
		СтрокаВыработка = Выработка[0];
		Объект = СтрокаВыработка.НоменклатурнаяГруппа;
		СтатьяЗатрат = СтрокаВыработка.СтатьяЗатрат;
	Иначе
		Объект = Справочники.НоменклатурныеГруппы.ПустаяСсылка();
		СтатьяЗатрат = Справочники.СтатьиЗатрат.ПустаяСсылка();
	КонецЕсли;
	
	//
	ВидРасчетаНаряд = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию("Сдельно по тек.ремонту", Истина);
	//
	
	ТЗИсполнители = Исполнители.Выгрузить();
	ТЗИсполнители.Свернуть("Сотрудник", "СуммаКНачислениюРегл,ОтработаноЧасов");
	
	Для Каждого Стр Из ТЗИсполнители Цикл
		НоваяЗапись = ДвиженияДанныеДляСвода.Добавить();
		НоваяЗапись.Период       = ПериодРегистрации;
		НоваяЗапись.Сотрудник    = Стр.Сотрудник;
		НоваяЗапись.Объект       = Объект;
		НоваяЗапись.СтатьяЗатрат = СтатьяЗатрат;
		НоваяЗапись.Сумма        = Стр.СуммаКНачислениюРегл;
		Если СпособВводаДанных = Перечисления.СпособыВводаДанныхОВремени.ЗаДень Тогда
			НоваяЗапись.ДатаС  = ДатаНачалаПериода;
			НоваяЗапись.ДатаПо = ДатаНачалаПериода;
		Иначе
			НоваяЗапись.ДатаС  = НачалоМесяца(МесяцНачислений);
			НоваяЗапись.ДатаПо = КонецМесяца(МесяцНачислений);
		КонецЕсли;
		
		//
		НоваяЗапись.ВидРасчета = ВидРасчетаНаряд;
		НоваяЗапись.Часов      = Стр.ОтработаноЧасов;
		НоваяЗапись.Документ   = Ссылка;
		//
		
	КонецЦикла;
КонецПроцедуры
//Аверсон СВФР-014085

////////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ

мВалютаРегламентированногоУчета = Константы.ВалютаРегламентированногоУчета.Получить();
мВалютаУпрУчета = Константы.ВалютаУправленческогоУчета.Получить();

ВидУчетаВремениПоДням			= Перечисления.ВидыУчетаВремени.ПоДням;
ВидУчетаВремениПоЧасам			= Перечисления.ВидыУчетаВремени.ПоЧасам;
ВидУчетаВремениПоВечернимЧасам	= Перечисления.ВидыУчетаВремени.ПоВечернимЧасам;
ВидУчетаВремениПоНочнымЧасам	= Перечисления.ВидыУчетаВремени.ПоНочнымЧасам;

МассивПриставок = Новый Массив(3);
МассивПриставок[0] = "Первый";
МассивПриставок[1] = "Второй";
МассивПриставок[2] = "Третий";

КлассификаторНочноеВремя = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы;
КлассификаторВечернееВремя = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы;

КлассификаторЯвка = Справочники.КлассификаторИспользованияРабочегоВремени.Работа;
КлассификаторВечерниеЧасы = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы;
КлассификаторНочныеЧасы = Справочники.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы;
КлассификаторПустаяСсылка = Справочники.КлассификаторИспользованияРабочегоВремени.ПустаяСсылка();
