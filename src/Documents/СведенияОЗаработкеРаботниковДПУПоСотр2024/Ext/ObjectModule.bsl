//+ СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 9 )
Перем мДлинаСуток;
//- СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 9 )
Перем СЗ_ПремияДляПУ; //Аверсон 22.12.2021 КВВ СВФР-007900
Перем СЗ_ПремияДляПУ_Классификатор; //СВЭЙ 19.01.2024 КВВ СВФР-012080
////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

Функция ПроверкаСуммыПоПособиямВыплатам(Сотрудник,МесяцВыборки,ЧтоИщем, ДоговорП = Неопределено) //СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5)
	//СВЭЙ 26.10.2023 КВВ СВФР-011519 (	 
	СуммаВыборки = 0;
	З = Новый Запрос;
	З.Текст = "ВЫБРАТЬ ";
	
	//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5) (
	Если ЧтоИщем = 1 Тогда
		З.Текст = З.Текст + "
		|РегЕСН.Сотрудник,";
	КонецЕсли;   
	З.Текст = З.Текст + "
	//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5) )
	
	|СУММА(РегЕСН.Результат) КАК Сумма
	|ИЗ РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК РегЕСН
	|ГДЕ РегЕСН.Организация = &Организация
	
	//СВЭЙ 11.01.2024 КВВ СВФР-012136 (
	//|И НАЧАЛОПЕРИОДА(РегЕСН.Период,МЕСЯЦ) = &МесяцВыборки
	|И НАЧАЛОПЕРИОДА(РегЕСН.ПериодВзаиморасчетов,МЕСЯЦ) = &МесяцВыборки
	//СВЭЙ 11.01.2024 КВВ СВФР-012136 )
	
	|И РегЕСН.Сотрудник = &Сотрудник";
	
	Если ЧтоИщем = 1 Тогда
		З.Текст = З.Текст + "                 
		|И ((
		|РегЕСН.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
		|И РегЕСН.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоБеременностиИРодам))
		
		//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5) (
		//|ИЛИ
		//|(РегЕСН.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций
		//|И РегЕСН.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.ОплатаБЛПоБеременностиИРодам))
		|)
		|СГРУППИРОВАТЬ ПО
		|РегЕСН.Сотрудник
		|
		|ОБЪЕДИНИТЬ 
		|
		|ВЫБРАТЬ
		|ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
		|СУММА(ДополнительныеНачисленияРаботниковОрганизаций.Результат) 
		|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|ГДЕ ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|И ДополнительныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда
		|И ДополнительныеНачисленияРаботниковОрганизаций.Организация = &Организация    
		|И ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ДоговорПодряда = &Договор
		|И НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,МЕСЯЦ) = &МесяцВыборки   
		|И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.ОплатаБЛПоБеременностиИРодам)
		|СГРУППИРОВАТЬ ПО
		|ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник		
		//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5) )
		|";
	ИначеЕсли ЧтоИщем = 2 Тогда
		З.Текст = З.Текст + "
		|И РегЕСН.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
		|И РегЕСН.ВидРасчета.СвободныйДеньФСЗН = ИСТИНА";
	ИначеЕсли ЧтоИщем = 3 Тогда                      
		З.Текст = З.Текст + "
		|И РегЕСН.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
		|И РегЕСН.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойПоВинеРаботодателя)";
	ИначеЕсли ЧтоИщем = 4 Тогда
		З.Текст = З.Текст + "
		|И РегЕСН.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
		|И РегЕСН.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоИнициативеНанимателя)";	
	КонецЕсли;
	З.УстановитьПараметр("Организация",Организация);
	З.УстановитьПараметр("Сотрудник",Сотрудник);
	З.УстановитьПараметр("МесяцВыборки",НачалоМесяца(МесяцВыборки));
	З.УстановитьПараметр("Договор",ДоговорП); //СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5)
	РезЗ = З.Выполнить().Выгрузить();
	Если РезЗ.Количество() = 1 Тогда
		СуммаВыборки = ?(ЗначениеЗаполнено(РезЗ[0].Сумма),РезЗ[0].Сумма,0);
	КонецЕсли;
	
	Возврат СуммаВыборки;
	//СВЭЙ 26.10.2023 КВВ СВФР-011519 )
КонецФункции


// Выполняет автоматическое заполнение документа по данным документа и переданным параметрам
// 
// Параметры: 
//  нет
//
// Возвращаемое значение:
//  Логическое - удалось ли выполнить автоматическое заполнение документа
//
Функция Автозаполнение(ПостроительЗапроса = Неопределено, Сотрудник = Неопределено) Экспорт
	
	//Аверсон 22.12.2021 КВВ СВФР-007900 (
	СЗ_ПремияДляПУ = Новый СписокЗначений;
	Для Каждого стрСЗ_ПремияДляПУ Из Справочники.ГруппыРасчетов.ПремияДляПУ.Основные Цикл 
		СЗ_ПремияДляПУ.Добавить(стрСЗ_ПремияДляПУ.ВидРасчета);
	КонецЦикла;
	//Аверсон 22.12.2021 КВВ СВФР-007900 )
	
	//СВЭЙ 19.01.2024 КВВ СВФР-012080 (
	СЗ_ПремияДляПУ_Классификатор = Новый СписокЗначений;
	Для Каждого стрСЗ_ПремияДляПУ Из Справочники.ГруппыРасчетов.ПремияДляПУ.КлассификаторИспользованияРВ Цикл 
		СЗ_ПремияДляПУ_Классификатор.Добавить(стрСЗ_ПремияДляПУ.ВидКлассификатора);
	КонецЦикла;  
	//СВЭЙ 19.01.2024 КВВ СВФР-012080 )
	
	//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
	ВР_СправкаПоУходу = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию( "Справка по уходу", Истина );
	ВР_НеОплачиваемыйБольничный = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию( "Неоплачиваемый больничный", Истина );
	ВР_Не_ОплачиваемыйБольничный = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию( "Не оплачиваемый больничный", Истина );
	ВР_БольничныйБезОплаты = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.НайтиПоНаименованию( "Больничный без оплаты", Истина );
	МассивКод15 = Новый Массив(4);
	МассивКод15[0] = ВР_СправкаПоУходу; МассивКод15[1] = ВР_НеОплачиваемыйБольничный; МассивКод15[2] = ВР_БольничныйБезОплаты;
	МассивКод15[3] = ВР_Не_ОплачиваемыйБольничный;
	//- СВЭЙ КДЯ 07.06.19 СВФР-004424
	
	Сч1 = 0;
	СписокПустыхНомеровПФР = Новый СписокЗначений;
	СписокПустыхНомеровПФР.Добавить("");
	СписокПустыхНомеровПФР.Добавить("              ");
	
	СписокПричин = Новый СписокЗначений;
	СписокПричин.Добавить(Перечисления.ПричиныИзмененияСостояния.Увольнение);
	СписокПричин.Добавить(Перечисления.ПричиныИзмененияСостояния.ПриемНаРаботу);
	
	//Запрос = Новый Запрос;
	//Запрос.УстановитьПараметр("ГоловнаяОрганизация",				ОбщегоНазначения.ГоловнаяОрганизация(Организация));
	//Запрос.УстановитьПараметр("Организация",				Организация);
	//Запрос.УстановитьПараметр("Ссылка",Ссылка);
	
	
	Запрос = Новый Запрос;
	МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
	
	Договор = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДОГОВОР");
	Если Договор.Пустая() тогда
		ДоговорОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ДоговорОбъект.Код = "ДОГОВОР";
		ДоговорОбъект.Наименование = "Работа, выполняемая на основе гражданско-правовых договоров (предметом которых являются оказание услуг, выполнение работ и создание объектов интеллектуальной собственности) у юридических лиц и индивидуальных предпринимателей";
		ДоговорОбъект.Записать();
		Договор = ДоговорОбъект.Ссылка;
	КонецЕсли;
	Дети = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ");
	Если Дети.Пустая() тогда
		ДетиОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ДетиОбъект.Код = "ДЕТИ";
		ДетиОбъект.Наименование = "Период отпуска по уходу за ребенком и ухода за детьми до достижения ими возраста 3 лет";
		ДетиОбъект.Записать();
		Дети = ДетиОбъект.Ссылка;
	КонецЕсли;
	//Островская Татьяна 05.03.2014 № 17172
	Пособие = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБИЕ");
	Если Пособие.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ПОСОБИЕ";
		ПособиеОбъект.Наименование = "Пособие";
		ПособиеОбъект.Записать();
		Пособие = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ВзносыВрем = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВЗНОСЫВРЕМ");
	Если ВзносыВрем.Пустая() тогда
		ВзносыВремОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ВзносыВремОбъект.Код = "ВЗНОСЫВРЕМ";
		ВзносыВремОбъект.Наименование = "Вносы врем.";
		ВзносыВремОбъект.Записать();
		ВзносыВрем = ВзносыВремОбъект.Ссылка;
	КонецЕсли;
	
	Премия = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПРЕМИЯ");
	Если Премия.Пустая() тогда
		ПремияОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПремияОбъект.Код = "ПРЕМИЯ";
		ПремияОбъект.Наименование = "Премия";
		ПремияОбъект.Записать();
		Премия = ПремияОбъект.Ссылка;
	КонецЕсли;
	//О.Т. Аверсон 18.05.2018 № 1985
	СТРАХСЛУЧ = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("СТРАХСЛУЧ");
	Если СТРАХСЛУЧ.Пустая() тогда
		СТРАХСЛУЧОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		СТРАХСЛУЧОбъект.Код = "СТРАХСЛУЧ";
		СТРАХСЛУЧОбъект.Наименование = "СтрахСлуч";
		СТРАХСЛУЧОбъект.Записать();
		СТРАХСЛУЧ = СТРАХСЛУЧОбъект.Ссылка;
	КонецЕсли;
	//О.Т. Аверсон 18.05.2018 № 1985
	
	//О.Т. Аверсон 14.05.2019 № 4328
	НеоплДог = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("НЕОПЛДОГ");
	Если НеоплДог.Пустая() тогда
		НеоплДогОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		НеоплДогОбъект.Код = "НЕОПЛДОГ";
		НеоплДогОбъект.Наименование = "Неопл.дог";
		НеоплДогОбъект.Записать();
		НеоплДог = НеоплДогОбъект.Ссылка;
	КонецЕсли;
	
	//О.Т. Аверсон 14.05.2019 № 4328
	
	//Аверсон ЕАЕ 20.07.2021 СВФР-007783
	ПрофДопДляПУ3 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПРОФДОП");
	Если ПрофДопДляПУ3.Пустая() тогда
		ПрофДопДляПУ3Объект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПрофДопДляПУ3Объект.Код = "ПРОФДОП";
		ПрофДопДляПУ3Объект.Наименование = "ПРОФДОП для ПУ-3";
		ПрофДопДляПУ3Объект.Записать();
		ПрофДопДляПУ3 = ПрофДопДляПУ3Объект.Ссылка;
	КонецЕсли;
	//Аверсон СВФР-007783
	
	//Аверсон ЕАЕ 08.12.2021 СВФР-008384
	ВремНетрудДляПУ3 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВРЕМНЕТРУД");
	Если ВремНетрудДляПУ3.Пустая() тогда
		ВремНетрудДляПУ3Объект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ВремНетрудДляПУ3Объект.Код = "ВРЕМНЕТРУД";
		ВремНетрудДляПУ3Объект.Наименование = "ВРЕМНЕТРУД для ПУ-3";
		ВремНетрудДляПУ3Объект.Записать();
		ВремНетрудДляПУ3 = ВремНетрудДляПУ3Объект.Ссылка;
	КонецЕсли;
	//Аверсон СВФР-008384
	
	//Аверсон ЕАЕ 16.04.2022 СВФР-008941
	ДЕТИ0 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ0");
	Если ДЕТИ0.Пустая() тогда
		ДетиОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ДетиОбъект.Код = "ДЕТИ0";
		ДетиОбъект.Наименование = "Период отпуска по уходу за ребенком и ухода за детьми до достижения ими возраста 3 лет без выплаты пособия";
		ДетиОбъект.Записать();
		ДЕТИ0 = ДетиОбъект.Ссылка;
	КонецЕсли;
	
	ДЕТИ100 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ100");
	Если ДЕТИ100.Пустая() тогда
		ДетиОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ДетиОбъект.Код = "ДЕТИ100";
		ДетиОбъект.Наименование = "Период отпуска по уходу за ребенком и ухода за детьми до достижения ими возраста 3 лет с пособием 100%";
		ДетиОбъект.Записать();
		ДЕТИ100 = ДетиОбъект.Ссылка;
	КонецЕсли;
	
	ДЕТИ50 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ50");
	Если ДЕТИ50.Пустая() тогда
		ДетиОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ДетиОбъект.Код = "ДЕТИ50";
		ДетиОбъект.Наименование = "Период отпуска по уходу за ребенком и ухода за детьми до достижения ими возраста 3 лет с пособием 50%";
		ДетиОбъект.Записать();
		ДЕТИ50 = ДетиОбъект.Ссылка;
	КонецЕсли;
	
	ДПОСОБ100 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДПОСОБ100");
	Если ДПОСОБ100.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ДПОСОБ100";
		ПособиеОбъект.Наименование = "Период получения пособия 100%";
		ПособиеОбъект.Записать();
		ДПОСОБ100 = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ДПОСОБ50 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДПОСОБ50");
	Если ДПОСОБ50.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ДПОСОБ50";
		ПособиеОбъект.Наименование = "Период получения пособия 50%";
		ПособиеОбъект.Записать();
		ДПОСОБ50 = ПособиеОбъект.Ссылка;
	КонецЕсли;
	//Аверсон СВФР-008941
	
	//СВЭЙ 05.10.2023 КВВ СВФР-011519 (
	ПОСОБИЕ0 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБИЕ0");
	Если ПОСОБИЕ0.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ПОСОБИЕ0";
		ПособиеОбъект.Наименование = "Период временной нетрудоспособности без выплаты пособия";
		ПособиеОбъект.Записать();
		ПОСОБИЕ0 = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ПРОСТОИ = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПРОСТОИ");
	Если ПРОСТОИ.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ПРОСТОИ";
		ПособиеОбъект.Наименование = "Период целодневных (целосменных) простоев не по вине работника";
		ПособиеОбъект.Записать();
		ПРОСТОИ = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ОТПИН = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ОТПИН");
	Если ОТПИН.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ОТПИН";
		ПособиеОбъект.Наименование = "Период отпуска с частичным сохранением заработной платы, предоставляемого по инициативе нанимателя";
		ПособиеОбъект.Записать();
		ОТПИН = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ОТПИН0 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ОТПИН0");
	Если ОТПИН0.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ОТПИН0";
		ПособиеОбъект.Наименование = "Период отпуска без сохранения заработной платы, предоставляемого по инициативе нанимателя";
		ПособиеОбъект.Записать();
		ОТПИН0 = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ПОСОБУХОД = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБУХОД");
	Если ПОСОБУХОД.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ПОСОБУХОД";
		ПособиеОбъект.Наименование = "Период временной нетрудоспособности по уходу за ребенком  с выплатой пособия";
		ПособиеОбъект.Записать();
		ПОСОБУХОД = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ПОСОБУХОД0 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБУХОД0");
	Если ПОСОБУХОД0.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ПОСОБУХОД0";
		ПособиеОбъект.Наименование = "Период временной нетрудоспособности по уходу за ребенком без выплаты пособия";
		ПособиеОбъект.Записать();
		ПОСОБУХОД0 = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ПОСОББИР0 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОББИР0");
	Если ПОСОББИР0.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ПОСОББИР0";
		ПособиеОбъект.Наименование = "Период беременности и родов без выплаты пособия";
		ПособиеОбъект.Записать();
		ПОСОББИР0 = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ПОСОББИР = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОББИР");
	Если ПОСОББИР.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ПОСОББИР";
		ПособиеОбъект.Наименование = "Период беременности и родов с выплатой пособия";
		ПособиеОбъект.Записать();
		ПОСОББИР = ПособиеОбъект.Ссылка;
	КонецЕсли;
	
	ПОСОБДЕНЬ = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБДЕНЬ");
	Если ПОСОБДЕНЬ.Пустая() тогда
		ПособиеОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
		ПособиеОбъект.Код = "ПОСОБДЕНЬ";
		ПособиеОбъект.Наименование = "Оплата дополнительного свободного от работы дня матери (мачехе) или отцу (отчиму), опекуну (попечителю), воспитывающей (воспитывающему) ребенка-инвалида в возрасте до восемнадцати лет за счет средств государственного";
		ПособиеОбъект.Записать();
		ПОСОБДЕНЬ = ПособиеОбъект.Ссылка;
	КонецЕсли;
	//СВЭЙ 05.10.2023 КВВ СВФР-011519 )
	
	//Островская Татьяна 05.03.2014 № 17172
	
	// + СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
	Запрос.УстановитьПараметр( "Организация", ЭтотОбъект.Организация );
	Запрос.УстановитьПараметр( "ПоВсемФизЛицам", Сотрудник = Неопределено );
	Запрос.УстановитьПараметр( "Сотрудник", Сотрудник );
	Запрос.УстановитьПараметр( "ВсеСотрудники", ЭтотОбъект.ВсеСотрудники );
	Запрос.УстановитьПараметр( "Основные", ЭтотОбъект.Основные );
	Запрос.УстановитьПараметр( "ДогПодряда", ЭтотОбъект.ДогПодряда );
	// - СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
	
	//О.Т. Аверсон 17.01.2018 № 1455
	Если ПостроительЗапроса = Неопределено Тогда
		
		// + СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
		//Запрос.Текст = "ВЫБРАТЬ
		//|	РаботникиОрганизаций.Ссылка КАК Ссылка,
		//|	РаботникиОрганизаций.Физлицо КАК Ссылка1
		//|ИЗ
		//|	Справочник.СотрудникиОрганизаций КАК РаботникиОрганизаций";
		//СписокСотрудников = Запрос.Выполнить().Выгрузить();
		// - СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
		
		// + СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
		Запрос.Текст = "ВЫБРАТЬ
		|	Сотрудники.Ссылка КАК Сотрудник,
		|	Сотрудники.ТипРаботника КАК ТипРаботника,
		|	Сотрудники.ФизЛицо КАК ФизЛицо
		|ИЗ
		|	Справочник.СотрудникиОрганизаций КАК Сотрудники
		|ГДЕ
		|	( &ВсеСотрудники
		|	ИЛИ &Основные И Сотрудники.ВидДоговора <> ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.Подряда )
		|	ИЛИ &ДогПодряда И Сотрудники.ВидДоговора = ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.Подряда ) )
		|   И ( &ПоВсемФизЛицам ИЛИ Ссылка = &Сотрудник )
		|	И Сотрудники.Организация = &Организация
		|УПОРЯДОЧИТЬ ПО
		|	Сотрудники.Наименование	
		|";
		
		ТЗ_Сотрудников = Запрос.Выполнить().Выгрузить();
		СписокСотрудников = ТЗ_Сотрудников.ВыгрузитьКолонку( "Сотрудник" );
		// - СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
		
	иначе
		
		ИсходныйТекстПостроителя = ПостроительЗапроса.Текст;
		ТекстЗапросаПоСпискуРаботников = СтрЗаменить(ИсходныйТекстПостроителя,"РАЗРЕШЕННЫЕ","");
		ПостроительЗапроса.Текст = ТекстЗапросаПоСпискуРаботников;
		ПостроительЗапроса.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		ПостроительЗапроса.Выполнить();
		
		// + СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
		//СотрудникиТекст = 
		//"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		//|	СписокРаботников.Сотрудник КАК Ссылка,
		//|	СписокРаботников.ФизЛицо как Ссылка1
		//|ИЗ
		//|	ВТСписокРаботников КАК СписокРаботников";
		//ПостроительЗапроса.Текст = СотрудникиТекст;
		//ПостроительЗапроса.Выполнить();
		//СписокСотрудников = ПостроительЗапроса.Выполнить().Выгрузить();
		// - СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
		
		// + СВЭЙ КДЯ 11.09.19 СВФР-004631 ( пункт 22. )
		СотрудникиТекст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СписокРаботников.Сотрудник КАК Сотрудник,
		|	СписокРаботников.Сотрудник.ТипРаботника КАК ТипРаботника,
		|	СписокРаботников.Сотрудник.ВидЗанятости КАК ВидЗанятости,//СВЭЙ 17.04.2024 КВВ СВФР-012815
		|	СписокРаботников.ФизЛицо КАК ФизЛицо
		|ИЗ
		|	ВТСписокРаботников КАК СписокРаботников
		|ГДЕ
		|	&ВсеСотрудники
		|	ИЛИ &Основные И СписокРаботников.Сотрудник.ВидДоговора <> ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.Подряда )
		|	ИЛИ &ДогПодряда И СписокРаботников.Сотрудник.ВидДоговора = ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.Подряда )
		|УПОРЯДОЧИТЬ ПО
		|	СписокРаботников.Сотрудник.Наименование	
		|";
		ПостроительЗапроса.Текст = СотрудникиТекст;
		ПостроительЗапроса.УстановитьПараметр( "ВсеСотрудники", ЭтотОбъект.ВсеСотрудники );
		ПостроительЗапроса.УстановитьПараметр( "Основные", ЭтотОбъект.Основные );
		ПостроительЗапроса.УстановитьПараметр( "ДогПодряда", ЭтотОбъект.ДогПодряда );
		ТЗ_Сотрудников = ПостроительЗапроса.Выполнить().Выгрузить();
		
		//СВЭЙ 17.04.2024 КВВ СВФР-012815 (
		Если ТЗ_Сотрудников.Количество() > 0 И ВсеСотрудники И ОбъединятьОсновные Тогда
			
			//убираем вн.совм, по которым в списке нет осн.работников 
			ТЗ_Сотрудников.Колонки.Добавить("НадоУдалить");  
			НадоУдалить = Ложь;
			
			Отбор1 = Новый Структура;
			Отбор1.Вставить("ВидЗанятости", Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство);
			
			Строки_Отбор1 = ТЗ_Сотрудников.НайтиСтроки(Отбор1);
			Если Строки_Отбор1.Количество() > 0 Тогда
				Для Каждого Стр1 ИЗ Строки_Отбор1 Цикл 
					Отбор2 = Новый Структура;  
					Отбор2.Вставить("ФизЛицо", Стр1.ФизЛицо);
					Отбор2.Вставить("ВидЗанятости", Перечисления.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы);
					Строки_Отбор2 = ТЗ_Сотрудников.НайтиСтроки(Отбор2);  
					
					Если Строки_Отбор2.Количество() = 0 Тогда
						Стр1.НадоУдалить = Истина;
						НадоУдалить = Истина;
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			
			Если НадоУдалить Тогда
				НадоУдалитьСтроки = ТЗ_Сотрудников.НайтиСтроки(Новый Структура("НадоУдалить",Истина));
				Для каждого СтрокаТаблицыНадоУдалитьСтроки Из НадоУдалитьСтроки Цикл  
					Сообщить("Из списка удален вн. совместитель (будет отражен по осн. работнику) : " + СокрЛП(СтрокаТаблицыНадоУдалитьСтроки.Сотрудник) + " (тн " + СокрЛП(СтрЗаменить(СтрокаТаблицыНадоУдалитьСтроки.Сотрудник.Код," ","")) + ")");
					ТЗ_Сотрудников.Удалить(СтрокаТаблицыНадоУдалитьСтроки);
				КонецЦикла;
			КонецЕсли;  
			
			//проверяем всех осн.работников, есть ли у них где-то вн.совм., добавляем их
			З_ВнСовм = Новый Запрос;
			З_ВнСовм.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|СписокРаботников.Ссылка КАК Сотрудник,  
			|СписокРаботников.ТипРаботника КАК ТипРаботника,
			|СписокРаботников.ВидЗанятости КАК ВидЗанятости,
			|СписокРаботников.ФизЛицо КАК ФизЛицо,
			|ВЫБОР
			|КОГДА РаботникиОрганизацийПрием.Период ЕСТЬ NULL
			|ТОГДА ДатаВремя(1,1,1)
			|ИНАЧЕ РаботникиОрганизацийПрием.Период
			|КОНЕЦ КАК ДатаПриема,
			|ВЫБОР
			|КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
			|ТОГДА ДатаВремя(1,1,1)
			|ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(РаботникиОрганизацийУвольнение.Период, ДЕНЬ), СЕКУНДА, -1), ДЕНЬ)
			|КОНЕЦ КАК ДатаУвольнения 
			|ИЗ Справочник.СотрудникиОрганизаций КАК СписокРаботников 
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийПрием
			|ПО СписокРаботников.Ссылка = РаботникиОрганизацийПрием.Сотрудник
			|И РаботникиОрганизацийПрием.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийУвольнение
			|ПО СписокРаботников.Ссылка = РаботникиОрганизацийУвольнение.Сотрудник
			|И РаботникиОрганизацийУвольнение.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|ГДЕ
			|СписокРаботников.ВидЗанятости = ЗНАЧЕНИЕ( Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство )    
			|И НЕ СписокРаботников.ПометкаУдаления
			|И ВЫБОР
			|КОГДА РаботникиОрганизацийПрием.Период ЕСТЬ NULL
			|ТОГДА ДатаВремя(1,1,1)
			|ИНАЧЕ РаботникиОрганизацийПрием.Период
			|КОНЕЦ <> ДатаВремя(1,1,1)
			|И ВЫБОР
			|КОГДА РаботникиОрганизацийПрием.Период ЕСТЬ NULL
			|ТОГДА ДатаВремя(1,1,1)
			|ИНАЧЕ РаботникиОрганизацийПрием.Период
			|КОНЕЦ < &ДатаОкончания
			|И (ВЫБОР
			|КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
			|ТОГДА ДатаВремя(1,1,1)
			|ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(РаботникиОрганизацийУвольнение.Период, ДЕНЬ), СЕКУНДА, -1), ДЕНЬ)
			|КОНЕЦ = ДатаВремя(1,1,1)
			|ИЛИ
			|ВЫБОР
			|КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
			|ТОГДА ДатаВремя(1,1,1)
			|ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(РаботникиОрганизацийУвольнение.Период, ДЕНЬ), СЕКУНДА, -1), ДЕНЬ)
			|КОНЕЦ > НАЧАЛОПЕРИОДА(&ДатаНачала,ГОД))";
			З_ВнСовм.УстановитьПараметр("ДатаНачала",НачалоДня(ДатаНачала)); 
			З_ВнСовм.УстановитьПараметр("ДатаОкончания",КонецДня(ДатаОкончания)); 
			РезВнСовм = З_ВнСовм.Выполнить().Выгрузить();
			Для Каждого СтрВнСовм ИЗ РезВнСовм Цикл
				Отбор3 = Новый Структура;
				Отбор3.Вставить("ФизЛицо", СтрВнСовм.ФизЛицо);
				Отбор3.Вставить("ВидЗанятости", Перечисления.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы);
				Строки_Отбор3 = ТЗ_Сотрудников.НайтиСтроки(Отбор3);
				Если Строки_Отбор3.Количество() <> 0 Тогда
					Отбор4 = Новый Структура;
					Отбор4.Вставить("Сотрудник", СтрВнСовм.Сотрудник);
					Строки_Отбор4 = ТЗ_Сотрудников.НайтиСтроки(Отбор4);
					Если Строки_Отбор4.Количество() = 0 Тогда  
						СтрНью = ТЗ_Сотрудников.Добавить();
						ЗаполнитьЗначенияСвойств(СтрНью,СтрВнСовм);
						Сообщить("В список добавлен вн. совместитель (отражен по осн. работнику) : " + СокрЛП(СтрВнСовм.Сотрудник) + " (тн " + СокрЛП(СтрЗаменить(СтрВнСовм.Сотрудник.Код," ","")) + ")");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		//СВЭЙ 17.04.2024 КВВ СВФР-012815 )  
		
		СписокСотрудников = ТЗ_Сотрудников.ВыгрузитьКолонку( "Сотрудник" );
		
		Если СписокСотрудников.Количество() = 0 Тогда
			Сообщить( "Не найдено ни одного сотрудника, соответствующего отбору!", СтатусСообщения.Важное );
			Возврат Истина;
		КонецЕсли; 
		// - СВЭЙ КДЯ 29.07.19 СВФР-004561
		
	КонецЕсли;
	
	
	Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
	
	ЗапросПособие = Новый Запрос;
	Если Сотрудник = Неопределено Тогда 
		ПолучитьТаблицуПособий(ЗапросПособие);
	КонецЕсли;
	
	
	//О.Т. Аверсон 17.01.2018 № 1455
	
	//Островская Татьяна 20.01.2014 № 17051
	Запрос.УстановитьПараметр("КонецПрошлогоГода", НачалоГода(ДатаНачала)-1);//НачалоМесяца(ДатаРегистрации)-1);
	Запрос.УстановитьПараметр("НачалоГода", ДатаНачала);//НачалоГода(ДобавитьМесяц(НачалоКвартала(ДатаРегистрации),-1)));
	Запрос.УстановитьПараметр("КонецГода", конецГода(ДатаОкончания)); //конецГода(ДатаРегистрации)
	Запрос.УстановитьПараметр("СписокОтчитывающихсяПодразделений", Организация);
	Запрос.УстановитьПараметр("Увольнение", Перечисления.ПричиныИзмененияСостояния.Увольнение);
	Запрос.УстановитьПараметр("ВнСовместитель", Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство);
	Запрос.УстановитьПараметр("СписокОтчитывающихсяПодразделений", Организация);
	Запрос.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
	Запрос.УстановитьПараметр("ДоходФСЗН", Перечисления.ДоходыФСС_НС.Облагается);
	Запрос.УстановитьПараметр("ДатаПодачиСведений", ДатаОкончания);//ДатаРегистрации);// дата акуальности сведений о доходах и налогах
	Запрос.УстановитьПараметр("Договор",Договор);  
	Запрос.УстановитьПараметр("Дети",Дети);
	Запрос.УстановитьПараметр("ПоВсемФизЛицам", Сотрудник = Неопределено);
	Запрос.УстановитьПараметр("Сотрудник", Сотрудник);
	Запрос.УстановитьПараметр("ПустойДоговор", Документы.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка());
	Запрос.УстановитьПараметр("СписокПустыхНомеровПФР",		СписокПустыхНомеровПФР);
	//Запрос.УстановитьПараметр("Увольнение",		СписокПричин);
	Запрос.УстановитьПараметр("ДатаНачала" , 		НачалоКвартала(ДатаНачала));
	Запрос.УстановитьПараметр("ДатаАктуальности" , 	КонецКвартала(ДатаНачала));
	Запрос.УстановитьПараметр("ВидАдресаРегистрации" , 	Справочники.ВидыКонтактнойИнформации.ЮрАдресФизЛица);
	Запрос.УстановитьПараметр("ВидАдресаФактический" , 	Справочники.ВидыКонтактнойИнформации.ФактАдресФизЛица);
	Запрос.УстановитьПараметр("ВидТелефонаДомашний" , 	Справочники.ВидыКонтактнойИнформации.ТелефонФизЛица);
	Запрос.УстановитьПараметр("ТипТелефон" , 	Перечисления.ТипыКонтактнойИнформации.Телефон);
	Запрос.УстановитьПараметр("ТипАдрес" , 	Перечисления.ТипыКонтактнойИнформации.Адрес);
	Запрос.УстановитьПараметр("ПустаяСтрана" , Справочники.КлассификаторСтранМира.ПустаяСсылка());
	Запрос.УстановитьПараметр("СтранапоУмолчанию" , Справочники.КлассификаторСтранМира.НайтиПоКоду("112"));
	
	//СВЭЙ 25.04.2024 КВВ СВФР-012944 (пункт 2) (
	//Запрос.УстановитьПараметр("ДоговораПодряда" , Справочники.КатегорииЗастрахованныхЛиц.НайтиПоРеквизиту("КодПФР","03"));
	Запрос.УстановитьПараметр("ДоговораПодряда" , Справочники.КатегорииЗастрахованныхЛиц.ПустаяСсылка());
	//СВЭЙ 25.04.2024 КВВ СВФР-012944 (пункт 2) )
	
	Запрос.УстановитьПараметр("ПериодВзаиморасчетов" , ДатаОкончания);//КонецМесяца(ДобавитьМесяц(НачалоКвартала(ДатаРегистрации),-1)));
	Запрос.УстановитьПараметр("СотрудникПустоеЗначение" , Справочники.СотрудникиОрганизаций.ПустаяСсылка());
	СписокВидРасчета = Новый СписокЗначений;
	СписокВидРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
	СписокВидРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
	СписокВидРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
	СписокВидРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
	Запрос.УстановитьПараметр("ВидРасчета" , СписокВидРасчета);
	
	Запрос.УстановитьПараметр("СпособРасчета" , Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	Запрос.УстановитьПараметр("ПодразделениеОрганизации" , ПодразделениеОрганизации);
	Запрос.УстановитьПараметр("ДатаКалендаря" , ДатаНачала);
	Запрос.УстановитьПараметр("ДатаКалендаря1" , ДатаОкончания);
	//О.Т. Аверсон 28.02.2019 № 3224
	СпособыПособия = Новый СписокЗначений;
	СпособыПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	для Каждого стрПособ из Справочники.ГруппыРасчетов.ДопПособияДляПУ3.Основные Цикл 
		СпособыПособия.Добавить(стрПособ.ВидРасчета);
	КонецЦикла;  
	//О.Т. Аверсон 28.02.2019 № 3224
	
	Запрос.УстановитьПараметр("СпособРасчета" , СпособыПособия);
	
	//О.Т. Аверсон 28.02.2019 № 3224
	ВидыРасчетаПремия = Новый СписокЗначений;
	ВидыРасчетаПремия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
	для Каждого стрПособ из Справочники.ГруппыРасчетов.ПремияДляПУ.Основные Цикл 
		ВидыРасчетаПремия.Добавить(стрПособ.ВидРасчета);
	КонецЦикла;  
	//О.Т. Аверсон 28.02.2019 № 3224
	
	Запрос.УстановитьПараметр("ВидРасчетаПремия" , ВидыРасчетаПремия);
	Запрос.УстановитьПараметр("ОснНачисление_ОплатаБЛПоТравмеНаПроизводстве" , ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве); //ПСА 08.07.2019 СВФР-004373
	
	//Аверсон ЕАЕ 27.10.2022 СВФР-009696
	Запрос.УстановитьПараметр("ПоПериодуВзаиморасчетов", ОтборПоПериодуВзаиморасчетов);
	//Аверсон СВФР-009696
	
	ДанныеОПравеНаПенсиюТекст = 
	"ВЫБРАТЬ
	|	НАЧАЛОПЕРИОДА(Периоды.Период,МЕСЯЦ) КАК Месяц,
	|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо
	|ПОМЕСТИТЬ ВТДанныеОПравеНаПенсию
	|ИЗ
	|	(ВЫБРАТЬ
	|		Периоды.Период КАК Период,
	|		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
	|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
	|	ИЗ
	|		ВТПериоды КАК Периоды
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|			ПО Периоды.Период >= ГражданствоФизЛиц.Период
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ГражданствоФизЛиц.ФизЛицо,
	|		Периоды.Период) КАК Периоды
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	|		ПО (ГражданствоФизЛиц.Период = Периоды.ПериодРегистра)
	|			И (ГражданствоФизЛиц.ФизЛицо = Периоды.Физлицо)
	|			И (ГражданствоФизЛиц.НеИмеетПравоНаПенсию)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Месяц";
	Если ВыгрузкаДоговоровПодрядаБезОграничения Тогда 
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|	СУММА(ВЫБОР
		|			КОГДА ЕСНИсчисленный.ПроцентФСЗН = 0
		|				ТОГДА 1
		|			ИНАЧЕ ЕСНИсчисленный.ПроцентФСЗН
		|		КОНЕЦ) КАК ПроцентФСЗН,
		|	СУММА(ВЫБОР
		|			КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1)
		|					И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
		|				ТОГДА ВЫРАЗИТЬ((ЕСНИсчисленный.ПенсионныйФонд + ЕСНИсчисленный.ФСЗН) / 10000 КАК ЧИСЛО(15, 2))
		|			ИНАЧЕ ЕСНИсчисленный.ПенсионныйФонд + ЕСНИсчисленный.ФСЗН
		|		КОНЕЦ) КАК Взносы
		|ПОМЕСТИТЬ ВТФСЗНИсчисленный
		|ИЗ
		|	РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|ГДЕ
		|	ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
		
		//Аверсон ЕАЕ 20.01.2022 СВФР-008626
		//|	И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
		|	//И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
		//Аверсон СВФР-008626
		
		|	И ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|	И ВЫБОР
		|			КОГДА &ПоВсемФизЛицам
		|				ТОГДА ЕСНИсчисленный.Сотрудник В (&СписокСотрудников)
		|			ИНАЧЕ ЕСНИсчисленный.Сотрудник = &Сотрудник
		|		КОНЕЦ
		|
		|СГРУППИРОВАТЬ ПО
		|	ЕСНИсчисленный.Сотрудник,
		|	ЕСНИсчисленный.ФизЛицо,
		|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник,
		|	ПериодВзаиморасчетов
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|	ВЫБРАТЬ
		|	Сумма(ВложЗапрос.Выплаты) КАК Выплаты,
		|	ВложЗапрос.ФизЛицо,
		|	ВложЗапрос.Сотрудник,
		|	ВложЗапрос.ПериодВзаиморасчетов,
		|	ВложЗапрос.Категория,
		|	ВложЗапрос.ДокументОснование,
		|	ВложЗапрос.ВидРасчетаОклад
		|	ПОМЕСТИТЬ ВТФСЗНДоходы
		|	ИЗ
		|	(ВЫБРАТЬ
		|	СУММА(ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
		|					И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ДАТАВРЕМЯ(2016, 7, 1)
		|				ТОГДА ВЫРАЗИТЬ(ДополнительныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
		|			ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Результат
		|		КОНЕЦ) КАК Выплаты,
		|	ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
		|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
		|	НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|	ВЫБОР
		|		КОГДА ВложенныйЗапрос.Флаг
		|			ТОГДА &ДоговораПодряда
		|		ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо.СтатусКатегория
		|	КОНЕЦ КАК Категория,
		|	ВложенныйЗапрос.Регистратор КАК ДокументОснование,
		|	СведДоходыОклад.ВидРасчета КАК ВидРасчетаОклад
		
		|ИЗ
		|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник как Сотрудник,
		|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
		|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка КАК Регистратор,
		|			ВЫБОР
		|				КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка = &ПустойДоговор
		|					ТОГДА ЛОЖЬ
		|				ИНАЧЕ ИСТИНА
		|			КОНЕЦ КАК Флаг
		|		ИЗ
		|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
		|		ГДЕ
		|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом
		|			И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Организация = &СписокОтчитывающихсяПодразделений) КАК ВложенныйЗапрос
		|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование = ВложенныйЗапрос.Регистратор
		|			И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = ВложенныйЗапрос.Сотрудник
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
		|			ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
		|			НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|			""Оклад"" КАК ВидРасчета
		|		ИЗ
		|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		|		ГДЕ
		|			ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
		|			И НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) = &ПериодВзаиморасчетов
		|			И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|		
		|		СГРУППИРОВАТЬ ПО
		|			ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
		|			ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|			НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ)) КАК СведДоходыОклад
		|		ПО ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = СведДоходыОклад.Сотрудник
		|			И (НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = НАЧАЛОПЕРИОДА(СведДоходыОклад.ПериодВзаиморасчетов, МЕСЯЦ))
		|ГДЕ
		|	ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало МЕЖДУ &НачалоГода И &КонецГода
		|	//И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации <= &ДатаПодачиСведений
		|	И ВЫБОР
		|			КОГДА &ПоВсемФизЛицам
		|				ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник В (&СписокСотрудников)
		|			ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|		КОНЕЦ
		|	И ДополнительныеНачисленияРаботниковОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
		|	И ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)";
		Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
			Запрос.Текст = Запрос.Текст + " И 
			
			//СВЭЙ 17.04.2024 КВВ СВФР-012815 (
			|(ВЫБОР КОГДА ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство) 
			|ТОГДА ИСТИНА
			|ИНАЧЕ
			//СВЭЙ 17.04.2024 КВВ СВФР-012815 )
			
			|ЕСТЬNULL(ВложенныйЗапрос.Регистратор.ПодразделениеОрганизации, ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации) В ИЕРАРХИИ (&ПодразделениеОрганизации) 
			|КОНЕЦ)
			|";
		КонецЕсли;
		Запрос.Текст = Запрос.Текст +"
		|
		|СГРУППИРОВАТЬ ПО
		|	ВложенныйЗапрос.Регистратор,
		|	СведДоходыОклад.ВидРасчета,
		|	НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ),
		|	ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
		
		|	ВЫБОР
		|		КОГДА ВложенныйЗапрос.Флаг
		|			ТОГДА &ДоговораПодряда
		|		ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо.СтатусКатегория
		|	КОНЕЦ ) КАК ВложЗапрос
		
		|	СГРУППИРОВАТЬ ПО
		|ВложЗапрос.ФизЛицо,
		|ВложЗапрос.Сотрудник,
		|ВложЗапрос.ВидРасчетаОклад,
		|ВложЗапрос.ДокументОснование,
		|ВложЗапрос.Категория,
		|ВложЗапрос.ПериодВзаиморасчетов
		
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ВложЗапрос.ФизЛицо,
		|	ВложЗапрос.ПериодВзаиморасчетов
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|		ВЫБРАТЬ
		|	ДанныеПоПособиям.ПериодВзаиморасчетов,
		|	ДанныеПоПособиям.Сотрудник как Сотрудник,
		|	ДанныеПоПособиям.ФизЛицо,
		|	СУММА(ДанныеПоПособиям.Пособия) КАК Пособия,
		|	ДанныеПоПособиям.Регистратор,
		|	ДанныеПоПособиям.ДокументОснованиеДатаОкончания
		|ПОМЕСТИТЬ ВТФСЗНПособия
		|ИЗ
		|	(ВЫБРАТЬ
		|		НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|		ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
		
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
		|					И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ДАТАВРЕМЯ(2016, 7, 1)
		|				ТОГДА ВЫРАЗИТЬ(ДополнительныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало < ДАТАВРЕМЯ(2016, 7, 1)
		|					И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1)
		|				ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Результат * 10000
		|			ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Результат
		|		КОНЕЦ КАК Пособия,
		|		ДополнительныеНачисленияРаботниковОрганизаций.Регистратор КАК Регистратор,
		|		МАКСИМУМ(ВТФСЗНДоходы.ДокументОснование.ДатаОкончания) КАК ДокументОснованиеДатаОкончания
		|	ИЗ
		|		ВТФСЗНДоходы КАК ВТФСЗНДоходы
		|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|			ПО ВТФСЗНДоходы.Сотрудник = ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
		|				И (ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ВТФСЗНДоходы.ДокументОснование.ДатаОкончания
		|					ИЛИ ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ВТФСЗНДоходы.ДокументОснование.ДатаНачала
		|						И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало <= ВТФСЗНДоходы.ДокументОснование.ДатаОкончания)
		|	ГДЕ
		|		ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало МЕЖДУ &НачалоГода И &КонецГода
		|		И ВЫБОР
		|				КОГДА &ПоВсемФизЛицам
		|					ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник В (&СписокСотрудников)
		|				ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
		|			КОНЕЦ
		|		И ДополнительныеНачисленияРаботниковОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
		|		И ДополнительныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда
		|		И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета В (&СпособРасчета)
		|	
		|	СГРУППИРОВАТЬ ПО
		|		НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ),
		|		ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|		ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
		|		ДополнительныеНачисленияРаботниковОрганизаций.Регистратор,
		|		ВЫБОР
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
		|					И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ДАТАВРЕМЯ(2016, 7, 1)
		|				ТОГДА ВЫРАЗИТЬ(ДополнительныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
		|			КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало < ДАТАВРЕМЯ(2016, 7, 1)
		|					И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации >= ДАТАВРЕМЯ(2016, 7, 1)
		|				ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Результат * 10000
		|			ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Результат
		|		КОНЕЦ) КАК ДанныеПоПособиям
		
		|СГРУППИРОВАТЬ ПО
		|	ДанныеПоПособиям.ПериодВзаиморасчетов,
		|	ДанныеПоПособиям.ФизЛицо,
		|	ДанныеПоПособиям.Сотрудник,
		|	ДанныеПоПособиям.Регистратор,
		|	ДанныеПоПособиям.ДокументОснованиеДатаОкончания
		
		|;
		
		|
		//|////////////////////////////////////////////////////////////////////////////////
		//|ВЫБРАТЬ
		//|	НАЧАЛОПЕРИОДА(Периоды.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		//|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо
		//|ПОМЕСТИТЬ ВТДанныеОПравеНаПенсию
		//|ИЗ
		//|	(ВЫБРАТЬ
		//|		Периоды.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
		//|		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
		//|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
		//|	ИЗ
		//|		ВТФСЗНДоходы КАК Периоды
		//|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
		//|			ПО Периоды.ПериодВзаиморасчетов >= ГражданствоФизЛиц.Период
		//|	
		//|	СГРУППИРОВАТЬ ПО
		//|		ГражданствоФизЛиц.ФизЛицо,
		//|		Периоды.ПериодВзаиморасчетов) КАК Периоды
		//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
		//|		ПО (ГражданствоФизЛиц.Период = Периоды.ПериодВзаиморасчетов)
		//|			И (ГражданствоФизЛиц.ФизЛицо = Периоды.Физлицо)
		//|
		//|СГРУППИРОВАТЬ ПО
		//|	ГражданствоФизЛиц.ФизЛицо,
		//|	НАЧАЛОПЕРИОДА(Периоды.ПериодВзаиморасчетов, МЕСЯЦ)
		//|
		//|ИНДЕКСИРОВАТЬ ПО
		//|	Физлицо,
		//|	ПериодВзаиморасчетов
		//|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВТФСЗНДоходы.Сотрудник КАК Сотрудник,
		|	ВТФСЗНДоходы.ФизЛицо КАК ФизЛицо,
		|	ВТФСЗНДоходы.ПериодВзаиморасчетов КАК Месяц,
		|	ЕСТЬNULL(ВТФСЗНИсчисленный.Взносы, 0) КАК Взносы,
		|	ЕСТЬNULL(ВТФСЗНИсчисленный.ПроцентФСЗН, 35) КАК ТарифВзносов,
		|	ВТФСЗНДоходы.ФизЛицо.СтраховойНомерПФР КАК ЛичныйНомер,
		|	ФИОФизЛицСрезПоследних.Фамилия КАК Фамилия,
		|	ФИОФизЛицСрезПоследних.Имя КАК Имя,
		|	ФИОФизЛицСрезПоследних.Отчество КАК Отчество,
		|	АдресаРегистрации.Поле1 КАК ИндексРегистрации,
		|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9 КАК АдресРегистрации,
		|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия КАК ПаспортСерия,
		|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер КАК ПаспортНомер,
		|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи КАК ПаспортДатаВыдачи,
		|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументКемВыдан КАК ПаспортКемВыдан,
		|	ДомашниеТелефоны.Поле3 КАК Телефоны,
		|	ВЫБОР
		|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL 
		|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
		|			ТОГДА &СтранаПоУмолчанию
		|		ИНАЧЕ ГражданствоФизЛиц.Страна
		|	КОНЕЦ КАК Гражданство,
		|	ВТФСЗНДоходы.ФизЛицо.Пол КАК Пол,
		|	ВТФСЗНДоходы.ФизЛицо.ДатаРождения КАК ДатаРождения,
		|	ВТФСЗНДоходы.ФизЛицо.СтраховойНомерПФР КАК СтраховойНомерПФР,
		|	ВТФСЗНДоходы.ФизЛицо.МестоРождения КАК МестоРождения,
		|	ВТФСЗНДоходы.Категория,
		|	ЕСТЬNULL(ВТФСЗНДоходы.Выплаты, 0) КАК Выплаты,
		|	ЕСТЬNULL(ВТФСЗНПособия.Пособия, 0) КАК Пособия,
		|	ВТФСЗНДоходы.ДокументОснование КАК Договор,
		|	ЕСТЬNULL(ВТФСЗНДоходы.ВидРасчетаОклад, 1) КАК ВидРасчетаОклад,
		|	ГражданствоФизЛиц.НеИмеетПравоНаПенсию,
		|	ВТФСЗНПособия.ФизЛицо КАК ФизЛицо1
		|ИЗ
		|	ВТФСЗНДоходы КАК ВТФСЗНДоходы
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТФСЗНИсчисленный КАК ВТФСЗНИсчисленный
		|	ПО ВТФСЗНДоходы.Сотрудник = ВТФСЗНИсчисленный.Сотрудник
		|		И ВТФСЗНДоходы.ПериодВзаиморасчетов = ВТФСЗНИсчисленный.ПериодВзаиморасчетов
		|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&КонецГода, ) КАК ФИОФизЛицСрезПоследних
		|	ПО ВТФСЗНДоходы.ФизЛицо = ФИОФизЛицСрезПоследних.ФизЛицо
		|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаРегистрации
		|	ПО ВТФСЗНДоходы.Сотрудник = АдресаРегистрации.Объект
		|		И (АдресаРегистрации.Вид = &ВидАдресаРегистрации)
		|		И (АдресаРегистрации.Тип = &ТипАдрес)
		|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаФактические
		|	ПО ВТФСЗНДоходы.Сотрудник = АдресаФактические.Объект
		|		И (АдресаФактические.Тип = &ТипАдрес)
		|		И (АдресаФактические.Вид = &ВидАдресаФактический)
		|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК ДомашниеТелефоны
		|	ПО ВТФСЗНДоходы.Сотрудник = ДомашниеТелефоны.Объект
		|		И (ДомашниеТелефоны.Вид = &ВидТелефонаДомашний)
		|		И (ДомашниеТелефоны.Тип = &ТипТелефон)
		|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних КАК ПаспортныеДанныеФизЛицСрезПоследних
		|	ПО ВТФСЗНДоходы.ФизЛицо = ПаспортныеДанныеФизЛицСрезПоследних.ФизЛицо
		|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&ДатаПодачиСведений, ) КАК ГражданствоФизЛиц
		|	ПО ВТФСЗНДоходы.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
		|	ЛЕВОЕ СОЕДИНЕНИЕ ВТФСЗНПособия КАК ВТФСЗНПособия
		|	ПО ВТФСЗНДоходы.Сотрудник = ВТФСЗНПособия.Сотрудник
		|	И ВТФСЗНДоходы.ДокументОснование.ДатаОкончания = ВТФСЗНПособия.ДокументОснованиеДатаОкончания
		|ГДЕ
		|	ВТФСЗНДоходы.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов
		|	И ВТФСЗНДоходы.ДокументОснование <> &ПустойДоговор
		|	И (ЕСТЬNULL(ВТФСЗНДоходы.ВидРасчетаОклад, 1) = 1
		|			ИЛИ ЕСТЬNULL(ВТФСЗНДоходы.ДокументОснование, 1) <> 1)
		|
		|УПОРЯДОЧИТЬ ПО
		|	ВТФСЗНДоходы.Сотрудник.Наименование,
		|	Месяц
		|ИТОГИ
		|	СУММА(Выплаты)
		|ПО
		|	Сотрудник,
		|	Месяц";
		//О.Т. Аверсон 04.03.2016 № 940
		Если ОтборПоПериодуВзаиморасчетов Тогда 
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации <= &ДатаПодачиСведений","");
			
			//Аверсон ЕАЕ 20.01.2022 СВФР-008626
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНИсчисленный.Период <= &ДатаПодачиСведений","");
			//Аверсон СВФР-008626
			
		иначе
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации <= &ДатаПодачиСведений","И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации <= &ДатаПодачиСведений");
			
			//Аверсон ЕАЕ 20.01.2022 СВФР-008626
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНИсчисленный.Период <= &ДатаПодачиСведений","И ЕСНИсчисленный.Период <= &ДатаПодачиСведений");
			//Аверсон СВФР-008626
			
		КонецЕсли;
		//О.Т. Аверсон 04.03.2016 № 940
		Результат = Запрос.Выполнить();
		
	иначе
		
		если ДогПодряда или ВсеСотрудники Тогда 
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	ЕСНИсчисленный.Сотрудник КАК Сотрудник,
			|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
			|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			|	СУММА(ВЫБОР
			|			КОГДА ЕСНИсчисленный.ПроцентФСЗН = 0
			|				ТОГДА 1
			|			ИНАЧЕ ЕСНИсчисленный.ПроцентФСЗН
			|		КОНЕЦ) КАК ПроцентФСЗН,
			|	СУММА(ВЫБОР
			|		КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1)
			|				И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
			|			ТОГДА ВЫРАЗИТЬ((ЕСНИсчисленный.ПенсионныйФонд + ЕСНИсчисленный.ФСЗН) / 10000 КАК ЧИСЛО(15, 2))
			|		ИНАЧЕ ЕСНИсчисленный.ПенсионныйФонд + ЕСНИсчисленный.ФСЗН
			|	КОНЕЦ) КАК Взносы
			|ПОМЕСТИТЬ ВТФСЗНИсчисленный
			|ИЗ
			|	РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
			|ГДЕ
			|	ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			
			//Аверсон ЕАЕ 20.01.2022 СВФР-008626
			//|	И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
			|	//И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
			//Аверсон СВФР-008626
			
			|	И ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
			|	И (выбор когда &ПоВсемФизЛицам тогда ЕСНИсчисленный.Сотрудник в (&СписокСотрудников) иначе ЕСНИсчисленный.Сотрудник = &Сотрудник конец)
			|
			|СГРУППИРОВАТЬ ПО
			|	ЕСНИсчисленный.Сотрудник,
			|	ЕСНИсчисленный.ФизЛицо,
			|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник,
			|	ПериодВзаиморасчетов
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254			
			|ВЫБРАТЬ 
			|	РегЕСН.Организация,
			|	РегЕСН.Сотрудник,
			|	РегЕСН.ФизЛицо,
			|	РегЕСН.Период,
			|	ВЫБОР
			|		КОГДА РегЕСН.ВидРасчета В (&ВидРасчетаПремия) 
			|		ТОГДА РегЕСН.Период 
			|		ИНАЧЕ РегЕСН.ПериодВзаиморасчетов 
			|	КОНЕЦ КАК ПериодВзаиморасчетов,			
			|	РегЕСН.ПериодКонец,
			|	РегЕСН.КодДоходаЕСН,
			|	СУММА(РегЕСН.Результат) КАК Результат,
			|	СУММА(ВЫБОР
			|		КОГДА РегЕСН.КодДоходаЕСН = &ДоходБольничныйФСЗН или РегЕСН.ВидРасчета.СпособРасчета в (&СпособРасчета)
			|				И НЕ РегЕСН.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций
			|				И НЕ РегЕСН.ВидРасчета = &ОснНачисление_ОплатаБЛПоТравмеНаПроизводстве			
			|			ТОГДА ВЫБОР
			|					КОГДА РегЕСН.Период < ДАТАВРЕМЯ(2016, 7, 1)
			|							И РегЕСН.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА ВЫРАЗИТЬ(РегЕСН.Результат / 10000 КАК ЧИСЛО(15, 2))
			|					КОГДА РегЕСН.ПериодВзаиморасчетов < ДАТАВРЕМЯ(2016, 7, 1)
			|							И РегЕСН.Период >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА РегЕСН.Результат * 10000
			|					ИНАЧЕ РегЕСН.Результат
			|				КОНЕЦ
			|		ИНАЧЕ 0
			|	КОНЕЦ) КАК Пособия,
			|	СУММА (
			|	ВЫБОР
			|		КОГДА РегЕСН.КодДоходаЕСН = &ДоходБольничныйФСЗН или РегЕСН.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			|			ТОГДА 0 иначе ВЫБОР
			|					КОГДА РегЕСН.Период < ДАТАВРЕМЯ(2016, 7, 1)
			|							И РегЕСН.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
			|			ТОГДА ВЫРАЗИТЬ(РегЕСН.Результат / 10000 КАК ЧИСЛО(15, 2))
			|		иначе РегЕСН.результат
			|				КОНЕЦ конец)
			|		 КАК Выплаты
			|ПОМЕСТИТЬ ВТРегЕСН		 
			|ИЗ РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК РегЕСН
			|ГДЕ РегЕСН.Организация = &Организация
			|И РегЕСН.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			|И РегЕСН.Сотрудник В (&СписокСотрудников)
			|СГРУППИРОВАТЬ ПО
			|	РегЕСН.Организация,
			|	РегЕСН.Сотрудник,
			|	РегЕСН.ФизЛицо,
			|	РегЕСН.Период,
			|	ВЫБОР
			|		КОГДА РегЕСН.ВидРасчета В (&ВидРасчетаПремия) 
			|		ТОГДА РегЕСН.Период 
			|		ИНАЧЕ РегЕСН.ПериодВзаиморасчетов 
			|	КОНЕЦ,
			|	РегЕСН.ПериодКонец,
			|	РегЕСН.КодДоходаЕСН,
			|	РегЕСН.ВидРасчета
			|;
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ РАЗРЕШЕННЫЕ
			|	РегЕСН.Организация,
			|	РегЕСН.Сотрудник,
			|	РегЕСН.ФизЛицо,
			|	РегЕСН.Период,
			|	РегЕСН.ПериодВзаиморасчетов,
			|	РегЕСН.ПериодКонец,
			|	СУММА(РегЕСН.Результат) КАК Результат,
			|	СУММА(РегЕСН.Пособия) КАК Пособия,
			|	СУММА (РегЕСН.ВЫплаты) КАК Выплаты
			|ПОМЕСТИТЬ ВТРегЕСНСгруппированная
			|ИЗ ВТРегЕСН КАК РегЕСН
			|СГРУППИРОВАТЬ ПО
			|	РегЕСН.Организация,
			|	РегЕСН.Сотрудник,
			|	РегЕСН.ФизЛицо,
			|	РегЕСН.Период,
			|	РегЕСН.ПериодВзаиморасчетов,
			|	РегЕСН.ПериодКонец
			|;
			|///////////////////////////////////////////////////////////////////////////////
			//Аверсон СВФР-008254
			
			|ВЫБРАТЬ
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			//|	СУММА(ВЫБОР
			//|		КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
			//|				И НЕ ЕСНСведенияОДоходах.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций
			//|				И НЕ ЕСНСведенияОДоходах.ВидРасчета = &ОснНачисление_ОплатаБЛПоТравмеНаПроизводстве  // ПСА 08.07.2019 СВФР-004373			
			//|			ТОГДА ВЫБОР
			//|					КОГДА ЕСНСведенияОДоходах.Период < ДАТАВРЕМЯ(2016, 7, 1)
			//|							И ЕСНСведенияОДоходах.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
			//|						ТОГДА ВЫРАЗИТЬ(ЕСНСведенияОДоходах.Результат / 10000 КАК ЧИСЛО(15, 2))
			//|					КОГДА ЕСНСведенияОДоходах.ПериодВзаиморасчетов < ДАТАВРЕМЯ(2016, 7, 1) //О.Т. Аверсон 01.02.2017 № 234
			//|							И ЕСНСведенияОДоходах.Период >= ДАТАВРЕМЯ(2016, 7, 1)
			//|						ТОГДА ЕСНСведенияОДоходах.Результат * 10000
			//|					ИНАЧЕ ЕСНСведенияОДоходах.Результат
			//|				КОНЕЦ
			//|		ИНАЧЕ 0
			//|	КОНЕЦ) КАК Пособия,
			|	СУММА(ЕСНСведенияОДоходах.Пособия) КАК Пособия,
			
			//|	СУММА (ВЫБОР
			//|		КОГДА ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = &ДоходБольничныйФСЗН или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			//|			ТОГДА 0 иначе ВЫБОР
			//|					КОГДА ЕСНСведенияОДоходах.Период < ДАТАВРЕМЯ(2016, 7, 1)
			//|							И ЕСНСведенияОДоходах.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
			//
			////Аверсон ЕАЕ 01.04.2021 СВФР-006959
			//		//ТОГДА ВЫРАЗИТЬ(ЕСНСведенияОДоходах.Результат / 10000 КАК ЧИСЛО(15, 2))
			//|			ТОГДА ВЫРАЗИТЬ(вложенныйзапрос.Результат / 10000 КАК ЧИСЛО(15, 2))
			//		//ИНАЧЕ ЕСНСведенияОДоходах.Результат
			//|		иначе вложенныйзапрос.результат
			////Аверсон СВФР-006959
			//
			//|				КОНЕЦ конец
			//|		) КАК Выплаты,
			|	СУММА(ЕСНСведенияОДоходах.Выплаты) КАК Выплаты,
			//Аверсон СВФР-008254
			
			|	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|	ЕСНСведенияОДоходах.Сотрудник КАК Сотрудник,
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			//|	ВЫБОР
			//|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
			//|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
			//|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
			//|	КОНЕЦ КАК ПериодВзаиморасчетов,
			|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			//Аверсон СВФР-008254
			
			//|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			|	ВЫБОР
			|		КОГДА ВложенныйЗапрос.Флаг
			|			ТОГДА &ДоговораПодряда
			|		ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
			|	КОНЕЦ КАК Категория,
			|	ВложенныйЗапрос.Регистратор КАК ДокументОснование,
			|	СведДоходыОклад.ВидРасчета КАК ВидРасчетаОклад
			|ПОМЕСТИТЬ ВТФСЗНДоходы
			|ИЗ
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			//|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			| ВТРегЕСНСгруппированная КАК ЕСНСведенияОДоходах
			//Аверсон СВФР-008254
			
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка КАК Регистратор,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка = &ПустойДоговор
			|					ТОГДА ЛОЖЬ
			|				ИНАЧЕ ИСТИНА
			|			КОНЕЦ КАК Флаг,
			
			//Аверсон ЕАЕ 01.04.2021 СВФР-006959
			|допначисления.периодрегистрации,
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			//|допначисления.результат,
			|СУММА(допначисления.результат) КАК Результат,
			//Аверсон СВФР-008254
			
			|допначисления.базовыйпериодначало,
			|допначисления.базовыйпериодконец
			//Аверсон СВФР-006959
			
			|		ИЗ
			|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
			
			//Аверсон ЕАЕ 01.04.2021 СВФР-006959
			|левое соединение регистррасчета.дополнительныеначисленияработниковорганизаций как допначисления
			|по (допначисления.документоснование = ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.регистратор
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			|или (допначисления.Регистратор ссылка Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда И допначисления.Сотрудник = ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник
			//|И (допначисления.базовыйпериодначало МЕЖДУ ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.ДатаНачала И КОНЕЦПЕРИОДА(ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.ДатаОкончания, ДЕНЬ)) 
			//|И (допначисления.базовыйпериодконец МЕЖДУ ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.ДатаНачала И КОНЕЦПЕРИОДА(ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.ДатаОкончания, ДЕНЬ))))
			//Аверсон СВФР-008254
			
			//Аверсон ЕАЕ 26.01.2023 СВФР-010135 окончание бл может быть после окончания договора
			|И ((допначисления.базовыйпериодначало МЕЖДУ ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.ДатаНачала И КОНЕЦПЕРИОДА(ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.ДатаОкончания, ДЕНЬ)) 
			|ИЛИ (допначисления.базовыйпериодконец МЕЖДУ ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.ДатаНачала И КОНЕЦПЕРИОДА(ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.ДатаОкончания, ДЕНЬ)))))
			//Аверсон СВФР-010135
			
			//Аверсон ЕАЕ 19.01.2023 СВФР-010135
			//|И допначисления.периодрегистрации Между &ДатаКалендаря и &ДатаКалендаря1
			|И ВЫБОР 
			|КОГДА &ПоПериодуВзаиморасчетов 
			|ТОГДА допначисления.базовыйпериодначало Между &ДатаКалендаря и &ДатаКалендаря1 
			|ИНАЧЕ допначисления.периодрегистрации Между &ДатаКалендаря и &ДатаКалендаря1
			|КОНЕЦ  
			//СВФР-010135
			
			|и допначисления.результат <> 0
			//Аверсон СВФР-006959
			
			|		ГДЕ
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом
			|			И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Организация = &СписокОтчитывающихсяПодразделений
			|И ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник В (&СписокСотрудников) //СВЭЙ 26.01.2024 КВВ СВФР-012080 (формировало очень долго по одному сотруднику)
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			|		СГРУППИРОВАТЬ ПО
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник,
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник.Физлицо,
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка = &ПустойДоговор
			|					ТОГДА ЛОЖЬ
			|				ИНАЧЕ ИСТИНА
			|			КОНЕЦ,
			|			допначисления.периодрегистрации,
			|			допначисления.базовыйпериодначало,
			|			допначисления.базовыйпериодконец
			//Аверсон СВФР-008254
			
			|) КАК ВложенныйЗапрос
			|		ПО ЕСНСведенияОДоходах.Сотрудник = ВложенныйЗапрос.Сотрудник
			
			//Аверсон ЕАЕ 01.04.2021 СВФР-006959
			//((ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ НАЧАЛОПЕРИОДА(ВложенныйЗапрос.Регистратор.ДатаНачала, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВложенныйЗапрос.Регистратор.ДатаОкончания, МЕСЯЦ))
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			//|И (ЕСНСведенияОДоходах.ПериодВзаиморасчетов = ВложенныйЗапрос.базовыйпериодначало и ЕСНСведенияОДоходах.ПериодКонец = ВложенныйЗапрос.базовыйпериодконец)
			|И (ЕСНСведенияОДоходах.ПериодВзаиморасчетов = ВложенныйЗапрос.базовыйпериодначало и НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодКонец, ДЕНЬ) = НАЧАЛОПЕРИОДА(ВложенныйЗапрос.базовыйпериодконец, ДЕНЬ))
			//Аверсон СВФР-008254
			
			//Аверсон ЕАЕ 25.01.2023 СВФР-010135
			|И НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) = НАЧАЛОПЕРИОДА(ВложенныйЗапрос.ПериодРегистрации, МЕСЯЦ)
			//Аверсон СВФР-010135
			
			//Аверсон СВФР-006959
			
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	СведенияОДоходах1.Сотрудник КАК Сотрудник,
			|	СведенияОДоходах1.ФизЛицо КАК ФизЛицо,
			|	СведенияОДоходах1.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
			|	СведенияОДоходах1.ВидРасчета КАК ВидРасчета
			|ИЗ
			|	(ВЫБРАТЬ
			|			ЕСНСведенияОДоходах.Сотрудник КАК Сотрудник,
			|			ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|			ВЫБОР
			|				КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
			|					ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
			|					ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
			|			КОНЕЦ КАК ПериодВзаиморасчетов, 
			//|			НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			|			""Оклад"" КАК ВидРасчета //О.Т. 30.09.2015 № 616
			|		ИЗ
			|			РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			|		ГДЕ
			|			ЕСНСведенияОДоходах.ВидРасчета В(&ВидРасчета) //О.Т. Аверсон 24.04.2019 № 4274
			|			И ВЫБОР
			|				КОГДА &ПоВсемФизЛицам
			|					ТОГДА ЕСНСведенияОДоходах.Сотрудник В (&СписокСотрудников)
			|					ИНАЧЕ ЕСНСведенияОДоходах.Сотрудник = &Сотрудник
			|			КОНЕЦ
			|			И ВЫБОР
			|				КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия)
			|					ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоГода И &КонецГода
			|					ИНАЧЕ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			|			КОНЕЦ
			// + СВЭЙ КДЯ 22.07.19 СВФР-004561
			|			И ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
			// - СВЭЙ КДЯ 22.07.19 СВФР-004561
			//О.Т. Аверсон 24.04.2019 № 4274
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ЕСНСведенияОДоходах.Сотрудник, 
			|			ЕСНСведенияОДоходах.ФизЛицо,
			|			ВЫБОР
			|				КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
			|					ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
			|					ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
			|			КОНЕЦ,
			
			//|			НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
			|			""Оклад"" ) КАК СведенияОДоходах1
			
			|СГРУППИРОВАТЬ ПО
			|	СведенияОДоходах1.Сотрудник,
			|	СведенияОДоходах1.ФизЛицо,
			|	СведенияОДоходах1.ПериодВзаиморасчетов,
			|	СведенияОДоходах1.ВидРасчета) КАК СведДоходыОклад //О.Т. 30.09.2015 № 616
			|		ПО ЕСНСведенияОДоходах.Сотрудник = СведДоходыОклад.Сотрудник
			|			И (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = НАЧАЛОПЕРИОДА(СведДоходыОклад.ПериодВзаиморасчетов, МЕСЯЦ))
			|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	ВложенныйЗапрос.ПериодКал,
			|	ВложенныйЗапрос.Период,
			|	ВложенныйЗапрос.Сотрудник,
			|	РаботникиОрганизаций.ПодразделениеОрганизации
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодКал,
			|			МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период,
			|			РаботникиОрганизаций.Сотрудник КАК Сотрудник
			|		ИЗ
			|			РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|				ПО РегламентированныйПроизводственныйКалендарь.ДатаКалендаря >= РаботникиОрганизаций.Период
			|		ГДЕ
			|			РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &ДатаКалендаря И &ДатаКалендаря1
			|		
			|		СГРУППИРОВАТЬ ПО
			|			РаботникиОрганизаций.Сотрудник,
			|			НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ)) КАК ВложенныйЗапрос
			|		ПО РаботникиОрганизаций.Период = ВложенныйЗапрос.Период
			|			И РаботникиОрганизаций.Сотрудник = ВложенныйЗапрос.Сотрудник) КАК РаботникиПодразделение
			|		ПО (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) = РаботникиПодразделение.ПериодКал)
			|			И ЕСНСведенияОДоходах.Сотрудник = РаботникиПодразделение.Сотрудник
			|ГДЕ
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			//|	ВЫБОР
			//|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
			//|		ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоГода И &КонецГода
			//|		ИНАЧЕ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			//|	КОНЕЦ
			|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			//Аверсон СВФР-008254
			
			|	//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений
			|	И (ВЫБОР
			|		КОГДА &ПоВсемФизЛицам
			|			ТОГДА ЕСНСведенияОДоходах.Сотрудник В (&СписокСотрудников)
			|			ИНАЧЕ ЕСНСведенияОДоходах.Сотрудник = &Сотрудник
			|		КОНЕЦ)
			|   И ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				Запрос.Текст = Запрос.Текст + " И 
				
				//СВЭЙ 17.04.2024 КВВ СВФР-012815 (
				|(ВЫБОР КОГДА ЕСНСведенияОДоходах.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство) 
				|ТОГДА ИСТИНА
				|ИНАЧЕ
				//СВЭЙ 17.04.2024 КВВ СВФР-012815 )
				
				|ЕСТЬNULL(ВложенныйЗапрос.Регистратор.ПодразделениеОрганизации, РаботникиПодразделение.ПодразделениеОрганизации) В ИЕРАРХИИ (&ПодразделениеОрганизации) 
				|КОНЕЦ)
				|";
			КонецЕсли;
			Запрос.Текст = Запрос.Текст +"
			
			|
			|СГРУППИРОВАТЬ ПО
			|	ЕСНСведенияОДоходах.Сотрудник,
			|	ЕСНСведенияОДоходах.ФизЛицо,
			
			//Аверсон ЕАЕ 19.10.2021 СВФР-008254
			//|	ВЫБОР
			//|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
			//|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
			//|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
			//|	КОНЕЦ,
			|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
			//Аверсон СВФР-008254
			
			//|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
			|	ВЫБОР
			|		КОГДА ВложенныйЗапрос.Флаг
			|			ТОГДА &ДоговораПодряда
			|		ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
			|	КОНЕЦ,
			|	ВложенныйЗапрос.Регистратор,
			|	СведДоходыОклад.ВидРасчета
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник,
			|	ПериодВзаиморасчетов
			|;
			|
			//|////////////////////////////////////////////////////////////////////////////////
			//|ВЫБРАТЬ
			//|	НАЧАЛОПЕРИОДА(Периоды.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			//|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо
			//|ПОМЕСТИТЬ ВТДанныеОПравеНаПенсию
			//|ИЗ
			//|	(ВЫБРАТЬ
			//|		Периоды.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
			//|		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
			//|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
			//|	ИЗ
			//|		ВТФСЗНДоходы КАК Периоды
			//|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
			//|			ПО Периоды.ПериодВзаиморасчетов >= ГражданствоФизЛиц.Период
			//|	
			//|	СГРУППИРОВАТЬ ПО
			//|		ГражданствоФизЛиц.ФизЛицо,
			//|		Периоды.ПериодВзаиморасчетов) КАК Периоды
			//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
			//|		ПО (ГражданствоФизЛиц.Период = Периоды.ПериодВзаиморасчетов)
			//|			И (ГражданствоФизЛиц.ФизЛицо = Периоды.Физлицо)
			//|
			//|СГРУППИРОВАТЬ ПО
			//|	ГражданствоФизЛиц.ФизЛицо,
			//|	НАЧАЛОПЕРИОДА(Периоды.ПериодВзаиморасчетов, МЕСЯЦ)
			//|
			//|ИНДЕКСИРОВАТЬ ПО
			//|	Физлицо,
			//|	ПериодВзаиморасчетов
			//|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ВТФСЗНДоходы.Сотрудник КАК Сотрудник,
			|	ВТФСЗНДоходы.ФизЛицо КАК ФизЛицо,
			|	ВТФСЗНДоходы.ПериодВзаиморасчетов КАК Месяц,
			|	ЕСТЬNULL(ВТФСЗНИсчисленный.Взносы, 0) КАК Взносы,
			|	ЕСТЬNULL(ВТФСЗНИсчисленный.ПроцентФСЗН, 35) КАК ТарифВзносов,
			|	ВТФСЗНДоходы.ФизЛицо.СтраховойНомерПФР КАК ЛичныйНомер,
			|	ФИОФизЛицСрезПоследних.Фамилия КАК Фамилия,
			|	ФИОФизЛицСрезПоследних.Имя КАК Имя,
			|	ФИОФизЛицСрезПоследних.Отчество КАК Отчество,
			|	АдресаРегистрации.Поле1 КАК ИндексРегистрации,
			|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9 КАК АдресРегистрации,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия КАК ПаспортСерия,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер КАК ПаспортНомер,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи КАК ПаспортДатаВыдачи,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументКемВыдан КАК ПаспортКемВыдан,
			|	ДомашниеТелефоны.Поле3 КАК Телефоны,
			|	ВЫБОР
			|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL 
			|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
			|			ТОГДА &СтранаПоУмолчанию
			|		ИНАЧЕ ГражданствоФизЛиц.Страна
			|	КОНЕЦ КАК Гражданство,
			|	ВТФСЗНДоходы.ФизЛицо.Пол КАК Пол,
			|	ВТФСЗНДоходы.ФизЛицо.ДатаРождения КАК ДатаРождения,
			|	ВТФСЗНДоходы.ФизЛицо.СтраховойНомерПФР КАК СтраховойНомерПФР,
			|	ВТФСЗНДоходы.ФизЛицо.МестоРождения КАК МестоРождения,
			|	ВТФСЗНДоходы.Категория,
			|	ЕСТЬNULL(ВТФСЗНДоходы.Выплаты, 0) КАК Выплаты,
			|	ЕСТЬNULL(ВТФСЗНДоходы.Пособия, 0) КАК Пособия,
			|	ВТФСЗНДоходы.ДокументОснование КАК Договор,
			|	ЕСТЬNULL(ВТФСЗНДоходы.ВидРасчетаОклад, 1) КАК ВидРасчетаОклад,
			|	ГражданствоФизЛиц.НеИмеетПравоНаПенсию
			|ИЗ
			|	ВТФСЗНДоходы КАК ВТФСЗНДоходы
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТФСЗНИсчисленный КАК ВТФСЗНИсчисленный
			|		ПО ВТФСЗНДоходы.Сотрудник = ВТФСЗНИсчисленный.Сотрудник
			|			И ВТФСЗНДоходы.ПериодВзаиморасчетов = ВТФСЗНИсчисленный.ПериодВзаиморасчетов
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&КонецГода, ) КАК ФИОФизЛицСрезПоследних
			|		ПО ВТФСЗНДоходы.ФизЛицо = ФИОФизЛицСрезПоследних.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаРегистрации
			|		ПО ВТФСЗНДоходы.ФизЛицо = АдресаРегистрации.Объект
			|			И (АдресаРегистрации.Вид = &ВидАдресаРегистрации)
			|			И (АдресаРегистрации.Тип = &ТипАдрес)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаФактические
			|		ПО ВТФСЗНДоходы.ФизЛицо = АдресаФактические.Объект
			|			И (АдресаФактические.Тип = &ТипАдрес)
			|			И (АдресаФактические.Вид = &ВидАдресаФактический)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК ДомашниеТелефоны
			|		ПО ВТФСЗНДоходы.ФизЛицо = ДомашниеТелефоны.Объект
			|			И (ДомашниеТелефоны.Вид = &ВидТелефонаДомашний)
			|			И (ДомашниеТелефоны.Тип = &ТипТелефон)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних КАК ПаспортныеДанныеФизЛицСрезПоследних
			|		ПО ВТФСЗНДоходы.ФизЛицо = ПаспортныеДанныеФизЛицСрезПоследних.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&ДатаПодачиСведений, ) КАК ГражданствоФизЛиц
			|		ПО ВТФСЗНДоходы.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
			|ГДЕ
			|	ВТФСЗНДоходы.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов
			|	И ВТФСЗНДоходы.ДокументОснование <> &ПустойДоговор
			|	И (ЕСТЬNULL(ВТФСЗНДоходы.ВидРасчетаОклад, 1) = 1 ИЛИ ЕСТЬNULL(ВТФСЗНДоходы.ДокументОснование, 1) <> 1)
			|
			|УПОРЯДОЧИТЬ ПО
			|	ВТФСЗНДоходы.Сотрудник.Наименование,
			|	Месяц
			|ИТОГИ
			|	СУММА(Выплаты)
			|ПО
			|	Сотрудник,
			|	Месяц";
			//О.Т. Аверсон 04.03.2016 № 940
			Если ОтборПоПериодуВзаиморасчетов Тогда 
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений","");
			иначе
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений","И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений");
			КонецЕсли;
			//О.Т. Аверсон 04.03.2016 № 940
			Результат = Запрос.Выполнить();
		КонецЕсли;
		
		Если Основные или ВсеСотрудники Тогда 
			Запрос.Текст = 
			"ВЫБРАТЬ
			|	ЕСНИсчисленный.Сотрудник КАК Сотрудник,
			|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
			|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			|	СУММА(ВЫБОР
			|			КОГДА ЕСНИсчисленный.ПроцентФСЗН = 0
			|				ТОГДА 1
			|			ИНАЧЕ ЕСНИсчисленный.ПроцентФСЗН
			|		КОНЕЦ) КАК ПроцентФСЗН,
			|	СУММА(ВЫБОР
			|		КОГДА ЕСНИсчисленный.Период < ДАТАВРЕМЯ(2016, 7, 1)
			|				И ЕСНИсчисленный.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
			|			ТОГДА ВЫРАЗИТЬ((ЕСНИсчисленный.ПенсионныйФонд + ЕСНИсчисленный.ФСЗН) / 10000 КАК ЧИСЛО(15, 2))
			|		ИНАЧЕ ЕСНИсчисленный.ПенсионныйФонд + ЕСНИсчисленный.ФСЗН
			|	КОНЕЦ) КАК Взносы
			|ПОМЕСТИТЬ ВТФСЗНИсчисленный1
			|ИЗ
			|	РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
			|ГДЕ
			|	ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			
			//Аверсон ЕАЕ 20.01.2022 СВФР-008626
			//|	И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
			|	//И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
			//Аверсон СВФР-008626
			
			|	И ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
			|	И (ВЫБОР
			|	КОГДА &ПоВсемФизЛицам
			|		ТОГДА ЕСНИсчисленный.Сотрудник В (&СписокСотрудников)
			|	ИНАЧЕ
			|		ЕСНИсчисленный.Сотрудник = &Сотрудник КОНЕЦ)
			|
			|СГРУППИРОВАТЬ ПО
			|	ЕСНИсчисленный.Сотрудник, 
			|	ЕСНИсчисленный.ФизЛицо,
			|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник,
			|	ПериодВзаиморасчетов
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	СУММА(ВЫБОР
			|		КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
			|				И НЕ ЕСНСведенияОДоходах.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций
			|				И НЕ ЕСНСведенияОДоходах.ВидРасчета = &ОснНачисление_ОплатаБЛПоТравмеНаПроизводстве  // ПСА 08.07.2019 СВФР-004373			
			|			ТОГДА ВЫБОР
			|					КОГДА ЕСНСведенияОДоходах.Период < ДАТАВРЕМЯ(2016, 7, 1)
			|							И ЕСНСведенияОДоходах.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА ВЫРАЗИТЬ(ЕСНСведенияОДоходах.Результат / 10000 КАК ЧИСЛО(15, 2))
			|					КОГДА ЕСНСведенияОДоходах.ПериодВзаиморасчетов < ДАТАВРЕМЯ(2016, 7, 1) //О.Т. Аверсон 01.02.2017 № 234
			|							И ЕСНСведенияОДоходах.Период >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА ЕСНСведенияОДоходах.Результат * 10000
			|					ИНАЧЕ ЕСНСведенияОДоходах.Результат
			|				КОНЕЦ
			|		ИНАЧЕ 0
			|	КОНЕЦ) КАК Пособия,
			|	СУММА(ВЫБОР
			|		КОГДА ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН = &ДоходБольничныйФСЗН или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			|		
			|			ТОГДА 0 иначе ВЫБОР
			|					КОГДА ЕСНСведенияОДоходах.Период < ДАТАВРЕМЯ(2016, 7, 1)
			|							И ЕСНСведенияОДоходах.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА ВЫРАЗИТЬ(ЕСНСведенияОДоходах.Результат / 10000 КАК ЧИСЛО(15, 2))
			|					ИНАЧЕ ЕСНСведенияОДоходах.Результат
			|				КОНЕЦ конец
			|		) КАК Выплаты,
			|	ЕСНСведенияОДоходах.Сотрудник КАК Сотрудник,
			|	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|	ЕСТЬNULL(ВложенныйЗапрос.Регистратор.ПодразделениеОрганизации, РаботникиПодразделение.ПодразделениеОрганизации) как  Подразделение,
			|	ВЫБОР
			
			//Аверсон ЕАЕ 27.10.2022 СВФР-009696
			//|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
			|		КОГДА НЕ &ПоПериодуВзаиморасчетов
			//Аверсон СВФР-009696
			
			|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
			|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
			|	КОНЕЦ КАК ПериодВзаиморасчетов,
			
			//|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			|	ВЫБОР
			|		КОГДА ВложенныйЗапрос.Флаг
			|			ТОГДА &ДоговораПодряда
			|		ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
			|	КОНЕЦ КАК Категория,
			|	ВложенныйЗапрос.Регистратор КАК ДокументОснование,
			|	ВЫБОР
			|		КОГДА ЕСТЬNULL(СведДоходыОклад.ВидРасчета, 1) = 1
			|			ТОГДА 1
			|		ИНАЧЕ 2
			|	КОНЕЦ КАК ВидРасчетаОклад
			|ПОМЕСТИТЬ ВТФСЗНДоходы1
			|ИЗ
			|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка КАК Регистратор,
			|			ВЫБОР
			|				КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка = &ПустойДоговор
			|					ТОГДА ЛОЖЬ
			|				ИНАЧЕ ИСТИНА
			|			КОНЕЦ КАК Флаг
			|		ИЗ
			|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
			|		ГДЕ
			|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом) КАК ВложенныйЗапрос
			|		ПО ЕСНСведенияОДоходах.Сотрудник = ВложенныйЗапрос.Сотрудник
			|			И (ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ НАЧАЛОПЕРИОДА(ВложенныйЗапрос.Регистратор.ДатаНачала, МЕСЯЦ) И КОНЕЦПЕРИОДА(ВложенныйЗапрос.Регистратор.ДатаОкончания, МЕСЯЦ))
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	СведенияОДоходах1.ФизЛицо КАК Сотрудник,
			|	СведенияОДоходах1.ФизЛицо КАК ФизЛицо,
			|	СведенияОДоходах1.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
			|	СведенияОДоходах1.ВидРасчета КАК ВидРасчета
			|ИЗ
			|	(ВЫБРАТЬ
			|			ЕСНСведенияОДоходах.Сотрудник КАК Сотрудник,
			|			ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|			ВЫБОР
			
			//Аверсон ЕАЕ 27.10.2022 СВФР-009696
			//|				КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
			|               КОГДА НЕ &ПоПериодуВзаиморасчетов 
			//Аверсон СВФР-009696
			
			|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
			|				ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
			|			КОНЕЦ КАК ПериодВзаиморасчетов,
			//|			НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,//О.Т. Аверсон 02.02.2016 № (Началопериода. Меняется оклад в середине месяца.Цифра задваивается)
			|			""Оклад"" КАК ВидРасчета //О.Т. 30.09.2015 № 616
			|		ИЗ
			|			РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			|		ГДЕ
			|			ЕСНСведенияОДоходах.ВидРасчета В(&ВидРасчета)
			//О.Т. Аверсон 24.04.2019 № 4274
			|			И ВЫБОР
			|				КОГДА &ПоВсемФизЛицам
			|					ТОГДА ЕСНСведенияОДоходах.Сотрудник В (&СписокСотрудников)
			|					ИНАЧЕ ЕСНСведенияОДоходах.Сотрудник = &Сотрудник
			|			КОНЕЦ
			|			И ВЫБОР
			
			//Аверсон ЕАЕ 27.10.2022 СВФР-009696
			//|				КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия)
			|				КОГДА НЕ &ПоПериодуВзаиморасчетов
			//Аверсон СВФР-009696
			
			|					ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоГода И &КонецГода
			|					ИНАЧЕ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			|			КОНЕЦ
			// + СВЭЙ КДЯ 22.07.19 СВФР-004561
			|			И ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
			// - СВЭЙ КДЯ 22.07.19 СВФР-004561
			//О.Т. Аверсон 24.04.2019 № 4274
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ЕСНСведенияОДоходах.Сотрудник,
			|			ЕСНСведенияОДоходах.ФизЛицо,
			|	ВЫБОР
			
			//Аверсон ЕАЕ 27.10.2022 СВФР-009696
			//|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
			|	    КОГДА НЕ &ПоПериодуВзаиморасчетов 
			//Аверсон СВФР-009696
			
			|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
			|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
			|	КОНЕЦ,
			//|			НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
			|			""Оклад"") КАК СведенияОДоходах1
			
			|СГРУППИРОВАТЬ ПО
			|	СведенияОДоходах1.Сотрудник,
			|	СведенияОДоходах1.ФизЛицо,
			|	СведенияОДоходах1.ПериодВзаиморасчетов,
			|	СведенияОДоходах1.ВидРасчета) КАК СведДоходыОклад //О.Т. 30.09.2015 № 616
			|		ПО ЕСНСведенияОДоходах.Сотрудник = СведДоходыОклад.Сотрудник
			|			И (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = НАЧАЛОПЕРИОДА(СведДоходыОклад.ПериодВзаиморасчетов, МЕСЯЦ))
			
			|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|	ВложенныйЗапрос.ПериодКал,
			|	ВложенныйЗапрос.Период,
			|	ВложенныйЗапрос.Сотрудник,
			|	РаботникиОрганизаций.ПодразделениеОрганизации
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодКал,
			|			МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период,
			|			РаботникиОрганизаций.Сотрудник КАК Сотрудник
			|		ИЗ
			|			РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
			|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|				ПО РегламентированныйПроизводственныйКалендарь.ДатаКалендаря >= РаботникиОрганизаций.Период
			|		ГДЕ
			|			РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &ДатаКалендаря И &ДатаКалендаря1
			|		
			|		СГРУППИРОВАТЬ ПО
			|			РаботникиОрганизаций.Сотрудник,
			|			НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ)) КАК ВложенныйЗапрос
			|		ПО РаботникиОрганизаций.Период = ВложенныйЗапрос.Период
			|			И РаботникиОрганизаций.Сотрудник = ВложенныйЗапрос.Сотрудник) КАК РаботникиПодразделение
			|		ПО (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = РаботникиПодразделение.ПериодКал)
			|			И ЕСНСведенияОДоходах.Сотрудник = РаботникиПодразделение.Сотрудник
			
			|ГДЕ
			|	ВЫБОР
			
			//Аверсон ЕАЕ 27.10.2022 СВФР-009696
			//|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч 
			|		КОГДА НЕ &ПоПериодуВзаиморасчетов 
			//Аверсон СВФР-009696
			
			|		ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоГода И &КонецГода
			|		ИНАЧЕ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			|	КОНЕЦ
			
			//|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			|	//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений
			|	И (ВЫБОР
			|	КОГДА &ПоВсемФизЛицам
			|		ТОГДА ЕСНСведенияОДоходах.Сотрудник В (&СписокСотрудников)
			|	ИНАЧЕ
			|		ЕСНСведенияОДоходах.Сотрудник = &Сотрудник КОНЕЦ)
			|   И ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				Запрос.Текст = Запрос.Текст + " И 
				
				//СВЭЙ 17.04.2024 КВВ СВФР-012815 (
				|(ВЫБОР КОГДА ЕСНСведенияОДоходах.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство) 
				|ТОГДА ИСТИНА
				|ИНАЧЕ
				//СВЭЙ 17.04.2024 КВВ СВФР-012815 )
				
				|ЕСТЬNULL(ВложенныйЗапрос.Регистратор.ПодразделениеОрганизации, РаботникиПодразделение.ПодразделениеОрганизации) В ИЕРАРХИИ (&ПодразделениеОрганизации) 
				|КОНЕЦ)
				|";

			КонецЕсли;
			Запрос.Текст = Запрос.Текст +"
			
			|
			|СГРУППИРОВАТЬ ПО
			|	ЕСНСведенияОДоходах.Сотрудник,
			|	ЕСНСведенияОДоходах.ФизЛицо,
			|	ЕСТЬNULL(ВложенныйЗапрос.Регистратор.ПодразделениеОрганизации, РаботникиПодразделение.ПодразделениеОрганизации),
			|	ВЫБОР
			
			//Аверсон ЕАЕ 27.10.2022 СВФР-009696
			//|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч 
			|		КОГДА НЕ &ПоПериодуВзаиморасчетов 
			//Аверсон СВФР-009696
			
			|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
			|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
			|	КОНЕЦ,        
			//|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
			|	ВЫБОР
			|		КОГДА ВложенныйЗапрос.Флаг
			|			ТОГДА &ДоговораПодряда
			|		ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
			|	КОНЕЦ,
			|	ВложенныйЗапрос.Регистратор,
			|	ВЫБОР
			|		КОГДА ЕСТЬNULL(СведДоходыОклад.ВидРасчета, 1) = 1
			|			ТОГДА 1
			|		ИНАЧЕ 2
			|	КОНЕЦ
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Сотрудник,
			|	ПериодВзаиморасчетов
			|;
			|
			//|////////////////////////////////////////////////////////////////////////////////
			//|ВЫБРАТЬ
			//|	НАЧАЛОПЕРИОДА(Периоды.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			//|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо
			//|ПОМЕСТИТЬ ВТДанныеОПравеНаПенсию1
			//|ИЗ
			//|	(ВЫБРАТЬ
			//|		Периоды.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
			//|		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
			//|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
			//|	ИЗ
			//|		ВТФСЗНДоходы1 КАК Периоды
			//|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
			//|			ПО Периоды.ПериодВзаиморасчетов >= ГражданствоФизЛиц.Период
			//|	
			//|	СГРУППИРОВАТЬ ПО
			//|		ГражданствоФизЛиц.ФизЛицо,
			//|		Периоды.ПериодВзаиморасчетов) КАК Периоды
			//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
			//|		ПО (ГражданствоФизЛиц.Период = Периоды.ПериодВзаиморасчетов)
			//|			И (ГражданствоФизЛиц.ФизЛицо = Периоды.Физлицо)
			//|
			//|СГРУППИРОВАТЬ ПО
			//|	ГражданствоФизЛиц.ФизЛицо,
			//|	НАЧАЛОПЕРИОДА(Периоды.ПериодВзаиморасчетов, МЕСЯЦ)
			//|
			//|ИНДЕКСИРОВАТЬ ПО
			//|	Физлицо,
			//|	ПериодВзаиморасчетов
			//|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ВТФСЗНДоходы1.Сотрудник КАК Сотрудник,
			|	ВТФСЗНДоходы1.ФизЛицо КАК ФизЛицо,
			|	ВТФСЗНДоходы1.Подразделение,
			|	ВТФСЗНДоходы1.ПериодВзаиморасчетов КАК Месяц,
			|	ЕСТЬNULL(ВТФСЗНИсчисленный1.Взносы, 0) КАК Взносы,
			|	ЕСТЬNULL(ВТФСЗНИсчисленный1.ПроцентФСЗН, 35) КАК ТарифВзносов,
			|	ВТФСЗНДоходы1.ФизЛицо.СтраховойНомерПФР КАК ЛичныйНомер,
			|	ФИОФизЛицСрезПоследних.Фамилия КАК Фамилия,
			|	ФИОФизЛицСрезПоследних.Имя КАК Имя,
			|	ФИОФизЛицСрезПоследних.Отчество КАК Отчество,
			|	АдресаРегистрации.Поле1 КАК ИндексРегистрации,
			|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9 КАК АдресРегистрации,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия КАК ПаспортСерия,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер КАК ПаспортНомер,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи КАК ПаспортДатаВыдачи,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументКемВыдан КАК ПаспортКемВыдан,
			|	ДомашниеТелефоны.Поле3 КАК Телефоны,
			|	ВЫБОР
			|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL 
			|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
			|			ТОГДА &СтранаПоУмолчанию
			|		ИНАЧЕ ГражданствоФизЛиц.Страна
			|	КОНЕЦ КАК Гражданство,
			|	ВТФСЗНДоходы1.ФизЛицо.Пол КАК Пол,
			|	ВТФСЗНДоходы1.ФизЛицо.ДатаРождения КАК ДатаРождения,
			|	ВТФСЗНДоходы1.ФизЛицо.СтраховойНомерПФР КАК СтраховойНомерПФР,
			|	ВТФСЗНДоходы1.ФизЛицо.МестоРождения КАК МестоРождения,
			|	ВТФСЗНДоходы1.Категория,
			|	ЕСТЬNULL(ВТФСЗНДоходы1.Выплаты, 0) КАК Выплаты,
			|	ЕСТЬNULL(ВТФСЗНДоходы1.Пособия, 0) КАК Пособия,
			|	ЕСТЬNULL(ВТФСЗНДоходы1.ДокументОснование, 1) КАК Договор,
			|	ЕСТЬNULL(ВТФСЗНДоходы1.ВидРасчетаОклад, 1) КАК ВидРасчетаОклад,
			|	ГражданствоФизЛиц.НеИмеетПравоНаПенсию КАК НеИмеетПравоНаПенсию
			|ИЗ
			|	ВТФСЗНДоходы1 КАК ВТФСЗНДоходы1
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТФСЗНИсчисленный1 КАК ВТФСЗНИсчисленный1
			|		ПО ВТФСЗНДоходы1.Сотрудник = ВТФСЗНИсчисленный1.Сотрудник
			|			И ВТФСЗНДоходы1.ПериодВзаиморасчетов = ВТФСЗНИсчисленный1.ПериодВзаиморасчетов
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&КонецГода, ) КАК ФИОФизЛицСрезПоследних
			|		ПО ВТФСЗНДоходы1.ФизЛицо = ФИОФизЛицСрезПоследних.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаРегистрации
			|		ПО ВТФСЗНДоходы1.ФизЛицо = АдресаРегистрации.Объект
			|			И (АдресаРегистрации.Вид = &ВидАдресаРегистрации)
			|			И (АдресаРегистрации.Тип = &ТипАдрес)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаФактические
			|		ПО ВТФСЗНДоходы1.ФизЛицо = АдресаФактические.Объект
			|			И (АдресаФактические.Тип = &ТипАдрес)
			|			И (АдресаФактические.Вид = &ВидАдресаФактический)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК ДомашниеТелефоны
			|		ПО ВТФСЗНДоходы1.ФизЛицо = ДомашниеТелефоны.Объект
			|			И (ДомашниеТелефоны.Вид = &ВидТелефонаДомашний)
			|			И (ДомашниеТелефоны.Тип = &ТипТелефон)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних КАК ПаспортныеДанныеФизЛицСрезПоследних
			|		ПО ВТФСЗНДоходы1.ФизЛицо = ПаспортныеДанныеФизЛицСрезПоследних.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&ДатаПодачиСведений, ) КАК ГражданствоФизЛиц
			|		ПО ВТФСЗНДоходы1.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
			|ГДЕ
			|	ВТФСЗНДоходы1.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов";
			//если Основные Тогда 
			//	Запрос.Текст = Запрос.Текст + " и ЕСТЬNULL(ВТФСЗНДоходы1.ДокументОснование, 1) = 1 ";
			//КонецЕсли;
			
			Запрос.Текст = Запрос.Текст+"
			|	И ВЫБОР
			|			КОГДА ЕСТЬNULL(ВТФСЗНДоходы1.ВидРасчетаОклад, 1) = 1
			|				ТОГДА ЕСТЬNULL(ВТФСЗНДоходы1.ДокументОснование, 1) = 1
			|			КОГДА ЕСТЬNULL(ВТФСЗНДоходы1.ВидРасчетаОклад, 1) <> 1
			|				ТОГДА ЕСТЬNULL(ВТФСЗНДоходы1.ДокументОснование, 1) <> 3
			|		КОНЕЦ
			
			|	И ЕСТЬNULL(ВТФСЗНДоходы1.ДокументОснование, 1) = 1
			
			|	УПОРЯДОЧИТЬ ПО
			|	ВТФСЗНДоходы1.Сотрудник.Наименование,Месяц
			|ИТОГИ
			|	СУММА(Выплаты)
			|ПО
			|	Сотрудник,
			|	Месяц";
			//О.Т. Аверсон 04.03.2016 № 940
			Если ОтборПоПериодуВзаиморасчетов Тогда 
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений","");
			иначе
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений","И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений");
			КонецЕсли;
			//О.Т. Аверсон 04.03.2016 № 940
			Результат1 = Запрос.Выполнить();
		КонецЕсли;
	КонецЕсли;
	
	//Если ВсеСотрудники Тогда 
	//	Запрос.Текст = 
	//	"ВЫБРАТЬ
	//	|	ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
	//	|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
	//	|	СУММА(ВЫБОР
	//	|			КОГДА ЕСНИсчисленный.ПроцентФСЗН = 0
	//	|				ТОГДА 1
	//	|			ИНАЧЕ ЕСНИсчисленный.ПроцентФСЗН
	//	|		КОНЕЦ) КАК ПроцентФСЗН,
	//	|	СУММА(ЕСНИсчисленный.ПенсионныйФонд + ЕСНИсчисленный.ФСЗН) КАК Взносы
	//	|ПОМЕСТИТЬ ВТФСЗНИсчисленный
	//	|ИЗ
	//	|	РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
	//	|ГДЕ
	//	|	ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
	//	|	И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
	//	|	И ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
	//	|	И (&ПоВсемФизЛицам
	//	|			ИЛИ ЕСНИсчисленный.ФизЛицо = &ФизЛицо)
	//	|
	//	|СГРУППИРОВАТЬ ПО
	//	|	ЕСНИсчисленный.ФизЛицо,
	//	|	НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
	//	|
	//	|ИНДЕКСИРОВАТЬ ПО
	//	|	ФизЛицо,
	//	|	ПериодВзаиморасчетов
	//	|;
	//	|
	//	|////////////////////////////////////////////////////////////////////////////////
	//	|ВЫБРАТЬ
	//	|	СУММА(ВЫБОР
	//	|			КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН
	//	|				ТОГДА ЕСНСведенияОДоходах.Результат
	//	|			ИНАЧЕ 0
	//	|		КОНЕЦ) КАК Пособия,
	//	|	СУММА(ВЫБОР
	//	|			КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
	//	|				ТОГДА ЕСНСведенияОДоходах.Результат
	//	|			ИНАЧЕ 0
	//	|		КОНЕЦ) КАК Выплаты,
	//	|	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
	//	|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
	//	|	ВЫБОР
	//	|		КОГДА ВложенныйЗапрос.Флаг
	//	|			ТОГДА &ДоговораПодряда
	//	|		ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
	//	|	КОНЕЦ КАК Категория,
	//	|	ВложенныйЗапрос.Регистратор КАК ДокументОснование
	//	|ПОМЕСТИТЬ ВТФСЗНДоходы
	//	|ИЗ
	//	|	РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	//	|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
	//	|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка КАК Регистратор,
	//	|			ВЫБОР
	//	|				КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка = &ПустойДоговор
	//	|					ТОГДА ЛОЖЬ
	//	|				ИНАЧЕ ИСТИНА
	//	|			КОНЕЦ КАК Флаг
	//	|		ИЗ
	//	|			РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
	//	|		ГДЕ
	//	|			ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом) КАК ВложенныйЗапрос
	//	|		ПО ЕСНСведенияОДоходах.ФизЛицо = ВложенныйЗапрос.СотрудникФизлицо
	//	|			И (ЕСНСведенияОДоходах.Период МЕЖДУ ВложенныйЗапрос.Регистратор.ДатаНачала И ВложенныйЗапрос.Регистратор.ДатаОкончания)
	//	|ГДЕ
	//	|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
	//	|	И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений
	//	|	И (&ПоВсемФизЛицам
	//	|			ИЛИ ЕСНСведенияОДоходах.ФизЛицо = &ФизЛицо)
	//	|
	//	|СГРУППИРОВАТЬ ПО
	//	|	ЕСНСведенияОДоходах.ФизЛицо,
	//	|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
	//	|	ВЫБОР
	//	|		КОГДА ВложенныйЗапрос.Флаг
	//	|			ТОГДА &ДоговораПодряда
	//	|		ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
	//	|	КОНЕЦ,
	//	|	ВложенныйЗапрос.Регистратор
	//	|
	//	|ИНДЕКСИРОВАТЬ ПО
	//	|	ФизЛицо,
	//	|	ПериодВзаиморасчетов
	//	|;
	//	|
	//	|////////////////////////////////////////////////////////////////////////////////
	//	|ВЫБРАТЬ
	//	|	НАЧАЛОПЕРИОДА(Периоды.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
	//	|	ГражданствоФизЛиц.ФизЛицо КАК Физлицо
	//	|ПОМЕСТИТЬ ВТДанныеОПравеНаПенсию
	//	|ИЗ
	//	|	(ВЫБРАТЬ
	//	|		Периоды.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
	//	|		ГражданствоФизЛиц.ФизЛицо КАК Физлицо,
	//	|		МАКСИМУМ(ГражданствоФизЛиц.Период) КАК ПериодРегистра
	//	|	ИЗ
	//	|		ВТФСЗНДоходы КАК Периоды
	//	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	//	|			ПО Периоды.ПериодВзаиморасчетов >= ГражданствоФизЛиц.Период
	//	|	
	//	|	СГРУППИРОВАТЬ ПО
	//	|		ГражданствоФизЛиц.ФизЛицо,
	//	|		Периоды.ПериодВзаиморасчетов) КАК Периоды
	//	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц КАК ГражданствоФизЛиц
	//	|		ПО (ГражданствоФизЛиц.Период = Периоды.ПериодВзаиморасчетов)
	//	|			И (ГражданствоФизЛиц.ФизЛицо = Периоды.Физлицо)
	//	|
	//	|СГРУППИРОВАТЬ ПО
	//	|	ГражданствоФизЛиц.ФизЛицо,
	//	|	НАЧАЛОПЕРИОДА(Периоды.ПериодВзаиморасчетов, МЕСЯЦ)
	//	|
	//	|ИНДЕКСИРОВАТЬ ПО
	//	|	Физлицо,
	//	|	ПериодВзаиморасчетов
	//	|;
	//	|
	//	|////////////////////////////////////////////////////////////////////////////////
	//	|ВЫБРАТЬ
	//	|	ВТФСЗНДоходы.ФизЛицо КАК ФизЛицо,
	//	|	ВТФСЗНДоходы.ПериодВзаиморасчетов КАК Месяц,
	//	|	ЕСТЬNULL(ВТФСЗНИсчисленный.Взносы, 0) КАК Взносы,
	//	|	ЕСТЬNULL(ВТФСЗНИсчисленный.ПроцентФСЗН, 35) КАК ТарифВзносов,
	//	|	ВТФСЗНДоходы.ФизЛицо.СтраховойНомерПФР КАК ЛичныйНомер,
	//	|	ФИОФизЛицСрезПоследних.Фамилия КАК Фамилия,
	//	|	ФИОФизЛицСрезПоследних.Имя КАК Имя,
	//	|	ФИОФизЛицСрезПоследних.Отчество КАК Отчество,
	//	|	АдресаРегистрации.Поле1 КАК ИндексРегистрации,
	//	|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9 КАК АдресРегистрации,
	//	|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия КАК ПаспортСерия,
	//	|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер КАК ПаспортНомер,
	//	|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи КАК ПаспортДатаВыдачи,
	//	|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументКемВыдан КАК ПаспортКемВыдан,
	//	|	ДомашниеТелефоны.Поле3 КАК Телефоны,
	//	|	ВЫБОР
	//	|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL 
	//	|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
	//	|			ТОГДА &СтранаПоУмолчанию
	//	|		ИНАЧЕ ГражданствоФизЛиц.Страна
	//	|	КОНЕЦ КАК Гражданство,
	//	|	ВТФСЗНДоходы.ФизЛицо.Пол КАК Пол,
	//	|	ВТФСЗНДоходы.ФизЛицо.ДатаРождения КАК ДатаРождения,
	//	|	ВТФСЗНДоходы.ФизЛицо.СтраховойНомерПФР КАК СтраховойНомерПФР,
	//	|	ВТФСЗНДоходы.ФизЛицо.МестоРождения КАК МестоРождения,
	//	|	ВТФСЗНДоходы.Категория,
	//	|	ЕСТЬNULL(ВТФСЗНДоходы.Выплаты, 0) КАК Выплаты,
	//	|	ЕСТЬNULL(ВТФСЗНДоходы.Пособия, 0) КАК Пособия,
	//	|	ВТФСЗНДоходы.ДокументОснование КАК Договор,
	//	|	NULL КАК ВидРасчетаОклад
	//	|ИЗ
	//	|	ВТФСЗНДоходы КАК ВТФСЗНДоходы
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТФСЗНИсчисленный КАК ВТФСЗНИсчисленный
	//	|		ПО ВТФСЗНДоходы.ФизЛицо = ВТФСЗНИсчисленный.ФизЛицо
	//	|			И ВТФСЗНДоходы.ПериодВзаиморасчетов = ВТФСЗНИсчисленный.ПериодВзаиморасчетов
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&КонецГода, ) КАК ФИОФизЛицСрезПоследних
	//	|		ПО ВТФСЗНДоходы.ФизЛицо = ФИОФизЛицСрезПоследних.ФизЛицо
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеОПравеНаПенсию КАК ДанныеОПравеНаПенсию
	//	|		ПО ВТФСЗНДоходы.ФизЛицо = ДанныеОПравеНаПенсию.Физлицо
	//	|			И ВТФСЗНДоходы.ПериодВзаиморасчетов = ДанныеОПравеНаПенсию.ПериодВзаиморасчетов
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаРегистрации
	//	|		ПО ВТФСЗНДоходы.ФизЛицо = АдресаРегистрации.Объект
	//	|			И (АдресаРегистрации.Вид = &ВидАдресаРегистрации)
	//	|			И (АдресаРегистрации.Тип = &ТипАдрес)
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаФактические
	//	|		ПО ВТФСЗНДоходы.ФизЛицо = АдресаФактические.Объект
	//	|			И (АдресаФактические.Тип = &ТипАдрес)
	//	|			И (АдресаФактические.Вид = &ВидАдресаФактический)
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК ДомашниеТелефоны
	//	|		ПО ВТФСЗНДоходы.ФизЛицо = ДомашниеТелефоны.Объект
	//	|			И (ДомашниеТелефоны.Вид = &ВидТелефонаДомашний)
	//	|			И (ДомашниеТелефоны.Тип = &ТипТелефон)
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних КАК ПаспортныеДанныеФизЛицСрезПоследних
	//	|		ПО ВТФСЗНДоходы.ФизЛицо = ПаспортныеДанныеФизЛицСрезПоследних.ФизЛицо
	//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних КАК ГражданствоФизЛиц
	//	|		ПО ВТФСЗНДоходы.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
	//	|ГДЕ
	//	|	ДанныеОПравеНаПенсию.Физлицо ЕСТЬ NULL 
	//	|	И ВТФСЗНДоходы.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов
	//	|ИТОГИ
	//	|	СУММА(Выплаты)
	//	|ПО
	//	|	ФизЛицо,
	//	|	Месяц";
	//	
	//КонецЕсли;
	если Сотрудник = Неопределено Тогда 
		СведенияОВзносах.Очистить();
		СведенияОСтаже.Очистить();
		РаботникиОрганизации.Очистить();
	КонецЕсли;
	
	//О.Т. Аверсон 25.04.2019 № 4274
	ЗапросРабОрг = Новый Запрос;
	ЗапросРабОрг.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	
	ДатаНач = ДатаНачала; 
	ДатаКон = ДатаОкончания;
	
	Пока ДатаНач <= ДатаКон Цикл 
		
		ЗапросРабОрг.Текст = 
		"ВЫБРАТЬ
		|	РаботникиОрганизацийСрезПоследних.ЗанимаемыхСтавок,
		|	РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник
		|	ПОМЕСТИТЬ ВТЗанимаемыеСтавки"+Строка(Месяц(ДатаНач))+"
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период";
		если не Сотрудник = Неопределено Тогда
			ЗапросРабОрг.Текст = ЗапросРабОрг.Текст + ",Сотрудник = &Сотрудник";
		КонецЕсли;
		ЗапросРабОрг.Текст = ЗапросРабОрг.Текст + ") КАК РаботникиОрганизацийСрезПоследних";
		ЗапросРабОрг.УстановитьПараметр("Период",КонецМесяца(ДатаНач));
		ЗапросРабОрг.УстановитьПараметр("Сотрудник",Сотрудник);
		
		ДатаНач = ДобавитьМесяц(ДатаНач,1);
		ЗапросРабОрг.Выполнить(); 		
	КонецЦикла;
	
	ЗапросПрием = Новый Запрос;
	ЗапросПрием.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	ЗапросПрием.Текст = 
	"ВЫБРАТЬ
	|	РаботникиОрганизаций.Регистратор,
	|	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	|	РаботникиОрганизаций.Период
	|	ПОМЕСТИТЬ ВТПрием	
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|ГДЕ
	|	(РаботникиОрганизаций.Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию
	|			ИЛИ РаботникиОрганизаций.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций)
	|	И РаботникиОрганизаций.Период <= &ПериодОкончания
	//+ СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 77. )
	////О.Т. Аверсон 29.01.2018 № 1511 Доб условие на внутр совм";
	////|	И ( РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
	//- СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 77. )
	|"; 
	
	если не Сотрудник = Неопределено Тогда
		ЗапросРабОрг.Текст = " И РаботникиОрганизаций.Сотрудник = &Сотрудник";
	КонецЕсли;
	ТЗПриемУвольнениеСотрудника = Новый ТаблицаЗначений;
	ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаПриема");
	ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаУвольнения");
	
	ЗапросПрием.УстановитьПараметр("ПериодОкончания", КонецМесяца(ДатаОкончания));
	ЗапросПрием.УстановитьПараметр("Сотрудник", Сотрудник);
	
	ЗапросПрием.Выполнить();
	
	ДатаНач = ДатаНачала; 
	ДатаКон = ДатаОкончания;
	Сч = 1; 
	ЗапросРабОрг.Текст = "";
	Пока ДатаНач <= ДатаКон Цикл
		Если сч <> 1 Тогда
			ЗапросРабОрг.Текст = ЗапросРабОрг.Текст + " ОБЪЕДИНИТЬ ВСЕ ";
		КонецЕсли;
		ЗапросРабОрг.Текст =ЗапросРабОрг.Текст +  
		"ВЫБРАТЬ
		|	&Дата"+Строка(Месяц(ДатаНач))+" как Месяц,
		|	РаботникиОрганизацийСрезПоследних.Сотрудник,
		|	РаботникиОрганизацийСрезПоследних.ЗанимаемыхСтавок
		|ИЗ
		|	ВТЗанимаемыеСтавки"+Строка(Месяц(ДатаНач))+" КАК РаботникиОрганизацийСрезПоследних";
		
		ЗапросРабОрг.УстановитьПараметр("Дата"+Строка(Месяц(ДатаНач)),ДатаНач);
		ДатаНач = ДобавитьМесяц(ДатаНач,1);
		Сч = Сч+1;
	КонецЦикла;
	
	ТаблицаЗанимаемыеСтавки = ЗапросРабОрг.Выполнить().Выгрузить();
	
	
	//О.Т. Аверсон 25.04.2019 № 4274
	
	ТаблЗначений = Новый ТаблицаЗначений;
	ТаблЗначений.Колонки.Добавить("Таблица",,"Таблица");
	если ДогПодряда или ВсеСотрудники Тогда
		Если не Результат = Неопределено Тогда 
			СтрЗначений = ТаблЗначений.Добавить();
			СтрЗначений.Таблица = Результат;
		КонецЕсли;
	КонецЕсли;
	если Основные или ВсеСотрудники Тогда
		Если не Результат1 = Неопределено Тогда 
			СтрЗначений = ТаблЗначений.Добавить();
			СтрЗначений.Таблица = Результат1;
		КонецЕсли;
	КонецЕсли;
	сч = 0;
	ДоговорПрошл="";
	СотрПрошл = "";
	ДоговорПрошл1 = "";
	КатегорияПрошл = "";
	для Каждого Таблица из ТаблЗначений Цикл
		Результат = Таблица.Таблица;
		СтруктураПоискаВзносы = Новый Структура;
		СтруктураПоискаВзносы.Вставить("Сотрудник");
		СтруктураПоискаВзносы.Вставить("ФизЛицо");
		СтруктураПоискаВзносы.Вставить("Месяц");	
		СтруктураПоискаВзносы.Вставить("Выплаты");
		СтруктураПоискаВзносы.Вставить("Пособия");
		СтруктураПоискаВзносы.Вставить("Взносы");	
		СтруктураПоискаВзносы.Вставить("ТарифВзносов");
		СтруктураПоискаВзносы.Вставить("Договор");	
		СтруктураПоискаВзносы.Вставить("Категория");
		если не ОбъединятьОсновные Тогда 
			СтруктураПоиска = Новый Структура;
			СтруктураПоиска.Вставить("Сотрудник");
			СтруктураПоиска.Вставить("ФизЛицо");
			СтруктураПоиска.Вставить("Категория");
			СтруктураПоиска.Вставить("ВидДоговора");
		иначе
			СтруктураПоиска = Новый Структура;
			СтруктураПоиска.Вставить("Фамилия");
			СтруктураПоиска.Вставить("Имя");
			СтруктураПоиска.Вставить("Отчество");
			СтруктураПоиска.Вставить("Категория");
			СтруктураПоиска.Вставить("ВидДоговора");
		КонецЕсли;
		
		СтруктураПоискаПособие = Новый Структура; 
		СтруктураПоискаПособие.Вставить("Сотрудник");
		СтруктураПоискаПособие.Вставить("ФизЛицо");
		СтруктураПоискаПособие.Вставить("ВидДеятельности");	
		СтруктураПоискаПособие.Вставить("ДатаНачалаРабот");
		СтруктураПоискаПособие.Вставить("ДатаОкончанияРабот");
		
		//Аверсон ЕАЕ 19.01.2023 СВФР-010135
		СтруктураПоискаПособиеСДоговором = Новый Структура;
		СтруктураПоискаПособиеСДоговором.Вставить("Сотрудник");
		СтруктураПоискаПособиеСДоговором.Вставить("ФизЛицо");
		СтруктураПоискаПособиеСДоговором.Вставить("ВидДеятельности");	
		СтруктураПоискаПособиеСДоговором.Вставить("ДатаНачалаРабот");
		СтруктураПоискаПособиеСДоговором.Вставить("ДатаОкончанияРабот");
		СтруктураПоискаПособиеСДоговором.Вставить("Договор");
		//Аверсон СВФР-010135
		
		СтокаПрошлая = Дата("00010101000000");
		СтокаПрошлаяВр = Дата("00010101000000");
		СтокаПрошлаяТравма = 0;
		СтрокаПособие = СведенияОСтаже;
		
		//+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
		//СтрокаВзносыВР = СведенияОСтаже;
		//- СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
		//+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
		СтрокаВзносыВР = Неопределено;
		//- СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
		
		СтруктураПоиска1 = Новый Структура; 
		
		СтруктураПоиска1.Вставить("Сотрудник");
		СтруктураПоиска1.Вставить("ФизЛицо");
		СтруктураПоиска1.Вставить("Категория");	
		СтруктураПоиска1.Вставить("Договор");	
		СтруктураПоиска1.Вставить("ДатаНачалаРабот");
		СтруктураПоиска1.Вставить("ДатаОкончанияРабот");
		
		//О.Т. Аверсон 14.05.2019 № 4328
		Если сч1 <> 0 и ЗначениеЗаполнено(ДоговорПрошл1) и ДоговорПрошл1 <> 1 Тогда 
			ДатаНачДО = ДатаНачала;
			ДатаКонДО = ДатаОкончания;
			Пока ДатаНачДО <= ДатаКонДО Цикл
				
				
				//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
				// Данный фрагмент построен конструктором.
				// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
				
				ЗапросДоговора = Новый Запрос;
				ЗапросДоговора.Текст = 
				"ВЫБРАТЬ
				|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка,
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
				|ИЗ
				|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
				|ГДЕ
				|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
				|	И (&Месяц МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала МЕЖДУ НАЧАЛОПЕРИОДА(&Месяц, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Месяц, МЕСЯЦ)
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания МЕЖДУ НАЧАЛОПЕРИОДА(&Месяц, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Месяц, МЕСЯЦ))
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен";
				
				ЗапросДоговора.УстановитьПараметр("Месяц", ДатаНачДО);
				ЗапросДоговора.УстановитьПараметр("Сотрудник", СотрПрошл);
				
				ВыборкаДетальныеЗаписи = ЗапросДоговора.Выполнить().Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					
					ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("Сотрудник,Договор",СотрПрошл,ВыборкаДетальныеЗаписи.Ссылка));
					Если ЗначСведенияОСтаже.Количество()> 0 Тогда 
						ЗначениеЕсть = Ложь;
						
						//Аверсон ЕАЕ 09.08.2022 СВФР-009383
						ЗначениеВзносыВремЕсть = Ложь;
						//Аверсон СВФР-009383
						
						Для Каждого стрСведенияОстаже из ЗначСведенияОСтаже Цикл 
							Если ((стрСведенияОстаже.ДатаНачалаРабот >= ВыборкаДетальныеЗаписи.ДатаНачала И стрСведенияОстаже.ДатаНачалаРабот <= ВыборкаДетальныеЗаписи.ДатаОкончания) или
								(ВыборкаДетальныеЗаписи.ДатаНачала >= стрСведенияОстаже.ДатаНачалаРабот И ВыборкаДетальныеЗаписи.ДатаНачала <= стрСведенияОстаже.ДатаОкончанияРабот) или
								(ВыборкаДетальныеЗаписи.ДатаОкончания >= стрСведенияОстаже.ДатаНачалаРабот И ВыборкаДетальныеЗаписи.ДатаОкончания <= стрСведенияОстаже.ДатаОкончанияРабот)) и
								(ДатаНачДО >= НачалоМесяца(стрСведенияОстаже.ДатаНачалаРабот) и ДатаНачДО <= КонецМесяца(стрСведенияОстаже.ДатаОкончанияРабот)) Тогда 
								Дата1 = НачалоМесяца(стрСведенияОстаже.ДатаНачалаРабот);
								Дата2 = НачалоМесяца(стрСведенияОстаже.ДатаОкончанияРабот);    
								ВзносыЕсть = Ложь; 
								//СВЭЙ 08.10.25 СВФР-016398
								ПроверкаДата2 = СведенияОВзносах.Выгрузить(); 
								ОтборТЗ = Новый Структура;
								ОтборТЗ.Вставить("Сотрудник", СотрПрошл);
								СтрокиТЗ = ПроверкаДата2.НайтиСтроки(ОтборТЗ);
								Для Каждого СтрТЗ Из СтрокиТЗ Цикл
									Если СтрТЗ.Месяц > Дата2  Тогда
										Дата2 =  СтрТЗ.Месяц;
										прервать;
									КонецЕсли;
								КонецЦикла;
								//СВЭЙ 08.10.25 СВФР-016398
								Пока Дата1 <= Дата2 Цикл
									
									ПроверкаВзносов = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",СотрПрошл,Дата1)); 
									Если ПроверкаВзносов.Количество()>0 Тогда 
										ВзносыЕсть = ПроверкаВзносов[0].Выплаты >0;
										// + СВЭЙ КДЯ 22.07.19 СВФР-004561
										Если ВзносыЕсть Тогда
											Прервать;	
										КонецЕсли; 
										// - СВЭЙ КДЯ 22.07.19 СВФР-004561
									КонецЕсли;   																		
									Дата1 = ДобавитьМесяц(Дата1,1);
									
								КонецЦикла;
								Если не ВзносыЕсть Тогда 
									стрСведенияОстаже.ВидДеятельности = НеоплДог;
								КонецЕсли;   								
								ЗначениеЕсть = Истина;
								
								//Аверсон ЕАЕ 09.08.2022 СВФР-009383
								Если стрСведенияОстаже.ВидДеятельности = ВзносыВрем Тогда
									ЗначениеВзносыВремЕсть = Истина;
								КонецЕсли;
								//Аверсон СВФР-009383
								
							КонецЕсли;
						КонецЦикла;
						Если не ЗначениеЕсть Тогда  
							СтрокаСтажа = СведенияОСтаже.Добавить();
							СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
							СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
							
							//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
							СтрокаСтажа.Категория = КатегорияПрошл;
							//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
							
							СтрокаСтажа.Сотрудник = СотрПрошл;
							СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
							СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
							СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
							СтрокаСтажа.ВидДеятельности = НеоплДог;
						КонецЕсли;
						
						//Аверсон ЕАЕ 09.08.2022 СВФР-009383
						Если Не ЗначениеВзносыВремЕсть Тогда
							СтрокаСтажа = СведенияОСтаже.Добавить();
							СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
							СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
							СтрокаСтажа.Категория = КатегорияПрошл;
							СтрокаСтажа.Сотрудник = СотрПрошл;
							СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
							СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
							СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
							СтрокаСтажа.ВидДеятельности = ВзносыВрем;
						КонецЕсли;
						//Аверсон СВФР-009383
						
					иначе
						СтрокаСтажа = СведенияОСтаже.Добавить();
						СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						
						//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
						СтрокаСтажа.Категория = КатегорияПрошл;
						//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
						
						СтрокаСтажа.Сотрудник = СотрПрошл;
						СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
						СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
						СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
						СтрокаСтажа.ВидДеятельности = НеоплДог;
						
						//Аверсон ЕАЕ 09.08.2022 СВФР-009383
						СтрокаСтажа = СведенияОСтаже.Добавить();
						СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						СтрокаСтажа.Категория = КатегорияПрошл;
						СтрокаСтажа.Сотрудник = СотрПрошл;
						СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
						СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
						СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
						СтрокаСтажа.ВидДеятельности = ВзносыВрем;
						//Аверсон СВФР-009383
						
					КонецЕсли;
					
					ЗначСведенияОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",СотрПрошл,ДатаНачДО));
					если ЗначСведенияОВзносах.Количество()=0 Тогда   
						СтрокаВзносов = СведенияОВзносах.Добавить();
						СтрокаВзносов.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						СтрокаВзносов.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						СтрокаВзносов.Категория = КатегорияПрошл;
						СтрокаВзносов.Сотрудник = СотрПрошл;
						СтрокаВзносов.ФизЛицо = СотрПрошл.ФизЛицо;
						СтрокаВзносов.Месяц = ДатаНачДО;
					КонецЕсли;
					
				КонецЦикла;
				
				
				ДатаНачДО = ДобавитьМесяц(ДатаНачДО,1);
			КонецЦикла;
			ДоговорПрошл="";
			СотрПрошл = "";
			ДоговорПрошл1 = "";
			КатегорияПрошл = "";
		КонецЕсли;
		
		//О.Т. Аверсон 14.05.2019 № 4328
		
		
		ВыборкаПоФизЛицу = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		Пока ВыборкаПоФизЛицу.Следующий() Цикл
			СтокаПрошлаяВр = Дата("00010101000000");
			СтокаПрошлая = Дата("00010101000000");
			СтокаПрошлаяТравма = 0;//О.Т. Аверсон 18.05.2018 № 1985
			
			
			//О.Т. Аверсон 14.05.2019 № 4328
			Если сч1 <> 0 и ЗначениеЗаполнено(ДоговорПрошл1) и ДоговорПрошл1 <> 1 Тогда 
				ДатаНачДО = ДатаНачала;
				ДатаКонДО = ДатаОкончания;
				Пока ДатаНачДО <= ДатаКонДО Цикл
					
					
					//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
					// Данный фрагмент построен конструктором.
					// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
					
					ЗапросДоговора = Новый Запрос;
					ЗапросДоговора.Текст = 
					"ВЫБРАТЬ
					|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка,
					|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,
					|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
					|ИЗ
					|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
					|ГДЕ
					|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
					|	И (&Месяц МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
					|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала МЕЖДУ НАЧАЛОПЕРИОДА(&Месяц, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Месяц, МЕСЯЦ)
					|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания МЕЖДУ НАЧАЛОПЕРИОДА(&Месяц, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Месяц, МЕСЯЦ))
					|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен";
					
					ЗапросДоговора.УстановитьПараметр("Месяц", ДатаНачДО);
					ЗапросДоговора.УстановитьПараметр("Сотрудник", СотрПрошл);
					
					ВыборкаДетальныеЗаписи = ЗапросДоговора.Выполнить().Выбрать();
					
					Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
						
						ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("Сотрудник,Договор",СотрПрошл,ВыборкаДетальныеЗаписи.Ссылка));
						Если ЗначСведенияОСтаже.Количество()> 0 Тогда 
							ЗначениеЕсть = Ложь;
							
							//Аверсон ЕАЕ 09.08.2022 СВФР-009383
							ЗначениеВзносыВремЕсть = Ложь;
							//Аверсон СВФР-009383
							
							Для Каждого стрСведенияОстаже из ЗначСведенияОСтаже Цикл 
								Если ((стрСведенияОстаже.ДатаНачалаРабот >= ВыборкаДетальныеЗаписи.ДатаНачала И стрСведенияОстаже.ДатаНачалаРабот <= ВыборкаДетальныеЗаписи.ДатаОкончания) или
									(ВыборкаДетальныеЗаписи.ДатаНачала >= стрСведенияОстаже.ДатаНачалаРабот И ВыборкаДетальныеЗаписи.ДатаНачала <= стрСведенияОстаже.ДатаОкончанияРабот) или
									(ВыборкаДетальныеЗаписи.ДатаОкончания >= стрСведенияОстаже.ДатаНачалаРабот И ВыборкаДетальныеЗаписи.ДатаОкончания <= стрСведенияОстаже.ДатаОкончанияРабот)) и
									(ДатаНачДО >= НачалоМесяца(стрСведенияОстаже.ДатаНачалаРабот) и ДатаНачДО <= КонецМесяца(стрСведенияОстаже.ДатаОкончанияРабот)) Тогда 
									Дата1 = НачалоМесяца(стрСведенияОстаже.ДатаНачалаРабот);
									Дата2 = НачалоМесяца(стрСведенияОстаже.ДатаОкончанияРабот);    
									ВзносыЕсть = Ложь; 
									
									//СВЭЙ 08.10.25 СВФР-016398
									ПроверкаДата2 = СведенияОВзносах.Выгрузить(); 
									ОтборТЗ = Новый Структура;
									ОтборТЗ.Вставить("Сотрудник", СотрПрошл);
									СтрокиТЗ = ПроверкаДата2.НайтиСтроки(ОтборТЗ);
									Для Каждого СтрТЗ Из СтрокиТЗ Цикл
										Если СтрТЗ.Месяц > Дата2  Тогда
											Дата2 =  СтрТЗ.Месяц;
											прервать;
										КонецЕсли;
									КонецЦикла;
									//СВЭЙ 08.10.25 СВФР-016398

									Пока Дата1 <= Дата2 Цикл
										
										ПроверкаВзносов = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",СотрПрошл,Дата1)); 
										Если ПроверкаВзносов.Количество()>0 Тогда 
											ВзносыЕсть = ПроверкаВзносов[0].Выплаты >0;
											// + СВЭЙ КДЯ 22.07.19 СВФР-004561
											Если ВзносыЕсть Тогда
												Прервать;	
											КонецЕсли; 
											// - СВЭЙ КДЯ 22.07.19 СВФР-004561
										КонецЕсли;   																		
										Дата1 = ДобавитьМесяц(Дата1,1);
										
									КонецЦикла;
									Если не ВзносыЕсть Тогда 
										стрСведенияОстаже.ВидДеятельности = НеоплДог;
									КонецЕсли;   								
									ЗначениеЕсть = Истина;
									
									//Аверсон ЕАЕ 09.08.2022 СВФР-009383
									Если стрСведенияОстаже.ВидДеятельности = ВзносыВрем Тогда
										ЗначениеВзносыВремЕсть = Истина;
									КонецЕсли;
									//Аверсон СВФР-009383
									
								КонецЕсли;
							КонецЦикла;
							Если не ЗначениеЕсть Тогда  
								СтрокаСтажа = СведенияОСтаже.Добавить();
								СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
								СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
								
								//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
								СтрокаСтажа.Категория = КатегорияПрошл;
								//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
								
								СтрокаСтажа.Сотрудник = СотрПрошл;
								СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
								СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
								СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
								СтрокаСтажа.ВидДеятельности = НеоплДог;
							КонецЕсли;
							
							//Аверсон ЕАЕ 09.08.2022 СВФР-009383
							Если Не ЗначениеВзносыВремЕсть Тогда
								СтрокаСтажа = СведенияОСтаже.Добавить();
								СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
								СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
								СтрокаСтажа.Категория = КатегорияПрошл;
								СтрокаСтажа.Сотрудник = СотрПрошл;
								СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
								СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
								СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
								СтрокаСтажа.ВидДеятельности = ВзносыВрем;
							КонецЕсли;
							//Аверсон СВФР-009383
							
						иначе
							СтрокаСтажа = СведенияОСтаже.Добавить();
							СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
							СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
							
							//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
							СтрокаСтажа.Категория = КатегорияПрошл;
							//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
							
							СтрокаСтажа.Сотрудник = СотрПрошл;
							СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
							СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
							СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
							СтрокаСтажа.ВидДеятельности = НеоплДог;
							
							//Аверсон ЕАЕ 09.08.2022 СВФР-009383
							СтрокаСтажа = СведенияОСтаже.Добавить();
							СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
							СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
							СтрокаСтажа.Категория = КатегорияПрошл;
							СтрокаСтажа.Сотрудник = СотрПрошл;
							СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
							СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
							СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
							СтрокаСтажа.ВидДеятельности = ВзносыВрем;
							//Аверсон СВФР-009383
							
						КонецЕсли;
						
						ЗначСведенияОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",СотрПрошл,ДатаНачДО));
						если ЗначСведенияОВзносах.Количество()=0 Тогда   
							СтрокаВзносов = СведенияОВзносах.Добавить();
							СтрокаВзносов.Договор = ВыборкаДетальныеЗаписи.Ссылка;
							СтрокаВзносов.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
							СтрокаВзносов.Категория = КатегорияПрошл;
							СтрокаВзносов.Сотрудник = СотрПрошл;
							СтрокаВзносов.ФизЛицо = СотрПрошл.ФизЛицо;
							СтрокаВзносов.Месяц = ДатаНачДО;
						КонецЕсли;
						
					КонецЦикла;		
					
					ДатаНачДО = ДобавитьМесяц(ДатаНачДО,1);
				КонецЦикла; 	
			КонецЕсли;
			сч1 = 1;
			//О.Т. Аверсон 14.05.2019 № 4328
			
			//Островская Татьяна 06.03.2014 № 17172
			если не Сотрудник = Неопределено Тогда
				СтруктураПоискаУдалить = Новый Структура("Сотрудник", Сотрудник);
				
				МассивСтрок = СведенияОСтаже.НайтиСтроки(СтруктураПоискаУдалить);
				Для каждого СтрокаТабличнойЧасти Из МассивСтрок Цикл
					СведенияОСтаже.Удалить(СтрокаТабличнойЧасти);
				КонецЦикла;
				МассивСтрок = СведенияОВзносах.НайтиСтроки(СтруктураПоискаУдалить);
				Для каждого СтрокаТабличнойЧасти Из МассивСтрок Цикл
					СведенияОВзносах.Удалить(СтрокаТабличнойЧасти);
				КонецЦикла;
			КонецЕсли;
			//Островская Татьяна 06.03.2014 № 17172
			ВыборкаПоМесяцам = ВыборкаПоФизЛицу.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаПоМесяцам.Следующий() Цикл
				
				
				ВсегоВыплат = ВыборкаПоМесяцам.Выплаты;
				ВыборкаПоДоговорам = ВыборкаПоМесяцам.Выбрать();
				Пока ВыборкаПоДоговорам.Следующий() Цикл
					если ВыборкаПоДоговорам.НеИмеетПравоНаПенсию = истина Тогда 
						Продолжить;	
					КонецЕсли;
					
					//Аверсон ЕАЕ 01.06.2022 СВФР-009112
					//если ВыборкаПоДоговорам.Выплаты = 0  и ВыборкаПоДоговорам.Пособия = 0 Тогда  //Островская Татьяна 25.02.2014 № 17147
					//	Продолжить;
					//КонецЕсли; 
					//Аверсон СВФР-009112
					
					СотрПрошл = ВыборкаПоДоговорам.Сотрудник;//О.Т. Аверсон 14.05.2019 № 4328
					ДоговорПрошл1 = ВыборкаПоДоговорам.Договор;//О.Т. Аверсон 14.05.2019 № 4328
					КатегорияПрошл = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 14.05.2019 № 4328
					//если ОбъединятьОсновные и ВыборкаПоДоговорам.Договор = 1 Тогда 
					//	СтруктураПоиска = Новый Структура;
					//	СтруктураПоиска.Вставить("Фамилия");
					//	СтруктураПоиска.Вставить("Имя");
					//	СтруктураПоиска.Вставить("Отчество");
					//	СтруктураПоиска.Вставить("Категория");
					//	СтруктураПоиска.Вставить("ВидДоговора");
					//иначе 
					СтруктураПоиска = Новый Структура;
					СтруктураПоиска.Вставить("Сотрудник");
					СтруктураПоиска.Вставить("ФизЛицо");
					СтруктураПоиска.Вставить("Категория");
					СтруктураПоиска.Вставить("ВидДоговора");
					
					//КонецЕсли;
					
					//если ОбъединятьОсновные и ВыборкаПоДоговорам.Договор = 1 Тогда 
					//	СтруктураПоиска.Фамилия = ВыборкаПоДоговорам.Фамилия;
					//	СтруктураПоиска.Имя = ВыборкаПоДоговорам.Имя;
					//	СтруктураПоиска.Отчество = ВыборкаПоДоговорам.Отчество;
					//иначе
					СтруктураПоиска.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
					СтруктураПоиска.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
					//КонецЕсли;
					СтруктураПоиска.Категория =ВыборкаПоДоговорам.Категория; 
					если ВыборкаПоДоговорам.Договор = 1 Тогда 
						СтруктураПоиска.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
					иначе
						СтруктураПоиска.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
					КонецЕсли;
					НайденныеСтроки = РаботникиОрганизации.НайтиСтроки(СтруктураПоиска);
					Если НайденныеСтроки.Количество() = 0 Тогда
						если не Сотрудник = Неопределено Тогда 
							если ВыборкаПоДоговорам.Договор <> 1 и Основные Тогда 
								
								СтрокаРаботник = РаботникиОрганизации.Добавить();
								ЗаполнитьЗначенияСвойств(СтрокаРаботник,ВыборкаПоДоговорам);
								если не ВыборкаПоДоговорам.Договор = 1 Тогда 
									СтрокаРаботник.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
								Иначе 
									СтрокаРаботник.ВидДоговора =  Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
									
								КонецЕсли;
							КонецЕсли;
							если не Основные и ВыборкаПоДоговорам.Договор <> 1 Тогда 
								СтруктураПоискаДог = Новый Структура;
								СтруктураПоискаДог.Вставить("Сотрудник");
								СтруктураПоискаДог.Вставить("ФизЛицо");
								СтруктураПоискаДог.Вставить("Категория");
								
								//если ОбъединятьОсновные и ВыборкаПоДоговорам.Договор = 1 Тогда 
								//	СтруктураПоискаДог.Фамилия = ВыборкаПоДоговорам.Фамилия;
								//	СтруктураПоискаДог.Имя = ВыборкаПоДоговорам.Имя;
								//	СтруктураПоискаДог.Отчество = ВыборкаПоДоговорам.Отчество;
								//иначе
								СтруктураПоискаДог.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
								СтруктураПоискаДог.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
								//КонецЕсли;
								СтруктураПоискаДог.Категория =ВыборкаПоДоговорам.Категория; 
								НайденныеСтрокиДог = РаботникиОрганизации.НайтиСтроки(СтруктураПоискаДог);
								Если НайденныеСтрокиДог.Количество()>0 Тогда 
									НайденныеСтрокиДог[0].ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
								КонецЕсли;
							КонецЕсли;
						иначе
							если ВыборкаПоДоговорам.Договор <> 1 и Основные Тогда 
							иначе
								
								СтрокаРаботник = РаботникиОрганизации.Добавить();
								ЗаполнитьЗначенияСвойств(СтрокаРаботник,ВыборкаПоДоговорам);
								если не ВыборкаПоДоговорам.Договор = 1 Тогда 
									СтрокаРаботник.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
								Иначе 
									СтрокаРаботник.ВидДоговора =  Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
									
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					//Островская Татьяна 05.03.2014 № 17172
					ДобавлениеСтрокДата = Новый ТаблицаЗначений;
					ДобавлениеСтрокДата.Колонки.Добавить("ДатаНачала");
					ДобавлениеСтрокДата.Колонки.Добавить("ДатаОкончания");
					
					ЗапросПрием.Текст = 
					"ВЫБРАТЬ
					|	РаботникиОрганизаций.Регистратор,
					|	РаботникиОрганизаций.Период КАК Период
					|ИЗ
					|	ВТПрием КАК РаботникиОрганизаций
					|ГДЕ
					|	РаботникиОрганизаций.Сотрудник = &Сотрудник
					//+ СВЭЙ КДЯ 22.07.19 СВФР-004561 
					|УПОРЯДОЧИТЬ ПО
					|	Период	
					//- СВЭЙ КДЯ 22.07.19 СВФР-004561
					|";
					
					ТЗПриемУвольнениеСотрудника = Новый ТаблицаЗначений;
					ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаПриема");
					ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаУвольнения");
					
					ЗапросПрием.УстановитьПараметр("ПериодОкончания", КонецМесяца(ДатаОкончания));
					ЗапросПрием.УстановитьПараметр("Сотрудник", ВыборкаПоДоговорам.Сотрудник);
					
					РезультПрием = ЗапросПрием.Выполнить().Выбрать();
					ДатаПриема = Дата(1,1,1);							
					Пока РезультПрием.Следующий() Цикл
						если ТипЗнч(РезультПрием.Регистратор) = Тип("ДокументСсылка.ПриемНаРаботуВОрганизацию") Тогда 
							СтрТЗПриемУвольнениеСотрудника = ТЗПриемУвольнениеСотрудника.Добавить();
							СтрТЗПриемУвольнениеСотрудника.ДатаПриема = РезультПрием.Период; 
						КонецЕсли;
						если ТипЗнч(РезультПрием.Регистратор) = Тип("ДокументСсылка.УвольнениеИзОрганизаций") Тогда 
							если СтрТЗПриемУвольнениеСотрудника = Неопределено Тогда 
								СтрТЗПриемУвольнениеСотрудника = ТЗПриемУвольнениеСотрудника.Добавить();
							КонецЕсли;
							СтрТЗПриемУвольнениеСотрудника.ДатаУвольнения = РезультПрием.Период-86400;
							
						КонецЕсли;
						
					КонецЦикла;
					// Для Сотрудников, когда Дата Увольнения и следом дата приема в одном месяце
					СчКол = 0;
					Для Каждого СтрДата из ТЗПриемУвольнениеСотрудника Цикл
						если СчКол = 0 Тогда 
							если ?(СтрДата.ДатаУвольнения=Неопределено, Дата(1,1,1),СтрДата.ДатаУвольнения) > НачалоМесяца(НачалоМесяца(ВыборкаПоДоговорам.Месяц)-1) и ?(СтрДата.ДатаУвольнения=Неопределено, Дата(1,1,1),СтрДата.ДатаУвольнения) <= НачалоМесяца(ВыборкаПоДоговорам.Месяц)-1 Тогда 
								СчКол = СчКол+1;
							КонецЕсли;
						иначе
							если СтрДата.ДатаПриема > НачалоМесяца(НачалоМесяца(ВыборкаПоДоговорам.Месяц)-1) и СтрДата.ДатаПриема <= НачалоМесяца(ВыборкаПоДоговорам.Месяц)-1 Тогда 
								СчКол = СчКол+1;
							КонецЕсли;
						КонецЕсли;
						
						
					КонецЦикла;
					//
					
					
					
					ДатаПриема = Дата(1,1,1);
					ДатаУвольнения = Дата(1,1,1);
					ДатаУвПрСовпадают = Ложь;
					КолПр = 0;
					Для Каждого СтрДата из ТЗПриемУвольнениеСотрудника Цикл
						если ДатаПриема = Дата(1,1,1) и ДатаУвольнения = Дата(1,1,1) Тогда 
							ДатаПриема = СтрДата.ДатаПриема;
							ДатаУвольнения = СтрДата.ДатаУвольнения;
						КонецЕсли;
						
						если ?(СтрДата.ДатаПриема = Неопределено,КонецМесяца(ВыборкаПоДоговорам.Месяц),СтрДата.ДатаПриема) <= КонецМесяца(ВыборкаПоДоговорам.Месяц) и
							?(СтрДата.ДатаУвольнения = Неопределено,НачалоМесяца(ВыборкаПоДоговорам.Месяц),СтрДата.ДатаУвольнения) >= НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
							
							ДатаПриема = ?(СтрДата.ДатаПриема = Неопределено,Дата(1,1,1),СтрДата.ДатаПриема);
							если ЗначениеЗаполнено(ДатаУвольнения) и ЗначениеЗаполнено(ДатаПриема) Тогда 
								если КонецДня(ДатаУвольнения)+1 = ДатаПриема или НачалоМесяца(ДатаУвольнения) = НачалоМесяца(ДатаПриема) Тогда 
									ДатаУвПрСовпадают = Истина;
								КонецЕсли;
							КонецЕсли;
							
							если не  КолПр = 1 Тогда 
								ДатаУвольнения = ?(СтрДата.ДатаУвольнения = Неопределено,Дата(1,1,1),СтрДата.ДатаУвольнения);
							КонецЕсли;
							
							КолПр = КолПр+1;
						КонецЕсли;
						
					КонецЦикла;
					если ЗначениеЗаполнено(ВыборкаПоДоговорам.Договор) и ВыборкаПоДоговорам.Договор<>1 Тогда 
						ДатаПриема = Дата(1,1,1);
						ДатаУвольнения = Дата(1,1,1);
					КонецЕсли;
					
					//Аверсон ЕАЕ 21.01.2022 СВФР-008639
					Если ДатаУвольнения = Неопределено Тогда
						ДатаУвольнения = Дата(1,1,1);
					КонецЕсли;
					//Аверсон СВФР-008639
					
					//ЗапросПриемПоРегистрации = Новый Запрос;
					//ЗапросПриемПоРегистрации.Текст = 
					//"ВЫБРАТЬ
					//|	РаботникиОрганизацийСрезПоследних.Период
					//|ИЗ
					//|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
					//|			&Период,
					//|			Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию
					//|				И Сотрудник.Физлицо = &ФизЛицо) КАК РаботникиОрганизацийСрезПоследних";
					//
					//ЗапросПриемПоРегистрации.УстановитьПараметр("Период", КонецМесяца(ДатаОкончания));
					//ЗапросПриемПоРегистрации.УстановитьПараметр("ФизЛицо", ВыборкаПоДоговорам.ФизЛицо);
					//
					//РезультПриемПоРегитрации = ЗапросПриемПоРегистрации.Выполнить().Выбрать();
					//ДатаПриемаПоРегистрации = Дата(1,1,1);							
					//Пока РезультПриемПоРегитрации.Следующий() Цикл
					//	ДатаПриемаПоРегистрации = РезультПриемПоРегитрации.Период;
					//КонецЦикла;
					//
					//ЗапросУвольн = Новый Запрос;
					//ЗапросУвольн.Текст = 
					//"ВЫБРАТЬ
					//|	РаботникиОрганизацийСрезПоследних.Период
					//|ИЗ
					//|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
					//|			&Период,
					//|			Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций
					//|				И Сотрудник.Физлицо = &ФизЛицо) КАК РаботникиОрганизацийСрезПоследних";
					//
					//ЗапросУвольн.УстановитьПараметр("Период", КонецМесяца(ВыборкаПоДоговорам.Месяц));
					//ЗапросУвольн.УстановитьПараметр("ФизЛицо", ВыборкаПоДоговорам.ФизЛицо);
					//
					//РезультУв = ЗапросУвольн.Выполнить().Выбрать();
					//ДатаУвольнения = Дата(1,1,1);							
					//Пока РезультУв.Следующий() Цикл
					//	ДатаУвольнения = РезультУв.Период-86400;
					//КонецЦикла;
					//
					//ЗапросУвольнПоРегистрации = Новый Запрос;
					//ЗапросУвольнПоРегистрации.Текст = 
					//"ВЫБРАТЬ
					//|	РаботникиОрганизацийСрезПоследних.Период
					//|ИЗ
					//|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(
					//|			&Период,
					//|			Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций
					//|				И Сотрудник.Физлицо = &ФизЛицо) КАК РаботникиОрганизацийСрезПоследних";
					//
					//ЗапросУвольнПоРегистрации.УстановитьПараметр("Период", КонецМесяца(ДатаОкончания));
					//ЗапросУвольнПоРегистрации.УстановитьПараметр("ФизЛицо", ВыборкаПоДоговорам.ФизЛицо);
					//
					//РезультУвПоРегитрации = ЗапросУвольнПоРегистрации.Выполнить().Выбрать();
					//ДатаУвольнПоРегистрации = Дата(1,1,1);							
					//Пока РезультУвПоРегитрации.Следующий() Цикл
					//	ДатаУвольнПоРегистрации = РезультУвПоРегитрации.Период;
					//КонецЦикла;
					
					
					
					
					если ДатаНачала >= Дата("20140101000000") и ?(ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда, истина,ВыборкаПоДоговорам.Пособия > 0) Тогда  //ДатаРегистрации
						Если не Сотрудник = Неопределено Тогда 
							ПолучитьТаблицуПособий(ЗапросПособие,Сотрудник,ВыборкаПоДоговорам.Месяц);
						КонецЕсли;
						
						Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда
							ЗапросПособие.УстановитьПараметр("Сотрудник",ВыборкаПоДоговорам.Сотрудник);						
							ЗапросПособие.Текст = "Выбрать 
							|	Сумма(ВТПособие.Пособия) как Пособия,
							|	ВТПособие.ПериодДействияНачало,
							|	ВТПособие.ПериодВзаиморасчетов,
							|	ВТПособие.ПериодДействияКонец,
							|	ВТПособие.НомерДоговора,
							|	ВТПособие.ДатаДоговора
							|	ИЗ ВТДанныеОПособии"+Строка(Месяц(ВыборкаПоДоговорам.Месяц))+" как ВТПособие
							|	ГДЕ ВТПособие.Сотрудник = &Сотрудник 						
							|	СГРУППИРОВАТЬ ПО
							|	ВТПособие.ПериодДействияНачало,
							|	ВТПособие.ПериодВзаиморасчетов,
							|	ВТПособие.ПериодДействияКонец,
							|	ВТПособие.НомерДоговора,
							|	ВТПособие.ДатаДоговора
							|УПОРЯДОЧИТЬ ПО
							|	ПериодДействияНачало";
							
						иначе
							ЗапросПособие.УстановитьПараметр("Сотрудник",ВыборкаПоДоговорам.Сотрудник);						
							ЗапросПособие.Текст = "Выбрать 
							|	Сумма(ВТПособие.Пособия) как Пособия,
							|	ВТПособие.ПериодДействияНачало,
							|	ВТПособие.ПериодВзаиморасчетов,
							|	Сумма(ВТПособие.Выплаты) как Выплаты,
							|	ВТПособие.ПериодДействияКонец,
							|	ВТПособие.ПериодДействияНачало1
							|	ИЗ ВТДанныеОПособии"+Строка(Месяц(ВыборкаПоДоговорам.Месяц))+" как ВТПособие
							|	ГДЕ ВТПособие.Сотрудник = &Сотрудник 						
							|	СГРУППИРОВАТЬ ПО
							|	ВТПособие.ПериодДействияНачало,
							|	ВТПособие.ПериодВзаиморасчетов,
							|	ВТПособие.ПериодДействияКонец,
							|	ВТПособие.ПериодДействияНачало1
							|УПОРЯДОЧИТЬ ПО
							|	ПериодДействияНачало";  
						КонецЕсли;
						
						РезЗапросПособие = ЗапросПособие.Выполнить().Выбрать();
						
						ПрошлДатаКон = "";
						ПрошлДатаНач = "";
						ПрошлДействиеКонец = "";
						Пока РезЗапросПособие.Следующий() Цикл 
							если РезЗапросПособие.Пособия > 0 Тогда //или (РезЗапросПособие.Пособия = 0 и РезЗапросПособие.Выплаты = 0)  Тогда
								Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда
									Если (РезЗапросПособие.ПериодДействияНачало >= ВыборкаПоДоговорам.Договор.ДатаНачала и РезЗапросПособие.ПериодДействияНачало <= ВыборкаПоДоговорам.Договор.ДатаОкончания) 
										или (РезЗапросПособие.ПериодДействияКонец >= ВыборкаПоДоговорам.Договор.ДатаНачала и РезЗапросПособие.ПериодДействияКонец <= ВыборкаПоДоговорам.Договор.ДатаОкончания)
										или (ВыборкаПоДоговорам.Договор.ДатаНачала >= РезЗапросПособие.ПериодДействияНачало и ВыборкаПоДоговорам.Договор.ДатаНачала <= РезЗапросПособие.ПериодДействияКонец) Тогда 
										
										СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата.Добавить();
										СтрокаДобавлениеСтрокДата.ДатаНачала = РезЗапросПособие.ПериодДействияНачало;
										СтрокаДобавлениеСтрокДата.ДатаОкончания = РезЗапросПособие.ПериодДействияКонец;
									КонецЕсли;
									
								иначе
									СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата.Добавить();
									СтрокаДобавлениеСтрокДата.ДатаНачала = РезЗапросПособие.ПериодДействияНачало;
									СтрокаДобавлениеСтрокДата.ДатаОкончания = РезЗапросПособие.ПериодДействияКонец;
								КонецЕсли;
								//если РезЗапросПособие.ПериодДействияНачало > НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ПрошлДатаНач = "" Тогда 
								//	
								//	СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата.Добавить();
								//	СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
								//	СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецДня(РезЗапросПособие.ПериодДействияНачало-86400);
								//	ПрошлДатаКон =СтрокаДобавлениеСтрокДата.ДатаОкончания; 
								//	ПрошлДатаНач =СтрокаДобавлениеСтрокДата.ДатаНачала; 
								//										
								//ИначеЕсли ПрошлДатаНач <> "" Тогда 
								//	если НачалоДня(ПрошлДатаКон+86400) = НачалоДня(РезЗапросПособие.ПериодДействияНачало) Тогда
								//		//СтрокаДобавлениеСтрокДата.ДатаОкончания = РезЗапросПособие.ПериодДействияКонец;
								//		ПрошлДатаКон =РезЗапросПособие.ПериодДействияКонец;
								//	иначе
								//		
								//		если ПрошлДатаКон <> "" Тогда 
								//			если не НачалоДня(ПрошлДействиеКонец+86400) = РезЗапросПособие.ПериодДействияНачало Тогда  
								//				СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата.Добавить();
								//				СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоДня(ПрошлДействиеКонец+86400);
								//				СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецДня(РезЗапросПособие.ПериодДействияНачало-86400); 
								//			КонецЕсли;
								//		КонецЕсли;
								//		ПрошлДатаКон =СтрокаДобавлениеСтрокДата.ДатаОкончания; 
								//		ПрошлДатаНач =СтрокаДобавлениеСтрокДата.ДатаНачала; 
								//	КонецЕсли;
								//	
								//КонецЕсли;
								//ПрошлДействиеКонец = РезЗапросПособие.ПериодДействияКонец;
								если РезЗапросПособие.Пособия > 0 и ?(ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда,ВыборкаПоДоговорам.Пособия >0,истина)  Тогда								
									ПрошлДатаКон1 = "";
									ПрошлДатаНач1 = "";
									ДатаНачПособие = РезЗапросПособие.ПериодДействияНачало;
									
									//Аверсон ЕАЕ 19.01.2023 СВФР-010135
									//СтруктураПоискаПособие.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
									//СтруктураПоискаПособие.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
									//СтруктураПоискаПособие.ДатаНачалаРабот = РезЗапросПособие.ПериодДействияНачало;
									//СтруктураПоискаПособие.ДатаОкончанияРабот = НачалоДня(РезЗапросПособие.ПериодДействияКонец);
									//СтруктураПоискаПособие.ВидДеятельности = Пособие;
									СтруктураПоискаПособиеСДоговором.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
									СтруктураПоискаПособиеСДоговором.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
									СтруктураПоискаПособиеСДоговором.ДатаНачалаРабот = РезЗапросПособие.ПериодДействияНачало;
									СтруктураПоискаПособиеСДоговором.ДатаОкончанияРабот = НачалоДня(РезЗапросПособие.ПериодДействияКонец);
									СтруктураПоискаПособиеСДоговором.ВидДеятельности = Пособие;
									СтруктураПоискаПособиеСДоговором.Договор = ВыборкаПоДоговорам.Договор;
									
									//НайденныеСтрокиПособие =  СведенияОСтаже.НайтиСтроки(СтруктураПоискаПособие);
									НайденныеСтрокиПособие =  СведенияОСтаже.НайтиСтроки(СтруктураПоискаПособиеСДоговором);
									//Аверсон СВФР-010135
									
									Если НайденныеСтрокиПособие.Количество() = 0 Тогда
										если НачалоДня(СтокаПрошлая+86400) = НачалоДня(РезЗапросПособие.ПериодДействияНачало) 
											//+ СВЭЙ КДЯ 01.11.19 СВФР-004631 ( Пункт 57. ) СВФР-004969
											И СтрокаПособие.Договор = ВыборкаПоДоговорам.Договор 
											//- СВЭЙ КДЯ 01.11.19 СВФР-004631 ( Пункт 57. ) СВФР-004969
											Тогда
											если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < РезЗапросПособие.ПериодДействияКонец Тогда 
												СтрокаПособие.ДатаОкончанияРабот = ДатаУвольнения;
											иначе
												СтрокаПособие.ДатаОкончанияРабот = РезЗапросПособие.ПериодДействияКонец;
											КонецЕсли;
											
											//+ СВЭЙ КДЯ 21.11.19 СВФР-004631 ( Пункт 65. )
											Если ЗначениеЗаполнено( СтрокаПособие.Договор ) И ЗначениеЗаполнено( СтрокаПособие.Договор.ДатаОкончания ) Тогда
												
												Если Год( СтрокаПособие.ДатаОкончанияРабот ) =  Год( СтрокаПособие.Договор.ДатаОкончания ) 
													И Месяц( СтрокаПособие.ДатаОкончанияРабот ) =  Месяц( СтрокаПособие.Договор.ДатаОкончания ) Тогда
													СтрокаПособие.ДатаОкончанияРабот = Мин( СтрокаПособие.ДатаОкончанияРабот, СтрокаПособие.Договор.ДатаОкончания );	
												КонецЕсли; 
												
											КонецЕсли; 
											//- СВЭЙ КДЯ 21.11.19 СВФР-004631 ( Пункт 65. )
											
											если ДатаПриема <> Дата(1,1,1) и ДатаПриема > РезЗапросПособие.ПериодДействияНачало и не (ДатаУвольнения >РезЗапросПособие.ПериодДействияНачало и ДатаУвольнения>РезЗапросПособие.ПериодДействияКонец) Тогда 
												СтрокаПособие.ДатаНачалаРабот = ДатаПриема;
											КонецЕсли;											
											
											
											СтокаПрошлая = СтрокаПособие.ДатаОкончанияРабот;
											если ПрошлДатаНач = "" Тогда 
												ПрошлДатаНач1 =РезЗапросПособие.ПериодДействияНачало;
											КонецЕсли;
											ПрошлДатаКон1 =СтрокаПособие.ДатаОкончанияРабот;
											
										иначе
											если (ДатаПриема <= РезЗапросПособие.ПериодДействияКонец или ДатаПриема = Дата(1,1,1)) и (ДатаУвольнения >= РезЗапросПособие.ПериодДействияНачало или ДатаУвольнения = Дата(1,1,1)) Тогда 
												СтрокаПособие = СведенияОСтаже.Добавить();
												//если ВыгрузкаДоговоровПодрядаБезОграничнеия и ДогПодряда Тогда //О.Т. Аверсон 23.08.2018 № 2335
												если не ВыборкаПоДоговорам.Договор = 1 Тогда
													СтрокаПособие.Договор = ВыборкаПоДоговорам.Договор;
													СтрокаПособие.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
													СтрокаПособие.Категория = ВыборкаПоДоговорам.Категория; //СВЭЙ 23.08.2023 КВВ СВФР-011258 (пункт 2)
												КонецЕсли;
												//КонецЕсли;
												
												СтрокаПособие.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
												СтрокаПособие.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
												если ДатаПриема <> Дата(1,1,1) и Год(ДатаПриема) = Год(РезЗапросПособие.ПериодДействияНачало) и Месяц(ДатаПриема) = Месяц(РезЗапросПособие.ПериодДействияНачало) и День(ДатаПриема) > День(РезЗапросПособие.ПериодДействияНачало) Тогда 
													СтрокаПособие.ДатаНачалаРабот = ДатаПриема;
												ИначеЕсли СчКол > 1 Тогда 
													СтрокаПособие.ДатаНачалаРабот = ДатаПриема;
												иначе
													
													СтрокаПособие.ДатаНачалаРабот = РезЗапросПособие.ПериодДействияНачало;
												КонецЕсли;
												если не (ДатаУвольнения >РезЗапросПособие.ПериодДействияНачало и ДатаУвольнения>РезЗапросПособие.ПериодДействияКонец) Тогда
													СтрокаПособие.ДатаНачалаРабот = РезЗапросПособие.ПериодДействияНачало;
												КонецЕсли;
												
												
												если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < РезЗапросПособие.ПериодДействияКонец Тогда 
													СтрокаПособие.ДатаОкончанияРабот = ДатаУвольнения;
												иначе
													СтрокаПособие.ДатаОкончанияРабот = РезЗапросПособие.ПериодДействияКонец;
												КонецЕсли;
												
												//+ СВЭЙ КДЯ 21.11.19 СВФР-004631 ( Пункт 65. )
												Если ЗначениеЗаполнено( СтрокаПособие.Договор ) И ЗначениеЗаполнено( СтрокаПособие.Договор.ДатаОкончания ) Тогда
													
													Если Год( СтрокаПособие.ДатаОкончанияРабот ) =  Год( СтрокаПособие.Договор.ДатаОкончания ) 
														И Месяц( СтрокаПособие.ДатаОкончанияРабот ) =  Месяц( СтрокаПособие.Договор.ДатаОкончания ) Тогда
														СтрокаПособие.ДатаОкончанияРабот = Мин( СтрокаПособие.ДатаОкончанияРабот, СтрокаПособие.Договор.ДатаОкончания );	
													КонецЕсли; 
													
												КонецЕсли; 
												//- СВЭЙ КДЯ 21.11.19 СВФР-004631 ( Пункт 65. )
												
												СтрокаПособие.ВидДеятельности = Пособие;
												
												СтокаПрошлая = СтрокаПособие.ДатаОкончанияРабот;
												ПрошлДатаНач1 =СтрокаПособие.ДатаНачалаРабот;
												ПрошлДатаКон1 =СтрокаПособие.ДатаОкончанияРабот;
												
												//СВЭЙ 28.08.2023 КВВ СВФР-011258 (пункт 2) (
												Если КонецДня(СтрокаПособие.ДатаОкончанияРабот) = КонецМесяца(СтрокаПособие.ДатаОкончанияРабот)
													И ДогПодряда
													И КонецДня(СтрокаПособие.ДатаОкончанияРабот)=КонецДня(ВыборкаПоДоговорам.Договор.ДатаОкончания) //СВЭЙ 25.04.2024 КВВ СВФР-012944 (пункт 1)
													И НЕ ВыгрузкаДоговоровПодрядаБезОграничения
													И НЕ ВыборкаПоДоговорам.Договор = 1 Тогда
													
													Для МесяцевВперед = 1 По 3 Цикл
														СтанетМесяц = ДобавитьМесяц(НачалоМесяца(ВыборкаПоДоговорам.Месяц),МесяцевВперед);
														
														ЗапросПособие1 = Новый Запрос;
														ЗапросПособие1 = ЗапросПособие;
														
														ЗапросПособие1.Текст = "Выбрать 
														|	Сумма(ВТПособие.Пособия) как Пособия,
														|	ВТПособие.ПериодДействияНачало,
														|	ВТПособие.ПериодВзаиморасчетов,
														|	Сумма(ВТПособие.Выплаты) как Выплаты,
														|	ВТПособие.ПериодДействияКонец,
														|	ВТПособие.ПериодДействияНачало1   
														|	ИЗ ВТДанныеОПособии"+Строка(Месяц(СтанетМесяц))+" как ВТПособие
														|	ГДЕ ВТПособие.Сотрудник = &Сотрудник 						
														|	СГРУППИРОВАТЬ ПО
														|	ВТПособие.ПериодДействияНачало,
														|	ВТПособие.ПериодВзаиморасчетов,
														|	ВТПособие.ПериодДействияКонец,
														|	ВТПособие.ПериодДействияНачало1
														|УПОРЯДОЧИТЬ ПО
														|	ПериодДействияНачало";  
														
														РезЗапросПособие1 = ЗапросПособие1.Выполнить().Выбрать();
														
														СумПособияПосле = 0;
														ДН = Дата(1,1,1);
														ДК = Дата(1,1,1);
														Пока РезЗапросПособие1.Следующий() Цикл 
															Если РезЗапросПособие1.Пособия > 0 Тогда
																СумПособияПосле = СумПособияПосле + РезЗапросПособие1.Пособия;
																ДН = ?(ДН=Дата(1,1,1),РезЗапросПособие1.ПериодДействияНачало,МИН(ДН,РезЗапросПособие1.ПериодДействияНачало));
																ДК = ?(ДК=Дата(1,1,1),РезЗапросПособие1.ПериодДействияКонец,МАКС(ДК,РезЗапросПособие1.ПериодДействияКонец));
															КонецЕсли;
														КонецЦикла;
														
														Если СумПособияПосле > 0 Тогда
															СтрокаПособие = СведенияОСтаже.Добавить();
															СтрокаПособие.Договор = ВыборкаПоДоговорам.Договор;
															СтрокаПособие.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
															СтрокаПособие.Категория = ВыборкаПоДоговорам.Категория;
															СтрокаПособие.ВидДеятельности = ВремНетрудДляПУ3;
															СтрокаПособие.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
															СтрокаПособие.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
															СтрокаПособие.ДатаНачалаРабот = ДН;
															СтрокаПособие.ДатаОкончанияРабот = ДК;
														КонецЕсли;
													КонецЦикла;
												КонецЕсли;
												//СВЭЙ 28.08.2023 КВВ СВФР-011258 (пункт 2) )
												
												//Аверсон ЕАЕ 08.12.2021 СВФР-008384
											ИначеЕсли ДатаУвольнения < РезЗапросПособие.ПериодДействияНачало И ДатаУвольнения <> Дата(1,1,1) Тогда
												СтрокаПособие = СведенияОСтаже.Добавить();
												если не ВыборкаПоДоговорам.Договор = 1 Тогда
													СтрокаПособие.Договор = ВыборкаПоДоговорам.Договор;
													СтрокаПособие.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
												КонецЕсли;
												
												СтрокаПособие.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
												СтрокаПособие.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
												если ДатаПриема <> Дата(1,1,1) и Год(ДатаПриема) = Год(РезЗапросПособие.ПериодДействияНачало) и Месяц(ДатаПриема) = Месяц(РезЗапросПособие.ПериодДействияНачало) и День(ДатаПриема) > День(РезЗапросПособие.ПериодДействияНачало) Тогда 
													СтрокаПособие.ДатаНачалаРабот = ДатаПриема;
												ИначеЕсли СчКол > 1 Тогда 
													СтрокаПособие.ДатаНачалаРабот = ДатаПриема;
												иначе
													
													СтрокаПособие.ДатаНачалаРабот = РезЗапросПособие.ПериодДействияНачало;
												КонецЕсли;
												СтрокаПособие.ДатаОкончанияРабот = РезЗапросПособие.ПериодДействияКонец;
												
												Если ЗначениеЗаполнено( СтрокаПособие.Договор ) И ЗначениеЗаполнено( СтрокаПособие.Договор.ДатаОкончания ) Тогда
													
													Если Год( СтрокаПособие.ДатаОкончанияРабот ) =  Год( СтрокаПособие.Договор.ДатаОкончания ) 
														И Месяц( СтрокаПособие.ДатаОкончанияРабот ) =  Месяц( СтрокаПособие.Договор.ДатаОкончания ) Тогда
														СтрокаПособие.ДатаОкончанияРабот = Мин( СтрокаПособие.ДатаОкончанияРабот, СтрокаПособие.Договор.ДатаОкончания );	
													КонецЕсли; 
													
												КонецЕсли; 
												
												СтрокаПособие.ВидДеятельности = ВремНетрудДляПУ3;
												
												СтокаПрошлая = СтрокаПособие.ДатаОкончанияРабот;
												ПрошлДатаНач1 =СтрокаПособие.ДатаНачалаРабот;
												ПрошлДатаКон1 =СтрокаПособие.ДатаОкончанияРабот;
												//Аверсон СВФР-008384
											КонецЕсли;
											
										КонецЕсли; // НачалоДня(СтокаПрошлая+86400) = НачалоДня(РезЗапросПособие.ПериодДействияНачало)
									КонецЕсли; // НайденныеСтрокиПособие.Количество() = 0
								КонецЕсли;
								
							КонецЕсли;
							
						КонецЦикла;
						//если ПрошлДатаКон1 <> "" Тогда 
						//	если КонецДня(ПрошлДатаКон1) < КонецМесяца(ВыборкаПоДоговорам.Месяц) Тогда
						//		СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата.Добавить();
						//		СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоДня(ПрошлДатаКон1+86400);
						//		СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецМесяца(ВыборкаПоДоговорам.Месяц);
						//	КонецЕсли;
						//КонецЕсли;
						
						
						
						
					КонецЕсли;
					
					
					Если ЗначениеЗаполнено(ВыборкаПоДоговорам.Договор)  Тогда
						//если ВыборкаПоДоговорам.ВидРасчетаОклад = 1 или ВыборкаПоДоговорам.ВидРасчетаОклад = null Тогда 
						если не ВыборкаПоДоговорам.Договор = 1 Тогда
							если ОбъединятьОсновные и ВыборкаПоДоговорам.Договор = 1 Тогда
								Если НайденныеСтроки.Количество() > 0 Тогда
									СтруктураПоиска1.Сотрудник = НайденныеСтроки[0].Сотрудник;
									СтруктураПоиска1.ФизЛицо = НайденныеСтроки[0].ФизЛицо;
								иначе
									СтруктураПоиска1.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
									СтруктураПоиска1.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
								КонецЕсли;
							иначе
								СтруктураПоиска1.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
								СтруктураПоиска1.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
							КонецЕсли;
							СтруктураПоиска1.Категория = ВыборкаПоДоговорам.Категория;
							
							СтруктураПоиска1.Договор = ВыборкаПоДоговорам.Договор;
							СтруктураПоиска1.ДатаНачалаРабот = ВыборкаПоДоговорам.Договор.ДатаНачала;
							СтруктураПоиска1.ДатаОкончанияРабот = ВыборкаПоДоговорам.Договор.ДатаОкончания;
							
							
							
							ЗапроcПроверкаДоговоров = Новый Запрос;
							ЗапроcПроверкаДоговоров.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
							ЗапроcПроверкаДоговоров.Текст = 
							"ВЫБРАТЬ
							|	СведенияОСтаже.ФизЛицо
							|	ПОМЕСТИТЬ ВТСведОСтаже
							|	ИЗ &СведенияОСтаже КАК СведенияОСтаже
							|	ГДЕ СведенияОСтаже.Сотрудник = &Сотрудник
							|	И СведенияОСтаже.Категория = &Категория
							|	И СведенияОСтаже.Договор = &Договор
							|	И СведенияОСтаже.ВидДеятельности = &ВидДеятельности
							|	И СведенияОСтаже.ДатаНачалаРабот между &ДатаНачалаРабот и &ДатаОкончанияРабот";
							ЗапроcПроверкаДоговоров.УстановитьПараметр("Сотрудник",СтруктураПоиска1.Сотрудник);
							ЗапроcПроверкаДоговоров.УстановитьПараметр("Категория",СтруктураПоиска1.Категория);
							ЗапроcПроверкаДоговоров.УстановитьПараметр("Договор",СтруктураПоиска1.Договор);
							ЗапроcПроверкаДоговоров.УстановитьПараметр("ДатаНачалаРабот",СтруктураПоиска1.ДатаНачалаРабот);
							ЗапроcПроверкаДоговоров.УстановитьПараметр("ДатаОкончанияРабот",СтруктураПоиска1.ДатаОкончанияРабот);
							ЗапроcПроверкаДоговоров.УстановитьПараметр("СведенияОСтаже",СведенияОСтаже);
							ЗапроcПроверкаДоговоров.УстановитьПараметр("ВидДеятельности",Договор); //О.Т. Аверсон 24.04.2019 № 4289
							
							ЗапроcПроверкаДоговоров.Выполнить();
							ЗапроcПроверкаДоговоров.Текст = 
							"ВЫБРАТЬ
							|	СведенияОСтаже.ФизЛицо
							|	ИЗ ВТСведОСтаже КАК СведенияОСтаже"; 						
							НайденныеСтрокиСтажа = ЗапроcПроверкаДоговоров.Выполнить().Выгрузить();
							
							
							//НайденныеСтрокиСтажа =  СведенияОСтаже.НайтиСтроки(СтруктураПоиска1);
							Если НайденныеСтрокиСтажа.Количество() = 0 Тогда
								если ТипЗнч(ВыборкаПоДоговорам.Договор) = Тип("ДокументСсылка.ДоговорНаВыполнениеРаботСФизЛицом") Тогда 
									если ВсеСотрудники или ДогПодряда Тогда 
										СтрокаСтажа = СведенияОСтаже.Добавить();
										ЗаполнитьЗначенияСвойств(СтрокаСтажа,ВыборкаПоДоговорам);
										СтрокаСтажа.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
										
										если не ВыборкаПоДоговорам.Договор = 1 Тогда 
											СтрокаСтажа.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
										Иначе 
											СтрокаСтажа.ВидДоговора =  Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
											
										КонецЕсли;
										СтрокаСтажа.ДатаНачалаРабот = ВыборкаПоДоговорам.Договор.ДатаНачала;
										СтрокаСтажа.ДатаОкончанияРабот = ВыборкаПоДоговорам.Договор.ДатаОкончания;
										СтрокаСтажа.ВидДеятельности = Договор;
										//О.Т. Аверсон 04.04.2019 № 4187
										Если Год(ВыборкаПоДоговорам.Договор.ДатаНачала) < Год(ВыборкаПоДоговорам.Месяц) Тогда 
											ЗаписьГод =Год(ВыборкаПоДоговорам.Договор.ДатаНачала); 
											Пока ЗаписьГод<Год(ВыборкаПоДоговорам.Месяц) Цикл  
												СтрокаСтажа1 = СведенияОСтаже.Добавить();
												ЗаполнитьЗначенияСвойств(СтрокаСтажа1,СтрокаСтажа);
												если ЗаписьГод =Год(ВыборкаПоДоговорам.Договор.ДатаНачала) Тогда 
													СтрокаСтажа1.ДатаНачалаРабот = ВыборкаПоДоговорам.Договор.ДатаНачала;
												Иначе
													СтрокаСтажа1.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
												КонецЕсли;
												СтрокаСтажа1.ДатаОкончанияРабот = Дата(ЗаписьГод,12,31);
												СтрокаСтажа1.ВидДеятельности = Договор;
												СтрокаСтажа1.Категория = ВыборкаПоДоговорам.Категория;
												
												ЗаписьГод = ЗаписьГод+1;
											КонецЦикла;
											СтрокаСтажа.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
										КонецЕсли;													
										//О.Т. Аверсон 04.04.2019 № 4187
									КонецЕсли;
								иначе
									
									СтрокаСтажа = СведенияОСтаже.Добавить();
									ЗаполнитьЗначенияСвойств(СтрокаСтажа,ВыборкаПоДоговорам);
									СтрокаСтажа.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
									если не ВыборкаПоДоговорам.Договор = 1 Тогда 
										СтрокаСтажа.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
									Иначе 
										СтрокаСтажа.ВидДоговора =  Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
										
									КонецЕсли;
									СтрокаСтажа.ДатаНачалаРабот = ВыборкаПоДоговорам.Договор.ДатаНачала;
									СтрокаСтажа.ДатаОкончанияРабот = ВыборкаПоДоговорам.Договор.ДатаОкончания;
									СтрокаСтажа.ВидДеятельности = Договор;
									//О.Т. Аверсон 04.04.2019 № 4187
									Если Год(ВыборкаПоДоговорам.Договор.ДатаНачала) < Год(ВыборкаПоДоговорам.Месяц) Тогда 
										ЗаписьГод =Год(ВыборкаПоДоговорам.Договор.ДатаНачала); 
										Пока ЗаписьГод<Год(ВыборкаПоДоговорам.Месяц) Цикл  
											СтрокаСтажа1 = СведенияОСтаже.Добавить();
											ЗаполнитьЗначенияСвойств(СтрокаСтажа1,СтрокаСтажа);
											если ЗаписьГод =Год(ВыборкаПоДоговорам.Договор.ДатаНачала) Тогда 
												СтрокаСтажа1.ДатаНачалаРабот = ВыборкаПоДоговорам.Договор.ДатаНачала;
											Иначе
												СтрокаСтажа1.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
											КонецЕсли;
											СтрокаСтажа1.ДатаОкончанияРабот = Дата(ЗаписьГод,12,31);
											СтрокаСтажа1.ВидДеятельности = Договор;
											СтрокаСтажа1.Категория = ВыборкаПоДоговорам.Категория;
											
											ЗаписьГод = ЗаписьГод+1;
										КонецЦикла;
										СтрокаСтажа.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
									КонецЕсли;													
									//О.Т. Аверсон 04.04.2019 № 4187
								КонецЕсли;
							КонецЕсли;
							
							
						КонецЕсли;
					КонецЕсли;
					
					//Если ВыборкаПоДоговорам.Договор=1  Тогда
					если ВыборкаПоДоговорам.Выплаты > 0 Тогда 
						ЗапросИскл = Новый Запрос;
						ЗапросИскл.Текст = 
						"ВЫБРАТЬ
						|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
						|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
						|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ПериодДействияНачало,
						|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ПериодДействияКонец
						|ИЗ
						|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
						|ГДЕ
						|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия МЕЖДУ &ПериодДействия И &ПериодДействия1
						|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
						|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
						|
						|УПОРЯДОЧИТЬ ПО
						|	ПериодДействияНачало";
						ВидыРасчета = Новый СписокЗначений;
						ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
						ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыПоТКРФ);
						ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.РождениеРебенка);//О.Т. Аверсон 16.08.2018 № 2307
						ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СмертьБлизкогоРодственника);//О.Т. Аверсон 16.08.2018 № 2307
						//О.Т. Аверсон 17.02.2016 № 884
						ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Невыход);
						ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул);
						//О.Т. Аверсон 17.02.2016 № 884
						
						//ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛЛиквидаторамЧАЭС);
						//ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеВБыту);
						//ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуБЛ);
						ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоБеременностиИРодам);
						ВидыРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве);//О.Т. Аверсон 18.05.2018 № 1985
						
						//Аверсон ЕАЕ 10.11.2021 СВФР-008288
						МассивИсключений = ПолучитьСписокИсключений();
						Для Каждого Эл Из МассивИсключений Цикл
							Если ВидыРасчета.НайтиПоЗначению(Эл) = Неопределено Тогда
								ВидыРасчета.Добавить(Эл);	
							КонецЕсли;
						КонецЦикла;
						//Аверсон СВФР-008288
						
						ЗапросИскл.УстановитьПараметр("ВидРасчета", ВидыРасчета);
						ЗапросИскл.УстановитьПараметр("ПериодДействия", НачалоМесяца(ВыборкаПоДоговорам.Месяц));
						ЗапросИскл.УстановитьПараметр("ПериодДействия1", КонецМесяца(ВыборкаПоДоговорам.Месяц));
						ЗапросИскл.УстановитьПараметр("Сотрудник", ВыборкаПоДоговорам.Сотрудник);
						
						РезультатИсклТЗ = ЗапросИскл.Выполнить().Выгрузить();
						МесяцНачало = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						МесяцКонец = КонецМесяца(ВыборкаПоДоговорам.Месяц);
						ДобавлениеСтрокДата1 = Новый ТаблицаЗначений;
						ДобавлениеСтрокДата1.Колонки.Добавить("ДатаНачала");
						ДобавлениеСтрокДата1.Колонки.Добавить("ДатаОкончания");
						ДобавлениеСтрокДата1.Колонки.Добавить("Травма");//О.Т. Аверсон 18.05.2018 № 1985
						
						ПрошлДатаНач2 = "";
						ПрошлДатаКон2 = "";
						ПрошлДействиеКонец1 = "";
						ПрошлДействиеКонец = "";
						СчИскл = 1;
						ТаблицаОбщаяяИскл = Новый ТаблицаЗначений;
						ТаблицаОбщаяяИскл.Колонки.Добавить("ПериодДействияНачало");
						ТаблицаОбщаяяИскл.Колонки.Добавить("ПериодДействияКонец");
						
						Для Каждого  РезультатИскл из РезультатИсклТЗ Цикл
							СтрДата = РезультатИскл.ПериодДействияНачало;
							Пока СтрДата <= РезультатИскл.ПериодДействияКонец Цикл
								СтрТаблицаОбщаяяИскл = ТаблицаОбщаяяИскл.Добавить();
								СтрТаблицаОбщаяяИскл.ПериодДействияНачало = СтрДата;
								СтрТаблицаОбщаяяИскл.ПериодДействияКонец = КонецДня(СтрДата);
								СтрДата = СтрДата+86400;
							КонецЦикла; 
						КонецЦикла;
						Для Каждого  РезультатИскл из ДобавлениеСтрокДата Цикл
							СтрДата = РезультатИскл.ДатаНачала;
							Пока СтрДата <= РезультатИскл.ДатаОкончания Цикл
								СтрТаблицаОбщаяяИскл = ТаблицаОбщаяяИскл.Добавить();
								СтрТаблицаОбщаяяИскл.ПериодДействияНачало = СтрДата;
								СтрТаблицаОбщаяяИскл.ПериодДействияКонец = КонецДня(СтрДата);
								СтрДата = СтрДата +86400;
							КонецЦикла; 
						КонецЦикла;
						ТаблицаОбщаяяИскл.Сортировать("ПериодДействияНачало");
						ТаблицаОбщаяяИскл.Свернуть("ПериодДействияНачало,ПериодДействияКонец");
						Первый = Истина;
						для Каждого стрДобавлениеСтрок из ТаблицаОбщаяяИскл Цикл 
							
							если Первый Тогда
								если стрДобавлениеСтрок.ПериодДействияНачало > НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда
									
									//Аверсон ЕАЕ 10.01.2025 СВФР-014027
									//Учтем дату приема
									
									//СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
									//Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда //О.Т. Аверсон 22.08.2018 № 2335
									//	Если стрДобавлениеСтрок.ПериодДействияНачало > ВыборкаПоДоговорам.Договор.ДатаНачала Тогда
									//		СтрокаДобавлениеСтрокДата1.ДатаНачала = ВыборкаПоДоговорам.Договор.ДатаНачала;
									//	иначе
									//		СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
									//	КонецЕсли;
									//иначе
									//	СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
									//КонецЕсли;
									//СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ПериодДействияНачало-86400);
									//СтрокаДобавлениеСтрокДата1.Травма = 0;
									
									Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда
										Если стрДобавлениеСтрок.ПериодДействияНачало > ВыборкаПоДоговорам.Договор.ДатаНачала Тогда
											Нач = ВыборкаПоДоговорам.Договор.ДатаНачала;
										Иначе
											Нач = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
										КонецЕсли;
									Иначе
										Нач = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
									КонецЕсли;
									Кон = КонецДня(стрДобавлениеСтрок.ПериодДействияНачало - 86400);
									
									Если ДатаПриема <= Нач Тогда
										СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
										СтрокаДобавлениеСтрокДата1.ДатаНачала    = Нач;
										СтрокаДобавлениеСтрокДата1.ДатаОкончания = Кон;
										СтрокаДобавлениеСтрокДата1.Травма        = 0;
									ИначеЕсли ДатаПриема > Нач И ДатаПриема <= Кон Тогда
										СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
										СтрокаДобавлениеСтрокДата1.ДатаНачала    = ДатаПриема;
										СтрокаДобавлениеСтрокДата1.ДатаОкончания = Кон;
										СтрокаДобавлениеСтрокДата1.Травма        = 0;
									Иначе //ДатаПриема > Кон 
										//Не добавляем
									КонецЕсли;
									//Аверсон СВФР-014027

								КонецЕсли;
								ПрошлДействиеКонец1 = стрДобавлениеСтрок.ПериодДействияКонец;
							иначе
								если НачалоДня(ПрошлДействиеКонец1+86400)<> стрДобавлениеСтрок.ПериодДействияНачало Тогда
									СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
									СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
									СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ПериодДействияНачало-86400);
									СтрокаДобавлениеСтрокДата1.Травма = 0;
								КонецЕсли;
								ПрошлДействиеКонец1 = стрДобавлениеСтрок.ПериодДействияКонец;
								
								
							КонецЕсли;
							Первый = Ложь;
							
						КонецЦикла;
						//О.Т. Аверсон 18.05.2018 № 1985
						МассивРезультатИсклТЗ = РезультатИсклТЗ.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)); 
						Для Каждого стр из МассивРезультатИсклТЗ Цикл 
							СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();	
							СтрокаДобавлениеСтрокДата1.ДатаНачала = стр.ПериодДействияНачало;
							СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стр.ПериодДействияКонец);
							СтрокаДобавлениеСтрокДата1.Травма = 1;
						КонецЦикла;
						ДобавлениеСтрокДата1.Сортировать("ДатаНачала");
						//О.Т. Аверсон 18.05.2018 № 1985
						
						//СВЭЙ 17.10.2023 КВВ СВФР-011630 (
						З = Новый Запрос;
						З.Текст = "ВЫБРАТЬ 
						|БЛ.ДатаНачала,
						|БЛ.ДатаОкончания
						|ИЗ Документ.НачислениеПоБольничномуЛисту КАК БЛ
						|ГДЕ БЛ.Ссылка.Проведен = ИСТИНА
						|И БЛ.Организация = &Организация
						|И БЛ.Сотрудник = &Сотрудник
						|И БЛ.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)";
						З.УстановитьПараметр("Сотрудник",ВыборкаПоДоговорам.Сотрудник);
						З.УстановитьПараметр("Организация",Организация);
						РезЗ = З.Выполнить().Выгрузить();
						Если РезЗ.Количество() > 0 Тогда
							Для Каждого СтрЗ Из РезЗ Цикл
								Если СтрЗ.ДатаОкончания < ДатаНачала ИЛИ СтрЗ.ДатаНачала > ДатаОкончания Тогда
									Продолжить;
								КонецЕсли;
								Если СтрЗ.ДатаНачала < ДатаНачала Тогда
									СтрЗ.ДатаНачала = ДатаНачала;
								КонецЕсли;
								ИзТЗ = ДобавлениеСтрокДата1.НайтиСтроки(Новый Структура("ДатаНачала,ДатаОкончания",СтрЗ.ДатаНачала,КонецДня(СтрЗ.ДатаОкончания)));
								Если ИзТЗ.Количество() = 0 Тогда
									СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();	
									СтрокаДобавлениеСтрокДата1.ДатаНачала = СтрЗ.ДатаНачала;
									СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(СтрЗ.ДатаОкончания);
									СтрокаДобавлениеСтрокДата1.Травма = 1;
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
						//СВЭЙ 17.10.2023 КВВ СВФР-011630 )
						
						
						//	для Каждого стрДобавлениеСтрок из ДобавлениеСтрокДата Цикл 
						//		ДобавлятьНеНадо = Ложь;
						//		если РезультатИскл.ПериодДействияНачало < стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияКонец < стрДобавлениеСтрок.ДатаОкончания Тогда 
						//			
						//			если Первый Тогда
						//				если РезультатИскл.ПериодДействияНачало > НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();	
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(РезультатИскл.ПериодДействияНачало-86400);
						//					
						//				КонецЕсли;
						//				ПрошлДействиеКонец1 = РезультатИскл.ПериодДействияКонец;
						//				если НачалоДня(ПрошлДействиеКонец1+86400)<> стрДобавлениеСтрок.ДатаНачала Тогда
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();	
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
						//					
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//				КонецЕсли;
						//				ПрошлДействиеКонец1 = стрДобавлениеСтрок.ДатаОкончания;
						//			иначе
						//				если НачалоДня(ПрошлДействиеКонец1+86400)<> стрДобавлениеСтрок.ДатаНачала Тогда
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//				КонецЕсли;
						//				ПрошлДействиеКонец1 = стрДобавлениеСтрок.ДатаОкончания;
						//			КонецЕсли; 
						//			
						//			
						//		КонецЕсли;
						//		если РезультатИскл.ПериодДействияНачало > стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияНачало >= стрДобавлениеСтрок.ДатаОкончания Тогда
						//			
						//			если Первый  Тогда
						//				если стрДобавлениеСтрок.ДатаНачала > НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//					
						//				КонецЕсли;
						//				ПрошлДействиеКонец1 = стрДобавлениеСтрок.ДатаОкончания;
						//				
						//				стрДобавлениеСтрокСлед = ДобавлениеСтрокДата[Мин(СчИскл,ДобавлениеСтрокДата.Количество()-1)];
						//				если РезультатИскл.ПериодДействияНачало > стрДобавлениеСтрокСлед.ДатаНачала Тогда 
						//					
						//				иначе
						//					если НачалоДня(ПрошлДействиеКонец1+86400)<> РезультатИскл.ПериодДействияНачало Тогда 
						//						СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//						СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
						//						СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(РезультатИскл.ПериодДействияНачало-86400);
						//					КонецЕсли;
						//					ПрошлДействиеКонец1 = РезультатИскл.ПериодДействияКонец;
						//				КонецЕсли;
						//				
						//			иначе
						//				если НачалоДня(ПрошлДействиеКонец1+86400)<> стрДобавлениеСтрок.ДатаНачала Тогда
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//				КонецЕсли;
						//				ПрошлДействиеКонец1 = стрДобавлениеСтрок.ДатаОкончания;
						//			КонецЕсли; 
						//			
						//		КонецЕсли;
						//		
						//		если РезультатИскл.ПериодДействияНачало >= стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияНачало <= стрДобавлениеСтрок.ДатаОкончания Тогда
						//			
						//			если Первый  Тогда 
						//				если стрДобавлениеСтрок.ДатаНачала > НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//				КонецЕсли;
						//			иначе
						//				если НачалоДня(ПрошлДействиеКонец1+86400)<> стрДобавлениеСтрок.ДатаНачала Тогда
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//				КонецЕсли;
						//			КонецЕсли;
						//			ПрошлДействиеКонец1 = стрДобавлениеСтрок.ДатаОкончания;
						//			
						//		КонецЕсли;
						//		
						//		
						//		если РезультатИскл.ПериодДействияНачало < стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияКонец > стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияКонец <= стрДобавлениеСтрок.ДатаОкончания Тогда
						//			если Первый  Тогда
						//				если РезультатИскл.ПериодДействияНачало > НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(РезультатИскл.ПериодДействияНачало-86400);
						//				КонецЕсли;
						//			иначе
						//				если НачалоДня(ПрошлДействиеКонец1+86400)<> РезультатИскл.ПериодДействияНачало Тогда
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(РезультатИскл.ПериодДействияНачало-86400);
						//				КонецЕсли;
						//			КонецЕсли;
						//			ПрошлДействиеКонец1 = РезультатИскл.ПериодДействияКонец;
						//		КонецЕсли;
						//		
						//		если РезультатИскл.ПериодДействияНачало >= стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияНачало < стрДобавлениеСтрок.ДатаОкончания и РезультатИскл.ПериодДействияКонец > стрДобавлениеСтрок.ДатаОкончания Тогда
						//			если Первый  Тогда
						//				если стрДобавлениеСтрок.ДатаНачала > НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//				КонецЕсли;
						//				
						//			иначе
						//				если НачалоДня(ПрошлДействиеКонец1+86400)<> стрДобавлениеСтрок.ДатаНачала Тогда
						//					СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
						//					СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
						//					СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//				КонецЕсли;
						//			КонецЕсли;
						//			ПрошлДействиеКонец1 = стрДобавлениеСтрок.ДатаОкончания;
						//		КонецЕсли;
						//		
						//		
						//		
						//		
						//		
						//		
						//		
						//		
						//		//если РезультатИскл.ПериодДействияНачало > стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияНачало<стрДобавлениеСтрок.ДатаОкончания тогда 
						//		//	СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();  
						//		//	если Первый Тогда
						//		//		СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//		//	иначе
						//		//		СтрокаДобавлениеСтрокДата1.ДатаНачала = стрДобавлениеСтрок.ДатаНачала;
						//		//	КонецЕсли;
						//		//	СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(РезультатИскл.ПериодДействияНачало-86400);
						//		//	ДобавлятьНеНадо = Истина;
						//		//	ПрошлДействиеКонец1 = СтрокаДобавлениеСтрокДата1.ДатаОкончания;
						//		//КонецЕсли;
						//		//если РезультатИскл.ПериодДействияКонец < стрДобавлениеСтрок.ДатаОкончания и РезультатИскл.ПериодДействияНачало > стрДобавлениеСтрок.ДатаНачала  тогда //и РезультатИсклТЗ[Мин(СчИскл,РезультатИсклТЗ.Количество()-1)].ПериодДействияНачало > стрДобавлениеСтрок.ДатаОкончания
						//		//	СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();  
						//		//	СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(РезультатИскл.ПериодДействияКонец+86400);
						//		//	СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаОкончания);
						//		//	ДобавлятьНеНадо = Истина;
						//		//	ПрошлДействиеКонец1 = СтрокаДобавлениеСтрокДата1.ДатаОкончания;
						//		//КонецЕсли;
						//		////если РезультатИсклТЗ[Мин(СчИскл,РезультатИсклТЗ.Количество()-1)].ПериодДействияНачало < стрДобавлениеСтрок.ДатаОкончания тогда
						//		////	ДобавлятьНеНадо = Истина;
						//		////КонецЕсли;
						//		//
						//		////Если РезультатИскл.ПериодДействияКонец > стрДобавлениеСтрок.ДатаНачала и не РезультатИскл.ПериодДействияКонец > стрДобавлениеСтрок.ДатаОкончания и не Первый тогда
						//		////	СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();  
						//		////	СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(РезультатИскл.ПериодДействияКонец);
						//		////	СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаОкончания);
						//		////	
						//		////КонецЕсли;
						//		//если (РезультатИскл.ПериодДействияНачало > стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияНачало > стрДобавлениеСтрок.ДатаОкончания и
						//		//	РезультатИскл.ПериодДействияКонец > стрДобавлениеСтрок.ДатаНачала и РезультатИскл.ПериодДействияКонец > стрДобавлениеСтрок.ДатаОкончания) или
						//		//	РезультатИскл.ПериодДействияНачало > стрДобавлениеСтрок.ДатаОкончания или РезультатИскл.ПериодДействияНачало < стрДобавлениеСтрок.ДатаНачала Тогда 
						//		//	если не ДобавлятьНеНадо Тогда 
						//		//		если Первый и стрДобавлениеСтрок.ДатаНачала > НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда
						//		//			СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить(); 
						//		//			
						//		//			СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//		//			
						//		//			
						//		//			
						//		//			СтрокаДобавлениеСтрокДата1.ДатаНачала = стрДобавлениеСтрок.ДатаНачала;
						//		//			СтрокаДобавлениеСтрокДата1.ДатаОкончания = стрДобавлениеСтрок.ДатаОкончания;
						//		//			ПрошлДействиеКонец1 = СтрокаДобавлениеСтрокДата1.ДатаОкончания;
						//		//		иначе
						//		//			Первый = Ложь;
						//		//		КонецЕсли;
						//		//	КонецЕсли;
						//		//	
						//		//иначе
						//		//	Первый = Ложь;
						//		//	
						//		//КонецЕсли;
						//		
						//		Первый = Ложь;
						//		
						//		СчИскл = СчИскл + 1;
						//		
						//		
						//	КонецЦикла;
						//	
						//	
						//	если ДобавлениеСтрокДата.Количество() = 0 Тогда 
						//		если РезультатИскл.ПериодДействияНачало > НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ПрошлДатаНач2 = "" Тогда 
						//			//если НачалоДня(ПрошлДатаКон+86400) = НачалоДня(РезЗапросПособие.ПериодДействияНачало) Тогда
						//			//	//СтрокаДобавлениеСтрокДата.ДатаОкончания = РезЗапросПособие.ПериодДействияКонец;
						//			//	ПрошлДатаКон =РезЗапросПособие.ПериодДействияКонец;
						//			//иначе
						//			СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата1.Добавить();
						//			СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//			СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецДня(РезультатИскл.ПериодДействияНачало-86400);
						//			ПрошлДатаКон2 =СтрокаДобавлениеСтрокДата.ДатаОкончания; 
						//			ПрошлДатаНач2 =СтрокаДобавлениеСтрокДата.ДатаНачала; 
						//			//КонецЕсли;
						//			
						//		ИначеЕсли ПрошлДатаНач2 <> "" Тогда 
						//			если НачалоДня(ПрошлДатаКон2+86400) = НачалоДня(РезультатИскл.ПериодДействияНачало) Тогда
						//				//СтрокаДобавлениеСтрокДата.ДатаОкончания = РезЗапросПособие.ПериодДействияКонец;
						//				ПрошлДатаКон2 =РезультатИскл.ПериодДействияКонец;
						//			иначе
						//				
						//				если ПрошлДатаКон2 <> "" Тогда 
						//					если не НачалоДня(ПрошлДействиеКонец+86400) = РезЗапросПособие.ПериодДействияНачало Тогда  
						//						СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата1.Добавить();
						//						СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоДня(ПрошлДействиеКонец+86400);
						//						СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецДня(РезультатИскл.ПериодДействияНачало-86400); 
						//					КонецЕсли;
						//				КонецЕсли;
						//				ПрошлДатаКон2 =СтрокаДобавлениеСтрокДата.ДатаОкончания; 
						//				ПрошлДатаНач2 =СтрокаДобавлениеСтрокДата.ДатаНачала; 
						//			КонецЕсли;
						//			
						//		КонецЕсли;
						//		ПрошлДействиеКонец = РезультатИскл.ПериодДействияКонец;
						//	КонецЕсли;
						//	
						//	СчИскл = СчИскл+1;		
						//КонецЦикла;
						если ТаблицаОбщаяяИскл.Количество() > 0 Тогда
							если КонецДня(ПрошлДействиеКонец1) < КонецМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
								
								Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда //О.Т. Аверсон 22.08.2018 № 2335
									
									если КонецМесяца(ВыборкаПоДоговорам.Месяц) > ВыборкаПоДоговорам.Договор.ДатаОкончания  Тогда
										Если ВыборкаПоДоговорам.Договор.ДатаОкончания > ПрошлДействиеКонец1 Тогда 
											СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
											СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
											СтрокаДобавлениеСтрокДата1.ДатаОкончания = ВыборкаПоДоговорам.Договор.ДатаОкончания;
											СтрокаДобавлениеСтрокДата1.Травма = 0;
										КонецЕсли;
									иначе
										СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
										СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
										СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецМесяца(ВыборкаПоДоговорам.Месяц);
										СтрокаДобавлениеСтрокДата1.Травма = 0;
									КонецЕсли;
								иначе
									СтрокаДобавлениеСтрокДата1 = ДобавлениеСтрокДата1.Добавить();
									СтрокаДобавлениеСтрокДата1.ДатаНачала = НачалоДня(ПрошлДействиеКонец1+86400);
									СтрокаДобавлениеСтрокДата1.ДатаОкончания = КонецМесяца(ВыборкаПоДоговорам.Месяц);
									СтрокаДобавлениеСтрокДата1.Травма = 0;
								КонецЕсли;
								
							КонецЕсли;
							ДобавлениеСтрокДата1.Свернуть("ДатаНачала,ДатаОкончания,Травма");
						КонецЕсли;
						
						
						//если РезультатИсклТЗ.Количество() > 0 и ДобавлениеСтрокДата.Количество() = 0 Тогда
						//	если ПрошлДействиеКонец <> "" Тогда 
						//		если КонецДня(ПрошлДействиеКонец) < КонецМесяца(ВыборкаПоДоговорам.Месяц) Тогда
						//			СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата1.Добавить();
						//			СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоДня(ПрошлДействиеКонец+86400);
						//			СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецМесяца(ВыборкаПоДоговорам.Месяц);
						//		КонецЕсли;
						//	КонецЕсли;
						//КонецЕсли;
						//если РезультатИсклТЗ.Количество() = 0 Тогда 
						//	Первый = Истина;
						//	ДатаКонПрошл = "";
						//	для Каждого стрДобавлениеСтрок из ДобавлениеСтрокДата Цикл
						//		если Первый Тогда 
						//			если стрДобавлениеСтрок.ДатаНачала <> НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
						//				СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата1.Добавить();
						//				СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
						//				СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//			КонецЕсли;
						//			ДатаКонПрошл = стрДобавлениеСтрок.ДатаОкончания;
						//		иначе
						//			если НачалоДня(ДатаКонПрошл+86400)<> стрДобавлениеСтрок.ДатаНачала Тогда 
						//				СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата1.Добавить();
						//				СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоДня(ДатаКонПрошл+86400);
						//				СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецДня(стрДобавлениеСтрок.ДатаНачала-86400);
						//			КонецЕсли;
						//			ДатаКонПрошл = стрДобавлениеСтрок.ДатаОкончания;
						//		КонецЕсли;
						//		Первый = Ложь;
						//	КонецЦикла;
						//	если ДобавлениеСтрокДата.Количество()>0 Тогда 
						//		если КонецДня(ДатаКонПрошл) < КонецМесяца(ВыборкаПоДоговорам.Месяц) Тогда
						//			СтрокаДобавлениеСтрокДата = ДобавлениеСтрокДата1.Добавить();
						//			СтрокаДобавлениеСтрокДата.ДатаНачала = НачалоДня(ДатаКонПрошл+86400);
						//			СтрокаДобавлениеСтрокДата.ДатаОкончания = КонецМесяца(ВыборкаПоДоговорам.Месяц);
						//		КонецЕсли;
						//		
						//	КонецЕсли;
						//	
						//КонецЕсли;
						
						
						СчСтрокДата = 0;
						ВзносыДобавлены = Ложь;
						для Каждого стрДобавлениеСтрок из ДобавлениеСтрокДата1 Цикл 
							Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
								Если стрДобавлениеСтрок.ДатаОкончания < ВыборкаПоДоговорам.Договор.ДатаНачала Тогда 
									Продолжить;
								КонецЕсли;
								
							КонецЕсли;
							СтруктураПоискаПособие.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
							СтруктураПоискаПособие.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
							СтруктураПоискаПособие.ДатаНачалаРабот = стрДобавлениеСтрок.ДатаНачала;
							СтруктураПоискаПособие.ДатаОкончанияРабот = НачалоДня(стрДобавлениеСтрок.ДатаОкончания);
							Если стрДобавлениеСтрок.Травма = 1 Тогда //О.Т. Аверсон 18.05.2018 № 1985 
								СтруктураПоискаПособие.ВидДеятельности = СТРАХСЛУЧ;
							иначе
								СтруктураПоискаПособие.ВидДеятельности = ВзносыВрем;
							КонецЕсли;
							НайденныеСтрокиПособие =  СведенияОСтаже.НайтиСтроки(СтруктураПоискаПособие);
							СтруктураПособие = Новый Структура("ВидДеятельности,Сотрудник",Пособие,ВыборкаПоДоговорам.Сотрудник);
							СтрокиПособия = СведенияОСтаже.НайтиСтроки(СтруктураПособие);
							Если НайденныеСтрокиПособие.Количество() = 0 Тогда
								если НачалоДня(СтокаПрошлаяВр+86400) = НачалоДня(стрДобавлениеСтрок.ДатаНачала) и СтокаПрошлаяТравма = стрДобавлениеСтрок.Травма Тогда
									если не (ДатаУвольнения >стрДобавлениеСтрок.ДатаНачала и ДатаУвольнения>стрДобавлениеСтрок.ДатаОкончания) Тогда 
										если ДатаПриема <> Дата(1,1,1) и ДатаПриема > стрДобавлениеСтрок.ДатаНачала и не ДатаПриема > стрДобавлениеСтрок.ДатаОкончания  Тогда 
											если КолПр = 1 Тогда  
												СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
											иначе
												СтрокаВзносыВР = СведенияОСтаже.Добавить();
												если не ВыборкаПоДоговорам.Договор=1 Тогда 
													СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
													СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
												КонецЕсли;
												СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
												СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
												если ДатаПриема <> Дата(1,1,1) и Год(ДатаПриема) = Год(стрДобавлениеСтрок.ДатаНачала) и Месяц(ДатаПриема) = Месяц(стрДобавлениеСтрок.ДатаНачала) и День(ДатаПриема) > День(стрДобавлениеСтрок.ДатаНачала) Тогда 
													СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
												ИначеЕсли СчКол > 1 Тогда 
													СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
												иначе
													СтрокаВзносыВР.ДатаНачалаРабот = стрДобавлениеСтрок.ДатаНачала;
												КонецЕсли;
												
												если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < стрДобавлениеСтрок.ДатаОкончания Тогда 
													СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
												иначе
													СтрокаВзносыВР.ДатаОкончанияРабот = стрДобавлениеСтрок.ДатаОкончания;
												КонецЕсли;
												
												Если стрДобавлениеСтрок.Травма = 1 Тогда //О.Т. Аверсон 18.05.2018 № 1985
													СтрокаВзносыВР.ВидДеятельности = СТРАХСЛУЧ;
												иначе
													СтрокаВзносыВР.ВидДеятельности = ВзносыВрем;
												КонецЕсли;
												
												СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
												
												
											КонецЕсли;
											
										КонецЕсли;
									КонецЕсли;
									
									
									если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < стрДобавлениеСтрок.ДатаОкончания Тогда 
										СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
									иначе
										Если (СтрокаВзносыВР.ВидДеятельности <> Премия) ИЛИ (СтрокаВзносыВР.ВидДеятельности = Премия И НачалоМесяца(СтрокаВзносыВР.ДатаНачалаРабот) = НачалоМесяца(стрДобавлениеСтрок.ДатаОкончания)) Тогда //СВЭЙ 21.01.2024 КВВ СВФР-012080
											СтрокаВзносыВР.ДатаОкончанияРабот = стрДобавлениеСтрок.ДатаОкончания;
											
											//СВЭЙ 21.01.2024 КВВ СВФР-012080 (
										ИначеЕсли (СтрокаВзносыВР.ВидДеятельности = Премия И НачалоМесяца(СтрокаВзносыВР.ДатаНачалаРабот) <> НачалоМесяца(стрДобавлениеСтрок.ДатаОкончания)) Тогда
											СтрокаВзносыВР2 = СведенияОСтаже.Добавить();
											ЗаполнитьЗначенияСвойств(СтрокаВзносыВР2,СтрокаВзносыВР);
											СтрокаВзносыВР2.ВидДеятельности = ВзносыВрем;
											СтрокаВзносыВР2.ДатаНачалаРабот = стрДобавлениеСтрок.ДатаНачала;
											СтрокаВзносыВР2.ДатаОкончанияРабот = стрДобавлениеСтрок.ДатаОкончания; 
										КонецЕсли;
										//СВЭЙ 21.01.2024 КВВ СВФР-012080 )
										
									КонецЕсли;
									
									СтокаПрошлаяВр = СтрокаВзносыВР.ДатаОкончанияРабот;
									СтокаПрошлаяТравма = стрДобавлениеСтрок.Травма;//О.Т. Аверсон 18.05.2018 № 1985
									
									ВзносыДобавлены = Истина;
								иначе
									ЕстьПособие = Ложь;
									для Каждого стрПособие из СтрокиПособия Цикл 
										если НачалоДня(СтокаПрошлаяВр+86400) = стрПособие.ДатаНачалаРабот и СтокаПрошлаяТравма = стрДобавлениеСтрок.Травма Тогда 
											если ВыборкаПоДоговорам.Договор <> 1 Тогда 
												//	ЕстьПособие = Истина;
											КонецЕсли;
										КонецЕсли;
										
									КонецЦикла;
									
									если (ДатаПриема <= стрДобавлениеСтрок.ДатаОкончания или ДатаПриема = Дата(1,1,1)) и (ДатаУвольнения >= стрДобавлениеСтрок.ДатаНачала или ДатаУвольнения = Дата(1,1,1)) Тогда
										если ЕстьПособие Тогда 
											если не (ДатаУвольнения >стрДобавлениеСтрок.ДатаНачала и ДатаУвольнения>стрДобавлениеСтрок.ДатаОкончания) Тогда
												если ДатаПриема <> Дата(1,1,1) и ДатаПриема > стрДобавлениеСтрок.ДатаНачала Тогда 
													если КолПр = 1 Тогда  
														СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
													иначе
														СтрокаВзносыВР = СведенияОСтаже.Добавить();
														если не ВыборкаПоДоговорам.Договор=1 Тогда 
															СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
															СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
														КонецЕсли;
														СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
														СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
														если ДатаПриема <> Дата(1,1,1) и Год(ДатаПриема) = Год(стрДобавлениеСтрок.ДатаНачала) и Месяц(ДатаПриема) = Месяц(стрДобавлениеСтрок.ДатаНачала) и День(ДатаПриема) > День(стрДобавлениеСтрок.ДатаНачала) Тогда 
															СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
														ИначеЕсли СчКол > 1 Тогда 
															СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
														иначе
															СтрокаВзносыВР.ДатаНачалаРабот = стрДобавлениеСтрок.ДатаНачала;
														КонецЕсли;
														
														если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < стрДобавлениеСтрок.ДатаОкончания Тогда 
															СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
														иначе
															СтрокаВзносыВР.ДатаОкончанияРабот = стрДобавлениеСтрок.ДатаОкончания;
														КонецЕсли;
														Если стрДобавлениеСтрок.Травма = 1 Тогда //О.Т. Аверсон 18.05.2018 № 1985
															СтрокаВзносыВР.ВидДеятельности = СТРАХСЛУЧ;
														иначе
															СтрокаВзносыВР.ВидДеятельности = ВзносыВрем;
														КонецЕсли;
														СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
														
													КонецЕсли;
													
												КонецЕсли;
											КонецЕсли;
											
											если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < стрДобавлениеСтрок.ДатаОкончания Тогда 
												СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
											иначе
												СтрокаВзносыВР.ДатаОкончанияРабот = стрДобавлениеСтрок.ДатаОкончания;
											КонецЕсли;
											ВзносыДобавлены = Истина;
										иначе 
											
											//Аверсон ЕАЕ 20.01.2023 СВФР-010135
											СтрОтбора = Новый Структура;
											СтрОтбора.Вставить("ФизЛицо", ВыборкаПоДоговорам.ФизЛицо);
											СтрОтбора.Вставить("Сотрудник", ВыборкаПоДоговорам.Сотрудник);
											СтрОтбора.Вставить("ВидДеятельности", Договор);
											СтрОтбора.Вставить("Договор", ВыборкаПоДоговорам.Договор);
											СтрокиСтажаДоговор = СведенияОСтаже.НайтиСтроки(СтрОтбора);
											Если СтрокиСтажаДоговор.Количество() > 0 Тогда
												СтрокаСтажаДоговор = СтрокиСтажаДоговор[0];
											Иначе
												СтрокаСтажаДоговор = Неопределено;
											КонецЕсли;
											//Аверсон СВФР-010135
											
											СтрокаВзносыВР = СведенияОСтаже.Добавить();
											если не ВыборкаПоДоговорам.Договор=1 Тогда 
												СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
												СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
											КонецЕсли;
											СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
											СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
											если ДатаПриема <> Дата(1,1,1) и Год(ДатаПриема) = Год(стрДобавлениеСтрок.ДатаНачала) и Месяц(ДатаПриема) = Месяц(стрДобавлениеСтрок.ДатаНачала) и День(ДатаПриема) > День(стрДобавлениеСтрок.ДатаНачала) Тогда 
												СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
											ИначеЕсли СчКол > 1 Тогда 
												СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
											иначе
												//+ СВЭЙ КДЯ 01.11.19 СВФР-004631 ( Пункт 58. ) СВФР-004969
												//СтрокаВзносыВР.ДатаНачалаРабот = стрДобавлениеСтрок.ДатаНачала;
												//- СВЭЙ КДЯ 01.11.19 СВФР-004631 ( Пункт 58. ) СВФР-004969
												
												//+ СВЭЙ КДЯ 01.11.19 СВФР-004631 ( Пункт 58. ) СВФР-004969
												СтрокаВзносыВР.ДатаНачалаРабот = ?( ЗначениеЗаполнено( ВыборкаПоДоговорам.Договор ) 
												И ТипЗнч( ВыборкаПоДоговорам.Договор ) = Тип( "ДокументСсылка.ДоговорНаВыполнениеРаботСФизЛицом" )
												
												//Аверсон ЕАЕ 19.01.2023 СВФР-010135
												//И ЗначениеЗаполнено( СтрокаСтажа )
												И ЗначениеЗаполнено(СтрокаСтажаДоговор)
												И СтрокаСтажаДоговор.Договор = ВыборкаПоДоговорам.Договор,
												//СтрокаСтажа.ДатаНачалаРабот,
												СтрокаСтажаДоговор.ДатаНачалаРабот,
												//Аверсон СВФР-010135
												
												//+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
												//стрДобавлениеСтрок.ДатаНачала 
												//- СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
												
												//+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
												?( СчСтрокДата = 0 И ЗначениеЗаполнено( ДатаПриема ) 
												И НачалоМесяца( ДатаПриема ) = НачалоМесяца( стрДобавлениеСтрок.ДатаНачала ) 
												
												//Аверсон ЕАЕ 10.01.2025 СВФР-014027
												//будем заменять дату начала периода на дату приема только в том случае, если дата приема входит в этот период
												И (ДатаПриема >= стрДобавлениеСтрок.ДатаНачала И ДатаПриема <= стрДобавлениеСтрок.ДатаОкончания),
												//Аверсон СВФР-014027
												
												Мин( ДатаПриема, стрДобавлениеСтрок.ДатаНачала ),
												стрДобавлениеСтрок.ДатаНачала
												)
												//- СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
												);
												
											КонецЕсли;
											
											если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < стрДобавлениеСтрок.ДатаОкончания Тогда 
												СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
											иначе
												СтрокаВзносыВР.ДатаОкончанияРабот = стрДобавлениеСтрок.ДатаОкончания;
											КонецЕсли;
											Если стрДобавлениеСтрок.Травма = 1 Тогда //О.Т. Аверсон 18.05.2018 № 1985
												СтрокаВзносыВР.ВидДеятельности = СТРАХСЛУЧ;
											иначе
												СтрокаВзносыВР.ВидДеятельности = ВзносыВрем;
											КонецЕсли;
											СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
										КонецЕсли;   
										ВзносыДобавлены = Истина;
										СтокаПрошлаяВр = СтрокаВзносыВР.ДатаОкончанияРабот;
										СтокаПрошлаяТравма = стрДобавлениеСтрок.Травма;//О.Т. Аверсон 18.05.2018 № 1985
									ИначеЕсли ?(КолПр > 1,ДатаУвольнения >стрДобавлениеСтрок.ДатаНачала,Ложь) Тогда 
										СтрокаВзносыВР = СведенияОСтаже.Добавить();
										если не ВыборкаПоДоговорам.Договор=1 Тогда 
											СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
											СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
										КонецЕсли;
										СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
										СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
										СтрокаВзносыВР.ДатаНачалаРабот = стрДобавлениеСтрок.ДатаНачала;
										СтрокаВзносыВР.ДатаОкончанияРабот = стрДобавлениеСтрок.ДатаОкончания;
										Если стрДобавлениеСтрок.Травма = 1 Тогда //О.Т. Аверсон 18.05.2018 № 1985
											СтрокаВзносыВР.ВидДеятельности = СТРАХСЛУЧ;
										иначе
											СтрокаВзносыВР.ВидДеятельности = ВзносыВрем;
										КонецЕсли;
										СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
										
										СтокаПрошлаяВр = СтрокаВзносыВР.ДатаОкончанияРабот;	
										СтокаПрошлаяТравма = стрДобавлениеСтрок.Травма;//О.Т. Аверсон 18.05.2018 № 1985
										ВзносыДобавлены = Истина;
									иначе
										//+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
										//если не ВзносыДобавлены Тогда 
										//	если ЗначениеЗаполнено( СтрокаВзносыВР.ДатаОкончанияРабот ) Тогда 
										//		если КонецДня(СтрокаВзносыВР.ДатаОкончанияРабот) <> КонецДня(ДатаУвольнения) Тогда 
										//- СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
										//+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
										если не ВзносыДобавлены И ЗначениеЗаполнено( ДатаУвольнения ) Тогда 
											если ЗначениеЗаполнено( СтруктураПоискаПособие.ДатаОкончанияРабот ) Тогда 
												если КонецДня( СтруктураПоискаПособие.ДатаОкончанияРабот ) <> КонецДня( ДатаУвольнения ) Тогда 
													//- СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
													//Если ЗначениеЗаполнено( ДатаУвольнения ) Тогда //+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
													СтрокаВзносыВР = СведенияОСтаже.Добавить();
													если не ВыборкаПоДоговорам.Договор=1 Тогда 
														СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
														СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
													КонецЕсли;
													СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
													СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо; 
													СтрокаВзносыВР.ДатаНачалаРабот = ДатаУвольнения;
													
													//Аверсон 18.05.2020 КВВ СВФР-005940 (
													З = Новый Запрос;
													З.Текст = 
													"ВЫБРАТЬ  
													|СУММА(РАЗНОСТЬДАТ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,ДЕНЬ)+1) КАК КалендарныхДней
													|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
													|ГДЕ ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация
													|И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
													|И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия МЕЖДУ &ПериодДействияН И &ПериодДействияК
													|И (ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.НеоплачиваемыйОтпускПоЗаконодательству)
													|ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ОбозначениеВТабелеУчетаРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.НеоплачиваемыйОтпускПоРазрешениюРаботодателя))";
													З.УстановитьПараметр("Организация",Организация);
													З.УстановитьПараметр("Сотрудник", ВыборкаПоДоговорам.Сотрудник);
													З.УстановитьПараметр("ПериодДействияН", НачалоМесяца(ДатаУвольнения));
													З.УстановитьПараметр("ПериодДействияК", КонецМесяца(ДатаУвольнения));
													РезЗ = З.Выполнить().Выбрать();
													Если РезЗ.Следующий() Тогда
														Если РезЗ.КалендарныхДней = ((НачалоДня(ДатаУвольнения)-НачалоМесяца(ДатаУвольнения))/60/60/24)+1 Тогда
															СтрокаВзносыВР.ДатаНачалаРабот = НачалоМесяца(ДатаУвольнения);
														КонецЕсли;
													КонецЕсли;
													//Аверсон 18.05.2020 КВВ СВФР-005940 )
													
													СтрокаВзносыВР.ДатаОкончанияРабот = КонецДня(ДатаУвольнения);
													СтрокаВзносыВР.ВидДеятельности = Премия;
													//КонецЕсли; //+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
												КонецЕсли;
											иначе // т.е. НЕ ЗначениеЗаполнено( СтруктураПоискаПособие.ДатаОкончанияРабот )
												//если ЗначениеЗаполнено( ДатаУвольнения ) Тогда  //+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
												СтрокаВзносыВР = СведенияОСтаже.Добавить();
												если не ВыборкаПоДоговорам.Договор=1 Тогда 
													СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
													СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
												КонецЕсли;
												СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
												СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
												СтрокаВзносыВР.ДатаНачалаРабот = ДатаУвольнения;
												
												СтрокаВзносыВР.ДатаОкончанияРабот = КонецДня(ДатаУвольнения);
												
												
												СтрокаВзносыВР.ВидДеятельности = Премия;
												//КонецЕсли; //+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
											КонецЕсли;		
										КонецЕсли;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							
							//+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
							//СчСтрокДата = СчСтрокДата+1;
							//- СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
							//+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
							Если ВзносыДобавлены Тогда
								СчСтрокДата = СчСтрокДата + 1;
							КонецЕсли;
							//- СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
							//ПСА 05.07.2019 СВФР-004373 +++
							Если СтрокиПособия.Количество()> 0 И СтрокаВзносыВР.ВидДеятельности = СТРАХСЛУЧ Тогда
								НомерИндексаСтрокиПособия = 0;
								Пока НомерИндексаСтрокиПособия <= СтрокиПособия.Количество()-1 Цикл
									СтрокаПособияПоИндексу = СтрокиПособия[НомерИндексаСтрокиПособия];
									Если СтрокаВзносыВР.ДатаНачалаРабот  = СтрокаПособияПоИндексу.ДатаНачалаРабот 
										И СтрокаВзносыВР.ДатаОкончанияРабот = СтрокаПособияПоИндексу.ДатаОкончанияРабот  Тогда
										СведенияОСтаже.Удалить(СтрокаПособияПоИндексу);
										СтрокиПособия.Удалить(НомерИндексаСтрокиПособия);
									Иначе	
										НомерИндексаСтрокиПособия= НомерИндексаСтрокиПособия + 1;
									КонецЕсли;
								КонецЦикла	
							КонецЕсли;	
							//+++ПСА 05.07.2019 СВФР-004373
						КонецЦикла;
						ВзносыДобавлены = Ложь;
						
						
						//СВЭЙ 29.03.2024 КВВ СВФР-012249 (
						НетЗаписейВТЗ = Истина;
						Если ДобавлениеСтрокДата1.Количество() <> 0 Тогда 
							Если НетЗаписейВТЗ Тогда
								Для Каждого СтрТЗ1 ИЗ ДобавлениеСтрокДата1 Цикл    
									Если НачалоМесяца(СтрТЗ1.ДатаНачала) >= НачалоМесяца(ВыборкаПоДоговорам.Месяц) 
										И НачалоМесяца(СтрТЗ1.ДатаОкончания) <= НачалоМесяца(ВыборкаПоДоговорам.Месяц) Тогда  
										НетЗаписейВТЗ = Ложь;
									КонецЕсли;
								КонецЦикла;	
							КонецЕсли;
						КонецЕсли;
						//если ДобавлениеСтрокДата1.Количество() = 0 Тогда 
						Если НетЗаписейВТЗ Тогда	
							//СВЭЙ 29.03.2024 КВВ СВФР-012249 )
							
							
							//Аверсон 22.05.2020 КВВ СВФР-005940 (
							БылОтпускЗаСвойСчетМесяц = ПроверкаНаОтпускЗаСвойСчетНаЦелыйМесяц(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц);
							Если БылОтпускЗаСвойСчетМесяц Тогда
								СуммаПФиФСЗНМес = ПолучитьСуммуПФиФСЗН(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,Ложь);
								Если СуммаПФиФСЗНМес = 0 Тогда
									Продолжить;
								КонецЕсли;
							КонецЕсли;             
							//Аверсон 22.05.2020 КВВ СВФР-005940 )
							
							//Аверсон 23.07.2020 КВВ СВФР-006298 (
							ТЗРабДн = РабочихДнейЗаМесяц(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц);
							ЕстьРабочиеДниЧасыВМес = ?(ТЗРабДн[0].Часов+ТЗРабДн[0].Дней > 0 ИЛИ НЕ ВыборкаПоДоговорам.Договор = 1,Истина,Ложь);
							//Аверсон 23.07.2020 КВВ СВФР-006298 )
							
							ЕстьПремияДляПУЗаМесяц = ЕстьПремияДляПУЗаМесяц(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц);//Аверсон 22.12.2021 КВВ СВФР-007900
							
							СтруктураПоискаПособие.Сотрудник = ВыборкаПоДоговорам.Сотрудник;	
							СтруктураПоискаПособие.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;							
							СтруктураПоискаПособие.ДатаНачалаРабот = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
							СтруктураПоискаПособие.ДатаОкончанияРабот = НачалоДня(КонецМесяца(ВыборкаПоДоговорам.Месяц));
							СтруктураПоискаПособие.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
							НайденныеСтрокиПособие = СведенияОСтаже.НайтиСтроки(СтруктураПоискаПособие);
							СтруктураПособие = Новый Структура("ВидДеятельности,Сотрудник",Пособие,ВыборкаПоДоговорам.Сотрудник);
							СтрокиПособия = СведенияОСтаже.НайтиСтроки(СтруктураПособие);
							
							Если НайденныеСтрокиПособие.Количество() = 0 Тогда
								если НачалоДня(СтокаПрошлаяВр+86400) = НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ?(не ВыборкаПоДоговорам.Договор=1,ДоговорПрошл = ВыборкаПоДоговорам.Договор, Истина) Тогда
									если не (ДатаУвольнения >НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ДатаУвольнения>КонецМесяца(ВыборкаПоДоговорам.Месяц)) Тогда
										если ДатаПриема <> Дата(1,1,1) и ДатаПриема > ВыборкаПоДоговорам.Месяц Тогда 
											если ДатаУвПрСовпадают и ДатаУвольнения < ДатаПриема Тогда  
												СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
												СтрокаВзносыВР = СведенияОСтаже.Добавить();
												если не ВыборкаПоДоговорам.Договор=1 Тогда 
													СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
													СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
												КонецЕсли;
												СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
												СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
												
												СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
												СтрокаВзносыВР.ДатаОкончанияРабот = КонецМесяца(ВыборкаПоДоговорам.Месяц);
												СтрокаВзносыВР.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
												СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
											иначе
												СтрокаВзносыВР = СведенияОСтаже.Добавить();
												если не ВыборкаПоДоговорам.Договор=1 Тогда 
													СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
													СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
												КонецЕсли;
												СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
												СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
												если ДатаПриема <> Дата(1,1,1) и Год(ДатаПриема) = Год(ВыборкаПоДоговорам.Месяц) и Месяц(ДатаПриема) = Месяц(ВыборкаПоДоговорам.Месяц) и День(ДатаПриема) > День(ВыборкаПоДоговорам.Месяц) Тогда 
													СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
												ИначеЕсли СчКол > 1 Тогда 
													СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
												иначе
													Если ЗначениеЗаполнено(ВыборкаПоДоговорам.Договор) и ВыборкаПоДоговорам.Договор<>1 и ?(ДоговорПрошл = ВыборкаПоДоговорам.Договор,СтокаПрошлаяВр = Дата(1,1,1),Истина)  Тогда
														СтрокаВзносыВР.ДатаНачалаРабот = Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01));
													Иначе 
														СтрокаВзносыВР.ДатаНачалаРабот = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
													КонецЕсли;
												КонецЕсли;
												
												//О.Т. Аверсон 04.04.2019 № 4187
												Если Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))) < Год(ВыборкаПоДоговорам.Месяц) Тогда 
													ЗаписьГод =Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))); 
													Пока ЗаписьГод<Год(ВыборкаПоДоговорам.Месяц) Цикл  
														СтрокаСтажа1 = СведенияОСтаже.Добавить();
														ЗаполнитьЗначенияСвойств(СтрокаСтажа1,СтрокаСтажа);
														
														если ЗаписьГод =Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))) Тогда 
															СтрокаСтажа1.ДатаНачалаРабот = Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01));
														Иначе
															СтрокаСтажа1.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
														КонецЕсли;
														СтрокаСтажа1.ДатаОкончанияРабот = Дата(ЗаписьГод,12,31);
														СтрокаСтажа1.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
														СтрокаСтажа1.Категория = ВыборкаПоДоговорам.Категория;
														
														ЗаписьГод = ЗаписьГод+1;
													КонецЦикла;
													СтрокаСтажа.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
												КонецЕсли;													
												//О.Т. Аверсон 04.04.2019 № 4187
												
												если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < КонецМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
													СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
												иначе
													СтрокаВзносыВР.ДатаОкончанияРабот = КонецМесяца(ВыборкаПоДоговорам.Месяц);
												КонецЕсли;
												//О.Т. Аверсон 22.08.2018 № 2335
												Если не ВыборкаПоДоговорам.Договор=1 Тогда
													Если СтрокаВзносыВР.ДатаОкончанияРабот > ВыборкаПоДоговорам.Договор.ДатаОкончания Тогда 
														СтрокаВзносыВР.ДатаОкончанияРабот = КонецДня(ВыборкаПоДоговорам.Договор.ДатаОкончания);
													КонецЕсли;
												КонецЕсли;
												//О.Т. Аверсон 22.08.2018 № 2335
												
												СтрокаВзносыВР.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
												СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
												
											КонецЕсли;
											
											//Аверсон 22.12.2021 КВВ СВФР-007900 (
										Иначе
											Если СтрокаВзносыВР.ВидДеятельности <> СтруктураПоискаПособие.ВидДеятельности ИЛИ СтрокаВзносыВР.ВидДеятельности = ПРЕМИЯ Тогда //Аверсон ЕАЕ 26.01.2023 СВФР-010135 (добавлено условие для премии)
												СтрокаВзносыВР = СведенияОСтаже.Добавить();
												если не ВыборкаПоДоговорам.Договор=1 Тогда 
													СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
													СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
												КонецЕсли;
												СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
												СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
												
												СтрокаВзносыВР.ДатаНачалаРабот = СтруктураПоискаПособие.ДатаНачалаРабот;
												СтрокаВзносыВР.ДатаОкончанияРабот = СтруктураПоискаПособие.ДатаОкончанияРабот;
												СтрокаВзносыВР.ВидДеятельности = СтруктураПоискаПособие.ВидДеятельности;
												СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;
											КонецЕсли;
											//Аверсон 22.12.2021 КВВ СВФР-007900 )
											
										КонецЕсли;
									КонецЕсли;
									если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < КонецМесяца(ВыборкаПоДоговорам.Месяц) и не(ДатаУвольнения<ДатаПриема) Тогда 
										СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
									иначе
										СтрокаВзносыВР.ДатаОкончанияРабот = КонецМесяца(ВыборкаПоДоговорам.Месяц);
									КонецЕсли;
									//О.Т. Аверсон 22.08.2018 № 2335
									Если не ВыборкаПоДоговорам.Договор=1 Тогда
										Если СтрокаВзносыВР.ДатаОкончанияРабот > ВыборкаПоДоговорам.Договор.ДатаОкончания Тогда 
											СтрокаВзносыВР.ДатаОкончанияРабот = КонецДня(ВыборкаПоДоговорам.Договор.ДатаОкончания);
										КонецЕсли;
									КонецЕсли;
									//О.Т. Аверсон 22.08.2018 № 2335
									
									
									
									
									СтокаПрошлаяВр = СтрокаВзносыВР.ДатаОкончанияРабот;
								иначе
									ЕстьПособие = Ложь;
									для Каждого стрПособие из СтрокиПособия Цикл 
										если НачалоДня(СтокаПрошлаяВр+86400) = стрПособие.ДатаНачалаРабот Тогда 
											//ЕстьПособие = Истина;
										КонецЕсли;
										
									КонецЦикла;
									если (ДатаПриема <= КонецМесяца(ВыборкаПоДоговорам.Месяц) или ДатаПриема = Дата(1,1,1)) и (ДатаУвольнения >= НачалоМесяца(ВыборкаПоДоговорам.Месяц) или ДатаУвольнения = Дата(1,1,1)) Тогда
										если ЕстьПособие Тогда
											если не (ДатаУвольнения >НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ДатаУвольнения>КонецМесяца(ВыборкаПоДоговорам.Месяц)) Тогда
												если ДатаПриема <> Дата(1,1,1) и ДатаПриема > ВыборкаПоДоговорам.Месяц Тогда 
													если ДатаУвПрСовпадают и ДатаУвольнения < ДатаПриема Тогда  
														СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
														СтрокаВзносыВР = СведенияОСтаже.Добавить();
														если не ВыборкаПоДоговорам.Договор=1 Тогда 
															СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
															СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
														КонецЕсли;
														СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
														СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
														
														СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
														СтрокаВзносыВР.ДатаОкончанияРабот = КонецМесяца(ВыборкаПоДоговорам.Месяц);
														СтрокаВзносыВР.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
														СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
														
													иначе
														СтрокаВзносыВР = СведенияОСтаже.Добавить();
														если не ВыборкаПоДоговорам.Договор=1 Тогда 
															СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
															СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
														КонецЕсли;
														СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
														СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
														если ДатаПриема <> Дата(1,1,1) и Год(ДатаПриема) = Год(ВыборкаПоДоговорам.Месяц) и Месяц(ДатаПриема) = Месяц(ВыборкаПоДоговорам.Месяц) и День(ДатаПриема) > День(ВыборкаПоДоговорам.Месяц) Тогда 
															СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
														ИначеЕсли СчКол > 1 Тогда 
															СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
														иначе
															Если ЗначениеЗаполнено(ВыборкаПоДоговорам.Договор) и ВыборкаПоДоговорам.Договор<>1 и ?(ДоговорПрошл = ВыборкаПоДоговорам.Договор,СтокаПрошлаяВр = Дата(1,1,1),Истина)  Тогда
																СтрокаВзносыВР.ДатаНачалаРабот = Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01));
															Иначе 
																СтрокаВзносыВР.ДатаНачалаРабот = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
															КонецЕсли;
														КонецЕсли;
														
														//О.Т. Аверсон 04.04.2019 № 4187
														Если Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))) < Год(ВыборкаПоДоговорам.Месяц) Тогда 
															ЗаписьГод =Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))); 
															Пока ЗаписьГод<Год(ВыборкаПоДоговорам.Месяц) Цикл  
																СтрокаСтажа1 = СведенияОСтаже.Добавить();
																ЗаполнитьЗначенияСвойств(СтрокаСтажа1,СтрокаСтажа);
																если ЗаписьГод =Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))) Тогда 
																	СтрокаСтажа1.ДатаНачалаРабот = Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01));
																Иначе
																	СтрокаСтажа1.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
																КонецЕсли;
																СтрокаСтажа1.ДатаОкончанияРабот = Дата(ЗаписьГод,12,31);
																СтрокаСтажа1.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
																СтрокаСтажа1.Категория = ВыборкаПоДоговорам.Категория;
																
																ЗаписьГод = ЗаписьГод+1;
															КонецЦикла;
															СтрокаСтажа.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
														КонецЕсли;													
														//О.Т. Аверсон 04.04.2019 № 4187
														
														если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < КонецМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
															СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
														иначе
															СтрокаВзносыВР.ДатаОкончанияРабот = КонецМесяца(ВыборкаПоДоговорам.Месяц);
														КонецЕсли;
														//О.Т. Аверсон 22.08.2018 № 2335
														Если не ВыборкаПоДоговорам.Договор=1 Тогда
															Если СтрокаВзносыВР.ДатаОкончанияРабот > ВыборкаПоДоговорам.Договор.ДатаОкончания Тогда 
																СтрокаВзносыВР.ДатаОкончанияРабот = КонецДня(ВыборкаПоДоговорам.Договор.ДатаОкончания);
															КонецЕсли;
														КонецЕсли;
														//О.Т. Аверсон 22.08.2018 № 2335
														
														СтрокаВзносыВР.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
														СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
														
														
													КонецЕсли;
												иначе
													СтрокаВзносыВР = СведенияОСтаже.Добавить();
													если не ВыборкаПоДоговорам.Договор=1 Тогда 
														СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
														СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
													КонецЕсли;
													СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
													СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
													СтрокаВзносыВР.ДатаНачалаРабот = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
													СтрокаВзносыВР.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
													СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
												КонецЕсли;
											иначе
												СтрокаВзносыВР = СведенияОСтаже.Добавить();
												если не ВыборкаПоДоговорам.Договор=1 Тогда 
													СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
													СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
												КонецЕсли;
												СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
												СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
												СтрокаВзносыВР.ДатаНачалаРабот = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
												СтрокаВзносыВР.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
												СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
											КонецЕсли;
											
											
											если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < КонецМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
												СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
											иначе
												СтрокаВзносыВР.ДатаОкончанияРабот = КонецМесяца(ВыборкаПоДоговорам.Месяц);
											КонецЕсли;
											//О.Т. Аверсон 22.08.2018 № 2335
											Если не ВыборкаПоДоговорам.Договор=1 Тогда
												Если СтрокаВзносыВР.ДатаОкончанияРабот > ВыборкаПоДоговорам.Договор.ДатаОкончания Тогда 
													СтрокаВзносыВР.ДатаОкончанияРабот = КонецДня(ВыборкаПоДоговорам.Договор.ДатаОкончания);
												КонецЕсли;
											КонецЕсли;
											//О.Т. Аверсон 22.08.2018 № 2335
											
										иначе
											СтрокаВзносыВР = СведенияОСтаже.Добавить();
											если не ВыборкаПоДоговорам.Договор=1 Тогда 
												СтрокаВзносыВР.Договор = ВыборкаПоДоговорам.Договор;
												СтрокаВзносыВР.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
											КонецЕсли;
											СтрокаВзносыВР.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
											СтрокаВзносыВР.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
											если ДатаПриема <> Дата(1,1,1) и Год(ДатаПриема) = Год(ВыборкаПоДоговорам.Месяц) и Месяц(ДатаПриема) = Месяц(ВыборкаПоДоговорам.Месяц) и День(ДатаПриема) > День(ВыборкаПоДоговорам.Месяц)
												Тогда //и не (ДатаУвольнения >НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ДатаУвольнения>КонецМесяца(ВыборкаПоДоговорам.Месяц)) //О.Т. Аверсон 02.03.2016 № Убрала,т.к. в дата начала не заполняется дата приема
												СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
											ИначеЕсли СчКол > 1 Тогда 
												СтрокаВзносыВР.ДатаНачалаРабот = ДатаПриема;
											иначе
												Если ЗначениеЗаполнено(ВыборкаПоДоговорам.Договор) и ВыборкаПоДоговорам.Договор<>1 и ?(ДоговорПрошл = ВыборкаПоДоговорам.Договор,СтокаПрошлаяВр = Дата(1,1,1),Истина)  Тогда
													СтрокаВзносыВР.ДатаНачалаРабот = Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01));
													//О.Т. Аверсон 04.04.2019 № 4187
													Если Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))) < Год(ВыборкаПоДоговорам.Месяц) Тогда 
														ЗаписьГод =Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))); 
														Пока ЗаписьГод<Год(ВыборкаПоДоговорам.Месяц) Цикл  
															СтрокаВзносыВР1 = СведенияОСтаже.Добавить();
															ЗаполнитьЗначенияСвойств(СтрокаВзносыВР1,СтрокаВзносыВР);
															если ЗаписьГод =Год(Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01))) Тогда 
																СтрокаВзносыВР1.ДатаНачалаРабот = Макс(ВыборкаПоДоговорам.Договор.ДатаНачала,Дата(2014,01,01));
															Иначе
																СтрокаВзносыВР1.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
															КонецЕсли;
															СтрокаВзносыВР1.ДатаОкончанияРабот = Дата(ЗаписьГод,12,31);
															СтрокаВзносыВР1.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
															СтрокаВзносыВР1.Категория = ВыборкаПоДоговорам.Категория;
															
															ЗаписьГод = ЗаписьГод+1;
														КонецЦикла;
														СтрокаВзносыВР.ДатаНачалаРабот = Дата(ЗаписьГод,01,01);
													КонецЕсли;													
													//О.Т. Аверсон 04.04.2019 № 4187
												Иначе 
													СтрокаВзносыВР.ДатаНачалаРабот = НачалоМесяца(ВыборкаПоДоговорам.Месяц);
												КонецЕсли;
											КонецЕсли;
											
											если ДатаУвольнения <> Дата(1,1,1) и ДатаУвольнения < КонецМесяца(ВыборкаПоДоговорам.Месяц) Тогда 
												СтрокаВзносыВР.ДатаОкончанияРабот = ДатаУвольнения;
											иначе
												СтрокаВзносыВР.ДатаОкончанияРабот = КонецМесяца(ВыборкаПоДоговорам.Месяц);
											КонецЕсли;
											//О.Т. Аверсон 22.08.2018 № 2335
											Если не ВыборкаПоДоговорам.Договор=1 Тогда 
												Если СтрокаВзносыВР.ДатаОкончанияРабот > ВыборкаПоДоговорам.Договор.ДатаОкончания Тогда 
													СтрокаВзносыВР.ДатаОкончанияРабот = КонецДня(ВыборкаПоДоговорам.Договор.ДатаОкончания);
												КонецЕсли;
											КонецЕсли;
											//О.Т. Аверсон 22.08.2018 № 2335
											
											СтрокаВзносыВР.ВидДеятельности = ?(НЕ БылОтпускЗаСвойСчетМесяц И ЕстьРабочиеДниЧасыВМес,ВзносыВрем,?(ЕстьПремияДляПУЗаМесяц,Премия,ВзносыВрем)); //Аверсон 22.05.2020 КВВ СВФР-005940 //Аверсон 23.07.2020 КВВ СВФР-006298 //Аверсон 22.12.2021 КВВ СВФР-007900
											СтрокаВзносыВР.Категория = ВыборкаПоДоговорам.Категория;//О.Т. Аверсон 02.03.2016 (Чтоб попадала в отбор)
											
										КонецЕсли;
										ДоговорПрошл = ВыборкаПоДоговорам.Договор;
										СтокаПрошлаяВр = СтрокаВзносыВР.ДатаОкончанияРабот;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						
						
					КонецЕсли;
					//КонецЕсли;
					
					//Островская Татьяна 05.03.2014 № 17172
					
					
					//КонецЕсли;
					//КонецЕсли;
					если ОбъединятьОсновные и ВыборкаПоДоговорам.Договор = 1 Тогда
						Если НайденныеСтроки.Количество() > 0 Тогда
							СтруктураПоискаВзносы.Сотрудник = НайденныеСтроки[0].Сотрудник;
							СтруктураПоискаВзносы.ФизЛицо = НайденныеСтроки[0].ФизЛицо;
						иначе
							СтруктураПоискаВзносы.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
							СтруктураПоискаВзносы.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
						КонецЕсли;
					иначе
						СтруктураПоискаВзносы.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
						СтруктураПоискаВзносы.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
					КонецЕсли;
					//О.Т. Аверсон 29.08.2018 № 2363
					Если ЗначениеЗаполнено(ВыборкаПоДоговорам.Сотрудник.ВидНалогообложенияОсновной) Тогда 
						ОсновнойВидНалогообл = ВыборкаПоДоговорам.Сотрудник.ВидНалогообложенияОсновной;
					иначе
						ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
					КонецЕсли;
					//О.Т. Аверсон 29.08.2018 № 2363
					СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ВыборкаПоДоговорам.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
					РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ВыборкаПоДоговорам.Месяц) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
					БазаОграниченияФСЗН = СтруктураФСЗН.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
					
					
					СтруктураПоискаВзносы.Месяц=ВыборкаПоДоговорам.Месяц;
					//+ СВЭЙ КДЯ 12.12.19 СВФР-005192
					//Если ВыборкаПоДоговорам.Выплаты > БазаОграниченияФСЗН Тогда 
					//	СтруктураПоискаВзносы.Выплаты = БазаОграниченияФСЗН;
					//иначе
					//	СтруктураПоискаВзносы.Выплаты = ВыборкаПоДоговорам.Выплаты;
					//КонецЕсли;
					//- СВЭЙ КДЯ 12.12.19 СВФР-005192
					
					//+ СВЭЙ КДЯ 12.12.19 СВФР-005192
					//берем данные из регистра
					СтруктураПоискаВзносы.Выплаты = ВыборкаПоДоговорам.Выплаты;
					//- СВЭЙ КДЯ 12.12.19 СВФР-005192
					
					СтруктураПоискаВзносы.Пособия=ВыборкаПоДоговорам.Пособия;
					СтруктураПоискаВзносы.Взносы=ВыборкаПоДоговорам.Взносы;	
					СтруктураПоискаВзносы.ТарифВзносов=ВыборкаПоДоговорам.ТарифВзносов;
					СтруктураПоискаВзносы.Договор=ВыборкаПоДоговорам.Договор;	
					СтруктураПоискаВзносы.Категория=ВыборкаПоДоговорам.Категория;
					НайденныеСтрокиВзносы =  СведенияОВзносах.НайтиСтроки(СтруктураПоискаВзносы);
					если НайденныеСтрокиВзносы.Количество() = 0 Тогда
						если не ВыборкаПоДоговорам.Договор = 1 и (ВсеСотрудники или ДогПодряда) Тогда
							
							//Аверсон ЕАЕ 31.03.2021 СВФР-006959
							//О.Т. Аверсон 11.04.2019 № 4221 Чтоб записи по нулевым значениям по премиям не задвоились
							//МассивОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц)); 
							//Если МассивОВзносах.Количество()=0 Тогда 
							//	СтрокаВзносов = СведенияОВзносах.Добавить();
							//иначе
							//	СтрокаВзносов = МассивОВзносах[0];
							//КонецЕсли;
							////О.Т. Аверсон 11.04.2019 № 4221
							//ДоговорПрошлПоСтроке = СтрокаВзносов.Договор;
							//
							//ЗаполнитьЗначенияСвойств(СтрокаВзносов,ВыборкаПоДоговорам);
							//Если МассивОВзносах.Количество() > 0 Тогда
							//	СтрокаВзносов.Договор = ДоговорПрошлПоСтроке;
							//КонецЕсли;
							МассивОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц,Договор",ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,ВыборкаПоДоговорам.Договор)); 
							Если МассивОВзносах.Количество()=0 Тогда 
								СтрокаВзносов = СведенияОВзносах.Добавить();
							иначе
								СтрокаВзносов = МассивОВзносах[0];
							КонецЕсли;
							//О.Т. Аверсон 11.04.2019 № 4221
							ДоговорПрошлПоСтроке = СтрокаВзносов.Договор;
							
							ЗаполнитьЗначенияСвойств(СтрокаВзносов,ВыборкаПоДоговорам);
							//Если МассивОВзносах.Количество() > 0 Тогда
							//	СтрокаВзносов.Договор = ДоговорПрошлПоСтроке;
							//КонецЕсли;
							//Аверсон СВФР-006959
							
							//О.Т. Аверсон 17.04.2019 № 4246
							ЗапросЗаСвойСчет = Новый Запрос;
							ЗапросЗаСвойСчет.Текст = 
							"ВЫБРАТЬ
							|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
							//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В ( &МассивКод15 ) КАК ЭтоКод15,
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета 
							|		= ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты ) КАК ЭтоКод16,
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета 
							|		= ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ) КАК ЭтоКод19,
							//- СВЭЙ КДЯ 07.06.19 СВФР-004424
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета
							|ИЗ
							|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
							|ГДЕ
							|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия МЕЖДУ &ПериодДействия И &ПериодДействия1
							|	И ( ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
							//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
							|		ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В ( &МассивКод15 ) 
							|		ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета В
							|					( ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты ) 
							|					 , ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ) )
							|     )
							//- СВЭЙ КДЯ 07.06.19 СВФР-004424
							|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
							|
							|УПОРЯДОЧИТЬ ПО
							|	ПериодДействияНачало";
							ЗапросЗаСвойСчет.УстановитьПараметр("Сотрудник",ВыборкаПоДоговорам.Сотрудник);
							СписокВР = Новый СписокЗначений;
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыУчебный); //09
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул); //05
							//Аверсон 22.04.2020 КВВ СВФР-005887 (	
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоДням);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоЧасам);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифДневной);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифЧасовой);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойПоВинеРаботодателя);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойПоВинеРаботодателя);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойОкладПоЧасам);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойТарифЧасовой);
							//Аверсон 22.04.2020 КВВ СВФР-005887 )
							//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
							ЗапросЗаСвойСчет.УстановитьПараметр( "МассивКод15", МассивКод15 );
							//- СВЭЙ КДЯ 07.06.19 СВФР-004424
							ЗапросЗаСвойСчет.УстановитьПараметр("ВидРасчета",СписокВР);
							ЗапросЗаСвойСчет.УстановитьПараметр("ПериодДействия",НачалоМесяца(ВыборкаПоДоговорам.Месяц));
							ЗапросЗаСвойСчет.УстановитьПараметр("ПериодДействия1",КонецМесяца(ВыборкаПоДоговорам.Месяц));
							РезЗаСвойСчет = ЗапросЗаСвойСчет.Выполнить().Выгрузить();
							
							МассивЗС = ТаблицаЗанимаемыеСтавки.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц)); 
							Если МассивЗС.Количество()>0 Тогда
								ЗанимаемыхСтавок = МассивЗС[0].ЗанимаемыхСтавок;
							иначе
								ЗанимаемыхСтавок = 0;	
							КонецЕсли;
							
							ЗапросПрочиеПричины = Новый Запрос;
							ЗапросПрочиеПричины.Текст = 
							"ВЫБРАТЬ
							|	ПрочиеПричиныМинимальнойЗаработнойПлаты.ПричиныМинимальнойЗаработнойПлаты
							|ИЗ
							|	РегистрСведений.ПрочиеПричиныМинимальнойЗаработнойПлаты КАК ПрочиеПричиныМинимальнойЗаработнойПлаты
							|ГДЕ
							|	ПрочиеПричиныМинимальнойЗаработнойПлаты.Сотрудник = &Сотрудник
							// + СВЭЙ КДЯ 22.07.19 СВФР-004561
							|	И ПрочиеПричиныМинимальнойЗаработнойПлаты.Организация = &Организация
							// - СВЭЙ КДЯ 22.07.19 СВФР-004561
							|	И ПрочиеПричиныМинимальнойЗаработнойПлаты.Период МЕЖДУ &Период И &Период1";
							
							// + СВЭЙ КДЯ 22.07.19 СВФР-004561
							ЗапросПрочиеПричины.УстановитьПараметр("Организация", ЭтотОбъект.Организация);
							// - СВЭЙ КДЯ 22.07.19 СВФР-004561
							ЗапросПрочиеПричины.УстановитьПараметр("Период", НачалоМесяца(ВыборкаПоДоговорам.Месяц));
							ЗапросПрочиеПричины.УстановитьПараметр("Период1", КонецМесяца(ВыборкаПоДоговорам.Месяц));
							ЗапросПрочиеПричины.УстановитьПараметр("Сотрудник", ВыборкаПоДоговорам.Сотрудник);
							
							РезПрочиеПричины = ЗапросПрочиеПричины.Выполнить().Выбрать();
							ПрочаяПричина = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();
							Пока РезПрочиеПричины.Следующий() Цикл
								ПрочаяПричина = РезПрочиеПричины.ПричиныМинимальнойЗаработнойПлаты;								
							КонецЦикла;	
							
							РазмерМинЗП = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ВыборкаПоДоговорам.Месяц),Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
							
							Если ВыборкаПоДоговорам.Договор = 1 Тогда
								Если ЗначениеЗаполнено(ПрочаяПричина) Тогда 
									СтрокаВзносов.ПричиныМинимальнойЗП = ПрочаяПричина;
								иначе
									
									Если ВыборкаПоДоговорам.Выплаты + ВыборкаПоДоговорам.Пособия <= РазмерМинЗП и не ВыборкаПоДоговорам.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство Тогда 
										Если СтрокаВзносов.ПричиныМинимальнойЗП <> Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодОтпускаПоУходуЗаРебенкомДоДостиженияИмВозраста3Лет Тогда
											Если (ДатаПриема > НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ДатаПриема <= КонецМесяца(ВыборкаПоДоговорам.Месяц)) или
												(ДатаУвольнения <= КонецМесяца(ВыборкаПоДоговорам.Месяц) и ДатаУвольнения <> Дата(1,1,1)) Тогда									
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НеполноеРабочееВремяВСвязиСПриемомУвольнением;
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет)).Количество()>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОтпускБезСохраненияЗаработнойПлатыВСвязиСОбучениемПоСемейноБытовымИДругимУважительнымПричинам; 
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыУчебный)).Количество()>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОтпускБезСохраненияЗаработнойПлатыВСвязиСОбучениемПоСемейноБытовымИДругимУважительнымПричинам;
												//Аверсон 22.04.2020 КВВ СВФР-005887 (	
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоДням)).Количество()>0 ИЛИ
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоЧасам)).Количество()>0 ИЛИ 
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифДневной)).Количество()>0 ИЛИ 
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифЧасовой)).Количество()>0 ИЛИ 
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойПоВинеРаботодателя)).Количество()>0 ИЛИ 
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойОкладПоЧасам)).Количество()>0 ИЛИ
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойТарифЧасовой)).Количество()>0 ИЛИ
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойПоВинеРаботодателя)).Количество()>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ЦелодневныеЦелосменныеПростои;
												//Аверсон 22.04.2020 КВВ СВФР-005887 )
												//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод15", Истина  ) ).Количество() > 0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодВременнойНетрудоспособностиПоСправкеИлиНетПособия;
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод16", Истина  ) ).Количество() > 0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ИзРасчетаЧасовойМинимЗП;
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод19", Истина  ) ).Количество() > 0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОплачиваемыйОтпуск;
												//- СВЭЙ КДЯ 07.06.19 СВФР-004424
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул)).Количество()>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НарушениеТрудовоПроизводственноТехнологическойИсполнительскойДисциплины;
											ИначеЕсли ВыборкаПоДоговорам.Пособия > 0  Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодВременнойНетрудоспособности;  
											ИначеЕсли ЗанимаемыхСтавок < 1 и ЗанимаемыхСтавок>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НеполноеРабочееВремяПоСоглашениюМеждуРаботникомИНанимателем; 									
											КонецЕсли;	
										КонецЕсли;
									иначе
										СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();
									КонецЕсли;  
								КонецЕсли;
							КонецЕсли;
							//О.Т. Аверсон 17.04.2019 № 4246
							
							
							//+ СВЭЙ КДЯ 12.12.19 СВФР-005192
							////О.Т. Аверсон 29.01.2018 № 1511
							//Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
							//	СтрокаВзносов.Выплаты = ВыборкаПоДоговорам.Выплаты;
							//иначе
							//	Если ВыборкаПоДоговорам.Выплаты > БазаОграниченияФСЗН Тогда 
							//		СтрокаВзносов.Выплаты = БазаОграниченияФСЗН;
							//	иначе
							//		СтрокаВзносов.Выплаты = ВыборкаПоДоговорам.Выплаты;
							//	КонецЕсли;
							//КонецЕсли;
							////О.Т. Аверсон 29.01.2018 № 1511
							//- СВЭЙ КДЯ 12.12.19 СВФР-005192
							
							//+ СВЭЙ КДЯ 12.12.19 СВФР-005192
							//берем данные из регистра
							СтрокаВзносов.Выплаты = ВыборкаПоДоговорам.Выплаты;
							//- СВЭЙ КДЯ 12.12.19 СВФР-005192
							
							если ОбъединятьОсновные и ВыборкаПоДоговорам.Договор = 1 Тогда
								СтрокаВзносов.Сотрудник = СтруктураПоискаВзносы.Сотрудник;
								СтрокаВзносов.ФизЛицо = СтруктураПоискаВзносы.ФизЛицо;
							КонецЕсли;
							
							если не ВыборкаПоДоговорам.Договор = 1 Тогда 
								СтрокаВзносов.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
							иначе
								СтрокаВзносов.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
							КонецЕсли;
							//если Основные и ВыборкаПоДоговорам.Договор <> 1 Тогда
							//	СтрокаВзносов.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
							//КонецЕсли;
							//О.Т. Аверсон 29.08.2018 № 2363
							Если ЗначениеЗаполнено(ВыборкаПоДоговорам.Сотрудник.ВидНалогообложенияОсновной) Тогда 
								ОсновнойВидНалогообл = ВыборкаПоДоговорам.Сотрудник.ВидНалогообложенияОсновной;
							иначе
								ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
							КонецЕсли;
							//О.Т. Аверсон 29.08.2018 № 2363
							Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда
								СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ВыборкаПоДоговорам.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
								СтавкаФСЗН = СтруктураФСЗН.Размер;
								СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ВыборкаПоДоговорам.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
								СтавкаПенс = СтруктураПенс.Размер;
								Взносы = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПоДоговорам.Выплаты * СтавкаФСЗН/100,ДатаРегистрации)+ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПоДоговорам.Выплаты * СтавкаПенс/100,ДатаРегистрации)
							иначе
								
								Если ВсегоВыплат <> 0 Тогда
									Взносы = ВыборкаПоДоговорам.Взносы*ВыборкаПоДоговорам.Выплаты/ВсегоВыплат;
									//Выплаты = ВсегоВыплат*ВыборкаПоДоговорам.Выплаты/ВсегоВыплат;
								Иначе
									Взносы = 0;
									//Выплаты = 0;
								КонецЕсли;
							КонецЕсли;
							СтрокаВзносов.Взносы = Взносы;  
							РезультатДоговор= 0;
							Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда 
								
								ЗапросДог = Новый Запрос;
								ЗапросДог.Текст = 
								"ВЫБРАТЬ
								|	ЕСНСведенияОДоходах.Результат  как Результат
								|ИЗ
								|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
								|ГДЕ
								|	ЕСНСведенияОДоходах.Сотрудник = &Сотрудник
								|	И ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1
								|	И ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН <> &ДоходБольничныйФСЗН";
								//|	И ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета = &СпособРасчета"; //О.Т. Аверсон 31.01.2017 № 244
								ЗапросДог.УстановитьПараметр("Сотрудник",СтруктураПоискаВзносы.Сотрудник);
								ЗапросДог.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
								ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов",НачалоМесяца(ВыборкаПоДоговорам.Месяц));
								ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов1",КонецМесяца(ВыборкаПоДоговорам.Месяц));
								//ЗапросДог.УстановитьПараметр("СпособРасчета",Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой);
								РезДог = ЗапросДог.Выполнить().Выбрать();
								
								пока РезДог.Следующий() Цикл 
									РезультатДоговор =РезультатДоговор + РезДог.Результат; 
								КонецЦикла;
								
								//Аверсон ЕАЕ 01.04.2021 СВФР-006959
								РезультатДоговор = ВыборкаПоДоговорам.Выплаты;
								//Аверсон СВФР-006959
								
								Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
									СтрокаВзносов.Выплаты = РезультатДоговор;
								иначе
									Если РезультатДоговор > БазаОграниченияФСЗН Тогда 
										СтрокаВзносов.Выплаты = БазаОграниченияФСЗН;
									иначе
										СтрокаВзносов.Выплаты = РезультатДоговор;
									КонецЕсли;
								КонецЕсли;
							КонецЕсли;
							
							//СВЭЙ 28.08.2023 КВВ СВФР-011258 (пункт 2) (
							Если НЕ ВыгрузкаДоговоровПодрядаБезОграничения 
								И ДогПодряда
								И ВыборкаПоДоговорам.Пособия <> 0 
								И ВыборкаПоДоговорам.Месяц < НачалоМесяца(СтрокаПособие.ДатаОкончанияРабот) 
								И ВыборкаПоДоговорам.Месяц = Началомесяца(ВыборкаПоДоговорам.Договор.ДатаОкончания) //СВЭЙ 25.04.2024 КВВ СВФР-012944 (пункт 1)
								Тогда
								
								//СВЭЙ 26.04.2024 КВВ СВФР-012944 (пункт 3) (
								Если СтрокаВзносов.Пособия <> 0 И (СтрокаВзносов.ПособияБР = 0 И СтрокаВзносов.ОплатыДопДня = 0 И СтрокаВзносов.ПособияВН = 0) Тогда
									СтрокаВзносов.ПособияБР = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,1,ВыборкаПоДоговорам.Договор); 
									СтрокаВзносов.ОплатыДопДня = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,2);
									СтрокаВзносов.ПособияВН = СтрокаВзносов.Пособия - СтрокаВзносов.ПособияБР - СтрокаВзносов.ОплатыДопДня;
								КонецЕсли;
								//СВЭЙ 26.04.2024 КВВ СВФР-012944 (пункт 3) )
								
								Для МесяцевВперед = 1 По 3 Цикл
									СтанетМесяц = ДобавитьМесяц(НачалоМесяца(ВыборкаПоДоговорам.Месяц),МесяцевВперед);
									
									ЗапросПособие1 = Новый Запрос;
									ЗапросПособие1 = ЗапросПособие;
									
									ЗапросПособие1.Текст = "Выбрать 
									|	Сумма(ВТПособие.Пособия) как Пособия,
									|	ВТПособие.ПериодДействияНачало,
									|	ВТПособие.ПериодВзаиморасчетов,
									|	Сумма(ВТПособие.Выплаты) как Выплаты,
									|	ВТПособие.ПериодДействияКонец,
									|	ВТПособие.ПериодДействияНачало1   
									|	ИЗ ВТДанныеОПособии"+Строка(Месяц(СтанетМесяц))+" как ВТПособие
									|	ГДЕ ВТПособие.Сотрудник = &Сотрудник 						
									|	СГРУППИРОВАТЬ ПО
									|	ВТПособие.ПериодДействияНачало,
									|	ВТПособие.ПериодВзаиморасчетов,
									|	ВТПособие.ПериодДействияКонец,
									|	ВТПособие.ПериодДействияНачало1
									|УПОРЯДОЧИТЬ ПО
									|	ПериодДействияНачало";  
									
									РезЗапросПособие1 = ЗапросПособие1.Выполнить().Выбрать();
									
									СумПособияПосле = 0;
									Пока РезЗапросПособие1.Следующий() Цикл 
										Если РезЗапросПособие1.Пособия > 0 Тогда
											СумПособияПосле = СумПособияПосле + РезЗапросПособие1.Пособия;
										КонецЕсли;
									КонецЦикла;
									
									Если СумПособияПосле > 0 Тогда
										СтрокаВзносов = СведенияОВзносах.Добавить();
										СтрокаВзносов.Месяц = СтанетМесяц;
										СтрокаВзносов.Пособия = СумПособияПосле;
										СтрокаВзносов.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
										СтрокаВзносов.Договор = ВыборкаПоДоговорам.Договор;
										СтрокаВзносов.Категория = ВыборкаПоДоговорам.Категория;
										СтрокаВзносов.Сотрудник = ВыборкаПоДоговорам.Сотрудник;
										СтрокаВзносов.ФизЛицо = ВыборкаПоДоговорам.ФизЛицо;
										
										//СВЭЙ 26.10.2023 КВВ СВФР-011519 (
										
										//СВЭЙ 26.04.2024 КВВ СВФР-012944 (пункт 3) (
										//Если ВыборкаПоДоговорам.Пособия <> 0 Тогда
										Если СумПособияПосле <> 0 Тогда
											//СВЭЙ 26.04.2024 КВВ СВФР-012944 (пункт 3) )
											
											СтрокаВзносов.ПособияБР = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,СтанетМесяц,1,ВыборкаПоДоговорам.Договор); //СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5) (Договор)
											СтрокаВзносов.ОплатыДопДня = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,СтанетМесяц,2);
											
											//СВЭЙ 26.04.2024 КВВ СВФР-012944 (пункт 3) (
											//СтрокаВзносов.ПособияВН = ВыборкаПоДоговорам.Пособия - СтрокаВзносов.ПособияБР - СтрокаВзносов.ОплатыДопДня;
											СтрокаВзносов.ПособияВН = СумПособияПосле - СтрокаВзносов.ПособияБР - СтрокаВзносов.ОплатыДопДня;
											//СВЭЙ 26.04.2024 КВВ СВФР-012944 (пункт 3) )
										КонецЕсли;
										
										Если ВыборкаПоДоговорам.Выплаты <> 0 Тогда
											СтрокаВзносов.Простои = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,СтанетМесяц,3);
											СтрокаВзносов.ОтпускаИницНаним = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,СтанетМесяц,4);
										КонецЕсли;
										//СВЭЙ 26.10.2023 КВВ СВФР-011519 )
										
									КонецЕсли;
								КонецЦикла;
								
								//СВЭЙ 16.01.2024 КВВ СВФР-012080 (
							Иначе
								Если ВыборкаПоДоговорам.Пособия <> 0 ИЛИ ВыборкаПоДоговорам.Выплаты <> 0 Тогда
									Если ВыборкаПоДоговорам.Пособия <> 0 Тогда
										СтрокаВзносов.ПособияБР = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,1,ВыборкаПоДоговорам.Договор); //СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5) (Договор)
										СтрокаВзносов.ОплатыДопДня = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,2);
										СтрокаВзносов.ПособияВН = ВыборкаПоДоговорам.Пособия - СтрокаВзносов.ПособияБР - СтрокаВзносов.ОплатыДопДня;
									КонецЕсли;
									
									Если ВыборкаПоДоговорам.Выплаты <> 0 Тогда
										СтрокаВзносов.Простои = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,3);
										СтрокаВзносов.ОтпускаИницНаним = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,4);
									КонецЕсли;
								КонецЕсли;
								//СВЭЙ 16.01.2024 КВВ СВФР-012080 )
								
							КонецЕсли;
							//СВЭЙ 28.08.2023 КВВ СВФР-011258 (пункт 2) )
							
						ИначеЕсли ВыборкаПоДоговорам.Договор = 1 и (ВсеСотрудники или Основные) Тогда
							//О.Т. Аверсон 11.04.2019 № 4221 Чтоб записи по нулевым значениям по премиям не задвоились
							МассивОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц)); 
							Если МассивОВзносах.Количество()=0 Тогда 
								СтрокаВзносов = СведенияОВзносах.Добавить();
							иначе
								СтрокаВзносов = МассивОВзносах[0];
							КонецЕсли;
							//О.Т. Аверсон 11.04.2019 № 4221
							
							ДоговорПрошлПоСтроке = СтрокаВзносов.Договор;
							
							//Аверсон ЕАЕ 30.05.2022 СВФР-009112
							ВыплатыПрошлПоСтроке = СтрокаВзносов.Выплаты;
							ВзносыПрошлПоСтроке  = СтрокаВзносов.Взносы;
							ПособияПрошлПоСтроке = СтрокаВзносов.Пособия;
							//Аверсон СВФР-009112
							
							ЗаполнитьЗначенияСвойств(СтрокаВзносов,ВыборкаПоДоговорам);
							Если МассивОВзносах.Количество() > 0 Тогда
								СтрокаВзносов.Договор = ДоговорПрошлПоСтроке;
							КонецЕсли;
							
							//О.Т. Аверсон 17.04.2019 № 4246
							ЗапросЗаСвойСчет = Новый Запрос;
							ЗапросЗаСвойСчет.Текст = 
							"ВЫБРАТЬ
							|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
							//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В ( &МассивКод15 ) КАК ЭтоКод15,
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета 
							|		= ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты ) КАК ЭтоКод16,
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета 
							|		= ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ) КАК ЭтоКод19,
							//- СВЭЙ КДЯ 07.06.19 СВФР-004424
							|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета
							|ИЗ
							|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
							|ГДЕ
							|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия МЕЖДУ &ПериодДействия И &ПериодДействия1
							|	И ( ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
							//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
							|		ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В ( &МассивКод15 ) 
							|		ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета В
							|					( ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты ) 
							|					 , ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ) )
							|     )
							//- СВЭЙ КДЯ 07.06.19 СВФР-004424
							|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
							|
							|УПОРЯДОЧИТЬ ПО
							|	ПериодДействияНачало";
							ЗапросЗаСвойСчет.УстановитьПараметр("Сотрудник",ВыборкаПоДоговорам.Сотрудник);
							СписокВР = Новый СписокЗначений;
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыУчебный); //09
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул); //05
							//Аверсон 22.04.2020 КВВ СВФР-005887 (	
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоДням);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоЧасам);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифДневной);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифЧасовой);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойПоВинеРаботодателя);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойПоВинеРаботодателя);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойОкладПоЧасам);
							СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойТарифЧасовой);
							//Аверсон 22.04.2020 КВВ СВФР-005887 )
							//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
							ЗапросЗаСвойСчет.УстановитьПараметр( "МассивКод15", МассивКод15 );
							//- СВЭЙ КДЯ 07.06.19 СВФР-004424
							ЗапросЗаСвойСчет.УстановитьПараметр("ВидРасчета",СписокВР);
							ЗапросЗаСвойСчет.УстановитьПараметр("ПериодДействия",НачалоМесяца(ВыборкаПоДоговорам.Месяц));
							ЗапросЗаСвойСчет.УстановитьПараметр("ПериодДействия1",КонецМесяца(ВыборкаПоДоговорам.Месяц));
							РезЗаСвойСчет = ЗапросЗаСвойСчет.Выполнить().Выгрузить();
							МассивЗС = ТаблицаЗанимаемыеСтавки.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц)); 
							Если МассивЗС.Количество()>0 Тогда
								ЗанимаемыхСтавок = МассивЗС[0].ЗанимаемыхСтавок;
							иначе
								ЗанимаемыхСтавок = 0;	
							КонецЕсли;
							
							ЗапросПрочиеПричины = Новый Запрос;
							ЗапросПрочиеПричины.Текст = 
							"ВЫБРАТЬ
							|	ПрочиеПричиныМинимальнойЗаработнойПлаты.ПричиныМинимальнойЗаработнойПлаты
							|ИЗ
							|	РегистрСведений.ПрочиеПричиныМинимальнойЗаработнойПлаты КАК ПрочиеПричиныМинимальнойЗаработнойПлаты
							|ГДЕ
							|	ПрочиеПричиныМинимальнойЗаработнойПлаты.Сотрудник = &Сотрудник
							// + СВЭЙ КДЯ 22.07.19 СВФР-004561
							|	И ПрочиеПричиныМинимальнойЗаработнойПлаты.Организация = &Организация
							// - СВЭЙ КДЯ 22.07.19 СВФР-004561
							|	И ПрочиеПричиныМинимальнойЗаработнойПлаты.Период МЕЖДУ &Период И &Период1";
							
							
							// + СВЭЙ КДЯ 22.07.19 СВФР-004561
							ЗапросПрочиеПричины.УстановитьПараметр("Организация", ЭтотОбъект.Организация);
							// - СВЭЙ КДЯ 22.07.19 СВФР-004561
							ЗапросПрочиеПричины.УстановитьПараметр("Период", НачалоМесяца(ВыборкаПоДоговорам.Месяц));
							ЗапросПрочиеПричины.УстановитьПараметр("Период1", КонецМесяца(ВыборкаПоДоговорам.Месяц));
							ЗапросПрочиеПричины.УстановитьПараметр("Сотрудник", ВыборкаПоДоговорам.Сотрудник);
							
							РезПрочиеПричины = ЗапросПрочиеПричины.Выполнить().Выбрать();
							ПрочаяПричина = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();
							Пока РезПрочиеПричины.Следующий() Цикл
								ПрочаяПричина = РезПрочиеПричины.ПричиныМинимальнойЗаработнойПлаты;								
							КонецЦикла;	
							
							РазмерМинЗП = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ВыборкаПоДоговорам.Месяц),Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
							
							Если ВыборкаПоДоговорам.Договор = 1 Тогда 
								Если ЗначениеЗаполнено(ПрочаяПричина) Тогда 
									СтрокаВзносов.ПричиныМинимальнойЗП = ПрочаяПричина;
								иначе
									
									Если ВыборкаПоДоговорам.Выплаты + ВыборкаПоДоговорам.Пособия <= РазмерМинЗП и не ВыборкаПоДоговорам.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство Тогда 
										Если СтрокаВзносов.ПричиныМинимальнойЗП <> Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодОтпускаПоУходуЗаРебенкомДоДостиженияИмВозраста3Лет Тогда
											Если (ДатаПриема > НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ДатаПриема <= КонецМесяца(ВыборкаПоДоговорам.Месяц)) или
												(ДатаУвольнения <= КонецМесяца(ВыборкаПоДоговорам.Месяц) и ДатаУвольнения <> Дата(1,1,1)) Тогда								
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НеполноеРабочееВремяВСвязиСПриемомУвольнением;
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет)).Количество()>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОтпускБезСохраненияЗаработнойПлатыВСвязиСОбучениемПоСемейноБытовымИДругимУважительнымПричинам; 
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыУчебный)).Количество()>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОтпускБезСохраненияЗаработнойПлатыВСвязиСОбучениемПоСемейноБытовымИДругимУважительнымПричинам;
												//Аверсон 22.04.2020 КВВ СВФР-005887 (	
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоДням)).Количество()>0 ИЛИ
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоЧасам)).Количество()>0 ИЛИ 
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифДневной)).Количество()>0 ИЛИ 
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифЧасовой)).Количество()>0 ИЛИ 
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойПоВинеРаботодателя)).Количество()>0 ИЛИ 
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойОкладПоЧасам)).Количество()>0 ИЛИ
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойТарифЧасовой)).Количество()>0 ИЛИ
												РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойПоВинеРаботодателя)).Количество()>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ЦелодневныеЦелосменныеПростои;
												//Аверсон 22.04.2020 КВВ СВФР-005887 )
												//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод15", Истина  ) ).Количество() > 0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодВременнойНетрудоспособностиПоСправкеИлиНетПособия;
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод16", Истина  ) ).Количество() > 0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ИзРасчетаЧасовойМинимЗП;
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод19", Истина  ) ).Количество() > 0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОплачиваемыйОтпуск;
												//- СВЭЙ КДЯ 07.06.19 СВФР-004424
											ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул)).Количество()>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НарушениеТрудовоПроизводственноТехнологическойИсполнительскойДисциплины;
											ИначеЕсли ВыборкаПоДоговорам.Пособия > 0  Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодВременнойНетрудоспособности;  
											ИначеЕсли ЗанимаемыхСтавок < 1 и ЗанимаемыхСтавок>0 Тогда 
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НеполноеРабочееВремяПоСоглашениюМеждуРаботникомИНанимателем; 									
											КонецЕсли;	
										КонецЕсли;
									иначе
										СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();	
									КонецЕсли; 
								КонецЕсли;
							КонецЕсли;
							//О.Т. Аверсон 17.04.2019 № 4246
							
							
							//О.Т. Аверсон 29.01.2018 № 1511
							//+ СВЭЙ КДЯ 12.12.19 СВФР-005192
							//Если ВыборкаПоДоговорам.Выплаты > БазаОграниченияФСЗН Тогда 
							//	СтрокаВзносов.Выплаты = БазаОграниченияФСЗН;
							//иначе
							//	СтрокаВзносов.Выплаты = ВыборкаПоДоговорам.Выплаты;
							//КонецЕсли;
							//- СВЭЙ КДЯ 12.12.19 СВФР-005192
							
							//+ СВЭЙ КДЯ 12.12.19 СВФР-005192
							//берем данные из регистра
							
							//Аверсон ЕАЕ 30.05.2022 СВФР-009112
							//СтрокаВзносов.Выплаты = ВыборкаПоДоговорам.Выплаты;
							СтрокаВзносов.Выплаты = ВыплатыПрошлПоСтроке + ВыборкаПоДоговорам.Выплаты;
							СтрокаВзносов.Пособия = ПособияПрошлПоСтроке + ВыборкаПоДоговорам.Пособия;
							//Аверсон СВФР-009112
							
							//СВЭЙ 26.10.2023 КВВ СВФР-011519 (
							Если ВыборкаПоДоговорам.Пособия <> 0 Тогда
								СтрокаВзносов.ПособияБР = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,1,ВыборкаПоДоговорам.Договор); //СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5) (Договор)
								СтрокаВзносов.ОплатыДопДня = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,2);
								СтрокаВзносов.ПособияВН = ВыборкаПоДоговорам.Пособия - СтрокаВзносов.ПособияБР - СтрокаВзносов.ОплатыДопДня;
							КонецЕсли;
							
							Если ВыборкаПоДоговорам.Выплаты <> 0 Тогда
								СтрокаВзносов.Простои = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,3);
								СтрокаВзносов.ОтпускаИницНаним = ПроверкаСуммыПоПособиямВыплатам(ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц,4);
							КонецЕсли;
							//СВЭЙ 26.10.2023 КВВ СВФР-011519 )
							
							//- СВЭЙ КДЯ 12.12.19 СВФР-005192
							
							//О.Т. Аверсон 29.01.2018 № 1511
							если ОбъединятьОсновные и ВыборкаПоДоговорам.Договор = 1 Тогда
								СтрокаВзносов.Сотрудник = СтруктураПоискаВзносы.Сотрудник;
								СтрокаВзносов.ФизЛицо = СтруктураПоискаВзносы.ФизЛицо;
							КонецЕсли;
							
							если не ВыборкаПоДоговорам.Договор = 1 Тогда 
								СтрокаВзносов.ВидДоговора = ВыборкаПоДоговорам.Договор.Сотрудник.ВидДоговора;
							иначе
								СтрокаВзносов.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
							КонецЕсли;
							//если Основные и ВыборкаПоДоговорам.Договор <> 1 Тогда
							//	СтрокаВзносов.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
							//КонецЕсли;
							
							Если ВсегоВыплат <> 0 Тогда
								Взносы = ВыборкаПоДоговорам.Взносы*ВыборкаПоДоговорам.Выплаты/ВсегоВыплат;
								//Выплаты = ВсегоВыплат*ВыборкаПоДоговорам.Выплаты/ВсегоВыплат;
							Иначе
								Взносы = 0;
								//Выплаты = 0;
							КонецЕсли;
							
							//Аверсон ЕАЕ 30.05.2022 СВФР-009112
							//СтрокаВзносов.Взносы = Взносы;
							СтрокаВзносов.Взносы = ВзносыПрошлПоСтроке + Взносы;
							//Аверсон СВФР-009112
							
							//+ СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 72. )
							Если 	СтрокаВзносыВР <> Неопределено 
								И КонецМесяца( СтрокаВзносыВР.ДатаОкончанияРабот ) < СтрокаВзносов.Месяц 
								И СтрокаВзносыВР.Сотрудник = СтрокаВзносов.Сотрудник  
								И СтрокаВзносыВР.ВидДеятельности <> СТРАХСЛУЧ //СВЭЙ 17.10.2023 КВВ СВФР-011630
								И СтрокаВзносов.Выплаты > 0 Тогда
								
								СтрокаВзносыВР.ДатаОкончанияРабот = СтрокаВзносов.Месяц;	
								
							КонецЕсли; 
							//- СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 72. )
							
						КонецЕсли;
						
						
						//	СтрокаВзносов.Выплаты = Выплаты;
						если ВыборкаПоДоговорам.Договор <> 1 Тогда
							если ВыборкаПоДоговорам.ВидРасчетаОклад = 1 или ВыборкаПоДоговорам.ВидРасчетаОклад = null Тогда
							иначе
								если ВсеСотрудники или Основные Тогда 
									РезультатДоговор= 0;        
									
									ЗапросДог = Новый Запрос;
									ЗапросДог.Текст = 
									"ВЫБРАТЬ
									|	ЕСНСведенияОДоходах.Результат как Результат
									|ИЗ
									|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
									|ГДЕ
									|	ЕСНСведенияОДоходах.Сотрудник = &Сотрудник
									|	И ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1
									|	И ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН <> &ДоходБольничныйФСЗН";
									//|	И ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета = &СпособРасчета"; //О.Т. Аверсон 31.01.2017 № 244
									ЗапросДог.УстановитьПараметр("Сотрудник",СтруктураПоискаВзносы.Сотрудник);
									ЗапросДог.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
									ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов",НачалоМесяца(ВыборкаПоДоговорам.Месяц));
									ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов1",КонецМесяца(ВыборкаПоДоговорам.Месяц));
									//ЗапросДог.УстановитьПараметр("СпособРасчета",Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой);
									РезДог = ЗапросДог.Выполнить().Выбрать();
									пока РезДог.Следующий() Цикл 
										РезультатДоговор =РезультатДоговор+РезДог.Результат; 
									КонецЦикла;
									
									
									
									//О.Т. Аверсон 11.04.2019 № 4221 Чтоб записи по нулевым значениям по премиям не задвоились
									МассивОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц)); 
									Если МассивОВзносах.Количество()=0 Тогда 
										СтрокаВзносов = СведенияОВзносах.Добавить();
									иначе
										СтрокаВзносов = МассивОВзносах[0];
									КонецЕсли;
									//О.Т. Аверсон 11.04.2019 № 4221
									ДоговорПрошлПоСтроке = СтрокаВзносов.Договор;
									
									ЗаполнитьЗначенияСвойств(СтрокаВзносов,ВыборкаПоДоговорам);
									Если МассивОВзносах.Количество() > 0 Тогда
										СтрокаВзносов.Договор = ДоговорПрошлПоСтроке;
									КонецЕсли;
									
									
									//О.Т. Аверсон 17.04.2019 № 4246
									ЗапросЗаСвойСчет = Новый Запрос;
									ЗапросЗаСвойСчет.Текст = 
									"ВЫБРАТЬ
									|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
									//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
									|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В ( &МассивКод15 ) КАК ЭтоКод15,
									|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета 
									|		= ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты ) КАК ЭтоКод16,
									|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета 
									|		= ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ) КАК ЭтоКод19,
									//- СВЭЙ КДЯ 07.06.19 СВФР-004424
									|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета
									|ИЗ
									|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
									|ГДЕ
									|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия МЕЖДУ &ПериодДействия И &ПериодДействия1
									|	И ( ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
									//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
									|		ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В ( &МассивКод15 ) 
									|		ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета В
									|					( ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ДоплатаДоРазмераМинимальнойЗарплаты ) 
									|					 , ЗНАЧЕНИЕ( Перечисление.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуДляОтпускаПоКалендарнымДням ) )
									|     )
									//- СВЭЙ КДЯ 07.06.19 СВФР-004424
									|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
									|
									|УПОРЯДОЧИТЬ ПО
									|	ПериодДействияНачало";
									ЗапросЗаСвойСчет.УстановитьПараметр("Сотрудник",ВыборкаПоДоговорам.Сотрудник);
									СписокВР = Новый СписокЗначений;
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыУчебный); //09
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул); //05
									//Аверсон 22.04.2020 КВВ СВФР-005887 (	
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоДням);
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоЧасам);
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифДневной);
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифЧасовой);
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойПоВинеРаботодателя);
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойПоВинеРаботодателя);
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойОкладПоЧасам);
									СписокВР.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойТарифЧасовой);
									//Аверсон 22.04.2020 КВВ СВФР-005887 )
									//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
									ЗапросЗаСвойСчет.УстановитьПараметр( "МассивКод15", МассивКод15 );
									//- СВЭЙ КДЯ 07.06.19 СВФР-004424
									ЗапросЗаСвойСчет.УстановитьПараметр("ВидРасчета",СписокВР);
									ЗапросЗаСвойСчет.УстановитьПараметр("ПериодДействия",НачалоМесяца(ВыборкаПоДоговорам.Месяц));
									ЗапросЗаСвойСчет.УстановитьПараметр("ПериодДействия1",КонецМесяца(ВыборкаПоДоговорам.Месяц));
									РезЗаСвойСчет = ЗапросЗаСвойСчет.Выполнить().Выгрузить();
									МассивЗС = ТаблицаЗанимаемыеСтавки.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаПоДоговорам.Сотрудник,ВыборкаПоДоговорам.Месяц)); 
									Если МассивЗС.Количество()>0 Тогда
										ЗанимаемыхСтавок = МассивЗС[0].ЗанимаемыхСтавок;
									иначе
										ЗанимаемыхСтавок = 0;	
									КонецЕсли;
									
									ЗапросПрочиеПричины = Новый Запрос;
									ЗапросПрочиеПричины.Текст = 
									"ВЫБРАТЬ
									|	ПрочиеПричиныМинимальнойЗаработнойПлаты.ПричиныМинимальнойЗаработнойПлаты
									|ИЗ
									|	РегистрСведений.ПрочиеПричиныМинимальнойЗаработнойПлаты КАК ПрочиеПричиныМинимальнойЗаработнойПлаты
									|ГДЕ
									|	ПрочиеПричиныМинимальнойЗаработнойПлаты.Сотрудник = &Сотрудник
									// + СВЭЙ КДЯ 22.07.19 СВФР-004561
									|	И ПрочиеПричиныМинимальнойЗаработнойПлаты.Организация = &Организация
									// - СВЭЙ КДЯ 22.07.19 СВФР-004561
									|	И ПрочиеПричиныМинимальнойЗаработнойПлаты.Период МЕЖДУ &Период И &Период1";
									
									
									// + СВЭЙ КДЯ 22.07.19 СВФР-004561
									ЗапросПрочиеПричины.УстановитьПараметр("Организация", ЭтотОбъект.Организация);
									// - СВЭЙ КДЯ 22.07.19 СВФР-004561
									ЗапросПрочиеПричины.УстановитьПараметр("Период", НачалоМесяца(ВыборкаПоДоговорам.Месяц));
									ЗапросПрочиеПричины.УстановитьПараметр("Период1", КонецМесяца(ВыборкаПоДоговорам.Месяц));
									ЗапросПрочиеПричины.УстановитьПараметр("Сотрудник", ВыборкаПоДоговорам.Сотрудник);
									
									РезПрочиеПричины = ЗапросПрочиеПричины.Выполнить().Выбрать();
									ПрочаяПричина = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();
									Пока РезПрочиеПричины.Следующий() Цикл
										ПрочаяПричина = РезПрочиеПричины.ПричиныМинимальнойЗаработнойПлаты;								
									КонецЦикла;	
									
									РазмерМинЗП = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(ВыборкаПоДоговорам.Месяц),Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
									
									
									Если ВыборкаПоДоговорам.Договор = 1 Тогда 
										Если ЗначениеЗаполнено(ПрочаяПричина) Тогда 
											СтрокаВзносов.ПричиныМинимальнойЗП = ПрочаяПричина;
										иначе
											
											Если ВыборкаПоДоговорам.Выплаты + ВыборкаПоДоговорам.Пособия <= РазмерМинЗП и не ВыборкаПоДоговорам.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство Тогда 
												Если СтрокаВзносов.ПричиныМинимальнойЗП <> Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодОтпускаПоУходуЗаРебенкомДоДостиженияИмВозраста3Лет Тогда
													Если (ДатаПриема > НачалоМесяца(ВыборкаПоДоговорам.Месяц) и ДатаПриема <= КонецМесяца(ВыборкаПоДоговорам.Месяц)) или
														(ДатаУвольнения <= КонецМесяца(ВыборкаПоДоговорам.Месяц) и ДатаУвольнения <> Дата(1,1,1)) Тогда								
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НеполноеРабочееВремяВСвязиСПриемомУвольнением;
													ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет)).Количество()>0 Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОтпускБезСохраненияЗаработнойПлатыВСвязиСОбучениемПоСемейноБытовымИДругимУважительнымПричинам; 
													ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыУчебный)).Количество()>0 Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОтпускБезСохраненияЗаработнойПлатыВСвязиСОбучениемПоСемейноБытовымИДругимУважительнымПричинам;
														//Аверсон 22.04.2020 КВВ СВФР-005887 (	
													ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоДням)).Количество()>0 ИЛИ
														РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойОкладПоЧасам)).Количество()>0 ИЛИ 
														РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифДневной)).Количество()>0 ИЛИ 
														РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойТарифЧасовой)).Количество()>0 ИЛИ 
														РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПростойПоВинеРаботодателя)).Количество()>0 ИЛИ 
														РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойОкладПоЧасам)).Количество()>0 ИЛИ
														РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойТарифЧасовой)).Количество()>0 ИЛИ
														РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПочасовойПростойПоВинеРаботодателя)).Количество()>0 Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ЦелодневныеЦелосменныеПростои;
														//Аверсон 22.04.2020 КВВ СВФР-005887 )
														//+ СВЭЙ КДЯ 07.06.19 СВФР-004424
													ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод15", Истина  ) ).Количество() > 0 Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодВременнойНетрудоспособностиПоСправкеИлиНетПособия;
													ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод16", Истина  ) ).Количество() > 0 Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ИзРасчетаЧасовойМинимЗП;
													ИначеЕсли РезЗаСвойСчет.НайтиСтроки( Новый Структура( "ЭтоКод19", Истина  ) ).Количество() > 0 Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОплачиваемыйОтпуск;
														//- СВЭЙ КДЯ 07.06.19 СВФР-004424
													ИначеЕсли РезЗаСвойСчет.НайтиСтроки(Новый Структура("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул)).Количество()>0 Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НарушениеТрудовоПроизводственноТехнологическойИсполнительскойДисциплины;
													ИначеЕсли ВыборкаПоДоговорам.Пособия > 0  Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодВременнойНетрудоспособности;  
													ИначеЕсли ЗанимаемыхСтавок < 1 и ЗанимаемыхСтавок>0 Тогда 
														СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.НеполноеРабочееВремяПоСоглашениюМеждуРаботникомИНанимателем; 									
													КонецЕсли;		
												КонецЕсли;
											иначе
												СтрокаВзносов.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();	
											КонецЕсли;
										КонецЕсли;
									КонецЕсли;
									//О.Т. Аверсон 17.04.2019 № 4246
									
									
									//О.Т. Аверсон 29.01.2018 № 1511
									//+ СВЭЙ КДЯ 12.12.19 СВФР-005192
									//Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда
									//	СтрокаВзносов.Выплаты = ВыборкаПоДоговорам.Выплаты;
									//иначе
									//	Если ВыборкаПоДоговорам.Выплаты > БазаОграниченияФСЗН Тогда 
									//		СтрокаВзносов.Выплаты = БазаОграниченияФСЗН;
									//	иначе
									//		СтрокаВзносов.Выплаты = ВыборкаПоДоговорам.Выплаты;
									//	КонецЕсли;
									//КонецЕсли;
									//- СВЭЙ КДЯ 12.12.19 СВФР-005192
									
									//+ СВЭЙ КДЯ 12.12.19 СВФР-005192
									//берем данные из регистра
									СтрокаВзносов.Выплаты = ВыборкаПоДоговорам.Выплаты;
									//- СВЭЙ КДЯ 12.12.19 СВФР-005192
									
									//О.Т. Аверсон 29.01.2018 № 1511
									если ОбъединятьОсновные и ВыборкаПоДоговорам.Договор = 1 Тогда
										СтрокаВзносов.Сотрудник = СтруктураПоискаВзносы.Сотрудник;
										СтрокаВзносов.ФизЛицо = СтруктураПоискаВзносы.ФизЛицо;
									КонецЕсли;
									
									СтрокаВзносов.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
									
									//если Основные и ВыборкаПоДоговорам.Договор <> 1 Тогда
									//	СтрокаВзносов.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка();
									//КонецЕсли;
									//О.Т. Аверсон 29.08.2018 № 2363
									Если ЗначениеЗаполнено(ВыборкаПоДоговорам.Сотрудник.ВидНалогообложенияОсновной) Тогда 
										ОсновнойВидНалогообл = ВыборкаПоДоговорам.Сотрудник.ВидНалогообложенияОсновной;
									иначе
										ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
									КонецЕсли;
									//О.Т. Аверсон 29.08.2018 № 2363
									Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда
										СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ВыборкаПоДоговорам.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
										СтавкаФСЗН = СтруктураФСЗН.Размер;
										СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(ВыборкаПоДоговорам.Месяц),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
										СтавкаПенс = СтруктураПенс.Размер;
										Взносы = ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПоДоговорам.Выплаты * СтавкаФСЗН/100,ДатаРегистрации)+ОбщегоНазначения.ОкруглитьЗначение2016(ВыборкаПоДоговорам.Выплаты * СтавкаПенс/100,ДатаРегистрации)
									иначе
										
										Если ВсегоВыплат <> 0 Тогда
											Взносы = ВыборкаПоДоговорам.Взносы*ВыборкаПоДоговорам.Выплаты/ВсегоВыплат;
											//Выплаты = ВсегоВыплат*ВыборкаПоДоговорам.Выплаты/ВсегоВыплат;
										Иначе
											Взносы = 0;
											//Выплаты = 0;
										КонецЕсли;
									КонецЕсли;
									СтрокаВзносов.Взносы = Взносы;
									СтрокаВзносов.Выплаты = СтрокаВзносов.Выплаты - РезультатДоговор;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						//О.Т. Аверсон 18.04.2019 № 4246
						ЗапросЗаСвойСчет = Новый Запрос;
						ЗапросЗаСвойСчет.Текст = 
						"ВЫБРАТЬ
						|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
						|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
						|	МИНИМУМ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало) КАК ПериодДействияНачало,
						|	МАКСИМУМ(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец) КАК ПериодДействияКонец
						|ИЗ
						|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
						|ГДЕ
						|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ПериодДействия И &ПериодДействия1
						|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&ВидРасчета)
						|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
						|
						|СГРУППИРОВАТЬ ПО
						|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
						|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета";
						ЗапросЗаСвойСчет.УстановитьПараметр("Сотрудник",ВыборкаПоДоговорам.Сотрудник);
						ЗапросЗаСвойСчет.УстановитьПараметр("ВидРасчета",ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
						ЗапросЗаСвойСчет.УстановитьПараметр("ПериодДействия",НачалоМесяца(ВыборкаПоДоговорам.Месяц));
						ЗапросЗаСвойСчет.УстановитьПараметр("ПериодДействия1",КонецМесяца(ВыборкаПоДоговорам.Месяц));
						РезЗаСвойСчет = ЗапросЗаСвойСчет.Выполнить().Выгрузить();
						
						Для Каждого стрСвойСчет из РезЗаСвойСчет Цикл 
							ДатаНачДО = Макс(ДатаНачала,НачалоМесяца(стрСвойСчет.ПериодДействияНачало));
							ДатаКонДО = Мин(ДатаОкончания,НачалоМесяца(стрСвойСчет.ПериодДействияКонец));
							Пока ДатаНачДО <= ДатаКонДО Цикл
								МассивСвОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаПоДоговорам.Сотрудник,ДатаНачДО)); 
								Если МассивСвОВзносах.Количество()=0 Тогда 
									СтрокаСтажа = СведенияОВзносах.Добавить();
									ЗаполнитьЗначенияСвойств(СтрокаСтажа,ВыборкаПоДоговорам);
									СтрокаСтажа.Выплаты = 0;
									СтрокаСтажа.Взносы = 0;
									СтрокаСтажа.Пособия = 0;
									СтрокаСтажа.ТарифВзносов = 0;
									СтрокаСтажа.Месяц = ДатаНачДО; 
									СтрокаСтажа.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОтпускБезСохраненияЗаработнойПлатыВСвязиСОбучениемПоСемейноБытовымИДругимУважительнымПричинам;
									
									//СВЭЙ 26.10.2023 КВВ СВФР-011519 (
									СтрокаСтажа.ПособияБР = 0;
									СтрокаСтажа.ОплатыДопДня = 0;
									СтрокаСтажа.ПособияВН = 0;
									СтрокаСтажа.Простои = 0;
									СтрокаСтажа.ОтпускаИницНаним = 0;
									СтрокаСтажа.УдержОсужд = 0;
									//СВЭЙ 26.10.2023 КВВ СВФР-011519 )
									
								КонецЕсли;					
								ДатаНачДО = ДобавитьМесяц(ДатаНачДО,1);
							КонецЦикла;     							
						КонецЦикла; 
						//О.Т. Аверсон 18.04.2019 № 4246
					КонецЕсли;
				КонецЦикла;
			КонецЦикла;
		КонецЦикла;
		СведенияОВзносах.Свернуть("Сотрудник,ФизЛицо,Месяц,Выплаты,Пособия,Взносы,ТарифВзносов,Сотрудник,Договор,Категория,ВидДоговора,ПричиныМинимальнойЗП,Простои,ОтпускаИницНаним,УдержОсужд,ПособияВН,ПособияБР,ОплатыДопДня"); //СВЭЙ 26.10.2023 КВВ СВФР-011519 ("Простои,ОтпускаИницНаним,УдержОсужд,ПособияВН,ПособияБР,ОплатыДопДня")
		если ВсеСотрудники или Основные Тогда 
			ДатыОтпусковТекст = 
			"ВЫБРАТЬ
			|	Работники.Сотрудник КАК Сотрудник,
			|	Работники.ФизЛицо КАК ФизЛицо,
			|	Работники.ДатаС КАК ДатаС,
			|	Работники.Организация КАК Организация,
			|	&Дети КАК ВидДеятельности,
			|	Работники.ПериодЗавершения КАК ПериодЗавершения
			|ПОМЕСТИТЬ ВТДатыОтпусков
			|ИЗ
			|	(ВЫБРАТЬ
			|	ПлановыеНачисленияРаботниковОрганизаций.Сотрудник как Сотрудник,
			|	ПлановыеНачисленияРаботниковОрганизаций.Сотрудник.Физлицо как Физлицо,
			|	Выбор когда ПлановыеНачисленияРаботниковОрганизаций.Период < &НачалоГода тогда &НачалоГода иначе ПлановыеНачисленияРаботниковОрганизаций.Период конец как ДатаС,
			|	ПлановыеНачисленияРаботниковОрганизаций.Организация,
			|	ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения,
			|	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации
			|ИЗ
			|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
			|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоГода, ) КАК РаботникиОрганизацийСрезПоследних
			|			ПО ПлановыеНачисленияРаботниковОрганизаций.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
			
			|ГДЕ
			
			|ВЫБОР
			|			КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &НачалоГода
			|					И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения
			|			ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Действие
			|		КОНЕЦ <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|	И ВЫБОР
			|			КОГДА ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <= &НачалоГода
			|					И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			|				ТОГДА ВЫБОР
			|						КОГДА ПлановыеНачисленияРаботниковОрганизаций.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
			|							ТОГДА ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
			|						ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчетаЗавершения
			|					КОНЕЦ
			|			ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета
			|		КОНЕЦ = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)
			
			
			|	И (ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения >= &НачалоГода
			|	ИЛИ ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения = ДАТАВРЕМЯ(1, 1, 1))
			|	И ПлановыеНачисленияРаботниковОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
			|	И ПлановыеНачисленияРаботниковОрганизаций.Сотрудник.ВидЗанятости <> &ВнСовместитель
			|	И ВЫБОР
			|		КОГДА &ПоВсемФизЛицам
			|			ТОГДА ПлановыеНачисленияРаботниковОрганизаций.Сотрудник В (&СписокСотрудников)
			|			ИНАЧЕ ПлановыеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
			|	КОНЕЦ
			|	И ПлановыеНачисленияРаботниковОрганизаций.Период <= &ПериодВзаиморасчетов) КАК Работники";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ДатыОтпусковТекст = ДатыОтпусковТекст + " ГДЕ 
				
				//СВЭЙ 17.04.2024 КВВ СВФР-012815 (
				|(ВЫБОР КОГДА Работники.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство) 
				|ТОГДА ИСТИНА
				|ИНАЧЕ 
				//СВЭЙ 17.04.2024 КВВ СВФР-012815 )

				|Работники.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации) 
				|КОНЕЦ)
				|";
				
			КонецЕсли;                                                                                                         	
			ДатыОтпусковТекст = ДатыОтпусковТекст + "
			|;                                                                                               
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	Работники.Сотрудник,
			|	Работники.ФизЛицо КАК ФизЛицо,
			|	Работники.ДатаС КАК ДатаС,
			|	Работники.Организация КАК Организация,
			|	Работники.ВидДеятельности КАК ВидДеятельности,
			|	Работники.КодПоОКПДТР КАК КодПоОКПДТР
			|ПОМЕСТИТЬ ВТДатыДвижений
			|ИЗ
			|	(ВЫБРАТЬ
			|		РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
			|		РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК ФизЛицо,
			|		&НачалоГода КАК ДатаС,
			|		РаботникиОрганизацийСрезПоследних.Организация КАК Организация,
			|		РаботникиОрганизацийСрезПоследних.ВидДеятельностиИзмерение КАК ВидДеятельности,
			|		РаботникиОрганизацийСрезПоследних.Должность.КодПоОКПДТР КАК КодПоОКПДТР,
			|		РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации
			|	ИЗ
			|		РегистрСведений.РаботникиОрганизаций.СрезПоследних(
			|				&КонецПрошлогоГода,
			|				Организация = &СписокОтчитывающихсяПодразделений
			|				И Сотрудник.ВидЗанятости <> &ВнСовместитель
			//|					И НЕ ВидДеятельностиИзмерение.ИспользуетсяВПУ6
			|				И (ВЫБОР
			|					КОГДА &ПоВсемФизЛицам
			|						ТОГДА Сотрудник В (&СписокСотрудников)
			|						ИНАЧЕ
			|							Сотрудник = &Сотрудник КОНЕЦ) ) КАК РаботникиОрганизацийСрезПоследних
			|	ГДЕ
			|		РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния <> &Увольнение
			|		И Выбор когда РаботникиОрганизацийСрезПоследних.ВидДеятельностиИзмерение = Значение(справочник.ОсобыеУсловияТруда.ПустаяСсылка) 
			|			тогда ЛОЖЬ иначе 
			
			//Аверсон 19.10.2022 КВВ СВФР-009690 (
			//|не РаботникиОрганизацийСрезПоследних.ВидДеятельностиИзмерение.ИспользуетсяВПУ6 
			|ЛОЖЬ
			//Аверсон 19.10.2022 КВВ СВФР-009690 )
			
			|конец //О.Т. Аверсон 22.02.2018 № 1633 условие на пустую ссылку
			|	
			|	ОБЪЕДИНИТЬ ВСЕ
			|	
			|	ВЫБРАТЬ
			|		РаботникиОрганизаций.Сотрудник,
			|		РаботникиОрганизаций.Сотрудник.Физлицо,
			|		РаботникиОрганизаций.Период,
			|		РаботникиОрганизаций.Организация,
			|		РаботникиОрганизаций.ВидДеятельностиИзмерение,
			|		РаботникиОрганизаций.Должность.КодПоОКПДТР,
			|		РаботникиОрганизаций.ПодразделениеОрганизации
			|	ИЗ
			|		РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			|	ГДЕ
			|		РаботникиОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
			|		И РаботникиОрганизаций.Период МЕЖДУ &НачалоГода И &КонецГода
			|		И РаботникиОрганизаций.ПричинаИзмененияСостояния <> &Увольнение
			|		И РаботникиОрганизаций.Сотрудник.ВидЗанятости <> &ВнСовместитель
			|		И Выбор когда РаботникиОрганизаций.ВидДеятельностиИзмерение = Значение(справочник.ОсобыеУсловияТруда.ПустаяСсылка) 
			|			тогда ЛОЖЬ иначе не РаботникиОрганизаций.ВидДеятельностиИзмерение.ИспользуетсяВПУ6 конец //О.Т. Аверсон 22.02.2018 № 1633 условие на пустую ссылку
			|		И (ВЫБОР
			|			КОГДА &ПоВсемФизЛицам
			|				ТОГДА РаботникиОрганизаций.Сотрудник В (&СписокСотрудников)
			|				ИНАЧЕ
			|					РаботникиОрганизаций.Сотрудник = &Сотрудник КОНЕЦ) ) КАК Работники";
			Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
				ДатыОтпусковТекст = ДатыОтпусковТекст + " ГДЕ 
				
				//СВЭЙ 17.04.2024 КВВ СВФР-012815 (
				|(ВЫБОР КОГДА Работники.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство) 
				|ТОГДА ИСТИНА
				|ИНАЧЕ 
				//СВЭЙ 17.04.2024 КВВ СВФР-012815 )

				|Работники.ПодразделениеОрганизации В ИЕРАРХИИ (&ПодразделениеОрганизации) 
				|КОНЕЦ)
				|";
				
			КонецЕсли;                                                                                                         	
			ДатыОтпусковТекст = ДатыОтпусковТекст + "			
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ДатыНазначений1.ВидДеятельности КАК ВидДеятельности,
			|	ДатыНазначений1.Сотрудник КАК Сотрудник,
			|	ДатыНазначений1.ФизЛицо КАК ФизЛицо,
			|	ДатыНазначений1.ФизЛицо.СтатусКатегория КАК Категория,
			|	ДатыНазначений1.ДатаС КАК ДатаНачалаРабот,
			|	Выбор когда ЕСТЬNULL(МИНИМУМ(ДатыНазначений2.ПериодЗавершения), &КонецГода)> &ПериодВзаиморасчетов тогда &ПериодВзаиморасчетов иначе ЕСТЬNULL(МИНИМУМ(ДатыНазначений2.ПериодЗавершения), &КонецГода) конец КАК ДатаОкончанияРабот,
			|	ДатыНазначений1.ФизЛицо.СтраховойНомерПФР КАК ЛичныйНомер,
			|	ФИОФизЛицСрезПоследних.Фамилия,
			|	ФИОФизЛицСрезПоследних.Имя,
			|	ФИОФизЛицСрезПоследних.Отчество,
			|	ДатыНазначений1.КодПоОКПДТР КАК КодПоОКПДТР,
			|	АдресаРегистрации.Поле1 КАК ИндексРегистрации,
			|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9 КАК АдресРегистрации,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия КАК ПаспортСерия,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер КАК ПаспортНомер,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи КАК ПаспортДатаВыдачи,
			|	ДомашниеТелефоны.Поле3 КАК Телефоны,
			|	ВЫБОР
			|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL 
			|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
			|			ТОГДА &СтранаПоУмолчанию
			|		ИНАЧЕ ГражданствоФизЛиц.Страна
			|	КОНЕЦ КАК Гражданство,
			|	ДатыНазначений1.ФизЛицо.Пол КАК ФизЛицоПол,
			|	ДатыНазначений1.ФизЛицо.ДатаРождения КАК ФизЛицоДатаРождения,
			|	ДатыНазначений1.ФизЛицо.СтраховойНомерПФР КАК ФизЛицоСтраховойНомерПФР,
			|	ДатыНазначений1.ФизЛицо.МестоРождения КАК ФизЛицоМестоРождения,
			|	ВложенныйЗапрос.ДокументОснование,
			|	ГражданствоФизЛиц.НеИмеетПравоНаПенсию
			|ИЗ
			|	ВТДатыДвижений КАК ДатыНазначений1
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ДатыНазначений2
			|		ПО (ДатыНазначений2.Сотрудник = ДатыНазначений1.Сотрудник)
			|			И (ДатыНазначений2.Организация = ДатыНазначений1.Организация)
			|			И (ДатыНазначений2.Период > ДатыНазначений1.ДатаС)
			|			И (ДатыНазначений2.Период < &КонецГода)
			|			И (ДатыНазначений2.Сотрудник.ВидЗанятости <> &ВнСовместитель)
			|			И (НЕ ДатыНазначений2.ВидДеятельностиИзмерение.ИспользуетсяВПУ6)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&КонецГода, ) КАК ФИОФизЛицСрезПоследних
			|		ПО ДатыНазначений1.ФизЛицо = ФИОФизЛицСрезПоследних.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаРегистрации
			|		ПО ДатыНазначений1.ФизЛицо = АдресаРегистрации.Объект
			|			И (АдресаРегистрации.Вид = &ВидАдресаРегистрации)
			|			И (АдресаРегистрации.Тип = &ТипАдрес)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаФактические
			|		ПО ДатыНазначений1.ФизЛицо = АдресаФактические.Объект
			|			И (АдресаФактические.Тип = &ТипАдрес)
			|			И (АдресаФактические.Вид = &ВидАдресаФактический)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК ДомашниеТелефоны
			|		ПО ДатыНазначений1.ФизЛицо = ДомашниеТелефоны.Объект
			|			И (ДомашниеТелефоны.Вид = &ВидТелефонаДомашний)
			|			И (ДомашниеТелефоны.Тип = &ТипТелефон)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних КАК ПаспортныеДанныеФизЛицСрезПоследних
			|		ПО ДатыНазначений1.ФизЛицо = ПаспортныеДанныеФизЛицСрезПоследних.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних КАК ГражданствоФизЛиц
			|		ПО ДатыНазначений1.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			СУММА(ВЫБОР
			|					КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН 
			|							или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			//|							или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			|                     		) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			|						ТОГДА ЕСНСведенияОДоходах.Результат
			|					ИНАЧЕ 0
			|				КОНЕЦ) КАК Пособия,
			|			СУММА(ЕСНСведенияОДоходах.Результат
			|					) КАК Выплаты,
			|			ЕСНСведенияОДоходах.Сотрудник КАК Сотрудник,
			|			ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|			НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			|			ВЫБОР
			|				КОГДА ВложенныйЗапрос.Флаг
			|					ТОГДА &ДоговораПодряда
			|				ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
			|			КОНЕЦ КАК Категория,
			|			ВложенныйЗапрос.Регистратор КАК ДокументОснование
			|		ИЗ
			|			РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			|				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
			|					ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
			|					ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка КАК Регистратор,
			|					ВЫБОР
			|						КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка = &ПустойДоговор
			|							ТОГДА ЛОЖЬ
			|						ИНАЧЕ ИСТИНА
			|					КОНЕЦ КАК Флаг
			|				ИЗ
			|					РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
			|				ГДЕ
			|					ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом) КАК ВложенныйЗапрос
			|				ПО ЕСНСведенияОДоходах.Сотрудник = ВложенныйЗапрос.Сотрудник
			|					И (ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ ВложенныйЗапрос.Регистратор.ДатаНачала И ВложенныйЗапрос.Регистратор.ДатаОкончания)
			|		ГДЕ
			|			ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			|			//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений
			|			И (ВЫБОР
			|				КОГДА &ПоВсемФизЛицам
			|					ТОГДА ЕСНСведенияОДоходах.Сотрудник В (&СписокСотрудников)
			|					ИНАЧЕ
			|						ЕСНСведенияОДоходах.Сотрудник = &Сотрудник КОНЕЦ)			
			// + СВЭЙ КДЯ 22.07.19 СВФР-004561
			|			И ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
			// - СВЭЙ КДЯ 22.07.19 СВФР-004561
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ЕСНСведенияОДоходах.Сотрудник,
			|			ЕСНСведенияОДоходах.ФизЛицо,
			|			НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
			|			ВЫБОР
			|				КОГДА ВложенныйЗапрос.Флаг
			|					ТОГДА &ДоговораПодряда
			|				ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
			|			КОНЕЦ,
			|			ВложенныйЗапрос.Регистратор) КАК ВложенныйЗапрос
			|		ПО ДатыНазначений1.Сотрудник = ВложенныйЗапрос.Сотрудник
			|ГДЕ
			|	ДатыНазначений1.ДатаС <= &ПериодВзаиморасчетов
			|
			|СГРУППИРОВАТЬ ПО
			|	ДатыНазначений1.ВидДеятельности,
			|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия,
			|	АдресаРегистрации.Поле1,
			|	ДатыНазначений1.ФизЛицо,
			|	ДатыНазначений1.Сотрудник,
			|	ДатыНазначений1.ДатаС,
			|	ФИОФизЛицСрезПоследних.Фамилия,
			|	ФИОФизЛицСрезПоследних.Имя,
			|	ФИОФизЛицСрезПоследних.Отчество,
			|	ДатыНазначений1.КодПоОКПДТР,
			|	ВЫБОР
			|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL 
			|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
			|			ТОГДА &СтранаПоУмолчанию
			|		ИНАЧЕ ГражданствоФизЛиц.Страна
			|	КОНЕЦ,
			|	ДомашниеТелефоны.Поле3,
			|	ДатыНазначений1.ФизЛицо.СтатусКатегория,
			|	ДатыНазначений1.ФизЛицо.СтраховойНомерПФР,
			|	ДатыНазначений1.ФизЛицо.Пол,
			|	ДатыНазначений1.ФизЛицо.ДатаРождения,
			|	ДатыНазначений1.ФизЛицо.МестоРождения,
			|	ВложенныйЗапрос.ДокументОснование,
			|	ГражданствоФизЛиц.НеИмеетПравоНаПенсию,
			|	ДатыНазначений1.ФизЛицо.СтраховойНомерПФР
			|
			|ОБЪЕДИНИТЬ ВСЕ
			|
			|ВЫБРАТЬ
			|	ДатыОстпусков1.ВидДеятельности,
			|	ДатыОстпусков1.Сотрудник,
			|	ДатыОстпусков1.ФизЛицо,
			|	ДатыОстпусков1.ФизЛицо.СтатусКатегория,
			|	ДатыОстпусков1.ДатаС,
			|	ВЫБОР
			|		КОГДА ДатыОстпусков1.ПериодЗавершения > Выбор когда ЕСТЬNULL(МИНИМУМ(ДОБАВИТЬКДАТЕ(ДатыОстпусков2.ПериодЗавершения, СЕКУНДА, -1)), &КонецГода)> &ПериодВзаиморасчетов тогда &ПериодВзаиморасчетов иначе ЕСТЬNULL(МИНИМУМ(ДОБАВИТЬКДАТЕ(ДатыОстпусков2.ПериодЗавершения, СЕКУНДА, -1)), &КонецГода) конец
			|			ТОГДА Выбор когда ЕСТЬNULL(МИНИМУМ(ДОБАВИТЬКДАТЕ(ДатыОстпусков2.ПериодЗавершения, СЕКУНДА, -1)), &КонецГода)> &ПериодВзаиморасчетов тогда &ПериодВзаиморасчетов иначе ЕСТЬNULL(МИНИМУМ(ДОБАВИТЬКДАТЕ(ДатыОстпусков2.ПериодЗавершения, СЕКУНДА, -1)), &КонецГода) конец
			|		ИНАЧЕ ДатыОстпусков1.ПериодЗавершения
			|	КОНЕЦ,
			|	ДатыОстпусков1.ФизЛицо.СтраховойНомерПФР,
			|	ФИОФизЛицСрезПоследних.Фамилия,
			|	ФИОФизЛицСрезПоследних.Имя,
			|	ФИОФизЛицСрезПоследних.Отчество,
			|	NULL,
			|	АдресаРегистрации.Поле1,
			|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи,
			|	ДомашниеТелефоны.Поле3,
			|	ВЫБОР
			|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL 
			|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
			|			ТОГДА &СтранаПоУмолчанию
			|		ИНАЧЕ ГражданствоФизЛиц.Страна
			|	КОНЕЦ,
			|	ДатыОстпусков1.ФизЛицо.Пол,
			|	ДатыОстпусков1.ФизЛицо.ДатаРождения,
			|	ДатыОстпусков1.ФизЛицо.СтраховойНомерПФР,
			|	ДатыОстпусков1.ФизЛицо.МестоРождения,
			|	NULL,
			|	ГражданствоФизЛиц.НеИмеетПравоНаПенсию
			|ИЗ
			|	ВТДатыОтпусков КАК ДатыОстпусков1
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ДатыОстпусков2
			|		ПО (ДатыОстпусков2.Организация = ДатыОстпусков1.Организация)
			|			И (Выбор  когда ДатыОстпусков2.Период< &НачалоГода тогда &НачалоГода иначе ДатыОстпусков2.Период конец >= ДатыОстпусков1.ДатаС)
			|			И (ДатыОстпусков2.Период < &КонецГода)
			|			И (ДатыОстпусков2.ПериодЗавершения >= &НачалоГода)
			|			И (ДатыОстпусков2.Сотрудник.ВидЗанятости <> &ВнСовместитель)
			|			И ДатыОстпусков1.Сотрудник = ДатыОстпусков2.Сотрудник
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&КонецГода, ) КАК ФИОФизЛицСрезПоследних
			|		ПО ДатыОстпусков1.ФизЛицо = ФИОФизЛицСрезПоследних.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаРегистрации
			|		ПО ДатыОстпусков1.ФизЛицо = АдресаРегистрации.Объект
			|			И (АдресаРегистрации.Вид = &ВидАдресаРегистрации)
			|			И (АдресаРегистрации.Тип = &ТипАдрес)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаФактические
			|		ПО ДатыОстпусков1.ФизЛицо = АдресаФактические.Объект
			|			И (АдресаФактические.Тип = &ТипАдрес)
			|			И (АдресаФактические.Вид = &ВидАдресаФактический)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК ДомашниеТелефоны
			|		ПО ДатыОстпусков1.ФизЛицо = ДомашниеТелефоны.Объект
			|			И (ДомашниеТелефоны.Вид = &ВидТелефонаДомашний)
			|			И (ДомашниеТелефоны.Тип = &ТипТелефон)
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних КАК ПаспортныеДанныеФизЛицСрезПоследних
			|		ПО ДатыОстпусков1.ФизЛицо = ПаспортныеДанныеФизЛицСрезПоследних.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних КАК ГражданствоФизЛиц
			|		ПО ДатыОстпусков1.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
			|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|			СУММА(ВЫБОР
			|					КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН 
			|							или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			//|							или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			|                     		) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			|						ТОГДА ЕСНСведенияОДоходах.Результат
			|					ИНАЧЕ 0
			|				КОНЕЦ) КАК Пособия,
			|			СУММА(ЕСНСведенияОДоходах.Результат
			|					) КАК Выплаты,
			|			ЕСНСведенияОДоходах.Сотрудник КАК Сотрудник,
			|			ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|			НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			|			ВЫБОР
			|				КОГДА ВложенныйЗапрос.Флаг
			|					ТОГДА &ДоговораПодряда
			|				ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
			|			КОНЕЦ КАК Категория,
			|			ВложенныйЗапрос.Регистратор КАК ДокументОснование
			|		ИЗ
			|			РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			|				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
			|					ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник.Физлицо КАК СотрудникФизлицо,
			|					ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка КАК Регистратор,
			|					ВЫБОР
			|						КОГДА ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор.Ссылка = &ПустойДоговор
			|							ТОГДА ЛОЖЬ
			|						ИНАЧЕ ИСТИНА
			|					КОНЕЦ КАК Флаг
			|				ИЗ
			|					РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
			|				ГДЕ
			|					ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.ДоговорНаВыполнениеРаботСФизЛицом) КАК ВложенныйЗапрос
			|				ПО ЕСНСведенияОДоходах.Сотрудник = ВложенныйЗапрос.Сотрудник
			|					И (ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ ВложенныйЗапрос.Регистратор.ДатаНачала И ВложенныйЗапрос.Регистратор.ДатаОкончания)
			|		ГДЕ
			|			ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоГода И &КонецГода
			|			//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений
			|			И (ВЫБОР
			|				КОГДА &ПоВсемФизЛицам
			|					ТОГДА ЕСНСведенияОДоходах.Сотрудник В (&СписокСотрудников)
			|					ИНАЧЕ
			|						ЕСНСведенияОДоходах.Сотрудник = &Сотрудник КОНЕЦ)
			// + СВЭЙ КДЯ 22.07.19 СВФР-004561
			|			И ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
			// - СВЭЙ КДЯ 22.07.19 СВФР-004561
			|		
			|		СГРУППИРОВАТЬ ПО
			|			ЕСНСведенияОДоходах.Сотрудник,
			|			ЕСНСведенияОДоходах.ФизЛицо,
			|			НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
			|			ВЫБОР
			|				КОГДА ВложенныйЗапрос.Флаг
			|					ТОГДА &ДоговораПодряда
			|				ИНАЧЕ ЕСНСведенияОДоходах.ФизЛицо.СтатусКатегория
			|			КОНЕЦ,
			|			ВложенныйЗапрос.Регистратор) КАК ВложенныйЗапрос
			|		ПО ДатыОстпусков1.Сотрудник = ВложенныйЗапрос.Сотрудник
			|ГДЕ
			|	ДатыОстпусков1.ДатаС <= &ПериодВзаиморасчетов
			|	И ДатыОстпусков2.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)
			|
			|СГРУППИРОВАТЬ ПО
			|	АдресаРегистрации.Поле1,
			|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер,
			|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи,
			|	ДомашниеТелефоны.Поле3,
			|	ВЫБОР
			|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL 
			|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
			|			ТОГДА &СтранаПоУмолчанию
			|		ИНАЧЕ ГражданствоФизЛиц.Страна
			|	КОНЕЦ,
			|	ДатыОстпусков1.Сотрудник,
			|	ДатыОстпусков1.ВидДеятельности,
			|	ДатыОстпусков1.ФизЛицо,
			|	ДатыОстпусков1.ДатаС,
			|	ФИОФизЛицСрезПоследних.Фамилия,
			|	ФИОФизЛицСрезПоследних.Имя,
			|	ФИОФизЛицСрезПоследних.Отчество,
			|	ДатыОстпусков1.ФизЛицо.СтатусКатегория,
			|	ДатыОстпусков1.ФизЛицо.МестоРождения,
			|	ДатыОстпусков1.ФизЛицо.СтраховойНомерПФР,
			|	ДатыОстпусков1.ФизЛицо.ДатаРождения,
			|	ДатыОстпусков1.ФизЛицо.Пол,
			|	ДатыОстпусков1.ПериодЗавершения,
			|	ГражданствоФизЛиц.НеИмеетПравоНаПенсию,
			|	ДатыОстпусков1.ФизЛицо.СтраховойНомерПФР
			|
			|УПОРЯДОЧИТЬ ПО
			|	ФизЛицо";
			//О.Т. Аверсон 04.03.2016 № 940
			Если ОтборПоПериодуВзаиморасчетов Тогда 
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений","");
			иначе
				Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений","И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений");
			КонецЕсли;
			//О.Т. Аверсон 04.03.2016 № 940
			если сч = 1 Тогда 
				ДатыОтпусковТекст = СтрЗаменить(ДатыОтпусковТекст,"ВТДатыДвижений","ВТДатыДвижений1");
				ДатыОтпусковТекст = СтрЗаменить(ДатыОтпусковТекст,"ВТДатыОтпусков","ВТДатыОтпусков1");
				
			КонецЕсли;
			СтруктураПоиска = Новый Структура;
			СтруктураПоиска.Вставить("ФизЛицо");
			СтруктураПоиска.Вставить("Категория");
			
			Запрос.Текст = ДатыОтпусковТекст;
			Запрос.УстановитьПараметр("ПодразделениеОрганизации",ПодразделениеОрганизации);
			Результат = Запрос.Выполнить();
			Выборка = Результат.Выбрать();
			//	СтруктураПоиска.Договор = Документы.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка();
			
			СтруктураПоиска1 = Новый Структура;
			СтруктураПоиска1.Вставить("ФизЛицо");
			СтруктураПоиска1.Вставить("Категория");	
			СтруктураПоиска1.Вставить("ВидДеятельности");	
			
			//О.Т. Аверсон 02.02.2017 № 244
			СтруктураПоискаВзносыВрем = Новый Структура;
			СтруктураПоискаВзносыВрем.Вставить("ФизЛицо");
			СтруктураПоискаВзносыВрем.Вставить("Категория");	
			СтруктураПоискаВзносыВрем.Вставить("ВидДеятельности");
			//О.Т. Аверсон 02.02.2017 № 244
			
			Пока Выборка.Следующий() Цикл
				если Выборка.НеИмеетПравоНаПенсию = истина Тогда 
					Продолжить;	
				КонецЕсли;
				СтруктураПоиска.ФизЛицо = Выборка.ФизЛицо;
				СтруктураПоиска.Категория = Выборка.Категория;
				//СтруктураПоиска.ВидДоговора  = Неопределено;
				НайденныеСтроки = РаботникиОрганизации.НайтиСтроки(СтруктураПоиска);
				Если НайденныеСтроки.Количество() = 0 Тогда
					СтрокаРаботник = РаботникиОрганизации.Добавить();
					ЗаполнитьЗначенияСвойств(СтрокаРаботник,Выборка);
					
					//Аверсон ЕАЕ 19.09.2024 СВФР-013489
					СтрокаРаботник.ДатаРождения = Выборка.ФизЛицоДатаРождения;
					СтрокаРаботник.Пол          = Выборка.ФизЛицоПол;
					//Аверсон СВФР-013489
					
				КонецЕсли;
				//О.Т. Аверсон 02.02.2017 № 244
				СтруктураПоискаВзносыВрем.ФизЛицо = Выборка.ФизЛицо;
				СтруктураПоискаВзносыВрем.Категория = Выборка.Категория;
				СтруктураПоискаВзносыВрем.ВидДеятельности = ВзносыВрем;
				НайденныеСтрокиСтажа =  СведенияОСтаже.НайтиСтроки(СтруктураПоискаВзносыВрем);
				
				//О.Т. Аверсон 29.03.2019 № 4054
				МесяцПрошл = "";
				СведОСтажеПрошл = "";
				Для каждого СтрВзносыВрем Из НайденныеСтрокиСтажа Цикл
					если не МесяцПрошл = "" Тогда 
						Если МесяцПрошл >= СтрВзносыВрем.ДатаНачалаРабот и МесяцПрошл <= СтрВзносыВрем.ДатаОкончанияРабот	Тогда 
							СведОСтажеПрошл.ДатаОкончанияРабот = СтрВзносыВрем.ДатаНачалаРабот -1;
						КонецЕсли;          			
					КонецЕсли;
					МесяцПрошл = СтрВзносыВрем.ДатаОкончанияРабот;
					СведОСтажеПрошл = СтрВзносыВрем;
				КонецЦикла;
				//О.Т. Аверсон 29.03.2019 № 4054
				
				Для каждого СтрВзносыВрем Из НайденныеСтрокиСтажа Цикл
					Если Выборка.ДатаНачалаРабот	<= СтрВзносыВрем.ДатаНачалаРабот и Выборка.ДатаОкончанияРабот >= СтрВзносыВрем.ДатаОкончанияРабот Тогда 
						СтрВзносыВрем.ВидДеятельности = Премия;
						Дата1 = НачалоМесяца(СтрВзносыВрем.ДатаНачалаРабот);
						Дата2 = НачалоМесяца(СтрВзносыВрем.ДатаОкончанияРабот);
						сч1 = 1;
						Пока Дата1 <= Дата2 Цикл 
							Если не сч1 = 1 Тогда 
								СтрВзносыВрем1 = СведенияОСтаже.Добавить();
								ЗаполнитьЗначенияСвойств(СтрВзносыВрем1,СтрВзносыВрем);
								СтрВзносыВрем1.ДатаНачалаРабот = Дата1;
								
								СтрВзносыВрем1.ДатаОкончанияРабот = ?(НачалоМесяца(СтрВзносыВрем.ДатаОкончанияРабот) = Дата1,СтрВзносыВрем.ДатаОкончанияРабот,КонецМесяца(Дата1));
							КонецЕсли;
							
							Дата1 = ДобавитьМесяц(Дата1,1);
							сч1 = сч1+1;
						КонецЦикла;
						Если сч1>2 Тогда 
							СтрВзносыВрем.ДатаОкончанияРабот = КонецМесяца(СтрВзносыВрем.ДатаНачалаРабот);
						КонецЕсли; 					
					КонецЕсли;            				
				КонецЦикла;
				//О.Т. Аверсон 02.02.2017 № 244
				
				//О.Т. Аверсон 04.03.2019 № 4036
				ЗапросПрием.Текст = 
				"ВЫБРАТЬ
				|	РаботникиОрганизаций.Регистратор,
				|	РаботникиОрганизаций.Период КАК Период
				|ИЗ                                           
				|	ВТПрием КАК РаботникиОрганизаций
				|ГДЕ
				|	РаботникиОрганизаций.Сотрудник = &Сотрудник
				//+ СВЭЙ КДЯ 22.07.19 СВФР-004561 
				|УПОРЯДОЧИТЬ ПО
				|	Период	
				//- СВЭЙ КДЯ 22.07.19 СВФР-004561
				|";
				ТЗПриемУвольнениеСотрудника = Новый ТаблицаЗначений;
				ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаПриема");
				ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаУвольнения");
				
				ЗапросПрием.УстановитьПараметр("ПериодОкончания", КонецМесяца(ДатаОкончания));
				ЗапросПрием.УстановитьПараметр("Сотрудник", Выборка.Сотрудник);
				
				РезультПрием = ЗапросПрием.Выполнить().Выбрать();
				ДатаПриема = Дата(1,1,1);	
				Пока РезультПрием.Следующий() Цикл
					если ТипЗнч(РезультПрием.Регистратор) = Тип("ДокументСсылка.ПриемНаРаботуВОрганизацию") Тогда 
						если СтрТЗПриемУвольнениеСотрудника = Неопределено Тогда
							СтрТЗПриемУвольнениеСотрудника = ТЗПриемУвольнениеСотрудника.Добавить();
							СтрТЗПриемУвольнениеСотрудника.ДатаПриема = РезультПрием.Период;
						ИначеЕсли не СтрТЗПриемУвольнениеСотрудника.ДатаУвольнения = Неопределено Тогда 
							СтрТЗПриемУвольнениеСотрудника = ТЗПриемУвольнениеСотрудника.Добавить();
							СтрТЗПриемУвольнениеСотрудника.ДатаПриема = РезультПрием.Период; 
						КонецЕсли; 
						если СтрТЗПриемУвольнениеСотрудника.ДатаУвольнения = Неопределено Тогда 
							СтрТЗПриемУвольнениеСотрудника.ДатаУвольнения = ДатаОкончания;
						конецЕсли;
					КонецЕсли;
					если ТипЗнч(РезультПрием.Регистратор) = Тип("ДокументСсылка.УвольнениеИзОрганизаций") Тогда 
						если СтрТЗПриемУвольнениеСотрудника = Неопределено Тогда 
							СтрТЗПриемУвольнениеСотрудника = ТЗПриемУвольнениеСотрудника.Добавить();
						КонецЕсли;
						СтрТЗПриемУвольнениеСотрудника.ДатаУвольнения = РезультПрием.Период-86400;
						
					КонецЕсли;
					
				КонецЦикла;
				
				ДатаПриема = Дата(1,1,1);
				ДатаУвольнения = ДатаОкончания;
				Для Каждого СтрДата из ТЗПриемУвольнениеСотрудника Цикл
					// + СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 17. )
					//если СтрДата.ДатаПриема < ДатаНачала и СтрДата.ДатаУвольнения < ДатаНачала и СтрДата.ДатаУвольнения<>Дата(1,1,1) Тогда 
					// - СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 17. )
					// + СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 17. )
					Если ЗначениеЗаполнено( СтрДата.ДатаПриема )
						И ЗначениеЗаполнено( СтрДата.ДатаУвольнения )
						И СтрДата.ДатаПриема < ДатаНачала 
						И СтрДата.ДатаУвольнения < ДатаНачала Тогда
						// - СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 17. )
						Продолжить;
					КонецЕсли;
					Если не ЗначениеЗаполнено(ДатаПриема) Тогда 
						ДатаПриема = СтрДата.ДатаПриема;
					КонецЕсли;
					если СтрДата.ДатаУвольнения <>Дата(1,1,1) Тогда 
						ДатаУвольнения = СтрДата.ДатаУвольнения;
					КонецЕсли;
					
				КонецЦикла;
				
				СтруктураПоиска1.ФизЛицо = Выборка.ФизЛицо;
				СтруктураПоиска1.Категория = Выборка.Категория;
				СтруктураПоиска1.ВидДеятельности = Выборка.ВидДеятельности;
				НайденныеСтрокиСтажа =  СведенияОСтаже.НайтиСтроки(СтруктураПоиска1);
				
				Если НайденныеСтрокиСтажа.Количество() = 0 Тогда 
					
					СтрокаСтажа = СведенияОСтаже.Добавить();
					ЗаполнитьЗначенияСвойств(СтрокаСтажа,Выборка);
					СтрокаСтажа.ДатаОкончанияРабот = ?(СтрокаСтажа.ДатаОкончанияРабот>ДатаУвольнения,ДатаУвольнения,СтрокаСтажа.ДатаОкончанияРабот);
					СтрокаСтажа.ДатаНачалаРабот = ?(СтрокаСтажа.ДатаНачалаРабот<ДатаПриема,ДатаПриема,СтрокаСтажа.ДатаНачалаРабот);
					
					//О.Т. Аверсон 09.04.2019 № 4221
					ДатаНачДО = НачалоМесяца(СтрокаСтажа.ДатаНачалаРабот);
					ДатаКонДО = НачалоМесяца(СтрокаСтажа.ДатаОкончанияРабот);
					Пока  ДатаНачДО <= ДатаКонДО Цикл
						МассивСвОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",Выборка.Сотрудник,ДатаНачДО)); 
						Если МассивСвОВзносах.Количество()=0 Тогда 
							СтрокаСтажа = СведенияОВзносах.Добавить();
							ЗаполнитьЗначенияСвойств(СтрокаСтажа,Выборка);
							СтрокаСтажа.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодОтпускаПоУходуЗаРебенкомДоДостиженияИмВозраста3Лет;//О.Т. Аверсон 17.04.2019 № 4246
							СтрокаСтажа.Месяц = ДатаНачДО; 
						иначе
							РазмерМинЗП = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаНачДО,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
							
							Если МассивСвОВзносах[0].Выплаты + МассивСвОВзносах[0].Пособия <= РазмерМинЗП Тогда 
								МассивСвОВзносах[0].ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодОтпускаПоУходуЗаРебенкомДоДостиженияИмВозраста3Лет;//О.Т. Аверсон 17.04.2019 № 4246
							иначе
								МассивСвОВзносах[0].ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();	
							КонецЕсли;
						КонецЕсли;					
						ДатаНачДО = ДобавитьМесяц(ДатаНачДО,1);
					КонецЦикла;  					
					//О.Т. Аверсон 09.04.2019 № 4221
				Иначе //О.Т. Аверсон 08.04.2019 № 4203
					ЗаписьЕстьВПериоде = Ложь;
					Для Каждого Стр из НайденныеСтрокиСтажа Цикл 
						Если (Выборка.ДатаНачалаРабот >= Стр.ДатаНачалаРабот и Выборка.ДатаНачалаРабот <= Стр.ДатаОкончанияРабот) или
							(Выборка.ДатаОкончанияРабот >= Стр.ДатаНачалаРабот и Выборка.ДатаОкончанияРабот <= Стр.ДатаОкончанияРабот) Тогда 
							//СтрокаСтажа.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодОтпускаПоУходуЗаРебенкомДоДостиженияИмВозраста3Лет;//О.Т. Аверсон 17.04.2019 № 4246
							ЗаписьЕстьВПериоде = Истина;
						КонецЕсли;  						
					КонецЦикла;
					Если не ЗаписьЕстьВПериоде Тогда 
						СтрокаСтажа = СведенияОСтаже.Добавить();
						ЗаполнитьЗначенияСвойств(СтрокаСтажа,Выборка);
						СтрокаСтажа.ДатаОкончанияРабот = ?(СтрокаСтажа.ДатаОкончанияРабот>ДатаУвольнения,ДатаУвольнения,СтрокаСтажа.ДатаОкончанияРабот);
						СтрокаСтажа.ДатаНачалаРабот = ?(СтрокаСтажа.ДатаНачалаРабот<ДатаПриема,ДатаПриема,СтрокаСтажа.ДатаНачалаРабот);
						
						//О.Т. Аверсон 09.04.2019 № 4221
						ДатаНачДО = НачалоМесяца(СтрокаСтажа.ДатаНачалаРабот);
						ДатаКонДО = НачалоМесяца(СтрокаСтажа.ДатаОкончанияРабот);
						Пока ДатаНачДО <= ДатаКонДО Цикл
							МассивСвОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",Выборка.Сотрудник,ДатаНачДО)); 
							Если МассивСвОВзносах.Количество()=0 Тогда 
								СтрокаСтажа = СведенияОВзносах.Добавить();
								ЗаполнитьЗначенияСвойств(СтрокаСтажа,Выборка);
								СтрокаСтажа.Месяц = ДатаНачДО; 
								СтрокаСтажа.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодОтпускаПоУходуЗаРебенкомДоДостиженияИмВозраста3Лет;//О.Т. Аверсон 17.04.2019 № 4246
								
							иначе
								РазмерМинЗП = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаНачДО,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ)).Размер;
								
								Если МассивСвОВзносах[0].Выплаты + МассивСвОВзносах[0].Пособия <= РазмерМинЗП Тогда 
									МассивСвОВзносах[0].ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодОтпускаПоУходуЗаРебенкомДоДостиженияИмВозраста3Лет;//О.Т. Аверсон 17.04.2019 № 4246
								иначе
									МассивСвОВзносах[0].ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();	
								КонецЕсли;
								
							КонецЕсли;					
							ДатаНачДО = ДобавитьМесяц(ДатаНачДО,1);
						КонецЦикла;  					
						//О.Т. Аверсон 09.04.2019 № 4221
					КонецЕсли;
					
					//О.Т. Аверсон 08.04.2019 № 4203
				КонецЕсли;
				
				//Аверсон ЕАЕ 30.10.2025 СВФР-017030
				//Дата начала ВЗНОСЫВРЕМ не меньше, чем дата окончания отпуска по уходу
				Если ЗначениеЗаполнено(Выборка.ДатаОкончанияРабот) Тогда
					СтрПоискаВзносыВрем = Новый Структура;
					СтрПоискаВзносыВрем.Вставить("ФизЛицо", Выборка.ФизЛицо);
					СтрПоискаВзносыВрем.Вставить("ВидДеятельности", ВзносыВрем);
					НайденныеСтрокиСтажа = СведенияОСтаже.НайтиСтроки(СтрПоискаВзносыВрем);
					Для Каждого СтрСтаж Из НайденныеСтрокиСтажа Цикл
						Если Выборка.ДатаОкончанияРабот > СтрСтаж.ДатаНачалаРабот И Выборка.ДатаОкончанияРабот < СтрСтаж.ДатаОкончанияРабот Тогда
							СтрСтаж.ДатаНачалаРабот = Выборка.ДатаОкончанияРабот + 1;	
						КонецЕсли;
					КонецЦикла; 
				КонецЕсли;
				//Аверсон СВФР-017030
				
			КонецЦикла;
			
		КонецЕсли;
		сч = сч+1;
	КонецЦикла;
	
	
	//О.Т. Аверсон 14.05.2019 № 4328
	Если СотрПрошл <> "" Тогда 
		Если сч1 <> 0 и ЗначениеЗаполнено(ДоговорПрошл1) и ДоговорПрошл1 <> 1 Тогда 
			ДатаНачДО = ДатаНачала;
			ДатаКонДО = ДатаОкончания;
			Пока ДатаНачДО <= ДатаКонДО Цикл
				
				
				//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
				// Данный фрагмент построен конструктором.
				// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
				
				ЗапросДоговора = Новый Запрос;
				ЗапросДоговора.Текст = 
				"ВЫБРАТЬ
				|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка,
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
				|ИЗ
				|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
				|ГДЕ
				|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
				|	И (&Месяц МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала МЕЖДУ НАЧАЛОПЕРИОДА(&Месяц, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Месяц, МЕСЯЦ)
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания МЕЖДУ НАЧАЛОПЕРИОДА(&Месяц, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Месяц, МЕСЯЦ))
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен";
				
				ЗапросДоговора.УстановитьПараметр("Месяц", ДатаНачДО);
				ЗапросДоговора.УстановитьПараметр("Сотрудник", СотрПрошл);
				
				ВыборкаДетальныеЗаписи = ЗапросДоговора.Выполнить().Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					
					ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("Сотрудник,Договор",СотрПрошл,ВыборкаДетальныеЗаписи.Ссылка));
					Если ЗначСведенияОСтаже.Количество()> 0 Тогда 
						ЗначениеЕсть = Ложь;
						
						//Аверсон ЕАЕ 09.08.2022 СВФР-009383 (06.02.2025 СВФР-014733)
						ЗначениеВзносыВремЕсть = Ложь;
						//Аверсон СВФР-009383 (СВФР-014733)
						
						Для Каждого стрСведенияОстаже из ЗначСведенияОСтаже Цикл 
							Если ((стрСведенияОстаже.ДатаНачалаРабот >= ВыборкаДетальныеЗаписи.ДатаНачала И стрСведенияОстаже.ДатаНачалаРабот <= ВыборкаДетальныеЗаписи.ДатаОкончания) или
								(ВыборкаДетальныеЗаписи.ДатаНачала >= стрСведенияОстаже.ДатаНачалаРабот И ВыборкаДетальныеЗаписи.ДатаНачала <= стрСведенияОстаже.ДатаОкончанияРабот) или
								(ВыборкаДетальныеЗаписи.ДатаОкончания >= стрСведенияОстаже.ДатаНачалаРабот И ВыборкаДетальныеЗаписи.ДатаОкончания <= стрСведенияОстаже.ДатаОкончанияРабот)) и
								(ДатаНачДО >= НачалоМесяца(стрСведенияОстаже.ДатаНачалаРабот) и ДатаНачДО <= КонецМесяца(стрСведенияОстаже.ДатаОкончанияРабот)) Тогда 
								Дата1 = НачалоМесяца(стрСведенияОстаже.ДатаНачалаРабот);
								Дата2 = НачалоМесяца(стрСведенияОстаже.ДатаОкончанияРабот);    
								ВзносыЕсть = Ложь; 
								
								//СВЭЙ 08.10.25 СВФР-016398
								ПроверкаДата2 = СведенияОВзносах.Выгрузить(); 
								ОтборТЗ = Новый Структура;
								ОтборТЗ.Вставить("Сотрудник", СотрПрошл);
								СтрокиТЗ = ПроверкаДата2.НайтиСтроки(ОтборТЗ);
								Для Каждого СтрТЗ Из СтрокиТЗ Цикл
									Если СтрТЗ.Месяц > Дата2  Тогда
										Дата2 =  СтрТЗ.Месяц;
										прервать;
									КонецЕсли;
								КонецЦикла;
								//СВЭЙ 08.10.25 СВФР-016398

								Пока Дата1 <= Дата2 Цикл
									
									//Аверсон ЕАЕ 01.04.2021 СВФР-006959
									//ПроверкаВзносов = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",СотрПрошл,Дата1)); 
									ПроверкаВзносов = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Договор",СотрПрошл,ВыборкаДетальныеЗаписи.Ссылка)); 
									//Аверсон СВФР-006959
									
									Если ПроверкаВзносов.Количество()>0 Тогда 
										ВзносыЕсть = ПроверкаВзносов[0].Выплаты >0;
										// + СВЭЙ КДЯ 22.07.19 СВФР-004561
										Если ВзносыЕсть Тогда
											Прервать;	
										КонецЕсли; 
										// - СВЭЙ КДЯ 22.07.19 СВФР-004561
									КонецЕсли;   																		
									Дата1 = ДобавитьМесяц(Дата1,1);
									
								КонецЦикла;
								Если не ВзносыЕсть Тогда 
									стрСведенияОстаже.ВидДеятельности = НеоплДог;
								КонецЕсли;   								
								ЗначениеЕсть = Истина;
								
								//Аверсон ЕАЕ 09.08.2022 СВФР-009383 (06.02.2025 СВФР-014733)
								Если стрСведенияОстаже.ВидДеятельности = ВзносыВрем Тогда
									ЗначениеВзносыВремЕсть = Истина;
								КонецЕсли;
								//Аверсон СВФР-009383 (СВФР-014733)
								
							КонецЕсли;
						КонецЦикла;
						Если не ЗначениеЕсть Тогда  
							СтрокаСтажа = СведенияОСтаже.Добавить();
							СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
							СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
							
							//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
							СтрокаСтажа.Категория = КатегорияПрошл;
							//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
							
							СтрокаСтажа.Сотрудник = СотрПрошл;
							СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
							СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
							СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
							СтрокаСтажа.ВидДеятельности = НеоплДог;
						КонецЕсли;
						
						//Аверсон ЕАЕ 09.08.2022 СВФР-009383 (06.02.2025 СВФР-014733)
						Если Не ЗначениеВзносыВремЕсть Тогда
							СтрокаСтажа = СведенияОСтаже.Добавить();
							СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
							СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
							СтрокаСтажа.Категория = КатегорияПрошл;
							СтрокаСтажа.Сотрудник = СотрПрошл;
							СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
							СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
							СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
							СтрокаСтажа.ВидДеятельности = ВзносыВрем;
						КонецЕсли;
						//Аверсон СВФР-009383 (СВФР-014733)
						
					иначе
						СтрокаСтажа = СведенияОСтаже.Добавить();
						СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						
						//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
						СтрокаСтажа.Категория = КатегорияПрошл;
						//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
						
						СтрокаСтажа.Сотрудник = СотрПрошл;
						СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
						СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
						СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
						СтрокаСтажа.ВидДеятельности = НеоплДог;
						
						//Аверсон ЕАЕ 09.08.2022 СВФР-009383 (06.02.2025 СВФР-014733)
						СтрокаСтажа = СведенияОСтаже.Добавить();
						СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						СтрокаСтажа.Категория = КатегорияПрошл;
						СтрокаСтажа.Сотрудник = СотрПрошл;
						СтрокаСтажа.ФизЛицо = СотрПрошл.ФизЛицо;
						СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
						СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));  													
						СтрокаСтажа.ВидДеятельности = ВзносыВрем;
						//Аверсон СВФР-009383 (СВФР-014733)
						
					КонецЕсли;
					
					//Аверсон ЕАЕ 17.04.2025 СВФР-014605
					//Будем добавлять строки взносов по каждому договору
					//ЗначСведенияОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",СотрПрошл,ДатаНачДО));
					ЗначСведенияОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц,Договор",СотрПрошл,ДатаНачДО,ВыборкаДетальныеЗаписи.Ссылка));
					//Аверсон СВФР-014605
					
					если ЗначСведенияОВзносах.Количество()=0 Тогда   
						СтрокаВзносов = СведенияОВзносах.Добавить();
						
						//Аверсон ЕАЕ 07.04.2021 СВФР-006959
						//СтрокаВзносов.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						
						//Аверсон ЕАЕ 17.04.2025 СВФР-014605
						//СтрокаВзносов.Договор = Документы.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка();
						СтрокаВзносов.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						//Аверсон СВФР-014605
						
						//Аверсон СВФР-006959
						
						СтрокаВзносов.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						СтрокаВзносов.Категория = КатегорияПрошл;
						СтрокаВзносов.Сотрудник = СотрПрошл;
						СтрокаВзносов.ФизЛицо = СотрПрошл.ФизЛицо;
						СтрокаВзносов.Месяц = ДатаНачДО;
					КонецЕсли;
					
				КонецЦикла;	
				
				ДатаНачДО = ДобавитьМесяц(ДатаНачДО,1);
			КонецЦикла; 	
		КонецЕсли;
	КонецЕсли;	
	//О.Т. Аверсон 14.05.2019 № 4328
	
	//О.Т. Аверсон 16.05.2019 № 4328	
	Если ВсеСотрудники или ДогПодряда Тогда 
		Если Сотрудник = Неопределено Тогда 
			ДобавлятьСотрудника = Истина;
		иначе
			ЗначСведенияОРабОрг = РаботникиОрганизации.НайтиСтроки(Новый Структура("Сотрудник",Сотрудник));
			ПроверкаВзносов = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник",Сотрудник));
			ПроверкаОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("Сотрудник",Сотрудник));
			Если ЗначСведенияОРабОрг.Количество()>0 и ПроверкаВзносов.Количество()=0 и ПроверкаОСтаже.Количество() = 0 Тогда
				ДобавлятьСотрудника = Истина;
			иначе
				ДобавлятьСотрудника = Ложь;
			КонецЕсли;	
			
			
		КонецЕсли;
		
		
		Если ДобавлятьСотрудника Тогда 
			
			// + СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
			ЭтоПерваяИтерация = Истина;
			// + СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
			
			ДатаНачДО = ДатаНачала;
			ДатаКонДО = ДатаОкончания;
			Пока ДатаНачДО <= ДатаКонДО Цикл
				
				
				//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
				// Данный фрагмент построен конструктором.
				// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
				
				ЗапросДоговора = Новый Запрос;
				ЗапросДоговора.Текст = 
				"ВЫБРАТЬ
				|	ДоговорНаВыполнениеРаботСФизЛицом.Ссылка,
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала,
				|	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания,
				|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник,
				|	ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо,
				|	&ДоговораПодряда как Категория
				|ИЗ
				|	Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
				|ГДЕ ";
				
				// + СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
				//Если Сотрудник = Неопределено тогда 
				//	ЗапросДоговора.Текст = ЗапросДоговора.Текст + "	
				//	|	НЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В (&СписокСотрудников)";
				//иначе
				//	ЗапросДоговора.Текст = ЗапросДоговора.Текст + "	
				//	|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В (&СписокСотрудников)";
				//КонецЕсли;
				//ЗапросДоговора.УстановитьПараметр("СписокСотрудников", ?(Сотрудник=Неопределено,РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник"),Сотрудник));
				// - СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
				
				// + СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
				ЗапросДоговора.УстановитьПараметр( "СписокУжеЗаполненныхСотрудников", РаботникиОрганизации.ВыгрузитьКолонку( "Сотрудник" ) );
				Если Сотрудник <> Неопределено тогда 
					ЗапросДоговора.УстановитьПараметр( "Сотрудник", Сотрудник );
					ЗапросДоговора.Текст = ЗапросДоговора.Текст + "	
					|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотрудник
					
					//Аверсон ЕАЕ 06.03.2025 СВФР-014605
					//Выводился только один договор
					//|	" + ?( ЭтоПерваяИтерация, "", "И НЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В ( &СписокУжеЗаполненныхСотрудников )" );
					|	" + ?( ЭтоПерваяИтерация, "", "И ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В ( &СписокУжеЗаполненныхСотрудников )" );
					//Аверсон СВФР-014605
					
				иначе
					ЗапросДоговора.УстановитьПараметр( "СписокСотрудников", СписокСотрудников );
					ЗапросДоговора.Текст = ЗапросДоговора.Текст + "	
					|	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В ( &СписокСотрудников )
					
					//Аверсон ЕАЕ 06.03.2025 СВФР-014605
					//Выводился только один договор
					//|	И НЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В ( &СписокУжеЗаполненныхСотрудников )";
					|	И ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник В ( &СписокУжеЗаполненныхСотрудников )";
					//Аверсон СВФР-014605
					
				КонецЕсли;
				// - СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
				
				ЗапросДоговора.Текст = ЗапросДоговора.Текст + "	
				|	И (&Месяц МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала И ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала МЕЖДУ НАЧАЛОПЕРИОДА(&Месяц, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Месяц, МЕСЯЦ)
				|			ИЛИ ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания МЕЖДУ НАЧАЛОПЕРИОДА(&Месяц, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Месяц, МЕСЯЦ))
				|	И ДоговорНаВыполнениеРаботСФизЛицом.Проведен";
				
				Если ЗначениеЗаполнено(ПодразделениеОрганизации) Тогда 
					ЗапросДоговора.Текст = ЗапросДоговора.Текст + "	
					|	И ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации В  ИЕРАРХИИ (&МассивПодразделений)";
					МассивПодразделений = Новый Массив();
					МассивПодразделений.Добавить(ПодразделениеОрганизации);
					ЗапросДоговора.УстановитьПараметр("МассивПодразделений", МассивПодразделений);  					  
				КонецЕсли;	
				ЗапросДоговора.УстановитьПараметр("Месяц", ДатаНачДО);
				
				//СВЭЙ 25.04.2024 КВВ СВФР-012944 (пункт 2) (
				//ЗапросДоговора.УстановитьПараметр("ДоговораПодряда" , Справочники.КатегорииЗастрахованныхЛиц.НайтиПоРеквизиту("КодПФР","03"));
				ЗапросДоговора.УстановитьПараметр("ДоговораПодряда" , Справочники.КатегорииЗастрахованныхЛиц.ПустаяСсылка());
				//СВЭЙ 25.04.2024 КВВ СВФР-012944 (пункт 2) )
				
				ВыборкаДетальныеЗаписи = ЗапросДоговора.Выполнить().Выбрать();
				
				Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					
					ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("Сотрудник,Договор",ВыборкаДетальныеЗаписи.Сотрудник,ВыборкаДетальныеЗаписи.Ссылка));
					Если ЗначСведенияОСтаже.Количество()> 0 Тогда 
						ЗначениеЕсть = Ложь;
						Для Каждого стрСведенияОстаже из ЗначСведенияОСтаже Цикл 
							Если ((стрСведенияОстаже.ДатаНачалаРабот >= ВыборкаДетальныеЗаписи.ДатаНачала И стрСведенияОстаже.ДатаНачалаРабот <= ВыборкаДетальныеЗаписи.ДатаОкончания) или
								(ВыборкаДетальныеЗаписи.ДатаНачала >= стрСведенияОстаже.ДатаНачалаРабот И ВыборкаДетальныеЗаписи.ДатаНачала <= стрСведенияОстаже.ДатаОкончанияРабот) или
								(ВыборкаДетальныеЗаписи.ДатаОкончания >= стрСведенияОстаже.ДатаНачалаРабот И ВыборкаДетальныеЗаписи.ДатаОкончания <= стрСведенияОстаже.ДатаОкончанияРабот)) и
								(ДатаНачДО >= НачалоМесяца(стрСведенияОстаже.ДатаНачалаРабот) и ДатаНачДО <= КонецМесяца(стрСведенияОстаже.ДатаОкончанияРабот)) Тогда 
								Дата1 = НачалоМесяца(стрСведенияОстаже.ДатаНачалаРабот);
								Дата2 = НачалоМесяца(стрСведенияОстаже.ДатаОкончанияРабот);    
								ВзносыЕсть = Ложь; 
								
								//СВЭЙ 08.10.25 СВФР-016398
								ПроверкаДата2 = СведенияОВзносах.Выгрузить(); 
								ОтборТЗ = Новый Структура;
								ОтборТЗ.Вставить("Сотрудник", ВыборкаДетальныеЗаписи.Сотрудник);
								СтрокиТЗ = ПроверкаДата2.НайтиСтроки(ОтборТЗ);
								Для Каждого СтрТЗ Из СтрокиТЗ Цикл
									Если СтрТЗ.Месяц > Дата2  Тогда
										Дата2 =  СтрТЗ.Месяц;
										прервать;
									КонецЕсли;
								КонецЦикла;
								//СВЭЙ 08.10.25 СВФР-016398

								Пока Дата1 <= Дата2 Цикл
									
									ПроверкаВзносов = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаДетальныеЗаписи.Сотрудник,Дата1)); 
									Если ПроверкаВзносов.Количество()>0 Тогда 
										ВзносыЕсть = ПроверкаВзносов[0].Выплаты >0;
										// + СВЭЙ КДЯ 22.07.19 СВФР-004561
										Если ВзносыЕсть Тогда
											Прервать;	
										КонецЕсли; 
										// - СВЭЙ КДЯ 22.07.19 СВФР-004561
									КонецЕсли;   																		
									Дата1 = ДобавитьМесяц(Дата1,1);
									
								КонецЦикла;
								Если не ВзносыЕсть Тогда 
									стрСведенияОстаже.ВидДеятельности = НеоплДог;
								КонецЕсли;   								
								ЗначениеЕсть = Истина;
							КонецЕсли;
						КонецЦикла;
						Если не ЗначениеЕсть Тогда  
							СтрокаСтажа = СведенияОСтаже.Добавить();
							СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
							СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
							
							//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
							СтрокаСтажа.Категория = ВыборкаДетальныеЗаписи.Категория;
							//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
							
							СтрокаСтажа.Сотрудник = ВыборкаДетальныеЗаписи.Сотрудник;
							СтрокаСтажа.ФизЛицо = ВыборкаДетальныеЗаписи.Сотрудник.ФизЛицо;
							СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
							
							//Аверсон ЕАЕ 14.01.2025 СВФР-014563
							//СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО)); 
							Если ДатаОкончания >= '20241231' И (ВсеСотрудники ИЛИ ДогПодряда) Тогда
								СтрокаСтажа.ДатаОкончанияРабот = Макс(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));
							Иначе
								СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));
							КонецЕсли;
							//Аверсон СВФР-014563
							
							СтрокаСтажа.ВидДеятельности = НеоплДог;
						КонецЕсли;
					иначе
						СтрокаСтажа = СведенияОСтаже.Добавить();
						СтрокаСтажа.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						СтрокаСтажа.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						
						//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
						СтрокаСтажа.Категория = ВыборкаДетальныеЗаписи.Категория;
						//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
						
						СтрокаСтажа.Сотрудник = ВыборкаДетальныеЗаписи.Сотрудник;
						СтрокаСтажа.ФизЛицо = ВыборкаДетальныеЗаписи.Сотрудник.ФизЛицо;
						СтрокаСтажа.ДатаНачалаРабот = Макс(ВыборкаДетальныеЗаписи.ДатаНачала,ДатаНачДО);
						
						//Аверсон ЕАЕ 14.01.2025 СВФР-014563
						//СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО)); 
						Если ДатаОкончания >= '20241231' И (ВсеСотрудники ИЛИ ДогПодряда) Тогда
							СтрокаСтажа.ДатаОкончанияРабот = Макс(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО)); 
						Иначе
							СтрокаСтажа.ДатаОкончанияРабот = Мин(ВыборкаДетальныеЗаписи.ДатаОкончания,КонецМесяца(ДатаНачДО));
						КонецЕсли;
						//Аверсон СВФР-014563
						
						СтрокаСтажа.ВидДеятельности = НеоплДог;
					КонецЕсли;
					
					ЗначСведенияОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаДетальныеЗаписи.Сотрудник,ДатаНачДО));
					если ЗначСведенияОВзносах.Количество()=0 Тогда   
						СтрокаВзносов = СведенияОВзносах.Добавить();
						СтрокаВзносов.Договор = ВыборкаДетальныеЗаписи.Ссылка;
						СтрокаВзносов.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						СтрокаВзносов.Категория = ВыборкаДетальныеЗаписи.Категория;
						СтрокаВзносов.Сотрудник = ВыборкаДетальныеЗаписи.Сотрудник;
						СтрокаВзносов.ФизЛицо = ВыборкаДетальныеЗаписи.Сотрудник.ФизЛицо;
						СтрокаВзносов.Месяц = ДатаНачДО;
					КонецЕсли;
					
					ЗначСведенияОВзносах = РаботникиОрганизации.НайтиСтроки(Новый Структура("Сотрудник",ВыборкаДетальныеЗаписи.Сотрудник));
					если ЗначСведенияОВзносах.Количество()=0 Тогда 
						
						
						ЗапросРабОрг = Новый Запрос;
						ЗапросРабОрг.Текст = 
						"ВЫБРАТЬ
						|	ВТФСЗНДоходы.Ссылка КАК Сотрудник,
						|	ВТФСЗНДоходы.Физлицо КАК ФизЛицо,
						|	ВТФСЗНДоходы.Физлицо.СтраховойНомерПФР КАК ЛичныйНомер,
						|	ФИОФизЛицСрезПоследних.Фамилия КАК Фамилия,
						|	ФИОФизЛицСрезПоследних.Имя КАК Имя,
						|	ФИОФизЛицСрезПоследних.Отчество КАК Отчество,
						|	АдресаРегистрации.Поле1 КАК ИндексРегистрации,
						|	АдресаРегистрации.Поле2 + "","" + АдресаРегистрации.Поле3 + "","" + АдресаРегистрации.Поле4 + "","" + АдресаРегистрации.Поле5 + "","" + АдресаРегистрации.Поле6 + "","" + АдресаРегистрации.Поле7 + "","" + АдресаРегистрации.Поле8 + "","" + АдресаРегистрации.Поле9 КАК АдресРегистрации,
						|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументСерия КАК ПаспортСерия,
						|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументНомер КАК ПаспортНомер,
						|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументДатаВыдачи КАК ПаспортДатаВыдачи,
						|	ПаспортныеДанныеФизЛицСрезПоследних.ДокументКемВыдан КАК ПаспортКемВыдан,
						|	ДомашниеТелефоны.Поле3 КАК Телефоны,
						|	ВЫБОР
						|		КОГДА ГражданствоФизЛиц.ФизЛицо ЕСТЬ NULL
						|				ИЛИ ГражданствоФизЛиц.Страна = &ПустаяСтрана
						|			ТОГДА &СтранаПоУмолчанию
						|		ИНАЧЕ ГражданствоФизЛиц.Страна
						|	КОНЕЦ КАК Гражданство,
						|	ВТФСЗНДоходы.Физлицо.Пол КАК Пол,
						|	ВТФСЗНДоходы.Физлицо.ДатаРождения КАК ДатаРождения,
						|	ВТФСЗНДоходы.Физлицо.СтраховойНомерПФР КАК СтраховойНомерПФР,
						|	ВТФСЗНДоходы.Физлицо.МестоРождения КАК МестоРождения,
						|	&ДоговораПодряда как Категория,
						|	ГражданствоФизЛиц.НеИмеетПравоНаПенсию
						|ИЗ
						|	Справочник.СотрудникиОрганизаций КАК ВТФСЗНДоходы
						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&КонецГода, ) КАК ФИОФизЛицСрезПоследних
						|		ПО ВТФСЗНДоходы.Физлицо = ФИОФизЛицСрезПоследних.ФизЛицо
						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаРегистрации
						|		ПО ВТФСЗНДоходы.Физлицо = АдресаРегистрации.Объект
						|			И (АдресаРегистрации.Вид = &ВидАдресаРегистрации)
						|			И (АдресаРегистрации.Тип = &ТипАдрес)
						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК АдресаФактические
						|		ПО ВТФСЗНДоходы.Физлицо = АдресаФактические.Объект
						|			И (АдресаФактические.Тип = &ТипАдрес)
						|			И (АдресаФактические.Вид = &ВидАдресаФактический)
						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КонтактнаяИнформация КАК ДомашниеТелефоны
						|		ПО ВТФСЗНДоходы.Физлицо = ДомашниеТелефоны.Объект
						|			И (ДомашниеТелефоны.Вид = &ВидТелефонаДомашний)
						|			И (ДомашниеТелефоны.Тип = &ТипТелефон)
						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних КАК ПаспортныеДанныеФизЛицСрезПоследних
						|		ПО ВТФСЗНДоходы.Физлицо = ПаспортныеДанныеФизЛицСрезПоследних.ФизЛицо
						|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&ДатаПодачиСведений, ) КАК ГражданствоФизЛиц
						|		ПО ВТФСЗНДоходы.Физлицо = ГражданствоФизЛиц.ФизЛицо
						|ГДЕ
						|	ВТФСЗНДоходы.Ссылка = &Сотрудник
						|";
						
						ЗапросРабОрг.УстановитьПараметр("ВидАдресаРегистрации" , 	Справочники.ВидыКонтактнойИнформации.ЮрАдресФизЛица);
						ЗапросРабОрг.УстановитьПараметр("ВидАдресаФактический" , 	Справочники.ВидыКонтактнойИнформации.ФактАдресФизЛица);
						ЗапросРабОрг.УстановитьПараметр("ВидТелефонаДомашний" , 	Справочники.ВидыКонтактнойИнформации.ТелефонФизЛица);
						ЗапросРабОрг.УстановитьПараметр("ТипТелефон" , 	Перечисления.ТипыКонтактнойИнформации.Телефон);
						ЗапросРабОрг.УстановитьПараметр("ТипАдрес" , 	Перечисления.ТипыКонтактнойИнформации.Адрес);
						ЗапросРабОрг.УстановитьПараметр("ПустаяСтрана" , Справочники.КлассификаторСтранМира.ПустаяСсылка());
						ЗапросРабОрг.УстановитьПараметр("СтранапоУмолчанию" , Справочники.КлассификаторСтранМира.НайтиПоКоду("112"));
						
						//СВЭЙ 25.04.2024 КВВ СВФР-012944 (пункт 2) (
						//ЗапросРабОрг.УстановитьПараметр("ДоговораПодряда" , Справочники.КатегорииЗастрахованныхЛиц.НайтиПоРеквизиту("КодПФР","03"));
						ЗапросРабОрг.УстановитьПараметр("ДоговораПодряда" , Справочники.КатегорииЗастрахованныхЛиц.ПустаяСсылка());
						//СВЭЙ 25.04.2024 КВВ СВФР-012944 (пункт 2) )
				
						ЗапросРабОрг.УстановитьПараметр("ДатаПодачиСведений", ДатаОкончания);
						ЗапросРабОрг.УстановитьПараметр("КонецГода", КонецГода(ДатаОкончания));
						ЗапросРабОрг.УстановитьПараметр("Сотрудник", ВыборкаДетальныеЗаписи.Сотрудник);
						
						
						РезРабОрг = ЗапросРабОрг.Выполнить().Выбрать();
						
						Пока РезРабОрг.Следующий() Цикл
							СтрокаРабОрг = РаботникиОрганизации.Добавить();
							ЗаполнитьЗначенияСвойств(СтрокаРабОрг,РезРабОрг);
							СтрокаРабОрг.ВидДоговора = ВыборкаДетальныеЗаписи.Ссылка.Сотрудник.ВидДоговора;
						КонецЦикла;
						
					иначе
						ЗначСведенияОРабОрг = РаботникиОрганизации.НайтиСтроки(Новый Структура("Сотрудник",ВыборкаДетальныеЗаписи.Сотрудник));
						Для Каждого стрСв из ЗначСведенияОРабОрг Цикл 
							стрСв.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
							стрСв.ВидДоговора1 = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
						КонецЦикла;
					КонецЕсли;
					
					// + СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					ЭтоПерваяИтерация = Ложь;
					// + СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					
				КонецЦикла;	
				
				ДатаНачДО = ДобавитьМесяц(ДатаНачДО,1);
			КонецЦикла;
		КонецЕсли;
	КонецЕсли;
	//О.Т. Аверсон 16.05.2019 № 4328
	
	//Аверсон ЕАЕ 21.01.2022 СВФР-008632
	ДозаполнитьНедостающихСотрудников(СписокСотрудников, РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник"));
	//Аверсон СВФР-008632
	
	ЗапросПрочиеПричины = Новый Запрос;
	ЗапросПрочиеПричины.Текст = 
	"ВЫБРАТЬ
	|	ПрочиеПричиныМинимальнойЗаработнойПлаты.Период,
	|	ПрочиеПричиныМинимальнойЗаработнойПлаты.Сотрудник,
	|	ПрочиеПричиныМинимальнойЗаработнойПлаты.ФизЛицо,
	|	ПрочиеПричиныМинимальнойЗаработнойПлаты.ПричиныМинимальнойЗаработнойПлаты
	|ИЗ
	|	РегистрСведений.ПрочиеПричиныМинимальнойЗаработнойПлаты КАК ПрочиеПричиныМинимальнойЗаработнойПлаты
	|ГДЕ
	|	ПрочиеПричиныМинимальнойЗаработнойПлаты.Период МЕЖДУ &Период И &Период1
	// + СВЭЙ КДЯ 22.07.19 СВФР-004561
	|	И ПрочиеПричиныМинимальнойЗаработнойПлаты.Организация = &Организация
	// - СВЭЙ КДЯ 22.07.19 СВФР-004561
	|	И ПрочиеПричиныМинимальнойЗаработнойПлаты.Сотрудник В (&СписокФизЛиц)";
	
	// + СВЭЙ КДЯ 22.07.19 СВФР-004561
	ЗапросПрочиеПричины.УстановитьПараметр("Организация", ЭтотОбъект.Организация);
	// - СВЭЙ КДЯ 22.07.19 СВФР-004561
	ЗапросПрочиеПричины.УстановитьПараметр("Период", НачалоМесяца(ДатаНачала));
	ЗапросПрочиеПричины.УстановитьПараметр("Период1", КонецМесяца(ДатаОкончания));
	Если Сотрудник = Неопределено Тогда
		ЗапросПрочиеПричины.УстановитьПараметр("СписокФизЛиц", РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник"));
	иначе
		ЗапросПрочиеПричины.УстановитьПараметр("СписокФизЛиц", Сотрудник);
	КонецЕсли;
	
	
	РезПрочиеПричины = ЗапросПрочиеПричины.Выполнить().Выбрать();
	ПрочаяПричина = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();
	Пока РезПрочиеПричины.Следующий() Цикл
		ПрочаяПричина = РезПрочиеПричины.ПричиныМинимальнойЗаработнойПлаты;
		
		МассивСвОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("ФизЛицо,Месяц",РезПрочиеПричины.ФизЛицо,РезПрочиеПричины.Период)); 
		Если МассивСвОВзносах.Количество() = 0 Тогда 
			СтрокаСтажа = СведенияОВзносах.Добавить();
			ЗначениеРабОрг = РаботникиОрганизации.НайтиСтроки(Новый Структура("ФизЛицо",РезПрочиеПричины.ФизЛицо)); 
			Если ЗначениеРабОрг.Количество() > 0 Тогда // СВЭЙ  КДЯ 23.07.19 СВФР-004561
				ЗаполнитьЗначенияСвойств(СтрокаСтажа,ЗначениеРабОрг[0]);
			КонецЕсли; // СВЭЙ  КДЯ 23.07.19 СВФР-004561
			СтрокаСтажа.Сотрудник = РезПрочиеПричины.Сотрудник;
			СтрокаСтажа.ФизЛицо = РезПрочиеПричины.ФизЛицо;
			СтрокаСтажа.Выплаты = 0;
			СтрокаСтажа.Взносы = 0;
			СтрокаСтажа.Пособия = 0;
			СтрокаСтажа.ТарифВзносов = 0;
			СтрокаСтажа.Месяц = РезПрочиеПричины.Период; 
			СтрокаСтажа.ПричиныМинимальнойЗП = ПрочаяПричина;
			
			//СВЭЙ 26.10.2023 КВВ СВФР-011519 (
			СтрокаСтажа.ПособияБР = 0;
			СтрокаСтажа.ОплатыДопДня = 0;
			СтрокаСтажа.ПособияВН = 0;
			СтрокаСтажа.Простои = 0;
			СтрокаСтажа.ОтпускаИницНаним = 0;
			СтрокаСтажа.УдержОсужд = 0;
			//СВЭЙ 26.10.2023 КВВ СВФР-011519 )
		КонецЕсли;
		
	КонецЦикла;	
	
	//Аверсон ЕАЕ 08.08.2022 СВФР-009383
	//Неоплачиваемый больничный, отпуск за свой счет
	ЗапросНевыход = Новый Запрос;
	ЗапросНевыход.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ГруппыРасчетовОсновные.ВидРасчета
	|ПОМЕСТИТЬ ВТНевыходы
	|ИЗ
	|	Справочник.ГруппыРасчетов.Основные КАК ГруппыРасчетовОсновные
	|ГДЕ
	|	ГруппыРасчетовОсновные.Ссылка = ЗНАЧЕНИЕ(Справочник.ГруппыРасчетов.ИсключениеНевыходовИзПУ3)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
	|	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
	//Аверсон ЕАЕ 11.01.2025 СВФР-014027
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ПрочаяПричинаМинимальнойЗП КАК ПричинаМинимальнойЗП
	//Аверсон ЕАЕ 11.01.2025 СВФР-014027
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &Период И &Период1
	|	И (ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В
	|				(ВЫБРАТЬ
	|					ВТНевыходы.ВидРасчета
	|				ИЗ
	|					ВТНевыходы)
	|			ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет))
	|	И ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация
	|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В(&СписокФизЛиц)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
	|	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ПрочаяПричинаМинимальнойЗП";
	
	ЗапросНевыход.УстановитьПараметр("Организация", ЭтотОбъект.Организация);
	ЗапросНевыход.УстановитьПараметр("Период", НачалоМесяца(ДатаНачала));
	ЗапросНевыход.УстановитьПараметр("Период1", КонецМесяца(ДатаОкончания));
	Если Сотрудник = Неопределено Тогда
		ЗапросНевыход.УстановитьПараметр("СписокФизЛиц", РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник"));
	иначе
		ЗапросНевыход.УстановитьПараметр("СписокФизЛиц", Сотрудник);
	КонецЕсли;
	
	РезНевыход = ЗапросНевыход.Выполнить().Выбрать();
	
	//Аверсон ЕАЕ 11.01.2025 СВФР-014027
	//ПричинаБЛ = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПериодВременнойНетрудоспособности;
	//ПричинаОтп = Справочники.ПричиныМинимальнойЗаработнойПлаты.ОтпускБезСохраненияЗаработнойПлатыВСвязиСОбучениемПоСемейноБытовымИДругимУважительнымПричинам;
	//Аверсон СВФР-014027
	
	Пока РезНевыход.Следующий() Цикл
		
		МассивСвОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("ФизЛицо,Месяц",РезНевыход.ФизЛицо,РезНевыход.ПериодРегистрации)); 
		Если МассивСвОВзносах.Количество() = 0 Тогда 
			СтрокаСтажа = СведенияОВзносах.Добавить();
			ЗначениеРабОрг = РаботникиОрганизации.НайтиСтроки(Новый Структура("ФизЛицо",РезНевыход.ФизЛицо)); 
			Если ЗначениеРабОрг.Количество() > 0 Тогда
				ЗаполнитьЗначенияСвойств(СтрокаСтажа,ЗначениеРабОрг[0]);
			КонецЕсли;
			СтрокаСтажа.Сотрудник = РезНевыход.Сотрудник;
			СтрокаСтажа.ФизЛицо = РезНевыход.ФизЛицо;
			СтрокаСтажа.Выплаты = 0;
			СтрокаСтажа.Взносы = 0;
			СтрокаСтажа.Пособия = 0;
			СтрокаСтажа.ТарифВзносов = 0;
			СтрокаСтажа.Месяц = РезНевыход.ПериодРегистрации;
			
			//Аверсон ЕАЕ 11.01.2025 СВФР-014027
			//Если РезНевыход.ВидРасчета = ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет Тогда
			//	СтрокаСтажа.ПричиныМинимальнойЗП = ПричинаОтп;
			//Иначе
			//	СтрокаСтажа.ПричиныМинимальнойЗП = ПричинаБЛ;
			//КонецЕсли;
			СтрокаСтажа.ПричиныМинимальнойЗП = РезНевыход.ПричинаМинимальнойЗП;
			//Аверсон СВФР-014027
			
			//СВЭЙ 26.10.2023 КВВ СВФР-011519 (
			СтрокаСтажа.ПособияБР = 0;
			СтрокаСтажа.ОплатыДопДня = 0;
			СтрокаСтажа.ПособияВН = 0;
			СтрокаСтажа.Простои = 0;
			СтрокаСтажа.ОтпускаИницНаним = 0;
			СтрокаСтажа.УдержОсужд = 0;
			//СВЭЙ 26.10.2023 КВВ СВФР-011519 )
		КонецЕсли;
		
	КонецЦикла;	
	//Аверсон СВФР-009383
	
	//+ СВЭЙ КДЯ 10.09.19 СВФР-004631 ( пункт 15. )
	//если Сотрудник = Неопределено Тогда 
	//	РаботникиОрганизации.Сортировать( "ФизЛицо" );
	//КонецЕсли;
	//- СВЭЙ КДЯ 10.09.19 СВФР-004631 ( пункт 15. )
	
	//+ СВЭЙ КДЯ 10.09.19 СВФР-004631 ( пункт 15. )
	если Сотрудник = Неопределено Тогда 
		РаботникиОрганизации.Сортировать( "Фамилия, Имя, Отчество" );
	КонецЕсли;
	//- СВЭЙ КДЯ 10.09.19 СВФР-004631 ( пункт 15. )
	
	Для Каждого стр из РаботникиОрганизации Цикл 
		//Сотрудник = Справочники.СотрудникиОрганизаций.НайтиПоНаименованию(стр.ФизЛицо.Наименование);
		стр.ВидДоговора1 = Стр.Сотрудник.ВидДоговора;
		//+ СВЭЙ КДЯ 22.10.19 СВФР-004948
		стр.ВидДоговора = стр.ВидДоговора1;
		//- СВЭЙ КДЯ 22.10.19 СВФР-004948
	КонецЦикла;
	
	СведенияОСтаже.Сортировать( "Сотрудник, ДатаНачалаРабот, ВидДеятельности" );
	
	//Аверсон ЕАЕ 20.07.2021 СВФР-007783
	//Аверсон ЕАЕ 21.01.2022 СВФР-008632
	//ДозаполнитьНедостающихСотрудников(СписокСотрудников, РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник"));
	//Аверсон СВФР-008632
	//Аверсон СВФР-007783
	
	Если ОбъединятьОсновные Тогда 
		Запрос = Новый Запрос;
		
		//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
		//Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		//Запрос.Текст = 
		//"ВЫБРАТЬ
		//|		СведенияОЗаработкеРаботниковДПУПоСотрРаботникиОрганизации.ФизЛицо КАК ФизЛицо,
		//|		СведенияОЗаработкеРаботниковДПУПоСотрРаботникиОрганизации.ЛичныйНомер КАК ЛичныйНомер,
		//|		СведенияОЗаработкеРаботниковДПУПоСотрРаботникиОрганизации.ВидДоговора КАК ВидДоговора,
		//|		1 КАК КоличествоСотр
		//|	ПОМЕСТИТЬ ВТРаботники
		//
		//|	ИЗ
		//|		&РаботникиОрганизации КАК СведенияОЗаработкеРаботниковДПУПоСотрРаботникиОрганизации";
		//
		//
		//Запрос.УстановитьПараметр("Ссылка", Ссылка);
		//Запрос.УстановитьПараметр("РаботникиОрганизации", РаботникиОрганизации);
		//Запрос.Выполнить();
		//
		//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
		//Запрос.Текст = " ВЫБРАТЬ
		//|	ВложенныйЗапрос.ФизЛицо,
		//|	ВложенныйЗапрос.ЛичныйНомер,
		//|	ВложенныйЗапрос.КоличествоСотр
		//|ИЗ
		//|	(ВЫБРАТЬ
		//|	ВложенныйЗапрос1.ФизЛицо,
		//|	ВложенныйЗапрос1.ЛичныйНомер,
		//|	ВложенныйЗапрос1.ВидДоговора,
		//|	Сумма(ВложенныйЗапрос1.КоличествоСотр)
		//|ИЗ ВТРаботники как ВложенныйЗапрос1
		//|	СГРУППИРОВАТЬ ПО
		//|	ВложенныйЗапрос1.ФизЛицо,
		//|	ВложенныйЗапрос1.ВидДоговора,
		//|	ВложенныйЗапрос1.ЛичныйНомер) как ВложенныйЗапрос
		//|ГДЕ
		//|	ВложенныйЗапрос.КоличествоСотр > 1";
		//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
		
		//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
		Запрос.Текст = "
		|ВЫБРАТЬ
		|		Работники.ФизЛицо КАК ФизЛицо,
		|		Работники.ЛичныйНомер КАК ЛичныйНомер,
		|		Работники.ВидДоговора КАК ВидДоговора,
		|		1 КАК КоличествоСотрудников
		|	ПОМЕСТИТЬ ВТРаботники
		|ИЗ
		|	&РаботникиОрганизации КАК Работники
		|;
		|ВЫБРАТЬ
		|	Работники.ФизЛицо,
		|	Работники.ВидДоговора,
		|	Работники.ЛичныйНомер
		|ИЗ 
		|	ВТРаботники КАК Работники
		|СГРУППИРОВАТЬ ПО
		|	Работники.ФизЛицо,
		|	Работники.ВидДоговора,
		|	Работники.ЛичныйНомер
		|ИМЕЮЩИЕ
		|	СУММА( Работники.КоличествоСотрудников ) > 1
		|";
		Запрос.УстановитьПараметр( "РаботникиОрганизации", РаботникиОрганизации );
		//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
		
		
		РезультатЗапроса = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			//Ответ = Вопрос("По физлицу "+ВыборкаДетальныеЗаписи.ФизЛицо+ " есть несколько строк. Объединять данные?", РежимДиалогаВопрос.ДаНет);
			//Если Ответ = КодВозвратаДиалога.Да Тогда
			
			
			МассивРаботники = РаботникиОрганизации.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаДетальныеЗаписи.ФизЛицо)); 
			Если МассивРаботники.Количество()> 0 Тогда 
				Сотрудник = МассивРаботники[0].Сотрудник;
				Категория = МассивРаботники[0].Категория;
				ВидДоговора = МассивРаботники[0].ВидДоговора;
				
				
				МассивСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаДетальныеЗаписи.ФизЛицо));
				Для Каждого стр из МассивСведенияОСтаже Цикл 
					стр.Сотрудник = Сотрудник;
					стр.Категория = Категория;
					стр.ВидДоговора = ВидДоговора;
				КонецЦикла;
				
				МассивСведенияОВзносах = СведенияОВзносах.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаДетальныеЗаписи.ФизЛицо));
				Для Каждого стр из МассивСведенияОВзносах Цикл 
					стр.Сотрудник = Сотрудник;
					стр.Категория = Категория;
					стр.ВидДоговора = ВидДоговора;
					//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
					//стр.ПричиныМинимальнойЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();
					//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
					//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
					стр.ПричиныМинимальнойЗП = ПолучитьИтоговуюПричинуМинимальнойЗП( стр ); 
					//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
				КонецЦикла;
				
				СтрКол = РаботникиОрганизации.Количество();
				Сч = СтрКол;
				Пока Сч> 0 Цикл
					Если РаботникиОрганизации[Сч-1].ФизЛицо = ВыборкаДетальныеЗаписи.ФизЛицо Тогда 
						Если РаботникиОрганизации[Сч-1].Сотрудник <> Сотрудник Тогда
							РаботникиОрганизации.Удалить(Сч-1);
						КонецЕсли;
						
					КонецЕсли;             				
					Сч = Сч -1;
				КонецЦикла;
				
				
				СведенияОСтаже.Свернуть("Сотрудник,ФизЛицо,ДатаНачалаРабот,ДатаОкончанияРабот,ВидДеятельности,КодПоОКПДТР,Договор,Категория,ВидДоговора");
				СведенияОВзносах.Свернуть("Сотрудник,ФизЛицо,Месяц,Договор,Категория,ВидДоговора,ПричиныМинимальнойЗП","Выплаты,Пособия,Взносы,ТарифВзносов,Простои,ОтпускаИницНаним,УдержОсужд,ПособияВН,ПособияБР,ОплатыДопДня"); //СВЭЙ 26.10.2023 КВВ СВФР-011519 ("Простои,ОтпускаИницНаним,УдержОсужд,ПособияВН,ПособияБР,ОплатыДопДня")
				
				
			КонецЕсли;
			
			//КонецЕсли;
			
			
		КонецЦикла;
	КонецЕсли;
	
	//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
	ОбъединитьОсновные();
	//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
	
	//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
	//УстановитьВидДеятельностиНеоплДог( Договор, ВзносыВрем, НеоплДог );
	МасОбъединяемыеВидыДеятельности = Новый Массив( 1 );
	МасОбъединяемыеВидыДеятельности[0] = НеоплДог;
	//+ Ништ 23.01.2026 СВФР-017912
	//ОбъединитьХронологическиеЦепочкиСведенийОСтаже( МасОбъединяемыеВидыДеятельности, Премия );
	//- Ништ 23.01.2026
	//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
	
	//+ СВЭЙ КДЯ 15.08.19 СВФР-004631 ( пункт 4 )
	СтрокиНеоплДог = СведенияОСтаже.НайтиСтроки( Новый Структура( "ВидДеятельности", НеоплДог ) );
	СтрокиДоговор = СведенияОСтаже.НайтиСтроки( Новый Структура( "ВидДеятельности", Договор ) );
	СвернутьСтрокиДоговоровДублей( СтрокиНеоплДог, СтрокиДоговор, Договор );
	//- СВЭЙ КДЯ 15.08.19 СВФР-004631 ( пункт 4 )
	
	//+ СВЭЙ КДЯ 16.08.19 СВФР-004631 ( пункт 5 )
	//удаляем строки - дубли
	СвернутьТабличнуюЧасть( "РаботникиОрганизации" );
	СвернутьТабличнуюЧасть( "СведенияОСтаже" );
	//- СВЭЙ КДЯ 16.08.19 СВФР-004631 ( пункт 5 )
	
	//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
	////+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 28. )
	УстановитьВидДеятельностиНеоплДог( Договор, ВзносыВрем, НеоплДог );
	////- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 28. )
	//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
	
	//+ СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 9 )
	//удаляем строки, которым соответствуют поддиапазоны других строк, т.е. образующие подмножества
	УдалитьВключаемыеСтрокиСведенийОСтаже();
	//склеиваем строки, образуюшие хронологические цепочки
	//+ СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	
	//Аверсон ЕАЕ 13.10.2021 СВФР-008251
	//МасОбъединяемыеВидыДеятельности = Новый Массив( 3 );
	//МасОбъединяемыеВидыДеятельности[0] = Договор;
	//МасОбъединяемыеВидыДеятельности[1] = ВзносыВрем;
	//МасОбъединяемыеВидыДеятельности[2] = НеоплДог;
	МасОбъединяемыеВидыДеятельности = Новый Массив;
	//Аверсон СВФР-008251
	
	//+ СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
	//Новый формат Пачки ПУ-3 требует следующее:
	//1) Период по виду деятельности ПОСОБИЕ должен  входить в период вида деятельности ДОГОВОР
	//2) Период вида деятельности "ПОСОБИЕ" должен соответствовать месяцу, в котором сумма пособий по временной нетрудоспособности больше нуля
	//МасОбъединяемыеВидыДеятельности[3] = Пособие;
	//- СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
	
	//- СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	
	//+ СВЭЙ Ништ 23.01.2026 СВФР-017912
	//ОбъединитьХронологическиеЦепочкиСведенийОСтаже( 
	////+ СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	//МасОбъединяемыеВидыДеятельности, Премия 
	////- СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	//);
	//- СВЭЙ Ништ 23.01.2026 СВФР-017912
	//- СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 9 )
	
	//+ СВЭЙ КДЯ 26.08.19 СВФР-004631 ( пункт 7 )
	СтрокиДети = СведенияОСтаже.НайтиСтроки( Новый Структура( "ВидДеятельности", Дети ) );
	СтрокиВзносыВрем = СведенияОСтаже.НайтиСтроки( Новый Структура( "ВидДеятельности", ВзносыВрем ) );
	УстановитьПремиюВСтажеДети( СтрокиДети, СтрокиВзносыВрем, Премия );
	//- СВЭЙ КДЯ 26.08.19 СВФР-004631 ( пункт 7 )
	
	//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
	ЗаполнитьДатыДоговоров_И_ВзносовВрем( Договор, ВзносыВрем, Премия );
	//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
	
	Если ДогПодряда ИЛИ ВсеСотрудники Тогда  //Стравита: Бирило Е.М. 01.06.2023 вносит ПОСОБИЕ, т.к. перераспределение уже после ДозаполнитьЗаписиОСтажеПособие(). Ставлю тут и потом еще раз
		СведенияОВзносах.Сортировать( "ФизЛицо, Месяц, Договор" );
		ПерераспределитьВзносыПоДоговорам();
	КонецЕсли;
	
	//+ СВЭЙ КДЯ 06.12.19 СВФР-004631 ( пункт 72. )
	ДозаполнитьЗаписиОСтажеПособие( Пособие );
	//- СВЭЙ КДЯ 06.12.19 СВФР-004631 ( пункт 72. )
	
	//Аверсон 20.04.2023 КВВ СВФР-010716 (
	Если ДогПодряда Тогда
		ЕстьВыборПервичногоДП = Ложь;
		Для Каждого СтрДП ИЗ СведенияОВзносах Цикл
			Если ЗначениеЗаполнено(СтрДП.Договор) 
				И ЗначениеЗаполнено(СтрДП.Договор.ПервичныйДоговор) 
				И СтрДП.Договор <> СтрДП.Договор.ПервичныйДоговор Тогда 
				СтрДП.Договор = СтрДП.Договор.ПервичныйДоговор;
				ЕстьВыборПервичногоДП = Истина;
			КонецЕсли;
		КонецЦикла;
		Если ЕстьВыборПервичногоДП Тогда
			СведенияОВзносах.Свернуть("Сотрудник,ФизЛицо,Месяц,ТарифВзносов,Сотрудник,Договор,Категория,ВидДоговора,ПричиныМинимальнойЗП","Выплаты,Пособия,Взносы,Простои,ОтпускаИницНаним,УдержОсужд,ПособияВН,ПособияБР,ОплатыДопДня"); //СВЭЙ 26.10.2023 КВВ СВФР-011519 ("Простои,ОтпускаИницНаним,УдержОсужд,ПособияВН,ПособияБР,ОплатыДопДня")				
		КонецЕсли;
	КонецЕсли;
	//Аверсон 20.04.2023 КВВ СВФР-010716 )
	
	//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
	СведенияОВзносах.Сортировать( "ФизЛицо, Месяц, Договор" );
	//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
	
	//Аверсон ЕАЕ 20.07.2021 СВФР-007783
	ЗаполнитьПрофДопДляПУ3(ПрофДопДляПУ3, ВзносыВрем);
	//Аверсон СВФР-007783
	
	//Аверсон ЕАЕ 16.04.2022 СВФР-008941
	РаспределитьДетей();
	//Аверсон СВФР-008941
	
	//Аверсон ЕАЕ 17.01.2023 СВФР-010135
	Если ДогПодряда ИЛИ ВсеСотрудники Тогда
		ПерераспределитьВзносыПоДоговорам();
		ПроверкаПособий();
	КонецЕсли;
	//Аверсон СВФР-010135
	
	//СВЭЙ 21.12.2023 СВФР-011519 (
	//проверка заполнение Видов деятельности по всем видам расчета для ТЧ Стажа (  
	
	СпЗн_ВД_НеПроверять = Новый СписокЗначений;
	СпЗн_ВД_НеПроверять.Добавить("ВЗНОСЫВРЕМ");
	СпЗн_ВД_НеПроверять.Добавить("ВРЕМНЕТРУД");
	СпЗн_ВД_НеПроверять.Добавить("ДЕТИ");
	СпЗн_ВД_НеПроверять.Добавить("ДЕТИ0"); 
	СпЗн_ВД_НеПроверять.Добавить("ДЕТИ100");
	СпЗн_ВД_НеПроверять.Добавить("ДЕТИ50"); 
	СпЗн_ВД_НеПроверять.Добавить("ДОГОВОР"); 
	СпЗн_ВД_НеПроверять.Добавить("НЕОПЛДОГ");
	СпЗн_ВД_НеПроверять.Добавить("ПРЕМИЯ"); 
	СпЗн_ВД_НеПроверять.Добавить("ПРОФДОП");  
	
	СпЗн_ВД_ТипаПОСОБИЕ = Новый СписокЗначений;
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ПОСОБИЕ"); 
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ПОСОБИЕ0");
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ПОСОББИР"); //СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 5)
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ПОСОББИР0");
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ПОСОБДЕНЬ");
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ПОСОБУХОД"); 
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ПОСОБУХОД0"); 
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ОТПИН0");
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("ПРЕМИЯ");
	СпЗн_ВД_ТипаПОСОБИЕ.Добавить("СОЦСТРАХ"); 
	
	//СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 8) (
	Если СведенияОСтаже.Количество() <> 0 Тогда    
		ОтборСтажа = Новый Структура;
		ОтборСтажа.Вставить("ВидДеятельности", Договор);
		СтрокиСтажа = СведенияОСтаже.НайтиСтроки(ОтборСтажа);
		Если СтрокиСтажа.Количество() > 0 Тогда  
			Для Каждого СтрСтажа ИЗ СтрокиСтажа Цикл
				Если НачалоДня(СтрСтажа.ДатаОкончанияРабот) <= НачалоДня(ДатаОкончания) Тогда
					Продолжить;
				КонецЕсли;
				СтрСтажа.ДатаОкончанияРабот = ДатаОкончания;
			КонецЦикла;
		КонецЕсли;
	КонецЕсли;	
	//СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 8) )
	
	З_ВР_ВД = Новый Запрос;
	З_ВР_ВД.Текст = "ВЫБРАТЬ 
	|ИСТИНА КАК ОснНач,
	|ОснНач.Ссылка КАК ВидРасчета,
	|ОснНач.ВидДеятельности КАК ВидДеятельности
	|ИЗ ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОснНач
	|ГДЕ ОснНач.ПометкаУдаления = ЛОЖЬ
	|И ОснНач.ВидДеятельности <> ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ 
	|ЛОЖЬ КАК ОснНач,
	|ДопНач.Ссылка КАК ВидРасчета,
	|ДопНач.ВидДеятельности КАК ВидДеятельности
	|ИЗ ПланВидовРасчета.ДополнительныеНачисленияОрганизаций КАК ДопНач
	|ГДЕ ДопНач.ПометкаУдаления = ЛОЖЬ
	|И ДопНач.ВидДеятельности <> ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)";
	РезЗ_ВР_ВД = З_ВР_ВД.Выполнить().Выгрузить();
	Если РезЗ_ВР_ВД.Количество() <> 0 Тогда
		//СЗ_ВР_ВД = Новый СписокЗначений;
		//СЗ_ВР_ВД.ЗагрузитьЗначения(РезЗ_ВР_ВД.ВыгрузитьКолонку("ВидРасчета"));
		
		СЗ_Сотр = Новый ("СписокЗначений");
		Масс_Сотр = РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник");
		СЗ_Сотр.ЗагрузитьЗначения(Масс_Сотр);
		Если СЗ_Сотр.Количество() <> 0 Тогда
			З_ВР_ВД_Сотр = Новый Запрос;
			З_ВР_ВД_Сотр.Текст = "
			|ВЫБРАТЬ 
			|ЕСНСведенияОДоходах.Сотрудник,
			|ЕСНСведенияОДоходах.ВидРасчета КАК ВидРасчета,
			|ЕСНСведенияОДоходах.ПериодВзаиморасчетов      
			|ПОМЕСТИТЬ ВтРасчетыФОТ
			|ИЗ РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			|ГДЕ
			|ЕСНСведенияОДоходах.Сотрудник В (&СписокСотрудников)
			|И ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоПериода И &КонецПериода  
			|СГРУППИРОВАТЬ ПО
			|ЕСНСведенияОДоходах.Сотрудник,
			|ЕСНСведенияОДоходах.ВидРасчета,
			|ЕСНСведенияОДоходах.ПериодВзаиморасчетов
			|;               
			|
			|ВЫБРАТЬ
			|ОснНач.Регистратор.ПерерассчитываемыйДокумент КАК Регистратор,   
			|ОснНач.Сотрудник КАК Сотрудник,
			|ОснНач.ВидРасчета    
			|ПОМЕСТИТЬ ВтДокСторно
			|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНач    
			|ГДЕ ОснНач.Сотрудник В (&СписокСотрудников)
			|И ОснНач.ВидРасчета.ВидДеятельности <> ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка) 
			|И ОснНач.ПериодДействия МЕЖДУ &НачалоПериода И &КонецПериода    
			|И ОснНач.Сторно = ИСТИНА
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ    
			|ДопНач.Регистратор.ПерерассчитываемыйДокумент КАК Регистратор,      
			|ДопНач.Сотрудник,
			|ДопНач.ВидРасчета
			|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДопНач
			|ГДЕ ДопНач.Сотрудник В (&СписокСотрудников)
			|И ДопНач.ВидРасчета.ВидДеятельности <> ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
			|И ДопНач.БазовыйПериодНачало МЕЖДУ &НачалоПериода И &КонецПериода
			|И ДопНач.Сторно = ИСТИНА
			|;
			|
			|ВЫБРАТЬ 
			|ОснНач.Сотрудник КАК Сотрудник,
			|ОснНач.Сотрудник.Физлицо КАК Физлицо,
			|ОснНач.ПериодДействияНачало КАК ДатаНачалаРабот,
			|НАЧАЛОПЕРИОДА(ОснНач.ПериодДействияКонец,ДЕНЬ) КАК ДатаОкончанияРабот,
			|ОснНач.ВидРасчета.ВидДеятельности КАК ВидДеятельности,
			|&ПустойДП КАК ДПвБЛ
			|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНач    
			|
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтРасчетыФОТ КАК ВтРасчетыФОТ1
			|ПО ОснНач.Сотрудник = ВтРасчетыФОТ1.Сотрудник
			|И ОснНач.ВидРасчета = ВтРасчетыФОТ1.ВидРасчета 
			|И ОснНач.ПериодДействияНачало = ВтРасчетыФОТ1.ПериодВзаиморасчетов   
			|
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтДокСторно КАК ВтДокСторно1
			|ПО ОснНач.Регистратор = ВтДокСторно1.Регистратор
			|
			|ГДЕ ОснНач.Сотрудник В (&СписокСотрудников)
			|И ОснНач.ВидРасчета.ВидДеятельности <> ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка) 
			|И ОснНач.ПериодДействия МЕЖДУ &НачалоПериода И &КонецПериода    
			|И НЕ ВтРасчетыФОТ1.Сотрудник ЕСТЬ NULL 
			|И ВтДокСторно1.Регистратор ЕСТЬ NULL 
			|И ОснНач.Сторно = ЛОЖЬ
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ 
			|ДопНач.Сотрудник,
			|ДопНач.Сотрудник.Физлицо,
			|ДопНач.БазовыйПериодНачало,
			|НАЧАЛОПЕРИОДА(ДопНач.БазовыйПериодКонец,ДЕНЬ),
			|ДопНач.ВидРасчета.ВидДеятельности,
			
			//Ставита: Бирило Е.М. Июнь 2023 два раза ПОСОБИЕ на разные договора, хотя БЛ на один ДП (
			|ВЫБОР КОГДА ДопНач.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда
			|ТОГДА ДопНач.Регистратор.ДоговорПодряда
			|ИНАЧЕ &ПустойДП 
			|КОНЕЦ //КАК ДПвБЛ
			//Ставита: Бирило Е.М. Июнь 2023 два раза ПОСОБИЕ на разные договора, хотя БЛ на один ДП )
			
			|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДопНач
			|
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтРасчетыФОТ КАК ВтРасчетыФОТ2
			|ПО ДопНач.Сотрудник = ВтРасчетыФОТ2.Сотрудник
			|И ДопНач.ВидРасчета = ВтРасчетыФОТ2.ВидРасчета 
			|И ДопНач.БазовыйПериодНачало = ВтРасчетыФОТ2.ПериодВзаиморасчетов  
			|
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтДокСторно КАК ВтДокСторно2
			|ПО ДопНач.Регистратор = ВтДокСторно2.Регистратор
			|
			|ГДЕ ДопНач.Сотрудник В (&СписокСотрудников)
			|И ДопНач.ВидРасчета.ВидДеятельности <> ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
			|И ДопНач.БазовыйПериодНачало МЕЖДУ &НачалоПериода И &КонецПериода
			|И НЕ ВтРасчетыФОТ2.Сотрудник ЕСТЬ NULL
			|И ВтДокСторно2.Регистратор ЕСТЬ NULL
			|И ДопНач.Сторно = ЛОЖЬ
			
			//СВЭЙ 29.03.2024 КВВ СВФР-012249 (
			|
			|ОБЪЕДИНИТЬ    
			|
			|ВЫБРАТЬ 
			|ОснНач.Сотрудник КАК Сотрудник,
			|ОснНач.Сотрудник.Физлицо КАК Физлицо,
			|ОснНач.ПериодДействияНачало КАК ДатаНачалаРабот,
			|НАЧАЛОПЕРИОДА(ОснНач.ПериодДействияКонец,ДЕНЬ) КАК ДатаОкончанияРабот,
			|ОснНач.ВидРасчета.ВидДеятельности КАК ВидДеятельности,
			|&ПустойДП КАК ДПвБЛ
			|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОснНач    
			
			//Аверсон ЕАЕ 10.03.2025 СВФР-015114
			|ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеПоБольничномуЛисту КАК ДокБЛ
			|ПО ОснНач.Регистратор = ДокБЛ.ПерерассчитываемыйДокумент
			|И ДокБЛ.Проведен
			//Аверсон СВФР-015114
			
			|ГДЕ ОснНач.Сотрудник В (&СписокСотрудников)
			|И (ОснНач.ВидРасчета.ВидДеятельности <> ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка)
			|И ОснНач.ВидРасчета.ВидДеятельности = &ВД_ПОСОБИЕ0
			|) 
			|И ОснНач.ПериодДействия МЕЖДУ &НачалоПериода И &КонецПериода    
			|И ОснНач.Сторно = ЛОЖЬ     
			|И ОснНач.Результат = 0 
			
			//Аверсон ЕАЕ 07.03.2025 СВФР-015114
			|И ЕСТЬNULL(ДокБЛ.Ссылка,ЗНАЧЕНИЕ(Документ.НачислениеПоБольничномуЛисту.ПустаяСсылка)) = ЗНАЧЕНИЕ(Документ.НачислениеПоБольничномуЛисту.ПустаяСсылка)
			//Аверсон СВФР-015114
			
			|
			|ОБЪЕДИНИТЬ
			|
			|ВЫБРАТЬ 
			|ДопНач.Сотрудник,
			|ДопНач.Сотрудник.Физлицо,
			|ДопНач.БазовыйПериодНачало,
			|НАЧАЛОПЕРИОДА(ДопНач.БазовыйПериодКонец,ДЕНЬ),
			|ДопНач.ВидРасчета.ВидДеятельности,
			|ВЫБОР КОГДА ДопНач.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда
			|ТОГДА ДопНач.Регистратор.ДоговорПодряда
			|ИНАЧЕ &ПустойДП 
			|КОНЕЦ //КАК ДПвБЛ
			|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДопНач
			|
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтРасчетыФОТ КАК ВтРасчетыФОТ2
			|ПО ДопНач.Сотрудник = ВтРасчетыФОТ2.Сотрудник
			|И ДопНач.ВидРасчета = ВтРасчетыФОТ2.ВидРасчета 
			|И ДопНач.БазовыйПериодНачало = ВтРасчетыФОТ2.ПериодВзаиморасчетов  
			|
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтДокСторно КАК ВтДокСторно2
			|ПО ДопНач.Регистратор = ВтДокСторно2.Регистратор
			|
			|ГДЕ ДопНач.Сотрудник В (&СписокСотрудников)
			|И (ДопНач.ВидРасчета.ВидДеятельности <> ЗНАЧЕНИЕ(Справочник.ОсобыеУсловияТруда.ПустаяСсылка) 
			|И ДопНач.ВидРасчета.ВидДеятельности = &ВД_ПОСОБИЕ0
			|)
			|И ДопНач.БазовыйПериодНачало МЕЖДУ &НачалоПериода И &КонецПериода
			|И ДопНач.Сторно = ЛОЖЬ  
			|И ДопНач.Результат = 0
			|";
			
			З_ВР_ВД_Сотр.УстановитьПараметр("ВД_ПОСОБИЕ0",ПОСОБИЕ0);
			//СВЭЙ 29.03.2024 КВВ СВФР-012249 )
			
			З_ВР_ВД_Сотр.УстановитьПараметр("СписокСотрудников",СЗ_Сотр);
			З_ВР_ВД_Сотр.УстановитьПараметр("НачалоПериода",ДатаНачала);
			З_ВР_ВД_Сотр.УстановитьПараметр("КонецПериода",ДатаОкончания);
			З_ВР_ВД_Сотр.УстановитьПараметр("ПустойДП",Документы.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка());
			
			Рез_З_ВР_ВД_Сотр_ = З_ВР_ВД_Сотр.Выполнить().Выгрузить();
			Если Рез_З_ВР_ВД_Сотр_.Количество() > 0 Тогда 
				
				Рез_З_ВР_ВД_Сотр_.Сортировать("Сотрудник,ДатаНачалаРабот");
				Рез_З_ВР_ВД_Сотр_.Колонки.Добавить("НадоУдалить");
				Рез_З_ВР_ВД_Сотр_Копия = Рез_З_ВР_ВД_Сотр_.Скопировать();
				
				Рез_З_ВР_ВД_Сотр = Новый ТаблицаЗначений;
				Рез_З_ВР_ВД_Сотр.Колонки.Добавить("Сотрудник");
				Рез_З_ВР_ВД_Сотр.Колонки.Добавить("Физлицо");
				Рез_З_ВР_ВД_Сотр.Колонки.Добавить("ДатаНачалаРабот");
				Рез_З_ВР_ВД_Сотр.Колонки.Добавить("ДатаОкончанияРабот");
				Рез_З_ВР_ВД_Сотр.Колонки.Добавить("ВидДеятельности");
				Рез_З_ВР_ВД_Сотр.Колонки.Добавить("ДПвБЛ"); //Ставита: Бирило Е.М. Июнь 2023 два раза ПОСОБИЕ на разные договора, хотя БЛ на один ДП
				
				Для Каждого Стр ИЗ Рез_З_ВР_ВД_Сотр_ Цикл
					
					ДобавляемСтр = Ложь;
					ОтборТЗ1 = Новый Структура;
					ОтборТЗ1.Вставить("ВидДеятельности", Стр.ВидДеятельности);
					ОтборТЗ1.Вставить("Сотрудник", Стр.Сотрудник);
					ОтборТЗ1.Вставить("ДПвБЛ", Стр.ДПвБЛ); //СВЭЙ 28.03.2024 КВВ СВФР-012718
					СтрокиТЗ1 = Рез_З_ВР_ВД_Сотр.НайтиСтроки(ОтборТЗ1);
					Если СтрокиТЗ1.Количество() = 0 Тогда 
						ДобавляемСтр = ИСТИНА;
					Иначе
						НачВД = Стр.ДатаНачалаРабот;
						КонВД = Стр.ДатаОкончанияРабот;
						УжеЕсть = ЛОЖЬ;
						Для Каждого СтрТЗ Из СтрокиТЗ1 Цикл
							Если (СтрТЗ.ДатаНачалаРабот = Стр.ДатаНачалаРабот
								ИЛИ СтрТЗ.ДатаНачалаРабот < Стр.ДатаНачалаРабот) 
								И 
								(СтрТЗ.ДатаОкончанияРабот = Стр.ДатаОкончанияРабот
								ИЛИ СтрТЗ.ДатаОкончанияРабот > Стр.ДатаОкончанияРабот) Тогда
								УжеЕсть = ИСТИНА;
								Прервать;
							КонецЕсли;
						КонецЦикла;
						
						Если УжеЕсть = ЛОЖЬ Тогда 
							ДобавляемСтр = ИСТИНА;
						КонецЕсли;
					КонецЕсли;
					
					Если ДобавляемСтр Тогда
						СтрНью = Рез_З_ВР_ВД_Сотр.Добавить();
						ЗаполнитьЗначенияСвойств(СтрНью,Стр);
						ВД_Кон = СтрНью.ДатаОкончанияРабот;
						
						БылиИзменения = Ложь;
						ОтборТЗ = Новый Структура;
						ОтборТЗ.Вставить("ВидДеятельности", Стр.ВидДеятельности);
						ОтборТЗ.Вставить("Сотрудник", Стр.Сотрудник);
						СтрокиТЗ = Рез_З_ВР_ВД_Сотр_Копия.НайтиСтроки(ОтборТЗ);
						Для Каждого СтрТЗ Из СтрокиТЗ Цикл
							Если Стр = СтрТЗ Тогда
								Продолжить;
							КонецЕсли;
							
							Если СтрТЗ.НадоУдалить = ИСТИНА Тогда
								Продолжить;
							КонецЕсли;
							
							Если КонецДня(ВД_Кон) + 1 <> СтрТЗ.ДатаНачалаРабот Тогда
								Продолжить;
							КонецЕсли;
							ВД_Кон = СтрТЗ.ДатаОкончанияРабот;
							СтрТЗ.НадоУдалить = ИСТИНА;
							БылиИзменения = ИСТИНА; 
						КонецЦикла;
						
						Если БылиИзменения Тогда
							СтрНью.ДатаОкончанияРабот = ВД_Кон;
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
				
				//СВЭЙ 29.01.2024 КВВ СВФР-012279 (пункт 2) (
				//Не учитывались исключающие ВР (Ремондис Минск : Демидкевич О.Н. Отпуск за свой счет 04.08.2023 не прерывал ВЗНОСЫВРЕМ) (
				ЗапросИскл = Новый Запрос;
				ЗапросИскл.Текст = 
				"ВЫБРАТЬ
				|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
				|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
				|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ПериодДействияНачало,
				|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ПериодДействияКонец
				|ИЗ
				|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
				|ГДЕ
				|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия МЕЖДУ &НачалоПериода И &КонецПериода
				|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В(&Сп_ВР_Искл)
				|	И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В (&СписокСотрудников)
				|
				|УПОРЯДОЧИТЬ ПО
				|	ПериодДействияНачало";
				Сп_ВР_Искл = Новый СписокЗначений;
				Сп_ВР_Искл.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускЗаСвойСчет);
				Сп_ВР_Искл.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускБезОплатыПоТКРФ);
				Сп_ВР_Искл.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.РождениеРебенка);
				Сп_ВР_Искл.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.СмертьБлизкогоРодственника);
				Сп_ВР_Искл.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Невыход);
				Сп_ВР_Искл.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.Прогул);
				Сп_ВР_Искл.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоБеременностиИРодам);
				Сп_ВР_Искл.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве);				
				
				МассивИсключений = ПолучитьСписокИсключений();
				Если ВидыРасчета <> Неопределено Тогда
					Для Каждого Эл Из МассивИсключений Цикл
						Если ВидыРасчета.НайтиПоЗначению(Эл) = Неопределено Тогда
							Сп_ВР_Искл.Добавить(Эл);	
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
				ЗапросИскл.УстановитьПараметр("Сп_ВР_Искл",Сп_ВР_Искл);
				ЗапросИскл.УстановитьПараметр("СписокСотрудников",СЗ_Сотр);
				ЗапросИскл.УстановитьПараметр("НачалоПериода",ДатаНачала);
				ЗапросИскл.УстановитьПараметр("КонецПериода",ДатаОкончания);
				Рез_ЗапросИскл = ЗапросИскл.Выполнить().Выгрузить();
				Если Рез_ЗапросИскл.Количество() > 0 Тогда 	  
					НадоУдалить = Ложь;
					Рез_З_ВР_ВД_Сотр.Колонки.Добавить("НадоУдалить");
					
					Для Каждого СтрИскл ИЗ Рез_ЗапросИскл Цикл
						ОтборТЗ = Новый Структура;
						ОтборТЗ.Вставить("ВидДеятельности", ВзносыВрем);
						ОтборТЗ.Вставить("Сотрудник", СтрИскл.Сотрудник);
						СтрокиТЗ = Рез_З_ВР_ВД_Сотр.НайтиСтроки(ОтборТЗ);
						Для Каждого СтрТЗ Из СтрокиТЗ Цикл 
							Если СтрИскл.ПериодДействияНачало > НачалоДня(СтрТЗ.ДатаОкончанияРабот) 
								ИЛИ НачалоДня(СтрИскл.ПериодДействияКонец) < СтрТЗ.ДатаНачалаРабот Тогда
								Продолжить;
							КонецЕсли;
							Если СтрИскл.ПериодДействияНачало = СтрТЗ.ДатаНачалаРабот 
								И НачалоДня(СтрИскл.ПериодДействияКонец) = НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда
								СтрТЗ.НадоУдалить = Истина;
								НадоУдалить = Истина;
							ИначеЕсли СтрИскл.ПериодДействияНачало = СтрТЗ.ДатаНачалаРабот 
								И НачалоДня(СтрИскл.ПериодДействияКонец) <> НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда   
								Если НачалоДня(СтрИскл.ПериодДействияКонец) < НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда
									СтрТЗ.ДатаНачалаРабот = КонецДня(СтрИскл.ПериодДействияКонец) + 1;    
								Иначе     
									СтрТЗ.НадоУдалить = Истина;
									НадоУдалить = Истина;
								КонецЕсли;
							ИначеЕсли СтрИскл.ПериодДействияНачало <> СтрТЗ.ДатаНачалаРабот 
								И НачалоДня(СтрИскл.ПериодДействияКонец) = НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда 
								Если НачалоДня(СтрИскл.ПериодДействияКонец) > НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда
									СтрТЗ.ДатаОкончанияРабот = НачалоДня(НачалоДня(СтрИскл.ПериодДействияНачало) - 1);    
								Иначе     
									СтрТЗ.НадоУдалить = Истина;
									НадоУдалить = Истина;
								КонецЕсли;
							ИначеЕсли СтрИскл.ПериодДействияНачало <> СтрТЗ.ДатаНачалаРабот 
								И НачалоДня(СтрИскл.ПериодДействияКонец) <> НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда
								
								Если СтрИскл.ПериодДействияНачало > СтрТЗ.ДатаНачалаРабот
									И НачалоДня(СтрИскл.ПериодДействияКонец) < НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда  
									
									СтрНью = Рез_З_ВР_ВД_Сотр.Добавить();
									ЗаполнитьЗначенияСвойств(СтрНью,СтрТЗ);
									СтрНью.ДатаНачалаРабот = КонецДня(СтрИскл.ПериодДействияКонец) + 1;
									
									СтрТЗ.ДатаОкончанияРабот = НачалоДня(НачалоДня(СтрИскл.ПериодДействияНачало) - 1);
									
								ИначеЕсли СтрИскл.ПериодДействияНачало < СтрТЗ.ДатаНачалаРабот
									И НачалоДня(СтрИскл.ПериодДействияКонец) < НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда
									СтрТЗ.ДатаНачалаРабот = КонецДня(СтрИскл.ПериодДействияКонец) + 1;  
									
								ИначеЕсли СтрИскл.ПериодДействияНачало > СтрТЗ.ДатаНачалаРабот
									И НачалоДня(СтрИскл.ПериодДействияКонец) > НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда
									СтрТЗ.ДатаОкончанияРабот = НачалоДня(НачалоДня(СтрИскл.ПериодДействияНачало) - 1);
									
								ИначеЕсли СтрИскл.ПериодДействияНачало < СтрТЗ.ДатаНачалаРабот
									И НачалоДня(СтрИскл.ПериодДействияКонец) > НачалоДня(СтрТЗ.ДатаОкончанияРабот) Тогда
									СтрТЗ.НадоУдалить = Истина;
									НадоУдалить = Истина;
								КонецЕсли;
							КонецЕсли;
						КонецЦикла;
						
					КонецЦикла; 
					
					Если НадоУдалить Тогда
						НадоУдалитьСтроки = Рез_З_ВР_ВД_Сотр.НайтиСтроки(Новый Структура("НадоУдалить",Истина));
						Для каждого СтрокаТаблицыНадоУдалитьСтроки Из НадоУдалитьСтроки Цикл
							Рез_З_ВР_ВД_Сотр.Удалить(СтрокаТаблицыНадоУдалитьСтроки);
						КонецЦикла;
					КонецЕсли;
					
				КонецЕсли;
				//Не учитывались исключающие ВР (Ремондис Минск : Демидкевич О.Н. Отпуск за свой счет 04.08.2023 не прерывал ВЗНОСЫВРЕМ) )
				//СВЭЙ 29.01.2024 КВВ СВФР-012279 (пункт 2) )
				
				НадоУдалить = Ложь;
				
				Если СведенияОСтаже.Количество() = 0 Тогда
					Для Каждого Стр ИЗ Рез_З_ВР_ВД_Сотр Цикл
						СтрСтаж = СведенияОСтаже.Добавить();
						ЗаполнитьЗначенияСвойств(СтрСтаж, Стр);
					КонецЦикла;
				Иначе
					ТЗ_ТЧ_Стажа = СведенияОСтаже.Выгрузить();
					//	ТЗ_ТЧ_Стажа.Колонки.Добавить("НовыеВД");
					ТЗ_ТЧ_Стажа.Колонки.Добавить("НадоУдалить");
					
					ТЗ_ТЧ_Стажа_ВД = ТЗ_ТЧ_Стажа.Скопировать();
					ТЗ_ТЧ_Стажа_ВД.Очистить();
					
					НадоУдалить = Ложь;
					
					Для Каждого Стр ИЗ Рез_З_ВР_ВД_Сотр Цикл
						ОтборТЗ = Новый Структура;
						ОтборТЗ.Вставить("ДатаНачалаРабот", Стр.ДатаНачалаРабот);
						ОтборТЗ.Вставить("ДатаОкончанияРабот", Стр.ДатаОкончанияРабот);
						ОтборТЗ.Вставить("Сотрудник", Стр.Сотрудник);
						СтрокиТЗ = ТЗ_ТЧ_Стажа.НайтиСтроки(ОтборТЗ);
						Для Каждого СтрТЗ Из СтрокиТЗ Цикл
							ВДТЗ = ВРЕГ(СокрЛП(СтрТЗ.ВидДеятельности));  
							
							НайдЭл = СпЗн_ВД_НеПроверять.НайтиПоЗначению(ВДТЗ);
							Если НайдЭл = Неопределено Тогда
								СтрТЗ.НадоУдалить = ИСТИНА;
								НадоУдалить = ИСТИНА;	
							КонецЕсли;
						КонецЦикла;
						
						ВДТЗ2 = ВРЕГ(СокрЛП(Стр.ВидДеятельности));  
						НайдЭл2 = СпЗн_ВД_ТипаПОСОБИЕ.НайтиПоЗначению(ВДТЗ2);  
						Если НайдЭл2 <> Неопределено Тогда
							//Если Найти(ВРЕГ(СокрЛП(Стр.ВидДеятельности)),"ПОСОБИЕ") > 0 Тогда
							ОтборВзносыВрем = Новый Структура;
							ОтборВзносыВрем.Вставить("ВидДеятельности", ВзносыВрем);
							ОтборВзносыВрем.Вставить("Сотрудник", Стр.Сотрудник);
							ОтборВзносыВрем.Вставить("Договор", Стр.ДПвБЛ); //СВЭЙ 01.04.2024 КВВ СВФР-012718 (Стравита: Куранова Н.В. нет ВЗНОСЫВРЕМ 15.03.24 - 31.03.24 по второму дог.п.)

							СтрокиТЗВзносыВрем = ТЗ_ТЧ_Стажа.НайтиСтроки(ОтборВзносыВрем);
							Для Каждого СтрТЗВВ Из СтрокиТЗВзносыВрем Цикл
								Если СтрТЗВВ.НадоУдалить = ИСТИНА Тогда
									Продолжить;
								КонецЕсли;
								
								Если Стр.ДатаНачалаРабот > СтрТЗВВ.ДатаОкончанияРабот
									ИЛИ Стр.ДатаОкончанияРабот < СтрТЗВВ.ДатаНачалаРабот Тогда
									
									//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 4) (
									Если Стр.ДатаНачалаРабот < СтрТЗВВ.ДатаОкончанияРабот
										И Стр.ДатаОкончанияРабот < СтрТЗВВ.ДатаНачалаРабот
										
										//Аверсон ЕАЕ 11.01.2025 СВФР-014027
										//Бобруйск (Бакан А.И., Взносыврем, удаляется строка 28.05.2024 - 16.07.2024)
										//за счет того, что происходит замена даты начала 28.05.2024 на 26.05.2024
										//Если так исправить, ломается Стравита (Туркова, СВФР-012718)
										
										И КонецДня(КонецДня(Стр.ДатаОкончанияРабот)+1)+1 = НачалоДня(НачалоДня(СтрТЗВВ.ДатаНачалаРабот)-1)
										//И КонецДня(Стр.ДатаОкончанияРабот)+1 = НачалоДня(НачалоДня(СтрТЗВВ.ДатаНачалаРабот)-1) Тогда
										
										//Попробуем сделать, чтобы это отрабатывало только для договоров подряда
										И ЗначениеЗаполнено(Стр.ДПвБЛ) Тогда
										//Аверсон СВФР-014027

										
										СтрТЗВВ.ДатаНачалаРабот = КонецДня(Стр.ДатаОкончанияРабот)+1;
									КонецЕсли;
									//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 4) )
									
									Продолжить;
								КонецЕсли;
								
								Если ((Стр.ДатаНачалаРабот = СтрТЗВВ.ДатаНачалаРабот) И (Стр.ДатаОкончанияРабот = СтрТЗВВ.ДатаОкончанияРабот))
									ИЛИ ((Стр.ДатаНачалаРабот < СтрТЗВВ.ДатаНачалаРабот) И (Стр.ДатаОкончанияРабот > СтрТЗВВ.ДатаОкончанияРабот)) Тогда 
									СтрТЗВВ.НадоУдалить = ИСТИНА;
									НадоУдалить = ИСТИНА;
								КонецЕсли;
								
								Если (СтрТЗВВ.ДатаНачалаРабот < Стр.ДатаНачалаРабот) Тогда
									ДатаК = СтрТЗВВ.ДатаОкончанияРабот;
									СтрТЗВВ.ДатаОкончанияРабот = НачалоДня(Стр.ДатаНачалаРабот-1);
									Если (Стр.ДатаОкончанияРабот > СтрТЗВВ.ДатаОкончанияРабот) Тогда
										ДатаН = КонецДня(Стр.ДатаОкончанияРабот)+1;
										ВноситьНовСтр = Истина;
										ОтборВзносыВрем2 = Новый Структура;
										ОтборВзносыВрем2.Вставить("ВидДеятельности", ВзносыВрем);
										ОтборВзносыВрем2.Вставить("Сотрудник", Стр.Сотрудник); 
										ОтборВзносыВрем2.Вставить("Договор", СтрТЗВВ.Договор);
										СтрокиТЗВзносыВрем2 = ТЗ_ТЧ_Стажа.НайтиСтроки(ОтборВзносыВрем2);
										Для Каждого СтрТЗВВ2 Из СтрокиТЗВзносыВрем2 Цикл		
											Если СтрТЗВВ2.НадоУдалить = ИСТИНА Тогда
												Продолжить;
											КонецЕсли;
											
											Если СтрТЗВВ2.ДатаНачалаРабот = ДатаН Тогда
												Если СтрТЗВВ2.ДатаОкончанияРабот >= ДатаК Тогда
													ВноситьНовСтр = Ложь;
												Иначе
													СтрТЗВВ2.ДатаОкончанияРабот = ДатаК;
												КонецЕсли;
											КонецЕсли;
										КонецЦикла;	
										Если ВноситьНовСтр 
											И (ДатаН <= ДатаК) Тогда //СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 5)
											СтрНов = ТЗ_ТЧ_Стажа.Добавить();
											ЗаполнитьЗначенияСвойств(СтрНов,СтрТЗВВ);
											СтрТЗВВ.ДатаНачалаРабот = ДатаН; 
											СтрТЗВВ.ДатаОкончанияРабот = ДатаК;
										КонецЕсли;
									КонецЕсли;
									
								ИначеЕсли (СтрТЗВВ.ДатаНачалаРабот >= Стр.ДатаНачалаРабот) Тогда
									Если (Стр.ДатаОкончанияРабот > СтрТЗВВ.ДатаОкончанияРабот) Тогда
										СтрТЗВВ.ДатаНачалаРабот = КонецДня(Стр.ДатаОкончанияРабот)+1;
									Иначе
										Если ЗначениеЗаполнено(СтрТЗВВ.Договор) 
											И НачалоДня(СтрТЗВВ.Договор.ДатаОкончания) = НачалоДня(СтрТЗВВ.ДатаОкончанияРабот) 
											И СтрТЗВВ.ВидДеятельности = ВзносыВрем Тогда
											
											Если СтрТЗВВ.ДатаНачалаРабот <= Стр.ДатаОкончанияРабот Тогда //Стравита Авраменко-Паноцкая Л.К. (было : ВЗНОСЫВРЕМ с 01.05-20.11.2023, ПОСОБИЕ с 26.04-25.05.2023 ) 
												СтрТЗВВ.ДатаНачалаРабот = КонецДня(Стр.ДатаОкончанияРабот)+1;
											Иначе
												Продолжить;
											КонецЕсли;
											
										Иначе
											
											//СВЭЙ 29.03.2024 КВВ СВФР-012249 (
											Если (Стр.ВидДеятельности = ПОСОБИЕ0 
												ИЛИ (
												(Стр.ВидДеятельности = ПОСОБУХОД ИЛИ //СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 9)
												Стр.ВидДеятельности = ПОСОБИЕ) И ЗначениеЗаполнено(СтрТЗВВ.Договор))) //СВЭЙ 01.04.2024 КВВ СВФР-012718 (Стравита: Куранова Н.В. нет ВЗНОСЫВРЕМ 15.03.24 - 31.03.24 по второму дог.п.)
												И НачалоДня(Стр.ДатаОкончанияРабот) < НачалоДня(СтрТЗВВ.ДатаОкончанияРабот) Тогда 
												СтрТЗВВ.ДатаНачалаРабот = КонецДня(Стр.ДатаОкончанияРабот)+1;
											Иначе
												//СВЭЙ 29.03.2024 КВВ СВФР-012249 )
												
												СтрТЗВВ.НадоУдалить = ИСТИНА;
												НадоУдалить = ИСТИНА; 
											КонецЕсли;
										КонецЕсли;
									КонецЕсли;	
								КонецЕсли;
							КонецЦикла;
						КонецЕсли;
					КонецЦикла;
					
					Если НадоУдалить Тогда
						НадоУдалитьСтроки = ТЗ_ТЧ_Стажа.НайтиСтроки(Новый Структура("НадоУдалить",Истина));
						Для каждого СтрокаТаблицыНадоУдалитьСтроки Из НадоУдалитьСтроки Цикл
							ТЗ_ТЧ_Стажа.Удалить(СтрокаТаблицыНадоУдалитьСтроки);
						КонецЦикла;
					КонецЕсли;
					
					НадоУдалить = Ложь;
					
					Для Каждого Стр ИЗ Рез_З_ВР_ВД_Сотр Цикл
						ОтборТЗ = Новый Структура;
						ОтборТЗ.Вставить("Сотрудник", Стр.Сотрудник);
						СтрокиТЗ = ТЗ_ТЧ_Стажа.НайтиСтроки(ОтборТЗ);
						Для Каждого СтрТЗ Из СтрокиТЗ Цикл
							Если СтрТЗ.ДатаОкончанияРабот < Стр.ДатаНачалаРабот
								ИЛИ СтрТЗ.ДатаНачалаРабот > Стр.ДатаОкончанияРабот Тогда
								Продолжить;
							КонецЕсли;
							
							ВДТЗ = ВРЕГ(СокрЛП(СтрТЗ.ВидДеятельности));
							
							НайдЭл = СпЗн_ВД_НеПроверять.НайтиПоЗначению(ВДТЗ);
							Если НайдЭл = Неопределено Тогда
								Если (СтрТЗ.ДатаНачалаРабот = Стр.ДатаНачалаРабот
									ИЛИ СтрТЗ.ДатаНачалаРабот > Стр.ДатаНачалаРабот) 
									И 
									(СтрТЗ.ДатаОкончанияРабот = Стр.ДатаОкончанияРабот
									ИЛИ СтрТЗ.ДатаОкончанияРабот < Стр.ДатаОкончанияРабот) Тогда
									СтрТЗ.НадоУдалить = ИСТИНА;
									НадоУдалить = ИСТИНА;
								КонецЕсли;
							КонецЕсли; 
							//Сообщить(сокрлп(Стр.Сотрудник) + " - " + ФОрмат(Стр.ДатаНачалаРабот,"ДЛФ=Д") + " - " + ФОрмат(Стр.ДатаОкончанияРабот,"ДЛФ=Д") + " - " + сокрлп(Стр.ВидДеятельности));
						КонецЦикла;
					КонецЦикла;
					
					Если НадоУдалить Тогда
						НадоУдалитьСтроки = ТЗ_ТЧ_Стажа.НайтиСтроки(Новый Структура("НадоУдалить",Истина));
						Для каждого СтрокаТаблицыНадоУдалитьСтроки Из НадоУдалитьСтроки Цикл
							ТЗ_ТЧ_Стажа.Удалить(СтрокаТаблицыНадоУдалитьСтроки);
						КонецЦикла;
					КонецЕсли;					   
					
					НадоУдалить = Ложь;                
					
					Для Каждого Стр ИЗ ТЗ_ТЧ_Стажа Цикл 
						ВДТЗ = ВРЕГ(СокрЛП(Стр.ВидДеятельности)); 
						НайдЭл = СпЗн_ВД_НеПроверять.НайтиПоЗначению(ВДТЗ);
						
						Если НайдЭл = Неопределено Тогда
							СчПересечений = 0;
							РазницаВДнях = ((НачалоДня(Стр.ДатаОкончанияРабот) - НачалоДня(Стр.ДатаНачалаРабот)) / (60 * 60 * 24)) + 1;
							
							ОтборТЗ = Новый Структура;
							ОтборТЗ.Вставить("Сотрудник", Стр.Сотрудник);
							СтрокиТЗ = Рез_З_ВР_ВД_Сотр.НайтиСтроки(ОтборТЗ);
							
							ТекДата = НачалоДня(Стр.ДатаНачалаРабот);
							Пока ТекДата <= НачалоДня(Стр.ДатаОкончанияРабот) Цикл; 
								
								Для Каждого СтрТЗ Из СтрокиТЗ Цикл   
									ВДТЗ2 = ВРЕГ(СокрЛП(СтрТЗ.ВидДеятельности)); 
									НайдЭл2 = СпЗн_ВД_НеПроверять.НайтиПоЗначению(ВДТЗ2);
									
									Если НайдЭл2 = Неопределено Тогда
										Если ТекДата < СтрТЗ.ДатаНачалаРабот
											ИЛИ ТекДата > СтрТЗ.ДатаОкончанияРабот Тогда
											Продолжить;
										КонецЕсли; 
										СчПересечений = СчПересечений + 1; 
									КонецЕсли;
								КонецЦикла;
								
								ТекДата = ТекДата + (60 * 60 * 24);
							КонецЦикла;
							
							Если СчПересечений = РазницаВДнях Тогда
								Стр.НадоУдалить = Истина;
								НадоУдалить = Истина;
							КонецЕсли;
						КонецЕсли;
					КонецЦикла;
					
					Если НадоУдалить Тогда
						НадоУдалитьСтроки = ТЗ_ТЧ_Стажа.НайтиСтроки(Новый Структура("НадоУдалить",Истина));
						Для каждого СтрокаТаблицыНадоУдалитьСтроки Из НадоУдалитьСтроки Цикл
							ТЗ_ТЧ_Стажа.Удалить(СтрокаТаблицыНадоУдалитьСтроки);
						КонецЦикла;
					КонецЕсли;
					
					Для Каждого Стр ИЗ Рез_З_ВР_ВД_Сотр Цикл
						
						//СВЭЙ 28.01.2024 КВВ СВФР-012279 (
						Если Стр.ВидДеятельности = ВзносыВрем Тогда	
							Отбор1 = Новый Структура;
							Отбор1.Вставить("ДатаНачалаРабот", Стр.ДатаНачалаРабот);
							//Отбор1.Вставить("ДатаОкончанияРабот", Стр.ДатаОкончанияРабот); //СВЭЙ 29.01.2024 КВВ СВФР-012279 (пункт 2) (закомментировано)
							Отбор1.Вставить("Сотрудник", Стр.Сотрудник);
							Отбор1.Вставить("ВидДеятельности", Стр.ВидДеятельности);
							Строки1 = ТЗ_ТЧ_Стажа.НайтиСтроки(Отбор1);
							Если Строки1.Количество() > 0 Тогда 
								Продолжить;   //уже есть такая запись
							КонецЕсли;
						КонецЕсли;	
						//СВЭЙ 28.01.2024 КВВ СВФР-012279 )
						
						СтрСтаж = ТЗ_ТЧ_Стажа.Добавить();
						ЗаполнитьЗначенияСвойств(СтрСтаж, Стр);
						
						ОтборРО = Новый Структура;
						ОтборРО.Вставить("Сотрудник", Стр.Сотрудник);
						СтрокиРО = РаботникиОрганизации.НайтиСтроки(ОтборРО);
						Если СтрокиРО[0].ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда Тогда
							
							//Ставита: Бирило Е.М. Июнь 2023 два раза ПОСОБИЕ на разные договора, хотя БЛ на один ДП (
							Если ЗначениеЗаполнено(Стр.ДПвБЛ) Тогда //Ставита: Бирило Е.М.
								СтрСтаж.Договор = Стр.ДПвБЛ; 
								СтрСтаж.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
							Иначе
								//Ставита: Бирило Е.М. Июнь 2023 два раза ПОСОБИЕ на разные договора, хотя БЛ на один ДП )
								
								ЗапросДП = Новый Запрос;
								ЗапросДП.Текст = "ВЫБРАТЬ
								|ДоговорНаВыполнениеРаботСФизЛицом.Ссылка.ДатаНачала КАК ДатаНачала,
								|КОНЕЦПЕРИОДА(ДоговорНаВыполнениеРаботСФизЛицом.Ссылка.ДатаОкончания,ДЕНЬ) КАК ДатаОкончания,
								|ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
								|ИЗ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
								|ГДЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.ТипРаботника = ЗНАЧЕНИЕ(Перечисление.ТипыРаботников.ДоговорПодряда)
								|И ((&Нач МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.Ссылка.ДатаНачала И КОНЕЦПЕРИОДА(ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания,ДЕНЬ))
								|ИЛИ (&Кон МЕЖДУ ДоговорНаВыполнениеРаботСФизЛицом.Ссылка.ДатаНачала И КОНЕЦПЕРИОДА(ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания,ДЕНЬ))) 
								|И ДоговорНаВыполнениеРаботСФизЛицом.Проведен 
								|И ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник = &Сотр";  
								ЗапросДП.УстановитьПараметр("Нач",Стр.ДатаНачалаРабот);
								ЗапросДП.УстановитьПараметр("Кон",Стр.ДатаОкончанияРабот);
								ЗапросДП.УстановитьПараметр("Сотр",Стр.Сотрудник);  
								РезЗапросДП = ЗапросДП.Выполнить().Выгрузить();
								Если РезЗапросДП.Количество() > 0 Тогда    
									СтрСтаж.Договор = РезЗапросДП[0].Ссылка; 
									СтрСтаж.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
									
									ВДТЗ2 = ВРЕГ(СокрЛП(Стр.ВидДеятельности));  
									НайдЭл2 = СпЗн_ВД_ТипаПОСОБИЕ.НайтиПоЗначению(ВДТЗ2);  
									Если НайдЭл2 <> Неопределено 								
										//Если Стр.ВидДеятельности = Пособие 
										И РезЗапросДП.Количество() > 1 Тогда   
										СчА = 0;
										Для Каждого СтрА ИЗ РезЗапросДП Цикл 
											СчА = СчА + 1;
											Если СчА > 1 Тогда
												СтрСтаж = ТЗ_ТЧ_Стажа.Добавить();
												ЗаполнитьЗначенияСвойств(СтрСтаж, Стр);
												СтрСтаж.Договор = СтрА.Ссылка; 
												СтрСтаж.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда;
											КонецЕсли;
										КонецЦикла;
									КонецЕсли;
								КонецЕсли; 
							КонецЕсли;
						КонецЕсли;
					КонецЦикла;
					
					СведенияОСтаже.Загрузить(ТЗ_ТЧ_Стажа);
				КонецЕсли;
				СведенияОСтаже.Сортировать("Сотрудник,Физлицо,ДатаНачалаРабот,ВидДеятельности");
			КонецЕсли;
		КонецЕсли; 
	КонецЕсли;
	
	Если СведенияОСтаже.Количество() <> 0 Тогда 
		
		//НЕОПЛДОГ убрать ВЗНОСЫВРЕМ (Стравита: Бацеко дек 2023) (  
		НадоУдалить = Ложь;
		ТЗ_ТЧ_Стажа = СведенияОСтаже.Выгрузить(); 
		ТЗ_ТЧ_Стажа.Колонки.Добавить("НадоУдалить");
		ТЗ_ТЧ_Стажа_НЕОПЛДОГ = ТЗ_ТЧ_Стажа.Скопировать();
		Отбор3 = Новый Структура;
		Отбор3.Вставить("ВидДеятельности", НеоплДог);
		Строки3 = ТЗ_ТЧ_Стажа_НЕОПЛДОГ.НайтиСтроки(Отбор3);
		Если Строки3.Количество() > 0 Тогда
			Для Каждого Стр3 ИЗ Строки3 Цикл
				Отбор4 = Новый Структура;
				Отбор4.Вставить("ДатаНачалаРабот", Стр3.ДатаНачалаРабот);
				Отбор4.Вставить("ДатаОкончанияРабот", Стр3.ДатаОкончанияРабот);
				Отбор4.Вставить("Сотрудник", Стр3.Сотрудник);
				Отбор4.Вставить("ВидДеятельности", ВзносыВрем); 
				Отбор4.Вставить("Договор", Стр3.Договор);
				Строки4 = ТЗ_ТЧ_Стажа.НайтиСтроки(Отбор4);  
				Для Каждого Стр4 ИЗ Строки4 Цикл
					Стр4.НадоУдалить = Истина;
					НадоУдалить = Истина;
				КонецЦикла;
			КонецЦикла;
			
			Если НадоУдалить Тогда
				НадоУдалитьСтроки = ТЗ_ТЧ_Стажа.НайтиСтроки(Новый Структура("НадоУдалить",Истина));
				Для каждого СтрокаТаблицыНадоУдалитьСтроки Из НадоУдалитьСтроки Цикл
					ТЗ_ТЧ_Стажа.Удалить(СтрокаТаблицыНадоУдалитьСтроки);
				КонецЦикла;  
				
				СведенияОСтаже.Загрузить(ТЗ_ТЧ_Стажа);	
			КонецЕсли;    
		КонецЕсли;   
		//НЕОПЛДОГ убрать ВЗНОСЫВРЕМ (Стравита: Бацеко дек 2023) )
		
		БылиИзменения = Ложь;  
		ТЗ_ТЧ_Стажа = СведенияОСтаже.Выгрузить();
		ТЗ_ТЧ_Стажа2 = ТЗ_ТЧ_Стажа.Скопировать();
		
		//договора срок действия от даты договора, взносы не ранее 01012014
		
		//Для Каждого Стр ИЗ ТЗ_ТЧ_Стажа2 Цикл
		//	Если Год(Стр.ДатаНачалаРабот) = Год(Стр.ДатаОкончанияРабот) Тогда
		//		Продолжить;
		//	КонецЕсли;
		//	
		//	Отбор = Новый Структура;
		//	Отбор.Вставить("Сотрудник", Стр.Сотрудник); 
		//	Отбор.Вставить("Физлицо", Стр.Физлицо);
		//	Отбор.Вставить("ДатаНачалаРабот", Стр.ДатаНачалаРабот);  
		//	Отбор.Вставить("ДатаОкончанияРабот", Стр.ДатаОкончанияРабот); 
		//	Отбор.Вставить("Договор", Стр.Договор);
		//	Отбор.Вставить("ВидДеятельности", Стр.ВидДеятельности);
		//	СтрокиП = ТЗ_ТЧ_Стажа.НайтиСтроки(Отбор);
		//	
		//	Если СтрокиП[0].ВидДеятельности = Договор Тогда
		//		НачГод = Год(Стр.ДатаНачалаРабот);
		//		КонГод = Год(Стр.ДатаОкончанияРабот);
		//		НачГод = ?(НачГод<2014,2014,НачГод);
		//		СчГод = 0;
		//		Пока НачГод <= КонГод Цикл
		//			СчГод = СчГод + 1;
		//			Если СчГод = 1 Тогда
		//				Если Год(Стр.ДатаНачалаРабот) < 2014 Тогда
		//					СтрокиП[0].ДатаНачалаРабот = Дата(2014,01,01);	
		//					СтрокиП[0].ДатаОкончанияРабот = НачалоДня(КонецГода(СтрокиП[0].ДатаНачалаРабот));     
		//				Иначе
		//					СтрокиП[0].ДатаОкончанияРабот = НачалоДня(КонецГода(Стр.ДатаНачалаРабот));
		//				КонецЕсли;
		//			Иначе
		//				СтрСтаж = ТЗ_ТЧ_Стажа.Добавить();
		//				ЗаполнитьЗначенияСвойств(СтрСтаж, Стр);	 
		//				СтрСтаж.ДатаНачалаРабот = Дата(НачГод, 01, 01);
		//				СтрСтаж.ДатаОкончанияРабот = ?(НачГод = КонГод,Стр.ДатаОкончанияРабот,НачалоДня(КонецГода(СтрСтаж.ДатаНачалаРабот)));
		//			КонецЕсли;
		//			НачГод = НачГод + 1;
		//		КонецЦикла; 
		//	ИначеЕсли СтрокиП[0].ВидДеятельности = ВзносыВрем Тогда   
		//		СтрокиП[0].ДатаНачалаРабот = НачалоГода(Стр.ДатаОкончанияРабот);
		//	КонецЕсли;
		//	БылиИзменения = Истина;
		//КонецЦикла;   
		//
		//ТЗ_ТЧ_Стажа2 = ТЗ_ТЧ_Стажа.Скопировать();
		//
		//Если БылиИзменения Тогда  
		//	Для Каждого Стр ИЗ ТЗ_ТЧ_Стажа2 Цикл
		//		Если Год(Стр.ДатаНачалаРабот) = Год(ДатаНачала) Тогда
		//			Продолжить;
		//		КонецЕсли;
		//		
		//		Если Стр.ВидДеятельности = Договор Тогда
		//			Отбор = Новый Структура;
		//			Отбор.Вставить("Сотрудник", Стр.Сотрудник); 
		//			Отбор.Вставить("Физлицо", Стр.Физлицо);
		//			Отбор.Вставить("ДатаНачалаРабот", Стр.ДатаНачалаРабот);  
		//			Отбор.Вставить("ДатаОкончанияРабот", Стр.ДатаОкончанияРабот); 
		//			Отбор.Вставить("Договор", Стр.Договор);
		//			Отбор.Вставить("ВидДеятельности", ВзносыВрем);
		//			СтрокиП = ТЗ_ТЧ_Стажа.НайтиСтроки(Отбор); 
		//			Если СтрокиП.Количество() = 0 Тогда
		//				СтрСтаж = ТЗ_ТЧ_Стажа.Добавить();
		//				ЗаполнитьЗначенияСвойств(СтрСтаж, Стр);	 
		//				СтрСтаж.ВидДеятельности = ВзносыВрем;    
		//			КонецЕсли; 
		//		КонецЕсли;
		//	КонецЦикла; 			
		//	
		//	СведенияОСтаже.Загрузить(ТЗ_ТЧ_Стажа);
		//	
		//	СведенияОСтаже.Сортировать("Сотрудник,Физлицо,ДатаНачалаРабот,ВидДеятельности");  
		//КонецЕсли;
		//договора срок действия от даты договора, взносы не ранее 01012014

		//заполнить Категории (
		КолвоСтр = СведенияОСтаже.Количество();
		
		ОтборК = Новый Структура;
		ОтборК.Вставить("Категория", Справочники.КатегорииЗастрахованныхЛиц.ПустаяСсылка()); 
		СтрокиК = СведенияОСтаже.НайтиСтроки(ОтборК); 
		КолвоБезК = СтрокиК.Количество();
		Если КолвоСтр <> КолвоБезК Тогда //есть заполненные Категории, дозаполнить пустые
			Для Каждого Стр Из СтрокиК Цикл
				Стр.Категория = Стр.Сотрудник.Физлицо.СтатусКатегория;
			КонецЦикла; 
			СведенияОСтаже.Сортировать("Сотрудник,Физлицо,ДатаНачалаРабот,ВидДеятельности");	
		КонецЕсли;
		//заполнить Категории )
		
		//СВЭЙ 03.04.2024 КВВ СВФР-012718 (пункт 2) (
		//ВРЕМНЕТРУД (
		ОтборУв = Новый Структура;
		ОтборУв.Вставить("ВидДеятельности", ВремНетрудДляПУ3);
		СтрокиУв = СведенияОСтаже.НайтиСтроки(ОтборУв); 
		Если СтрокиУв.Количество() > 0 Тогда  
			БылиИзменения = Ложь; НадоУдалить = Ложь;
			ТЗ_ТЧ_Стажа = СведенияОСтаже.Выгрузить();	
			ТЗ_ТЧ_Стажа.Колонки.Добавить("НадоУдалить");
			
			Для Каждого СтрУв ИЗ СтрокиУв Цикл   
				ЗУв = Новый Запрос;
				ЗУв.Текст = "ВЫБРАТЬ 
				|КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(Работники.Период,ДЕНЬ,-1),ДЕНЬ) КАК ДатаУвольнения
				|ИЗ РегистрСведений.РаботникиОрганизаций КАК Работники   		
				|ГДЕ Работники.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)		
				|И Работники.Сотрудник = &Сотрудник";
				ЗУв.УстановитьПараметр("Сотрудник",СтрУв.Сотрудник);
				РезЗУв = ЗУв.Выполнить().Выгрузить();
				Если РезЗУв.Количество() > 0 Тогда
					ДатаУвСотр = РезЗУв[0].ДатаУвольнения; 
					ОтборУв2 = Новый Структура;      
					ОтборУв2.Вставить("Сотрудник", СтрУв.Сотрудник);
					ОтборУв2.Вставить("Физлицо", СтрУв.Физлицо);  
					СтрокиУв2 = ТЗ_ТЧ_Стажа.НайтиСтроки(ОтборУв2);	
					Для Каждого СтрУв2 ИЗ СтрокиУв2 Цикл   
						Если СтрУв2.ВидДеятельности <> ВремНетрудДляПУ3 Тогда
							Если НачалоДня(СтрУв2.ДатаОкончанияРабот) < НачалоДня(ДатаУвСотр) Тогда
								Продолжить;   
							ИначеЕсли НачалоДня(СтрУв2.ДатаНачалаРабот) > НачалоДня(ДатаУвСотр) Тогда
								СтрУв2.НадоУдалить = ИСТИНА;
								НадоУдалить = ИСТИНА; 
								БылиИзменения = ИСТИНА;  
							ИначеЕсли НачалоДня(СтрУв2.ДатаНачалаРабот) < НачалоДня(ДатаУвСотр) И НачалоДня(СтрУв2.ДатаОкончанияРабот) > НачалоДня(ДатаУвСотр) Тогда
								СтрУв2.ДатаОкончанияРабот = НачалоДня(ДатаУвСотр);
								БылиИзменения = ИСТИНА;
							КонецЕсли;  
						Иначе  
							Если НачалоДня(СтрУв2.ДатаНачалаРабот) > НачалоДня(ДатаУвСотр) Тогда  
								СтрУв2.ДатаНачалаРабот = КонецДня(ДатаУвСотр)+1;
								БылиИзменения = ИСТИНА;	
							КонецЕсли;
						КонецЕсли;
					КонецЦикла;	
				КонецЕсли;
			КонецЦикла;  
			
			Если БылиИзменения Тогда
				Если НадоУдалить Тогда
					НадоУдалитьСтроки = ТЗ_ТЧ_Стажа.НайтиСтроки(Новый Структура("НадоУдалить",Истина));
					Для каждого СтрокаТаблицыНадоУдалитьСтроки Из НадоУдалитьСтроки Цикл
						ТЗ_ТЧ_Стажа.Удалить(СтрокаТаблицыНадоУдалитьСтроки);
					КонецЦикла;  
					
					СведенияОСтаже.Загрузить(ТЗ_ТЧ_Стажа);	
				КонецЕсли; 
			КонецЕсли;
		КонецЕсли;
		
		//СВЭЙ 26.04.2024 КВВ СВФР-012944 (пункт 3) (
		ОтборУв = Новый Структура;
		ОтборУв.Вставить("ВидДеятельности", ВремНетрудДляПУ3);
		СтрокиУв = СведенияОСтаже.НайтиСтроки(ОтборУв); 
		Если СтрокиУв.Количество() > 0 Тогда   
			БылиИзменения = Ложь;  
			
			ТЗСотрВрН = Новый ТаблицаЗначений();
			ТЗСотрВрН.Колонки.Добавить("Сотрудник");
			ТЗСотрВрН.Колонки.Добавить("ДатаНачалаРабот");
			ТЗСотрВрН.Колонки.Добавить("ДатаОкончанияРабот");
			ТЗСотрВрН.Колонки.Добавить("Договор");
			
			Для Каждого СтрУв ИЗ СтрокиУв Цикл 
				
				Если НачалоМесяца(СтрУв.ДатаНачалаРабот) = НачалоМесяца(СтрУв.ДатаОкончанияРабот) Тогда 
					СтрТЗВрН = ТЗСотрВрН.Добавить();
    				ЗаполнитьЗначенияСвойств(СтрТЗВрН,СтрУв);
					Продолжить;
				КонецЕсли;
				
				БылиИзменения = Истина;
				
				НачалоСтарт = СтрУв.ДатаНачалаРабот; 
				КонецСтарт = СтрУв.ДатаОкончанияРабот;
				
				МесяцНачалаВрН = Месяц(СтрУв.ДатаНачалаРабот);
				МесяцКонцаВрН = Месяц(СтрУв.ДатаОкончанияРабот);
				ЛетМеждуДатами = Год(СтрУв.ДатаОкончанияРабот) - Год(СтрУв.ДатаНачалаРабот);
				РезультатВМесяцах = ЛетМеждуДатами * 12 - МесяцНачалаВрН + МесяцКонцаВрН;
				РезультатВМесяцах = РезультатВМесяцах + 1;
				
				Для А = 1 ПО РезультатВМесяцах Цикл
					Если РезультатВМесяцах > 1 Тогда
						Если А = 1 Тогда    
							СтрУв.ДатаОкончанияРабот = КонецМесяца(НачалоСтарт);  
							
							СтрТЗВрН = ТЗСотрВрН.Добавить();
    						ЗаполнитьЗначенияСвойств(СтрТЗВрН,СтрУв);
						ИначеЕсли А = РезультатВМесяцах Тогда
							СтрСтаж = СведенияОСтаже.Добавить();
							ЗаполнитьЗначенияСвойств(СтрСтаж,СтрУв);
							СтрСтаж.ДатаНачалаРабот = НачалоМесяца(КонецСтарт);
							СтрСтаж.ДатаОкончанияРабот = КонецДня(КонецСтарт);  
							
							СтрТЗВрН = ТЗСотрВрН.Добавить();
    						ЗаполнитьЗначенияСвойств(СтрТЗВрН,СтрСтаж);
						Иначе   
							СтрСтаж = СведенияОСтаже.Добавить();
							ЗаполнитьЗначенияСвойств(СтрСтаж,СтрУв);
							СтрСтаж.ДатаНачалаРабот = НачалоМесяца(ДобавитьМесяц(НачалоСтарт,А-1));
							СтрСтаж.ДатаОкончанияРабот = КонецМесяца(СтрУв.ДатаНачалаРабот);
							
							СтрТЗВрН = ТЗСотрВрН.Добавить();
    						ЗаполнитьЗначенияСвойств(СтрТЗВрН,СтрСтаж);
						КонецЕсли;  
					КонецЕсли;
				КонецЦикла;
			КонецЦикла; 
			
			Для Каждого СтрТЗВрН ИЗ ТЗСотрВрН Цикл
				ОтборУв = Новый Структура;
				ОтборУв.Вставить("Сотрудник", СтрТЗВрН.Сотрудник); 
				ОтборУв.Вставить("Договор", СтрТЗВрН.Договор);
				СтрокиУв = СведенияОСтаже.НайтиСтроки(ОтборУв); 
				Для Каждого СтрС ИЗ СтрокиУв Цикл  
					Если СтрС.ВидДеятельности = ВремНетрудДляПУ3 Тогда
						Продолжить;
					КонецЕсли;
					
					Если СтрС.ДатаНачалаРабот > СтрТЗВрН.ДатаОкончанияРабот
						ИЛИ СтрС.ДатаОкончанияРабот < СтрТЗВрН.ДатаНачалаРабот Тогда
						Продолжить;
					КонецЕсли;
					
					ВДТЗ2 = ВРЕГ(СокрЛП(СтрС.ВидДеятельности));  
					НайдЭл2 = СпЗн_ВД_ТипаПОСОБИЕ.НайтиПоЗначению(ВДТЗ2);  
					Если НайдЭл2 <> Неопределено Тогда
						Если СтрС.ДатаОкончанияРабот > СтрТЗВрН.ДатаНачалаРабот Тогда
							СтрС.ДатаОкончанияРабот = НачалоДня(СтрТЗВрН.ДатаНачалаРабот)-1;
						КонецЕсли;
					КонецЕсли;  
				КонецЦикла;
			КонецЦикла;
			
			Если БылиИзменения Тогда
				СведенияОСтаже.Сортировать("Сотрудник,Физлицо,ДатаНачалаРабот,ВидДеятельности");
			КонецЕсли;
		КонецЕсли;
		//СВЭЙ 26.04.2024 КВВ СВФР-012944 (пункт 3) )
		
		//ВРЕМНЕТРУД )   
		//СВЭЙ 03.04.2024 КВВ СВФР-012718 (пункт 2) )

		//Аверсон ЕАЕ 07.10.2024 СВФР-013489
		//ДПОСОБ100
		ПроверкаБЛ2Пособие1();
		//Аверсон СВФР-013489
		
		//Аверсон ЕАЕ 14.01.2025 СВФР-014563
		Если ДатаОкончания >= '20241231' И (ВсеСотрудники ИЛИ ДогПодряда) Тогда
			ГруппировкаДоговорВзносыврем();
		КонецЕсли;
		//Аверсон СВФР-014563
		
		//Аверсон ЕАЕ 06.03.2025 СВФР-014605
		//Уберем НЕОПЛДОГ, если не было взносов
		//Только если заполнение по всем
		Если ДатаНачала >= '20250101' И (ВсеСотрудники ИЛИ ДогПодряда) и не ДПУдалить Тогда
			Если Сотрудник = Неопределено Тогда
				//Это входит в обработку ниже
				//СтруктураОтбора = Новый Структура;
				//СтруктураОтбора.Вставить("ВидДеятельности", НЕОПЛДОГ);
				//МассивНЕОПЛДОГ = СведенияОСтаже.НайтиСтроки(СтруктураОтбора);
				//
				//МассивНЕОПЛДОГУдалить = Новый Массив;
				//МассивВзносыУдалить = Новый Массив;
				//Для Каждого Стр Из МассивНЕОПЛДОГ Цикл
				//	Если Не ЗначениеЗаполнено(Стр.Договор) Тогда
				//		Продолжить;
				//	КонецЕсли;
				//	//Проверяем взносы
				//	СтруктураОтбораВзносы = Новый Структура;
				//	СтруктураОтбораВзносы.Вставить("Сотрудник", Стр.Сотрудник);
				//	СтруктураОтбораВзносы.Вставить("Договор", Стр.Договор);
				//	
				//	МассивВзносы = СведенияОВзносах.НайтиСтроки(СтруктураОтбораВзносы);
				//	СуммаВзносов = 0;
				//	Для Каждого СтрВзносы Из МассивВзносы Цикл
				//		Если СтрВзносы.Месяц < ДатаНачала ИЛИ СтрВзносы.Месяц > ДатаОкончания Тогда
				//			Продолжить;
				//		КонецЕсли;
				//		СуммаВзносов = СуммаВзносов + СтрВзносы.Взносы;
				//	КонецЦикла;
				//	Если СуммаВзносов = 0 Тогда
				//		МассивНЕОПЛДОГУдалить.Добавить(Стр);
				//		Для Каждого СтрВзносы Из МассивВзносы Цикл
				//			МассивВзносыУдалить.Добавить(СтрВзносы);
				//		КонецЦикла;
				//	КонецЕсли;
				//КонецЦикла;
				//Для Каждого Стр Из МассивНЕОПЛДОГУдалить Цикл
				//	СведенияОСтаже.Удалить(Стр);
				//КонецЦикла;
				//Для Каждого Стр Из МассивВзносыУдалить Цикл
				//	СведенияОВзносах.Удалить(Стр);
				//КонецЦикла;
				//
				//МассивСотрудникиУдалить = Новый Массив;
				//Для Каждого Стр Из РаботникиОрганизации Цикл
				//	СтрСтаж = СведенияОСтаже.Найти(Стр.Сотрудник, "Сотрудник");
				//	СтрВзносы = СведенияОВзносах.Найти(Стр.Сотрудник, "Сотрудник");
				//	Если СтрСтаж = Неопределено И СтрВзносы = Неопределено Тогда
				//		МассивСотрудникиУдалить.Добавить(Стр);	
				//	КонецЕсли;
				//КонецЦикла;
				//Для Каждого Стр Из МассивСотрудникиУдалить Цикл
				//	РаботникиОрганизации.Удалить(Стр);	
				//КонецЦикла;
				
				ПоследнийКварталНачало = НачалоКвартала(ДатаОкончания);
				ПоследнийКварталКонец  = КонецДня(ДатаОкончания);
				
				//Отберем взносы за последний квартал
				ТЗВзносы = СведенияОВзносах.Выгрузить();
				к = ТЗВзносы.Количество();
				Если к > 0 Тогда
					Инд = к - 1;
					Для н = -Инд По 0 Цикл
						НомСтр = -н;
						ТекСтр = ТЗВзносы[НомСтр];
						Если Не (ТекСтр.Месяц >= ПоследнийКварталНачало И ТекСтр.Месяц <= ПоследнийКварталКонец) Тогда
							ТЗВзносы.Удалить(ТекСтр);	
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
				
				//Найдем строки стажа, которые нужно удалить
				МассивСтажУдалить = Новый Массив;
				МассивВзносыУдалить = Новый Массив;
				МассивСотрудникиУдалить = Новый Массив;
				Для Каждого Стр Из СведенияОСтаже Цикл
					Если Не ЗначениеЗаполнено(Стр.Договор) Тогда //??? может быть заполнен?
						Продолжить;
					КонецЕсли;
					СтруктураОтбора = Новый Структура;
					СтруктураОтбора.Вставить("Сотрудник", Стр.Сотрудник);
					СтруктураОтбора.Вставить("Договор", Стр.Договор);
					
					МассивСтрок = ТЗВзносы.НайтиСтроки(СтруктураОтбора);
					СуммаВыплат = 0;
					Для Каждого Эл Из МассивСтрок Цикл
						СуммаВыплат = СуммаВыплат + Эл.Выплаты;	
					КонецЦикла;
					Если МассивСтрок.Количество() = 0 ИЛИ СуммаВыплат = 0 Тогда
						МассивСтажУдалить.Добавить(Стр);
						
						МассивСтрокВзносы = СведенияОВзносах.НайтиСтроки(СтруктураОтбора);
						Для Каждого ЭлВзносы Из МассивСтрокВзносы Цикл
							Если МассивВзносыУдалить.Найти(ЭлВзносы) = Неопределено Тогда
								МассивВзносыУдалить.Добавить(ЭлВзносы);
							КонецЕсли;
						КонецЦикла;
						
					КонецЕсли;
				КонецЦикла;
				
				//Удалим
				Для Каждого Эл Из МассивСтажУдалить Цикл
					СведенияОСтаже.Удалить(Эл);	
				КонецЦикла;
				Для Каждого Эл Из МассивВзносыУдалить Цикл
					СведенияОВзносах.Удалить(Эл);	
				КонецЦикла;
				
				//Удалим работника, если у него нет ни стажа, ни взносов
				Для Каждого Стр Из РаботникиОрганизации Цикл
					СтрСтаж = СведенияОСтаже.Найти(Стр.Сотрудник, "Сотрудник");
					СтрВзносы = СведенияОВзносах.Найти(Стр.Сотрудник, "Сотрудник");
					Если СтрСтаж = Неопределено И СтрВзносы = Неопределено Тогда
						МассивСотрудникиУдалить.Добавить(Стр);	
					КонецЕсли;
				КонецЦикла;
				Для Каждого Стр Из МассивСотрудникиУдалить Цикл
					РаботникиОрганизации.Удалить(Стр);	
				КонецЦикла;
				
			КонецЕсли;
		КонецЕсли;
		//Аверсон СВФР-014605
		
		//Аверсон ЕАЕ 16.04.2025 СВФР-014605
		//Уберем строки стажа, если не было выплат за квартал
		//Перенесено выше
		//Если ВсеСотрудники ИЛИ ДогПодряда Тогда
		//	ПоследнийКварталНачало = НачалоКвартала(ДатаОкончания);
		//	ПоследнийКварталКонец  = КонецДня(ДатаОкончания);
		//	
		//	//Отберем взносы за последний квартал
		//	ТЗВзносы = СведенияОВзносах.Выгрузить();
		//	к = ТЗВзносы.Количество();
		//	Если к > 0 Тогда
		//		Инд = к - 1;
		//		Для н = -Инд По 0 Цикл
		//			НомСтр = -н;
		//			ТекСтр = ТЗВзносы[НомСтр];
		//			Если Не (ТекСтр.Месяц >= ПоследнийКварталНачало И ТекСтр.Месяц <= ПоследнийКварталКонец) Тогда
		//				ТЗВзносы.Удалить(ТекСтр);	
		//			КонецЕсли;
		//		КонецЦикла;
		//	КонецЕсли;
		//	
		//	//Найдем строки стажа, которые нужно удалить
		//	МассивСтажУдалить = Новый Массив;
		//	МассивВзносыУдалить = Новый Массив;
		//	МассивСотрудникиУдалить = Новый Массив;
		//	Для Каждого Стр Из СведенияОСтаже Цикл
		//		Если Не ЗначениеЗаполнено(Стр.Договор) Тогда //??? может быть заполнен?
		//			Продолжить;
		//		КонецЕсли;
		//		СтруктураОтбора = Новый Структура;
		//		СтруктураОтбора.Вставить("Сотрудник", Стр.Сотрудник);
		//		СтруктураОтбора.Вставить("Договор", Стр.Договор);
		//		
		//		МассивСтрок = ТЗВзносы.НайтиСтроки(СтруктураОтбора);
		//		СуммаВыплат = 0;
		//		Для Каждого Эл Из МассивСтрок Цикл
		//			СуммаВыплат = СуммаВыплат + Эл.Выплаты;	
		//		КонецЦикла;
		//		Если МассивСтрок.Количество() = 0 ИЛИ СуммаВыплат = 0 Тогда
		//			МассивСтажУдалить.Добавить(Стр);
		//			
		//			МассивСтрокВзносы = СведенияОВзносах.НайтиСтроки(СтруктураОтбора);
		//			Для Каждого ЭлВзносы Из МассивСтрокВзносы Цикл
		//				Если МассивВзносыУдалить.Найти(ЭлВзносы) = Неопределено Тогда
		//					МассивВзносыУдалить.Добавить(ЭлВзносы);
		//				КонецЕсли;
		//			КонецЦикла;

		//		КонецЕсли;
		//	КонецЦикла;
		//	
		//	//Удалим
		//	Для Каждого Эл Из МассивСтажУдалить Цикл
		//		СведенияОСтаже.Удалить(Эл);	
		//	КонецЦикла;
		//	Для Каждого Эл Из МассивВзносыУдалить Цикл
		//		СведенияОВзносах.Удалить(Эл);	
		//	КонецЦикла;
		//	
		//	//Удалим работника, если у него нет ни стажа, ни взносов
		//	Для Каждого Стр Из РаботникиОрганизации Цикл
		//		СтрСтаж = СведенияОСтаже.Найти(Стр.Сотрудник, "Сотрудник");
		//		СтрВзносы = СведенияОВзносах.Найти(Стр.Сотрудник, "Сотрудник");
		//		Если СтрСтаж = Неопределено И СтрВзносы = Неопределено Тогда
		//			МассивСотрудникиУдалить.Добавить(Стр);	
		//		КонецЕсли;
		//	КонецЦикла;
		//	Для Каждого Стр Из МассивСотрудникиУдалить Цикл
		//		РаботникиОрганизации.Удалить(Стр);	
		//	КонецЦикла;
		//	
		//КонецЕсли;
		//Аверсон СВФР-014605
		
	КонецЕсли;
	
	//проверка заполнение Видов деятельности по всем видам расчета для ТЧ Стажа )
	//СВЭЙ 21.12.2023 СВФР-011519 )
	
КонецФункции

//Аверсон ЕАЕ 17.01.2023 СВФР-010135
Процедура ПроверкаПособий()
	Пособие = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБИЕ");
	
	Отбор = Новый Структура;
	Отбор.Вставить("ВидДеятельности", Пособие);
	Отбор.Вставить("ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.Подряда);
	МассивСтрок = СведенияОСтаже.НайтиСтроки(Отбор);
	
	ТЗ = СведенияОСтаже.Выгрузить(МассивСтрок);
	ТЗПериоды = ТЗ.Скопировать();
	ТЗПериоды.Свернуть("ФизЛицо,Сотрудник,ДатаНачалаРабот,ДатаОкончанияРабот");
	
	ТЗПересекающиесяДоговора = ТЗ.СкопироватьКолонки();
	ТЗПересекающиесяДоговора.Колонки.Добавить("ПерваяСтрока", Новый ОписаниеТипов("Булево"));
	
	Для Каждого Стр Из ТЗПериоды Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("ФизЛицо", Стр.ФизЛицо);
		Отбор.Вставить("Сотрудник", Стр.Сотрудник);
		Отбор.Вставить("ДатаНачалаРабот", Стр.ДатаНачалаРабот);
		Отбор.Вставить("ДатаОкончанияРабот", Стр.ДатаОкончанияРабот);
		НужныеСтроки = ТЗ.НайтиСтроки(Отбор);
		//если в периоде несколько договоров
		Если НужныеСтроки.Количество() > 1 Тогда
			Для Каждого Д Из НужныеСтроки Цикл
				НоваяСтр = ТЗПересекающиесяДоговора.Добавить();
				ЗаполнитьЗначенияСвойств(НоваяСтр,Д);
				Если НужныеСтроки.Найти(Д) = 0 Тогда
					НоваяСтр.ПерваяСтрока = Истина;
				Иначе
					НоваяСтр.ПерваяСтрока = Ложь;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	СписокФизЛиц = ТЗПериоды.ВыгрузитьКолонку("ФизЛицо");
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	|   ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
	|   ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
	|   ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ДоговорПодряда КАК Договор,
	|   ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало КАК ДатаНачалаРабот,
	|   ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец КАК ДатаОкончанияРабот,
	|   СУММА(ДополнительныеНачисленияРаботниковОрганизаций.Результат) КАК СуммаБольничного
	//|ПОМЕСТИТЬ ВТСуммыБольничных
	|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
	|ГДЕ ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо В (&СписокФизЛиц)
	|	И ДополнительныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда
	|   И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= &Начало И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец <= &Окончание
	|СГРУППИРОВАТЬ ПО
	|   ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
	|   ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
	|   ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ДоговорПодряда,
	|   ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
	|   ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
	|";
	Запрос.УстановитьПараметр("Начало", ДатаНачала);
	Запрос.УстановитьПараметр("Окончание", ДатаОкончания);
	Запрос.УстановитьПараметр("СписокФизЛиц", СписокФизЛиц);
	ТЗБольничные = Запрос.Выполнить().Выгрузить();
	
	КолСтрок = СведенияОСтаже.Количество();
	Если КолСтрок > 0 Тогда
		ПоследнийИндекс = КолСтрок - 1;
		Для к = -ПоследнийИндекс По 0 Цикл
			Стр = СведенияОСтаже[-к];
			Отбор = Новый Структура;
			Отбор.Вставить("ФизЛицо", Стр.ФизЛицо);
			Отбор.Вставить("Сотрудник", Стр.Сотрудник);
			Отбор.Вставить("ДатаНачалаРабот", Стр.ДатаНачалаРабот);
			Отбор.Вставить("ДатаОкончанияРабот", Стр.ДатаОкончанияРабот);
			Отбор.Вставить("Договор", Стр.Договор);
			Отбор.Вставить("ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.Подряда);
			Отбор.Вставить("ВидДеятельности", Пособие);
			
			НужныеСтрокиПересекающиесяДоговора = ТЗПересекающиесяДоговора.НайтиСтроки(Отбор);
			Если НужныеСтрокиПересекающиесяДоговора.Количество() > 0 Тогда
				НужнаяСтрокаПересекающиесяДоговора = НужныеСтрокиПересекающиесяДоговора[0];
				Отбор = Новый Структура;
				Отбор.Вставить("ФизЛицо", Стр.ФизЛицо);
				Отбор.Вставить("Сотрудник", Стр.Сотрудник);
				Отбор.Вставить("ДатаНачалаРабот", Стр.ДатаНачалаРабот);
				Отбор.Вставить("ДатаОкончанияРабот", КонецДня(Стр.ДатаОкончанияРабот));
				Отбор.Вставить("Договор", Стр.Договор);
				
				НужныеСтрокиБольничныеСДоговором = ТЗБольничные.НайтиСтроки(Отбор);
				Если НужныеСтрокиБольничныеСДоговором.Количество() = 0 Тогда
					Если НужнаяСтрокаПересекающиесяДоговора.ПерваяСтрока Тогда
						Отбор = Новый Структура;
						Отбор.Вставить("ФизЛицо", Стр.ФизЛицо);
						Отбор.Вставить("Сотрудник", Стр.Сотрудник);
						Отбор.Вставить("ДатаНачалаРабот", Стр.ДатаНачалаРабот);
						Отбор.Вставить("ДатаОкончанияРабот", КонецДня(Стр.ДатаОкончанияРабот));
						Отбор.Вставить("Договор", Документы.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка());
						НужныеСтрокиБольничногоБезДОговора = ТЗБольничные.НайтиСтроки(Отбор);
						Если НужныеСтрокиБольничногоБезДОговора.Количество() = 0 Тогда
							СведенияОСтаже.Удалить(-к);	
						КонецЕсли;
					Иначе
						СведенияОСтаже.Удалить(-к);
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры

Процедура ПерераспределитьВзносыПоДоговорам()
	//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 6) (
	НеоплДог = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("НЕОПЛДОГ");   
	Договор = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДОГОВОР");
	//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 6) )
	
	Отбор = Новый Структура;
	Отбор.Вставить("ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.Подряда);
	МассивСтрок = СведенияОВзносах.НайтиСтроки(Отбор);
	ТЗ = СведенияОВзносах.Выгрузить(МассивСтрок);
	ТЗПериоды = ТЗ.Скопировать();
	
	//Аверсон 26.04.2023 КВВ СВФР-010716 (
	ТЗПериоды.Свернуть("ФизЛицо,Сотрудник,Месяц");  //было закомментировано заявкой СВФР-010716 
	//ТЗПериоды.Свернуть("ФизЛицо,Сотрудник,Месяц,Договор");  //СВЭЙ 23.01.2024 КВВ СВФР-012080 (закомментировано, т.к. не шла разбивка сумм (Стравита Билал О.В. июнь 2023 БЛ по двум дог.подряда)
	//Аверсон 26.04.2023 КВВ СВФР-010716 )
	
	ТЗПересекающиесяДоговора = ТЗ.СкопироватьКолонки();
	ТЗПересекающиесяДоговора.Колонки.Добавить("ПерваяСтрока", Новый ОписаниеТипов("Булево"));
	Для Каждого Стр Из ТЗПериоды Цикл
		Отбор = Новый Структура;
		Отбор.Вставить("ФизЛицо", Стр.ФизЛицо);
		Отбор.Вставить("Сотрудник", Стр.Сотрудник);
		Отбор.Вставить("Месяц", Стр.Месяц);
		//	Отбор.Вставить("Договор", Стр.Договор); //Аверсон 26.04.2023 КВВ СВФР-010716  //СВЭЙ 23.01.2024 КВВ СВФР-012080 (закомментировано, т.к. не шла разбивка сумм (Стравита Билал О.В. июнь 2023 БЛ по двум дог.подряда)
		НужныеСтроки = ТЗ.НайтиСтроки(Отбор);
		//если в периоде несколько договоров
		Если НужныеСтроки.Количество() > 1 Тогда
			
			//СВЭЙ 28.01.2024 КВВ СВФР-012080 (
			//(закомментированное выше этой заявкой обходим другим способом 
			//(проблема: Стравита: Билал О.В. июнь 2023 БЛ (параллельные договора) + Арлекс: Копа В.А. янв 2023 (последовательные договора ))
			НужноДобавлять = Истина;
			НужныеСтроки2 = ТЗ.НайтиСтроки(Отбор);
			Для Каждого Д Из НужныеСтроки Цикл
				НачДП = Д.Договор.ДатаНачала;
				КонДП = Д.Договор.ДатаОкончания;   
				
				Если НужноДобавлять Тогда
					Для Каждого Д2 Из НужныеСтроки2 Цикл
						Если Д2 = Д Тогда 
							Продолжить;
						КонецЕсли; 
						НачДП2 = Д2.Договор.ДатаНачала;
						КонДП2 = Д2.Договор.ДатаОкончания;
						
						Если НачДП > КонДП2 ИЛИ КонДП < НачДП2 Тогда
							НужноДобавлять = Ложь;
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			КонецЦикла;
			
			Если НужноДобавлять Тогда
				//СВЭЙ 28.01.2024 КВВ СВФР-01208 )
				
				Для Каждого Д Из НужныеСтроки Цикл
					НоваяСтр = ТЗПересекающиесяДоговора.Добавить();
					ЗаполнитьЗначенияСвойств(НоваяСтр,Д);
					Если НужныеСтроки.Найти(Д) = 0 Тогда
						НоваяСтр.ПерваяСтрока = Истина;
					Иначе
						НоваяСтр.ПерваяСтрока = Ложь;
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	Если ТЗПересекающиесяДоговора.Количество() > 0 Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВЫРАЗИТЬ(ТаблицаРабот.ФизЛицо КАК Справочник.ФизическиеЛица) КАК ФизЛицо,
		|   ВЫРАЗИТЬ(ТаблицаРабот.Сотрудник КАК Справочник.СотрудникиОрганизаций) КАК Сотрудник,
		|   ВЫРАЗИТЬ(ТаблицаРабот.Договор КАК Документ.ДоговорНаВыполнениеРаботСФизЛицом) КАК Договор,
		|   ВЫРАЗИТЬ(ТаблицаРабот.Месяц КАК Дата) КАК Месяц,
		|   ВЫРАЗИТЬ(ТаблицаРабот.ПерваяСтрока КАК Булево) КАК ПерваяСтрока
		|ПОМЕСТИТЬ ВТ_ТаблицаРабот
		|ИЗ
		|	&ТаблицаРабот КАК ТаблицаРабот
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НАЧАЛОПЕРИОДА(НачисленияПоДоговорам.ДатаНачала, МЕСЯЦ) КАК Месяц,
		|	СУММА( НачисленияПоДоговорам.Результат ) КАК СуммаДохода,
		|	НачисленияПоДоговорам.Физлицо,
		|   НачисленияПоДоговорам.Сотрудник,
		|	НачисленияПоДоговорам.ДокументОснование КАК Договор
		|ПОМЕСТИТЬ ВТСуммыДоходов
		|ИЗ
		|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачисленияПоДоговорам
		|ГДЕ НачисленияПоДоговорам.ДатаНачала >= &Начало И НачисленияПоДоговорам.ДатаОкончания <= &Окончание
		|	И НачисленияПоДоговорам.ФизЛицо В (ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТаблицаРабот.ФизЛицо ИЗ ВТ_ТаблицаРабот)
		|   И НачисленияПоДоговорам.Сотрудник В (ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТаблицаРабот.Сотрудник ИЗ ВТ_ТаблицаРабот)
		|   И НачисленияПоДоговорам.ДокументОснование В (ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТаблицаРабот.Договор ИЗ ВТ_ТаблицаРабот)
		|	И НачисленияПоДоговорам.Ссылка.Проведен
		|СГРУППИРОВАТЬ ПО
		|	НАЧАЛОПЕРИОДА(НачисленияПоДоговорам.ДатаНачала, МЕСЯЦ),
		|	НачисленияПоДоговорам.Физлицо,
		|   НачисленияПоДоговорам.Сотрудник,
		|	НачисленияПоДоговорам.ДокументОснование
		|;
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|   ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|   ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
		|   ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ДоговорПодряда КАК Договор,
		
		//проблема: Стравита Жежа Ю.А. февральские БЛ сели в март по дате регистрации, должны в февраль 2023 (
		//|   НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) КАК Месяц,
		|НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) КАК Месяц,
		//проблема: Стравита Жежа Ю.А. февральские БЛ сели в март по дате регистрации, должны в февраль 2023 )
		
		|   СУММА(ДополнительныеНачисленияРаботниковОрганизаций.Результат) КАК СуммаБольничного
		|ПОМЕСТИТЬ ВТСуммыБольничных
		|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|ГДЕ ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо В (ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТаблицаРабот.ФизЛицо ИЗ ВТ_ТаблицаРабот)
		|	И ДополнительныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда
		|   И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= &Начало И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец <= &Окончание
		|СГРУППИРОВАТЬ ПО
		
		//проблема: Стравита Жежа Ю.А. февральские БЛ сели в март по дате регистрации, должны в февраль 2023 (
		//|   НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
		|НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ),
		//проблема: Стравита Жежа Ю.А. февральские БЛ сели в март по дате регистрации, должны в февраль 2023 )
		
		|   ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ДоговорПодряда,
		|   ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|   ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
		|;
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|   ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|   ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
		|   НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) КАК Месяц,
		|   СУММА(ОсновныеНачисленияРаботниковОрганизаций.Результат) КАК СуммаРН
		|ПОМЕСТИТЬ ВТСуммыРН
		|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		|ГДЕ ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо В (ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТаблицаРабот.ФизЛицо ИЗ ВТ_ТаблицаРабот)
		|	И ОсновныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций
		|   И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало >= &Начало И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец <= &Окончание
		
		//СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 7) (
		|И (ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяПолностью)
		|ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиЕП)
		|ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗН)
		|ИЛИ ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиСТРАХ))
		//СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 7) )
		
		|СГРУППИРОВАТЬ ПО
		|   НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
		|   ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|   ОсновныеНачисленияРаботниковОрганизаций.Сотрудник
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|   ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|   ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
		|   НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) КАК Месяц,
		|   СУММА(ДополнительныеНачисленияРаботниковОрганизаций.Результат)
		|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		|ГДЕ ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо В (ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТаблицаРабот.ФизЛицо ИЗ ВТ_ТаблицаРабот)
		|	И ДополнительныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций
		|   И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= &Начало И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец <= &Окончание
		
		//СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 7) (
		|И (ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяПолностью)
		|ИЛИ ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиЕП)
		|ИЛИ ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗН)
		|ИЛИ ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.КодДоходаЕСН = ЗНАЧЕНИЕ(Справочник.ДоходыЕСН.ОблагаетсяФСЗНиСТРАХ))
		//СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 7) )
		
		|СГРУППИРОВАТЬ ПО
		|   НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
		|   ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		|   ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
		|;
		|///////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТ_ТаблицаРабот.ФизЛицо,
		|   ВТ_ТаблицаРабот.Сотрудник,
		|   ВТ_ТаблицаРабот.Договор,
		|   ВТ_ТаблицаРабот.Месяц,
		|   ВТ_ТаблицаРабот.ПерваяСтрока,
		|   СУММА(ЕСТЬNULL(ВТСуммыДоходов.СуммаДохода,0)) КАК СуммаДохода,
		|   СУММА(ЕСТЬNULL(ВТСуммыБольничных.СуммаБольничного,0)) КАК СуммаБольничного
		|ПОМЕСТИТЬ ВТРезультат
		|ИЗ ВТ_ТаблицаРабот
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТСуммыДоходов
		|ПО ВТ_ТаблицаРабот.ФизЛицо = ВТСуммыДоходов.ФизЛицо
		|	И ВТ_ТаблицаРабот.Сотрудник = ВТСуммыДоходов.Сотрудник
		|   И ВТ_ТаблицаРабот.Договор = ВТСуммыДоходов.Договор
		|   И ВТ_ТаблицаРабот.Месяц = ВТСуммыДоходов.Месяц
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТСуммыБольничных
		|ПО ВТ_ТаблицаРабот.ФизЛицо = ВТСуммыБольничных.ФизЛицо
		|	И ВТ_ТаблицаРабот.Сотрудник = ВТСуммыБольничных.Сотрудник
		|   И ВТ_ТаблицаРабот.Договор = ВТСуммыБольничных.Договор
		|   И ВТ_ТаблицаРабот.Месяц = ВТСуммыБольничных.Месяц
		|СГРУППИРОВАТЬ ПО
		|	ВТ_ТаблицаРабот.ФизЛицо,
		|   ВТ_ТаблицаРабот.Сотрудник,
		|   ВТ_ТаблицаРабот.Договор,
		|   ВТ_ТаблицаРабот.Месяц,
		|   ВТ_ТаблицаРабот.ПерваяСтрока
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВТ_ТаблицаРабот.ФизЛицо,
		|   ВТ_ТаблицаРабот.Сотрудник,
		|   ВТ_ТаблицаРабот.Договор,
		|   ВТ_ТаблицаРабот.Месяц,
		|   ВТ_ТаблицаРабот.ПерваяСтрока,
		|   0,
		|   СУММА(ЕСТЬNULL(ВТСуммыБольничных.СуммаБольничного,0))
		|ИЗ ВТ_ТаблицаРабот
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТСуммыБольничных
		|ПО ВТ_ТаблицаРабот.ФизЛицо = ВТСуммыБольничных.ФизЛицо
		|	И ВТ_ТаблицаРабот.Сотрудник = ВТСуммыБольничных.Сотрудник
		|   И ВТ_ТаблицаРабот.ПерваяСтрока = ИСТИНА
		|   И ВТ_ТаблицаРабот.Месяц = ВТСуммыБольничных.Месяц
		|   И ВТСуммыБольничных.Договор = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
		|СГРУППИРОВАТЬ ПО
		|	ВТ_ТаблицаРабот.ФизЛицо,
		|   ВТ_ТаблицаРабот.Сотрудник,
		|   ВТ_ТаблицаРабот.Договор,
		|   ВТ_ТаблицаРабот.Месяц,
		|   ВТ_ТаблицаРабот.ПерваяСтрока
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВТ_ТаблицаРабот.ФизЛицо,
		|   ВТ_ТаблицаРабот.Сотрудник,
		|   ВТ_ТаблицаРабот.Договор,
		|   ВТ_ТаблицаРабот.Месяц,
		|   ВТ_ТаблицаРабот.ПерваяСтрока,
		|   СУММА(ЕСТЬNULL(ВТСуммыРН.СуммаРН,0)),
		|   0
		|ИЗ ВТ_ТаблицаРабот
		|ЛЕВОЕ СОЕДИНЕНИЕ ВТСуммыРН
		|ПО ВТ_ТаблицаРабот.ФизЛицо = ВТСуммыРН.ФизЛицо
		|	И ВТ_ТаблицаРабот.Сотрудник = ВТСуммыРН.Сотрудник
		|   И ВТ_ТаблицаРабот.ПерваяСтрока = ИСТИНА
		|   И ВТ_ТаблицаРабот.Месяц = ВТСуммыРН.Месяц
		|СГРУППИРОВАТЬ ПО
		|	ВТ_ТаблицаРабот.ФизЛицо,
		|   ВТ_ТаблицаРабот.Сотрудник,
		|   ВТ_ТаблицаРабот.Договор,
		|   ВТ_ТаблицаРабот.Месяц,
		|   ВТ_ТаблицаРабот.ПерваяСтрока
		|;
		|///////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВТРезультат.ФизЛицо,
		|   ВТРезультат.Сотрудник,
		|   ВТРезультат.Договор,
		|   ВТРезультат.Месяц,
		|   ВТРезультат.ПерваяСтрока,
		|   СУММА(ВТРезультат.СуммаДохода) КАК СуммаДохода,
		|   СУММА(ВТРезультат.СуммаБольничного) КАК СуммаБольничного
		|ИЗ ВТРезультат
		|СГРУППИРОВАТЬ ПО
		|	ВТРезультат.ФизЛицо,
		|   ВТРезультат.Сотрудник,
		|   ВТРезультат.Договор,
		|   ВТРезультат.Месяц,
		|	ВТРезультат.ПерваяСтрока
		|";
		
		Запрос.УстановитьПараметр("ТаблицаРабот", ТЗПересекающиесяДоговора);
		Запрос.УстановитьПараметр("Начало", ДатаНачала);
		Запрос.УстановитьПараметр("Окончание", КонецДня(ДатаОкончания)); //СВЭЙ 05.04.2024 КВВ СВФР-012718 (пункт 5) (было просто "ДатаОкончания")
		
		ТЗСуммыПоДоговорам = Запрос.Выполнить().Выгрузить();
		
		Для Каждого Стр Из СведенияОВзносах Цикл
			Если Стр.ВидДоговора <> Перечисления.ВидыДоговоровСФизЛицами.Подряда Тогда
				Продолжить;
			КонецЕсли;
			Если Не ЗначениеЗаполнено(Стр.Договор) Тогда
				Продолжить;
			КонецЕсли;
			Отбор = Новый Структура;
			Отбор.Вставить("ФизЛицо", Стр.ФизЛицо);
			Отбор.Вставить("Сотрудник", Стр.Сотрудник);
			Отбор.Вставить("Месяц", Стр.Месяц);
			Отбор.Вставить("Договор", Стр.Договор);
			НужныеСтроки = ТЗСуммыПоДоговорам.НайтиСтроки(Отбор);
			Если НужныеСтроки.Количество() > 0 Тогда
				Стр.Выплаты = НужныеСтроки[0].СуммаДохода;
				Стр.Пособия = НужныеСтроки[0].СуммаБольничного;    
				
				//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 6) (
				Если Стр.Выплаты > 0 ИЛИ Стр.Пособия > 0 Тогда
					ОтборСтаж = Новый Структура;
					ОтборСтаж.Вставить("ФизЛицо", Стр.ФизЛицо);
					ОтборСтаж.Вставить("Сотрудник", Стр.Сотрудник);
					ОтборСтаж.Вставить("Договор", Стр.Договор);
					ОтборСтаж.Вставить("ВидДеятельности", НеоплДог);
					НужныеСтрокиСтаж = СведенияОСтаже.НайтиСтроки(ОтборСтаж);
					Если НужныеСтрокиСтаж.Количество() > 0 Тогда
						Для Каждого СтрСтаж ИЗ НужныеСтрокиСтаж Цикл
							СтрСтаж.ВидДеятельности = Договор;	
						КонецЦикла;	
					КонецЕсли;
				КонецЕсли;
				//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 6) )
				
				//СВЭЙ 23.01.2024 КВВ СВФР-012080 (
				Стр.ПособияБР = ПроверкаСуммыПоПособиямВыплатам(Стр.Сотрудник,Стр.Месяц,1,Стр.Договор); //СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 5) (Договор)
				Стр.ОплатыДопДня = ПроверкаСуммыПоПособиямВыплатам(Стр.Сотрудник,Стр.Месяц,2);
				Стр.ПособияВН = Стр.Пособия - Стр.ПособияБР - Стр.ОплатыДопДня;  
				//СВЭЙ 23.01.2024 КВВ СВФР-012080 )
				
				//Если НЕ НужныеСтроки[0].ПерваяСтрока Тогда // 14.01.24 зачем обнулять взносы, итог по документу взносов не совпадает
				//	Стр.Взносы = 0;
				//КонецЕсли;
				
				//Проверяем на размерсреднейзарплаты*5
				НаДату = Стр.Месяц - 1;
				ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
				Если Стр.Сотрудник.ВидНалогообложенияОсновной = Справочники.ВидыНалогообложения.ПустаяСсылка() Тогда 
					ВидНалогообложения = Организация.ОсновнаяСтавкаНалогообложения;
				иначе
					ВидНалогообложения = Стр.Сотрудник.ВидНалогообложенияОсновной;
				КонецЕсли;
				СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(НаДату,Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ВидНалогообложения));
				РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НаДату,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
				БазаОграниченияФСЗН = СтруктураПенс.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
				
				Если Стр.Выплаты > БазаОграниченияФСЗН Тогда
					Сообщить("В строке " + СокрЛП(Стр.НомерСтроки) + " табличной части Сведения о взносах сумма выплат превышает 5-кратный размер средней зп."); 	
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры
//Аверсон СВФР-010135

//Аверсон ЕАЕ 20.07.2021 СВФР-007783
Процедура ДозаполнитьНедостающихСотрудников(СписокНадо, СписокЕсть)
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СотрудникиОрганизаций.Ссылка КАК Сотрудник,
	|	СотрудникиОрганизаций.Физлицо,
	|	СотрудникиОрганизаций.Физлицо.Пол КАК Пол,
	|	СотрудникиОрганизаций.Физлицо.ДатаРождения КАК ДатаРождения,
	|   ФИОФизЛиц.Фамилия,
	|   ФИОФизЛиц.Имя,
	|   ФИОФизЛиц.Отчество,
	|   ПаспортныеДанныеФизЛиц.ЛичныйНомер КАК ЛичныйНомер,
	|   ПаспортныеДанныеФизЛиц.ДокументСерия КАК ПаспортСерия,
	|   ПаспортныеДанныеФизЛиц.ДокументНомер КАК ПаспортНомер,
	|   ПаспортныеДанныеФизЛиц.ДокументКемВыдан КАК ПаспортКемВыдан,
	|   ПаспортныеДанныеФизЛиц.ДокументДатаВыдачи КАК ПаспортДатавыдачи,
	|   СотрудникиОрганизаций.ВидДоговора,
	|   СотрудникиОрганизаций.ВидДоговора КАК ВидДоговора1,
	|   СотрудникиОрганизаций.Физлицо.МестоРождения КАК МестоРождения,
	|	СотрудникиОрганизаций.Физлицо.СтатусКатегория КАК Категория,
	|   ГражданствоФизЛиц.Страна КАК Гражданство,
	|   ВЫБОР
	|   КОГДА РаботникиОрганизацийПрием.Период ЕСТЬ NULL
	|   ТОГДА ДатаВремя(1,1,1)
	|   ИНАЧЕ РаботникиОрганизацийПрием.Период
	|   КОНЕЦ КАК ДатаПриема,
	|   ВЫБОР
	|   КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
	|   ТОГДА ДатаВремя(1,1,1)
	|   ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(РаботникиОрганизацийУвольнение.Период, ДЕНЬ), СЕКУНДА, -1), ДЕНЬ)
	|   КОНЕЦ КАК ДатаУвольнения
	|ИЗ
	|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
	|
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ФИОФизЛиц.СрезПоследних(&ДатаНачала) КАК ФИОФизЛиц
	|ПО СотрудникиОрганизаций.Физлицо = ФИОФизЛиц.ФизЛицо
	|
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПаспортныеДанныеФизЛиц.СрезПоследних(&ДатаНачала) КАК ПаспортныеДанныеФизЛиц
	|ПО СотрудникиОрганизаций.Физлицо = ПаспортныеДанныеФизЛиц.ФизЛицо
	|
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&ДатаНачала) КАК ГражданствоФизЛиц
	|ПО СотрудникиОрганизаций.Физлицо = ГражданствоФизЛиц.ФизЛицо
	|
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийПрием
	|ПО СотрудникиОрганизаций.Ссылка = РаботникиОрганизацийПрием.Сотрудник
	|И РаботникиОрганизацийПрием.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)
	|
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийУвольнение
	|ПО СотрудникиОрганизаций.Ссылка = РаботникиОрганизацийУвольнение.Сотрудник
	|И РаботникиОрганизацийУвольнение.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
	|
	|ГДЕ
	|	СотрудникиОрганизаций.Ссылка В(&СписокНадо)
	|	И НЕ СотрудникиОрганизаций.Ссылка В (&СписокЕсть)
	|	И НЕ СотрудникиОрганизаций.ПометкаУдаления
	|   И ВЫБОР
	|   	КОГДА РаботникиОрганизацийПрием.Период ЕСТЬ NULL
	|   	ТОГДА ДатаВремя(1,1,1)
	|   	ИНАЧЕ РаботникиОрганизацийПрием.Период
	|   	КОНЕЦ <> ДатаВремя(1,1,1)
	|   И ВЫБОР
	|   	КОГДА РаботникиОрганизацийПрием.Период ЕСТЬ NULL
	|   	ТОГДА ДатаВремя(1,1,1)
	|   	ИНАЧЕ РаботникиОрганизацийПрием.Период
	|   	КОНЕЦ < &ДатаОкончания
	|   И (ВЫБОР
	|   	КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
	|   	ТОГДА ДатаВремя(1,1,1)
	|   	ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(РаботникиОрганизацийУвольнение.Период, ДЕНЬ), СЕКУНДА, -1), ДЕНЬ)
	|   	КОНЕЦ = ДатаВремя(1,1,1)
	|   ИЛИ
	|   	ВЫБОР
	|   	КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
	|   	ТОГДА ДатаВремя(1,1,1)
	|   	ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(РаботникиОрганизацийУвольнение.Период, ДЕНЬ), СЕКУНДА, -1), ДЕНЬ)
	|   	КОНЕЦ > &ДатаНачала)
	|";
	
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("СписокНадо", СписокНадо);
	Запрос.УстановитьПараметр("СписокЕсть", СписокЕсть);
	Запрос.УстановитьПараметр("ДатаНачала", ДатаНачала);
	Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончания);
	Результат = Запрос.Выполнить();
	Если Не Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Пока Выборка.Следующий() Цикл
			НоваяСтр = РаботникиОрганизации.Добавить();
			ЗаполнитьЗначенияСвойств(НоваяСтр, Выборка);
		КонецЦикла;
	КонецЕсли;
	РаботникиОрганизации.Сортировать("Сотрудник");
КонецПроцедуры

Процедура ЗаполнитьПрофДопДляПУ3(ПрофДопДляПУ3, ВзносыВрем)
	//Получаем тз взносыврем
	ТЗСведенияОСтаже = СведенияОСтаже.Выгрузить();
	КоличествоСтрок = ТЗСведенияОСтаже.Количество();
	Если КоличествоСтрок > 0 Тогда
		ИндексПоследнейСтроки = КоличествоСтрок - 1;
		Для н = -ИндексПоследнейСтроки По 0 Цикл
			ИндексСтроки = -н;
			НужнаяСтрока = ТЗСведенияОСтаже[ИндексСтроки];
			Если НужнаяСтрока.ВидДеятельности <> ВзносыВрем Тогда
				ТЗСведенияОСтаже.Удалить(НужнаяСтрока);	
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ТЗ.Сотрудник,
	|	ТЗ.ФизЛицо,
	|	ТЗ.ДатаНачалаРабот,
	|	ТЗ.ДатаОкончанияРабот
	|ПОМЕСТИТЬ ВТТЗ
	|ИЗ &ТЗ КАК ТЗ
	|;
	|//////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
	|	ОсновныеНачисленияРаботниковОрганизаций.Результат КАК Результат,
	|   ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
	
	//Аверсон ЕАЕ 27.10.2022 СВФР-009696
	|   ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ДатаС,
	|   ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ДатаПо
	//Аверсон СВФР-009696
	
	|ПОМЕСТИТЬ ВТНачисления
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыРасчетов.Основные КАК ГруппыРасчетовОсновные
	|	ПО ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = ГруппыРасчетовОсновные.ВидРасчета
	|		И (ГруппыРасчетовОсновные.Ссылка = &ГруппаРасчетовПрофДопПУ3)
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо.СтатусКатегория <> &КатегорияПоДоговорамПодряда
	|	И ОсновныеНачисленияРаботниковОрганизаций.Результат > 0
	|	И НЕ ГруппыРасчетовОсновные.Ссылка ЕСТЬ NULL
	|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ДатаНачала И &ДатаОкончания
	|   И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В (ВЫБРАТЬ ВТТЗ.Сотрудник ИЗ ВТТЗ)
	|	
	|ОБЪЕДИНИТЬ ВСЕ
	|	
	|ВЫБРАТЬ
	|	ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
	|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
	|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
	|   ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации,
	
	//Аверсон ЕАЕ 27.10.2022 СВФР-009696
	|   ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
	|   ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец
	//Аверсон СВФР-009696
	
	|ИЗ
	|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
	|ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыРасчетов.Основные КАК ГруппыРасчетовОсновные
	|ПО ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = ГруппыРасчетовОсновные.ВидРасчета
	|	И (ГруппыРасчетовОсновные.Ссылка = &ГруппаРасчетовПрофДопПУ3)
	|ГДЕ
	|	ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо.СтатусКатегория <> &КатегорияПоДоговорамПодряда
	|	И ДополнительныеНачисленияРаботниковОрганизаций.Результат > 0
	|	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &ДатаНачала И &ДатаОкончания
	|	И НЕ ГруппыРасчетовОсновные.Ссылка ЕСТЬ NULL
	|   И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник В (ВЫБРАТЬ ВТТЗ.Сотрудник ИЗ ВТТЗ)
	|;
	|////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТНачисления.Сотрудник,
	|	ВТНачисления.ФизЛицо,
	|	ВТНачисления.ПериодРегистрации,
	
	//Аверсон ЕАЕ 27.10.2022 СВФР-009696
	|	ВТНачисления.ДатаС,
	|	ВТНачисления.ДатаПо,
	//Аверсон СВФР-009696
	
	|	СУММА(ВТНачисления.Результат) КАК Результат
	|ПОМЕСТИТЬ ВТНачисленияСгруппированная
	|ИЗ ВТНачисления
	|СГРУППИРОВАТЬ ПО
	|	ВТНачисления.Сотрудник,
	|	ВТНачисления.ФизЛицо,
	|	ВТНачисления.ПериодРегистрации,
	
	//Аверсон ЕАЕ 27.10.2022 СВФР-009696
	|	ВТНачисления.ДатаС,
	|	ВТНачисления.ДатаПо
	//Аверсон СВФР-009696
	
	|;
	|////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВТТЗ.Сотрудник,
	|	ВТТЗ.ФизЛицо,
	
	//Аверсон ЕАЕ 27.10.2022 СВФР-009696
	//|   ВТТЗ.ДатаНачалаРабот,
	//|	ВТТЗ.ДатаОкончанияРабот
	|ВЫБОР
	|КОГДА ВТТЗ.ДатаНачалаРабот > ВТНачисления.ДатаС
	|ТОГДА ВТТЗ.ДатаНачалаРабот
	|ИНАЧЕ ВТНачисления.ДатаС
	|КОНЕЦ КАК ДатаНачалаРабот,
	
	//Аверсон ЕАЕ 30.10.2025 СВФР-017030
	//|ВЫБОР
	//|КОГДА ВТТЗ.ДатаОкончанияРабот < ВТНачисления.ДатаПо3101
	//|ТОГДА ВТТЗ.ДатаОкончанияРабот
	//|ИНАЧЕ ВТНачисления.ДатаПо
	//|КОНЕЦ КАК ДатаОкончанияРабот
	|ВТТЗ.ДатаОкончанияРабот КАК ДатаОкончанияРабот
	//Аверсон СВФР-017030
	
	//Аверсон СВФР-009696
	
	|ПОМЕСТИТЬ ВТРезультат
	|ИЗ ВТТЗ
	|ЛЕВОЕ СОЕДИНЕНИЕ ВТНачисленияСгруппированная КАК ВТНачисления
	|ПО ВТТЗ.Сотрудник = ВТНачисления.Сотрудник
	|	И ВТТЗ.ФизЛицо = ВТНачисления.ФизЛицо
	|	И ВТНачисления.ПериодРегистрации МЕЖДУ НАЧАЛОПЕРИОДА(ВТТЗ.ДатаНачалаРабот,МЕСЯЦ) И КОНЕЦПЕРИОДА(ВТТЗ.ДатаОкончанияРабот,МЕСЯЦ)
	|ГДЕ НЕ ВТНачисления.Сотрудник ЕСТЬ NULL
	|;
	|///////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	ВТРезультат.Сотрудник,
	|	ВТРезультат.ФизЛицо,
	|	ВТРезультат.ДатаНачалаРабот,
	|	ВТРезультат.ДатаОкончанияРабот
	|ИЗ ВТРезультат
	|";
	
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("ТЗ", ТЗСведенияОСтаже);
	Запрос.УстановитьПараметр("ДатаНачала", ДатаНачала);
	Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончания);
	Запрос.УстановитьПараметр("КатегорияПоДоговорамПодряда", Справочники.КатегорииЗастрахованныхЛиц.НайтиПоКоду("01"));
	Запрос.УстановитьПараметр("ГруппаРасчетовПрофДопПУ3", Справочники.ГруппыРасчетов.НайтиПоКоду("000000884"));
	
	//Аверсон ЕАЕ 09.01.2026 СВФР-017780
	//Результат = Запрос.Выполнить();
	//Если Не Результат.Пустой() Тогда
	//	Выборка = Результат.Выбрать();
	//	Пока Выборка.Следующий() Цикл
	//		НоваяСтр = СведенияОСтаже.Добавить();
	//		ЗаполнитьЗначенияСвойств(НоваяСтр, Выборка);
	//		НоваяСтр.ВидДеятельности = ПрофДопДляПУ3;
	//	КонецЦикла;
	//КонецЕсли;
	
	//Свернем ПрофДоп по периодам
	ТЗРезультат = Запрос.Выполнить().Выгрузить();
	ТЗРезультатИтог = ТЗРезультат.Скопировать();
	ТЗРезультатИтог.Очистить();
	Для Каждого Стр Из ТЗРезультат Цикл
		//	ДатаНач = Стр.ДатаНачалаРабот;
		//	ДатаКонПроверка = НачалоДня(ДатаНач) - 1;
		//	
		//	СтруктураОтбора = Новый Структура;
		//	СтруктураОтбора.Вставить("Сотрудник", Стр.Сотрудник);
		//	СтруктураОтбора.Вставить("ФизЛицо", Стр.ФизЛицо);
		//	СтруктураОтбора.Вставить("ДатаОкончанияРабот", ДатаКонПроверка);
		//	
		//	НужныеСтроки = ТЗРезультатИтог.НайтиСтроки(СтруктураОтбора);
		//	Если НужныеСтроки.Количество() = 0 Тогда
		//		НоваяСтр = ТЗРезультатИтог.Добавить();
		//		ЗаполнитьЗначенияСвойств(НоваяСтр, Стр);
		//	Иначе
		//		НужнаяСтрока = НужныеСтроки[0];
		//		НужнаяСтрока.ДатаОкончанияРабот = Стр.ДатаОкончанияРабот;
		//	КонецЕсли;
		ДатаНач = Стр.ДатаНачалаРабот;
		ДатаКон = Стр.ДатаОкончанияРабот;
		
		СтруктураОтбора = Новый Структура;
		СтруктураОтбора.Вставить("Сотрудник", Стр.Сотрудник);
		СтруктураОтбора.Вставить("ФизЛицо", Стр.ФизЛицо);
		
		НужныеСтроки = ТЗРезультатИтог.НайтиСтроки(СтруктураОтбора);
		Есть = Ложь;
		Для Каждого Эл Из НужныеСтроки Цикл
			Если Эл.ДатаНачалаРабот <= ДатаНач И Эл.ДатаОкончанияРабот >= ДатаКон Тогда
				Есть = Истина;
				Прервать;
			КонецЕсли;
		КонецЦикла;
		
		//Если уже есть строка, в период которой полностью помещается период текущей строки, новую строку не добавляем
		Если Не Есть Тогда
			НоваяСтр = ТЗРезультатИтог.Добавить();
			ЗаполнитьЗначенияСвойств(НоваяСтр, Стр);
		КонецЕсли;
		
	КонецЦикла;
	
	Для Каждого Стр Из ТЗРезультатИтог Цикл
		НоваяСтр = СведенияОСтаже.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяСтр, Стр);
		НоваяСтр.ВидДеятельности = ПрофДопДляПУ3;
	КонецЦикла;
	//Аверсон СВФР-017780
	
	СведенияОСтаже.Сортировать("Сотрудник, ДатаНачалаРабот, ВидДеятельности");
КонецПроцедуры
//Аверсон СВФР-007783

//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )

Функция ПолучитьРазмерМинимальнойЗП( Период )
	
	РазмерМинимальнойЗП = 
	РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(
	НачалоМесяца( Период ), 
	Новый Структура( "ВидПараметра", 
	Перечисления.ВидыПараметровДляРасчетаЗарплаты.МинимальнаяЗарплатаРБ ) 
	).Размер;
	Возврат РазмерМинимальнойЗП;
	
КонецФункции // ПолучитьИтоговуюПричинуМинимальнойЗП

Функция ПолучитьИтоговуюПричинуМинимальнойЗП( строкаВзносов )
	Если НЕ ЗначениеЗаполнено( строкаВзносов.ПричиныМинимальнойЗП ) Тогда
		Возврат строкаВзносов.ПричиныМинимальнойЗП;	
	КонецЕсли; 
	
	РазмерМинимальнойЗП = ПолучитьРазмерМинимальнойЗП( строкаВзносов.Месяц );
	ОтборОбъединяемыхСтрок = Новый Структура( "ФизЛицо, Договор, Месяц", 
	строкаВзносов.ФизЛицо, строкаВзносов.Договор, строкаВзносов.Месяц );
	ОбъединяемыеСтроки = СведенияОВзносах.НайтиСтроки( ОтборОбъединяемыхСтрок );
	РазмерИтоговойЗП = 0;
	Для каждого ОбъединяемаяСтрока Из ОбъединяемыеСтроки Цикл
		РазмерИтоговойЗП = РазмерИтоговойЗП + ОбъединяемаяСтрока.Выплаты;
	КонецЦикла;
	Если РазмерИтоговойЗП >= РазмерМинимальнойЗП Тогда
		ПричиныМинимальнойЗП = Неопределено;
	Иначе	
		ПричиныМинимальнойЗП = строкаВзносов.ПричиныМинимальнойЗП;
	КонецЕсли; 
	Для каждого ОбъединяемаяСтрока Из ОбъединяемыеСтроки Цикл
		ОбъединяемаяСтрока.ПричиныМинимальнойЗП = ПричиныМинимальнойЗП;
	КонецЦикла;
	Возврат ПричиныМинимальнойЗП;
КонецФункции // ПолучитьИтоговуюПричинуМинимальнойЗП
//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )


//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
Процедура ОбъединитьОсновные()
	Если НЕ ( ( Основные ИЛИ ВсеСотрудники ) И ОбъединятьОсновные )  Тогда
		Возврат;	
	КонецЕсли;
	
	СтрокиРаботниковКУдалению = Новый Массив;
	//ТЧ_СведенияОСтаже_Модифицирована = Ложь;
	//ТЧ_СведенияОВзносах_Модифицирована = Ложь;
	Отбор = Новый Структура( "ЛичныйНомер, Фамилия, Имя, Отчество" );
	ОтборСотр = Новый Структура( "Сотрудник" );
	ОбработанныеСтраховыеНомера = Новый Массив;
	Для каждого Стр Из РаботникиОрганизации Цикл
		СтраховойНомер = Стр.ЛичныйНомер;
		Если ОбработанныеСтраховыеНомера.Найти( СтраховойНомер ) <> Неопределено Тогда
			Продолжить;
		КонецЕсли;
		ЗаполнитьЗначенияСвойств( Отбор, Стр );
		НайдСтроки = РаботникиОрганизации.НайтиСтроки( Отбор );
		Если НайдСтроки.Количество() <= 1 Тогда Продолжить; КонецЕсли;
		
		ПриорСотрудник = Неопределено;
		ПриорФизЛицо = Неопределено;
		ПриорСтрока = Неопределено;
		//отобрать приоритетного сотрудника и приоритетное физ.лицо среди дублей
		Для каждого СтрДубль Из НайдСтроки Цикл
			Если НЕ ЗначениеЗаполнено( СтрДубль.Сотрудник.ВидЗанятости ) Тогда
				Продолжить;	
			КонецЕсли; 
			
			Если ПриорСотрудник = Неопределено 
				ИЛИ ПриорСотрудник.Актуальность <> СтрДубль.Сотрудник.Актуальность
				И СтрДубль.Сотрудник.Актуальность
				ИЛИ ПриорСотрудник.Актуальность = СтрДубль.Сотрудник.Актуальность
				И ПриорСотрудник.ВидЗанятости <> СтрДубль.Сотрудник.ВидЗанятости
				И СтрДубль.Сотрудник.ВидЗанятости = Перечисления.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы
				Тогда
				ПриорСотрудник = СтрДубль.Сотрудник;	
				ПриорФизЛицо = СтрДубль.ФизЛицо;	
				ПриорСтрока = СтрДубль;
			КонецЕсли;
		КонецЦикла; // СтрДубль Из НайдСтроки
		
		СтрокаПриорВзносовЭталон = Неопределено;
		СтрокиПриорВзносовВсе = СведенияОВзносах.НайтиСтроки( Новый Структура("Сотрудник", ПриорСотрудник ) );
		Если СтрокиПриорВзносовВсе.Количество() > 0 Тогда
			СтрокаПриорВзносовЭталон = СтрокиПриорВзносовВсе[ 0 ];
		КонецЕсли; 
		
		
		Для каждого  СтрДубль Из НайдСтроки Цикл
			
			Если СтрДубль = ПриорСтрока 
				ИЛИ НЕ ЗначениеЗаполнено( СтрДубль.Сотрудник.ВидЗанятости )
				Тогда 
				Продолжить; 
			КонецЕсли;
			
			//заменить неприоритетные ссылки на приоритетные
			ОтборСотр.Сотрудник = СтрДубль.Сотрудник;
			
			ЕстьДоговоры = Ложь;
			НайдСтрокиСтажа = СведенияОСтаже.НайтиСтроки( ОтборСотр );
			Для каждого  СтрСтаж Из НайдСтрокиСтажа Цикл
				Если ЗначениеЗаполнено( СтрСтаж.Договор ) Тогда 
					ЕстьДоговоры = Истина; 
					Продолжить; 
				КонецЕсли; 
				СтрСтаж.Сотрудник = ПриорСотрудник;		
				СтрСтаж.ФизЛицо = ПриорФизЛицо;		
				СтрСтаж.Категория = ПриорСтрока.Категория;		
				//ТЧ_СведенияОСтаже_Модифицирована = Истина;
			КонецЦикла;
			
			СтрокиВзносовКУдалению = Новый Массив;
			НайдСтрокиВзносов = СведенияОВзносах.НайтиСтроки( ОтборСотр );
			Для каждого  СтрВзнос Из НайдСтрокиВзносов Цикл
				Если ЗначениеЗаполнено( СтрВзнос.Договор ) Тогда 
					ЕстьДоговоры = Истина; 
					Продолжить; 
				КонецЕсли;
				
				СтрокиПриорВзносов = СведенияОВзносах.НайтиСтроки( Новый Структура("Сотрудник, Месяц", ПриорСотрудник, СтрВзнос.Месяц ) );
				Если СтрокиПриорВзносов.Количество() > 0 Тогда
					СтрокаПриорВзносов = СтрокиПриорВзносов[ 0 ];
					СтрокаПриорВзносов.Выплаты = СтрокаПриорВзносов.Выплаты + СтрВзнос.Выплаты;
					СтрокаПриорВзносов.Пособия = СтрокаПриорВзносов.Пособия + СтрВзнос.Пособия;
					СтрокаПриорВзносов.Взносы = СтрокаПриорВзносов.Взносы + СтрВзнос.Взносы;
					
					//СВЭЙ 24.01.2024 КВВ СВФР-012080 (
					СтрокаПриорВзносов.Простои = СтрокаПриорВзносов.Простои + СтрВзнос.Простои;
					СтрокаПриорВзносов.ОтпускаИницНаним = СтрокаПриорВзносов.ОтпускаИницНаним + СтрВзнос.ОтпускаИницНаним;
					СтрокаПриорВзносов.УдержОсужд = СтрокаПриорВзносов.УдержОсужд + СтрВзнос.УдержОсужд;
					СтрокаПриорВзносов.ПособияВН = СтрокаПриорВзносов.ПособияВН + СтрВзнос.ПособияВН;
					СтрокаПриорВзносов.ПособияБР = СтрокаПриорВзносов.ПособияБР + СтрВзнос.ПособияБР;
					СтрокаПриорВзносов.ОплатыДопДня = СтрокаПриорВзносов.ОплатыДопДня + СтрВзнос.ОплатыДопДня;
					//СВЭЙ 24.01.2024 КВВ СВФР-012080 )
					
					Если ЗначениеЗаполнено( СтрокаПриорВзносов.ПричиныМинимальнойЗП ) 
						И НЕ ЗначениеЗаполнено( СтрВзнос.ПричиныМинимальнойЗП ) Тогда
						СтрокаПриорВзносов.ПричиныМинимальнойЗП = СтрВзнос.ПричиныМинимальнойЗП;
					КонецЕсли; 
					СтрокиВзносовКУдалению.Добавить( СтрВзнос );
				Иначе	
					//Если СтрВзнос.Сотрудник = ПриорСотрудник ИЛИ СтрВзнос.ФизЛицо = ПриорФизЛицо Тогда //Аверсон 13.01.2022 КВВ СВФР-008597 
					СтрВзнос.Сотрудник = ПриорСотрудник;		
					СтрВзнос.ФизЛицо = ПриорФизЛицо;	
					//КонецЕсли;
					Если СтрокаПриорВзносовЭталон <> Неопределено Тогда
						ЗаполнитьЗначенияСвойств( СтрВзнос, СтрокаПриорВзносовЭталон, "Категория,ТарифВзносов" );
					КонецЕсли; 
				КонецЕсли; 
				//ТЧ_СведенияОВзносах_Модифицирована = Истина;
				
			КонецЦикла;
			Для каждого СтрВзносУдал Из СтрокиВзносовКУдалению Цикл
				СведенияОВзносах.Удалить( СтрВзносУдал );	
			КонецЦикла; 
			Если НЕ ЕстьДоговоры Тогда
				СтрокиРаботниковКУдалению.Добавить( СтрДубль );
			КонецЕсли; 
			
		КонецЦикла; // СтрДубль Из НайдСтроки
		
		ОбработанныеСтраховыеНомера.Добавить( СтраховойНомер );
	КонецЦикла; // Стр Из РаботникиОрганизации
	
	//Если ТЧ_СведенияОСтаже_Модифицирована Тогда
	//	СвернутьТабличнуюЧасть( "СведенияОСтаже" );	
	//КонецЕсли; 
	
	//Если ТЧ_СведенияОВзносах_Модифицирована Тогда
	//	СведенияОВзносах.Свернуть( "ФизЛицо,Месяц,Сотрудник,Договор,Категория,ВидДоговора,ТарифВзносов,ПричиныМинимальнойЗП", "Выплаты,Пособия,Взносы" );	
	//КонецЕсли;
	
	Для каждого СтрУдал Из СтрокиРаботниковКУдалению Цикл
		РаботникиОрганизации.Удалить( СтрУдал );	
	КонецЦикла; 
	
	
	
КонецПроцедуры // ОбъединитьОсновные	
//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )


//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
Процедура ЗаполнитьДатыДоговоров_И_ВзносовВрем( Договор, ВзносыВрем, Премия )
	Если НЕ ЗначениеЗаполнено( ЭтотОбъект.ДатаНачала ) ИЛИ НЕ ЗначениеЗаполнено( ЭтотОбъект.ДатаОкончания ) Тогда
		Сообщить( "Не заполнены поля ""Период С: ... по:"" !", СтатусСообщения.Важное );
		Возврат;
	КонецЕсли;	
	Если ЭтотОбъект.ДатаНачала > ЭтотОбъект.ДатаОкончания  Тогда
		Сообщить( "Некорректно заполнены поля ""Период С: ... по:"" - дата ПО больше даты С!", СтатусСообщения.Важное );
		Возврат;
	КонецЕсли;	
	
	//+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	ЭтоФЛ = ( Основные ИЛИ ВсеСотрудники ) И ОбъединятьОсновные;
	Если ЭтоФЛ Тогда
		//- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
		ЗаполняемыеКолонки = "Договор, ФизЛицо";
		//+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	Иначе	
		ЗаполняемыеКолонки = "Договор, ФизЛицо, Сотрудник";
	КонецЕсли; 
	//- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	
	КолонкиОтборов = "ВидДеятельности, " + ЗаполняемыеКолонки;
	
	ОтборДоговор = Новый Структура( КолонкиОтборов, Договор );
	ОтборВзносыВрем = Новый Структура( КолонкиОтборов, ВзносыВрем );
	СтрокиДоговор = СведенияОСтаже.НайтиСтроки( Новый Структура( "ВидДеятельности", Договор ) );
	//А. Синхронизация даты окончания ВЗНОСЫВРЕМ с ДОГОВОРЫ
	Для каждого СтрокаДоговор Из СтрокиДоговор Цикл
		
		Если СтрокаДоговор.ДатаОкончанияРабот < ЭтотОбъект.ДатаНачала
			//+ СВЭЙ КДЯ 25.11.19 СВФР-004631 ( Пункт 67. )
			ИЛИ СтрокаДоговор.ДатаНачалаРабот > ЭтотОбъект.ДатаОкончания
			//- СВЭЙ КДЯ 25.11.19 СВФР-004631 ( Пункт 67. )
			Тогда
			Продолжить;	
		КонецЕсли;
		
		ЗаполнитьЗначенияСвойств( ОтборДоговор, СтрокаДоговор, ЗаполняемыеКолонки );
		ВсеСтрокиДоговор =  СведенияОСтаже.НайтиСтроки( ОтборДоговор );
		Если ВсеСтрокиДоговор.Количество() > 1 Тогда
			
			ЭтоМаксимальнаяСтрокаДоговор = Истина;
			Для каждого ДругаяСтрокаДоговор Из ВсеСтрокиДоговор Цикл
				Если ДругаяСтрокаДоговор = СтрокаДоговор 
					//+ СВЭЙ КДЯ 25.11.19 СВФР-004631 ( Пункт 67. )
					ИЛИ ДругаяСтрокаДоговор.ДатаОкончанияРабот < ЭтотОбъект.ДатаНачала
					ИЛИ ДругаяСтрокаДоговор.ДатаНачалаРабот > ЭтотОбъект.ДатаОкончания
					//- СВЭЙ КДЯ 25.11.19 СВФР-004631 ( Пункт 67. )
					Тогда
					Продолжить;	
				КонецЕсли; 
				Если ДругаяСтрокаДоговор.ДатаОкончанияРабот > СтрокаДоговор.ДатаОкончанияРабот Тогда
					ЭтоМаксимальнаяСтрокаДоговор = Ложь;
					Прервать;	
				КонецЕсли; 
			КонецЦикла;
			Если НЕ ЭтоМаксимальнаяСтрокаДоговор Тогда
				
				Продолжить;	
				
			КонецЕсли; 
			
		КонецЕсли;
		
		СтрокаДоговор.ДатаОкончанияРабот = Мин( ЭтотОбъект.ДатаОкончания, СтрокаДоговор.ДатаОкончанияРабот );	
		ЗаполнитьЗначенияСвойств( ОтборВзносыВрем, СтрокаДоговор, ЗаполняемыеКолонки );
		СтрокиВзносыВремТекущегоДоговора = СведенияОСтаже.НайтиСтроки( ОтборВзносыВрем );
		МаксСтрокаВзносыВрем = Неопределено;
		МаксДатаОкончанияРаботВзносыВрем = Дата(1,1,1);
		Для каждого СтрокаВзносыВрем Из СтрокиВзносыВремТекущегоДоговора Цикл
			
			Если МаксСтрокаВзносыВрем = Неопределено
				ИЛИ СтрокаВзносыВрем.ДатаОкончанияРабот > МаксДатаОкончанияРаботВзносыВрем Тогда
				
				МаксСтрокаВзносыВрем = СтрокаВзносыВрем; 
				МаксДатаОкончанияРаботВзносыВрем = СтрокаВзносыВрем.ДатаОкончанияРабот;	
				
			КонецЕсли; 		
			
		КонецЦикла; // СтрокаВзносыВрем Из СтрокиВзносыВремТекущегоДоговора
		
		Если МаксСтрокаВзносыВрем <> Неопределено 
			И МаксСтрокаВзносыВрем.ДатаОкончанияРабот <> СтрокаДоговор.ДатаОкончанияРабот Тогда
			
			МаксСтрокаВзносыВрем.ДатаОкончанияРабот = СтрокаДоговор.ДатаОкончанияРабот;	
			
		КонецЕсли; 
		
	КонецЦикла; // Контроль максимума : СтрокаДоговор Из СтрокиДоговор
	
	//Аверсон ЕАЕ 20.07.2021 СВФР-007783
	//для длительных договоров выводим строки за каждый год договора
	//дата начала - дата начала договора
	
	//+ СВЭЙ КДЯ 25.11.19 СВФР-004631 ( Пункт 67. )
	//Б. Синхронизация даты начала ВЗНОСЫВРЕМ с ДОГОВОРЫ
	//Для каждого СтрокаДоговор Из СтрокиДоговор Цикл
	//	
	//	Если СтрокаДоговор.ДатаОкончанияРабот < ЭтотОбъект.ДатаНачала
	//		ИЛИ СтрокаДоговор.ДатаНачалаРабот > ЭтотОбъект.ДатаОкончания
	//		Тогда
	//		Продолжить;	
	//	КонецЕсли;
	//	
	//	ЗаполнитьЗначенияСвойств( ОтборДоговор, СтрокаДоговор, ЗаполняемыеКолонки );
	//	ВсеСтрокиДоговор =  СведенияОСтаже.НайтиСтроки( ОтборДоговор );
	//	Если ВсеСтрокиДоговор.Количество() > 1 Тогда
	//		
	//		ЭтоМинимальнаяСтрокаДоговор = Истина;
	//		Для каждого ДругаяСтрокаДоговор Из ВсеСтрокиДоговор Цикл
	//			Если ДругаяСтрокаДоговор = СтрокаДоговор 
	//				ИЛИ ДругаяСтрокаДоговор.ДатаНачалаРабот < ЭтотОбъект.ДатаНачала
	//				ИЛИ ДругаяСтрокаДоговор.ДатаНачалаРабот > ЭтотОбъект.ДатаОкончания
	//				Тогда
	//				Продолжить;	
	//			КонецЕсли; 
	//			Если ДругаяСтрокаДоговор.ДатаНачалаРабот < СтрокаДоговор.ДатаНачалаРабот Тогда
	//				ЭтоМинимальнаяСтрокаДоговор = Ложь;
	//				Прервать;	
	//			КонецЕсли; 
	//		КонецЦикла;
	//		Если НЕ ЭтоМинимальнаяСтрокаДоговор Тогда
	//			
	//			Продолжить;	
	//			
	//		КонецЕсли; 
	//		
	//	КонецЕсли;
	//	
	//	СтрокаДоговор.ДатаНачалаРабот = Макс( ЭтотОбъект.ДатаНачала, СтрокаДоговор.ДатаНачалаРабот );	
	//	ЗаполнитьЗначенияСвойств( ОтборВзносыВрем, СтрокаДоговор, ЗаполняемыеКолонки );
	//	СтрокиВзносыВремТекущегоДоговора = СведенияОСтаже.НайтиСтроки( ОтборВзносыВрем );
	//	МинСтрокаВзносыВрем = Неопределено;
	//	МинДатаНачалаРаботВзносыВрем = Дата(1,1,1);
	//	Для каждого СтрокаВзносыВрем Из СтрокиВзносыВремТекущегоДоговора Цикл
	//		
	//		Если МинСтрокаВзносыВрем = Неопределено
	//			ИЛИ СтрокаВзносыВрем.ДатаНачалаРабот < МинДатаНачалаРаботВзносыВрем Тогда
	//			
	//			МинСтрокаВзносыВрем = СтрокаВзносыВрем; 
	//			МинДатаНачалаРаботВзносыВрем = СтрокаВзносыВрем.ДатаНачалаРабот;	
	//			
	//		КонецЕсли; 		
	//		
	//	КонецЦикла; // СтрокаВзносыВрем Из СтрокиВзносыВремТекущегоДоговора
	//	
	//	Если МинСтрокаВзносыВрем <> Неопределено 
	//		И МинСтрокаВзносыВрем.ДатаНачалаРабот <> СтрокаДоговор.ДатаНачалаРабот Тогда
	//		
	//		МинСтрокаВзносыВрем.ДатаНачалаРабот = СтрокаДоговор.ДатаНачалаРабот;	
	//		
	//	КонецЕсли; 
	//	
	//КонецЦикла; // Контроль минимума : СтрокаДоговор Из СтрокиДоговор
	//- СВЭЙ КДЯ 25.11.19 СВФР-004631 ( Пункт 67. )
	//Аверсон СВФР-007783
КонецПроцедуры // ЗаполнитьДатыДоговоров_И_ВзносовВрем
//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )


//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 28. )
Процедура УстановитьВидДеятельностиНеоплДог( Договор, ВзносыВрем, НеоплДог )
	
	//НулевыеСтрокиВзносов = СведенияОВзносах.НайтиСтроки( 
	//	Новый Структура( "Выплаты, Взносы, Пособия", 0, 0, 0 ) );
	//Для каждого НулеваяСтрокаВзносов Из НулевыеСтрокиВзносов Цикл
	//
	//	СведенияОВзносах.Удалить( НулеваяСтрокаВзносов );	
	//
	//КонецЦикла;
	
	СтрокиДоговоров = СведенияОСтаже.НайтиСтроки( 
	Новый Структура( "ВидДеятельности", Договор ) );
	
	Для каждого СтрокаДоговора Из СтрокиДоговоров Цикл
		
		СтрокиВзносов = СведенияОВзносах.НайтиСтроки( Новый Структура( "ФизЛицо", СтрокаДоговора.ФизЛицо ) );
		ЕстьВзносы = Ложь;
		НомерДоговора = ПолучитьНомерДокументаДляПУ( СтрокаДоговора.Договор );
		ДатаДоговора = ПолучитьДатуДокументаДляПУ( СтрокаДоговора.Договор );
		Для каждого СтрокаВзносов Из СтрокиВзносов Цикл
			
			Если ( ПолучитьНомерДокументаДляПУ( СтрокаВзносов.Договор )
				= НомерДоговора
				И
				ПолучитьДатуДокументаДляПУ( СтрокаВзносов.Договор )
				= ДатаДоговора
				
				//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 3) (закомментировано) (
				////+ СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 34. )
				//ИЛИ
				//ПолучитьПересечениеДиапазонов( НачалоМесяца(СтрокаВзносов.Месяц), КонецМесяца(СтрокаВзносов.Месяц ), 
				//СтрокаДоговора.ДатаНачалаРабот, СтрокаДоговора.ДатаОкончанияРабот ) <> Неопределено 
				////- СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 34. )
				//СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 3) (закомментировано) )
				)
				И (СтрокаВзносов.Выплаты > 0
				//ИЛИ СтрокаВзносов.Пособия > 0 //СВЭЙ 04.04.2024 КВВ СВФР-012718 (пункт 3) (закомментировано, не ставить, по пункту 6 дальше идет проверка)
				) 
				Тогда
				
				ЕстьВзносы = Истина;
				Прервать;
				
			КонецЕсли; 	
			
		КонецЦикла;
		
		Если НЕ ЕстьВзносы Тогда
			СтрокаДоговора.ВидДеятельности = НеоплДог;
			СтрокаДоговора.ДатаНачалаРабот = ЭтотОбъект.ДатаНачала;
			СтрокаДоговора.ДатаОкончанияРабот = ЭтотОбъект.ДатаОкончания;
			СтрокиВзносыВремТекДоговора = СведенияОСтаже.НайтиСтроки( 
			Новый Структура( "Договор, ВидДеятельности", СтрокаДоговора.Договор, ВзносыВрем ) );
			Для каждого СтрокаВзносыВрем Из СтрокиВзносыВремТекДоговора Цикл
				
				СведенияОСтаже.Удалить( СтрокаВзносыВрем );	
				
			КонецЦикла; 
		КонецЕсли; 
		
	КонецЦикла;
	
	//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
	СтрокиНеоплДог = СведенияОСтаже.НайтиСтроки( 
	Новый Структура( "ВидДеятельности", НеоплДог ) );
	Для каждого СтрокаНеоплДог Из СтрокиНеоплДог Цикл
		
		СтрокиВзносов = СведенияОВзносах.НайтиСтроки( Новый Структура( "ФизЛицо", СтрокаНеоплДог.ФизЛицо ) );
		ЕстьВзносы = Ложь;
		НомерДоговора = ПолучитьНомерДокументаДляПУ( СтрокаНеоплДог.Договор );
		ДатаДоговора = ПолучитьДатуДокументаДляПУ( СтрокаНеоплДог.Договор );
		Для каждого СтрокаВзносов Из СтрокиВзносов Цикл
			
			Если //(
				ПолучитьНомерДокументаДляПУ( СтрокаВзносов.Договор )
				= НомерДоговора
				И
				ПолучитьДатуДокументаДляПУ( СтрокаВзносов.Договор )
				= ДатаДоговора
				//И
				// ПолучитьПересечениеДиапазонов( НачалоМесяца(СтрокаВзносов.Месяц), КонецМесяца(СтрокаВзносов.Месяц ), 
				// 	СтрокаНеоплДог.ДатаНачалаРабот, СтрокаНеоплДог.ДатаОкончанияРабот ) <> Неопределено 
				//)
				Тогда
				
				ЕстьВзносы = Истина;
				Прервать;
				
			КонецЕсли; 	
			
		КонецЦикла;
		
		Если НЕ ЕстьВзносы Тогда
			НовСтрокаВзносов = СведенияОВзносах.Добавить();
			ЗаполнитьЗначенияСвойств( НовСтрокаВзносов, СтрокаНеоплДог );
			НовСтрокаВзносов.Месяц = НачалоМесяца( СтрокаНеоплДог.ДатаНачалаРабот );
		КонецЕсли; 
	КонецЦикла;
	//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
	
	
КонецПроцедуры
//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 28. )

//+ СВЭЙ КДЯ 15.08.19 СВФР-004631 ( пункт 4 )
Функция ПолучитьНомерДокументаДляПУ( Договор )
	Перем НомерДокументаДляПУ;
	//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 52. )
	Если НЕ ЗначениеЗаполнено( Договор ) Тогда
		Возврат "";	
	КонецЕсли; 
	//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 52. )
	Если ЗначениеЗаполнено( Договор.НомерДляПу ) Тогда
		НомерДокументаДляПУ	= СокрЛП( Договор.НомерДляПу );
	Иначе	
		НомерДокументаДляПУ	= СокрЛП( Договор.Номер );
	КонецЕсли; 	
	Возврат НомерДокументаДляПУ;
КонецФункции // ПолучитьНомерДокументаДляПУ()

Функция ПолучитьДатуДокументаДляПУ( Договор )
	Перем ДатаДокументаДляПУ;
	//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 52. )
	Если НЕ ЗначениеЗаполнено( Договор ) Тогда
		Возврат Дата( 1, 1, 1 );	
	КонецЕсли; 
	//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 52. )
	Если ЗначениеЗаполнено( Договор.ДатаПУ ) Тогда
		ДатаДокументаДляПУ	= Договор.ДатаПУ;
	Иначе	
		ДатаДокументаДляПУ	= Договор.ДатаНачала;
	КонецЕсли; 	
	Возврат ДатаДокументаДляПУ;
КонецФункции // ПолучитьДатуДокументаДляПУ()

Процедура СвернутьСтрокиДоговоровДублей( СтрокиНеоплДог, СтрокиДоговор, Договор )
	
	МассивСтрокКУдалению = Новый Массив; //строки к удалению
	ТЗ_СведенияОСтажеДоговор = СведенияОСтаже.Выгрузить( СтрокиДоговор );
	ОтборФЛ = Новый Структура( "ФизЛицо" );
	Для каждого Стр Из СтрокиНеоплДог Цикл
		Если ЗначениеЗаполнено( Стр.Договор ) И ЗначениеЗаполнено( Стр.ВидДоговора ) Тогда
			//ищем Договор
		Иначе
			Продолжить;
		КонецЕсли; 
		ЗаполнитьЗначенияСвойств( ОтборФЛ, Стр );
		ЕстьДоговор = Ложь;
		Для каждого СтрДог Из ТЗ_СведенияОСтажеДоговор.НайтиСтроки( ОтборФЛ ) Цикл
			Если ЗначениеЗаполнено( СтрДог.Договор ) И ЗначениеЗаполнено( СтрДог.ВидДоговора )
				И СтрДог.ВидДоговора = Стр.ВидДоговора
				// + СВЭЙ КДЯ 28.08.19 СВФР-004631 ( пункт 13. )
				//И СтрДог.Договор <> Стр.Договор  //это договор - дубль
				//И НачалоГода( СтрДог.ДатаНачалаРабот ) = НачалоГода( Стр.ДатаНачалаРабот )
				// - СВЭЙ КДЯ 28.08.19 СВФР-004631 ( пункт 13. )
				// + СВЭЙ КДЯ 28.08.19 СВФР-004631 ( пункт 13. )
				И ПолучитьПересечениеДиапазонов( НачалоГода( СтрДог.ДатаНачалаРабот ), КонецГода( СтрДог.ДатаОкончанияРабот ),
				Стр.ДатаНачалаРабот, Стр.ДатаОкончанияРабот ) <> Неопределено
				// - СВЭЙ КДЯ 28.08.19 СВФР-004631 ( пункт 13. )
				И ПолучитьНомерДокументаДляПУ( СтрДог.Договор ) = ПолучитьНомерДокументаДляПУ( Стр.Договор )
				И ПолучитьДатуДокументаДляПУ( СтрДог.Договор ) =  ПолучитьДатуДокументаДляПУ( Стр.Договор ) Тогда
				ЕстьДоговор = Истина;
				Прервать;
			КонецЕсли; 
		КонецЦикла; // СтрДог Из ТЗ_СведенияОСтажеДоговор.НайтиСтроки( ОтборФЛ )
		Если ЕстьДоговор Тогда
			//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
			//МассивСтрокКУдалению.Добавить( Стр ); 	
			//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
			//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
			Стр.ВидДеятельности = Договор; 	
			//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
		КонецЕсли; 
	КонецЦикла; // Стр Из СведенияОСтаже	
	
	//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
	//Для каждого СтрУдал Из МассивСтрокКУдалению Цикл
	//
	//	СведенияОСтаже.Удалить( СтрУдал );	
	//
	//КонецЦикла;
	//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 40. )
	
КонецПроцедуры
//- СВЭЙ КДЯ 15.08.19 СВФР-004631 ( пункт 4 )

//+ СВЭЙ КДЯ 26.08.19 СВФР-004631 ( пункт 7 )
Процедура УстановитьПремиюВСтажеДети( СтрокиДети, СтрокиВзносыВрем, ВидДеятельностиПремия )
	Перем ВерхняяГраницаПокрытия;
	
	ТЗ_СведенияОСтажеДети = СведенияОСтаже.Выгрузить( СтрокиДети );
	ТЗ_СведенияОСтажеДети.Сортировать( "ДатаНачалаРабот" );
	
	//+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	//ОтборФизЛица = Новый Структура( "ФизЛицо" );
	//- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	
	//+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	ЭтоФЛ = ( Основные ИЛИ ВсеСотрудники ) И ОбъединятьОсновные;
	Если ЭтоФЛ Тогда
		ЗаполняемыеКолонки = "Договор, ФизЛицо";
	Иначе	
		ЗаполняемыеКолонки = "Договор, ФизЛицо, Сотрудник";
	КонецЕсли; 
	ОтборФизЛица = Новый Структура( ЗаполняемыеКолонки );
	//- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	
	//(1) для каждого месяца каждого диапазона "ВЗНОСЫВРЕМ", проверяем его покрытие диапазонами "ДЕТИ";
	//      если полное покрытие ( месяца целиком ) есть, то "ВЗНОСЫВРЕМ" заменяем на "ПРЕМИЯ"
	Для каждого СтрВзнВрем Из СтрокиВзносыВрем Цикл
		
		ЗаполнитьЗначенияСвойств( ОтборФизЛица, СтрВзнВрем );
		
		ВерхняяГраницаПокрытия = Неопределено;
		
		Для каждого СтрДети Из ТЗ_СведенияОСтажеДети.НайтиСтроки( ОтборФизЛица ) Цикл
			
			ПересечениеДиапазонов = ПолучитьПересечениеДиапазонов( 
			СтрДети.ДатаНачалаРабот, СтрДети.ДатаОкончанияРабот, СтрВзнВрем.ДатаНачалаРабот, СтрВзнВрем.ДатаОкончанияРабот );
			
			Если ПересечениеДиапазонов = Неопределено Тогда
				Продолжить;	
			КонецЕсли;
			
			Если ВерхняяГраницаПокрытия = Неопределено Тогда
				//это первый диапазон
				Если СтрВзнВрем.ДатаНачалаРабот < СтрДети.ДатаНачалаРабот Тогда
					//если диапазоны стажа ДЕТИ не покрывают полностью диапазон стажа ВзносыВрем, то Премию не устанавливаем
					Прервать;	
				КонецЕсли;
				ВерхняяГраницаПокрытия = СтрДети.ДатаОкончанияРабот;
			Иначе	
				Если НачалоДня( ВерхняяГраницаПокрытия + мДлинаСуток ) < СтрДети.ДатаНачалаРабот Тогда
					//если диапазоны стажа ДЕТИ не покрывают полностью диапазон стажа ВзносыВрем, то Премию не устанавливаем
					Прервать;	
				КонецЕсли;
				ВерхняяГраницаПокрытия = Макс( ВерхняяГраницаПокрытия, СтрДети.ДатаОкончанияРабот );
			КонецЕсли;
			
			Если ВерхняяГраницаПокрытия >= СтрВзнВрем.ДатаОкончанияРабот Тогда
				
				СтрВзнВрем.ВидДеятельности = ВидДеятельностиПремия;
				Прервать;	
				
			КонецЕсли; 
			
		КонецЦикла; // СтрДог Из ТЗ_СведенияОСтажеДоговор.НайтиСтроки( ОтборФЛ )
		
	КонецЦикла; // Стр Из СведенияОСтаже	
	
	//+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	//(2) для каждого диапазона "ПРЕМИЯ", проверяем пересечение каждого его месяца с месяцами диапазонов "ВЗНОСЫВРЕМ";
	//      если в рамках какого-либо месяца есть и "ВЗНОСЫВРЕМ" , и "ПРЕМИЯ",  
	//		то этот месяц удаляем из соответствующего диапазона "ПРЕМИЯ".
	ОтборПремийФизЛица = Новый Структура( "ВидДеятельности, " + ЗаполняемыеКолонки, ВидДеятельностиПремия );
	
	Для каждого СтрВзнВрем Из СтрокиВзносыВрем Цикл
		
		ЗаполнитьЗначенияСвойств( ОтборПремийФизЛица, СтрВзнВрем, ЗаполняемыеКолонки );
		
		Для каждого СтрПремия Из СведенияОСтаже.НайтиСтроки( ОтборПремийФизЛица ) Цикл
			
			ПересечениеДиапазонов = ПолучитьПересечениеДиапазонов( 
			СтрПремия.ДатаНачалаРабот, СтрПремия.ДатаОкончанияРабот, СтрВзнВрем.ДатаНачалаРабот, СтрВзнВрем.ДатаОкончанияРабот );
			
			Если ПересечениеДиапазонов = Неопределено Тогда
				Продолжить;	
			КонецЕсли;
			
			Если НачалоМесяца( ПересечениеДиапазонов.Начало ) <= СтрПремия.ДатаНачалаРабот
				И КонецМесяца( ПересечениеДиапазонов.Окончание ) >= СтрПремия.ДатаОкончанияРабот  Тогда
				
				СтрПремия.ВидДеятельности = СтрВзнВрем.ВидДеятельности;
				
			КонецЕсли; 
			
		КонецЦикла; // СтрДог Из ТЗ_СведенияОСтажеДоговор.НайтиСтроки( ОтборФЛ )
		
	КонецЦикла; // Стр Из СведенияОСтаже	
	//- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	
	//+ СВЭЙ КДЯ 09.01.20 СВФР-005301
	Для каждого СтрДети Из ТЗ_СведенияОСтажеДети Цикл
		
		ЗаполнитьЗначенияСвойств( ОтборПремийФизЛица, СтрДети, ЗаполняемыеКолонки );
		
		Для каждого СтрПремия Из СведенияОСтаже.НайтиСтроки( ОтборПремийФизЛица ) Цикл
			
			ПересечениеДиапазонов = ПолучитьПересечениеДиапазонов( 
			СтрПремия.ДатаНачалаРабот, СтрПремия.ДатаОкончанияРабот, СтрДети.ДатаНачалаРабот, СтрДети.ДатаОкончанияРабот );
			
			Если ПересечениеДиапазонов = Неопределено Тогда
				Продолжить;	
			КонецЕсли;
			
			Если НачалоМесяца( ПересечениеДиапазонов.Начало ) <= СтрПремия.ДатаНачалаРабот
				И КонецМесяца( ПересечениеДиапазонов.Окончание ) >= СтрПремия.ДатаОкончанияРабот  
				И СтрПремия.ДатаНачалаРабот <> НачалоМесяца( СтрПремия.ДатаНачалаРабот ) Тогда
				
				СтрПремия.ДатаНачалаРабот = НачалоМесяца( СтрПремия.ДатаНачалаРабот );
				
			КонецЕсли; 
			
		КонецЦикла; // СтрДог Из ТЗ_СведенияОСтажеДоговор.НайтиСтроки( ОтборФЛ )
		
	КонецЦикла; // СтрДети Из ТЗ_СведенияОСтажеДети
	//- СВЭЙ КДЯ 09.01.20 СВФР-005301
	
КонецПроцедуры
//- СВЭЙ КДЯ 26.08.19 СВФР-004631 ( пункт 7 )


//+ СВЭЙ КДЯ 15.08.19 СВФР-004631 ( пункт 5 )
Процедура СвернутьТабличнуюЧасть( ИмяТЧ )
	ИменаСворачиваемыхКолонок = "";
	Для каждого Реквизит Из Ссылка.Метаданные().ТабличныеЧасти[ ИмяТЧ ].Реквизиты Цикл
		ИменаСворачиваемыхКолонок = ИменаСворачиваемыхКолонок
		+ ?( ИменаСворачиваемыхКолонок = "", "", ", " ) + Реквизит.Имя;
	КонецЦикла; 
	ЭтотОбъект[ ИмяТЧ ].Свернуть( ИменаСворачиваемыхКолонок, "" );
КонецПроцедуры // СвернутьТабличнуюЧасть
//- СВЭЙ КДЯ 15.08.19 СВФР-004631 ( пункт 5 )

//+ СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
////+ СВЭЙ КДЯ 29.08.19 СВФР-004631 ( пункт 13. )
//Функция	ЕстьНеобъединяемыеВидыДеятельности( СтрокиДоговораВсехВидовДеятельности, ХроноПромежуток, МасОбъединяемыеВидыДеятельности )
//	Перем ЕстьНеобъединяемыеВидыДеятельности, Стр;
//	
//	ЕстьНеобъединяемыеВидыДеятельности = Ложь;
//	Для каждого Стр Из СтрокиДоговораВсехВидовДеятельности Цикл
//		
//		Если МасОбъединяемыеВидыДеятельности.Найти( Стр.ВидДеятельности ) <> Неопределено  Тогда
//			Продолжить;	
//		КонецЕсли; 	
//		
//		Если ПолучитьПересечениеДиапазонов( Стр.ДатаНачалаРабот, Стр.ДатаОкончанияРабот,
//				ХроноПромежуток.ДатаНачала, ХроноПромежуток.ДатаОкончания ) <> Неопределено Тогда
//			ЕстьНеобъединяемыеВидыДеятельности = Истина;
//			Прервать;
//		КонецЕсли;
//	
//	КонецЦикла; 
//	Возврат ЕстьНеобъединяемыеВидыДеятельности;
//КонецФункции // ЕстьНеобъединяемыеВидыДеятельности
////- СВЭЙ КДЯ 29.08.19 СВФР-004631 ( пункт 13. )
//- СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )

// + СВЭЙ КДЯ 31.07.19 СВФР-004561
Функция ПолучитьПересечениеДиапазонов( Знач Начало1, Знач Окончание1 = Неопределено, Знач Начало2, Знач Окончание2 = Неопределено
	//+ СВЭЙ КДЯ 24.09.19 СВФР-004631 ( пункт 43. )
	, ТочноеПересечение = Ложь
	//- СВЭЙ КДЯ 24.09.19 СВФР-004631 ( пункт 43. )
	)
	Перем Диапазон;
	
	//+ СВЭЙ КДЯ 24.09.19 СВФР-004631 ( пункт 43. )
	Если НЕ ТочноеПересечение Тогда
		//- СВЭЙ КДЯ 24.09.19 СВФР-004631 ( пункт 43. )
		
		Начало1 = НачалоМесяца( Начало1 );
		//+ СВЭЙ КДЯ 05.12.19 СВФР-004631 ( пункт 73. )
		Если Окончание1 = Неопределено Тогда
			Окончание1 = Начало1;	
		КонецЕсли; 
		//- СВЭЙ КДЯ 05.12.19 СВФР-004631 ( пункт 73. )
		Окончание1 = КонецМесяца( Окончание1 );
		
		Начало2 = НачалоМесяца( Начало2 ); 
		//+ СВЭЙ КДЯ 05.12.19 СВФР-004631 ( пункт 73. )
		Если Окончание2 = Неопределено Тогда
			Окончание2 = Начало2;	
		КонецЕсли; 
		//- СВЭЙ КДЯ 05.12.19 СВФР-004631 ( пункт 73. )
		Окончание2 = КонецМесяца( Окончание2 ); 
		
		//+ СВЭЙ КДЯ 24.09.19 СВФР-004631 ( пункт 43. )
	КонецЕсли;  
	//- СВЭЙ КДЯ 24.09.19 СВФР-004631 ( пункт 43. )
	
	Если Начало1 <= Окончание1 И Начало2 <= Окончание2 Тогда
		
		Если Начало1 <= Начало2 И Начало2 <= Окончание1
			ИЛИ
			Начало1 <= Окончание2 И Окончание2 <= Окончание1	
			ИЛИ
			Начало1 <= Начало2 И Окончание2 <= Окончание1	
			ИЛИ
			Начало2 <= Начало1 И Окончание1 <= Окончание2 Тогда	
			
			Диапазон = Новый Структура( "Начало, Окончание" );
			Диапазон.Начало = НачалоМесяца( Макс( Начало1, Начало2 ) );	
			Диапазон.Окончание = НачалоМесяца( Мин( Окончание1, Окончание2 ) );	
			
		КонецЕсли; 	
		
	КонецЕсли;
	
	Возврат Диапазон;
КонецФункции
// - СВЭЙ КДЯ 31.07.19 СВФР-004561


//+ СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 9 )
Процедура УдалитьВключаемыеСтрокиСведенийОСтаже()
	Перем МассивСтрокКУдалению, Отбор, ЕстьВключение, СтрУдал;
	
	МассивСтрокКУдалению = Новый Массив; //строки к удалению
	//+ СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40.) 
	//Отбор = Новый Структура( "ФизЛицо, Договор, ВидДоговора, ВидДеятельности" );
	//- СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40.)
	
	//+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	Если ОбъединятьОсновные И ( Основные ИЛИ ВсеСотрудники )  Тогда
		//- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
		
		//+ СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40.) 
		Отбор = Новый Структура( "ФизЛицо, ВидДоговора, ВидДеятельности" );
		//- СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40.)
		
		//+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	Иначе
		Отбор = Новый Структура( "Сотрудник, ФизЛицо, ВидДоговора, ВидДеятельности" );
	КонецЕсли; 
	//- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	
	
	
	Для каждого Стр Из СведенияОСтаже Цикл
		//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 52. )
		//Если ЗначениеЗаполнено( Стр.Договор ) И ЗначениеЗаполнено( Стр.ВидДоговора ) Тогда
		//	//ищем Договор
		//Иначе
		//	Продолжить;
		//КонецЕсли;
		//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 52. )
		НомерДокументаПУ = ПолучитьНомерДокументаДляПУ( Стр.Договор );
		ДатаДокументаПУ = ПолучитьДатуДокументаДляПУ( Стр.Договор );
		ЗаполнитьЗначенияСвойств( Отбор, Стр );
		ЕстьВключение = Ложь;
		Для каждого СтрДог Из СведенияОСтаже.НайтиСтроки( Отбор ) Цикл
			Если 
				//+ СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 30. )
				//СтрДог.ДатаНачалаРабот <= Стр.ДатаНачалаРабот 
				//И СтрДог.ДатаОкончанияРабот >= Стр.ДатаОкончанияРабот
				//И Стр <> СтрДог
				//- СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 30. )
				
				//+ СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 30. )
				( СтрДог.ДатаНачалаРабот < Стр.ДатаНачалаРабот 
				И СтрДог.ДатаОкончанияРабот >= Стр.ДатаОкончанияРабот
				ИЛИ
				СтрДог.ДатаНачалаРабот <= Стр.ДатаНачалаРабот 
				И СтрДог.ДатаОкончанияРабот > Стр.ДатаОкончанияРабот
				ИЛИ
				СтрДог.ДатаНачалаРабот = Стр.ДатаНачалаРабот 
				И СтрДог.ДатаОкончанияРабот = Стр.ДатаОкончанияРабот
				И Стр.НомерСтроки > СтрДог.НомерСтроки )
				//- СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 30. )
				
				//+ СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40.) 
				И НомерДокументаПУ = ПолучитьНомерДокументаДляПУ( СтрДог.Договор )
				И ДатаДокументаПУ = ПолучитьДатуДокументаДляПУ( СтрДог.Договор )
				//- СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40.)
				
				Тогда
				ЕстьВключение = Истина;
				Прервать;
			КонецЕсли; 
		КонецЦикла; // СтрДог Из ТЗ_СведенияОСтажеДоговор.НайтиСтроки( ОтборФЛ )
		Если ЕстьВключение Тогда
			МассивСтрокКУдалению.Добавить( Стр ); 	
		КонецЕсли; 
	КонецЦикла; // Стр Из СведенияОСтаже	
	
	Для каждого СтрУдал Из МассивСтрокКУдалению Цикл
		
		СведенияОСтаже.Удалить( СтрУдал );	
		
	КонецЦикла;
	
КонецПроцедуры // УдалитьВключаемыеСтрокиСведенийОСтаже()

Процедура ОбъединитьХронологическиеЦепочкиСведенийОСтаже( 
	//+ СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	МасОбъединяемыеВидыДеятельности, Премия 
	//- СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	)
	Перем ТЗ_ФизЛиц, Стр, СтрокаДубль, Отбор, СведенияОСтажеКопия, ОтборСтрокДоговора;
	Перем НеобходимоСвернуть, ДублиБылиОткорректированы;
	
	// сворачиваем строки, образующие хронологические звенья, в одну строку для каждого картежа ( ФизЛицо, ВидДеятельности, Договор )
	
	//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
	//ТЗ_ФизЛиц = СведенияОСтаже.Выгрузить( Новый Структура( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.Подряда ) );
	//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
	//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
	ТЗ_ФизЛиц = СведенияОСтаже.Выгрузить();
	//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
	
	
	//+ СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	КолонкиОтбора = "ФизЛицо, ВидДоговора, Договор";
	Если НЕ ( ОбъединятьОсновные И ( Основные ИЛИ ВсеСотрудники ) ) Тогда
		КолонкиОтбора = "Сотрудник, " + КолонкиОтбора;
	КонецЕсли; 
	ОтборСтрокДоговора = Новый Структура( КолонкиОтбора );
	//- СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	
	//ЦелевыеКолонки = "ФизЛицо, ВидДеятельности, ВидДоговора, Договор"; //+ СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	ЦелевыеКолонки = КолонкиОтбора + ", ВидДеятельности"; //+ СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	
	ТЗ_ФизЛиц.Свернуть( ЦелевыеКолонки );
	ТЗ_ФизЛиц.Сортировать( ЦелевыеКолонки );
	
	//+ СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	////+ СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	//ОтборСтрокДоговора = Новый Структура( "ФизЛицо, ВидДоговора, Договор" );
	////- СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	
	////+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	//Если ОбъединятьОсновные И ( Основные ИЛИ ВсеСотрудники )  Тогда
	////- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	//	
	//	//+ СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	//	ОтборСтрокДоговора = Новый Структура( "ФизЛицо, ВидДоговора, Договор" );
	//	//- СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
	//	
	////+ СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	//Иначе
	//    //+ СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	//	//Отбор = Новый Структура( "Сотрудник, ФизЛицо, ВидДоговора, ВидДеятельности" );
	//	//- СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	//    //+ СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	//	ОтборСтрокДоговора = Новый Структура( "Сотрудник, ФизЛицо, ВидДоговора, ВидДеятельности" );
	//	//- СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	//КонецЕсли; 
	////- СВЭЙ КДЯ 04.11.19 СВФР-004631 ( Пункт 59. ) СВФР-004969 ( Пункт 7. )
	//- СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 78. )
	
	//+ СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
	МассивУдаляемыхСотрудников = Новый Массив;
	//- СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
	
	
	//+ СВЭЙ КДЯ 31.10.19 СВФР-004631 ( Пункт 55. )
	//заменим все ссылки на договоры-дубли ссылкой на главный договор
	КолонкиВидаДоговора = "ФизЛицо, ВидДоговора";
	ОтборСтрокВсехДоговоров = Новый Структура( КолонкиВидаДоговора );
	ТЗ_ВидыДоговоровФизЛица = ТЗ_ФизЛиц.Скопировать();
	ТЗ_ВидыДоговоровФизЛица.Свернуть( КолонкиВидаДоговора );
	Для каждого СтрВид Из ТЗ_ВидыДоговоровФизЛица Цикл
		ЗаполнитьЗначенияСвойств( ОтборСтрокВсехДоговоров, СтрВид );
		СтрокиВсехДоговоровВида = СведенияОСтаже.НайтиСтроки( ОтборСтрокВсехДоговоров );
		СтрокиВзносовВсехДоговоровВида = СведенияОВзносах.НайтиСтроки( ОтборСтрокВсехДоговоров );
		
		//Аверсон ЕАЕ 01.02.2023 СВФР-010250
		//ОбработанныеНомераПУ = Новый Массив;
		ОбработанныеНомераПУ = Новый ТаблицаЗначений;
		ОбработанныеНомераПУ.Колонки.Добавить("ОснНомерПУ");
		ОбработанныеНомераПУ.Колонки.Добавить("ОснДат");
		//Аверсон СВФР-010250
		
		Для каждого СтрОснДог Из СтрокиВсехДоговоровВида Цикл
			Если НЕ ЗначениеЗаполнено( СтрОснДог.Договор ) Тогда
				Продолжить;
			КонецЕсли; 
			
			ОснНомерПУ = ПолучитьНомерДокументаДляПУ( СтрОснДог.Договор );
			
			//Аверсон ЕАЕ 01.02.2023 СВФР-010250
			//Будем искать договор не только по номеру, но и по дате
			//Если ОбработанныеНомераПУ.Найти( ОснНомерПУ ) <> Неопределено Тогда
			ОснДат = СтрОснДог.Договор.Дата;
			СтруктураОтбора = Новый Структура;
			СтруктураОтбора.Вставить("ОснНомерПУ", ОснНомерПУ);
			СтруктураОтбора.Вставить("ОснДат", ОснДат);
			НужныеСтроки = ОбработанныеНомераПУ.НайтиСтроки(СтруктураОтбора);
			Если НужныеСтроки.Количество() > 0 Тогда
				//Аверсон СВФР-010250
				
				Продолжить;
			КонецЕсли;
			ДубльНайден = Ложь;
			Для каждого СтрДопДог Из СтрокиВсехДоговоровВида Цикл
				Если СтрОснДог = СтрДопДог 
					ИЛИ СтрОснДог.Договор = СтрДопДог.Договор
					ИЛИ (ОснНомерПУ <> ПолучитьНомерДокументаДляПУ( СтрДопДог.Договор ) ИЛИ ОснДат <> СтрДопДог.Договор.Дата) //Аверсон ЕАЕ 01.02.2023 СВФР-010250
					Тогда
					Продолжить;
				КонецЕсли;
				ДубльНайден = Истина;
				СтрДопДог.Договор = СтрОснДог.Договор;
				//+ СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
				Если СтрДопДог.Сотрудник <> СтрОснДог.Сотрудник Тогда
					Если МассивУдаляемыхСотрудников.Найти( СтрДопДог.Сотрудник ) = Неопределено Тогда
						МассивУдаляемыхСотрудников.Добавить( СтрДопДог.Сотрудник );
					КонецЕсли;
					СтрДопДог.Сотрудник = СтрОснДог.Сотрудник;
				КонецЕсли; 
				//- СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
			КонецЦикла;
			Если ДубльНайден Тогда
				//+ СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
				МассивУдаляемыхСтрокВзносов = Новый Массив;
				//- СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
				Для каждого СтрВзносДопДог Из СтрокиВзносовВсехДоговоровВида Цикл
					Если СтрОснДог.Договор = СтрВзносДопДог.Договор
						ИЛИ (ОснНомерПУ <> ПолучитьНомерДокументаДляПУ( СтрВзносДопДог.Договор ) ИЛИ ОснДат <> СтрВзносДопДог.Договор.Дата) //Аверсон ЕАЕ 01.02.2023 СВФР-010250
						Тогда
						Продолжить;
					КонецЕсли;
					//+ СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
					НайдСтроки = СведенияОВзносах.НайтиСтроки( Новый Структура( "Договор, Месяц", СтрОснДог.Договор, СтрВзносДопДог.Месяц ) );
					Если НайдСтроки.Количество() > 0 Тогда
						НайдСтрока = НайдСтроки[ 0 ];
						НайдСтрока.Выплаты = НайдСтрока.Выплаты + СтрВзносДопДог.Выплаты;
						НайдСтрока.Пособия = НайдСтрока.Пособия + СтрВзносДопДог.Пособия;
						НайдСтрока.Взносы = НайдСтрока.Взносы + СтрВзносДопДог.Взносы;
						МассивУдаляемыхСтрокВзносов.Добавить( СтрВзносДопДог );
					КонецЕсли; 
					СтрВзносДопДог.Сотрудник = СтрОснДог.Сотрудник;
					//- СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
					СтрВзносДопДог.Договор = СтрОснДог.Договор;
				КонецЦикла;
				//+ СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
				Для каждого УдаляемаяСтрока Из МассивУдаляемыхСтрокВзносов Цикл
					СведенияОВзносах.Удалить( УдаляемаяСтрока );	
				КонецЦикла;
				//- СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
			КонецЕсли;
			
			//Аверсон ЕАЕ 01.02.2023 СВФР-010250
			//ОбработанныеНомераПУ.Добавить( ОснНомерПУ );
			НовСтр = ОбработанныеНомераПУ.Добавить();
			НовСтр.ОснНомерПУ = ОснНомерПУ;
			НовСтр.ОснДат = ОснДат;
			//Аверсон СВФР-010250
			
		КонецЦикла; 
	КонецЦикла; 
	//- СВЭЙ КДЯ 31.10.19 СВФР-004631 ( Пункт 55. )
	
	//+ СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
	Для каждого СотрУдал Из МассивУдаляемыхСотрудников Цикл
		ОтборУдал = Новый Структура( "Сотрудник", СотрУдал );
		Если СведенияОСтаже.НайтиСтроки( ОтборУдал ).Количество() = 0 
			И СведенияОВзносах.НайтиСтроки( ОтборУдал ).Количество() = 0 Тогда
			Для каждого СтрокаУдал Из РаботникиОрганизации.НайтиСтроки( ОтборУдал ) Цикл
				РаботникиОрганизации.Удалить( СтрокаУдал );	
			КонецЦикла; 
		КонецЕсли; 
	КонецЦикла; 
	//- СВЭЙ КДЯ 26.11.19 СВФР-004631 ( Пункт 68. )
	
	СведенияОСтажеКопия = СведенияОСтаже.Выгрузить();
	СведенияОСтажеКопия.Сортировать( "ФизЛицо, ДатаНачалаРабот" );
	
	Отбор = Новый Структура( ЦелевыеКолонки );
	
	НеобходимоСвернуть = Ложь;
	Для каждого ЦелеваяСтрока Из ТЗ_ФизЛиц Цикл
		//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
		//Если НЕ ЗначениеЗаполнено( ЦелеваяСтрока.Договор ) Тогда
		//	Продолжить;
		//КонецЕсли;
		//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
		
		ЗаполнитьЗначенияСвойств( Отбор, ЦелеваяСтрока );
		СтрокиДоговора = СведенияОСтаже.НайтиСтроки( Отбор );
		Если СтрокиДоговора.Количество() <= 1 Тогда
			Продолжить;		
		КонецЕсли; 
		СтрокиДубли = СведенияОСтажеКопия.НайтиСтроки( Отбор );
		
		Для каждого Стр Из СтрокиДоговора Цикл
			
			Если Стр.ДатаНачалаРабот > Стр.ДатаОкончанияРабот Тогда
				ТекстОшибки = НСтр( "ru='В строке %1 дата начала работ превышает дату окончания работ!'" );
				ТекстОшибки =  СтрЗаменить( ТекстОшибки, "%1", Строка( Стр.НомерСтроки ) );
				Сообщить( ТекстОшибки, СтатусСообщения.Важное );
				Продолжить;	
			КонецЕсли;
			
			//+ СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
			ЭтоОбъединяемыйВидДеятельности = ( МасОбъединяемыеВидыДеятельности.Найти( Стр.ВидДеятельности ) <> Неопределено );
			//- СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
			
			ДублиБылиОткорректированы = Истина;
			Пока ДублиБылиОткорректированы Цикл
				
				ДублиБылиОткорректированы = Ложь;
				
				Для каждого СтрокаДубль Из СтрокиДубли Цикл
					
					Если Стр.НомерСтроки = СтрокаДубль.НомерСтроки ИЛИ СтрокаДубль.ДатаНачалаРабот > СтрокаДубль.ДатаОкончанияРабот Тогда
						Продолжить;	
					КонецЕсли;
					
					Если ( СтрокаДубль.ДатаОкончанияРабот + мДлинаСуток ) = Стр.ДатаНачалаРабот 
						И Стр.ВидДеятельности <> Премия //+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
						Тогда
						Стр.ДатаНачалаРабот	= СтрокаДубль.ДатаНачалаРабот;
						ДублиБылиОткорректированы = Истина;
						Продолжить;
					КонецЕсли;
					Если ( Стр.ДатаОкончанияРабот + мДлинаСуток ) = СтрокаДубль.ДатаНачалаРабот
						И Стр.ВидДеятельности <> Премия //+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
						Тогда
						Стр.ДатаОкончанияРабот	= СтрокаДубль.ДатаОкончанияРабот;
						ДублиБылиОткорректированы = Истина;
						//+ СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
						Продолжить;
						//- СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
					Если ЭтоОбъединяемыйВидДеятельности Тогда
						
						//+ СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
						//Даже если есть Необъединяемые ВидыДеятельности, все равно объединяем
						//ЕстьНеобъединяемыеВидыДеятельности = Ложь;
						//- СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
						
						Если ПолучитьПересечениеДиапазонов( Стр.ДатаНачалаРабот, Стр.ДатаОкончанияРабот,
							СтрокаДубль.ДатаНачалаРабот, СтрокаДубль.ДатаОкончанияРабот
							//+ СВЭЙ КДЯ 24.09.19 СВФР-004631 ( пункт 43. )
							, Истина
							//- СВЭЙ КДЯ 24.09.19 СВФР-004631 ( пункт 43. )
							) <> Неопределено Тогда
							
							//есть пересечение диапазонов
							Если СтрокаДубль.ДатаНачалаРабот < Стр.ДатаНачалаРабот Тогда
								Стр.ДатаНачалаРабот	= СтрокаДубль.ДатаНачалаРабот;
								ДублиБылиОткорректированы = Истина;
							КонецЕсли; 
							Если СтрокаДубль.ДатаОкончанияРабот > Стр.ДатаОкончанияРабот Тогда
								Стр.ДатаОкончанияРабот	= СтрокаДубль.ДатаОкончанияРабот;
								ДублиБылиОткорректированы = Истина;
							КонецЕсли; 
							Продолжить;
							
							//+ СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
							//Иначе
							
							////есть хронологический разрыв; нет пересечения диапазонов
							//Если СтрокаДубль.ДатаОкончанияРабот < Стр.ДатаНачалаРабот Тогда
							//	
							//	ХроноПромежуток = Новый Структура( "ДатаНачала, ДатаОкончания",
							//		СтрокаДубль.ДатаОкончанияРабот, Стр.ДатаНачалаРабот	);
							//		
							//	ЗаполнитьЗначенияСвойств( ОтборСтрокДоговора, ЦелеваяСтрока );
							//	СтрокиДоговораВсехВидовДеятельности = СведенияОСтажеКопия.НайтиСтроки( ОтборСтрокДоговора );
							//	
							//	Даже если есть Необъединяемые ВидыДеятельности, все равно объединяем
							//	ЕстьНеобъединяемыеВидыДеятельности = 
							//	ЕстьНеобъединяемыеВидыДеятельности( СтрокиДоговораВсехВидовДеятельности, ХроноПромежуток, МасОбъединяемыеВидыДеятельности )
							//	;
							//	
							//ИначеЕсли СтрокаДубль.ДатаНачалаРабот > Стр.ДатаОкончанияРабот Тогда
							//	
							//	ХроноПромежуток = Новый Структура( "ДатаНачала, ДатаОкончания",
							//		Стр.ДатаОкончанияРабот, СтрокаДубль.ДатаНачалаРабот	);
							//		
							//	ЗаполнитьЗначенияСвойств( ОтборСтрокДоговора, ЦелеваяСтрока );
							//	СтрокиДоговораВсехВидовДеятельности = СведенияОСтажеКопия.НайтиСтроки( ОтборСтрокДоговора );
							//	
							//	Даже если есть Необъединяемые ВидыДеятельности, все равно объединяем
							//	ЕстьНеобъединяемыеВидыДеятельности = 
							//	ЕстьНеобъединяемыеВидыДеятельности( СтрокиДоговораВсехВидовДеятельности, ХроноПромежуток, МасОбъединяемыеВидыДеятельности )
							//	;
							//	
							//КонецЕсли; 
							//- СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
							
							//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
						ИначеЕсли ЗначениеЗаполнено( Стр.Договор ) Тогда
							//объедняем дипазоны, даже если между ними есть зазоры, но только для договоров
							Если СтрокаДубль.ДатаОкончанияРабот < Стр.ДатаНачалаРабот Тогда
								Стр.ДатаНачалаРабот	= СтрокаДубль.ДатаНачалаРабот;
								ДублиБылиОткорректированы = Истина;
								Продолжить;
							КонецЕсли;
							Если Стр.ДатаОкончанияРабот < СтрокаДубль.ДатаНачалаРабот Тогда
								Стр.ДатаОкончанияРабот	= СтрокаДубль.ДатаОкончанияРабот;
								ДублиБылиОткорректированы = Истина;
							КонецЕсли;
							//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
							
						КонецЕсли; // ПолучитьПересечениеДиапазонов( Стр.ДатаНачалаРабот, Стр.ДатаОкончанияРабот ... 
						
						//+ СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
						//Даже если есть Необъединяемые ВидыДеятельности, все равно объединяем
						//Если ЕстьНеобъединяемыеВидыДеятельности Тогда
						//	Продолжить;	
						//КонецЕсли; 
						//- СВЭЙ КДЯ 25.09.18 СВФР-004631 ( пункт 47. )
						
						//+ СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
						//Если СтрокаДубль.ДатаОкончанияРабот < Стр.ДатаНачалаРабот Тогда
						//	Стр.ДатаНачалаРабот	= СтрокаДубль.ДатаНачалаРабот;
						//	ДублиБылиОткорректированы = Истина;
						//	Продолжить;
						//КонецЕсли;
						//Если Стр.ДатаОкончанияРабот < СтрокаДубль.ДатаНачалаРабот Тогда
						//	Стр.ДатаОкончанияРабот	= СтрокаДубль.ДатаОкончанияРабот;
						//	ДублиБылиОткорректированы = Истина;
						//КонецЕсли;
						//- СВЭЙ КДЯ 07.12.19 СВФР-004631 ( Пункт 75. )
						
						Продолжить;
						
					КонецЕсли; // ЭтоОбъединяемыйВидДеятельности 
					//- СВЭЙ КДЯ 29.08.18 СВФР-004631 ( пункт 13. )
					
				КонецЦикла; // СтрокаДубль Из СтрокиДубли
				
				Если ДублиБылиОткорректированы Тогда
					НеобходимоСвернуть = Истина;
				КонецЕсли;
				
			КонецЦикла; // ДублиБылиОткорректированы
		КонецЦикла; // Стр Из СтрокиДоговора
		
	КонецЦикла; // СтрФЛ Из ТЗ_ФизЛиц
	
	Если НеобходимоСвернуть Тогда
		СвернутьТабличнуюЧасть( "СведенияОСтаже" );
	КонецЕсли;
	
КонецПроцедуры // ОбъединитьХронологическиеЦепочкиСведенийОСтаже()
//- СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 9 )

//Островская Татьяна 30.11.2012 № 15958
Процедура УдалитьСтрокиНачисленийПоРаботнику(Сотрудник) Экспорт
	
	СтруктураПоиска = Новый Структура("Сотрудник", Сотрудник);
	
	МассивСтрок = СведенияОСтаже.НайтиСтроки(СтруктураПоиска);
	Для каждого СтрокаТабличнойЧасти Из МассивСтрок Цикл
		СведенияОСтаже.Удалить(СтрокаТабличнойЧасти);
	КонецЦикла;
	МассивСтрок = СведенияОВзносах.НайтиСтроки(СтруктураПоиска);
	Для каждого СтрокаТабличнойЧасти Из МассивСтрок Цикл
		СведенияОВзносах.Удалить(СтрокаТабличнойЧасти);
	КонецЦикла;
	
КонецПроцедуры // УдалитьСтрокиНачисленийПоРаботнику()
//Островская Татьяна 30.11.2012 № 15958

#Если Клиент Тогда
	
	// Формирует файл, который можно будет записать на дискетку
	//
	// Параметры: 
	//  Нет
	//
	// Возвращаемое значение:
	//  Строка - содержимое файла
	//
	Функция СформироватьВыходнойФайл(Отказ) Экспорт
		
		мДлинаСуток = 86400;
		
		// Заголовок для сообщений об ошибках проведения.
		Заголовок = ОбщегоНазначения.ПредставлениеДокументаПриПроведении(Ссылка);
		
		ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
		Если ВыборкаПоШапкеДокумента.Следующий()=0 тогда
			Отказ = Истина;
			Возврат "";
		КонецЕсли;	
		
		ПроверитьЗаполнениеШапки(ВыборкаПоШапкеДокумента, Отказ, Заголовок);
		Если Отказ тогда
			Возврат "";
		КонецЕсли;	 
		
		Результат					=	СформироватьЗапросПоРаботникиОрганизации();
		ВыборкаПоРаботникиОрганизации			=	Результат.Выбрать(ОбходРезультатаЗапроса.Прямой);
		ЗапросОрг = Новый Запрос;
		ЗапросОрг.Текст = 
		"ВЫБРАТЬ
		|	КонтактнаяИнформация.Представление,
		|	КонтактнаяИнформация.Объект
		|ИЗ
		|	РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация
		|ГДЕ
		|	КонтактнаяИнформация.Объект = &Объект
		|	И КонтактнаяИнформация.Тип = &Тип
		|	И КонтактнаяИнформация.Вид = &Вид
		|	И КонтактнаяИнформация.Объект.Код = &Код";
		ЗапросОрг.УстановитьПараметр("Объект", ВыборкаПоШапкеДокумента.Организация);
		ЗапросОрг.УстановитьПараметр("Тип", Перечисления.ТипыКонтактнойИнформации.Телефон);
		ЗапросОрг.УстановитьПараметр("Вид", Справочники.ВидыКонтактнойИнформации.ТелефонОрганизации);
		ЗапросОрг.УстановитьПараметр("Код", ВыборкаПоШапкеДокумента.Организация.Код);
		РезОрг = ЗапросОрг.Выполнить().Выбрать();
		ТелефонОрганизации = "";
		Если РезОрг.Следующий() Тогда 
			ТелефонОрганизации = РезОрг.Представление;
		КонецЕсли;;
		
		
		
		//убрал за ненадобностью	
		//Если ВыборкаПоРаботникиОрганизации.Количество()>200 тогда
		//	ОбщегоНазначения.СообщитьОбОшибке("В документе должно быть не более 200 анкет (работников)!", Отказ, Заголовок);
		//КонецЕсли;	 
		
		СписокОбработанныхАнкет = Новый СписокЗначений;
		
		ТекстФайла	=	"";
		НомерДокументаВПачке = 0;
		
		//Формируем заголовок выходного файла
		ДатаФормирования = ВыборкаПоШапкеДокумента.Дата;
		ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
		МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
		ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
		ДатаЗаполнения   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
		НомерПачки 				= ПроцедурыПерсонифицированогоУчета.НомерПачкиДокумента(ВыборкаПоШапкеДокумента.Номер);
		КоличествоДокументов 	= ВыборкаПоРаботникиОрганизации.Количество();
		
		Если Отказ тогда
			Возврат "";
		КонецЕсли;	 
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("ДокументСсылка" , Ссылка);
		Запрос.УстановитьПараметр("СписокОтчитывающихсяПодразделений", ВыборкаПоШапкеДокумента.Организация);
		Запрос.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
		Запрос.УстановитьПараметр("ДоходФСЗН", Перечисления.ДоходыФСС_НС.Облагается);
		Запрос.УстановитьПараметр("НачалоНП", НачалоГода(НачалоГода(ДобавитьМесяц(НачалоКвартала(ДатаНачала),-1))));  //ДатаРегистрации 1633
		Запрос.УстановитьПараметр("КонецНП", КонецГода(ВыборкаПоШапкеДокумента.ПериодРегистрации));// последний месяц налогового периода, за который подаём сведения
		Запрос.УстановитьПараметр("ДатаПодачиСведений", ВыборкаПоШапкеДокумента.ПериодРегистрации);// дата акуальности сведений о доходах и налогах
		
		
		// Выборка списка физлиц, для которых надо получать доходы
		СписокФизлицТекст = "ВЫБРАТЬ 
		//|	ТЧРаботникиОрганизации.ФизЛицо,
		|	ТЧРаботникиОрганизации.Сотрудник
		|ИЗ
		|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр2024.РаботникиОрганизации КАК ТЧРаботникиОрганизации
		|
		|ГДЕ
		|	ТЧРаботникиОрганизации.Ссылка = &ДокументСсылка";
		
		ДоходыПоВидамЗаГод =
		//"ВЫБРАТЬ
		//|	СУММА(ВЫБОР
		//|			КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН
		//|				ТОГДА ЕСНСведенияОДоходах.Результат
		//|			ИНАЧЕ 0
		//|		КОНЕЦ) КАК Больничные,
		//|	СУММА(ВЫБОР
		//|			КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		//|				ТОГДА ЕСНСведенияОДоходах.Результат
		//|			ИНАЧЕ 0
		//|		КОНЕЦ) КАК СуммаДохода,
		//|	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
		//|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК Период,
		//|	ЕСНИсчисленный.ФСЗН КАК ФСЗН,
		//|	ЕСНИсчисленный.ПенсионныйФонд КАК ПенсионныйФонд,
		//|	34 КАК ПроцентФСЗН
		//|ИЗ
		//|	РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		//|		ПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|			ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		//|			НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		//|			34 КАК ПроцентФСЗН,
		//|			СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		//|			СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН
		//|		ИЗ
		//|			РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		//|		ГДЕ
		//|			ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		//|			И ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		//|			И ЕСНИсчисленный.ФизЛицо В(" + СписокФизлицТекст + ")
		//|		
		//|		СГРУППИРОВАТЬ ПО
		//|			ЕСНИсчисленный.ФизЛицо,
		//|			НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)) КАК ЕСНИсчисленный
		//|		ПО ЕСНСведенияОДоходах.ФизЛицо = ЕСНИсчисленный.ФизЛицо
		//|			И (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ЕСНИсчисленный.ПериодВзаиморасчетов)
		//|ГДЕ
		//|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		//|	И ЕСНСведенияОДоходах.ФизЛицо В(" + СписокФизлицТекст + ")
		//|
		//|СГРУППИРОВАТЬ ПО
		//|	ЕСНСведенияОДоходах.ФизЛицо,
		//|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		//|	ЕСНИсчисленный.ФСЗН,
		//|	ЕСНИсчисленный.ПенсионныйФонд";
		"ВЫБРАТЬ
		|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		|	ОбщаяТаблицаФСЗН.ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов КАК Период,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		|	ВложенныйЗапрос.ВидДоговора,
		|	ВложенныйЗапрос.ДоговорНомер КАК НомерДокумента,
		|	ВложенныйЗапрос.ДоговорДата КАК ДатаДокумента
		|ИЗ
		|	(ВЫБРАТЬ
		|		NULL КАК Больничные,
		|		NULL КАК СуммаДохода,
		|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|		ВЫБОР
		|			КОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
		|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		|		КОНЕЦ КАК ПериодВзаиморасчетов,
		|		34 КАК ПроцентФСЗН,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ВЫБОР
		|				КОГДА ЕСНИсчисленный.ПериодВзаиморасчетов = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА ЕСНИсчисленный.Период МЕЖДУ &НачалоНП И &КонецНП
		|				ИНАЧЕ ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		|			КОНЕЦ
		
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.ФизЛицо,
		|		ВЫБОР
		|			КОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
		|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		|		КОНЕЦ
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		СУММА(ВЫБОР
		|				КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|				КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ВЫБОР
		|			КОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		|		КОНЕЦ,
		|		34,
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ВЫБОР
		|				КОГДА ЕСНСведенияОДоходах.ПериодВзаиморасчетов = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		|				ИНАЧЕ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		|			КОНЕЦ
		
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ВЫБОР
		|			КОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		|		КОНЕЦ) КАК ОбщаяТаблицаФСЗН
		
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.ФизЛицо КАК ФизЛицо,
		|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Месяц КАК Месяц,
		|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.ВидДоговора КАК ВидДоговора,
		|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.Номер КАК ДоговорНомер,
		|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.ДатаНачала КАК ДоговорДата
		|		ИЗ
		|			Документ.СведенияОЗаработкеРаботниковДПУПоСотр2024.СведенияОВзносах КАК СведенияОЗаработкеРаботниковДПУСведенияОВзносах
		|		ГДЕ
		|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Ссылка = &ДокументСсылка) КАК ВложенныйЗапрос
		|		ПО ОбщаяТаблицаФСЗН.ФизЛицо = ВложенныйЗапрос.ФизЛицо
		|			И ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов = ВложенныйЗапрос.Месяц
		
		|
		|СГРУППИРОВАТЬ ПО                                           
		|	ОбщаяТаблицаФСЗН.ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	ВложенныйЗапрос.ВидДоговора,
		|	ВложенныйЗапрос.ДоговорНомер,
		|	ВложенныйЗапрос.ДоговорДата
		|	УПОРЯДОЧИТЬ ПО
		|	Период";	
		
		
		
		Запрос.Текст = ДоходыПоВидамЗаГод;
		ПромежуточнаяТаблица = Запрос.Выполнить().Выгрузить();
		ПромежуточнаяТаблица.Свернуть("ФизЛицо,Период,ВидДоговора,НомерДокумента,ДатаДокумента,ПроцентФСЗН","Больничные,СуммаДохода,ФСЗН,ПенсионныйФонд");
		
		ПТДопСведОстаже = ПолучитьДанныеДляЗаполненияСтажа(ВыборкаПоШапкеДокумента.Организация, ВыборкаПоШапкеДокумента.ПериодРегистрации);
		
		ТекстФайла = Новый ТекстовыйДокумент;
		текстФайла.ДобавитьСтроку("ЗГЛВ=1.5=");
		//Островская Татьяна 25.10.2012 № 15
		ТекстФайла.ДобавитьСтроку(Врег("<ПАЧК="+?(СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)= "", " ",СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)) +"="+?(СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР)= ""," ",СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР))+
		"="+?(СокрЛП(ВыборкаПоШапкедокумента.организация.НаименованиеПолное) = ""," ",СокрЛП(ВыборкаПоШапкедокумента.организация.НаименованиеПолное))+"="+Прав(ВыборкаПоШапкеДокумента.Номер,5)+"= = =1="));
		//Островская Татьяна 25.10.2012 № 15
		ТекстФайла.ДобавитьСтроку("ТИПД=ПУ-3=1= = = =>");
		
		//ТекстФайла.ДобавитьСтроку("<ПУ-3=И="+СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР)+"= = ="+СокрЛП(Строка(КоличествоДокументов))+"= = = = =");
		
		
		ТипЗаписи    = "<ПУ-3=И="+?(СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР) = ""," ",СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР)) +"=";
		
		ТекСтрока = 3;
		ИтогДохода = 0;
		ИтогБольн = 0;
		ИтогВзнос = 0;
		РаботДоходСлед =0;
		РаботБольнСлед = 0;
		РаботВзносСлед =0;
		РаботДоход = 0;
		РаботБольн = 0;
		РаботВзнос = 0;
		
		СтрокаЗамены = 3;
		
		//толик контрольный файл дбф
		
		Дбф=Новый XBase();
		Дбф.Кодировка=КодировкаXBase.OEM;
		Дбф.Поля.Добавить("FIO", "S", 50);
		Дбф.Поля.Добавить("Datr", "D");
		Дбф.Поля.Добавить("Dato", "D");
		Дбф.Поля.Добавить("Sm", "N", 12);
		Дбф.Поля.Добавить("Bl", "N", 12);
		Дбф.Поля.Добавить("Vz", "N", 12);
		//Островская Татьяна 22.02.2013 № 16256 Островская Татьяна 27.05.2014 № 17388
		ПутьКФайлу = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация",Организация)).ПутьКФайламБанк;
		если ЗначениеЗаполнено(ПутьКФайлу) Тогда 
			Дбф.СоздатьФайл(ПутьКФайлу+"\VznosyF.DBF");
		иначе
			РабочийКаталог = СтрокаСоединенияИнформационнойБазы();
			б = Сред(РабочийКаталог,7);
			в = Найти(б,Символ(34));
			путьИБ = Лев(б, в-1);
			
			Дбф.СоздатьФайл(путьИБ+"\VznosyF.DBF");
		КонецЕсли;
		//Островская Татьяна 22.02.2013 № 16256 Островская Татьяна 27.05.2014 № 17388
		
		Пока ВыборкаПоРаботникиОрганизации.Следующий()	Цикл
			//Контроль дубля строк
			ТипЗаписиНач = "НЧСЛ=";
			Структура = Новый Структура;
			Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
			если ВыборкаПоРаботникиОрганизации.ВидДоговора = Неопределено Тогда 
				Структура.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
			Иначе 
				Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
			КонецЕсли;
			СтрокиПоРаботнику = ПромежуточнаяТаблица.НайтиСтроки(Структура); 
			Если СтрокиПоРаботнику.Количество()<> 0 тогда
				РаботДоход = 0;
				РаботБольн = 0;
				РаботВзнос = 0;
				СтрокаФайла = ТипЗаписи;
				//Инициалы должны быть указаны
				Фамилия = ВРег(?(ВыборкаПоРаботникиОрганизации.Фамилия = "", " ", СокрЛП(ВыборкаПоРаботникиОрганизации.Фамилия)));
				Имя = Врег(?(ВыборкаПоРаботникиОрганизации.Имя = "", " ", Лев(СокрЛП(ВыборкаПоРаботникиОрганизации.Имя),1)));
				Отчество = Врег(?(ВыборкаПоРаботникиОрганизации.Отчество = "", " ", Лев(СокрЛП(ВыборкаПоРаботникиОрганизации.Отчество),1)));
				Категория =?(ВыборкаПоРаботникиОрганизации.Категория = "", "01", СокрЛП(ВыборкаПоРаботникиОрганизации.Категория));
				//толик			СтрокаФайла = СтрокаФайла+СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)+"="+Фамилия+"="+Имя+"="+Отчество+"="+Категория+"=";
				СтрокаЗар = "";
				//Островская Татьяна 02.11.2012 № 15
				если ЗначениеЗаполнено(ВыборкаПоРаботникиОрганизации.ВидДоговора) Тогда 
					КатегорияВывод = "ДОГОВОР";
				ИНАЧЕ
					КатегорияВывод = "";
				КонецЕсли;
				Структура = Новый Структура;
				Структура.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
				если ВыборкаПоРаботникиОрганизации.ВидДоговора = Неопределено Тогда 
					Структура.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
				Иначе 
					Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
				КонецЕсли;
				
				СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо));
				ЕстьВидРасчета = Ложь;
				Для каждого СтрДог из СтрокиПоРаб цикл
					если не СокрЛП(СтрДог.ВидДейтельности) = "" Тогда
						ЕстьВидРасчета = Истина;
					КонецЕсли;
				КонецЦикла;
				СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо));
				Для каждого СтрДог из СтрокиПоРаб цикл 
					если ЕстьВидРасчета Тогда 
						если СокрЛП(СтрДог.ВидДейтельности) = "" Тогда
							Продолжить;
						КонецЕсли;
					КонецЕсли;
					
					
					если КатегорияВывод= "ДОГОВОР"  Тогда 
						
						СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"03"+"=";
					Иначе 
						СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"01"+"=";
						
					КонецЕсли;
					
					Прервать;
					
				КонецЦикла;
				
				Если СтрокиПоРаб.Количество()=0 Тогда 
					СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"01"+"=";
					Сообщить("Данные не найдены по сотруднику "+ВыборкаПоРаботникиОрганизации.ФизЛицо.Наименование);					
				КонецЕсли;
				
				//Островская Татьяна 02.11.2012 № 15
				Если Отказ Тогда
					Продолжить;
				КонецЕсли;                     
				
				НомерДокументаВПачке = 	НомерДокументаВПачке + 1;
				
				//Берем запись с пустыми полями
				//Запись = ПолучитьСтруктуруЗаписи(ТаблицаФорматаЗаписи);
				
				НомерДокументаВПачке = НомерДокументаВПачке;
				ТекстФайла.ДобавитьСтроку(СтрокаФайла);
				ТекСтрока = ТекСтрока+1;
				СтрокаЗамены = ТекСтрока;
				
				КоличествоМес = 0;
				СтрокаДатаДокумента = "";
				СтрокаНомерДокумента = "";
				СтрМес = 1;
				СтрокаФайла1 = "";
				Сч =0;
				СтрокиПоРаботнику1 = ПромежуточнаяТаблица.НайтиСтроки(Структура);
				Колич = СтрокиПоРаботнику1.Количество();
				СтрокаЗамена = СтрокаФайла;
				Для Сч = 0 по Колич-1 цикл
					СтрокаМес = СтрокиПоРаботнику1[Сч];
					если ЗначениеЗаполнено(СтрокаДатаДокумента) и ЗначениеЗаполнено(СтрокаНомерДокумента) Тогда 
					иначе
						
						СтрокаДатаДокумента = СтрокаМес.ДатаДокумента;
						СтрокаНомерДокумента = СтрокаМес.НомерДокумента;
					КонецЕсли;
					если Сч+1 <= СтрокиПоРаботнику1.Количество()-1 Тогда 
						СтрокаДатаДокументаСлед = СтрокиПоРаботнику1[Сч+1].ДатаДокумента;
						СтрокаНомерДокументаСлед = СтрокиПоРаботнику1[Сч+1].НомерДокумента;
					иначе
						СтрокаДатаДокументаСлед = СтрокаДатаДокумента;
						СтрокаНомерДокументаСлед = СтрокаНомерДокумента;
						
					КонецЕсли;
					Если Категория <> "03" тогда
						если КатегорияВывод= "ДОГОВОР" Тогда
							если  не СтрокаДатаДокументаСлед = "" Тогда  
								//если не СтрМес>1 Тогда
								ДеньДатыДоговора        = ?(День(СтрокаДатаДокументаСлед)<10,"0","")+День(СтрокаДатаДокументаСлед);
								МесяцДатыДоговора       = ?(Месяц(СтрокаДатаДокументаСлед)<10,"0","")+Месяц(СтрокаДатаДокументаСлед);
								ГодДатыДоговора 		 = Строка(СокрЛП(Формат(Год(СтрокаДатаДокументаСлед), "ЧГ=0")));
								ДатаДоговора   = ДеньДатыДоговора+"/"+МесяцДатыДоговора+"/"+ГодДатыДоговора;    
								//иначе
								//	ДеньДатыДоговора        = ?(День(СтрокаДатаДокумента)<10,"0","")+День(СтрокаДатаДокумента);
								//	МесяцДатыДоговора       = ?(Месяц(СтрокаДатаДокумента)<10,"0","")+Месяц(СтрокаДатаДокумента);
								//	ГодДатыДоговора 		 = Строка(СокрЛП(Формат(Год(СтрокаДатаДокумента), "ЧГ=0")));
								//	ДатаДоговора   = ДеньДатыДоговора+"/"+МесяцДатыДоговора+"/"+ГодДатыДоговора;
								//КонецЕсли;
							иначе
								ДатаДоговора = "";
							КонецЕсли;
							если не Сч > Колич-1 Тогда
								СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокументаСлед= "",СтрокаНомерДокументаСлед, Число(СтрокаНомерДокументаСлед)) +"="+ДатаДоговора+"= = =";					
							иначе
								СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокумента= "",СтрокаНомерДокумента, Число(СтрокаНомерДокумента)) +"="+ДатаДоговора+"= = =";
							КонецЕсли;
						Иначе 
							если не СтрМес>1 Тогда
								СтрокаФайла = СтрокаФайла+" = = = =";
							КонецЕсли;
						КонецЕсли;
						
						
					КонецЕсли;
					//КонецЕсли;
					если СтрМес > 1 Тогда 
						если КатегорияВывод= "ДОГОВОР" Тогда
							если не Сч > Колич-1 Тогда
								ТекстФайла.ДобавитьСтроку(СтрокаФайла1);
							иначе
								ТекстФайла.ДобавитьСтроку(СтрокаФайла);
							КонецЕсли;
							ТекСтрока = ТекСтрока+1;
							ТипЗаписиНач = "НЧСЛ=";
							если Сч <= СтрокиПоРаботнику1.Количество()-1 Тогда 
								если не КатегорияВывод= "ДОГОВОР" Тогда
									ИтогДохода = ИтогДохода + РаботДоход;
									ИтогБольн = ИтогБольн + РаботБольн;
									ИтогВзнос = ИтогВзнос + РаботВзнос;
								иначе
									ИтогДохода = ИтогДохода + РаботДоходСлед;
									ИтогБольн = ИтогБольн + РаботБольнСлед;
									ИтогВзнос = ИтогВзнос + РаботВзносСлед;
								КонецЕсли;
							иначе
								если КатегорияВывод= "ДОГОВОР" Тогда
									ИтогДохода = ИтогДохода + РаботДоход;
									ИтогБольн = ИтогБольн + РаботБольн;
									ИтогВзнос = ИтогВзнос + РаботВзнос;
									
								иначе
									ИтогДохода = ИтогДохода + РаботДоход;
									ИтогБольн = ИтогБольн + РаботБольн;
									ИтогВзнос = ИтогВзнос + РаботВзнос;
									
								КонецЕсли;
							КонецЕсли;
							РаботДоход = 0;
							РаботБольн = 0;
							РаботВзнос = 0;
							КоличествоМес = 0;
							КоличествоДокументов 	= КоличествоДокументов+1;
						КонецЕсли;
					КонецЕсли;
					
					//толик 	добавил округление - ЧДЦ=0;
					//Если (ЗначениеЗаполнено(СтрокаМес.СуммаДохода) Или ЗначениеЗаполнено(СтрокаМес.Больничные) или ЗначениеЗаполнено(СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд)) Тогда
					//Островская Татьяна 31.10.2012 № 15958
					ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаОкончания,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер; //О.Т. Аверсон 22.06.2016 № 949
					СтрЗар = ?(СтрокаМес.СуммаДохода = 0, "0", СокрЛП(Строка(Формат(СтрокаМес.СуммаДохода,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					если не КатегорияВывод= "ДОГОВОР" Тогда
						СтрБлн = ?(СтрокаМес.Больничные = 0, "0", СокрЛП(Строка(Формат(СтрокаМес.Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					иначе
						СтрБлн = ?(СтрокаМес.Больничные = 0, " ", СокрЛП(Строка(Формат(СтрокаМес.Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					КонецЕсли;
					СтрВзн = ?((СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд) = 0, "0", СокрЛП(Строка(Формат((СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					//Островская Татьяна 31.10.2012 № 15958
					НомерМесяца = Формат(Месяц(СтрокаМес.Период),"ЧГ=0");
					
					//+ СВЭЙ КДЯ 23.09.19 СВФР-004631 ( пункт 46. )
					//изменился формат файла пачки ПУ-3 - незначащие нули не проходят проверку
					//если НомерМесяца = Лев(НомерМесяца,1) Тогда 
					//	НомерМесяца = "0"+НомерМесяца;
					//КонецЕсли;
					//- СВЭЙ КДЯ 23.09.19 СВФР-004631 ( пункт 46. )
					
					
					//Островская Татьяна 30.11.2012 № 15958
					//Островская Татьяна 30.11.2012 № 15958
					//СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",СтрокаМес.ФизЛицо));
					//Для каждого СтрДог из СтрокиПоРаб цикл 
					//	если КатегорияВывод= "ДОГОВОР" Тогда
					//		если Основные Тогда
					//		Иначе 
					//			если СтрБлн = "0" Тогда 
					//				СтрБлн = " ";
					//				Прервать;
					//			КонецЕсли;
					//		КонецЕсли;
					//	КонецЕсли;
					//	
					//КонецЦикла;
					
					
					//Островская Татьяна 30.11.2012 № 15958
					СтрокаЗар = ВРЕГ(ТипЗаписиНач+НомерМесяца+"="+СтрЗар+"="+СтрБлн+"="+СтрВзн+"= ="+СокрЛП(Строка(Формат(СтрокаМес.ПроцентФСЗН+1,"ЧГ=0")))+"="); //Островская Татьяна 17.01.2013 № 16153
					ТекстФайла.ДобавитьСтроку(СтрокаЗар);
					ТекСтрока = ТекСтрока+1;
					//толик формирование контрольного файла
					Дбф.Добавить();
					Дбф.УстановитьЗначениеПоля("FIO", СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо)));
					Дбф.УстановитьЗначениеПоля("Dato", СтрокаМес.Период);
					Дбф.УстановитьЗначениеПоля("Sm", ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода, СтрокаМес.Период)); //О.Т. Аверсон 14.03.2016 № 949
					Дбф.УстановитьЗначениеПоля("Bl", ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.Больничные, СтрокаМес.Период));//О.Т. Аверсон 14.03.2016 № 949
					Дбф.УстановитьЗначениеПоля("Vz", ОбщегоНазначения.ОкруглитьЗначение2016((СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд),  СтрокаМес.Период));//О.Т. Аверсон 14.03.2016 № 949
					Дбф.Записать();
					
					если Сч+1 <= СтрокиПоРаботнику1.Количество()-1 Тогда 
						РаботДоходСлед = РаботДоход + ОбщегоНазначения.ОкруглитьЗначение2016(СтрокиПоРаботнику1[Сч+1].СуммаДохода, СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
						РаботБольнСлед = РаботБольн + СтрокиПоРаботнику1[Сч+1].Больничные;
						РаботВзносСлед = РаботВзнос + СтрокиПоРаботнику1[Сч+1].ФСЗН + СтрокиПоРаботнику1[Сч+1].ПенсионныйФонд;
						РаботДоход = РаботДоход + ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода, СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
						РаботБольн = РаботБольн + СтрокаМес.Больничные;
						РаботВзнос = РаботВзнос + СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд;
						//если не КатегорияВывод= "ДОГОВОР" Тогда
						//	ИтогДохода = ИтогДохода + РаботДоход;
						//	ИтогБольн = ИтогБольн + РаботБольн;
						//	ИтогВзнос = ИтогВзнос + РаботВзнос;
						//иначе
						//	ИтогДохода = ИтогДохода + РаботДоходСлед;
						//	ИтогБольн = ИтогБольн + РаботБольнСлед;
						//	ИтогВзнос = ИтогВзнос + РаботВзносСлед;
						//КонецЕсли;
					иначе
						если КатегорияВывод= "ДОГОВОР" Тогда
							РаботДоход = РаботДоход + ОбщегоНазначения.ОкруглитьЗначение2016(СтрокиПоРаботнику1[0].СуммаДохода, СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
							РаботБольн = РаботБольн + СтрокиПоРаботнику1[0].Больничные;
							РаботВзнос = РаботВзнос + СтрокиПоРаботнику1[0].ФСЗН + СтрокиПоРаботнику1[0].ПенсионныйФонд;
							//ИтогДохода = ИтогДохода + РаботДоход;
							//ИтогБольн = ИтогБольн + РаботБольн;
							//ИтогВзнос = ИтогВзнос + РаботВзнос;
							
						иначе
							РаботДоход = РаботДоход + ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода, СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
							РаботБольн = РаботБольн + СтрокаМес.Больничные;
							РаботВзнос = РаботВзнос + СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд;
							//ИтогДохода = ИтогДохода + РаботДоход;
							//ИтогБольн = ИтогБольн + РаботБольн;
							//ИтогВзнос = ИтогВзнос + РаботВзнос;
							
						КонецЕсли;
					КонецЕсли;
					КоличествоМес = КоличествоМес+1;
					//КонецЕсли;
					
					
					если КатегорияВывод= "ДОГОВОР" Тогда
						ТипЗаписиНач = "СТАЖ=";
						Структура = Новый Структура;
						Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
						если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							Структура.Вставить("ВидДоговора",null);
						Иначе 
							Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
						КонецЕсли;
						
						СтрокиПоРаботнику = ПТДопСведОстаже.НайтиСтроки(Структура); 
						КоличествоЗаписейОСтаже = 0;
						ПредыдущийВидДейтельности = "";
						ПредыдущееОкончаниеРабот = "";
						ДатаНачалаРабот = "";
						Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
							если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.НачалоРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ОкончаниеРабот)) Тогда 
								Продолжить;
							КонецЕсли;
							
							Если ЗначениеЗаполнено(СтрокаСтаж.ВидДейтельности) Тогда 
								Если СтрокаСтаж.ВидДейтельности <> "СП2     " Тогда 
									ДатаФормирования = СтрокаСтаж.НачалоРабот; //СтрЗаменить(СтрокаСтаж.НачалоРабот,"2011","2012");
									ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
									МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
									ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
									ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
									
									
									Если НачалоМесяца(СтрокаСтаж.НачалоРабот) <> НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) и Год(СтрокаСтаж.НачалоРабот) < Год(СтрокаСтаж.ОкончаниеРабот)  Тогда
										ДатаФормирования = КонецМесяца(СтрокаСтаж.НачалоРабот);
									иначе
										ДатаФормирования = СтрокаСтаж.ОкончаниеРабот;
									КонецЕсли;
									ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
									МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
									ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
									ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
									
									СтрокаЗар = ВРЕГ(ТипЗаписиНач+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="+СокрЛП(СтрокаСтаж.ВидДейтельности)+"= = =");
									ТекстФайла.ДобавитьСтроку(СтрокаЗар);
									ТекСтрока = ТекСтрока+1;
									КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
									Если Категория = "03" тогда
										НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
										ДатаФормирования = СтрокаСтаж.ДатаДокумента;
										ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
										МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
										ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
										ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										СтрокаФайла = СтрокаФайла+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"= = =";
									КонецЕсли;
									
									
									ПериодНач = НачалоМесяца(ДобавитьМесяц(СтрокаСтаж.НачалоРабот,1));
									Если Год(СтрокаСтаж.НачалоРабот) < Год(СтрокаСтаж.ОкончаниеРабот)  Тогда
										Пока ПериодНач <= НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) Цикл 
											ДатаФормирования = ПериодНач; //О.Т. Аверсон 22.04.2019 № 4269 //СтрЗаменить(СтрокаСтаж.НачалоРабот,"2011","2012");
											ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
											МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
											ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
											ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
											
											
											
											Если НачалоМесяца(ПериодНач) = НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) Тогда
												ДатаФормирования = СтрокаСтаж.ОкончаниеРабот;
											иначе
												ДатаФормирования = КонецМесяца(ПериодНач);
											КонецЕсли;
											ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
											МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
											ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
											ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
											
											СтрокаЗар = ВРЕГ(ТипЗаписиНач+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="+СокрЛП(СтрокаСтаж.ВидДейтельности)+"= = =");
											ТекстФайла.ДобавитьСтроку(СтрокаЗар);
											ТекСтрока = ТекСтрока+1;
											КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
											Если Категория = "03" тогда
												НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
												ДатаФормирования = СтрокаСтаж.ДатаДокумента;
												ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
												МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
												ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
												ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
												СтрокаФайла = СтрокаФайла+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"= = =";
											КонецЕсли;
											ПериодНач = ДобавитьМесяц(ПериодНач,1);
											
										КонецЦикла;
									КонецЕсли;
									
									ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
									ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
								КонецЕсли;
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
					
					
					
					
					
					//Островская Татьяна 25.10.2012 № 15958
					//Островская Татьяна 17.01.2013 № 16153
					если не Сч > Колич-1 Тогда 
						если не КатегорияВывод= "ДОГОВОР" Тогда
							
						иначе
							СтрокаЗар = СтрокаЗар + ">";
							ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар);
							если не Сч > Колич-1 Тогда
								СтрокаФайла1 = ВРЕГ(СтрокаФайла+ ?(РаботДоходСлед = 0, " ", СокрЛП(Строка(Формат(РаботДоходСлед,"ЧГ=0"))))+"="+
								?(РаботБольнСлед = 0, " ", СокрЛП(Строка(Формат(РаботБольнСлед,"ЧГ=0"))))+"="+
								?(РаботВзносСлед = 0, " ", СокрЛП(Строка(Формат(РаботВзносСлед,"ЧГ=0"))))+"= ="+Формат(КоличествоМес,"ЧГ=0")+"="+?(КоличествоЗаписейОСтаже=0," ",СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже,"ЧГ=0"))))+"="+ДатаЗаполнения+"= ="+Формат(ГОД(ДобавитьМесяц(НачалоКвартала(ДатаНачала),-1)),"ЧГ=0")+"="+СтрЗаменить(ТелефонОрганизации," ",""))+"=";
								
							КонецЕсли;	
						КонецЕсли;
					иначе
						если  КатегорияВывод= "ДОГОВОР" Тогда
							СтрокаЗар = СтрокаЗар + ">";
							ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар);
						КонецЕсли;
					КонецЕсли;
					//Островская Татьяна 17.01.2013 № 16153
					//Островская Татьяна 25.10.2012 № 15958	
					
					
					
					СтрМес = СтрМес+1;
				КонецЦикла;
				//если не СтрМес>1 Тогда 
				если не КатегорияВывод= "ДОГОВОР" Тогда
					СтрокаФайла = ВРЕГ(СтрокаФайла+ ?(РаботДоход = 0, "0", СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
					?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"= ="+Формат(КоличествоМес,"ЧГ=0")+"="+" "+"="+ДатаЗаполнения+"= ="+Формат(ГОД(ДобавитьМесяц(НачалоКвартала(ДатаНачала),-1)),"ЧГ=0")+"="+СтрЗаменить(ТелефонОрганизации," ",""))+"=";
				иначе
					
					//если не СтрМес>1 Тогда
					
					СтрокаФайла = ВРЕГ(СтрокаФайла+ ?(РаботДоход = 0, " ", СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
					?(РаботБольн = 0, " ", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, " ", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"= ="+Формат(КоличествоМес,"ЧГ=0")+"="+?(КоличествоЗаписейОСтаже=0," ",СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже,"ЧГ=0"))))+"="+ДатаЗаполнения+"= ="+Формат(ГОД(ДобавитьМесяц(НачалоКвартала(ДатаНачала),-1)),"ЧГ=0")+"="+СтрЗаменить(ТелефонОрганизации," ",""))+"=";
					//КонецЕсли;	
				КонецЕсли;
				//КонецЕсли;
				ТекстФайла.ЗаменитьСтроку(СтрокаЗамены, СтрокаФайла);
				если не КатегорияВывод= "ДОГОВОР" Тогда
					СтрокаЗар = СтрокаЗар + ">";
					ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар);
				КонецЕсли;
				
			КонецЕсли;
			если Сч+1 <= СтрокиПоРаботнику1.Количество()-1 Тогда 
				если не КатегорияВывод= "ДОГОВОР" Тогда
					ИтогДохода = ИтогДохода + РаботДоход;
					ИтогБольн = ИтогБольн + РаботБольн;
					ИтогВзнос = ИтогВзнос + РаботВзнос;
				иначе
					ИтогДохода = ИтогДохода + РаботДоходСлед;
					ИтогБольн = ИтогБольн + РаботБольнСлед;
					ИтогВзнос = ИтогВзнос + РаботВзносСлед;
				КонецЕсли;
			иначе
				если КатегорияВывод= "ДОГОВОР" Тогда
					ИтогДохода = ИтогДохода + РаботДоход;
					ИтогБольн = ИтогБольн + РаботБольн;
					ИтогВзнос = ИтогВзнос + РаботВзнос;
					
				иначе
					ИтогДохода = ИтогДохода + РаботДоход;
					ИтогБольн = ИтогБольн + РаботБольн;
					ИтогВзнос = ИтогВзнос + РаботВзнос;
					
				КонецЕсли;
			КонецЕсли;
			
		КонецЦикла; 
		Дбф.ЗакрытьФайл();
		//Островская Татьяна 25.10.2012 № 15
		//Островская Татьяна 17.01.2013 № 16153
		если не КатегорияВывод= "ДОГОВОР" Тогда
			
			//Аверсон ЕАЕ 20.07.2022 СВФР-009352
			//СтрокаФайла = "ТИПД=ПУ-3="+СокрЛП(Строка(КоличествоДокументов))+"="+ ?(ИтогДохода = 0, "0", СокрЛП(Строка(Формат(ИтогДохода,"ЧГ=0"))))+"="+
			СтрокаФайла = "ТИПД=ПУ-3="+СокрЛП(Формат(КоличествоДокументов,"ЧГ=0"))+"="+ ?(ИтогДохода = 0, "0", СокрЛП(Строка(Формат(ИтогДохода,"ЧГ=0"))))+"="+
			//Аверсон СВФР-009352
			
			?(ИтогБольн = 0, "0", СокрЛП(Строка(Формат(ИтогБольн,"ЧГ=0"))))+"="+
			?(ИтогВзнос = 0, "0", СокрЛП(Строка(Формат(ИтогВзнос,"ЧГ=0"))))+"=0=>";//Островская Татьяна 17.01.2013 № 16153
		Иначе 
			
			//Аверсон ЕАЕ 20.07.2022 СВФР-009352
			//СтрокаФайла = "ТИПД=ПУ-3="+СокрЛП(Строка(КоличествоДокументов))+"="+ ?(ИтогДохода = 0, " ", СокрЛП(Строка(Формат(ИтогДохода,"ЧГ=0"))))+"="+
			СтрокаФайла = "ТИПД=ПУ-3="+СокрЛП(Формат(КоличествоДокументов,"ЧГ=0"))+"="+ ?(ИтогДохода = 0, " ", СокрЛП(Строка(Формат(ИтогДохода,"ЧГ=0"))))+"="+
			//Аверсон СВФР-009352
			
			?(ИтогБольн = 0, " ", СокрЛП(Строка(Формат(ИтогБольн,"ЧГ=0"))))+"="+
			?(ИтогВзнос = 0, " ", СокрЛП(Строка(Формат(ИтогВзнос,"ЧГ=0"))))+"=0=>"; //Островская Татьяна 17.01.2013 № 16153
		КонецЕсли;	
		
		//Островская Татьяна 17.01.2013 № 16153
		
		
		//Островская Татьяна 25.10.2012 № 15
		ТекстФайла.ЗаменитьСтроку(3, СтрокаФайла);
		
		//толик проверка ФСЗН дбф	
		//ДоходыПоВидамЗаГод =
		//"ВЫБРАТЬ
		//|	СУММА(ВЫБОР
		//|			КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН
		//|				ТОГДА ЕСНСведенияОДоходах.Результат
		//|			ИНАЧЕ 0
		//|		КОНЕЦ) КАК Больничные,
		//|	СУММА(ВЫБОР
		//|			КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		//|				ТОГДА ЕСНСведенияОДоходах.Результат
		//|			ИНАЧЕ 0
		//|		КОНЕЦ) КАК СуммаДохода,
		//|	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
		//|	ЕСНИсчисленный.ФСЗН КАК ФСЗН,
		//|	ЕСНИсчисленный.ПенсионныйФонд КАК ПенсионныйФонд,
		//|	34 КАК ПроцентФСЗН,
		//|	ЕСНСведенияОДоходах.Период КАК ПериодРегистрации
		//|ИЗ
		//|	РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		//|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|			ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		//|			34 КАК ПроцентФСЗН,
		//|			СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		//|			СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		//|			ЕСНИсчисленный.Период КАК Период
		//|		ИЗ
		//|			РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		//|		ГДЕ
		//|			ЕСНИсчисленный.Период МЕЖДУ &НачалоНП И &КонецНП
		//|			И ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		//|			И ЕСНИсчисленный.ФизЛицо В(" + СписокФизлицТекст + ")
		//|		
		//|		СГРУППИРОВАТЬ ПО
		//|			ЕСНИсчисленный.ФизЛицо,
		//|			ЕСНИсчисленный.Период) КАК ЕСНИсчисленный
		//|		ПО ЕСНСведенияОДоходах.ФизЛицо = ЕСНИсчисленный.ФизЛицо
		//|			И ЕСНСведенияОДоходах.Период = ЕСНИсчисленный.Период
		//|ГДЕ
		//|	ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		//|	И ЕСНСведенияОДоходах.ФизЛицо В(" + СписокФизлицТекст + ")
		//|
		//|СГРУППИРОВАТЬ ПО
		//|	ЕСНСведенияОДоходах.ФизЛицо,
		//|	ЕСНИсчисленный.ФСЗН,
		//|	ЕСНИсчисленный.ПенсионныйФонд,
		//|	ЕСНИсчисленный.ПроцентФСЗН,
		//|	ЕСНСведенияОДоходах.Период";
		ДоходыПоВидамЗаГод =
		"ВЫБРАТЬ
		|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		|	ОбщаяТаблицаФСЗН.ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		|	ОбщаяТаблицаФСЗН.Период КАК ПериодРегистрации
		|ИЗ
		|	(ВЫБРАТЬ
		|		NULL КАК Больничные,
		|		NULL КАК СуммаДохода,
		|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|		ВЫБОР
		|		КОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
		|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		|		КОНЕЦ КАК ПериодВзаиморасчетов,
		|		34 КАК ПроцентФСЗН,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		|		ЕСНИсчисленный.Период КАК Период
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		|		И (ЕСНИсчисленный.Период МЕЖДУ &НачалоНП И &КонецНП
		|				ИЛИ ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП)
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.ФизЛицо,
		|		ЕСНИсчисленный.Период,
		|		ВЫБОР
		|			КОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
		|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		|		КОНЕЦ
		
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		СУММА(ВЫБОР
		|				КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|				КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ВЫБОР
		|		КОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		|		КОНЕЦ,
		|		34,
		|		NULL,
		|		NULL,
		|		ЕСНСведенияОДоходах.Период
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		|		И (ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		|				ИЛИ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП)
		|	СГРУППИРОВАТЬ ПО
		|	ЕСНСведенияОДоходах.ФизЛицо,
		|	ЕСНСведенияОДоходах.Период,
		|	ВЫБОР
		|		КОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		|	КОНЕЦ) КАК ОбщаяТаблицаФСЗН
		
		|
		|СГРУППИРОВАТЬ ПО
		|	ОбщаяТаблицаФСЗН.ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	ОбщаяТаблицаФСЗН.Период
		|	УПОРЯДОЧИТЬ ПО
		|	ПериодРегистрации";	
		Запрос.Текст = ДоходыПоВидамЗаГод;
		ПромежуточнаяТаблица = Запрос.Выполнить().Выгрузить();
		
		//формируем файл
		
		Дбф=Новый XBase();
		Дбф.Кодировка=КодировкаXBase.OEM;
		Дбф.Поля.Добавить("Tab_nom", "S", 10);
		Дбф.Поля.Добавить("FIO", "S", 50);
		Дбф.Поля.Добавить("Datr", "D");
		Дбф.Поля.Добавить("Dato", "D");
		Дбф.Поля.Добавить("Sm", "N", 12);
		Дбф.Поля.Добавить("Bl", "N", 12);
		Дбф.Поля.Добавить("Vz", "N", 12);
		//Островская Татьяна 22.02.2013 № 16256 Островская Татьяна 27.05.2014 № 17388
		ПутьКФайлу = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация",Организация)).ПутьКФайламБанк;
		если ЗначениеЗаполнено(ПутьКФайлу) Тогда 
			Дбф.СоздатьФайл(ПутьКФайлу+"\Vznosy.DBF");
		иначе
			РабочийКаталог = СтрокаСоединенияИнформационнойБазы();
			б = Сред(РабочийКаталог,7);
			в = Найти(б,Символ(34));
			путьИБ = Лев(б, в-1);
			
			Дбф.СоздатьФайл(путьИБ+"\Vznosy.DBF");
		КонецЕсли;
		//Островская Татьяна 22.02.2013 № 16256 Островская Татьяна 27.05.2014 № 17388
		
		Для Каждого мСтрока из ПромежуточнаяТаблица Цикл
			Дбф.Добавить();
			Дбф.УстановитьЗначениеПоля("FIO", СокрЛП(Строка(мСтрока.ФизЛицо)));
			Дбф.УстановитьЗначениеПоля("Datr", мСтрока.ПериодРегистрации);
			Дбф.УстановитьЗначениеПоля("Dato", мСтрока.ПериодВзаиморасчетов);
			Дбф.УстановитьЗначениеПоля("Sm", ОбщегоНазначения.ОкруглитьЗначение2016(?(мСтрока.СуммаДохода=Null, 0, мСтрока.СуммаДохода), мСтрока.ПериодРегистрации));//О.Т. Аверсон 14.03.2016 № 949
			Дбф.УстановитьЗначениеПоля("Bl", ОбщегоНазначения.ОкруглитьЗначение2016(?(мСтрока.Больничные=Null, 0, мСтрока.Больничные), мСтрока.ПериодРегистрации)); //О.Т. Аверсон 14.03.2016 № 949
			Дбф.УстановитьЗначениеПоля("Vz", ОбщегоНазначения.ОкруглитьЗначение2016(?(мСтрока.ФСЗН=Null, 0, мСтрока.ФСЗН) + ?(мСтрока.ПенсионныйФонд=Null, 0, мСтрока.ПенсионныйФонд), мСтрока.ПериодРегистрации));//О.Т. Аверсон 14.03.2016 № 949
			Дбф.Записать();
		КонецЦикла;
		Дбф.ЗакрытьФайл();
		Предупреждение("Данные сформированы !!!");
		
		
		
		Возврат ТекстФайла.ПолучитьТекст();
	КонецФункции 
	
	
	// + СВЭЙ КДЯ 31.07.19 СВФР-004561
	Функция ПолучитьРасшифрованнуюПромежуточнуюТаблицу( ПромежуточнаяТаблица, ТребуемыеРасшифровкиПересекающихсяДоговоров )
		Перем РасшифрованнаяПромежуточнаяТаблица;
		
		//Аверсон ЕАЕ 18.01.2023 СВФР-010135 (Закомментировано, распределяем по договорам при заполнении тч СведенияОВзносах)
		//если ДогПодряда или ВсеСотрудники Тогда
		//	
		//	Запрос = Новый Запрос;
		//	
		//	Запрос.Текст = "ВЫБРАТЬ
		//	|	ВЫРАЗИТЬ(ТаблицаРабот.ФизЛицо КАК Справочник.ФизическиеЛица) КАК ФизЛицо,
		//	|	ВЫРАЗИТЬ(ТаблицаРабот.НачалоРабот КАК ДАТА) КАК НачалоРабот,
		//	|	ВЫРАЗИТЬ(ТаблицаРабот.ОкончаниеРабот КАК ДАТА) КАК ОкончаниеРабот
		//	|ПОМЕСТИТЬ ВТ_ТаблицаРабот
		//	|ИЗ
		//	|	&ТаблицаРабот КАК ТаблицаРабот
		//	|;
		//	|
		//	|////////////////////////////////////////////////////////////////////////////////
		//	|ВЫБРАТЬ
		//	|	ВЫБОР
		//	|		КОГДА НачисленияПоДоговорам.ДокументОснование.НомерДляПу = """"
		//	|			ТОГДА НачисленияПоДоговорам.ДокументОснование.Номер
		//	|		ИНАЧЕ НачисленияПоДоговорам.ДокументОснование.НомерДляПу
		//	|	КОНЕЦ КАК НомерДокумента,
		//	|	ВЫБОР
		//	|		КОГДА НачисленияПоДоговорам.ДокументОснование.ДатаПУ = ДАТАВРЕМЯ(1, 1, 1)
		//	|			ТОГДА НачисленияПоДоговорам.ДокументОснование.Дата
		//	|		ИНАЧЕ НачисленияПоДоговорам.ДокументОснование.ДатаПУ
		//	|	КОНЕЦ КАК ДатаДокумента,
		//	|	НАЧАЛОПЕРИОДА(НачисленияПоДоговорам.ДатаНачала, МЕСЯЦ) КАК Период,
		//	|	НачисленияПоДоговорам.ДатаНачала КАК НачалоРабот,
		//	|	НачисленияПоДоговорам.ДатаОкончания КАК ОкончаниеРабот,
		//	|	СУММА( НачисленияПоДоговорам.Результат ) КАК СуммаДохода,
		//	|	НачисленияПоДоговорам.Физлицо,
		//	
		//	//Аверсон ЕАЕ 07.04.2021 СВФР-006959
		//	|	НачисленияПоДоговорам.ДокументОснование
		//	//Аверсон СВФР-006959
		//	
		//	|ИЗ
		//	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.ДоговорыНаВыполнениеРабот КАК НачисленияПоДоговорам
		//	
		//	//Аверсон ЕАЕ 07.04.2021 СВФР-006959
		//	//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ТаблицаРабот КАК ТаблицаРабот
		//	//|		ПО НачисленияПоДоговорам.Физлицо = ТаблицаРабот.ФизЛицо
		//	//|			И (НАЧАЛОПЕРИОДА(НачисленияПоДоговорам.ДатаНачала, МЕСЯЦ) = НАЧАЛОПЕРИОДА(ТаблицаРабот.НачалоРабот, МЕСЯЦ))
		//	//|			И (КОНЕЦПЕРИОДА(НачисленияПоДоговорам.ДатаОкончания, МЕСЯЦ) = КОНЕЦПЕРИОДА(ТаблицаРабот.ОкончаниеРабот, МЕСЯЦ))
		//	//|			И (НачисленияПоДоговорам.Ссылка.Проведен)
		//	//|			И (НачисленияПоДоговорам.Ссылка.Организация = &Организация)
		//	|ГДЕ НачисленияПоДоговорам.ДатаНачала >= &Начало И НачисленияПоДоговорам.ДатаОкончания <= &Окончание
		//	|И НачисленияПоДоговорам.ФизЛицо В (ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТаблицаРабот.ФизЛицо ИЗ ВТ_ТаблицаРабот)
		//	|И НачисленияПоДоговорам.Ссылка.Проведен
		//	//Аверсон СВФР-006959
		//	
		//	|
		//	|СГРУППИРОВАТЬ ПО
		//	|	ВЫБОР
		//	|		КОГДА НачисленияПоДоговорам.ДокументОснование.НомерДляПу = """"
		//	|			ТОГДА НачисленияПоДоговорам.ДокументОснование.Номер
		//	|		ИНАЧЕ НачисленияПоДоговорам.ДокументОснование.НомерДляПу
		//	|	КОНЕЦ,
		//	|	ВЫБОР
		//	|		КОГДА НачисленияПоДоговорам.ДокументОснование.ДатаПУ = ДАТАВРЕМЯ(1, 1, 1)
		//	|			ТОГДА НачисленияПоДоговорам.ДокументОснование.Дата
		//	|		ИНАЧЕ НачисленияПоДоговорам.ДокументОснование.ДатаПУ
		//	|	КОНЕЦ,
		//	|	НАЧАЛОПЕРИОДА(НачисленияПоДоговорам.ДатаНачала, МЕСЯЦ),
		//	|	НачисленияПоДоговорам.ДатаНачала,
		//	|	НачисленияПоДоговорам.ДатаОкончания,
		//	|	НачисленияПоДоговорам.Физлицо,
		//	
		//	//Аверсон ЕАЕ 07.04.2021 СВФР-006959
		//	|	НачисленияПоДоговорам.ДокументОснование
		//	//Аверсон СВФР-006959
		//	
		//	//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//	|УПОРЯДОЧИТЬ ПО
		//	|	НачисленияПоДоговорам.Физлицо,
		//	|	Период,
		//	|	СуммаДохода УБЫВ
		//	//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//	|";
		//	
		//	Запрос.УстановитьПараметр( "Организация", Организация );
		//	Запрос.УстановитьПараметр( "ТаблицаРабот", ТребуемыеРасшифровкиПересекающихсяДоговоров );
		//	
		//	//Аверсон ЕАЕ 07.04.2021 СВФР-006959
		//	Запрос.УстановитьПараметр( "Начало", ДатаНачала );
		//	Запрос.УстановитьПараметр( "Окончание", ДатаОкончания );
		//	//Аверсон СВФР-006959
		//	
		//	ТЗ_Расшифровки = Запрос.Выполнить().Выгрузить();
		//	
		//	//Аверсон ЕАЕ 16.01.2023 СВФР-010135
		//    Запрос = Новый Запрос;
		//	Запрос.Текст = "ВЫБРАТЬ
		//	|	ВЫРАЗИТЬ(ТаблицаРабот.ФизЛицо КАК Справочник.ФизическиеЛица) КАК ФизЛицо,
		//	|	ВЫРАЗИТЬ(ТаблицаРабот.НачалоРабот КАК ДАТА) КАК НачалоРабот,
		//	|	ВЫРАЗИТЬ(ТаблицаРабот.ОкончаниеРабот КАК ДАТА) КАК ОкончаниеРабот
		//	|ПОМЕСТИТЬ ВТ_ТаблицаРабот
		//	|ИЗ
		//	|	&ТаблицаРабот КАК ТаблицаРабот
		//	|;
		//	|
		//	|////////////////////////////////////////////////////////////////////////////////
		//	|ВЫБРАТЬ
		//	|   ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		//	|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор,
		//	|   ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ДоговорПодряда КАК ДокументОснование,
		//	|   НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) КАК Период,
		//	|   СУММА(ДополнительныеНачисленияРаботниковОрганизаций.Результат) КАК Результат
		//	|ИЗ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		//	|ГДЕ ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо В (ВЫБРАТЬ РАЗЛИЧНЫЕ ВТ_ТаблицаРабот.ФизЛицо ИЗ ВТ_ТаблицаРабот)
		//	|	И ДополнительныеНачисленияРаботниковОрганизаций.Регистратор ССЫЛКА Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда
		//	|   И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= &Начало И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец <= &Окончание
		//	|СГРУППИРОВАТЬ ПО
		//	|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор,
		//	|   НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
		//	|   ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ДоговорПодряда,
		//	|   ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо
		//	|";
		//	
		//	Запрос.УстановитьПараметр( "ТаблицаРабот", ТребуемыеРасшифровкиПересекающихсяДоговоров );
		//	Запрос.УстановитьПараметр( "Начало", ДатаНачала );
		//	Запрос.УстановитьПараметр( "Окончание", ДатаОкончания );
		//	ТЗ_Расшифровки_Больничные = Запрос.Выполнить().Выгрузить();
		//	//Аверсон СВФР-010135
		//	
		//	РасшифрованнаяПромежуточнаяТаблица = ПромежуточнаяТаблица.СкопироватьКолонки();
		//	//РасшифрованнаяПромежуточнаяТаблица.Колонки.Добавить( "ПериодРегистрации" );
		//	//РасшифрованнаяПромежуточнаяТаблица.Колонки.Добавить( "ПериодВзаиморасчетов" );
		//	
		//	//Аверсон ЕАЕ 07.04.2021 СВФР-006959
		//	//Отбор = Новый Структура( "ФизЛицо, Период" );
		//	Отбор = Новый Структура( "ФизЛицо, ДокументОснование, Период" );
		//	//Аверсон СВФР-006959
		//	
		//	Для каждого Стр Из ПромежуточнаяТаблица Цикл
		//		
		//		//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//		Если НЕ ЗначениеЗаполнено( Стр.НомерДокумента ) Тогда
		//			НовСтр = РасшифрованнаяПромежуточнаяТаблица.Добавить();
		//			ЗаполнитьЗначенияСвойств( НовСтр, Стр );
		//			Продолжить;
		//		КонецЕсли;
		//		//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//		
		//		ЗаполнитьЗначенияСвойств( Отбор, Стр );
		//		НайдРасшифровки = ТЗ_Расшифровки.НайтиСтроки( Отбор );
		//		Если НайдРасшифровки.Количество() = 0 Тогда
		//			НовСтр = РасшифрованнаяПромежуточнаяТаблица.Добавить();
		//			ЗаполнитьЗначенияСвойств( НовСтр, Стр );
		//			
		//			//Аверсон ЕАЕ 16.01.2023 СВФР-010135
		//			НайдБольничные = ТЗ_Расшифровки_Больничные.НайтиСтроки(Отбор);
		//			Если НайдБольничные.Количество() > 0 Тогда
		//				НовСтр.Больничные = 0;
		//				Для Каждого Б Из НайдБольничные Цикл
		//					НовСтр.Больничные = НовСтр.Больничные + Б.Результат;	
		//				КонецЦикла;
		//			КонецЕсли;
		//			//Аверсон СВФР-010135
		//			
		//		Иначе
		//			Сч = 0;
		//			//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//			СуммаДоходаКРаспределению = Стр.СуммаДохода;
		//			//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//			Для каждого СтрРасш Из НайдРасшифровки Цикл
		//				НовСтр = РасшифрованнаяПромежуточнаяТаблица.Добавить();
		//				НовСтр.Больничные = 0;
		//				//Вся сумма колонки "Больничные" остается в первой строке расшифровок за месяц (за период)
		//				ЗаполнитьЗначенияСвойств( НовСтр, Стр, , ?( Сч = 0, "", "Больничные" ) );
		//				//+ СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 34. )
		//				//ЗаполнитьЗначенияСвойств( НовСтр, СтрРасш, "НомерДокумента, СуммаДохода", "ПенсионныйФонд, ФСЗН" );
		//				//- СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 34. )
		//				
		//				//Аверсон ЕАЕ 16.01.2023 СВФР-010135
		//				НайдБольничные = ТЗ_Расшифровки_Больничные.НайтиСтроки(Отбор);
		//				Если НайдБольничные.Количество() > 0 Тогда
		//					НовСтр.Больничные = 0;
		//					Для Каждого Б Из НайдБольничные Цикл
		//						НовСтр.Больничные = НовСтр.Больничные + Б.Результат;	
		//					КонецЦикла;
		//				КонецЕсли;
		//				//Аверсон СВФР-010135
		//				
		//				//+ СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 34. )
		//				ЗаполнитьЗначенияСвойств( НовСтр, СтрРасш, "НомерДокумента, ДатаДокумента, СуммаДохода", "ПенсионныйФонд, ФСЗН" );
		//				//- СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 34. )
		//				
		//				//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//				Если СуммаДоходаКРаспределению < НовСтр.СуммаДохода Тогда
		//					Если Сч = НайдРасшифровки.ВГраница() Тогда
		//						НовСтр.СуммаДохода = СуммаДоходаКРаспределению;
		//					Иначе	
		//						НовСтр.СуммаДохода = 0;
		//					КонецЕсли; 
		//				КонецЕсли;
		//				СуммаДоходаКРаспределению = СуммаДоходаКРаспределению - НовСтр.СуммаДохода;
		//				//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//				
		//				НовСтр.НомерДокумента = СокрЛП( НовСтр.НомерДокумента );
		//				НовСтр.ПенсионныйФонд = Окр( НовСтр.СуммаДохода / 100, 2 ) ;
		//				//+ СВЭЙ КДЯ 21.10.19 СВФР-004944
		//				//НовСтр.ФСЗН = Окр( НовСтр.СуммаДохода * Стр.ПроцентФСЗН / 100, 2 ) ;
		//				//- СВЭЙ КДЯ 21.10.19 СВФР-004944
		//				//+ СВЭЙ КДЯ 21.10.19 СВФР-004944
		//				НовСтр.ФСЗН = Окр( НовСтр.СуммаДохода * ?( ЗначениеЗаполнено( Стр.ПроцентФСЗН ), Стр.ПроцентФСЗН, 1 ) / 100, 2 ) ;
		//				//- СВЭЙ КДЯ 21.10.19 СВФР-004944
		//				
		//				Сч = Сч + 1;
		//			КонецЦикла; // СтрРасш Из НайдРасшифровки
		//		КонецЕсли; 
		//		
		//	КонецЦикла; // Стр Из ПромежуточнаяТаблица
		//	
		//иначе
		//Аверсон СВФР-010135
		
		РасшифрованнаяПромежуточнаяТаблица = ПромежуточнаяТаблица;
		//конецесли; //  ДогПодряда или ВсеСотрудники
		
		РасшифрованнаяПромежуточнаяТаблица.Сортировать( "ДатаДокумента,НомерДокумента" );	
		Возврат РасшифрованнаяПромежуточнаяТаблица;
	КонецФункции // ПолучитьРасшифрованнуюПромежуточнуюТаблицу
	// - СВЭЙ КДЯ 31.07.19 СВФР-004561
	
	//+ СВЭЙ КДЯ 09.09.19 СВФР-004631 ( пункт 20. )
	Функция СтрокаСтажаСоответствуетСтрокеМесяца( СтрокаСтаж, СтрокаМес, ИдентификацияДоговораПоРеквизитам = Ложь )
		Перем Значениефункции;
		
		// + СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
		//Значениефункции =
		//		  ?( ЗначениеЗаполнено( СтрокаСтаж.Договор ),
		//		  
		//		        //а) договор заполнен:
		//				ПолучитьНомерДокументаДляПУ( СтрокаСтаж.Договор ) = СтрокаМес.НомерДокумента
		//				ИЛИ ПолучитьДатуДокументаДляПУ( СтрокаСтаж.Договор ) = СтрокаМес.ДатаДокумента,
		//				
		//				//б) договор не заполнен:
		//				НачалоМесяца( СтрокаСтаж.ДатаНачалаРабот ) <= НачалоМесяца( СтрокаМес.ДатаДокумента ) 
		//				И СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента 
		//			);
		// - СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
		
		// + СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
		Если ИдентификацияДоговораПоРеквизитам Тогда
			Значениефункции =
			СтрокаСтаж.НомерДокумента  = СтрокаМес.НомерДокумента
			И СтрокаСтаж.ДатаДляПУ = СтрокаМес.ДатаДокумента
			И СтрокаСтаж.ФизЛицо = СтрокаМес.ФизЛицо;
		Иначе	
			Значениефункции =
			
			?( ЗначениеЗаполнено( СтрокаСтаж.Договор ),
			
			//а) договор заполнен:
			ПолучитьНомерДокументаДляПУ( СтрокаСтаж.Договор ) = СтрокаМес.НомерДокумента
			ИЛИ ПолучитьДатуДокументаДляПУ( СтрокаСтаж.Договор ) = СтрокаМес.ДатаДокумента,
			
			//б) договор не заполнен:
			НачалоМесяца( СтрокаСтаж.ДатаНачалаРабот ) <= НачалоМесяца( СтрокаМес.ДатаДокумента ) 
			И СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента 
			);
		КонецЕсли; 
		
		// - СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
		
		Возврат Значениефункции;
		
	КонецФункции // СтрокаСтажаСоответствуетСтрокеДоговора()
	//- СВЭЙ КДЯ 09.09.19 СВФР-004631 ( пункт 20. )
	
	//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
	Функция ПолучитьМаксимальнуюДатуВыборкиВзносов( Сотрудник )
		НайдСтроки = СведенияОВзносах.НайтиСтроки( Новый Структура( "Сотрудник", Сотрудник ) );
		МаксимальнаяДатаВыборкиВзносов = Дата( 1, 1, 1 );
		Для каждого Стр Из НайдСтроки Цикл
			
			МаксимальнаяДатаВыборкиВзносов = Макс( Стр.Месяц, МаксимальнаяДатаВыборкиВзносов );	
			
		КонецЦикла;
		Возврат МаксимальнаяДатаВыборкиВзносов;
	КонецФункции // ПолучитьМаксимальнуюДатуВыборкиВзносов
	//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
	
	Функция  ПолучитьДоходыПоВидамЗаГод( Запрос )
		
		// + СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
		////О.Т. Аверсон 23.08.2018 № 2335
		//// Выборка списка физлиц, для которых надо получать доходы
		//СписокФизлицТекст1 = "ВЫБРАТЬ
		//|	ТЧРаботникиОрганизации.ФизЛицо
		//|ИЗ
		//|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр.РаботникиОрганизации КАК ТЧРаботникиОрганизации
		//|ГДЕ
		//|	ТЧРаботникиОрганизации.Ссылка = &ДокументСсылка";
		//
		//
		//СписокФизлицТекст = "ВЫБРАТЬ
		//|	ТЧРаботникиОрганизации.Сотрудник
		//|ИЗ
		//|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр.РаботникиОрганизации КАК ТЧРаботникиОрганизации
		//|ГДЕ
		//|	ТЧРаботникиОрганизации.Ссылка = &ДокументСсылка";
		//
		//Если ВыгрузкаДоговоровПодрядаБезОграничения Тогда //О.Т. Аверсон 22.08.2018 № 2335
		//	ДоходыПоВидамЗаГод =
		//	
		//	"ВЫБРАТЬ
		//	|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		//	|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		//	|	ОбщаяТаблицаФСЗН.ФизЛицо,";
		//	Если не ОбъединятьОсновные Тогда 
		//		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "	ОбщаяТаблицаФСЗН.Сотрудник,";
		//	КонецЕсли;
		//	ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//	|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов КАК Период,
		//	// + СВЭЙ КДЯ 31.07.19 СВФР-004561
		//	|	НАЧАЛОПЕРИОДА( ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов, МЕСЯЦ ) КАК ПериодВзаиморасчетов,
		//	|	НАЧАЛОПЕРИОДА( ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов, МЕСЯЦ ) КАК ПериодРегистрации,
		//	// - СВЭЙ КДЯ 31.07.19 СВФР-004561
		//	|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		//	|	Выразить(СУММА(ОбщаяТаблицаФСЗН.СуммаДохода)*ОбщаяТаблицаФСЗН.ПроцентПенсионный/100 как число(15,2)) КАК ПенсионныйФонд,   //&СтавкаПенс
		//	|	Выразить(СУММА(ОбщаяТаблицаФСЗН.СуммаДохода)*ОбщаяТаблицаФСЗН.ПроцентФСЗН/100 как число(15,2)) КАК ФСЗН,
		//	|	ВложенныйЗапрос.ВидДоговора,
		//	|	ВложенныйЗапрос.ДоговорНомер КАК НомерДокумента,
		//	|	ВложенныйЗапрос.ДоговорДата КАК ДатаДокумента,
		//	|	ОбщаяТаблицаФСЗН.ДокументОснование,
		//	|	ВложенныйЗапрос.ПричиныМинимальнойЗП
		//	|ИЗ
		//	|	(ВЫБРАТЬ
		//	|		NULL КАК Больничные,
		//	|		СУММА(ВЫБОР
		//	|				КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
		//	|						И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ДАТАВРЕМЯ(2016, 7, 1)
		//	|					ТОГДА ВЫРАЗИТЬ(ДополнительныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
		//	|				ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Результат
		//	|			КОНЕЦ) КАК СуммаДохода,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
		//	|		ВЫБОР
		//	|			КОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ)
		//	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ)
		//	|		КОНЕЦ КАК ПериодВзаиморасчетов,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер КАК ПроцентФСЗН,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних1.Размер КАК ПроцентПенсионный,
		//	|		0 КАК ПенсионныйФонд,
		//	|		0 КАК ФСЗН,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование как ДокументОснование
		//	|	ИЗ
		//	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц.СрезПоследних(&КонецНП, ) КАК СведенияОбИнвалидностиФизлицСрезПоследних
		//	|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = СведенияОбИнвалидностиФизлицСрезПоследних.Физлицо
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&КонецНП, ) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних
		//	|		ПО (ВЫБОР
		//	|				КОГДА ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидНалогообложенияОсновной = ЗНАЧЕНИЕ(Справочник.ВидыНалогообложения.ПустаяСсылка)
		//	|					ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Организация.ОсновнаяСтавкаНалогообложения
		//	|				ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидНалогообложенияОсновной
		//	|			КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидНалогообложения)
		//	|			И (ВЫБОР
		//	|				КОГДА СведенияОбИнвалидностиФизлицСрезПоследних.Инвалидность
		//	|					ТОГДА СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)
		//	|				ИНАЧЕ СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ФСЗН)
		//	|			КОНЕЦ)
		//	|		И ЕСНСведенияОДоходах.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних.Организация	
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&КонецНП, ) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних1
		//	|		ПО (ВЫБОР
		//	|			КОГДА ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидНалогообложенияОсновной = ЗНАЧЕНИЕ(Справочник.ВидыНалогообложения.ПустаяСсылка)
		//	|				ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Организация.ОсновнаяСтавкаНалогообложения
		//	|			ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидНалогообложенияОсновной
		//	|		КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних1.ВидНалогообложения)
		//	|		И (СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.Пенсионныйфонд))
		//	|			И ЕСНСведенияОДоходах.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних1.Организация
		//	
		//	
		//	|	ГДЕ
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
		//	|		И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник В(" + СписокФизлицТекст + ")			
		//	|		И ВЫБОР
		//	|				КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|					ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &НачалоНП И &КонецНП
		//	|				ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало МЕЖДУ &НачалоНП И &КонецНП
		//	|			КОНЕЦ
		//	|		И ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
		//	|	
		//	|	СГРУППИРОВАТЬ ПО
		//	|		ВЫБОР
		//	|			КОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ)
		//	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ)
		//	|		КОНЕЦ,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.ДокументОснование,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних1.Размер
		//	|	
		//	|	ОБЪЕДИНИТЬ ВСЕ
		//	|	
		//	|	ВЫБРАТЬ
		//	|		СУММА(ВЫБОР
		//	|				КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &СпособРасчета
		//	|					ТОГДА ВЫБОР
		//	|							КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
		//	|									И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ДАТАВРЕМЯ(2016, 7, 1)
		//	|								ТОГДА ВЫРАЗИТЬ(ДополнительныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
		//	|							ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Результат
		//	|						КОНЕЦ
		//	|				ИНАЧЕ 0
		//	|			КОНЕЦ),
		//	|		NULL,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
		//	|		ВЫБОР
		//	|			КОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ)
		//	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ)
		//	|		КОНЕЦ,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних1.Размер,
		//	|		0,
		//	|		0,
		//	|		Null
		//	|	ИЗ
		//	|		РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц.СрезПоследних(&КонецНП, ) КАК СведенияОбИнвалидностиФизлицСрезПоследних
		//	|		ПО ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = СведенияОбИнвалидностиФизлицСрезПоследних.Физлицо
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&КонецНП, ) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних
		//	|		ПО (ВЫБОР
		//	|				КОГДА ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидНалогообложенияОсновной = ЗНАЧЕНИЕ(Справочник.ВидыНалогообложения.ПустаяСсылка)
		//	|					ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Организация.ОсновнаяСтавкаНалогообложения
		//	|				ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидНалогообложенияОсновной
		//	|			КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидНалогообложения)
		//	|			И (ВЫБОР
		//	|				КОГДА СведенияОбИнвалидностиФизлицСрезПоследних.Инвалидность
		//	|					ТОГДА СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)
		//	|				ИНАЧЕ СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ФСЗН)
		//	|			КОНЕЦ)
		//	|			И ЕСНСведенияОДоходах.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних.Организация
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&КонецНП, ) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних1
		//	|		ПО (ВЫБОР
		//	|			КОГДА ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидНалогообложенияОсновной = ЗНАЧЕНИЕ(Справочник.ВидыНалогообложения.ПустаяСсылка)
		//	|				ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Организация.ОсновнаяСтавкаНалогообложения
		//	|			ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.ВидНалогообложенияОсновной
		//	|		КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних1.ВидНалогообложения)
		//	|		И (СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.Пенсионныйфонд))
		//	|			И ЕСНСведенияОДоходах.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних1.Организация
		//	
		//	
		//	|	ГДЕ
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
		//	|		И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник В(" + СписокФизлицТекст + ")
		//	
		//	|		И ВЫБОР
		//	|				КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|					ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &НачалоНП И &КонецНП
		//	|				ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало МЕЖДУ &НачалоНП И &КонецНП
		//	|			КОНЕЦ
		//	|		И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &СпособРасчета
		//	|	
		//	|	СГРУППИРОВАТЬ ПО
		//	|		ВЫБОР
		//	|			КОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|				ТОГДА НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ)
		//	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ)
		//	|		КОНЕЦ,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
		//	|		ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних1.Размер) КАК ОбщаяТаблицаФСЗН
		//	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.ФизЛицо КАК ФизЛицо,
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Сотрудник КАК Сотрудник,
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Месяц КАК Месяц,
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.ВидДоговора КАК ВидДоговора,
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.ПричиныМинимальнойЗП КАК ПричиныМинимальнойЗП, //О.Т. Аверсон 01.04.2019 № 4182
		//	//О.Т. Аверсон 31.01.2019 № 3056
		//	|		ВЫБОР
		//	|		КОГДА СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.НомерДляПу = """"
		//	|			ТОГДА СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.Номер
		//	|		ИНАЧЕ СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.НомерДляПу
		//	|		КОНЕЦ КАК ДоговорНомер,
		//	|		ВЫБОР
		//	|		КОГДА СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.ДатаПУ = ДАТАВРЕМЯ(1, 1, 1)
		//	|			ТОГДА СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.ДатаНачала
		//	|		ИНАЧЕ СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.ДатаПУ
		//	|		КОНЕЦ КАК ДоговорДата
		//	//О.Т. Аверсон 31.01.2019 № 3056
		//	|		ИЗ
		//	|			Документ.СведенияОЗаработкеРаботниковДПУПоСотр.СведенияОВзносах КАК СведенияОЗаработкеРаботниковДПУСведенияОВзносах
		//	|		ГДЕ
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Ссылка = &ДокументСсылка) КАК ВложенныйЗапрос
		//	|		ПО ОбщаяТаблицаФСЗН.Сотрудник = ВложенныйЗапрос.Сотрудник
		//	|			И ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов = ВложенныйЗапрос.Месяц
		//	|		И (ВЫБОР
		//	|			КОГДА НЕ ЕСТЬNULL(ОбщаяТаблицаФСЗН.ДокументОснование, 0) = 0
		//	|				ТОГДА ОбщаяТаблицаФСЗН.ДокументОснование.Номер = ВложенныйЗапрос.ДоговорНомер
		//	|						И ОбщаяТаблицаФСЗН.ДокументОснование.ДатаНачала = ВложенныйЗапрос.ДоговорДата
		//	|		КОНЕЦ)
		//	
		//	|
		//	|СГРУППИРОВАТЬ ПО
		//	|	ОбщаяТаблицаФСЗН.ФизЛицо,";
		//	Если не ОбъединятьОсновные Тогда 
		//		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "	ОбщаяТаблицаФСЗН.Сотрудник,";
		//	КонецЕсли;
		//	ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//	|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		//	// + СВЭЙ КДЯ 31.07.19 СВФР-004561
		//	|	НАЧАЛОПЕРИОДА( ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов, МЕСЯЦ ),
		//	|	НАЧАЛОПЕРИОДА( ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов, МЕСЯЦ ),
		//	// - СВЭЙ КДЯ 31.07.19 СВФР-004561
		//	|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		//	|	ОбщаяТаблицаФСЗН.ПроцентПенсионный,
		//	|	ВложенныйЗапрос.ВидДоговора,
		//	|	ВложенныйЗапрос.ДоговорНомер,
		//	|	ВложенныйЗапрос.ДоговорДата,
		//	|	ОбщаяТаблицаФСЗН.ДокументОснование,
		//	|	ВложенныйЗапрос.ПричиныМинимальнойЗП
		//	|
		//	|УПОРЯДОЧИТЬ ПО
		//	|	Период,
		//	|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование"
		//иначе
		//	
		//	ДоходыПоВидамЗаГод =
		//	//"ВЫБРАТЬ
		//	//|	СУММА(ВЫБОР
		//	//|			КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН
		//	//|				ТОГДА ЕСНСведенияОДоходах.Результат
		//	//|			ИНАЧЕ 0
		//	//|		КОНЕЦ) КАК Больничные,
		//	//|	СУММА(ВЫБОР
		//	//|			КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		//	//|				ТОГДА ЕСНСведенияОДоходах.Результат
		//	//|			ИНАЧЕ 0
		//	//|		КОНЕЦ) КАК СуммаДохода,
		//	//|	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
		//	//|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) КАК Период,
		//	//|	ЕСНИсчисленный.ФСЗН КАК ФСЗН,
		//	//|	ЕСНИсчисленный.ПенсионныйФонд КАК ПенсионныйФонд,
		//	//|	34 КАК ПроцентФСЗН
		//	//|ИЗ
		//	//|	РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		//	//|		ПОЛНОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//	//|			ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		//	//|			НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		//	//|			34 КАК ПроцентФСЗН,
		//	//|			СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		//	//|			СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН
		//	//|		ИЗ
		//	//|			РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		//	//|		ГДЕ
		//	//|			ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		//	//|			И ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		//	//|			И ЕСНИсчисленный.ФизЛицо В(" + СписокФизлицТекст + ")
		//	//|		
		//	//|		СГРУППИРОВАТЬ ПО
		//	//|			ЕСНИсчисленный.ФизЛицо,
		//	//|			НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)) КАК ЕСНИсчисленный
		//	//|		ПО ЕСНСведенияОДоходах.ФизЛицо = ЕСНИсчисленный.ФизЛицо
		//	//|			И (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ЕСНИсчисленный.ПериодВзаиморасчетов)
		//	//|ГДЕ
		//	//|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		//	//|	И ЕСНСведенияОДоходах.ФизЛицо В(" + СписокФизлицТекст + ")
		//	//|
		//	//|СГРУППИРОВАТЬ ПО
		//	//|	ЕСНСведенияОДоходах.ФизЛицо,
		//	//|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		//	//|	ЕСНИсчисленный.ФСЗН,
		//	//|	ЕСНИсчисленный.ПенсионныйФонд";
		//	"ВЫБРАТЬ
		//	|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		//	|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		//	|	ВложенныйЗапрос.ФизЛицо как ФизЛицо,
		//	|	ВложенныйЗапрос.Сотрудник,
		//	|	ВложенныйЗапрос.Месяц КАК Период,
		//	// + СВЭЙ КДЯ 31.07.19 СВФР-004561
		//	|	НАЧАЛОПЕРИОДА( ВложенныйЗапрос.Месяц, МЕСЯЦ ) КАК ПериодВзаиморасчетов,
		//	|	НАЧАЛОПЕРИОДА( ВложенныйЗапрос.Месяц, МЕСЯЦ ) КАК ПериодРегистрации,
		//	// - СВЭЙ КДЯ 31.07.19 СВФР-004561
		//	|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		//	|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		//	|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		//	|	ВложенныйЗапрос.ВидДоговора,
		//	|	ВложенныйЗапрос.ДоговорНомер КАК НомерДокумента,
		//	|	ВложенныйЗапрос.ДоговорДата КАК ДатаДокумента,
		//	|	ВложенныйЗапрос.ПричиныМинимальнойЗП
		//	|ИЗ
		//	
		//	|		(ВЫБРАТЬ
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Сотрудник КАК Сотрудник,
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.ФизЛицо КАК ФизЛицо,
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Месяц КАК Месяц,
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.ВидДоговора КАК ВидДоговора,
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.ПричиныМинимальнойЗП КАК ПричиныМинимальнойЗП, //О.Т. Аверсон 01.04.2019 № 4182
		//	//О.Т. Аверсон 31.01.2019 № 3056
		//	|		ВЫБОР
		//	|		КОГДА СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.НомерДляПу = """"
		//	|			ТОГДА СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.Номер
		//	|		ИНАЧЕ СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.НомерДляПу
		//	|		КОНЕЦ КАК ДоговорНомер,
		//	|		ВЫБОР
		//	|		КОГДА СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.ДатаПУ = ДАТАВРЕМЯ(1, 1, 1)
		//	|			ТОГДА СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.ДатаНачала
		//	|		ИНАЧЕ СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Договор.ДатаПУ
		//	|		КОНЕЦ КАК ДоговорДата
		//	//О.Т. Аверсон 31.01.2019 № 3056
		//	|		ИЗ
		//	|			Документ.СведенияОЗаработкеРаботниковДПУПоСотр.СведенияОВзносах КАК СведенияОЗаработкеРаботниковДПУСведенияОВзносах
		//	|		ГДЕ
		//	|			СведенияОЗаработкеРаботниковДПУСведенияОВзносах.Ссылка = &ДокументСсылка) КАК ВложенныйЗапрос
		//	
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ 
		//	|	
		//	|	(ВЫБРАТЬ
		//	|		NULL КАК Больничные,
		//	|		NULL КАК СуммаДохода,
		//	|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		//	|		ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		//	|		ВЫБОР
		//	|			КОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
		//	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		//	|		КОНЕЦ КАК ПериодВзаиморасчетов,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер КАК ПроцентФСЗН,  //34
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних1.Размер КАК ПроцентПенсионный,
		//	|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		//	|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН
		//	|	ИЗ
		//	|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц.СрезПоследних(&КонецНП, ) КАК СведенияОбИнвалидностиФизлицСрезПоследних
		//	|		ПО ЕСНИсчисленный.ФизЛицо = СведенияОбИнвалидностиФизлицСрезПоследних.Физлицо
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&КонецНП, ) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних
		//	|		ПО (ВЫБОР
		//	|				КОГДА ЕСНИсчисленный.Сотрудник.ВидНалогообложенияОсновной = ЗНАЧЕНИЕ(Справочник.ВидыНалогообложения.ПустаяСсылка)
		//	|					ТОГДА ЕСНИсчисленный.Организация.ОсновнаяСтавкаНалогообложения
		//	|				ИНАЧЕ ЕСНИсчисленный.Сотрудник.ВидНалогообложенияОсновной
		//	|			КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидНалогообложения)
		//	|			И (ВЫБОР
		//	|				КОГДА СведенияОбИнвалидностиФизлицСрезПоследних.Инвалидность
		//	|					ТОГДА СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)
		//	|				ИНАЧЕ СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ФСЗН)
		//	|			КОНЕЦ)	
		//	|			И ЕСНИсчисленный.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних.Организация
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&КонецНП, ) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних1
		//	|		ПО (ВЫБОР
		//	|			КОГДА ЕСНИсчисленный.Сотрудник.ВидНалогообложенияОсновной = ЗНАЧЕНИЕ(Справочник.ВидыНалогообложения.ПустаяСсылка)
		//	|				ТОГДА ЕСНИсчисленный.Организация.ОсновнаяСтавкаНалогообложения
		//	|			ИНАЧЕ ЕСНИсчисленный.Сотрудник.ВидНалогообложенияОсновной
		//	|		КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних1.ВидНалогообложения)
		//	|		И (СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.Пенсионныйфонд))
		//	|			И ЕСНИсчисленный.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних1.Организация
		//	
		//	|	ГДЕ
		//	|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		//	|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		//	|		И ВЫБОР
		//	|				КОГДА ЕСНИсчисленный.ПериодВзаиморасчетов = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|					ТОГДА ЕСНИсчисленный.Период МЕЖДУ &НачалоНП И &КонецНП
		//	|				ИНАЧЕ ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		//	|			КОНЕЦ
		//	
		//	|	
		//	|	СГРУППИРОВАТЬ ПО
		//	|		ЕСНИсчисленный.ФизЛицо,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних1.Размер,
		//	|		ЕСНИсчисленный.Сотрудник,
		//	|		ВЫБОР
		//	|			КОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
		//	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		//	|		КОНЕЦ
		//	|	
		//	|	ОБЪЕДИНИТЬ ВСЕ
		//	|	
		//	|	ВЫБРАТЬ
		//	|		СУММА(ВЫБОР
		//	|				КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//	|		или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 03.04.2019 № 3224
		//	|	и НЕ ЕСНСведенияОДоходах.ВидРасчета ССЫЛКА ПланВидовРасчета.ДополнительныеНачисленияОрганизаций
		//	|			ТОГДА ВЫБОР
		//	|					КОГДА ЕСНСведенияОДоходах.Период < ДАТАВРЕМЯ(2016, 7, 1)
		//	|							И ЕСНСведенияОДоходах.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
		//	|						ТОГДА ВЫРАЗИТЬ(ЕСНСведенияОДоходах.Результат / 10000 КАК ЧИСЛО(15, 2))
		//	|					ИНАЧЕ ЕСНСведенияОДоходах.Результат конец
		//	
		//	|				ИНАЧЕ 0
		//	|			КОНЕЦ),
		//	|		СУММА( ВЫБОР
		//	|		КОГДА НЕ ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН и не ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//	|		
		//	|			ТОГДА ВЫБОР
		//	|					КОГДА ЕСНСведенияОДоходах.Период < ДАТАВРЕМЯ(2016, 7, 1)
		//	|							И ЕСНСведенияОДоходах.ПериодВзаиморасчетов >= ДАТАВРЕМЯ(2016, 7, 1)
		//	|						ТОГДА ВЫРАЗИТЬ(ЕСНСведенияОДоходах.Результат / 10000 КАК ЧИСЛО(15, 2))
		//	|					ИНАЧЕ ЕСНСведенияОДоходах.Результат конец
		//	|				КОНЕЦ),
		//	|		ЕСНСведенияОДоходах.ФизЛицо,
		//	|		ЕСНСведенияОДоходах.Сотрудник,
		//	|		ВЫБОР
		//	|			КОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		//	|			ИНАЧЕ ВЫБОР
		//	|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
		//	|			ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
		//	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
		//	|		КОНЕЦ
		//	|		КОНЕЦ,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер,//34,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних1.Размер,
		//	|		NULL,
		//	|		NULL
		//	|	ИЗ
		//	|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц.СрезПоследних(&КонецНП, ) КАК СведенияОбИнвалидностиФизлицСрезПоследних
		//	|		ПО ЕСНСведенияОДоходах.ФизЛицо = СведенияОбИнвалидностиФизлицСрезПоследних.Физлицо
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&КонецНП, ) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних
		//	|		ПО (ВЫБОР
		//	|				КОГДА ЕСНСведенияОДоходах.Сотрудник.ВидНалогообложенияОсновной = ЗНАЧЕНИЕ(Справочник.ВидыНалогообложения.ПустаяСсылка)
		//	|					ТОГДА ЕСНСведенияОДоходах.Организация.ОсновнаяСтавкаНалогообложения
		//	|				ИНАЧЕ ЕСНСведенияОДоходах.Сотрудник.ВидНалогообложенияОсновной
		//	|			КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидНалогообложения)
		//	|			И (ВЫБОР
		//	|				КОГДА СведенияОбИнвалидностиФизлицСрезПоследних.Инвалидность
		//	|					ТОГДА СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)
		//	|				ИНАЧЕ СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.ФСЗН)
		//	|			КОНЕЦ)
		//	|			И ЕСНСведенияОДоходах.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних.Организация
		//	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиОтчисленийСФОТиЗП.СрезПоследних(&КонецНП, ) КАК СтавкиОтчисленийСФОТиЗПСрезПоследних1
		//	|		ПО (ВЫБОР
		//	|			КОГДА ЕСНСведенияОДоходах.Сотрудник.ВидНалогообложенияОсновной = ЗНАЧЕНИЕ(Справочник.ВидыНалогообложения.ПустаяСсылка)
		//	|				ТОГДА ЕСНСведенияОДоходах.Организация.ОсновнаяСтавкаНалогообложения
		//	|			ИНАЧЕ ЕСНСведенияОДоходах.Сотрудник.ВидНалогообложенияОсновной
		//	|		КОНЕЦ = СтавкиОтчисленийСФОТиЗПСрезПоследних1.ВидНалогообложения)
		//	|		И (СтавкиОтчисленийСФОТиЗПСрезПоследних.ВидОтчисления = ЗНАЧЕНИЕ(Перечисление.ВидыОтчисленийСФОТиЗП.Пенсионныйфонд))
		//	|		И ЕСНСведенияОДоходах.Организация = СтавкиОтчисленийСФОТиЗПСрезПоследних1.Организация
		//	
		//	
		//	
		//	|	ГДЕ
		//	|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		//	|		И выбор когда &ОбъединятьОсновные тогда ЕСНСведенияОДоходах.ФизЛицо В(" + СписокФизлицТекст1 + ") иначе ЕСНСведенияОДоходах.Сотрудник  В(" + СписокФизлицТекст + ") конец
		//	|		И ВЫБОР
		//	|				КОГДА ЕСНСведенияОДоходах.ПериодВзаиморасчетов = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|					ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		//	|				ИНАЧЕ выбор когда ЕСНСведенияОДоходах.ВидРасчета в (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
		//	|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
		//	|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) конец  МЕЖДУ &НачалоНП И &КонецНП
		//	|		КОНЕЦ
		//	
		//	|	
		//	|	СГРУППИРОВАТЬ ПО
		//	|		ЕСНСведенияОДоходах.Сотрудник,
		//	|		ЕСНСведенияОДоходах.ФизЛицо,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних.Размер,
		//	|		СтавкиОтчисленийСФОТиЗПСрезПоследних1.Размер,
		//	|		ВЫБОР
		//	|			КОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//	|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		//	|			ИНАЧЕ ВЫБОР
		//	|		КОГДА ЕСНСведенияОДоходах.ВидРасчета В (&ВидРасчетаПремия) //О.Т. Аверсон 14.03.2019 № 4054 3ч
		//	|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
		//	|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
		//	|		КОНЕЦ
		//	|		КОНЕЦ) КАК ОбщаяТаблицаФСЗН";
		//	
		//	Если ОбъединятьОсновные Тогда 
		//		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "	ПО (ОбщаяТаблицаФСЗН.ФизЛицо = ВложенныйЗапрос.ФизЛицо)";
		//		
		//	иначе
		//		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "	ПО (ОбщаяТаблицаФСЗН.Сотрудник = ВложенныйЗапрос.Сотрудник)";
		//		
		//	КонецЕсли;
		//	ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//	|		И (ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов = ВложенныйЗапрос.Месяц)
		//	
		//	|
		//	|СГРУППИРОВАТЬ ПО   
		//	|	ВложенныйЗапрос.Сотрудник,
		//	|	ВложенныйЗапрос.ФизЛицо,
		//	|	ВложенныйЗапрос.Месяц,
		//	// + СВЭЙ КДЯ 31.07.19 СВФР-004561
		//	|	НАЧАЛОПЕРИОДА( ВложенныйЗапрос.Месяц, МЕСЯЦ ),
		//	|	НАЧАЛОПЕРИОДА( ВложенныйЗапрос.Месяц, МЕСЯЦ ),
		//	// - СВЭЙ КДЯ 31.07.19 СВФР-004561
		//	|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		//	|	ВложенныйЗапрос.ВидДоговора,
		//	|	ВложенныйЗапрос.ПричиныМинимальнойЗП,
		//	|	ВложенныйЗапрос.ДоговорНомер,
		//	|	ВложенныйЗапрос.ДоговорДата
		//	|	УПОРЯДОЧИТЬ ПО
		//	|	Период,
		//	|	ВложенныйЗапрос.ФизЛицо.Наименование";	
		//КонецЕсли;
		//Запрос.Текст = ДоходыПоВидамЗаГод;
		// - СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
		
		// + СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
		Запрос.УстановитьПараметр( "ДокументСсылка", Ссылка );
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	СведенияОВзносах.Сотрудник КАК Сотрудник,
		|	СведенияОВзносах.ФизЛицо КАК ФизЛицо,
		|	НАЧАЛОПЕРИОДА(СведенияОВзносах.Месяц, МЕСЯЦ) КАК Период,
		|	НАЧАЛОПЕРИОДА(СведенияОВзносах.Месяц, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|	НАЧАЛОПЕРИОДА(СведенияОВзносах.Месяц, МЕСЯЦ) КАК ПериодРегистрации,
		|	СведенияОВзносах.Выплаты КАК СуммаДохода,
		|	ВЫБОР КОГДА СведенияОВзносах.Взносы > (ВЫРАЗИТЬ(СведенияОВзносах.Выплаты * &СтавкаПенс / 100 КАК ЧИСЛО(15, 2)))
		|   	ТОГДА  СведенияОВзносах.Взносы - (ВЫРАЗИТЬ(СведенияОВзносах.Выплаты * &СтавкаПенс / 100 КАК ЧИСЛО(15, 2)))
		|       ИНАЧЕ  0
		|	КОНЕЦ КАК ФСЗН,
		|	СведенияОВзносах.Договор КАК ДокументОснование,
		//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
		//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//|	СведенияОВзносах.ВидДоговора,
		//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
		//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
		//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		|	ВЫБОР КОГДА СведенияОВзносах.ВидДоговора = ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.Подряда ) 
		|			ТОГДА СведенияОВзносах.ВидДоговора
		|         	ИНАЧЕ ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.ПустаяСсылка )
		|   КОНЕЦ КАК ВидДоговора,
		//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
		|		ВЫБОР
		//+ СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		|		КОГДА СведенияОВзносах.Договор.ДатаПУ IS NULL 
		|			ТОГДА """"
		//- СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		|		КОГДА СведенияОВзносах.Договор.НомерДляПу = """"
		|			ТОГДА СведенияОВзносах.Договор.Номер
		|		ИНАЧЕ СведенияОВзносах.Договор.НомерДляПу
		|		КОНЕЦ КАК НомерДокумента,
		|		ВЫБОР
		//+ СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		|		КОГДА СведенияОВзносах.Договор.ДатаПУ IS NULL 
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1)
		//- СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		|		КОГДА СведенияОВзносах.Договор.ДатаПУ = ДАТАВРЕМЯ(1, 1, 1)
		|			ТОГДА СведенияОВзносах.Договор.ДатаНачала
		|		ИНАЧЕ СведенияОВзносах.Договор.ДатаПУ
		|		КОНЕЦ КАК ДатаДокумента,
		|	СведенияОВзносах.Пособия КАК Больничные,
		|	ВЫБОР КОГДА СведенияОВзносах.Взносы >= ВЫРАЗИТЬ(СведенияОВзносах.Выплаты * &СтавкаПенс / 100 КАК ЧИСЛО(15, 2))
		|   	ТОГДА  ВЫРАЗИТЬ(СведенияОВзносах.Выплаты * &СтавкаПенс / 100 КАК ЧИСЛО(15, 2))
		|       ИНАЧЕ  СведенияОВзносах.Взносы
		|	КОНЕЦ КАК ПенсионныйФонд,
		//|	ВЫРАЗИТЬ(СведенияОВзносах.Выплаты * &СтавкаПенс / 100 КАК ЧИСЛО(15, 2)) КАК ПенсионныйФонд,
		|	СведенияОВзносах.ПричиныМинимальнойЗП КАК ПричиныМинимальнойЗП,
		|	&СтавкаФСЗН КАК ПроцентФСЗН
		|ИЗ
		|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр2024.СведенияОВзносах КАК СведенияОВзносах
		|ГДЕ
		|	СведенияОВзносах.Ссылка = &ДокументСсылка
		|
		|УПОРЯДОЧИТЬ ПО
		|	Сотрудник,
		|	ФизЛицо,
		// + СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
		|	ВЫБОР
		|		КОГДА СведенияОВзносах.Договор.ДатаПУ IS NULL 
		|			ТОГДА ДАТАВРЕМЯ(1, 1, 1)
		|		КОГДА СведенияОВзносах.Договор.ДатаПУ = ДАТАВРЕМЯ(1, 1, 1)
		|			ТОГДА СведенияОВзносах.Договор.ДатаНачала
		|		ИНАЧЕ СведенияОВзносах.Договор.ДатаПУ
		|	КОНЕЦ, // КАК ДатаДокумента
		|	ВЫБОР
		|		КОГДА СведенияОВзносах.Договор.ДатаПУ IS NULL 
		|			ТОГДА """"
		|		КОГДА СведенияОВзносах.Договор.НомерДляПу = """"
		|			ТОГДА СведенияОВзносах.Договор.Номер
		|		ИНАЧЕ СведенияОВзносах.Договор.НомерДляПу
		|	КОНЕЦ,  // КАК НомерДокумента
		// - СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
		|	Период
		|";
		// - СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
		
		ПромежуточнаяТаблица = Запрос.Выполнить().Выгрузить();
		Возврат ПромежуточнаяТаблица;
		
	КонецФункции // ПолучитьДоходыПоВидамЗаГод	
	
	//+ СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
	Функция ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже, НомерДоговора = Неопределено, ДатаДоговора = Неопределено )
		
		ЗапросНеОплДог = Новый Запрос;
		ЗапросНеОплДог.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		ЗапросНеОплДог.Текст = "
		| ВЫБРАТЬ 
		| 	СведенияОСтаже.ФизЛицо,
		| 	СведенияОСтаже.НомерДокумента,
		| 	СведенияОСтаже.ДатаДокумента,
		//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
		|	СведенияОСтаже.ДатаДляПУ, 
		//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
		| 	ВЫРАЗИТЬ( СведенияОСтаже.ВидДеятельности КАК СТРОКА(8) ) КАК ВидДеятельности
		|   ПОМЕСТИТЬ ВтСведенияОСтаже
		| ИЗ 
		|	&СведенияОСтаже КАК СведенияОСтаже
		|;
		| ВЫБРАТЬ ПЕРВЫЕ 1
		| 	СведенияОСтаже.ФизЛицо
		| ИЗ 
		|	ВтСведенияОСтаже КАК СведенияОСтаже
		| ГДЕ 
		|	СведенияОСтаже.НомерДокумента = &НомерДокумента 
		|	И ( НАЧАЛОПЕРИОДА( СведенияОСтаже.ДатаДокумента, ДЕНЬ ) = &ДатаДокумента
		//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
		|		ИЛИ НАЧАЛОПЕРИОДА( СведенияОСтаже.ДатаДляПУ, ДЕНЬ ) = &ДатаДокумента 
		//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
		|	)
		|	И СведенияОСтаже.ФизЛицо = &ФизЛицо
		|	И СведенияОСтаже.ВидДеятельности = ""НЕОПЛДОГ""
		|";
		ЗапросНеОплДог.УстановитьПараметр( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
		ЗапросНеОплДог.УстановитьПараметр( "НомерДокумента", ?( ЗначениеЗаполнено( НомерДоговора ), НомерДоговора, СтрокаМес.НомерДокумента ) );
		ЗапросНеОплДог.УстановитьПараметр( "ДатаДокумента", НачалоДня( ?( ЗначениеЗаполнено( ДатаДоговора ), ДатаДоговора, СтрокаМес.ДатаДокумента ) ) );
		ЗапросНеОплДог.УстановитьПараметр( "СведенияОСтаже", ТЗ_СведенияОСтаже );
		ЕстьНеоплДог = НЕ ЗапросНеОплДог.Выполнить().Пустой();
		
		Возврат ЕстьНеоплДог;
		
	КонецФункции
	//- СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
	
	//+ СВЭЙ КДЯ 05.12.19 СВФР-004631 ( пункт 73. )
	Функция ЕстьПересениеСоСведениямиОСтаже( СтрокаМес, ТЗ_СведенияОСтаже )
		ЕстьПересениеСоСведениямиОСтаже = Ложь;
		
		Если ЭтотОбъект.ОбъединятьОсновные Тогда
			СтрокиСведенийОСтажеСотрудника = 
			ТЗ_СведенияОСтаже.НайтиСтроки( Новый Структура( "ФизЛицо, НомерДокумента", СтрокаМес.ФизЛицо, СтрокаМес.НомерДокумента ) );
		Иначе	
			СтрокиСведенийОСтажеСотрудника = 
			ТЗ_СведенияОСтаже.НайтиСтроки( Новый Структура( "Сотрудник, НомерДокумента", СтрокаМес.Сотрудник, СтрокаМес.НомерДокумента ) );
		КонецЕсли; 
		
		ИскПериод = СтрокаМес.Период;
		Для каждого Стр Из СтрокиСведенийОСтажеСотрудника Цикл
			
			ЕстьПересениеСоСведениямиОСтаже  = 
			ПолучитьПересечениеДиапазонов( 
			ИскПериод, , Стр.ДатаНачалаРабот, Стр.ДатаОкончанияРабот ) <> Неопределено;
			
			Если ЕстьПересениеСоСведениямиОСтаже Тогда
				Прервать;
			КонецЕсли;
			
		КонецЦикла; 
		
		Возврат ЕстьПересениеСоСведениямиОСтаже;
	КонецФункции // ЕстьПересениеСоСведениямиОСтаже
	//- СВЭЙ КДЯ 05.12.19 СВФР-004631 ( пункт 73. )
	
	
	//+ СВЭЙ КДЯ 06.12.19 СВФР-004631 ( пункт 72. )
	//если выплата пособия в месяце была, а записей о стаже нет, то добавляем такую запись
	Процедура ДобавитьЗаписьОСтажеПособие( СтрокаМес, ТЗ_СведенияОСтаже )
		
		НовСтр = ТЗ_СведенияОСтаже.Добавить();
		ЗаполнитьЗначенияСвойств( НовСтр, СтрокаМес, "Сотрудник, ФизЛицо, НомерДокумента" );
		НовСтр.ДатаНачалаРабот = СтрокаМес.Период;
		НовСтр.ДатаОкончанияРабот = СтрокаМес.Период;
		НовСтр.ВидДеятельности = "ПОСОБИЕ";
		
	КонецПроцедуры
	
	Процедура ДозаполнитьЗаписиОСтажеПособие( Пособие )
		
		ТЧ_Модифицирована = Ложь;
		СтрокиБезВыплат = СведенияОВзносах.НайтиСтроки( Новый Структура( "Выплаты", 0 ) );
		Для каждого СтрокаБезВыплат Из СтрокиБезВыплат Цикл
			Если НЕ СтрокаБезВыплат.Пособия > 0 Тогда
				Продолжить;
			КонецЕсли;
			
			
			
			Если ЭтотОбъект.ОбъединятьОсновные Тогда
				СтрокиПособиеСотрудника = 
				СведенияОСтаже.НайтиСтроки( Новый Структура( "ФизЛицо, ВидДеятельности", СтрокаБезВыплат.ФизЛицо, Пособие ) );
			Иначе	
				СтрокиПособиеСотрудника = 
				СведенияОСтаже.НайтиСтроки( Новый Структура( "Сотрудник, ВидДеятельности", СтрокаБезВыплат.Сотрудник, Пособие ) );
			КонецЕсли; 
			
			ИскПериод = СтрокаБезВыплат.Месяц;
			ЕстьПересениеСоСведениямиОСтаже = Ложь;
			Для каждого Стр Из СтрокиПособиеСотрудника Цикл
				
				ЕстьПересениеСоСведениямиОСтаже  = 
				ПолучитьПересечениеДиапазонов( 
				ИскПериод, , Стр.ДатаНачалаРабот, Стр.ДатаОкончанияРабот ) <> Неопределено;
				
				Если ЕстьПересениеСоСведениямиОСтаже Тогда
					Прервать;
				КонецЕсли;
				
			КонецЦикла; // Стр Из СтрокиПособиеСотрудника
			
			//СВЭЙ 28.08.2023 КВВ СВФР-011258 (пункт 2) (
			Если НЕ ЕстьПересениеСоСведениямиОСтаже 
				И ДогПодряда 
				И НЕ ВыгрузкаДоговоровПодрядаБезОграничения 
				И НЕ ЭтотОбъект.ОбъединятьОсновные Тогда
				ВремНетрудДляПУ3 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВРЕМНЕТРУД");
				СтрокиПособиеСотрудника = 
				СведенияОСтаже.НайтиСтроки(Новый Структура( "Сотрудник, ВидДеятельности", СтрокаБезВыплат.Сотрудник, ВремНетрудДляПУ3));
				Для каждого Стр Из СтрокиПособиеСотрудника Цикл
					
					ЕстьПересениеСоСведениямиОСтаже  = 
					ПолучитьПересечениеДиапазонов( 
					ИскПериод, , Стр.ДатаНачалаРабот, Стр.ДатаОкончанияРабот ) <> Неопределено;
					
					Если ЕстьПересениеСоСведениямиОСтаже Тогда
						Прервать;
					КонецЕсли;
				КонецЦикла;
			КонецЕсли;
			//СВЭЙ 28.08.2023 КВВ СВФР-011258 (пункт 2) )
			
			Если НЕ ЕстьПересениеСоСведениямиОСтаже Тогда
				
				//СВЭЙ 01.04.2024 КВВ СВФР-012718 (
				З = Новый Запрос;
				З.Текст = "ВЫБРАТЬ  
				|Док.Ссылка КАК ТекДок
				|ИЗ Документ.НачислениеПоБольничномуЛистуПоДоговорамПодряда КАК Док
				|ГДЕ Док.ПРОВЕДЕН = ИСТИНА
				|И Док.Сотрудник = &Сотрудник
				|И Док.Организация = &Организация
				|И Док.ДатаНачала = &Начало
				|И НАЧАЛОПЕРИОДА(Док.ДатаОкончания,ДЕНЬ) = &Окончание";
				
				Если ЗначениеЗаполнено(СтрокаБезВыплат.Договор) Тогда
					З.Текст = З.Текст + "
					|И Док.ДоговорПодряда = &ДоговорПодряда";
				КонецЕсли;
				
				З.Текст = З.Текст + "  
				|
				|ОБЪЕДИНИТЬ 
				|
				|ВЫБРАТЬ  
				|Док2.Ссылка
				|ИЗ Документ.НачислениеПоБольничномуЛисту КАК Док2
				|ГДЕ Док2.ПРОВЕДЕН = ИСТИНА
				|И Док2.Сотрудник = &Сотрудник
				|И Док2.Организация = &Организация
				|И Док2.ДатаНачала = &Начало
				|И НАЧАЛОПЕРИОДА(Док2.ДатаОкончания,ДЕНЬ) = &Окончание";
				
				Если ЗначениеЗаполнено(СтрокаБезВыплат.Договор) Тогда
					З.УстановитьПараметр("ДоговорПодряда",СтрокаБезВыплат.Договор);
				КонецЕсли;    
				З.УстановитьПараметр("Организация", Организация);
				З.УстановитьПараметр("Сотрудник", СтрокаБезВыплат.Сотрудник);
				З.УстановитьПараметр("Начало", ИскПериод);
				З.УстановитьПараметр("Окончание", ИскПериод);  
				РезЗ = З.Выполнить().Выгрузить();
				Если РезЗ.Количество() > 0 Тогда
					//СВЭЙ 01.04.2024 КВВ СВФР-012718 )
					
					НовСтр = СведенияОСтаже.Добавить();
					ЗаполнитьЗначенияСвойств( НовСтр, СтрокаБезВыплат, "Сотрудник, ФизЛицо, Договор, Категория, ВидДоговора" );
					НовСтр.ДатаНачалаРабот = ИскПериод;
					НовСтр.ДатаОкончанияРабот = ИскПериод;
					НовСтр.ВидДеятельности = Пособие;
					ТЧ_Модифицирована = Истина;
					
				КонецЕсли;
			КонецЕсли; 
			
		КонецЦикла; // СтрокаБезВыплат Из СтрокиБезВыплат
		
		Если ТЧ_Модифицирована Тогда
			
			СведенияОСтаже.Сортировать( "Сотрудник, ДатаНачалаРабот" );	
			
		КонецЕсли;
		
	КонецПроцедуры
	
	//- СВЭЙ КДЯ 06.12.19 СВФР-004631 ( пункт 72. )
	
	
	Функция СформироватьВыходнойФайл1(Отказ) Экспорт
		
		//+ СВЭЙ КДЯ 21.09.19 СВФР-004805
		ИмяФайлаПачки = ПроцедурыПерсонифицированогоУчета.ПолучитьИмяФайлаФормыПУ( 3, 
		?( Отменяющая, 2, ?( НазначениеПенсии, 3, 1 ) ), ДатаОкончания, Организация );
		//- СВЭЙ КДЯ 21.09.19 СВФР-004805 
		
		мДлинаСуток = 86400;
		ЕстьНеоплДог = Ложь;
		//+ СВЭЙ КДЯ СВФР-004631 20.08.19 ( Пункт 7. )
		Дети = Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "ДЕТИ" );
		//- СВЭЙ КДЯ СВФР-004631 20.08.19 ( Пункт 7. )
		
		// Заголовок для сообщений об ошибках проведения.
		Заголовок = ОбщегоНазначения.ПредставлениеДокументаПриПроведении(Ссылка);                  
		
		ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
		Если ВыборкаПоШапкеДокумента.Следующий()=0 тогда
			Отказ = Истина;
			Возврат "";
		КонецЕсли;	
		
		ПроверитьЗаполнениеШапки(ВыборкаПоШапкеДокумента, Отказ, Заголовок);
		Если Отказ тогда
			Возврат "";
		КонецЕсли;	
		
		//О.Т. Аверсон 14.05.2019 № 4328
		НеоплДог = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("НЕОПЛДОГ");
		Если НеоплДог.Пустая() тогда
			НеоплДогОбъект = Справочники.ОсобыеУсловияТруда.СоздатьЭлемент();
			НеоплДогОбъект.Код = "НЕОПЛДОГ";
			НеоплДогОбъект.Наименование = "Неопл.дог";
			НеоплДогОбъект.Записать();
			НеоплДог = НеоплДогОбъект.Ссылка;
		КонецЕсли;
		
		//О.Т. Аверсон 14.05.2019 № 4328
		
		//Аверсон ЕАЕ 20.07.2021 СВФР-007783
		ПрофДопДляПУ3 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПРОФДОП");
		//Аверсон СВФР-007783
		
		//Аверсон ЕАЕ 09.12.2021 СВФР-008384
		ВремНетрудДляПУ3 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВРЕМНЕТРУД");
		ТЗБольничные = ПолучитьБольничные(РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник"));
		//Аверсон СВФР-008384
		
		//Аверсон ЕАЕ 17.04.2022 СВФР-008941
		ДЕТИ0 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ0");
		ДЕТИ100 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ100");
		ДЕТИ50 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ50");
		ДПОСОБ100 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДПОСОБ100");
		ДПОСОБ50 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДПОСОБ50");
		//Аверсон СВФР-008941
		
		Результат					=	СформироватьЗапросПоРаботникиОрганизации();
		ВыборкаПоРаботникиОрганизации			=	Результат.Выбрать(ОбходРезультатаЗапроса.Прямой);
		ЗапросОрг = Новый Запрос;
		ЗапросОрг.Текст = 
		"ВЫБРАТЬ
		|	КонтактнаяИнформация.Представление,
		|	КонтактнаяИнформация.Объект
		|ИЗ
		|	РегистрСведений.КонтактнаяИнформация КАК КонтактнаяИнформация
		|ГДЕ
		|	КонтактнаяИнформация.Объект = &Объект
		|	И КонтактнаяИнформация.Тип = &Тип
		|	И КонтактнаяИнформация.Вид = &Вид
		|	И КонтактнаяИнформация.Объект.Код = &Код";
		ЗапросОрг.УстановитьПараметр("Объект", ВыборкаПоШапкеДокумента.Организация);
		ЗапросОрг.УстановитьПараметр("Тип", Перечисления.ТипыКонтактнойИнформации.Телефон);
		ЗапросОрг.УстановитьПараметр("Вид", Справочники.ВидыКонтактнойИнформации.ТелефонОрганизации);
		ЗапросОрг.УстановитьПараметр("Код", ВыборкаПоШапкеДокумента.Организация.Код);
		РезОрг = ЗапросОрг.Выполнить().Выбрать();
		ТелефонОрганизации = "_";
		Если РезОрг.Следующий() Тогда 
			ТелефонОрганизации = СтрЗаменить(СтрЗаменить(РезОрг.Представление,"(",""),")","");
		КонецЕсли;;
		
		
		ДатаНач = ДатаНачала;
		ДатаКон = ДатаОкончания;
		
		ЗапросУв = Новый Запрос; 
		ЗапросУв.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц; 
		ЗапросСтавка = Новый Запрос;
		ЗапросСтавка.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		Пока ДатаНач <= ДатаКон Цикл 
			СтрокаМес = Строка(Месяц(ДатаНач)); 		
			
			ЗапросУв.Текст = 
			"ВЫБРАТЬ
			|	РаботникиОрганизацийСрезПоследних.Период,
			|	РаботникиОрганизацийСрезПоследних.Сотрудник,
			|	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК Физлицо
			|	ПОМЕСТИТЬ ПакетУВ"+СтрокаМес+"
			|ИЗ
			|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&Период) КАК РаботникиОрганизацийСрезПоследних
			|ГДЕ
			|	РаботникиОрганизацийСрезПоследних.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций";
			
			ЗапросУв.УстановитьПараметр("Период", КонецМесяца(ДатаНач));
			
			ЗапросУв.Выполнить();    		
			
			//ЗапросСтавка.Текст = 
			//"ВЫБРАТЬ
			//|	ГражданствоФизЛицСрезПоследних.ИнаяСтавка,
			//|	ГражданствоФизЛицСрезПоследних.ФизЛицо
			//|	ПОМЕСТИТЬ ПакетГражд"+СтрокаМес+"
			//|ИЗ
			//|	РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&Период, ) КАК ГражданствоФизЛицСрезПоследних";
			//
			//ЗапросСтавка.УстановитьПараметр("Период", НачалоМесяца(ДатаНач));
			//
			//ЗапросСтавка.Выполнить(); 	
			
			ДатаНач = ДобавитьМесяц(ДатаНач,1);
		КонецЦикла;
		
		ЗапросПрием = Новый Запрос;
		ЗапросПрием.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
		ЗапросПрием.Текст = 
		"ВЫБРАТЬ
		|	РаботникиОрганизаций.Регистратор,
		|	РаботникиОрганизаций.Сотрудник как Сотрудник,
		|	РаботникиОрганизаций.Сотрудник.Физлицо КАК ФизЛицо,
		|	РаботникиОрганизаций.Период КАК Период
		|	ПОМЕСТИТЬ ВТПрием	
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|ГДЕ
		|	(РаботникиОрганизаций.Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию
		|			ИЛИ РаботникиОрганизаций.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций)
		|	И РаботникиОрганизаций.Период <= &ПериодОкончания
		//+ СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 77. )
		////О.Т. Аверсон 29.01.2018 № 1511 Доб условие на внутр совм
		//|	И РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		//- СВЭЙ КДЯ 09.12.19 СВФР-004631 ( Пункт 77. )
		|";
		
		ТЗПриемУвольнениеСотрудника = Новый ТаблицаЗначений;
		ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаПриема");
		ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаУвольнения");
		
		ЗапросПрием.УстановитьПараметр("ПериодОкончания", КонецМесяца(ДатаОкончания));
		
		ЗапросПрием.Выполнить();
		
		
		//убрал за ненадобностью	
		//Если ВыборкаПоРаботникиОрганизации.Количество()>200 тогда
		//	ОбщегоНазначения.СообщитьОбОшибке("В документе должно быть не более 200 анкет (работников)!", Отказ, Заголовок);
		//КонецЕсли;	 
		
		СписокОбработанныхАнкет = Новый СписокЗначений;
		
		ТекстФайла	=	"";
		НомерДокументаВПачке = 0;
		
		//Формируем заголовок выходного файла
		ДатаФормирования = ВыборкаПоШапкеДокумента.Дата;
		ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
		МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
		ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
		ДатаЗаполнения   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
		НомерПачки 				= ПроцедурыПерсонифицированогоУчета.НомерПачкиДокумента(ВыборкаПоШапкеДокумента.Номер);
		КоличествоДокументов 	= ВыборкаПоРаботникиОрганизации.Количество();
		
		Если Отказ тогда
			Возврат "";
		КонецЕсли;	 
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("ДокументСсылка" , Ссылка);
		Запрос.УстановитьПараметр("СписокОтчитывающихсяПодразделений", ВыборкаПоШапкеДокумента.Организация);
		Запрос.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
		Запрос.УстановитьПараметр("ДоходФСЗН", Перечисления.ДоходыФСС_НС.Облагается);
		Запрос.УстановитьПараметр("НачалоНП", НачалоГода(НачалоГода(ДобавитьМесяц(НачалоКвартала(ДатаНачала),-1)))); //ДатаРегистрации  1633
		Запрос.УстановитьПараметр("КонецНП", КонецГода(ВыборкаПоШапкеДокумента.ПериодРегистрации));// последний месяц налогового периода, за который подаём сведения
		Запрос.УстановитьПараметр("ДатаПодачиСведений", ВыборкаПоШапкеДокумента.ПериодРегистрации);// дата акуальности сведений о доходах и налогах
		Запрос.УстановитьПараметр("СпособРасчета" , Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);//О.Т. Аверсон 22.08.2018 № 2335
		Запрос.УстановитьПараметр("ОбъединятьОсновные",ОбъединятьОсновные);
		
		
		//О.Т. Аверсон 14.03.2019 № 4054 3ч
		ВидыРасчетаПремия = Новый СписокЗначений;
		ВидыРасчетаПремия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
		для Каждого стрПособ из Справочники.ГруппыРасчетов.ПремияДляПУ.Основные Цикл 
			ВидыРасчетаПремия.Добавить(стрПособ.ВидРасчета);
		КонецЦикла;  
		
		
		Запрос.УстановитьПараметр("ВидРасчетаПремия" , ВидыРасчетаПремия);
		//О.Т. Аверсон 14.03.2019 № 4054 3ч
		
		//+ СВЭЙ КДЯ 26.10.19 СВФР-004631 ( Пункт 48. )
		////О.Т. Аверсон 28.02.2019 № 3224
		//СпособыПособия = Новый СписокЗначений;
		//СпособыПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
		//для Каждого стрПособ из Справочники.ГруппыРасчетов.ДопПособияДляПУ3.Основные Цикл 
		//	СпособыПособия.Добавить(стрПособ.ВидРасчета);
		//КонецЦикла;  
		////О.Т. Аверсон 28.02.2019 № 3224
		//
		//Запрос.УстановитьПараметр("СпособРасчета" , СпособыПособия);//О.Т. Аверсон 22.08.2018 № 2335
		//- СВЭЙ КДЯ 26.10.19 СВФР-004631 ( Пункт 48. )
		
		//О.Т. Аверсон 28.02.2019 № 3224
		СпособыПособия = Новый СписокЗначений;
		СпособыПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
		для Каждого стрПособ из Справочники.ГруппыРасчетов.ДопПособияДляПУ3.Основные Цикл 
			СпособыПособия.Добавить(стрПособ.ВидРасчета);
		КонецЦикла;  
		//О.Т. Аверсон 28.02.2019 № 3224
		Запрос.УстановитьПараметр("СпособРасчета" , СпособыПособия);//О.Т. Аверсон 22.08.2018 № 2335
		
		//О.Т. Аверсон 29.08.2018 № 2363
		Если ЗначениеЗаполнено(ВидНалогообложения) Тогда 
			ОсновнойВидНалогообл = ВидНалогообложения;
		иначе
			ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
		КонецЕсли;
		//О.Т. Аверсон 29.08.2018 № 2363
		//О.Т. Аверсон 23.08.2018 № 2335
		СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ДатаРегистрации,Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
		СтавкаФСЗН = СтруктураФСЗН.Размер;
		СтруктураПенс = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(ДатаРегистрации,Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ПенсионныйФонд,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
		СтавкаПенс = СтруктураПенс.Размер;
		Запрос.УстановитьПараметр("СтавкаФСЗН", СтавкаФСЗН);
		Запрос.УстановитьПараметр("СтавкаПенс", СтавкаПенс);
		
		ПромежуточнаяТаблица = ПолучитьДоходыПоВидамЗаГод( Запрос );
		
		//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
		//Если ОбъединятьОсновные Тогда
		//	Если ВыгрузкаДоговоровПодрядаБезОграничения Тогда 
		//		ПромежуточнаяТаблица.Свернуть("ФизЛицо,Период,ПериодВзаиморасчетов, ПериодРегистрации, ВидДоговора,НомерДокумента,ДатаДокумента,ДокументОснование,ПроцентФСЗН,ПричиныМинимальнойЗП","Больничные,СуммаДохода,ФСЗН,ПенсионныйФонд");
		//	иначе
		//		ПромежуточнаяТаблица.Свернуть("ФизЛицо,Период,ПериодВзаиморасчетов, ПериодРегистрации, ВидДоговора,НомерДокумента,ДатаДокумента,ПроцентФСЗН,ПричиныМинимальнойЗП","Больничные,СуммаДохода,ФСЗН,ПенсионныйФонд");
		//	КонецЕсли;
		//иначе
		//	
		//	Если ВыгрузкаДоговоровПодрядаБезОграничения Тогда 
		//		ПромежуточнаяТаблица.Свернуть("Сотрудник,ФизЛицо,Период, ПериодВзаиморасчетов, ПериодРегистрации, ВидДоговора,НомерДокумента,ДатаДокумента,ДокументОснование,ПроцентФСЗН,ПричиныМинимальнойЗП","Больничные,СуммаДохода,ФСЗН,ПенсионныйФонд");
		//	иначе
		//		ПромежуточнаяТаблица.Свернуть("Сотрудник,ФизЛицо,Период, ПериодВзаиморасчетов, ПериодРегистрации, ВидДоговора,НомерДокумента,ДатаДокумента,ПроцентФСЗН,ПричиныМинимальнойЗП","Больничные,СуммаДохода,ФСЗН,ПенсионныйФонд");
		//	КонецЕсли;
		//КонецЕсли;
		//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
		
		// + СВЭЙ КДЯ 31.07.19 СВФР-004561
		Для каждого Стр Из ПромежуточнаяТаблица Цикл
			Стр.НомерДокумента = СокрЛП( Стр.НомерДокумента );	
		КонецЦикла;
		// + СВЭЙ КДЯ 14.08.19 СВФР-004631 ( Пункт 11. )
		//Если ВыгрузкаДоговоровПодрядаБезОграничения Тогда
		//	КолонкиГруппировок = "ФизЛицо, Период, ПериодВзаиморасчетов, ПериодРегистрации, ПроцентФСЗН, ВидДоговора, НомерДокумента, ДатаДокумента, ДокументОснование, ПричиныМинимальнойЗП";
		//Иначе
		//	КолонкиГруппировок = "ФизЛицо, Период, ПериодВзаиморасчетов, ПериодРегистрации, ПроцентФСЗН, ВидДоговора, НомерДокумента, ДатаДокумента, ПричиныМинимальнойЗП";
		//КонецЕсли;
		// - СВЭЙ КДЯ 14.08.19 СВФР-004631 ( Пункт 11. )
		// + СВЭЙ КДЯ 14.08.19 СВФР-004631 ( Пункт 11. )
		КолонкиГруппировок =
		?( ОбъединятьОсновные, "", "Сотрудник, " )
		+ "ФизЛицо, Период, ПериодВзаиморасчетов, ПериодРегистрации, ПроцентФСЗН, ВидДоговора, НомерДокумента, ДатаДокумента, ПричиныМинимальнойЗП"
		
		//Аверсон ЕАЕ 07.04.2021 СВФР-006959
		//+ ?( ВыгрузкаДоговоровПодрядаБезОграничения, ", ДокументОснование", "" );
		+ ", ДокументОснование";
		//Аверсон СВФР-006959
		
		// - СВЭЙ КДЯ 14.08.19 СВФР-004631 ( Пункт 11. )
		КолонкиСуммирования = "Больничные, СуммаДохода, ПенсионныйФонд, ФСЗН";
		ПромежуточнаяТаблица.Свернуть( КолонкиГруппировок, КолонкиСуммирования );
		// - СВЭЙ КДЯ 31.07.19 СВФР-004561
		
		
		ПТДопСведОстаже = ПолучитьДанныеДляЗаполненияСтажа(ВыборкаПоШапкеДокумента.Организация, ВыборкаПоШапкеДокумента.ПериодРегистрации);
		// + СВЭЙ КДЯ 31.07.19 СВФР-004561
		Для каждого Стр Из ПТДопСведОстаже Цикл
			Стр.НомерДокумента = СокрЛП( Стр.НомерДокумента );
			Если Стр.ВидДейтельности = "СТРАХСЛУЧ" Тогда
				НайдСтроки = ПромежуточнаяТаблица.НайтиСтроки(
				Новый Структура( "ФизЛицо, Период", Стр.ФизЛицо, НачалоМесяца( Стр.НачалоРабот ) ) );
				Для каждого НайдСтрока Из НайдСтроки Цикл
					НайдСтрока.Больничные = 0;	
				КонецЦикла;   
			КонецЕсли;
		КонецЦикла; 
		
		//Аверсон ЕАЕ 10.12.2021 СВФР-008384
		//из промежуточной таблицы вычтем суммы больничных, которые были после увольнения
		//чтобы вынести их отдельно
		Для Каждого Стр Из ПромежуточнаяТаблица Цикл
			СтруктураБольничный = Новый Структура;
			СтруктураБольничный.Вставить("ФизЛицо", Стр.ФизЛицо);
			СтруктураБольничный.Вставить("НачалоМесяца", НачалоМесяца(Стр.ПериодРегистрации));
			СтруктураБольничный.Вставить("ЭтоБольничныйПослеУвольнения", Истина);
			НайдСтрокиБольничный = ТЗБольничные.НайтиСтроки(СтруктураБольничный);
			
			Для Каждого СтрБольничный Из НайдСтрокиБольничный Цикл
				Стр.Больничные = Стр.Больничные - СтрБольничный.Результат;
			КонецЦикла;
		КонецЦикла;
		//Аверсон СВФР-008384
		
		// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
		//КолонкиГруппировок = "Сотрудник, ФизЛицо, ВидДейтельности, ВидДоговора, ДатаДляПУ, ДатаДокумента, НомерДокумента, НачалоРабот, ОкончаниеРабот";
		// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
		// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
		КолонкиГруппировок =
		?( ОбъединятьОсновные, "", "Сотрудник, " )
		
		//Аверсон ЕАЕ 07.04.2021 СВФР-006959
		//+ "ФизЛицо, ВидДейтельности, ВидДоговора, ДатаДляПУ, ДатаДокумента, НомерДокумента, НачалоРабот, ОкончаниеРабот";
		+ "ФизЛицо, ВидДейтельности, ВидДоговора, ДатаДляПУ, ДатаДокумента, НомерДокумента, НачалоРабот, ОкончаниеРабот";
		//Аверсон СВФР-006959
		
		// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
		КолонкиСуммирования = "";
		ПТДопСведОстаже.Свернуть( КолонкиГруппировок, КолонкиСуммирования ); // сворачиваем дубли
		
		// сворачиваем строки, образующие хронологические звенья, в одну строку для каждого договора
		ПТДопСведОстажеКопия = ПТДопСведОстаже.Скопировать(); //работаем с копией ТЗ, т.к. исходную ТЗ будем менять в цикле
		Отбор = Новый Структура( "ФизЛицо, ВидДейтельности, ВидДоговора, ДатаДляПУ, ДатаДокумента, НомерДокумента" 
		+ ?( ОбъединятьОсновные, "", ", Сотрудник" )  //+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
		);
		
		// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
		//ТЗ_ФизЛиц = ПТДопСведОстаже.Скопировать( Новый Структура( "ВидДейтельности", "ДОГОВОР" ) );
		//ТЗ_ФизЛиц.Свернуть( "ФизЛицо, ВидДейтельности" );
		//ОтборФЛ = Новый Структура( "ФизЛицо, ВидДейтельности" );
		// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
		// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
		ТЗ_ФизЛиц = ПТДопСведОстаже.Скопировать();
		ИменаКолонокХроноЦепочки = "ФизЛицо, ВидДейтельности, НомерДокумента, ДатаДокумента" //Аверсон ЕАЕ 17.02.2023 СВФР-010250 (ДатаДокумента)
		+ ?( ОбъединятьОсновные, "", ", Сотрудник" )  //+ СВЭЙ КДЯ 11.12.19 СВФР-004631 ( Пункт 83. )
		;
		
		ТЗ_ФизЛиц.Свернуть( ИменаКолонокХроноЦепочки );
		ОтборФЛ = Новый Структура( ИменаКолонокХроноЦепочки );
		// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
		ТребуемыеРасшифровкиПересекающихсяДоговоров = ПТДопСведОстаже.СкопироватьКолонки();
		
		НеобходимоСвернуть = Ложь;
		Для каждого СтрФЛ Из ТЗ_ФизЛиц Цикл
			
			//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 9. )
			Если СтрФЛ.ВидДейтельности = "ПРЕМИЯ" Тогда
				Продолжить;	
			КонецЕсли; 
			//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 9. )
			
			ЗаполнитьЗначенияСвойств( ОтборФЛ, СтрФЛ );
			СтрокиФЛ = ПТДопСведОстаже.НайтиСтроки( ОтборФЛ );
			Если СтрокиФЛ.Количество() <= 1 Тогда
				Продолжить;	
			КонецЕсли; 
			
			Для каждого Стр Из СтрокиФЛ Цикл
				
				ЗаполнитьЗначенияСвойств( Отбор, Стр );
				СтрокиДубли = ПТДопСведОстажеКопия.НайтиСтроки( Отбор );
				Если СтрокиДубли.Количество() <= 1 Тогда
					Продолжить;	
				КонецЕсли; 
				
				ДублиБылиОткорректированы = Истина;
				Пока ДублиБылиОткорректированы Цикл
					ДублиБылиОткорректированы = Ложь;
					
					Для каждого СтрокаДубль Из СтрокиДубли Цикл
						Если ПТДопСведОстаже.Индекс( Стр ) = ПТДопСведОстажеКопия.Индекс( СтрокаДубль ) 
							ИЛИ СтрокаДубль.НачалоРабот > СтрокаДубль.ОкончаниеРабот Тогда
							Продолжить;	
						КонецЕсли; 
						Если ( СтрокаДубль.ОкончаниеРабот + мДлинаСуток ) = Стр.НачалоРабот Тогда
							Стр.НачалоРабот	= СтрокаДубль.НачалоРабот;
							ДублиБылиОткорректированы = Истина;
							Продолжить;
						КонецЕсли;
						Если ( Стр.ОкончаниеРабот + мДлинаСуток ) = СтрокаДубль.НачалоРабот Тогда
							Стр.ОкончаниеРабот	= СтрокаДубль.ОкончаниеРабот;
							ДублиБылиОткорректированы = Истина;
						КонецЕсли;
					КонецЦикла; // СтрокаДубль Из СтрокиДубли
					
					Если ДублиБылиОткорректированы Тогда
						НеобходимоСвернуть = Истина;
					КонецЕсли;
				КонецЦикла; // ДублиБылиОткорректированы
				
			КонецЦикла; // Стр Из СтрокиФЛ
		КонецЦикла; // СтрФЛ Из ТЗ_ФизЛиц
		
		
		Если НеобходимоСвернуть Тогда
			ПТДопСведОстаже.Свернуть( КолонкиГруппировок, КолонкиСуммирования );
		КонецЕсли;
		ПТДопСведОстажеКопия = Неопределено;
		
		//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
		////+ СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		//Если НЕ ( ЭтотОбъект.ДогПодряда И ЭтотОбъект.ОбъединятьОсновные ) Тогда
		////- СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
		
		//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
		Если ДогПодряда или ВсеСотрудники Тогда
			//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
			
			// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 34. )
			КолонкиРасшифровок = "ФизЛицо, ВидДейтельности";
			ОтборФЛРасш =  Новый Структура( КолонкиРасшифровок );
			ТЗ_ФизЛицРасш = ТЗ_ФизЛиц.Скопировать( Новый Структура( "ВидДейтельности", "ДОГОВОР" ) );
			ТЗ_ФизЛицРасш.Свернуть( КолонкиРасшифровок );
			// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 34. )
			
			
			Для каждого СтрФЛ Из ТЗ_ФизЛицРасш Цикл
				
				ЗаполнитьЗначенияСвойств( ОтборФЛРасш, СтрФЛ );
				СтрокиФЛ = ПТДопСведОстаже.НайтиСтроки( ОтборФЛРасш );
				Если СтрокиФЛ.Количество() <= 1 Тогда
					Продолжить;	
				КонецЕсли; 
				
				Для каждого Стр Из СтрокиФЛ Цикл
					Для каждого СтрКопия Из СтрокиФЛ Цикл
						Если Стр = СтрКопия 
							//+ СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
							ИЛИ НЕ ЗначениеЗаполнено( Стр.НомерДокумента )
							//- СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
							//+ СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 34. )
							ИЛИ ПТДопСведОстаже.Индекс( Стр ) > ПТДопСведОстаже.Индекс( СтрКопия ) Тогда
							//- СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 34. )
							Продолжить;	
						КонецЕсли;
						Диапазон = ПолучитьПересечениеДиапазонов( 
						Стр.НачалоРабот, Стр.ОкончаниеРабот, СтрКопия.НачалоРабот, СтрКопия.ОкончаниеРабот );
						Если Диапазон <> Неопределено Тогда
							ДатаНач = Макс( Диапазон.Начало, ДатаНачала );
							ДатаКон = Мин( Диапазон.Окончание, ДатаОкончания );
							Пока ДатаНач <= ДатаКон Цикл
								НовРасш = ТребуемыеРасшифровкиПересекающихсяДоговоров.Добавить();
								ЗаполнитьЗначенияСвойств( НовРасш, Стр, "ФизЛицо, НачалоРабот, ОкончаниеРабот" );
								НовРасш.НачалоРабот = Макс( Стр.НачалоРабот, НачалоМесяца( ДатаНач ) );
								НовРасш.ОкончаниеРабот = Мин( Стр.ОкончаниеРабот, КонецМесяца( ДатаНач ) );
								
								ДатаНач = ДобавитьМесяц( ДатаНач, 1 );
							КонецЦикла;
						КонецЕсли; 
					КонецЦикла; // СтрКопия Из ПТДопСведОстаже
				КонецЦикла; // Стр Из СтрокиФЛ
				
			КонецЦикла; // СтрФЛ Из ТЗ_ФизЛиц
			
			//+ СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		КонецЕсли; // ДогПодряда или ВсеСотрудники 
		//- СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		
		
		ЕстьРасшифровкиДоговоров = ТребуемыеРасшифровкиПересекающихсяДоговоров.Количество() > 0;
		Если ЕстьРасшифровкиДоговоров Тогда
			ТребуемыеРасшифровкиПересекающихсяДоговоров.Свернуть( "ФизЛицо, НачалоРабот, ОкончаниеРабот" );
			ПромежуточнаяТаблица = ПолучитьРасшифрованнуюПромежуточнуюТаблицу( ПромежуточнаяТаблица, ТребуемыеРасшифровкиПересекающихсяДоговоров );
		КонецЕсли;
		
		ИтогиПоДоговорам = ПромежуточнаяТаблица.Скопировать();
		ИтогиПоДоговорам.Свернуть( "НомерДокумента, ДатаДокумента", "СуммаДохода, Больничные, ФСЗН, ПенсионныйФонд" );
		// - СВЭЙ КДЯ 31.07.19 СВФР-004561
		
		// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
		ТЗ_СведенияОСтаже = ПТДопСведОстаже.Скопировать();
		ТЗ_СведенияОСтаже.Колонки[ "ВидДейтельности"].Имя = "ВидДеятельности";
		ТЗ_СведенияОСтаже.Колонки[ "НачалоРабот"].Имя = "ДатаНачалаРабот";
		ТЗ_СведенияОСтаже.Колонки[ "ОкончаниеРабот"].Имя = "ДатаОкончанияРабот";
		
		// + СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		//УдаляемыеСтрокиВзносыВрем = ПТДопСведОстаже.НайтиСтроки(
		//		Новый Структура( "ВидДейтельности", "ВЗНОСЫВРЕМ" )  );
		//Для каждого УдаляемаяСтрокаВзносыВрем Из УдаляемыеСтрокиВзносыВрем Цикл
		//
		//	ПТДопСведОстаже.Удалить( УдаляемаяСтрокаВзносыВрем );	
		//
		//КонецЦикла; 		
		// - СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
		// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
		
		
		ТекстФайла = Новый ТекстовыйДокумент;
		//О.Т. Аверсон 01.04.2019 № 4182
		если ДатаНачала>=Дата(2019,01,01) Тогда 
			ТекстФайла.ДобавитьСтроку("ЗГЛВ=1.7=");
		иначе
			текстФайла.ДобавитьСтроку("ЗГЛВ=1.6="); 
		КонецЕсли;
		//О.Т. Аверсон 01.04.2019 № 4182
		
		//Островская Татьяна 25.10.2012 № 15
		ТекстФайла.ДобавитьСтроку(Врег("<ПАЧК="+?(СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)= "", " ",СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)) +"="+?(СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР)= ""," ",СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР))+
		"="+?(СокрЛП(ВыборкаПоШапкедокумента.организация.НаименованиеПолное) = ""," ",СокрЛП(ВыборкаПоШапкедокумента.организация.НаименованиеПолное))+"="
		//+ СВЭЙ КДЯ 21.10.19 СВФР-004944
		//+ Прав( ВыборкаПоШапкеДокумента.Номер, 5 )
		//- СВЭЙ КДЯ 21.10.19 СВФР-004944
		//+ СВЭЙ КДЯ 21.10.19 СВФР-004944
		+ Лев( ИмяФайлаПачки, СтрДлина( ИмяФайлаПачки ) - 4 )
		//- СВЭЙ КДЯ 21.10.19 СВФР-004944
		+ "= = =1=" ) );
		
		//Островская Татьяна 25.10.2012 № 15
		ТекстФайла.ДобавитьСтроку("ТИПД=ПУ-3=1= = = =>");
		
		//ТекстФайла.ДобавитьСтроку("<ПУ-3=И="+СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР)+"= = ="+СокрЛП(Строка(КоличествоДокументов))+"= = = = =");
		//Островская Татьяна 07.02.2014 № 17089
		если НазначениеПенсии Тогда
			СтрокаПУ3 = "<ПУ-3=П=";
		ИначеЕсли Корректирующая Тогда 
			СтрокаПУ3 = "<ПУ-3=К=";
		ИначеЕсли Отменяющая Тогда //О.Т. Аверсон 06.02.2018 № 1550
			СтрокаПУ3 = "<ПУ-3=О=";
		иначе
			СтрокаПУ3 = "<ПУ-3=И=";
		КонецЕсли;
		
		ТипЗаписи    = СтрокаПУ3+?(СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР) = ""," ",СокрЛП(ВыборкаПоШапкеДокумента.Организация.РегистрационныйНомерПФР)) +"=";
		//Островская Татьяна 07.02.2014 № 17089
		ТекСтрока = 3;
		ИтогДохода = 0;
		ИтогБольн = 0;
		ИтогВзнос = 0;
		ИтогВзнос1 = 0;
		ИтогВзнос2 = 0;
		ИтогВзнос3 = 0;
		РаботДоходСлед =0;
		РаботБольнСлед = 0;
		РаботВзносСлед =0;
		РаботВзносСлед1 =0;
		РаботВзносСлед2 =0;
		РаботВзносСлед3 =0;
		РаботДоход = 0;
		РаботБольн = 0;
		РаботВзнос = 0;
		РаботВзнос1 = 0;//Островская Татьяна 17.01.2014 № 17051
		РаботВзнос2 = 0;
		РаботВзнос3 = 0;
		СтрокаЗамены = 3;
		
		//толик контрольный файл дбф
		
		Дбф=Новый XBase();
		Дбф.Кодировка=КодировкаXBase.OEM;
		Дбф.Поля.Добавить("FIO", "S", 50);
		Дбф.Поля.Добавить("Datr", "D");
		Дбф.Поля.Добавить("Dato", "D");
		Дбф.Поля.Добавить("Sm", "N", 12);
		Дбф.Поля.Добавить("Bl", "N", 12);
		Дбф.Поля.Добавить("Vz", "N", 12);
		//Островская Татьяна 22.02.2013 № 16256 Островская Татьяна 27.05.2014 № 17388
		ПутьКФайлу = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация",Организация)).ПутьДляВыгрузкиПУ12;
		если ЗначениеЗаполнено(ПутьКФайлу) Тогда 
			Дбф.СоздатьФайл(ПутьКФайлу+"\VznosyF.DBF");
		иначе
			РабочийКаталог = СтрокаСоединенияИнформационнойБазы();
			б = Сред(РабочийКаталог,7);
			в = Найти(б,Символ(34));
			путьИБ = Лев(б, в-1);
			
			Дбф.СоздатьФайл(путьИБ+"\VznosyF.DBF");
		КонецЕсли;
		//Островская Татьяна 22.02.2013 № 16256 Островская Татьяна 27.05.2014 № 17388
		
		//О.Т. Аверсон 28.02.2018 № 1448				
		ЗапросКоррект = Новый Запрос;
		ЗапросКоррект.Текст = 
		"ВЫБРАТЬ
		|	КорректировкаФСЗН.СуммаКорректировки
		|ИЗ
		|	РегистрСведений.КорректировкаФСЗН КАК КорректировкаФСЗН
		|ГДЕ
		|	КорректировкаФСЗН.Период МЕЖДУ &НачалоНП И &КонецНП
		|   И КорректировкаФСЗН.Организация = &Организация";  //Аверсон 17.07.2020 КВВ СВФР-006279
		
		ЗапросКоррект.УстановитьПараметр("НачалоНП", НачалоГода(НачалоГода(ДобавитьМесяц(НачалоКвартала(ДатаНачала),-1)))); //ДатаРегистрации  1633
		ЗапросКоррект.УстановитьПараметр("КонецНП", КонецГода(ВыборкаПоШапкеДокумента.ПериодРегистрации));// последний месяц налогового периода, за который подаём сведения
		ЗапросКоррект.УстановитьПараметр("Организация", Организация); //Аверсон 17.07.2020 КВВ СВФР-006279
		
		РезультатЗапросаКорр = ЗапросКоррект.Выполнить();
		
		ВыборкаДетальныеЗаписиКорр = РезультатЗапросаКорр.Выбрать();
		СуммаКорректировки = 0;
		Пока ВыборкаДетальныеЗаписиКорр.Следующий() Цикл
			СуммаКорректировки = СуммаКорректировки + ВыборкаДетальныеЗаписиКорр.СуммаКорректировки;
		КонецЦикла;         
		ТЗСотрудники = ПромежуточнаяТаблица.Скопировать();
		Если ОбъединятьОсновные Тогда 
			ТЗСотрудники.Свернуть("ФизЛицо,Период");
		иначе
			ТЗСотрудники.Свернуть("Сотрудник,ФизЛицо,Период");
		КонецЕсли;
		ТЗСотрудники.Колонки.Добавить("СуммаКорректировки");
		ОбщееКолКопеек001 = Макс(СуммаКорректировки / 0.01,-СуммаКорректировки / 0.01);
		КолКопеек001 = Макс(СуммаКорректировки / 0.01,-СуммаКорректировки / 0.01);
		Для Каждого стр из ТЗСотрудники Цикл 
			стр.СуммаКорректировки = ?(ЗначениеЗаполнено(ОбщееКолКопеек001),СуммаКорректировки/ОбщееКолКопеек001,0);
			КолКопеек001 = КолКопеек001 - 1;
			Если КолКопеек001 = 0 Тогда 
				Прервать;
			КонецЕсли;
			
		КонецЦикла;
		
		КолСотрудников = ТЗСотрудники.Количество();
		//Макс((СуммаКорректировки / 0.01) - КолСотрудников,0);
		//О.Т. Аверсон 28.02.2018 № 1448
		
		ПенсияВыгружена = Ложь; //Островская Татьяна 20.01.2014 № 17051
		ДетиВыгружена = Ложь;
		ПособиеВыгружена = Ложь;//Островская Татьяна 05.03.2014 № 17172
		ПремияВыгружена = Ложь;
		ВзносыВрВыгружена = Ложь;//Островская Татьяна 05.03.2014 № 17172
		СтрахСлучВыгружена = Ложь; //О.Т. Аверсон 21.05.2018 № 1985
		
		//Аверсон ЕАЕ 21.07.2021 СВФР-007783
		ПрофДопВыгружена = Ложь;
		//Аверсон СВФР-007783
		
		//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
		//ДетиЕсть = Ложь;
		//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
		ТекСтрокаДляСтрПУ = ТекСтрока;
		Пока ВыборкаПоРаботникиОрганизации.Следующий()	Цикл
			
			//Аверсон ЕАЕ 09.08.2022 СВФР-009387
			//Получаем изменения группы инвалидности с I(II) на III
			МассивИнвалидность = ПолучитьИзмененияГруппыИнвалидности(ВыборкаПоРаботникиОрганизации.ФизЛицо);
			//Аверсон СВФР-009387
			
			//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
			ЗначениеКв = "";
			//- СВЭЙ КДЯ 25.07.19 СВФР-004561
			ПенсияВыгружена = Ложь; //Островская Татьяна 20.01.2014 № 17051
			ДетиВыгружена = Ложь;
			ПособиеВыгружена = Ложь;//Островская Татьяна 05.03.2014 № 17172
			ПремияВыгружена = Ложь;
			ВзносыВрВыгружена = Ложь;//Островская Татьяна 05.03.2014 № 17172
			СтрахСлучВыгружена = Ложь;//О.Т. Аверсон 21.05.2018 № 1985
			
			//Аверсон ЕАЕ 21.07.2021 СВФР-007783
			ПрофДопВыгружена = Ложь;
			//Аверсон СВФР-007783
			
			//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
			//ДетиЕсть = Ложь;
			//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
			ПериодДляДоговора = "";
			//Контроль дубля строк
			СчДляПУ = 0;
			ТипЗаписиНач = "НЧСЛ=";
			Структура = Новый Структура;
			Структура.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
			Если не ОбъединятьОсновные Тогда 
				Структура.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
			КонецЕсли;
			
			//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
			//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Неопределено Тогда 
			//	Структура.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
			//Иначе 
			//	Структура.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
			//КонецЕсли;
			//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
			//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
			Структура.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
			//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
			
			СтрокиПоРаботнику = ПромежуточнаяТаблица.НайтиСтроки( Структура );
			
			РаботДоходСлед = 0;	
			РаботБольнСлед = 0;
			РаботВзносСлед = 0;
			РаботВзносСлед1 = 0;
			РаботВзносСлед2 = 0;
			РаботВзносСлед3 = 0;
			КоличествоЗаписейОСтаже = 0;
			Если СтрокиПоРаботнику.Количество()<> 0 тогда
				
				РаботДоход = 0;
				РаботБольн = 0;
				РаботВзнос = 0;
				РаботВзнос1 = 0; //Островская Татьяна 17.01.2014 № 17051
				РаботВзнос2 = 0;
				РаботВзнос3 = 0;
				СтрокаФайла = ТипЗаписи;
				//Инициалы должны быть указаны
				Фамилия = ВРег(?(ВыборкаПоРаботникиОрганизации.Фамилия = "", " ", СокрЛП(ВыборкаПоРаботникиОрганизации.Фамилия)));
				Имя = Врег(?(ВыборкаПоРаботникиОрганизации.Имя = "", " ", Лев(СокрЛП(ВыборкаПоРаботникиОрганизации.Имя),1)));
				Отчество = Врег(?(ВыборкаПоРаботникиОрганизации.Отчество = "", " ", Лев(СокрЛП(ВыборкаПоРаботникиОрганизации.Отчество),1)));
				Категория =?(ВыборкаПоРаботникиОрганизации.Категория = "", "01", СокрЛП(ВыборкаПоРаботникиОрганизации.Категория));
				//толик			СтрокаФайла = СтрокаФайла+СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)+"="+Фамилия+"="+Имя+"="+Отчество+"="+Категория+"=";
				СтрокаЗар = "";
				//Островская Татьяна 02.11.2012 № 15
				если ЗначениеЗаполнено(ВыборкаПоРаботникиОрганизации.ВидДоговора) Тогда 
					КатегорияВывод = "ДОГОВОР";
				ИНАЧЕ
					КатегорияВывод = "";
				КонецЕсли;
				
				//+ СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
				
				//Аверсон ЕАЕ 13.02.2023 СВФР-010250
				//НомераДоговоровСОшибками = Новый Массив;
				НомераДоговоровСОшибками = Новый ТаблицаЗначений;
				НомераДоговоровСОшибками.Колонки.Добавить("НомерДокумента");
				НомераДоговоровСОшибками.Колонки.Добавить("ДатаДокумента");
				//Аверсон СВФР-010250
				
				//- СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
				
				//О.Т. Аверсон 05.04.2019 № 4187
				НевернаЗапись = Ложь;
				Если КатегорияВывод = "ДОГОВОР" Тогда
					Для Каждого стрДог из СтрокиПоРаботнику Цикл
						
						//+ СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
						
						//Аверсон ЕАЕ 13.02.2023 СВФР-010250
						//Если НомераДоговоровСОшибками.Найти( стрДог.НомерДокумента ) <> Неопределено Тогда
						СтруктураПоиска = Новый Структура;
						СтруктураПоиска.Вставить("НомерДокумента", стрДог.НомерДокумента);
						СтруктураПоиска.Вставить("ДатаДокумента", стрДог.ДатаДокумента);
						НужныеСтроки = НомераДоговоровСОшибками.НайтиСтроки(СтруктураПоиска);
						Если НужныеСтроки.Количество() > 0 Тогда
							//Аверсон СВФР-010250
							
							Продолжить;	
						КонецЕсли;
						//- СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
						
						Если ОбъединятьОсновные Тогда 
							//Аверсон ЕАЕ 13.02.2023 СВФР-010250
							//СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо,НомерДокумента",ВыборкаПоРаботникиОрганизации.ФизЛицо,стрДог.НомерДокумента));
							СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо,НомерДокумента,ДатаДокумента",ВыборкаПоРаботникиОрганизации.ФизЛицо,стрДог.НомерДокумента,стрДог.ДатаДокумента));
							//Аверсон СВФР-010250
						иначе
							//Аверсон ЕАЕ 13.02.2023 СВФР-010250
							//СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник,НомерДокумента",ВыборкаПоРаботникиОрганизации.Сотрудник,стрДог.НомерДокумента));
							СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник,НомерДокумента,ДатаДокумента",ВыборкаПоРаботникиОрганизации.Сотрудник,стрДог.НомерДокумента,стрДог.ДатаДокумента));
							//Аверсон СВФР-010250
						КонецЕсли;
						
						Для Каждого СтрСведОСтаже из СтрокиПоРаб Цикл    							
							
							//+ СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
							
							//Аверсон ЕАЕ 13.02.2023 СВФР-010250
							//Если НомераДоговоровСОшибками.Найти( СтрСведОСтаже.НомерДокумента ) <> Неопределено Тогда
							СтруктураПоиска = Новый Структура;
							СтруктураПоиска.Вставить("НомерДокумента", СтрСведОСтаже.НомерДокумента);
							СтруктураПоиска.Вставить("ДатаДокумента", СтрСведОСтаже.ДатаДокумента);
							НужныеСтроки = НомераДоговоровСОшибками.НайтиСтроки(СтруктураПоиска);
							Если НужныеСтроки.Количество() > 0 Тогда
								//Аверсон СВФР-010250
								
								Продолжить;	
							КонецЕсли;
							//- СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
							
							Если СтрСведОСтаже.НачалоРабот < стрДог.ДатаДокумента Тогда 
								Сообщить( "По сотруднику " + ВыборкаПоРаботникиОрганизации.ФизЛицо.Наименование
								+ " в договоре №" + СокрЛП( СтрСведОСтаже.НомерДокумента ) 
								+ " неверно заполнен реквизит - Дата для ПУ!" );
								НевернаЗапись = Истина;
								
								//+ СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
								
								//Аверсон ЕАЕ 13.02.2023 СВФР-010250
								//НомераДоговоровСОшибками.Добавить( СтрСведОСтаже.НомерДокумента );
								НоваяСтр = НомераДоговоровСОшибками.Добавить();
								НоваяСтр.НомерДокумента = СтрСведОСтаже.НомерДокумента;
								НоваяСтр.ДатаДокумента = СтрСведОСтаже.ДатаДокумента;
								//Аверсон СВФР-010250
								
								//- СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
								
								Прервать;
							КонецЕсли;  							
						КонецЦикла;
						если НевернаЗапись Тогда 
							//+ СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
							//Прервать;
							//- СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
							//+ СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
							Продолжить;
							//- СВЭЙ КДЯ 06.11.19 СВФР-004631 ( Пункт 64. ) СВФР-004969 ( Пункт 12. )
						КонецЕсли;
					КонецЦикла; 
					если НевернаЗапись Тогда 
						Продолжить;
					КонецЕсли;
					
				КонецЕсли;
				//О.Т. Аверсон 05.04.2019 № 4187
				
				//Островская Татьяна 03.02.2014 № 17051
				СтрокаДети = СведенияОСтаже.НайтиСтроки(Структура);
				КатегорияДети = "";
				для Каждого СтрДети из СтрокаДети Цикл 
					//+ СВЭЙ КДЯ СВФР-004631 20.08.19 ( Пункт 7. )
					//если СтрДети.ВидДеятельности = "ДЕТИ" Тогда 
					//- СВЭЙ КДЯ СВФР-004631 20.08.19 ( Пункт 7. )
					//+ СВЭЙ КДЯ СВФР-004631 20.08.19 ( Пункт 7. )
					если СтрДети.ВидДеятельности = Дети Тогда 
						//- СВЭЙ КДЯ СВФР-004631 20.08.19 ( Пункт 7. )
						КатегорияДети = "ДЕТИ";
						Прервать; // СВЭЙ КДЯ СВФР-004561 31.07.19
					КонецЕсли;
				КонецЦикла;
				
				//Островская Татьяна 03.02.2014 № 17051
				Структура = Новый Структура;
				Если не ОбъединятьОсновные Тогда 
					Структура.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
				КонецЕсли;
				Структура.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
				
				//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Неопределено Тогда 
				//	Структура.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
				//Иначе 
				//	Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
				//КонецЕсли;
				//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				Структура.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
				//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				
				Если ОбъединятьОсновные Тогда 
					СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо));
				иначе
					СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник));
				КонецЕсли;
				ЕстьВидРасчета = Ложь;
				Для каждого СтрДог из СтрокиПоРаб цикл
					если не СокрЛП(СтрДог.ВидДейтельности) = "" Тогда
						ЕстьВидРасчета = Истина;
						Прервать; // СВЭЙ КДЯ СВФР-004561 31.07.19
					КонецЕсли;
				КонецЦикла;
				Если ОбъединятьОсновные Тогда 
					СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо));
				иначе
					СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник));
				КонецЕсли;
				Для каждого СтрДог из СтрокиПоРаб цикл 
					если ЕстьВидРасчета Тогда 
						если СокрЛП(СтрДог.ВидДейтельности) = "" Тогда
							Продолжить;
						КонецЕсли;
					КонецЕсли;
					
					
					если КатегорияВывод= "ДОГОВОР"  Тогда 
						
						СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"03"+"=";
					Иначе 
						СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"01"+"=";
						
					КонецЕсли;
					
					Прервать;
					
				КонецЦикла;
				
				Если СтрокиПоРаб.Количество()=0 Тогда 
					СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"01"+"=";
					Сообщить("Данные не найдены по сотруднику "+ВыборкаПоРаботникиОрганизации.ФизЛицо.Наименование);					
				КонецЕсли;
				
				//Островская Татьяна 02.11.2012 № 15
				Если Отказ Тогда
					Продолжить;
				КонецЕсли;                     
				
				НомерДокументаВПачке = 	НомерДокументаВПачке + 1;
				
				//Берем запись с пустыми полями
				//Запись = ПолучитьСтруктуруЗаписи(ТаблицаФорматаЗаписи);
				
				НомерДокументаВПачке = НомерДокументаВПачке;
				ТекстФайла.ДобавитьСтроку(СтрокаФайла);
				ТекСтрока = ТекСтрока+1;
				СтрокаЗамены = ТекСтрока;
				
				КоличествоМес = 0;
				СтрокаДатаДокумента = "";
				СтрокаНомерДокумента = "";
				СтрМес = 1;
				СтрокаФайла1 = "";
				Сч =0;
				СтрокиПоРаботнику1 = ПромежуточнаяТаблица.НайтиСтроки(Структура);
				СтрВзнСл = 0;
				СтрВзнСл1 = 0;
				СтрВзнСл2 = 0;
				СтрВзнСл3 = 0;
				СтрБлнСл = 0;
				РаботДоходСл = 0;
				Колич = СтрокиПоРаботнику1.Количество();
				ДатаНач = ДатаНачала;
				ДатаКон = ДатаОкончания;
				//ЗапросСотр = Новый Запрос;
				//
				//ЗапросСотр.УстановитьПараметр("Физлицо",				ВыборкаПоРаботникиОрганизации.ФизЛицо);
				//ЗапросСотр.УстановитьПараметр("ГоловнаяОрганизация",	Организация);
				//
				//ЗапросСотр.Текст =
				//"ВЫБРАТЬ
				//|	СотрудникиОрганизаций.Ссылка,
				//|	ВЫБОР
				//|		КОГДА СотрудникиОрганизаций.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Контракт)
				//|			ТОГДА 1
				//|		ИНАЧЕ 2
				//|	КОНЕЦ КАК Порядок
				//|ИЗ
				//|	Справочник.СотрудникиОрганизаций КАК СотрудникиОрганизаций
				//|ГДЕ
				//|	(СотрудникиОрганизаций.ВидДоговора <> ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровСФизЛицами.Контракт)
				//|			ИЛИ СотрудникиОрганизаций.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
				//|	И СотрудникиОрганизаций.Физлицо = &Физлицо
				//|	И СотрудникиОрганизаций.Организация = &ГоловнаяОрганизация
				//|
				//|УПОРЯДОЧИТЬ ПО
				//|	Порядок";
				//
				//Выборка = ЗапросСотр.Выполнить().Выбрать();
				//Сотрудник = Справочники.СотрудникиОрганизаций.НайтиПоНаименованию(ВыборкаПоРаботникиОрганизации.ФизЛицо.Наименование);
				//Если Выборка.Следующий() Тогда
				//	Сотрудник	= Выборка.Ссылка;
				//КонецЕсли;
				ЗапросПрием.Текст = 
				"ВЫБРАТЬ
				|	РаботникиОрганизаций.Регистратор,
				|	РаботникиОрганизаций.Период КАК Период
				|ИЗ
				|	ВТПрием КАК РаботникиОрганизаций 
				|";
				Если ОбъединятьОсновные Тогда 
					ЗапросПрием.Текст = ЗапросПрием.Текст + "
					|ГДЕ РаботникиОрганизаций.Сотрудник.ФизЛицо = &ФизЛицо";
				иначе                                                                         					
					ЗапросПрием.Текст = ЗапросПрием.Текст + "
					|ГДЕ РаботникиОрганизаций.Сотрудник = &Сотрудник";
				КонецЕсли;
				
				//+ СВЭЙ КДЯ 22.07.19 СВФР-004561 
				ЗапросПрием.Текст = ЗапросПрием.Текст + "
				|УПОРЯДОЧИТЬ ПО
				|	Период";	
				//- СВЭЙ КДЯ 22.07.19 СВФР-004561
				
				ТЗПриемУвольнениеСотрудника = Новый ТаблицаЗначений;
				ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаПриема");
				ТЗПриемУвольнениеСотрудника.Колонки.Добавить("ДатаУвольнения");
				Если ОбъединятьОсновные Тогда 
					ЗапросПрием.УстановитьПараметр("ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо);
				иначе 					
					ЗапросПрием.УстановитьПараметр("Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник);
				КонецЕсли;
				
				
				РезультПрием = ЗапросПрием.Выполнить().Выбрать(); 		
				
				ДатаПриема = Дата(1,1,1);	
				Пока РезультПрием.Следующий() Цикл
					если ТипЗнч(РезультПрием.Регистратор) = Тип("ДокументСсылка.ПриемНаРаботуВОрганизацию") Тогда 
						СтрТЗПриемУвольнениеСотрудника = ТЗПриемУвольнениеСотрудника.Добавить();
						СтрТЗПриемУвольнениеСотрудника.ДатаПриема = РезультПрием.Период; 
						если СтрТЗПриемУвольнениеСотрудника.ДатаУвольнения = Неопределено Тогда 
							СтрТЗПриемУвольнениеСотрудника.ДатаУвольнения = ДатаОкончания;
						конецЕсли;
					КонецЕсли;
					если ТипЗнч(РезультПрием.Регистратор) = Тип("ДокументСсылка.УвольнениеИзОрганизаций") Тогда 
						если СтрТЗПриемУвольнениеСотрудника = Неопределено Тогда 
							СтрТЗПриемУвольнениеСотрудника = ТЗПриемУвольнениеСотрудника.Добавить();
						КонецЕсли;
						СтрТЗПриемУвольнениеСотрудника.ДатаУвольнения = РезультПрием.Период-86400;
						
					КонецЕсли;
					
				КонецЦикла;
				ДатаПриема = Дата(1,1,1);
				ДатаУвольнения = ДатаОкончания;
				Для Каждого СтрДата из ТЗПриемУвольнениеСотрудника Цикл
					// + СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 17. )
					//если СтрДата.ДатаПриема < ДатаНачала и СтрДата.ДатаУвольнения < ДатаНачала и СтрДата.ДатаУвольнения<>Дата(1,1,1) Тогда 
					// - СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 17. )
					// + СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 17. )
					Если ЗначениеЗаполнено( СтрДата.ДатаПриема )
						И ЗначениеЗаполнено( СтрДата.ДатаУвольнения )
						И СтрДата.ДатаПриема < ДатаНачала 
						И СтрДата.ДатаУвольнения < ДатаНачала Тогда
						// - СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 17. )
						Продолжить;
					КонецЕсли;
					Если не ЗначениеЗаполнено(ДатаПриема) Тогда 
						ДатаПриема = СтрДата.ДатаПриема;
					КонецЕсли;
					если СтрДата.ДатаУвольнения <>Дата(1,1,1) Тогда 
						ДатаУвольнения = СтрДата.ДатаУвольнения;
					КонецЕсли;
					
				КонецЦикла;
				
				ТЗ_ВзносыФизЛица = Новый ТаблицаЗначений;
				ТЗ_ВзносыФизЛица.Колонки.Добавить("Больничные");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("СуммаДохода");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("ФизЛицо");
				Если не ОбъединятьОсновные Тогда
					ТЗ_ВзносыФизЛица.Колонки.Добавить("Сотрудник");
				КонецЕсли;
				ТЗ_ВзносыФизЛица.Колонки.Добавить("Период");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("ПроцентФСЗН");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("ПенсионныйФонд");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("ФСЗН");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("ВидДоговора");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("НомерДокумента");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("ДатаДокумента");
				ТЗ_ВзносыФизЛица.Колонки.Добавить("ДокументОснование");//О.Т. Аверсон 23.08.2018 № 2335
				ТЗ_ВзносыФизЛица.Колонки.Добавить("ПричиныМинимальнойЗП");
				//ЗапросПрием = Новый Запрос;
				//ЗапросПрием.Текст = 
				//"ВЫБРАТЬ
				//|	ВложенныйЗапрос.Сотрудник,
				//|	ВЫБОР
				//|		КОГДА ЕСТЬNULL(ВложенныйЗапрос.ДатаУвольнения, 1) = 1
				//|			ТОГДА &ДатаОкончания
				//|		ИНАЧЕ ВложенныйЗапрос.ДатаУвольнения
				//|	КОНЕЦ КАК ДатаУвольнения,
				//|	ВложенныйЗапрос.ДатаПриема
				//|ИЗ
				//|	(ВЫБРАТЬ
				//|		РаботникиОрганизаций.Сотрудник КАК Сотрудник,
				//|		ВложенныйЗапрос.ДатаУвольнения КАК ДатаУвольнения,
				//|		ПриемНаРаботуВОрганизациюРаботникиОрганизации.ДатаПриема КАК ДатаПриема
				//|	ИЗ
				//|		РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
				//|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				//|				РаботникиОрганизаций.Сотрудник КАК Сотрудник,
				//|				УвольнениеИзОрганизацийРаботникиОрганизации.ДатаУвольнения КАК ДатаУвольнения
				//|			ИЗ
				//|				РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
				//|					ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.УвольнениеИзОрганизаций.РаботникиОрганизации КАК УвольнениеИзОрганизацийРаботникиОрганизации
				//|					ПО РаботникиОрганизаций.Регистратор = УвольнениеИзОрганизацийРаботникиОрганизации.Ссылка
				//|						И РаботникиОрганизаций.Сотрудник = УвольнениеИзОрганизацийРаботникиОрганизации.Сотрудник
				//|			ГДЕ
				//|				РаботникиОрганизаций.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций
				//|				И РаботникиОрганизаций.Сотрудник.Физлицо = &Физлицо) КАК ВложенныйЗапрос
				//|			ПО РаботникиОрганизаций.Сотрудник = ВложенныйЗапрос.Сотрудник
				//|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПриемНаРаботуВОрганизацию.РаботникиОрганизации КАК ПриемНаРаботуВОрганизациюРаботникиОрганизации
				//|			ПО РаботникиОрганизаций.Регистратор = ПриемНаРаботуВОрганизациюРаботникиОрганизации.Ссылка
				//|				И РаботникиОрганизаций.Сотрудник = ПриемНаРаботуВОрганизациюРаботникиОрганизации.Сотрудник
				//|	ГДЕ
				//|		РаботникиОрганизаций.Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию
				//|		И РаботникиОрганизаций.Сотрудник.Физлицо = &Физлицо) КАК ВложенныйЗапрос
				//|ГДЕ
				//|	ВЫБОР
				//|			КОГДА ЕСТЬNULL(ВложенныйЗапрос.ДатаУвольнения, 1) = 1
				//|				ТОГДА &ДатаОкончания
				//|			ИНАЧЕ ВложенныйЗапрос.ДатаУвольнения
				//|		КОНЕЦ >= &ДатаНачала
				//|	И ВложенныйЗапрос.ДатаПриема <= &ДатаОкончания";
				//ЗапросПрием.УстановитьПараметр("Физлицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
				//ЗапросПрием.УстановитьПараметр("ДатаНачала",ДатаНачала);
				//ЗапросПрием.УстановитьПараметр("ДатаОкончания",ДатаОкончания);
				//РезПрием = ЗапросПрием.Выполнить().Выбрать();
				//ДатаПриема = Дата("00010101000000");
				//если РезПрием.Следующий() Тогда 
				//	ДатаПриема = РезПрием.ДатаПриема;
				//КонецЕсли;
				//РезУв = ЗапросПрием.Выполнить().Выбрать(); 
				//ДатаУвольнения = ДатаОкончания;
				//Пока РезУв.Следующий() Цикл 	
				//	ДатаУвольнения = РезУв.ДатаУвольнения;
				//КонецЦикла;
				
				если КатегорияВывод <> "ДОГОВОР" Тогда
					если ДатаНач < ДатаПриема 
						//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
						//т.к. при флаге "Объединять основные", 
						//для объединяемых сотрудников могут быть разные физ.лица
						И НЕ ОбъединятьОсновные
						//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
						
						Тогда 
						ДатаНач = НачалоМесяца(Макс(ДатаПриема,ДатаНачала));
					КонецЕсли;
					
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					//если ДатаОкончания > ДатаУвольнения Тогда 
					//	ДатаКон = НачалоМесяца(ДатаУвольнения);
					//КонецЕсли;
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					ДатаВыборки = ПолучитьМаксимальнуюДатуВыборкиВзносов( 
					ВыборкаПоРаботникиОрганизации.Сотрудник );
					если ДатаОкончания > ДатаВыборки Тогда 
						ДатаКон = НачалоМесяца( ДатаВыборки );
					КонецЕсли;
					
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
				КонецЕсли;
				
				//РезПереборДат = ЗапросПрием.Выполнить().Выбрать(); 
				ПереборДатТЗ = Новый Массив;
				Для Каждого РезПереборДат из ТЗПриемУвольнениеСотрудника Цикл 
					// + СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 16. )
					//ДатаПриемСч = НачалоМесяца(РезПереборДат.ДатаПриема);
					// - СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 16. )
					// + СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 16. )
					ДатаПриемСч = НачалоМесяца( ?( ЗначениеЗаполнено( РезПереборДат.ДатаПриема ), 
					РезПереборДат.ДатаПриема, ЭтотОбъект.ДатаНачала ) );
					// - СВЭЙ КДЯ 06.09.19 СВФР-004631 ( Пункт 16. )
					пока ДатаПриемСч <= РезПереборДат.ДатаУвольнения Цикл 
						ПереборДатТЗ.Добавить(ДатаПриемСч);
						ДатаПриемСч = ДобавитьМесяц(ДатаПриемСч,1);
					КонецЦикла;
					
				КонецЦикла;
				
				пока ДатаНач <= ДатаКон Цикл 
					ПериодЕсть = Ложь;
					Для Каждого стр из СтрокиПоРаботнику1 Цикл 
						если стр.Период = ДатаНач Тогда
							если КатегорияВывод = "ДОГОВОР" Тогда
								Если ОбъединятьОсновные Тогда
									//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
									//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо,НомерДокумента,НачалоРабот",стр.ФизЛицо,стр.НомерДокумента,стр.ДатаДокумента));
									//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
									//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
									
									//Аверсон ЕАЕ 13.02.2023 СВФР-010250
									//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки( Новый Структура( "ФизЛицо, НомерДокумента", стр.ФизЛицо, стр.НомерДокумента ) );
									МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки( Новый Структура( "ФизЛицо, НомерДокумента, ДатаДокумента", стр.ФизЛицо, стр.НомерДокумента, стр.ДатаДокумента ) );
									//Аверсон СВФР-010250
									
									//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
								иначе
									//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
									//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник,НомерДокумента,НачалоРабот",стр.Сотрудник,стр.НомерДокумента,стр.ДатаДокумента));
									//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
									//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
									
									//Аверсон ЕАЕ 13.02.2023 СВФР-010250
									//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки( Новый Структура("Сотрудник, НомерДокумента", стр.Сотрудник, стр.НомерДокумента ) );
									МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки( Новый Структура("Сотрудник, НомерДокумента, ДатаДокумента", стр.Сотрудник, стр.НомерДокумента, стр.ДатаДокумента ) );
									//Аверсон СВФР-010250
									
									//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
								КонецЕсли;
								
								Если МасПровПТДопСведОстаже.Количество()> 0 Тогда 
									СтрокаСтрокиПоРаботнику1 = ТЗ_ВзносыФизЛица.Добавить();
									ЗаполнитьЗначенияСвойств(СтрокаСтрокиПоРаботнику1,стр);
									Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
										ПериодЕсть = Истина;
										//+ СВЭЙ КДЯ 22.07.19 СВФР-004561
										//Прервать;
										//- СВЭЙ КДЯ 22.07.19 СВФР-004561
										//+ СВЭЙ КДЯ 22.07.19 СВФР-004561
										Продолжить;
										//- СВЭЙ КДЯ 22.07.19 СВФР-004561
									КонецЕсли;
								иначе //О.Т. Аверсон 05.04.2019 № 4187
									Если ОбъединятьОсновные Тогда
										
										//Аверсон ЕАЕ 13.02.2023 СВФР-010250
										//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо,НомерДокумента",стр.ФизЛицо,стр.НомерДокумента));
										МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо,НомерДокумента,ДатаДокумента",стр.ФизЛицо,стр.НомерДокумента,стр.ДатаДокумента));
										//Аверсон СВФР-010250
										
									иначе
										
										//Аверсон ЕАЕ 13.02.2023 СВФР-010250
										//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник,НомерДокумента",стр.Сотрудник,стр.НомерДокумента));
										МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник,НомерДокумента,ДатаДокумента",стр.Сотрудник,стр.НомерДокумента,стр.ДатаДокумента));
										//Аверсон СВФР-010250
										
									КонецЕсли;
									
									
									Для Каждого стрДопСвед из МасПровПТДопСведОстаже Цикл 
										Если стрДопСвед.НачалоРабот >= стр.ДатаДокумента Тогда 
											СтрокаСтрокиПоРаботнику1 = ТЗ_ВзносыФизЛица.Добавить();
											ЗаполнитьЗначенияСвойств(СтрокаСтрокиПоРаботнику1,стр);
											Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
												ПериодЕсть = Истина;
												Прервать;
											КонецЕсли;											
										КонецЕсли;  												
									КонецЦикла;
									Если МасПровПТДопСведОстаже.Количество()> 0 Тогда
										Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
											ПериодЕсть = Истина;
											Прервать;
										КонецЕсли;
									КонецЕсли;
								КонецЕсли;
							иначе
								СтрокаСтрокиПоРаботнику1 = ТЗ_ВзносыФизЛица.Добавить();
								ЗаполнитьЗначенияСвойств(СтрокаСтрокиПоРаботнику1,стр);
								Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
									ПериодЕсть = Истина;
									Прервать;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли; // если стр.Период = ДатаНач
						
					КонецЦикла;
					Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
						если не ПериодЕсть Тогда 
							
							Для Каждого стрЗнач из СтрокиПоРаботнику1 Цикл 
								если стрЗнач.Период = ДатаНач Тогда
									если КатегорияВывод = "ДОГОВОР" Тогда
										Если ОбъединятьОсновные Тогда
											//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо,НомерДокумента,НачалоРабот",стр.ФизЛицо,стр.НомерДокумента,стр.ДатаДокумента));
											//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											
											//Аверсон ЕАЕ 13.02.2023 СВФР-010250
											//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки( Новый Структура( "ФизЛицо, НомерДокумента", стр.ФизЛицо, стр.НомерДокумента ) );
											МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки( Новый Структура( "ФизЛицо, НомерДокумента, ДатаДокумента", стр.ФизЛицо, стр.НомерДокумента, стр.ДатаДокумента ) );
											//Аверсон СВФР-010250
											
											//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
										иначе
											//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник,НомерДокумента,НачалоРабот",стр.Сотрудник,стр.НомерДокумента,стр.ДатаДокумента));
											//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											
											//Аверсон ЕАЕ 13.02.2023 СВФР-010250
											//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки( Новый Структура("Сотрудник, НомерДокумента", стр.Сотрудник, стр.НомерДокумента ) );
											МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки( Новый Структура("Сотрудник, НомерДокумента, ДатаДокумента", стр.Сотрудник, стр.НомерДокумента, стр.ДатаДокумента ) );
											//Аверсон СВФР-010250
											
											//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
										КонецЕсли;
										Если МасПровПТДопСведОстаже.Количество()> 0 Тогда 
											СтрокаСтрокиПоРаботнику1 = ТЗ_ВзносыФизЛица.Добавить();
											ЗаполнитьЗначенияСвойств(СтрокаСтрокиПоРаботнику1,стрЗнач);
											Прервать;
										иначе
											Если ОбъединятьОсновные Тогда
												
												//Аверсон ЕАЕ 13.02.2023 СВФР-010250
												//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо,НомерДокумента",стр.ФизЛицо,стр.НомерДокумента));
												МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо,НомерДокумента,ДатаДокумента",стр.ФизЛицо,стр.НомерДокумента,стр.ДатаДокумента));
												//Аверсон СВФР-010250
												
											иначе
												
												//Аверсон ЕАЕ 13.02.2023 СВФР-010250
												//МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник,НомерДокумента",стр.Сотрудник,стр.НомерДокумента));
												МасПровПТДопСведОстаже = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник,НомерДокумента,ДатаДокумента",стр.Сотрудник,стр.НомерДокумента,стр.ДатаДокумента));
												//Аверсон СВФР-010250
												
											КонецЕсли;
											Для Каждого стрДопСвед из МасПровПТДопСведОстаже Цикл 
												Если стрДопСвед.НачалоРабот >= стр.ДатаДокумента Тогда 
													СтрокаСтрокиПоРаботнику1 = ТЗ_ВзносыФизЛица.Добавить();
													ЗаполнитьЗначенияСвойств(СтрокаСтрокиПоРаботнику1,стрЗнач);
													Прервать; 													
												КонецЕсли;  												
											КонецЦикла;       									
										КонецЕсли;
									иначе
										СтрокаСтрокиПоРаботнику1 = ТЗ_ВзносыФизЛица.Добавить();
										ЗаполнитьЗначенияСвойств(СтрокаСтрокиПоРаботнику1,стрЗнач);
										Прервать;
									КонецЕсли;
									
								КонецЕсли;
							КонецЦикла;
							если КатегорияВывод <> "ДОГОВОР" Тогда
								ДатаОтбор = ПереборДатТЗ.Найти(НачалоМесяца(ДатаНач));
								если не ДатаОтбор = Неопределено Тогда 
									
									СтрокаСтрокиПоРаботнику1 = ТЗ_ВзносыФизЛица.Добавить();
									СтрокаСтрокиПоРаботнику1.Больничные = 0;
									СтрокаСтрокиПоРаботнику1.Период = НачалоМесяца(ДатаНач);
									СтрокаСтрокиПоРаботнику1.СуммаДохода = 0;
									Если не ОбъединятьОсновные Тогда
										СтрокаСтрокиПоРаботнику1.Сотрудник = ВыборкаПоРаботникиОрганизации.Сотрудник;
									КонецЕсли;
									СтрокаСтрокиПоРаботнику1.ФизЛицо = ВыборкаПоРаботникиОрганизации.ФизЛицо;
									СтрокаСтрокиПоРаботнику1.ПроцентФСЗН = 0;
									СтрокаСтрокиПоРаботнику1.ПенсионныйФонд = 0;
									СтрокаСтрокиПоРаботнику1.ФСЗН = 0;
									//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
									СтрокаСтрокиПоРаботнику1.НомерДокумента = "";
									СтрокаСтрокиПоРаботнику1.ДатаДокумента = Дата( 1, 1, 1 );
									//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
								КонецЕсли;
							КонецЕсли;
							ПериодЕсть = Ложь;
							
						КонецЕсли; 
					КонецЕсли;
					ДатаНач = ДобавитьМесяц(ДатаНач,1);	
				КонецЦикла;
				// + СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
				ТЗ_ВзносыФизЛица.Сортировать( "ФизЛицо, ДатаДокумента, НомерДокумента, Период" );
				// - СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
				СтрокиПоРаботнику1 = ТЗ_ВзносыФизЛица; 
				Колич = ТЗ_ВзносыФизЛица.Количество();
				
				НомерДоговораПрошл = "";
				ДатаДоговораПрошл = "";
				ДокументОснованиеПрошл = ""; //О.Т. Аверсон 23.08.2018 № 2335
				НомерДоговораПервый = "";
				ДатаДоговораПервый = "";
				СтрокаЗамена = СтрокаФайла;  
				СчДляКолСтажа = 0;
				//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
				ПериодДляДоговора = Дата( 1, 1, 1 );
				ОтборДоговора = Новый Структура( "НомерДокумента, ДатаДокумента" );
				//- СВЭЙ КДЯ 25.07.19 СВФР-004561
				// + СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
				ПрефиксСтрокаФайла1 = "";
				// - СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
				Для Сч = 0 по Колич-1 цикл
					
					СтрокаМес = СтрокиПоРаботнику1[Сч];
					если КатегорияВывод= "ДОГОВОР" и не ЗначениеЗаполнено(СтрокаМес.НомерДокумента) Тогда
						Продолжить;
					КонецЕсли;
					если Сч = 0 Тогда 
						НомерДоговораПервый = СтрокаМес.НомерДокумента;
						ДатаДоговораПервый = СтрокаМес.ДатаДокумента;
					КонецЕсли;
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					ЗначениеКв = "";
					//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					ЕстьВзносы = Истина;
					//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					Если  КатегорияВывод = "ДОГОВОР"
						И СтрокаМес.СуммаДохода = 0 
						И СтрокаМес.Больничные = 0 И СтрокаМес.ФСЗН = 0 И СтрокаМес.ПенсионныйФонд = 0 Тогда
						
						ЗаполнитьЗначенияСвойств( ОтборДоговора, СтрокаМес );
						ИтогиДоговора = ИтогиПоДоговорам.НайтиСтроки( ОтборДоговора );
						Если ИтогиДоговора.Количество() > 0 Тогда
							Если ИтогиДоговора[0].СуммаДохода > 0 ИЛИ ИтогиДоговора[0].Больничные > 0 
								ИЛИ ИтогиДоговора[0].ФСЗН > 0 ИЛИ ИтогиДоговора[0].ПенсионныйФонд > 0 Тогда
								//нулевой месяц по договору с ненулевым итогом ( пропускаем ) 
								Продолжить;
							КонецЕсли;
						КонецЕсли; 
						//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
						ЕстьВзносы = Ложь;
						//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
						
						//+ СВЭЙ КДЯ 05.12.19 СВФР-004631 ( пункт 73. )
						//обобщаем на случай, если это Основные
					ИначеЕсли КатегорияВывод = "" 
						И СтрокаМес.СуммаДохода = 0 
						И СтрокаМес.Больничные = 0 И СтрокаМес.ФСЗН = 0 И СтрокаМес.ПенсионныйФонд = 0 
						И НЕ ЕстьПересениеСоСведениямиОСтаже( СтрокаМес, ТЗ_СведенияОСтаже )
						И НЕ ЗначениеЗаполнено(СтрокаМес.ПричиныМинимальнойЗП) Тогда  //Аверсон 07.05.2020 КВВ СВФР-005942
						Продолжить;
						//- СВЭЙ КДЯ 05.12.19 СВФР-004631 ( пункт 73. )
						
						//+ СВЭЙ КДЯ 06.12.19 СВФР-004631 ( пункт 72. )
						//если выплата пособия в месяце была, а записей о стаже нет, то добавляем такую запись
					ИначеЕсли КатегорияВывод = "" 
						И СтрокаМес.СуммаДохода = 0 
						И СтрокаМес.Больничные <> 0 
						И НЕ ЕстьПересениеСоСведениямиОСтаже( СтрокаМес, ТЗ_СведенияОСтаже ) Тогда
						ДобавитьЗаписьОСтажеПособие( СтрокаМес, ТЗ_СведенияОСтаже );
						//- СВЭЙ КДЯ 06.12.19 СВФР-004631 ( пункт 72. )
						
					КонецЕсли;
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					РезультатДоговор= 0;
					// + СВЭЙ КДЯ СВФР-004561 02.08.19 + 18.09.19 СВФР-004631 ( пункт 31. )
					Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
						// - СВЭЙ КДЯ СВФР-004561 02.08.19
						// + СВЭЙ КДЯ СВФР-004561 02.08.19 - 18.09.19 СВФР-004631 ( пункт 31. )
						//Если НЕ ( ВыгрузкаДоговоровПодрядаБезОграничения И ДогПодряда ИЛИ ЕстьРасшифровкиДоговоров )  Тогда
						// - СВЭЙ КДЯ СВФР-004561 02.08.19
						
						//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 28. )
						//если КатегорияВывод= "ДОГОВОР" Тогда 
						//	ЗапросДог = Новый Запрос;
						//	ЗапросДог.Текст = 
						//	"ВЫБРАТЬ
						//	|	ЕСНСведенияОДоходах.Результат как Результат
						//	|ИЗ
						//	|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
						//	|ГДЕ
						//	|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1";
						//	Если ОбъединятьОсновные Тогда
						//		ЗапросДог.Текст = ЗапросДог.Текст +"
						//		|	И ЕСНСведенияОДоходах.ФизЛицо = &ФизЛицо";
						//	иначе       								
						//		ЗапросДог.Текст = ЗапросДог.Текст +"
						//		|	И ЕСНСведенияОДоходах.Сотрудник = &Сотрудник";
						//	КонецЕсли;
						//	ЗапросДог.Текст = ЗапросДог.Текст +"       							
						//	|	И ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН <> &ДоходБольничныйФСЗН";
						//	//|	И ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета = &СпособРасчета"; //О.Т. Аверсон 31.01.2017 № 244
						//	Если не ОбъединятьОсновные Тогда 
						//		ЗапросДог.УстановитьПараметр("Сотрудник",СтрокаМес.Сотрудник);
						//	иначе
						//		ЗапросДог.УстановитьПараметр("ФизЛицо",СтрокаМес.ФизЛицо);
						//	КонецЕсли;
						//	ЗапросДог.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
						//	ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов",НачалоМесяца(СтрокаМес.Период));
						//	ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов1",КонецМесяца(СтрокаМес.Период));
						//	//ЗапросДог.УстановитьПараметр("СпособРасчета",Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой);
						//	РезДог = ЗапросДог.Выполнить().Выбрать();
						//	пока РезДог.Следующий() Цикл 
						//		РезультатДоговор = РезультатДоговор+РезДог.Результат; 
						//	КонецЦикла;
						//КонецЕсли;
						//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 28. )
						
						
						//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 31. )
						Если КатегорияВывод = "ДОГОВОР" И ЗначениеЗаполнено( СтрокаМес.НомерДокумента ) Тогда
							
							ОтборДохода = Новый Структура( "ФизЛицо, Период, НомерДокумента, ДатаДокумента", 
							СтрокаМес.ФизЛицо, СтрокаМес.Период, СтрокаМес.НомерДокумента, СтрокаМес.ДатаДокумента );
							СтрокиДохода = ПромежуточнаяТаблица.НайтиСтроки( ОтборДохода );
							Для каждого СтрокаДохода Из СтрокиДохода Цикл
								РезультатДоговор = РезультатДоговор + СтрокаДохода.СуммаДохода;
							КонецЦикла;
							
						КонецЕсли; // КатегорияВывод = "ДОГОВОР" И ЗначениеЗаполнено( СтрокаМес.НомерДокумента )
						//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 31. )
						
					иначе
						РезультатДоговор = СтрокаМес.СуммаДохода
					КонецЕсли;
					
					
					
					
					
					если ЗначениеЗаполнено(СтрокаДатаДокумента) и ЗначениеЗаполнено(СтрокаНомерДокумента) Тогда 
					иначе
						
						СтрокаДатаДокумента = СтрокаМес.ДатаДокумента;
						СтрокаНомерДокумента = СтрокаМес.НомерДокумента;
					КонецЕсли;
					если не Сч > Колич-1 Тогда 
						СтрокаДатаДокументаСлед = СтрокиПоРаботнику1[Сч].ДатаДокумента;
						СтрокаНомерДокументаСлед = СтрокиПоРаботнику1[Сч].НомерДокумента;
					иначе
						СтрокаДатаДокументаСлед = СтрокаДатаДокумента;
						СтрокаНомерДокументаСлед = СтрокаНомерДокумента;
						
					КонецЕсли;
					Если Категория <> "03" тогда
						если КатегорияВывод= "ДОГОВОР" Тогда
							если ЗначениеЗаполнено(СтрокаМес.НомерДокумента) Тогда 
								если  не СтрокаДатаДокументаСлед = "" Тогда  
									//если не СтрМес>1 Тогда
									ДеньДатыДоговора        = ?(День(СтрокаДатаДокументаСлед)<10,"0","")+День(СтрокаДатаДокументаСлед);
									МесяцДатыДоговора       = ?(Месяц(СтрокаДатаДокументаСлед)<10,"0","")+Месяц(СтрокаДатаДокументаСлед);
									ГодДатыДоговора 		 = Строка(СокрЛП(Формат(Год(СтрокаДатаДокументаСлед), "ЧГ=0")));
									ДатаДоговора   = ДеньДатыДоговора+"/"+МесяцДатыДоговора+"/"+ГодДатыДоговора;    
									//иначе
									//	ДеньДатыДоговора        = ?(День(СтрокаДатаДокумента)<10,"0","")+День(СтрокаДатаДокумента);
									//	МесяцДатыДоговора       = ?(Месяц(СтрокаДатаДокумента)<10,"0","")+Месяц(СтрокаДатаДокумента);
									//	ГодДатыДоговора 		 = Строка(СокрЛП(Формат(Год(СтрокаДатаДокумента), "ЧГ=0")));
									//	ДатаДоговора   = ДеньДатыДоговора+"/"+МесяцДатыДоговора+"/"+ГодДатыДоговора;
									//КонецЕсли;
								иначе
									ДатаДоговора = "";
								КонецЕсли;
								// О.Т. 05.11.2014 
								
								//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 28. )
								//ЗапросНеОплДог = Новый Запрос;
								//ЗапросНеОплДог.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
								//ЗапросНеОплДог.Текст = "
								//| Выбрать 
								//| ТЧСведОСтаже.Сотрудник,
								//| ТЧСведОСтаже.Договор,
								//| ТЧСведОСтаже.ВидДеятельности
								//| Поместить ВТТЧСведОСтаже
								//| из &ТЧСведОСтаже как ТЧСведОСтаже
								//| ГДЕ ТЧСведОСтаже.Сотрудник = &Сотрудник ";
								//ЗапросНеОплДог.УстановитьПараметр("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
								//ЗапросНеОплДог.УстановитьПараметр("НеОплДог",НеоплДог);
								//ЗапросНеОплДог.УстановитьПараметр("ТЧСведОСтаже",СведенияОСтаже);
								//
								//ЗапросНеОплДог.Выполнить();
								//ЗапросНеОплДог.Текст = "
								//| Выбрать 
								//| ТЧСведОСтаже.Сотрудник,
								//| ТЧСведОСтаже.Договор,
								//| ТЧСведОСтаже.ВидДеятельности
								//| из ВТТЧСведОСтаже как ТЧСведОСтаже
								////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
								////| ГДЕ ТЧСведОСтаже.Договор.Номер = &Номер и ТЧСведОСтаже.Договор.ДатаНачала = &Дата и ТЧСведОСтаже.ВидДеятельности = &НеОплДог ";
								////- СВЭЙ КДЯ 25.07.19 СВФР-004561
								////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
								//| ГДЕ ТЧСведОСтаже.Договор.НомерДляПУ = &Номер и ТЧСведОСтаже.Договор.ДатаНачала = &Дата и ТЧСведОСтаже.ВидДеятельности = &НеОплДог ";
								////- СВЭЙ КДЯ 25.07.19 СВФР-004561
								
								//если не Сч > Колич-1 Тогда
								//	Попытка
								//		СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокументаСлед= "",СтрокаНомерДокументаСлед, Число(СтрокаНомерДокументаСлед)) +"="+ДатаДоговора+"=";
								//		ЗапросНеОплДог.УстановитьПараметр("Номер",СтрокаНомерДокументаСлед);
								//		ЗапросНеОплДог.УстановитьПараметр("Дата",СтрокаДатаДокументаСлед);
								//	Исключение
								//		СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокументаСлед= "",СтрокаНомерДокументаСлед, СокрЛП(СтрокаНомерДокументаСлед)) +"="+ДатаДоговора+"=";
								//		ЗапросНеОплДог.УстановитьПараметр("Номер",СтрокаНомерДокументаСлед);
								//		ЗапросНеОплДог.УстановитьПараметр("Дата",СтрокаДатаДокументаСлед);
								
								//	КонецПопытки;
								//иначе
								//	Попытка
								//		СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокумента= "",СтрокаНомерДокумента, Число(СтрокаНомерДокумента)) +"="+ДатаДоговора+"=";
								//		ЗапросНеОплДог.УстановитьПараметр("Номер",СтрокаНомерДокумента);
								//		ЗапросНеОплДог.УстановитьПараметр("Дата",СтрокаДатаДокументаСлед);
								//	Исключение
								//		СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокумента= "",СтрокаНомерДокумента, СокрЛП(СтрокаНомерДокумента)) +"="+ДатаДоговора+"=";
								//		ЗапросНеОплДог.УстановитьПараметр("Номер",СтрокаНомерДокумента);
								//		ЗапросНеОплДог.УстановитьПараметр("Дата",СтрокаДатаДокументаСлед);
								//	КонецПопытки;
								//КонецЕсли;
								//// О.Т. 05.11.2014 
								//
								//РезНеОплДог = ЗапросНеОплДог.Выполнить().Выгрузить();
								//ЕстьНеоплДог = РезНеОплДог.Количество(); 
								//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 28. )
								
								//+ СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже );
								Если НЕ Сч > Колич-1 Тогда
									//Аверсон 23.10.2020 КВВ СВФР-006738 ( (закомментировано)
									//Попытка       									
									//	СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокументаСлед= "",СтрокаНомерДокументаСлед, СтрЗаменить(Число(СтрокаНомерДокументаСлед)," ","")) +"="+ДатаДоговора+"=";
									//Исключение
									//Аверсон 23.10.2020 КВВ СВФР-006738 ) (закомментировано) 
									СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокументаСлед= "",СтрокаНомерДокументаСлед, СтрЗаменить(СокрЛП(СтрокаНомерДокументаСлед)," ","")) +"="+ДатаДоговора+"=";	
									//КонецПопытки;
								Иначе
									//Аверсон 23.10.2020 КВВ СВФР-006738 ( (закомментировано)
									//Попытка
									//	СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокумента= "",СтрокаНомерДокумента, СтрЗаменить(Число(СтрокаНомерДокумента)," ","")) +"="+ДатаДоговора+"=";
									//Исключение
									//Аверсон 23.10.2020 КВВ СВФР-006738 ) (закомментировано)
									СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокумента= "",СтрокаНомерДокумента, СтрЗаменить(СокрЛП(СтрокаНомерДокумента)," ","")) +"="+ДатаДоговора+"=";
									//КонецПопытки;
								КонецЕсли;
								//- СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								
							КонецЕсли;
						Иначе 
							если не СтрМес>1 Тогда
								СтрокаФайла = СтрокаФайла+" = =";
							КонецЕсли;
						КонецЕсли;
						
						
					КонецЕсли;
					//КонецЕсли;
					если СтрМес > 1 Тогда 
						если КатегорияВывод= "ДОГОВОР" Тогда
							если не Сч > Колич-1 Тогда
								Если СтрокаМес.НомерДокумента <> НомерДоговораПрошл или СтрокаМес.ДатаДокумента <> ДатаДоговораПрошл Тогда 
									ДатаНачалаДоговора = Дата(1,1,1);
									ДатаОкончанияДоговора = Дата(1,1,1);
									если КатегорияВывод= "ДОГОВОР" Тогда
										Если СтрокаМес.НомерДокумента <> НомерДоговораПрошл или СтрокаМес.ДатаДокумента <> ДатаДоговораПрошл Тогда 
											ТипЗаписиНач = "СТАЖ=";
											Структура = Новый Структура;
											// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
											//Если ОбъединятьОсновные Тогда 
											// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
											// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
											Если НЕ ОбъединятьОсновные Тогда 
												// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
												Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
											иначе
												Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
											КонецЕсли;
											если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
												Структура.Вставить("ВидДоговора",null);
											Иначе 
												Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
												Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
													Структура.Вставить("НомерДокумента",НомерДоговораПрошл);
													//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
													//Структура.Вставить("ДатаДляПУ",ДатаДоговораПрошл);
													//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
													
													//Аверсон ЕАЕ 17.02.2023 СВФР-010250
													Структура.Вставить("ДатаДокумента", ДатаДоговораПрошл);
													//Аверсон СВФР-010250
													
												КонецЕсли;
											КонецЕсли;
											
											// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
											Структура.Вставить( "ВидДейтельности", "ДОГОВОР" );
											// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
											
											СтрокиПоРаботнику = ПТДопСведОстаже.НайтиСтроки(Структура); 
											
											//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
											Если СтрокиПоРаботнику.Количество() = 0 Тогда
												Структура.ВидДейтельности = "НЕОПЛДОГ";
												СтрокиПоРаботнику = ПТДопСведОстаже.НайтиСтроки(Структура);
											КонецЕсли; 
											//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
											
											КоличествоЗаписейОСтаже = 0;
											ПредыдущийВидДейтельности = "";
											ПредыдущееОкончаниеРабот = "";
											ДатаНачалаРабот = "";
											Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
												//если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.НачалоРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ОкончаниеРабот)) Тогда 
												//	Продолжить;
												//КонецЕсли;
												
												Если ЗначениеЗаполнено(СтрокаСтаж.ВидДейтельности) Тогда 
													Если СтрокаСтаж.ВидДейтельности <> "СП2     " Тогда 
														
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														//ДатаФормирования = СтрокаСтаж.НачалоРабот; //О.Т. Аверсон 22.04.2019 № 4269 //СтрЗаменить(СтрокаСтаж.НачалоРабот,"2011","2012");
														//ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
														//МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
														//ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
														//ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														ДатаНачалаРабот   = Формат( СтрокаСтаж.НачалоРабот, "ДФ=""дд/ММ/гггг""" );
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														
														ДатаНачалаДоговора = СтрокаСтаж.НачалоРабот;
														ДатаОкончанияДоговора = СтрокаСтаж.ОкончаниеРабот;
														
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														//Если НачалоМесяца( СтрокаСтаж.НачалоРабот ) <> НачалоМесяца( СтрокаСтаж.ОкончаниеРабот ) 
														//		и Год( СтрокаСтаж.НачалоРабот ) < Год( СтрокаСтаж.ОкончаниеРабот ) Тогда
														//	ДатаФормирования = КонецМесяца(СтрокаСтаж.НачалоРабот);
														//иначе
														//	ДатаФормирования = СтрокаСтаж.ОкончаниеРабот;
														//КонецЕсли;
														//ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
														//МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
														//ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
														//ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														ВерхняяГраницаПериода = Мин( ДатаОкончания, СтрокаСтаж.ОкончаниеРабот );
														Если Год( СтрокаСтаж.НачалоРабот ) < Год( ВерхняяГраницаПериода ) Тогда
															ДатаФормирования = КонецГода( СтрокаСтаж.НачалоРабот );
														иначе
															ДатаФормирования = ВерхняяГраницаПериода;
														КонецЕсли;
														ДатаОкончанияРабот = Формат( ДатаФормирования, "ДФ=""дд/ММ/гггг""" );
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														
														
														Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
															
															// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
															//О.Т. Аверсон 14.05.2019 № 4328
															//ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки( 
															//	Новый Структура( "ФизЛицо, ДатаНачалаРабот, ДатаОкончанияРабот, ВидДеятельности",
															//	ВыборкаПоРаботникиОрганизации.ФизЛицо, СтрокаСтаж.НачалоРабот, НачалоДня( ДатаФормирования ), НеоплДог ) ); 
															//
															//ЗначВидДеят = Неопределено;
															//Если ЗначСведенияОСтаже.Количество()>0 Тогда 
															//	ЗначВидДеят = ЗначСведенияОСтаже[0].ВидДеятельности;																
															//КонецЕсли;
															////О.Т. Аверсон 14.05.2019 № 4328
															
															//СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот + "= =" 
															//	+ СокрЛП( ?( ЗначениеЗаполнено( ЗначВидДеят ), ЗначВидДеят, СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
															// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
															
															// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
															ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже,
															НомерДоговораПрошл, ДатаДоговораПрошл );
															СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот + "= =" 
															+ СокрЛП( ?( ЕстьНеоплДог, "НЕОПЛДОГ", СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
															// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
															
															ТекстФайла.ДобавитьСтроку( СтрокаЗар );
															ТекСтрока = ТекСтрока + 1;
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1 ;
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
														КонецЕсли;
														
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														//КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;//О.Т. 09.03.2015 № ниже суммируется
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														
														Если Категория = "03" тогда
															НомерДоговора = СокрЛП(НомерДоговораПрошл);
															ДатаФормирования = ДатаДоговораПрошл;
															ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
															МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
															ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
															ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
															
															// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
															//ЗапросНеОплДог = Новый Запрос;
															//ЗапросНеОплДог.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
															//ЗапросНеОплДог.Текст = "
															//| Выбрать 
															//| ТЧСведОСтаже.Сотрудник,
															//| ТЧСведОСтаже.Договор,
															//| ТЧСведОСтаже.ВидДеятельности
															//| Поместить ВТТЧСведОСтаже
															//| из &ТЧСведОСтаже как ТЧСведОСтаже
															//| ГДЕ ТЧСведОСтаже.Сотрудник = &Сотрудник ";
															//ЗапросНеОплДог.УстановитьПараметр("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
															//ЗапросНеОплДог.УстановитьПараметр("НеОплДог",НеоплДог);
															//ЗапросНеОплДог.УстановитьПараметр("ТЧСведОСтаже",СведенияОСтаже);
															//
															//ЗапросНеОплДог.Выполнить();
															//ЗапросНеОплДог.Текст = "
															//| Выбрать 
															//| ТЧСведОСтаже.Сотрудник,
															//| ТЧСведОСтаже.Договор,
															//| ТЧСведОСтаже.ВидДеятельности
															//| из ВТТЧСведОСтаже как ТЧСведОСтаже
															////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
															////| ГДЕ ТЧСведОСтаже.Договор.Номер = &Номер и ТЧСведОСтаже.Договор.ДатаНачала = &Дата и ТЧСведОСтаже.ВидДеятельности = &НеОплДог ";
															////- СВЭЙ КДЯ 25.07.19 СВФР-004561
															////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
															//| ГДЕ ТЧСведОСтаже.Договор.НомерДляПУ = &Номер и ТЧСведОСтаже.Договор.ДатаНачала = &Дата и ТЧСведОСтаже.ВидДеятельности = &НеОплДог ";
															////- СВЭЙ КДЯ 25.07.19 СВФР-004561
															// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
															
															
															Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
																СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"=");
																
																// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																//ЗапросНеОплДог.УстановитьПараметр("Номер",НомерДоговора);
																//ЗапросНеОплДог.УстановитьПараметр("Дата",ДатаФормирования);
																//																
																//РезНеОплДог = ЗапросНеОплДог.Выполнить().Выгрузить();
																//ЕстьНеоплДог = РезНеОплДог.Количество();
																// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																
																// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже,
																НомерДоговораПрошл, ДатаДоговораПрошл );
																// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																
															КонецЕсли;
															
														КонецЕсли; 
														
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														//ПериодНач = НачалоМесяца(ДобавитьМесяц(СтрокаСтаж.НачалоРабот,1));
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														ПериодНач = НачалоГода( ДобавитьМесяц( СтрокаСтаж.НачалоРабот, 12 ) );
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														//Если Год( СтрокаСтаж.НачалоРабот ) < Год( СтрокаСтаж.ОкончаниеРабот )  Тогда
														//	
														//	Пока ПериодНач <= НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) Цикл
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														
														// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														Пока Год( ПериодНач ) <= Год( ВерхняяГраницаПериода ) Цикл
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															//ДатаФормирования = ПериодНач; //О.Т. Аверсон 22.04.2019 № 4269 //СтрЗаменить(СтрокаСтаж.НачалоРабот,"2011","2012");
															//ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
															//МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
															//ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
															//ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															ДатаНачалаРабот   = Формат( ПериодНач, "ДФ=""дд/ММ/гггг""" );
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
															ДатаНачалаДоговора = СтрокаСтаж.НачалоРабот;
															ДатаОкончанияДоговора = СтрокаСтаж.ОкончаниеРабот;
															
															
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															//Если НачалоМесяца(ПериодНач) = НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) Тогда
															//	ДатаФормирования = СтрокаСтаж.ОкончаниеРабот;
															//иначе
															//	ДатаФормирования = КонецМесяца(ПериодНач);
															//КонецЕсли;
															//ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
															//МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
															//ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
															//ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															Если Год( ПериодНач ) < Год( ВерхняяГраницаПериода ) Тогда
																ДатаФормирования = КонецГода( ПериодНач );
															иначе
																ДатаФормирования = ВерхняяГраницаПериода;
															КонецЕсли;
															ДатаОкончанияРабот = Формат( ДатаФормирования, "ДФ=""дд/ММ/гггг""" );
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
															
															
															
															Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
																
																// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																//ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(
																//	Новый Структура( "Сотрудник, ДатаНачалаРабот, ДатаОкончанияРабот, ВидДеятельности",
																//	ВыборкаПоРаботникиОрганизации.Сотрудник, ПериодНач, НачалоДня( ДатаФормирования ), НеоплДог ) ); 
																//
																//ЗначВидДеят = Неопределено;
																//Если ЗначСведенияОСтаже.Количество()>0 Тогда 
																//	ЗначВидДеят = ЗначСведенияОСтаже[0].ВидДеятельности;																
																//КонецЕсли;
																//
																//СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот + "= ="
																//	 + СокрЛП( ?( ЗначениеЗаполнено( ЗначВидДеят ), ЗначВидДеят, СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
																// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																
																// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже,
																НомерДоговораПрошл, ДатаДоговораПрошл );
																СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот + "= =" 
																+ СокрЛП( ?( ЕстьНеоплДог, "НЕОПЛДОГ", СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
																// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																
																ТекстФайла.ДобавитьСтроку( СтрокаЗар );
																ТекСтрока = ТекСтрока + 1;
																
																// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
																КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
																// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
																
															КонецЕсли;
															
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															//КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1; //О.Т. 09.03.2015 № ниже суммируется
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
															Если Категория = "03" тогда
																НомерДоговора = СокрЛП(НомерДоговораПрошл);
																ДатаФормирования = ДатаДоговораПрошл;
																ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
																МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
																ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
																ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
																
																// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																//ЗапросНеОплДог = Новый Запрос;
																//ЗапросНеОплДог.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
																//ЗапросНеОплДог.Текст = "
																//| Выбрать 
																//| ТЧСведОСтаже.Сотрудник,
																//| ТЧСведОСтаже.Договор,
																//| ТЧСведОСтаже.ВидДеятельности
																//| Поместить ВТТЧСведОСтаже
																//| из &ТЧСведОСтаже как ТЧСведОСтаже
																//| ГДЕ ТЧСведОСтаже.Сотрудник = &Сотрудник ";
																//ЗапросНеОплДог.УстановитьПараметр("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
																//ЗапросНеОплДог.УстановитьПараметр("НеОплДог",НеоплДог);
																//ЗапросНеОплДог.УстановитьПараметр("ТЧСведОСтаже",СведенияОСтаже);
																//
																//ЗапросНеОплДог.Выполнить();
																//ЗапросНеОплДог.Текст = "
																//| Выбрать 
																//| ТЧСведОСтаже.Сотрудник,
																//| ТЧСведОСтаже.Договор,
																//| ТЧСведОСтаже.ВидДеятельности
																//| из ВТТЧСведОСтаже как ТЧСведОСтаже
																////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
																////| ГДЕ ТЧСведОСтаже.Договор.Номер = &Номер и ТЧСведОСтаже.Договор.ДатаНачала = &Дата и ТЧСведОСтаже.ВидДеятельности = &НеОплДог ";
																////- СВЭЙ КДЯ 25.07.19 СВФР-004561
																////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
																//| ГДЕ ТЧСведОСтаже.Договор.НомерДляПУ = &Номер и ТЧСведОСтаже.Договор.ДатаНачала = &Дата и ТЧСведОСтаже.ВидДеятельности = &НеОплДог ";
																////- СВЭЙ КДЯ 25.07.19 СВФР-004561
																// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																
																Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
																	СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"=");
																	
																	// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																	//ЗапросНеОплДог.УстановитьПараметр("Номер",НомерДоговора);
																	//ЗапросНеОплДог.УстановитьПараметр("Дата",ДатаФормирования);
																	//																
																	//РезНеОплДог = ЗапросНеОплДог.Выполнить().Выгрузить();
																	//ЕстьНеоплДог = РезНеОплДог.Количество();
																	// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																	
																	// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																	ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже );
																	// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
																	
																КонецЕсли;
															КонецЕсли;
															
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															//ПериодНач = ДобавитьМесяц(ПериодНач,1);
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															ПериодНач = НачалоГода( ДобавитьМесяц( ПериодНач, 12 ) );
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															//	КонецЦикла; // ПериодНач <= НачалоМесяца(СтрокаСтаж.ОкончаниеРабот)
															//КонецЕсли; // Год( СтрокаСтаж.НачалоРабот ) < Год( СтрокаСтаж.ОкончаниеРабот )
															// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
															
															// + СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														КонецЦикла; // Пока Год( ПериодНач ) <= Год( СтрокаСтаж.ОкончаниеРабот ) 
														// - СВЭЙ КДЯ 21.08.19 СВФР-004631 ( пункт 10. )
														
														
														ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
														ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
														
														
													КонецЕсли;
												КонецЕсли;
												
											КонецЦикла;
											
										КонецЕсли;							
										
									КонецЕсли;
									
									
									если НазначениеПенсии Тогда 
										ТипЗаписиНач2 = "СТАЖ=";
										Структура = Новый Структура;
										// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										//Если ОбъединятьОсновные Тогда 
										// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										Если НЕ ОбъединятьОсновные Тогда 
											// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
											Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
										иначе
											Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
										КонецЕсли;
										если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
											Структура.Вставить("ВидДоговора",null);
										Иначе 
											Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
											// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
											Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
												Структура.Вставить("НомерДокумента",НомерДоговораПрошл);
												//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
												//Структура.Вставить("ДатаДляПУ",ДатаДоговораПрошл);
												//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
												
												//Аверсон ЕАЕ 17.02.2023 СВФР-010250
												Структура.Вставить("ДатаДокумента",ДатаДоговораПрошл);
												//Аверсон СВФР-010250
												
											КонецЕсли;
											// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										КонецЕсли;
										ПериодПенсии = СтрокиПоРаботнику1[СтрокиПоРаботнику1.Количество()-1].Период;
										ДеньШапки        = ?(День(НачалоМесяца(ПериодПенсии))<10,"0","")+День(НачалоМесяца(ПериодПенсии));
										МесяцШапки       = ?(Месяц(НачалоМесяца(ПериодПенсии))<10,"0","")+Месяц(НачалоМесяца(ПериодПенсии));
										ГодШапки 		 = Строка(СокрЛП(Формат(Год(НачалоМесяца(ПериодПенсии)), "ЧГ=0")));
										ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										ДеньШапки        = ?(День(КонецМесяца(ПериодПенсии))<10,"0","")+День(КонецМесяца(ПериодПенсии));
										МесяцШапки       = ?(Месяц(КонецМесяца(ПериодПенсии))<10,"0","")+Месяц(КонецМесяца(ПериодПенсии));
										ГодШапки 		 = Строка(СокрЛП(Формат(Год(КонецМесяца(ПериодПенсии)), "ЧГ=0")));
										ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										
										
										СтрокаЗар = ВРЕГ(ТипЗаписиНач2+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="+"ПЕНСИЯ= = =");
										ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										ТекСтрока = ТекСтрока+1;
										ПенсияВыгружена = Истина;
									КонецЕсли;
									
									ТипЗаписиНач3 = "СТАЖ=";
									СтруктураДети = Новый Структура;
									// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									//Если ОбъединятьОсновные Тогда 
									// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									Если НЕ ОбъединятьОсновные Тогда 
										// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										СтруктураДети.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
									иначе
										СтруктураДети.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
									КонецЕсли;
									если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
										СтруктураДети.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
									Иначе 
										СтруктураДети.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
										// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
											СтруктураДети.Вставить( "НомерДокумента", НомерДоговораПрошл );
											//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											//СтруктураДети.Вставить( "ДатаДляПУ", ДатаДоговораПрошл );
											//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											
											//Аверсон ЕАЕ 17.02.2023 СВФР-010250
											СтруктураДети.Вставить( "ДатаДокумента", ДатаДоговораПрошл );
											//Аверсон СВФР-010250
											
										КонецЕсли;
										// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									КонецЕсли;
									
									// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									//СтруктураДети.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ"));
									//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураДети); 
									// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									СтруктураДети.Вставить( "ВидДеятельности", "ДЕТИ" );
									СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураДети ); 
									// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									
									//Аверсон ЕАЕ 17.04.2022 СВФР-008941
									//Здесь нужно добавить строки по работникам с видами деятельности ДЕТИ100, ДЕТИ50, ДПОСОБ100, ДПОСОБ50
									МассивВидовДеятельностиДети = Новый Массив;
									МассивВидовДеятельностиДети.Добавить("ДЕТИ0");
									МассивВидовДеятельностиДети.Добавить("ДЕТИ100");
									МассивВидовДеятельностиДети.Добавить("ДЕТИ50");
									МассивВидовДеятельностиДети.Добавить("ДПОСОБ100");
									МассивВидовДеятельностиДети.Добавить("ДПОСОБ50");
									Для Каждого ВД Из МассивВидовДеятельностиДети Цикл
										СтруктураДети.ВидДеятельности = ВД;
										СтрПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки(СтруктураДети);
										Для Каждого Эл Из СтрПоРаботнику Цикл
											СтрокиПоРаботнику.Добавить(Эл);	
										КонецЦикла;
									КонецЦикла;
									//Аверсон СВФР-008941
									
									//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
									ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
									//- СВЭЙ КДЯ 25.07.19 СВФР-004561
									
									ПредыдущийВидДейтельности = "";
									ПредыдущееОкончаниеРабот = "";
									ДатаНачалаРабот = "";
									
									Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
										если не (ДатаДоговораПрошл >= СтрокаСтаж.ДатаНачалаРабот и  ДатаДоговораПрошл <= СтрокаСтаж.ДатаОкончанияРабот) Тогда 
											Продолжить;
										КонецЕсли;
										
										ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										
										ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										//Аверсон ЕАЕ 17.04.2022 СВФР-008941
										//СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ДЕТИ"+"= = =");
										ДетиСтр = СокрЛП(СтрокаСтаж.ВидДеятельности);
										КолДетей = ПолучитьКоличествоДетей(СтрокаСтаж.ФизЛицо, СтрокаСтаж.ДатаНачалаРабот);
										КолДетейСтр = СокрЛП(КолДетей);
										СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+ ДетиСтр +"=" + КолДетейСтр + "= =");
										//Аверсон СВФР-008941
										
										ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										ТекСтрока = ТекСтрока+1;
										ДетиВыгружена = Истина;
										//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
										//ДетиЕсть = Истина;
										//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
										
										//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
										КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
										//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
										
										//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										//ТекСтрока = ТекСтрока+1;
										//КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
										//Если Категория = "03" тогда
										//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
										//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
										//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
										//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
										//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
										//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
										//КонецЕсли;
										//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
										//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
										
									КонецЦикла;
									
									
									
									ТипЗаписиНач3 = "СТАЖ=";
									СтруктураПособие = Новый Структура;
									// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									//Если ОбъединятьОсновные Тогда 
									// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									Если НЕ ОбъединятьОсновные Тогда 
										// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										СтруктураПособие.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
									иначе
										СтруктураПособие.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
									КонецЕсли; 
									
									если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
										СтруктураПособие.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
									Иначе 
										//СтруктураПособие.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
										// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										СтруктураПособие.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
										Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
											СтруктураПособие.Вставить( "НомерДокумента", НомерДоговораПрошл );
											//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											//СтруктураПособие.Вставить( "ДатаДляПУ", ДатаДоговораПрошл );
											//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											
											//Аверсон ЕАЕ 17.02.2023 СВФР-010250
											СтруктураПособие.Вставить( "ДатаДокумента", ДатаДоговораПрошл );
											//Аверсон СВФР-010250
											
										КонецЕсли;
										// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									КонецЕсли;
									
									// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									//СтруктураПособие.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБИЕ") );
									//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураПособие); 
									// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									СтруктураПособие.Вставить( "ВидДеятельности", "ПОСОБИЕ" );
									СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураПособие ); 
									// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									
									//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
									ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
									//- СВЭЙ КДЯ 25.07.19 СВФР-004561
									
									ПредыдущийВидДейтельности = "";
									ПредыдущееОкончаниеРабот = "";
									ДатаНачалаРабот = "";
									
									Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
										//О.Т. Аверсон 23.08.2018 № 2335
										Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
											Если СтрокаСтаж.Договор <> ДокументОснованиеПрошл Тогда 
												Продолжить;								
											КонецЕсли;
										иначе
											//+ СВЭЙ КДЯ 01.11.19 СВФР-004631 ( Пункт 57. ) СВФР-004969
											//если не (ДатаДоговораПрошл >= СтрокаСтаж.ДатаНачалаРабот и  ДатаДоговораПрошл <= СтрокаСтаж.ДатаОкончанияРабот) Тогда 
											//	Продолжить;
											//КонецЕсли;
											//- СВЭЙ КДЯ 01.11.19 СВФР-004631 ( Пункт 57. ) СВФР-004969
										КонецЕсли;
										//О.Т. Аверсон 23.08.2018 № 2335
										
										ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот;//О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										
										ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ПОСОБИЕ"+"= = =");
										ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										ТекСтрока = ТекСтрока+1;
										ПособиеВыгружена = Истина;
										
										//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										//ТекСтрока = ТекСтрока+1;
										КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;//О.Т. 09.03.2015 № ниже суммируется
										//Если Категория = "03" тогда
										//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
										//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
										//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
										//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
										//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
										//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
										//КонецЕсли;
										//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
										//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
										
									КонецЦикла;
									
									//О.Т. Аверсон 21.05.2018 № 1985
									ТипЗаписиНач3 = "СТАЖ=";
									СтруктураПособие = Новый Структура;
									// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									//Если ОбъединятьОсновные Тогда 
									// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									Если НЕ ОбъединятьОсновные Тогда 
										// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										СтруктураПособие.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
									иначе
										СтруктураПособие.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
									КонецЕсли; 
									если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
										СтруктураПособие.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
									Иначе 
										//СтруктураПособие.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
										// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										СтруктураПособие.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
										Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
											СтруктураПособие.Вставить( "НомерДокумента", НомерДоговораПрошл );
											//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											//СтруктураПособие.Вставить( "ДатаДляПУ", ДатаДоговораПрошл );
											//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. ) 
											
											//Аверсон ЕАЕ 17.02.2023 СВФР-010250
											СтруктураПособие.Вставить( "ДатаДокумента", ДатаДоговораПрошл );
											//Аверсон СВФР-010250
											
										КонецЕсли;
										// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									КонецЕсли;
									
									// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									//СтруктураПособие.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "СТРАХСЛУЧ" ) );
									//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( СтруктураПособие ); 
									// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									
									// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									СтруктураПособие.Вставить( "ВидДеятельности", "СТРАХСЛУЧ" );
									СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураПособие ); 
									// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									
									
									ПредыдущийВидДейтельности = "";
									ПредыдущееОкончаниеРабот = "";
									ДатаНачалаРабот = "";
									
									Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
										если не (ДатаДоговораПрошл >= СтрокаСтаж.ДатаНачалаРабот и  ДатаДоговораПрошл <= СтрокаСтаж.ДатаОкончанияРабот) Тогда 
											Продолжить;
										КонецЕсли;
										
										ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										
										ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"СТРАХСЛУЧ"+"= = =");
										ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										ТекСтрока = ТекСтрока+1;
										СтрахСлучВыгружена = Истина;
										
										//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										//ТекСтрока = ТекСтрока+1;
										КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;//О.Т. 09.03.2015 № ниже суммируется
										//Если Категория = "03" тогда
										//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
										//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
										//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
										//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
										//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
										//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
										//КонецЕсли;
										//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
										//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
										
									КонецЦикла;
									//О.Т. Аверсон 21.05.2018 № 1985
									
									
									ТипЗаписиНач3 = "СТАЖ=";
									СтруктураПособие = Новый Структура;
									// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									//Если ОбъединятьОсновные Тогда 
									// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
									Если НЕ ОбъединятьОсновные Тогда 
										// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										СтруктураПособие.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
									иначе
										СтруктураПособие.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
									КонецЕсли; 
									если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
										СтруктураПособие.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
									Иначе 
										//СтруктураПособие.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
										// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										СтруктураПособие.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
										Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
											СтруктураПособие.Вставить( "НомерДокумента", НомерДоговораПрошл );
											//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											//СтруктураПособие.Вставить( "ДатаДляПУ", ДатаДоговораПрошл );
											//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
											
											//Аверсон ЕАЕ 17.02.2023 СВФР-010250
											СтруктураПособие.Вставить( "ДатаДокумента", ДатаДоговораПрошл );
											//Аверсон СВФР-010250
											
										КонецЕсли;
										// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									КонецЕсли;
									
									// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									//СтруктураПособие.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПРЕМИЯ"));
									//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураПособие); 
									// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									
									// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									СтруктураПособие.Вставить( "ВидДеятельности", "ПРЕМИЯ" );
									СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураПособие ); 
									// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
									
									
									//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
									ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
									//- СВЭЙ КДЯ 25.07.19 СВФР-004561
									
									ПредыдущийВидДейтельности = "";
									ПредыдущееОкончаниеРабот = "";
									ДатаНачалаРабот = "";
									
									Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
										если не (ДатаДоговораПрошл >= СтрокаСтаж.ДатаНачалаРабот и  ДатаДоговораПрошл <= СтрокаСтаж.ДатаОкончанияРабот) Тогда 
											Продолжить;
										КонецЕсли;
										
										ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										
										ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ПРЕМИЯ"+"= = =");
										ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										ТекСтрока = ТекСтрока+1;
										ПремияВыгружена = Истина;
										
										//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										//ТекСтрока = ТекСтрока+1;
										КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;//О.Т. 09.03.2015 № ниже суммируется
										//Если Категория = "03" тогда
										//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
										//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
										//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
										//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
										//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
										//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
										//КонецЕсли;
										//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
										//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
										
									КонецЦикла;
									
									Если (СтрокаМес.НомерДокумента <> НомерДоговораПрошл или СтрокаМес.ДатаДокумента <> ДатаДоговораПрошл) и НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
										ТипЗаписиНач3 = "СТАЖ=";
										СтруктураВзносыВр = Новый Структура;
										// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										//Если ОбъединятьОсновные Тогда 
										// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
										Если НЕ ОбъединятьОсновные Тогда 
											// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
											СтруктураВзносыВр.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
										иначе
											СтруктураВзносыВр.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
										КонецЕсли; 
										если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
											СтруктураВзносыВр.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
										Иначе 
											СтруктураВзносыВр.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
											// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
											Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
												СтруктураВзносыВр.Вставить( "НомерДокумента", НомерДоговораПрошл );
												//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
												//СтруктураВзносыВр.Вставить( "ДатаДляПУ", ДатаДоговораПрошл );
												//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
												
												//Аверсон ЕАЕ 17.02.2023 СВФР-010250
												СтруктураВзносыВр.Вставить( "ДатаДокумента", ДатаДоговораПрошл );
												//Аверсон СВФР-010250
												
											КонецЕсли;
											// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										КонецЕсли;
										
										// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										//СтруктураВзносыВр.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВЗНОСЫВРЕМ"));
										//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураВзносыВр); 
										// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										
										// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										СтруктураВзносыВр.Вставить( "ВидДеятельности", "ВЗНОСЫВРЕМ" );
										СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураВзносыВр ); 
										// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										
										
										// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
										// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
										
										ПредыдущийВидДейтельности = "";
										ПредыдущееОкончаниеРабот = "";                                   
										ДатаНачалаРабот = "";
										// + СВЭЙ КДЯ 22.08.19 СВФР-004631 ( пункт 10. )
										//Прерывание = Ложь;
										// - СВЭЙ КДЯ 22.08.19 СВФР-004631 ( пункт 10. )
										Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
											
											// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
											//// + СВЭЙ КДЯ 22.08.19 СВФР-004631 ( пункт 10. )
											//если НомерДоговораПрошл <> ПолучитьНомерДокументаДляПУ( СтрокаСтаж.Договор ) 
											//	 ИЛИ ДатаДоговораПрошл <> ПолучитьДатуДокументаДляПУ( СтрокаСтаж.Договор ) Тогда 
											//	Продолжить;
											//КонецЕсли;
											//// - СВЭЙ КДЯ 22.08.19 СВФР-004631 ( пункт 10. )
											// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
											
											// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
											Если НомерДоговораПрошл <> СтрокаСтаж.НомерДокумента
												//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
												//ИЛИ ДатаДоговораПрошл <> СтрокаСтаж.ДатаДляПУ
												//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
												
												//Аверсон ЕАЕ 17.02.2023 СВФР-010250
												ИЛИ ДатаДоговораПрошл <> СтрокаСтаж.ДатаДокумента
												//Аверсон СВФР-010250
												
												Тогда 
												Продолжить;
											КонецЕсли;
											// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
											
											// + СВЭЙ КДЯ 22.08.19 СВФР-004631 ( пункт 10. )
											//если не (ДатаДоговораПрошл >= СтрокаСтаж.ДатаНачалаРабот и  ДатаДоговораПрошл <= СтрокаСтаж.ДатаОкончанияРабот) Тогда 
											//	Продолжить;
											//КонецЕсли;
											//если Прерывание Тогда 
											//	Продолжить;
											//КонецЕсли;
											//если КатегорияВывод = "ДОГОВОР" Тогда
											//	
											//	если не ДатаНачалаДоговора = Дата(1,1,1) Тогда 
											//		ДатаФормированияДети = ДатаНачалаДоговора; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
											//		Прерывание = Истина;
											//	иначе
											//		ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
											//	КонецЕсли;
											//	
											//иначе
											//	ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
											//КонецЕсли;
											//
											//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
											//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
											//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
											//ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
											//
											//
											//если КатегорияВывод = "ДОГОВОР" Тогда 
											//	Если НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <> НачалоМесяца(ДатаОкончанияДоговора) и Год(СтрокаСтаж.ДатаНачалаРабот) < Год(ДатаОкончанияДоговора) Тогда
											//		ДатаФормированияДети = КонецМесяца(СтрокаСтаж.ДатаНачалаРабот);
											//	иначе
											//		если не ДатаОкончанияДоговора = Дата(1,1,1) Тогда 
											//			ДатаФормированияДети = ДатаОкончанияДоговора;
											//			
											//		иначе
											//			ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
											//		КонецЕсли;
											//	КонецЕсли;
											//иначе
											//	ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
											//КонецЕсли;
											//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
											//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
											//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
											//ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
											//
											//СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ВЗНОСЫВРЕМ"+"= = =");
											//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
											//ТекСтрока = ТекСтрока+1;
											//сТРОК = ТекстФайла.ПолучитьТекст();
											//ВзносыВрВыгружена = Истина;
											//
											////ТекстФайла.ДобавитьСтроку(СтрокаЗар);
											////ТекСтрока = ТекСтрока+1;
											//КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;//О.Т. 09.03.2015 № ниже суммируется
											//
											//ПериодНач = НачалоМесяца(ДобавитьМесяц(СтрокаСтаж.ДатаНачалаРабот,1));
											//Если Год(СтрокаСтаж.ДатаНачалаРабот) < Год(ДатаОкончанияДоговора)  Тогда															
											//	Пока ПериодНач <= НачалоМесяца(ДатаОкончанияДоговора) Цикл 
											//		
											//		
											//		если КатегорияВывод = "ДОГОВОР" Тогда 
											//			если не ДатаНачалаДоговора = Дата(1,1,1) Тогда 
											//				ДатаФормированияДети = ПериодНач; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
											//				Прерывание = Истина;
											//			иначе
											//				ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
											//			КонецЕсли;
											//		иначе
											//			ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
											//		КонецЕсли;
											//		
											//		ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
											//		МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
											//		ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
											//		ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
											//		
											//		
											//		если КатегорияВывод = "ДОГОВОР" Тогда
											//			Если НачалоМесяца(ПериодНач) <> НачалоМесяца(ДатаОкончанияДоговора) и Год(СтрокаСтаж.ДатаНачалаРабот) < Год(ДатаОкончанияДоговора) Тогда
											//				ДатаФормированияДети = КонецМесяца(ПериодНач);
											//			иначе
											//				
											//				если не ДатаОкончанияДоговора = Дата(1,1,1) Тогда 
											//					ДатаФормированияДети = ДатаОкончанияДоговора;
											//				иначе
											//					ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
											//				КонецЕсли;
											//			КонецЕсли;
											//		иначе
											//			ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
											//		КонецЕсли;
											//		ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
											//		МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
											//		ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
											//		ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
											//		
											//		СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ВЗНОСЫВРЕМ"+"= = =");
											//		ТекстФайла.ДобавитьСтроку(СтрокаЗар);
											//		ТекСтрока = ТекСтрока+1;
											//		сТРОК = ТекстФайла.ПолучитьТекст();
											//		ВзносыВрВыгружена = Истина;
											//		
											//		//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
											//		//ТекСтрока = ТекСтрока+1;
											//		КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;//О.Т. 09.03.2015 № ниже суммируется
											//		
											//		ПериодНач = ДобавитьМесяц(ПериодНач,1);
											//	КонецЦикла;
											//КонецЕсли;
											// - СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
											
											// + СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
											НижняяГраницаПериода = Макс( СтрокаСтаж.ДатаНачалаРабот, Дата( 2014, 1, 1 ) );  //Задача № 4269 Аверсон 22.04.2019
											ВерхняяГраницаПериода = Мин( ДатаОкончания, СтрокаСтаж.ДатаОкончанияРабот );
											
											ДатаНачалаРаботСтрокой = Формат( НижняяГраницаПериода, "ДФ=""дд/ММ/гггг""" );
											
											если КатегорияВывод = "ДОГОВОР" Тогда
												Если Год( НижняяГраницаПериода ) < Год( ВерхняяГраницаПериода ) Тогда
													ДатаОкончанияРабот = КонецГода( НижняяГраницаПериода );
												иначе
													ДатаОкончанияРабот = ВерхняяГраницаПериода;
												КонецЕсли;
											иначе
												ДатаОкончанияРабот = ВерхняяГраницаПериода;
											КонецЕсли;
											ДатаОкончанияРаботСтрокой  = Формат( ДатаОкончанияРабот, "ДФ=""дд/ММ/гггг""" );
											
											
											СтрокаЗар = ВРЕГ( ТипЗаписиНач3 + ДатаНачалаРаботСтрокой + "=" + ДатаОкончанияРаботСтрокой + "= =" + "ВЗНОСЫВРЕМ" + "= = =" );
											ТекстФайла.ДобавитьСтроку( СтрокаЗар );
											ТекСтрока = ТекСтрока + 1;
											ВзносыВрВыгружена = Истина;
											КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
											
											
											ПериодНач = НачалоГода( ДобавитьМесяц( НижняяГраницаПериода, 12 ) );
											Пока Год( ПериодНач ) <= Год( ВерхняяГраницаПериода ) Цикл
												
												ДатаНачалаРаботСтрокой = Формат( ПериодНач, "ДФ=""дд/ММ/гггг""" );
												ДатаОкончанияРаботСтрокой = Формат( Мин( КонецГода( ПериодНач ), ВерхняяГраницаПериода ), "ДФ=""дд/ММ/гггг""" );
												
												СтрокаЗар = ВРЕГ( ТипЗаписиНач3 + ДатаНачалаРаботСтрокой + "=" + ДатаОкончанияРаботСтрокой + "= =" + "ВЗНОСЫВРЕМ" + "= = =" );
												ТекстФайла.ДобавитьСтроку( СтрокаЗар );
												ТекСтрока = ТекСтрока + 1;
												ВзносыВрВыгружена = Истина;
												
												КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
												ПериодНач = НачалоГода( ДобавитьМесяц( ПериодНач, 12 ) );
												
											КонецЦикла; // Пока Год( ПериодНач ) <= Год( ВерхняяГраницаПериода ) Цикл
											// - СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
											
											//Если Категория = "03" тогда
											//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
											//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
											//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
											//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
											//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
											//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
											//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
											//КонецЕсли;
											//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
											//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
											
										КонецЦикла;
									КонецЕсли;
									//О.Т. Аверсон 16.03.2017 № 362
									//СтрокаФайла1 = ВРЕГ(СтрокаФайла+ ?(РаботДоход = 0, " ", СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
									//?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
									//?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
									//?(РаботВзнос1 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос1,"ЧГ=0"))))+"="+
									//?(РаботВзнос2 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос2,"ЧГ=0"))))+"="+
									//?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
									//?(РаботВзнос3 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос3,"ЧГ=0"))))+"="+
									//Формат(КоличествоМес,"ЧГ=0")+"="+?(СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0")))="0","0",СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0"))))+"="+ДатаЗаполнения+"= ="+Формат(ГОД(ДатаРегистрации),"ЧГ=0")+"="+СтрЗаменить(ТелефонОрганизации," ",""))+"=";
									//ДоговорНом = ?(ЗначениеЗаполнено(НомерДоговора),СтрЗаменить(Число(НомерДоговора)," ",""),"");
									//ДоговорДата = ?(ЗначениеЗаполнено(ДатаДокумента),ДатаДокумента,"");
									//СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+ДоговорНом+"="+ДоговорДата+"=");
									//О.Т. Аверсон 16.03.2017 № 362
									
									//Аверсон ЕАЕ 21.07.2021 СВФР-007783
									//Вывод ПрофДоп
									ТипЗаписиНач3 = "СТАЖ=";
									СтруктураПрофДоп = Новый Структура;
									Если НЕ ОбъединятьОсновные Тогда 
										СтруктураПрофДоп.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
									иначе
										СтруктураПрофДоп.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
									КонецЕсли; 
									если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
										СтруктураПрофДоп.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
									Иначе 
										СтруктураПрофДоп.Вставить("ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора);
										Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
											СтруктураПрофДоп.Вставить("НомерДокумента", НомерДоговораПрошл);
											
											//Аверсон ЕАЕ 17.02.2023 СВФР-010250
											СтруктураПрофДоп.Вставить("ДатаДокумента", ДатаДоговораПрошл);
											//Аверсон СВФР-010250
										КонецЕсли;
									КонецЕсли;
									СтруктураПрофДоп.Вставить("ВидДеятельности", "ПРОФДОП");
									СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки(СтруктураПрофДоп); 
									
									ПредыдущийВидДейтельности = "";
									ПредыдущееОкончаниеРабот = "";
									ДатаНачалаРабот = "";
									
									Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
										если не (ДатаДоговораПрошл >= СтрокаСтаж.ДатаНачалаРабот и  ДатаДоговораПрошл <= СтрокаСтаж.ДатаОкончанияРабот) Тогда 
											Продолжить;
										КонецЕсли;
										
										ДатаФормированияПрофДоп = СтрокаСтаж.ДатаНачалаРабот;
										ДеньШапкиПрофДоп        = ?(День(ДатаФормированияПрофДоп)<10,"0","")+День(ДатаФормированияПрофДоп);
										МесяцШапкиПрофДоп       = ?(Месяц(ДатаФормированияПрофДоп)<10,"0","")+Месяц(ДатаФормированияПрофДоп);
										ГодШапкиПрофДоп 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаНачалаРаботПрофДоп   = ДеньШапкиПрофДоп+"/"+МесяцШапкиПрофДоп+"/"+ГодШапкиПрофДоп;
										
										
										ДатаФормированияПрофДоп = СтрокаСтаж.ДатаОкончанияРабот;
										ДеньШапкиПрофДоп        = ?(День(ДатаФормированияПрофДоп)<10,"0","")+День(ДатаФормированияПрофДоп);
										МесяцШапкиПрофДоп       = ?(Месяц(ДатаФормированияПрофДоп)<10,"0","")+Месяц(ДатаФормированияПрофДоп);
										ГодШапкиПрофДоп 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияПрофДоп), "ЧГ=0")));
										ДатаОкончанияРаботПрофДоп   = ДеньШапкиПрофДоп+"/"+МесяцШапкиПрофДоп+"/"+ГодШапкиПрофДоп;
										
										СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботПрофДоп+"="+ДатаОкончанияРаботПрофДоп+"= ="+"ПРОФДОП"+"= = =");
										ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										ТекСтрока = ТекСтрока+1;
										ПрофДопВыгружена = Истина;
										
										КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
										
									КонецЦикла;
									//Аверсон СВФР-007783
									
									ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар+">");
									ТекстФайла.ДобавитьСтроку(СтрокаФайла1); 
									ТекСтрока = ТекСтрока+1;
									
									
									//+ СВЭЙ КДЯ 22.10.19 СВФР-004948
									Если ЗначениеЗаполнено( НомерДоговора ) И ЗначениеЗаполнено( ДатаДокумента ) Тогда
										ДопСтрокаФайла1 = СтрЗаменить( НомерДоговора, " ", "" ) + "=" +  Формат( ДатаДокумента, "ДФ=""дд/ММ/гггг""" ) + "=" ;
										//+ СВЭЙ КДЯ 25.10.19 СВФР-004631 ( Пункт 48. )
										//ИначеЕсли ЗначениеЗаполнено( НомерДоговораПрошл ) И ЗначениеЗаполнено( ДатаДоговораПрошл ) Тогда
										//	ДопСтрокаФайла1 = СтрЗаменить( НомерДоговораПрошл, " ", "" ) + "=" +  Формат( ДатаДоговораПрошл, "ДФ=""дд/ММ/гггг""" ) + "=" ;
										//- СВЭЙ КДЯ 25.10.19 СВФР-004631 ( Пункт 48. )
									Иначе
										ДопСтрокаФайла1 = "";
									КонецЕсли;		
									//- СВЭЙ КДЯ 22.10.19 СВФР-004948
									
									// + СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
									
									//+ СВЭЙ КДЯ 22.10.19 СВФР-004948
									//СтрокаФайла1 = ВРЕГ( ПрефиксСтрокаФайла1
									//- СВЭЙ КДЯ 22.10.19 СВФР-004948
									
									//+ СВЭЙ КДЯ 22.10.19 СВФР-004948
									СтрокаФайла1 = ВРЕГ( ПрефиксСтрокаФайла1 + ДопСтрокаФайла1
									//- СВЭЙ КДЯ 22.10.19 СВФР-004948
									
									
									
									+ ?(РаботДоход = 0, ?(ЕстьНеоплДог,"0"," "), СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
									?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
									?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
									?(РаботВзнос1 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос1,"ЧГ=0"))))+"="+
									?(РаботВзнос2 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос2,"ЧГ=0"))))+"="+
									?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
									?(РаботВзнос3 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос3,"ЧГ=0"))))+"="+
									
									?( ЕстьНеоплДог ИЛИ КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
									+ ?( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0) = 0, "0", Формат( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0 ), "ЧГ=0" ) )
									
									+ "=" + ДатаЗаполнения + "=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) + "=" 
									+ Формат( ГОД( ДатаНачала ),"ЧГ=0" ) + "=" + СтрЗаменить( ТелефонОрганизации, " ", "" ) ) + "=";
									// - СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
									
									
									если СчДляПУ > 0 Тогда 
										ТекстФайла.ЗаменитьСтроку(ТекСтрокаДляСтрПУ,СтрокаФайла1);
									иначе
										ТекстФайла.ЗаменитьСтроку(СтрокаЗамены,СтрокаФайла1);
									КонецЕсли;
									СчДляПУ = 1;
									ТекСтрокаДляСтрПУ = ТекСтрока;
									СчДляКолСтажа = 1;
									КоличествоЗаписейОСтаже = 0;
									
									
									ИтогДохода = ИтогДохода + РаботДоход;
									ИтогБольн = ИтогБольн + РаботБольн;
									ИтогВзнос = ИтогВзнос + РаботВзнос;
									ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
									ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
									ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
									
								КонецЕсли;
							иначе
								ТекстФайла.ДобавитьСтроку(СтрокаФайла);
								ТекСтрока = ТекСтрока+1;
							КонецЕсли;
							
							ТипЗаписиНач = "НЧСЛ=";
							//если Сч <= СтрокиПоРаботнику1.Количество()-1 Тогда 
							//	если не КатегорияВывод= "ДОГОВОР" Тогда
							//		ИтогДохода = ИтогДохода + РаботДоход;
							//		ИтогБольн = ИтогБольн + РаботБольн;
							//		ИтогВзнос = ИтогВзнос + РаботВзнос;
							//		ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
							//		ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
							//		ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
							//	иначе
							//		ИтогДохода = ИтогДохода + РаботДоход;
							//		ИтогБольн = ИтогБольн + РаботБольнСлед;
							//		ИтогВзнос = ИтогВзнос + РаботВзносСлед;
							//		ИтогВзнос1 = ИтогВзнос1 + РаботВзносСлед1;
							//		ИтогВзнос2 = ИтогВзнос2 + РаботВзносСлед2;
							//		ИтогВзнос3 = ИтогВзнос3 + РаботВзносСлед3;
							//		
							//	КонецЕсли;
							//иначе
							//	если КатегорияВывод= "ДОГОВОР" Тогда
							//		ИтогДохода = ИтогДохода + РаботДоход;
							//		ИтогБольн = ИтогБольн + РаботБольн;
							//		ИтогВзнос = ИтогВзнос + РаботВзнос;
							//		ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
							//		ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
							//		ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
							//		
							//	иначе
							//		ИтогДохода = ИтогДохода + РаботДоход;
							//		ИтогБольн = ИтогБольн + РаботБольн;
							//		ИтогВзнос = ИтогВзнос + РаботВзнос;
							//		ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
							//		ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
							//		ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
							//		
							//	КонецЕсли;
							//КонецЕсли;
							если СтрокаМес.НомерДокумента <> НомерДоговораПрошл или СтрокаМес.ДатаДокумента <> ДатаДоговораПрошл Тогда 
								РаботДоход = 0;
								РаботДоходСлед = 0;
								РаботБольнСлед = 0;
								РаботВзносСлед = 0;
								РаботВзносСлед1 = 0;
								РаботВзносСлед2 = 0;
								РаботВзносСлед3 = 0;
								РаботБольн = 0;
								РаботВзнос = 0;
								РаботВзнос1 = 0;
								РаботВзнос2 = 0;
								РаботВзнос3 = 0;
								КоличествоМес = 0; 
								КоличествоДокументов 	= КоличествоДокументов+1;
							КонецЕсли;
							
						КонецЕсли;
					КонецЕсли;
					
					//толик 	добавил округление - ЧДЦ=0;
					//Если (ЗначениеЗаполнено(СтрокаМес.СуммаДохода) Или ЗначениеЗаполнено(СтрокаМес.Больничные) или ЗначениеЗаполнено(СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд)) Тогда
					//Островская Татьяна 31.10.2012 № 15958
					если КатегорияВывод = 	"ДОГОВОР" Тогда 
						СтрокаМес.СуммаДохода = РезультатДоговор;
					иначе
						СтрокаМес.СуммаДохода = СтрокаМес.СуммаДохода - РезультатДоговор;
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 18.10.19 СВФР-004944
					//делаем определение вида налогообложения не зависящим от флага ОбъединятьОсновные ( см. ниже )
					////О.Т. Аверсон 29.08.2018 № 2363
					//Если ОбъединятьОсновные Тогда 
					//	ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
					//иначе
					//	Если ЗначениеЗаполнено(СтрокаМес.Сотрудник.ВидНалогообложенияОсновной) Тогда 
					//		ОсновнойВидНалогообл = СтрокаМес.Сотрудник.ВидНалогообложенияОсновной;
					//	иначе
					//		ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
					//	КонецЕсли;
					//КонецЕсли;
					////О.Т. Аверсон 29.08.2018 № 2363
					//- СВЭЙ КДЯ 18.10.19 СВФР-004944
					
					
					//+ СВЭЙ КДЯ 21.10.19 СВФР-004944
					//делаем определение вида налогообложения не зависящим от флага ОбъединятьОсновные
					Если ЗначениеЗаполнено( ВыборкаПоРаботникиОрганизации.Сотрудник.ВидНалогообложенияОсновной ) Тогда 
						ОсновнойВидНалогообл = ВыборкаПоРаботникиОрганизации.Сотрудник.ВидНалогообложенияОсновной;
					иначе
						ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
					КонецЕсли;
					//- СВЭЙ КДЯ 21.10.19 СВФР-004944
					
					СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокаМес.Период),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
					РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(СтрокаМес.Период) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
					БазаОграниченияФСЗН = СтруктураФСЗН.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
					
					Если СтрокаМес.СуммаДохода > БазаОграниченияФСЗН 
						//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
						И НЕ ВыгрузкаДоговоровПодрядаБезОграничения И ДогПодряда 
						//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
						Тогда 
						СтрокаМес.СуммаДохода = БазаОграниченияФСЗН;
					КонецЕсли;
					
					
					ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаОкончания,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер; //О.Т. Аверсон 22.06.2016 № 949
					СтрЗар = ?(СтрокаМес.СуммаДохода = 0, "0", СокрЛП(Строка(Формат(СтрокаМес.СуммаДохода,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					если не КатегорияВывод= "ДОГОВОР" Тогда
						СтрБлн = ?(СтрокаМес.Больничные = 0, "0", СокрЛП(Строка(Формат(СтрокаМес.Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					иначе
						СтрБлн = ?(СтрокаМес.Больничные = 0, "0", СокрЛП(Строка(Формат(СтрокаМес.Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					КонецЕсли;
					//О.Т. Аверсон 02.02.2018 № 1535
					СтрВзн1Число = ?(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.28,СтрокаМес.Период) = 0, 0, ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.28,СтрокаМес.Период));   
					//О.Т. Аверсон 02.02.2018 № 1535
					Если СКорректировкойФСЗН Тогда //О.Т. Аверсон 28.02.2018 № 1448
						
						//Аверсон 29.07.2020 КВВ СВФР-006298 (
						//СтрВзн = ?(не ЗначениеЗаполнено(СтрокаМес.ПенсионныйФонд), "0", СокрЛП(Строка(Формат(СтрокаМес.ПенсионныйФонд,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						ПенсФондФакт = ПолучитьФактичПФПриУвольнении(ВыборкаПоРаботникиОрганизации.Сотрудник,СтрокаМес.Период);
						ПенсФондВСтрВзн = ?(ПенсФондФакт<>0,ПенсФондФакт,СтрокаМес.ПенсионныйФонд);
						СтрВзн = ?(не ЗначениеЗаполнено(ПенсФондВСтрВзн), "0", СокрЛП(Строка(Формат(ПенсФондВСтрВзн,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						//Аверсон 29.07.2020 КВВ СВФР-006298 )
						
						//О.Т. Аверсон 02.02.2018 № 1535
						СтрВзнЧисло = ?(ЗначениеЗаполнено(СтрокаМес.ПенсионныйФонд),СтрокаМес.ПенсионныйФонд,0);
					иначе
						СтрВзн = ?(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.01,СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.01,СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						//О.Т. Аверсон 02.02.2018 № 1535
						СтрВзнЧисло = ?(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.01,СтрокаМес.Период) = 0, 0, ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.01,СтрокаМес.Период));
					КонецЕсли;
					СтрВзн1 = ?(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.28,СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.28,СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));   
					СуммаВсе = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.35,СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
					Если СКорректировкойФСЗН Тогда //О.Т. Аверсон 28.02.2018 № 1448
						Если ОбъединятьОсновные Тогда 
							МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("ФизЛицо,Период",СтрокаМес.ФизЛицо,СтрокаМес.Период));
						Иначе 
							МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("Сотрудник,Период",СтрокаМес.Сотрудник,СтрокаМес.Период));
						КонецЕсли;
						СуммаКоррект = 0;
						Для Каждого стр из МассивТЗСотрудники Цикл 
							СуммаКоррект = СуммаКоррект + ?(ЗначениеЗаполнено(стр.СуммаКорректировки),стр.СуммаКорректировки,0);							
						КонецЦикла;
						//Аверсон 21.05.2020 КВВ СВФР-005940 (
						Если (СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)="193357089" ИЛИ СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)="100993744" ИЛИ СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)="101505322") Тогда //СЛИВКИ-БАЙ все три
							СуммаВсе = ?(СуммаКоррект=0,СуммаВсе,ПолучитьСуммуПФиФСЗН(?(ОбъединятьОсновные,СтрокаМес.ФизЛицо,СтрокаМес.Сотрудник),СтрокаМес.Период));
						КонецЕсли;
						//Аверсон 21.05.2020 КВВ СВФР-005940 )
						СтрВзн2 = ?(СуммаВсе-СтрВзнЧисло-СтрВзн1Число+СуммаКоррект=0,"0",СтрЗаменить(СуммаВсе-СтрВзнЧисло-СтрВзн1Число+СуммаКоррект," ",""));
					иначе
						СтрВзн2 = ?(СуммаВсе-СтрВзнЧисло-СтрВзн1Число=0,"0",СтрЗаменить(СуммаВсе-СтрВзнЧисло-СтрВзн1Число," ",""));//О.Т. Аверсон 02.02.2018 № 1535
					КонецЕсли;
					СтрВзн3 = ?(ОбщегоНазначения.ОкруглитьЗначение2016(Число(СтрВзн1)+Число(СтрВзн2),СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(Число(СтрВзн1)+Число(СтрВзн2),СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));//О.Т. Аверсон 17.03.2016 № 949 
					
					
					//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					////строки следующие 
					//если КатегорияВывод = 	"ДОГОВОР"  и СтрокаМес.СуммаДохода = 0 и СтрокаМес.Больничные = 0 Тогда
					//	ПериодДляДоговора = СтрокаМес.Период;
					//	Продолжить;
					//КонецЕсли;
					//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					
					если Сч+2 <= СтрокиПоРаботнику1.Количество() Тогда  
						РезультатДоговор= 0;
						
						// + СВЭЙ КДЯ СВФР-004561 02.08.19 + 18.09.19 СВФР-004631 ( пункт 31. )
						Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
							// - СВЭЙ КДЯ СВФР-004561 02.08.19
							// + СВЭЙ КДЯ СВФР-004561 02.08.19 - 18.09.19 СВФР-004631 ( пункт 31. )
							//Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда ИЛИ ЕстьРасшифровкиДоговоров ) Тогда
							// - СВЭЙ КДЯ СВФР-004561 02.08.19
							
							если КатегорияВывод= "ДОГОВОР" Тогда
								// + СВЭЙ КДЯ СВФР-004631 17.09.19 ( пункт 28. )
								//ЗапросДог = Новый Запрос;
								//ЗапросДог.Текст = 
								//"ВЫБРАТЬ
								//|	ЕСНСведенияОДоходах.Результат как Результат
								//|ИЗ
								//|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
								//|ГДЕ
								//|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1";
								//Если ОбъединятьОсновные Тогда
								//	ЗапросДог.Текст = ЗапросДог.Текст + "
								//	|	И ЕСНСведенияОДоходах.ФизЛицо = &ФизЛицо";
								//иначе                                               									
								//	ЗапросДог.Текст = ЗапросДог.Текст + "
								//	|	И ЕСНСведенияОДоходах.Сотрудник = &Сотрудник";
								//КонецЕсли;
								//ЗапросДог.Текст = ЗапросДог.Текст + "     								
								//|	И ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН <> &ДоходБольничныйФСЗН";
								////|	И ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета = &СпособРасчета"; //О.Т. Аверсон 31.01.2017 № 244
								//Если не ОбъединятьОсновные Тогда
								//	ЗапросДог.УстановитьПараметр("Сотрудник",СтрокиПоРаботнику1[Сч+1].Сотрудник);
								//иначе
								//	ЗапросДог.УстановитьПараметр("ФизЛицо",СтрокиПоРаботнику1[Сч+1].ФизЛицо);
								//КонецЕсли;
								//ЗапросДог.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
								//ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов",НачалоМесяца(СтрокиПоРаботнику1[Сч+1].Период));
								//ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов1",КонецМесяца(СтрокиПоРаботнику1[Сч+1].Период));
								////ЗапросДог.УстановитьПараметр("СпособРасчета",Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой);
								//РезДог = ЗапросДог.Выполнить().Выбрать();
								//
								//пока РезДог.Следующий() Цикл 
								//	РезультатДоговор =РезультатДоговор+РезДог.Результат; 
								//КонецЦикла;
								// - СВЭЙ КДЯ СВФР-004631 17.09.19 ( пункт 28. )
								
								
								// + СВЭЙ КДЯ СВФР-004631 17.09.19 ( пункт 28. )
								
								//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 31. )
								Если ЗначениеЗаполнено( СтрокаМес.НомерДокумента ) Тогда
									//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 31. )
									
									ОтборДохода = Новый Структура( "ФизЛицо, Период, НомерДокумента, ДатаДокумента", 
									СтрокаМес.ФизЛицо, СтрокаМес.Период, СтрокаМес.НомерДокумента, СтрокаМес.ДатаДокумента );
									СтрокиДохода = ПромежуточнаяТаблица.НайтиСтроки( ОтборДохода );
									Для каждого СтрокаДохода Из СтрокиДохода Цикл
										РезультатДоговор = РезультатДоговор + СтрокаДохода.СуммаДохода;
									КонецЦикла;
									
									//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 31. )
								КонецЕсли; // ЗначениеЗаполнено( СледСтрокаМес.НомерДокумента ) Тогда
								//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 31. )
								
								// - СВЭЙ КДЯ СВФР-004631 17.09.19 ( пункт 28. )
								
								
							КонецЕсли;
						иначе
							РезультатДоговор = СтрокиПоРаботнику1[Сч+1].СуммаДохода ;
						КонецЕсли;
						
						если КатегорияВывод = 	"ДОГОВОР" Тогда 
							РаботДоходСл = РезультатДоговор;
						иначе
							РаботДоходСл = СтрокиПоРаботнику1[Сч+1].СуммаДохода - РезультатДоговор;
						КонецЕсли;
						//О.Т. Аверсон 29.08.2018 № 2363
						Если ОбъединятьОсновные Тогда
							ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
						иначе
							Если ЗначениеЗаполнено(СтрокиПоРаботнику1[Сч+1].Сотрудник.ВидНалогообложенияОсновной) Тогда 
								ОсновнойВидНалогообл = СтрокиПоРаботнику1[Сч+1].Сотрудник.ВидНалогообложенияОсновной;
							иначе
								ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
							КонецЕсли;
						КонецЕсли;
						//О.Т. Аверсон 29.08.2018 № 2363
						//О.Т. Аверсон 29.01.2018 № 1511
						СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокиПоРаботнику1[Сч+1].Период),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
						РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(СтрокиПоРаботнику1[Сч+1].Период) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
						БазаОграниченияФСЗН = СтруктураФСЗН.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
						
						Если РаботДоходСл > БазаОграниченияФСЗН Тогда 
							РаботДоходСл = БазаОграниченияФСЗН;
						КонецЕсли;
						//О.Т. Аверсон 29.01.2018 № 1511
						
						ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаОкончания,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер; //О.Т. Аверсон 22.06.2016 № 949
						СтрЗарСл = ?(РаботДоходСл = 0, "0", СокрЛП(Строка(Формат(РаботДоходСл,"ЧДЦ=0;ЧГ=0"))));
						если не КатегорияВывод= "ДОГОВОР" Тогда
							СтрБлнСл = ?(СтрокиПоРаботнику1[Сч+1].Больничные = 0, "0", СокрЛП(Строка(Формат(СтрокиПоРаботнику1[Сч+1].Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						иначе
							СтрБлнСл = ?(СтрокиПоРаботнику1[Сч+1].Больничные = 0, "0", СокрЛП(Строка(Формат(СтрокиПоРаботнику1[Сч+1].Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						КонецЕсли;
						//О.Т. Аверсон 02.02.2018 № 1535
						СтрВзн1СлЧисло = ?(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.28,СтрокаМес.Период) = 0, 0, ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.28,СтрокаМес.Период));   
						//О.Т. Аверсон 02.02.2018 № 1535
						Если СКорректировкойФСЗН Тогда //О.Т. Аверсон 28.02.2018 № 1448
							СтрВзнСл = ?(не ЗначениеЗаполнено(СтрокиПоРаботнику1[Сч+1].ПенсионныйФонд), "0", СокрЛП(Строка(Формат(СтрокиПоРаботнику1[Сч+1].ПенсионныйФонд,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
							//О.Т. Аверсон 02.02.2018 № 1535
							СтрВзнСлЧисло = ?(ЗначениеЗаполнено(СтрокиПоРаботнику1[Сч+1].ПенсионныйФонд),СтрокиПоРаботнику1[Сч+1].ПенсионныйФонд,0);
						иначе
							СтрВзнСл = ?(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.01,СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.01,СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
							//О.Т. Аверсон 02.02.2018 № 1535
							СтрВзнСлЧисло = ?(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.01,СтрокаМес.Период) = 0, 0, ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.01,СтрокаМес.Период));
						КонецЕсли;
						
						СтрВзн1Сл = ?(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.28,СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.28,СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));   
						СуммаВсеСл = ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходСл*0.35,СтрокаМес.Период);
						Если СКорректировкойФСЗН Тогда //О.Т. Аверсон 28.02.2018 № 1448
							Если ОбъединятьОсновные Тогда 
								МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("ФизЛицо,Период",СтрокиПоРаботнику1[Сч+1].ФизЛицо,СтрокиПоРаботнику1[Сч+1].Период));
							Иначе 
								МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("Сотрудник,Период",СтрокиПоРаботнику1[Сч+1].Сотрудник,СтрокиПоРаботнику1[Сч+1].Период));
							КонецЕсли;
							
							СуммаКоррект = 0;
							Для Каждого стр из МассивТЗСотрудники Цикл 
								СуммаКоррект = СуммаКоррект + ?(ЗначениеЗаполнено(стр.СуммаКорректировки),стр.СуммаКорректировки,0);							
							КонецЦикла;
							
							СтрВзн2Сл = ?(СуммаВсеСл-СтрВзнСлЧисло-СтрВзн1СлЧисло+СуммаКоррект=0,"0",СтрЗаменить(СуммаВсеСл-СтрВзнСлЧисло-СтрВзн1СлЧисло+СуммаКоррект," ","")); //О.Т. Аверсон 02.02.2018 № 1535
						иначе
							
							СтрВзн2Сл = ?(СуммаВсеСл-СтрВзнСлЧисло-СтрВзн1СлЧисло=0,"0",СтрЗаменить(СуммаВсеСл-СтрВзнСлЧисло-СтрВзн1СлЧисло," ","")); //О.Т. Аверсон 02.02.2018 № 1535
						КонецЕсли;
						СтрВзн3Сл = ?(ОбщегоНазначения.ОкруглитьЗначение2016(Число(СтрВзн1Сл)+Число(СтрВзн2Сл),СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(Число(СтрВзн1Сл)+Число(СтрВзн2Сл),СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0")))); 
					КонецЕсли;
					
					
					//Островская Татьяна 31.10.2012 № 15958
					
					НомерМесяца = Формат(Месяц(СтрокаМес.Период),"ЧГ=0");
					
					//+ СВЭЙ КДЯ 23.09.19 СВФР-004631 ( пункт 46. )
					//изменился формат файла пачки ПУ-3 - незначащие нули не проходят проверку
					//если НомерМесяца = Лев(НомерМесяца,1) Тогда 
					//	НомерМесяца = "0"+НомерМесяца;
					//КонецЕсли;
					//- СВЭЙ КДЯ 23.09.19 СВФР-004631 ( пункт 46. )
					
					//Островская Татьяна 30.11.2012 № 15958
					//Островская Татьяна 30.11.2012 № 15958
					//СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",СтрокаМес.ФизЛицо));
					//Для каждого СтрДог из СтрокиПоРаб цикл 
					//	если КатегорияВывод= "ДОГОВОР" Тогда
					//		если Основные Тогда
					//		Иначе 
					//			если СтрБлн = "0" Тогда 
					//				СтрБлн = " ";
					//				Прервать;
					//			КонецЕсли;
					//		КонецЕсли;
					//	КонецЕсли;
					//	
					//КонецЦикла;
					
					
					//Островская Татьяна 30.11.2012 № 15958
					
					//О.Т. Аверсон 29.08.2018 № 2363
					
					МесяцЧисло = Строка(Месяц(СтрокаМес.Период));    					
					ЗапросУв.Текст = 
					"ВЫБРАТЬ
					|	РаботникиОрганизацийСрезПоследних.Период
					|ИЗ
					|	ПакетУВ"+МесяцЧисло+" КАК РаботникиОрганизацийСрезПоследних"; 					
					Если ОбъединятьОсновные Тогда 
						ЗапросУв.Текст = ЗапросУв.Текст +"
						|ГДЕ
						|	РаботникиОрганизацийСрезПоследних.ФизЛицо = &ФизЛицо";
						ЗапросУв.УстановитьПараметр("ФизЛицо", СтрокаМес.ФизЛицо);
					иначе
						ЗапросУв.Текст = ЗапросУв.Текст +"
						|ГДЕ
						|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
						ЗапросУв.УстановитьПараметр("Сотрудник", СтрокаМес.Сотрудник);
					КонецЕсли; 				
					РезультатЗапросаУв = ЗапросУв.Выполнить().Выбрать();
					
					ДатаУвольнения = Дата(1,1,1);
					Пока РезультатЗапросаУв.Следующий() Цикл
						ДатаУвольнения = РезультатЗапросаУв.Период;
					КонецЦикла;
					
					//Аверсон 17.05.2020 КВВ СВФР-005997 (
					Проверка_ВидНалогообложения = ОсновнойВидНалогообл;
					Проверка_ИнаяСтавка = РегистрыСведений.ГражданствоФизЛиц.ПолучитьПоследнее(КонецМесяца(СтрокаМес.Период),Новый Структура("ФизЛицо",?(ОбъединятьОсновные,СтрокаМес.ФизЛицо,СтрокаМес.Сотрудник.ФизЛицо))).ИнаяСтавка;
					Проверка_Инвалид = РегистрыСведений.СведенияОбИнвалидностиФизлиц.ПолучитьПоследнее(КонецМесяца(СтрокаМес.Период),Новый Структура("ФизЛицо",?(ОбъединятьОсновные,СтрокаМес.ФизЛицо,СтрокаМес.Сотрудник.ФизЛицо))).Инвалидность;
					//Аверсон 17.07.2020 КВВ СВФР-006298 (
					Если Проверка_Инвалид Тогда
						Если СокрЛП(РегистрыСведений.СведенияОбИнвалидностиФизлиц.СрезПоследних(КонецМесяца(СтрокаМес.Период),Новый Структура("ФизЛицо",СтрокаМес.ФизЛицо))[0].ГруппаИнвалидности) = "III" Тогда
							Проверка_Инвалид = Ложь;
						КонецЕсли;
					КонецЕсли;
					Если ОбъединятьОсновные Тогда 
						ДНПС = РегистрыСведений.ДополнительнаяПенсияРаботодательРаботник.ПолучитьПоследнее(СтрокаМес.Период,Новый Структура("Физлицо",СтрокаМес.ФизЛицо)).ПроцентРаботника;
					Иначе
						ДНПС = РегистрыСведений.ДополнительнаяПенсияРаботодательРаботник.ПолучитьПоследнее(СтрокаМес.Период,Новый Структура("Сотрудник",СтрокаМес.Сотрудник)).ПроцентРаботника;
					КонецЕсли;
					//Аверсон 17.07.2020 КВВ СВФР-006298 )
					Если ЗначениеЗаполнено(Проверка_ИнаяСтавка) Тогда 
						Пр_ФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокаМес.Период),
						Новый Структура("Организация,ВидНалогообложения,ВидОтчисления",Организация,Проверка_ВидНалогообложения,Перечисления.ВидыОтчисленийСФОТиЗП.ИнаяСтавка)).Размер;			
						Если ДНПС <> 0 Тогда //организация.УчетДополнительнойПенсии Тогда 
							Пр_ФСЗН = Проверка_ИнаяСтавка;
						КонецЕсли;;
					ИначеЕсли Проверка_Инвалид Тогда 
						Пр_ФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокаМес.Период),
						Новый Структура("Организация,ВидНалогообложения,ВидОтчисления",Организация,Проверка_ВидНалогообложения,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)).Размер;
					иначе
						Пр_ФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокаМес.Период),
						Новый Структура("Организация,ВидНалогообложения,ВидОтчисления",Организация,Проверка_ВидНалогообложения,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).Размер;
					КонецЕсли;
					Процент_ФСЗН_Итог = Пр_ФСЗН-6;
					ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаОкончания,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер;
					СтрВзн1 = Окр((СтрЗар*Процент_ФСЗН_Итог)/100,2);
					СтрВзн1 = Формат(?(ЗначениеЗаполнено(СтрВзн1),СтрВзн1,"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0");
					
					//Аверсон 21.05.2020 КВВ СВФР-005940 (
					Если СКорректировкойФСЗН И (СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)="193357089" ИЛИ СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)="100993744" ИЛИ СокрЛП(ВыборкаПоШапкеДокумента.Организация.ИНН)="101505322") Тогда //СЛИВКИ-БАЙ все три
						Если ОбъединятьОсновные Тогда 
							МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("ФизЛицо,Период",СтрокаМес.ФизЛицо,СтрокаМес.Период));
						Иначе 
							МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("Сотрудник,Период",СтрокаМес.Сотрудник,СтрокаМес.Период));
						КонецЕсли;
						ИзменятьВзн2 = Истина;
						Для Каждого стр из МассивТЗСотрудники Цикл 
							Если ЗначениеЗаполнено(стр.СуммаКорректировки) Тогда
								ИзменятьВзн2 = Ложь;
							КонецЕсли;
						КонецЦикла;
						Если ИзменятьВзн2 Тогда
							СуммаВФайл = Число(СтрВзн) + Число(СтрВзн1) + Число(СтрВзн2);
							СуммаИзРегНак = ПолучитьСуммуПФиФСЗН(?(ОбъединятьОсновные,СтрокаМес.ФизЛицо,СтрокаМес.Сотрудник),СтрокаМес.Период);
							Если СуммаИзРегНак-СуммаВФайл <> 0 Тогда
								СтрВзн2 = Число(СтрВзн2) + (СуммаИзРегНак-СуммаВФайл);
								СтрВзн2 = Формат(?(ЗначениеЗаполнено(СтрВзн2),СтрВзн2,"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0");
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
					//Аверсон 21.05.2020 КВВ СВФР-005940 )
					
					СтрВзн3 = Формат(?(ЗначениеЗаполнено(СтрВзн2),Число(СтрВзн2),"0") + ?(ЗначениеЗаполнено(СтрВзн1),Число(СтрВзн1),"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0");
					СтрВзн3 = Формат(?(ЗначениеЗаполнено(СтрВзн3),СтрВзн3,"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0");
					//Аверсон 17.05.2020 КВВ СВФР-005997 )
					
					//Аверсон 29.07.2020 КВВ СВФР-006298 ( закомментировано
					//Если ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*1/100,СтрокаМес.Период)<> СтрВзнЧисло и ЗначениеЗаполнено(ДатаУвольнения) Тогда
					//	ДатаУвольненияФормат = Формат(ДатаУвольнения,"ДФ=""дд/ММ/гггг""");
					//	СтрокаЗар = ВРЕГ(ТипЗаписиНач+НомерМесяца+"="+СтрЗар+"="+СтрБлн+"="+СтрВзн+"="+СтрВзн1+"="+СтрВзн2+"="+СтрВзн+"="+СтрВзн3+"=0="+СокрЛП(Процент_ФСЗН_Итог)+"=6="+ДатаУвольненияФормат+"=");  //Аверсон 17.05.2020 КВВ СВФР-005997 (было 28, стало Процент_ФСЗН_Итог )
					//иначе
					//Аверсон 29.07.2020 КВВ СВФР-006298 ) закомментировано
					
					//Аверсон ЕАЕ 09.08.2022 СВФР-009387
					//СтрокаЗар = ВРЕГ(ТипЗаписиНач+НомерМесяца+"="+СтрЗар+"="+СтрБлн+"="+СтрВзн+"="+СтрВзн1+"="+СтрВзн2+"="+СтрВзн+"="+СтрВзн3+"=1="+СокрЛП(Процент_ФСЗН_Итог)+"=6= "+"="); //Островская Татьяна 17.01.2013 № 16153  //Аверсон 17.05.2020 КВВ СВФР-005997 (было 28, стало Процент_ФСЗН_Итог )
					ДатаИнвалидность = " ";
					ПериодДПС = " ";
					Для Каждого ДатИнв Из МассивИнвалидность Цикл
						Если ДатИнв >= НачалоМесяца(СтрокаМес.Период) И ДатИнв <= КонецМесяца(СтрокаМес.Период) Тогда
							ДатаИнвалидность = Формат(ДатИнв, "ДФ=dd/MM/yyyy");
							Прервать;
						КонецЕсли;
					КонецЦикла;
					Если (организация.УчетДополнительнойПенсии или ОтборПоПериодуВзаиморасчетов) и не КатегорияВывод= "ДОГОВОР" Тогда    
						ЗапросДПС = Новый Запрос;
						ЗапросДПС.Текст =
						"ВЫБРАТЬ
						|	ДополнительнаяПенсияРаботодательРаботникСрезПоследних.Сотрудник,
						|	ДополнительнаяПенсияРаботодательРаботникСрезПоследних.Период,
						|	ДополнительнаяПенсияРаботодательРаботникСрезПоследних.ПроцентРаботника,
						|	ДополнительнаяПенсияРаботодательРаботникСрезПоследних.Сотрудник.Физлицо
						|ИЗ
						|	РегистрСведений.ДополнительнаяПенсияРаботодательРаботник.СрезПоследних(, ) КАК ДополнительнаяПенсияРаботодательРаботникСрезПоследних
						|ГДЕ
						|	ДополнительнаяПенсияРаботодательРаботникСрезПоследних.ПроцентРаботника <> 0 
						| //И ДополнительнаяПенсияРаботодательРаботникСрезПоследних.Сотрудник = &Сотрудник"; 
						Если ОбъединятьОсновные Тогда 
							ЗапросДПС.Текст = СтрЗаменить(ЗапросДПС.Текст,"//И ДополнительнаяПенсияРаботодательРаботникСрезПоследних.Сотрудник = &Сотрудник","И ДополнительнаяПенсияРаботодательРаботникСрезПоследних.Сотрудник.Физлицо = &Физлицо");
							ЗапросДПС.УстановитьПараметр("ФизЛицо", СтрокаМес.ФизЛицо);
						Иначе 
							ЗапросДПС.Текст = СтрЗаменить(ЗапросДПС.Текст,"//	И ДополнительнаяПенсияРаботодательРаботникСрезПоследних.Сотрудник = &Сотрудник","");
							ЗапросДПС.УстановитьПараметр("Сотрудник", СтрокаМес.Сотрудник);
						КонецЕсли;           	
						
						РезДПС = ЗапросДПС.Выполнить().Выбрать();
						пока РезДПС.Следующий() Цикл 
							ПериодДПС =РезДПС.Период; 
						КонецЦикла;      					 
						Если СтрокаМес.Период = ПериодДПС Тогда
							ДатаИнвалидность =Формат(ПериодДПС, "ДФ=dd/MM/yyyy");
						КонецЕсли;
						ЗапросДПСвзносы = Новый Запрос;
						ЗапросДПСвзносы.Текст =      
						"ВЫБРАТЬ
						|	ДопДанныеДляПУ3.Сотрудник,
						|	ДопДанныеДляПУ3.ПериодВзаиморасчетов,
						|	ДопДанныеДляПУ3.Организация,
						|	СУММА(ДопДанныеДляПУ3.СуммаВыплат) КАК СуммаВыплат,
						|	СУММА(ДопДанныеДляПУ3.ПенсионныйФонд) КАК ПенсионныйФонд,
						|	СУММА(ДопДанныеДляПУ3.ПенсСтрах) КАК ПенсСтрах,
						|	СУММА(ДопДанныеДляПУ3.СоцСтрах) КАК СоцСтрах
						|ИЗ
						|	РегистрНакопления.ДопДанныеДляПУ3 КАК ДопДанныеДляПУ3
						|ГДЕ
						|	ДопДанныеДляПУ3.Организация = &Организация
						|	И ДопДанныеДляПУ3.ПериодВзаиморасчетов = &ПериодВзаиморасчетов
						|	//И ДопДанныеДляПУ3.Сотрудник = &Сотрудник
						|
						|СГРУППИРОВАТЬ ПО
						|	ДопДанныеДляПУ3.Сотрудник,
						|	ДопДанныеДляПУ3.ПериодВзаиморасчетов,
						|	ДопДанныеДляПУ3.Организация";    
						Если ОбъединятьОсновные Тогда 
							ЗапросДПСвзносы.Текст = СтрЗаменить(ЗапросДПСвзносы.Текст,"//И ДопДанныеДляПУ3.Сотрудник = &Сотрудник","И ДопДанныеДляПУ3.Сотрудник.Физлицо = &Физлицо");
							ЗапросДПСвзносы.Текст = СтрЗаменить(ЗапросДПСвзносы.Текст,"///ДопДанныеДляПУ3.Сотрудник","ДопДанныеДляПУ3.Сотрудник.Физлицо");
							ЗапросДПСвзносы.УстановитьПараметр("ФизЛицо", СтрокаМес.ФизЛицо);
						Иначе 
							ЗапросДПСвзносы.Текст = СтрЗаменить(ЗапросДПСвзносы.Текст,"//И ДопДанныеДляПУ3.Сотрудник = &Сотрудник","И ДопДанныеДляПУ3.Сотрудник = &Сотрудник");
							ЗапросДПСвзносы.Текст = СтрЗаменить(ЗапросДПСвзносы.Текст,"///ДопДанныеДляПУ3.Сотрудник","ДопДанныеДляПУ3.Сотрудник");
							ЗапросДПСвзносы.УстановитьПараметр("Сотрудник", СтрокаМес.Сотрудник);
						КонецЕсли;
						ЗапросДПСвзносы.УстановитьПараметр("ПериодВзаиморасчетов", НачалоМесяца(СтрокаМес.Период));  
						ЗапросДПСвзносы.УстановитьПараметр("Организация", Организация);
						
						Если ДНПС <> 0 Тогда
							Рез = ЗапросДПСвзносы.Выполнить().Выбрать();
							пока Рез.Следующий() Цикл    
								СтрЗар = Формат(?(ЗначениеЗаполнено(Рез.СуммаВыплат),Рез.СуммаВыплат,"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"); 
								СтрВзн1 = Формат(?(ЗначениеЗаполнено(Рез.ПенсСтрах),Рез.ПенсСтрах,"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"); 
								СтрВзн =  Формат(?(ЗначениеЗаполнено(Рез.ПенсионныйФонд),Рез.ПенсионныйФонд,"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0");
								СтрВзн2 = Формат(?(ЗначениеЗаполнено(Рез.СоцСтрах),Рез.СоцСтрах,"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0");
								СтрВзн3 = Формат(?(ЗначениеЗаполнено(Рез.ПенсСтрах+Рез.СоцСтрах),Рез.ПенсСтрах+Рез.СоцСтрах,"0"),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0");
							КонецЦикла; 
						КонецЕсли;
					КонецЕсли;    
					СтрокаЗар = ВРЕГ(ТипЗаписиНач+НомерМесяца+"="+СтрЗар+"="+СтрБлн+"="+СтрВзн+"="+СтрВзн1+"="+СтрВзн2+"="+СтрВзн+"="+СтрВзн3+"=1="+СокрЛП(Процент_ФСЗН_Итог)+"=6="+ ДатаИнвалидность +"=");
					//Аверсон СВФР-009387
					
					//КонецЕсли;
					
					//О.Т. Аверсон 01.04.2019 № 4182
					Если не ДатаНачала < Дата(2019,01,01) Тогда
						Если ЗначениеЗаполнено(СтрокаМес.ПричиныМинимальнойЗП) Тогда
							СтрокаЗар = СтрокаЗар + СтрокаМес.ПричиныМинимальнойЗП.Код+"=";
						иначе
							СтрокаЗар = СтрокаЗар + " =";  						
						КонецЕсли;
					КонецЕсли;
					//О.Т. Аверсон 01.04.2019 № 4082
					
					
					//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					Если ЕстьВзносы Тогда
						//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
						
						//О.Т. Аверсон 29.08.2018 № 2363
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						//толик формирование контрольного файла
						Дбф.Добавить();
						Если ОбъединятьОсновные Тогда 
							Дбф.УстановитьЗначениеПоля("FIO", СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо)));
						иначе
							Дбф.УстановитьЗначениеПоля("FIO", СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.Сотрудник)));
						КонецЕсли;
						Дбф.УстановитьЗначениеПоля("Dato", СтрокаМес.Период);
						Дбф.УстановитьЗначениеПоля("Sm", ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода, СтрокаМес.Период));//О.Т. Аверсон 14.03.2016 № 949
						Дбф.УстановитьЗначениеПоля("Bl", ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.Больничные, СтрокаМес.Период));//О.Т. Аверсон 14.03.2016 № 949
						Дбф.УстановитьЗначениеПоля("Vz", ОбщегоНазначения.ОкруглитьЗначение2016((СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд), СтрокаМес.Период));//О.Т. Аверсон 14.03.2016 № 949
						Дбф.Записать();
						
						//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					КонецЕсли; // ЕстьВзносы
					//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					
					если Сч+1 <= СтрокиПоРаботнику1.Количество()-1 Тогда 
						РаботДоходСлед = РаботДоходСлед + Число(РаботДоходСл);
						РаботБольнСлед = РаботБольнСлед + Число(СтрБлнСл);
						//Островская Татьяна 17.01.2014 № 17051
						РаботВзносСлед = РаботВзносСлед + Число(СтрВзнСл);
						РаботВзносСлед1 = РаботВзносСлед1 + Число(СтрВзн1Сл);
						//СуммаВсе = окр(СтрокиПоРаботнику1[Сч+1].СуммаДохода*0.35);					
						РаботВзносСлед2 = РаботВзносСлед2 + Число(СтрВзн2Сл);
						
						РаботВзносСлед3 = РаботВзносСлед3 + Число(СтрВзн3Сл);
						
						
						
						
						//если Сч+1 <= СтрокиПоРаботнику1.Количество()-1 Тогда 
						//	РаботДоходСлед = РаботДоход + Окр(СтрокиПоРаботнику1[Сч+1].СуммаДохода, 0);
						//	РаботБольнСлед = РаботБольн + СтрокиПоРаботнику1[Сч+1].Больничные;
						//	РаботВзносСлед = РаботВзнос + СтрокиПоРаботнику1[Сч+1].ФСЗН + СтрокиПоРаботнику1[Сч+1].ПенсионныйФонд;
						//	РаботДоход = РаботДоход + Окр(СтрокаМес.СуммаДохода, 0);
						//	РаботБольн = РаботБольн + СтрокаМес.Больничные;
						//	РаботВзнос = РаботВзнос + СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд;
						//	//если не КатегорияВывод= "ДОГОВОР" Тогда
						//	//	ИтогДохода = ИтогДохода + РаботДоход;
						//	//	ИтогБольн = ИтогБольн + РаботБольн;
						//	//	ИтогВзнос = ИтогВзнос + РаботВзнос;
						//	//иначе
						//	//	ИтогДохода = ИтогДохода + РаботДоходСлед;
						//	//	ИтогБольн = ИтогБольн + РаботБольнСлед;
						//	//	ИтогВзнос = ИтогВзнос + РаботВзносСлед;
						//	//КонецЕсли;
						//иначе
						//	если КатегорияВывод= "ДОГОВОР" Тогда
						//		РаботДоход = РаботДоход + Окр(СтрокиПоРаботнику1[0].СуммаДохода, 0);
						//		РаботБольн = РаботБольн + СтрокиПоРаботнику1[0].Больничные;
						//		РаботВзнос = РаботВзнос + СтрокиПоРаботнику1[0].ФСЗН + СтрокиПоРаботнику1[0].ПенсионныйФонд;
						//		//ИтогДохода = ИтогДохода + РаботДоход;
						//		//ИтогБольн = ИтогБольн + РаботБольн;
						//		//ИтогВзнос = ИтогВзнос + РаботВзнос;
						//		
						//	иначе
						//		РаботДоход = РаботДоход + Окр(СтрокаМес.СуммаДохода, 0);
						//		РаботБольн = РаботБольн + СтрокаМес.Больничные;
						//		РаботВзнос = РаботВзнос + СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд;
						//		//ИтогДохода = ИтогДохода + РаботДоход;
						//		//ИтогБольн = ИтогБольн + РаботБольн;
						//		//ИтогВзнос = ИтогВзнос + РаботВзнос;
						//		
						//	КонецЕсли;
						//КонецЕсли;
						
						
						
						
						
						//Островская Татьяна 17.01.2014 № 17051
						РаботДоход = РаботДоход + Число(СтрЗар);
						РаботБольн = РаботБольн + Число(СтрБлн);
						РаботВзнос = РаботВзнос + Число(СтрВзн); //Островская Татьяна 17.01.2014 № 17051
						РаботВзнос1 = РаботВзнос1 + Число(СтрВзн1); //Островская Татьяна 17.01.2014 № 17051
						СуммаВсе = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.35,СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
						РаботВзнос2 = РаботВзнос2 + Число(СтрВзн2); //Островская Татьяна 17.01.2014 № 17051
						РаботВзнос3 = РаботВзнос3 + Число(СтрВзн3); //Островская Татьяна 17.01.2014 № 17051
						//если не КатегорияВывод= "ДОГОВОР" Тогда
						//	ИтогДохода = ИтогДохода + РаботДоход;
						//	ИтогБольн = ИтогБольн + РаботБольн;
						//	ИтогВзнос = ИтогВзнос + РаботВзнос;
						//иначе
						//	ИтогДохода = ИтогДохода + РаботДоходСлед;
						//	ИтогБольн = ИтогБольн + РаботБольнСлед;
						//	ИтогВзнос = ИтогВзнос + РаботВзносСлед;
						//КонецЕсли;
					иначе 
						РезультатДоговор= 0;
						Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
							
							если КатегорияВывод= "ДОГОВОР" Тогда
								ЗапросДог = Новый Запрос;
								ЗапросДог.Текст = 
								"ВЫБРАТЬ
								|	ЕСНСведенияОДоходах.Результат как Результат
								|ИЗ
								|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
								|ГДЕ
								|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1";
								Если ОбъединятьОсновные Тогда 
									ЗапросДог.Текст = ЗапросДог.Текст +"
									|	И ЕСНСведенияОДоходах.ФизЛицо = &ФизЛицо";
								иначе
									ЗапросДог.Текст = ЗапросДог.Текст +"
									|	И ЕСНСведенияОДоходах.Сотрудник = &Сотрудник";
								КонецЕсли;
								ЗапросДог.Текст = ЗапросДог.Текст +"
								|	И ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН <> &ДоходБольничныйФСЗН";
								//|	И ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета = &СпособРасчета";//О.Т. Аверсон 31.01.2017 № 244
								Если ОбъединятьОсновные Тогда
									ЗапросДог.УстановитьПараметр("ФизЛицо",СтрокиПоРаботнику1[0].ФизЛицо);
								иначе
									ЗапросДог.УстановитьПараметр("Сотрудник",СтрокиПоРаботнику1[0].Сотрудник);
								КонецЕсли;
								ЗапросДог.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
								ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов",НачалоМесяца(СтрокиПоРаботнику1[0].Период));
								ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов1",КонецМесяца(СтрокиПоРаботнику1[0].Период));
								//ЗапросДог.УстановитьПараметр("СпособРасчета",Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой);
								РезДог = ЗапросДог.Выполнить().Выбрать();
								пока РезДог.Следующий() Цикл 
									РезультатДоговор =РезультатДоговор+РезДог.Результат; 
								КонецЦикла;
							КонецЕсли;
						иначе
							РезультатДоговор = СтрокиПоРаботнику1[0].СуммаДохода;
						КонецЕсли;
						
						если КатегорияВывод = 	"ДОГОВОР" Тогда 
							РаботДоходПер = РезультатДоговор;
						иначе
							РаботДоходПер = СтрокиПоРаботнику1[0].СуммаДохода - РезультатДоговор;
						КонецЕсли;
						//О.Т. Аверсон 29.08.2018 № 2363
						Если ОбъединятьОсновные Тогда
							ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
						иначе
							Если ЗначениеЗаполнено(СтрокиПоРаботнику1[0].Сотрудник.ВидНалогообложенияОсновной) Тогда 
								ОсновнойВидНалогообл = СтрокиПоРаботнику1[0].Сотрудник.ВидНалогообложенияОсновной;
							иначе
								ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
							КонецЕсли;
						КонецЕсли;
						//О.Т. Аверсон 29.08.2018 № 2363
						
						СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокиПоРаботнику1[0].Период),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
						РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(СтрокиПоРаботнику1[0].Период) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
						БазаОграниченияФСЗН = СтруктураФСЗН.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
						
						Если РаботДоходПер > БазаОграниченияФСЗН Тогда 
							РаботДоходПер = БазаОграниченияФСЗН;
						КонецЕсли;
						
						
						ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаОкончания,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер; //О.Т. Аверсон 22.06.2016 № 949
						СтрЗарПр = ?(РаботДоходПер = 0, "0", СокрЛП(Строка(Формат(РаботДоходПер,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						если не КатегорияВывод= "ДОГОВОР" Тогда
							СтрБлнПер = ?(СтрокиПоРаботнику1[0].Больничные = 0, "0", СокрЛП(Строка(Формат(СтрокиПоРаботнику1[0].Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						иначе
							СтрБлнПер = ?(СтрокиПоРаботнику1[0].Больничные = 0, "0", СокрЛП(Строка(Формат(СтрокиПоРаботнику1[0].Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						КонецЕсли;
						//О.Т. Аверсон 01.02.2018 № 1535
						СтрВзн1ПерЧисло = ?(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.28,СтрокаМес.Период) = 0, 0, ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.28,СтрокаМес.Период));   
						//О.Т. Аверсон 01.02.2018 № 1535
						Если СКорректировкойФСЗН Тогда //О.Т. Аверсон 28.02.2018 № 1448
							СтрВзнПер = ?(не ЗначениеЗаполнено(СтрокиПоРаботнику1[0].ПенсионныйФонд), "0", СокрЛП(Строка(Формат(СтрокиПоРаботнику1[0].ПенсионныйФонд,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
							//О.Т. Аверсон 02.02.2018 № 1535
							СтрВзнПерЧисло = ?(ЗначениеЗаполнено(СтрокиПоРаботнику1[0].ПенсионныйФонд),СтрокиПоРаботнику1[0].ПенсионныйФонд,0);
						иначе
							СтрВзнПер = ?(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.01,СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.01,СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
							//О.Т. Аверсон 02.02.2018 № 1535
							СтрВзнПерЧисло = ?(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.01,СтрокаМес.Период) = 0, 0, ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.01,СтрокаМес.Период));
						КонецЕсли;
						
						СтрВзн1Пер = ?(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.28,СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.28,СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));   
						
						СуммаВсеПер = ОбщегоНазначения.ОкруглитьЗначение2016(РаботДоходПер*0.35,СтрокаМес.Период);
						Если СКорректировкойФСЗН Тогда //О.Т. Аверсон 28.02.2018 № 1448
							Если ОбъединятьОсновные Тогда 
								МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("ФизЛицо,Период",СтрокиПоРаботнику1[0].ФизЛицо,СтрокиПоРаботнику1[0].Период));
							иначе
								МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("Сотрудник,Период",СтрокиПоРаботнику1[0].Сотрудник,СтрокиПоРаботнику1[0].Период));
							КонецЕсли;
							СуммаКоррект = 0;
							Для Каждого стр из МассивТЗСотрудники Цикл 
								СуммаКоррект = СуммаКоррект + ?(ЗначениеЗаполнено(стр.СуммаКорректировки),стр.СуммаКорректировки,0);							
							КонецЦикла;
							
							СтрВзн2Пер = ?(СуммаВсеПер-СтрВзнПерЧисло - СтрВзн1ПерЧисло+СуммаКоррект=0,"0",СтрЗаменить(СуммаВсеПер - СтрВзнПерЧисло - СтрВзн1ПерЧисло+СуммаКоррект," ",""));
						иначе
							
							СтрВзн2Пер = ?(СуммаВсеПер-СтрВзнПерЧисло - СтрВзн1ПерЧисло=0,"0",СтрЗаменить(СуммаВсеПер - СтрВзнПерЧисло - СтрВзн1ПерЧисло," ",""));
						КонецЕсли;
						
						СтрВзн3Пер = ?(ОбщегоНазначения.ОкруглитьЗначение2016(Число(СтрВзн1Пер)+Число(СтрВзн2Пер),СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(Число(СтрВзн1Пер)+Число(СтрВзн2Пер),СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0")))); 
						
						
						
						//если КатегорияВывод= "ДОГОВОР" Тогда
						//	РаботДоход = РаботДоход + РаботДоходПер;
						//	РаботБольн = РаботБольн + Число(СтрБлнПер);
						//	//Островская Татьяна 17.01.2014 № 17051
						//	РаботВзнос = РаботВзнос + Число(СтрВзнПер);
						//	РаботВзнос1 = РаботВзнос1 + Число(СтрВзн1Пер);
						//	//СуммаВсе = окр(СтрокиПоРаботнику1[0].СуммаДохода*0.35);
						//	
						//	РаботВзнос2 = РаботВзнос2 + Число(СтрВзн2Пер);
						//	РаботВзнос3 = РаботВзнос3 + Число(СтрВзн3Пер);
						//	//Островская Татьяна 17.01.2014 № 17051
						//	//ИтогДохода = ИтогДохода + РаботДоход;
						//	//ИтогБольн = ИтогБольн + РаботБольн;
						//	//ИтогВзнос = ИтогВзнос + РаботВзнос;
						//	
						//иначе
						РаботДоход = РаботДоход + Число(СтрЗар);
						РаботБольн = РаботБольн + Число(СтрБлн);
						РаботВзнос = РаботВзнос + Число(СтрВзн);
						//Островская Татьяна 17.01.2014 № 17051
						РаботВзнос1 = РаботВзнос1 + Число(СтрВзн1);
						СуммаВсе = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.35,СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
						РаботВзнос2 = РаботВзнос2 + Число(СтрВзн2);
						РаботВзнос3 = РаботВзнос3 + Число(СтрВзн3);
						//Островская Татьяна 17.01.2014 № 17051
						//ИтогДохода = ИтогДохода + РаботДоход;
						//ИтогБольн = ИтогБольн + РаботБольн;
						//ИтогВзнос = ИтогВзнос + РаботВзнос;
						
						//КонецЕсли;
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					Если ЕстьВзносы Тогда
						//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
						КоличествоМес = КоличествоМес + 1;
						//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					КонецЕсли;
					//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					
					//КонецЕсли;
					если не Сч > Колич-1 Тогда 
						если не КатегорияВывод= "ДОГОВОР" Тогда
							
						иначе
							
							//если СчДляКолСтажа = 1 и ДатаДоговораПрошл<>"" Тогда 
							//	если КатегорияВывод= "ДОГОВОР" Тогда
							//		
							//		ТипЗаписиНач = "СТАЖ=";
							//		Структура = Новый Структура;
							//		Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
							//		если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							//			Структура.Вставить("ВидДоговора",null);
							//		Иначе 
							//			Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
							//			Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
							//				Структура.Вставить("НомерДокумента",СтрокаМес.НомерДокумента);
							//				Структура.Вставить("НачалоРабот",СтрокаМес.ДатаДокумента);
							//			КонецЕсли;
							//		КонецЕсли;
							//		
							//		СтрокиПоРаботнику = ПТДопСведОстаже.НайтиСтроки(Структура); 
							//		
							//		Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
							//			
							//			Если ЗначениеЗаполнено(СтрокаСтаж.ВидДейтельности) Тогда 
							//				Если СтрокаСтаж.ВидДейтельности <> "СП2     " Тогда 
							//					
							//					КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
							//					
							//				КонецЕсли;
							//			КонецЕсли;
							//		КонецЦикла;
							//	КонецЕсли;
							//КонецЕсли;
							//
							//если СчДляКолСтажа >= 0 Тогда	
							//	ТипЗаписиНач3 = "СТАЖ=";
							//	СтруктураПособие = Новый Структура;
							//	СтруктураПособие.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
							//	если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							//		СтруктураПособие.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
							//	Иначе 
							//		СтруктураПособие.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
							//	КонецЕсли;
							//	СтруктураПособие.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБИЕ"));
							//	СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураПособие); 
							//	
							//	Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
							//		если не (СтрокаСтаж.ДатаНачалаРабот >= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокументаи 
							//			и НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) = НачалоМесяца(СтрокаМес.Период)) Тогда 
							//			Продолжить;
							//		КонецЕсли;
							//		
							//		КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
							//		
							//	КонецЦикла;
							//	
							//	
							//	ТипЗаписиНач3 = "СТАЖ=";
							//	СтруктураВзносыВр = Новый Структура;
							//	СтруктураВзносыВр.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
							//	если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							//		СтруктураВзносыВр.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
							//	Иначе 
							//		СтруктураВзносыВр.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
							//	КонецЕсли;
							//	СтруктураВзносыВр.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВЗНОСЫВРЕМ"));
							//	СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураВзносыВр); 
							//	
							//	Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
							//		если не (СтрокаСтаж.ДатаНачалаРабот >= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента 
							//			и НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) = НачалоМесяца(СтрокаМес.Период)) Тогда 
							//			Продолжить;
							//		КонецЕсли;
							//		
							//		КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
							//		
							//	КонецЦикла;
							//КонецЕсли;
							
							//О.Т. Аверсон 31.08.2018 № 
							СтруктураПособие = Новый Структура;
							Если ОбъединятьОсновные Тогда 
								СтруктураПособие.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
							иначе          								
								СтруктураПособие.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
							КонецЕсли;
							
							//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
							//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							//	СтруктураПособие.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
							//Иначе 
							//	СтруктураПособие.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
							//КонецЕсли;
							//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( СтруктураПособие ); 
							//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
							
							//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
							СтруктураПособие.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
							СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураПособие ); 
							//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
							
							// + СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
							//ВидДеятельностиПрошл = "";
							//ДоговорПрошл = "";
							//Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
							//	//О.Т. Аверсон 23.08.2018 № 2335
							//	Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
							//		Если СтрокаСтаж.Договор <> СтрокаМес.ДокументОснование Тогда 
							//			Продолжить;								
							//		КонецЕсли;
							//	иначе
							//		если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),СтрокаСтаж.Договор.Номер =СтрокаМес.НомерДокумента,истина))
							//			и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),не (СтрокаСтаж.Договор.ДатаНачала <= СтрокаМес.ДатаДокумента и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента),Ложь) Тогда //О.Т. Аверсон 04.04.2019 № 4187
							//			Продолжить;
							//		КонецЕсли;
							//	КонецЕсли;
							//	//О.Т. Аверсон 23.08.2018 № 2335
							//	Если Год(СтрокаСтаж.ДатаНачалаРабот) < Год(СтрокаСтаж.ДатаОкончанияРабот) Тогда
							//		
							//		ПериодНач = НачалоМесяца(ДобавитьМесяц(СтрокаСтаж.ДатаНачалаРабот,1));															
							//		Пока ПериодНач <= НачалоМесяца(СтрокаСтаж.ДатаОкончанияРабот) Цикл 
							//			Если ДоговорПрошл <> СтрокаСтаж.Договор Тогда 
							//				КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
							//			ИначеЕсли ВидДеятельностиПрошл <> СтрокаСтаж.ВидДеятельности Тогда 
							//				КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
							//			КонецЕсли;
							//			ПериодНач = ДобавитьМесяц(ПериодНач,1);
							//		КонецЦикла;
							//		
							//	иначе
							//		Если ДоговорПрошл <> СтрокаСтаж.Договор Тогда 
							//			КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
							//		ИначеЕсли ВидДеятельностиПрошл <> СтрокаСтаж.ВидДеятельности Тогда 
							//			КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
							//		КонецЕсли;
							//	КонецЕсли;
							//	ВидДеятельностиПрошл = СтрокаСтаж.ВидДеятельности;
							//	ДоговорПрошл = СтрокаСтаж.Договор;
							//КонецЦикла;
							////О.Т. Аверсон 31.08.2018 № 
							// - СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
							
							//ПСА 04.07.2019 СВФР-004497++
							ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику
							//+ СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 5. )
							, ЗначениеКв, СтрокаМес
							//- СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 5. )
							);
							//+++ПСА 04.07.2019 СВФР-004497
							
							
							//СтрокаЗар = СтрокаЗар + ">";
							
							//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
							Если ЕстьВзносы Тогда
								//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
								
								ТекстФайла.ЗаменитьСтроку( ТекСтрока, СтрокаЗар );
								
								//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
							КонецЕсли; // ЕстьВзносы
							//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
							
							// + СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
							//если не Сч > Колич-1 Тогда
							//	СтрокаФайла1 = ВРЕГ(СтрокаФайла+ ?(РаботДоход = 0 , ?(ЕстьНеоплДог,"0"," "), СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
							//	?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
							//	?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
							//	?(РаботВзнос1 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос1,"ЧГ=0"))))+"="+
							//	?(РаботВзнос2 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос2,"ЧГ=0"))))+"="+
							//	?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
							//	?(РаботВзнос3 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос3,"ЧГ=0"))))+"="+
							//	
							//	//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
							//	//?( ЕстьНеоплДог и КоличествоМес = 0, "0", Формат( КоличествоМес,"ЧГ=0" ) ) + "=" 
							//	//+?( СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0")))="0","0",СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0"))))
							//	//- СВЭЙ КДЯ 25.07.19 СВФР-004561
							//	//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
							//	?( ЕстьНеоплДог ИЛИ КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
							//	+ ?( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0) = 0, "0", Формат( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0 ), "ЧГ=0" ) )
							//	//- СВЭЙ КДЯ 25.07.19 СВФР-004561
							//	                  
							//	+ "=" + ДатаЗаполнения + "=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) + "=" 
							//	+ Формат( ГОД( ДатаНачала ),"ЧГ=0" ) + "=" + СтрЗаменить( ТелефонОрганизации, " ", "" ) ) + "=";
							//	//ДоговорНом = ?(ЗначениеЗаполнено(НомерДоговора),СтрЗаменить(СокрЛП(НомерДоговора)," ",""),"");
							//	//ДоговорДата = ?(ЗначениеЗаполнено(ДатаДокумента),ДатаДокумента,"");
							//	//
							//	//СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+ДоговорНом+"="+ДоговорДата+"=");
							//	
							//	//Островская Татьяна 20.01.2014 № 17051
							//КонецЕсли;
							//КоличествоЗаписейОСтаже = 0;
							// - СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
							
							// + СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
							ПрефиксСтрокаФайла1 = СтрокаФайла;
							// - СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
							
						КонецЕсли;
					иначе
						если  КатегорияВывод= "ДОГОВОР" Тогда
							//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
							Если ЕстьВзносы Тогда
								//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
								
								СтрокаЗар = СтрокаЗар + ">";
								ТекстФайла.ЗаменитьСтроку( ТекСтрока, СтрокаЗар );
								
								//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
							КонецЕсли; // ЕстьВзносы
							//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
						КонецЕсли;
					КонецЕсли;
					//Островская Татьяна 17.01.2013 № 16153
					//Островская Татьяна 25.10.2012 № 15958	
					
					
					НомерДоговораПрошл = СтрокаМес.НомерДокумента;
					ДатаДоговораПрошл = СтрокаМес.ДатаДокумента;
					Если ВыгрузкаДоговоровПодрядаБезОграничения Тогда 
						ДокументОснованиеПрошл = СтрокаМес.ДокументОснование;//О.Т. Аверсон 23.08.2018 № 2335
					КонецЕсли;
					//О.Т. 06.03.2015 № 
					СчДляКолСтажа = СчДляКолСтажа+1;
					
					Если ПериодДляДоговора <> СтрокаМес.Период Тогда // СВЭЙ КДЯ 25.07.19 СВФР-004561
						СтрМес = СтрМес + 1;
					КонецЕсли; // СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					ПериодДляДоговора = СтрокаМес.Период;
				КонецЦикла;
				
				// Проверка Кол Стажа
				Если КатегорияВывод = "ДОГОВОР" Тогда 	
					
					//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					//Структура = Новый Структура;
					//Если ОбъединятьОсновные Тогда 
					//	Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					//иначе
					//	Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					//КонецЕсли;
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	Структура.Вставить("ВидДоговора",null);
					//Иначе 
					//	Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
					//	Структура.Вставить("НомерДокумента",СтрокаМес.НомерДокумента);
					//	Структура.Вставить("ДатаДляПУ",СтрокаМес.ДатаДокумента);
					//КонецЕсли;
					//СтрокиПоРаботнику = ПТДопСведОстаже.НайтиСтроки(Структура); 
					//// + СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
					////Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл						
					////	Если ЗначениеЗаполнено(СтрокаСтаж.ВидДейтельности) Тогда 
					////		Если СтрокаСтаж.ВидДейтельности <> "СП2     " Тогда 
					////			КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;		
					////		КонецЕсли;
					////	КонецЕсли;
					////КонецЦикла;
					//// - СВЭЙ КДЯ 23.08.19 СВФР-004631 ( пункт 10. )
					//
					//СтруктураПособие = Новый Структура;
					//Если ОбъединятьОсновные Тогда 
					//	СтруктураПособие.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					//иначе
					//	СтруктураПособие.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					//КонецЕсли;
					//
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	СтруктураПособие.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
					//Иначе 
					//	//СтруктураПособие.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
					//КонецЕсли;
					//СтруктураПособие.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБИЕ"));
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураПособие); 
					//
					////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					////- СВЭЙ КДЯ 25.07.19 СВФР-004561
					//			 					
					//
					//Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
					//	//О.Т. Аверсон 23.08.2018 № 2335
					//	Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
					//		Если СтрокаСтаж.Договор <> СтрокаМес.ДокументОснование Тогда 
					//			Продолжить;								
					//		КонецЕсли;
					//	иначе
					//		если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),СтрокаСтаж.Договор.Номер =СтрокаМес.НомерДокумента,истина))
					//			и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),не (СтрокаСтаж.Договор.ДатаНачала <= СтрокаМес.ДатаДокумента и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента),Ложь) Тогда
					//			//или ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),не (СтрокаСтаж.Договор.ДатаНачала >= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента),Ложь) Тогда //О.Т. Аверсон 04.04.2019 № 4187
					//			Продолжить;
					//		КонецЕсли;
					//	КонецЕсли;
					//	//О.Т. Аверсон 23.08.2018 № 2335
					//	
					//	КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
					//	
					//	
					//КонецЦикла;
					//
					//СтруктураПособие = Новый Структура;
					//Если ОбъединятьОсновные Тогда 
					//	СтруктураПособие.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					//иначе
					//	СтруктураПособие.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					//КонецЕсли;
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	СтруктураПособие.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
					//Иначе 
					//	//СтруктураПособие.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
					//КонецЕсли;
					//СтруктураПособие.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПРЕМИЯ"));
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураПособие); 
					//
					////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					////- СВЭЙ КДЯ 25.07.19 СВФР-004561
					//			 					
					//
					//Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
					//	если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),СтрокаСтаж.Договор.Номер =СтрокаМес.НомерДокумента,истина))
					//		и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),не (СтрокаСтаж.Договор.ДатаНачала <= СтрокаМес.ДатаДокумента и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента),Ложь) Тогда
					//		//или ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),не (СтрокаСтаж.Договор.ДатаНачала >= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента),Ложь) Тогда //О.Т. Аверсон 04.04.2019 № 4187
					//		Продолжить;
					//	КонецЕсли;
					//	КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
					//	
					//	
					//КонецЦикла;
					//
					//
					//ТипЗаписиНач3 = "СТАЖ=";
					//СтруктураВзносыВр = Новый Структура;
					//Если ОбъединятьОсновные Тогда 
					//	СтруктураВзносыВр.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					//иначе
					//	СтруктураВзносыВр.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					//КонецЕсли;
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	СтруктураВзносыВр.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
					//Иначе 
					//	СтруктураВзносыВр.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
					//	Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
					//		Структура.Вставить("НомерДокумента",НомерДоговораПрошл);
					//		Структура.Вставить("НачалоРабот",ДатаДоговораПрошл);
					//	КонецЕсли;	
					//КонецЕсли;
					//СтруктураВзносыВр.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВЗНОСЫВРЕМ"));
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураВзносыВр); 
					//
					//Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
					//	если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),СтрокаСтаж.Договор.Номер =СтрокаМес.НомерДокумента,истина) 
					//		и СтрокаСтаж.ДатаНачалаРабот <= КонецМесяца(ПериодДляДоговора))
					//		и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),не (СтрокаСтаж.Договор.ДатаНачала <= СтрокаМес.ДатаДокумента и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента),Ложь) Тогда
					//		//или ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),не (СтрокаСтаж.Договор.ДатаНачала >= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента),Ложь) Тогда //О.Т. Аверсон 04.04.2019 № 4187
					//		если СтрокаСтаж.ДатаНачалаРабот > КонецМесяца(ПериодДляДоговора) Тогда 
					//			ВзносыВрВыгружена = Истина;
					//		КонецЕсли;
					//		
					//		Продолжить;
					//	КонецЕсли;
					//	
					//	КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
					//	
					//КонецЦикла;
					//
					////ПСА 04.07.2019 СВФР-004497++
					//ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику
					//		                          //+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//									, ЗначениеКв
					//								  //- СВЭЙ КДЯ 25.07.19 СВФР-004561
					//			 					);
					////+++ПСА 04.07.2019 СВФР-004497
					//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					
					//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					//+ СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 28. )
					ОтборСтрокСтажаДоговора = Новый Структура();
					Если ОбъединятьОсновные Тогда 
						ОтборСтрокСтажаДоговора.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
					иначе
						ОтборСтрокСтажаДоговора.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
					КонецЕсли;
					ОтборСтрокСтажаДоговора.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					Если ЗначениеЗаполнено( НомерДоговораПрошл ) И ЗначениеЗаполнено( ДатаДоговораПрошл ) Тогда
						ОтборСтрокСтажаДоговора.Вставить( "НомерДокумента", НомерДоговораПрошл );
						//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
						//ОтборСтрокСтажаДоговора.Вставить( "ДатаДляПу", ДатаДоговораПрошл );
						//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
						
						//Аверсон ЕАЕ 18.02.2023 СВФР-010250
						ОтборСтрокСтажаДоговора.Вставить("ДатаДокумента", ДатаДоговораПрошл);
						//Аверсон СВФР-010250
					КонецЕсли;
					СтрокиСтажаДоговора = ТЗ_СведенияОСтаже.НайтиСтроки( ОтборСтрокСтажаДоговора );
					КоличествоЗаписейОСтаже = СтрокиСтажаДоговора.Количество();
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиСтажаДоговора, ЗначениеКв );
					//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 28. )
					//- СВЭЙ КДЯ 21.09.19 СВФР-004631 ( пункт 45. )
					
					
					СтрокаФайла1 = ВРЕГ(СтрокаФайла	+ ?(РаботДоход = 0, ?(ЕстьНеоплДог,"0"," "), СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
					?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос1 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос1,"ЧГ=0"))))+"="+
					?(РаботВзнос2 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос2,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос3 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос3,"ЧГ=0"))))+"="+
					
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//?( ЕстьНеоплДог и КоличествоМес = 0, "0", Формат( КоличествоМес ,"ЧГ=0" ) ) + "=" 
					//+ ?( СокрЛП( Строка( Формат( КоличествоЗаписейОСтаже +?(НазначениеПенсии,1,0),"ЧГ=0")))="0","0",СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0"))))
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					?( ЕстьНеоплДог ИЛИ КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
					+ ?( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0) = 0, "0", Формат( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0 ), "ЧГ=0" ) )
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					+ "=" + ДатаЗаполнения + "=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) + "=" 
					+ Формат( ГОД( ДатаНачала ), "ЧГ=0" ) + "=" +СтрЗаменить( ТелефонОрганизации, " ", "" ) ) + "=";
					//О.Т. Аверсон 01.03.2017 № 362
					//ДоговорНом = ?(ЗначениеЗаполнено(НомерДоговора),СтрЗаменить(Число(НомерДоговора)," ",""),"");
					//ДоговорДата = ?(ЗначениеЗаполнено(ДатаДокумента),ДатаДокумента,"");
					//СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+ДоговорНом+"="+ДоговорДата+"=");
					//О.Т. Аверсон 01.03.2017 № 362
					
					//если СчДляПУ > 0 Тогда
					//	СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+Число(НомерДоговора)+"="+ДатаДокумента+"=");
					//КонецЕсли;
				КонецЕсли;
				
				
				ДатаНачалаДоговора = Дата(1,1,1);
				ДатаОкончанияДоговора = Дата(1,1,1);
				если КатегорияВывод= "ДОГОВОР" Тогда 
					ТипЗаписиНач = "СТАЖ=";
					Структура = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					иначе
						Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					КонецЕсли;
					
					если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
						Структура.Вставить("ВидДоговора",null);
					Иначе 
						Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
						Структура.Вставить("НомерДокумента",СтрокаМес.НомерДокумента);
						//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
						//Структура.Вставить("ДатаДляПУ",СтрокаМес.ДатаДокумента);
						//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
						
						//Аверсон ЕАЕ 18.02.2023 СВФР-010250
						Структура.Вставить("ДатаДокумента",СтрокаМес.ДатаДокумента);
						//Аверсон СВФР-010250
					КонецЕсли;
					
					// + СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40. )
					//// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
					//Структура.Вставить( "ВидДейтельности", "ДОГОВОР" );
					//// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
					// - СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40. )
					
					СтрокиПоРаботнику = ПТДопСведОстаже.НайтиСтроки(Структура); 
					КоличествоЗаписейОСтаже = 0;
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						//если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.НачалоРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ОкончаниеРабот)) Тогда 
						//	Продолжить;
						//КонецЕсли;
						
						// + СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40. )
						Если СокрЛП( СтрокаСтаж.ВидДейтельности ) <> "ДОГОВОР" 
							И СокрЛП( СтрокаСтаж.ВидДейтельности ) <> "НЕОПЛДОГ" Тогда
							Продолжить;	
						КонецЕсли; 
						// - СВЭЙ КДЯ 20.09.19 СВФР-004631 ( пункт 40. )
						
						Если ЗначениеЗаполнено(СтрокаСтаж.ВидДейтельности) Тогда 
							Если СтрокаСтаж.ВидДейтельности <> "СП2     " Тогда
								
								//О.Т. Аверсон 05.04.2019 № 4187
								ДатаНачалаДог = СтрокаСтаж.НачалоРабот;
								ДатаОкончанияДог = СтрокаСтаж.ОкончаниеРабот;
								
								// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								//Если Год( СтрокаСтаж.НачалоРабот ) < Год( ПериодДляДоговора ) Тогда
								//	
								//	ЕстьНеопл = Ложь;
								//	ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("Сотрудник,ВидДеятельности",ВыборкаПоРаботникиОрганизации.Сотрудник,НеоплДог));
								//	Для Каждого стрЗначСвед из ЗначСведенияОСтаже Цикл 
								//		Если стрЗначСвед.ДатаНачалаРабот >= СтрокаСтаж.НачалоРабот и стрЗначСвед.ДатаНачалаРабот <= СтрокаСтаж.ОкончаниеРабот Тогда 
								//			ЕстьНеопл = Истина;	
								//		КонецЕсли;   											
								//	КонецЦикла;
								// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								
								Пока Год( ДатаНачалаДог )< Год( ПериодДляДоговора ) Цикл 
									
									ДатаОкончанияДог = КонецГода( ДатаНачалаДог );
									ДатаНачалаДоговора = ДатаНачалаДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
									
									// + СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
									//ДатаФормирования = ДатаНачалаДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
									//
									//ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
									//МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
									//ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
									//ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
									//
									//
									//Если НачалоМесяца(СтрокаСтаж.НачалоРабот) <> НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) Тогда
									//	ДатаФормирования = КонецГода(СтрокаСтаж.НачалоРабот);
									//иначе
									//	ДатаФормирования = СтрокаСтаж.ОкончаниеРабот;
									//КонецЕсли;
									//
									//ДатаОкончанияДоговора = Мин(ДатаОкончанияДог,КонецМесяца(ПериодДляДоговора));
									////+ СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 12. )										
									//ДатаФормирования = Мин( ДатаОкончанияДог, КонецМесяца( ПериодДляДоговора ) );
									////- СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 12. )										
									//ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
									//МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
									//ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
									//ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
									// - СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
									
									// + СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
									ДатаНачалаРабот   = Формат( ДатаНачалаДог, "ДФ=""дд/ММ/гггг""" );
									ДатаОкончанияРабот   = Формат( Мин( ДатаОкончанияДог, КонецМесяца( ПериодДляДоговора ) ) , "ДФ=""дд/ММ/гггг""" );
									// - СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
									
									// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
									////О.Т. Аверсон 14.05.2019 № 4328
									//ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("Сотрудник,ДатаНачалаРабот,ДатаОкончанияРабот,ВидДеятельности",ВыборкаПоРаботникиОрганизации.Сотрудник,ДатаНачалаДог,НачалоДня(ДатаФормирования),НеоплДог));  
									//
									//ЗначВидДеят = Неопределено;
									//Если ЗначСведенияОСтаже.Количество()>0 Тогда 
									//	ЗначВидДеят = ЗначСведенияОСтаже[0].ВидДеятельности;																
									//КонецЕсли;
									//
									////О.Т. Аверсон 14.05.2019 № 4328
									//Если не ЕстьНеопл Тогда 
									//	СтрокаЗар = ВРЕГ(ТипЗаписиНач+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="+СокрЛП(?(ЗначениеЗаполнено(ЗначВидДеят),ЗначВидДеят,СтрокаСтаж.ВидДейтельности))+"= = =");
									//	ТекстФайла.ДобавитьСтроку(СтрокаЗар);
									//	ТекСтрока = ТекСтрока+1;
									//	КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
									//КонецЕсли;
									// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
									
									
									// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
									ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже );
									СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот + "= =" 
									+ СокрЛП( ?( ЕстьНеоплДог, "НЕОПЛДОГ", СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
									ТекстФайла.ДобавитьСтроку( СтрокаЗар );
									ТекСтрока = ТекСтрока + 1;
									КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
									// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
									
									Если Категория = "03" тогда
										НомерДоговора = СокрЛП(НомерДоговораПервый);
										ДатаФормирования = ДатаДоговораПервый;
										ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
										МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
										ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
										ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										СтрокаФайла = СтрокаЗамена+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"=";
										//Для нового расчета договоров
										НомерДоговора = СокрЛП(СтрокаМес.НомерДокумента);
										ДатаФормирования = СтрокаМес.ДатаДокумента;
										ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
										МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
										ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
										ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"=");
									КонецЕсли;
									
									
									
									ДатаНачалаДог = Дата(Год(ДатаНачалаДог)+1,01,01);
								КонецЦикла;
								
								// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								//КонецЕсли;
								////О.Т. Аверсон 05.04.2019 № 4187
								// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								
								// + СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
								//ДатаФормирования = ДатаНачалаДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
								//ДатаНачалаДоговора = СтрокаСтаж.НачалоРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
								//
								//ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
								//МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
								//ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
								//ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
								//
								//
								//ДатаФормирования = Мин(СтрокаСтаж.ОкончаниеРабот,КонецМесяца(ПериодДляДоговора));
								//ДатаОкончанияДоговора = Мин(СтрокаСтаж.ОкончаниеРабот,КонецМесяца(ПериодДляДоговора));
								//ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
								//МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
								//ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
								//ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
								// - СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
								
								// + СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
								ДатаНачалаДоговора = СтрокаСтаж.НачалоРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
								ДатаНачалаРабот   = Формат( ДатаНачалаДог, "ДФ=""дд/ММ/гггг""" );
								ДатаОкончанияРабот   = Формат( Мин( СтрокаСтаж.ОкончаниеРабот, ЭтотОбъект.ДатаОкончания ) , "ДФ=""дд/ММ/гггг""" );
								// - СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
								
								// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								////О.Т. Аверсон 14.05.2019 № 4328
								//ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки( Новый Структура("Сотрудник,ДатаНачалаРабот,ДатаОкончанияРабот,ВидДеятельности",ВыборкаПоРаботникиОрганизации.Сотрудник,ДатаНачалаДог,НачалоДня(ДатаФормирования),НеоплДог));  
								//									
								//ЗначВидДеят = Неопределено;
								//Если ЗначСведенияОСтаже.Количество()>0 Тогда 
								//	ЗначВидДеят = ЗначСведенияОСтаже[0].ВидДеятельности;																
								//КонецЕсли;
								////О.Т. Аверсон 14.05.2019 № 4328
								//СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот +"= =" 
								//		+ СокрЛП( ?( ЗначениеЗаполнено( ЗначВидДеят ), ЗначВидДеят, СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
								// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								
								// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже );
								СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот + "= =" 
								+ СокрЛП( ?( ЕстьНеоплДог, "НЕОПЛДОГ", СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
								// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
								
								ТекстФайла.ДобавитьСтроку( СтрокаЗар );
								ТекСтрока = ТекСтрока + 1;
								КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
								Если Категория = "03" тогда
									НомерДоговора = СокрЛП(НомерДоговораПервый);
									ДатаФормирования = ДатаДоговораПервый;
									ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
									МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
									ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
									ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
									СтрокаФайла = СтрокаЗамена+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"=";
									//Для нового расчета договоров
									НомерДоговора = СокрЛП(СтрокаМес.НомерДокумента);
									ДатаФормирования = СтрокаМес.ДатаДокумента;
									ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
									МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
									ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
									ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
									СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"=");
								КонецЕсли;
								ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
								ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
							КонецЕсли;
						КонецЕсли;
					КонецЦикла;
					
					
				КонецЕсли;			
				
				если СчДляПУ = 0 и КатегорияВывод = "ДОГОВОР" Тогда
					ДоговорНом = ?(ЗначениеЗаполнено(НомерДоговора),СтрЗаменить(НомерДоговора," ",""),"");
					ДоговорДата = ?(ЗначениеЗаполнено(ДатаДокумента),ДатаДокумента,"");
					СтрокаФайла1 = СтрЗаменить(СтрокаФайла1,СтрокаЗамена,СтрокаЗамена+ДоговорНом+"="+ДоговорДата+"=");
				КонецЕсли;
				
				
				Если КатегорияВывод = "ДОГОВОР" Тогда 
					
					если НазначениеПенсии Тогда 
						ТипЗаписиНач2 = "СТАЖ=";
						Структура = Новый Структура;
						Если ОбъединятьОсновные Тогда 
							Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
						иначе
							Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
						КонецЕсли;
						если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							Структура.Вставить("ВидДоговора",null);
						Иначе 
							Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
						КонецЕсли;
						ПериодПенсии = СтрокиПоРаботнику1[СтрокиПоРаботнику1.Количество()-1].Период;
						ДеньШапки        = ?(День(НачалоМесяца(ПериодПенсии))<10,"0","")+День(НачалоМесяца(ПериодПенсии));
						МесяцШапки       = ?(Месяц(НачалоМесяца(ПериодПенсии))<10,"0","")+Месяц(НачалоМесяца(ПериодПенсии));
						ГодШапки 		 = Строка(СокрЛП(Формат(Год(НачалоМесяца(ПериодПенсии)), "ЧГ=0")));
						ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						ДеньШапки        = ?(День(КонецМесяца(ПериодПенсии))<10,"0","")+День(КонецМесяца(ПериодПенсии));
						МесяцШапки       = ?(Месяц(КонецМесяца(ПериодПенсии))<10,"0","")+Месяц(КонецМесяца(ПериодПенсии));
						ГодШапки 		 = Строка(СокрЛП(Формат(Год(КонецМесяца(ПериодПенсии)), "ЧГ=0")));
						ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач2+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="+"ПЕНСИЯ= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						ПенсияВыгружена = Истина;
					КонецЕсли;
					
					ТипЗаписиНач3 = "СТАЖ=";
					СтруктураДети = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						СтруктураДети.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					иначе
						СтруктураДети.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					КонецЕсли;
					если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
						СтруктураДети.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
					Иначе 
						СтруктураДети.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					//СтруктураДети.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "ДЕТИ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураДети); 
					//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					
					//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					СтруктураДети.Вставить( "ВидДеятельности", "ДЕТИ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураДети ); 
					//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					
					//Аверсон ЕАЕ 18.04.2022 СВФР-008941
					МассивВидовДеятельностиДети = Новый Массив;
					МассивВидовДеятельностиДети.Добавить("ДЕТИ0");
					МассивВидовДеятельностиДети.Добавить("ДЕТИ100");
					МассивВидовДеятельностиДети.Добавить("ДЕТИ50");
					МассивВидовДеятельностиДети.Добавить("ДПОСОБ100");
					МассивВидовДеятельностиДети.Добавить("ДПОСОБ50");
					Для Каждого ВД Из МассивВидовДеятельностиДети Цикл
						СтруктураДети.ВидДеятельности = ВД;
						СтрПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки(СтруктураДети);
						Для Каждого Эл Из СтрПоРаботнику Цикл
							СтрокиПоРаботнику.Добавить(Эл);	
						КонецЦикла;
					КонецЦикла;
					//Аверсон СВФР-008941
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						
						//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
						//если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),СтрокаСтаж.Договор.Номер =СтрокаМес.НомерДокумента,истина)) Тогда 
						//	Продолжить;
						//КонецЕсли;
						//
						//ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
						//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						//ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						//
						//
						//ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
						//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						//ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
						
						//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
						если НЕ СтрокаСтажаСоответствуетСтрокеМесяца( СтрокаСтаж, СтрокаМес, Истина ) Тогда
							
							Продолжить;
							
						КонецЕсли;
						ДатаНачалаРаботДети   = Формат( СтрокаСтаж.ДатаНачалаРабот, "ДФ=""дд/ММ/гггг""" );
						ДатаОкончанияРаботДети = Формат( СтрокаСтаж.ДатаОкончанияРабот, "ДФ=""дд/ММ/гггг""" );
						//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
						
						//Аверсон ЕАЕ 18.04.2022 СВФР-008941
						//СтрокаЗар = ВРЕГ( ТипЗаписиНач3 + ДатаНачалаРаботДети + "=" + ДатаОкончанияРаботДети + "= =" + "ДЕТИ" + "= = =" );
						ДетиСтр = СокрЛП(СтрокаСтаж.ВидДеятельности);
						КолДетей = ПолучитьКоличествоДетей(СтрокаСтаж.ФизЛицо, СтрокаСтаж.ДатаНачалаРабот);
						КолДетейСтр = СокрЛП(КолДетей);
						СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+ ДетиСтр +"=" + КолДетейСтр + "= =");
						//Аверсон СВФР-008941
						
						ТекстФайла.ДобавитьСтроку( СтрокаЗар );
						ТекСтрока = ТекСтрока + 1;
						ДетиВыгружена = Истина;
						//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
						//ДетиЕсть = Истина;
						//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
						
						//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
						//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
						
						//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						//ТекСтрока = ТекСтрока+1;
						//КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
						//Если Категория = "03" тогда
						//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
						//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
						//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
						//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
						//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
						//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
						//КонецЕсли;
						//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
						//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
						
					КонецЦикла;
					
					
					
					ТипЗаписиНач3 = "СТАЖ=";
					СтруктураПособие = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						СтруктураПособие.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					иначе
						СтруктураПособие.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					КонецЕсли;
					
					если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
						СтруктураПособие.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
					Иначе 
						//СтруктураПособие.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					//СтруктураПособие.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "ПОСОБИЕ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураПособие); 
					//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					
					//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					СтруктураПособие.Вставить( "ВидДеятельности", "ПОСОБИЕ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураПособие ); 
					//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						
						//О.Т. Аверсон 23.08.2018 № 2335
						Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
							//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
							//Если СтрокаСтаж.Договор <> СтрокаМес.ДокументОснование Тогда 
							//	Продолжить;								
							//КонецЕсли;
							//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
							//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
							Если ЗначениеЗаполнено( СтрокаМес.ДокументОснование )
								И ( СтрокаСтаж.НомерДокумента <> ПолучитьНомерДокументаДляПУ( СтрокаМес.ДокументОснование )
								ИЛИ СтрокаСтаж.ДатаДокумента <> ПолучитьДатуДокументаДляПУ( СтрокаМес.ДокументОснование ) ) Тогда 
								Продолжить;								
							КонецЕсли;
							//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
						иначе
							
							//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
							//если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) 
							//	и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента 
							//	и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),СтрокаСтаж.Договор.Номер =СтрокаМес.НомерДокумента,истина)) Тогда 
							//	Продолжить;
							//КонецЕсли;
							//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
							
							//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
							если НЕ СтрокаСтажаСоответствуетСтрокеМесяца( СтрокаСтаж, СтрокаМес, Истина ) Тогда
								
								Продолжить;
								
							КонецЕсли;
							//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
							
						КонецЕсли;
						//О.Т. Аверсон 23.08.2018 № 2335
						
						
						//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
						//ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
						//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						//ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						//
						//
						//ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
						//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						//ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						//
						//СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ПОСОБИЕ"+"= = =");
						//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
						
						//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
						ДатаНачалаПособия   = Формат( СтрокаСтаж.ДатаНачалаРабот, "ДФ=""дд/ММ/гггг""" );
						ДатаОкончанияПособия = Формат( СтрокаСтаж.ДатаОкончанияРабот, "ДФ=""дд/ММ/гггг""" );
						СтрокаЗар = ВРЕГ( ТипЗаписиНач3 + ДатаНачалаПособия + "=" + ДатаОкончанияПособия + "= =" + "ПОСОБИЕ" + "= = =" );
						//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
						
						ТекстФайла.ДобавитьСтроку( СтрокаЗар );
						ТекСтрока = ТекСтрока + 1;
						ПособиеВыгружена = Истина;
						
						//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						//ТекСтрока = ТекСтрока+1;
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
						//Если Категория = "03" тогда
						//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
						//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
						//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
						//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
						//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
						//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
						//КонецЕсли;
						//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
						//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
						
					КонецЦикла;
					
					//О.Т. Аверсон 21.05.2018 № 1985
					ТипЗаписиНач3 = "СТАЖ=";
					СтруктураСтрахСлуч = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						СтруктураСтрахСлуч.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
					иначе
						СтруктураСтрахСлуч.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
					КонецЕсли;
					
					если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
						СтруктураСтрахСлуч.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 26. )
					//СтруктураСтрахСлуч.Вставить( "ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "СТРАХСЛУЧ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( СтруктураСтрахСлуч ); 
					//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 26. )
					
					//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 26. )
					СтруктураСтрахСлуч.Вставить( "ВидДеятельности", "СТРАХСЛУЧ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураСтрахСлуч ); 
					//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 26. )
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						
						//О.Т. Аверсон 23.08.2018 № 2335
						Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
							Если СтрокаСтаж.Договор <> СтрокаМес.ДокументОснование Тогда 
								Продолжить;								
							КонецЕсли;
						иначе
							
							//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
							//если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),СтрокаСтаж.Договор.Номер =СтрокаМес.НомерДокумента,истина)) Тогда 
							//	Продолжить;
							//КонецЕсли;
							//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
							
							//+ СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
							если НЕ СтрокаСтажаСоответствуетСтрокеМесяца( СтрокаСтаж, СтрокаМес, Истина ) Тогда
								
								Продолжить;
								
							КонецЕсли;
							//- СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 15. )
							
						КонецЕсли;
						//О.Т. Аверсон 23.08.2018 № 2335
						
						
						//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 15. )
						//ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
						//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						//ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						//
						//
						//ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
						//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						//ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						//
						//СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ПОСОБИЕ"+"= = =");
						//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 15. )
						
						
						//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 15. )
						ДатаНачалаСтрахСлуч   = Формат( СтрокаСтаж.ДатаНачалаРабот, "ДФ=""дд/ММ/гггг""" );
						ДатаОкончанияСтрахСлуч = Формат( СтрокаСтаж.ДатаОкончанияРабот, "ДФ=""дд/ММ/гггг""" );
						СтрокаЗар = ВРЕГ( ТипЗаписиНач3 + ДатаНачалаСтрахСлуч + "=" + ДатаОкончанияСтрахСлуч + "= =" + "СТРАХСЛУЧ" + "= = =" );
						//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 15. )
						
						ТекстФайла.ДобавитьСтроку( СтрокаЗар );
						ТекСтрока = ТекСтрока + 1;
						СтрахСлучВыгружена = Истина;
						
						//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						//ТекСтрока = ТекСтрока+1;
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
						//Если Категория = "03" тогда
						//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
						//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
						//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
						//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
						//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
						//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
						//КонецЕсли;
						//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
						//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
						
					КонецЦикла;
					//О.Т. Аверсон 21.05.2018 № 1985
					
					
					ТипЗаписиНач3 = "СТАЖ=";
					СтруктураПремия = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						СтруктураПремия.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
					иначе
						СтруктураПремия.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
					КонецЕсли;
					
					если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
						СтруктураПремия.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 26. )
					//СтруктураПремия.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "ПРЕМИЯ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( СтруктураПремия ); 
					//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 26. )
					
					//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 26. )
					СтруктураПремия.Вставить( "ВидДеятельности", "ПРЕМИЯ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураПремия ); 
					//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 26. )
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						
						//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 15. )
						//если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента и ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),СтрокаСтаж.Договор.Номер =СтрокаМес.НомерДокумента,истина)) Тогда 
						//	Продолжить;
						//КонецЕсли;
						//
						//ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
						//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						//ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						//
						//
						//ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
						//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						//ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						//
						//СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ПРЕМИЯ"+"= = =");
						//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 15. )
						
						//+ СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 15. )
						если НЕ СтрокаСтажаСоответствуетСтрокеМесяца( СтрокаСтаж, СтрокаМес, Истина ) Тогда
							
							Продолжить;
							
						КонецЕсли;
						
						ДатаНачалаПремия   = Формат( СтрокаСтаж.ДатаНачалаРабот, "ДФ=""дд/ММ/гггг""" );
						ДатаОкончанияПремия = Формат( СтрокаСтаж.ДатаОкончанияРабот, "ДФ=""дд/ММ/гггг""" );
						СтрокаЗар = ВРЕГ( ТипЗаписиНач3 + ДатаНачалаПремия + "=" + ДатаОкончанияПремия + "= =" + "ПРЕМИЯ" + "= = =" );
						//- СВЭЙ КДЯ 16.09.19 СВФР-004631 ( пункт 15. )
						
						ТекстФайла.ДобавитьСтроку( СтрокаЗар );
						ТекСтрока = ТекСтрока + 1;
						ПремияВыгружена = Истина;
						
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
						
					КонецЦикла;
					
					
					//Если (СтрокаМес.НомерДокумента <> НомерДоговораПрошл или СтрокаМес.ДатаДокумента <> ДатаДоговораПрошл) и НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
					ТипЗаписиНач3 = "СТАЖ=";
					СтруктураВзносыВр = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						СтруктураВзносыВр.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					иначе
						СтруктураВзносыВр.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					КонецЕсли;
					
					если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
						СтруктураВзносыВр.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
					Иначе 
						СтруктураВзносыВр.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
						Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
							// + СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
							//Структура.Вставить("НомерДокумента",НомерДоговораПрошл);
							//Структура.Вставить("НачалоРабот",ДатаДоговораПрошл);
							// - СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
							// + СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
							СтруктураВзносыВр.Вставить( "НомерДокумента", НомерДоговораПрошл );
							//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
							//СтруктураВзносыВр.Вставить( "ДатаДляПУ", ДатаДоговораПрошл );
							//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
							// - СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
							
							//Аверсон ЕАЕ 18.02.2023 СВФР-010250
							СтруктураВзносыВр.Вставить( "ДатаДокумента", ДатаДоговораПрошл );
							//Аверсон СВФР-010250
						КонецЕсли;	
					КонецЕсли;
					
					// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					//СтруктураВзносыВр.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "ВЗНОСЫВРЕМ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( СтруктураВзносыВр ); 
					// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					СтруктураВзносыВр.Вставить( "ВидДеятельности", "ВЗНОСЫВРЕМ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураВзносыВр ); 
					// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					
					// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					//ПредыдущийВидДейтельности = "";
					//ПредыдущееОкончаниеРабот = "";                                   
					//ДатаНачалаРабот = "";
					//Прерывание = Ложь;
					// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					ВыгруженыРанниеВзносы = Ложь;
					// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						
						//+ СВЭЙ КДЯ 10.09.19 СВФР-004631 ( пункт 15. )
						//если не (НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) <= НачалоМесяца(СтрокаМес.ДатаДокумента) 
						//			и СтрокаСтаж.ДатаОкончанияРабот >= СтрокаМес.ДатаДокумента 
						//			и ?( ЗначениеЗаполнено( СтрокаСтаж.Договор ), СтрокаСтаж.Договор.Номер = СтрокаМес.НомерДокумента, истина ) 
						//		и СтрокаСтаж.ДатаНачалаРабот <= КонецМесяца( ПериодДляДоговора ) )
						//		и ?( ЗначениеЗаполнено( СтрокаСтаж.Договор ), 
						//			не ( СтрокаСтаж.Договор.ДатаНачала <= СтрокаМес.ДатаДокумента 
						//				и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента ), Ложь ) Тогда
						//	
						//	//или ?(ЗначениеЗаполнено(СтрокаСтаж.Договор),не (СтрокаСтаж.Договор.ДатаНачала >= НачалоМесяца(СтрокаМес.ДатаДокумента) и СтрокаСтаж.Договор.ДатаОкончания >= СтрокаМес.ДатаДокумента),Ложь) Тогда //О.Т. Аверсон 04.04.2019 № 4187
						//	если СтрокаСтаж.ДатаНачалаРабот > КонецМесяца( ПериодДляДоговора ) Тогда 
						//		ВзносыВрВыгружена = Истина;
						//	КонецЕсли;
						//	Продолжить;
						//КонецЕсли;
						//- СВЭЙ КДЯ 10.09.19 СВФР-004631 ( пункт 15. )
						
						//+ СВЭЙ КДЯ 10.09.19 СВФР-004631 ( пункт 15. )
						// + СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
						//Если НЕ СтрокаСтажаСоответствуетСтрокеМесяца( СтрокаСтаж, СтрокаМес ) Тогда
						// - СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
						// + СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
						Если НЕ СтрокаСтажаСоответствуетСтрокеМесяца( СтрокаСтаж, СтрокаМес, Истина ) Тогда
							// - СВЭЙ КДЯ 15.09.19 СВФР-004631 ( пункт 26. )
							
							Продолжить;
							
						КонецЕсли;
						//- СВЭЙ КДЯ 10.09.19 СВФР-004631 ( пункт 15. )
						
						
						// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
						//если Прерывание Тогда 
						//	Продолжить;
						//КонецЕсли;
						// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
						
						// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
						ДатаНачалаДоговора = СтрокаСтаж.ДатаНачалаРабот;
						// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
						// + СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 37. )
						ДатаНачалаДог = СтрокаСтаж.ДатаНачалаРабот;
						// - СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 37. )
						
						//О.Т. Аверсон 05.04.2019 № 4187
						если КатегорияВывод = "ДОГОВОР" 
							// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
							И НЕ ВыгруженыРанниеВзносы
							// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
							Тогда 
							
							если не ДатаНачалаДоговора = Дата(1,1,1) Тогда
								
								Если Год( Дата( ДатаНачалаДоговора  )) < Год( ПериодДляДоговора ) Тогда
									
									ДатаНачалаДог = Макс(Дата(ДатаНачалаДоговора),Дата(2014,01,01));
									ДатаОкончанияДог = Дата(ДатаОкончанияДоговора);
									Пока Год( ДатаНачалаДог ) < Год( ПериодДляДоговора ) Цикл 
										ДатаОкончанияДог = КонецГода( ДатаНачалаДог );
										
										// + СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
										//ДатаФормированияДети = ДатаНачалаДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
										//
										//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										//ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										//
										//
										//ДатаФормированияДети = ДатаОкончанияДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
										//
										//ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										//МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										//ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										//ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										//
										//СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ВЗНОСЫВРЕМ"+"= = =");
										// - СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
										
										
										// + СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
										ДатаНачалаВзносыВрем   = Формат( ДатаНачалаДог, "ДФ=""дд/ММ/гггг""" );
										ДатаОкончанияВзносыВрем   = Формат( ДатаОкончанияДог , "ДФ=""дд/ММ/гггг""" );
										СтрокаЗар = ВРЕГ( ТипЗаписиНач3 + ДатаНачалаВзносыВрем + "=" + ДатаОкончанияВзносыВрем + "= =" + "ВЗНОСЫВРЕМ" + "= = =" );
										// - СВЭЙ КДЯ 13.09.19 СВФР-004631 ( пункт 23. )
										
										ТекстФайла.ДобавитьСтроку( СтрокаЗар );
										ТекСтрока = ТекСтрока + 1;
										ВзносыВрВыгружена = Истина;
										
										// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
										ВыгруженыРанниеВзносы = Истина;
										// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
										
										//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										//ТекСтрока = ТекСтрока+1;
										КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
										
										ДатаНачалаДог = Дата( Год( ДатаНачалаДог ) + 1, 01, 01 )
									КонецЦикла;
									
								КонецЕсли;
							КонецЕсли;
							
						КонецЕсли;
						//О.Т. Аверсон 05.04.2019 № 4187
						
						если КатегорияВывод = "ДОГОВОР" Тогда 
							если не ДатаНачалаДоговора = Дата(1,1,1) Тогда 
								ДатаФормированияДети = ДатаНачалаДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
								
								
								// + СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
								//Прерывание = Истина;
								// - СВЭЙ КДЯ 14.09.19 СВФР-004631 ( пункт 26. )
							Иначе 
								ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот;//О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
							КонецЕсли;
						иначе
							ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот;//О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012							
						КонецЕсли;
						
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						
						если КатегорияВывод = "ДОГОВОР" Тогда 
							если не ДатаОкончанияДоговора = Дата(1,1,1) Тогда 
								ДатаФормированияДети = ДатаОкончанияДоговора; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
							Иначе 
								//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
								//ДатаФормированияДети = Мин(СтрокаСтаж.ДатаОкончанияРабот,КонецМесяца(ПериодДляДоговора));
								//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
								//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
								ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
								//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
							КонецЕсли;
						иначе
							//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
							//ДатаФормированияДети = Мин(СтрокаСтаж.ДатаОкончанияРабот,КонецМесяца(ПериодДляДоговора));
							//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
							//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
							ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
							//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 35. )
						КонецЕсли;
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ВЗНОСЫВРЕМ"+"= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						ВзносыВрВыгружена = Истина;
						
						//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						//ТекСтрока = ТекСтрока+1;
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
						//Если Категория = "03" тогда
						//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
						//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
						//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
						//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
						//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
						//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
						//КонецЕсли;
						//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
						//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
						
					КонецЦикла;
					//КонецЕсли;
					
					
				КонецЕсли;
				
				
				////Для пенсии
				если НазначениеПенсии Тогда 
					если не ПенсияВыгружена Тогда 
						ТипЗаписиНач2 = "СТАЖ=";
						Структура = Новый Структура;
						Если ОбъединятьОсновные Тогда 
							Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
						иначе
							Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
						КонецЕсли;
						
						если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							Структура.Вставить("ВидДоговора",null);
						Иначе 
							Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
						КонецЕсли;
						ПериодПенсии = СтрокиПоРаботнику1[СтрокиПоРаботнику1.Количество()-1].Период;
						ДеньШапки        = ?(День(НачалоМесяца(ПериодПенсии))<10,"0","")+День(НачалоМесяца(ПериодПенсии));
						МесяцШапки       = ?(Месяц(НачалоМесяца(ПериодПенсии))<10,"0","")+Месяц(НачалоМесяца(ПериодПенсии));
						ГодШапки 		 = Строка(СокрЛП(Формат(Год(НачалоМесяца(ПериодПенсии)), "ЧГ=0")));
						ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						ДеньШапки        = ?(День(КонецМесяца(ПериодПенсии))<10,"0","")+День(КонецМесяца(ПериодПенсии));
						МесяцШапки       = ?(Месяц(КонецМесяца(ПериодПенсии))<10,"0","")+Месяц(КонецМесяца(ПериодПенсии));
						ГодШапки 		 = Строка(СокрЛП(Формат(Год(КонецМесяца(ПериодПенсии)), "ЧГ=0")));
						ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач2+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="+"ПЕНСИЯ= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
					КонецЕсли;
					ПенсияВыгружена = Ложь;  //Островская Татьяна 20.01.2014 № 17051
				КонецЕсли;
				
				если не ДетиВыгружена Тогда
					ТипЗаписиНач3 = "СТАЖ=";
					ОтборДети = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						ОтборДети.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
					иначе
						ОтборДети.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
					КонецЕсли;
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	ОтборДети.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
					//Иначе 
					//	ОтборДети.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					//КонецЕсли;
					//ОтборДети.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "ДЕТИ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( ОтборДети );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					ОтборДети.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					ОтборДети.Вставить( "ВидДеятельности",  "ДЕТИ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( ОтборДети );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//Аверсон ЕАЕ 18.04.2022 СВФР-008941
					МассивВидовДеятельностиДети = Новый Массив;
					МассивВидовДеятельностиДети.Добавить("ДЕТИ0");
					МассивВидовДеятельностиДети.Добавить("ДЕТИ100");
					МассивВидовДеятельностиДети.Добавить("ДЕТИ50");
					МассивВидовДеятельностиДети.Добавить("ДПОСОБ100");
					МассивВидовДеятельностиДети.Добавить("ДПОСОБ50");
					Для Каждого ВД Из МассивВидовДеятельностиДети Цикл
						ОтборДети.ВидДеятельности = ВД;
						СтрПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки(ОтборДети);
						Для Каждого Эл Из СтрПоРаботнику Цикл
							СтрокиПоРаботнику.Добавить(Эл);	
						КонецЦикла;
					КонецЦикла;
					//Аверсон СВФР-008941
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					//КоличествоЗаписейОСтаже = 0;
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						//если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ДатаОкончанияРабот)) Тогда 
						//	Продолжить;
						//КонецЕсли;
						
						ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						
						ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						//Аверсон ЕАЕ 18.04.2022 СВФР-008941
						//СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ДЕТИ"+"= = =");
						ДетиСтр = СокрЛП(СтрокаСтаж.ВидДеятельности);
						КолДетей = ПолучитьКоличествоДетей(СтрокаСтаж.ФизЛицо, СтрокаСтаж.ДатаНачалаРабот);
						КолДетейСтр = СокрЛП(КолДетей);
						СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+ ДетиСтр +"=" + КолДетейСтр + "= =");
						//Аверсон СВФР-008941
						
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						ДетиВыгружена = Ложь;
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
						//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
						//ДетиЕсть = Истина;
						//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
						
						//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						//ТекСтрока = ТекСтрока+1;
						//КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
						//Если Категория = "03" тогда
						//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
						//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
						//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
						//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
						//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
						//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
						//КонецЕсли;
						//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
						//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
						
					КонецЦикла;
				КонецЕсли;
				
				
				если не ПособиеВыгружена Тогда
					ТипЗаписиНач3 = "СТАЖ=";
					ОтборПособие = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						ОтборПособие.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
					иначе
						ОтборПособие.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	ОтборПособие.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
					//Иначе 
					//	ОтборПособие.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					//КонецЕсли;
					//ОтборПособие.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "ПОСОБИЕ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( ОтборПособие );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					ОтборПособие.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					ОтборПособие.Вставить( "ВидДеятельности",  "ПОСОБИЕ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( ОтборПособие );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						//если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ДатаОкончанияРабот)) Тогда 
						//	Продолжить;
						//КонецЕсли;
						//О.Т. Аверсон 23.08.2018 № 2335
						Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
							Если СтрокаСтаж.Договор <> СтрокаМес.ДокументОснование Тогда 
								Продолжить;								
							КонецЕсли;
						КонецЕсли;
						//О.Т. Аверсон 23.08.2018 № 2335
						
						
						ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						
						ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ПОСОБИЕ"+"= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						ПособиеВыгружена = Ложь;
						
						//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						//ТекСтрока = ТекСтрока+1;
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
						//Если Категория = "03" тогда
						//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
						//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
						//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
						//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
						//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
						//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
						//КонецЕсли;
						//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
						//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
						
					КонецЦикла;
				КонецЕсли;
				
				//О.Т. Аверсон 21.05.2018 № 1985
				если не СтрахСлучВыгружена Тогда
					ТипЗаписиНач3 = "СТАЖ=";
					ОтборСтрахСлуч = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						ОтборСтрахСлуч.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					иначе
						ОтборСтрахСлуч.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	ОтборСтрахСлуч.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
					//Иначе 
					//	ОтборСтрахСлуч.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					//КонецЕсли;
					//ОтборСтрахСлуч.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "СТРАХСЛУЧ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( ОтборСтрахСлуч );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					ОтборСтрахСлуч.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					ОтборСтрахСлуч.Вставить( "ВидДеятельности",  "СТРАХСЛУЧ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( ОтборСтрахСлуч );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						//если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ДатаОкончанияРабот)) Тогда 
						//	Продолжить;
						//КонецЕсли;
						
						ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						
						ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"СТРАХСЛУЧ"+"= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						СтрахСлучВыгружена = Ложь;
						
						//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						//ТекСтрока = ТекСтрока+1;
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
						//Если Категория = "03" тогда
						//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
						//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
						//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
						//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
						//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
						//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
						//КонецЕсли;
						//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
						//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
						
					КонецЦикла;
				КонецЕсли;
				//О.Т. Аверсон 21.05.2018 № 1985
				
				если не ПремияВыгружена Тогда
					ТипЗаписиНач3 = "СТАЖ=";
					СтруктураПремия = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						СтруктураПремия.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
					иначе
						СтруктураПремия.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	СтруктураПремия.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
					//Иначе 
					//	СтруктураПремия.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					//КонецЕсли;                 
					//СтруктураПремия.Вставить( "ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду( "ПРЕМИЯ" ) );
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( СтруктураПремия );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					СтруктураПремия.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					СтруктураПремия.Вставить( "ВидДеятельности",  "ПРЕМИЯ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураПремия );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						
						ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						
						ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ПРЕМИЯ"+"= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						ПремияВыгружена = Ложь;
						
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
						
					КонецЦикла;
				КонецЕсли;
				
				
				КолВзносыВрем = 0;
				если не ВзносыВрВыгружена Тогда
					ТипЗаписиНач3 = "СТАЖ=";
					СтруктураВзносыВр = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						СтруктураВзносыВр.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					иначе
						СтруктураВзносыВр.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
					КонецЕсли;
					
					если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
						СтруктураВзносыВр.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
					Иначе 
						СтруктураВзносыВр.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					//СтруктураВзносыВр.Вставить("ВидДеятельности",Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВЗНОСЫВРЕМ"));
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки(СтруктураВзносыВр); 
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					СтруктураВзносыВр.Вставить( "ВидДеятельности", "ВЗНОСЫВРЕМ" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( СтруктураВзносыВр );
					//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
					
					//+ СВЭЙ КДЯ 26.10.19 СВФР-004631 ( Пункт 48. )
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					//- СВЭЙ КДЯ 26.10.19 СВФР-004631 ( Пункт 48. )
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					Прерывание = Ложь;
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						//если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ДатаОкончанияРабот)) Тогда 
						//	Продолжить;
						//КонецЕсли;
						если Прерывание Тогда 
							Продолжить;
						КонецЕсли;
						
						//О.Т. Аверсон 05.04.2019 № 4187
						если КатегорияВывод = "ДОГОВОР" Тогда 
							если не ДатаНачалаДоговора = Дата(1,1,1) Тогда 
								Если Год(Дата(ДатаНачалаДоговора)) < Год(ПериодДляДоговора) Тогда 
									ДатаНачалаДог = Макс(Дата(ДатаНачалаДоговора),Дата(2014,01,01));
									ДатаОкончанияДог = Дата(ДатаОкончанияДоговора);
									Пока Год(ДатаНачалаДог) < Год(ПериодДляДоговора) Цикл 
										ДатаОкончанияДог = КонецГода(ДатаНачалаДог);
										
										ДатаФормированияДети = ДатаНачалаДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
										
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										
										ДатаФормированияДети = ДатаОкончанияДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
										
										ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
										МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
										ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
										ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
										
										СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ВЗНОСЫВРЕМ"+"= = =");
										ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										ТекСтрока = ТекСтрока+1;
										ВзносыВрВыгружена = Истина;
										
										//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
										//ТекСтрока = ТекСтрока+1;
										КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
										
										ДатаНачалаДог = Дата(Год(ДатаНачалаДог)+1,01,01)
									КонецЦикла;
								КонецЕсли;
							КонецЕсли;
							
						КонецЕсли;
						//О.Т. Аверсон 05.04.2019 № 4187
						если КатегорияВывод = "ДОГОВОР" Тогда 
							если не ДатаНачалаДоговора = Дата(1,1,1) Тогда 
								ДатаФормированияДети = ДатаНачалаДог; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
								Прерывание = Истина;
							Иначе 
								ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
							КонецЕсли;
						иначе
							ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012							
						КонецЕсли;
						
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						если КатегорияВывод = "ДОГОВОР" Тогда 
							если не ДатаОкончанияДоговора = Дата(1,1,1) Тогда 
								ДатаФормированияДети = ДатаОкончанияДоговора; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
								Прерывание = Истина;
							Иначе 
								ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
							КонецЕсли;
						иначе
							ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;							
						КонецЕсли;
						ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
						МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
						ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
						ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+"ВЗНОСЫВРЕМ"+"= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						ВзносыВрВыгружена = Ложь;
						КолВзносыВрем = КолВзносыВрем+1;
						
						//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						//ТекСтрока = ТекСтрока+1;
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
						//Если Категория = "03" тогда
						//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
						//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
						//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
						//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
						//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
						//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
						//КонецЕсли;
						//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
						//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
						
					КонецЦикла;
				КонецЕсли;
				
				//Аверсон ЕАЕ 21.07.2021 СВФР-007783
				//вывод ПрофДоп
				если не ПрофДопВыгружена Тогда
					ТипЗаписиНач3 = "СТАЖ=";
					ОтборПрофДоп = Новый Структура;
					Если ОбъединятьОсновные Тогда 
						ОтборПрофДоп.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
					иначе
						ОтборПрофДоп.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
					КонецЕсли;
					
					ОтборПрофДоп.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					ОтборПрофДоп.Вставить( "ВидДеятельности",  "ПРОФДОП" );
					СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( ОтборПрофДоп );
					
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
					
					ПредыдущийВидДейтельности = "";
					ПредыдущееОкончаниеРабот = "";
					ДатаНачалаРабот = "";
					Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
						ДатаФормированияПрофДоп = СтрокаСтаж.ДатаНачалаРабот; 
						ДеньШапкиПрофДоп        = ?(День(ДатаФормированияПрофДоп)<10,"0","")+День(ДатаФормированияПрофДоп);
						МесяцШапкиПрофДоп       = ?(Месяц(ДатаФормированияПрофДоп)<10,"0","")+Месяц(ДатаФормированияПрофДоп);
						ГодШапкиПрофДоп 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияПрофДоп), "ЧГ=0")));
						ДатаНачалаРаботПрофДоп   = ДеньШапкиПрофДоп+"/"+МесяцШапкиПрофДоп+"/"+ГодШапкиПрофДоп;
						
						
						ДатаФормированияПрофДоп = СтрокаСтаж.ДатаОкончанияРабот;
						ДеньШапкиПрофДоп        = ?(День(ДатаФормированияПрофДоп)<10,"0","")+День(ДатаФормированияПрофДоп);
						МесяцШапкиПрофДоп       = ?(Месяц(ДатаФормированияПрофДоп)<10,"0","")+Месяц(ДатаФормированияПрофДоп);
						ГодШапкиПрофДоп 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияПрофДоп), "ЧГ=0")));
						ДатаОкончанияРаботПрофДоп   = ДеньШапкиПрофДоп+"/"+МесяцШапкиПрофДоп+"/"+ГодШапкиПрофДоп;
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач3+ДатаНачалаРаботПрофДоп+"="+ДатаОкончанияРаботПрофДоп+"= ="+"ПРОФДОП"+"= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						ДетиВыгружена = Ложь;
						КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
						
					КонецЦикла;
				КонецЕсли;
				//Аверсон СВФР-007783
				
				Если КатегорияВывод= "ДОГОВОР" Тогда
					ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар+">");
				КонецЕсли;
				
				//+ СВЭЙ КДЯ 26.10.19 СВФР-004631 ( Пункт 48. )
				////ПСА 04.07.2019 СВФР-004497++
				//ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику
				//		                          //+ СВЭЙ КДЯ 25.07.19 СВФР-004561
				//									, ЗначениеКв
				//								  //- СВЭЙ КДЯ 25.07.19 СВФР-004561
				//			 					);
				////+++ПСА 04.07.2019 СВФР-004497
				//- СВЭЙ КДЯ 26.10.19 СВФР-004631 ( Пункт 48. )
				
				// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
				////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
				////учитываем пособия
				//СтруктураПособия = Новый Структура;
				//СтруктураПособия.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
				//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
				//	СтруктураПособия.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
				//Иначе 
				//	СтруктураПособия.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
				//КонецЕсли;
				//СтруктураПособия.Вставить("ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОБИЕ"));
				//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( СтруктураПособия ); 
				//ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв );
				// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
				
				Если СтрДлина( ЗначениеКв ) = 2 И Лев( ЗначениеКв, 1 ) = " " Тогда
					
					//Значит, по договору все записи о стаже: НЕОПЛДОГ  - подсчитываем их.
					
					// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
					//СтруктураНеоплДог = Новый Структура;
					//СтруктураНеоплДог.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
					//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
					//	СтруктураНеоплДог.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
					//Иначе 
					//	СтруктураНеоплДог.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
					//КонецЕсли;
					//СтруктураНеоплДог.Вставить("ВидДеятельности", НеоплДог);
					//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( СтруктураНеоплДог );
					//
					//ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику, ЗначениеКв
					//			//+ СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 5 )
					//			, СтрокаМес
					//			//- СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 5 )
					//			);
					// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
					
					
					// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
					//все записи по договору "НЕОПЛДОГ"
					ОтборСтрокСтажаДоговора = Новый Структура;
					ОтборСтрокСтажаДоговора.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
					ОтборСтрокСтажаДоговора.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
					Если НомерДоговораПрошл <> "" Тогда
						ОтборСтрокСтажаДоговора.Вставить( "НомерДокумента", НомерДоговораПрошл );
						// + СВЭЙ КДЯ СВФР-004631 19.09.19 ( пункт 32. )
						//ОтборСтрокСтажаДоговора.Вставить( "ДатаДокумента", ДатаДоговораПрошл );
						// - СВЭЙ КДЯ СВФР-004631 19.09.19 ( пункт 32. )
						//+ СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
						//// + СВЭЙ КДЯ СВФР-004631 19.09.19 ( пункт 32. )
						//ОтборСтрокСтажаДоговора.Вставить( "ДатаДляПу", ДатаДоговораПрошл );
						//// - СВЭЙ КДЯ СВФР-004631 19.09.19 ( пункт 32. )
						//- СВЭЙ КДЯ 28.10.19 СВФР-004631 ( Пункт 49. )
						
						//Аверсон ЕАЕ 18.02.2023 СВФР-010250
						ОтборСтрокСтажаДоговора.Вставить( "ДатаДокумента", ДатаДоговораПрошл );
						//Аверсон СВФР-010250
					КонецЕсли;
					СтрокиСтажаДоговора = ТЗ_СведенияОСтаже.НайтиСтроки( ОтборСтрокСтажаДоговора );
					
					ЗначениеКв = ПолучитьЗначениеКВ( СтрокиСтажаДоговора, ЗначениеКв );
					КоличествоЗаписейОСтаже = СтрокиСтажаДоговора.Количество();
					// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
					
				КонецЕсли; 
				//- СВЭЙ КДЯ 25.07.19 СВФР-004561
				
				
				//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
				КоличествоЗаписейОСтажеИтого = КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0);
				//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
				
				//если не СтрМес>1 Тогда 
				если не КатегорияВывод= "ДОГОВОР" Тогда
					
					
					//Островская Татьяна 20.01.2014 № 17051
					СтрокаФайла = ВРЕГ(СтрокаФайла+ ?(РаботДоход = 0, "0", СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
					?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос1 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос1,"ЧГ=0"))))+"="+
					?(РаботВзнос2 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос2,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос3 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос3,"ЧГ=0"))))+"="+
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//Формат( КоличествоМес, "ЧГ=0" ) + "=" 
					//+ ?(СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0")))="0","0",СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0)+?(ДетиЕсть,1,0),"ЧГ=0"))))
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//?( ЕстьНеоплДог ИЛИ КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
					//+ ?( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0) + ?( ДетиЕсть, 1, 0 ) = 0, "0", Формат( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0 ) + ?( ДетиЕсть, 1, 0 ), "ЧГ=0" ) )
					////- СВЭЙ КДЯ 25.07.19 СВФР-004561
					//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					
					//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					?( КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
					+ ?( КоличествоЗаписейОСтажеИтого = 0, "0", Формат( КоличествоЗаписейОСтажеИтого, "ЧГ=0" ) )
					//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					
					+ "=" + ДатаЗаполнения + "=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) + "=" 
					+ Формат( ГОД( ДатаНачала ),"ЧГ=0") + "=" + СтрЗаменить( ТелефонОрганизации, " ", "" ) ) + "=";
				иначе
					
					
					//+ СВЭЙ КДЯ 22.10.19 СВФР-004948
					//Если НомерДоговораПрошл <> "" и ДатаДоговораПрошл <> "" Тогда
					//ДопСтрокаФайла1 = СтрЗаменить( НомерДоговораПрошл, " ", "" ) + "=" +  Формат( ДатаДоговораПрошл, "ДФ=""дд/ММ/гггг""" ) + "=" ;
					//Если НомерДоговора <> "" и ДатаДокумента <> "" Тогда
					//	ДопСтрокаФайла1 = СтрЗаменить( ДатаДокумента, " ", "" ) + "=" +  Формат( ДатаДоговораПрошл, "ДФ=""дд/ММ/гггг""" ) + "=" ;
					Если ЗначениеЗаполнено( НомерДоговора ) И ЗначениеЗаполнено( ДатаДокумента ) Тогда
						ДопСтрокаФайла1 = СтрЗаменить( НомерДоговора, " ", "" ) + "=" +  Формат( ДатаДокумента, "ДФ=""дд/ММ/гггг""" ) + "=" ;
					Иначе
						ДопСтрокаФайла1 = "";
					КонецЕсли;		
					//- СВЭЙ КДЯ 22.10.19 СВФР-004948
					
					
					//если не СтрМес>1 Тогда
					//Островская Татьяна 20.01.2014 № 17051
					
					//+ СВЭЙ КДЯ 22.10.19 СВФР-004948
					//СтрокаФайла = ВРЕГ(СтрокаФайла
					//- СВЭЙ КДЯ 22.10.19 СВФР-004948
					
					//+ СВЭЙ КДЯ 21.11.19 СВФР-004631 ( Пункт 66. )
					////+ СВЭЙ КДЯ 22.10.19 СВФР-004948
					//СтрокаФайла = ВРЕГ( ПрефиксСтрокаФайла1 + ДопСтрокаФайла1
					////- СВЭЙ КДЯ 22.10.19 СВФР-004948
					//- СВЭЙ КДЯ 21.11.19 СВФР-004631 ( Пункт 66. )
					
					//+ СВЭЙ КДЯ 21.11.19 СВФР-004631 ( Пункт 66. )
					НовыйПрефиксСтроки = ПрефиксСтрокаФайла1 + ДопСтрокаФайла1;
					Если НовыйПрефиксСтроки = "" Тогда
						НовыйПрефиксСтроки = СтрокаФайла + СтрокаМес.НомерДокумента + "=" 
						+  Формат( СтрокаМес.ДатаДокумента, "ДФ=""дд/ММ/гггг""" ) + "=";	
					КонецЕсли; 
					СтрокаФайла = ВРЕГ( НовыйПрефиксСтроки
					//- СВЭЙ КДЯ 21.11.19 СВФР-004631 ( Пункт 66. )              
					
					
					+ ?(РаботДоход = 0, ?(ЕстьНеоплДог,"0"," "), СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
					?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос1 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос1,"ЧГ=0"))))+"="+
					?(РаботВзнос2 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос2,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос3 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос3,"ЧГ=0"))))+"="+
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//?( ЕстьНеоплДог и КоличествоМес=0, "0", Формат(КоличествоМес,"ЧГ=0")) +"=" 
					//+?(СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0")))="0","0",СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0)+?(ДетиЕсть,1,0),"ЧГ=0"))))
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					////+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//?( ЕстьНеоплДог ИЛИ КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
					//+ ?( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0) + ?( ДетиЕсть, 1, 0 ) = 0, "0", Формат( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0 ) + ?( ДетиЕсть, 1, 0 ), "ЧГ=0" ) )
					////- СВЭЙ КДЯ 25.07.19 СВФР-004561
					//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					
					//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					?( ЕстьНеоплДог ИЛИ КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
					+ ?( КоличествоЗаписейОСтажеИтого = 0, "0", Формат( КоличествоЗаписейОСтажеИтого, "ЧГ=0" ) )
					//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
					
					+ "=" + ДатаЗаполнения + "=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) + "=" 
					+ Формат( ГОД( ДатаНачала ), "ЧГ=0" ) + "=" + СтрЗаменить( ТелефонОрганизации, " ", "" ) ) + "=";
					если СчДляПУ > 0 Тогда 
						//+ СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
						//ТекстФайла.ЗаменитьСтроку(ТекСтрокаДляСтрПУ,СтрокаФайла1);
						//- СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
						//+ СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
						ТекстФайла.ЗаменитьСтроку( ТекСтрокаДляСтрПУ, СтрокаФайла );
						//- СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
					КонецЕсли;
					ТекСтрокаДляСтрПУ = ТекСтрока;
					//КонецЕсли;	
				КонецЕсли;
				
				//+ СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
				//ДетиЕсть = Ложь;
				//- СВЭЙ КДЯ 27.08.19 СВФР-004631 ( пункт 11. )
				
				//КонецЕсли;   
				
				СтрокаЗар = СтрокаЗар + ">";
				
				////Аверсон 23.07.2023 КВВ СВФР-011153 (пункт 2) (
				//
				//Если ЗначениеЗаполнено(СтрокаЗар) Тогда
				//	СтрокаЗар = СтрокаЗар + ">"; 
				//Иначе
				//	Продолжить;
				//КонецЕсли;
				////Аверсон 23.07.2023 КВВ СВФР-011153 (пункт 2) )
				
				если КатегорияВывод= "ДОГОВОР" Тогда 
					если СчДляПУ = 0 Тогда 
						ТекстФайла.ЗаменитьСтроку(СтрокаЗамены, СтрокаФайла);
						если не КатегорияВывод= "ДОГОВОР" Тогда		
							ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар);
						КонецЕсли; 
						
					КонецЕсли;
					
				иначе
					ТекстФайла.ЗаменитьСтроку(СтрокаЗамены, СтрокаФайла);
					если не КатегорияВывод= "ДОГОВОР" Тогда
						ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар);
					КонецЕсли; 
					
				КонецЕсли;
				
				
			иначе
				
				РаботДоход = 0;
				РаботБольн = 0;
				РаботВзнос = 0;
				РаботВзнос1 = 0; //Островская Татьяна 17.01.2014 № 17051
				РаботВзнос2 = 0;
				РаботВзнос3 = 0;
				РаботДоход = 0;
				РаботБольн = 0;
				РаботВзнос = 0;
				РаботВзнос1 = 0;
				РаботВзнос2 = 0;
				РаботВзнос3 = 0;
				СтрокаФайла = ТипЗаписи;
				//Инициалы должны быть указаны
				Фамилия = ВРег(?(ВыборкаПоРаботникиОрганизации.Фамилия = "", " ", СокрЛП(ВыборкаПоРаботникиОрганизации.Фамилия)));
				Имя = Врег(?(ВыборкаПоРаботникиОрганизации.Имя = "", " ", Лев(СокрЛП(ВыборкаПоРаботникиОрганизации.Имя),1)));
				Отчество = Врег(?(ВыборкаПоРаботникиОрганизации.Отчество = "", " ", Лев(СокрЛП(ВыборкаПоРаботникиОрганизации.Отчество),1)));
				Категория =?(ВыборкаПоРаботникиОрганизации.Категория = "", "01", СокрЛП(ВыборкаПоРаботникиОрганизации.Категория));
				//толик			СтрокаФайла = СтрокаФайла+СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)+"="+Фамилия+"="+Имя+"="+Отчество+"="+Категория+"=";
				СтрокаЗар = "";
				//Островская Татьяна 02.11.2012 № 15
				если ЗначениеЗаполнено(ВыборкаПоРаботникиОрганизации.ВидДоговора) Тогда 
					КатегорияВывод = "ДОГОВОР";
				ИНАЧЕ
					КатегорияВывод = "";
				КонецЕсли;
				Структура = Новый Структура;
				Если ОбъединятьОсновные Тогда 
					Структура.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
				иначе
					Структура.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
				КонецЕсли;
				
				//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Неопределено Тогда 
				//	Структура.Вставить("ВидДоговора",Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка());
				//Иначе 
				//	Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
				//КонецЕсли;
				//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				Структура.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
				//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				
				Если ОбъединятьОсновные Тогда 
					СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо));
				иначе
					СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник));
				КонецЕсли;
				ЕстьВидРасчета = Ложь;
				Для каждого СтрДог из СтрокиПоРаб цикл
					если не СокрЛП(СтрДог.ВидДейтельности) = "" Тогда
						ЕстьВидРасчета = Истина;
					КонецЕсли;
				КонецЦикла;
				Если ОбъединятьОсновные Тогда 
					СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо));
				иначе
					СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник));
				КонецЕсли;
				
				Для каждого СтрДог из СтрокиПоРаб цикл 
					если ЕстьВидРасчета Тогда 
						если СокрЛП(СтрДог.ВидДейтельности) = "" Тогда
							Продолжить;
						КонецЕсли;
					КонецЕсли;
					
					
					если КатегорияВывод= "ДОГОВОР"  Тогда 
						
						СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"03"+"=";
					Иначе 
						СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"01"+"=";
						
					КонецЕсли;
					
					Прервать;
					
				КонецЦикла;
				Если СтрокиПоРаб.Количество()=0 Тогда 
					СтрокаФайла = СтрокаФайла+?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"01"+"=";
					Сообщить("Данные не найдены по сотруднику "+ВыборкаПоРаботникиОрганизации.ФизЛицо.Наименование);					
				КонецЕсли;
				
				//Островская Татьяна 02.11.2012 № 15
				Если Отказ Тогда
					Продолжить;
				КонецЕсли;                     
				
				НомерДокументаВПачке = 	НомерДокументаВПачке + 1;
				
				//Берем запись с пустыми полями
				//Запись = ПолучитьСтруктуруЗаписи(ТаблицаФорматаЗаписи);
				
				НомерДокументаВПачке = НомерДокументаВПачке;
				ТекстФайла.ДобавитьСтроку(СтрокаФайла);
				ТекСтрока = ТекСтрока+1;
				СтрокаЗамены = ТекСтрока;
				
				КоличествоМес = 0;
				СтрокаДатаДокумента = "";
				СтрокаНомерДокумента = "";
				СтрМес = 1;
				СтрокаФайла1 = "";
				Сч =0;
				СтрокиПоРаботнику1 = ПромежуточнаяТаблица.НайтиСтроки(Структура);
				
				
				Колич = СтрокиПоРаботнику1.Количество();
				
				
				если Колич = 0 Тогда 
					СтрокиПоРаботнику1 = Новый ТаблицаЗначений;
					СтрокиПоРаботнику1.Колонки.Добавить("Больничные");
					СтрокиПоРаботнику1.Колонки.Добавить("СуммаДохода");
					Если не ОбъединятьОсновные Тогда 
						СтрокиПоРаботнику1.Колонки.Добавить("Сотрудник");
					КонецЕсли;
					СтрокиПоРаботнику1.Колонки.Добавить("ФизЛицо");
					СтрокиПоРаботнику1.Колонки.Добавить("Период");
					СтрокиПоРаботнику1.Колонки.Добавить("ПроцентФСЗН");
					СтрокиПоРаботнику1.Колонки.Добавить("ПенсионныйФонд");
					СтрокиПоРаботнику1.Колонки.Добавить("ФСЗН");
					СтрокиПоРаботнику1.Колонки.Добавить("ВидДоговора");
					СтрокиПоРаботнику1.Колонки.Добавить("НомерДокумента");
					СтрокиПоРаботнику1.Колонки.Добавить("ДатаДокумента");
					СтрокиПоРаботнику1.Колонки.Добавить("ПричиныМинимальнойЗП");//О.Т. Аверсон 01.04.2019 № 4182
					Дата1 = ДатаНачала;
					Дата2 = ДатаОкончания;
					пока Дата1 <= Дата2 Цикл  
						СтрокаСтрокиПоРаботнику1 = СтрокиПоРаботнику1.Добавить();
						СтрокаСтрокиПоРаботнику1.Больничные = 0;
						СтрокаСтрокиПоРаботнику1.Период = НачалоМесяца(Дата1);
						СтрокаСтрокиПоРаботнику1.СуммаДохода = 0;
						Если не ОбъединятьОсновные Тогда 
							СтрокаСтрокиПоРаботнику1.Сотрудник = ВыборкаПоРаботникиОрганизации.Сотрудник;
						КонецЕсли;
						СтрокаСтрокиПоРаботнику1.ФизЛицо = ВыборкаПоРаботникиОрганизации.ФизЛицо;
						СтрокаСтрокиПоРаботнику1.ПроцентФСЗН = 0;
						СтрокаСтрокиПоРаботнику1.ПенсионныйФонд = 0;
						СтрокаСтрокиПоРаботнику1.ФСЗН = 0;
						//О.Т. Аверсон 18.04.2019 № 4246
						ПричинаМинЗП = Справочники.ПричиныМинимальнойЗаработнойПлаты.ПустаяСсылка();
						Если ОбъединятьОсновные Тогда 
							МассивСтрок = СведенияОВзносах.НайтиСтроки(Новый Структура("ФизЛицо,Месяц",ВыборкаПоРаботникиОрганизации.ФизЛицо,НачалоМесяца(Дата1)));
						иначе
							МассивСтрок = СведенияОВзносах.НайтиСтроки(Новый Структура("Сотрудник,Месяц",ВыборкаПоРаботникиОрганизации.Сотрудник,НачалоМесяца(Дата1)));
						КонецЕсли;
						Для каждого СтрокаТабличнойЧасти Из МассивСтрок Цикл
							ПричинаМинЗП = СтрокаТабличнойЧасти.ПричиныМинимальнойЗП; 							
						КонецЦикла;
						//О.Т. Аверсон 18.04.2019 № 4246						
						СтрокаСтрокиПоРаботнику1.ПричиныМинимальнойЗП = ПричинаМинЗП;
						
						//СтрокаСтрокиПоРаботнику1.СуммаДохода = 0;
						//СтрокаСтрокиПоРаботнику1.СуммаДохода = 0;
						//СтрокаСтрокиПоРаботнику1.СуммаДохода = 0;
						//СтрокаСтрокиПоРаботнику1.СуммаДохода = 0;
						Дата1 = ДобавитьМесяц(Дата1,1);
					КонецЦикла;
					
					Колич = СтрокиПоРаботнику1.Количество();
					
				КонецЕсли;
				
				СтрокаЗамена = СтрокаФайла;
				Для Сч = 0 по Колич-1 цикл
					СтрокаМес = СтрокиПоРаботнику1[Сч];
					
					РезультатДоговор= 0;
					Если не (ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда) Тогда //О.Т. Аверсон 22.08.2018 № 2335
						если КатегорияВывод= "ДОГОВОР" Тогда
							ЗапросДог = Новый Запрос;
							ЗапросДог.Текст = 
							"ВЫБРАТЬ
							|	ЕСНСведенияОДоходах.Результат как Результат
							|ИЗ
							|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
							|ГДЕ
							|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &ПериодВзаиморасчетов И &ПериодВзаиморасчетов1";
							Если ОбъединятьОсновные Тогда
								ЗапросДог.Текст = ЗапросДог.Текст + "
								// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
								//|	И ЕСНСведенияОДоходах.Сотрудник = &Сотрудник";
								// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
								// + СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
								|	И ЕСНСведенияОДоходах.ФизЛицо = &ФизЛицо";
								// - СВЭЙ КДЯ 15.08.19 СВФР-004631 ( Пункт 11. )
							иначе
								ЗапросДог.Текст = ЗапросДог.Текст + "
								|	И ЕСНСведенияОДоходах.Сотрудник = &Сотрудник";
							КонецЕсли;
							ЗапросДог.Текст = ЗапросДог.Текст + "							
							|	И ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН <> &ДоходБольничныйФСЗН";
							//|	И ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета = &СпособРасчета";//О.Т. Аверсон 31.01.2017 № 244
							Если ОбъединятьОсновные Тогда 
								ЗапросДог.УстановитьПараметр("ФизЛицо",СтрокаМес.ФизЛицо);
							иначе
								ЗапросДог.УстановитьПараметр("Сотрудник",СтрокаМес.Сотрудник);
							КонецЕсли;
							ЗапросДог.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
							ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов",НачалоМесяца(СтрокаМес.Период));
							ЗапросДог.УстановитьПараметр("ПериодВзаиморасчетов1",КонецМесяца(СтрокаМес.Период));
							//ЗапросДог.УстановитьПараметр("СпособРасчета",Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой);
							РезДог = ЗапросДог.Выполнить().Выбрать();
							пока РезДог.Следующий() Цикл 
								РезультатДоговор =РезультатДоговор+РезДог.Результат; 
							КонецЦикла;
						КонецЕсли;
					иначе
						РезультатДоговор = СтрокаМес.СуммаДохода;
					КонецЕсли;
					
					
					
					
					
					если ЗначениеЗаполнено(СтрокаДатаДокумента) и ЗначениеЗаполнено(СтрокаНомерДокумента) Тогда 
					иначе
						
						СтрокаДатаДокумента = СтрокаМес.ДатаДокумента;
						СтрокаНомерДокумента = СтрокаМес.НомерДокумента;
					КонецЕсли;
					если не Сч > Колич-1 Тогда 
						СтрокаДатаДокументаСлед = СтрокиПоРаботнику1[Сч].ДатаДокумента;
						СтрокаНомерДокументаСлед = СтрокиПоРаботнику1[Сч].НомерДокумента;
					иначе
						СтрокаДатаДокументаСлед = СтрокаДатаДокумента;
						СтрокаНомерДокументаСлед = СтрокаНомерДокумента;
						
					КонецЕсли;
					Если Категория <> "03" тогда
						если КатегорияВывод= "ДОГОВОР" Тогда
							//+  СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
							//если  не СтрокаДатаДокументаСлед = "" Тогда  
							//-  СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
							//+  СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
							Если ЗначениеЗаполнено( СтрокаДатаДокументаСлед ) Тогда  
								//-  СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
								//если не СтрМес>1 Тогда
								ДеньДатыДоговора        = ?(День(СтрокаДатаДокументаСлед)<10,"0","")+День(СтрокаДатаДокументаСлед);
								МесяцДатыДоговора       = ?(Месяц(СтрокаДатаДокументаСлед)<10,"0","")+Месяц(СтрокаДатаДокументаСлед);
								ГодДатыДоговора 		 = Строка(СокрЛП(Формат(Год(СтрокаДатаДокументаСлед), "ЧГ=0")));
								ДатаДоговора   = ДеньДатыДоговора+"/"+МесяцДатыДоговора+"/"+ГодДатыДоговора;    
								//иначе
								//	ДеньДатыДоговора        = ?(День(СтрокаДатаДокумента)<10,"0","")+День(СтрокаДатаДокумента);
								//	МесяцДатыДоговора       = ?(Месяц(СтрокаДатаДокумента)<10,"0","")+Месяц(СтрокаДатаДокумента);
								//	ГодДатыДоговора 		 = Строка(СокрЛП(Формат(Год(СтрокаДатаДокумента), "ЧГ=0")));
								//	ДатаДоговора   = ДеньДатыДоговора+"/"+МесяцДатыДоговора+"/"+ГодДатыДоговора;
								//КонецЕсли;
							иначе
								ДатаДоговора = "";
							КонецЕсли;
							если не Сч > Колич-1 Тогда
								//+  СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
								//СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокументаСлед= "",СтрокаНомерДокументаСлед, Число(СтрокаНомерДокументаСлед)) +"="+ДатаДоговора+"=";					
								//-  СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
								//+  СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
								СтрокаФайла = СтрокаЗамена +?( НЕ ЗначениеЗаполнено( СтрокаНомерДокументаСлед ), СтрокаНомерДокументаСлед, 
								СтрЗаменить(Число(СтрокаНомерДокументаСлед)," ","")) +"="+ДатаДоговора+"=";					
								//-  СВЭЙ КДЯ 18.09.19 СВФР-004631 ( пункт 31. )
							иначе
								СтрокаФайла = СтрокаЗамена +?(СтрокаНомерДокумента= "",СтрокаНомерДокумента, СтрЗаменить(Число(СтрокаНомерДокумента)," ","")) +"="+ДатаДоговора+"=";
							КонецЕсли;
						Иначе 
							если не СтрМес>1 Тогда
								СтрокаФайла = СтрокаФайла+" = =";
							КонецЕсли;
						КонецЕсли;
						
						
					КонецЕсли;
					//КонецЕсли;
					если СтрМес > 1 Тогда 
						если КатегорияВывод= "ДОГОВОР" Тогда
							если не Сч > Колич-1 Тогда
								ТекстФайла.ДобавитьСтроку(СтрокаФайла1);
							иначе
								ТекстФайла.ДобавитьСтроку(СтрокаФайла);
							КонецЕсли;
							ТекСтрока = ТекСтрока+1;
							ТипЗаписиНач = "НЧСЛ=";
							если Сч <= СтрокиПоРаботнику1.Количество()-1 Тогда 
								если не КатегорияВывод= "ДОГОВОР" Тогда
									ИтогДохода = ИтогДохода + РаботДоход;
									ИтогБольн = ИтогБольн + РаботБольн;
									ИтогВзнос = ИтогВзнос + РаботВзнос;
									ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
									ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
									ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
								иначе
									ИтогДохода = ИтогДохода + РаботДоходСлед;
									ИтогБольн = ИтогБольн + РаботБольнСлед;
									ИтогВзнос = ИтогВзнос + РаботВзносСлед;
									ИтогВзнос1 = ИтогВзнос1 + РаботВзносСлед1;
									ИтогВзнос2 = ИтогВзнос2 + РаботВзносСлед2;
									ИтогВзнос3 = ИтогВзнос3 + РаботВзносСлед3;
									
								КонецЕсли;
							иначе
								если КатегорияВывод= "ДОГОВОР" Тогда
									ИтогДохода = ИтогДохода + РаботДоход;
									ИтогБольн = ИтогБольн + РаботБольн;
									ИтогВзнос = ИтогВзнос + РаботВзнос;
									ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
									ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
									ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
									
								иначе
									ИтогДохода = ИтогДохода + РаботДоход;
									ИтогБольн = ИтогБольн + РаботБольн;
									ИтогВзнос = ИтогВзнос + РаботВзнос;
									ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
									ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
									ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
									
								КонецЕсли;
							КонецЕсли;
							РаботДоход = 0;
							РаботБольн = 0;
							РаботВзнос = 0;
							РаботВзнос1 = 0;
							РаботВзнос2 = 0;
							РаботВзнос3 = 0;
							КоличествоМес = 0;
							КоличествоДокументов 	= КоличествоДокументов+1;
						КонецЕсли;
					КонецЕсли;
					
					//толик 	добавил округление - ЧДЦ=0;
					//Если (ЗначениеЗаполнено(СтрокаМес.СуммаДохода) Или ЗначениеЗаполнено(СтрокаМес.Больничные) или ЗначениеЗаполнено(СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд)) Тогда
					//Островская Татьяна 31.10.2012 № 15958
					если КатегорияВывод = 	"ДОГОВОР" Тогда 
						СтрокаМес.СуммаДохода = РезультатДоговор;
					иначе
						СтрокаМес.СуммаДохода = СтрокаМес.СуммаДохода - РезультатДоговор;
					КонецЕсли;
					
					//+ СВЭЙ КДЯ 18.10.19 СВФР-004944
					//делаем определение вида налогообложения не зависящим от флага ОбъединятьОсновные ( см. ниже )
					////О.Т. Аверсон 29.08.2018 № 2363
					//Если ОбъединятьОсновные Тогда 
					//	ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
					//иначе
					//	Если ЗначениеЗаполнено(СтрокаМес.Сотрудник.ВидНалогообложенияОсновной) Тогда 
					//		ОсновнойВидНалогообл = СтрокаМес.Сотрудник.ВидНалогообложенияОсновной;
					//	иначе
					//		ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
					//	КонецЕсли;
					//КонецЕсли;
					////О.Т. Аверсон 29.08.2018 № 2363
					//- СВЭЙ КДЯ 18.10.19 СВФР-004944
					
					
					//+ СВЭЙ КДЯ 21.10.19 СВФР-004944
					//делаем определение вида налогообложения не зависящим от флага ОбъединятьОсновные
					Если ЗначениеЗаполнено( ВыборкаПоРаботникиОрганизации.Сотрудник.ВидНалогообложенияОсновной ) Тогда 
						ОсновнойВидНалогообл = ВыборкаПоРаботникиОрганизации.Сотрудник.ВидНалогообложенияОсновной;
					иначе
						ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
					КонецЕсли;
					//- СВЭЙ КДЯ 21.10.19 СВФР-004944
					
					
					//О.Т. Аверсон 29.01.2018 № 1511
					СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокаМес.Период),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
					РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(СтрокаМес.Период) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
					БазаОграниченияФСЗН = СтруктураФСЗН.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
					
					Если СтрокаМес.СуммаДохода > БазаОграниченияФСЗН 
						//+ СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
						И НЕ ВыгрузкаДоговоровПодрядаБезОграничения И ДогПодряда 
						//- СВЭЙ КДЯ 30.10.19 СВФР-004631 ( Пункт 54. )
						Тогда 
						СтрокаМес.СуммаДохода = БазаОграниченияФСЗН;
					КонецЕсли;
					//О.Т. Аверсон 29.01.2018 № 1511
					
					ЗначениеОкругления = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(ДатаОкончания,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.ТочностьРасчетов)).Размер; //О.Т. Аверсон 22.06.2016 № 949
					СтрЗар = ?(СтрокаМес.СуммаДохода = 0, "0", СокрЛП(Строка(Формат(СтрокаМес.СуммаДохода,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					если не КатегорияВывод= "ДОГОВОР" Тогда
						СтрБлн = ?(СтрокаМес.Больничные = 0, "0", СокрЛП(Строка(Формат(СтрокаМес.Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					иначе
						СтрБлн = ?(СтрокаМес.Больничные = 0, " ", СокрЛП(Строка(Формат(СтрокаМес.Больничные,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
					КонецЕсли;
					//О.Т. Аверсон 02.02.2018 № 1535
					СтрВзн1Число = ?(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.28,СтрокаМес.Период) = 0, 0, ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.28,СтрокаМес.Период));//О.Т. Аверсон 17.03.2016 № 949   
					//О.Т. Аверсон 02.02.2018 № 1535
					Если СКорректировкойФСЗН Тогда //О.Т. Аверсон 28.02.2018 № 1448
						СтрВзн = ?(не ЗначениеЗаполнено(СтрокаМес.ПенсионныйФонд), "0", СокрЛП(Строка(Формат(СтрокаМес.ПенсионныйФонд,"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						//О.Т. Аверсон 02.02.2018 № 1535
						СтрВзнЧисло = ?(ЗначениеЗаполнено(СтрокаМес.ПенсионныйФонд),СтрокаМес.ПенсионныйФонд,0);
					иначе
						СтрВзн = ?(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.01,СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.01,СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));
						//О.Т. Аверсон 02.02.2018 № 1535
						СтрВзнЧисло = ?(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.01,СтрокаМес.Период) = 0, 0, ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.01,СтрокаМес.Период));
					КонецЕсли;
					
					СтрВзн1 = ?(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.28,СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.28,СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));//О.Т. Аверсон 17.03.2016 № 949   
					СуммаВсе = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.35,СтрокаМес.Период);
					Если СКорректировкойФСЗН Тогда //О.Т. Аверсон 28.02.2018 № 1448
						Если ОбъединятьОсновные Тогда 
							МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("ФизЛицо,Период",СтрокаМес.ФизЛицо,СтрокаМес.Период));
						иначе
							МассивТЗСотрудники = ТЗСотрудники.НайтиСтроки(Новый Структура("Сотрудник,Период",СтрокаМес.Сотрудник,СтрокаМес.Период));
						КонецЕсли;
						СуммаКоррект = 0;
						Для Каждого стр из МассивТЗСотрудники Цикл 
							СуммаКоррект = СуммаКоррект + ?(ЗначениеЗаполнено(стр.СуммаКорректировки),стр.СуммаКорректировки,0);							
						КонецЦикла;
						
						СтрВзн2 = ?(СуммаВсе-СтрВзнЧисло-СтрВзн1Число+СуммаКоррект=0,"0",СтрЗаменить(СуммаВсе-СтрВзнЧисло-СтрВзн1Число+СуммаКоррект," ",""));//О.Т. Аверсон 02.02.2018 № 1535
					иначе
						
						СтрВзн2 = ?(СуммаВсе-СтрВзнЧисло-СтрВзн1Число=0,"0",СтрЗаменить(СуммаВсе-СтрВзнЧисло-СтрВзн1Число," ",""));//О.Т. Аверсон 02.02.2018 № 1535
					КонецЕсли;
					
					СтрВзн3 = ?(ОбщегоНазначения.ОкруглитьЗначение2016(Число(СтрВзн1)+Число(СтрВзн2),СтрокаМес.Период) = 0, "0", СокрЛП(Строка(Формат(ОбщегоНазначения.ОкруглитьЗначение2016(Число(СтрВзн1)+Число(СтрВзн2),СтрокаМес.Период),"ЧДЦ="+Строка(ЗначениеОкругления)+";ЧГ=0"))));//О.Т. Аверсон 17.03.2016 № 949 
					//Островская Татьяна 31.10.2012 № 15958
					НомерМесяца = Формат(Месяц(СтрокаМес.Период),"ЧГ=0");
					
					//+ СВЭЙ КДЯ 23.09.19 СВФР-004631 ( пункт 46. )
					//изменился формат файла пачки ПУ-3 - незначащие нули не проходят проверку
					//если НомерМесяца = Лев(НомерМесяца,1) Тогда 
					//	НомерМесяца = "0"+НомерМесяца;
					//КонецЕсли;
					//- СВЭЙ КДЯ 23.09.19 СВФР-004631 ( пункт 46. )
					
					//Островская Татьяна 30.11.2012 № 15958
					//Островская Татьяна 30.11.2012 № 15958
					//СтрокиПоРаб = ПТДопСведОстаже.НайтиСтроки(Новый Структура("ФизЛицо",СтрокаМес.ФизЛицо));
					//Для каждого СтрДог из СтрокиПоРаб цикл 
					//	если КатегорияВывод= "ДОГОВОР" Тогда
					//		если Основные Тогда
					//		Иначе 
					//			если СтрБлн = "0" Тогда 
					//				СтрБлн = " ";
					//				Прервать;
					//			КонецЕсли;
					//		КонецЕсли;
					//	КонецЕсли;
					//	
					//КонецЦикла;
					
					
					//Островская Татьяна 30.11.2012 № 15958
					
					//О.Т. Аверсон 29.08.2018 № 2363
					
					МесяцЧисло = Строка(Месяц(СтрокаМес.Период));    					
					ЗапросУв.Текст = 
					"ВЫБРАТЬ
					|	РаботникиОрганизацийСрезПоследних.Период
					|ИЗ
					|	ПакетУВ"+МесяцЧисло+" КАК РаботникиОрганизацийСрезПоследних"; 					
					Если ОбъединятьОсновные Тогда 
						ЗапросУв.Текст = ЗапросУв.Текст +"
						|ГДЕ
						|	РаботникиОрганизацийСрезПоследних.ФизЛицо = &ФизЛицо";
						ЗапросУв.УстановитьПараметр("ФизЛицо", СтрокаМес.ФизЛицо);
					иначе
						ЗапросУв.Текст = ЗапросУв.Текст +"
						|ГДЕ
						|	РаботникиОрганизацийСрезПоследних.Сотрудник = &Сотрудник";
						ЗапросУв.УстановитьПараметр("Сотрудник", СтрокаМес.Сотрудник);
					КонецЕсли; 				
					РезультатЗапросаУв = ЗапросУв.Выполнить().Выбрать();
					
					ДатаУвольнения = Дата(1,1,1);
					Пока РезультатЗапросаУв.Следующий() Цикл
						ДатаУвольнения = РезультатЗапросаУв.Период;
					КонецЦикла;
					
					Если ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*1/100,СтрокаМес.Период)<> СтрВзнЧисло и ЗначениеЗаполнено(ДатаУвольнения) Тогда
						ДатаУвольненияФормат = Формат(ДатаУвольнения,"ДФ=""дд/ММ/гггг""");
						СтрокаЗар = ВРЕГ(ТипЗаписиНач+НомерМесяца+"="+СтрЗар+"="+СтрБлн+"="+СтрВзн+"="+СтрВзн1+"="+СтрВзн2+"="+СтрВзн+"="+СтрВзн3+"=0=28=6="+ДатаУвольненияФормат+"=");
					иначе
						СтрокаЗар = ВРЕГ(ТипЗаписиНач+НомерМесяца+"="+СтрЗар+"="+СтрБлн+"="+СтрВзн+"="+СтрВзн1+"="+СтрВзн2+"="+СтрВзн+"="+СтрВзн3+"=1=28=6= "+"="); //Островская Татьяна 17.01.2013 № 16153
					КонецЕсли; 
					
					//О.Т. Аверсон 01.04.2019 № 4182
					Если не ДатаНачала < Дата(2019,01,01) Тогда
						Если ЗначениеЗаполнено(СтрокаМес.ПричиныМинимальнойЗП) Тогда
							СтрокаЗар = СтрокаЗар + СтрокаМес.ПричиныМинимальнойЗП.Код+"=";
						иначе
							СтрокаЗар = СтрокаЗар + " =";  						
						КонецЕсли;
					КонецЕсли;
					//О.Т. Аверсон 01.04.2019 № 4182
					
					//О.Т. Аверсон 29.08.2018 № 2363
					ТекстФайла.ДобавитьСтроку(СтрокаЗар);
					ТекСтрока = ТекСтрока+1;
					//толик формирование контрольного файла
					Дбф.Добавить();
					Дбф.УстановитьЗначениеПоля("FIO", СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо)));
					Дбф.УстановитьЗначениеПоля("Dato", СтрокаМес.Период);
					Дбф.УстановитьЗначениеПоля("Sm", ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода, СтрокаМес.Период));//О.Т. Аверсон 17.03.2016 № 949
					Дбф.УстановитьЗначениеПоля("Bl", ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.Больничные,СтрокаМес.Период)); //О.Т. Аверсон 17.03.2016 № 949
					Дбф.УстановитьЗначениеПоля("Vz", ОбщегоНазначения.ОкруглитьЗначение2016((СтрокаМес.ФСЗН + СтрокаМес.ПенсионныйФонд), СтрокаМес.Период));//О.Т. Аверсон 14.03.2016 № 949
					Дбф.Записать();
					
					если Сч+1 <= СтрокиПоРаботнику1.Количество()-1 Тогда 
						РаботДоходСлед = РаботДоходСлед + Число(СтрЗар);
						РаботБольнСлед = РаботБольнСлед + Число(СтрБлн);
						//Островская Татьяна 17.01.2014 № 17051
						РаботВзносСлед = РаботВзносСлед + Число(СтрВзн);
						РаботВзносСлед1 = РаботВзносСлед1 + Число(СтрВзн1);
						//О.Т. Аверсон 29.01.2018 № 1511
						//О.Т. Аверсон 29.08.2018 № 2363
						Если ОбъединятьОсновные Тогда 
							ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
						иначе
							Если ЗначениеЗаполнено(ВыборкаПоРаботникиОрганизации.Сотрудник.ВидНалогообложенияОсновной) Тогда 
								ОсновнойВидНалогообл = ВыборкаПоРаботникиОрганизации.Сотрудник.ВидНалогообложенияОсновной;
							иначе
								ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
							КонецЕсли;
						КонецЕсли;
						//О.Т. Аверсон 29.08.2018 № 2363
						СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокиПоРаботнику1[Сч+1].Период),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
						РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(СтрокиПоРаботнику1[Сч+1].Период) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
						БазаОграниченияФСЗН = СтруктураФСЗН.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
						
						Если СтрокиПоРаботнику1[Сч+1].СуммаДохода > БазаОграниченияФСЗН Тогда 
							СтрокиПоРаботнику1[Сч+1].СуммаДохода = БазаОграниченияФСЗН;
						КонецЕсли;
						//О.Т. Аверсон 29.01.2018 № 1511
						
						СуммаВсе = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокиПоРаботнику1[Сч+1].СуммаДохода*0.35,СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949					
						РаботВзносСлед2 = РаботВзносСлед2 + Число(СтрВзн2);
						
						РаботВзносСлед3 = РаботВзносСлед3 + Число(СтрВзн3);
						//Островская Татьяна 17.01.2014 № 17051
						РаботДоход = РаботДоход + Число(СтрЗар);
						РаботБольн = РаботБольн + Число(СтрБлн);
						РаботВзнос = РаботВзнос + Число(СтрВзн); //Островская Татьяна 17.01.2014 № 17051
						РаботВзнос1 = РаботВзнос1 + Число(СтрВзн1); //Островская Татьяна 17.01.2014 № 17051
						СуммаВсе = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.35,СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
						РаботВзнос2 = РаботВзнос2 + Число(СтрВзн2); //Островская Татьяна 17.01.2014 № 17051
						РаботВзнос3 = РаботВзнос3 + Число(СтрВзн3); //Островская Татьяна 17.01.2014 № 17051
						//если не КатегорияВывод= "ДОГОВОР" Тогда
						//	ИтогДохода = ИтогДохода + РаботДоход;
						//	ИтогБольн = ИтогБольн + РаботБольн;
						//	ИтогВзнос = ИтогВзнос + РаботВзнос;
						//иначе
						//	ИтогДохода = ИтогДохода + РаботДоходСлед;
						//	ИтогБольн = ИтогБольн + РаботБольнСлед;
						//	ИтогВзнос = ИтогВзнос + РаботВзносСлед;
						//КонецЕсли;
					иначе
						если КатегорияВывод= "ДОГОВОР" Тогда
							РаботДоход = РаботДоход + Число(СтрЗар);
							РаботБольн = РаботБольн + Число(СтрБлн);
							//Островская Татьяна 17.01.2014 № 17051
							РаботВзнос = РаботВзнос + Число(СтрВзн);
							РаботВзнос1 = РаботВзнос1 + Число(СтрВзн1);
							
							//О.Т. Аверсон 29.08.2018 № 2363
							Если ОбъединятьОсновные Тогда 
								ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
							иначе
								Если ЗначениеЗаполнено(СтрокиПоРаботнику1[0].Сотрудник.ВидНалогообложенияОсновной) Тогда 
									ОсновнойВидНалогообл = СтрокиПоРаботнику1[0].Сотрудник.ВидНалогообложенияОсновной;
								иначе
									ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
								КонецЕсли;
							КонецЕсли;
							//О.Т. Аверсон 29.08.2018 № 2363
							//О.Т. Аверсон 29.01.2018 № 1511
							СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрокиПоРаботнику1[0].Период),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
							РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(СтрокиПоРаботнику1[0].Период) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
							БазаОграниченияФСЗН = СтруктураФСЗН.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
							
							Если СтрокиПоРаботнику1[0].СуммаДохода > БазаОграниченияФСЗН Тогда 
								СтрокиПоРаботнику1[0].СуммаДохода = БазаОграниченияФСЗН;
							КонецЕсли;
							//О.Т. Аверсон 29.01.2018 № 1511
							
							СуммаВсе = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокиПоРаботнику1[0].СуммаДохода*0.35,СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
							
							РаботВзнос2 = РаботВзнос2 + Число(СтрВзн2);
							РаботВзнос3 = РаботВзнос3 + Число(СтрВзн3);
							//Островская Татьяна 17.01.2014 № 17051
							//ИтогДохода = ИтогДохода + РаботДоход;
							//ИтогБольн = ИтогБольн + РаботБольн;
							//ИтогВзнос = ИтогВзнос + РаботВзнос;
							
						иначе
							РаботДоход = РаботДоход + Число(СтрЗар);
							РаботБольн = РаботБольн + Число(СтрБлн);
							РаботВзнос = РаботВзнос + Число(СтрВзн);
							//Островская Татьяна 17.01.2014 № 17051
							РаботВзнос1 = РаботВзнос1 + Число(СтрВзн1);
							СуммаВсе = ОбщегоНазначения.ОкруглитьЗначение2016(СтрокаМес.СуммаДохода*0.35,СтрокаМес.Период);//О.Т. Аверсон 17.03.2016 № 949
							РаботВзнос2 = РаботВзнос2 + Число(СтрВзн2);
							РаботВзнос3 = РаботВзнос3 + Число(СтрВзн3);
							//Островская Татьяна 17.01.2014 № 17051
							//ИтогДохода = ИтогДохода + РаботДоход;
							//ИтогБольн = ИтогБольн + РаботБольн;
							//ИтогВзнос = ИтогВзнос + РаботВзнос;
							
						КонецЕсли;
					КонецЕсли;
					КоличествоМес = КоличествоМес+1;
					//КонецЕсли;
					
					
					если КатегорияВывод= "ДОГОВОР" Тогда
						ТипЗаписиНач = "СТАЖ=";
						Структура = Новый Структура;
						Если ОбъединятьОсновные Тогда 
							Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
						иначе
							Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
						КонецЕсли;
						если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							Структура.Вставить("ВидДоговора",null);
						Иначе 
							Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
						КонецЕсли;
						
						СтрокиПоРаботнику = ПТДопСведОстаже.НайтиСтроки(Структура); 
						КоличествоЗаписейОСтаже = 0;
						ПредыдущийВидДейтельности = "";
						ПредыдущееОкончаниеРабот = "";
						ДатаНачалаРабот = "";
						Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
							если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.НачалоРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ОкончаниеРабот)) Тогда 
								Продолжить;
							КонецЕсли;
							
							Если ЗначениеЗаполнено(СтрокаСтаж.ВидДейтельности) Тогда 
								Если СтрокаСтаж.ВидДейтельности <> "СП2     " Тогда 
									ДатаФормирования = СтрокаСтаж.НачалоРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
									ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
									МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
									ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
									ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
									
									
									Если НачалоМесяца(СтрокаСтаж.НачалоРабот) <> НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) и Год(СтрокаСтаж.НачалоРабот) < Год(СтрокаСтаж.ОкончаниеРабот) Тогда
										ДатаФормирования = КонецМесяца(СтрокаСтаж.НачалоРабот);
									иначе
										ДатаФормирования = СтрокаСтаж.ОкончаниеРабот;
									КонецЕсли;
									ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
									МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
									ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
									ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
									
									// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
									////О.Т. Аверсон 14.05.2019 № 4328
									//ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("ФизЛицо,ДатаНачалаРабот,ДатаОкончанияРабот,ВидДеятельности",ВыборкаПоРаботникиОрганизации.ФизЛицо,ДатаНачалаДог,НачалоДня(ДатаФормирования),НеоплДог));
									//
									//ЗначВидДеят = Неопределено;
									//Если ЗначСведенияОСтаже.Количество()>0 Тогда 
									//	ЗначВидДеят = ЗначСведенияОСтаже[0].ВидДеятельности;																
									//КонецЕсли;
									////О.Т. Аверсон 14.05.2019 № 4328
									//СтрокаЗар = ВРЕГ(ТипЗаписиНач+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="
									//		+СокрЛП(?(ЗначениеЗаполнено(ЗначВидДеят),ЗначВидДеят,СтрокаСтаж.ВидДейтельности))+"= = =");
									// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
									
									// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
									ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже );
									СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот + "= =" 
									+ СокрЛП( ?( ЕстьНеоплДог, "НЕОПЛДОГ", СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
									// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
									
									ТекстФайла.ДобавитьСтроку( СтрокаЗар );
									ТекСтрока = ТекСтрока + 1;
									КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
									Если Категория = "03" тогда
										НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
										ДатаФормирования = СтрокаСтаж.ДатаДокумента;
										ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
										МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
										ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
										ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
										СтрокаФайла = СтрокаФайла+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"=";
									КонецЕсли;
									
									Если Год(СтрокаСтаж.НачалоРабот) < Год(СтрокаСтаж.ОкончаниеРабот)  Тогда
										ПериодНач = НачалоМесяца(ДобавитьМесяц(СтрокаСтаж.НачалоРабот,1));
										Пока ПериодНач <= НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) Цикл 
											ДатаФормирования = ПериодНач; //О.Т. Аверсон 22.04.2019 № 4269 //СтрЗаменить(СтрокаСтаж.НачалоРабот,"2011","2012");
											ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
											МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
											ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
											ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
											
											
											Если НачалоМесяца(ПериодНач) = НачалоМесяца(СтрокаСтаж.ОкончаниеРабот) Тогда
												ДатаФормирования = СтрокаСтаж.ОкончаниеРабот;
											иначе
												ДатаФормирования = КонецМесяца(ПериодНач);
											КонецЕсли;
											ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
											МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
											ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
											ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
											
											// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
											////О.Т. Аверсон 14.05.2019 № 4328
											//ЗначСведенияОСтаже = СведенияОСтаже.НайтиСтроки(Новый Структура("ФизЛицо,ДатаНачалаРабот,ДатаОкончанияРабот,ВидДеятельности",ВыборкаПоРаботникиОрганизации.ФизЛицо,ДатаНачалаДог,НачалоДня(ДатаФормирования),НеоплДог));
											//
											//ЗначВидДеят = Неопределено;
											//Если ЗначСведенияОСтаже.Количество()>0 Тогда 
											//	ЗначВидДеят = ЗначСведенияОСтаже[0].ВидДеятельности;																
											//КонецЕсли;
											////О.Т. Аверсон 14.05.2019 № 4328
											//СтрокаЗар = ВРЕГ(ТипЗаписиНач+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="
											//		+СокрЛП(?(ЗначениеЗаполнено(ЗначВидДеят),ЗначВидДеят,СтрокаСтаж.ВидДейтельности))+"= = =");
											// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
											
											// + СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
											ЕстьНеоплДог = ЕстьНеоплДог( ВыборкаПоРаботникиОрганизации, СтрокаМес, ТЗ_СведенияОСтаже );
											СтрокаЗар = ВРЕГ( ТипЗаписиНач + ДатаНачалаРабот + "=" + ДатаОкончанияРабот + "= =" 
											+ СокрЛП( ?( ЕстьНеоплДог, "НЕОПЛДОГ", СтрокаСтаж.ВидДейтельности ) ) + "= = =" );
											// - СВЭЙ КДЯ 17.09.19 СВФР-004631 ( пункт 28. )
											
											ТекстФайла.ДобавитьСтроку( СтрокаЗар );
											ТекСтрока = ТекСтрока + 1;
											КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже + 1;
											Если Категория = "03" тогда
												НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
												ДатаФормирования = СтрокаСтаж.ДатаДокумента;
												ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
												МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
												ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
												ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
												СтрокаФайла = СтрокаФайла+СтрЗаменить(НомерДоговора," ","")+"="+ДатаДокумента+"=";
											КонецЕсли;
											ПериодНач = ДобавитьМесяц(ПериодНач,1);
										КонецЦикла;
									КонецЕсли;
									
									ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
									ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
								КонецЕсли;
							КонецЕсли;
						КонецЦикла;
						
						
						
					КонецЕсли;
					
					
					
					
					//Островская Татьяна 25.10.2012 № 15958
					//Островская Татьяна 17.01.2013 № 16153
					если не Сч > Колич-1 Тогда 
						если не КатегорияВывод= "ДОГОВОР" Тогда
							
						иначе
							////Для пенсии
							если НазначениеПенсии Тогда 
								ТипЗаписиНач2 = "СТАЖ=";
								Структура = Новый Структура;
								Если ОбъединятьОсновные Тогда
									Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
								иначе
									Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
								КонецЕсли;
								если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
									Структура.Вставить("ВидДоговора",null);
								Иначе 
									Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
								КонецЕсли;
								ПериодПенсии = СтрокиПоРаботнику1[СтрокиПоРаботнику1.Количество()-1].Период;
								ДеньШапки        = ?(День(НачалоМесяца(ПериодПенсии))<10,"0","")+День(НачалоМесяца(ПериодПенсии));
								МесяцШапки       = ?(Месяц(НачалоМесяца(ПериодПенсии))<10,"0","")+Месяц(НачалоМесяца(ПериодПенсии));
								ГодШапки 		 = Строка(СокрЛП(Формат(Год(НачалоМесяца(ПериодПенсии)), "ЧГ=0")));
								ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
								ДеньШапки        = ?(День(КонецМесяца(ПериодПенсии))<10,"0","")+День(КонецМесяца(ПериодПенсии));
								МесяцШапки       = ?(Месяц(КонецМесяца(ПериодПенсии))<10,"0","")+Месяц(КонецМесяца(ПериодПенсии));
								ГодШапки 		 = Строка(СокрЛП(Формат(Год(КонецМесяца(ПериодПенсии)), "ЧГ=0")));
								ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
								
								
								СтрокаЗар = ВРЕГ(ТипЗаписиНач2+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="+"ПЕНСИЯ= = =");
								ТекстФайла.ДобавитьСтроку(СтрокаЗар);
								ТекСтрока = ТекСтрока+1;
								ПенсияВыгружена = Истина;
							КонецЕсли;
							
							СтрокаЗар = СтрокаЗар + ">";
							ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар);
							
							//+ СВЭЙ КДЯ 18.10.19 СВФР-004943
							ОтборСтрокДоговоров = Новый Структура;
							ОтборСтрокДоговоров.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
							ОтборСтрокДоговоров.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
							ОтборСтрокДоговоров.Вставить( "ВидДеятельности", ?( ЕстьНеоплДог, "НЕОПЛДОГ", "ДОГОВОР" ) );
							
							СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( ОтборСтрокДоговоров );
							//- СВЭЙ КДЯ 18.10.19 СВФР-004943
							
							
							//ПСА 04.07.2019 СВФР-004497++
							ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику
							//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
							, ЗначениеКв
							//- СВЭЙ КДЯ 25.07.19 СВФР-004561
							);
							//+++ПСА 04.07.2019 СВФР-004497							
							если не Сч > Колич-1 Тогда
								СтрокаФайла1 = ВРЕГ(СтрокаФайла+ ?(РаботДоходСлед = 0, ?(ЕстьНеоплДог,"0"," "), СокрЛП(Строка(Формат(РаботДоходСлед,"ЧГ=0"))))+"="+
								?(РаботБольнСлед = 0, " ", СокрЛП(Строка(Формат(РаботБольнСлед,"ЧГ=0"))))+"="+
								?(РаботВзносСлед = 0, " ", СокрЛП(Строка(Формат(РаботВзносСлед,"ЧГ=0"))))+"="+
								?(РаботВзносСлед1 = 0, " ", СокрЛП(Строка(Формат(РаботВзносСлед1,"ЧГ=0"))))+"="+
								?(РаботВзносСлед2 = 0, " ", СокрЛП(Строка(Формат(РаботВзносСлед2,"ЧГ=0"))))+"="+
								?(РаботВзносСлед = 0, " ", СокрЛП(Строка(Формат(РаботВзносСлед,"ЧГ=0"))))+"="+
								?(РаботВзносСлед3 = 0, " ", СокрЛП(Строка(Формат(РаботВзносСлед3,"ЧГ=0"))))+"="+
								
								//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
								//?( ЕстьНеоплДог и КоличествоМес=0, "0", Формат(КоличествоМес,"ЧГ=0")) +"=" 
								//+?(КоличествоЗаписейОСтаже = 0, "0", СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0"))))
								//- СВЭЙ КДЯ 25.07.19 СВФР-004561
								//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
								?( ЕстьНеоплДог ИЛИ КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
								+ ?( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0) = 0, "0", Формат( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0 ), "ЧГ=0" ) )
								//- СВЭЙ КДЯ 25.07.19 СВФР-004561
								
								+ "=" + ДатаЗаполнения + "=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) 
								+ "=" + Формат( ГОД( ДатаНачала ), "ЧГ=0" ) + "=" + СтрЗаменить( ТелефонОрганизации, " ", "" ) ) + "=";
								//Островская Татьяна 20.01.2014 № 17051
							КонецЕсли;	
						КонецЕсли;
					иначе
						если  КатегорияВывод= "ДОГОВОР" Тогда
							СтрокаЗар = СтрокаЗар + ">";
							ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар);
						КонецЕсли;
					КонецЕсли;
					//Островская Татьяна 17.01.2013 № 16153
					//Островская Татьяна 25.10.2012 № 15958	
					
					
					
					СтрМес = СтрМес+1;
				КонецЦикла;
				////Для пенсии
				если НазначениеПенсии Тогда 
					если не ПенсияВыгружена Тогда 
						ТипЗаписиНач2 = "СТАЖ=";
						Структура = Новый Структура;
						Если ОбъединятьОсновные Тогда
							Структура.Вставить("ФизЛицо",ВыборкаПоРаботникиОрганизации.ФизЛицо);
						иначе
							Структура.Вставить("Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник);
						КонецЕсли;
						
						если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
							Структура.Вставить("ВидДоговора",null);
						Иначе 
							Структура.Вставить("ВидДоговора",ВыборкаПоРаботникиОрганизации.ВидДоговора);
						КонецЕсли;
						ПериодПенсии = СтрокиПоРаботнику1[СтрокиПоРаботнику1.Количество()-1].Период;
						ДеньШапки        = ?(День(НачалоМесяца(ПериодПенсии))<10,"0","")+День(НачалоМесяца(ПериодПенсии));
						МесяцШапки       = ?(Месяц(НачалоМесяца(ПериодПенсии))<10,"0","")+Месяц(НачалоМесяца(ПериодПенсии));
						ГодШапки 		 = Строка(СокрЛП(Формат(Год(НачалоМесяца(ПериодПенсии)), "ЧГ=0")));
						ДатаНачалаРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						ДеньШапки        = ?(День(КонецМесяца(ПериодПенсии))<10,"0","")+День(КонецМесяца(ПериодПенсии));
						МесяцШапки       = ?(Месяц(КонецМесяца(ПериодПенсии))<10,"0","")+Месяц(КонецМесяца(ПериодПенсии));
						ГодШапки 		 = Строка(СокрЛП(Формат(Год(КонецМесяца(ПериодПенсии)), "ЧГ=0")));
						ДатаОкончанияРабот   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
						
						СтрокаЗар = ВРЕГ(ТипЗаписиНач2+ДатаНачалаРабот+"="+ДатаОкончанияРабот+"= ="+"ПЕНСИЯ= = =");
						ТекстФайла.ДобавитьСтроку(СтрокаЗар);
						ТекСтрока = ТекСтрока+1;
						
					КонецЕсли;
					ПенсияВыгружена = Ложь;  //Островская Татьяна 20.01.2014 № 17051
				КонецЕсли;
				
				
				ТипЗаписиНач = "СТАЖ=";
				ОтборСведенийОСтаже = Новый Структура;
				Если ОбъединятьОсновные Тогда
					ОтборСведенийОСтаже.Вставить( "ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо );
				иначе
					ОтборСведенийОСтаже.Вставить( "Сотрудник",ВыборкаПоРаботникиОрганизации.Сотрудник );
				КонецЕсли;
				
				//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				//если ВыборкаПоРаботникиОрганизации.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() Тогда 
				//	ОтборСведенийОСтаже.Вставить( "ВидДоговора", Перечисления.ВидыДоговоровСФизЛицами.ПустаяСсылка() );
				//Иначе 
				//	ОтборСведенийОСтаже.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
				//КонецЕсли;
				//
				//СтрокиПоРаботнику = СведенияОСтаже.НайтиСтроки( ОтборСведенийОСтаже );
				//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				
				//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				ОтборСведенийОСтаже.Вставить( "ВидДоговора", ВыборкаПоРаботникиОрганизации.ВидДоговора );
				СтрокиПоРаботнику = ТЗ_СведенияОСтаже.НайтиСтроки( ОтборСведенийОСтаже );
				//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
				
				КоличествоЗаписейОСтаже = 0;
				ПредыдущийВидДейтельности = "";
				ПредыдущееОкончаниеРабот = "";
				ДатаНачалаРабот = "";
				Для каждого СтрокаСтаж из СтрокиПоРаботнику цикл
					//если не (СтрокаМес.Период >= НачалоМесяца(СтрокаСтаж.ДатаНачалаРабот) и  СтрокаМес.Период <= КонецМесяца(СтрокаСтаж.ДатаОкончанияРабот)) Тогда 
					//	Продолжить;
					//КонецЕсли;
					
					
					ДатаФормированияДети = СтрокаСтаж.ДатаНачалаРабот; //О.Т. Аверсон 22.04.2019 № 4269 убрать замену 2011-2012
					ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
					МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
					ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
					ДатаНачалаРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
					
					
					ДатаФормированияДети = СтрокаСтаж.ДатаОкончанияРабот;
					ДеньШапкиДети        = ?(День(ДатаФормированияДети)<10,"0","")+День(ДатаФормированияДети);
					МесяцШапкиДети       = ?(Месяц(ДатаФормированияДети)<10,"0","")+Месяц(ДатаФормированияДети);
					ГодШапкиДети 		 = Строка(СокрЛП(Формат(Год(ДатаФормированияДети), "ЧГ=0")));
					ДатаОкончанияРаботДети   = ДеньШапкиДети+"/"+МесяцШапкиДети+"/"+ГодШапкиДети;
					
					СтрокаЗар = ВРЕГ(ТипЗаписиНач+ДатаНачалаРаботДети+"="+ДатаОкончанияРаботДети+"= ="+СокрЛП(СтрокаСтаж.ВидДеятельности)+"= = =");
					ТекстФайла.ДобавитьСтроку(СтрокаЗар);
					ТекСтрока = ТекСтрока+1;
					//ТекстФайла.ДобавитьСтроку(СтрокаЗар);
					//ТекСтрока = ТекСтрока+1;
					//КоличествоЗаписейОСтаже = КоличествоЗаписейОСтаже+1;
					//Если Категория = "03" тогда
					//	НомерДоговора = СокрЛП(СтрокаСтаж.НомерДокумента);
					//	ДатаФормирования = СтрокаСтаж.ДатаДокумента;
					//	ДеньШапки        = ?(День(ДатаФормирования)<10,"0","")+День(ДатаФормирования);
					//	МесяцШапки       = ?(Месяц(ДатаФормирования)<10,"0","")+Месяц(ДатаФормирования);
					//	ГодШапки 		 = Строка(СокрЛП(Формат(Год(ДатаФормирования), "ЧГ=0")));
					//	ДатаДокумента   = ДеньШапки+"/"+МесяцШапки+"/"+ГодШапки;
					//	СтрокаФайла = СтрокаФайла+Число(НомерДоговора)+"="+ДатаДокумента+"=";
					//КонецЕсли;
					//ПредыдущийВидДейтельности = СтрокаСтаж.ВидДейтельности;
					//ПредыдущееОкончаниеРабот = СтрокаСтаж.ОкончаниеРабот;
				КонецЦикла;
				
				//ПСА 04.07.2019 СВФР-004497++
				ЗначениеКв = ПолучитьЗначениеКВ( СтрокиПоРаботнику
				//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
				, ЗначениеКв
				//- СВЭЙ КДЯ 25.07.19 СВФР-004561
				);
				//+++ПСА 04.07.2019 СВФР-004497       				
				
				//если не СтрМес>1 Тогда 
				если не КатегорияВывод= "ДОГОВОР" Тогда
					//Островская Татьяна 20.01.2014 № 17051
					СтрокаФайла = ВРЕГ(СтрокаФайла+ ?(РаботДоход = 0, "0", СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
					?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос1 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос1,"ЧГ=0"))))+"="+
					?(РаботВзнос2 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос2,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос3 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос3,"ЧГ=0"))))+"="+
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//Формат(КоличествоМес,"ЧГ=0")+"="+?(НазначениеПенсии,"1","0")
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					?( КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
					+ ?( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0) = 0, "0", Формат( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0 ), "ЧГ=0" ) )
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					+ "=" + ДатаЗаполнения +"=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) + "=" 
					+ Формат( ГОД( ДатаНачала ), "ЧГ=0" ) + "=" + СтрЗаменить( ТелефонОрганизации, " ", "" ) ) + "=";
				иначе
					
					//если не СтрМес>1 Тогда
					//Островская Татьяна 20.01.2014 № 17051
					СтрокаФайла = ВРЕГ(СтрокаФайла+ ?(РаботДоход = 0, ?(ЕстьНеоплДог,"0"," "), СокрЛП(Строка(Формат(РаботДоход,"ЧГ=0"))))+"="+
					?(РаботБольн = 0, "0", СокрЛП(Строка(Формат(РаботБольн,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос1 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос1,"ЧГ=0"))))+"="+
					?(РаботВзнос2 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос2,"ЧГ=0"))))+"="+
					?(РаботВзнос = 0, "0", СокрЛП(Строка(Формат(РаботВзнос,"ЧГ=0"))))+"="+
					?(РаботВзнос3 = 0, "0", СокрЛП(Строка(Формат(РаботВзнос3,"ЧГ=0"))))+"="+
					
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					//?( ЕстьНеоплДог и КоличествоМес = 0, "0", Формат(КоличествоМес,"ЧГ=0"))+ "=" + 
					//?( КоличествоЗаписейОСтаже=0, "0", СокрЛП(Строка(Формат(КоличествоЗаписейОСтаже+?(НазначениеПенсии,1,0),"ЧГ=0"))))
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
					?( ЕстьНеоплДог ИЛИ КоличествоМес = 0, "0", Формат( КоличествоМес, "ЧГ=0" ) ) + "=" 
					+ ?( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0) = 0, "0", Формат( КоличествоЗаписейОСтаже + ?( НазначениеПенсии, 1, 0 ), "ЧГ=0" ) )
					//- СВЭЙ КДЯ 25.07.19 СВФР-004561
					
					+ "=" + ДатаЗаполнения + "=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) + "=" 
					+ Формат( ГОД( ДатаНачала ),"ЧГ=0" ) + "=" + СтрЗаменить( ТелефонОрганизации, " ", "" ) ) +"=";
					//КонецЕсли;	
				КонецЕсли;
				//КонецЕсли;
				ТекстФайла.ЗаменитьСтроку(СтрокаЗамены, СтрокаФайла);
				если не КатегорияВывод= "ДОГОВОР" Тогда
					СтрокаЗар = СтрокаЗар + ">";
					ТекстФайла.ЗаменитьСтроку(ТекСтрока, СтрокаЗар);
				КонецЕсли;
				
			КонецЕсли;
			если Сч+1 <= СтрокиПоРаботнику1.Количество()-1 Тогда 
				если не КатегорияВывод= "ДОГОВОР" Тогда
					ИтогДохода = ИтогДохода + РаботДоход;
					ИтогБольн = ИтогБольн + РаботБольн;
					ИтогВзнос = ИтогВзнос + РаботВзнос;
					ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
					ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
					ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
				иначе
					ИтогДохода = ИтогДохода + РаботДоход;
					ИтогБольн = ИтогБольн + РаботБольн;          
					ИтогВзнос = ИтогВзнос + РаботВзнос;
					ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
					ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
					ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
				КонецЕсли;
			иначе
				если КатегорияВывод= "ДОГОВОР" Тогда
					ИтогДохода = ИтогДохода + РаботДоход;
					ИтогБольн = ИтогБольн + РаботБольн;
					ИтогВзнос = ИтогВзнос + РаботВзнос;
					ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
					ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
					ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
					
				иначе
					ИтогДохода = ИтогДохода + РаботДоход;
					ИтогБольн = ИтогБольн + РаботБольн;
					ИтогВзнос = ИтогВзнос + РаботВзнос;
					ИтогВзнос1 = ИтогВзнос1 + РаботВзнос1;
					ИтогВзнос2 = ИтогВзнос2 + РаботВзнос2;
					ИтогВзнос3 = ИтогВзнос3 + РаботВзнос3;
					
				КонецЕсли;                          
			КонецЕсли;
			
			//Аверсон ЕАЕ 09.12.2021 СВФР-008384
			//выведем больничные после увольнения
			СтруктураОтбора = Новый Структура;
			СтруктураОтбора.Вставить("ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо);
			Если НЕ ОбъединятьОсновные Тогда 
				СтруктураОтбора.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
			КонецЕсли;
			СтруктураОтбора.Вставить("ЭтоБольничныйПослеУвольнения", Истина);
			СтрокиВремНеТрудПоСотруднику = ТЗБольничные.НайтиСтроки(СтруктураОтбора);
			
			СтруктураОтбораСтаж = Новый Структура;
			СтруктураОтбораСтаж.Вставить("ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо);
			Если НЕ ОбъединятьОсновные Тогда 
				СтруктураОтбораСтаж.Вставить( "Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник );
			КонецЕсли;
			СтруктураОтбораСтаж.Вставить("ВидДеятельности", ВремНеТрудДляПУ3);
			СтрокиВремНеТрудПоСотрудникуСтаж = СведенияОСтаже.НайтиСтроки(СтруктураОтбораСтаж);
			
			Если СтрокиВремНеТрудПоСотруднику.Количество() > 0 Тогда
				
				КоличествоДокументов = КоличествоДокументов + 1;
				
				СтрокаПУ3 = ТипЗаписи + ?(ЗначениеЗаполнено(СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер)), СокрЛП(ВыборкаПоРаботникиОрганизации.ЛичныйНомер), СокрЛП(Строка(ВыборкаПоРаботникиОрганизации.ФизЛицо.Код))+"N")+"="+Фамилия+"="+Имя+"="+Отчество+"="+"06"+"=";
				СтрокаПУ3 = СтрокаПУ3 + " = =";
				
				ИтогоБольничныеПослеУвольнения = 0;
				
				МассивМесяцы = Новый Массив;
				Для Каждого СтрВремНетруд Из СтрокиВремНеТрудПоСотруднику Цикл
					ИтогоБольничныеПослеУвольнения = ИтогоБольничныеПослеУвольнения + СтрВремНетруд.Результат;
					
					Если МассивМесяцы.Найти(СтрВремНетруд.НачалоМесяца) = Неопределено Тогда
						МассивМесяцы.Добавить(СтрВремНетруд.НачалоМесяца);	
					КонецЕсли;
				КонецЦикла;
				
				КолМес = МассивМесяцы.Количество();
				КолЗаписейОСтаже = СтрокиВремНеТрудПоСотрудникуСтаж.Количество();
				
				//ПУ-3
				СтрокаПУ3 = ВРЕГ(СтрокаПУ3 + "0" + "=" +
				?(ИтогоБольничныеПослеУвольнения = 0, "0", СокрЛП(Строка(Формат(ИтогоБольничныеПослеУвольнения,"ЧГ=0")))) + "=" +
				"0" + "=" +
				"0" + "=" +
				"0" + "=" +
				"0" + "=" +
				"0" + "=" +
				?( КолМес = 0, "0", Формат( КолМес, "ЧГ=0" ) ) + "=" 
				+ ?( КолЗаписейОСтаже = 0, "0", Формат( КолЗаписейОСтаже, "ЧГ=0" ) )
				+ "=" + ДатаЗаполнения + "=" + ?( ЗначениеКв = " ", ЗначениеКв, СокрЛП( ЗначениеКв ) ) + "=" 
				+ Формат( ГОД( ДатаНачала ),"ЧГ=0") + "=" + СтрЗаменить( ТелефонОрганизации, " ", "" ) ) + "=";				
				ТекстФайла.ДобавитьСтроку(СтрокаПУ3);
				ТекСтрока = ТекСтрока + 1;
				
				//НЧСЛ
				ТЗБолничныеПослеУвольнения = ТЗБольничные.Скопировать();
				СтруктураПоиска = Новый Структура;
				СтруктураПоиска.Вставить("ЭтоБольничныйПослеУвольнения", Истина);
				
				Если ОбъединятьОсновные Тогда
					ТЗБолничныеПослеУвольнения.Свернуть("ФизЛицо,НачалоМесяца,ЭтоБольничныйПослеУвольнения", "Результат");
					СтруктураПоиска.Вставить("ФизЛицо", ВыборкаПоРаботникиОрганизации.ФизЛицо);
				Иначе
					ТЗБолничныеПослеУвольнения.Свернуть("ФизЛицо,Сотрудник,НачалоМесяца,ЭтоБольничныйПослеУвольнения", "Результат");
					СтруктураПоиска.Вставить("Сотрудник", ВыборкаПоРаботникиОрганизации.Сотрудник);
				КонецЕсли;
				МассивНЧСЛ = ТЗБолничныеПослеУвольнения.НайтиСтроки(СтруктураПоиска);
				
				Для Каждого СтрНЧСЛ Из МассивНЧСЛ Цикл
					
					Проверка_ВидНалогообложения = ОсновнойВидНалогообл;
					Проверка_ИнаяСтавка = РегистрыСведений.ГражданствоФизЛиц.ПолучитьПоследнее(КонецМесяца(СтрНЧСЛ.НачалоМесяца),Новый Структура("ФизЛицо",?(ОбъединятьОсновные,СтрНЧСЛ.ФизЛицо,СтрНЧСЛ.Сотрудник.ФизЛицо))).ИнаяСтавка;
					Проверка_Инвалид = РегистрыСведений.СведенияОбИнвалидностиФизлиц.ПолучитьПоследнее(КонецМесяца(СтрНЧСЛ.НачалоМесяца),Новый Структура("ФизЛицо",?(ОбъединятьОсновные,СтрНЧСЛ.ФизЛицо,СтрНЧСЛ.Сотрудник.ФизЛицо))).Инвалидность;
					Если Проверка_Инвалид Тогда
						Если СокрЛП(РегистрыСведений.СведенияОбИнвалидностиФизлиц.СрезПоследних(КонецМесяца(СтрНЧСЛ.НачалоМесяца),Новый Структура("ФизЛицо",СтрНЧСЛ.ФизЛицо))[0].ГруппаИнвалидности) = "III" Тогда
							Проверка_Инвалид = Ложь;
						КонецЕсли;
					КонецЕсли;
					Если ЗначениеЗаполнено(Проверка_ИнаяСтавка) Тогда 
						Пр_ФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрНЧСЛ.НачалоМесяца),
						Новый Структура("Организация,ВидНалогообложения,ВидОтчисления",Организация,Проверка_ВидНалогообложения,Перечисления.ВидыОтчисленийСФОТиЗП.ИнаяСтавка)).Размер;			
						Если организация.УчетДополнительнойПенсии Тогда 
							Пр_ФСЗН = 34; //
						КонецЕсли;
					ИначеЕсли Проверка_Инвалид Тогда 
						Пр_ФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрНЧСЛ.НачалоМесяца),
						Новый Структура("Организация,ВидНалогообложения,ВидОтчисления",Организация,Проверка_ВидНалогообложения,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗНИнвалиды)).Размер;
					иначе
						Пр_ФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(СтрНЧСЛ.НачалоМесяца),
						Новый Структура("Организация,ВидНалогообложения,ВидОтчисления",Организация,Проверка_ВидНалогообложения,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН)).Размер;
					КонецЕсли;
					Процент_ФСЗН_Итог = Пр_ФСЗН-6;
					
					
					СтрНЧСЛ = "НЧСЛ=" + Месяц(СТрНЧСЛ.НачалоМесяца) + 
					"=0" + "=" +
					?(СтрНЧСЛ.Результат = 0, "0", СокрЛП(Строка(Формат(СтрНЧСЛ.Результат,"ЧГ=0")))) + "=" +
					"0" + "=" +
					"0" + "=" +
					"0" + "=" +
					"0" + "=" +
					"0" + "=" +
					"=1="+СокрЛП(Процент_ФСЗН_Итог)+"=6= "+"=";
					
					ТекстФайла.ДобавитьСтроку(СтрНЧСЛ);
					ТекСтрока = ТекСтрока + 1;
				КонецЦикла;
				
				//СТАЖ
				Для Каждого СтрСтаж Из СтрокиВремНеТрудПоСотрудникуСтаж Цикл
					СтрокаСтаж = "СТАЖ=" + Формат(СтрСтаж.ДатаНачалаРабот, "ДФ=dd/MM/yyyy") + "=" + Формат(СтрСтаж.ДатаОкончанияРабот, "ДФ=dd/MM/yyyy");
					СтрокаСтаж = СтрокаСтаж + "= =ВРЕМНЕТРУД= = =>";
					ТекстФайла.ДобавитьСтроку(СтрокаСтаж);
					ТекСтрока = ТекСтрока + 1;
				КонецЦикла;
			КонецЕсли;
			//Аверсон СВФР-008384
			
		КонецЦикла; 
		Дбф.ЗакрытьФайл();
		//Островская Татьяна 25.10.2012 № 15
		//Островская Татьяна 17.01.2013 № 16153
		//Островская Татьяна 20.01.2014 № 17051
		если не КатегорияВывод= "ДОГОВОР" Тогда
			
			//Аверсон ЕАЕ 20.07.2022 СВФР-009352
			//СтрокаФайла = "ТИПД=ПУ-3="+СокрЛП(Строка(КоличествоДокументов))+"="+ ?(ИтогДохода = 0, "0", СокрЛП(Строка(Формат(ИтогДохода,"ЧГ=0"))))+"="+
			СтрокаФайла = "ТИПД=ПУ-3="+СокрЛП(Формат(КоличествоДокументов,"ЧГ=0"))+"="+ ?(ИтогДохода = 0, "0", СокрЛП(Строка(Формат(ИтогДохода,"ЧГ=0"))))+"="+
			//Аверсон СВФР-009352
			
			?(ИтогБольн = 0, "0", СокрЛП(Строка(Формат(ИтогБольн,"ЧГ=0"))))+"="+
			?(ИтогВзнос+ИтогВзнос1+ИтогВзнос2 = 0, "0", СокрЛП(Строка(Формат(ИтогВзнос+ИтогВзнос1+ИтогВзнос2,"ЧГ=0"))))+"="+
			?(ИтогВзнос+ИтогВзнос1+ИтогВзнос2 = 0, "0", СокрЛП(Строка(Формат(ИтогВзнос+ИтогВзнос1+ИтогВзнос2,"ЧГ=0"))))+"=>";//Островская Татьяна 17.01.2013 № 16153
		Иначе 
			
			//Аверсон ЕАЕ 20.07.2022 СВФР-009352
			//СтрокаФайла = "ТИПД=ПУ-3="+СокрЛП(Строка(КоличествоДокументов))+"="+ ?(ИтогДохода = 0, "0", СокрЛП(Строка(Формат(ИтогДохода,"ЧГ=0"))))+"="+
			СтрокаФайла = "ТИПД=ПУ-3="+СокрЛП(Формат(КоличествоДокументов,"ЧГ=0"))+"="+ ?(ИтогДохода = 0, "0", СокрЛП(Строка(Формат(ИтогДохода,"ЧГ=0"))))+"="+
			//Аверсон СВФР-009352
			
			?(ИтогБольн = 0, "0", СокрЛП(Строка(Формат(ИтогБольн,"ЧГ=0"))))+"="+
			?(ИтогВзнос+ИтогВзнос1+ИтогВзнос2 = 0, "0", СокрЛП(Строка(Формат(ИтогВзнос+ИтогВзнос1+ИтогВзнос2,"ЧГ=0"))))+"="+
			?(ИтогВзнос+ИтогВзнос1+ИтогВзнос2 = 0, "0", СокрЛП(Строка(Формат(ИтогВзнос+ИтогВзнос1+ИтогВзнос2,"ЧГ=0"))))+"=>";//Островская Татьяна 17.01.2013 № 16153
		КонецЕсли;	
		//Островская Татьяна 20.01.2014 № 17051
		//Островская Татьяна 17.01.2013 № 16153
		
		
		//Островская Татьяна 25.10.2012 № 15
		ТекстФайла.ЗаменитьСтроку(3, СтрокаФайла);
		
		//толик проверка ФСЗН дбф	
		//ДоходыПоВидамЗаГод =
		//"ВЫБРАТЬ
		//|	СУММА(ВЫБОР
		//|			КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН
		//|				ТОГДА ЕСНСведенияОДоходах.Результат
		//|			ИНАЧЕ 0
		//|		КОНЕЦ) КАК Больничные,
		//|	СУММА(ВЫБОР
		//|			КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		//|				ТОГДА ЕСНСведенияОДоходах.Результат
		//|			ИНАЧЕ 0
		//|		КОНЕЦ) КАК СуммаДохода,
		//|	ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
		//|	ЕСНИсчисленный.ФСЗН КАК ФСЗН,
		//|	ЕСНИсчисленный.ПенсионныйФонд КАК ПенсионныйФонд,
		//|	34 КАК ПроцентФСЗН,
		//|	ЕСНСведенияОДоходах.Период КАК ПериодРегистрации
		//|ИЗ
		//|	РегистрНакопления.ЕСНСведенияОДоходах КАК ЕСНСведенияОДоходах
		//|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|			ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		//|			34 КАК ПроцентФСЗН,
		//|			СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		//|			СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		//|			ЕСНИсчисленный.Период КАК Период
		//|		ИЗ
		//|			РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		//|		ГДЕ
		//|			ЕСНИсчисленный.Период МЕЖДУ &НачалоНП И &КонецНП
		//|			И ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		//|			И ЕСНИсчисленный.ФизЛицо В(" + СписокФизлицТекст + ")
		//|		
		//|		СГРУППИРОВАТЬ ПО
		//|			ЕСНИсчисленный.ФизЛицо,
		//|			ЕСНИсчисленный.Период) КАК ЕСНИсчисленный
		//|		ПО ЕСНСведенияОДоходах.ФизЛицо = ЕСНИсчисленный.ФизЛицо
		//|			И ЕСНСведенияОДоходах.Период = ЕСНИсчисленный.Период
		//|ГДЕ
		//|	ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		//|	И ЕСНСведенияОДоходах.ФизЛицо В(" + СписокФизлицТекст + ")
		//|
		//|СГРУППИРОВАТЬ ПО
		//|	ЕСНСведенияОДоходах.ФизЛицо,
		//|	ЕСНИсчисленный.ФСЗН,
		//|	ЕСНИсчисленный.ПенсионныйФонд,
		//|	ЕСНИсчисленный.ПроцентФСЗН,
		//|	ЕСНСведенияОДоходах.Период";
		
		// + СВЭЙ КДЯ 31.07.19 СВФР-004561
		//ДоходыПоВидамЗаГод =
		//"ВЫБРАТЬ
		//|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		//|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,";
		//Если не ОбъединятьОсновные Тогда
		//	ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//	|	ОбщаяТаблицаФСЗН.Сотрудник,";
		//КонецЕсли;
		//ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + " 
		//|	ОбщаяТаблицаФСЗН.ФизЛицо,
		//|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		//|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		//|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		//|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		//|	ОбщаяТаблицаФСЗН.Период КАК ПериодРегистрации
		//|ИЗ
		//|	(ВЫБРАТЬ
		//|		NULL КАК Больничные,
		//|		NULL КАК СуммаДохода,
		//|		ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		//|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		//|		ВЫБОР
		//|		КОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//|			ТОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
		//|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		//|		КОНЕЦ КАК ПериодВзаиморасчетов,
		//|		34 КАК ПроцентФСЗН,
		//|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		//|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		//|		ЕСНИсчисленный.Период КАК Период
		//|	ИЗ
		//|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		//|	ГДЕ
		//|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		//|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		//|		И (ЕСНИсчисленный.Период МЕЖДУ &НачалоНП И &КонецНП
		//|				ИЛИ ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП)
		//|	
		//|	СГРУППИРОВАТЬ ПО
		//|		ЕСНИсчисленный.Сотрудник,
		//|		ЕСНИсчисленный.ФизЛицо,
		//|		ЕСНИсчисленный.Период,
		//|		ВЫБОР
		//|			КОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//|				ТОГДА НАЧАЛОПЕРИОДА(ЕСНИсчисленный.Период, МЕСЯЦ)
		//|			ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		//|		КОНЕЦ
		//
		//|	
		//|	ОБЪЕДИНИТЬ ВСЕ
		//|	
		//|	ВЫБРАТЬ
		//|		СУММА(ВЫБОР
		//|				КОГДА ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//|		или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
		//|					ТОГДА ЕСНСведенияОДоходах.Результат
		//|				ИНАЧЕ 0
		//|			КОНЕЦ),
		//|		СУММА(ВЫБОР
		//|		КОГДА НЕ ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН и не ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//|		
		//|			ТОГДА ЕСНСведенияОДоходах.Результат КОНЕЦ
		//|				),
		//|		ЕСНСведенияОДоходах.Сотрудник,
		//|		ЕСНСведенияОДоходах.ФизЛицо,
		//|		ВЫБОР
		//|		КОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//|			ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		//|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		//|		КОНЕЦ,
		//|		34,
		//|		NULL,
		//|		NULL,
		//|		ЕСНСведенияОДоходах.Период
		//|	ИЗ
		//|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		//|	ГДЕ
		//|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		//|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		//|		И (ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		//|				ИЛИ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП)
		//|	СГРУППИРОВАТЬ ПО
		//|	ЕСНСведенияОДоходах.Сотрудник,
		//|	ЕСНСведенияОДоходах.ФизЛицо,
		//|	ЕСНСведенияОДоходах.Период,
		//|	ВЫБОР
		//|		КОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		//|			ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		//|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		//|	КОНЕЦ) КАК ОбщаяТаблицаФСЗН
		//
		//|
		//|СГРУППИРОВАТЬ ПО
		//|	ОбщаяТаблицаФСЗН.ФизЛицо,";
		//Если не ОбъединятьОсновные Тогда
		//	ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//	|	ОбщаяТаблицаФСЗН.Сотрудник,";
		//КонецЕсли;
		//ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + " 
		//|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		//|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		//|	ОбщаяТаблицаФСЗН.Период
		//|	УПОРЯДОЧИТЬ ПО
		//|	ПериодРегистрации";	
		//Запрос.Текст = ДоходыПоВидамЗаГод;
		//ПромежуточнаяТаблица = Запрос.Выполнить().Выгрузить();
		// - СВЭЙ КДЯ 31.07.19 СВФР-004561
		
		//формируем файл
		
		Дбф=Новый XBase();
		Дбф.Кодировка=КодировкаXBase.OEM;
		Дбф.Поля.Добавить("Tab_nom", "S", 10);
		Дбф.Поля.Добавить("FIO", "S", 50);
		Дбф.Поля.Добавить("Datr", "D");
		Дбф.Поля.Добавить("Dato", "D");
		Дбф.Поля.Добавить("Sm", "N", 12);
		Дбф.Поля.Добавить("Bl", "N", 12);
		Дбф.Поля.Добавить("Vz", "N", 12);
		//Островская Татьяна 22.02.2013 № 16256 Островская Татьяна 27.05.2014 № 17388
		ПутьКФайлу = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация",Организация)).ПутьДляВыгрузкиПУ12;
		если ЗначениеЗаполнено(ПутьКФайлу) Тогда 
			Дбф.СоздатьФайл(ПутьКФайлу+"\Vznosy.DBF");
		иначе
			РабочийКаталог = СтрокаСоединенияИнформационнойБазы();
			б = Сред(РабочийКаталог,7);
			в = Найти(б,Символ(34));
			путьИБ = Лев(б, в-1);
			
			Дбф.СоздатьФайл(путьИБ+"\Vznosy.DBF");
		КонецЕсли;
		//Островская Татьяна 22.02.2013 № 16256 Островская Татьяна 27.05.2014 № 17388
		
		
		Для Каждого мСтрока из ПромежуточнаяТаблица Цикл
			Дбф.Добавить();
			Дбф.УстановитьЗначениеПоля("FIO", СокрЛП(Строка(мСтрока.ФизЛицо)));
			Дбф.УстановитьЗначениеПоля("Datr", мСтрока.ПериодРегистрации);
			Дбф.УстановитьЗначениеПоля("Dato", мСтрока.ПериодВзаиморасчетов);
			//О.Т. Аверсон 29.08.2018 № 2363
			Если ОбъединятьОсновные Тогда
				ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
			иначе
				Если ЗначениеЗаполнено(мСтрока.Сотрудник.ВидНалогообложенияОсновной) Тогда 
					ОсновнойВидНалогообл = мСтрока.Сотрудник.ВидНалогообложенияОсновной;
				иначе
					ОсновнойВидНалогообл = Организация.ОсновнаяСтавкаНалогообложения;
				КонецЕсли;
			КонецЕсли;
			//О.Т. Аверсон 29.08.2018 № 2363
			//О.Т. Аверсон 29.01.2018 № 1511
			СтруктураФСЗН = РегистрыСведений.СтавкиОтчисленийСФОТиЗП.ПолучитьПоследнее(КонецМесяца(мСтрока.ПериодРегистрации),Новый Структура("Организация,ВидОтчисления,ВидНалогообложения",Организация,Перечисления.ВидыОтчисленийСФОТиЗП.ФСЗН,ОсновнойВидНалогообл));//О.Т. Аверсон 26.03.2016 № 950
			РазмерСреднейЗарплаты = РегистрыСведений.РазмерыПараметровДляРасчетаРБ.ПолучитьПоследнее(НачалоМесяца(мСтрока.ПериодРегистрации) - 86400,Новый Структура("ВидПараметра",Перечисления.ВидыПараметровДляРасчетаЗарплаты.СредняяЗПРаботников)).Размер;
			БазаОграниченияФСЗН = СтруктураФСЗН.ОграничениеПоДоходам*РазмерСреднейЗарплаты;
			
			Если ?(мСтрока.СуммаДохода=Null, 0,мСтрока.СуммаДохода) > БазаОграниченияФСЗН Тогда 
				мСтрока.СуммаДохода = БазаОграниченияФСЗН;
			КонецЕсли;
			//О.Т. Аверсон 29.01.2018 № 1511
			
			Дбф.УстановитьЗначениеПоля("Sm", ОбщегоНазначения.ОкруглитьЗначение2016(?(мСтрока.СуммаДохода=Null, 0, мСтрока.СуммаДохода), мСтрока.ПериодРегистрации));//О.Т. Аверсон 14.03.2016 № 949
			Дбф.УстановитьЗначениеПоля("Bl", ОбщегоНазначения.ОкруглитьЗначение2016(?(мСтрока.Больничные=Null, 0, мСтрока.Больничные), мСтрока.ПериодРегистрации)); //О.Т. Аверсон 14.03.2016 № 949
			Дбф.УстановитьЗначениеПоля("Vz", ОбщегоНазначения.ОкруглитьЗначение2016(?(мСтрока.ФСЗН=Null, 0, мСтрока.ФСЗН) + ?(мСтрока.ПенсионныйФонд=Null, 0, мСтрока.ПенсионныйФонд),мСтрока.ПериодРегистрации)); //О.Т. Аверсон 14.03.2016 № 949
			Дбф.Записать();
		КонецЦикла;
		Дбф.ЗакрытьФайл();
		//Предупреждение("Данные сформированы !!!");//О.Т. Аверсон 26.10.2015 № 661
		
		//О.Т. Аверсон 26.10.2015 № 661
		//записываем файл
		//О.Т. Аверсон 27.06.2016 № 1278
		ПутьКФайлу = РегистрыСведений.УчетнаяПолитикаПоПерсоналуОрганизаций.Получить(Новый Структура("Организация",Организация)).ПутьДляВыгрузкиПУ12;
		
		если ЗначениеЗаполнено(ПутьКФайлу) Тогда 
			//+ СВЭЙ КДЯ 21.09.19 СВФР-004805
			//ТекстФайла.Записать(ПутьКФайлу+"\"+"PU3_"+Номер+".txt",КодировкаТекста.ANSI);
			//Сообщить("Файл сохранен: " + ПутьКФайлу+"\"+"PU3_"+Номер+".txt");
			//- СВЭЙ КДЯ 21.09.19 СВФР-004805 
			//+ СВЭЙ КДЯ 21.09.19 СВФР-004805
			ТекстФайла.Записать( ПутьКФайлу + "\" + ИмяФайлаПачки, КодировкаТекста.ANSI );
			Сообщить( "Файл сохранен: " + ПутьКФайлу + "\" + ИмяФайлаПачки );
			//- СВЭЙ КДЯ 21.09.19 СВФР-004805 
		иначе   			
			ЗапросПутьКФайлу = Новый Запрос;
			ТекстЗапроса = "ВЫБРАТЬ
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.ПутьКФайламБанк
			|ИЗ
			|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитикаПоПерсоналуОрганизаций
			|ГДЕ
			|	УчетнаяПолитикаПоПерсоналуОрганизаций.Организация = &Организация";
			
			ЗапросПутьКФайлу.УстановитьПараметр("Организация", Организация);
			
			ЗапросПутьКФайлу.Текст = ТекстЗапроса; 
			
			ПутьКФайламБанка = ЗапросПутьКФайлу.Выполнить().Выгрузить();
			
			Если Не ЗначениеЗаполнено(ПутьКФайламБанка[0].ПутьКФайламБанк) Тогда
				Сообщить("Не указан путь к файлам ПУ в учетной политике по персоналу организаций");
			Иначе
				//+ СВЭЙ КДЯ 21.09.19 СВФР-004805
				//ТекстФайла.Записать(СокрЛП(ПутьКФайламБанка[0].ПутьКФайламБанк)+"PU3_"+Строка(Номер) +".txt", КодировкаТекста.ANSI);
				//Сообщить("Файл сохранен: " + СокрЛП(ПутьКФайламБанка[0].ПутьКФайламБанк)+"PU3_"+ Строка(Номер) +".txt");
				//- СВЭЙ КДЯ 21.09.19 СВФР-004805 
				//+ СВЭЙ КДЯ 21.09.19 СВФР-004805
				ТекстФайла.Записать(СокрЛП(ПутьКФайламБанка[0].ПутьКФайламБанк)+ИмяФайлаПачки, КодировкаТекста.ANSI);
				Сообщить("Файл сохранен: " + СокрЛП(ПутьКФайламБанка[0].ПутьКФайламБанк)+ИмяФайлаПачки);
				//- СВЭЙ КДЯ 21.09.19 СВФР-004805 
			КонецЕсли;
			//О.Т. Аверсон 26.10.2015 № 661
		КонецЕсли;
		
		Возврат ТекстФайла.ПолучитьТекст();
	КонецФункции 
	
	//Аверсон ЕАЕ 09.12.2021 СВФР-008384
	Функция ПолучитьБольничные(СписокСотрудников)
		
		//СВЭЙ 28.08.2023 КВВ СВФР-011258 (пункт 2) (
		Если ДогПодряда И НЕ ВыгрузкаДоговоровПодрядаБезОграничения И НЕ ЭтотОбъект.ОбъединятьОсновные Тогда
			Текст = "ВЫБРАТЬ
			|ДоговорНаВыполнениеРаботСФизЛицом.Ссылка.ДатаНачала КАК ДатаНачала,
			|КОНЕЦПЕРИОДА(ДоговорНаВыполнениеРаботСФизЛицом.Ссылка.ДатаОкончания,ДЕНЬ) КАК ДатаОкончания,
			|ДоговорНаВыполнениеРаботСФизЛицом.Ссылка,
			|ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
			|ПОМЕСТИТЬ ВтДоговораПодряда
			|ИЗ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			|ГДЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.ТипРаботника = ЗНАЧЕНИЕ(Перечисление.ТипыРаботников.ДоговорПодряда)
			|И ДоговорНаВыполнениеРаботСФизЛицом.Ссылка.НеОповещатьДопПенсия = Ложь
			|И КОНЕЦПЕРИОДА(ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания,ДЕНЬ) МЕЖДУ &Нач И &Кон
			|И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
			|;
			|
			|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
			|ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
			|ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
			|НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) КАК НачалоМесяца,
			|ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			|ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
			|ДополнительныеНачисленияРаботниковОрганизаций.Результат
			|ПОМЕСТИТЬ ВтБЛПоДействующимДогПодряда
			|ИЗ
			|РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтДоговораПодряда КАК ВтДоговораПодряда
			|ПО ВтДоговораПодряда.Сотрудник = ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
			|ГДЕ
			|ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.ОплатаБЛОбщееЗаболевание)
			|И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало <= &Кон                                              
			|И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец >= &Нач
			|И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
			|И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник В (&СписокСотрудников)
			|И (ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало <= ВтДоговораПодряда.ДатаОкончания                                              
			|И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец >= ВтДоговораПодряда.ДатаНачала)
			|;
			|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
			|ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
			|ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
			|НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) КАК НачалоМесяца,
			|ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			|ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
			|ДополнительныеНачисленияРаботниковОрганизаций.Результат, 
			|ИСТИНА КАК ЭтоБольничныйПослеУвольнения
			|ИЗ
			|РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтБЛПоДействующимДогПодряда КАК ВтБЛПоДействующимДогПодряда
			|ПО ВтБЛПоДействующимДогПодряда.Сотрудник = ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
			|И ВтБЛПоДействующимДогПодряда.Результат = ДополнительныеНачисленияРаботниковОрганизаций.Результат
			|И ВтБЛПоДействующимДогПодряда.БазовыйПериодНачало = ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало
			|И ВтБЛПоДействующимДогПодряда.БазовыйПериодКонец = ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец			
			|ГДЕ
			|ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ДополнительныеНачисленияОрганизаций.ОплатаБЛОбщееЗаболевание)
			|И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало <= &Кон                                              
			|И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец >= &Нач
			|И ДополнительныеНачисленияРаботниковОрганизаций.Результат <> 0
			|И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник В (&СписокСотрудников)
			|И ВтБЛПоДействующимДогПодряда.Сотрудник ЕСТЬ NULL";						
		Иначе
			//СВЭЙ 28.08.2023 КВВ СВФР-011258 (пункт 2) )
			
			Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
			|ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
			|ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,
			|НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) КАК НачалоМесяца,
			|ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
			|ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
			|ОсновныеНачисленияРаботниковОрганизаций.Результат,
			|ВЫБОР
			|	КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
			|	ТОГДА ДАТАВРЕМЯ(1,1,1)
			
			//Аверсон ЕАЕ 26.01.2023 СВФР-010135
			//|	ИНАЧЕ ДОБАВИТЬКДАТЕ(РаботникиОрганизацийУвольнение.Период, ДЕНЬ, -1)
			|	ИНАЧЕ РаботникиОрганизацийУвольнение.Период
			//Аверсон СВФР-010135
			
			|КОНЕЦ КАК ДатаУвольнения,
			|ВЫБОР
			|	КОГДА ВЫБОР
			|			КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
			|			ТОГДА ДАТАВРЕМЯ(1,1,1)
			
			//Аверсон ЕАЕ 26.01.2023 СВФР-010135
			//|	        ИНАЧЕ ДОБАВИТЬКДАТЕ(РаботникиОрганизацийУвольнение.Период, ДЕНЬ, -1)
			|	        ИНАЧЕ РаботникиОрганизацийУвольнение.Период
			//Аверсон СВФР-010135
			
			|		КОНЕЦ = ДАТАВРЕМЯ(1,1,1) 
			|	ТОГДА Ложь
			|	ИНАЧЕ
			|		ВЫБОР
			|		КОГДА 
			|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец >= (ВЫБОР
			|																				КОГДА РаботникиОрганизацийУвольнение.Период ЕСТЬ NULL
			|																				ТОГДА ДАТАВРЕМЯ(1,1,1)
			
			//Аверсон ЕАЕ 26.01.2023 СВФР-010135
			//|	                                                                            ИНАЧЕ ДОБАВИТЬКДАТЕ(РаботникиОрганизацийУвольнение.Период, ДЕНЬ, -1)
			|	                                                                            ИНАЧЕ РаботникиОрганизацийУвольнение.Период
			//Аверсон СВФР-010135
			
			|																			КОНЕЦ)
			
			|		ТОГДА Истина
			|		ИНАЧЕ Ложь
			|		КОНЕЦ
			|КОНЕЦ КАК ЭтоБольничныйПослеУвольнения
			|ИЗ
			|РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийУвольнение
			|ПО РаботникиОрганизацийУвольнение.Сотрудник = ОсновныеНачисленияРаботниковОрганизаций.Сотрудник
			|И РаботникиОрганизацийУвольнение.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			|ГДЕ
			|ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаПоСреднемуБЛ)
			|И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало <= &Кон
			|И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец >= &Нач
			|И ОсновныеНачисленияРаботниковОрганизаций.Результат <> 0
			|И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В (&СписокСотрудников)";
		КонецЕсли;
		Запрос = Новый Запрос;
		Запрос.Текст = Текст;
		Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
		Запрос.УстановитьПараметр("Нач", ДатаНачала);
		Запрос.УстановитьПараметр("Кон", ДатаОкончания);
		ТЗ = Запрос.Выполнить().Выгрузить();
		Возврат ТЗ;
	КонецФункции
	//Аверсон СВФР-008384
	
	//ПСА 04.07.2019 СВФР-004497++
	Функция ПолучитьЗначениеКВ( СтрокиПоРаботнику
		//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
		, ИсходноеЗначениеКв = "", СтрокаМес = Неопределено
		//- СВЭЙ КДЯ 25.07.19 СВФР-004561
		) 
		
		//О.Т. Аверсон 15.03.2019 № 4091
		Если ДатаНачала < Дата(2019,01,01) Тогда 
			ЗначениеКв = " ";
		иначе
			
			Если СтрокиПоРаботнику = Неопределено или СтрокиПоРаботнику.Количество() = 0 Тогда
				ДатаДляЗначенияКВ = ДатаОкончания;
				//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
				ЕстьВыборка = Ложь;
				//- СВЭЙ КДЯ 25.07.19 СВФР-004561
			Иначе
				ДатаДляЗначенияКВ = Дата(1,1,1);
				Для Каждого СтрокаПоРаботнику Из СтрокиПоРаботнику Цикл
					//+ СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 5. )
					Если 
						СтрокаМес <> Неопределено
						//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
						//И СтрокаМес.ВидДоговора = Перечисления.ВидыДоговоровСФизЛицами.Подряда
						//И (
						//	
						//	НЕ ЗначениеЗаполнено( СтрокаПоРаботнику.Договор )
						//   ИЛИ
						//	ТипЗнч( СтрокаПоРаботнику.Договор ) <>  Тип( "ДокументСсылка.ДоговорНаВыполнениеРаботСФизЛицом" ) 
						//   ИЛИ
						//	СтрокаМес.ВидДоговора <> СтрокаПоРаботнику.ВидДоговора
						//   
						//	ИЛИ
						//   СокрЛП( СтрокаМес.НомерДокумента ) <> ПолучитьНомерДокументаДляПУ( СтрокаПоРаботнику.Договор )
						//   
						//   ИЛИ
						//   СтрокаМес.ДатаДокумента <> ПолучитьДатуДокументаДляПУ( СтрокаПоРаботнику.Договор )
						//  )
						//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
						//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
						И (
						СтрокаМес.ВидДоговора <> СтрокаПоРаботнику.ВидДоговора
						
						ИЛИ
						СтрокаМес.НомерДокумента <> СтрокаПоРаботнику.НомерДокумента
						
						ИЛИ
						СтрокаМес.ДатаДокумента <> СтрокаПоРаботнику.ДатаДляПУ
						)
						//- СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
						
						Тогда
						
						Продолжить;	
						
					КонецЕсли; 
					//- СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 5. )
					Если ДатаДляЗначенияКВ < СтрокаПоРаботнику.ДатаОкончанияРабот Тогда 
						ДатаДляЗначенияКВ = СтрокаПоРаботнику.ДатаОкончанияРабот;
					КонецЕсли;
				КонецЦикла;
				
				//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
				
				
				ЕстьВыборка = Истина;
				ДатаДляЗначенияКВ = Мин( Макс( ДатаДляЗначенияКВ, ДатаНачала ), ДатаОкончания );
				//- СВЭЙ КДЯ 25.07.19 СВФР-004561
				
			КонецЕсли;	
			
			Если Месяц(ДатаДляЗначенияКВ) >=1 и  Месяц(ДатаДляЗначенияКВ) <=3 Тогда 
				ЗначениеКв = "1";
			ИначеЕсли Месяц(ДатаДляЗначенияКВ) >=4 и  Месяц(ДатаДляЗначенияКВ) <=6 Тогда 
				ЗначениеКв = "2";
			ИначеЕсли Месяц(ДатаДляЗначенияКВ) >=7 и  Месяц(ДатаДляЗначенияКВ) <=9 Тогда 
				ЗначениеКв = "3";	  
			ИначеЕсли Месяц(ДатаДляЗначенияКВ) >=10 и  Месяц(ДатаДляЗначенияКВ) <=12 Тогда 
				ЗначениеКв = "4"; 			
			КонецЕсли; 
			
			//+ СВЭЙ КДЯ 25.07.19 СВФР-004561
			//Если НЕ ЕстьВыборка И СокрЛП( ИсходноеЗначениеКв ) <> "" И ЗначениеКв <> ИсходноеЗначениеКв Тогда
			//	ЗначениеКв = ИсходноеЗначениеКв;	
			//КонецЕсли;
			Если ЕстьВыборка Тогда
				
				Если НЕ ПустаяСтрока( ИсходноеЗначениеКв ) Тогда
					Если Лев( ИсходноеЗначениеКв, 1 ) = " " Тогда  // это значение квартала было вычислено ранее без выборки
						// оставляем ЗначениеКв без изменений
					Иначе // ИсходноеЗначениеКв	- было вычислено ранее на основании выборки
						Если Число( ЗначениеКв ) < Число( ИсходноеЗначениеКв ) Тогда
							
							ЗначениеКв = ИсходноеЗначениеКв;	
							
						КонецЕсли; 	
					КонецЕсли; // Лев( ИсходноеЗначениеКв, 1 ) = " "
				КонецЕсли; // НЕ ПустаяСтрока( ИсходноеЗначениеКв )
				
			Иначе  // НЕ ЕстьВыборка
				
				ЗначениеКв = " " + ЗначениеКв; //пробел слева - признак того, что квартал вычислен без выборки
				Если НЕ ПустаяСтрока( ИсходноеЗначениеКв ) И ЗначениеКв <> ИсходноеЗначениеКв Тогда
					ЗначениеКв = ИсходноеЗначениеКв;	
				КонецЕсли; // НЕ ПустаяСтрока( ИсходноеЗначениеКв )
				
			КонецЕсли; // ЕстьВыборка
			//- СВЭЙ КДЯ 25.07.19 СВФР-004561
			
			
		КонецЕсли;
		
		Возврат ЗначениеКв;
	КонецФункции
	//+++ПСА 04.07.2019 СВФР-004497
	
	Функция ПолучитьДанныеДляЗаполненияСтажа(Организация, Год) Экспорт
		
		Запрос = Новый Запрос;
		
		Запрос.УстановитьПараметр("ДокументСсылка" , Ссылка);
		
		// + СВЭЙ КДЯ 12.09.19 СВФР-004631 ( пункт 23. )
		//Запрос.УстановитьПараметр("СписокОтчитывающихсяПодразделений", Организация);
		//Запрос.УстановитьПараметр("НачалоНП", НачалоГода(НачалоГода(ДобавитьМесяц(НачалоКвартала(ДатаНачала),-1))));
		//Запрос.УстановитьПараметр("КонецНП", КонецГода(Год));
		//Запрос.УстановитьПараметр("БольничныйПоТравме", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве);
		//Запрос.УстановитьПараметр("ОтпускПоУходуЗаРебенком", ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты);
		//Запрос.УстановитьПараметр("ПриемНаРаботу", Перечисления.ПричиныИзмененияСостояния.ПриемНаРаботу);
		//Запрос.УстановитьПараметр("Перемещение", Перечисления.ПричиныИзмененияСостояния.Перемещение);
		//Запрос.УстановитьПараметр("Увольнение", Перечисления.ПричиныИзмененияСостояния.Увольнение);
		//Запрос.УстановитьПараметр("Договор", Перечисления.СпособыРасчетаОплатыТруда.ПоДоговоруФиксированнойСуммой);
		//
		//СписокФизлицТекст = "ВЫБРАТЬ 
		//|	ТЧРаботникиОрганизации.Сотрудник
		//|ИЗ
		//|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр.РаботникиОрганизации КАК ТЧРаботникиОрганизации
		//|
		//|ГДЕ
		//|	ТЧРаботникиОрганизации.Ссылка = &ДокументСсылка";
		//
		//ДатыДвиженийТекст = 
		//"ВЫБРАТЬ
		//|	РаботникиОрганизацийСрезПоследних.Сотрудник как Сотрудник,
		//|	РаботникиОрганизацийСрезПоследних.Сотрудник.Физлицо КАК ФизЛицо,
		//|	&НачалоНП КАК ДатаС,
		//|	РаботникиОрганизацийСрезПоследних.Организация КАК Организация,
		//|	РаботникиОрганизацийСрезПоследних.Должность.ВидДейтельности.Код КАК ВидДейтельности
		//|ИЗ
		//|   РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачалоНП) КАК РаботникиОрганизацийСрезПоследних
		//|ГДЕ
		//|   РаботникиОрганизацийСрезПоследних.Организация = &СписокОтчитывающихсяПодразделений
		//|   И РаботникиОрганизацийСрезПоследних.Сотрудник В (" + СписокФизлицТекст + ")
		//|   И РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния <> &Увольнение
		//|
		//|ОБЪЕДИНИТЬ ВСЕ
		//|	
		//|ВЫБРАТЬ
		//|	РаботникиОрганизаций.Сотрудник,
		//|	РаботникиОрганизаций.Сотрудник.Физлицо,
		//|	РаботникиОрганизаций.Период,
		//|	РаботникиОрганизаций.Организация, 
		//|	РаботникиОрганизаций.Должность.ВидДейтельности.Код КАК ВидДейтельности 
		//|ИЗ
		//|   РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		//|ГДЕ
		//|	РаботникиОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
		//|   И РаботникиОрганизаций.Сотрудник В (" + СписокФизлицТекст + ")
		//|   И РаботникиОрганизаций.Период МЕЖДУ &НачалоНП И &КонецНП
		//|   И РаботникиОрганизаций.ПричинаИзмененияСостояния <> &Увольнение";
		//
		//ЗапросТекст = 
		//"ВЫБРАТЬ 
		//|	ДопСведОСтаже.ВидДейтельности КАК ВидДейтельности,
		//|	ДопСведОстаже.Сотрудник КАК Сотрудник,
		//|	ДопСведОстаже.ФизЛицо КАК ФизЛицо,
		//|   ДопСведОСтаже.НачалоРабот КАК НачалоРабот,
		//|   ДопСведОСтаже.ОкончаниеРабот КАК ОкончаниеРабот,
		//|   ДопСведОСтаже.ДатаДокумента КАК ДатаДокумента,
		//|   ДопСведОСтаже.НомерДокумента КАК НомерДокумента,
		//|   ДопСведОСтаже.ДатаДляПУ КАК ДатаДляПУ,
		//|   ДопСведОСтаже.ВидДоговора КАК ВидДоговора
		//|ИЗ
		//|   (";
		//ЕСЛИ ДогПодряда или ВсеСотрудники Тогда 
		//	ЗапросТекст = ЗапросТекст +	
		//	"ВЫБРАТЬ
		//	|		""ДОГОВОР"" КАК ВидДейтельности,
		//	|		ПлановыеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
		//	|		ПлановыеНачисленияРаботниковОрганизаций.Сотрудник.Физлицо КАК ФизЛицо,
		//	|		ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.ДатаНачала КАК НачалоРабот,
		//	|		ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.ДатаОкончания КАК ОкончаниеРабот,
		//	|       Выбор когда ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.ДатаПУ = ДатаВремя(1,1,1) тогда  ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.Дата иначе ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.ДатаПУ конец КАК  ДатаДокумента,
		//	|       Выбор когда ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.НомерДляПу = """" тогда ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.Номер иначе ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.НомерДляПу конец КАК НомерДокумента,
		//	|       Выбор когда ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.ДатаПУ = ДатаВремя(1,1,1) тогда  ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.ДатаНачала иначе ПлановыеНачисленияРаботниковОрганизаций.ДокументОснование.ДатаПУ конец КАК  ДатаДляПУ,
		//	|       ПлановыеНачисленияРаботниковОрганизаций.Сотрудник.ВидДоговора как ВидДоговора
		//	|	ИЗ
		//	|		РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
		//	|	ГДЕ
		//	|		ПлановыеНачисленияРаботниковОрганизаций.Период <= &КонецНП
		//	|		И ПлановыеНачисленияРаботниковОрганизаций.ПериодЗавершения >= &НачалоНП
		//	|		И ПлановыеНачисленияРаботниковОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
		//	|		И ПлановыеНачисленияРаботниковОрганизаций.Сотрудник В (" + СписокФизлицТекст + ")
		//	|		И ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &Договор
		//	|
		//	|ОБЪЕДИНИТЬ ВСЕ ";
		//КонецЕсли;
		//ЗапросТекст = ЗапросТекст +
		//"ВЫБРАТЬ  
		//|       ""СТРАХСЛУЧ"" КАК ВидДейтельности, 
		//|		ОсновныеНачисленияРаботниковОрганизаций.Сотрудник как Сотрудник,
		//|		ОсновныеНачисленияРаботниковОрганизаций.Сотрудник.ФизЛицо КАК ФизЛицо,
		//|		ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК НачалоРабот,
		//|		ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ОкончаниеРабот,
		//|       NULL КАК  ДатаДокумента,
		//|       NULL КАК НомерДокумента,
		//|       NULL КАК  ДатаДляПУ,
		//|      NULL как ВидДоговора
		//| 	ИЗ
		//|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		//|   ГДЕ
		//|      ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало <= &КонецНП
		//|		И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец >= &НачалоНП
		//|		И ОсновныеНачисленияРаботниковОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
		//|		И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В (" + СписокФизлицТекст + ")
		//|		И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = &БольничныйПоТравме
		//|
		////";
		////если ВсеСотрудники или Основные Тогда 
		////ЗапросТекст = ЗапросТекст +
		////" 
		//| ОБЪЕДИНИТЬ ВСЕ
		//|
		//|    ВЫБРАТЬ  
		//|       ""ДЕТИ"" КАК ВидДейтельности, 
		//|		ОсновныеНачисленияРаботниковОрганизаций.Сотрудник как Сотрудник,
		//|		ОсновныеНачисленияРаботниковОрганизаций.Сотрудник.ФизЛицо КАК ФизЛицо,
		//|		ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК НачалоРабот,
		//|		ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ОкончаниеРабот,
		//|       NULL КАК  ДатаДокумента,
		//|       NULL КАК НомерДокумента,
		//|       NULL КАК  ДатаДляПУ,
		//|      NULL как ВидДоговора
		//| 	ИЗ
		//|		РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		//|   ГДЕ
		//|      ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало <= &КонецНП
		//|		И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец >= &НачалоНП
		//|		И ОсновныеНачисленияРаботниковОрганизаций.Организация = &СписокОтчитывающихсяПодразделений
		//|		И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник В (" + СписокФизлицТекст + ")
		//|		И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = &ОтпускПоУходуЗаРебенком
		//| 
		////";
		////КонецЕсли;
		////ЗапросТекст = ЗапросТекст +
		//| ОБЪЕДИНИТЬ ВСЕ
		//|
		//|	ВЫБРАТЬ
		//|	ДатыНазначений1.ВидДейтельности КАК ВидДейтельности,
		//|	ДатыНазначений1.Сотрудник КАК Сотрудник,
		//|	ДатыНазначений1.ФизЛицо КАК ФизЛицо,
		//|	ДатыНазначений1.ДатаС КАК НачалоРабот,
		//|	ЕСТЬNULL(МИНИМУМ(ДатыНазначений2.Период), &КонецНП) КАК ДатаОкончанияРабот,
		//|       NULL КАК  ДатаДокумента,
		//|       NULL КАК НомерДокумента,
		//|       NULL КАК  ДатаДляПУ,
		//|      NULL как ВидДоговора
		//|ИЗ
		//|	(" + ДатыДвиженийТекст + ") КАК ДатыНазначений1
		//|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ДатыНазначений2
		//|					ПО ДатыНазначений2.Сотрудник = ДатыНазначений1.Сотрудник
		//|						И ДатыНазначений2.Организация = ДатыНазначений1.Организация
		//|						И ДатыНазначений2.Период > ДатыНазначений1.ДатаС
		//|						И (ДатыНазначений2.Период < &КонецНП)
		//|			
		//|СГРУППИРОВАТЬ ПО
		//|	ДатыНазначений1.Сотрудник,
		//|	ДатыНазначений1.ФизЛицо,
		//|   ДатыНазначений1.ВидДейтельности,
		//|	ДатыНазначений1.ДатаС
		//|) КАК ДопСведОСтаже
		//|УПОРЯДОЧИТЬ ПО
		//|	Сотрудник,
		//|	ВидДейтельности,
		//|	НачалоРабот";
		//
		//
		//Запрос.Текст = ЗапросТекст;
		//ТаблицаСтажа = Запрос.Выполнить().Выгрузить();
		//
		//// Удалим из таблицы стажа незначимые записи:
		////  - если по физлицу имеется 2 непрерывных записи с одинаковыми условиями труда, то объединим данные записи 
		////Н = ТаблицаСтажа.Количество() - 1;
		////Пока Н > 0 Цикл
		////	
		////	ТекущаяЗапись = ТаблицаСтажа[Н];
		////	ПредшествующаяЗапись = ТаблицаСтажа[Н-1];
		////	
		////	Если ТекущаяЗапись.ФизЛицо = ПредшествующаяЗапись.ФизЛицо // если совпадает физлицо
		////		И ТекущаяЗапись.НачалоРабот = КонецДня(ПредшествующаяЗапись.ОкончаниеРабот)+1 // если записи непрерывны (идут друг за другом по времени)
		////		// и совпадают параметры стажа
		////		И ТекущаяЗапись.ВидДейтельности = ПредшествующаяЗапись.ВидДейтельности  
		////		Тогда
		////		// объединим записи в одну
		////		ПредшествующаяЗапись.ОкончаниеРабот = ТекущаяЗапись.ОкончаниеРабот;
		////		ТаблицаСтажа.Удалить(ТекущаяЗапись);
		////	КонецЕсли; 
		////	Н = Н - 1;	
		////КонецЦикла;
		//
		//ПредшествующееФизЛицо = Справочники.ФизическиеЛица.ПустаяСсылка();
		//МассивСтрок = Новый Массив;
		//СтрокСтажа = 0;
		//СтруктураПоиска = Новый Структура("Сотрудник");
		//Н = ТаблицаСтажа.Количество();
		//Пока Н > 0 Цикл
		//	
		//	ТекущаяЗапись = ТаблицаСтажа[Н - 1];
		//	
		//	Если ТекущаяЗапись.Сотрудник <> ПредшествующееФизЛицо Тогда
		//		ЗаполнитьЗначенияСвойств(СтруктураПоиска,ТекущаяЗапись);
		//		МассивСтрок = ТаблицаСтажа.НайтиСтроки(СтруктураПоиска);
		//		ПредшествующееФизЛицо = ТекущаяЗапись.Сотрудник;
		//	КонецЕсли; 
		//	
		//	СтрокСтажа = МассивСтрок.Количество();
		//	//Если СтрокСтажа = 0 Тогда
		//	//	ЗаполнитьЗначенияСвойств(Таблица.Добавить(),ТекущаяЗапись);
		//	//	Н = Н - 1;	
		//	//	Продолжить;
		//	//КонецЕсли;
		//	
		//	НачалоРабот = ТекущаяЗапись.НачалоРабот;
		//	ОкончаниеРабот = ТекущаяЗапись.ОкончаниеРабот;
		//	
		//	Для Сч = 1 По СтрокСтажа Цикл
		//		СтрокаСтажа = МассивСтрок[СтрокСтажа - Сч];
		//		Если СтрокаСтажа.ВидДейтельности = "ДЕТИ" тогда
		//			
		//			Если НачалоРабот = СтрокаСтажа.НачалоРабот И ТекущаяЗапись.ВидДейтельности <> "ДЕТИ" тогда
		//				//Если ОкончаниеРабот = СтрокаСтажа.ОкончаниеРабот тогда
		//				//	ТекущаяЗапись.Удалить();
		//				//КонецЕсли;
		//				ТекущаяЗапись.НачалоРабот = НачалоДня(СтрокаСтажа.ОкончаниеРабот + 1);
		//			КонецЕсли;
		//			
		//			Если НачалоРабот < СтрокаСтажа.НачалоРабот Тогда
		//				Если ОкончаниеРабот > СтрокаСтажа.ОкончаниеРабот Тогда
		//					НоваяСтрока = ТаблицаСтажа.Добавить();
		//					ЗаполнитьЗначенияСвойств(НоваяСтрока,ТекущаяЗапись);
		//					НоваяСтрока.НачалоРабот = КонецДня(СтрокаСтажа.ОкончаниеРабот) + 1;
		//					НоваяСтрока.ОкончаниеРабот = ОкончаниеРабот;
		//					ТекущаяЗапись.ОкончаниеРабот = НачалоДня(СтрокаСтажа.НачалоРабот) -1;
		//					
		//					
		//				КонецЕсли;
		//			КонецЕсли;		
		//			
		//			Если ОкончаниеРабот = СтрокаСтажа.ОкончаниеРабот И ТекущаяЗапись.ВидДейтельности <> "ДЕТИ" тогда
		//				ТекущаяЗапись.ОкончаниеРабот = НачалоДня(СтрокаСтажа.НачалоРабот - 1);
		//			КонецЕсли;
		//			
		//			
		//			
		//		КонецЕсли;
		//		
		//	КонецЦикла;				
		//	Н = Н - 1;	
		//КонецЦикла;
		//
		//ТаблицаСтажа.Сортировать("Сотрудник,ФизЛицо,НачалоРабот,ВидДейтельности");	
		// - СВЭЙ КДЯ 12.09.19 СВФР-004631 ( пункт 23. )
		
		// + СВЭЙ КДЯ 12.09.19 СВФР-004631 ( пункт 23. )
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	СведенияОСтаже.Сотрудник КАК Сотрудник,
		|	СведенияОСтаже.ФизЛицо КАК ФизЛицо,
		|	СведенияОСтаже.ДатаНачалаРабот КАК НачалоРабот,
		|	СведенияОСтаже.ДатаОкончанияРабот КАК ОкончаниеРабот,
		|	ВЫРАЗИТЬ( СведенияОСтаже.ВидДеятельности.Код КАК СТРОКА ) КАК ВидДейтельности,
		|	ВЫБОР
		|		КОГДА СведенияОСтаже.Договор.ДатаПУ = ДАТАВРЕМЯ(1, 1, 1)
		|			ТОГДА СведенияОСтаже.Договор.Дата
		|		ИНАЧЕ СведенияОСтаже.Договор.ДатаПУ
		|	КОНЕЦ КАК ДатаДокумента,
		|	ВЫБОР
		|		КОГДА СведенияОСтаже.Договор.НомерДляПу = """"
		|			ТОГДА СведенияОСтаже.Договор.Номер
		|		ИНАЧЕ СведенияОСтаже.Договор.НомерДляПу
		|	КОНЕЦ КАК НомерДокумента,
		|	ВЫБОР
		|		КОГДА СведенияОСтаже.Договор.ДатаПУ = ДАТАВРЕМЯ(1, 1, 1)
		|			ТОГДА СведенияОСтаже.Договор.ДатаНачала
		|		ИНАЧЕ СведенияОСтаже.Договор.ДатаПУ
		|	КОНЕЦ КАК ДатаДляПУ,
		//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
		//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		//|	СведенияОСтаже.ВидДоговора
		//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
		//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
		//+ СВЭЙ КДЯ 05.11.19 СВФР-004631 ( Пункт 60. ) СВФР-004969 ( Пункт 8. )
		|	ВЫБОР КОГДА СведенияОСтаже.ВидДоговора = ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.Подряда ) 
		|			ТОГДА СведенияОСтаже.ВидДоговора
		|         	ИНАЧЕ ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.ПустаяСсылка )
		|   КОНЕЦ КАК ВидДоговора
		//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
		|ИЗ
		|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр2024.СведенияОСтаже КАК СведенияОСтаже
		|ГДЕ
		|	СведенияОСтаже.Ссылка = &ДокументСсылка
		//+ СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
		//не расскомментировать, иначе будут нули в начислениях !!!
		//|	И СведенияОСтаже.ВидДеятельности.Код <> ""ВЗНОСЫВРЕМ""
		//- СВЭЙ КДЯ 19.09.19 СВФР-004631 ( пункт 32. )
		|
		|УПОРЯДОЧИТЬ ПО
		|	Сотрудник.Наименование,
		|	ФизЛицо.Наименование,
		|	НачалоРабот,
		|	ВЫРАЗИТЬ( СведенияОСтаже.ВидДеятельности.Код КАК СТРОКА(100) )";
		ТаблицаСтажа = Запрос.Выполнить().Выгрузить();
		Для каждого Стр Из ТаблицаСтажа Цикл
			
			Стр.ВидДейтельности = СокрЛП( Стр.ВидДейтельности );	
			Стр.НомерДокумента = СокрЛП( Стр.НомерДокумента );	
			
		КонецЦикла; 
		// - СВЭЙ КДЯ 12.09.19 СВФР-004631 ( пункт 23. )
		
		Возврат ТаблицаСтажа;
	КонецФункции
	
	//Процедура вывода файла сведений на печать
	Процедура ПечатьФайла(РежимПечати = 0, МестоВызова = "") Экспорт
		
		ЕстьОшибки = Ложь;
		ТекстФайла = РегламентированнаяОтчетность.ПолучитьТекстФайла(ЭтотОбъект,ЕстьОшибки);
		Если ЕстьОшибки тогда
			Возврат;
		КонецЕсли;	 
		
		Макет = ПолучитьМакет("ФормаАДВ_1");
		ДокументРезультат = Новый ТабличныйДокумент;
		ДокументРезультат.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АнкетаЗастрахованногоЛица_ФормаАДВ_1";
		
		//Получаем таблицу формата записи
		ДокументФорматЗаписей = ПолучитьМакет("ФорматЗаписей");
		ТаблицаФорматаЗаписи = ПроцедурыПерсонифицированогоУчета.ПолучитьФорматЗаписи("АНКТ",ДокументФорматЗаписей);
		
		//Получаем инициализированную структуру, соответствующую формату записи 
		//ПустаяЗапись = ПолучитьСтруктуруЗаписи(ТаблицаФорматаЗаписи);
		
		//Обработка заголовка файла
		ИнформацияОПачке = Новый Структура;
		Если ПроцедурыПерсонифицированогоУчета.РазобратьЗаголовокФайла(ТекстФайла,ИнформацияОПачке)=0 тогда
			Возврат;
		КонецЕсли;	
		
		//Обработка документов файла
		ОбластьАнкета = Макет.ПолучитьОбласть("Анкета");
		
		Для Н=5 по СтрЧислоСтрок(ТекстФайла) цикл
			//Прочитаем запись из файла
			СтрокаФайла = СтрПолучитьСтроку(ТекстФайла,Н);
			Запись = ПроцедурыПерсонифицированогоУчета.ПолучитьСтруктуруЗаписи(ТаблицаФорматаЗаписи);
			СтрОшибка = "";
			Если НЕ ПроцедурыПерсонифицированогоУчета.РазложитьСтрокуВСтруктуруЗаписи(СтрокаФайла,"АНКТ",ТаблицаФорматаЗаписи,Запись,СтрОшибка) тогда
				Сообщить("Ошибка в строке файла № "+Н+": "+СтрОшибка);
				Возврат;
			КонецЕсли;	
			
			ОбластьАнкета.Параметры.ДатаЗаполнения					= 	"Дата заполнения "+ПроцедурыПерсонифицированогоУчета.ДатаВОтчет(Запись.ДатаЗаполнения);
			ОбластьАнкета.Параметры.Фамилия 						= Запись.Фамилия; 
			ОбластьАнкета.Параметры.Имя 							= Запись.Имя; 
			ОбластьАнкета.Параметры.Отчество 						= Запись.Отчество; 
			ОбластьАнкета.Параметры.Пол 							= Запись.Пол+"     (м/ж)"; 
			ОбластьАнкета.Параметры.ДатаРождения 					= ПроцедурыПерсонифицированогоУчета.ДатаВОтчет(Запись.СтандартнаяДатаРождения); 
			
			//Место рождения
			ОбластьАнкета.Параметры.МестоРожденияТип 				= 	?(Запись.ТипМестаРождения = "ОСОБОЕ", "особое", "");
			ОбластьАнкета.Параметры.МестоРожденияГород 				= 	Запись.МестоРожденияНаселенныйПункт;
			ОбластьАнкета.Параметры.МестоРожденияРайон 				= 	Запись.МестоРожденияРайон;
			ОбластьАнкета.Параметры.МестоРожденияОбласть			= 	Запись.МестоРожденияОбласть;
			ОбластьАнкета.Параметры.МестоРожденияСтрана			 	= 	Запись.МестоРожденияСтрана;
			
			ОбластьАнкета.Параметры.Гражданство 					= 	Запись.Гражданство;
			
			//Паспортные данные
			НаименованиеДокумента 									= 	Запись.ДокументНаименование;
			Серия1 													= 	Запись.ДокументСерияРимскиеЦифры;
			Серия2 													= 	Запись.ДокументСерияРусскиеБуквы;
			
			СерияНомер = Серия1 +?( СокрЛП(НаименованиеДокумента) 	= ВРЕГ("паспорт РБ"), " ", ?( СокрЛП(НаименованиеДокумента) = ВРЕГ("паспорт"), "-", "") ) + Серия2 +",  " + Формат(Запись.ДокументНомер,"ЧГ=0");
			
			ОбластьАнкета.Параметры.НаименованиеДокумента		= 	НаименованиеДокумента;
			ОбластьАнкета.Параметры.СерияНомер			 		= 	СерияНомер;
			ОбластьАнкета.Параметры.ДатаВыдачи 					= 	ПроцедурыПерсонифицированогоУчета.ДатаВОтчет(Запись.ДокументДатаВыдачи);
			ОбластьАнкета.Параметры.КемВыдан 					= 	Запись.ДокументКемВыдан;
			
			//Адреса
			ОбластьАнкета.Параметры.АдресРегистрации 			=	ПроцедурыПерсонифицированогоУчета.ПредставлениеАдресадляПФР(Запись.АдресРегистрации,0,"");
			ОбластьАнкета.Параметры.АдресФактический 			= 	ПроцедурыПерсонифицированогоУчета.ПредставлениеАдресадляПФР(Запись.АдресФактический,0,"");
			ОбластьАнкета.Параметры.Телефоны 					= 	Запись.Телефоны;
			
			ДокументРезультат.Вывести(ОбластьАнкета);
			ДокументРезультат.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЦикла;	
		
		РаботаСДиалогами.НапечататьДокумент(ДокументРезультат,1,Ложь,"Анкета застрахованного лица АДВ-1");
		
		//Печать описи документов
		ДокументОписи = Новый ТабличныйДокумент;
		ДокументОписи.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АнкетаЗастрахованногоЛица_АДВ_6";
		ОтветственныеЛица = РегламентированнаяОтчетность.ОтветственныеЛицаОрганизаций(Организация,Дата,Ответственный.ФизЛицо);
		ПроцедурыПерсонифицированогоУчета.ВывестиОписьАДВ6(ДокументОписи,ИнформацияОПачке,ОтветственныеЛица);
		РаботаСДиалогами.НапечататьДокумент(ДокументОписи,1,Ложь,"Опись документов АДВ-6");
	КонецПроцедуры
	
#КонецЕсли

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ДЛЯ ОБЕСПЕЧЕНИЯ ПРОВЕДЕНИЯ ДОКУМЕНТА

// Формирует запрос по шапке документа
//
// Параметры: 
//  Режим - режим проведения
//
// Возвращаемое значение:
//  Результат запроса
//
Функция СформироватьЗапросПоШапке()
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка" , Ссылка);
	
	Запрос.Текст = "
	|Выбрать 
	|	Дата, 
	|	Номер, 
	|	Организация,
	|	ДатаНачала КАК ПериодРегистрации, //ДатаРегистрации
	|	Ответственный,
	| 	Ссылка 
	|Из 
	|	Документ." + Метаданные().Имя + "
	|Где 
	|	Ссылка = &ДокументСсылка
	|";
	
	Возврат Запрос.Выполнить();
	
КонецФункции // СформироватьЗапросПоШапке()

// Выбирает данные, необходимые для заполнения утвержденных форм как из спр-ка
//  физлиц, так и из соотв. регистров сведений
//
// Параметры: 
//  Нет
//
// Возвращаемое значение:
//  Результат запроса к данным работников документа.
//
Функция	СформироватьЗапросПоРаботникиОрганизации()
	
	Запрос = Новый Запрос;
	
	// Установим параметры запроса
	Запрос.УстановитьПараметр("ДокументСсылка" , Ссылка);
	Запрос.УстановитьПараметр("ДатаАктуальности" , Дата);
	Запрос.УстановитьПараметр("ВидАдресаРегистрации" , Справочники.ВидыКонтактнойИнформации.ЮрАдресФизЛица);
	Запрос.УстановитьПараметр("ВидАдресаФактический" , Справочники.ВидыКонтактнойИнформации.ФактАдресФизЛица);
	Запрос.УстановитьПараметр("ВидТелефонаДомашний" , Справочники.ВидыКонтактнойИнформации.ТелефонФизЛица);
	Запрос.УстановитьПараметр("ОбъединятьОсновные" , ОбъединятьОсновные); //Аверсон 24.07.2023 КВВ СВФР-011153 (пункт 1)
	
	Запрос.Текст = "
	//Аверсон 24.07.2023 КВВ СВФР-011153 (пункт 1) (
	|ВЫБРАТЬ 
	|АнкетаСотр.Сотрудник.Код КАК ТН,
	|АнкетаСотр.Сотрудник,
	|АнкетаСотр.ФизЛицо,
	|РаботникиОрганизацийПрием.Период КАК ДатаПриема
	|ПОМЕСТИТЬ ВтСотрудникПрием
	|ИЗ Документ.СведенияОЗаработкеРаботниковДПУПоСотр2024.РаботникиОрганизации КАК АнкетаСотр
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизацийПрием
	|ПО АнкетаСотр.Сотрудник = РаботникиОрганизацийПрием.Сотрудник
	|И РаботникиОрганизацийПрием.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)
	|ГДЕ
	|АнкетаСотр.Ссылка = &ДокументСсылка
	|И АнкетаСотр.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
	|;
	|ВЫБРАТЬ 
	|ВтСотрудникПрием.ФизЛицо,
	|МАКСИМУМ(ВтСотрудникПрием.ДатаПриема) КАК ДатаПриема
	|ПОМЕСТИТЬ ВтФизЛицоПрием
	|ИЗ ВтСотрудникПрием
	|СГРУППИРОВАТЬ ПО
	|ВтСотрудникПрием.ФизЛицо
	|;
	|ВЫБРАТЬ 
	|ВтСотрудникПрием.Сотрудник
	|ПОМЕСТИТЬ ВтОсновныеСотрудники
	|ИЗ ВтСотрудникПрием
	|ЛЕВОЕ СОЕДИНЕНИЕ ВтФизЛицоПрием
	|ПО ВтСотрудникПрием.ФизЛицо = ВтФизЛицоПрием.ФизЛицо
	|И ВтСотрудникПрием.ДатаПриема = ВтФизЛицоПрием.ДатаПриема 
	|ГДЕ  
	|ВтСотрудникПрием.ДатаПриема = ВтФизЛицоПрием.ДатаПриема
	|;
	//Аверсон 24.07.2023 КВВ СВФР-011153 (пункт 1) )
	
	//Островская Татьяна 25.10.2012 № 15958
	//+ СВЭЙ КДЯ СВФР-004561 06.08.19
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	МИНИМУМ( НомерСтроки ) КАК НомерСтроки,
	|	ФизЛицо,
	|	Сотрудник,
	|	ФизЛицоНаименование,
	|	ЛичныйНомер,
	|	ДокументСерия,
	|	ДокументНомер,
	|	ДокументДатаВыдачи,
	|	ДокументКемВыдан,
	|	АдресРегистрации,
	|	ИндексРегистрации,
	|	Телефоны,
	|	Фамилия,
	|	Имя,
	|	Отчество,
	|	Пол,
	|	ДатаПриема,
	|	ДатаУвольнения,
	|	ДатаРождения,
	|	ГородРождения,
	|	Страна,
	|	РайонРождения,
	|	СтранаРождения,
	|	ОбластьРождения,
	|	Категория,
	|	ВидДоговора
	|ИЗ
	|(
	//- СВЭЙ КДЯ СВФР-004561 06.08.19
	|ВЫБРАТЬ
	|	АнкетаЗастрахованногоЛицаРаботники.НомерСтроки КАК НомерСтроки,
	|	АнкетаЗастрахованногоЛицаРаботники.Сотрудник КАК Сотрудник,
	|	АнкетаЗастрахованногоЛицаРаботники.ФизЛицо КАК ФизЛицо,
	|	АнкетаЗастрахованногоЛицаРаботники.ФизЛицо.Наименование КАК ФизЛицоНаименование,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ЛичныйНомер ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ЛичныйНомер
	|	КОНЕЦ КАК ЛичныйНомер,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ПаспортСерия ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ПаспортСерия
	|	КОНЕЦ КАК ДокументСерия,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ПаспортНомер ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ПаспортНомер
	|	КОНЕЦ КАК ДокументНомер,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ПаспортДатавыдачи ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ПаспортДатавыдачи
	|	КОНЕЦ КАК ДокументДатаВыдачи,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ПаспортКемВыдан ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ПаспортКемВыдан
	|	КОНЕЦ КАК ДокументКемВыдан,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.АдресРегистрации ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.АдресРегистрации
	|	КОНЕЦ КАК АдресРегистрации,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ИндексРегистрации ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ИндексРегистрации
	|	КОНЕЦ КАК ИндексРегистрации,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.Телефоны ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.Телефоны
	|	КОНЕЦ КАК Телефоны,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.Фамилия ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.Фамилия
	|	КОНЕЦ КАК Фамилия,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.Имя ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.Имя
	|	КОНЕЦ КАК Имя,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.Отчество ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.Отчество
	|	КОНЕЦ КАК Отчество,
	|	АнкетаЗастрахованногоЛицаРаботники.Пол,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ДатаПриема ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ДатаПриема
	|	КОНЕЦ КАК ДатаПриема,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ДатаУвольнения ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ДатаУвольнения
	|	КОНЕЦ КАК ДатаУвольнения,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ДатаРождения ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ДатаРождения
	|	КОНЕЦ КАК ДатаРождения,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ГородРождения ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ГородРождения
	|	КОНЕЦ КАК ГородРождения,
	|	АнкетаЗастрахованногоЛицаРаботники.Гражданство.Наименование КАК Страна,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.РайонРождения ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.РайонРождения
	|	КОНЕЦ КАК РайонРождения,
	|	АнкетаЗастрахованногоЛицаРаботники.СтранаРождения,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.ОбластьРождения ЕСТЬ NULL 
	|			ТОГДА "" ""
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.ОбластьРождения
	|	КОНЕЦ КАК ОбластьРождения,
	|	ВЫБОР
	|		КОГДА АнкетаЗастрахованногоЛицаРаботники.Категория.КодПФР ЕСТЬ NULL 
	|			ТОГДА """"
	|		ИНАЧЕ АнкетаЗастрахованногоЛицаРаботники.Категория.КодПФР
	|	КОНЕЦ КАК Категория,
	//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
	//|	АнкетаЗастрахованногоЛицаРаботники.ВидДоговора
	//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
	//+ СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
	|	ВЫБОР КОГДА АнкетаЗастрахованногоЛицаРаботники.ВидДоговора = ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.Подряда ) 
	|			ТОГДА АнкетаЗастрахованногоЛицаРаботники.ВидДоговора
	|         	ИНАЧЕ ЗНАЧЕНИЕ( Перечисление.ВидыДоговоровСФизЛицами.ПустаяСсылка )
	|   КОНЕЦ КАК ВидДоговора
	//- СВЭЙ КДЯ 29.10.19 СВФР-004631 ( Пункт 50. )
	|ИЗ
	|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр2024.РаботникиОрганизации КАК АнкетаЗастрахованногоЛицаРаботники
	
	//Аверсон 24.07.2023 КВВ СВФР-011153 (пункт 1) (
	|ЛЕВОЕ СОЕДИНЕНИЕ ВтОсновныеСотрудники
	|ПО АнкетаЗастрахованногоЛицаРаботники.Сотрудник = ВтОсновныеСотрудники.Сотрудник
	//Аверсон 24.07.2023 КВВ СВФР-011153 (пункт 1) )
	
	|ГДЕ
	|	АнкетаЗастрахованногоЛицаРаботники.Ссылка = &ДокументСсылка
	
	//Аверсон 24.07.2023 КВВ СВФР-011153 (пункт 1) (
	|И (ВЫБОР КОГДА &ОбъединятьОсновные = ИСТИНА И АнкетаЗастрахованногоЛицаРаботники.Сотрудник.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ОсновноеМестоРаботы)
	|ТОГДА НЕ ВтОсновныеСотрудники.Сотрудник ЕСТЬ NULL
	|ИНАЧЕ ИСТИНА
	|КОНЕЦ )
	//Аверсон 24.07.2023 КВВ СВФР-011153 (пункт 1) )
	
	|
	//+ СВЭЙ КДЯ СВФР-004561 06.08.19
	|) КАК Анкеты
	|
	|СГРУППИРОВАТЬ ПО
	|	ФизЛицо,
	|	Сотрудник,
	|	ФизЛицоНаименование,
	|	ЛичныйНомер,
	|	ДокументСерия,
	|	ДокументНомер,
	|	ДокументДатаВыдачи,
	|	ДокументКемВыдан,
	|	АдресРегистрации,
	|	ИндексРегистрации,
	|	Телефоны,
	|	Фамилия,
	|	Имя,
	|	Отчество,
	|	Пол,
	|	ДатаПриема,
	|	ДатаУвольнения,
	|	ДатаРождения,
	|	ГородРождения,
	|	Страна,
	|	РайонРождения,
	|	СтранаРождения,
	|	ОбластьРождения,
	|	Категория,
	|	ВидДоговора
	//- СВЭЙ КДЯ СВФР-004561 06.08.19
	|
	|УПОРЯДОЧИТЬ ПО
	|	НомерСтроки
	|";
	//Островская Татьяна 25.10.2012 № 15958
	Возврат Запрос.Выполнить();
	
КонецФункции

// Проверяет правильность заполнения шапки документа.
// Если какой-то из реквизтов шапки, влияющий на проведение не заполнен или
// заполнен не корректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса по шапке,
// все проверяемые реквизиты должны быть включены в выборку по шапке.
//
// Параметры: 
//  ВыборкаПоШапкеДокумента	- выборка из результата запроса по шапке документа,
//  Отказ 					- флаг отказа в проведении.
//	Заголовок				- Заголовок для сообщений об ошибках проведения
//
Процедура ПроверитьЗаполнениеШапки(ВыборкаПоШапкеДокумента, Отказ, Заголовок)
	
	Если Не ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.Организация) Тогда
		ОбщегоНазначения.СообщитьОбОшибке("Не указана организация, которая подает сведения!", Отказ, Заголовок);
	КонецЕсли;
	Если НЕ ЗначениеЗаполнено(ВыборкаПоШапкеДокумента.Ответственный) Тогда
		ОбщегоНазначения.СообщитьОбОшибке("Не указано ответственное лицо!", Отказ, Заголовок);
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеШапки()

// Проверяет правильность заполнения реквизитов в строке ТЧ "РаботникиОрганизации" документа.
// Если какой-то из реквизтов, влияющий на проведение не заполнен или
// заполнен не корректно, то выставляется флаг отказа в проведении.
// Проверка выполняется по выборке из результата запроса по строке ТЧ документа,
// все проверяемые реквизиты должны быть включены в выборку.
//
// Параметры: 
//  ВыборкаПоШапкеДокумента		- выборка из результата запроса по шапке документа,
//  ВыборкаПоСтрокамДокумента	- спозиционированная на определеной строке выборка 
//  							  из результата запроса по работникам, 
//  Отказ 						- флаг отказа в проведении.
//	Заголовок				- Заголовок для сообщений об ошибках проведения
//
Процедура ПроверитьЗаполнениеСтрокиРаботникаОрганизации(ВыборкаПоШапкеДокумента, ВыборкаПоСтрокамДокумента, Фамилия, Имя, Отказ ,Заголовок)
	
	СтрокаНачалаСообщенияОбОшибке = "В строке № """+ СокрЛП(ВыборкаПоСтрокамДокумента.НомерСтроки) +
	""" табл. части ""Работники организации"": ";
	// ФизЛицо
	Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ФизЛицо) Тогда
		ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не выбран работник!", Отказ ,Заголовок);
	Иначе	
		СтрокаНачалаСообщенияОбОшибке = СтрокаНачалаСообщенияОбОшибке + ВыборкаПоСтрокамДокумента.ФизЛицо + " ";
		
		Если ЗначениеЗаполнено(СтрЗаменить(ВыборкаПоСтрокамДокумента.СтраховойНомерПФР,"-","")) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Уже имеет страховой номер!", Отказ ,Заголовок);
		КонецЕсли;
		Если Не ЗначениеЗаполнено(Фамилия) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задана фамилия!", Отказ ,Заголовок);
		КонецЕсли;	
		Если Не ЗначениеЗаполнено(Имя) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задано имя!", Отказ ,Заголовок);
		КонецЕсли;	
		Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.Пол) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задан пол!", Отказ ,Заголовок);
		КонецЕсли;	
		Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДатаРождения) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задана дата рождения!", Отказ ,Заголовок);
		Иначе
			Если ВыборкаПоСтрокамДокумента.ДатаРождения > Дата тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Дата рождения не может быть больше даты подачи сведений!", Отказ ,Заголовок);
			КонецЕсли;	 
		КонецЕсли;	
		
		Если СокрЛП(СтрЗаменить(ВыборкаПоСтрокамДокумента.МестоРождения,",","")) = "" 
			или СокрЛП(СтрЗаменить(ВыборкаПоСтрокамДокумента.МестоРождения,",","")) = "0" Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не указано место рождения!", Отказ ,Заголовок);
		КонецЕсли; 
		
		//Паспортные данные
		Если ВыборкаПоСтрокамДокумента.ДокументВид = NULL Тогда
			
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не указаны паспортные данные!", Отказ ,Заголовок);
			
		Иначе
			
			//Проверка реквизитов паспортных данных
			Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДокументВид) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задан вид документа, удостоверяющего личность!", Отказ ,Заголовок);
			КонецЕсли;	
			
			Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДокументДатаВыдачи) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задана дата выдачи документа, удостоверяющего личность!", Отказ ,Заголовок);
			Иначе
				Если (ВыборкаПоСтрокамДокумента.ДатаРождения > ВыборкаПоСтрокамДокумента.ДокументДатаВыдачи) Тогда
					ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Дата рождения не должна превышать дату выдачи документа, удостоверяющего личность!", Отказ ,Заголовок);
				КонецЕсли;
			КонецЕсли;	
			
			Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДокументСерия) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задана серия документа, удостоверяющего личность!", Отказ ,Заголовок);
			КонецЕсли;
			
			Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.ДокументНомер) Тогда
				ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задан номер документа, удостоверяющего личность!", Отказ ,Заголовок);
			КонецЕсли;
		КонецЕсли; 
		
		// Проверка адреса регистрации и проживания
		Если Не ЗначениеЗаполнено(ВыборкаПоСтрокамДокумента.АдресРегистрации) Тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- Не задан адрес регистрации (юридический адрес)!", Отказ ,Заголовок);
		КонецЕсли;	
		Если НЕ РегламентированнаяОтчетность.АдресСоответствуетТребованиям(УправлениеКонтактнойИнформацией.РазложитьАдрес(ВыборкаПоСтрокамДокумента.АдресРегистрации)) тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- В адресе регистрации присутствуют латинские или недопустимые символы!", Отказ ,Заголовок);
		КонецЕсли;
		Если НЕ РегламентированнаяОтчетность.АдресСоответствуетТребованиям(УправлениеКонтактнойИнформацией.РазложитьАдрес(ВыборкаПоСтрокамДокумента.АдресФактический)) тогда
			ОбщегоНазначения.СообщитьОбОшибке(СтрокаНачалаСообщенияОбОшибке + "- В фактическом адресе проживания присутствуют латинские или недопустимые символы!", Отказ ,Заголовок);
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры // ПроверитьЗаполнениеСтрокиРаботникаОрганизации()

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ

Процедура ОбработкаПроведения(Отказ, Режим)
	//При проведении файл формируем заново 
	//ТекстФайла = "";
	//#Если Клиент Тогда
	//	
	//	ТекстФайла = СформироватьВыходнойФайл1(Отказ);//О.Т.(К) 24.03.2015
	//#КонецЕсли
	//
	//Если Отказ тогда
	//	Возврат;
	//КонецЕсли;	 
	
	//Сохраним сформированный файл сведений в регистре сведений
	//Запись = Движения["АрхивДанныхРегламентированнойОтчетности"].Добавить();
	//Запись.Объект = Ссылка;
	//Запись.ОписаниеДанных = "Файл-пачка форм ПУ-3";
	//Запись.Данные = ТекстФайла; 
КонецПроцедуры	

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	
	КраткийСоставДокумента = ПроцедурыУправленияПерсоналом.ЗаполнитьКраткийСоставДокумента(РаботникиОрганизации,,"ФизЛицо");
	
КонецПроцедуры


Функция ПолучитьТаблицуПособий(ЗапросПособие,Сотрудник = Неопределено,Месяц = Неопределено)//О.Т. Аверсон 25.04.2019 № 4274
	
	ЗапросПособие.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	ДатаНач = ДатаНачала;
	Если Месяц = Неопределено Тогда
		ДатаНач = ДатаНачала;
		ДатаКон = ДатаОкончания;
	иначе
		ДатаНач = Месяц;
		ДатаКон = Месяц; 
	КонецЕсли;
	
	
	Пока ДатаНач <= ДатаКон Цикл 
		
		
		СписокВидРасчета = Новый СписокЗначений;
		СписокВидРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоДням);
		СписокВидРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ОкладПоЧасам);
		СписокВидРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифДневной);
		СписокВидРасчета.Добавить(ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ТарифЧасовой);
		ЗапросПособие.УстановитьПараметр("ВидРасчета" , СписокВидРасчета);
		ЗапросПособие.УстановитьПараметр("ПериодВзаиморасчетов",ДатаНач); 		
		ЗапросПособие.УстановитьПараметр("ДатаПодачиСведений",ДатаОкончания);
		ЗапросПособие.УстановитьПараметр("Сотрудник",Сотрудник);
		ЗапросПособие.УстановитьПараметр("ВидРасчета" , СписокВидРасчета);
		ЗапросПособие.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
		//ЗапросПособие.УстановитьПараметр("Результат" , ВыборкаПоДоговорам.Пособия);
		ЗапросПособие.УстановитьПараметр("ДоходФСЗН", Перечисления.ДоходыФСС_НС.Облагается);
		
		//О.Т. Аверсон 28.02.2019 № 3224
		СпособыПособия = Новый СписокЗначений;
		СпособыПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
		для Каждого стрПособ из Справочники.ГруппыРасчетов.ДопПособияДляПУ3.Основные Цикл 
			СпособыПособия.Добавить(стрПособ.ВидРасчета);
		КонецЦикла;  
		//О.Т. Аверсон 28.02.2019 № 3224
		
		ЗапросПособие.УстановитьПараметр("СпособРасчета" , СпособыПособия);//О.Т. Аверсон 22.08.2018 № 2335
		СтрокаМес = Строка(Месяц(ДатаНач));
		Если ВыгрузкаДоговоровПодрядаБезОграничения и ДогПодряда Тогда 
			ЗапросПособие.Текст = 
			"ВЫБРАТЬ
			//Аверсон ЕАЕ 21.07.2021 СВФР-007783
			|   ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			//Аверсон СВФР-007783
			|	СУММА(ВЫБОР
			|			КОГДА ЕСТЬNULL(ВЫБОР
			|						КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало < РаботникиОрганизацийСрезПоследнихПрием.Период
			|							ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			|						ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало
			|					КОНЕЦ, 1) <> 1
			|				ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.Результат
			|			ИНАЧЕ 0
			|		КОНЕЦ) КАК Пособия,
			|	ВЫБОР
			|		КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало < РаботникиОрганизацийСрезПоследнихПрием.Период
			|			ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			|		ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало
			|	КОНЕЦ КАК ПериодДействияНачало,
			|	ВЫБОР
			|		КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец > РаботникиОрганизацийСрезПоследнихУвольн.Период
			|			ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			|		ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец
			|	КОНЕЦ КАК ПериодДействияКонец,
			|	НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) КАК ПериодВзаиморасчетов,
			|	ДополнительныеНачисленияРаботниковОрганизаций.НомерДоговора,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ДатаДоговора
			| ПОМЕСТИТь ВТДанныеОПособии"+СтрокаМес+"
			
			|ИЗ
			|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ПериодВзаиморасчетов, Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию) КАК РаботникиОрганизацийСрезПоследнихПрием
			|	ПО ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = РаботникиОрганизацийСрезПоследнихПрием.Сотрудник.Физлицо
			|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ПериодВзаиморасчетов, Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследнихУвольн
			|	ПО ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = РаботникиОрганизацийСрезПоследнихУвольн.Сотрудник.Физлицо
			
			
			|ГДЕ
			|	НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = &ПериодВзаиморасчетов";
			Если не ОтборПоПериодуВзаиморасчетов Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации <= &ДатаПодачиСведений";
			КонецЕсли;
			ЗапросПособие.Текст = ЗапросПособие.Текст + "
			|
			//+ СВЭЙ КДЯ 11.07.19 СВФР-004424
			//|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета = &СпособРасчета";
			//- СВЭЙ КДЯ 11.07.19 СВФР-004424
			//+ СВЭЙ КДЯ 11.07.19 СВФР-004424
			|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.СпособРасчета В ( &СпособРасчета )";
			//- СВЭЙ КДЯ 11.07.19 СВФР-004424
			Если ЗначениеЗаполнено(Сотрудник) Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник";
			КонецЕсли;
			ЗапросПособие.Текст = ЗапросПособие.Текст + "
			|
			|СГРУППИРОВАТЬ ПО
			//Аверсон ЕАЕ 21.07.2021 СВФР-007783
			|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			//Аверсон СВФР-007783
			|	ВЫБОР
			|		КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало < РаботникиОрганизацийСрезПоследнихПрием.Период
			|			ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			|		ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало
			|	КОНЕЦ,
			|	ВЫБОР
			|		КОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец > РаботникиОрганизацийСрезПоследнихУвольн.Период
			|			ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			|		ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец
			|	КОНЕЦ,
			|	НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ),
			|	ДополнительныеНачисленияРаботниковОрганизаций.НомерДоговора,
			|	ДополнительныеНачисленияРаботниковОрганизаций.ДатаДоговора
			
			|";
			//|УПОРЯДОЧИТЬ ПО
			//|	ПериодДействияНачало";
			
		иначе
			
			ЗапросПособие.Текст =  
			"	ВЫБРАТЬ
			|			ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
			|			ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
			|			ОсновныеНачисленияРаботниковОрганизаций.Организация КАК Организация,
			|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ПериодДействияНачало,
			|			ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
			|			СУММА(ВЫБОР
			|					КОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
			|							И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА ВЫРАЗИТЬ(ОсновныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
			|					ИНАЧЕ ОсновныеНачисленияРаботниковОрганизаций.Результат
			|				КОНЕЦ + ЕСТЬNULL(ВложенныйЗапрос.Результат, 0)) КАК Результат,
			|			ВЫБОР
			|				КОГДА ЕСТЬNULL(ВложенныйЗапрос.ПериодДействияКонец, 1) = 1
			|					ТОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец
			|				ИНАЧЕ ВложенныйЗапрос.ПериодДействияКонец
			|			КОНЕЦ КАК ПериодДействияКонец,
			|			ВложенныйЗапрос.ПериодДействияНачало КАК ПериодДействияНачало1,
			|			ВложенныйЗапрос.ПериодДействияКонец КАК ПериодДействияКонец1,
			|			ВложенныйЗапрос.Результат КАК Результат1
			|		ПОМЕСТИТЬ ВТОсновные"+СтрокаМес+"
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			|				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ПериодДействияНачало,
			|					ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
			|					СУММА(ВЫБОР
			|							КОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
			|									И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало >= ДАТАВРЕМЯ(2016, 7, 1)
			|								ТОГДА ВЫРАЗИТЬ(ОсновныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
			|							ИНАЧЕ ОсновныеНачисленияРаботниковОрганизаций.Результат
			|						КОНЕЦ) КАК Результат,
			|					ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ПериодДействияКонец,
			|					ОсновныеНачисленияРаботниковОрганизаций.Регистратор.ПервичныйБольничныйЛист КАК РегистраторПервичныйБольничныйЛист
			|				ИЗ
			|					РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			|				ГДЕ
			|					НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) = &ПериодВзаиморасчетов
			|				
			|				СГРУППИРОВАТЬ ПО
			|					ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
			|					ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|					ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец,
			|					ОсновныеНачисленияРаботниковОрганизаций.Регистратор.ПервичныйБольничныйЛист) КАК ВложенныйЗапрос
			|				ПО ОсновныеНачисленияРаботниковОрганизаций.Регистратор = ВложенныйЗапрос.РегистраторПервичныйБольничныйЛист
			|					И (ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец, ДЕНЬ), ДЕНЬ, 1) = ВложенныйЗапрос.ПериодДействияНачало)
			|		ГДЕ
			|			НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) = &ПериодВзаиморасчетов
			|			И ВложенныйЗапрос.Результат > 0";
			Если ЗначениеЗаполнено(Сотрудник) Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник";
			КонецЕсли;
			ЗапросПособие.Текст = ЗапросПособие.Текст + "
			
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
			|			ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
			|			ОсновныеНачисленияРаботниковОрганизаций.Организация,
			|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
			|			ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|			ВложенныйЗапрос.ПериодДействияНачало,
			|			ВложенныйЗапрос.ПериодДействияКонец,
			|			ВложенныйЗапрос.Результат,
			|			ВЫБОР
			|				КОГДА ЕСТЬNULL(ВложенныйЗапрос.ПериодДействияКонец, 1) = 1
			|					ТОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец
			|				ИНАЧЕ ВложенныйЗапрос.ПериодДействияКонец
			|			КОНЕЦ
			|		;
			
			|		////////////////////////////////////////////////////////////////////////////////
			|		ВЫБРАТЬ
			|			ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
			|			ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
			|			ОсновныеНачисленияРаботниковОрганизаций.Организация КАК Организация,
			|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК ПериодДействияНачало,
			|			ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
			|			СУММА(ВЫБОР
			|					КОГДА ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
			|							И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА ВЫРАЗИТЬ(ОсновныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
			|					ИНАЧЕ ОсновныеНачисленияРаботниковОрганизаций.Результат
			|				КОНЕЦ) КАК Результат,
			|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК ПериодДействияКонец
			|		ПОМЕСТИТЬ ВТОсновнойБезГруппировки"+СтрокаМес+"
			|		ИЗ
			|			РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
			|		ГДЕ
			|			НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало, МЕСЯЦ) = &ПериодВзаиморасчетов";
			Если ЗначениеЗаполнено(Сотрудник) Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник";
			КонецЕсли;
			ЗапросПособие.Текст = ЗапросПособие.Текст + "
			
			|		СГРУППИРОВАТЬ ПО
			|			ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
			|			ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
			|			ОсновныеНачисленияРаботниковОрганизаций.Организация,
			|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало,
			|			ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|			ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец
			|		;
			
			|		////////////////////////////////////////////////////////////////////////////////
			|		ВЫБРАТЬ
			|			ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
			|			ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
			|			ДополнительныеНачисленияРаботниковОрганизаций.Организация КАК Организация,
			|			ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало КАК БазовыйПериодНачало,
			|			ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
			|			СУММА(ВЫБОР
			|					КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
			|							И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА ВЫРАЗИТЬ(ДополнительныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
			|					ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Результат
			|				КОНЕЦ + ЕСТЬNULL(ВложенныйЗапрос.Результат, 0)) КАК Результат,
			|			ВЫБОР
			|				КОГДА ЕСТЬNULL(ВложенныйЗапрос.БазовыйПериодКонец, 1) = 1
			|					ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец
			|				ИНАЧЕ ВложенныйЗапрос.БазовыйПериодКонец
			|			КОНЕЦ КАК БазовыйПериодКонец,
			|			ВложенныйЗапрос.БазовыйПериодНачало КАК БазовыйПериодНачало1,
			|			ВложенныйЗапрос.БазовыйПериодКонец КАК БазовыйПериодКонец1,
			|			ВложенныйЗапрос.Результат КАК Результат1
			|		ПОМЕСТИТЬ ВТДополнительные"+СтрокаМес+"
			|		ИЗ
			|			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			|					ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало КАК БазовыйПериодНачало,
			|					ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
			|					СУММА(ВЫБОР
			|							КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
			|									И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ДАТАВРЕМЯ(2016, 7, 1)
			|								ТОГДА ВЫРАЗИТЬ(ДополнительныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
			|							ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Результат
			|						КОНЕЦ) КАК Результат,
			|					ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец КАК БазовыйПериодКонец,
			|					ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ПервичныйБольничныйЛист КАК РегистраторПервичныйБольничныйЛист
			|				ИЗ
			|					РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|				ГДЕ
			|					НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = &ПериодВзаиморасчетов
			|				
			|				СГРУППИРОВАТЬ ПО
			|					ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
			|					ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|					ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец,
			|					ДополнительныеНачисленияРаботниковОрганизаций.Регистратор.ПервичныйБольничныйЛист) КАК ВложенныйЗапрос
			|				ПО ДополнительныеНачисленияРаботниковОрганизаций.Регистратор = ВложенныйЗапрос.РегистраторПервичныйБольничныйЛист
			|					И (ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец, ДЕНЬ), ДЕНЬ, 1) = ВложенныйЗапрос.БазовыйПериодНачало)
			|		ГДЕ
			|			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = &ПериодВзаиморасчетов
			|			И ВложенныйЗапрос.Результат > 0";
			Если ЗначениеЗаполнено(Сотрудник) Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник";
			КонецЕсли;
			ЗапросПособие.Текст = ЗапросПособие.Текст + "
			
			|		СГРУППИРОВАТЬ ПО
			|			ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			|			ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
			|			ДополнительныеНачисленияРаботниковОрганизаций.Организация,
			|			ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
			|			ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|			ВложенныйЗапрос.БазовыйПериодНачало,
			|			ВложенныйЗапрос.БазовыйПериодКонец,
			|			ВложенныйЗапрос.Результат,
			|			ВЫБОР
			|				КОГДА ЕСТЬNULL(ВложенныйЗапрос.БазовыйПериодКонец, 1) = 1
			|					ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец
			|				ИНАЧЕ ВложенныйЗапрос.БазовыйПериодКонец
			|			КОНЕЦ
			|		;
			
			|		////////////////////////////////////////////////////////////////////////////////
			|		ВЫБРАТЬ
			|			ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
			|			ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо КАК ФизЛицо,
			|			ДополнительныеНачисленияРаботниковОрганизаций.Организация КАК Организация,
			|			ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало КАК БазовыйПериодНачало,
			|			ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
			|			СУММА(ВЫБОР
			|					КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < ДАТАВРЕМЯ(2016, 7, 1)
			|							И ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало >= ДАТАВРЕМЯ(2016, 7, 1)
			|						ТОГДА ВЫРАЗИТЬ(ДополнительныеНачисленияРаботниковОрганизаций.Результат / 10000 КАК ЧИСЛО(15, 2))
			|					ИНАЧЕ ДополнительныеНачисленияРаботниковОрганизаций.Результат
			|				КОНЕЦ) КАК Результат,
			|			ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец КАК БазовыйПериодКонец
			|		ПОМЕСТИТЬ ВТДополнительныеБезГруппировки"+СтрокаМес+"
			|		ИЗ
			|			РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
			|		ГДЕ
			|			НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало, МЕСЯЦ) = &ПериодВзаиморасчетов";
			Если ЗначениеЗаполнено(Сотрудник) Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник";
			КонецЕсли;
			ЗапросПособие.Текст = ЗапросПособие.Текст + "
			
			|		СГРУППИРОВАТЬ ПО
			|			ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
			|			ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
			|			ДополнительныеНачисленияРаботниковОрганизаций.Организация,
			|			ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодНачало,
			|			ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
			|			ДополнительныеНачисленияРаботниковОрганизаций.БазовыйПериодКонец
			|		;
			
			|		////////////////////////////////////////////////////////////////////////////////
			|		ВЫБРАТЬ
			|			ЕСНСведенияОДоходах.Сотрудник КАК Сотрудник,
			|			ЕСНСведенияОДоходах.ФизЛицо КАК ФизЛицо,
			|			ЕСНСведенияОДоходах.ПериодВзаиморасчетов КАК ПериодВзаиморасчетов,
			|			ЕСНСведенияОДоходах.ВидРасчета КАК ВидРасчета
			|		ПОМЕСТИТЬ ВТДоходыОклад"+СтрокаМес+"
			|		ИЗ
			|			РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			|		ГДЕ
			|			ЕСНСведенияОДоходах.ВидРасчета В(&ВидРасчета)
			|			И НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = &ПериодВзаиморасчетов";
			Если ЗначениеЗаполнено(Сотрудник) Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ЕСНСведенияОДоходах.Сотрудник = &Сотрудник";
			КонецЕсли;
			ЗапросПособие.Текст = ЗапросПособие.Текст + "
			|		;
			
			
			
			
			
			|	ВЫБРАТЬ
			|	ЕСНСведенияОДоходах.Сотрудник,
			|	СУММА(ВЫБОР
			|			КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН 
			|					или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
			|					И ЕСТЬNULL(ВЫБОР
			|							КОГДА Основные.ПериодДействияНачало < РаботникиОрганизацийСрезПоследнихПрием.Период
			|								ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			|							ИНАЧЕ ЕСТЬNULL(Основные.ПериодДействияНачало, ОсновнойБезГруппировки.ПериодДействияНачало)
			|						КОНЕЦ, 1) <> 1
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			//|						или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			|                   ) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
			//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
			|				ТОГДА ЕСНСведенияОДоходах.Результат
			|			ИНАЧЕ 0
			|		КОНЕЦ) КАК Пособия,
			|	ВЫБОР
			|		КОГДА Основные.ПериодДействияНачало < РаботникиОрганизацийСрезПоследнихПрием.Период
			|			ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			|		ИНАЧЕ ЕСТЬNULL(ЕСТЬNULL(Основные.ПериодДействияНачало, ОсновнойБезГруппировки.ПериодДействияНачало), ЕСНСведенияОДоходах.ПериодВзаиморасчетов)
			|	КОНЕЦ КАК ПериодДействияНачало,
			|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов,
			|	СУММА(ВЫБОР
			|			КОГДА ЕСНСведенияОДоходах.ВидРасчета.КодДоходаЕСН <> &ДоходБольничныйФСЗН 
			|				ТОГДА ЕСНСведенияОДоходах.Результат иначе 0 конец) КАК Выплаты,
			|	ВЫБОР КОГДА Основные.ПериодДействияКонец > РаботникиОрганизацийСрезПоследнихУвольн.Период
			|			ИЛИ Дополнительные.БазовыйПериодКонец > РаботникиОрганизацийСрезПоследнихУвольн.Период
			|		ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			
			//Аверсон 02.05.2023 КВВ СВФР-010759 (
			//|	ИНАЧЕ ЕСТЬNULL(ЕСТЬNULL(ЕСТЬNULL(Основные.ПериодДействияКонец, ОсновнойБезГруппировки.ПериодДействияКонец), ЕстьNull(Дополнительные.БазовыйПериодКонец,ДополнительныеБезГруппировки.БазовыйПериодКонец)), КОНЕЦПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ))
			|	ИНАЧЕ ЕСТЬNULL(ЕСТЬNULL(ЕСТЬNULL(Основные.ПериодДействияКонец, ОсновнойБезГруппировки.ПериодДействияКонец), ЕстьNull(Дополнительные.БазовыйПериодКонец,ДополнительныеБезГруппировки.БазовыйПериодКонец)), КОНЕЦПЕРИОДА(ЕСНСведенияОДоходах.ПериодКонец, ДЕНЬ))
			//Аверсон 02.05.2023 КВВ СВФР-010759 )
			
			|	КОНЕЦ как ПериодДействияКонец, //О.Т. Аверсон 02.04.2019 № 4187
			|	ОсновнойБезГруппировки.ПериодДействияНачало КАК ПериодДействияНачало1
			|	ПОМЕСТИТЬ ВТДанныеОПособии"+СтрокаМес+"
			
			|ИЗ
			|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТДоходыОклад"+СтрокаМес+" КАК СведДоходыОклад
			|		ПО ЕСНСведенияОДоходах.Сотрудник = СведДоходыОклад.Сотрудник
			|			И (НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = НАЧАЛОПЕРИОДА(СведДоходыОклад.ПериодВзаиморасчетов, МЕСЯЦ))
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ПериодВзаиморасчетов, Регистратор ССЫЛКА Документ.ПриемНаРаботуВОрганизацию) КАК РаботникиОрганизацийСрезПоследнихПрием
			|		ПО ЕСНСведенияОДоходах.Сотрудник = РаботникиОрганизацийСрезПоследнихПрием.Сотрудник
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&ПериодВзаиморасчетов, Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций) КАК РаботникиОрганизацийСрезПоследнихУвольн
			|		ПО ЕСНСведенияОДоходах.Сотрудник = РаботникиОрганизацийСрезПоследнихУвольн.Сотрудник
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОсновные"+СтрокаМес+" КАК Основные
			|		ПО ЕСНСведенияОДоходах.Сотрудник = Основные.Сотрудник
			|			И ЕСНСведенияОДоходах.ВидРасчета = Основные.ВидРасчета
			|			И ЕСНСведенияОДоходах.Организация = Основные.Организация
			|			И ЕСНСведенияОДоходах.Результат = Основные.Результат
			|			И ЕСНСведенияОДоходах.ПериодВзаиморасчетов = Основные.ПериодДействияНачало
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОсновнойБезГруппировки"+СтрокаМес+" КАК ОсновнойБезГруппировки
			|		ПО ЕСНСведенияОДоходах.Сотрудник = ОсновнойБезГруппировки.Сотрудник
			|			И ЕСНСведенияОДоходах.ВидРасчета = ОсновнойБезГруппировки.ВидРасчета
			|			И ЕСНСведенияОДоходах.Организация = ОсновнойБезГруппировки.Организация
			|			И ЕСНСведенияОДоходах.Результат = ОсновнойБезГруппировки.Результат
			|			И ЕСНСведенияОДоходах.ПериодВзаиморасчетов = ОсновнойБезГруппировки.ПериодДействияНачало
			
			//О.Т. Аверсон 02.04.2019 № 4187
			|	ЛЕВОЕ СОЕДИНЕНИЕ ВТДополнительные"+СтрокаМес+" КАК Дополнительные
			|ПО ЕСНСведенияОДоходах.Сотрудник = Дополнительные.Сотрудник
			|	И ЕСНСведенияОДоходах.ВидРасчета = Дополнительные.ВидРасчета
			|	И ЕСНСведенияОДоходах.Организация = Дополнительные.Организация
			|	И ЕСНСведенияОДоходах.Результат = Дополнительные.Результат
			|	И ЕСНСведенияОДоходах.ПериодВзаиморасчетов = Дополнительные.БазовыйПериодНачало
			
			|	ЛЕВОЕ СОЕДИНЕНИЕ ВтДополнительныеБезГруппировки"+СтрокаМес+" КАК ДополнительныеБезГруппировки
			|ПО ЕСНСведенияОДоходах.ФизЛицо = ДополнительныеБезГруппировки.ФизЛицо
			|	И ЕСНСведенияОДоходах.ВидРасчета = ДополнительныеБезГруппировки.ВидРасчета
			|	И ЕСНСведенияОДоходах.Организация = ДополнительныеБезГруппировки.Организация
			|	И ЕСНСведенияОДоходах.Результат = ДополнительныеБезГруппировки.Результат
			|	И ЕСНСведенияОДоходах.ПериодВзаиморасчетов = ДополнительныеБезГруппировки.БазовыйПериодНачало
			
			
			//О.Т. Аверсон 02.04.2019 № 4187
			|ГДЕ
			|	НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) = &ПериодВзаиморасчетов";
			Если ЗначениеЗаполнено(Сотрудник) Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ЕСНСведенияОДоходах.Сотрудник = &Сотрудник";
			КонецЕсли;
			Если не ОтборПоПериодуВзаиморасчетов Тогда 
				ЗапросПособие.Текст = ЗапросПособие.Текст + " И ЕСНСведенияОДоходах.Период <= &ДатаПодачиСведений";
			КонецЕсли;
			ЗапросПособие.Текст = ЗапросПособие.Текст + "    
			|	
			|СГРУППИРОВАТЬ ПО
			|	ЕСНСведенияОДоходах.Сотрудник,
			|	ЕСНСведенияОДоходах.ПериодВзаиморасчетов,
			|	ОсновнойБезГруппировки.ПериодДействияНачало,
			|	ВЫБОР
			|		КОГДА Основные.ПериодДействияНачало < РаботникиОрганизацийСрезПоследнихПрием.Период
			|			ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			|		ИНАЧЕ ЕСТЬNULL(ЕСТЬNULL(Основные.ПериодДействияНачало, ОсновнойБезГруппировки.ПериодДействияНачало), ЕСНСведенияОДоходах.ПериодВзаиморасчетов)
			|	КОНЕЦ,
			|	ВЫБОР КОГДА Основные.ПериодДействияКонец > РаботникиОрганизацийСрезПоследнихУвольн.Период
			|			ИЛИ Дополнительные.БазовыйПериодКонец > РаботникиОрганизацийСрезПоследнихУвольн.Период
			|		ТОГДА РаботникиОрганизацийСрезПоследнихПрием.Период
			
			//Аверсон 02.05.2023 КВВ СВФР-010759 (
			//|	ИНАЧЕ ЕСТЬNULL(ЕСТЬNULL(ЕСТЬNULL(Основные.ПериодДействияКонец, ОсновнойБезГруппировки.ПериодДействияКонец), ЕстьNull(Дополнительные.БазовыйПериодКонец,ДополнительныеБезГруппировки.БазовыйПериодКонец)), КОНЕЦПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ))
			|	ИНАЧЕ ЕСТЬNULL(ЕСТЬNULL(ЕСТЬNULL(Основные.ПериодДействияКонец, ОсновнойБезГруппировки.ПериодДействияКонец), ЕстьNull(Дополнительные.БазовыйПериодКонец,ДополнительныеБезГруппировки.БазовыйПериодКонец)), КОНЕЦПЕРИОДА(ЕСНСведенияОДоходах.ПериодКонец, ДЕНЬ))
			//Аверсон 02.05.2023 КВВ СВФР-010759 )
			
			|	КОНЕЦ //О.Т. Аверсон 02.04.2019 № 4187
			| ";		
			
		КонецЕсли;
		
		ДатаНач = ДобавитьМесяц(ДатаНач,1);
		ЗапросПособие.Выполнить();
	КонецЦикла;
	
	Возврат ЗапросПособие;
КонецФункции


//толик

#Если Клиент Тогда
	
	Процедура ПечатьОтклонений() Экспорт
		
		мДлинаСуток = 86400;
		
		ВыборкаПоШапкеДокумента = СформироватьЗапросПоШапке().Выбрать();
		Если ВыборкаПоШапкеДокумента.Следующий()=0 тогда
			Отказ = Истина;
			Возврат ;
		КонецЕсли;	
		
		Макет = ПолучитьМакет("Макет");
		ОбластьШГруппа = Макет.ПолучитьОбласть("Шапка");
		ОбластьДетальныхЗаписей = Макет.ПолучитьОбласть("Детали");
		ДеталиОтклонения = Макет.ПолучитьОбласть("ДеталиОтклонения");
		
		ТабДок = Новый ТабличныйДокумент;
		ТабДок.Очистить();
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("ДокументСсылка" , Ссылка);
		Запрос.УстановитьПараметр("СписокОтчитывающихсяПодразделений", ВыборкаПоШапкеДокумента.Организация);
		Запрос.УстановитьПараметр("ДоходБольничныйФСЗН", Справочники.ДоходыЕСН.БольничныйИзФСЗН);
		Запрос.УстановитьПараметр("ДоходФСЗН", Перечисления.ДоходыФСС_НС.Облагается);
		Запрос.УстановитьПараметр("НачалоНП", НачалоГода(НачалоКвартала(ДатаНачала))); //О.Т. Аверсон 15.03.2018 № 1693 убрано ДобавитьМесяц,-1
		Запрос.УстановитьПараметр("КонецНП", КонецГода(ВыборкаПоШапкеДокумента.ПериодРегистрации));// последний месяц налогового периода, за который подаём сведения
		Запрос.УстановитьПараметр("ПериодВзаиморасчетов" , ДатаОкончания); //О.Т. Аверсон 23.03.2018 № 1751
		Запрос.УстановитьПараметр("ФлагПериодВзаиморасчетов" , ОтборПоПериодуВзаиморасчетов); //О.Т. Аверсон 19.04.2019 № 4121
		СпособыПособия = Новый СписокЗначений;
		СпособыПособия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
		для Каждого стрПособ из Справочники.ГруппыРасчетов.ДопПособияДляПУ3.Основные Цикл 
			СпособыПособия.Добавить(стрПособ.ВидРасчета);
		КонецЦикла;  
		//О.Т. Аверсон 28.02.2019 № 3224
		
		Запрос.УстановитьПараметр("СпособРасчета" , СпособыПособия);
		
		//О.Т. Аверсон 28.02.2019 № 3224
		ВидыРасчетаПремия = Новый СписокЗначений;
		ВидыРасчетаПремия.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПоСреднемуЗаработкуФСС);
		для Каждого стрПособ из Справочники.ГруппыРасчетов.ПремияДляПУ.Основные Цикл 
			ВидыРасчетаПремия.Добавить(стрПособ.ВидРасчета);
		КонецЦикла;  
		//О.Т. Аверсон 28.02.2019 № 3224
		
		Запрос.УстановитьПараметр("ВидРасчетаПремия" , ВидыРасчетаПремия);
		
		
		// Выборка списка физлиц, для которых надо получать доходы
		//Аверсон 14.01.2022 КВВ СВФР-008597 (
		//СписокФизлицТекст = "ВЫБРАТЬ 
		////	|	ТЧРаботникиОрганизации.ФизЛицо,
		//|	ТЧРаботникиОрганизации.Сотрудник
		//|ИЗ
		////Аверсон 13.01.2022 КВВ СВФР-008597 (
		////|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр.РаботникиОрганизации КАК ТЧРаботникиОрганизации
		//  |	Документ.СведенияОЗаработкеРаботниковДПУПоСотр.СведенияОВзносах КАК ТЧРаботникиОрганизации
		////Аверсон 13.01.2022 КВВ СВФР-008597 )
		//|
		//|ГДЕ
		//|	ТЧРаботникиОрганизации.Ссылка = &ДокументСсылка";
		//
		//СписокФизлицТекст = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(СписокФизлицТекст,"ТЧРаботникиОрганизации.Сотрудник","ТЧРаботникиОрганизации.ФизЛицо"),СписокФизлицТекст); //Аверсон 23.09.2021 КВВ СВФР-008181
		
		Если ОбъединятьОсновные ИЛИ ВсеСотрудники Тогда
			ЗапросНовый = Новый Запрос;
			ЗапросНовый.Текст = "ВЫБРАТЬ 
			|ТЧРаботникиОрганизации.ФизЛицо,
			|ТЧРаботникиОрганизации.ФизЛицо.СтраховойНомерПФР КАК СтраховойНомерПФР
			|ПОМЕСТИТЬ ВтСоСтрахНомерами
			|ИЗ Документ.СведенияОЗаработкеРаботниковДПУПоСотр2024.РаботникиОрганизации КАК ТЧРаботникиОрганизации
			|ГДЕ ТЧРаботникиОрганизации.Ссылка = &ДокументСсылка
			|;
			|ВЫБРАТЬ
			|СпрФЛ.Ссылка КАК ФизЛицо
			|ИЗ Справочник.ФизическиеЛица КАК СпрФЛ
			|ЛЕВОЕ СОЕДИНЕНИЕ ВтСоСтрахНомерами КАК ВтСоСтрахНомерами
			|ПО СпрФЛ.Ссылка.СтраховойНомерПФР = ВтСоСтрахНомерами.СтраховойНомерПФР
			|ГДЕ СпрФЛ.СтраховойНомерПФР В (ВтСоСтрахНомерами.СтраховойНомерПФР)";
			ЗапросНовый.УстановитьПараметр("ДокументСсылка",Ссылка);
			резЗапросНовый = ЗапросНовый.Выполнить().Выгрузить();
			
			СписокФЛ = Новый СписокЗначений;
			СписокФЛ.ЗагрузитьЗначения(резЗапросНовый.ВыгрузитьКолонку("ФизЛицо"));
			СписокФизлицТекст = "&СписокФЛ";
			Запрос.УстановитьПараметр("СписокФЛ",СписокФЛ);
		Иначе
			СписокФизлицТекст = "ВЫБРАТЬ 
			|	ТЧРаботникиОрганизации.Сотрудник
			|ИЗ
			|	Документ.СведенияОЗаработкеРаботниковДПУПоСотр2024.РаботникиОрганизации КАК ТЧРаботникиОрганизации
			|
			|ГДЕ
			|	ТЧРаботникиОрганизации.Ссылка = &ДокументСсылка";
		КонецЕсли;
		//Аверсон 14.01.2022 КВВ СВФР-008597 )
		
		//Персонификация	
		ДоходыПоВидамЗаГод =
		"ВЫБРАТЬ
		|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		|	ОбщаяТаблицаФСЗН.ФизЛицо КАК ФизЛицо,";
		
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ОбщаяТаблицаФСЗН.Сотрудник КАК Сотрудник,";
		КонецЕсли;
		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов КАК Период,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,";
		
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование КАК СотрудникНаименование";
		Иначе 
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование КАК ФизЛицоНаименование";	
		КонецЕсли;
		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		|ИЗ
		|	(ВЫБРАТЬ
		|		NULL КАК Больничные,
		|		NULL КАК СуммаДохода,
		|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|		ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|		34 КАК ПроцентФСЗН,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		|		И ЕСНИсчисленный.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов //О.Т. Аверсон 23.03.2018 № 1751
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.Сотрудник,
		|		ЕСНИсчисленный.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ)
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		СУММА(ВЫБОР
		|				КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН
		|						или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//|						или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|                     ) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|		КОГДА НЕ ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН и не ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		|		
		|			ТОГДА
		//	|				КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		|					 ЕСНСведенияОДоходах.Результат
		//|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник, 		
		|	ВЫБОР
		|		КОГДА не &ФлагПериодВзаиморасчетов //О.Т. Аверсон 19.04.2019 № 4121
		//Аверсон 12.11.2021 КВВ СВФР-008369 (
		//|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		
		//Аверсон ЕАЕ 14.12.2022 СВФР-009988
		//|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
		|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		//Аверсон СВФР-009988
		
		//Аверсон 12.11.2021 КВВ СВФР-008369 )
		|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
		|	КОНЕЦ КАК ПериодВзаиморасчетов,
		|		34,
		|		NULL,
		|		NULL
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ВЫБОР
		|			КОГДА не &ФлагПериодВзаиморасчетов //О.Т. Аверсон 19.04.2019 № 4121
		//Аверсон 12.11.2021 КВВ СВФР-008369 (
		//|			ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		
		//Аверсон ЕАЕ 14.12.2022 СВФР-009988
		//|			ТОГДА ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		|			ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		//Аверсон СВФР-009988
		
		//Аверсон 12.11.2021 КВВ СВФР-008369 )
		|			ИНАЧЕ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		|		КОНЕЦ
		|		И ЕСНСведенияОДоходах.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов //О.Т. Аверсон 23.03.2018 № 1751
		
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|	ВЫБОР
		|		КОГДА не &ФлагПериодВзаиморасчетов //О.Т. Аверсон 19.04.2019 № 4121
		//Аверсон 12.11.2021 КВВ СВФР-008369 (
		//|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
		
		//Аверсон ЕАЕ 14.12.2022 СВФР-009988
		//|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		//Аверсон СВФР-009988
		
		//Аверсон 12.11.2021 КВВ СВФР-008369 )
		|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ) 
		|	КОНЕЦ) КАК ОбщаяТаблицаФСЗН
		|
		|СГРУППИРОВАТЬ ПО
		|	ОбщаяТаблицаФСЗН.ФизЛицо,";
		
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ОбщаяТаблицаФСЗН.Сотрудник,";
		КонецЕсли;
		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование
		|
		|УПОРЯДОЧИТЬ ПО
		|	Период,";
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	СотрудникНаименование";
		Иначе
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ФизЛицоНаименование";
		КонецЕсли;
		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		|ИТОГИ
		|	СУММА(Больничные),
		|	СУММА(СуммаДохода),
		|	СУММА(ПенсионныйФонд),
		|	СУММА(ФСЗН)
		|ПО
		|	ОБЩИЕ,";
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	Сотрудник";
		Иначе
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ФизЛицо";
		КонецЕсли;
		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		|	Период";	
		
		//Аверсон 23.09.2021 КВВ СВФР-008181 (
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНИсчисленный.Сотрудник В(","И ЕСНИсчисленный.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНСведенияОДоходах.Сотрудник В(","И ЕСНСведенияОДоходах.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		//Аверсон 23.09.2021 КВВ СВФР-008181 )
		
		Запрос.Текст = ДоходыПоВидамЗаГод;
		Результат = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		ТабДок.Вывести(ОбластьШГруппа);
		ТабДок.НачатьАвтогруппировкуСтрок();
		
		Пока Результат.Следующий() Цикл
			ОбластьДетальныхЗаписей.Параметры.Заполнить(Результат);
			ОбластьДетальныхЗаписей.Параметры.Надпись = "1. Данные по ДПУ по форме ПУ-3 ""Индивидуальные сведения""";
			ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(Результат.ФСЗН=Null, 0, Результат.ФСЗН) + ?(Результат.ПенсионныйФонд=Null, 0 , Результат.ПенсионныйФонд);
			ТабДок.Вывести(ОбластьДетальныхЗаписей, Результат.Уровень(), , Ложь);
			ВыборкаПериод = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам); //О.Т. Аверсон 07.02.2016 № 862 Смена группировок
			Пока ВыборкаПериод.Следующий() Цикл
				ОбластьДетальныхЗаписей.Параметры.Заполнить(ВыборкаПериод);
				
				//Аверсон 11.11.2021 КВВ СВФР-008369 (
				Если НЕ ОбъединятьОсновные Тогда
					ОбластьДетальныхЗаписей.Параметры.Надпись = Символы.Таб+Строка(ВыборкаПериод.Сотрудник);
				Иначе
					ОбластьДетальныхЗаписей.Параметры.Надпись = Символы.Таб+Строка(ВыборкаПериод.ФизЛицо);
				КонецЕсли;
				//Аверсон 11.11.2021 КВВ СВФР-008369 )
				
				ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(ВыборкаПериод.ФСЗН=Null, 0, ВыборкаПериод.ФСЗН) + ?(ВыборкаПериод.ПенсионныйФонд=Null, 0 , ВыборкаПериод.ПенсионныйФонд);
				ТабДок.Вывести(ОбластьДетальныхЗаписей, ВыборкаПериод.Уровень(), , Ложь);
				
				ВыборкаФизЛицо = ВыборкаПериод.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам); //О.Т. Аверсон 07.02.2016 № 862 смена группировок
				Пока ВыборкаФизЛицо.Следующий() Цикл
					ОбластьДетальныхЗаписей.Параметры.Заполнить(ВыборкаФизЛицо);
					ОбластьДетальныхЗаписей.Параметры.Надпись = Символы.Таб+Строка(ВыборкаФизЛицо.Период);
					ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(ВыборкаФизЛицо.ФСЗН=Null, 0, ВыборкаФизЛицо.ФСЗН) + ?(ВыборкаФизЛицо.ПенсионныйФонд=Null, 0 , ВыборкаФизЛицо.ПенсионныйФонд);
					ТабДок.Вывести(ОбластьДетальныхЗаписей, ВыборкаФизЛицо.Уровень(), , Ложь);
				КонецЦикла;
			КонецЦикла;
		КонецЦикла;
		
		
		//ЗП						
		ДоходыПоВидамЗаГод =
		"ВЫБРАТЬ
		|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		|	ОбщаяТаблицаФСЗН.ФизЛицо КАК ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование КАК ФизЛицоНаименование,";
		
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ОбщаяТаблицаФСЗН.Сотрудник КАК Сотрудник,
			|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование КАК СотрудникНаименование,";
		КонецЕсли;
		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		|	ОбщаяТаблицаФСЗН.Период КАК ПериодРегистрации
		|ИЗ
		|	(ВЫБРАТЬ
		|		NULL КАК Больничные,
		|		NULL КАК СуммаДохода,
		|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|		ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		|		34 КАК ПроцентФСЗН,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		|		ЕСНИсчисленный.Период КАК Период
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ЕСНИсчисленный.Период МЕЖДУ &НачалоНП И &КонецНП
		|		//И ЕСНИсчисленный.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов //О.Т. Аверсон 23.03.2018 № 1751
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.Сотрудник,
		|		ЕСНИсчисленный.ФизЛицо,
		|		ЕСНИсчисленный.Период
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		СУММА(ВЫБОР
		|				КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН 
		|						или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//|						или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|                     ) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА( ВЫБОР
		|		КОГДА НЕ ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН и не ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		|		
		|			ТОГДА
		|				//КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		|					 ЕСНСведенияОДоходах.Результат
		|				//ИНАЧЕ 0
		|			КОНЕЦ),
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		34,
		|		NULL,
		|		NULL,
		|	ВЫБОР
		|		КОГДА не &ФлагПериодВзаиморасчетов //О.Т. Аверсон 19.04.2019 № 4121
		|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
		
		//Аверсон ЕАЕ 12.12.2022 СВФР-009988
		//|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		|       ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		//Аверсон СВФР-009988
		
		|	КОНЕЦ КАК ПериодВзаиморасчетов
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ВЫБОР
		|			КОГДА не &ФлагПериодВзаиморасчетов //О.Т. Аверсон 19.04.2019 № 4121
		|			ТОГДА ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		
		//Аверсон ЕАЕ 12.12.2022 СВФР-009988
		//|			ИНАЧЕ ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &НачалоНП И &КонецНП
		|			ИНАЧЕ ЕСНСведенияОДоходах.Период МЕЖДУ &НачалоНП И &КонецНП
		//Аверсон СВФР-009988
		
		|		КОНЕЦ
		|		//И ЕСНСведенияОДоходах.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов //О.Т. Аверсон 23.03.2018 № 1751
		
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник,
		|	ВЫБОР
		|		КОГДА не &ФлагПериодВзаиморасчетов //О.Т. Аверсон 19.04.2019 № 4121
		|		ТОГДА НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ) 
		
		//Аверсон ЕАЕ 12.12.2022 СВФР-009988
		//|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ)
		|		ИНАЧЕ НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.Период, МЕСЯЦ)
		//Аверсон СВФР-009988
		
		|	КОНЕЦ) КАК ОбщаяТаблицаФСЗН
		|
		|СГРУППИРОВАТЬ ПО
		|	ОбщаяТаблицаФСЗН.ФизЛицо,";
		
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ОбщаяТаблицаФСЗН.Сотрудник,
			|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование,";
		КонецЕсли;
		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	ОбщаяТаблицаФСЗН.Период
		|
		|УПОРЯДОЧИТЬ ПО
		|	ПериодРегистрации,";
		
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	СотрудникНаименование";
		Иначе
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ФизЛицоНаименование";
		КонецЕсли;
		ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		|
		|ИТОГИ
		|	СУММА(Больничные),
		|	СУММА(СуммаДохода),
		|	СУММА(ПенсионныйФонд),
		|	СУММА(ФСЗН)
		|ПО
		|	ОБЩИЕ,
		|	ПериодРегистрации,";
		//Аверсон 11.11.2021 КВВ СВФР-008369 (
		Если НЕ ОбъединятьОсновные Тогда
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	Сотрудник";
		Иначе
			ДоходыПоВидамЗаГод = ДоходыПоВидамЗаГод + "
			|	ФизЛицо";
		КонецЕсли;
		//Аверсон 11.11.2021 КВВ СВФР-008369 )
		
		
		
		//Аверсон 23.09.2021 КВВ СВФР-008181 (
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНИсчисленный.Сотрудник В(","И ЕСНИсчисленный.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНСведенияОДоходах.Сотрудник В(","И ЕСНСведенияОДоходах.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		//Аверсон 23.09.2021 КВВ СВФР-008181 )
		
		Запрос.Текст = ДоходыПоВидамЗаГод;
		
		Если ОтборПоПериодуВзаиморасчетов Тогда 
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНСведенияОДоходах.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов","И ЕСНСведенияОДоходах.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов");
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНИсчисленный.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов ","И ЕСНИсчисленный.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов");
		иначе                      
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНСведенияОДоходах.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов","И ЕСНСведенияОДоходах.Период <= &ПериодВзаиморасчетов");
			Запрос.Текст = СтрЗаменить(Запрос.Текст,"//И ЕСНИсчисленный.ПериодВзаиморасчетов <= &ПериодВзаиморасчетов ","И ЕСНИсчисленный.Период <= &ПериодВзаиморасчетов");
		КонецЕсли;
		
		РезультатЗП = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		
		Пока РезультатЗП.Следующий() Цикл
			ОбластьДетальныхЗаписей.Параметры.Заполнить(РезультатЗП);
			ОбластьДетальныхЗаписей.Параметры.Надпись = "2. Данные по периодам регистрации";
			ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(РезультатЗП.ФСЗН=Null, 0, РезультатЗП.ФСЗН) + ?(РезультатЗП.ПенсионныйФонд=Null, 0 , РезультатЗП.ПенсионныйФонд);
			ТабДок.Вывести(ОбластьДетальныхЗаписей, РезультатЗП.Уровень(), , Ложь);
			ВыборкаПериод = РезультатЗП.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаПериод.Следующий() Цикл
				ОбластьДетальныхЗаписей.Параметры.Заполнить(ВыборкаПериод);
				ОбластьДетальныхЗаписей.Параметры.Надпись = Символы.Таб+Строка(ВыборкаПериод.ПериодРегистрации);
				ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(ВыборкаПериод.ФСЗН=Null, 0, ВыборкаПериод.ФСЗН) + ?(ВыборкаПериод.ПенсионныйФонд=Null, 0 , ВыборкаПериод.ПенсионныйФонд);
				ТабДок.Вывести(ОбластьДетальныхЗаписей, ВыборкаПериод.Уровень(), , Ложь);
				ВыборкаФизЛицо = ВыборкаПериод.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
				Пока ВыборкаФизЛицо.Следующий() Цикл
					ОбластьДетальныхЗаписей.Параметры.Заполнить(ВыборкаФизЛицо);
					
					//Аверсон 11.11.2021 КВВ СВФР-008369 (
					Если НЕ ОбъединятьОсновные Тогда
						ОбластьДетальныхЗаписей.Параметры.Надпись = Символы.Таб+Строка(ВыборкаФизЛицо.Сотрудник);
					Иначе
						ОбластьДетальныхЗаписей.Параметры.Надпись = Символы.Таб+Строка(ВыборкаФизЛицо.Физлицо);
					КонецЕсли;
					//Аверсон 11.11.2021 КВВ СВФР-008369 )
					
					ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(ВыборкаФизЛицо.ФСЗН=Null, 0, ВыборкаФизЛицо.ФСЗН) + ?(ВыборкаФизЛицо.ПенсионныйФонд=Null, 0 , ВыборкаФизЛицо.ПенсионныйФонд);
					ТабДок.Вывести(ОбластьДетальныхЗаписей, ВыборкаФизЛицо.Уровень(), , Ложь);
				КонецЦикла;
			КонецЦикла;
		КонецЦикла;
		ТабДок.ЗакончитьАвтогруппировкуСтрок();
		
		//разница	
		Результат.Сбросить();
		Результат.Следующий();
		РезультатЗП.Сбросить();
		РезультатЗП.Следующий();
		ОбластьДетальныхЗаписей.Параметры.Надпись = "3. Сумма расхождений в рублях (+/-) (стр.1 - стр.2)";
		ОбластьДетальныхЗаписей.Параметры.СуммаДохода = Результат.СуммаДохода - РезультатЗП.СуммаДохода;
		ОбластьДетальныхЗаписей.Параметры.Больничные = Результат.Больничные - РезультатЗП.Больничные;
		ОбластьДетальныхЗаписей.Параметры.ФСЗН = (Результат.ФСЗН + Результат.ПенсионныйФонд) - (РезультатЗП.ФСЗН + РезультатЗП.ПенсионныйФонд);
		ТабДок.Вывести(ОбластьДетальныхЗаписей);
		
		ОбластьДетальныхЗаписей.Параметры.Надпись = "4. Причины расхождений (с указанием суммы)";
		ОбластьДетальныхЗаписей.Параметры.СуммаДохода = 0;
		ОбластьДетальныхЗаписей.Параметры.Больничные = 0;
		ОбластьДетальныхЗаписей.Параметры.ФСЗН = 0;
		ТабДок.Вывести(ОбластьДетальныхЗаписей);
		ОбластьДетальныхЗаписей.Параметры.Надпись = "- по выплатам, пособиям и страховым взносам";
		ТабДок.Вывести(ОбластьДетальныхЗаписей);
		
		
		
		//ЗП отклонения	до отчетного периода
		мГод = Год(КонецГода(ВыборкаПоШапкеДокумента.ПериодРегистрации));
		Запрос.УстановитьПараметр("Год", мГод);
		
		ДоходыПоВидамЗаГод =
		"ВЫБРАТЬ
		|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		|	ОбщаяТаблицаФСЗН.ФизЛицо КАК ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование КАК ФизЛицоНименование,
		|	ОбщаяТаблицаФСЗН.Сотрудник КАК Сотрудник,
		|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование КАК СотрудникНименование,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов КАК Период,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		|	ОбщаяТаблицаФСЗН.Период КАК ПериодРегистрации
		|ИЗ
		|	(ВЫБРАТЬ
		|		NULL КАК Больничные,
		|		NULL КАК СуммаДохода,
		|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|		ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|		34 КАК ПроцентФСЗН,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		|		ЕСНИсчисленный.Период КАК Период
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ГОД(ЕСНИсчисленный.Период) = &Год
		|		И ГОД(ЕСНИсчисленный.ПериодВзаиморасчетов) < &Год
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.Сотрудник,
		|		ЕСНИсчисленный.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНИсчисленный.Период
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		СУММА(ВЫБОР
		|				КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН 
		|						или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//|						или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|                     ) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА( ВЫБОР
		|		КОГДА НЕ ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН и не ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		|		
		|			ТОГДА
		|				//КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		|					 ЕСНСведенияОДоходах.Результат
		|				//ИНАЧЕ 0
		|			КОНЕЦ),
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		|		34,
		|		NULL,
		|		NULL,
		|		ЕСНСведенияОДоходах.Период
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ГОД(ЕСНСведенияОДоходах.Период) = &Год
		|		И ГОД(ЕСНСведенияОДоходах.ПериодВзаиморасчетов) < &Год
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНСведенияОДоходах.Период) КАК ОбщаяТаблицаФСЗН
		|
		|СГРУППИРОВАТЬ ПО
		|	ОбщаяТаблицаФСЗН.ФизЛицо,
		|	ОбщаяТаблицаФСЗН.Сотрудник,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование,
		|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	ОбщаяТаблицаФСЗН.Период
		|
		|УПОРЯДОЧИТЬ ПО
		|	СотрудникНименование
		|ИТОГИ
		|	СУММА(Больничные),
		|	СУММА(СуммаДохода),
		|	СУММА(ПенсионныйФонд),
		|	СУММА(ФСЗН)
		|ПО
		|	ОБЩИЕ";	
		
		//Аверсон 23.09.2021 КВВ СВФР-008181 (
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНИсчисленный.Сотрудник В(","И ЕСНИсчисленный.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНСведенияОДоходах.Сотрудник В(","И ЕСНСведенияОДоходах.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		//Аверсон 23.09.2021 КВВ СВФР-008181 )
		
		Запрос.Текст = ДоходыПоВидамЗаГод;
		Результат = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		ТабДок.НачатьАвтогруппировкуСтрок();
		Пока Результат.Следующий() Цикл
			ОбластьДетальныхЗаписей.Параметры.Заполнить(Результат);
			ОбластьДетальныхЗаписей.Параметры.Надпись = "Переходящие выплаты прошлых годов выплаченные в "+Строка(мГод)+" г. (-)";
			ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(Результат.ФСЗН=Null, 0, Результат.ФСЗН) + ?(Результат.ПенсионныйФонд=Null, 0 , Результат.ПенсионныйФонд);
			ТабДок.Вывести(ОбластьДетальныхЗаписей, Результат.Уровень(), , Ложь);
			ВыборкаПериод = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаПериод.Следующий() Цикл
				ДеталиОтклонения.Параметры.Заполнить(ВыборкаПериод);
				ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(ВыборкаПериод.ФСЗН=Null, 0, ВыборкаПериод.ФСЗН) + ?(ВыборкаПериод.ПенсионныйФонд=Null, 0 , ВыборкаПериод.ПенсионныйФонд);
				ТабДок.Вывести(ДеталиОтклонения, ВыборкаПериод.Уровень(), , Ложь);
			КонецЦикла;
		КонецЦикла;
		ТабДок.ЗакончитьАвтогруппировкуСтрок();
		
		//Персонификация отклонения						
		
		Запрос.УстановитьПараметр("Год", Год(КонецГода(ВыборкаПоШапкеДокумента.ПериодРегистрации)));
		
		ДоходыПоВидамЗаГод =
		"ВЫБРАТЬ
		|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		|	ОбщаяТаблицаФСЗН.ФизЛицо КАК ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование КАК ФизЛицоНаименование,
		|	ОбщаяТаблицаФСЗН.Сотрудник КАК Сотрудник,
		|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование КАК СотрудникНаименование,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов КАК Период,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		|	ОбщаяТаблицаФСЗН.Период КАК ПериодРегистрации
		|ИЗ
		|	(ВЫБРАТЬ
		|		NULL КАК Больничные,
		|		NULL КАК СуммаДохода,
		|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|		ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|		34 КАК ПроцентФСЗН,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		|		ЕСНИсчисленный.Период КАК Период
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ГОД(ЕСНИсчисленный.Период) < &Год
		|		И ГОД(ЕСНИсчисленный.ПериодВзаиморасчетов) = &Год
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.Сотрудник,
		|		ЕСНИсчисленный.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНИсчисленный.Период
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		СУММА(ВЫБОР
		|				КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН 
		|						или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//|						или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|                     ) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА( ВЫБОР
		|		КОГДА НЕ ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН и не ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		|		
		|			ТОГДА
		|			//	КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		|					 ЕСНСведенияОДоходах.Результат
		|			//	ИНАЧЕ 0
		|			КОНЕЦ),
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		|		34,
		|		NULL,
		|		NULL,
		|		ЕСНСведенияОДоходах.Период
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ГОД(ЕСНСведенияОДоходах.Период) < &Год
		|		И ГОД(ЕСНСведенияОДоходах.ПериодВзаиморасчетов) = &Год
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНСведенияОДоходах.Период) КАК ОбщаяТаблицаФСЗН
		|
		|СГРУППИРОВАТЬ ПО
		|	ОбщаяТаблицаФСЗН.ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование,
		|	ОбщаяТаблицаФСЗН.Сотрудник,
		|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование,  
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	ОбщаяТаблицаФСЗН.Период
		|
		|УПОРЯДОЧИТЬ ПО
		|	СотрудникНаименование
		|ИТОГИ
		|	СУММА(Больничные),
		|	СУММА(СуммаДохода),
		|	СУММА(ПенсионныйФонд),
		|	СУММА(ФСЗН)
		|ПО
		|	ОБЩИЕ";	
		
		//Аверсон 23.09.2021 КВВ СВФР-008181 (
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНИсчисленный.Сотрудник В(","И ЕСНИсчисленный.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНСведенияОДоходах.Сотрудник В(","И ЕСНСведенияОДоходах.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		//Аверсон 23.09.2021 КВВ СВФР-008181 )
		
		Запрос.Текст = ДоходыПоВидамЗаГод;
		Результат = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		ТабДок.НачатьАвтогруппировкуСтрок();
		Пока Результат.Следующий() Цикл
			ОбластьДетальныхЗаписей.Параметры.Заполнить(Результат);
			ОбластьДетальныхЗаписей.Параметры.Надпись = "Переходящие выплаты по ФСЗН прошлых годов выплаченные в "+Строка(мГод)+" г. (+)";
			ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(Результат.ФСЗН=Null, 0, Результат.ФСЗН) + ?(Результат.ПенсионныйФонд=Null, 0 , Результат.ПенсионныйФонд);
			ТабДок.Вывести(ОбластьДетальныхЗаписей, Результат.Уровень(), , Ложь);
			ВыборкаПериод = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаПериод.Следующий() Цикл
				ДеталиОтклонения.Параметры.Заполнить(ВыборкаПериод);
				ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(ВыборкаПериод.ФСЗН=Null, 0, ВыборкаПериод.ФСЗН) + ?(ВыборкаПериод.ПенсионныйФонд=Null, 0 , ВыборкаПериод.ПенсионныйФонд);
				ТабДок.Вывести(ДеталиОтклонения, ВыборкаПериод.Уровень(), , Ложь);
			КонецЦикла;
		КонецЦикла;
		ТабДок.ЗакончитьАвтогруппировкуСтрок();
		
		//ЗП отклонения	после отчетного периода
		мГод = Год(КонецГода(ВыборкаПоШапкеДокумента.ПериодРегистрации));
		Запрос.УстановитьПараметр("Год", мГод);
		
		ДоходыПоВидамЗаГод =
		"ВЫБРАТЬ
		|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		|	ОбщаяТаблицаФСЗН.ФизЛицо КАК ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование КАК ФизЛицоНаименование,
		|	ОбщаяТаблицаФСЗН.Сотрудник КАК Сотрудник,
		|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование КАК СотрудникНаименование, 
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов КАК Период,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		|	ОбщаяТаблицаФСЗН.Период КАК ПериодРегистрации
		|ИЗ
		|	(ВЫБРАТЬ
		|		NULL КАК Больничные,
		|		NULL КАК СуммаДохода,
		|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|		ЕСНИсчисленный.Сотрудник КАК Сотрудник,  
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|		34 КАК ПроцентФСЗН,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		|		ЕСНИсчисленный.Период КАК Период
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ГОД(ЕСНИсчисленный.Период) = &Год
		|		И ГОД(ЕСНИсчисленный.ПериодВзаиморасчетов) > &Год
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.Сотрудник,
		|		ЕСНИсчисленный.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНИсчисленный.Период
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		СУММА(ВЫБОР
		|				КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН 
		|						или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//|						или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|                     ) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА( ВЫБОР
		|		КОГДА НЕ ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН и не ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		|		
		|			ТОГДА
		|				//КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		|					 ЕСНСведенияОДоходах.Результат
		|			//	ИНАЧЕ 0
		|			КОНЕЦ),
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		|		34,
		|		NULL,
		|		NULL,
		|		ЕСНСведенияОДоходах.Период
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ГОД(ЕСНСведенияОДоходах.Период) = &Год
		|		И ГОД(ЕСНСведенияОДоходах.ПериодВзаиморасчетов) > &Год
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНСведенияОДоходах.Период) КАК ОбщаяТаблицаФСЗН
		|
		|СГРУППИРОВАТЬ ПО
		|	ОбщаяТаблицаФСЗН.ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование,
		|	ОбщаяТаблицаФСЗН.Сотрудник,
		|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	ОбщаяТаблицаФСЗН.Период
		|
		|УПОРЯДОЧИТЬ ПО
		|	СотрудникНаименование
		|ИТОГИ
		|	СУММА(Больничные),
		|	СУММА(СуммаДохода),
		|	СУММА(ПенсионныйФонд),
		|	СУММА(ФСЗН)
		|ПО
		|	ОБЩИЕ";	
		
		//Аверсон 23.09.2021 КВВ СВФР-008181 (
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНИсчисленный.Сотрудник В(","И ЕСНИсчисленный.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНСведенияОДоходах.Сотрудник В(","И ЕСНСведенияОДоходах.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		//Аверсон 23.09.2021 КВВ СВФР-008181 )
		
		Запрос.Текст = ДоходыПоВидамЗаГод;
		Результат = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		ТабДок.НачатьАвтогруппировкуСтрок();
		Пока Результат.Следующий() Цикл
			ОбластьДетальныхЗаписей.Параметры.Заполнить(Результат);
			ОбластьДетальныхЗаписей.Параметры.Надпись = "Переходящие выплаты по ФСЗН "+Строка(мГод)+" г. выплаченные в последующих годах (-)";
			ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(Результат.ФСЗН=Null, 0, Результат.ФСЗН) + ?(Результат.ПенсионныйФонд=Null, 0 , Результат.ПенсионныйФонд);
			ТабДок.Вывести(ОбластьДетальныхЗаписей, Результат.Уровень(), , Ложь);
			ВыборкаПериод = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаПериод.Следующий() Цикл
				ДеталиОтклонения.Параметры.Заполнить(ВыборкаПериод);
				ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(ВыборкаПериод.ФСЗН=Null, 0, ВыборкаПериод.ФСЗН) + ?(ВыборкаПериод.ПенсионныйФонд=Null, 0 , ВыборкаПериод.ПенсионныйФонд);
				ТабДок.Вывести(ДеталиОтклонения, ВыборкаПериод.Уровень(), , Ложь);
			КонецЦикла;
		КонецЦикла;
		ТабДок.ЗакончитьАвтогруппировкуСтрок();
		
		//Персонификация отклонения						
		
		Запрос.УстановитьПараметр("Год", Год(КонецГода(ВыборкаПоШапкеДокумента.ПериодРегистрации)));
		
		ДоходыПоВидамЗаГод =
		"ВЫБРАТЬ
		|	СУММА(ОбщаяТаблицаФСЗН.Больничные) КАК Больничные,
		|	СУММА(ОбщаяТаблицаФСЗН.СуммаДохода) КАК СуммаДохода,
		|	ОбщаяТаблицаФСЗН.ФизЛицо КАК ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование КАК ФизЛицоНаименование,
		|	ОбщаяТаблицаФСЗН.Сотрудник КАК Сотрудник,
		|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование КАК СотрудникНаименование,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов КАК Период,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	СУММА(ОбщаяТаблицаФСЗН.ПенсионныйФонд) КАК ПенсионныйФонд,
		|	СУММА(ОбщаяТаблицаФСЗН.ФСЗН) КАК ФСЗН,
		|	ОбщаяТаблицаФСЗН.Период КАК ПериодРегистрации
		|ИЗ
		|	(ВЫБРАТЬ
		|		NULL КАК Больничные,
		|		NULL КАК СуммаДохода,
		|		ЕСНИсчисленный.ФизЛицо КАК ФизЛицо,
		|		ЕСНИсчисленный.Сотрудник КАК Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ) КАК ПериодВзаиморасчетов,
		|		34 КАК ПроцентФСЗН,
		|		СУММА(ЕСНИсчисленный.ПенсионныйФонд) КАК ПенсионныйФонд,
		|		СУММА(ЕСНИсчисленный.ФСЗН) КАК ФСЗН,
		|		ЕСНИсчисленный.Период КАК Период
		|	ИЗ
		|		РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
		|	ГДЕ
		|		ЕСНИсчисленный.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНИсчисленный.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ГОД(ЕСНИсчисленный.Период) > &Год
		|		И ГОД(ЕСНИсчисленный.ПериодВзаиморасчетов) = &Год
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНИсчисленный.Сотрудник,
		|		ЕСНИсчисленный.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНИсчисленный.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНИсчисленный.Период
		|	
		|	ОБЪЕДИНИТЬ ВСЕ
		|	
		|	ВЫБРАТЬ
		|		СУММА(ВЫБОР
		|				КОГДА ( ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН 
		|						или ЕСНСведенияОДоходах.ВидРасчета.СпособРасчета в (&СпособРасчета) //О.Т. Аверсон 28.02.2019 № 3224
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//|						или ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		//+ СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|                     	) И НЕ ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		//- СВЭЙ КДЯ 12.12.19 СВФР-004631 ( Пункт 84. )
		|					ТОГДА ЕСНСведенияОДоходах.Результат
		|				ИНАЧЕ 0
		|			КОНЕЦ),
		|		СУММА(ВЫБОР
		|		КОГДА НЕ ЕСНСведенияОДоходах.КодДоходаЕСН = &ДоходБольничныйФСЗН и не ЕСНСведенияОДоходах.ВидРасчета = Значение(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОплатаБЛПоТравмеНаПроизводстве)
		|		
		|			ТОГДА
		|			//	КОГДА ЕСНСведенияОДоходах.ДоходФСЗН = &ДоходФСЗН
		|					 ЕСНСведенияОДоходах.Результат
		|			//	ИНАЧЕ 0
		|			КОНЕЦ),
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		|		34,
		|		NULL,
		|		NULL,
		|		ЕСНСведенияОДоходах.Период
		|	ИЗ
		|		РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|	ГДЕ
		|		ЕСНСведенияОДоходах.Организация = &СписокОтчитывающихсяПодразделений
		|		И ЕСНСведенияОДоходах.Сотрудник В(" + СписокФизлицТекст + ")
		|		И ГОД(ЕСНСведенияОДоходах.Период) > &Год
		|		И ГОД(ЕСНСведенияОДоходах.ПериодВзаиморасчетов) = &Год
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ЕСНСведенияОДоходах.Сотрудник,
		|		ЕСНСведенияОДоходах.ФизЛицо,
		|		НАЧАЛОПЕРИОДА(ЕСНСведенияОДоходах.ПериодВзаиморасчетов, МЕСЯЦ),
		|		ЕСНСведенияОДоходах.Период) КАК ОбщаяТаблицаФСЗН
		|
		|СГРУППИРОВАТЬ ПО
		|	ОбщаяТаблицаФСЗН.ФизЛицо,
		|	ОбщаяТаблицаФСЗН.ФизЛицо.Наименование,
		|	ОбщаяТаблицаФСЗН.Сотрудник,
		|	ОбщаяТаблицаФСЗН.Сотрудник.Наименование,
		|	ОбщаяТаблицаФСЗН.ПериодВзаиморасчетов,
		|	ОбщаяТаблицаФСЗН.ПроцентФСЗН,
		|	ОбщаяТаблицаФСЗН.Период
		|
		|УПОРЯДОЧИТЬ ПО
		|	СотрудникНаименование
		|ИТОГИ
		|	СУММА(Больничные),
		|	СУММА(СуммаДохода),
		|	СУММА(ПенсионныйФонд),
		|	СУММА(ФСЗН)
		|ПО
		|	ОБЩИЕ";	
		
		//Аверсон 23.09.2021 КВВ СВФР-008181 (
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНИсчисленный.Сотрудник В(","И ЕСНИсчисленный.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		ДоходыПоВидамЗаГод = ?(ОбъединятьОсновные ИЛИ ВсеСотрудники,СтрЗаменить(ДоходыПоВидамЗаГод,"И ЕСНСведенияОДоходах.Сотрудник В(","И ЕСНСведенияОДоходах.ФизЛицо В("),ДоходыПоВидамЗаГод); 
		//Аверсон 23.09.2021 КВВ СВФР-008181 )
		
		Запрос.Текст = ДоходыПоВидамЗаГод;
		Результат = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
		
		ТабДок.НачатьАвтогруппировкуСтрок();
		Пока Результат.Следующий() Цикл
			ОбластьДетальныхЗаписей.Параметры.Заполнить(Результат);
			ОбластьДетальныхЗаписей.Параметры.Надпись = "Переходящие выплаты "+Строка(мГод)+" г. выплаченные в последующих годах (+)";
			ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(Результат.ФСЗН=Null, 0, Результат.ФСЗН) + ?(Результат.ПенсионныйФонд=Null, 0 , Результат.ПенсионныйФонд);
			ТабДок.Вывести(ОбластьДетальныхЗаписей, Результат.Уровень(), , Ложь);
			ВыборкаПериод = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаПериод.Следующий() Цикл
				ДеталиОтклонения.Параметры.Заполнить(ВыборкаПериод);
				ОбластьДетальныхЗаписей.Параметры.ФСЗН = ?(ВыборкаПериод.ФСЗН=Null, 0, ВыборкаПериод.ФСЗН) + ?(ВыборкаПериод.ПенсионныйФонд=Null, 0 , ВыборкаПериод.ПенсионныйФонд);
				ТабДок.Вывести(ДеталиОтклонения, ВыборкаПериод.Уровень(), , Ложь);
			КонецЦикла;
		КонецЦикла;
		ТабДок.ЗакончитьАвтогруппировкуСтрок();
		
		РаботаСДиалогами.НапечататьДокумент(ТабДок);
		
	КонецПроцедуры
	
#КонецЕсли

//енд

Функция ПолучитьСуммуПФиФСЗН(Сотрудник,ЗаПериод,ПроверятьОбъединять=Истина)
	//Аверсон 21.05.2020 КВВ СВФР-005940 (
	СуммаПФиФСЗН = 0;
	З = Новый Запрос;
	З_Текст = "ВЫБРАТЬ
	|ЕСТЬNULL(Сумма(ЕСНИсчисленный.ПенсионныйФонд + ЕСНИсчисленный.ФСЗН),0) КАК Результат
	|ИЗ РегистрНакопления.ЕСНИсчисленныйПоСотрудникам КАК ЕСНИсчисленный
	|ГДЕ
	|	ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &Начало И &Конец
	
	//Аверсон ЕАЕ 20.01.2022 СВФР-008626
	//|	И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
	| //И ЕСНИсчисленный.Период <= &ДатаПодачиСведений
	//Аверсон СВФР-008626
	
	|	И ЕСНИсчисленный.Организация = &Организация
	|	И ЕСНИсчисленный.Сотрудник = &Сотрудник";
	Если ОбъединятьОсновные И ПроверятьОбъединять Тогда
		З_Текст = СтрЗаменить(З_Текст,"И ЕСНИсчисленный.Сотрудник","И ЕСНИсчисленный.ФизЛицо");
	КонецЕсли;
	
	//Аверсон ЕАЕ 20.01.2022 СВФР-008626
	Если ОтборПоПериодуВзаиморасчетов Тогда
		З_Текст = СтрЗаменить(З_Текст,"//И ЕСНИсчисленный.Период <= &ДатаПодачиСведений","");
	Иначе
		З_Текст = СтрЗаменить(З_Текст,"//И ЕСНИсчисленный.Период <= &ДатаПодачиСведений","И ЕСНИсчисленный.Период <= &ДатаПодачиСведений");
	КонецЕсли;
	//Аверсон СВФР-008626
	
	З.Текст = З_Текст;
	З.УстановитьПараметр("Организация",Организация);
	З.УстановитьПараметр("Сотрудник",Сотрудник);
	З.УстановитьПараметр("Начало",НачалоМесяца(ЗаПериод));
	З.УстановитьПараметр("Конец",КонецМесяца(ЗаПериод));
	З.УстановитьПараметр("ДатаПодачиСведений",ДатаОкончания);
	РезЗ = З.Выполнить().Выбрать();
	Если РезЗ.Следующий() Тогда
		СуммаПФиФСЗН = РезЗ.Результат;
	КонецЕсли;	
	Возврат СуммаПФиФСЗН;
	//Аверсон 21.05.2020 КВВ СВФР-005940 )	
КонецФункции

Функция ПроверкаНаОтпускЗаСвойСчетНаЦелыйМесяц(Сотрудник,Месяц) 
	//Аверсон 22.05.2020 КВВ СВФР-005940 (
	БылОтпМесяц = Ложь;
	З = Новый Запрос;
	З.Текст = "ВЫБРАТЬ 
	|ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
	|ОсновныеНачисленияРаботниковОрганизаций.Сотрудник
	|ИЗ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|ОсновныеНачисленияРаботниковОрганизаций.Организация = &Организация
	|И ОсновныеНачисленияРаботниковОрганизаций.Сотрудник = &Сотрудник
	|И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОРганизаций.ОтпускЗаСвойСчет)
	|И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало = &Начало
	|И ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец = &Конец";	
	З.УстановитьПараметр("Организация",Организация);
	З.УстановитьПараметр("Сотрудник",Сотрудник);
	З.УстановитьПараметр("Начало",НачалоМесяца(Месяц));
	З.УстановитьПараметр("Конец",КонецМесяца(Месяц));
	РезЗ = З.Выполнить().Выбрать();
	Если РезЗ.Следующий() Тогда
		БылОтпМесяц = Истина;
	КонецЕсли;	
	Возврат БылОтпМесяц;
	//Аверсон 22.05.2020 КВВ СВФР-005940 )	
КонецФункции

Функция РабочихДнейЗаМесяц(Сотрудник,Месяц)
	//Аверсон 23.07.2020 КВВ СВФР-006298 (
	З = Новый Запрос;
	З.Текст = "ВЫБРАТЬ 
	|		ЕСТЬNULL(СУММА(РабочееВремяРаботниковОрганизаций.Часов),0) КАК Часов,
	|		ЕСТЬNULL(СУММА(РабочееВремяРаботниковОрганизаций.Дней),0) КАК Дней
	|	ИЗ
	|		РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
	|	ГДЕ
	|		РабочееВремяРаботниковОрганизаций.Организация = &Организация
	|		И РабочееВремяРаботниковОрганизаций.Сотрудник = &Сотрудник
	|		И РабочееВремяРаботниковОрганизаций.ДатаНачала МЕЖДУ &Начало И &Конец
	|	    И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
	|	    ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Сверхурочные)
	|	    ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.ОсновнойОтпуск)
	|	    ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаВечерниеЧасы)
	|	    ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы)";
	
	//СВЭЙ 19.01.2024 КВВ СВФР-012080 (
	Если СЗ_ПремияДляПУ_Классификатор.Количество() <> 0 Тогда
		З.Текст = З.Текст + "
		|	    ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени В (&СЗ_ПремияДляПУ_Классификатор)";
	КонецЕсли;      
	//СВЭЙ 19.01.2024 КВВ СВФР-012080 )
	З.Текст = З.Текст + "
	| )";	
	З.УстановитьПараметр("Организация",Организация);   // отпуск тоже считается рабочим временем для ПУ 12.10.2022
	З.УстановитьПараметр("Сотрудник",Сотрудник);
	З.УстановитьПараметр("Начало",НачалоМесяца(Месяц));
	З.УстановитьПараметр("Конец",КонецМесяца(Месяц));  
	З.УстановитьПараметр("СЗ_ПремияДляПУ_Классификатор",СЗ_ПремияДляПУ_Классификатор); //СВЭЙ 19.01.2024 КВВ СВФР-012080
	
	РезЗ = З.Выполнить().Выгрузить();
	Возврат РезЗ;
	//Аверсон 23.07.2020 КВВ СВФР-006298 )
КонецФункции

Функция ЕстьПремияДляПУЗаМесяц(Сотрудник,Месяц_)
	//Аверсон 22.12.2021 КВВ СВФР-007900 (
	ЕстьПремияДляПУ = Ложь;
	Если СЗ_ПремияДляПУ.Количество() <> 0 Тогда 
		З = Новый Запрос;
		З.Текст = "ВЫБРАТЬ
		|	ЕСНСведенияОДоходах.ВидРасчета  как ВидРасчета
		|ИЗ
		|	РегистрНакопления.ЕСНСведенияОДоходахПоСотрудникам КАК ЕСНСведенияОДоходах
		|ГДЕ
		|	ЕСНСведенияОДоходах.Сотрудник = &Сотрудник
		|	И ЕСНСведенияОДоходах.ПериодВзаиморасчетов МЕЖДУ &Начало И &Конец
		|	И ЕСНСведенияОДоходах.ВидРасчета в (&СЗ_ПремияДляПУ)";
		З.УстановитьПараметр("Сотрудник",Сотрудник);
		З.УстановитьПараметр("Начало",НачалоМесяца(Месяц_));
		З.УстановитьПараметр("Конец",КонецМесяца(Месяц_));
		З.УстановитьПараметр("СЗ_ПремияДляПУ",СЗ_ПремияДляПУ);
		РезЗ = З.Выполнить().Выгрузить();
		Если РезЗ.Количество() <> 0 Тогда
			ЕстьПремияДляПУ = Истина;
		КонецЕсли;
	КонецЕсли;
	Возврат ЕстьПремияДляПУ;
	//Аверсон 22.12.2021 КВВ СВФР-007900 )
КонецФункции


Функция ПолучитьФактичПФПриУвольнении(Сотрудник,Месяц) Экспорт
	//Аверсон 29.07.2020 КВВ СВФР-006298 (
	СуммаПФ = 0;
	З = Новый Запрос;
	З.Текст = "ВЫБРАТЬ * 
	|ИЗ РегистрСведений.РаботникиОрганизаций КАК РабОрг
	|ГДЕ 
	|РабОрг.Организация = &Организация
	|И РабОрг.Сотрудник = &Сотрудник
	|И РабОрг.Регистратор ССЫЛКА Документ.УвольнениеИзОрганизаций
	|И РабОрг.Период МЕЖДУ &Начало И &Конец";
	
	З.УстановитьПараметр("Организация",Организация);
	З.УстановитьПараметр("Сотрудник",Сотрудник);
	З.УстановитьПараметр("Начало",КонецДня(НачалоМесяца(Месяц))+1);  //Увольнение запишется датой +1 день, берем со второго числа месяца по первое число нового месяца
	З.УстановитьПараметр("Конец",КонецМесяца(Месяц)+1);
	РезЗ = З.Выполнить().Выбрать();
	Если РезЗ.Следующий() Тогда
		З2 = Новый Запрос;
		З2.Текст = "ВЫБРАТЬ 
		|ЕСТЬNULL(СУММА(ЕСНИсчисленный.ПенсионныйФонд), 0) КАК ПФ
		|ИЗ РегистрНакопления.ЕСНИсчисленный КАК ЕСНИсчисленный
		|ГДЕ
		|ЕСНИсчисленный.ПериодВзаиморасчетов МЕЖДУ &Начало И &Конец
		|И ЕСНИсчисленный.Организация = &Организация
		|И ЕСНИсчисленный.ФизЛицо = &ФЛ
		|И ЕСНИсчисленный.ПенсионныйФонд <> 0";
		
		З2.УстановитьПараметр("Организация",Организация);
		З2.УстановитьПараметр("ФЛ",Сотрудник.ФизЛицо);
		З2.УстановитьПараметр("Начало",НачалоМесяца(Месяц));  
		З2.УстановитьПараметр("Конец",КонецМесяца(Месяц));
		РезЗ2 = З2.Выполнить().Выбрать();
		Если РезЗ2.Следующий() Тогда
			СуммаПФ = РезЗ2.ПФ;
		КонецЕсли;	
	КонецЕсли;	
	
	Возврат СуммаПФ;
	//Аверсон 29.07.2020 КВВ СВФР-006298 )
КонецФункции

//Аверсон ЕАЕ 10.11.2021 СВФР-008288
Функция ПолучитьСписокИсключений()
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	ГруппыРасчетовОсновные.ВидРасчета
	|ИЗ
	|	Справочник.ГруппыРасчетов.Основные КАК ГруппыРасчетовОсновные
	|ГДЕ
	|	ГруппыРасчетовОсновные.Ссылка = ЗНАЧЕНИЕ(Справочник.ГруппыРасчетов.ИсключениеНевыходовИзПУ3)";
	
	МассивИсключений = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("ВидРасчета");
	Возврат МассивИсключений;
КонецФункции
//Аверсон СВФР-008288

//Аверсон ЕАЕ 17.04.2022 СВФР-008941
Процедура РаспределитьДетей()
	СтруктураОтбора = Новый Структура;
	СтруктураОтбора.Вставить("ВидДеятельности", Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ", Истина));
	МассивСтрокДети = СведенияОСтаже.НайтиСтроки(СтруктураОтбора);
	ТЗДети = СведенияОСтаже.Выгрузить(МассивСтрокДети);
	МассивСотрудников = ТЗДети.ВыгрузитьКолонку("Сотрудник");
	МассивСотрудниковПолный = РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник");
	ТЗПособия = ПолучитьПособия(МассивСотрудниковПолный, НачалоГода(ДатаНачала), КонецДня(ДатаОкончания));
	
	ИтоговаяТЗ = ТЗДети.Скопировать();
	ИтоговаяТЗ.Очистить();
	
	Дети0 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ0");
	Дети50 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ50");
	Дети100 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ100");
	ДПособ50 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДПОСОБ50");
	ДПособ100 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДПОСОБ100");
	
	ТЗДетиБезПовторов = ТЗДети.Скопировать();
	ТЗДетиБезПовторов.Свернуть("Сотрудник,ФизЛицо");
	
	//есть отпуск по уходу за ребенком в текущем периоде (есть в тч ПУ3)
	Для Каждого Стр Из ТЗДетиБезПовторов Цикл
		
		//Аверсон ЕАЕ 23.10.2025 СВФР-017106
		МассивТекущийСотрудник = Новый Массив;
		МассивТекущийСотрудник.Добавить(Стр.Сотрудник);
		//Аверсон СВФР-017106
		
		СтруктураОтбораСотрудник = Новый Структура;
		СтруктураОтбораСотрудник.Вставить("Сотрудник", Стр.Сотрудник);
		МассивСтрокПособие = ТЗПособия.НайтиСтроки(СтруктураОтбораСотрудник);
		Для Каждого С Из МассивСтрокПособие Цикл
			
			//Аверсон ЕАЕ 20.07.2022 СВФР-009352
			ТЗСтавки = ПолучитьСтавкиСотрудника(Стр.Сотрудник, С.Начало, С.Окончание);
			Для Каждого ССтавки Из ТЗСтавки Цикл
				//Аверсон СВФР-009352
				
				НоваяСтр = ИтоговаяТЗ.Добавить();
				НоваяСтр.Сотрудник = Стр.Сотрудник;
				НоваяСтр.ФизЛицо = Стр.ФизЛицо;
				
				//Аверсон ЕАЕ 20.07.2022 СВФР-009352
				//НоваяСтр.ДатаНачалаРабот = С.Начало;
				//НоваяСтр.ДатаОкончанияРабот = С.Окончание;
				НоваяСтр.ДатаНачалаРабот = ССтавки.Начало;
				НоваяСтр.ДатаОкончанияРабот = ССтавки.Окончание;
				//Если С.Показатель1 = 50 Тогда
				//	НоваяСтр.ВидДеятельности = Дети50;
				//Иначе
				//	НоваяСтр.ВидДеятельности = Дети100;
				//КонецЕсли;
				Если С.Показатель1 = 50 Тогда
					Если ССтавки.КоличествоСтавок < 1 Тогда
						НоваяСтр.ВидДеятельности = ДПособ50;
					Иначе
						НоваяСтр.ВидДеятельности = Дети50;
					КонецЕсли;
				Иначе
					Если ССтавки.КоличествоСтавок < 1 Тогда
						//Аверсон 19.04.2023 КВВ СВФР-010705 (
						
						//Аверсон ЕАЕ 23.10.2025 СВФР-017106
						//ТЗОтпускаСтарые = ПолучитьОтпускаСтарые(МассивСотрудниковПолный, ССтавки.Начало, ССтавки.Окончание);
						ТЗОтпускаСтарые = ПолучитьОтпускаСтарые(МассивТекущийСотрудник, ССтавки.Начало, ССтавки.Окончание); 
						//Аверсон СВФР-017106
						
						Если ТЗОтпускаСтарые.Количество() > 0 Тогда
							НоваяСтр.ВидДеятельности = Дети100;
						Иначе			
							//Аверсон 19.04.2023 КВВ СВФР-010705 )
							НоваяСтр.ВидДеятельности = ДПособ100;
						КонецЕсли;
					Иначе
						НоваяСтр.ВидДеятельности = Дети100;
					КонецЕсли;
				КонецЕсли;
				//Аверсон СВФР-009352
				
			КонецЦикла;
			С.Записано = Истина;
		КонецЦикла;
	КонецЦикла;
	
	//отпуск по уходу за ребенком закончился до начала текущего периода (в тч ПУ3 нет)
	//но пособия продолжаются
	//СписокСотрудников = РаботникиОрганизации.ВыгрузитьКолонку("Сотрудник");
	ТЗОтпускаСтарые = ПолучитьОтпускаСтарые(МассивСотрудниковПолный, НачалоГода(НачалоГода(ДатаНачала) - 3 * 365 * 86400), НачалоГода(ДатаНачала) - 1); //за 3 предыдущих года
	Для Каждого Стр Из ТЗОтпускаСтарые Цикл
		СтруктураОтбораСотрудник = Новый Структура;
		СтруктураОтбораСотрудник.Вставить("Сотрудник", Стр.Сотрудник);
		СтруктураОтбораСотрудник.Вставить("Записано", Ложь);
		МассивСтрокПособие = ТЗПособия.НайтиСтроки(СтруктураОтбораСотрудник);
		Для Каждого С Из МассивСтрокПособие Цикл
			
			//Аверсон ЕАЕ 20.07.2022 СВФР-009352
			ТЗСтавки = ПолучитьСтавкиСотрудника(Стр.Сотрудник, С.Начало, С.Окончание);
			Для Каждого ССтавки Из ТЗСтавки Цикл
				//Аверсон СВФР-009352
				
				НоваяСтр = ИтоговаяТЗ.Добавить();
				НоваяСтр.Сотрудник = Стр.Сотрудник;
				НоваяСтр.ФизЛицо = Стр.ФизЛицо;
				
				//Аверсон ЕАЕ 20.07.2022 СВФР-009352
				//НоваяСтр.ДатаНачалаРабот = С.Начало;
				//НоваяСтр.ДатаОкончанияРабот = С.Окончание;
				НоваяСтр.ДатаНачалаРабот = ССтавки.Начало;
				НоваяСтр.ДатаОкончанияРабот = ССтавки.Окончание;
				//Если С.Показатель1 = 50 Тогда
				//	НоваяСтр.ВидДеятельности = Дети50;
				//Иначе
				//	НоваяСтр.ВидДеятельности = Дети100;
				//КонецЕсли;
				Если С.Показатель1 = 50 Тогда
					Если ССтавки.КоличествоСтавок < 1 Тогда
						НоваяСтр.ВидДеятельности = ДПособ50;
					Иначе
						НоваяСтр.ВидДеятельности = Дети50;
					КонецЕсли;
				Иначе
					Если ССтавки.КоличествоСтавок < 1 Тогда
						НоваяСтр.ВидДеятельности = ДПособ100;
					Иначе
						НоваяСтр.ВидДеятельности = Дети100;
					КонецЕсли;
				КонецЕсли;
				//Аверсон СВФР-009352
				
			КонецЦикла;
			С.Записано = Истина;
			
		КонецЦикла;
	КонецЦикла;
	
	//отпуска по уходу за ребенком нет
	//например, мать в декретном, отец работает и получает пособие
	СтруктураОтбораЗаписано = Новый Структура;
	СтруктураОтбораЗаписано.Вставить("Записано", Ложь);
	МассивСтрокПособие = ТЗПособия.НайтиСтроки(СтруктураОтбораЗаписано);
	Для Каждого С Из МассивСтрокПособие Цикл
		НоваяСтр = ИтоговаяТЗ.Добавить();
		НоваяСтр.Сотрудник = С.Сотрудник;
		НоваяСтр.ФизЛицо = С.ФизЛицо;
		НоваяСтр.ДатаНачалаРабот = С.Начало;
		НоваяСтр.ДатаОкончанияРабот = С.Окончание;
		Если С.Показатель1 = 50 Тогда
			НоваяСтр.ВидДеятельности = ДПособ50;
		Иначе
			НоваяСтр.ВидДеятельности = ДПособ100;
		КонецЕсли;
		
		С.Записано = Истина;
	КонецЦикла;
	
	//Аверсон ЕАЕ 03.08.2022 СВФР-009386
	
	//Для Каждого Стр Из МассивСтрокДети Цикл
	//	Если ИтоговаяТЗ.Найти(Стр.Сотрудник, "Сотрудник") = Неопределено Тогда //нет пособий, но есть отпуск
	//		Стр.ВидДеятельности = ДЕТИ0;
	//	Иначе
	//		ИндексСтроки = СведенияОСтаже.Индекс(Стр);
	//		СведенияОСтаже.Удалить(ИндексСтроки);
	//	КонецЕсли;
	//КонецЦикла;
	
	//Для Каждого Стр Из МассивСтрокДети Цикл
	//	
	//	//Найдем в сведениях о стаже периоды, которые не попали в итоговую тз 
	//	
	//	ТЗДети0 = Новый ТаблицаЗначений;
	//	ТЗДети0.Колонки.Добавить("С");
	//	ТЗДети0.Колонки.Добавить("По");
	//	
	//	СтруктураОтбора = Новый Структура;
	//	СтруктураОтбора.Вставить("Сотрудник", Стр.Сотрудник);
	//	ИтоговаяТЗСотрудник = ИтоговаяТЗ.НайтиСтроки(СтруктураОтбора);
	//	
	//	Д = Стр.ДатаНачалаРабот;
	//	ОткрытьПериод = Истина;
	//	ЗакрытьПериод = Ложь;
	//	ПредыдущаяДата = '00010101';
	//	Пока Д <= Стр.ДатаОкончанияРабот Цикл
	//		Входит = Ложь;
	//		Для Каждого Период Из ИтоговаяТЗСотрудник Цикл
	//			Если Д >= Период.ДатаНачалаРабот И Д <= Период.ДатаОкончанияРабот Тогда
	//				Входит = Истина;
	//				Прервать;
	//			КонецЕсли;
	//		КонецЦикла;
	//		
	//		Если Входит Тогда 
	//			Если ЗакрытьПериод Тогда
	//				Если ТЗДети0.Количество() > 0 Тогда
	//					ПоследняяСтр = ТЗДети0.Получить(ТЗДети0.Количество() - 1);
	//					Если Не ЗначениеЗаполнено(ПоследняяСтр.По) Тогда
	//						ПоследняяСтр.По = КонецДня(ПредыдущаяДата);
	//						ЗакрытьПериод = Ложь;
	//					КонецЕсли;
	//				КонецЕсли;
	//			КонецЕсли;
	//			ОткрытьПериод = Истина;
	//		Иначе
	//			Если ОткрытьПериод Тогда
	//				НовыйПериод = ТЗДети0.Добавить();
	//				НовыйПериод.С = НачалоДня(Д);
	//				
	//				ОткрытьПериод = Ложь;
	//				ЗакрытьПериод = Истина;
	//			КонецЕсли;
	//		КонецЕсли;
	//		ПредыдущаяДата = Д;
	//		Д = КонецДня(Д) + 1;
	//	КонецЦикла;
	//	
	//	Если ЗакрытьПериод Тогда
	//		Если ТЗДети0.Количество() > 0 Тогда
	//			ПоследняяСтр = ТЗДети0.Получить(ТЗДети0.Количество() - 1);
	//			Если Не ЗначениеЗаполнено(ПоследняяСтр.По) Тогда
	//				ПоследняяСтр.По = КонецДня(ПредыдущаяДата);	
	//			КонецЕсли;
	//		КонецЕсли;
	//	КонецЕсли;
	//	
	//	Для Каждого СтрДети0 Из ТЗДети0 Цикл
	//		НоваяСтр = ИтоговаяТЗ.Добавить();
	//		НоваяСтр.Сотрудник = Стр.Сотрудник;
	//		НоваяСтр.ФизЛицо = Стр.ФизЛицо;
	//		НоваяСтр.ДатаНачалаРабот = СтрДети0.С;
	//		НоваяСтр.ДатаОкончанияРабот = СтрДети0.По;
	//		НоваяСтр.ВидДеятельности = ДЕТИ0;
	//	КонецЦикла;
	//	
	//КонецЦикла;
	
	ТЗДети0 = ПолучитьОтпускаБезПособий(ТЗДети, ИтоговаяТЗ);
	Для Каждого СтрДети0 Из ТЗДети0 Цикл
		НоваяСтр = ИтоговаяТЗ.Добавить();
		НоваяСтр.Сотрудник = СтрДети0.Сотрудник;
		НоваяСтр.ФизЛицо = СтрДети0.ФизЛицо;
		НоваяСтр.ДатаНачалаРабот = СтрДети0.ДатаНач;
		НоваяСтр.ДатаОкончанияРабот = СтрДети0.ДатаКон;
		НоваяСтр.ВидДеятельности = ДЕТИ0;
	КонецЦикла;
	
	Для Каждого Стр Из МассивСтрокДети Цикл
		ИндексСтроки = СведенияОСтаже.Индекс(Стр);
		СведенияОСтаже.Удалить(ИндексСтроки);
	КонецЦикла;
	
	//Аверсон СВФР-009386
	
	Для Каждого Стр Из ИтоговаяТЗ Цикл
		НоваяСтр = СведенияОСтаже.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяСтр, Стр); 
	КонецЦикла;
	СведенияОСтаже.Сортировать("Сотрудник, ДатаНачалаРабот");
	
КонецПроцедуры

//Аверсон ЕАЕ 04.08.2022 СВФР-009386
//Получаем периоды из СведенияОСтаже(все сведения о детях), которые не вошли в ТЗИтоговая(Пособия)
Функция ПолучитьОтпускаБезПособий(ТЗДети, ТЗИтоговая)
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|ТЗИтоговая.Сотрудник,
	|ТЗИтоговая.ФизЛицо,
	|ТЗИтоговая.ДатаНачалаРабот КАК ДатаНач,
	|ТЗИтоговая.ДатаОкончанияРабот КАК ДатаКон
	|ПОМЕСТИТЬ ВТТЗИтоговая
	|ИЗ &ТЗИтоговая КАК ТЗИтоговая
	|;
	|/////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|ВТТЗДети.Сотрудник,
	|ВТТЗДети.ФизЛицо,
	|ВТТЗДети.ДатаНачалаРабот КАК ДатаНач,
	|ВТТЗДети.ДатаОкончанияРабот КАК ДатаКон
	|ПОМЕСТИТЬ ВТТЗДети
	|ИЗ &ТЗДети КАК ВТТЗДети
	|;
	|/////////////////////////////////
	|ВЫБРАТЬ
	|ВЫБОР 
	|КОГДА ВТТЗИтоговая.ДатаНач < ВТТЗДети.ДатаНач 
	|ТОГДА ВТТЗДети.ДатаНач 
	|ИНАЧЕ ВТТЗИтоговая.ДатаНач 
	|КОНЕЦ КАК ДатаНач,
	|ВЫБОР 
	|КОГДА ВТТЗИтоговая.датакон > ВТТЗДети.датакон 
	|ТОГДА ВТТЗДети.ДатаКон 
	|ИНАЧЕ ВТТЗИтоговая.ДатаКон 
	|КОНЕЦ КАК ДатаКон,
	|ВТТЗДети.ДатаНач КАК ДатаНачСведенияОСтаже,
	|ВТТЗДети.ДатаКон КАК ДатаКонСведенияОСтаже,
	|ВТТЗИтоговая.Сотрудник,
	|ВТТЗИтоговая.ФизЛицо
	|ПОМЕСТИТЬ ВТПериодыВходящие 
	|ИЗ ВТТЗИтоговая
	|ЛЕВОЕ СОЕДИНЕНИЕ ВТТЗДети
	|ПО ВТТЗИтоговая.ДатаНач <= ВТТЗДети.датакон
	|И ВТТЗИтоговая.ДатаКон >= ВТТЗДети.ДатаНач
	|И ВТТЗИтоговая.Сотрудник = ВТТЗДети.Сотрудник
	|И ВТТЗИтоговая.ФизЛицо = ВТТЗДети.ФизЛицо
	|ГДЕ НЕ ВТТЗДети.ДатаНач ЕСТЬ NULL и НЕ ВТТЗДети.ДатаКон ЕСТЬ NULL
	|; 
	|//////////////////////////////
	|ВЫБРАТЬ
	|МАКСИМУМ(ВТПериодыВходящие.датанач) КАК ДатаНач,
	|МАКСИМУМ(ВТПериодыВходящие.датакон) КАК ДатаКон,
	|ВТПериодыВходящие.ДатаНачСведенияОСтаже,
	|ВТПериодыВходящие.ДатаКонСведенияОСтаже,
	|ВТПериодыВходящие.Сотрудник,
	|ВТПериодыВходящие.ФизЛицо
	|ПОМЕСТИТЬ ВТМаксимальныйПериод
	|ИЗ ВТПериодыВходящие
	|СГРУППИРОВАТЬ ПО
	|ВТПериодыВходящие.ДатаНачСведенияОСтаже,
	|ВТПериодыВходящие.ДатаКонСведенияОСтаже,
	|ВТПериодыВходящие.Сотрудник,
	|ВТПериодыВходящие.ФизЛицо
	|;
	|//////////////////////////////
	|ВЫБРАТЬ 
	|ВТПериодыВходящие.ДатаНач,
	|ВТПериодыВходящие.ДатаКон,
	|ВТПериодыВходящие.ДатаНачСведенияОСтаже,
	|ВТПериодыВходящие.ДатаКонСведенияОСтаже,
	|ВТПериодыВходящие.Сотрудник,
	|ВТПериодыВходящие.ФизЛицо,
	|МАКСИМУМ(ВТПериодыВходящиеМеньше.ДатаНач) КАК ДатаНач1,
	|МАКСИМУМ(ВТПериодыВходящиеМеньше.датакон) КАК ДатаКон1
	|ПОМЕСТИТЬ ВТПериодыПодготовка
	|ИЗ ВТПериодыВходящие
	|ЛЕВОЕ СОЕДИНЕНИЕ ВТПериодыВходящие как ВТПериодыВходящиеМеньше
	|ПО ВТПериодыВходящие.ДатаНачСведенияОСтаже = ВТПериодыВходящиеМеньше.ДатаНачСведенияОСтаже
	|И ВТПериодыВходящие.ДатаКонСведенияОСтаже = ВТПериодыВходящиеМеньше.ДатаКонСведенияОСтаже
	|И ВТПериодыВходящие.ДатаКон > ВТПериодыВходящиеМеньше.ДатаКон
	|И ВТПериодыВходящие.ДатаНач > ВТПериодыВходящиеМеньше.ДатаНач
	|И ВТПериодыВходящие.Сотрудник = ВТПериодыВходящиеМеньше.Сотрудник
	|И ВТПериодыВходящие.ФизЛицо = ВТПериодыВходящиеМеньше.ФизЛицо
	
	|СГРУППИРОВАТЬ ПО
	|ВТПериодыВходящие.ДатаНач,
	|ВТПериодыВходящие.ДатаКон,
	|ВТПериодыВходящие.ДатаНачСведенияОСтаже,
	|ВТПериодыВходящие.ДатаКонСведенияОСтаже,
	|ВТПериодыВходящие.Сотрудник,
	|ВТПериодыВходящие.ФизЛицо
	|;
	|////////////////////////////////////////////
	|ВЫБРАТЬ
	|ВЫБОР
	|КОГДА ВТПериодыПодготовка.ДатаНач1 ЕСТЬ NULL и ВТПериодыПодготовка.ДатаКон1 ЕСТЬ NULL
	|ТОГДА 
	|		ВЫБОР
	|		КОГДА ВТПериодыПодготовка.ДатаНач > ВТПериодыПодготовка.ДатаНачСведенияОСтаже
	|		ТОГДА ВТПериодыПодготовка.ДатаНачСведенияОСтаже
	|		ИНАЧЕ NULL
	|		КОНЕЦ
	|ИНАЧЕ ДОБАВИТЬКДАТЕ(КОНЕЦПЕРИОДА(ВТПериодыПодготовка.ДатаКон1,ДЕНЬ),СЕКУНДА,1)
	|		
	|КОНЕЦ КАК ДатаНач,
	|
	|ВЫБОР
	|КОГДА ВТПериодыПодготовка.ДатаНач1 ЕСТЬ NULL и ВТПериодыПодготовка.ДатаКон1 ЕСТЬ NULL
	|ТОГДА 
	|		ВЫБОР
	|		КОГДА ВТПериодыПодготовка.ДатаНач > ВТПериодыПодготовка.ДатаНачСведенияОСтаже
	|		ТОГДА ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ВТПериодыПодготовка.ДатаНач,ДЕНЬ), СЕКУНДА,-1)
	|		ИНАЧЕ NULL
	|		КОНЕЦ
	|ИНАЧЕ ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(ВТПериодыПодготовка.ДатаНач,ДЕНЬ),СЕКУНДА,-1)
	|		
	|КОНЕЦ КАК ДатаКон,
	|ВТПериодыПодготовка.Сотрудник,
	|ВТПериодыПодготовка.ФизЛицо
	|ПОМЕСТИТЬ ВТРезультат
	|ИЗ ВТПериодыПодготовка
	|
	|ОБЪЕДИНИТЬ 
	|
	|ВЫБРАТЬ 
	|ВЫБОР
	|КОГДА ВТМаксимальныйПериод.ДатаКон < ВТМаксимальныйПериод.ДатаКонСведенияОСтаже
	|ТОГДА ДОБАВИТЬКДАТЕ(КОНЕЦПЕРИОДА(ВТМаксимальныйПериод.ДатаКон,ДЕНЬ), СЕКУНДА, 1)
	|ИНАЧЕ NULL
	|КОНЕЦ КАК ДатаНач,
	|
	|ВЫБОР
	|КОГДА ВТМаксимальныйПериод.ДатаКон < ВТМаксимальныйПериод.ДатаКонСведенияОСтаже
	|ТОГДА КОНЕЦПЕРИОДА(ВТМаксимальныйПериод.ДатаКонСведенияОСтаже,ДЕНЬ)
	|ИНАЧЕ NULL
	|КОНЕЦ КАК ДатаКон,
	|ВТМаксимальныйПериод.Сотрудник,
	|ВТМаксимальныйПериод.ФизЛицо
	| 
	|ИЗ ВТМаксимальныйПериод
	|  
	|;
	|///////////////////////////////////////////////////
	|ВЫБРАТЬ 
	|*
	|ИЗ ВТРезультат
	|ГДЕ НЕ ВТРезультат.ДатаНач ЕСТЬ NULL И НЕ ВТРезультат.ДатаКон ЕСТЬ NULL
	|И ВТРезультат.ДатаНач < ВТРезультат.ДатаКон 
	|"; 
	
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("ТЗИтоговая", ТЗИтоговая);
	Запрос.УстановитьПараметр("ТЗДети", ТЗДети); 
	
	ТЗДети0 = Запрос.Выполнить().Выгрузить();
	Возврат ТЗДети0;
КонецФункции
//Аверсон СВФР-009386

Функция ПолучитьПособия(МассивСотрудников, Нач, Кон)
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	план.Сотрудник,
	|   план.Сотрудник.ФизЛицо КАК ФизЛицо,
	|	план.ВидРасчета,
	|	план.Показатель1,
	|	&НачалоГода КАК начало,
	|	ВЫБОР
	|		КОГДА план.ПериодЗавершения > &ДатаОкончания
	|			ТОГДА &ДатаОкончания
	|		ИНАЧЕ ДОБАВИТЬКДАТЕ(план.ПериодЗавершения, СЕКУНДА, -1)
	|	КОНЕЦ КАК окончание,
	|   Ложь КАК Записано
	|ПОМЕСТИТЬ ВТПособия
	|ИЗ
	|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
	|			&НачалоГода,
	|			сотрудник В (&СписокСотрудников)
	//|				И видрасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаДо3Лет)
	|               И видрасчета.способрасчета В (&СпособыРасчета)
	|				И действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать)
	|               И (ПериодЗавершения = ДатаВремя(1,1,1) ИЛИ ПериодЗавершения >= &НачалоГода)) КАК план
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	план1.Сотрудник,
	|   план1.Сотрудник.ФизЛицо,
	|	план1.ВидРасчета,
	|	план1.Показатель1,
	|	план1.Период,
	|	ВЫБОР
	|		КОГДА план1.ПериодЗавершения > &ДатаОкончания
	|			ТОГДА &ДатаОкончания
	|		ИНАЧЕ ДОБАВИТЬКДАТЕ(план1.ПериодЗавершения, СЕКУНДА, -1)
	|	КОНЕЦ,
	|   Ложь
	|ИЗ
	|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК план1
	|ГДЕ
	|	план1.Сотрудник В (&СписокСотрудников)
	|	И план1.Период МЕЖДУ &НачалоГода И &ДатаОкончания
	//|	И план1.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ПособиеНаРебенкаДо3Лет)
	|	И план1.ВидРасчета.СпособРасчета В (&СпособыРасчета)
	|	И план1.Действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать)
	|   И (ПериодЗавершения = ДатаВремя(1,1,1) ИЛИ ПериодЗавершения >= &НачалоГода)
	|;
	|/////////////////////////////////////////////////////////////
	|ВЫБРАТЬ 
	|	ВТПособия.Сотрудник,
	|   ВТПособия.ФизЛицо,
	|   ВТПособия.ВидРасчета,
	|   ВТПособия.Показатель1,
	|   ВТПособия.Начало,
	|	ВЫБОР
	|   КОГДА РаботникиОрганизаций.Период ЕСТЬ NULL
	|   ТОГДА ВТПособия.Окончание
	|   ИНАЧЕ
	|   	ВЫБОР
	|       КОГДА ВТПособия.Окончание > РаботникиОрганизаций.Период
	|       ТОГДА КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(РаботникиОрганизаций.Период, ДЕНЬ), СЕКУНДА, -1), МЕСЯЦ)
	|       ИНАЧЕ 
	
	//Аверсон 08.08.2023 КВВ СВФР-011177 (
	//КОНЕЦПЕРИОДА(ВТПособия.Окончание, МЕСЯЦ)
	|ВЫБОР КОГДА
	|ДОБАВИТЬКДАТЕ(КОНЕЦПЕРИОДА(ВТПособия.Окончание, ДЕНЬ),СЕКУНДА, 1) = НАЧАЛОПЕРИОДА(РаботникиОрганизаций.Период, ДЕНЬ)
	|ТОГДА
	|ВТПособия.Окончание
	|ИНАЧЕ
	|КОНЕЦПЕРИОДА(ВТПособия.Окончание, МЕСЯЦ)
	|КОНЕЦ
	//Аверсон 08.08.2023 КВВ СВФР-011177 )
	
	|       КОНЕЦ
	|   КОНЕЦ КАК Окончание,
	|   ВТПособия.Записано
	|ИЗ ВТПособия
	|ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|ПО ВТПособия.Сотрудник = РаботникиОрганизаций.Сотрудник
	|	И РаботникиОрганизаций.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
	|ГДЕ РаботникиОрганизаций.Период ЕСТЬ NULL ИЛИ РаботникиОрганизаций.Период >= &НачалоГода
	|";
	
	Запрос.УстановитьПараметр("ДатаОкончания", Кон);
	Запрос.УстановитьПараметр("НачалоГода", Нач);
	Запрос.УстановитьПараметр("СписокСотрудников", МассивСотрудников);
	
	СпособыРасчета = Новый Массив;
	СпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаВторогоИПоследующихДо3Лет);
	СпособыРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ПособиеНаРебенкаДо3Лет);
	Запрос.УстановитьПараметр("СпособыРасчета", СпособыРасчета);
	
	ТЗ = Запрос.Выполнить().Выгрузить();
	Возврат ТЗ;
	
КонецФункции

Функция ПолучитьОтпускаСтарые(СписокСотрудников, Нач, Кон)
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	план.Сотрудник,
	|   план.Сотрудник.ФизЛицо КАК ФизЛицо,
	|	план.ВидРасчета
	|ИЗ
	|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(
	|			&Нач, Сотрудник В (&СписокСотрудников)
	|			И видрасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)
	//Аверсон ЕАЕ 22.10.2025 СВФР-017106
	//|				И действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать)) КАК план
	|				) КАК план
	|ГДЕ план.действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать) И
	|	(план.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.пустаяссылка) ИЛИ 
	|	ДОБАВИТЬКДАТЕ(план.ПериодЗавершения,ДЕНЬ,-1) >= &Нач)
	//Аверсон СВФР-017106
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	план1.Сотрудник,
	|   план1.Сотрудник.ФизЛицо,
	|	план1.ВидРасчета
	|ИЗ
	|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК план1
	|ГДЕ план1.Сотрудник В (&СписокСотрудников)
	|	И план1.Период МЕЖДУ &Нач И &Кон
	|	И план1.ВидРасчета = ЗНАЧЕНИЕ(ПланВидовРасчета.ОсновныеНачисленияОрганизаций.ОтпускПоУходуЗаРебенкомБезОплаты)
	|	И план1.Действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать)";
	Запрос.УстановитьПараметр("СписокСотрудников", СписокСотрудников);
	Запрос.УстановитьПараметр("Кон", Кон);
	Запрос.УстановитьПараметр("Нач", Нач);
	
	ТЗ = Запрос.Выполнить().Выгрузить();
	Возврат ТЗ;
КонецФункции

Функция ПолучитьКоличествоДетей(ФизЛицо, НаДату)
	Кол = 0;
	Запрос = Новый Запрос;
	Запрос.Текст = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ФизическиеЛицаСоставСемьи.Ссылка КАК ФизЛицо,
	|	СУММА(1) КАК КоличествоДетей
	|ИЗ
	|	Справочник.ФизическиеЛица.СоставСемьи КАК ФизическиеЛицаСоставСемьи
	|ГДЕ ФизическиеЛицаСоставСемьи.Ссылка = &ФизЛицо
	|И ФизическиеЛицаСоставСемьи.ДатаРождения > &НаДату
	|СГРУППИРОВАТЬ ПО
	|	ФизическиеЛицаСоставСемьи.Ссылка
	|";
	
	Запрос.УстановитьПараметр("ФизЛицо", ФизЛицо);
	Запрос.УстановитьПараметр("НаДату", НаДату - 3 * 365 * 86400);
	Результат = Запрос.Выполнить();
	Если Не Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Если Выборка.Следующий() Тогда
			Кол = Выборка.КоличествоДетей;	
		КонецЕсли;
	КонецЕсли;
	Возврат Кол;
КонецФункции
//Аверсон СВФР-008941

//Аверсон ЕАЕ 20.07.2022 СВФР-009352
Функция ПолучитьСтавкиСотрудника(Сотр, Нач, Кон)
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	РаботникиОрганизацийСрезПоследних.Занимаемыхставок КАК КоличествоСтавок,
	|	&НачПериода КАК Период
	|ПОМЕСТИТЬ ВтСтавки
	|ИЗ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&НачПериода, Сотрудник = &Сотрудник) КАК РаботникиОрганизацийСрезПоследних
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	РаботникиОрганизаций.ЗанимаемыхСтавок,
	|	РаботникиОрганизаций.Период
	|ИЗ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|ГДЕ РаботникиОрганизаций.Период МЕЖДУ &НачПериода и &КонПериода
	|	И РаботникиОрганизаций.Сотрудник = &Сотрудник
	|;
	|///////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВтСтавки.КоличествоСтавок КАК КоличествоСтавок,
	|	ВтСтавки.Период КАК Начало,
	|	ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ВтСтавкиБольше.Период, СЕКУНДА, -1), &КонПериода) как Окончание
	|ИЗ ВтСтавки
	|ЛЕВОЕ СОЕДИНЕНИЕ ВтСтавки КАК ВтСтавкиБольше
	|ПО ВтСтавки.Период < ВтСтавкиБольше.Период";
	
	Запрос = Новый Запрос;
	Запрос.Текст = Текст;
	Запрос.УстановитьПараметр("НачПериода", Нач);
	Запрос.УстановитьПараметр("КонПериода", Кон);
	Запрос.УстановитьПараметр("Сотрудник", Сотр);
	
	ТЗ = Запрос.Выполнить().Выгрузить();
	
	//Свернем, чтобы не повторялись периоды с одинаковыми ставками
	ТЗИтог = ТЗ.Скопировать();
	ТЗИтог.Очистить();
	ПредыдущаяСтавка = Неопределено;
	ИндексПредыдущейСтроки = 0;
	Для Каждого Стр Из ТЗ Цикл
		Если Стр.КоличествоСтавок = ПредыдущаяСтавка Тогда //в предыдущей строке изменяем конец периода
			ПредыдущаяСтр = ТЗИтог.Получить(ИндексПредыдущейСтроки);
			ПредыдущаяСтр.Окончание = Стр.Окончание;
		Иначе //Новая строка
			НоваяСтр = ТЗИтог.Добавить();
			ЗаполнитьЗначенияСвойств(НоваяСтр, Стр);
			ПредыдущаяСтавка = Стр.КоличествоСтавок;
			ИндексПредыдущейСтроки = ТЗИтог.Индекс(НоваяСтр);
		КонецЕсли;
	КонецЦикла;
	
	Возврат ТЗИтог;
КонецФункции
//Аверсон СВФР-009352

//Аверсон ЕАЕ 09.08.2022 СВФР-009387
Функция ПолучитьИзмененияГруппыИнвалидности(ФЛ)
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СведенияОбИнвалидностиФизлиц.Физлицо,
	|	СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности,
	|	МАКСИМУМ(СведенияОбИнвалидностиФизлицПред.ГруппаИнвалидности) КАК ГруппаИнвалидностиПред,
	|	СведенияОбИнвалидностиФизлиц.Период КАК ДатаИнвалидности
	|ИЗ
	|	РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлиц
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СведенияОбИнвалидностиФизлиц КАК СведенияОбИнвалидностиФизлицПред
	|		ПО СведенияОбИнвалидностиФизлиц.Физлицо = СведенияОбИнвалидностиФизлицПред.Физлицо
	|			И СведенияОбИнвалидностиФизлиц.Период > СведенияОбИнвалидностиФизлицПред.Период
	|ГДЕ
	|	СведенияОбИнвалидностиФизлиц.Физлицо = &ФЛ
	|	И СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности = ""III""
	|	И СведенияОбИнвалидностиФизлиц.Период МЕЖДУ &ПериодНач И &ПериодКон
	|	И (СведенияОбИнвалидностиФизлицПред.ГруппаИнвалидности = ""I""
	|			ИЛИ СведенияОбИнвалидностиФизлицПред.ГруппаИнвалидности = ""II"")
	|
	|СГРУППИРОВАТЬ ПО
	|	СведенияОбИнвалидностиФизлиц.Физлицо,
	|	СведенияОбИнвалидностиФизлиц.ГруппаИнвалидности,
	|	СведенияОбИнвалидностиФизлиц.Период";
	
	Запрос.УстановитьПараметр("ПериодКон", ДатаОкончания);  
	Запрос.УстановитьПараметр("ПериодНач", ДатаНачала);
	Запрос.УстановитьПараметр("ФЛ", ФЛ);
	
	МассивИнвалидность = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("ДатаИнвалидности");
	
	Возврат МассивИнвалидность;
КонецФункции
//Аверсон СВФР-009387

//Аверсон ЕАЕ 07.10.2024 СВФР-013489
Функция ПроверкаБЛ2Пособие1()
	//Первое пособие не закончилось, начался второй больничный
	
	ПОСОББИР = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ПОСОББИР");
	ДЕТИ100 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДЕТИ100");
	ДПособ100 = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДПособ100");
	
	СтруктураОтбора = Новый Структура;
	СтруктураОтбора.Вставить("ВидДеятельности", ПОСОББИР);
	МассивБЛ = СведенияОСтаже.НайтиСтроки(СтруктураОтбора);
	ТЗБЛ = СведенияОСтаже.Выгрузить(МассивБЛ);
	Для Каждого Стр Из СведенияОСтаже Цикл
		Если Стр.ВидДеятельности <> ДЕТИ100 Тогда
			Продолжить;
		КонецЕсли;
		НужнаяСтрока = ТЗБЛ.Найти(Стр.Сотрудник, "Сотрудник");
		Если НужнаяСтрока <> Неопределено Тогда
			Если НужнаяСтрока.ДатаНачалаРабот > Стр.ДатаОкончанияРабот ИЛИ НужнаяСтрока.ДатаОкончанияРабот < Стр.ДатаНачалаРабот Тогда
				Продолжить;
			КонецЕсли;
			Стр.ВидДеятельности = ДПособ100;
			Стр.ДатаНачалаРабот = МАКС(НужнаяСтрока.ДатаНачалаРабот, Стр.ДатаНачалаРабот);
			Стр.ДатаОкончанияРабот = МИН(НужнаяСтрока.ДатаОкончанияРабот, Стр.ДатаОкончанияРабот);
		КонецЕсли;
	КонецЦикла;
КонецФункции
//Аверсон СВФР-013489

//Аверсон ЕАЕ 14.01.2025 СВФР-014563
Процедура ГруппировкаДоговорВзносыврем()
	//Свернем ДОГОВОР
	ДОГОВОР = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ДОГОВОР");
	
	СтруктураОтбора = Новый Структура;
	СтруктураОтбора.Вставить("ВидДеятельности", ДОГОВОР);
	
	МассивСтрокДоговор = СведенияОСтаже.НайтиСтроки(СтруктураОтбора);
	
	ТЗДоговор = СведенияОСтаже.Выгрузить(СтруктураОтбора);
	ТЗДоговор.Сортировать("Сотрудник,Договор,ДатаНачалаРабот");
	
	ТЗИтог = ТЗДоговор.Скопировать();
	ТЗИтог.Очистить();
	
	ТЗДоговорСотрудник = ТЗДоговор.Скопировать();
	ТЗДоговорСотрудник.Свернуть("Сотрудник,Договор");
	Для Каждого Стр Из ТЗДоговорСотрудник Цикл
		
		Дог = Стр.Договор;
		
		СтрОтбора = Новый Структура;
		СтрОтбора.Вставить("Сотрудник", Стр.Сотрудник);
		СтрОтбора.Вставить("Договор", Дог);
		
		СтрокиДоговор = ТЗДоговор.НайтиСтроки(СтрОтбора);
		Если СтрокиДоговор.Количество() > 0 Тогда
			Дат = '00010101'; //Здесь будем хранить дату окончания пред периода
			СПред = Неопределено;
			н = 0;
			Для Каждого ЭлСтр Из СтрокиДоговор Цикл
				н = н + 1;
				Если ЭлСтр.ДатаНачалаРабот = КонецДня(Дат) + 1 Тогда
					СПред.ДатаОкончанияРабот = ЭлСтр.ДатаОкончанияРабот;
					Дат = ЭлСтр.ДатаОкончанияРабот;
					
					Если н = СтрокиДоговор.Количество() Тогда
						//Аверсон ЕАЕ 20.01.2025 СВФР-014643
						Если Дог.Пустая() Тогда
							СПред.ДатаОкончанияРабот = ЭлСтр.ДатаОкончанияРабот;
						Иначе
						//Аверсон СВФР-014643
							СПред.ДатаОкончанияРабот = Дог.ДатаОкончания;
						КонецЕсли;
					КонецЕсли;
					
				Иначе
					НоваяСтр = ТЗИтог.Добавить();
					ЗаполнитьЗначенияСвойств(НоваяСтр, ЭлСтр);
					СПред = НоваяСтр;
					Дат = ЭлСтр.ДатаОкончанияРабот;
					
					Если н = СтрокиДоговор.Количество() Тогда
						//Аверсон ЕАЕ 20.01.2025 СВФР-014643
						Если Дог.Пустая() Тогда
							НоваяСтр.ДатаОкончанияРабот = ЭлСтр.ДатаОкончанияРабот;
						Иначе
						//Аверсон СВФР-014643
							НоваяСтр.ДатаОкончанияРабот = Дог.ДатаОкончания;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	//+ Ништ 26.01.2026 СВФР-017912: "ВЗНОСЫВРЕМ нужно разбивать"
	////Свернем ВЗНОСЫВРЕМ
	//ВЗНОСЫВРЕМ = Справочники.ОсобыеУсловияТруда.НайтиПоКоду("ВЗНОСЫВРЕМ");

	//СтруктураОтбора = Новый Структура;
	//СтруктураОтбора.Вставить("ВидДеятельности", ВЗНОСЫВРЕМ);
	//
	//МассивСтрокВзносыврем = СведенияОСтаже.НайтиСтроки(СтруктураОтбора);
	//
	//ТЗВзносыврем = СведенияОСтаже.Выгрузить(СтруктураОтбора);
	//ТЗВзносыврем.Сортировать("Сотрудник,Договор,ДатаНачалаРабот");
	//
	//ТЗВзносывремСотрудник = ТЗВзносыврем.Скопировать();
	//ТЗВзносывремСотрудник.Свернуть("Сотрудник,Договор");
	//Для Каждого Стр Из ТЗВзносывремСотрудник Цикл
	//	
	//	Дог = Стр.Договор;
	//	
	//	СтрОтбора = Новый Структура;
	//	СтрОтбора.Вставить("Сотрудник", Стр.Сотрудник);
	//	СтрОтбора.Вставить("Договор", Дог);
	//	
	//	СтрокиВзносыврем = ТЗВзносыврем.НайтиСтроки(СтрОтбора);
	//	Если СтрокиВзносыврем.Количество() > 0 Тогда
	//		Дат = '00010101'; //Здесь будем хранить дату окончания пред периода
	//		СПред = Неопределено;
	//		н = 0;
	//		Для Каждого ЭлСтр Из СтрокиВзносыврем Цикл
	//			н = н + 1;
	//			Если ЭлСтр.ДатаНачалаРабот = КонецДня(Дат) + 1 Тогда
	//				СПред.ДатаОкончанияРабот = ЭлСтр.ДатаОкончанияРабот;
	//				Дат = ЭлСтр.ДатаОкончанияРабот;
	//				
	//				Если н = СтрокиВзносыврем.Количество() Тогда
	//					//Аверсон ЕАЕ 20.01.2025 СВФР-014643
	//					Если Дог.Пустая() Тогда
	//						СПред.ДатаОкончанияРабот = ЭлСтр.ДатаОкончанияРабот;
	//					Иначе
	//					//Аверсон СВФР-014643
	//						СПред.ДатаОкончанияРабот = Дог.ДатаОкончания;
	//					КонецЕсли;
	//				КонецЕсли;
	//				
	//			Иначе
	//				НоваяСтр = ТЗИтог.Добавить();
	//				ЗаполнитьЗначенияСвойств(НоваяСтр, ЭлСтр);
	//				СПред = НоваяСтр;
	//				Дат = ЭлСтр.ДатаОкончанияРабот;
	//				
	//				Если н = СтрокиВзносыврем.Количество() Тогда
	//					//Аверсон ЕАЕ 20.01.2025 СВФР-014643
	//					Если Дог.Пустая() Тогда
	//						НоваяСтр.ДатаОкончанияРабот = ЭлСтр.ДатаОкончанияРабот;
	//					Иначе
	//					//Аверсон СВФР-014643
	//						НоваяСтр.ДатаОкончанияРабот = Дог.ДатаОкончания;
	//					КонецЕсли;
	//				КонецЕсли;
	//			КонецЕсли;
	//		КонецЦикла;
	//	КонецЕсли;
	//КонецЦикла;
	//- Ништ 26.01.2026 СВФР-017912
	
	Для Каждого Эл Из МассивСтрокДоговор Цикл
		СведенияОСтаже.Удалить(Эл);
	КонецЦикла;
	//+ Ништ 26.01.2026 СВФР-017912: "ВЗНОСЫВРЕМ нужно разбивать"
	//Для Каждого Эл Из МассивСтрокВзносыврем Цикл
	//	СведенияОСтаже.Удалить(Эл);
	//КонецЦикла;
	//- Ништ 26.01.2026 СВФР-017912
	Для Каждого Стр Из ТЗИтог Цикл
		НоваяСтр = СведенияОСтаже.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяСтр, Стр, , "НомерСтроки");
	КонецЦикла;
	СведенияОСтаже.Сортировать("Сотрудник,Физлицо,Договор,ДатаНачалаРабот,ВидДеятельности");
	
КонецПроцедуры
//Аверсон СВФР-014563

//+ СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 9 )
мДлинаСуток = 24 * 60 * 60; // продолжительность суток в секундах
//- СВЭЙ КДЯ 19.08.19 СВФР-004631 ( пункт 9 )
